f | priv.c | s | 10K | 351 | Cornelia Huck | cornelia.huck@de.ibm.com | 1335833752 |  | KVM: s390: Handle sckpf instruction  Handle the mandatory intercept SET CLOCK PROGRAMMABLE FIELD instruction.  Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | interrupt.c | s | 16K | 567 | Linus Torvalds | torvalds@linux-foundation.org | 1332970531 |  | Merge branch 'kvm-updates/3.4' of git://git.kernel.org/pub/scm/virt/kvm/kvm  Pull kvm updates from Avi Kivity:  "Changes include timekeeping improvements, support for assigning host   PCI devices that share interrupt lines, s390 user-controlled guests, a   large ppc update, and random fixes."  This is with the sign-off's fixed, hopefully next merge window we won't have rebased commits.  * 'kvm-updates/3.4' of git://git.kernel.org/pub/scm/virt/kvm/kvm: (130 commits)   KVM: Convert intx_mask_lock to spin lock   KVM: x86: fix kvm_write_tsc() TSC matching thinko   x86: kvmclock: abstract save/restore sched_clock_state   KVM: nVMX: Fix erroneous exception bitmap check   KVM: Ignore the writes to MSR_K7_HWCR(3)   KVM: MMU: make use of ->root_level in reset_rsvds_bits_mask   KVM: PMU: add proper support for fixed counter 2   KVM: PMU: Fix raw event check   KVM: PMU: warn when pin control is set in eventsel msr   KVM: VMX: Fix delayed load of shared MSRs   KVM: use correct tlbs dirty type in cmpxchg   KVM: Allow host IRQ sharing for assigned PCI 2.3 devices   KVM: Ensure all vcpus are consistent with in-kernel irqchip settings   KVM: x86 emulator: Allow PM/VM86 switch during task switch   KVM: SVM: Fix CPL updates   KVM: x86 emulator: VM86 segments must have DPL 3   KVM: x86 emulator: Fix task switch privilege checks   arch/powerpc/kvm/book3s_hv.c: included linux/sched.h twice   KVM: x86 emulator: correctly mask pmc index bits in RDPMC instruction emulation   KVM: mmu_notifier: Flush TLBs before releasing mmu_lock   ...
f | sigp.c | s | 10K | 366 | Jens Freimann | jfrei@linux.vnet.ibm.com | 1331208617 |  | KVM: s390: add stop_on_stop flag when doing stop and store  When we do a stop and store status we need to pass ACTION_STOP_ON_STOP flag to __sigp_stop().  Signed-off-by: Jens Freimann <jfrei@linux.vnet.ibm.com> Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | Makefile | g | 480B |  | Martin Schwidefsky | schwidefsky@de.ibm.com | 1311497301 |  | [S390] move sie code to entry.S  The entry to / exit from sie has subtle dependencies to the first level interrupt handler. Move the sie assembler code to entry64.S and replace the SIE_HOOK callback with a test and the new _TIF_SIE bit. In addition this patch fixes several problems in regard to the check for the_TIF_EXIT_SIE bits. The old code checked the TIF bits before executing the interrupt handler and it only modified the instruction address if it pointed directly to the sie instruction. In both cases it could miss a TIF bit that normally would cause an exit from the guest and would reenter the guest context.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | diag.c | s | 3.1K | 103 | Christian Borntraeger | borntraeger@de.ibm.com | 1335832711 |  | KVM: s390: use kvm_vcpu_on_spin for diag 0x44  Lets replace the old open coded version of diag 0x44 (which relied on compat_sched_yield) with kvm_vcpu_on_spin.  Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | kvm-s390.h | s | 2.8K | 78 | Cornelia Huck | cornelia.huck@de.ibm.com | 1335833752 |  | KVM: s390: Handle sckpf instruction  Handle the mandatory intercept SET CLOCK PROGRAMMABLE FIELD instruction.  Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | intercept.c | s | 6.3K | 231 | Cornelia Huck | cornelia.huck@de.ibm.com | 1335833752 |  | KVM: s390: Handle sckpf instruction  Handle the mandatory intercept SET CLOCK PROGRAMMABLE FIELD instruction.  Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | gaccess.h | s | 8.6K | 292 | Carsten Otte | cotte@de.ibm.com | 1311497301 |  | [S390] Use gmap translation for accessing guest memory  This patch removes kvm-s390 internal assumption of a linear mapping of guest address space to user space. Previously, guest memory was translated to user addresses using a fixed offset (gmsor). The new code uses gmap_fault to resolve guest addresses.  Signed-off-by: Carsten Otte <cotte@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kvm-s390.c | s | 24K | 855 | Jason J. herne | jjherne@us.ibm.com | 1337299563 |  | KVM: s390: onereg for timer related registers  Enhance the KVM ONE_REG capability within S390 to allow getting/setting the following special cpu registers: clock comparator and the cpu timer. These are needed for migration.  Signed-off-by: Jason J. herne <jjherne@us.ibm.com> Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | Kconfig | g | 1.3K |  | Carsten Otte | cotte@de.ibm.com | 1330951938 |  | KVM: s390: add parameter for KVM_CREATE_VM  This patch introduces a new config option for user controlled kernel virtual machines. It introduces a parameter to KVM_CREATE_VM that allows to set bits that alter the capabilities of the newly created virtual machine. The parameter is passed to kvm_arch_init_vm for all architectures. The only valid modifier bit for now is KVM_VM_S390_UCONTROL. This requires CAP_SYS_ADMIN privileges and creates a user controlled virtual machine on s390 architectures.  Signed-off-by: Carsten Otte <cotte@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Avi Kivity <avi@redhat.com>
