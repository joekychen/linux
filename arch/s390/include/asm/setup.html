<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › s390 › include › asm › setup.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>setup.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  include/asm-s390/setup.h</span>
<span class="cm"> *</span>
<span class="cm"> *  S390 version</span>
<span class="cm"> *    Copyright IBM Corp. 1999,2010</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _ASM_S390_SETUP_H</span>
<span class="cp">#define _ASM_S390_SETUP_H</span>

<span class="cp">#define COMMAND_LINE_SIZE	4096</span>

<span class="cp">#define ARCH_COMMAND_LINE_SIZE	896</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#define PARMAREA		0x10400</span>
<span class="cp">#define MEMORY_CHUNKS		256</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="cp">#include &lt;asm/lowcore.h&gt;</span>
<span class="cp">#include &lt;asm/types.h&gt;</span>

<span class="cp">#ifndef CONFIG_64BIT</span>
<span class="cp">#define IPL_DEVICE        (*(unsigned long *)  (0x10404))</span>
<span class="cp">#define INITRD_START      (*(unsigned long *)  (0x1040C))</span>
<span class="cp">#define INITRD_SIZE       (*(unsigned long *)  (0x10414))</span>
<span class="cp">#define OLDMEM_BASE	  (*(unsigned long *)  (0x1041C))</span>
<span class="cp">#define OLDMEM_SIZE	  (*(unsigned long *)  (0x10424))</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define IPL_DEVICE        (*(unsigned long *)  (0x10400))</span>
<span class="cp">#define INITRD_START      (*(unsigned long *)  (0x10408))</span>
<span class="cp">#define INITRD_SIZE       (*(unsigned long *)  (0x10410))</span>
<span class="cp">#define OLDMEM_BASE	  (*(unsigned long *)  (0x10418))</span>
<span class="cp">#define OLDMEM_SIZE	  (*(unsigned long *)  (0x10420))</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define COMMAND_LINE      ((char *)            (0x10480))</span>

<span class="cp">#define CHUNK_READ_WRITE 0</span>
<span class="cp">#define CHUNK_READ_ONLY  1</span>
<span class="cp">#define CHUNK_OLDMEM	 4</span>
<span class="cp">#define CHUNK_CRASHK	 5</span>

<span class="k">struct</span> <span class="n">mem_chunk</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">type</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">mem_chunk</span> <span class="n">memory_chunk</span><span class="p">[];</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">real_memory_size</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">memory_end_set</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">memory_end</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">detect_memory_layout</span><span class="p">(</span><span class="k">struct</span> <span class="n">mem_chunk</span> <span class="n">chunk</span><span class="p">[]);</span>
<span class="kt">void</span> <span class="n">create_mem_hole</span><span class="p">(</span><span class="k">struct</span> <span class="n">mem_chunk</span> <span class="n">memory_chunk</span><span class="p">[],</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">,</span>
		     <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">);</span>

<span class="cp">#define PRIMARY_SPACE_MODE	0</span>
<span class="cp">#define ACCESS_REGISTER_MODE	1</span>
<span class="cp">#define SECONDARY_SPACE_MODE	2</span>
<span class="cp">#define HOME_SPACE_MODE		3</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">user_mode</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Machine features detected in head.S</span>
<span class="cm"> */</span>

<span class="cp">#define MACHINE_FLAG_VM		(1UL &lt;&lt; 0)</span>
<span class="cp">#define MACHINE_FLAG_IEEE	(1UL &lt;&lt; 1)</span>
<span class="cp">#define MACHINE_FLAG_CSP	(1UL &lt;&lt; 3)</span>
<span class="cp">#define MACHINE_FLAG_MVPG	(1UL &lt;&lt; 4)</span>
<span class="cp">#define MACHINE_FLAG_DIAG44	(1UL &lt;&lt; 5)</span>
<span class="cp">#define MACHINE_FLAG_IDTE	(1UL &lt;&lt; 6)</span>
<span class="cp">#define MACHINE_FLAG_DIAG9C	(1UL &lt;&lt; 7)</span>
<span class="cp">#define MACHINE_FLAG_MVCOS	(1UL &lt;&lt; 8)</span>
<span class="cp">#define MACHINE_FLAG_KVM	(1UL &lt;&lt; 9)</span>
<span class="cp">#define MACHINE_FLAG_HPAGE	(1UL &lt;&lt; 10)</span>
<span class="cp">#define MACHINE_FLAG_PFMF	(1UL &lt;&lt; 11)</span>
<span class="cp">#define MACHINE_FLAG_LPAR	(1UL &lt;&lt; 12)</span>
<span class="cp">#define MACHINE_FLAG_SPP	(1UL &lt;&lt; 13)</span>
<span class="cp">#define MACHINE_FLAG_TOPOLOGY	(1UL &lt;&lt; 14)</span>

<span class="cp">#define MACHINE_IS_VM		(S390_lowcore.machine_flags &amp; MACHINE_FLAG_VM)</span>
<span class="cp">#define MACHINE_IS_KVM		(S390_lowcore.machine_flags &amp; MACHINE_FLAG_KVM)</span>
<span class="cp">#define MACHINE_IS_LPAR		(S390_lowcore.machine_flags &amp; MACHINE_FLAG_LPAR)</span>

<span class="cp">#define MACHINE_HAS_DIAG9C	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_DIAG9C)</span>

<span class="cp">#ifndef CONFIG_64BIT</span>
<span class="cp">#define MACHINE_HAS_IEEE	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_IEEE)</span>
<span class="cp">#define MACHINE_HAS_CSP		(S390_lowcore.machine_flags &amp; MACHINE_FLAG_CSP)</span>
<span class="cp">#define MACHINE_HAS_IDTE	(0)</span>
<span class="cp">#define MACHINE_HAS_DIAG44	(1)</span>
<span class="cp">#define MACHINE_HAS_MVPG	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_MVPG)</span>
<span class="cp">#define MACHINE_HAS_MVCOS	(0)</span>
<span class="cp">#define MACHINE_HAS_HPAGE	(0)</span>
<span class="cp">#define MACHINE_HAS_PFMF	(0)</span>
<span class="cp">#define MACHINE_HAS_SPP		(0)</span>
<span class="cp">#define MACHINE_HAS_TOPOLOGY	(0)</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define MACHINE_HAS_IEEE	(1)</span>
<span class="cp">#define MACHINE_HAS_CSP		(1)</span>
<span class="cp">#define MACHINE_HAS_IDTE	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_IDTE)</span>
<span class="cp">#define MACHINE_HAS_DIAG44	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_DIAG44)</span>
<span class="cp">#define MACHINE_HAS_MVPG	(1)</span>
<span class="cp">#define MACHINE_HAS_MVCOS	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_MVCOS)</span>
<span class="cp">#define MACHINE_HAS_HPAGE	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_HPAGE)</span>
<span class="cp">#define MACHINE_HAS_PFMF	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_PFMF)</span>
<span class="cp">#define MACHINE_HAS_SPP		(S390_lowcore.machine_flags &amp; MACHINE_FLAG_SPP)</span>
<span class="cp">#define MACHINE_HAS_TOPOLOGY	(S390_lowcore.machine_flags &amp; MACHINE_FLAG_TOPOLOGY)</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>

<span class="cp">#define ZFCPDUMP_HSA_SIZE	(32UL&lt;&lt;20)</span>
<span class="cp">#define ZFCPDUMP_HSA_SIZE_MAX	(64UL&lt;&lt;20)</span>

<span class="cm">/*</span>
<span class="cm"> * Console mode. Override with conmode=</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">console_mode</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">console_devno</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">console_irq</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">char</span> <span class="n">vmhalt_cmd</span><span class="p">[];</span>
<span class="k">extern</span> <span class="kt">char</span> <span class="n">vmpoff_cmd</span><span class="p">[];</span>

<span class="cp">#define CONSOLE_IS_UNDEFINED	(console_mode == 0)</span>
<span class="cp">#define CONSOLE_IS_SCLP		(console_mode == 1)</span>
<span class="cp">#define CONSOLE_IS_3215		(console_mode == 2)</span>
<span class="cp">#define CONSOLE_IS_3270		(console_mode == 3)</span>
<span class="cp">#define SET_CONSOLE_SCLP	do { console_mode = 1; } while (0)</span>
<span class="cp">#define SET_CONSOLE_3215	do { console_mode = 2; } while (0)</span>
<span class="cp">#define SET_CONSOLE_3270	do { console_mode = 3; } while (0)</span>

<span class="cp">#define NSS_NAME_SIZE	8</span>
<span class="k">extern</span> <span class="kt">char</span> <span class="n">kernel_nss_name</span><span class="p">[];</span>

<span class="cp">#ifdef CONFIG_PFAULT</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">pfault_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pfault_fini</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_PFAULT */</span><span class="cp"></span>
<span class="cp">#define pfault_init()		({-1;})</span>
<span class="cp">#define pfault_fini()		do { } while (0)</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_PFAULT */</span><span class="cp"></span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">cmma_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">_machine_restart</span><span class="p">)(</span><span class="kt">char</span> <span class="o">*</span><span class="n">command</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">_machine_halt</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">_machine_power_off</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#else </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>

<span class="cp">#ifndef CONFIG_64BIT</span>
<span class="cp">#define IPL_DEVICE        0x10404</span>
<span class="cp">#define INITRD_START      0x1040C</span>
<span class="cp">#define INITRD_SIZE       0x10414</span>
<span class="cp">#define OLDMEM_BASE	  0x1041C</span>
<span class="cp">#define OLDMEM_SIZE	  0x10424</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define IPL_DEVICE        0x10400</span>
<span class="cp">#define INITRD_START      0x10408</span>
<span class="cp">#define INITRD_SIZE       0x10410</span>
<span class="cp">#define OLDMEM_BASE	  0x10418</span>
<span class="cp">#define OLDMEM_SIZE	  0x10420</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define COMMAND_LINE      0x10480</span>

<span class="cp">#endif </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* _ASM_S390_SETUP_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
