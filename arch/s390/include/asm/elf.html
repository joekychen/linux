<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › s390 › include › asm › elf.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>elf.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  include/asm-s390/elf.h</span>
<span class="cm"> *</span>
<span class="cm"> *  S390 version</span>
<span class="cm"> *</span>
<span class="cm"> *  Derived from &quot;include/asm-i386/elf.h&quot;</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __ASMS390_ELF_H</span>
<span class="cp">#define __ASMS390_ELF_H</span>

<span class="cm">/* s390 relocations defined by the ABIs */</span>
<span class="cp">#define R_390_NONE		0	</span><span class="cm">/* No reloc.  */</span><span class="cp"></span>
<span class="cp">#define R_390_8			1	</span><span class="cm">/* Direct 8 bit.  */</span><span class="cp"></span>
<span class="cp">#define R_390_12		2	</span><span class="cm">/* Direct 12 bit.  */</span><span class="cp"></span>
<span class="cp">#define R_390_16		3	</span><span class="cm">/* Direct 16 bit.  */</span><span class="cp"></span>
<span class="cp">#define R_390_32		4	</span><span class="cm">/* Direct 32 bit.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PC32		5	</span><span class="cm">/* PC relative 32 bit.	*/</span><span class="cp"></span>
<span class="cp">#define R_390_GOT12		6	</span><span class="cm">/* 12 bit GOT offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GOT32		7	</span><span class="cm">/* 32 bit GOT offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PLT32		8	</span><span class="cm">/* 32 bit PC relative PLT address.  */</span><span class="cp"></span>
<span class="cp">#define R_390_COPY		9	</span><span class="cm">/* Copy symbol at runtime.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GLOB_DAT		10	</span><span class="cm">/* Create GOT entry.  */</span><span class="cp"></span>
<span class="cp">#define R_390_JMP_SLOT		11	</span><span class="cm">/* Create PLT entry.  */</span><span class="cp"></span>
<span class="cp">#define R_390_RELATIVE		12	</span><span class="cm">/* Adjust by program base.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTOFF32		13	</span><span class="cm">/* 32 bit offset to GOT.	 */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPC		14	</span><span class="cm">/* 32 bit PC rel. offset to GOT.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GOT16		15	</span><span class="cm">/* 16 bit GOT offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PC16		16	</span><span class="cm">/* PC relative 16 bit.	*/</span><span class="cp"></span>
<span class="cp">#define R_390_PC16DBL		17	</span><span class="cm">/* PC relative 16 bit shifted by 1.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PLT16DBL		18	</span><span class="cm">/* 16 bit PC rel. PLT shifted by 1.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PC32DBL		19	</span><span class="cm">/* PC relative 32 bit shifted by 1.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PLT32DBL		20	</span><span class="cm">/* 32 bit PC rel. PLT shifted by 1.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPCDBL		21	</span><span class="cm">/* 32 bit PC rel. GOT shifted by 1.  */</span><span class="cp"></span>
<span class="cp">#define R_390_64		22	</span><span class="cm">/* Direct 64 bit.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PC64		23	</span><span class="cm">/* PC relative 64 bit.	*/</span><span class="cp"></span>
<span class="cp">#define R_390_GOT64		24	</span><span class="cm">/* 64 bit GOT offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PLT64		25	</span><span class="cm">/* 64 bit PC relative PLT address.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTENT		26	</span><span class="cm">/* 32 bit PC rel. to GOT entry &gt;&gt; 1. */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTOFF16		27	</span><span class="cm">/* 16 bit offset to GOT. */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTOFF64		28	</span><span class="cm">/* 64 bit offset to GOT. */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPLT12		29	</span><span class="cm">/* 12 bit offset to jump slot.	*/</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPLT16		30	</span><span class="cm">/* 16 bit offset to jump slot.	*/</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPLT32		31	</span><span class="cm">/* 32 bit offset to jump slot.	*/</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPLT64		32	</span><span class="cm">/* 64 bit offset to jump slot.	*/</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPLTENT		33	</span><span class="cm">/* 32 bit rel. offset to jump slot.  */</span><span class="cp"></span>
<span class="cp">#define R_390_PLTOFF16		34	</span><span class="cm">/* 16 bit offset from GOT to PLT. */</span><span class="cp"></span>
<span class="cp">#define R_390_PLTOFF32		35	</span><span class="cm">/* 32 bit offset from GOT to PLT. */</span><span class="cp"></span>
<span class="cp">#define R_390_PLTOFF64		36	</span><span class="cm">/* 16 bit offset from GOT to PLT. */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LOAD		37	</span><span class="cm">/* Tag for load insn in TLS code. */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_GDCALL	38	</span><span class="cm">/* Tag for function call in general</span>
<span class="cm">                                           dynamic TLS code.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LDCALL	39	</span><span class="cm">/* Tag for function call in local</span>
<span class="cm">                                           dynamic TLS code.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_GD32		40	</span><span class="cm">/* Direct 32 bit for general dynamic</span>
<span class="cm">                                           thread local data.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_GD64		41	</span><span class="cm">/* Direct 64 bit for general dynamic</span>
<span class="cm">                                           thread local data.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_GOTIE12	42	</span><span class="cm">/* 12 bit GOT offset for static TLS</span>
<span class="cm">                                           block offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_GOTIE32	43	</span><span class="cm">/* 32 bit GOT offset for static TLS</span>
<span class="cm">                                           block offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_GOTIE64	44	</span><span class="cm">/* 64 bit GOT offset for static TLS</span>
<span class="cm">                                           block offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LDM32		45	</span><span class="cm">/* Direct 32 bit for local dynamic</span>
<span class="cm">                                           thread local data in LD code.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LDM64		46	</span><span class="cm">/* Direct 64 bit for local dynamic</span>
<span class="cm">                                           thread local data in LD code.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_IE32		47	</span><span class="cm">/* 32 bit address of GOT entry for</span>
<span class="cm">                                           negated static TLS block offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_IE64		48	</span><span class="cm">/* 64 bit address of GOT entry for</span>
<span class="cm">                                           negated static TLS block offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_IEENT		49	</span><span class="cm">/* 32 bit rel. offset to GOT entry for</span>
<span class="cm">                                           negated static TLS block offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LE32		50	</span><span class="cm">/* 32 bit negated offset relative to</span>
<span class="cm">                                           static TLS block.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LE64		51	</span><span class="cm">/* 64 bit negated offset relative to</span>
<span class="cm">                                           static TLS block.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LDO32		52	</span><span class="cm">/* 32 bit offset relative to TLS</span>
<span class="cm">                                           block.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_LDO64		53	</span><span class="cm">/* 64 bit offset relative to TLS</span>
<span class="cm">                                           block.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_DTPMOD	54	</span><span class="cm">/* ID of module containing symbol.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_DTPOFF	55	</span><span class="cm">/* Offset in TLS block.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_TPOFF		56	</span><span class="cm">/* Negate offset in static TLS</span>
<span class="cm">                                           block.  */</span><span class="cp"></span>
<span class="cp">#define R_390_20		57	</span><span class="cm">/* Direct 20 bit.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GOT20		58	</span><span class="cm">/* 20 bit GOT offset.  */</span><span class="cp"></span>
<span class="cp">#define R_390_GOTPLT20		59	</span><span class="cm">/* 20 bit offset to jump slot.  */</span><span class="cp"></span>
<span class="cp">#define R_390_TLS_GOTIE20	60	</span><span class="cm">/* 20 bit GOT offset for static TLS</span>
<span class="cm">					   block offset.  */</span><span class="cp"></span>
<span class="cm">/* Keep this the last entry.  */</span>
<span class="cp">#define R_390_NUM	61</span>

<span class="cm">/* Bits present in AT_HWCAP. */</span>
<span class="cp">#define HWCAP_S390_ESAN3	1</span>
<span class="cp">#define HWCAP_S390_ZARCH	2</span>
<span class="cp">#define HWCAP_S390_STFLE	4</span>
<span class="cp">#define HWCAP_S390_MSA		8</span>
<span class="cp">#define HWCAP_S390_LDISP	16</span>
<span class="cp">#define HWCAP_S390_EIMM		32</span>
<span class="cp">#define HWCAP_S390_DFP		64</span>
<span class="cp">#define HWCAP_S390_HPAGE	128</span>
<span class="cp">#define HWCAP_S390_ETF3EH	256</span>
<span class="cp">#define HWCAP_S390_HIGH_GPRS	512</span>

<span class="cm">/*</span>
<span class="cm"> * These are used to set parameters in the core dumps.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef CONFIG_64BIT</span>
<span class="cp">#define ELF_CLASS	ELFCLASS32</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define ELF_CLASS	ELFCLASS64</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define ELF_DATA	ELFDATA2MSB</span>
<span class="cp">#define ELF_ARCH	EM_S390</span>

<span class="cm">/*</span>
<span class="cm"> * ELF register definitions..</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;asm/ptrace.h&gt;</span>
<span class="cp">#include &lt;asm/user.h&gt;</span>

<span class="k">typedef</span> <span class="n">s390_fp_regs</span> <span class="n">elf_fpregset_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">s390_regs</span> <span class="n">elf_gregset_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="n">s390_fp_regs</span> <span class="n">compat_elf_fpregset_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">s390_compat_regs</span> <span class="n">compat_elf_gregset_t</span><span class="p">;</span>

<span class="cp">#include &lt;linux/sched.h&gt;	</span><span class="cm">/* for task_struct */</span><span class="cp"></span>
<span class="cp">#include &lt;asm/mmu_context.h&gt;</span>

<span class="cp">#include &lt;asm/vdso.h&gt;</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vdso_enabled</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * This is used to ensure we don&#39;t load something for the wrong architecture.</span>
<span class="cm"> */</span>
<span class="cp">#define elf_check_arch(x) \</span>
<span class="cp">	(((x)-&gt;e_machine == EM_S390 || (x)-&gt;e_machine == EM_S390_OLD) \</span>
<span class="cp">         &amp;&amp; (x)-&gt;e_ident[EI_CLASS] == ELF_CLASS) </span>
<span class="cp">#define compat_elf_check_arch(x) \</span>
<span class="cp">	(((x)-&gt;e_machine == EM_S390 || (x)-&gt;e_machine == EM_S390_OLD) \</span>
<span class="cp">	 &amp;&amp; (x)-&gt;e_ident[EI_CLASS] == ELF_CLASS)</span>
<span class="cp">#define compat_start_thread	start_thread31</span>

<span class="cm">/* For SVR4/S390 the function pointer to be registered with `atexit` is</span>
<span class="cm">   passed in R14. */</span>
<span class="cp">#define ELF_PLAT_INIT(_r, load_addr) \</span>
<span class="cp">	do { \</span>
<span class="cp">		_r-&gt;gprs[14] = 0; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define CORE_DUMP_USE_REGSET</span>
<span class="cp">#define ELF_EXEC_PAGESIZE	4096</span>

<span class="cm">/* This is the location that an ET_DYN program is loaded if exec&#39;ed.  Typical</span>
<span class="cm">   use of this is to invoke &quot;./ld.so someprog&quot; to test out a new version of</span>
<span class="cm">   the loader.  We need to make sure that it is out of the way of the program</span>
<span class="cm">   that it will &quot;exec&quot;, and that there is sufficient room for the brk.  */</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">randomize_et_dyn</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">base</span><span class="p">);</span>
<span class="cp">#define ELF_ET_DYN_BASE		(randomize_et_dyn(STACK_TOP / 3 * 2))</span>

<span class="cm">/* This yields a mask that user programs can use to figure out what</span>
<span class="cm">   instruction set this CPU supports. */</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_hwcap</span><span class="p">;</span>
<span class="cp">#define ELF_HWCAP (elf_hwcap)</span>

<span class="cm">/* This yields a string that ld.so will use to load implementation</span>
<span class="cm">   specific libraries for optimization.  This is more specific in</span>
<span class="cm">   intent than poking at uname or /proc/cpuinfo.</span>

<span class="cm">   For the moment, we have only optimizations for the Intel generations,</span>
<span class="cm">   but that could change... */</span>

<span class="cp">#define ELF_PLATFORM_SIZE 8</span>
<span class="k">extern</span> <span class="kt">char</span> <span class="n">elf_platform</span><span class="p">[];</span>
<span class="cp">#define ELF_PLATFORM (elf_platform)</span>

<span class="cp">#ifndef CONFIG_64BIT</span>
<span class="cp">#define SET_PERSONALITY(ex) set_personality(PER_LINUX)</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define SET_PERSONALITY(ex)					\</span>
<span class="cp">do {								\</span>
<span class="cp">	if (personality(current-&gt;personality) != PER_LINUX32)	\</span>
<span class="cp">		set_personality(PER_LINUX |			\</span>
<span class="cp">			(current-&gt;personality &amp; ~PER_MASK));	\</span>
<span class="cp">	if ((ex).e_ident[EI_CLASS] == ELFCLASS32)		\</span>
<span class="cp">		set_thread_flag(TIF_31BIT);			\</span>
<span class="cp">	else							\</span>
<span class="cp">		clear_thread_flag(TIF_31BIT);			\</span>
<span class="cp">} while (0)</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>

<span class="cp">#define STACK_RND_MASK	0x7ffUL</span>

<span class="cp">#define ARCH_DLINFO							    \</span>
<span class="cp">do {									    \</span>
<span class="cp">	if (vdso_enabled)						    \</span>
<span class="cp">		NEW_AUX_ENT(AT_SYSINFO_EHDR,				    \</span>
<span class="cp">			    (unsigned long)current-&gt;mm-&gt;context.vdso_base); \</span>
<span class="cp">} while (0)</span>

<span class="k">struct</span> <span class="n">linux_binprm</span><span class="p">;</span>

<span class="cp">#define ARCH_HAS_SETUP_ADDITIONAL_PAGES 1</span>
<span class="kt">int</span> <span class="n">arch_setup_additional_pages</span><span class="p">(</span><span class="k">struct</span> <span class="n">linux_binprm</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arch_randomize_brk</span><span class="p">(</span><span class="k">struct</span> <span class="n">mm_struct</span> <span class="o">*</span><span class="n">mm</span><span class="p">);</span>
<span class="cp">#define arch_randomize_brk arch_randomize_brk</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
