f | io.h | s | 989B | 39 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kmap_types.h | s | 97B | 4 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kvm_para.h | s | 4.6K | 136 | Eric B Munson | emunson@mgebm.net | 1333878539 |  | kvmclock: Add functions to check if the host has stopped the vm  When a host stops or suspends a VM it will set a flag to show this.  The watchdog will use these functions to determine if a softlockup is real, or the result of a suspended VM.  Signed-off-by: Eric B Munson <emunson@mgebm.net> asm-generic changes Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | cpcmd.h | s | 1.2K | 30 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | cputime.h | s | 4.6K | 159 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | compat.h | s | 5.3K | 211 | Heiko Carstens | heiko.carstens@de.ibm.com | 1330358067 |  | compat: fix compile breakage on s390  The new is_compat_task() define for the !COMPAT case in include/linux/compat.h conflicts with a similar define in arch/s390/include/asm/compat.h.  This is the minimal patch which fixes the build issues.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | reset.h | s | 492B | 17 | Michael Holzheu | holzheu@linux.vnet.ibm.com | 1319984202 |  | [S390] kdump backend code  This patch provides the architecture specific part of the s390 kdump support.  Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | pci.h | s | 255B | 7 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | debug.h | s | 8.2K | 215 | Michael Holzheu | holzheu@linux.vnet.ibm.com | 1331481569 |  | [S390] kernel: Add z/VM LGR detection  Currently the following mechanisms are available to move active Linux on System z instances between machines: * z/VM 6.2 SSI (Single System Image) * Suspend/resume For moving Linux instances in this patch the term LGR (Linux Guest Relocation) is used. Because such an operation is critical, it should be detectable from Linux. With this patch for both, a live system and a kernel dump, the information about LGRs is accessible. To identify a guest, stsi and stfle data is used. A new function lgr_info_log() compares the current data (lgr_info_cur) with the last recorded one (lgr_info_last). In case the two data sets differ, lgr_info_cur is logged to the "lgr" s390dbf.  The following trigger points call lgr_info_log(): * panic * die * kdump * LGR timer * PSW restart * QDIO recovery * resume  This patch also changes the s390dbf hex_ascii view. Now only printable ASCII characters are shown.  Reviewed-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | appldata.h | s | 2.2K | 77 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | sections.h | s | 128B | 5 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ebcdic.h | s | 1.5K | 42 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | barrier.h | s | 891B | 32 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337172165 |  | s390/barrier: make use of fast-bcr facility  If the kernel gets compiled for at least z196, make use of the fast-BCR facility.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | sclp.h | s | 1.3K | 49 | Christian Borntraeger | borntraeger@de.ibm.com | 1337299561 |  | KVM: s390: add capability indicating COW support  Currently qemu/kvm on s390 uses a guest mapping that does not allow the guest backing page table to be write-protected to support older systems. On those older systems a host write protection fault will be delivered to the guest.  Newer systems allow to write-protect the guest backing memory and let the fault be delivered to the host, thus allowing COW.  Use a capability bit to tell qemu if that is possible.  Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Acked-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | cpu.h | s | 538B | 20 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1288015819 |  | [S390] correct alignment of cpuid structure  The store-cpu-id instruction has a minimum alignment of 8. Reflect that in the definition of struct cpuid.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | irq_regs.h | s | 34B | 1 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | delay.h | s | 758B | 22 | Heiko Carstens | heiko.carstens@de.ibm.com | 1306396105 |  | [S390] delay: implement ndelay  Implement ndelay() on s390 as well.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | isc.h | s | 803B | 21 | Felix Beck | felix.beck@de.ibm.com | 1230208737 |  | [S390] zcrypt: Use of Thin Interrupts  When the machine supports AP adapter interrupts polling will be switched off at module initialization and the driver will work in interrupt mode.  Signed-off-by: Felix Beck <felix.beck@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | etr.h | s | 7.4K | 230 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1267220250 |  | [S390] use inline assembly contraints available with gcc 3.3.3  Drop support to compile the kernel with gcc versions older than 3.3.3. This allows us to use the "Q" inline assembly contraint on some more inline assemblies without duplicating a lot of complex code (e.g. __xchg and __cmpxchg). The distinction for older gcc versions can be removed which saves a few lines and simplifies the code.  Reviewed-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | zcrypt.h | s | 9.3K | 264 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | cacheflush.h | s | 486B | 12 | Jan Glauber | jang@linux.vnet.ibm.com | 1305789926 |  | module: undo module RONX protection correctly.  While debugging I stumbled over two problems in the code that protects module pages.  First issue is that disabling the protection before freeing init or unload of a module is not symmetric with the enablement. For instance, if pages are set to RO the page range from module_core to module_core + core_ro_size is protected. If a module is unloaded the page range from module_core to module_core + core_size is set back to RW. So pages that were not set to RO are also changed to RW. This is not critical but IMHO it should be symmetric.  Second issue is that while set_memory_rw & set_memory_ro are used for RO/RW changes only set_memory_nx is involved for NX/X. One would await that the inverse function is called when the NX protection should be removed, which is not the case here, unless I'm missing something.  Signed-off-by: Jan Glauber <jang@linux.vnet.ibm.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | cpu_mf.h | s | 2.3K | 83 | Heiko Carstens | h.carstens@de.ibm.com | 1333093272 |  | [S390] Fix build errors (fallout from system.h disintegration)  Signed-off-by: Heiko Carstens <h.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | vtoc.h | s | 7.3K | 197 | Stefan Weinhuber | wein@de.ibm.com | 1238077445 |  | [S390] dasd: add large volume support  The dasd device driver will now support ECKD devices with more then 65520 cylinders. In the traditional ECKD adressing scheme each track is addressed by a 16-bit cylinder and 16-bit head number. The new addressing scheme makes use of the fact that the actual number of heads is never larger then 15, so 12 bits of the head number can be redefined to be part of the cylinder address.  Signed-off-by: Stefan Weinhuber <wein@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | fcx.h | s | 7.8K | 281 | Peter Oberparleiter | peter.oberparleiter@de.ibm.com | 1230208746 |  | [S390] cio: update sac values  Values for the sac field have changed - update code accordingly.  Signed-off-by: Peter Oberparleiter <peter.oberparleiter@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | timer.h | s | 1.2K | 40 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | current.h | s | 444B | 15 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | schid.h | s | 688B | 27 | Heiko Carstens | heiko.carstens@de.ibm.com | 1231499706 |  | [S390] types: add/fix types.h include in header files  /include/asm/chpid.h:12: include of <linux/types.h> is preferred over <asm/types.h> /include/asm/chsc.h:15: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/cmb.h:28: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/dasd.h:195: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/kvm.h:16: include of <linux/types.h> is preferred over <asm/types.h> /include/asm/kvm.h:30: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/qeth.h:24: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/schid.h:5: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/swab.h:12: include of <linux/types.h> is preferred over <asm/types.h> /include/asm/swab.h:19: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | segment.h | s | 54B | 3 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | elf.h | s | 8.2K | 188 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ipl.h | s | 3.3K | 146 | Michael Holzheu | holzheu@linux.vnet.ibm.com | 1331481569 |  | [S390] kernel: Add z/VM LGR detection  Currently the following mechanisms are available to move active Linux on System z instances between machines: * z/VM 6.2 SSI (Single System Image) * Suspend/resume For moving Linux instances in this patch the term LGR (Linux Guest Relocation) is used. Because such an operation is critical, it should be detectable from Linux. With this patch for both, a live system and a kernel dump, the information about LGRs is accessible. To identify a guest, stsi and stfle data is used. A new function lgr_info_log() compares the current data (lgr_info_cur) with the last recorded one (lgr_info_last). In case the two data sets differ, lgr_info_cur is logged to the "lgr" s390dbf.  The following trigger points call lgr_info_log(): * panic * die * kdump * LGR timer * PSW restart * QDIO recovery * resume  This patch also changes the s390dbf hex_ascii view. Now only printable ASCII characters are shown.  Reviewed-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | seccomp.h | s | 443B | 12 | Heiko Carstens | heiko.carstens@de.ibm.com | 1244795251 |  | [S390] secure computing arch backend  Enable secure computing on s390 as well.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | local64.h | s | 33B | 1 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1276074756 |  | arch: Implement local64_t  On 64bit, local_t is of size long, and thus we make local64_t an alias. On 32bit, we fall back to atomic64_t. (architecture can provide optimized 32-bit version)  (This new facility is to be used by perf events optimizations.)  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: linux-arch@vger.kernel.org Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> LKML-Reference: <new-submission> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | tlb.h | s | 4.1K | 126 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | vdso.h | s | 1.2K | 37 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | resource.h | s | 205B | 11 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | unaligned.h | s | 310B | 10 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ucontext.h | s | 652B | 28 | Heiko Carstens | heiko.carstens@de.ibm.com | 1254818110 |  | [S390] 64-bit register support for 31-bit processes  From: Heiko Carstens <heiko.carstens@de.ibm.com> From: Martin Schwidefsky <schwidefsky@de.ibm.com>  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | termios.h | s | 1.6K | 55 | Arnd Bergmann | arnd@arndb.de | 1244746912 |  | asm-generic: rename termios.h, signal.h and mman.h  The existing asm-generic versions are incomplete and included by some architectures. New architectures should be able to use a generic version, so rename the existing files and change all users, which lets us add the new files.  Signed-off-by: Remis Lima Baima <remis.developer@googlemail.com> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | crw.h | s | 2.0K | 58 | Sebastian Ott | sebott@linux.vnet.ibm.com | 1267220249 |  | [S390] cio: wait for channel report  To fetch a pending channel report word (crw) we use a kernel thread which triggers stcrw and sleeps on a semaphore. The s390 machine check handler uses crw_handle_channel_report to handle one crw if needed.  This patch replaces the semaphore with a waitqueue (to block the kernel thread) and an atomic_t (to count the number of pending requests).  By this we achieve the ability to force this thread to check for a pending crw (independent on when it is triggered by the machine check handler) and wait for this action to finish.  Signed-off-by: Sebastian Ott <sebott@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | bitsperlong.h | s | 230B | 9 | Arnd Bergmann | arnd@arndb.de | 1244746934 |  | asm-generic: introduce asm/bitsperlong.h  This provides a reliable way for asm-generic/types.h and other files to find out if it is running on a 32 or 64 bit platform.  We cannot use CONFIG_64BIT for this in headers that are included from user space because CONFIG symbols are not available there. We also cannot do it inside of asm/types.h because some headers need the word size but cannot include types.h.  The solution is to introduce a new header <asm/bitsperlong.h> that defines both __BITS_PER_LONG for user space and BITS_PER_LONG for usage in the kernel. The asm-generic version falls back to 32 bit unless the architecture overrides it, which I did for all 64 bit platforms.  Signed-off-by: Remis Lima Baima <remis.developer@googlemail.com> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | smp.h | s | 1.7K | 49 | Thomas Gleixner | tglx@linutronix.de | 1335434769 |  | smp: Add task_struct argument to __cpu_up()  Preparatory patch to make the idle thread allocation for secondary cpus generic.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Rusty Russell <rusty@rustcorp.com.au> Cc: Paul E. McKenney <paulmck@linux.vnet.ibm.com> Cc: Srivatsa S. Bhat <srivatsa.bhat@linux.vnet.ibm.com> Cc: Matt Turner <mattst88@gmail.com> Cc: Russell King <linux@arm.linux.org.uk> Cc: Mike Frysinger <vapier@gentoo.org> Cc: Jesper Nilsson <jesper.nilsson@axis.com> Cc: Richard Kuo <rkuo@codeaurora.org> Cc: Tony Luck <tony.luck@intel.com> Cc: Hirokazu Takata <takata@linux-m32r.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: David Howells <dhowells@redhat.com> Cc: James E.J. Bottomley <jejb@parisc-linux.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Cc: David S. Miller <davem@davemloft.net> Cc: Chris Metcalf <cmetcalf@tilera.com> Cc: Richard Weinberger <richard@nod.at> Cc: x86@kernel.org Link: http://lkml.kernel.org/r/20120420124556.964170564@linutronix.de
f | os_info.h | s | 1.1K | 42 | Michael Holzheu | holzheu@linux.vnet.ibm.com | 1337785610 |  | s390/kernel: Remove OS info init function call and diag 308 for kdump  Because of a design change for stand-alone kdump the function that was done by the OS info init function is moved to the boot loader code. This has two implications that are implemented by this patch: a) The OS info init function is no longer called by the kernel b) The diag 308 subcode 1 reset is no longer done by the kdump boot code.    This is necessary because otherwise the operation that is done now    by the boot loader would be reversed. For the normal kexec based    kdump mechansim the reset is already done by the kdump trigger code    (e.g. panic or PSW restart).  Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ioctls.h | s | 128B | 5 | Jeff Mahoney | jeffm@suse.com | 1287768001 |  | ioctl: Use asm-generic/ioctls.h on s390 (enables termiox)  This patch converts s390 to use asm-generic/ioctls.h instead of its own version.  The differences between the arch-specific version and the generic version are as follows:  - S390 defines its own value for FIOQSIZE, asm-generic/ioctls.h keeps it - The generic version adds TIOCGRS485 and TIOCGRS485, which are unused   by any driver available on this architecture - The generic version adds support for termiox  Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Jeff Mahoney <jeffm@suse.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | siginfo.h | s | 273B | 14 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | facility.h | s | 1.6K | 53 | Michael Holzheu | holzheu@linux.vnet.ibm.com | 1334147306 |  | [S390] Fix stfle() lowcore protection problem  The stfle() function writes into lowcore memory when stfl_fac_list is initialized with "S390_lowcore.stfl_fac_list = 0". For older compilers this triggers a lowcore exception. With newer compilers and "-OXX" compile option the bug does not show up because the "S390_lowcore.stfl_fac_list" initialization is removed by the compiler. The reason for thatis the incorrect "=m" (S390_lowcore.stfl_fac_list) constraint in the stfl inline assembly.  The following shows the disassembly of the stfle() optimized code that is inlined in the lgr_info_get() function:  000000000011325c <lgr_info_get>:   11325c:       eb 9f f0 60 00 24       stmg    %r9,%r15,96(%r15)   113262:       c0 d0 00 29 0e 47       larl    %r13,634ef0 <servi..>   113268:       a7 f1 3f c0             tml     %r15,16320   11326c:       b9 04 00 ef             lgr     %r14,%r15   113270:       a7 84 00 01             je      113272 <lgr_info_g..>   113274:       a7 fb ff c0             aghi    %r15,-64   113278:       b9 04 00 c2             lgr     %r12,%r2   11327c:       a7 29 00 01             lghi    %r2,1   113280:       e3 e0 f0 98 00 24       stg     %r14,152(%r15)   113286:       d7 97 c0 00 c0 00       xc      0(152,%r12),0(%r12)   11328c:       c0 e5 00 28 db 4c       brasl   %r14,62e924 <add_e..>   113292:       b2 b1 00 00             stfl    0  To fix the problem we now clear the S390_lowcore.stfl_fac_list at startup in "head.S" for all machine types before lowcore protection is enabled.  In addition to that the "=m" constraint is replaced by "+m".  Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kvm_host.h | s | 6.5K | 233 | Konstantin Weitz | WEITZKON@de.ibm.com | 1335832711 |  | KVM: s390: Implement the directed yield (diag 9c) hypervisor call for KVM  This patch implements the directed yield hypercall found on other System z hypervisors. It delegates execution time to the virtual cpu specified in the instruction's parameter.  Useful to avoid long spinlock waits in the guest.  Christian Borntraeger: moved common code in virt/kvm/  Signed-off-by: Konstantin Weitz <WEITZKON@de.ibm.com> Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | ccwdev.h | s | 7.7K | 197 | Peter Oberparleiter | peter.oberparleiter@de.ibm.com | 1319984175 |  | [S390] fix mismatch in summation of I/O IRQ statistics  Current IRQ statistics support does not show detail counts for I/O interrupts which are processed internally only. The result is a summation count which is way off such as this one:             CPU0       CPU1       CPU2 I/O:       1331        710        442 [...] QAI:         15         16         16   [I/O] QDIO Adapter Interrupt QDI:          1          0          0   [I/O] QDIO Interrupt DAS:        706        645        381   [I/O] DASD C15:         26         10          0   [I/O] 3215 C70:          0          0          0   [I/O] 3270 TAP:          0          0          0   [I/O] Tape VMR:          0          0          0   [I/O] Unit Record Devices LCS:          0          0          0   [I/O] LCS CLW:          0          0          0   [I/O] CLAW CTC:          0          0          0   [I/O] CTC APB:          0          0          0   [I/O] AP Bus  Fix this by moving I/O interrupt accounting into the common I/O layer.  Signed-off-by: Peter Oberparleiter <peter.oberparleiter@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | monwriter.h | s | 915B | 28 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | types.h | s | 782B | 34 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | cmb.h | s | 2.1K | 56 | Heiko Carstens | heiko.carstens@de.ibm.com | 1231499706 |  | [S390] types: add/fix types.h include in header files  /include/asm/chpid.h:12: include of <linux/types.h> is preferred over <asm/types.h> /include/asm/chsc.h:15: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/cmb.h:28: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/dasd.h:195: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/kvm.h:16: include of <linux/types.h> is preferred over <asm/types.h> /include/asm/kvm.h:30: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/qeth.h:24: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/schid.h:5: found __[us]{8,16,32,64} type without #include <linux/types.h> /include/asm/swab.h:12: include of <linux/types.h> is preferred over <asm/types.h> /include/asm/swab.h:19: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | bugs.h | s | 477B | 20 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | scsw.h | s | 23K | 886 | Heiko Carstens | heiko.carstens@de.ibm.com | 1252657776 |  | [S390] cio: move scsw helper functions to header file  All scsw helper functions are very short and usage of them shouldn't result in function calls. Therefore we move them to a separate header file. Also saves a lot of EXPORT_SYMBOLs.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | bitops.h | s | 21K | 744 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kvm_virtio.h | s | 1.7K | 54 | Alexander Graf | agraf@suse.de | 1287910289 |  | KVM: S390: Add virtio hotplug add support  The one big missing feature in s390-virtio was hotplugging. This is no more. This patch implements hotplug add support, so you can on the fly add new devices in the guest.  Keep in mind that this needs a patch for qemu to actually leverage the functionality.  Signed-off-by: Alexander Graf <agraf@suse.de> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | sparsemem.h | s | 325B | 12 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1324981630 |  | [S390] add support for physical memory > 4TB  The kernel address space of a 64 bit kernel currently uses a three level page table and the vmemmap array has a fixed address and a fixed maximum size. A three level page table is good enough for systems with less than 3.8TB of memory, for bigger systems four page table levels need to be used. Each page table level costs a bit of performance, use 3 levels for normal systems and 4 levels only for the really big systems. To avoid bloating sparse.o too much set MAX_PHYSMEM_BITS to 46 for a maximum of 64TB of memory.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kdebug.h | s | 347B | 22 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1324981632 |  | [S390] cleanup trap handling  Move the program interruption code and the translation exception identifier to the pt_regs structure as 'int_code' and 'int_parm_long' and make the first level interrupt handler in entry[64].S store the two values. That makes it possible to drop 'prot_addr' and 'trap_no' from the thread_struct and to reduce the number of arguments to a lot of functions. Finally un-inline do_trap. Overall this saves 5812 bytes in the .text section of the 64 bit kernel.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | setup.h | s | 5.2K | 143 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kprobes.h | s | 2.6K | 74 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1294228044 |  | [S390] kprobes: jprobe save and restore  Register %r14 and %r15 are already stored in jprobe_saved_regs, no need to store them a second time in jprobe_saved_r14 / jprobe_saved_r15.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | checksum.h | s | 3.5K | 125 | Heiko Carstens | heiko.carstens@de.ibm.com | 1252657783 |  | [S390] convert/optimize csum_fold() to C  In the meantime gcc generates better code than the old inline assemblies do. Original inline assembly results in:  lr	%r1,%r2 sr	%r3,%r3 lr	%r2,%r1 srdl	%r2,16 alr	%r2,%r3 alr	%r1,%r2 srl	%r1,16 xilf	%r1,65535 llghr	%r2,%r1 br	%r14  Out of the C code gcc generates this:  rll	%r1,%r2,16 ar	%r1,%r2 srl	%r1,16 xilf	%r1,65535 llghr	%r2,%r1 br	%r14  In addition we don't have any static register allocations anymore and gcc is free to shuffle instructions around for better pipeline usage.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | dma.h | s | 241B | 11 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | mmu_context.h | s | 2.7K | 85 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ptrace.h | s | 14K | 496 | Eric Paris | eparis@redhat.com | 1326835016 |  | Audit: push audit success and retcode into arch ptrace.h  The audit system previously expected arches calling to audit_syscall_exit to supply as arguments if the syscall was a success and what the return code was. Audit also provides a helper AUDITSC_RESULT which was supposed to simplify things by converting from negative retcodes to an audit internal magic value stating success or failure.  This helper was wrong and could indicate that a valid pointer returned to userspace was a failed syscall.  The fix is to fix the layering foolishness.  We now pass audit_syscall_exit a struct pt_reg and it in turns calls back into arch code to collect the return value and to determine if the syscall was a success or failure.  We also define a generic is_syscall_success() macro which determines success/failure based on if the value is < -MAX_ERRNO.  This works for arches like x86 which do not use a separate mechanism to indicate syscall failure.  We make both the is_syscall_success() and regs_return_value() static inlines instead of macros.  The reason is because the audit function must take a void* for the regs.  (uml calls theirs struct uml_pt_regs instead of just struct pt_regs so audit_syscall_exit can't take a struct pt_regs).  Since the audit function takes a void* we need to use static inlines to cast it back to the arch correct structure to dereference it.  The other major change is that on some arches, like ia64, MIPS and ppc, we change regs_return_value() to give us the negative value on syscall failure. THE only other user of this macro, kretprobe_example.c, won't notice and it makes the value signed consistently for the audit functions across all archs.  In arch/sh/kernel/ptrace_64.c I see that we were using regs[9] in the old audit code as the return value.  But the ptrace_64.h code defined the macro regs_return_value() as regs[3].  I have no idea which one is correct, but this patch now uses the regs_return_value() function, so it now uses regs[3].  For powerpc we previously used regs->result but now use the regs_return_value() function which uses regs->gprs[3].  regs->gprs[3] is always positive so the regs_return_value(), much like ia64 makes it negative before calling the audit code when appropriate.  Signed-off-by: Eric Paris <eparis@redhat.com> Acked-by: H. Peter Anvin <hpa@zytor.com> [for x86 portion] Acked-by: Tony Luck <tony.luck@intel.com> [for ia64] Acked-by: Richard Weinberger <richard@nod.at> [for uml] Acked-by: David S. Miller <davem@davemloft.net> [for sparc] Acked-by: Ralf Baechle <ralf@linux-mips.org> [for mips] Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> [for ppc]
f | jump_label.h | s | 665B | 30 | Ingo Molnar | mingo@elte.hu | 1330074359 |  | static keys: Introduce 'struct static_key', static_key_true()/false() and static_key_slow_[inc||dec]()  So here's a boot tested patch on top of Jason's series that does all the cleanups I talked about and turns jump labels into a more intuitive to use facility. It should also address the various misconceptions and confusions that surround jump labels.  Typical usage scenarios:          #include <linux/static_key.h>          struct static_key key = STATIC_KEY_INIT_TRUE;          if (static_key_false(&key))                 do unlikely code         else                 do likely code  Or:          if (static_key_true(&key))                 do likely code         else                 do unlikely code  The static key is modified via:          static_key_slow_inc(&key);         ...         static_key_slow_dec(&key);  The 'slow' prefix makes it abundantly clear that this is an expensive operation.  I've updated all in-kernel code to use this everywhere. Note that I (intentionally) have not pushed through the rename blindly through to the lowest levels: the actual jump-label patching arch facility should be named like that, so we want to decouple jump labels from the static-key facility a bit.  On non-jump-label enabled architectures static keys default to likely()/unlikely() branches.  Signed-off-by: Ingo Molnar <mingo@elte.hu> Acked-by: Jason Baron <jbaron@redhat.com> Acked-by: Steven Rostedt <rostedt@goodmis.org> Cc: a.p.zijlstra@chello.nl Cc: mathieu.desnoyers@efficios.com Cc: davem@davemloft.net Cc: ddaney.cavm@gmail.com Cc: Linus Torvalds <torvalds@linux-foundation.org> Link: http://lkml.kernel.org/r/20120222085809.GA26397@elte.hu Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | errno.h | s | 144B | 10 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ftrace.h | s | 407B | 17 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1305572706 |  | ftrace/s390: mcount offset calculation  Do the mcount offset adjustment in the recordmcount.pl/recordmcount.[ch] at compile time and not in ftrace_call_adjust at run time.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com> Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
f | cache.h | s | 445B | 16 | Horst Hartmann | horsth@linux.vnet.ibm.com | 1297944839 |  | [S390] net: provide architecture specific NET_SKB_PAD  NET_SKB_PAD has been increased from 32 to 64 and later to max(32, L1_CACHE_BYTES). This led to a 25% throughput decrease for streaming workloads accompanied by a 37% CPU cost increase on s390. Define a architecture specific NET_SKB_PAD with the old value of 32.  Signed-off-by: Horst Hartmann <horsth@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | chpid.h | s | 1022B | 44 | David Howells | dhowells@redhat.com | 1323768405 |  | UAPI: Alter the S390 asm include guards to be recognisable by the UAPI splitter  Alter some of the S390 asm include guards to fit a pattern that the UAPI splitter recognises.  Signed-off-by: David Howells <dhowells@redhat.com>
f | user.h | s | 3.3K | 70 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | cio.h | s | 7.0K | 265 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | statfs.h | s | 1.1K | 64 | Christoph Hellwig | hch@lst.de | 1281386924 |  | add f_flags to struct statfs(64)  Add a flags field to help glibc implementing statvfs(3) efficiently.  We copy the flag values from glibc, and add a new ST_VALID flag to denote that f_flags is implemented.  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | nmi.h | s | 2.3K | 60 | Heiko Carstens | heiko.carstens@de.ibm.com | 1238077450 |  | [S390] split/move machine check handler code  Split machine check handler code and move it to cio and kernel code where it belongs to. No functional change.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | exec.h | s | 230B | 9 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for S390  Disintegrate asm/system.h for S390.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-s390@vger.kernel.org
f | lowcore.h | s | 10K | 315 | Michael Holzheu | holzheu@linux.vnet.ibm.com | 1331481570 |  | [S390] Ensure that vmcore_info pointer is never accessed directly  Because the vmcore_info pointer is not 8 byte aligned it never should not be accessed directly. The reason is that the compiler assumes that 64 bit pointer are always double word aligned. To ensure save access, the vmcore_info type in struct lowcore is changed from u64 to an u8[8] array and a comment is added.  Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Reported-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | termbits.h | s | 101B | 4 | Christian Borntraeger | borntraeger@de.ibm.com | 1260186697 |  | [S390] use generic termbits.h header file  A compare shows that arch/s390/include/asm/termbits.h is the same as include/asm-generic.h. This patch lets arch/s390/include/asm/termbits.h include the generic header.  Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | xor.h | s | 29B | 1 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | sigcontext.h | s | 1.4K | 54 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | dasd.h | s | 10K | 264 | Stefan Haberland | stefan.haberland@de.ibm.com | 1294228050 |  | [S390] dasd: Add support for raw ECKD access.  Normal I/O operations through the DASD device driver give only access to the data fields of an ECKD device even for track based I/O. This patch extends the DASD device driver to give access to whole ECKD tracks including count, key and data fields.  Signed-off-by: Stefan Haberland <stefan.haberland@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | hardirq.h | s | 614B | 19 | Heiko Carstens | heiko.carstens@de.ibm.com | 1331481568 |  | [S390] irq: set __ARCH_IRQ_EXIT_IRQS_DISABLED  Set __ARCH_IRQ_EXIT_IRQS_DISABLED in order to optimize irq_exit() a bit, since we call __do_softirq() instead of do_softirq(). This saves several needless checks, pointless interrupt disabling and an extra branch. If do_softirq() gets called from process context we still switch to the async stack.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | Kbuild | g | 309B |  | Alexander Graf | agraf@suse.de | 1287910290 |  | KVM: S390: Export kvm_virtio.h  As suggested by Christian, we should expose headers to user space with information that might be valuable there. The s390 virtio interface is one of those cases. It defines an ABI between hypervisor and guest, so it should be exposed to user space.  Reported-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Alexander Graf <agraf@suse.de> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | bug.h | s | 1.4K | 58 | Ben Hutchings | ben@decadent.org.uk | 1274254608 |  | panic: Allow warnings to set different taint flags  WARN() is used in some places to report firmware or hardware bugs that are then worked-around.  These bugs do not affect the stability of the kernel and should not set the flag for TAINT_WARN.  To allow for this, add WARN_TAINT() and WARN_TAINT_ONCE() macros that take a taint number as argument.  Architectures that implement warnings using trap instructions instead of calls to warn_slowpath_*() now implement __WARN_TAINT(taint) instead of __WARN().  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Acked-by: Helge Deller <deller@gmx.de> Tested-by: Paul Mundt <lethal@linux-sh.org> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | qdio.h | s | 10K | 369 | Jan Glauber | jang@linux.vnet.ibm.com | 1337172156 |  | s390/qdio: Cleanup error handling to drivers  Various improvements of qdio error reporting to the upper-layer drivers (qeth, zfcp):  - Split QDIO_ERROR_ACTIVATE_CHECK_CONDITION into:    QDIO_ERROR_ACTIVATE: qdio termination interrupt   QDIO_ERROR_GET_BUF_STATE: QIOASSIST eqbs error   QDIO_ERROR_SET_BUF_STATE: QIOASSIST sqbs error    Add QDIO_ERROR_FATAL / QDIO_ERROR_TEMPORARY masks   to ease recovery decision in upper-layer drivers.  - Don't (ab-)use qdio handler errors as return codes   for do_QDIO but use standard error codes:    -ENOBUFS: temporary target CC=2 condition   -EBUSY: unresolved SIGA-W CC=2 busy condition   -EIO: I/O error (CC=1, CC=3)  - Remove unneeded memory clobber from SIGA-R - Remove EX_TABLE entry on SIGA-W, we want to see these errors  Reviewed-by: Ursula Braun <ursula.braun@de.ibm.com> Signed-off-by: Jan Glauber <jang@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | posix_types.h | s | 1.4K | 42 | Al Viro | viro@zeniv.linux.org.uk | 1338426290 |  | bury __kernel_nlink_t, make internal nlink_t consistent  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | mmu.h | s | 947B | 34 | Heiko Carstens | h.carstens@de.ibm.com | 1333093272 |  | [S390] Fix build errors (fallout from system.h disintegration)  Signed-off-by: Heiko Carstens <h.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | futex.h | s | 1.3K | 40 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | atomic.h | s | 7.4K | 278 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for S390  Disintegrate asm/system.h for S390.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-s390@vger.kernel.org
f | spinlock_types.h | s | 407B | 14 | Thomas Gleixner | tglx@linutronix.de | 1260831332 |  | locking: Convert raw_rwlock to arch_rwlock  Not strictly necessary for -rt as -rt does not have non sleeping rwlocks, but it's odd to not have a consistent naming convention.  No functional change.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Ingo Molnar <mingo@elte.hu> Cc: linux-arch@vger.kernel.org
f | linkage.h | s | 159B | 6 | Jan Glauber | jang@linux.vnet.ibm.com | 1311497301 |  | [S390] fix s390 assembler code alignments  The alignment is missing for various global symbols in s390 assembly code. With a recent gcc and an instruction like stgrl this can lead to a specification exception if the instruction uses such a mis-aligned address.  Specify the alignment explicitely and while add it define __ALIGN for s390 and use the ENTRY define to save some lines of code.  Signed-off-by: Jan Glauber <jang@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | device.h | s | 129B | 6 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | tlbflush.h | s | 3.4K | 123 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | mutex.h | s | 350B | 9 | Gerald Schaefer | gerald.schaefer@de.ibm.com | 1290780334 |  | mutexes, sched: Introduce arch_mutex_cpu_relax()  The spinning mutex implementation uses cpu_relax() in busy loops as a compiler barrier. Depending on the architecture, cpu_relax() may do more than needed in this specific mutex spin loops. On System z we also give up the time slice of the virtual cpu in cpu_relax(), which prevents effective spinning on the mutex.  This patch replaces cpu_relax() in the spinning mutex code with arch_mutex_cpu_relax(), which can be defined by each architecture that selects HAVE_ARCH_MUTEX_CPU_RELAX. The default is still cpu_relax(), so this patch should not affect other architectures than System z for now.  Signed-off-by: Gerald Schaefer <gerald.schaefer@de.ibm.com> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> LKML-Reference: <1290437256.7455.4.camel@thinkpad> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | local.h | s | 31B | 1 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | tape390.h | s | 2.7K | 85 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | perf_event.h | s | 416B | 13 | Hendrik Brueckner | brueckner@linux.vnet.ibm.com | 1332497605 |  | [S390] perf: add support for s390x CPU counters  Add a perf PMU to access the CPU-measurement counter facility CPUM CF. CPUM CF provides multiple counter sets for measuring generic, problem-state, and crypto activaties.  Also an extended counter set for the IBM System z10 and IBM z196 mainframes is available.  Counters from the basic and problem-state counter set are mapped to generic perf hardware events.  Other counters are accessible through raw events.  For a list of available counter sets and counters, see:    - The Load-Program-Parameter and the CPU-Measurement Facilities (SA23-2260)   - The CPU-Measurement Facility Extended Counters Definition for     z10 and z196 (SA23-2261)  Reviewed-by: Jan Glauber <jang@linux.vnet.ibm.com> Signed-off-by: Hendrik Brueckner <brueckner@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | hugetlb.h | s | 3.7K | 125 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1306139068 |  | [S390] Remove data execution protection  The noexec support on s390 does not rely on a bit in the page table entry but utilizes the secondary space mode to distinguish between memory accesses for instructions vs. data. The noexec code relies on the assumption that the cpu will always use the secondary space page table for data accesses while it is running in the secondary space mode. Up to the z9-109 class machines this has been the case. Unfortunately this is not true anymore with z10 and later machines. The load-relative-long instructions lrl, lgrl and lgfrl access the memory operand using the same addressing-space mode that has been used to fetch the instruction. This breaks the noexec mode for all user space binaries compiled with march=z10 or later. The only option is to remove the current noexec support.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | irqflags.h | s | 1.5K | 59 | Steven Rostedt | srostedt@redhat.com | 1311497280 |  | [S390] irqs: Do not trace arch_local_{*,irq_*} functions  Do not trace arch_local_save_flags(), arch_local_irq_*() and friends. Although they are marked inline, gcc may still make a function out of them and add it to the pool of functions that are traced by the function tracer. This can cause undesirable results (kernel panic, triple faults, etc).  Add the notrace notation to prevent them from ever being traced.  Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Steven Rostedt <rostedt@goodmis.org> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | chsc.h | s | 2.9K | 134 | Heiko Carstens | heiko.carstens@de.ibm.com | 1252657776 |  | [S390] cio: move scsw helper functions to header file  All scsw helper functions are very short and usage of them shouldn't result in function calls. Therefore we move them to a separate header file. Also saves a lot of EXPORT_SYMBOLs.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kexec.h | s | 1.7K | 53 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | unistd.h | s | 12K | 416 | Heiko Carstens | heiko.carstens@de.ibm.com | 1324981633 |  | [S390] ipc: call generic sys_ipc demultiplexer  Call generic IPC demultiplexer instead of having a nearly identical s390 variant. Also make sure that native and compat handling now have the same behaviour.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | topology.h | s | 1.8K | 63 | Heiko Carstens | heiko.carstens@de.ibm.com | 1324981632 |  | [S390] topology: increase poll frequency if change is anticipated  Increase cpu topology change poll frequency if a change is anticipated. Otherwise a user might be a bit confused to have to wait up to a minute in order to see a change this should be visible immediatly. However there is no guarantee that the change will happen during the time frame the poll frequency is increased.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | extmem.h | s | 843B | 28 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ctl_reg.h | s | 1.8K | 60 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | syscall.h | s | 2.2K | 78 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1324981632 |  | [S390] cleanup trap handling  Move the program interruption code and the translation exception identifier to the pt_regs structure as 'int_code' and 'int_parm_long' and make the first level interrupt handler in entry[64].S store the two values. That makes it possible to drop 'prot_addr' and 'trap_no' from the thread_struct and to reduce the number of arguments to a lot of functions. Finally un-inline do_trap. Overall this saves 5812 bytes in the .text section of the 64 bit kernel.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | string.h | s | 3.8K | 134 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847005 |  | s390/headers: remove #ifdef __KERNEL__ from not exported headers  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ioctl.h | s | 31B | 1 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | processor.h | s | 9.1K | 306 | Linus Torvalds | torvalds@linux-foundation.org | 1338486670 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/s390/linux  Pull s390 patches from Heiko Carstens:  "A couple of s390 patches for the 3.5 merge window.  Just a collection   of bug fixes and cleanups."  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/s390/linux:   s390/uaccess: fix access_ok compile warnings   s390/cmpxchg: select HAVE_CMPXCHG_LOCAL option   s390/cmpxchg: fix sign extension bugs   s390/cmpxchg: fix 1 and 2 byte memory accesses   s390/cmpxchg: fix compile warnings specific to s390   s390/cmpxchg: add missing memory barrier to cmpxchg64   s390/cpu: remove cpu "capabilities" sysfs attribute   s390/kernel: Fix smp_call_ipl_cpu() for offline CPUs   s390/kernel: Introduce memcpy_absolute() function   s390/headers: replace __s390x__ with CONFIG_64BIT where possible   s390/headers: remove #ifdef __KERNEL__ from not exported headers   s390/irq: split irq stats for cpu-measurement alert facilities   s390/kexec: Move early_pgm_check_handler() to text section   s390/kdump: Use real mode for PSW restart and kexec   s390/kdump: Account /sys/kernel/kexec_crash_size changes in OS info   s390/kernel: Remove OS info init function call and diag 308 for kdump
f | percpu.h | s | 3.0K | 77 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | module.h | s | 1.0K | 42 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | poll.h | s | 30B | 1 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | cmpxchg.h | s | 5.3K | 221 | Heiko Carstens | heiko.carstens@de.ibm.com | 1338361678 |  | s390/cmpxchg: fix sign extension bugs  For 1 and 2 byte operands for xchg and cmpxchg the old and new values get or'ed into the larger 4 byte old value before the compare and swap instruction gets executed. This is done without using the proper byte mask before or'ing the values. If the caller passed in negative old or new values these got sign extended by the caller. Which in turn means that either the old value never matches, or, even worse, unrelated bytes would be changed in memory.  Luckily there don't seem to be any callers around yet, since that would have resulted in the specification exception fixed in an earlies patch.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | sfp-util.h | s | 1.8K | 70 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | page.h | s | 5.7K | 176 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1319984206 |  | [S390] sparse: fix sparse warnings about missing prototypes  Add prototypes and includes for functions used in different modules.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | div64.h | s | 31B | 1 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | qeth.h | s | 3.0K | 104 | Frank Blaschka | frank.blaschka@de.ibm.com | 1328745020 |  | qeth: add query OSA address table support  Add qeth device private ioctl to query the OSA address table. This helps debugging hw related problems.  Signed-off-by: Frank Blaschka <frank.blaschka@de.ibm.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | diag.h | s | 1.3K | 44 | Michael Holzheu | holzheu@linux.vnet.ibm.com | 1305040423 |  | [S390] replace diag10() with diag10_range() function  Currently the diag10() function can only release one page. For exploiters that have to call diag10 on a contiguous memory region this is suboptimal. This patch replaces the diag10() function with diag10_range() that is able to release multiple pages. In addition to that the new function now allows to release memory with addresses higher than 2047 MiB. This was due to a restriction of the diagnose implementation under z/VM prior to release 5.2.  Signed-off-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | itcw.h | s | 911B | 24 | David Howells | dhowells@redhat.com | 1323768405 |  | UAPI: Alter the S390 asm include guards to be recognisable by the UAPI splitter  Alter some of the S390 asm include guards to fit a pattern that the UAPI splitter recognises.  Signed-off-by: David Howells <dhowells@redhat.com>
f | airq.h | s | 530B | 15 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | kvm.h | s | 1.5K | 52 | Jason J. herne | jjherne@us.ibm.com | 1337299563 |  | KVM: s390: onereg for timer related registers  Enhance the KVM ONE_REG capability within S390 to allow getting/setting the following special cpu registers: clock comparator and the cpu timer. These are needed for migration.  Signed-off-by: Jason J. herne <jjherne@us.ibm.com> Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | pgalloc.h | s | 3.9K | 114 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | auxvec.h | s | 91B | 4 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1230208735 |  | [S390] introduce vdso on s390  Add a vdso to speed up gettimeofday and clock_getres/clock_gettime for CLOCK_REALTIME/CLOCK_MONOTONIC.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | param.h | s | 113B | 4 | Robert P. J. Day | rpjday@crashcourse.ca | 1262592358 |  | [S390] Have param.h simply include <asm-generic/param.h>.  Since the files have identical content, might as well simplify.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | scatterlist.h | s | 64B | 2 | Christof Schmitt | christof.schmitt@de.ibm.com | 1288015815 |  | [S390] set ARCH_HAS_SG_CHAIN for s390  Set ARCH_HAS_SG_CHAIN for scatter lists on s390. Without this flag the SCSI code limits the maximum number of segments, so set it to make proper use of the FCP channel hardware.  Signed-off-by: Christof Schmitt <christof.schmitt@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | sfp-machine.h | s | 4.7K | 124 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | fb.h | s | 205B | 9 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | asm-offsets.h | s | 35B | 1 | Sam Ravnborg | sam@ravnborg.org | 1260619694 |  | kbuild: move asm-offsets.h to include/generated  The simplest method was to add an extra asm-offsets.h file in arch/$ARCH/include/asm that references the generated file.  We can now migrate the architectures one-by-one to reference the generated file direct - and when done we can delete the temporary arch/$ARCH/include/asm/asm-offsets.h file.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | thread_info.h | s | 3.8K | 111 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | irq.h | s | 980B | 46 | Hendrik Brueckner | brueckner@linux.vnet.ibm.com | 1337785612 |  | s390/irq: split irq stats for cpu-measurement alert facilities  CPU-measurement alerts are generated for different CPU-measurement facilities, for example, the sampling and counter facilities. Split the irq stats according to available facilities.  Signed-off-by: Hendrik Brueckner <brueckner@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | swab.h | s | 1.7K | 76 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1334147306 |  | [S390] Fix compile error in swab.h  The inline assembly in__arch_swab16p causes compile errors of the form:  *error*: *invalid* '*asm*': operand number missing after %-*letter*  The assembly uses the %O<n>/%R<n> notation but the first operand misses the operand number, it needs to be "%O1" instead of "%O".  Reported-by: Gil Peleg <gilpeleg@servframe.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | fcntl.h | s | 31B | 1 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | rwsem.h | s | 7.1K | 296 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | timex.h | s | 2.8K | 107 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337172164 |  | s390/time: simply Kconfig dependency  Use HAVE_MARCH_Z9_109_FEATURES to figure out if stckf is available at compile time.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | pgtable.h | s | 36K | 1089 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | socket.h | s | 1.6K | 63 | Ben Greear | greearb@candelatech.com | 1330076255 |  | net: Add framework to allow sending packets with customized CRC.  This is useful for testing RX handling of frames with bad CRCs.  Requires driver support to actually put the packet on the wire properly.  Signed-off-by: Ben Greear <greearb@candelatech.com> Tested-by: Aaron Brown <aaron.f.brown@intel.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | stat.h | s | 2.9K | 96 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | shmbuf.h | s | 1.3K | 44 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | switch_to.h | s | 2.3K | 89 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for S390  Disintegrate asm/system.h for S390.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-s390@vger.kernel.org
f | ipcbuf.h | s | 675B | 28 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | uaccess.h | s | 10K | 344 | Heiko Carstens | heiko.carstens@de.ibm.com | 1338364871 |  | s390/uaccess: fix access_ok compile warnings  On s390 access_ok is a macro which discards all parameters and always returns 1. This can result in compile warnings which warn about unused variables like this:  fs/read_write.c: In function 'rw_copy_check_uvector': fs/read_write.c:684:16: warning: unused variable 'buf' [-Wunused-variable]  Fix this by adding a __range_ok() function which consumes all parameters but still always returns 1.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | sysinfo.h | s | 3.6K | 151 | Heiko Carstens | heiko.carstens@de.ibm.com | 1288015821 |  | [S390] topology: move topology sysinfo code  Move the topology sysinfo SYSIB definitions to the proper place in asm/sysinfo.h where they should be.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | signal.h | s | 4.1K | 144 | Arnd Bergmann | arnd@arndb.de | 1244746912 |  | asm-generic: rename termios.h, signal.h and mman.h  The existing asm-generic versions are incomplete and included by some architectures. New architectures should be able to use a generic version, so rename the existing files and change all users, which lets us add the new files.  Signed-off-by: Remis Lima Baima <remis.developer@googlemail.com> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | mathemu.h | s | 881B | 22 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | ccwgroup.h | s | 2.2K | 62 | Sebastian Ott | sebott@linux.vnet.ibm.com | 1337172169 |  | s390/ccwgroup: remove ccwgroup_create_from_string  Remove the old ccwgroup_create_from_string interface since all drivers have been converted to ccwgroup_create_dev. Also remove now unused members of ccwgroup_driver.  Reviewed-by: Cornelia Huck <cornelia.huck@de.ibm.com> Signed-off-by: Sebastian Ott <sebott@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | mman.h | s | 428B | 17 | David Howells | dhowells@redhat.com | 1323788869 |  | UAPI: Split trivial #if defined(__KERNEL__) && X conditionals  Split trivial #if defined(__KERNEL__) && X conditionals to make automated disintegration easier.  Signed-off-by: David Howells <dhowells@redhat.com>
f | idals.h | s | 5.5K | 225 | Heiko Carstens | heiko.carstens@de.ibm.com | 1337847010 |  | s390/headers: replace __s390x__ with CONFIG_64BIT where possible  Replace __s390x__ with CONFIG_64BIT in all places that are not exported to userspace or guarded with #ifdef __KERNEL__.  Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | emergency-restart.h | s | 149B | 4 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | spinlock.h | s | 4.5K | 149 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1319984206 |  | [S390] sparse: fix sparse warnings about missing prototypes  Add prototypes and includes for functions used in different modules.  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | sockios.h | s | 98B | 4 | Christian Borntraeger | borntraeger@de.ibm.com | 1260186697 |  | [S390] use generic sockios.h header file  A compare shows that arch/s390/include/asm/sockios.h is the same as include/asm-generic/sockios.h. This patch lets arch/s390/include/asm/ termbits.h include the generic header.  Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | msgbuf.h | s | 1.1K | 34 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | shmparam.h | s | 281B | 11 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
f | byteorder.h | s | 125B | 4 | Harvey Harrison | harvey.harrison@gmail.com | 1231991810 |  | byteorder: make swab.h include asm/swab.h like a regular header  Add swab.h to kbuild.asm and remove the individual entries from each arch, mark as unifdef as some arches have some kernel-only bits inside.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sembuf.h | s | 801B | 26 | Martin Schwidefsky | schwidefsky@de.ibm.com | 1217616125 |  | [S390] move include/asm-s390 to arch/s390/include/asm  Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>
