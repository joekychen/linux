<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › ia64 › include › asm › machvec.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>machvec.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Machine vector for IA-64.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1999 Silicon Graphics, Inc.</span>
<span class="cm"> * Copyright (C) Srinivasa Thirumalachar &lt;sprasad@engr.sgi.com&gt;</span>
<span class="cm"> * Copyright (C) Vijay Chander &lt;vijay@engr.sgi.com&gt;</span>
<span class="cm"> * Copyright (C) 1999-2001, 2003-2004 Hewlett-Packard Co.</span>
<span class="cm"> *	David Mosberger-Tang &lt;davidm@hpl.hp.com&gt;</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _ASM_IA64_MACHVEC_H</span>
<span class="cp">#define _ASM_IA64_MACHVEC_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/* forward declarations: */</span>
<span class="k">struct</span> <span class="n">device</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">pt_regs</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">scatterlist</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">page</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">mm_struct</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">pci_bus</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">task_struct</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">pci_dev</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">msi_desc</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">dma_attrs</span><span class="p">;</span>

<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_setup_t</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_cpu_init_t</span> <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_irq_init_t</span> <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_send_ipi_t</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_timer_interrupt_t</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_global_tlb_purge_t</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mm_struct</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_tlb_migrate_finish_t</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mm_struct</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="n">u8</span> <span class="n">ia64_mv_irq_to_vector</span> <span class="p">(</span><span class="kt">int</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ia64_mv_local_vector_to_irq</span> <span class="p">(</span><span class="n">u8</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ia64_mv_pci_get_legacy_mem_t</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pci_bus</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="n">ia64_mv_pci_legacy_read_t</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pci_bus</span> <span class="o">*</span><span class="p">,</span> <span class="n">u16</span> <span class="n">port</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">val</span><span class="p">,</span>
				       <span class="n">u8</span> <span class="n">size</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="n">ia64_mv_pci_legacy_write_t</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pci_bus</span> <span class="o">*</span><span class="p">,</span> <span class="n">u16</span> <span class="n">port</span><span class="p">,</span> <span class="n">u32</span> <span class="n">val</span><span class="p">,</span>
					<span class="n">u8</span> <span class="n">size</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_migrate_t</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span> <span class="n">task</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_pci_fixup_bus_t</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pci_bus</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_kernel_launch_event_t</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* DMA-mapping interface: */</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_dma_init</span> <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">typedef</span> <span class="n">u64</span> <span class="n">ia64_mv_dma_get_required_mask</span> <span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">dma_map_ops</span> <span class="o">*</span><span class="n">ia64_mv_dma_get_ops</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * WARNING: The legacy I/O space is _architected_.  Platforms are</span>
<span class="cm"> * expected to follow this architected model (see Section 10.7 in the</span>
<span class="cm"> * IA-64 Architecture Software Developer&#39;s Manual).  Unfortunately,</span>
<span class="cm"> * some broken machines do not follow that model, which is why we have</span>
<span class="cm"> * to make the inX/outX operations part of the machine vector.</span>
<span class="cm"> * Platform designers should follow the architected model whenever</span>
<span class="cm"> * possible.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ia64_mv_inb_t</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ia64_mv_inw_t</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ia64_mv_inl_t</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_outb_t</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_outw_t</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_outl_t</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_mmiowb_t</span> <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ia64_mv_readb_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ia64_mv_readw_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ia64_mv_readl_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ia64_mv_readq_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ia64_mv_readb_relaxed_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ia64_mv_readw_relaxed_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ia64_mv_readl_relaxed_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ia64_mv_readq_relaxed_t</span> <span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">);</span>

<span class="k">typedef</span> <span class="kt">int</span> <span class="n">ia64_mv_setup_msi_irq_t</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">msi_desc</span> <span class="o">*</span><span class="p">);</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="n">ia64_mv_teardown_msi_irq_t</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">irq</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span>
<span class="nf">machvec_noop</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span>
<span class="nf">machvec_noop_mm</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mm_struct</span> <span class="o">*</span><span class="n">mm</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span>
<span class="nf">machvec_noop_task</span> <span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span>
<span class="nf">machvec_noop_bus</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pci_bus</span> <span class="o">*</span><span class="n">bus</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">machvec_setup</span> <span class="p">(</span><span class="kt">char</span> <span class="o">**</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">machvec_timer_interrupt</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">machvec_tlb_migrate_finish</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mm_struct</span> <span class="o">*</span><span class="p">);</span>

<span class="cp"># if defined (CONFIG_IA64_HP_SIM)</span>
<span class="cp">#  include &lt;asm/machvec_hpsim.h&gt;</span>
<span class="cp"># elif defined (CONFIG_IA64_DIG)</span>
<span class="cp">#  include &lt;asm/machvec_dig.h&gt;</span>
<span class="cp"># elif defined(CONFIG_IA64_DIG_VTD)</span>
<span class="cp">#  include &lt;asm/machvec_dig_vtd.h&gt;</span>
<span class="cp"># elif defined (CONFIG_IA64_HP_ZX1)</span>
<span class="cp">#  include &lt;asm/machvec_hpzx1.h&gt;</span>
<span class="cp"># elif defined (CONFIG_IA64_HP_ZX1_SWIOTLB)</span>
<span class="cp">#  include &lt;asm/machvec_hpzx1_swiotlb.h&gt;</span>
<span class="cp"># elif defined (CONFIG_IA64_SGI_SN2)</span>
<span class="cp">#  include &lt;asm/machvec_sn2.h&gt;</span>
<span class="cp"># elif defined (CONFIG_IA64_SGI_UV)</span>
<span class="cp">#  include &lt;asm/machvec_uv.h&gt;</span>
<span class="cp"># elif defined (CONFIG_IA64_XEN_GUEST)</span>
<span class="cp">#  include &lt;asm/machvec_xen.h&gt;</span>
<span class="cp"># elif defined (CONFIG_IA64_GENERIC)</span>

<span class="cp"># ifdef MACHVEC_PLATFORM_HEADER</span>
<span class="cp">#  include MACHVEC_PLATFORM_HEADER</span>
<span class="cp"># else</span>
<span class="cp">#  define platform_name		ia64_mv.name</span>
<span class="cp">#  define platform_setup	ia64_mv.setup</span>
<span class="cp">#  define platform_cpu_init	ia64_mv.cpu_init</span>
<span class="cp">#  define platform_irq_init	ia64_mv.irq_init</span>
<span class="cp">#  define platform_send_ipi	ia64_mv.send_ipi</span>
<span class="cp">#  define platform_timer_interrupt	ia64_mv.timer_interrupt</span>
<span class="cp">#  define platform_global_tlb_purge	ia64_mv.global_tlb_purge</span>
<span class="cp">#  define platform_tlb_migrate_finish	ia64_mv.tlb_migrate_finish</span>
<span class="cp">#  define platform_dma_init		ia64_mv.dma_init</span>
<span class="cp">#  define platform_dma_get_required_mask ia64_mv.dma_get_required_mask</span>
<span class="cp">#  define platform_dma_get_ops		ia64_mv.dma_get_ops</span>
<span class="cp">#  define platform_irq_to_vector	ia64_mv.irq_to_vector</span>
<span class="cp">#  define platform_local_vector_to_irq	ia64_mv.local_vector_to_irq</span>
<span class="cp">#  define platform_pci_get_legacy_mem	ia64_mv.pci_get_legacy_mem</span>
<span class="cp">#  define platform_pci_legacy_read	ia64_mv.pci_legacy_read</span>
<span class="cp">#  define platform_pci_legacy_write	ia64_mv.pci_legacy_write</span>
<span class="cp">#  define platform_inb		ia64_mv.inb</span>
<span class="cp">#  define platform_inw		ia64_mv.inw</span>
<span class="cp">#  define platform_inl		ia64_mv.inl</span>
<span class="cp">#  define platform_outb		ia64_mv.outb</span>
<span class="cp">#  define platform_outw		ia64_mv.outw</span>
<span class="cp">#  define platform_outl		ia64_mv.outl</span>
<span class="cp">#  define platform_mmiowb	ia64_mv.mmiowb</span>
<span class="cp">#  define platform_readb        ia64_mv.readb</span>
<span class="cp">#  define platform_readw        ia64_mv.readw</span>
<span class="cp">#  define platform_readl        ia64_mv.readl</span>
<span class="cp">#  define platform_readq        ia64_mv.readq</span>
<span class="cp">#  define platform_readb_relaxed        ia64_mv.readb_relaxed</span>
<span class="cp">#  define platform_readw_relaxed        ia64_mv.readw_relaxed</span>
<span class="cp">#  define platform_readl_relaxed        ia64_mv.readl_relaxed</span>
<span class="cp">#  define platform_readq_relaxed        ia64_mv.readq_relaxed</span>
<span class="cp">#  define platform_migrate		ia64_mv.migrate</span>
<span class="cp">#  define platform_setup_msi_irq	ia64_mv.setup_msi_irq</span>
<span class="cp">#  define platform_teardown_msi_irq	ia64_mv.teardown_msi_irq</span>
<span class="cp">#  define platform_pci_fixup_bus	ia64_mv.pci_fixup_bus</span>
<span class="cp">#  define platform_kernel_launch_event	ia64_mv.kernel_launch_event</span>
<span class="cp"># endif</span>

<span class="cm">/* __attribute__((__aligned__(16))) is required to make size of the</span>
<span class="cm"> * structure multiple of 16 bytes.</span>
<span class="cm"> * This will fillup the holes created because of section 3.3.1 in</span>
<span class="cm"> * Software Conventions guide.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ia64_machine_vector</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="n">ia64_mv_setup_t</span> <span class="o">*</span><span class="n">setup</span><span class="p">;</span>
	<span class="n">ia64_mv_cpu_init_t</span> <span class="o">*</span><span class="n">cpu_init</span><span class="p">;</span>
	<span class="n">ia64_mv_irq_init_t</span> <span class="o">*</span><span class="n">irq_init</span><span class="p">;</span>
	<span class="n">ia64_mv_send_ipi_t</span> <span class="o">*</span><span class="n">send_ipi</span><span class="p">;</span>
	<span class="n">ia64_mv_timer_interrupt_t</span> <span class="o">*</span><span class="n">timer_interrupt</span><span class="p">;</span>
	<span class="n">ia64_mv_global_tlb_purge_t</span> <span class="o">*</span><span class="n">global_tlb_purge</span><span class="p">;</span>
	<span class="n">ia64_mv_tlb_migrate_finish_t</span> <span class="o">*</span><span class="n">tlb_migrate_finish</span><span class="p">;</span>
	<span class="n">ia64_mv_dma_init</span> <span class="o">*</span><span class="n">dma_init</span><span class="p">;</span>
	<span class="n">ia64_mv_dma_get_required_mask</span> <span class="o">*</span><span class="n">dma_get_required_mask</span><span class="p">;</span>
	<span class="n">ia64_mv_dma_get_ops</span> <span class="o">*</span><span class="n">dma_get_ops</span><span class="p">;</span>
	<span class="n">ia64_mv_irq_to_vector</span> <span class="o">*</span><span class="n">irq_to_vector</span><span class="p">;</span>
	<span class="n">ia64_mv_local_vector_to_irq</span> <span class="o">*</span><span class="n">local_vector_to_irq</span><span class="p">;</span>
	<span class="n">ia64_mv_pci_get_legacy_mem_t</span> <span class="o">*</span><span class="n">pci_get_legacy_mem</span><span class="p">;</span>
	<span class="n">ia64_mv_pci_legacy_read_t</span> <span class="o">*</span><span class="n">pci_legacy_read</span><span class="p">;</span>
	<span class="n">ia64_mv_pci_legacy_write_t</span> <span class="o">*</span><span class="n">pci_legacy_write</span><span class="p">;</span>
	<span class="n">ia64_mv_inb_t</span> <span class="o">*</span><span class="n">inb</span><span class="p">;</span>
	<span class="n">ia64_mv_inw_t</span> <span class="o">*</span><span class="n">inw</span><span class="p">;</span>
	<span class="n">ia64_mv_inl_t</span> <span class="o">*</span><span class="n">inl</span><span class="p">;</span>
	<span class="n">ia64_mv_outb_t</span> <span class="o">*</span><span class="n">outb</span><span class="p">;</span>
	<span class="n">ia64_mv_outw_t</span> <span class="o">*</span><span class="n">outw</span><span class="p">;</span>
	<span class="n">ia64_mv_outl_t</span> <span class="o">*</span><span class="n">outl</span><span class="p">;</span>
	<span class="n">ia64_mv_mmiowb_t</span> <span class="o">*</span><span class="n">mmiowb</span><span class="p">;</span>
	<span class="n">ia64_mv_readb_t</span> <span class="o">*</span><span class="n">readb</span><span class="p">;</span>
	<span class="n">ia64_mv_readw_t</span> <span class="o">*</span><span class="n">readw</span><span class="p">;</span>
	<span class="n">ia64_mv_readl_t</span> <span class="o">*</span><span class="n">readl</span><span class="p">;</span>
	<span class="n">ia64_mv_readq_t</span> <span class="o">*</span><span class="n">readq</span><span class="p">;</span>
	<span class="n">ia64_mv_readb_relaxed_t</span> <span class="o">*</span><span class="n">readb_relaxed</span><span class="p">;</span>
	<span class="n">ia64_mv_readw_relaxed_t</span> <span class="o">*</span><span class="n">readw_relaxed</span><span class="p">;</span>
	<span class="n">ia64_mv_readl_relaxed_t</span> <span class="o">*</span><span class="n">readl_relaxed</span><span class="p">;</span>
	<span class="n">ia64_mv_readq_relaxed_t</span> <span class="o">*</span><span class="n">readq_relaxed</span><span class="p">;</span>
	<span class="n">ia64_mv_migrate_t</span> <span class="o">*</span><span class="n">migrate</span><span class="p">;</span>
	<span class="n">ia64_mv_setup_msi_irq_t</span> <span class="o">*</span><span class="n">setup_msi_irq</span><span class="p">;</span>
	<span class="n">ia64_mv_teardown_msi_irq_t</span> <span class="o">*</span><span class="n">teardown_msi_irq</span><span class="p">;</span>
	<span class="n">ia64_mv_pci_fixup_bus_t</span> <span class="o">*</span><span class="n">pci_fixup_bus</span><span class="p">;</span>
	<span class="n">ia64_mv_kernel_launch_event_t</span> <span class="o">*</span><span class="n">kernel_launch_event</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">__aligned__</span><span class="p">(</span><span class="mi">16</span><span class="p">)));</span> <span class="cm">/* align attrib? see above comment */</span>

<span class="cp">#define MACHVEC_INIT(name)			\</span>
<span class="cp">{						\</span>
<span class="cp">	#name,					\</span>
<span class="cp">	platform_setup,				\</span>
<span class="cp">	platform_cpu_init,			\</span>
<span class="cp">	platform_irq_init,			\</span>
<span class="cp">	platform_send_ipi,			\</span>
<span class="cp">	platform_timer_interrupt,		\</span>
<span class="cp">	platform_global_tlb_purge,		\</span>
<span class="cp">	platform_tlb_migrate_finish,		\</span>
<span class="cp">	platform_dma_init,			\</span>
<span class="cp">	platform_dma_get_required_mask,		\</span>
<span class="cp">	platform_dma_get_ops,			\</span>
<span class="cp">	platform_irq_to_vector,			\</span>
<span class="cp">	platform_local_vector_to_irq,		\</span>
<span class="cp">	platform_pci_get_legacy_mem,		\</span>
<span class="cp">	platform_pci_legacy_read,		\</span>
<span class="cp">	platform_pci_legacy_write,		\</span>
<span class="cp">	platform_inb,				\</span>
<span class="cp">	platform_inw,				\</span>
<span class="cp">	platform_inl,				\</span>
<span class="cp">	platform_outb,				\</span>
<span class="cp">	platform_outw,				\</span>
<span class="cp">	platform_outl,				\</span>
<span class="cp">	platform_mmiowb,			\</span>
<span class="cp">	platform_readb,				\</span>
<span class="cp">	platform_readw,				\</span>
<span class="cp">	platform_readl,				\</span>
<span class="cp">	platform_readq,				\</span>
<span class="cp">	platform_readb_relaxed,			\</span>
<span class="cp">	platform_readw_relaxed,			\</span>
<span class="cp">	platform_readl_relaxed,			\</span>
<span class="cp">	platform_readq_relaxed,			\</span>
<span class="cp">	platform_migrate,			\</span>
<span class="cp">	platform_setup_msi_irq,			\</span>
<span class="cp">	platform_teardown_msi_irq,		\</span>
<span class="cp">	platform_pci_fixup_bus,			\</span>
<span class="cp">	platform_kernel_launch_event            \</span>
<span class="cp">}</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">ia64_machine_vector</span> <span class="n">ia64_mv</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">machvec_init</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">machvec_init_from_cmdline</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cmdline</span><span class="p">);</span>

<span class="cp"># else</span>
<span class="cp">#  error Unknown configuration.  Update arch/ia64/include/asm/machvec.h.</span>
<span class="cp"># endif </span><span class="cm">/* CONFIG_IA64_GENERIC */</span><span class="cp"></span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">swiotlb_dma_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">dma_map_ops</span> <span class="o">*</span><span class="n">dma_get_ops</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Define default versions so we can extend machvec for new platforms without having</span>
<span class="cm"> * to update the machvec files for all existing platforms.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef platform_setup</span>
<span class="cp"># define platform_setup			machvec_setup</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_cpu_init</span>
<span class="cp"># define platform_cpu_init		machvec_noop</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_irq_init</span>
<span class="cp"># define platform_irq_init		machvec_noop</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef platform_send_ipi</span>
<span class="cp"># define platform_send_ipi		ia64_send_ipi	</span><span class="cm">/* default to architected version */</span><span class="cp"></span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_timer_interrupt</span>
<span class="cp"># define platform_timer_interrupt 	machvec_timer_interrupt</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_global_tlb_purge</span>
<span class="cp"># define platform_global_tlb_purge	ia64_global_tlb_purge </span><span class="cm">/* default to architected version */</span><span class="cp"></span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_tlb_migrate_finish</span>
<span class="cp"># define platform_tlb_migrate_finish	machvec_noop_mm</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_kernel_launch_event</span>
<span class="cp"># define platform_kernel_launch_event	machvec_noop</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_dma_init</span>
<span class="cp"># define platform_dma_init		swiotlb_dma_init</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_dma_get_ops</span>
<span class="cp"># define platform_dma_get_ops		dma_get_ops</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_dma_get_required_mask</span>
<span class="cp"># define  platform_dma_get_required_mask	ia64_dma_get_required_mask</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_irq_to_vector</span>
<span class="cp"># define platform_irq_to_vector		__ia64_irq_to_vector</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_local_vector_to_irq</span>
<span class="cp"># define platform_local_vector_to_irq	__ia64_local_vector_to_irq</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_pci_get_legacy_mem</span>
<span class="cp"># define platform_pci_get_legacy_mem	ia64_pci_get_legacy_mem</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_pci_legacy_read</span>
<span class="cp"># define platform_pci_legacy_read	ia64_pci_legacy_read</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ia64_pci_legacy_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_bus</span> <span class="o">*</span><span class="n">bus</span><span class="p">,</span> <span class="n">u16</span> <span class="n">port</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">val</span><span class="p">,</span> <span class="n">u8</span> <span class="n">size</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_pci_legacy_write</span>
<span class="cp"># define platform_pci_legacy_write	ia64_pci_legacy_write</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ia64_pci_legacy_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_bus</span> <span class="o">*</span><span class="n">bus</span><span class="p">,</span> <span class="n">u16</span> <span class="n">port</span><span class="p">,</span> <span class="n">u32</span> <span class="n">val</span><span class="p">,</span> <span class="n">u8</span> <span class="n">size</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_inb</span>
<span class="cp"># define platform_inb		__ia64_inb</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_inw</span>
<span class="cp"># define platform_inw		__ia64_inw</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_inl</span>
<span class="cp"># define platform_inl		__ia64_inl</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_outb</span>
<span class="cp"># define platform_outb		__ia64_outb</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_outw</span>
<span class="cp"># define platform_outw		__ia64_outw</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_outl</span>
<span class="cp"># define platform_outl		__ia64_outl</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_mmiowb</span>
<span class="cp"># define platform_mmiowb	__ia64_mmiowb</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readb</span>
<span class="cp"># define platform_readb		__ia64_readb</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readw</span>
<span class="cp"># define platform_readw		__ia64_readw</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readl</span>
<span class="cp"># define platform_readl		__ia64_readl</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readq</span>
<span class="cp"># define platform_readq		__ia64_readq</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readb_relaxed</span>
<span class="cp"># define platform_readb_relaxed	__ia64_readb_relaxed</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readw_relaxed</span>
<span class="cp"># define platform_readw_relaxed	__ia64_readw_relaxed</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readl_relaxed</span>
<span class="cp"># define platform_readl_relaxed	__ia64_readl_relaxed</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_readq_relaxed</span>
<span class="cp"># define platform_readq_relaxed	__ia64_readq_relaxed</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_migrate</span>
<span class="cp"># define platform_migrate machvec_noop_task</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_setup_msi_irq</span>
<span class="cp"># define platform_setup_msi_irq		((ia64_mv_setup_msi_irq_t*)NULL)</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_teardown_msi_irq</span>
<span class="cp"># define platform_teardown_msi_irq	((ia64_mv_teardown_msi_irq_t*)NULL)</span>
<span class="cp">#endif</span>
<span class="cp">#ifndef platform_pci_fixup_bus</span>
<span class="cp"># define platform_pci_fixup_bus	machvec_noop_bus</span>
<span class="cp">#endif</span>

<span class="cp">#endif </span><span class="cm">/* _ASM_IA64_MACHVEC_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
