<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › ia64 › include › asm › xen › interface.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>interface.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm"> * arch-ia64/hypervisor-if.h</span>
<span class="cm"> *</span>
<span class="cm"> * Guest OS interface to IA64 Xen.</span>
<span class="cm"> *</span>
<span class="cm"> * Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="cm"> * of this software and associated documentation files (the &quot;Software&quot;), to</span>
<span class="cm"> * deal in the Software without restriction, including without limitation the</span>
<span class="cm"> * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span>
<span class="cm"> * sell copies of the Software, and to permit persons to whom the Software is</span>
<span class="cm"> * furnished to do so, subject to the following conditions:</span>
<span class="cm"> *</span>
<span class="cm"> * The above copyright notice and this permission notice shall be included in</span>
<span class="cm"> * all copies or substantial portions of the Software.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="cm"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="cm"> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="cm"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span>
<span class="cm"> * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span>
<span class="cm"> * DEALINGS IN THE SOFTWARE.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright by those who contributed. (in alphabetical order)</span>
<span class="cm"> *</span>
<span class="cm"> * Anthony Xu &lt;anthony.xu@intel.com&gt;</span>
<span class="cm"> * Eddie Dong &lt;eddie.dong@intel.com&gt;</span>
<span class="cm"> * Fred Yang &lt;fred.yang@intel.com&gt;</span>
<span class="cm"> * Kevin Tian &lt;kevin.tian@intel.com&gt;</span>
<span class="cm"> * Alex Williamson &lt;alex.williamson@hp.com&gt;</span>
<span class="cm"> * Chris Wright &lt;chrisw@sous-sol.org&gt;</span>
<span class="cm"> * Christian Limpach &lt;Christian.Limpach@cl.cam.ac.uk&gt;</span>
<span class="cm"> * Dietmar Hahn &lt;dietmar.hahn@fujitsu-siemens.com&gt;</span>
<span class="cm"> * Hollis Blanchard &lt;hollisb@us.ibm.com&gt;</span>
<span class="cm"> * Isaku Yamahata &lt;yamahata@valinux.co.jp&gt;</span>
<span class="cm"> * Jan Beulich &lt;jbeulich@novell.com&gt;</span>
<span class="cm"> * John Levon &lt;john.levon@sun.com&gt;</span>
<span class="cm"> * Kazuhiro Suzuki &lt;kaz@jp.fujitsu.com&gt;</span>
<span class="cm"> * Keir Fraser &lt;keir.fraser@citrix.com&gt;</span>
<span class="cm"> * Kouya Shimura &lt;kouya@jp.fujitsu.com&gt;</span>
<span class="cm"> * Masaki Kanno &lt;kanno.masaki@jp.fujitsu.com&gt;</span>
<span class="cm"> * Matt Chapman &lt;matthewc@hp.com&gt;</span>
<span class="cm"> * Matthew Chapman &lt;matthewc@hp.com&gt;</span>
<span class="cm"> * Samuel Thibault &lt;samuel.thibault@eu.citrix.com&gt;</span>
<span class="cm"> * Tomonari Horikoshi &lt;t.horikoshi@jp.fujitsu.com&gt;</span>
<span class="cm"> * Tristan Gingold &lt;tgingold@free.fr&gt;</span>
<span class="cm"> * Tsunehisa Doi &lt;Doi.Tsunehisa@jp.fujitsu.com&gt;</span>
<span class="cm"> * Yutaka Ezaki &lt;yutaka.ezaki@jp.fujitsu.com&gt;</span>
<span class="cm"> * Zhang Xin &lt;xing.z.zhang@intel.com&gt;</span>
<span class="cm"> * Zhang xiantao &lt;xiantao.zhang@intel.com&gt;</span>
<span class="cm"> * dan.magenheimer@hp.com</span>
<span class="cm"> * ian.pratt@cl.cam.ac.uk</span>
<span class="cm"> * michael.fetterman@cl.cam.ac.uk</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _ASM_IA64_XEN_INTERFACE_H</span>
<span class="cp">#define _ASM_IA64_XEN_INTERFACE_H</span>

<span class="cp">#define __DEFINE_GUEST_HANDLE(name, type)	\</span>
<span class="cp">	typedef struct { type *p; } __guest_handle_ ## name</span>

<span class="cp">#define DEFINE_GUEST_HANDLE_STRUCT(name)	\</span>
<span class="cp">	__DEFINE_GUEST_HANDLE(name, struct name)</span>
<span class="cp">#define DEFINE_GUEST_HANDLE(name)	__DEFINE_GUEST_HANDLE(name, name)</span>
<span class="cp">#define GUEST_HANDLE(name)		__guest_handle_ ## name</span>
<span class="cp">#define GUEST_HANDLE_64(name)		GUEST_HANDLE(name)</span>
<span class="cp">#define set_xen_guest_handle(hnd, val)	do { (hnd).p = val; } while (0)</span>

<span class="cp">#ifndef __ASSEMBLY__</span>
<span class="cm">/* Guest handles for primitive C types. */</span>
<span class="n">__DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="n">uchar</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span><span class="p">);</span>
<span class="n">__DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="n">uint</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">);</span>
<span class="n">__DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="n">ulong</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>

<span class="n">DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="kt">char</span><span class="p">);</span>
<span class="n">DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
<span class="n">DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="kt">long</span><span class="p">);</span>
<span class="n">DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="n">DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">);</span>
<span class="n">DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">);</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">xen_pfn_t</span><span class="p">;</span>
<span class="n">DEFINE_GUEST_HANDLE</span><span class="p">(</span><span class="n">xen_pfn_t</span><span class="p">);</span>
<span class="cp">#define PRI_xen_pfn	&quot;lx&quot;</span>
<span class="cp">#endif</span>

<span class="cm">/* Arch specific VIRQs definition */</span>
<span class="cp">#define VIRQ_ITC	VIRQ_ARCH_0	</span><span class="cm">/* V. Virtual itc timer */</span><span class="cp"></span>
<span class="cp">#define VIRQ_MCA_CMC	VIRQ_ARCH_1	</span><span class="cm">/* MCA cmc interrupt */</span><span class="cp"></span>
<span class="cp">#define VIRQ_MCA_CPE	VIRQ_ARCH_2	</span><span class="cm">/* MCA cpe interrupt */</span><span class="cp"></span>

<span class="cm">/* Maximum number of virtual CPUs in multi-processor guests. */</span>
<span class="cm">/* keep sizeof(struct shared_page) &lt;= PAGE_SIZE.</span>
<span class="cm"> * this is checked in arch/ia64/xen/hypervisor.c. */</span>
<span class="cp">#define MAX_VIRT_CPUS	64</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="cp">#define INVALID_MFN	(~0UL)</span>

<span class="k">union</span> <span class="n">vac</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">value</span><span class="p">;</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">a_int</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">a_from_int_cr</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">a_to_int_cr</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">a_from_psr</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">a_from_cpuid</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">a_cover</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">a_bsw</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">long</span> <span class="n">reserved</span><span class="o">:</span><span class="mi">57</span><span class="p">;</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">vdc</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">value</span><span class="p">;</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">d_vmsw</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">d_extint</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">d_ibr_dbr</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">d_pmc</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">d_to_pmd</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">d_itm</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="kt">long</span> <span class="n">reserved</span><span class="o">:</span><span class="mi">58</span><span class="p">;</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">mapped_regs</span> <span class="p">{</span>
	<span class="k">union</span> <span class="n">vac</span> <span class="n">vac</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">vdc</span> <span class="n">vdc</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">virt_env_vaddr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vhpi</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">95</span><span class="p">];</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vgr</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">bank1_regs</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* bank1 regs (r16-r31)</span>
<span class="cm">						   when bank0 active */</span>
	<span class="p">};</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vbgr</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">bank0_regs</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* bank0 regs (r16-r31)</span>
<span class="cm">						   when bank1 active */</span>
	<span class="p">};</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vnat</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vbnat</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vcpuid</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">reserved3</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vpsr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vpr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">reserved4</span><span class="p">[</span><span class="mi">76</span><span class="p">];</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vcr</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">dcr</span><span class="p">;</span>	<span class="cm">/* CR0 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">itm</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">iva</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rsv1</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">pta</span><span class="p">;</span>	<span class="cm">/* CR8 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rsv2</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ipsr</span><span class="p">;</span>	<span class="cm">/* CR16 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">isr</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rsv3</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">iip</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ifa</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">itir</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">iipa</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ifs</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">iim</span><span class="p">;</span>	<span class="cm">/* CR24 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">iha</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rsv4</span><span class="p">[</span><span class="mi">38</span><span class="p">];</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">lid</span><span class="p">;</span>	<span class="cm">/* CR64 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ivr</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tpr</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">eoi</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">irr</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">itv</span><span class="p">;</span>	<span class="cm">/* CR72 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">pmv</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cmcv</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rsv5</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">lrr0</span><span class="p">;</span>	<span class="cm">/* CR80 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">lrr1</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rsv6</span><span class="p">[</span><span class="mi">46</span><span class="p">];</span>
		<span class="p">};</span>
	<span class="p">};</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">reserved5</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">precover_ifs</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">unat</span><span class="p">;</span>	<span class="cm">/* not sure if this is needed</span>
<span class="cm">						   until NaT arch is done */</span>
			<span class="kt">int</span> <span class="n">interrupt_collection_enabled</span><span class="p">;</span> <span class="cm">/* virtual psr.ic */</span>

			<span class="cm">/* virtual interrupt deliverable flag is</span>
<span class="cm">			 * evtchn_upcall_mask in shared info area now.</span>
<span class="cm">			 * interrupt_mask_addr is the address</span>
<span class="cm">			 * of evtchn_upcall_mask for current vcpu</span>
<span class="cm">			 */</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">interrupt_mask_addr</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">pending_interruption</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">vpsr_pp</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">vpsr_dfh</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">hpsr_dfh</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">hpsr_mfh</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">reserved5_1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
			<span class="kt">int</span> <span class="n">metaphysical_mode</span><span class="p">;</span>	<span class="cm">/* 1 = use metaphys mapping</span>
<span class="cm">						   0 = use virtual */</span>
			<span class="kt">int</span> <span class="n">banknum</span><span class="p">;</span>		<span class="cm">/* 0 or 1, which virtual</span>
<span class="cm">						   register bank is active */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rrs</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* region registers */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">krs</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>	<span class="cm">/* kernel registers */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* temp registers</span>
<span class="cm">						   (e.g. for hyperprivops) */</span>

			<span class="cm">/* itc paravirtualization</span>
<span class="cm">			 * vAR.ITC = mAR.ITC + itc_offset</span>
<span class="cm">			 * itc_last is one which was lastly passed to</span>
<span class="cm">			 * the guest OS in order to prevent it from</span>
<span class="cm">			 * going backwords.</span>
<span class="cm">			 */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">itc_offset</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">itc_last</span><span class="p">;</span>
		<span class="p">};</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">arch_vcpu_info</span> <span class="p">{</span>
	<span class="cm">/* nothing */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * This structure is used for magic page in domain pseudo physical address</span>
<span class="cm"> * space and the result of XENMEM_machine_memory_map.</span>
<span class="cm"> * As the XENMEM_machine_memory_map result,</span>
<span class="cm"> * xen_memory_map::nr_entries indicates the size in bytes</span>
<span class="cm"> * including struct xen_ia64_memmap_info. Not the number of entries.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">xen_ia64_memmap_info</span> <span class="p">{</span>
	<span class="kt">uint64_t</span> <span class="n">efi_memmap_size</span><span class="p">;</span>	<span class="cm">/* size of EFI memory map */</span>
	<span class="kt">uint64_t</span> <span class="n">efi_memdesc_size</span><span class="p">;</span>	<span class="cm">/* size of an EFI memory map</span>
<span class="cm">					 * descriptor */</span>
	<span class="kt">uint32_t</span> <span class="n">efi_memdesc_version</span><span class="p">;</span>	<span class="cm">/* memory descriptor version */</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">memdesc</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>		<span class="cm">/* array of efi_memory_desc_t */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">arch_shared_info</span> <span class="p">{</span>
	<span class="cm">/* PFN of the start_info page.	*/</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">start_info_pfn</span><span class="p">;</span>

	<span class="cm">/* Interrupt vector for event channel.	*/</span>
	<span class="kt">int</span> <span class="n">evtchn_vector</span><span class="p">;</span>

	<span class="cm">/* PFN of memmap_info page */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">memmap_info_num_pages</span><span class="p">;</span>	<span class="cm">/* currently only = 1 case is</span>
<span class="cm">						   supported. */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">memmap_info_pfn</span><span class="p">;</span>

	<span class="kt">uint64_t</span> <span class="n">pad</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xen_callback</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ip</span><span class="p">;</span>
<span class="p">};</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">xen_callback</span> <span class="n">xen_callback_t</span><span class="p">;</span>

<span class="cp">#endif </span><span class="cm">/* !__ASSEMBLY__ */</span><span class="cp"></span>

<span class="cm">/* Size of the shared_info area (this is not related to page size).  */</span>
<span class="cp">#define XSI_SHIFT			14</span>
<span class="cp">#define XSI_SIZE			(1 &lt;&lt; XSI_SHIFT)</span>
<span class="cm">/* Log size of mapped_regs area (64 KB - only 4KB is used).  */</span>
<span class="cp">#define XMAPPEDREGS_SHIFT		12</span>
<span class="cp">#define XMAPPEDREGS_SIZE		(1 &lt;&lt; XMAPPEDREGS_SHIFT)</span>
<span class="cm">/* Offset of XASI (Xen arch shared info) wrt XSI_BASE.	*/</span>
<span class="cp">#define XMAPPEDREGS_OFS			XSI_SIZE</span>

<span class="cm">/* Hyperprivops.  */</span>
<span class="cp">#define HYPERPRIVOP_START		0x1</span>
<span class="cp">#define HYPERPRIVOP_RFI			(HYPERPRIVOP_START + 0x0)</span>
<span class="cp">#define HYPERPRIVOP_RSM_DT		(HYPERPRIVOP_START + 0x1)</span>
<span class="cp">#define HYPERPRIVOP_SSM_DT		(HYPERPRIVOP_START + 0x2)</span>
<span class="cp">#define HYPERPRIVOP_COVER		(HYPERPRIVOP_START + 0x3)</span>
<span class="cp">#define HYPERPRIVOP_ITC_D		(HYPERPRIVOP_START + 0x4)</span>
<span class="cp">#define HYPERPRIVOP_ITC_I		(HYPERPRIVOP_START + 0x5)</span>
<span class="cp">#define HYPERPRIVOP_SSM_I		(HYPERPRIVOP_START + 0x6)</span>
<span class="cp">#define HYPERPRIVOP_GET_IVR		(HYPERPRIVOP_START + 0x7)</span>
<span class="cp">#define HYPERPRIVOP_GET_TPR		(HYPERPRIVOP_START + 0x8)</span>
<span class="cp">#define HYPERPRIVOP_SET_TPR		(HYPERPRIVOP_START + 0x9)</span>
<span class="cp">#define HYPERPRIVOP_EOI			(HYPERPRIVOP_START + 0xa)</span>
<span class="cp">#define HYPERPRIVOP_SET_ITM		(HYPERPRIVOP_START + 0xb)</span>
<span class="cp">#define HYPERPRIVOP_THASH		(HYPERPRIVOP_START + 0xc)</span>
<span class="cp">#define HYPERPRIVOP_PTC_GA		(HYPERPRIVOP_START + 0xd)</span>
<span class="cp">#define HYPERPRIVOP_ITR_D		(HYPERPRIVOP_START + 0xe)</span>
<span class="cp">#define HYPERPRIVOP_GET_RR		(HYPERPRIVOP_START + 0xf)</span>
<span class="cp">#define HYPERPRIVOP_SET_RR		(HYPERPRIVOP_START + 0x10)</span>
<span class="cp">#define HYPERPRIVOP_SET_KR		(HYPERPRIVOP_START + 0x11)</span>
<span class="cp">#define HYPERPRIVOP_FC			(HYPERPRIVOP_START + 0x12)</span>
<span class="cp">#define HYPERPRIVOP_GET_CPUID		(HYPERPRIVOP_START + 0x13)</span>
<span class="cp">#define HYPERPRIVOP_GET_PMD		(HYPERPRIVOP_START + 0x14)</span>
<span class="cp">#define HYPERPRIVOP_GET_EFLAG		(HYPERPRIVOP_START + 0x15)</span>
<span class="cp">#define HYPERPRIVOP_SET_EFLAG		(HYPERPRIVOP_START + 0x16)</span>
<span class="cp">#define HYPERPRIVOP_RSM_BE		(HYPERPRIVOP_START + 0x17)</span>
<span class="cp">#define HYPERPRIVOP_GET_PSR		(HYPERPRIVOP_START + 0x18)</span>
<span class="cp">#define HYPERPRIVOP_SET_RR0_TO_RR4	(HYPERPRIVOP_START + 0x19)</span>
<span class="cp">#define HYPERPRIVOP_MAX			(0x1a)</span>

<span class="cm">/* Fast and light hypercalls.  */</span>
<span class="cp">#define __HYPERVISOR_ia64_fast_eoi	__HYPERVISOR_arch_1</span>

<span class="cm">/* Xencomm macros.  */</span>
<span class="cp">#define XENCOMM_INLINE_MASK		0xf800000000000000UL</span>
<span class="cp">#define XENCOMM_INLINE_FLAG		0x8000000000000000UL</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="cm">/*</span>
<span class="cm"> * Optimization features.</span>
<span class="cm"> * The hypervisor may do some special optimizations for guests. This hypercall</span>
<span class="cm"> * can be used to switch on/of these special optimizations.</span>
<span class="cm"> */</span>
<span class="cp">#define __HYPERVISOR_opt_feature	0x700UL</span>

<span class="cp">#define XEN_IA64_OPTF_OFF		0x0</span>
<span class="cp">#define XEN_IA64_OPTF_ON		0x1</span>

<span class="cm">/*</span>
<span class="cm"> * If this feature is switched on, the hypervisor inserts the</span>
<span class="cm"> * tlb entries without calling the guests traphandler.</span>
<span class="cm"> * This is useful in guests using region 7 for identity mapping</span>
<span class="cm"> * like the linux kernel does.</span>
<span class="cm"> */</span>
<span class="cp">#define XEN_IA64_OPTF_IDENT_MAP_REG7	1</span>

<span class="cm">/* Identity mapping of region 4 addresses in HVM. */</span>
<span class="cp">#define XEN_IA64_OPTF_IDENT_MAP_REG4	2</span>

<span class="cm">/* Identity mapping of region 5 addresses in HVM. */</span>
<span class="cp">#define XEN_IA64_OPTF_IDENT_MAP_REG5	3</span>

<span class="cp">#define XEN_IA64_OPTF_IDENT_MAP_NOT_SET	 (0)</span>

<span class="k">struct</span> <span class="n">xen_ia64_opt_feature</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cmd</span><span class="p">;</span>	<span class="cm">/* Which feature */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">on</span><span class="p">;</span>	<span class="cm">/* Switch feature on/off */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="cm">/* The page protection bit mask of the pte.</span>
<span class="cm">			 * This will be or&#39;ed with the pte. */</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">pgprot</span><span class="p">;</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">key</span><span class="p">;</span>	<span class="cm">/* A protection key for itir.*/</span>
		<span class="p">};</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _ASM_IA64_XEN_INTERFACE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
