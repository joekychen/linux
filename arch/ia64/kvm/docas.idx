f | Makefile | g | 1.8K |  | matt mooney | mfm@muteddisk.com | 1300366976 |  | ia64: change to new flag variables  Replace EXTRA_CFLAGS with ccflags-y and EXTRA_AFLAGS with asflags-y.  Signed-off-by: matt mooney <mfm@muteddisk.com> Acked-by: WANG Cong <xiyou.wangcong@gmail.com> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | mmio.c | s | 8.6K | 302 | Uwe Kleine-König | u.kleine-koenig@pengutronix.de | 1288640314 |  | tree-wide: fix comment/printk typos  "gadget", "through", "command", "maintain", "maintain", "controller", "address", "between", "initiali[zs]e", "instead", "function", "select", "already", "equal", "access", "management", "hierarchy", "registration", "interest", "relative", "memory", "offset", "already",  Signed-off-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | kvm_lib.c | s | 655B | 21 | Jes Sorensen | jes@sgi.com | 1246187430 |  | KVM: ia64: fix ia64 build due to missing kallsyms_lookup() and double export  Fix problem with double export of certain symbols from vsprintf.c which we do not wish to export from the kvm-intel.ko module.  In addition, we do not have access to kallsyms_lookup() from the module, so make sure to #undef CONFIG_KALLSYMS  Signed-off-by: Jes Sorensen <jes@sgi.com> Acked-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | trampoline.S | g | 21K |  | Xiantao Zhang | xiantao.zhang@intel.com | 1209286868 |  | KVM: ia64: Add trampoline for guest/host mode switch  trampoline code targets for guest/host world switch.  Signed-off-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Avi Kivity <avi@qumranet.com>
f | vmm_ivt.S | g | 34K |  | Denys Vlasenko | vda.linux@googlemail.com | 1267611960 |  | Rename .text.ivt to .text..ivt.  Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | kvm_fw.c | s | 16K | 576 | Roel Kluin | roel.kluin@gmail.com | 1267457752 |  | KVM: ia64: remove redundant kvm_get_exit_data() NULL tests  kvm_get_exit_data() cannot return a NULL pointer.  Signed-off-by: Roel Kluin <roel.kluin@gmail.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | asm-offsets.c | s | 9.3K | 231 | Sam Ravnborg | sam@ravnborg.org | 1260619695 |  | drop explicit include of autoconf.h  kbuild.h forces include of autoconf.h on the commandline using -include - so we do not need to include the file explicit.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | lapic.h | s | 808B | 25 | Takuya Yoshikawa | yoshikawa.takuya@oss.ntt.co.jp | 1287910320 |  | KVM: ia64: define kvm_lapic_enabled() to fix a compile error  The following patch    commit 57ce1659316f4ca298919649f9b1b55862ac3826   KVM: x86: In DM_LOWEST, only deliver interrupts to vcpus with enabled LAPIC's  ignored the fact that kvm_irq_delivery_to_apic() was also used by ia64.  We define kvm_lapic_enabled() to fix a compile error caused by this. This will have the same effect as reverting the problematic patch for ia64.  Signed-off-by: Takuya Yoshikawa <yoshikawa.takuya@oss.ntt.co.jp> Signed-off-by: Avi Kivity <avi@redhat.com>
f | vcpu.h | s | 20K | 621 | Luck, Tony | tony.luck@intel.com | 1261928193 |  | KVM: ia64: fix build breakage due to host spinlock change  Len Brown pointed out that allmodconfig is broken for ia64 because of:  arch/ia64/kvm/vmm.c: In function 'vmm_spin_unlock': arch/ia64/kvm/vmm.c:70: error: 'spinlock_t' has no member named 'raw_lock'  KVM has it's own spinlock routines. It should not depend on the base kernel spinlock_t type (which changed when ia64 switched to ticket locks).  Define its own vmm_spinlock_t type.  Signed-off-by: Tony Luck <tony.luck@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | misc.h | s | 2.5K | 79 | Xiantao Zhang | xiantao.zhang@intel.com | 1230735109 |  | KVM: ia64: Re-organize data sturure of guests' data area  1. Increase the size of data area to 64M 2. Support more vcpus and memory, 128 vcpus and 256G memory are supported    for guests. 3. Add the boundary check for memory and vcpu allocation.  With this patch, kvm guest's data area looks as follow:   *   *            +----------------------+  ------- KVM_VM_DATA_SIZE   *            ||     vcpu[n]'s data   ||   ||     ___________________KVM_STK_OFFSET   *            ||                      ||   ||    /                   ||   *            ||        ..........    ||   ||   /vcpu's struct&stack ||   *            ||        ..........    ||   ||  /---------------------||---- 0   *            ||     vcpu[5]'s data   ||   || /       vpd            ||   *            ||     vcpu[4]'s data   ||   ||/-----------------------||   *            ||     vcpu[3]'s data   ||   /         vtlb           ||   *            ||     vcpu[2]'s data   ||  /||------------------------||   *            ||     vcpu[1]'s data   ||/  ||         vhpt           ||   *            ||     vcpu[0]'s data   ||____________________________||   *            +----------------------+   ||   *            ||    memory dirty log  ||   ||   *            +----------------------+   ||   *            ||    vm's data struct  ||   ||   *            +----------------------+   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||   vm's p2m table  ||      ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||  ||   * vm's data->||                      ||   ||  ||   *            +----------------------+ ------- 0   * To support large memory, needs to increase the size of p2m.   * To support more vcpus, needs to ensure it has enough space to   * hold vcpus' data.   */  Signed-off-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | vti.h | s | 7.7K | 259 | Jeff Mahoney | jeffm@suse.com | 1306067997 |  | KVM: ia64: fix sparse warnings  This patch fixes some sparse warning about "dubious one-bit signed bitfield."  Signed-off-by: Jeff Mahoney <jeffm@suse.com> Originally-by: Jan Blunck <jblunck@suse.de> Signed-off-by: Jan Blunck <jblunck@suse.de> Acked-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | memcpy.S | g | 27B |  | Xiantao Zhang | xiantao.zhang@intel.com | 1211110456 |  | KVM: ia64: fix GVMM module including position-dependent objects  The GVMM module is position independent since it is relocated to the guest address space.  Commit ea696f9cf ("ia64 kvm fixes for O=... builds") broke this by linking GVMM with non-PIC objects.  Fix by creating two files: memset.S and memcpy.S which just include the files under arch/ia64/lib/{memset.S, memcpy.S} respectively.  [akpm: don't delete files which we need]  Signed-off-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Avi Kivity <avi@qumranet.com>
f | kvm-ia64.c | s | 44K | 1646 | Avi Kivity | avi@redhat.com | 1334878543 |  | KVM: ia64: fix build due to typo  s/kcm/kvm/.  Signed-off-by: Avi Kivity <avi@redhat.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | Kconfig | g | 1.4K |  | Ohad Ben-Cohen | ohad@wizery.com | 1311403830 |  | virtio: expose for non-virtualization users too  virtio has been so far used only in the context of virtualization, and the virtio Kconfig was sourced directly by the relevant arch Kconfigs when VIRTUALIZATION was selected.  Now that we start using virtio for inter-processor communications, we need to source the virtio Kconfig outside of the virtualization scope too.  Moreover, some architectures might use virtio for both virtualization and inter-processor communications, so directly sourcing virtio might yield unexpected results due to conflicting selections.  The simple solution offered by this patch is to always source virtio's Kconfig in drivers/Kconfig, and remove it from the appropriate arch Kconfigs. Additionally, a virtio menu entry has been added so virtio drivers don't show up in the general drivers menu.  This way anyone can use virtio, though it's arguably less accessible (and neat!) for virtualization users now.  Note: some architectures (mips and sh) seem to have a VIRTUALIZATION menu merely for sourcing virtio's Kconfig, so that menu is removed too.  Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | vcpu.c | s | 50K | 1927 | Joe Perches | joe@perches.com | 1267457767 |  | KVM: ia64: Fix string literal continuation lines  String constants that are continued on subsequent lines with \ are not good.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | memset.S | g | 27B |  | Xiantao Zhang | xiantao.zhang@intel.com | 1211110456 |  | KVM: ia64: fix GVMM module including position-dependent objects  The GVMM module is position independent since it is relocated to the guest address space.  Commit ea696f9cf ("ia64 kvm fixes for O=... builds") broke this by linking GVMM with non-PIC objects.  Fix by creating two files: memset.S and memcpy.S which just include the files under arch/ia64/lib/{memset.S, memcpy.S} respectively.  [akpm: don't delete files which we need]  Signed-off-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Avi Kivity <avi@qumranet.com>
f | vmm.c | s | 2.3K | 81 | Avi Kivity | avi@redhat.com | 1274258189 |  | KVM: Let vcpu structure alignment be determined at runtime  vmx and svm vcpus have different contents and therefore may have different alignmment requirements.  Let each specify its required alignment.  Signed-off-by: Avi Kivity <avi@redhat.com>
f | process.c | s | 24K | 889 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | vtlb.c | s | 14K | 552 | Luck, Tony | tony.luck@intel.com | 1261928193 |  | KVM: ia64: fix build breakage due to host spinlock change  Len Brown pointed out that allmodconfig is broken for ia64 because of:  arch/ia64/kvm/vmm.c: In function 'vmm_spin_unlock': arch/ia64/kvm/vmm.c:70: error: 'spinlock_t' has no member named 'raw_lock'  KVM has it's own spinlock routines. It should not depend on the base kernel spinlock_t type (which changed when ia64 switched to ticket locks).  Define its own vmm_spinlock_t type.  Signed-off-by: Tony Luck <tony.luck@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | irq.h | s | 966B | 29 | Xiantao Zhang | xiantao.zhang@intel.com | 1237885393 |  | KVM: ia64: Fix the build errors due to lack of macros related to MSI.  Include the newly introduced msidef.h to solve the build issues.  Signed-off-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | optvfault.S | g | 19K |  | Jes Sorensen | jes@sgi.com | 1244623709 |  | KVM: ia64: Drop in SN2 replacement of fast path ITC emulation fault handler  Copy in SN2 RTC based ITC emulation for fast exit. The two versions have the same size, so a dropin is simpler than patching the branch instruction to hit the SN2 version.  Signed-off-by: Jes Sorensen <jes@sgi.com> Acked-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | kvm_minstate.h | s | 8.2K | 247 | Xiantao Zhang | xiantao.zhang@intel.com | 1230735109 |  | KVM: ia64: Re-organize data sturure of guests' data area  1. Increase the size of data area to 64M 2. Support more vcpus and memory, 128 vcpus and 256G memory are supported    for guests. 3. Add the boundary check for memory and vcpu allocation.  With this patch, kvm guest's data area looks as follow:   *   *            +----------------------+  ------- KVM_VM_DATA_SIZE   *            ||     vcpu[n]'s data   ||   ||     ___________________KVM_STK_OFFSET   *            ||                      ||   ||    /                   ||   *            ||        ..........    ||   ||   /vcpu's struct&stack ||   *            ||        ..........    ||   ||  /---------------------||---- 0   *            ||     vcpu[5]'s data   ||   || /       vpd            ||   *            ||     vcpu[4]'s data   ||   ||/-----------------------||   *            ||     vcpu[3]'s data   ||   /         vtlb           ||   *            ||     vcpu[2]'s data   ||  /||------------------------||   *            ||     vcpu[1]'s data   ||/  ||         vhpt           ||   *            ||     vcpu[0]'s data   ||____________________________||   *            +----------------------+   ||   *            ||    memory dirty log  ||   ||   *            +----------------------+   ||   *            ||    vm's data struct  ||   ||   *            +----------------------+   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||   vm's p2m table  ||      ||   *            ||                      ||   ||   *            ||                      ||   ||   *            ||                      ||   ||  ||   * vm's data->||                      ||   ||  ||   *            +----------------------+ ------- 0   * To support large memory, needs to increase the size of p2m.   * To support more vcpus, needs to ensure it has enough space to   * hold vcpus' data.   */  Signed-off-by: Xiantao Zhang <xiantao.zhang@intel.com> Signed-off-by: Avi Kivity <avi@redhat.com>
