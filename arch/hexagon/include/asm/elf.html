<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › hexagon › include › asm › elf.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>elf.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * ELF definitions for the Hexagon architecture</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2010-2011, Code Aurora Forum. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 and</span>
<span class="cm"> * only version 2 as published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span>
<span class="cm"> * 02110-1301, USA.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __ASM_ELF_H</span>
<span class="cp">#define __ASM_ELF_H</span>

<span class="cp">#include &lt;asm/ptrace.h&gt;</span>
<span class="cp">#include &lt;asm/user.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * This should really be in linux/elf-em.h.</span>
<span class="cm"> */</span>
<span class="cp">#define EM_HEXAGON	164   </span><span class="cm">/* QUALCOMM Hexagon */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">elf32_hdr</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * ELF header e_flags defines.</span>
<span class="cm"> */</span>

<span class="cm">/*  should have stuff like &quot;CPU type&quot; and maybe &quot;ABI version&quot;, etc  */</span>

<span class="cm">/* Hexagon relocations */</span>
  <span class="cm">/* V2 */</span>
<span class="cp">#define R_HEXAGON_NONE           0</span>
<span class="cp">#define R_HEXAGON_B22_PCREL      1</span>
<span class="cp">#define R_HEXAGON_B15_PCREL      2</span>
<span class="cp">#define R_HEXAGON_B7_PCREL       3</span>
<span class="cp">#define R_HEXAGON_LO16           4</span>
<span class="cp">#define R_HEXAGON_HI16           5</span>
<span class="cp">#define R_HEXAGON_32             6</span>
<span class="cp">#define R_HEXAGON_16             7</span>
<span class="cp">#define R_HEXAGON_8              8</span>
<span class="cp">#define R_HEXAGON_GPREL16_0      9</span>
<span class="cp">#define R_HEXAGON_GPREL16_1     10</span>
<span class="cp">#define R_HEXAGON_GPREL16_2     11</span>
<span class="cp">#define R_HEXAGON_GPREL16_3     12</span>
<span class="cp">#define R_HEXAGON_HL16          13</span>
  <span class="cm">/* V3 */</span>
<span class="cp">#define R_HEXAGON_B13_PCREL     14</span>
  <span class="cm">/* V4 */</span>
<span class="cp">#define R_HEXAGON_B9_PCREL      15</span>
  <span class="cm">/* V4 (extenders) */</span>
<span class="cp">#define R_HEXAGON_B32_PCREL_X   16</span>
<span class="cp">#define R_HEXAGON_32_6_X        17</span>
  <span class="cm">/* V4 (extended) */</span>
<span class="cp">#define R_HEXAGON_B22_PCREL_X   18</span>
<span class="cp">#define R_HEXAGON_B15_PCREL_X   19</span>
<span class="cp">#define R_HEXAGON_B13_PCREL_X   20</span>
<span class="cp">#define R_HEXAGON_B9_PCREL_X    21</span>
<span class="cp">#define R_HEXAGON_B7_PCREL_X    22</span>
<span class="cp">#define R_HEXAGON_16_X          23</span>
<span class="cp">#define R_HEXAGON_12_X          24</span>
<span class="cp">#define R_HEXAGON_11_X          25</span>
<span class="cp">#define R_HEXAGON_10_X          26</span>
<span class="cp">#define R_HEXAGON_9_X           27</span>
<span class="cp">#define R_HEXAGON_8_X           28</span>
<span class="cp">#define R_HEXAGON_7_X           29</span>
<span class="cp">#define R_HEXAGON_6_X           30</span>
  <span class="cm">/* V2 PIC */</span>
<span class="cp">#define R_HEXAGON_32_PCREL      31</span>
<span class="cp">#define R_HEXAGON_COPY          32</span>
<span class="cp">#define R_HEXAGON_GLOB_DAT      33</span>
<span class="cp">#define R_HEXAGON_JMP_SLOT      34</span>
<span class="cp">#define R_HEXAGON_RELATIVE      35</span>
<span class="cp">#define R_HEXAGON_PLT_B22_PCREL 36</span>
<span class="cp">#define R_HEXAGON_GOTOFF_LO16   37</span>
<span class="cp">#define R_HEXAGON_GOTOFF_HI16   38</span>
<span class="cp">#define R_HEXAGON_GOTOFF_32     39</span>
<span class="cp">#define R_HEXAGON_GOT_LO16      40</span>
<span class="cp">#define R_HEXAGON_GOT_HI16      41</span>
<span class="cp">#define R_HEXAGON_GOT_32        42</span>
<span class="cp">#define R_HEXAGON_GOT_16        43</span>

<span class="cm">/*</span>
<span class="cm"> * ELF register definitions..</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_greg_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">user_regs_struct</span> <span class="n">elf_gregset_t</span><span class="p">;</span>
<span class="cp">#define ELF_NGREG (sizeof(elf_gregset_t)/sizeof(unsigned long))</span>

<span class="cm">/*  Placeholder  */</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_fpregset_t</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Bypass the whole &quot;regsets&quot; thing for now and use the define.</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_CORE_COPY_REGS(DEST, REGS)	\</span>
<span class="cp">do {					\</span>
<span class="cp">	DEST.r0 = REGS-&gt;r00;		\</span>
<span class="cp">	DEST.r1 = REGS-&gt;r01;		\</span>
<span class="cp">	DEST.r2 = REGS-&gt;r02;		\</span>
<span class="cp">	DEST.r3 = REGS-&gt;r03;		\</span>
<span class="cp">	DEST.r4 = REGS-&gt;r04;		\</span>
<span class="cp">	DEST.r5 = REGS-&gt;r05;		\</span>
<span class="cp">	DEST.r6 = REGS-&gt;r06;		\</span>
<span class="cp">	DEST.r7 = REGS-&gt;r07;		\</span>
<span class="cp">	DEST.r8 = REGS-&gt;r08;		\</span>
<span class="cp">	DEST.r9 = REGS-&gt;r09;		\</span>
<span class="cp">	DEST.r10 = REGS-&gt;r10;		\</span>
<span class="cp">	DEST.r11 = REGS-&gt;r11;		\</span>
<span class="cp">	DEST.r12 = REGS-&gt;r12;		\</span>
<span class="cp">	DEST.r13 = REGS-&gt;r13;		\</span>
<span class="cp">	DEST.r14 = REGS-&gt;r14;		\</span>
<span class="cp">	DEST.r15 = REGS-&gt;r15;		\</span>
<span class="cp">	DEST.r16 = REGS-&gt;r16;		\</span>
<span class="cp">	DEST.r17 = REGS-&gt;r17;		\</span>
<span class="cp">	DEST.r18 = REGS-&gt;r18;		\</span>
<span class="cp">	DEST.r19 = REGS-&gt;r19;		\</span>
<span class="cp">	DEST.r20 = REGS-&gt;r20;		\</span>
<span class="cp">	DEST.r21 = REGS-&gt;r21;		\</span>
<span class="cp">	DEST.r22 = REGS-&gt;r22;		\</span>
<span class="cp">	DEST.r23 = REGS-&gt;r23;		\</span>
<span class="cp">	DEST.r24 = REGS-&gt;r24;		\</span>
<span class="cp">	DEST.r25 = REGS-&gt;r25;		\</span>
<span class="cp">	DEST.r26 = REGS-&gt;r26;		\</span>
<span class="cp">	DEST.r27 = REGS-&gt;r27;		\</span>
<span class="cp">	DEST.r28 = REGS-&gt;r28;		\</span>
<span class="cp">	DEST.r29 = pt_psp(REGS);	\</span>
<span class="cp">	DEST.r30 = REGS-&gt;r30;		\</span>
<span class="cp">	DEST.r31 = REGS-&gt;r31;		\</span>
<span class="cp">	DEST.sa0 = REGS-&gt;sa0;		\</span>
<span class="cp">	DEST.lc0 = REGS-&gt;lc0;		\</span>
<span class="cp">	DEST.sa1 = REGS-&gt;sa1;		\</span>
<span class="cp">	DEST.lc1 = REGS-&gt;lc1;		\</span>
<span class="cp">	DEST.m0 = REGS-&gt;m0;		\</span>
<span class="cp">	DEST.m1 = REGS-&gt;m1;		\</span>
<span class="cp">	DEST.usr = REGS-&gt;usr;		\</span>
<span class="cp">	DEST.p3_0 = REGS-&gt;preds;	\</span>
<span class="cp">	DEST.gp = REGS-&gt;gp;		\</span>
<span class="cp">	DEST.ugp = REGS-&gt;ugp;		\</span>
<span class="cp">	DEST.pc = pt_elr(REGS);	\</span>
<span class="cp">	DEST.cause = pt_cause(REGS);	\</span>
<span class="cp">	DEST.badva = pt_badva(REGS);	\</span>
<span class="cp">} while (0);</span>



<span class="cm">/*</span>
<span class="cm"> * This is used to ensure we don&#39;t load something for the wrong architecture.</span>
<span class="cm"> * Checks the machine and ABI type.</span>
<span class="cm"> */</span>
<span class="cp">#define elf_check_arch(hdr)	((hdr)-&gt;e_machine == EM_HEXAGON)</span>

<span class="cm">/*</span>
<span class="cm"> * These are used to set parameters in the core dumps.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_CLASS	ELFCLASS32</span>
<span class="cp">#define ELF_DATA	ELFDATA2LSB</span>
<span class="cp">#define ELF_ARCH	EM_HEXAGON</span>

<span class="cp">#ifdef CONFIG_HEXAGON_ARCH_V2</span>
<span class="cp">#define ELF_CORE_EFLAGS 0x1</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_HEXAGON_ARCH_V3</span>
<span class="cp">#define ELF_CORE_EFLAGS 0x2</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_HEXAGON_ARCH_V4</span>
<span class="cp">#define ELF_CORE_EFLAGS 0x3</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * Some architectures have ld.so set up a pointer to a function</span>
<span class="cm"> * to be registered using atexit, to facilitate cleanup.  So that</span>
<span class="cm"> * static executables will be well-behaved, we would null the register</span>
<span class="cm"> * in question here, in the pt_regs structure passed.  For now,</span>
<span class="cm"> * leave it a null macro.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_PLAT_INIT(regs, load_addr) do { } while (0)</span>

<span class="cp">#define USE_ELF_CORE_DUMP</span>
<span class="cp">#define CORE_DUMP_USE_REGSET</span>

<span class="cm">/* Hrm is this going to cause problems for changing PAGE_SIZE?  */</span>
<span class="cp">#define ELF_EXEC_PAGESIZE	4096</span>

<span class="cm">/*</span>
<span class="cm"> * This is the location that an ET_DYN program is loaded if exec&#39;ed.  Typical</span>
<span class="cm"> * use of this is to invoke &quot;./ld.so someprog&quot; to test out a new version of</span>
<span class="cm"> * the loader.  We need to make sure that it is out of the way of the program</span>
<span class="cm"> * that it will &quot;exec&quot;, and that there is sufficient room for the brk.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_ET_DYN_BASE         0x08000000UL</span>

<span class="cm">/*</span>
<span class="cm"> * This yields a mask that user programs can use to figure out what</span>
<span class="cm"> * instruction set this cpu supports.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_HWCAP	(0)</span>

<span class="cm">/*</span>
<span class="cm"> * This yields a string that ld.so will use to load implementation</span>
<span class="cm"> * specific libraries for optimization.  This is more specific in</span>
<span class="cm"> * intent than poking at uname or /proc/cpuinfo.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_PLATFORM  (NULL)</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#define SET_PERSONALITY(ex) set_personality(PER_LINUX)</span>
<span class="cp">#endif</span>

<span class="cp">#define ARCH_HAS_SETUP_ADDITIONAL_PAGES 1</span>
<span class="k">struct</span> <span class="n">linux_binprm</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">arch_setup_additional_pages</span><span class="p">(</span><span class="k">struct</span> <span class="n">linux_binprm</span> <span class="o">*</span><span class="n">bprm</span><span class="p">,</span>
				       <span class="kt">int</span> <span class="n">uses_interp</span><span class="p">);</span>


<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
