<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › sh › include › cpu-sh5 › cpu › cache.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>cache.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __ASM_SH_CPU_SH5_CACHE_H</span>
<span class="cp">#define __ASM_SH_CPU_SH5_CACHE_H</span>

<span class="cm">/*</span>
<span class="cm"> * include/asm-sh/cpu-sh5/cache.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2000, 2001  Paolo Alberelli</span>
<span class="cm"> * Copyright (C) 2003, 2004  Paul Mundt</span>
<span class="cm"> *</span>
<span class="cm"> * This file is subject to the terms and conditions of the GNU General Public</span>
<span class="cm"> * License.  See the file &quot;COPYING&quot; in the main directory of this archive</span>
<span class="cm"> * for more details.</span>
<span class="cm"> */</span>

<span class="cp">#define L1_CACHE_SHIFT		5</span>

<span class="cm">/* Valid and Dirty bits */</span>
<span class="cp">#define SH_CACHE_VALID		(1LL&lt;&lt;0)</span>
<span class="cp">#define SH_CACHE_UPDATED	(1LL&lt;&lt;57)</span>

<span class="cm">/* Unimplemented compat bits.. */</span>
<span class="cp">#define SH_CACHE_COMBINED	0</span>
<span class="cp">#define SH_CACHE_ASSOC		0</span>

<span class="cm">/* Cache flags */</span>
<span class="cp">#define SH_CACHE_MODE_WT	(1LL&lt;&lt;0)</span>
<span class="cp">#define SH_CACHE_MODE_WB	(1LL&lt;&lt;1)</span>

<span class="cm">/*</span>
<span class="cm"> * Control Registers.</span>
<span class="cm"> */</span>
<span class="cp">#define ICCR_BASE	0x01600000	</span><span class="cm">/* Instruction Cache Control Register */</span><span class="cp"></span>
<span class="cp">#define ICCR_REG0	0		</span><span class="cm">/* Register 0 offset */</span><span class="cp"></span>
<span class="cp">#define ICCR_REG1	1		</span><span class="cm">/* Register 1 offset */</span><span class="cp"></span>
<span class="cp">#define ICCR0		ICCR_BASE+ICCR_REG0</span>
<span class="cp">#define ICCR1		ICCR_BASE+ICCR_REG1</span>

<span class="cp">#define ICCR0_OFF	0x0		</span><span class="cm">/* Set ICACHE off */</span><span class="cp"></span>
<span class="cp">#define ICCR0_ON	0x1		</span><span class="cm">/* Set ICACHE on */</span><span class="cp"></span>
<span class="cp">#define ICCR0_ICI	0x2		</span><span class="cm">/* Invalidate all in IC */</span><span class="cp"></span>

<span class="cp">#define ICCR1_NOLOCK	0x0		</span><span class="cm">/* Set No Locking */</span><span class="cp"></span>

<span class="cp">#define OCCR_BASE	0x01E00000	</span><span class="cm">/* Operand Cache Control Register */</span><span class="cp"></span>
<span class="cp">#define OCCR_REG0	0		</span><span class="cm">/* Register 0 offset */</span><span class="cp"></span>
<span class="cp">#define OCCR_REG1	1		</span><span class="cm">/* Register 1 offset */</span><span class="cp"></span>
<span class="cp">#define OCCR0		OCCR_BASE+OCCR_REG0</span>
<span class="cp">#define OCCR1		OCCR_BASE+OCCR_REG1</span>

<span class="cp">#define OCCR0_OFF	0x0		</span><span class="cm">/* Set OCACHE off */</span><span class="cp"></span>
<span class="cp">#define OCCR0_ON	0x1		</span><span class="cm">/* Set OCACHE on */</span><span class="cp"></span>
<span class="cp">#define OCCR0_OCI	0x2		</span><span class="cm">/* Invalidate all in OC */</span><span class="cp"></span>
<span class="cp">#define OCCR0_WT	0x4		</span><span class="cm">/* Set OCACHE in WT Mode */</span><span class="cp"></span>
<span class="cp">#define OCCR0_WB	0x0		</span><span class="cm">/* Set OCACHE in WB Mode */</span><span class="cp"></span>

<span class="cp">#define OCCR1_NOLOCK	0x0		</span><span class="cm">/* Set No Locking */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * SH-5</span>
<span class="cm"> * A bit of description here, for neff=32.</span>
<span class="cm"> *</span>
<span class="cm"> *                               |&lt;--- tag  (19 bits) ---&gt;|</span>
<span class="cm"> * +-----------------------------+-----------------+------+----------+------+</span>
<span class="cm"> * |                             |                 | ways |set index |offset|</span>
<span class="cm"> * +-----------------------------+-----------------+------+----------+------+</span>
<span class="cm"> *                                ^                 2 bits   8 bits   5 bits</span>
<span class="cm"> *                                +- Bit 31</span>
<span class="cm"> *</span>
<span class="cm"> * Cacheline size is based on offset: 5 bits = 32 bytes per line</span>
<span class="cm"> * A cache line is identified by a tag + set but OCACHETAG/ICACHETAG</span>
<span class="cm"> * have a broader space for registers. These are outlined by</span>
<span class="cm"> * CACHE_?C_*_STEP below.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/* Instruction cache */</span>
<span class="cp">#define CACHE_IC_ADDRESS_ARRAY 0x01000000</span>

<span class="cm">/* Operand Cache */</span>
<span class="cp">#define CACHE_OC_ADDRESS_ARRAY 0x01800000</span>

<span class="cm">/* These declarations relate to cache &#39;synonyms&#39; in the operand cache.  A</span>
<span class="cm">   &#39;synonym&#39; occurs where effective address bits overlap between those used for</span>
<span class="cm">   indexing the cache sets and those passed to the MMU for translation.  In the</span>
<span class="cm">   case of SH5-101 &amp; SH5-103, only bit 12 is affected for 4k pages. */</span>

<span class="cp">#define CACHE_OC_N_SYNBITS  1               </span><span class="cm">/* Number of synonym bits */</span><span class="cp"></span>
<span class="cp">#define CACHE_OC_SYN_SHIFT  12</span>
<span class="cm">/* Mask to select synonym bit(s) */</span>
<span class="cp">#define CACHE_OC_SYN_MASK   (((1UL&lt;&lt;CACHE_OC_N_SYNBITS)-1)&lt;&lt;CACHE_OC_SYN_SHIFT)</span>

<span class="cm">/*</span>
<span class="cm"> * Instruction cache can&#39;t be invalidated based on physical addresses.</span>
<span class="cm"> * No Instruction Cache defines required, then.</span>
<span class="cm"> */</span>

<span class="cp">#endif </span><span class="cm">/* __ASM_SH_CPU_SH5_CACHE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
