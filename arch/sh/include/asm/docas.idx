f | io.h | s | 11K | 330 | Paul Mundt | lethal@linux-sh.org | 1336622875 |  | sh: Provide stubbed I/O routines for NO_IOPORT case.  Too many drivers fail at IOPORT vs IOMEM checking before blindly calling in to the API, so we may as well just provide basic stubs to get more build coverage. Other platforms already do this, too (tile, parisc, etc.)  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | atomic-irq.h | s | 1.4K | 57 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | kmap_types.h | s | 226B | 9 | Randy Dunlap | randy.dunlap@oracle.com | 1245206871 |  | kmap_types: make most arches use generic header file  Convert most arches to use asm-generic/kmap_types.h.  Move the KM_FENCE_ macro additions into asm-generic/kmap_types.h, controlled by __WITH_KM_FENCE from each arch's kmap_types.h file.  Would be nice to be able to add custom KM_types per arch, but I don't yet see a nice, clean way to do that.  Built on x86_64, i386, mips, sparc, alpha(tonyb), powerpc(tonyb), and 68k(tonyb).  Note: avr32 should be able to remove KM_PTE2 (since it's not used) and then just use the generic kmap_types.h file.  Get avr32 maintainer approval.  Signed-off-by: Randy Dunlap <randy.dunlap@oracle.com> Cc: <linux-arch@vger.kernel.org> Acked-by: Mike Frysinger <vapier@gentoo.org> Cc: Richard Henderson <rth@twiddle.net> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: Bryan Wu <cooloney@kernel.org> Cc: Mikael Starvik <starvik@axis.com> Cc: Hirokazu Takata <takata@linux-m32r.org> Cc: "Luck Tony" <tony.luck@intel.com> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: David Howells <dhowells@redhat.com> Cc: Kyle McMartin <kyle@mcmartin.ca> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Cc: "David S. Miller" <davem@davemloft.net> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: Arnd Bergmann <arnd@arndb.de> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | switch_to_32.h | s | 3.6K | 124 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | pci.h | s | 3.9K | 105 | Bjorn Helgaas | bhelgaas@google.com | 1330053544 |  | PCI: collapse pcibios_resource_to_bus  Everybody uses the generic pcibios_resource_to_bus() supplied by the core now, so remove the ARCH_HAS_GENERIC_PCI_OFFSETS used during conversion.  Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
f | sections.h | s | 331B | 9 | Francesco Virlinzi | francesco.virlinzi@st.com | 1297754694 |  | sh: Change __nosave_XXX symbols to long  This patch changes the:  - __nosave_begin  - __nosave_end symbols from 'void' to 'long' as required by the latest Gcc (4.5.2) which raises the compilation error:  cc1: warnings being treated as errors arch/sh/kernel/swsusp.c: In function 'pfn_is_nosave': arch/sh/kernel/swsusp.c:24:28: error: taking address of expression of type 'void' arch/sh/kernel/swsusp.c:25:26: error: taking address of expression of type 'void' arch/sh/kernel/swsusp.c:25:26: error: taking address of expression of type 'void' arch/sh/kernel/swsusp.c:25:26: error: taking address of expression of type 'void'  Signed-off-by: Francesco Virlinzi <francesco.virlinzi@st.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cmpxchg-irq.h | s | 825B | 34 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | pgtable-2level.h | s | 528B | 16 | Paul Mundt | lethal@linux-sh.org | 1263377919 |  | sh: Rename split-level pgtable headers.  These were originally named _nopmd and _pmd to follow their asm-generic counterparts, but we rename them to -2level and -3level for general consistency.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | pgtable_64.h | s | 11K | 267 | Paul Mundt | lethal@linux-sh.org | 1336976171 |  | sh64: Kill off unused fixed I/O mapping window.  This was reworked some time ago to go through fixmaps instead, leaving the range itself unused. As such, kill off the remaining references and hand over the remaining space for fixmaps directly. This also makes it possible to simplify the vmalloc fault case as we no longer have to care about the special section.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cmpxchg-llsc.h | s | 1.4K | 61 | Aoi Shinkai | shinkoi2005@gmail.com | 1244701915 |  | sh: Fix sh4a llsc-based cmpxchg()  This fixes up a typo in the ll/sc based cmpxchg code which apparently wasn't getting a lot of testing due to the swapped old/new pair. With that fixed up, the ll/sc code also starts using it and provides its own atomic_add_unless().  Signed-off-by: Aoi Shinkai <shinkoi2005@gmail.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | dma-register.h | s | 1.2K | 47 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1267495744 |  | dmaengine: shdma: separate DMA headers.  Separate SH DMA headers into ones, commonly used by both drivers, and ones, specific to each of them. This will make the future development of the dmaengine driver easier.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | barrier.h | s | 1.7K | 49 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | mmzone.h | s | 1.1K | 36 | KAMEZAWA Hiroyuki | kamezawa.hiroyu@jp.fujitsu.com | 1309209189 |  | Fix node_start/end_pfn() definition for mm/page_cgroup.c  commit 21a3c96 uses node_start/end_pfn(nid) for detection start/end of nodes. But, it's not defined in linux/mmzone.h but defined in /arch/???/include/mmzone.h which is included only under CONFIG_NEED_MULTIPLE_NODES=y.  Then, we see   mm/page_cgroup.c: In function 'page_cgroup_init':   mm/page_cgroup.c:308: error: implicit declaration of function 'node_start_pfn'   mm/page_cgroup.c:309: error: implicit declaration of function 'node_end_pfn'  So, fixiing page_cgroup.c is an idea...  But node_start_pfn()/node_end_pfn() is a very generic macro and should be implemented in the same manner for all archs. (m32r has different implementation...)  This patch removes definitions of node_start/end_pfn() in each archs and defines a unified one in linux/mmzone.h. It's not under CONFIG_NEED_MULTIPLE_NODES, now.  A result of macro expansion is here (mm/page_cgroup.c)  for !NUMA  start_pfn = ((&contig_page_data)->node_start_pfn);   end_pfn = ({ pg_data_t *__pgdat = (&contig_page_data); __pgdat->node_start_pfn + __pgdat->node_spanned_pages;});  for NUMA (x86-64)   start_pfn = ((node_data[nid])->node_start_pfn);   end_pfn = ({ pg_data_t *__pgdat = (node_data[nid]); __pgdat->node_start_pfn + __pgdat->node_spanned_pages;});  Changelog:  - fixed to avoid using "nid" twice in node_end_pfn() macro.  Reported-and-acked-by: Randy Dunlap <randy.dunlap@oracle.com> Reported-and-tested-by: Ingo Molnar <mingo@elte.hu> Acked-by: Mel Gorman <mgorman@suse.de> Signed-off-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | syscall_32.h | s | 2.2K | 85 | Matt Fleming | matt@console-pimps.org | 1246878993 |  | sh: Add ftrace syscall tracing support  Now that I've added TIF_SYSCALL_FTRACE the thread flags do not fit into a single byte any more. Code testing them now needs to be aware of the upper and lower bytes.  Signed-off-by: Matt Fleming <matt@console-pimps.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cache_insns_32.h | s | 603B | 16 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | romimage-macros.h | s | 1.1K | 66 | Kuninori Morimoto | morimoto.kuninori@renesas.com | 1252642756 |  | sh: add romimage-macros.h  romimage macros which are used in kfr2r09 is very useful for other board. This patch divides kfr2r09's romimage.h into romimage-macros and partner-jet-setup.  Signed-off-by: Kuninori Morimoto <morimoto.kuninori@renesas.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | hw_breakpoint.h | s | 1.8K | 56 | Linus Torvalds | torvalds@linux-foundation.org | 1274294163 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/lethal/sh-2.6  * git://git.kernel.org/pub/scm/linux/kernel/git/lethal/sh-2.6: (127 commits)   sh: update defconfigs.   sh: Fix up the NUMA build for recent LMB changes.   sh64: provide a stub per_cpu_trap_init() definition.   sh: fix up CONFIG_KEXEC=n build.   sh: fixup the docbook paths for clock framework shuffling.   driver core: Early dev_name() depends on slab_is_available().   sh: simplify WARN usage in SH clock driver   sh: Check return value of clk_get on ms7724   sh: Check return value of clk_get on ecovec24   sh: move sh clock-cpg.c contents to drivers/sh/clk-cpg.c   sh: move sh clock.c contents to drivers/sh/clk.   sh: move sh asm/clock.h contents to linux/sh_clk.h V2   sh: remove unused clock lookup   sh: switch boards to clkdev   sh: switch sh4-202 to clkdev   sh: switch shx3 to clkdev   sh: switch sh7757 to clkdev   sh: switch sh7763 to clkdev   sh: switch sh7780 to clkdev   sh: switch sh7786 to clkdev   ...
f | cachectl.h | s | 585B | 14 | Giuseppe Cavallaro | peppe.cavallaro@st.com | 1251107949 |  | sh: fix sys_cacheflush error checking  sys_cacheflush should return with EINVAL if the cache parameter is not one of ICACHE, DCACHE or BCACHE. So, we need to include 0 in the first check.  It also adds the three definitions above as wrapper of the existent macros.  PS: ltp cacheflush01 test now passes.  Signed-off-by: Giuseppe Cavallaro <peppe.cavallaro@st.com> Signed-off-by: Stuart Menefy <stuart.menefy@st.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cacheflush.h | s | 3.5K | 86 | Paul Mundt | lethal@linux-sh.org | 1291185591 |  | sh: Assume new page cache pages have dirty dcache lines.  This follows the ARM change c01778001a4f5ad9c62d882776235f3f31922fdd ("ARM: 6379/1: Assume new page cache pages have dirty D-cache") for the same rationale:      There are places in Linux where writes to newly allocated page     cache pages happen without a subsequent call to flush_dcache_page()     (several PIO drivers including USB HCD). This patch changes the     meaning of PG_arch_1 to be PG_dcache_clean and always flush the     D-cache for a newly mapped page in update_mmu_cache().  This addresses issues seen with executing binaries from MMC, in addition to some of the other HCDs that don't explicitly do cache management for their pipe-in buffers.  Requested-by: Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | mmu_context_32.h | s | 1.2K | 51 | Paul Mundt | lethal@linux-sh.org | 1264478320 |  | sh: Mass ctrl_in/outX to __raw_read/writeX conversion.  The old ctrl in/out routines are non-portable and unsuitable for cross-platform use. While drivers/sh has already been sanitized, there is still quite a lot of code that is not. This converts the arch/sh/ bits over, which permits us to flag the routines as deprecated whilst still building with -Werror for the architecture code, and to ensure that future users are not added.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | stacktrace.h | s | 567B | 18 | Richard Weinberger | richard@nod.at | 1306129335 |  | sh: remove warning and warning_symbol from struct stacktrace_ops  Both warning and warning_symbol are nowhere used. Let's get rid of them.  Signed-off-by: Richard Weinberger <richard@nod.at> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | unwinder.h | s | 817B | 24 | Matt Fleming | matt@console-pimps.org | 1250856164 |  | sh: unwinder: Introduce UNWINDER_BUG() and UNWINDER_BUG_ON()  We can't assume that if we execute the unwinder code and the unwinder was already running that it has faulted. Clearly two kernel threads can invoke the unwinder at the same time and may be running simultaneously.  The previous approach used BUG() and BUG_ON() in the unwinder code to detect whether the unwinder was incapable of unwinding the stack, and that the next available unwinder should be used instead. A better approach is to explicitly invoke a trap handler to switch unwinders when the current unwinder cannot continue.  Signed-off-by: Matt Fleming <matt@console-pimps.org>
f | traps.h | s | 440B | 17 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | segment.h | s | 839B | 26 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | tlb.h | s | 3.1K | 111 | Nobuhiro Iwamatsu | nobuhiro.iwamatsu.yj@renesas.com | 1306816061 |  | sh: asm/tlb.h needs linux/swap.h  Commit 1e56a56410bb64bce62d44563e35a143fc2d515f introduced the mmu_gather rework for sh, but missed a linux/swap.h include:  	CC      arch/sh/mm/tlb-urb.o 	In file included from arch/sh/mm/tlb-urb.c:14:0: 	arch/sh/include/asm/tlb.h: In function '__tlb_remove_page': 	arch/sh/include/asm/tlb.h:92:2: error: implicit declaration of function 'free_page_and_swap_cache'  Signed-off-by: Nobuhiro Iwamatsu <nobuhiro.iwamatsu.yj@renesas.com> CC: Peter Zijlstra <a.p.zijlstra@chello.nl> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | elf.h | s | 7.2K | 202 | Paul Mundt | lethal@linux-sh.org | 1276506133 |  | sh: update the FDPIC relocations.  Now that the FDPIC relocations have been given fixed numbers upstream, switch to using those. The previous values only applied to experimental toolchains that never made it in to the wild, so the impact remains minimal.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | adc.h | s | 214B | 10 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | seccomp.h | s | 241B | 7 | Paul Mundt | lethal@linux-sh.org | 1217619572 |  | sh: seccomp support.  This hooks up the seccomp thread flag and associated callback from the syscall tracer.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | unaligned-sh4a.h | s | 4.5K | 171 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | unaligned.h | s | 320B | 10 | Paul Mundt | lethal@linux-sh.org | 1244989483 |  | sh: Convert to asm-generic/unaligned.h.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | io_noioport.h | s | 765B | 33 | Paul Mundt | lethal@linux-sh.org | 1336622875 |  | sh: Provide stubbed I/O routines for NO_IOPORT case.  Too many drivers fail at IOPORT vs IOMEM checking before blindly calling in to the API, so we may as well just provide basic stubs to get more build coverage. Other platforms already do this, too (tile, parisc, etc.)  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | smc37c93x.h | s | 5.5K | 159 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | io_generic.h | s | 622B | 15 | Paul Mundt | lethal@linux-sh.org | 1288619344 |  | sh: machvec IO death.  This takes a bit of a sledgehammer to the machvec I/O routines. The iomem case requires no special casing and so can just be dropped outright. This only leaves the ioport casing for PCI and SuperIO mangling. With the SuperIO case going through the standard ioport mapping, it's possible to replace everything with generic routines.  With this done the standard I/O routines are tidied up and NO_IOPORT now gets default-enabled for the vast majority of boards.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cache_insns_64.h | s | 839B | 20 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | reboot.h | s | 433B | 15 | Paul Mundt | lethal@linux-sh.org | 1263973372 |  | sh: machine_ops based reboot support.  This provides a machine_ops-based reboot interface loosely cloned from x86, and converts the native sh32 and sh64 cases over to it.  Necessary both for tying in SMP support and also enabling platforms like SDK7786 to add support for their microcontroller-based power managers.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | traps_32.h | s | 1.6K | 61 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | ioctls.h | s | 4.4K | 92 | Kay Sievers | kay.sievers@vrfy.org | 1297980990 |  | tty: add TIOCVHANGUP to allow clean tty shutdown of all ttys  This is useful for system management software so that it can kick off things like gettys and everything that's started from a tty, before we reuse it from/for something else or shut it down.  Without this ioctl it would have to temporarily become the owner of the tty, then call vhangup() and then give it up again.  Cc: Lennart Poettering <lennart@poettering.net> Signed-off-by: Kay Sievers <kay.sievers@vrfy.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | atomic-llsc.h | s | 2.1K | 92 | Paul Mundt | lethal@linux-sh.org | 1262937737 |  | sh: consolidate atomic_cmpxchg()/atomic_add_unless() definitions.  The LL/SC and IRQ versions were using generic stubs while the GRB version was just reimplementing what it already had for the standard cmpxchg() code. As we have optimized cmpxchg() implementations that are decoupled from the atomic code, simply falling back on the generic wrapper does the right thing. With this in place the GRB case is unaffected while the LL/SC case gets to use its optimized cmpxchg().  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | smp.h | s | 1.7K | 55 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | watchdog.h | s | 4.1K | 151 | Paul Mundt | lethal@linux-sh.org | 1264478320 |  | sh: Mass ctrl_in/outX to __raw_read/writeX conversion.  The old ctrl in/out routines are non-portable and unsuitable for cross-platform use. While drivers/sh has already been sanitized, there is still quite a lot of code that is not. This converts the arch/sh/ bits over, which permits us to flag the routines as deprecated whilst still building with -Werror for the architecture code, and to ensure that future users are not added.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | ptrace_64.h | s | 463B | 18 | Eric Paris | eparis@redhat.com | 1326835016 |  | Audit: push audit success and retcode into arch ptrace.h  The audit system previously expected arches calling to audit_syscall_exit to supply as arguments if the syscall was a success and what the return code was. Audit also provides a helper AUDITSC_RESULT which was supposed to simplify things by converting from negative retcodes to an audit internal magic value stating success or failure.  This helper was wrong and could indicate that a valid pointer returned to userspace was a failed syscall.  The fix is to fix the layering foolishness.  We now pass audit_syscall_exit a struct pt_reg and it in turns calls back into arch code to collect the return value and to determine if the syscall was a success or failure.  We also define a generic is_syscall_success() macro which determines success/failure based on if the value is < -MAX_ERRNO.  This works for arches like x86 which do not use a separate mechanism to indicate syscall failure.  We make both the is_syscall_success() and regs_return_value() static inlines instead of macros.  The reason is because the audit function must take a void* for the regs.  (uml calls theirs struct uml_pt_regs instead of just struct pt_regs so audit_syscall_exit can't take a struct pt_regs).  Since the audit function takes a void* we need to use static inlines to cast it back to the arch correct structure to dereference it.  The other major change is that on some arches, like ia64, MIPS and ppc, we change regs_return_value() to give us the negative value on syscall failure. THE only other user of this macro, kretprobe_example.c, won't notice and it makes the value signed consistently for the audit functions across all archs.  In arch/sh/kernel/ptrace_64.c I see that we were using regs[9] in the old audit code as the return value.  But the ptrace_64.h code defined the macro regs_return_value() as regs[3].  I have no idea which one is correct, but this patch now uses the regs_return_value() function, so it now uses regs[3].  For powerpc we previously used regs->result but now use the regs_return_value() function which uses regs->gprs[3].  regs->gprs[3] is always positive so the regs_return_value(), much like ia64 makes it negative before calling the audit code when appropriate.  Signed-off-by: Eric Paris <eparis@redhat.com> Acked-by: H. Peter Anvin <hpa@zytor.com> [for x86 portion] Acked-by: Tony Luck <tony.luck@intel.com> [for ia64] Acked-by: Richard Weinberger <richard@nod.at> [for uml] Acked-by: David S. Miller <davem@davemloft.net> [for sparc] Acked-by: Ralf Baechle <ralf@linux-mips.org> [for mips] Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> [for ppc]
f | dma-mapping.h | s | 2.5K | 73 | Andrzej Pietrasiewicz | andrzej.p@samsung.com | 1332945397 |  | SH: adapt for dma_map_ops changes  Adapt core SH architecture code for dma_map_ops changes: replace alloc/free_coherent with generic alloc/free methods.  Signed-off-by: Andrzej Pietrasiewicz <andrzej.p@samsung.com> Acked-by: Kyungmin Park <kyungmin.park@samsung.com> Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com> Reviewed-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Paul Mundt <lethal@linux-sh.org>
f | machvec.h | s | 935B | 32 | Paul Mundt | lethal@linux-sh.org | 1337590441 |  | sh: Kill off machvec IRQ hinting.  Everything is using sparseirq these days, so we have no need to arbitrarily size nr_irqs ahead of time. The legacy IRQ pre-allocation likewise has no meaning for us, so that's killed off too. We now depend on nr_irqs expansion by the generic hardirq layer instead.  It's also worth noting that the majority of boards had completely bogus values for their nr_irqs relative to their CPU and configurations, so this ends up correcting behaviour for quite a few platforms.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | push-switch.h | s | 716B | 27 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | traps_64.h | s | 851B | 32 | Paul Mundt | lethal@linux-sh.org | 1336968248 |  | sh64: Provide EXPEVT helper.  We need a lookup_exception_vector() helper for sh64 in order to use the common page fault code.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | kdebug.h | s | 254B | 12 | Paul Mundt | lethal@linux-sh.org | 1336958854 |  | sh: Tidy up and generalize page fault error paths.  This follows the x86 changes for tidying up the page fault error paths. We'll build on top of this for _32/_64 unification.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | types.h | s | 418B | 18 | Paul Mundt | lethal@linux-sh.org | 1250269056 |  | sh: Add register alignment helpers for shared flushers.  This plugs in some register alignment helpers for the shared flushers, allowing them to also be used on SH-5. The main rationale here is that in the SH-5 case we have a variable ABI, where the pointer size may not equal the register width. This register extension is taken care of by the SH-5 code already today, and is otherwise unused on the SH-4 code. This combines the two and allows us to kill off the SH-5 implementation.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | bugs.h | s | 1.3K | 67 | Paul Mundt | lethal@linux-sh.org | 1255681258 |  | sh: Idle loop chainsawing for SMP-based light sleep.  This does a bit of chainsawing of the idle loop code to get light sleep working on SMP. Previously this was forcing secondary CPUs in to sleep mode with them not coming back if they didn't have their own local timers. Given that we use clockevents broadcasting by default, the CPU managing the clockevents can't have IRQs disabled before entering its sleep state.  This unfortunately leaves us with the age-old need_resched() race in between local_irq_enable() and cpu_sleep(), but at present this is unavoidable. After some more experimentation it may be possible to layer on SR.BL bit manipulation over top of this scheme to inhibit the race condition, but given the current potential for missing wakeups, this is left as a future exercise.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | bitops.h | s | 2.4K | 89 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | clock.h | s | 397B | 11 | Magnus Damm | damm@opensource.se | 1331587150 |  | sh: sh header sh_clk_ops rename  Convert the sh include asm/clock.h to use sh_clk_ops.  Signed-off-by: Magnus Damm <damm@opensource.se> Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | hw_irq.h | s | 876B | 27 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sparsemem.h | s | 404B | 13 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | uaccess_32.h | s | 3.7K | 165 | Paul Mundt | lethal@linux-sh.org | 1339550917 |  | sh: use the new generic strnlen_user() function  This discards both the _32 and _64 versions in favour of the consolidated generic one.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | dma.h | s | 3.7K | 118 | Paul Mundt | lethal@linux-sh.org | 1337421009 |  | sh: Kill off MAX_DMA_ADDRESS leftovers.  We don't support the ISA DMA API, so this is only ever misused. The dma-sh case inadvertently broke the dreamcast case by testing the wrong variable for the total number of channels, so this fixes that up too.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | checksum.h | s | 97B | 5 | Paul Mundt | lethal@linux-sh.org | 1244991642 |  | sh: Convert sh64 to use the generic checksum code.  This plugs in GENERIC_CSUM support on sh64, and kills off all of the old references.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | spi.h | s | 226B | 9 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | setup.h | s | 732B | 21 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | dwarf.h | s | 9.8K | 371 | Matt Fleming | matt@console-pimps.org | 1265596155 |  | sh: Optimise FDE/CIE lookup by using red-black trees  Now that the DWARF unwinder is being used to provide perf callstacks unwinding speed is an issue. It is no longer being used in exceptional circumstances where we don't care about runtime performance, e.g. when panicing, so it makes sense improve performance is possible.  With this patch I saw a 42% improvement in unwind time when calling return_address(1). Greater improvements will be seen as the number of levels unwound increases as each unwind is now cheaper.  Note that insertion time has doubled but that's just the price we pay for keeping the trees balanced. However, this is a one-time cost for kernel boot/module load and so the improvements in lookup time dominate the extra time we spend keeping the trees balanced.  Signed-off-by: Matt Fleming <matt@console-pimps.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | kprobes.h | s | 1.4K | 44 | Paul Mundt | lethal@linux-sh.org | 1276496213 |  | sh: Add kprobe-based event tracer.  This follows the x86/ppc changes for kprobe-based event tracing on sh. While kprobes is only supported on 32-bit sh, we provide the API for HAVE_REGS_AND_STACK_ACCESS_API for both 32 and 64-bit.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cache_insns.h | s | 195B | 8 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | fixmap.h | s | 4.1K | 122 | Paul Mundt | lethal@linux-sh.org | 1337337005 |  | Revert "sh: Ensure fixmap and store queue space can co-exist."  This reverts commit 20e7c297efeca0861adcca073a0d283da659834b. With store queues enabled the area above P4SEG has special properties from the MMU's point of view, which was causing fixmap failure. We'll have to do something else to satisfy the vmalloc range check.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | ptrace.h | s | 4.1K | 117 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | mmu_context.h | s | 4.4K | 156 | Paul Mundt | lethal@linux-sh.org | 1264478320 |  | sh: Mass ctrl_in/outX to __raw_read/writeX conversion.  The old ctrl in/out routines are non-portable and unsuitable for cross-platform use. While drivers/sh has already been sanitized, there is still quite a lot of code that is not. This converts the arch/sh/ bits over, which permits us to flag the routines as deprecated whilst still building with -Werror for the architecture code, and to ensure that future users are not added.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | sh7760fb.h | s | 5.6K | 168 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | ftrace.h | s | 1.4K | 39 | Paul Mundt | lethal@linux-sh.org | 1255488589 |  | sh: Provide CALLER_ADDRx definitions even when ftrace is disabled.  Despite being located in the ftrace header, the CALLER_ADDRx definitions are used by generic code. As such, we have to provide it generically, and given that there is no real dependence on ftrace in the first place, the definitions can just be moved out.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | mutex-llsc.h | s | 2.6K | 95 | Takashi Yoshii | yoshii.takashi@renesas.com | 1233197763 |  | sh: Fix up T-bit error handling in SH-4A mutex fastpath.  This corrects a deadlock encountered on ap325 in the cases where the mutex is contended and the slow-path needs to be fallen back upon.  Signed-off-by: Takashi YOSHII <yoshii.takashi@renesas.com> Signed-off-by: Kuninori Morimoto <morimoto.kuninori@renesas.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | string_32.h | s | 2.7K | 108 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | mc146818rtc.h | s | 151B | 6 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cache.h | s | 1.2K | 39 | Linus Torvalds | torvalds@linux-foundation.org | 1275407752 |  | Merge branch 'for-35' of git://repo.or.cz/linux-kbuild  * 'for-35' of git://repo.or.cz/linux-kbuild: (81 commits)   kbuild: Revert part of e8d400a to resolve a conflict   kbuild: Fix checking of scm-identifier variable   gconfig: add support to show hidden options that have prompts   menuconfig: add support to show hidden options which have prompts   gconfig: remove show_debug option   gconfig: remove dbg_print_ptype() and dbg_print_stype()   kconfig: fix zconfdump()   kconfig: some small fixes   add random binaries to .gitignore   kbuild: Include gen_initramfs_list.sh and the file list in the .d file   kconfig: recalc symbol value before showing search results   .gitignore: ignore *.lzo files   headerdep: perlcritic warning   scripts/Makefile.lib: Align the output of LZO   kbuild: Generate modules.builtin in make modules_install   Revert "kbuild: specify absolute paths for cscope"   kbuild: Do not unnecessarily regenerate modules.builtin   headers_install: use local file handles   headers_check: fix perl warnings   export_report: fix perl warnings   ...
f | vmlinux.lds.h | s | 519B | 21 | Paul Mundt | lethal@linux-sh.org | 1265956905 |  | sh64: fix up memory offset calculation.  The linker script offsets were broken by the recent 29/32-bit integration, so this fixes it up for sh64.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | user.h | s | 2.5K | 61 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | exec.h | s | 208B | 8 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | siu.h | s | 564B | 20 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1274514677 |  | sh: define DMA slaves per CPU type, remove now redundant header  Now that DMA slave IDs are only used used in platform specific code and have become opaque cookies for the rest of the code, we can make the, CPU specific too.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | entry-macros.S | g | 1.8K |  | Stuart Menefy | stuart.menefy@st.com | 1251101393 |  | sh: Remove implicit sign extension from assembler immediates  The SH instruction set has several instructions which accept an 8 bit immediate operand. For logical instructions this operand is zero extended, for arithmetic instructions the operand is sign extended. After adding an option to the assembler to check this, it was found that several pieces of assembly code were assuming this behaviour, and in one case getting it wrong.  So this patch explicitly sign extends any immediate operands, which makes it obvious what is happening, and fixes the one case which got it wrong.  Signed-off-by: Stuart Menefy <stuart.menefy@st.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | mmu_context_64.h | s | 2.0K | 64 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | stackprotector.h | s | 648B | 21 | Filippo Arcidiacono | filippo.arcidiacono@st.com | 1334817957 |  | sh: initial stack protector support.  This implements basic -fstack-protector support, based on the early ARM version in c743f38013aeff58ef6252601e397b5ba281c633. The SMP case is limited to the initial canary value, while the UP case handles per-task granularity (limited to 32-bit sh until a new enough sh64 compiler manifests itself).  Signed-off-by: Filippo Arcidiacono <filippo.arcidiacono@st.com> Reviewed-by: Carmelo Amoroso <carmelo.amoroso@st.com> Signed-off-by: Stuart Menefy <stuart.menefy@st.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | bug.h | s | 2.5K | 100 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | hardirq.h | s | 401B | 11 | Paul Mundt | lethal@linux-sh.org | 1255506148 |  | sh: Count NMIs in irq_cpustat_t.  This plugs in support for NMI counting per-CPU via irq_cpustat_t. Modelled after the x86 implementation.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | sigcontext.h | s | 906B | 35 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | word-at-a-time.h | s | 1.3K | 44 | Paul Mundt | lethal@linux-sh.org | 1339550917 |  | sh: use the new generic strnlen_user() function  This discards both the _32 and _64 versions in favour of the consolidated generic one.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | Kbuild | g | 1021B |  | Paul Mundt | lethal@linux-sh.org | 1339556387 |  | sh: Kill off additional asm-generic wrappers.  A few wrappers were overlooked in the initial conversion, take care of them now.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | processor_64.h | s | 5.5K | 191 | Linus Torvalds | torvalds@linux-foundation.org | 1337795947 |  | Merge branch 'x86-fpu-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  Pull fpu state cleanups from Ingo Molnar:  "This tree streamlines further aspects of FPU handling by eliminating   the prepare_to_copy() complication and moving that logic to   arch_dup_task_struct().    It also fixes the FPU dumps in threaded core dumps, removes and old   (and now invalid) assumption plus micro-optimizes the exit path by   avoiding an FPU save for dead tasks."  Fixed up trivial add-add conflict in arch/sh/kernel/process.c that came in because we now do the FPU handling in arch_dup_task_struct() rather than the legacy (and now gone) prepare_to_copy().  * 'x86-fpu-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:   x86, fpu: drop the fpu state during thread exit   x86, xsave: remove thread_has_fpu() bug check in __sanitize_i387_state()   coredump: ensure the fpu state is flushed for proper multi-threaded core dump   fork: move the real prepare_to_copy() users to arch_dup_task_struct()
f | suspend.h | s | 2.5K | 75 | Rafael J. Wysocki | rjw@sisk.pl | 1306272955 |  | PM / Hibernate: Remove arch_prepare_suspend()  All architectures supporting hibernation define arch_prepare_suspend() as an empty function, so remove it.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | bl_bit.h | s | 169B | 8 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | futex.h | s | 1.8K | 64 | Michel Lespinasse | walken@google.com | 1299842611 |  | futex: Sanitize futex ops argument types  Change futex_atomic_op_inuser and futex_atomic_cmpxchg_inatomic prototypes to use u32 types for the futex as this is the data type the futex core code uses all over the place.  Signed-off-by: Michel Lespinasse <walken@google.com> Cc: Darren Hart <darren@dvhart.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Matt Turner <mattst88@gmail.com> Cc: Russell King <linux@arm.linux.org.uk> Cc: David Howells <dhowells@redhat.com> Cc: Tony Luck <tony.luck@intel.com> Cc: Michal Simek <monstr@monstr.eu> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: "James E.J. Bottomley" <jejb@parisc-linux.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Cc: "David S. Miller" <davem@davemloft.net> Cc: Chris Metcalf <cmetcalf@tilera.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> LKML-Reference: <20110311025058.GD26122@google.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | mmu.h | s | 2.1K | 83 | Paul Mundt | lethal@linux-sh.org | 1268206188 |  | sh: Fix up NUMA build for 29-bit.  pmb_bolt_mapping() is undefined on 29-bit builds, so provide a stub. This fixes up the NUMA build on platforms lacking PMB support.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | addrspace.h | s | 2.0K | 60 | Paul Mundt | lethal@linux-sh.org | 1288841544 |  | sh: nommu: use 32-bit phys mode.  The nommu code has regressed somewhat in that 29BIT gets set for the SH-2/2A configs regardless of the fact that they are really 32BIT sans MMU or PMB. This does a bit of tidying to get nommu properly selecting 32BIT as it was before.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | bl_bit_64.h | s | 979B | 32 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | device.h | s | 450B | 14 | Paul Mundt | lethal@linux-sh.org | 1326439658 |  | sh: Defer to asm-generic/device.h.  Now that the hwblk use cases have been ripped out, we can revert to asm-generic/device.h for the device/platform device arch data structures.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | unistd_32.h | s | 10K | 378 | Paul Mundt | lethal@linux-sh.org | 1332922205 |  | sh: Consolidate duplicate _32/_64 unistd definitions.  This does some more tidying and converging of the header split, following the x86 example.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | heartbeat.h | s | 344B | 14 | Kuninori Morimoto | morimoto.kuninori@renesas.com | 1250597789 |  | sh: Prevent heartbeat from scribbling over non-LED bits.  While most platforms implement LED banks in sets of 8/16/32, some use different configurations. This adds a LED mask to the heartbeat platform data to allow platforms to constrain the bitmap, which is otherwise derived from the register size.  Signed-off-by: Kuninori Morimoto <morimoto.kuninori@renesas.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | posix_types.h | s | 238B | 13 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | atomic.h | s | 1.8K | 58 | Nobuhiro Iwamatsu | nobuhiro.iwamatsu.yj@renesas.com | 1335490958 |  | sh: Fix up tracepoint build fallout from static key introduction.  With the introduction of static keys, anything using tracepoints blows up in the following manner:  include/trace/events/oom.h:8:13: error: initializer element is not constant include/trace/events/oom.h:8:13: error: (near initialization for '__tracepoint_oom_score_adj_update') include/trace/events/oom.h:8:13: error: initializer element is not constant include/trace/events/oom.h:8:13: error: (near initialization for '__tracepoint_oom_score_adj_update.key')  This is a result of the STATIC_KEY_INIT_xxx defs wrapping ATOMIC_INIT() which on sh includes an atomic_t typecast. Given that we don't really need the typecast for anything anymore, the simplest solution is simply to kill off the cast.  Signed-off-by: Nobuhiro Iwamatsu <nobuhiro.iwamatsu.yj@renesas.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | spinlock_types.h | s | 424B | 15 | Thomas Gleixner | tglx@linutronix.de | 1260831332 |  | locking: Convert raw_rwlock to arch_rwlock  Not strictly necessary for -rt as -rt does not have non sleeping rwlocks, but it's odd to not have a consistent naming convention.  No functional change.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Ingo Molnar <mingo@elte.hu> Cc: linux-arch@vger.kernel.org
f | bitops-llsc.h | s | 2.8K | 123 | Matt Fleming | matt@console-pimps.org | 1233197829 |  | sh: Relax inline assembly constraints  When dereferencing the memory address contained in a register and modifying the value at that memory address, the register should not be listed in the inline asm outputs. The value at the memory address is an output (which is taken care of with the "memory" clobber), not the register.  Signed-off-by: Matt Fleming <matt@console-pimps.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | linkage.h | s | 115B | 5 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | mutex.h | s | 377B | 12 | Michael Trimarchi | trimarchimichael@yahoo.it | 1229938975 |  | sh: Add SH-4A optimized fastpath mutex implementation.  Add fast mutex path implementation for the SH4A architecture  Signed-off-by: Michael Trimarchi <trimarchimichael@yahoo.it> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | tlbflush.h | s | 1.7K | 41 | Paul Mundt | lethal@linux-sh.org | 1278053049 |  | sh: Provide a global TLB flush for U/I-TLB clear.  This provides a sledgehammer approach for clearing the TLBs, only to be used in cases where we know we will never want to use the mappings again and have no interest in preserving state. This also destroys wired entries.  The primary use for this is when we are either entering or exiting the kernel completely, in the latter case as a precursor for CPU reset by MMU.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | dmabrg.h | s | 497B | 19 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | bl_bit_32.h | s | 600B | 28 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | sh_bios.h | s | 704B | 19 | Paul Mundt | lethal@linux-sh.org | 1263277571 |  | sh: Kill off more unused sh_bios callbacks.  sh_bios_char_out() is not used by anything in-tree these days, so just get rid of it.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | perf_event.h | s | 758B | 24 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1287424730 |  | irq_work: Add generic hardirq context callbacks  Provide a mechanism that allows running code in IRQ context. It is most useful for NMI code that needs to interact with the rest of the system -- like wakeup a task to drain buffers.  Perf currently has such a mechanism, so extract that and provide it as a generic feature, independent of perf so that others may also benefit.  The IRQ context callback is generated through self-IPIs where possible, or on architectures like powerpc the decrementer (the built-in timer facility) is set to generate an interrupt immediately.  Architectures that don't have anything like this get to do with a callback from the timer tick. These architectures can call irq_work_run() at the tail of any IRQ handlers that might enqueue such work (like the perf IRQ handler) to avoid undue latencies in processing the work.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Acked-by: Kyle McMartin <kyle@mcmartin.ca> Acked-by: Martin Schwidefsky <schwidefsky@de.ibm.com> [ various fixes ] Signed-off-by: Huang Ying <ying.huang@intel.com> LKML-Reference: <1287036094.7768.291.camel@yhuang-dev> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | i2c-sh7760.h | s | 367B | 14 | Paul Mundt | lethal@linux-sh.org | 1337320351 |  | sh: edosk7760 evt2irq migration.  Migrate edosk7760 to evt2irq() backed hwirq lookups.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | hugetlb.h | s | 2.0K | 75 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | uncached.h | s | 1.3K | 52 | Paul Mundt | lethal@linux-sh.org | 1288842379 |  | sh: nommu: Support building without an uncached mapping.  Now that nommu selects 32BIT we run in to the situation where SH-2A supports an uncached identity mapping by way of the BSC, while the SH-2 does not. This provides stubs for the PC manglers and tidies up some of the system*.h mess in the process.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | irqflags.h | s | 187B | 6 | David Howells | dhowells@redhat.com | 1286456935 |  | Fix IRQ flag handling naming  Fix the IRQ flag handling naming.  In linux/irqflags.h under one configuration, it maps:  	local_irq_enable() -> raw_local_irq_enable() 	local_irq_disable() -> raw_local_irq_disable() 	local_irq_save() -> raw_local_irq_save() 	...  and under the other configuration, it maps:  	raw_local_irq_enable() -> local_irq_enable() 	raw_local_irq_disable() -> local_irq_disable() 	raw_local_irq_save() -> local_irq_save() 	...  This is quite confusing.  There should be one set of names expected of the arch, and this should be wrapped to give another set of names that are expected by users of this facility.  Change this to have the arch provide:  	flags = arch_local_save_flags() 	flags = arch_local_irq_save() 	arch_local_irq_restore(flags) 	arch_local_irq_disable() 	arch_local_irq_enable() 	arch_irqs_disabled_flags(flags) 	arch_irqs_disabled() 	arch_safe_halt()  Then linux/irqflags.h wraps these to provide:  	raw_local_save_flags(flags) 	raw_local_irq_save(flags) 	raw_local_irq_restore(flags) 	raw_local_irq_disable() 	raw_local_irq_enable() 	raw_irqs_disabled_flags(flags) 	raw_irqs_disabled() 	raw_safe_halt()  with type checking on the flags 'arguments', and then wraps those to provide:  	local_save_flags(flags) 	local_irq_save(flags) 	local_irq_restore(flags) 	local_irq_disable() 	local_irq_enable() 	irqs_disabled_flags(flags) 	irqs_disabled() 	safe_halt()  with tracing included if enabled.  The arch functions can now all be inline functions rather than some of them having to be macros.  Signed-off-by: David Howells <dhowells@redhat.com> [X86, FRV, MN10300] Signed-off-by: Chris Metcalf <cmetcalf@tilera.com> [Tile] Signed-off-by: Michal Simek <monstr@monstr.eu> [Microblaze] Tested-by: Catalin Marinas <catalin.marinas@arm.com> [ARM] Acked-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Haavard Skinnemoen <haavard.skinnemoen@atmel.com> [AVR] Acked-by: Tony Luck <tony.luck@intel.com> [IA-64] Acked-by: Hirokazu Takata <takata@linux-m32r.org> [M32R] Acked-by: Greg Ungerer <gerg@uclinux.org> [M68K/M68KNOMMU] Acked-by: Ralf Baechle <ralf@linux-mips.org> [MIPS] Acked-by: Kyle McMartin <kyle@mcmartin.ca> [PA-RISC] Acked-by: Paul Mackerras <paulus@samba.org> [PowerPC] Acked-by: Martin Schwidefsky <schwidefsky@de.ibm.com> [S390] Acked-by: Chen Liqin <liqin.chen@sunplusct.com> [Score] Acked-by: Matt Fleming <matt@console-pimps.org> [SH] Acked-by: David S. Miller <davem@davemloft.net> [Sparc] Acked-by: Chris Zankel <chris@zankel.net> [Xtensa] Reviewed-by: Richard Henderson <rth@twiddle.net> [Alpha] Reviewed-by: Yoshinori Sato <ysato@users.sourceforge.jp> [H8300] Cc: starvik@axis.com [CRIS] Cc: jesper.nilsson@axis.com [CRIS] Cc: linux-cris-kernel@axis.com
f | kexec.h | s | 2.6K | 59 | Paul Mundt | lethal@linux-sh.org | 1273211695 |  | sh: convert kexec crash kernel management to LMB.  This migrates the crash kernel handling off of bootmem and over to LMB.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | alignment.h | s | 615B | 15 | Paul Mundt | lethal@linux-sh.org | 1263280345 |  | sh: Split out the unaligned counters and user bits.  This splits out the unaligned access counters and userspace bits in to their own generic interface, which will allow them to be wired up on sh64 too.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | unistd.h | s | 1.3K | 45 | Al Viro | viro@zeniv.linux.org.uk | 1337659086 |  | sh: switch to saved_sigmask-based sigsuspend()/rt_sigsuspend()  Complete the move of sh64 to it, trim the crap from prototypes, tidy up a bit.  Infrastructure in do_signal() had already been there, in signal_64 as well as in signal_32 (where it was already used).  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | pgtable_32.h | s | 17K | 424 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | topology.h | s | 658B | 17 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1336568455 |  | sched/numa: Rewrite the CONFIG_NUMA sched domain support  The current code groups up to 16 nodes in a level and then puts an ALLNODES domain spanning the entire tree on top of that. This doesn't reflect the numa topology and esp for the smaller not-fully-connected machines out there today this might make a difference.  Therefore, build a proper numa topology based on node_distance().  Since there's no fixed numa layers anymore, the static SD_NODE_INIT and SD_ALLNODES_INIT aren't usable anymore, the new code tries to construct something similar and scales some values either on the number of cpus in the domain and/or the node_distance() ratio.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Anton Blanchard <anton@samba.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Chris Metcalf <cmetcalf@tilera.com> Cc: David Howells <dhowells@redhat.com> Cc: "David S. Miller" <davem@davemloft.net> Cc: Fenghua Yu <fenghua.yu@intel.com> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: linux-alpha@vger.kernel.org Cc: linux-ia64@vger.kernel.org Cc: linux-kernel@vger.kernel.org Cc: linux-mips@linux-mips.org Cc: linuxppc-dev@lists.ozlabs.org Cc: linux-sh@vger.kernel.org Cc: Matt Turner <mattst88@gmail.com> Cc: Paul Mackerras <paulus@samba.org> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Richard Henderson <rth@twiddle.net> Cc: sparclinux@vger.kernel.org Cc: Tony Luck <tony.luck@intel.com> Cc: x86@kernel.org Cc: Dimitri Sivanich <sivanich@sgi.com> Cc: Greg Pearson <greg.pearson@hp.com> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: bob.picco@oracle.com Cc: chris.mason@oracle.com Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Andrew Morton <akpm@linux-foundation.org> Link: http://lkml.kernel.org/n/tip-r74n3n8hhuc2ynbrnp3vt954@git.kernel.org Signed-off-by: Ingo Molnar <mingo@kernel.org>
f | string.h | s | 84B | 5 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | unistd_64.h | s | 11K | 397 | Paul Mundt | lethal@linux-sh.org | 1332922205 |  | sh: Consolidate duplicate _32/_64 unistd definitions.  This does some more tidying and converging of the header split, following the x86 example.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | posix_types_64.h | s | 973B | 24 | Al Viro | viro@zeniv.linux.org.uk | 1338426290 |  | bury __kernel_nlink_t, make internal nlink_t consistent  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | syscall.h | s | 220B | 9 | Mike Frysinger | vapier@gentoo.org | 1266408441 |  | tracing: Unify arch_syscall_addr() implementations  Most implementations of arch_syscall_addr() are the same, so create a default version in common code and move the one piece that differs (the syscall table) to asm/syscall.h.  New arch ports don't have to waste time copying & pasting this simple function.  The s390/sparc versions need to be different, so document why.  Signed-off-by: Mike Frysinger <vapier@gentoo.org> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Paul Mundt <lethal@linux-sh.org> Acked-by: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Steven Rostedt <rostedt@goodmis.org> LKML-Reference: <1264498803-17278-1-git-send-email-vapier@gentoo.org> Signed-off-by: Frederic Weisbecker <fweisbec@gmail.com>
f | syscall_64.h | s | 1.5K | 55 | Paul Mundt | lethal@linux-sh.org | 1233197763 |  | sh: Fix up spurious syscall restarting.  The T-bit manipulation for syscall error checking had the side effect of spuriously returning ERESTART* errno values over EINTR. So, we simplify the error checking a bit and leave the T-bit alone.  Reported-by: Kaz Kojima <kkojima@rr.iij4u.or.jp> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | uaccess_64.h | s | 2.2K | 81 | Paul Mundt | lethal@linux-sh.org | 1339550917 |  | sh: use the new generic strnlen_user() function  This discards both the _32 and _64 versions in favour of the consolidated generic one.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | module.h | s | 1.1K | 44 | Matt Fleming | matt@console-pimps.org | 1265596155 |  | sh: Optimise FDE/CIE lookup by using red-black trees  Now that the DWARF unwinder is being used to provide perf callstacks unwinding speed is an issue. It is no longer being used in exceptional circumstances where we don't care about runtime performance, e.g. when panicing, so it makes sense improve performance is possible.  With this patch I saw a 42% improvement in unwind time when calling return_address(1). Greater improvements will be seen as the number of levels unwound increases as each unwind is now cheaper.  Note that insertion time has doubled but that's just the price we pay for keeping the trees balanced. However, this is a one-time cost for kernel boot/module load and so the improvements in lookup time dominate the extra time we spend keeping the trees balanced.  Signed-off-by: Matt Fleming <matt@console-pimps.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | flat.h | s | 1.0K | 27 | Oskar Schirmer | os@emlix.com | 1243611602 |  | flat: fix data sections alignment  The flat loader uses an architecture's flat_stack_align() to align the stack but assumes word-alignment is enough for the data sections.  However, on the Xtensa S6000 we have registers up to 128bit width which can be used from userspace and therefor need userspace stack and data-section alignment of at least this size.  This patch drops flat_stack_align() and uses the same alignment that is required for slab caches, ARCH_SLAB_MINALIGN, or wordsize if it's not defined by the architecture.  It also fixes m32r which was obviously kaput, aligning an uninitialized stack entry instead of the stack pointer.  [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: Oskar Schirmer <os@emlix.com> Cc: David Howells <dhowells@redhat.com> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Bryan Wu <cooloney@kernel.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Acked-by: Paul Mundt <lethal@linux-sh.org> Cc: Greg Ungerer <gerg@uclinux.org> Signed-off-by: Johannes Weiner <jw@emlix.com> Acked-by: Mike Frysinger <vapier.adi@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | io_trapped.h | s | 1.4K | 47 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | processor.h | s | 4.4K | 147 | Linus Torvalds | torvalds@linux-foundation.org | 1337788840 |  | 
f | page.h | s | 6.0K | 179 | Nobuhiro Iwamatsu | nobuhiro.iwamatsu.yj@renesas.com | 1320412430 |  | sh: Fix cached/uncaced address calculation in 29bit mode  In the case of 29bit mode, CAC/UNCAC_ADDR does not return a right address. This revises this problem by using P1SEGADDR and P2SEGADDR in 29bit mode.  Reported-by: Yutaro Ebihara <ebiharaml@si-linux.co.jp> Signed-off-by: Nobuhiro Iwamatsu <nobuhiro.iwamatsu.yj@renesas.com> Tested-by: Kuninori Morimoto <kuninori.morimoto.gx@renesas.com> Tested-by: Simon Horman <horms@verge.net.au> Cc: stable@kernel.org Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | syscalls.h | s | 517B | 16 | Christoph Hellwig | hch@lst.de | 1268437952 |  | Add generic sys_olduname()  Add generic implementations of the old and really old uname system calls. Note that sh only implements sys_olduname but not sys_oldolduname, but I'm not going to bother with another ifdef for that special case.  m32r implemented an old uname but never wired it up, so kill it, too.  Signed-off-by: Christoph Hellwig <hch@lst.de> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Jeff Dike <jdike@addtoit.com> Cc: Hirokazu Takata <takata@linux-m32r.org> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Ingo Molnar <mingo@elte.hu> Cc: H. Peter Anvin <hpa@zytor.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Arnd Bergmann <arnd@arndb.de> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: "Luck, Tony" <tony.luck@intel.com> Cc: James Morris <jmorris@namei.org> Cc: Andreas Schwab <schwab@linux-m68k.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cmpxchg.h | s | 1.6K | 59 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | futex-irq.h | s | 1.8K | 78 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | ptrace_32.h | s | 1.7K | 74 | Eric Paris | eparis@redhat.com | 1326835016 |  | Audit: push audit success and retcode into arch ptrace.h  The audit system previously expected arches calling to audit_syscall_exit to supply as arguments if the syscall was a success and what the return code was. Audit also provides a helper AUDITSC_RESULT which was supposed to simplify things by converting from negative retcodes to an audit internal magic value stating success or failure.  This helper was wrong and could indicate that a valid pointer returned to userspace was a failed syscall.  The fix is to fix the layering foolishness.  We now pass audit_syscall_exit a struct pt_reg and it in turns calls back into arch code to collect the return value and to determine if the syscall was a success or failure.  We also define a generic is_syscall_success() macro which determines success/failure based on if the value is < -MAX_ERRNO.  This works for arches like x86 which do not use a separate mechanism to indicate syscall failure.  We make both the is_syscall_success() and regs_return_value() static inlines instead of macros.  The reason is because the audit function must take a void* for the regs.  (uml calls theirs struct uml_pt_regs instead of just struct pt_regs so audit_syscall_exit can't take a struct pt_regs).  Since the audit function takes a void* we need to use static inlines to cast it back to the arch correct structure to dereference it.  The other major change is that on some arches, like ia64, MIPS and ppc, we change regs_return_value() to give us the negative value on syscall failure. THE only other user of this macro, kretprobe_example.c, won't notice and it makes the value signed consistently for the audit functions across all archs.  In arch/sh/kernel/ptrace_64.c I see that we were using regs[9] in the old audit code as the return value.  But the ptrace_64.h code defined the macro regs_return_value() as regs[3].  I have no idea which one is correct, but this patch now uses the regs_return_value() function, so it now uses regs[3].  For powerpc we previously used regs->result but now use the regs_return_value() function which uses regs->gprs[3].  regs->gprs[3] is always positive so the regs_return_value(), much like ia64 makes it negative before calling the audit code when appropriate.  Signed-off-by: Eric Paris <eparis@redhat.com> Acked-by: H. Peter Anvin <hpa@zytor.com> [for x86 portion] Acked-by: Tony Luck <tony.luck@intel.com> [for ia64] Acked-by: Richard Weinberger <richard@nod.at> [for uml] Acked-by: David S. Miller <davem@davemloft.net> [for sparc] Acked-by: Ralf Baechle <ralf@linux-mips.org> [for mips] Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> [for ppc]
f | auxvec.h | s | 1.0K | 32 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | bitops-op32.h | s | 3.7K | 126 | Paul Mundt | lethal@linux-sh.org | 1229938974 |  | sh: Provide optimized non-atomic bitops for SH-2A.  This ties in the new SH-2A 32-bit non-atomic bitops.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | pgalloc.h | s | 1.8K | 62 | Paul Mundt | lethal@linux-sh.org | 1263377474 |  | sh: default to extended TLB support.  All SH-X2 and SH-X3 parts support an extended TLB mode, which has been left as experimental since support was originally merged. Now that it's had some time to stabilize and get some exposure to various platforms, we can drop it as an option and default enable it across the board.  This is also good future proofing for newer parts that will drop support for the legacy TLB mode completely.  This will also force 3-level page tables for all newer parts, which is necessary both for the varying page sizes and larger memories.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | gpio.h | s | 1013B | 43 | Paul Mundt | lethal@linux-sh.org | 1286045739 |  | sh: Allow GPIO chips to register IRQ mappings.  As non-PFC chips are added that may support IRQs, pass through to the generic helper instead of triggering the WARN_ON().  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | asm-offsets.h | s | 35B | 1 | Sam Ravnborg | sam@ravnborg.org | 1260619694 |  | kbuild: move asm-offsets.h to include/generated  The simplest method was to add an extra asm-offsets.h file in arch/$ARCH/include/asm that references the generated file.  We can now migrate the architectures one-by-one to reference the generated file direct - and when done we can delete the temporary arch/$ARCH/include/asm/asm-offsets.h file.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | sfp-machine.h | s | 3.3K | 70 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | irq.h | s | 1.6K | 59 | Paul Mundt | lethal@linux-sh.org | 1337590441 |  | sh: Kill off machvec IRQ hinting.  Everything is using sparseirq these days, so we have no need to arbitrarily size nr_irqs ahead of time. The legacy IRQ pre-allocation likewise has no meaning for us, so that's killed off too. We now depend on nr_irqs expansion by the generic hardirq layer instead.  It's also worth noting that the majority of boards had completely bogus values for their nr_irqs relative to their CPU and configurations, so this ends up correcting behaviour for quite a few platforms.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | swab.h | s | 1016B | 52 | Paul Mundt | lethal@linux-sh.org | 1244989314 |  | sh: Tidy up duplication in irq/swab/timex.h.  The asm-generic versions have some helper definitions that we can use instead, drop our definitions and use those instead.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | atomic-grb.h | s | 3.5K | 108 | Paul Mundt | lethal@linux-sh.org | 1262937737 |  | sh: consolidate atomic_cmpxchg()/atomic_add_unless() definitions.  The LL/SC and IRQ versions were using generic stubs while the GRB version was just reimplementing what it already had for the standard cmpxchg() code. As we have optimized cmpxchg() implementations that are decoupled from the atomic code, simply falling back on the generic wrapper does the right thing. With this in place the GRB case is unaffected while the LL/SC case gets to use its optimized cmpxchg().  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | fb.h | s | 375B | 15 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | thread_info.h | s | 6.2K | 181 | Al Viro | viro@zeniv.linux.org.uk | 1338569930 |  | set_restore_sigmask() is never called without SIGPENDING (and never should be)  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | rwsem.h | s | 2.6K | 112 | Thomas Gleixner | tglx@linutronix.de | 1296127839 |  | rwsem: Move duplicate function prototypes to linux/rwsem.h  All architecture specific rwsem headers carry the same function prototypes. Just x86 adds asmregparm, which is an empty define on all other architectures. S390 has a stale rwsem_downgrade_write() prototype.  Remove the duplicates and add the prototypes to linux/rwsem.h  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: Peter Zijlstra <peterz@infradead.org> Cc: David Howells <dhowells@redhat.com> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Richard Henderson <rth@twiddle.net> Acked-by: Tony Luck <tony.luck@intel.com> Acked-by: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Acked-by: David Miller <davem@davemloft.net> Cc: Chris Zankel <chris@zankel.net> LKML-Reference: <20110126195833.970840140@linutronix.de> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | pgtable.h | s | 4.1K | 134 | Paul Mundt | lethal@linux-sh.org | 1306820264 |  | sh64: asm/pgtable.h needs asm/mmu.h  Needed to satisfy the __in_29bit_mode() check.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | timex.h | s | 598B | 20 | Paul Mundt | lethal@linux-sh.org | 1262052570 |  | sh: Only provide a PCLK definition for legacy CPG CPUs.  As CPUs are migrated over to more fully-featured clock frameworks of their own and off of the legacy CPG code, they no longer have any real need for defining the PCLK value. The PCLK define in itself is already fairly misleading, as many boards get their input clocks from different sources, making this value fairly arbitrary anyways.  Outside of the legacy CPG clock framework, the only place where this value is used is for deriving CLOCK_TICK_RATE, which we set back to the legacy PIT value that it was before the PCLK definitions were added in the first place.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | fpu.h | s | 1.7K | 58 | Paul Mundt | lethal@linux-sh.org | 1263354700 |  | sh: Move over to dynamically allocated FPU context.  This follows the x86 xstate changes and implements a task_xstate slab cache that is dynamically sized to match one of hard FP/soft FP/FPU-less.  This also tidies up and consolidates some of the SH-2A/SH-4 FPU fragmentation. Now fpu state restorers are commonly defined, with the init_fpu()/fpu_init() mess reworked to follow the x86 convention. The fpu_init() register initialization has been replaced by xstate setup followed by writing out to hardware via the standard restore path.  As init_fpu() now performs a slab allocation a secondary lighterweight restorer is also introduced for the context switch.  In the future the DSP state will be rolled in here, too.  More work remains for math emulation and the SH-5 FPU, which presently uses its own special (UP-only) interfaces.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cpu-features.h | s | 1.0K | 24 | Paul Mundt | lethal@linux-sh.org | 1237279789 |  | sh: Support for extended ASIDs on PTEAEX-capable SH-X3 cores.  This adds support for extended ASIDs (up to 16-bits) on newer SH-X3 cores that implement the PTAEX register and respective functionality. Presently only the 65nm SH7786 (90nm only supports legacy 8-bit ASIDs).  The main change is in how the PTE is written out when loading the entry in to the TLB, as well as in how the TLB entry is selectively flushed.  While SH-X2 extended mode splits out the memory-mapped U and I-TLB data arrays for extra bits, extended ASID mode splits out the address arrays. While we don't use the memory-mapped data array access, the address array accesses are necessary for selective TLB flushes, so these are implemented newly and replace the generic SH-4 implementation.  With this, TLB flushes in switch_mm() are almost non-existent on newer parts.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | switch_to_64.h | s | 968B | 30 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | stat.h | s | 3.0K | 113 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | clkdev.h | s | 722B | 25 | Jean-Christop PLAGNIOL-VILLARD | plagnioj@jcrosoft.com | 1290768664 |  | ARM: 6483/1: arm & sh: factorised duplicated clkdev.c  factorise some generic infrastructure to assist looking up struct clks for the ARM & SH architecture.  as the code is identical at 99%  put the arch specific code for allocation as example in asm/clkdev.h  Signed-off-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Acked-by: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | syscalls_64.h | s | 1.1K | 28 | David Howells | dhowells@redhat.com | 1281743593 |  | Mark arguments to certain syscalls as being const  Mark arguments to certain system calls as being const where they should be but aren't.  The list includes:   (*) The filename arguments of various stat syscalls, execve(), various utimes      syscalls and some mount syscalls.   (*) The filename arguments of some syscall helpers relating to the above.   (*) The buffer argument of various write syscalls.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bitops-grb.h | s | 6.2K | 150 | Paul Mundt | lethal@linux-sh.org | 1229938973 |  | sh: Convert to generic bitops for IRQ-toggling implementation.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | pgtable-3level.h | s | 1.5K | 42 | Paul Mundt | lethal@linux-sh.org | 1263377919 |  | sh: Rename split-level pgtable headers.  These were originally named _nopmd and _pmd to follow their asm-generic counterparts, but we rename them to -2level and -3level for general consistency.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | uaccess.h | s | 6.4K | 176 | Paul Mundt | lethal@linux-sh.org | 1339550917 |  | sh: use the new generic strnlen_user() function  This discards both the _32 and _64 versions in favour of the consolidated generic one.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | hd64461.h | s | 11K | 212 | Paul Mundt | lethal@linux-sh.org | 1242786433 |  | sh: mach-hp6xx: Fix up the hp6xx build for hd64461 changes.  Fixes several compile errors due to the recent hd64461 I/O base changes.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | switch_to.h | s | 484B | 17 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for SH  Disintegrate asm/system.h for SH.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-sh@vger.kernel.org
f | checksum_32.h | s | 5.3K | 194 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | processor_32.h | s | 4.5K | 168 | Suresh Siddha | suresh.b.siddha@intel.com | 1337206586 |  | fork: move the real prepare_to_copy() users to arch_dup_task_struct()  Historical prepare_to_copy() is mostly a no-op, duplicated for majority of the architectures and the rest following the x86 model of flushing the extended register state like fpu there.  Remove it and use the arch_dup_task_struct() instead.  Suggested-by: Oleg Nesterov <oleg@redhat.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Suresh Siddha <suresh.b.siddha@intel.com> Link: http://lkml.kernel.org/r/1336692811-30576-1-git-send-email-suresh.b.siddha@intel.com Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: David Howells <dhowells@redhat.com> Cc: Koichi Yasutake <yasutake.koichi@jp.panasonic.com> Cc: Paul Mackerras <paulus@samba.org> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Chris Zankel <chris@zankel.net> Cc: Richard Henderson <rth@twiddle.net> Cc: Russell King <linux@arm.linux.org.uk> Cc: Haavard Skinnemoen <hskinnemoen@gmail.com> Cc: Mike Frysinger <vapier@gentoo.org> Cc: Mark Salter <msalter@redhat.com> Cc: Aurelien Jacquiot <a-jacquiot@ti.com> Cc: Mikael Starvik <starvik@axis.com> Cc: Yoshinori Sato <ysato@users.sourceforge.jp> Cc: Richard Kuo <rkuo@codeaurora.org> Cc: Tony Luck <tony.luck@intel.com> Cc: Michal Simek <monstr@monstr.eu> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Jonas Bonn <jonas@southpole.se> Cc: James E.J. Bottomley <jejb@parisc-linux.org> Cc: Helge Deller <deller@gmx.de> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Chen Liqin <liqin.chen@sunplusct.com> Cc: Lennox Wu <lennox.wu@gmail.com> Cc: David S. Miller <davem@davemloft.net> Cc: Chris Metcalf <cmetcalf@tilera.com> Cc: Jeff Dike <jdike@addtoit.com> Cc: Richard Weinberger <richard@nod.at> Cc: Guan Xuetao <gxt@mprc.pku.edu.cn> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>
f | tlb_64.h | s | 2.1K | 64 | Paul Mundt | lethal@linux-sh.org | 1217821866 |  | sh: Fix up broken kerneldoc comments.  These were completely unparseable, so fix them up.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | string_64.h | s | 460B | 13 | Paul Mundt | lethal@linux-sh.org | 1229939045 |  | sh: Add SH-5 optimized memcpy()/memset()/strcpy()/strlen().  Adopted from the uClibc optimized string versions.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | vga.h | s | 98B | 4 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | smp-ops.h | s | 973B | 39 | Paul Mundt | lethal@linux-sh.org | 1272276535 |  | sh: CPU hotplug support.  This adds preliminary support for CPU hotplug for SH SMP systems.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | cmpxchg-grb.h | s | 2.1K | 62 | Srinivas KANDAGATLA | srinivas.kandagatla@st.com | 1307514159 |  | sh: Fix up xchg/cmpxchg corruption with gUSA RB.  gUSA special cases r15 for part of its login/out sequence, meaning that any parameters need to be explicitly prohibited from accidentally being assigned that particular register, and the compiler ultimately needs to use a temporary instead.  Certain configurations have begun generating code paths that do indeed get allocated r15, resulting in immediate corruption of the exchanged value. This was observed in (amongst others) exit_mm() code generation where the xchg_u32 call was immediately corrupting a structure address.  As this is a general gUSA restriction, the rest of the users likewise need to be updated to ensure sensible constraints.  References: https://bugzilla.stlinux.com/show_bug.cgi?id=11229 Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@st.com> Reviewed-by: Stuart Menefy <stuart.menefy@st.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | signal.h | s | 280B | 11 | Paul Mundt | lethal@linux-sh.org | 1244989557 |  | sh: Convert to asm-generic/signal.h.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | sram.h | s | 631B | 27 | Paul Mundt | lethal@linux-sh.org | 1287076140 |  | sh: Provide a generic SRAM pool for tiny memories.  This sets up a generic SRAM pool for CPUs and platform code to insert their otherwise unused memories into. A simple alloc/free interface is provided (lifed from avr32) for generic code.  This only applies to tiny SRAMs that are otherwise unmanaged, and does not take in to account the more complex SRAMs sitting behind transfer engines, or that employ an I/D split.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | kgdb.h | s | 812B | 27 | Paul Mundt | lethal@linux-sh.org | 1334108904 |  | sh: kgdb: Unset CACHE_FLUSH_IS_SAFE for SMP.  Our SMP cache flush ops use CPU cross calls to deal with things like I-cache accesses not being broadcast in hardware, so ensure that the CACHE_FLUSH_IS_SAFE reflects this.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | posix_types_32.h | s | 738B | 18 | Al Viro | viro@zeniv.linux.org.uk | 1338426290 |  | bury __kernel_nlink_t, make internal nlink_t consistent  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | rtc.h | s | 789B | 21 | Paul Mundt | lethal@linux-sh.org | 1240821279 |  | sh: rtc-generic support.  This adds rtc-generic support for SUPERH32.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | freq.h | s | 472B | 16 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | syscalls_32.h | s | 2.2K | 49 | Al Viro | viro@zeniv.linux.org.uk | 1337659086 |  | sh: switch to saved_sigmask-based sigsuspend()/rt_sigsuspend()  Complete the move of sh64 to it, trim the crap from prototypes, tidy up a bit.  Infrastructure in do_signal() had already been there, in signal_64 as well as in signal_32 (where it was already used).  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | spinlock.h | s | 4.9K | 197 | Thomas Gleixner | tglx@linutronix.de | 1260831332 |  | locking: Convert raw_rwlock functions to arch_rwlock  Name space cleanup for rwlock functions. No functional change.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Ingo Molnar <mingo@elte.hu> Cc: linux-arch@vger.kernel.org
f | sockios.h | s | 473B | 11 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | shmparam.h | s | 629B | 19 | Paul Mundt | lethal@linux-sh.org | 1217286584 |  | sh: migrate to arch/sh/include/  This follows the sparc changes a439fe51a1f8eb087c22dd24d69cebae4a3addac.  Most of the moving about was done with Sam's directions at:  http://marc.info/?l=linux-sh&m=121724823706062&w=2  with subsequent hacking and fixups entirely my fault.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | byteorder.h | s | 215B | 8 | Harvey Harrison | harvey.harrison@gmail.com | 1231991810 |  | byteorder: make swab.h include asm/swab.h like a regular header  Add swab.h to kbuild.asm and remove the individual entries from each arch, mark as unifdef as some arches have some kernel-only bits inside.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
