<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › mach-bcm63xx › bcm963xx_tag.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>bcm963xx_tag.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __BCM963XX_TAG_H</span>
<span class="cp">#define __BCM963XX_TAG_H</span>

<span class="cp">#define TAGVER_LEN		4	</span><span class="cm">/* Length of Tag Version */</span><span class="cp"></span>
<span class="cp">#define TAGLAYOUT_LEN		4	</span><span class="cm">/* Length of FlashLayoutVer */</span><span class="cp"></span>
<span class="cp">#define SIG1_LEN		20	</span><span class="cm">/* Company Signature 1 Length */</span><span class="cp"></span>
<span class="cp">#define SIG2_LEN		14	</span><span class="cm">/* Company Signature 2 Length */</span><span class="cp"></span>
<span class="cp">#define BOARDID_LEN		16	</span><span class="cm">/* Length of BoardId */</span><span class="cp"></span>
<span class="cp">#define ENDIANFLAG_LEN		2	</span><span class="cm">/* Endian Flag Length */</span><span class="cp"></span>
<span class="cp">#define CHIPID_LEN		6	</span><span class="cm">/* Chip Id Length */</span><span class="cp"></span>
<span class="cp">#define IMAGE_LEN		10	</span><span class="cm">/* Length of Length Field */</span><span class="cp"></span>
<span class="cp">#define ADDRESS_LEN		12	</span><span class="cm">/* Length of Address field */</span><span class="cp"></span>
<span class="cp">#define DUALFLAG_LEN		2	</span><span class="cm">/* Dual Image flag Length */</span><span class="cp"></span>
<span class="cp">#define INACTIVEFLAG_LEN	2	</span><span class="cm">/* Inactie Flag Length */</span><span class="cp"></span>
<span class="cp">#define RSASIG_LEN		20	</span><span class="cm">/* Length of RSA Signature in tag */</span><span class="cp"></span>
<span class="cp">#define TAGINFO1_LEN		30	</span><span class="cm">/* Length of vendor information field1 in tag */</span><span class="cp"></span>
<span class="cp">#define FLASHLAYOUTVER_LEN	4	</span><span class="cm">/* Length of Flash Layout Version String tag */</span><span class="cp"></span>
<span class="cp">#define TAGINFO2_LEN		16	</span><span class="cm">/* Length of vendor information field2 in tag */</span><span class="cp"></span>
<span class="cp">#define ALTTAGINFO_LEN		54	</span><span class="cm">/* Alternate length for vendor information; Pirelli */</span><span class="cp"></span>

<span class="cp">#define NUM_PIRELLI		2</span>
<span class="cp">#define IMAGETAG_CRC_START	0xFFFFFFFF</span>

<span class="cp">#define PIRELLI_BOARDS { \</span>
<span class="cp">	&quot;AGPF-S0&quot;, \</span>
<span class="cp">	&quot;DWV-S0&quot;, \</span>
<span class="cp">}</span>

<span class="cm">/*</span>
<span class="cm"> * The broadcom firmware assumes the rootfs starts the image,</span>
<span class="cm"> * therefore uses the rootfs start (flash_image_address)</span>
<span class="cm"> * to determine where to flash the image.  Since we have the kernel first</span>
<span class="cm"> * we have to give it the kernel address, but the crc uses the length</span>
<span class="cm"> * associated with this address (root_length), which is added to the kernel</span>
<span class="cm"> * length (kernel_length) to determine the length of image to flash and thus</span>
<span class="cm"> * needs to be rootfs + deadcode (jffs2 EOF marker)</span>
<span class="cm">*/</span>

<span class="k">struct</span> <span class="n">bcm_tag</span> <span class="p">{</span>
	<span class="cm">/* 0-3: Version of the image tag */</span>
	<span class="kt">char</span> <span class="n">tag_version</span><span class="p">[</span><span class="n">TAGVER_LEN</span><span class="p">];</span>
	<span class="cm">/* 4-23: Company Line 1 */</span>
	<span class="kt">char</span> <span class="n">sig_1</span><span class="p">[</span><span class="n">SIG1_LEN</span><span class="p">];</span>
	<span class="cm">/*  24-37: Company Line 2 */</span>
	<span class="kt">char</span> <span class="n">sig_2</span><span class="p">[</span><span class="n">SIG2_LEN</span><span class="p">];</span>
	<span class="cm">/* 38-43: Chip this image is for */</span>
	<span class="kt">char</span> <span class="n">chip_id</span><span class="p">[</span><span class="n">CHIPID_LEN</span><span class="p">];</span>
	<span class="cm">/* 44-59: Board name */</span>
	<span class="kt">char</span> <span class="n">board_id</span><span class="p">[</span><span class="n">BOARDID_LEN</span><span class="p">];</span>
	<span class="cm">/* 60-61: Map endianness -- 1 BE 0 LE */</span>
	<span class="kt">char</span> <span class="n">big_endian</span><span class="p">[</span><span class="n">ENDIANFLAG_LEN</span><span class="p">];</span>
	<span class="cm">/* 62-71: Total length of image */</span>
	<span class="kt">char</span> <span class="n">total_length</span><span class="p">[</span><span class="n">IMAGE_LEN</span><span class="p">];</span>
	<span class="cm">/* 72-83: Address in memory of CFE */</span>
	<span class="kt">char</span> <span class="n">cfe__address</span><span class="p">[</span><span class="n">ADDRESS_LEN</span><span class="p">];</span>
	<span class="cm">/* 84-93: Size of CFE */</span>
	<span class="kt">char</span> <span class="n">cfe_length</span><span class="p">[</span><span class="n">IMAGE_LEN</span><span class="p">];</span>
	<span class="cm">/* 94-105: Address in memory of image start</span>
<span class="cm">	 * (kernel for OpenWRT, rootfs for stock firmware)</span>
<span class="cm">	 */</span>
	<span class="kt">char</span> <span class="n">flash_image_start</span><span class="p">[</span><span class="n">ADDRESS_LEN</span><span class="p">];</span>
	<span class="cm">/* 106-115: Size of rootfs */</span>
	<span class="kt">char</span> <span class="n">root_length</span><span class="p">[</span><span class="n">IMAGE_LEN</span><span class="p">];</span>
	<span class="cm">/* 116-127: Address in memory of kernel */</span>
	<span class="kt">char</span> <span class="n">kernel_address</span><span class="p">[</span><span class="n">ADDRESS_LEN</span><span class="p">];</span>
	<span class="cm">/* 128-137: Size of kernel */</span>
	<span class="kt">char</span> <span class="n">kernel_length</span><span class="p">[</span><span class="n">IMAGE_LEN</span><span class="p">];</span>
	<span class="cm">/* 138-139: Unused at the moment */</span>
	<span class="kt">char</span> <span class="n">dual_image</span><span class="p">[</span><span class="n">DUALFLAG_LEN</span><span class="p">];</span>
	<span class="cm">/* 140-141: Unused at the moment */</span>
	<span class="kt">char</span> <span class="n">inactive_flag</span><span class="p">[</span><span class="n">INACTIVEFLAG_LEN</span><span class="p">];</span>
	<span class="cm">/* 142-161: RSA Signature (not used; some vendors may use this) */</span>
	<span class="kt">char</span> <span class="n">rsa_signature</span><span class="p">[</span><span class="n">RSASIG_LEN</span><span class="p">];</span>
	<span class="cm">/* 162-191: Compilation and related information (not used in OpenWrt) */</span>
	<span class="kt">char</span> <span class="n">information1</span><span class="p">[</span><span class="n">TAGINFO1_LEN</span><span class="p">];</span>
	<span class="cm">/* 192-195: Version flash layout */</span>
	<span class="kt">char</span> <span class="n">flash_layout_ver</span><span class="p">[</span><span class="n">FLASHLAYOUTVER_LEN</span><span class="p">];</span>
	<span class="cm">/* 196-199: kernel+rootfs CRC32 */</span>
	<span class="n">__u32</span> <span class="n">fskernel_crc</span><span class="p">;</span>
	<span class="cm">/* 200-215: Unused except on Alice Gate where is is information */</span>
	<span class="kt">char</span> <span class="n">information2</span><span class="p">[</span><span class="n">TAGINFO2_LEN</span><span class="p">];</span>
	<span class="cm">/* 216-219: CRC32 of image less imagetag (kernel for Alice Gate) */</span>
	<span class="n">__u32</span> <span class="n">image_crc</span><span class="p">;</span>
	<span class="cm">/* 220-223: CRC32 of rootfs partition */</span>
	<span class="n">__u32</span> <span class="n">rootfs_crc</span><span class="p">;</span>
	<span class="cm">/* 224-227: CRC32 of kernel partition */</span>
	<span class="n">__u32</span> <span class="n">kernel_crc</span><span class="p">;</span>
	<span class="cm">/* 228-235: Unused at present */</span>
	<span class="kt">char</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="cm">/* 236-239: CRC32 of header excluding last 20 bytes */</span>
	<span class="n">__u32</span> <span class="n">header_crc</span><span class="p">;</span>
	<span class="cm">/* 240-255: Unused at present */</span>
	<span class="kt">char</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* __BCM63XX_TAG_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
