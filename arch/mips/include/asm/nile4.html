<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › nile4.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>nile4.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  asm-mips/nile4.h -- NEC Vrc-5074 Nile 4 definitions</span>
<span class="cm"> *</span>
<span class="cm"> *  Copyright (C) 2000 Geert Uytterhoeven &lt;geert@sonycom.com&gt;</span>
<span class="cm"> *                     Sony Software Development Center Europe (SDCE), Brussels</span>
<span class="cm"> *</span>
<span class="cm"> *  This file is based on the following documentation:</span>
<span class="cm"> *</span>
<span class="cm"> *	NEC Vrc 5074 System Controller Data Sheet, June 1998</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _ASM_NILE4_H</span>
<span class="cp">#define _ASM_NILE4_H</span>

<span class="cp">#define NILE4_BASE		0xbfa00000</span>
<span class="cp">#define NILE4_SIZE		0x00200000		</span><span class="cm">/* 2 MB */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  Physical Device Address Registers (PDARs)</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_SDRAM0	0x0000	</span><span class="cm">/* SDRAM Bank 0 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_SDRAM1	0x0008	</span><span class="cm">/* SDRAM Bank 1 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCS2	0x0010	</span><span class="cm">/* Device Chip-Select 2 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCS3	0x0018	</span><span class="cm">/* Device Chip-Select 3 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCS4	0x0020	</span><span class="cm">/* Device Chip-Select 4 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCS5	0x0028	</span><span class="cm">/* Device Chip-Select 5 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCS6	0x0030	</span><span class="cm">/* Device Chip-Select 6 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCS7	0x0038	</span><span class="cm">/* Device Chip-Select 7 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCS8	0x0040	</span><span class="cm">/* Device Chip-Select 8 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCIW0	0x0060	</span><span class="cm">/* PCI Address Window 0 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCIW1	0x0068	</span><span class="cm">/* PCI Address Window 1 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_INTCS	0x0070	</span><span class="cm">/* Controller Internal Registers and Devices */</span><span class="cp"></span>
				<span class="cm">/* [R/W] */</span>
<span class="cp">#define NILE4_BOOTCS	0x0078	</span><span class="cm">/* Boot ROM Chip-Select [R/W] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  CPU Interface Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_CPUSTAT	0x0080	</span><span class="cm">/* CPU Status [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_INTCTRL	0x0088	</span><span class="cm">/* Interrupt Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_INTSTAT0	0x0090	</span><span class="cm">/* Interrupt Status 0 [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_INTSTAT1	0x0098	</span><span class="cm">/* Interrupt Status 1 and CPU Interrupt */</span><span class="cp"></span>
				<span class="cm">/* Enable [R/W] */</span>
<span class="cp">#define NILE4_INTCLR	0x00A0	</span><span class="cm">/* Interrupt Clear [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_INTPPES	0x00A8	</span><span class="cm">/* PCI Interrupt Control [R/W] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  Memory-Interface Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_MEMCTRL	0x00C0	</span><span class="cm">/* Memory Control */</span><span class="cp"></span>
<span class="cp">#define NILE4_ACSTIME	0x00C8	</span><span class="cm">/* Memory Access Timing [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_CHKERR	0x00D0	</span><span class="cm">/* Memory Check Error Status [R] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  PCI-Bus Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_PCICTRL	0x00E0	</span><span class="cm">/* PCI Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCIARB	0x00E8	</span><span class="cm">/* PCI Arbiter [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCIINIT0	0x00F0	</span><span class="cm">/* PCI Master (Initiator) 0 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCIINIT1	0x00F8	</span><span class="cm">/* PCI Master (Initiator) 1 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCIERR	0x00B8	</span><span class="cm">/* PCI Error [R/W] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  Local-Bus Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_LCNFG	0x0100	</span><span class="cm">/* Local Bus Configuration [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_LCST2	0x0110	</span><span class="cm">/* Local Bus Chip-Select Timing 2 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_LCST3	0x0118	</span><span class="cm">/* Local Bus Chip-Select Timing 3 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_LCST4	0x0120	</span><span class="cm">/* Local Bus Chip-Select Timing 4 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_LCST5	0x0128	</span><span class="cm">/* Local Bus Chip-Select Timing 5 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_LCST6	0x0130	</span><span class="cm">/* Local Bus Chip-Select Timing 6 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_LCST7	0x0138	</span><span class="cm">/* Local Bus Chip-Select Timing 7 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_LCST8	0x0140	</span><span class="cm">/* Local Bus Chip-Select Timing 8 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DCSFN	0x0150	</span><span class="cm">/* Device Chip-Select Muxing and Output */</span><span class="cp"></span>
				<span class="cm">/* Enables [R/W] */</span>
<span class="cp">#define NILE4_DCSIO	0x0158	</span><span class="cm">/* Device Chip-Selects As I/O Bits [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BCST	0x0178	</span><span class="cm">/* Local Boot Chip-Select Timing [R/W] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  DMA Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_DMACTRL0	0x0180	</span><span class="cm">/* DMA Control 0 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DMASRCA0	0x0188	</span><span class="cm">/* DMA Source Address 0 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DMADESA0	0x0190	</span><span class="cm">/* DMA Destination Address 0 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DMACTRL1	0x0198	</span><span class="cm">/* DMA Control 1 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DMASRCA1	0x01A0	</span><span class="cm">/* DMA Source Address 1 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DMADESA1	0x01A8	</span><span class="cm">/* DMA Destination Address 1 [R/W] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  Timer Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_T0CTRL	0x01C0	</span><span class="cm">/* SDRAM Refresh Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_T0CNTR	0x01C8	</span><span class="cm">/* SDRAM Refresh Counter [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_T1CTRL	0x01D0	</span><span class="cm">/* CPU-Bus Read Time-Out Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_T1CNTR	0x01D8	</span><span class="cm">/* CPU-Bus Read Time-Out Counter [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_T2CTRL	0x01E0	</span><span class="cm">/* General-Purpose Timer Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_T2CNTR	0x01E8	</span><span class="cm">/* General-Purpose Timer Counter [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_T3CTRL	0x01F0	</span><span class="cm">/* Watchdog Timer Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_T3CNTR	0x01F8	</span><span class="cm">/* Watchdog Timer Counter [R/W] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  PCI Configuration Space Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_PCI_BASE	0x0200</span>

<span class="cp">#define NILE4_VID	0x0200	</span><span class="cm">/* PCI Vendor ID [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_DID	0x0202	</span><span class="cm">/* PCI Device ID [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCICMD	0x0204	</span><span class="cm">/* PCI Command [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCISTS	0x0206	</span><span class="cm">/* PCI Status [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_REVID	0x0208	</span><span class="cm">/* PCI Revision ID [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_CLASS	0x0209	</span><span class="cm">/* PCI Class Code [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_CLSIZ	0x020C	</span><span class="cm">/* PCI Cache Line Size [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_MLTIM	0x020D	</span><span class="cm">/* PCI Latency Timer [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_HTYPE	0x020E	</span><span class="cm">/* PCI Header Type [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BIST	0x020F	</span><span class="cm">/* BIST [R] (unimplemented) */</span><span class="cp"></span>
<span class="cp">#define NILE4_BARC	0x0210	</span><span class="cm">/* PCI Base Address Register Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR0	0x0218	</span><span class="cm">/* PCI Base Address Register 0 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR1	0x0220	</span><span class="cm">/* PCI Base Address Register 1 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_CIS	0x0228	</span><span class="cm">/* PCI Cardbus CIS Pointer [R] */</span><span class="cp"></span>
				<span class="cm">/* (unimplemented) */</span>
<span class="cp">#define NILE4_SSVID	0x022C	</span><span class="cm">/* PCI Sub-System Vendor ID [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_SSID	0x022E	</span><span class="cm">/* PCI Sub-System ID [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_ROM	0x0230	</span><span class="cm">/* Expansion ROM Base Address [R] */</span><span class="cp"></span>
				<span class="cm">/* (unimplemented) */</span>
<span class="cp">#define NILE4_INTLIN	0x023C	</span><span class="cm">/* PCI Interrupt Line [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_INTPIN	0x023D	</span><span class="cm">/* PCI Interrupt Pin [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_MINGNT	0x023E	</span><span class="cm">/* PCI Min_Gnt [R] (unimplemented) */</span><span class="cp"></span>
<span class="cp">#define NILE4_MAXLAT	0x023F	</span><span class="cm">/* PCI Max_Lat [R] (unimplemented) */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR2	0x0240	</span><span class="cm">/* PCI Base Address Register 2 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR3	0x0248	</span><span class="cm">/* PCI Base Address Register 3 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR4	0x0250	</span><span class="cm">/* PCI Base Address Register 4 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR5	0x0258	</span><span class="cm">/* PCI Base Address Register 5 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR6	0x0260	</span><span class="cm">/* PCI Base Address Register 6 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR7	0x0268	</span><span class="cm">/* PCI Base Address Register 7 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BAR8	0x0270	</span><span class="cm">/* PCI Base Address Register 8 [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_BARB	0x0278	</span><span class="cm">/* PCI Base Address Register BOOT [R/W] */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  Serial-Port Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_UART_BASE	0x0300</span>

<span class="cp">#define NILE4_UARTRBR	0x0300	</span><span class="cm">/* UART Receiver Data Buffer [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTTHR	0x0300	</span><span class="cm">/* UART Transmitter Data Holding [W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTIER	0x0308	</span><span class="cm">/* UART Interrupt Enable [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTDLL	0x0300	</span><span class="cm">/* UART Divisor Latch LSB [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTDLM	0x0308	</span><span class="cm">/* UART Divisor Latch MSB [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTIIR	0x0310	</span><span class="cm">/* UART Interrupt ID [R] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTFCR	0x0310	</span><span class="cm">/* UART FIFO Control [W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTLCR	0x0318	</span><span class="cm">/* UART Line Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTMCR	0x0320	</span><span class="cm">/* UART Modem Control [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTLSR	0x0328	</span><span class="cm">/* UART Line Status [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTMSR	0x0330	</span><span class="cm">/* UART Modem Status [R/W] */</span><span class="cp"></span>
<span class="cp">#define NILE4_UARTSCR	0x0338	</span><span class="cm">/* UART Scratch [R/W] */</span><span class="cp"></span>

<span class="cp">#define NILE4_UART_BASE_BAUD	520833	</span><span class="cm">/* 100 MHz / 12 / 16 */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  Interrupt Lines</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_INT_CPCE	0	</span><span class="cm">/* CPU-Interface Parity-Error Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_CNTD	1	</span><span class="cm">/* CPU No-Target Decode Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_MCE	2	</span><span class="cm">/* Memory-Check Error Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_DMA	3	</span><span class="cm">/* DMA Controller Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_UART	4	</span><span class="cm">/* UART Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_WDOG	5	</span><span class="cm">/* Watchdog Timer Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_GPT	6	</span><span class="cm">/* General-Purpose Timer Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_LBRTD	7	</span><span class="cm">/* Local-Bus Ready Timer Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_INTA	8	</span><span class="cm">/* PCI Interrupt Signal INTA# */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_INTB	9	</span><span class="cm">/* PCI Interrupt Signal INTB# */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_INTC	10	</span><span class="cm">/* PCI Interrupt Signal INTC# */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_INTD	11	</span><span class="cm">/* PCI Interrupt Signal INTD# */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_INTE	12	</span><span class="cm">/* PCI Interrupt Signal INTE# (ISA cascade) */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_RESV	13	</span><span class="cm">/* Reserved */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_PCIS	14	</span><span class="cm">/* PCI SERR# Interrupt */</span><span class="cp"></span>
<span class="cp">#define NILE4_INT_PCIE	15	</span><span class="cm">/* PCI Internal Error Interrupt */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  Nile 4 Register Access</span>
<span class="cm">     */</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">nile4_sync</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">volatile</span> <span class="n">u32</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="k">volatile</span> <span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="mh">0xbfc00000</span><span class="p">;</span>
    <span class="p">(</span><span class="kt">void</span><span class="p">)(</span><span class="o">*</span><span class="n">p</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">nile4_out32</span><span class="p">(</span><span class="n">u32</span> <span class="n">offset</span><span class="p">,</span> <span class="n">u32</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
    <span class="o">*</span><span class="p">(</span><span class="k">volatile</span> <span class="n">u32</span> <span class="o">*</span><span class="p">)(</span><span class="n">NILE4_BASE</span><span class="o">+</span><span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
    <span class="n">nile4_sync</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">nile4_in32</span><span class="p">(</span><span class="n">u32</span> <span class="n">offset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">u32</span> <span class="n">val</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="k">volatile</span> <span class="n">u32</span> <span class="o">*</span><span class="p">)(</span><span class="n">NILE4_BASE</span><span class="o">+</span><span class="n">offset</span><span class="p">);</span>
    <span class="n">nile4_sync</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">val</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">nile4_out16</span><span class="p">(</span><span class="n">u32</span> <span class="n">offset</span><span class="p">,</span> <span class="n">u16</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
    <span class="o">*</span><span class="p">(</span><span class="k">volatile</span> <span class="n">u16</span> <span class="o">*</span><span class="p">)(</span><span class="n">NILE4_BASE</span><span class="o">+</span><span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
    <span class="n">nile4_sync</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u16</span> <span class="nf">nile4_in16</span><span class="p">(</span><span class="n">u32</span> <span class="n">offset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">u16</span> <span class="n">val</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="k">volatile</span> <span class="n">u16</span> <span class="o">*</span><span class="p">)(</span><span class="n">NILE4_BASE</span><span class="o">+</span><span class="n">offset</span><span class="p">);</span>
    <span class="n">nile4_sync</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">val</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">nile4_out8</span><span class="p">(</span><span class="n">u32</span> <span class="n">offset</span><span class="p">,</span> <span class="n">u8</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
    <span class="o">*</span><span class="p">(</span><span class="k">volatile</span> <span class="n">u8</span> <span class="o">*</span><span class="p">)(</span><span class="n">NILE4_BASE</span><span class="o">+</span><span class="n">offset</span><span class="p">)</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>
    <span class="n">nile4_sync</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="nf">nile4_in8</span><span class="p">(</span><span class="n">u32</span> <span class="n">offset</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">u8</span> <span class="n">val</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="k">volatile</span> <span class="n">u8</span> <span class="o">*</span><span class="p">)(</span><span class="n">NILE4_BASE</span><span class="o">+</span><span class="n">offset</span><span class="p">);</span>
    <span class="n">nile4_sync</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">val</span><span class="p">;</span>
<span class="p">}</span>


    <span class="cm">/*</span>
<span class="cm">     *  Physical Device Address Registers</span>
<span class="cm">     */</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_set_pdar</span><span class="p">(</span><span class="n">u32</span> <span class="n">pdar</span><span class="p">,</span> <span class="n">u32</span> <span class="n">phys</span><span class="p">,</span> <span class="n">u32</span> <span class="n">size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span>
			   <span class="kt">int</span> <span class="n">on_memory_bus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">visible</span><span class="p">);</span>


    <span class="cm">/*</span>
<span class="cm">     *  PCI Master Registers</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_PCICMD_IACK	0	</span><span class="cm">/* PCI Interrupt Acknowledge */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCICMD_IO		1	</span><span class="cm">/* PCI I/O Space */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCICMD_MEM	3	</span><span class="cm">/* PCI Memory Space */</span><span class="cp"></span>
<span class="cp">#define NILE4_PCICMD_CFG	5	</span><span class="cm">/* PCI Configuration Space */</span><span class="cp"></span>


    <span class="cm">/*</span>
<span class="cm">     *  PCI Address Spaces</span>
<span class="cm">     *</span>
<span class="cm">     *  Note that these are multiplexed using PCIINIT[01]!</span>
<span class="cm">     */</span>

<span class="cp">#define NILE4_PCI_IO_BASE	0xa6000000</span>
<span class="cp">#define NILE4_PCI_MEM_BASE	0xa8000000</span>
<span class="cp">#define NILE4_PCI_CFG_BASE	NILE4_PCI_MEM_BASE</span>
<span class="cp">#define NILE4_PCI_IACK_BASE	NILE4_PCI_IO_BASE</span>


<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_set_pmr</span><span class="p">(</span><span class="n">u32</span> <span class="n">pmr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">addr</span><span class="p">);</span>


    <span class="cm">/*</span>
<span class="cm">     *  Interrupt Programming</span>
<span class="cm">     */</span>

<span class="cp">#define NUM_I8259_INTERRUPTS	16</span>
<span class="cp">#define NUM_NILE4_INTERRUPTS	16</span>

<span class="cp">#define IRQ_I8259_CASCADE	NILE4_INT_INTE</span>
<span class="cp">#define is_i8259_irq(irq)	((irq) &lt; NUM_I8259_INTERRUPTS)</span>
<span class="cp">#define nile4_to_irq(n)		((n)+NUM_I8259_INTERRUPTS)</span>
<span class="cp">#define irq_to_nile4(n)		((n)-NUM_I8259_INTERRUPTS)</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_map_irq</span><span class="p">(</span><span class="kt">int</span> <span class="n">nile4_irq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cpu_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_map_irq_all</span><span class="p">(</span><span class="kt">int</span> <span class="n">cpu_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_enable_irq</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nile4_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_disable_irq</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nile4_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_disable_irq_all</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">nile4_get_irq_stat</span><span class="p">(</span><span class="kt">int</span> <span class="n">cpu_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_enable_irq_output</span><span class="p">(</span><span class="kt">int</span> <span class="n">cpu_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_disable_irq_output</span><span class="p">(</span><span class="kt">int</span> <span class="n">cpu_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_set_pci_irq_polarity</span><span class="p">(</span><span class="kt">int</span> <span class="n">pci_irq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">high</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_set_pci_irq_level_or_edge</span><span class="p">(</span><span class="kt">int</span> <span class="n">pci_irq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">level</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_clear_irq</span><span class="p">(</span><span class="kt">int</span> <span class="n">nile4_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_clear_irq_mask</span><span class="p">(</span><span class="n">u32</span> <span class="n">mask</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">nile4_i8259_iack</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">nile4_dump_irq_status</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>	<span class="cm">/* Debug */</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
