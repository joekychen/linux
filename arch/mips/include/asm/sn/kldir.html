<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › sn › kldir.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>kldir.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * This file is subject to the terms and conditions of the GNU General Public</span>
<span class="cm"> * License.  See the file &quot;COPYING&quot; in the main directory of this archive</span>
<span class="cm"> * for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * Derived from IRIX &lt;sys/SN/kldir.h&gt;, revision 1.21.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1992 - 1997, 1999, 2000 Silicon Graphics, Inc.</span>
<span class="cm"> * Copyright (C) 1999, 2000 by Ralf Baechle</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _ASM_SN_KLDIR_H</span>
<span class="cp">#define _ASM_SN_KLDIR_H</span>


<span class="cm">/*</span>
<span class="cm"> * The kldir memory area resides at a fixed place in each node&#39;s memory and</span>
<span class="cm"> * provides pointers to most other IP27 memory areas.  This allows us to</span>
<span class="cm"> * resize and/or relocate memory areas at a later time without breaking all</span>
<span class="cm"> * firmware and kernels that use them.  Indices in the array are</span>
<span class="cm"> * permanently dedicated to areas listed below.  Some memory areas (marked</span>
<span class="cm"> * below) reside at a permanently fixed location, but are included in the</span>
<span class="cm"> * directory for completeness.</span>
<span class="cm"> */</span>

<span class="cp">#define KLDIR_MAGIC		0x434d5f53505f5357</span>

<span class="cm">/*</span>
<span class="cm"> * The upper portion of the memory map applies during boot</span>
<span class="cm"> * only and is overwritten by IRIX/SYMMON.</span>
<span class="cm"> *</span>
<span class="cm"> *                                    MEMORY MAP PER NODE</span>
<span class="cm"> *</span>
<span class="cm"> * 0x2000000 (32M)         +-----------------------------------------+</span>
<span class="cm"> *                         |      IO6 BUFFERS FOR FLASH ENET IOC3    |</span>
<span class="cm"> * 0x1F80000 (31.5M)       +-----------------------------------------+</span>
<span class="cm"> *                         |      IO6 TEXT/DATA/BSS/stack            |</span>
<span class="cm"> * 0x1C00000 (30M)         +-----------------------------------------+</span>
<span class="cm"> *                         |      IO6 PROM DEBUG TEXT/DATA/BSS/stack |</span>
<span class="cm"> * 0x0800000 (28M)         +-----------------------------------------+</span>
<span class="cm"> *                         |      IP27 PROM TEXT/DATA/BSS/stack      |</span>
<span class="cm"> * 0x1B00000 (27M)         +-----------------------------------------+</span>
<span class="cm"> *                         |      IP27 CFG                           |</span>
<span class="cm"> * 0x1A00000 (26M)         +-----------------------------------------+</span>
<span class="cm"> *                         |      Graphics PROM                      |</span>
<span class="cm"> * 0x1800000 (24M)         +-----------------------------------------+</span>
<span class="cm"> *                         |      3rd Party PROM drivers             |</span>
<span class="cm"> * 0x1600000 (22M)         +-----------------------------------------+</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |      Free                               |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         +-----------------------------------------+</span>
<span class="cm"> *                         |      UNIX DEBUG Version                 |</span>
<span class="cm"> * 0x190000 (2M--)         +-----------------------------------------+</span>
<span class="cm"> *                         |      SYMMON                             |</span>
<span class="cm"> *                         |      (For UNIX Debug only)              |</span>
<span class="cm"> * 0x34000 (208K)          +-----------------------------------------+</span>
<span class="cm"> *                         |      SYMMON STACK [NUM_CPU_PER_NODE]    |</span>
<span class="cm"> *                         |      (For UNIX Debug only)              |</span>
<span class="cm"> * 0x25000 (148K)          +-----------------------------------------+</span>
<span class="cm"> *                         |      KLCONFIG - II (temp)               |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |    ----------------------------         |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |      UNIX NON-DEBUG Version             |</span>
<span class="cm"> * 0x19000 (100K)          +-----------------------------------------+</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * The lower portion of the memory map contains information that is</span>
<span class="cm"> * permanent and is used by the IP27PROM, IO6PROM and IRIX.</span>
<span class="cm"> *</span>
<span class="cm"> * 0x19000 (100K)          +-----------------------------------------+</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |      PI Error Spools (32K)              |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> * 0x12000 (72K)           +-----------------------------------------+</span>
<span class="cm"> *                         |      Unused                             |</span>
<span class="cm"> * 0x11c00 (71K)           +-----------------------------------------+</span>
<span class="cm"> *                         |      CPU 1 NMI Eframe area       	     |</span>
<span class="cm"> * 0x11a00 (70.5K)         +-----------------------------------------+</span>
<span class="cm"> *                         |      CPU 0 NMI Eframe area       	     |</span>
<span class="cm"> * 0x11800 (70K)           +-----------------------------------------+</span>
<span class="cm"> *                         |      CPU 1 NMI Register save area       |</span>
<span class="cm"> * 0x11600 (69.5K)         +-----------------------------------------+</span>
<span class="cm"> *                         |      CPU 0 NMI Register save area       |</span>
<span class="cm"> * 0x11400 (69K)           +-----------------------------------------+</span>
<span class="cm"> *                         |      GDA (1k)                           |</span>
<span class="cm"> * 0x11000 (68K)           +-----------------------------------------+</span>
<span class="cm"> *                         |      Early cache Exception stack        |</span>
<span class="cm"> *                         |             and/or                      |</span>
<span class="cm"> *			   |      kernel/io6prom nmi registers	     |</span>
<span class="cm"> * 0x10800  (66k)	   +-----------------------------------------+</span>
<span class="cm"> *			   |      cache error eframe   	 	     |</span>
<span class="cm"> * 0x10400 (65K)           +-----------------------------------------+</span>
<span class="cm"> *                         |      Exception Handlers (UALIAS copy)   |</span>
<span class="cm"> * 0x10000 (64K)           +-----------------------------------------+</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |      KLCONFIG - I (permanent) (48K)     |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> *                         |                                         |</span>
<span class="cm"> * 0x4000 (16K)            +-----------------------------------------+</span>
<span class="cm"> *                         |      NMI Handler (Protected Page)       |</span>
<span class="cm"> * 0x3000 (12K)            +-----------------------------------------+</span>
<span class="cm"> *                         |      ARCS PVECTORS (master node only)   |</span>
<span class="cm"> * 0x2c00 (11K)            +-----------------------------------------+</span>
<span class="cm"> *                         |      ARCS TVECTORS (master node only)   |</span>
<span class="cm"> * 0x2800 (10K)            +-----------------------------------------+</span>
<span class="cm"> *                         |      LAUNCH [NUM_CPU]                   |</span>
<span class="cm"> * 0x2400 (9K)             +-----------------------------------------+</span>
<span class="cm"> *                         |      Low memory directory (KLDIR)       |</span>
<span class="cm"> * 0x2000 (8K)             +-----------------------------------------+</span>
<span class="cm"> *                         |      ARCS SPB (1K)                      |</span>
<span class="cm"> * 0x1000 (4K)             +-----------------------------------------+</span>
<span class="cm"> *                         |      Early cache Exception stack        |</span>
<span class="cm"> *                         |             and/or                      |</span>
<span class="cm"> *			   |      kernel/io6prom nmi registers	     |</span>
<span class="cm"> * 0x800  (2k)	           +-----------------------------------------+</span>
<span class="cm"> *			   |      cache error eframe   	 	     |</span>
<span class="cm"> * 0x400 (1K)              +-----------------------------------------+</span>
<span class="cm"> *                         |      Exception Handlers                 |</span>
<span class="cm"> * 0x0   (0K)              +-----------------------------------------+</span>
<span class="cm"> */</span>

<span class="cp">#ifdef __ASSEMBLY__</span>
<span class="cp">#define KLDIR_OFF_MAGIC			0x00</span>
<span class="cp">#define KLDIR_OFF_OFFSET		0x08</span>
<span class="cp">#define KLDIR_OFF_POINTER		0x10</span>
<span class="cp">#define KLDIR_OFF_SIZE			0x18</span>
<span class="cp">#define KLDIR_OFF_COUNT			0x20</span>
<span class="cp">#define KLDIR_OFF_STRIDE		0x28</span>
<span class="cp">#endif </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * This is defined here because IP27_SYMMON_STK_SIZE must be at least what</span>
<span class="cm"> * we define here.  Since it&#39;s set up in the prom.  We can&#39;t redefine it later</span>
<span class="cm"> * and expect more space to be allocated.  The way to find out the true size</span>
<span class="cm"> * of the symmon stacks is to divide SYMMON_STK_SIZE by SYMMON_STK_STRIDE</span>
<span class="cm"> * for a particular node.</span>
<span class="cm"> */</span>
<span class="cp">#define SYMMON_STACK_SIZE		0x8000</span>

<span class="cp">#if defined(PROM)</span>

<span class="cm">/*</span>
<span class="cm"> * These defines are prom version dependent.  No code other than the IP27</span>
<span class="cm"> * prom should attempt to use these values.</span>
<span class="cm"> */</span>
<span class="cp">#define IP27_LAUNCH_OFFSET		0x2400</span>
<span class="cp">#define IP27_LAUNCH_SIZE		0x400</span>
<span class="cp">#define IP27_LAUNCH_COUNT		2</span>
<span class="cp">#define IP27_LAUNCH_STRIDE		0x200</span>

<span class="cp">#define IP27_KLCONFIG_OFFSET		0x4000</span>
<span class="cp">#define IP27_KLCONFIG_SIZE		0xc000</span>
<span class="cp">#define IP27_KLCONFIG_COUNT		1</span>
<span class="cp">#define IP27_KLCONFIG_STRIDE		0</span>

<span class="cp">#define IP27_NMI_OFFSET			0x3000</span>
<span class="cp">#define IP27_NMI_SIZE			0x40</span>
<span class="cp">#define IP27_NMI_COUNT			2</span>
<span class="cp">#define IP27_NMI_STRIDE			0x40</span>

<span class="cp">#define IP27_PI_ERROR_OFFSET		0x12000</span>
<span class="cp">#define IP27_PI_ERROR_SIZE		0x4000</span>
<span class="cp">#define IP27_PI_ERROR_COUNT		1</span>
<span class="cp">#define IP27_PI_ERROR_STRIDE		0</span>

<span class="cp">#define IP27_SYMMON_STK_OFFSET		0x25000</span>
<span class="cp">#define IP27_SYMMON_STK_SIZE		0xe000</span>
<span class="cp">#define IP27_SYMMON_STK_COUNT		2</span>
<span class="cm">/* IP27_SYMMON_STK_STRIDE must be &gt;= SYMMON_STACK_SIZE */</span>
<span class="cp">#define IP27_SYMMON_STK_STRIDE		0x7000</span>

<span class="cp">#define IP27_FREEMEM_OFFSET		0x19000</span>
<span class="cp">#define IP27_FREEMEM_SIZE		-1</span>
<span class="cp">#define IP27_FREEMEM_COUNT		1</span>
<span class="cp">#define IP27_FREEMEM_STRIDE		0</span>

<span class="cp">#endif </span><span class="cm">/* PROM */</span><span class="cp"></span>
<span class="cm">/*</span>
<span class="cm"> * There will be only one of these in a partition so the IO6 must set it up.</span>
<span class="cm"> */</span>
<span class="cp">#define IO6_GDA_OFFSET			0x11000</span>
<span class="cp">#define IO6_GDA_SIZE			0x400</span>
<span class="cp">#define IO6_GDA_COUNT			1</span>
<span class="cp">#define IO6_GDA_STRIDE			0</span>

<span class="cm">/*</span>
<span class="cm"> * save area of kernel nmi regs in the prom format</span>
<span class="cm"> */</span>
<span class="cp">#define IP27_NMI_KREGS_OFFSET		0x11400</span>
<span class="cp">#define IP27_NMI_KREGS_CPU_SIZE		0x200</span>
<span class="cm">/*</span>
<span class="cm"> * save area of kernel nmi regs in eframe format</span>
<span class="cm"> */</span>
<span class="cp">#define IP27_NMI_EFRAME_OFFSET		0x11800</span>
<span class="cp">#define IP27_NMI_EFRAME_SIZE		0x200</span>

<span class="cp">#define KLDIR_ENT_SIZE			0x40</span>
<span class="cp">#define KLDIR_MAX_ENTRIES		(0x400 / 0x40)</span>

<span class="cp">#ifndef __ASSEMBLY__</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">kldir_ent_s</span> <span class="p">{</span>
	<span class="n">u64</span>		<span class="n">magic</span><span class="p">;</span>		<span class="cm">/* Indicates validity of entry      */</span>
	<span class="kt">off_t</span>		<span class="n">offset</span><span class="p">;</span>		<span class="cm">/* Offset from start of node space  */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">pointer</span><span class="p">;</span>	<span class="cm">/* Pointer to area in some cases    */</span>
	<span class="kt">size_t</span>		<span class="n">size</span><span class="p">;</span>		<span class="cm">/* Size in bytes 		    */</span>
	<span class="n">u64</span>		<span class="n">count</span><span class="p">;</span>		<span class="cm">/* Repeat count if array, 1 if not  */</span>
	<span class="kt">size_t</span>		<span class="n">stride</span><span class="p">;</span>		<span class="cm">/* Stride if array, 0 if not        */</span>
	<span class="kt">char</span>		<span class="n">rsvd</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* Pad entry to 0x40 bytes          */</span>
	<span class="cm">/* NOTE: These 16 bytes are used in the Partition KLDIR</span>
<span class="cm">	   entry to store partition info. Refer to klpart.h for this. */</span>
<span class="p">}</span> <span class="n">kldir_ent_t</span><span class="p">;</span>
<span class="cp">#endif </span><span class="cm">/* !__ASSEMBLY__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _ASM_SN_KLDIR_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
