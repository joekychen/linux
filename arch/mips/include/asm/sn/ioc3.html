<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › sn › ioc3.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>ioc3.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 1999, 2000 Ralf Baechle</span>
<span class="cm"> * Copyright (C) 1999, 2000 Silicon Graphics, Inc.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _IOC3_H</span>
<span class="cp">#define _IOC3_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/* SUPERIO uart register map */</span>
<span class="k">typedef</span> <span class="k">volatile</span> <span class="k">struct</span> <span class="n">ioc3_uartregs</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">volatile</span> <span class="n">u8</span>	<span class="n">rbr</span><span class="p">;</span>	<span class="cm">/* read only, DLAB == 0 */</span>
		<span class="k">volatile</span> <span class="n">u8</span>	<span class="n">thr</span><span class="p">;</span>	<span class="cm">/* write only, DLAB == 0 */</span>
		<span class="k">volatile</span> <span class="n">u8</span>	<span class="n">dll</span><span class="p">;</span>	<span class="cm">/* DLAB == 1 */</span>
	<span class="p">}</span> <span class="n">u1</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">volatile</span> <span class="n">u8</span>	<span class="n">ier</span><span class="p">;</span>	<span class="cm">/* DLAB == 0 */</span>
		<span class="k">volatile</span> <span class="n">u8</span>	<span class="n">dlm</span><span class="p">;</span>	<span class="cm">/* DLAB == 1 */</span>
	<span class="p">}</span> <span class="n">u2</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">volatile</span> <span class="n">u8</span>	<span class="n">iir</span><span class="p">;</span>	<span class="cm">/* read only */</span>
		<span class="k">volatile</span> <span class="n">u8</span>	<span class="n">fcr</span><span class="p">;</span>	<span class="cm">/* write only */</span>
	<span class="p">}</span> <span class="n">u3</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>	    <span class="n">iu_lcr</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>	    <span class="n">iu_mcr</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>	    <span class="n">iu_lsr</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>	    <span class="n">iu_msr</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>	    <span class="n">iu_scr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">ioc3_uregs_t</span><span class="p">;</span>

<span class="cp">#define iu_rbr u1.rbr</span>
<span class="cp">#define iu_thr u1.thr</span>
<span class="cp">#define iu_dll u1.dll</span>
<span class="cp">#define iu_ier u2.ier</span>
<span class="cp">#define iu_dlm u2.dlm</span>
<span class="cp">#define iu_iir u3.iir</span>
<span class="cp">#define iu_fcr u3.fcr</span>

<span class="k">struct</span> <span class="n">ioc3_sioregs</span> <span class="p">{</span>
	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">fill</span><span class="p">[</span><span class="mh">0x141</span><span class="p">];</span>	<span class="cm">/* starts at 0x141 */</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">uartc</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">kbdcg</span><span class="p">;</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">fill0</span><span class="p">[</span><span class="mh">0x150</span> <span class="o">-</span> <span class="mh">0x142</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">pp_data</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">pp_dsr</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">pp_dcr</span><span class="p">;</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">fill1</span><span class="p">[</span><span class="mh">0x158</span> <span class="o">-</span> <span class="mh">0x152</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">pp_fifa</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">pp_cfgb</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">pp_ecr</span><span class="p">;</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">fill2</span><span class="p">[</span><span class="mh">0x168</span> <span class="o">-</span> <span class="mh">0x15a</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">rtcad</span><span class="p">;</span>
	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">rtcdat</span><span class="p">;</span>

	<span class="k">volatile</span> <span class="n">u8</span>		<span class="n">fill3</span><span class="p">[</span><span class="mh">0x170</span> <span class="o">-</span> <span class="mh">0x169</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">ioc3_uartregs</span>    <span class="n">uartb</span><span class="p">;</span>	<span class="cm">/* 0x20170  */</span>
	<span class="k">struct</span> <span class="n">ioc3_uartregs</span>    <span class="n">uarta</span><span class="p">;</span>	<span class="cm">/* 0x20178  */</span>
<span class="p">};</span>

<span class="cm">/* Register layout of IOC3 in configuration space.  */</span>
<span class="k">struct</span> <span class="n">ioc3</span> <span class="p">{</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">pad0</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>	<span class="cm">/* 0x00000  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sio_ir</span><span class="p">;</span>		<span class="cm">/* 0x0001c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sio_ies</span><span class="p">;</span>	<span class="cm">/* 0x00020  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sio_iec</span><span class="p">;</span>	<span class="cm">/* 0x00024  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sio_cr</span><span class="p">;</span>		<span class="cm">/* 0x00028  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">int_out</span><span class="p">;</span>	<span class="cm">/* 0x0002c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">mcr</span><span class="p">;</span>		<span class="cm">/* 0x00030  */</span>

	<span class="cm">/* General Purpose I/O registers  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gpcr_s</span><span class="p">;</span>		<span class="cm">/* 0x00034  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gpcr_c</span><span class="p">;</span>		<span class="cm">/* 0x00038  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gpdr</span><span class="p">;</span>		<span class="cm">/* 0x0003c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_0</span><span class="p">;</span>		<span class="cm">/* 0x00040  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_1</span><span class="p">;</span>		<span class="cm">/* 0x00044  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_2</span><span class="p">;</span>		<span class="cm">/* 0x00048  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_3</span><span class="p">;</span>		<span class="cm">/* 0x0004c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_4</span><span class="p">;</span>		<span class="cm">/* 0x00050  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_5</span><span class="p">;</span>		<span class="cm">/* 0x00054  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_6</span><span class="p">;</span>		<span class="cm">/* 0x00058  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_7</span><span class="p">;</span>		<span class="cm">/* 0x0005c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_8</span><span class="p">;</span>		<span class="cm">/* 0x00060  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_9</span><span class="p">;</span>		<span class="cm">/* 0x00064  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_10</span><span class="p">;</span>	<span class="cm">/* 0x00068  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_11</span><span class="p">;</span>	<span class="cm">/* 0x0006c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_12</span><span class="p">;</span>	<span class="cm">/* 0x00070  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_13</span><span class="p">;</span>	<span class="cm">/* 0x00074  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_14</span><span class="p">;</span>	<span class="cm">/* 0x00078  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">gppr_15</span><span class="p">;</span>	<span class="cm">/* 0x0007c  */</span>

	<span class="cm">/* Parallel Port Registers  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ppbr_h_a</span><span class="p">;</span>	<span class="cm">/* 0x00080  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ppbr_l_a</span><span class="p">;</span>	<span class="cm">/* 0x00084  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ppcr_a</span><span class="p">;</span>		<span class="cm">/* 0x00088  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ppcr</span><span class="p">;</span>		<span class="cm">/* 0x0008c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ppbr_h_b</span><span class="p">;</span>	<span class="cm">/* 0x00090  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ppbr_l_b</span><span class="p">;</span>	<span class="cm">/* 0x00094  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ppcr_b</span><span class="p">;</span>		<span class="cm">/* 0x00098  */</span>

	<span class="cm">/* Keyboard and Mouse Registers  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">km_csr</span><span class="p">;</span>		<span class="cm">/* 0x0009c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">k_rd</span><span class="p">;</span>		<span class="cm">/* 0x000a0  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">m_rd</span><span class="p">;</span>		<span class="cm">/* 0x000a4  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">k_wd</span><span class="p">;</span>		<span class="cm">/* 0x000a8  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">m_wd</span><span class="p">;</span>		<span class="cm">/* 0x000ac  */</span>

	<span class="cm">/* Serial Port Registers  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sbbr_h</span><span class="p">;</span>		<span class="cm">/* 0x000b0  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sbbr_l</span><span class="p">;</span>		<span class="cm">/* 0x000b4  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sscr_a</span><span class="p">;</span>		<span class="cm">/* 0x000b8  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">stpir_a</span><span class="p">;</span>	<span class="cm">/* 0x000bc  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">stcir_a</span><span class="p">;</span>	<span class="cm">/* 0x000c0  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">srpir_a</span><span class="p">;</span>	<span class="cm">/* 0x000c4  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">srcir_a</span><span class="p">;</span>	<span class="cm">/* 0x000c8  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">srtr_a</span><span class="p">;</span>		<span class="cm">/* 0x000cc  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">shadow_a</span><span class="p">;</span>	<span class="cm">/* 0x000d0  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">sscr_b</span><span class="p">;</span>		<span class="cm">/* 0x000d4  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">stpir_b</span><span class="p">;</span>	<span class="cm">/* 0x000d8  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">stcir_b</span><span class="p">;</span>	<span class="cm">/* 0x000dc  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">srpir_b</span><span class="p">;</span>	<span class="cm">/* 0x000e0  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">srcir_b</span><span class="p">;</span>	<span class="cm">/* 0x000e4  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">srtr_b</span><span class="p">;</span>		<span class="cm">/* 0x000e8  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">shadow_b</span><span class="p">;</span>	<span class="cm">/* 0x000ec  */</span>

	<span class="cm">/* Ethernet Registers  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">emcr</span><span class="p">;</span>		<span class="cm">/* 0x000f0  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">eisr</span><span class="p">;</span>		<span class="cm">/* 0x000f4  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">eier</span><span class="p">;</span>		<span class="cm">/* 0x000f8  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ercsr</span><span class="p">;</span>		<span class="cm">/* 0x000fc  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">erbr_h</span><span class="p">;</span>		<span class="cm">/* 0x00100  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">erbr_l</span><span class="p">;</span>		<span class="cm">/* 0x00104  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">erbar</span><span class="p">;</span>		<span class="cm">/* 0x00108  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ercir</span><span class="p">;</span>		<span class="cm">/* 0x0010c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">erpir</span><span class="p">;</span>		<span class="cm">/* 0x00110  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ertr</span><span class="p">;</span>		<span class="cm">/* 0x00114  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">etcsr</span><span class="p">;</span>		<span class="cm">/* 0x00118  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ersr</span><span class="p">;</span>		<span class="cm">/* 0x0011c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">etcdc</span><span class="p">;</span>		<span class="cm">/* 0x00120  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ebir</span><span class="p">;</span>		<span class="cm">/* 0x00124  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">etbr_h</span><span class="p">;</span>		<span class="cm">/* 0x00128  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">etbr_l</span><span class="p">;</span>		<span class="cm">/* 0x0012c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">etcir</span><span class="p">;</span>		<span class="cm">/* 0x00130  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">etpir</span><span class="p">;</span>		<span class="cm">/* 0x00134  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">emar_h</span><span class="p">;</span>		<span class="cm">/* 0x00138  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">emar_l</span><span class="p">;</span>		<span class="cm">/* 0x0013c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ehar_h</span><span class="p">;</span>		<span class="cm">/* 0x00140  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ehar_l</span><span class="p">;</span>		<span class="cm">/* 0x00144  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">micr</span><span class="p">;</span>		<span class="cm">/* 0x00148  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">midr_r</span><span class="p">;</span>		<span class="cm">/* 0x0014c  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">midr_w</span><span class="p">;</span>		<span class="cm">/* 0x00150  */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">pad1</span><span class="p">[(</span><span class="mh">0x20000</span> <span class="o">-</span> <span class="mh">0x00154</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">];</span>

	<span class="cm">/* SuperIO Registers  XXX */</span>
	<span class="k">struct</span> <span class="n">ioc3_sioregs</span>	<span class="n">sregs</span><span class="p">;</span>	<span class="cm">/* 0x20000 */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">pad2</span><span class="p">[(</span><span class="mh">0x40000</span> <span class="o">-</span> <span class="mh">0x20180</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">];</span>

	<span class="cm">/* SSRAM Diagnostic Access */</span>
	<span class="k">volatile</span> <span class="n">u32</span>	<span class="n">ssram</span><span class="p">[(</span><span class="mh">0x80000</span> <span class="o">-</span> <span class="mh">0x40000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">];</span>

	<span class="cm">/* Bytebus device offsets</span>
<span class="cm">	   0x80000 -   Access to the generic devices selected with   DEV0</span>
<span class="cm">	   0x9FFFF     bytebus DEV_SEL_0</span>
<span class="cm">	   0xA0000 -   Access to the generic devices selected with   DEV1</span>
<span class="cm">	   0xBFFFF     bytebus DEV_SEL_1</span>
<span class="cm">	   0xC0000 -   Access to the generic devices selected with   DEV2</span>
<span class="cm">	   0xDFFFF     bytebus DEV_SEL_2</span>
<span class="cm">	   0xE0000 -   Access to the generic devices selected with   DEV3</span>
<span class="cm">	   0xFFFFF     bytebus DEV_SEL_3  */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Ethernet RX Buffer</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ioc3_erxbuf</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">w0</span><span class="p">;</span>			<span class="cm">/* first word (valid,bcnt,cksum) */</span>
	<span class="n">u32</span>	<span class="n">err</span><span class="p">;</span>			<span class="cm">/* second word various errors */</span>
	<span class="cm">/* next comes n bytes of padding */</span>
	<span class="cm">/* then the received ethernet frame itself */</span>
<span class="p">};</span>

<span class="cp">#define ERXBUF_IPCKSUM_MASK	0x0000ffff</span>
<span class="cp">#define ERXBUF_BYTECNT_MASK	0x07ff0000</span>
<span class="cp">#define ERXBUF_BYTECNT_SHIFT	16</span>
<span class="cp">#define ERXBUF_V		0x80000000</span>

<span class="cp">#define ERXBUF_CRCERR		0x00000001	</span><span class="cm">/* aka RSV15 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_FRAMERR		0x00000002	</span><span class="cm">/* aka RSV14 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_CODERR		0x00000004	</span><span class="cm">/* aka RSV13 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_INVPREAMB	0x00000008	</span><span class="cm">/* aka RSV18 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_LOLEN		0x00007000	</span><span class="cm">/* aka RSV2_0 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_HILEN		0x03ff0000	</span><span class="cm">/* aka RSV12_3 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_MULTICAST	0x04000000	</span><span class="cm">/* aka RSV16 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_BROADCAST	0x08000000	</span><span class="cm">/* aka RSV17 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_LONGEVENT	0x10000000	</span><span class="cm">/* aka RSV19 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_BADPKT		0x20000000	</span><span class="cm">/* aka RSV20 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_GOODPKT		0x40000000	</span><span class="cm">/* aka RSV21 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_CARRIER		0x80000000	</span><span class="cm">/* aka RSV22 */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Ethernet TX Descriptor</span>
<span class="cm"> */</span>
<span class="cp">#define ETXD_DATALEN    104</span>
<span class="k">struct</span> <span class="n">ioc3_etxd</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">cmd</span><span class="p">;</span>				<span class="cm">/* command field */</span>
	<span class="n">u32</span>	<span class="n">bufcnt</span><span class="p">;</span>				<span class="cm">/* buffer counts field */</span>
	<span class="n">u64</span>	<span class="n">p1</span><span class="p">;</span>				<span class="cm">/* buffer pointer 1 */</span>
	<span class="n">u64</span>	<span class="n">p2</span><span class="p">;</span>				<span class="cm">/* buffer pointer 2 */</span>
	<span class="n">u8</span>	<span class="n">data</span><span class="p">[</span><span class="n">ETXD_DATALEN</span><span class="p">];</span>		<span class="cm">/* opt. tx data */</span>
<span class="p">};</span>

<span class="cp">#define ETXD_BYTECNT_MASK	0x000007ff	</span><span class="cm">/* total byte count */</span><span class="cp"></span>
<span class="cp">#define ETXD_INTWHENDONE	0x00001000	</span><span class="cm">/* intr when done */</span><span class="cp"></span>
<span class="cp">#define ETXD_D0V		0x00010000	</span><span class="cm">/* data 0 valid */</span><span class="cp"></span>
<span class="cp">#define ETXD_B1V		0x00020000	</span><span class="cm">/* buf 1 valid */</span><span class="cp"></span>
<span class="cp">#define ETXD_B2V		0x00040000	</span><span class="cm">/* buf 2 valid */</span><span class="cp"></span>
<span class="cp">#define ETXD_DOCHECKSUM		0x00080000	</span><span class="cm">/* insert ip cksum */</span><span class="cp"></span>
<span class="cp">#define ETXD_CHKOFF_MASK	0x07f00000	</span><span class="cm">/* cksum byte offset */</span><span class="cp"></span>
<span class="cp">#define ETXD_CHKOFF_SHIFT	20</span>

<span class="cp">#define ETXD_D0CNT_MASK		0x0000007f</span>
<span class="cp">#define ETXD_B1CNT_MASK		0x0007ff00</span>
<span class="cp">#define ETXD_B1CNT_SHIFT	8</span>
<span class="cp">#define ETXD_B2CNT_MASK		0x7ff00000</span>
<span class="cp">#define ETXD_B2CNT_SHIFT	20</span>

<span class="cm">/*</span>
<span class="cm"> * Bytebus device space</span>
<span class="cm"> */</span>
<span class="cp">#define IOC3_BYTEBUS_DEV0	0x80000L</span>
<span class="cp">#define IOC3_BYTEBUS_DEV1	0xa0000L</span>
<span class="cp">#define IOC3_BYTEBUS_DEV2	0xc0000L</span>
<span class="cp">#define IOC3_BYTEBUS_DEV3	0xe0000L</span>

<span class="cm">/* ------------------------------------------------------------------------- */</span>

<span class="cm">/* Superio Registers (PIO Access) */</span>
<span class="cp">#define IOC3_SIO_BASE		0x20000</span>
<span class="cp">#define IOC3_SIO_UARTC		(IOC3_SIO_BASE+0x141)	</span><span class="cm">/* UART Config */</span><span class="cp"></span>
<span class="cp">#define IOC3_SIO_KBDCG		(IOC3_SIO_BASE+0x142)	</span><span class="cm">/* KBD Config */</span><span class="cp"></span>
<span class="cp">#define IOC3_SIO_PP_BASE	(IOC3_SIO_BASE+PP_BASE)		</span><span class="cm">/* Parallel Port */</span><span class="cp"></span>
<span class="cp">#define IOC3_SIO_RTC_BASE	(IOC3_SIO_BASE+0x168)	</span><span class="cm">/* Real Time Clock */</span><span class="cp"></span>
<span class="cp">#define IOC3_SIO_UB_BASE	(IOC3_SIO_BASE+UARTB_BASE)	</span><span class="cm">/* UART B */</span><span class="cp"></span>
<span class="cp">#define IOC3_SIO_UA_BASE	(IOC3_SIO_BASE+UARTA_BASE)	</span><span class="cm">/* UART A */</span><span class="cp"></span>

<span class="cm">/* SSRAM Diagnostic Access */</span>
<span class="cp">#define IOC3_SSRAM	IOC3_RAM_OFF	</span><span class="cm">/* base of SSRAM diagnostic access */</span><span class="cp"></span>
<span class="cp">#define IOC3_SSRAM_LEN	0x40000 </span><span class="cm">/* 256kb (address space size, may not be fully populated) */</span><span class="cp"></span>
<span class="cp">#define IOC3_SSRAM_DM	0x0000ffff	</span><span class="cm">/* data mask */</span><span class="cp"></span>
<span class="cp">#define IOC3_SSRAM_PM	0x00010000	</span><span class="cm">/* parity mask */</span><span class="cp"></span>

<span class="cm">/* bitmasks for PCI_SCR */</span>
<span class="cp">#define PCI_SCR_PAR_RESP_EN	0x00000040	</span><span class="cm">/* enb PCI parity checking */</span><span class="cp"></span>
<span class="cp">#define PCI_SCR_SERR_EN		0x00000100	</span><span class="cm">/* enable the SERR# driver */</span><span class="cp"></span>
<span class="cp">#define PCI_SCR_DROP_MODE_EN	0x00008000	</span><span class="cm">/* drop pios on parity err */</span><span class="cp"></span>
<span class="cp">#define PCI_SCR_RX_SERR		(0x1 &lt;&lt; 16)</span>
<span class="cp">#define PCI_SCR_DROP_MODE	(0x1 &lt;&lt; 17)</span>
<span class="cp">#define PCI_SCR_SIG_PAR_ERR	(0x1 &lt;&lt; 24)</span>
<span class="cp">#define PCI_SCR_SIG_TAR_ABRT	(0x1 &lt;&lt; 27)</span>
<span class="cp">#define PCI_SCR_RX_TAR_ABRT	(0x1 &lt;&lt; 28)</span>
<span class="cp">#define PCI_SCR_SIG_MST_ABRT	(0x1 &lt;&lt; 29)</span>
<span class="cp">#define PCI_SCR_SIG_SERR	(0x1 &lt;&lt; 30)</span>
<span class="cp">#define PCI_SCR_PAR_ERR		(0x1 &lt;&lt; 31)</span>

<span class="cm">/* bitmasks for IOC3_KM_CSR */</span>
<span class="cp">#define KM_CSR_K_WRT_PEND 0x00000001	</span><span class="cm">/* kbd port xmitting or resetting */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_WRT_PEND 0x00000002	</span><span class="cm">/* mouse port xmitting or resetting */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_LCB	  0x00000004	</span><span class="cm">/* Line Cntrl Bit for last KBD write */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_LCB	  0x00000008	</span><span class="cm">/* same for mouse */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_DATA	  0x00000010	</span><span class="cm">/* state of kbd data line */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_CLK	  0x00000020	</span><span class="cm">/* state of kbd clock line */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_PULL_DATA 0x00000040	</span><span class="cm">/* pull kbd data line low */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_PULL_CLK 0x00000080	</span><span class="cm">/* pull kbd clock line low */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_DATA	  0x00000100	</span><span class="cm">/* state of ms data line */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_CLK	  0x00000200	</span><span class="cm">/* state of ms clock line */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_PULL_DATA 0x00000400	</span><span class="cm">/* pull ms data line low */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_PULL_CLK 0x00000800	</span><span class="cm">/* pull ms clock line low */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_EMM_MODE	  0x00001000	</span><span class="cm">/* emulation mode */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_SIM_MODE	  0x00002000	</span><span class="cm">/* clock X8 */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_SM_IDLE  0x00004000	</span><span class="cm">/* Keyboard is idle */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_SM_IDLE  0x00008000	</span><span class="cm">/* Mouse is idle */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_TO	  0x00010000	</span><span class="cm">/* Keyboard trying to send/receive */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_TO	  0x00020000	</span><span class="cm">/* Mouse trying to send/receive */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_TO_EN	  0x00040000	</span><span class="cm">/* KM_CSR_K_TO + KM_CSR_K_TO_EN = cause</span>
<span class="cm">					   SIO_IR to assert */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_TO_EN	  0x00080000	</span><span class="cm">/* KM_CSR_M_TO + KM_CSR_M_TO_EN = cause</span>
<span class="cm">					   SIO_IR to assert */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_CLAMP_ONE	0x00100000	</span><span class="cm">/* Pull K_CLK low after rec. one char */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_CLAMP_ONE	0x00200000	</span><span class="cm">/* Pull M_CLK low after rec. one char */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_K_CLAMP_THREE	0x00400000	</span><span class="cm">/* Pull K_CLK low after rec. three chars */</span><span class="cp"></span>
<span class="cp">#define KM_CSR_M_CLAMP_THREE	0x00800000	</span><span class="cm">/* Pull M_CLK low after rec. three char */</span><span class="cp"></span>

<span class="cm">/* bitmasks for IOC3_K_RD and IOC3_M_RD */</span>
<span class="cp">#define KM_RD_DATA_2	0x000000ff	</span><span class="cm">/* 3rd char recvd since last read */</span><span class="cp"></span>
<span class="cp">#define KM_RD_DATA_2_SHIFT 0</span>
<span class="cp">#define KM_RD_DATA_1	0x0000ff00	</span><span class="cm">/* 2nd char recvd since last read */</span><span class="cp"></span>
<span class="cp">#define KM_RD_DATA_1_SHIFT 8</span>
<span class="cp">#define KM_RD_DATA_0	0x00ff0000	</span><span class="cm">/* 1st char recvd since last read */</span><span class="cp"></span>
<span class="cp">#define KM_RD_DATA_0_SHIFT 16</span>
<span class="cp">#define KM_RD_FRAME_ERR_2 0x01000000	</span><span class="cm">/*  framing or parity error in byte 2 */</span><span class="cp"></span>
<span class="cp">#define KM_RD_FRAME_ERR_1 0x02000000	</span><span class="cm">/* same for byte 1 */</span><span class="cp"></span>
<span class="cp">#define KM_RD_FRAME_ERR_0 0x04000000	</span><span class="cm">/* same for byte 0 */</span><span class="cp"></span>

<span class="cp">#define KM_RD_KBD_MSE	0x08000000	</span><span class="cm">/* 0 if from kbd, 1 if from mouse */</span><span class="cp"></span>
<span class="cp">#define KM_RD_OFLO	0x10000000	</span><span class="cm">/* 4th char recvd before this read */</span><span class="cp"></span>
<span class="cp">#define KM_RD_VALID_2	0x20000000	</span><span class="cm">/* DATA_2 valid */</span><span class="cp"></span>
<span class="cp">#define KM_RD_VALID_1	0x40000000	</span><span class="cm">/* DATA_1 valid */</span><span class="cp"></span>
<span class="cp">#define KM_RD_VALID_0	0x80000000	</span><span class="cm">/* DATA_0 valid */</span><span class="cp"></span>
<span class="cp">#define KM_RD_VALID_ALL (KM_RD_VALID_0|KM_RD_VALID_1|KM_RD_VALID_2)</span>

<span class="cm">/* bitmasks for IOC3_K_WD &amp; IOC3_M_WD */</span>
<span class="cp">#define KM_WD_WRT_DATA	0x000000ff	</span><span class="cm">/* write to keyboard/mouse port */</span><span class="cp"></span>
<span class="cp">#define KM_WD_WRT_DATA_SHIFT 0</span>

<span class="cm">/* bitmasks for serial RX status byte */</span>
<span class="cp">#define RXSB_OVERRUN	0x01	</span><span class="cm">/* char(s) lost */</span><span class="cp"></span>
<span class="cp">#define RXSB_PAR_ERR	0x02	</span><span class="cm">/* parity error */</span><span class="cp"></span>
<span class="cp">#define RXSB_FRAME_ERR	0x04	</span><span class="cm">/* framing error */</span><span class="cp"></span>
<span class="cp">#define RXSB_BREAK	0x08	</span><span class="cm">/* break character */</span><span class="cp"></span>
<span class="cp">#define RXSB_CTS	0x10	</span><span class="cm">/* state of CTS */</span><span class="cp"></span>
<span class="cp">#define RXSB_DCD	0x20	</span><span class="cm">/* state of DCD */</span><span class="cp"></span>
<span class="cp">#define RXSB_MODEM_VALID 0x40	</span><span class="cm">/* DCD, CTS and OVERRUN are valid */</span><span class="cp"></span>
<span class="cp">#define RXSB_DATA_VALID 0x80	</span><span class="cm">/* data byte, FRAME_ERR PAR_ERR &amp; BREAK valid */</span><span class="cp"></span>

<span class="cm">/* bitmasks for serial TX control byte */</span>
<span class="cp">#define TXCB_INT_WHEN_DONE 0x20 </span><span class="cm">/* interrupt after this byte is sent */</span><span class="cp"></span>
<span class="cp">#define TXCB_INVALID	0x00	</span><span class="cm">/* byte is invalid */</span><span class="cp"></span>
<span class="cp">#define TXCB_VALID	0x40	</span><span class="cm">/* byte is valid */</span><span class="cp"></span>
<span class="cp">#define TXCB_MCR	0x80	</span><span class="cm">/* data&lt;7:0&gt; to modem control register */</span><span class="cp"></span>
<span class="cp">#define TXCB_DELAY	0xc0	</span><span class="cm">/* delay data&lt;7:0&gt; mSec */</span><span class="cp"></span>

<span class="cm">/* bitmasks for IOC3_SBBR_L */</span>
<span class="cp">#define SBBR_L_SIZE	0x00000001	</span><span class="cm">/* 0 == 1KB rings, 1 == 4KB rings */</span><span class="cp"></span>
<span class="cp">#define SBBR_L_BASE	0xfffff000	</span><span class="cm">/* lower serial ring base addr */</span><span class="cp"></span>

<span class="cm">/* bitmasks for IOC3_SSCR_&lt;A:B&gt; */</span>
<span class="cp">#define SSCR_RX_THRESHOLD 0x000001ff	</span><span class="cm">/* hiwater mark */</span><span class="cp"></span>
<span class="cp">#define SSCR_TX_TIMER_BUSY 0x00010000	</span><span class="cm">/* TX timer in progress */</span><span class="cp"></span>
<span class="cp">#define SSCR_HFC_EN	0x00020000	</span><span class="cm">/* hardware flow control enabled */</span><span class="cp"></span>
<span class="cp">#define SSCR_RX_RING_DCD 0x00040000	</span><span class="cm">/* post RX record on delta-DCD */</span><span class="cp"></span>
<span class="cp">#define SSCR_RX_RING_CTS 0x00080000	</span><span class="cm">/* post RX record on delta-CTS */</span><span class="cp"></span>
<span class="cp">#define SSCR_HIGH_SPD	0x00100000	</span><span class="cm">/* 4X speed */</span><span class="cp"></span>
<span class="cp">#define SSCR_DIAG	0x00200000	</span><span class="cm">/* bypass clock divider for sim */</span><span class="cp"></span>
<span class="cp">#define SSCR_RX_DRAIN	0x08000000	</span><span class="cm">/* drain RX buffer to memory */</span><span class="cp"></span>
<span class="cp">#define SSCR_DMA_EN	0x10000000	</span><span class="cm">/* enable ring buffer DMA */</span><span class="cp"></span>
<span class="cp">#define SSCR_DMA_PAUSE	0x20000000	</span><span class="cm">/* pause DMA */</span><span class="cp"></span>
<span class="cp">#define SSCR_PAUSE_STATE 0x40000000	</span><span class="cm">/* sets when PAUSE takes effect */</span><span class="cp"></span>
<span class="cp">#define SSCR_RESET	0x80000000	</span><span class="cm">/* reset DMA channels */</span><span class="cp"></span>

<span class="cm">/* all producer/comsumer pointers are the same bitfield */</span>
<span class="cp">#define PROD_CONS_PTR_4K 0x00000ff8	</span><span class="cm">/* for 4K buffers */</span><span class="cp"></span>
<span class="cp">#define PROD_CONS_PTR_1K 0x000003f8	</span><span class="cm">/* for 1K buffers */</span><span class="cp"></span>
<span class="cp">#define PROD_CONS_PTR_OFF 3</span>

<span class="cm">/* bitmasks for IOC3_SRCIR_&lt;A:B&gt; */</span>
<span class="cp">#define SRCIR_ARM	0x80000000	</span><span class="cm">/* arm RX timer */</span><span class="cp"></span>

<span class="cm">/* bitmasks for IOC3_SRPIR_&lt;A:B&gt; */</span>
<span class="cp">#define SRPIR_BYTE_CNT	0x07000000	</span><span class="cm">/* bytes in packer */</span><span class="cp"></span>
<span class="cp">#define SRPIR_BYTE_CNT_SHIFT 24</span>

<span class="cm">/* bitmasks for IOC3_STCIR_&lt;A:B&gt; */</span>
<span class="cp">#define STCIR_BYTE_CNT	0x0f000000	</span><span class="cm">/* bytes in unpacker */</span><span class="cp"></span>
<span class="cp">#define STCIR_BYTE_CNT_SHIFT 24</span>

<span class="cm">/* bitmasks for IOC3_SHADOW_&lt;A:B&gt; */</span>
<span class="cp">#define SHADOW_DR	0x00000001	</span><span class="cm">/* data ready */</span><span class="cp"></span>
<span class="cp">#define SHADOW_OE	0x00000002	</span><span class="cm">/* overrun error */</span><span class="cp"></span>
<span class="cp">#define SHADOW_PE	0x00000004	</span><span class="cm">/* parity error */</span><span class="cp"></span>
<span class="cp">#define SHADOW_FE	0x00000008	</span><span class="cm">/* framing error */</span><span class="cp"></span>
<span class="cp">#define SHADOW_BI	0x00000010	</span><span class="cm">/* break interrupt */</span><span class="cp"></span>
<span class="cp">#define SHADOW_THRE	0x00000020	</span><span class="cm">/* transmit holding register empty */</span><span class="cp"></span>
<span class="cp">#define SHADOW_TEMT	0x00000040	</span><span class="cm">/* transmit shift register empty */</span><span class="cp"></span>
<span class="cp">#define SHADOW_RFCE	0x00000080	</span><span class="cm">/* char in RX fifo has an error */</span><span class="cp"></span>
<span class="cp">#define SHADOW_DCTS	0x00010000	</span><span class="cm">/* delta clear to send */</span><span class="cp"></span>
<span class="cp">#define SHADOW_DDCD	0x00080000	</span><span class="cm">/* delta data carrier detect */</span><span class="cp"></span>
<span class="cp">#define SHADOW_CTS	0x00100000	</span><span class="cm">/* clear to send */</span><span class="cp"></span>
<span class="cp">#define SHADOW_DCD	0x00800000	</span><span class="cm">/* data carrier detect */</span><span class="cp"></span>
<span class="cp">#define SHADOW_DTR	0x01000000	</span><span class="cm">/* data terminal ready */</span><span class="cp"></span>
<span class="cp">#define SHADOW_RTS	0x02000000	</span><span class="cm">/* request to send */</span><span class="cp"></span>
<span class="cp">#define SHADOW_OUT1	0x04000000	</span><span class="cm">/* 16550 OUT1 bit */</span><span class="cp"></span>
<span class="cp">#define SHADOW_OUT2	0x08000000	</span><span class="cm">/* 16550 OUT2 bit */</span><span class="cp"></span>
<span class="cp">#define SHADOW_LOOP	0x10000000	</span><span class="cm">/* loopback enabled */</span><span class="cp"></span>

<span class="cm">/* bitmasks for IOC3_SRTR_&lt;A:B&gt; */</span>
<span class="cp">#define SRTR_CNT	0x00000fff	</span><span class="cm">/* reload value for RX timer */</span><span class="cp"></span>
<span class="cp">#define SRTR_CNT_VAL	0x0fff0000	</span><span class="cm">/* current value of RX timer */</span><span class="cp"></span>
<span class="cp">#define SRTR_CNT_VAL_SHIFT 16</span>
<span class="cp">#define SRTR_HZ		16000	</span><span class="cm">/* SRTR clock frequency */</span><span class="cp"></span>

<span class="cm">/* bitmasks for IOC3_SIO_IR, IOC3_SIO_IEC and IOC3_SIO_IES  */</span>
<span class="cp">#define SIO_IR_SA_TX_MT		0x00000001	</span><span class="cm">/* Serial port A TX empty */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_RX_FULL	0x00000002	</span><span class="cm">/* port A RX buf full */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_RX_HIGH	0x00000004	</span><span class="cm">/* port A RX hiwat */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_RX_TIMER	0x00000008	</span><span class="cm">/* port A RX timeout */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_DELTA_DCD	0x00000010	</span><span class="cm">/* port A delta DCD */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_DELTA_CTS	0x00000020	</span><span class="cm">/* port A delta CTS */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_INT		0x00000040	</span><span class="cm">/* port A pass-thru intr */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_TX_EXPLICIT	0x00000080	</span><span class="cm">/* port A explicit TX thru */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SA_MEMERR	0x00000100	</span><span class="cm">/* port A PCI error */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_TX_MT		0x00000200	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_RX_FULL	0x00000400	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_RX_HIGH	0x00000800	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_RX_TIMER	0x00001000	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_DELTA_DCD	0x00002000	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_DELTA_CTS	0x00004000	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_INT		0x00008000	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_TX_EXPLICIT	0x00010000	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_SB_MEMERR	0x00020000	</span><span class="cm">/* */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_PP_INT		0x00040000	</span><span class="cm">/* P port pass-thru intr */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_PP_INTA		0x00080000	</span><span class="cm">/* PP context A thru */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_PP_INTB		0x00100000	</span><span class="cm">/* PP context B thru */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_PP_MEMERR	0x00200000	</span><span class="cm">/* PP PCI error */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_KBD_INT		0x00400000	</span><span class="cm">/* kbd/mouse intr */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_RT_INT		0x08000000	</span><span class="cm">/* RT output pulse */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_GEN_INT1		0x10000000	</span><span class="cm">/* RT input pulse */</span><span class="cp"></span>
<span class="cp">#define SIO_IR_GEN_INT_SHIFT	28</span>

<span class="cm">/* per device interrupt masks */</span>
<span class="cp">#define SIO_IR_SA		(SIO_IR_SA_TX_MT | SIO_IR_SA_RX_FULL | \</span>
<span class="cp">				 SIO_IR_SA_RX_HIGH | SIO_IR_SA_RX_TIMER | \</span>
<span class="cp">				 SIO_IR_SA_DELTA_DCD | SIO_IR_SA_DELTA_CTS | \</span>
<span class="cp">				 SIO_IR_SA_INT | SIO_IR_SA_TX_EXPLICIT | \</span>
<span class="cp">				 SIO_IR_SA_MEMERR)</span>
<span class="cp">#define SIO_IR_SB		(SIO_IR_SB_TX_MT | SIO_IR_SB_RX_FULL | \</span>
<span class="cp">				 SIO_IR_SB_RX_HIGH | SIO_IR_SB_RX_TIMER | \</span>
<span class="cp">				 SIO_IR_SB_DELTA_DCD | SIO_IR_SB_DELTA_CTS | \</span>
<span class="cp">				 SIO_IR_SB_INT | SIO_IR_SB_TX_EXPLICIT | \</span>
<span class="cp">				 SIO_IR_SB_MEMERR)</span>
<span class="cp">#define SIO_IR_PP		(SIO_IR_PP_INT | SIO_IR_PP_INTA | \</span>
<span class="cp">				 SIO_IR_PP_INTB | SIO_IR_PP_MEMERR)</span>
<span class="cp">#define SIO_IR_RT		(SIO_IR_RT_INT | SIO_IR_GEN_INT1)</span>

<span class="cm">/* macro to load pending interrupts */</span>
<span class="cp">#define IOC3_PENDING_INTRS(mem) (PCI_INW(&amp;((mem)-&gt;sio_ir)) &amp; \</span>
<span class="cp">				 PCI_INW(&amp;((mem)-&gt;sio_ies_ro)))</span>

<span class="cm">/* bitmasks for SIO_CR */</span>
<span class="cp">#define SIO_CR_SIO_RESET	0x00000001	</span><span class="cm">/* reset the SIO */</span><span class="cp"></span>
<span class="cp">#define SIO_CR_SER_A_BASE	0x000000fe	</span><span class="cm">/* DMA poll addr port A */</span><span class="cp"></span>
<span class="cp">#define SIO_CR_SER_A_BASE_SHIFT 1</span>
<span class="cp">#define SIO_CR_SER_B_BASE	0x00007f00	</span><span class="cm">/* DMA poll addr port B */</span><span class="cp"></span>
<span class="cp">#define SIO_CR_SER_B_BASE_SHIFT 8</span>
<span class="cp">#define SIO_SR_CMD_PULSE	0x00078000	</span><span class="cm">/* byte bus strobe length */</span><span class="cp"></span>
<span class="cp">#define SIO_CR_CMD_PULSE_SHIFT	15</span>
<span class="cp">#define SIO_CR_ARB_DIAG		0x00380000	</span><span class="cm">/* cur !enet PCI requet (ro) */</span><span class="cp"></span>
<span class="cp">#define SIO_CR_ARB_DIAG_TXA	0x00000000</span>
<span class="cp">#define SIO_CR_ARB_DIAG_RXA	0x00080000</span>
<span class="cp">#define SIO_CR_ARB_DIAG_TXB	0x00100000</span>
<span class="cp">#define SIO_CR_ARB_DIAG_RXB	0x00180000</span>
<span class="cp">#define SIO_CR_ARB_DIAG_PP	0x00200000</span>
<span class="cp">#define SIO_CR_ARB_DIAG_IDLE	0x00400000	</span><span class="cm">/* 0 -&gt; active request (ro) */</span><span class="cp"></span>

<span class="cm">/* bitmasks for INT_OUT */</span>
<span class="cp">#define INT_OUT_COUNT	0x0000ffff	</span><span class="cm">/* pulse interval timer */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_MODE	0x00070000	</span><span class="cm">/* mode mask */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_MODE_0	0x00000000	</span><span class="cm">/* set output to 0 */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_MODE_1	0x00040000	</span><span class="cm">/* set output to 1 */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_MODE_1PULSE 0x00050000	</span><span class="cm">/* send 1 pulse */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_MODE_PULSES 0x00060000	</span><span class="cm">/* send 1 pulse every interval */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_MODE_SQW 0x00070000	</span><span class="cm">/* toggle output every interval */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_DIAG	0x40000000	</span><span class="cm">/* diag mode */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_INT_OUT 0x80000000	</span><span class="cm">/* current state of INT_OUT */</span><span class="cp"></span>

<span class="cm">/* time constants for INT_OUT */</span>
<span class="cp">#define INT_OUT_NS_PER_TICK (30 * 260)	</span><span class="cm">/* 30 ns PCI clock, divisor=260 */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_TICKS_PER_PULSE 3	</span><span class="cm">/* outgoing pulse lasts 3 ticks */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_US_TO_COUNT(x)		</span><span class="cm">/* convert uS to a count value */</span><span class="cp"> \</span>
<span class="cp">	(((x) * 10 + INT_OUT_NS_PER_TICK / 200) *	\</span>
<span class="cp">	 100 / INT_OUT_NS_PER_TICK - 1)</span>
<span class="cp">#define INT_OUT_COUNT_TO_US(x)		</span><span class="cm">/* convert count value to uS */</span><span class="cp"> \</span>
<span class="cp">	(((x) + 1) * INT_OUT_NS_PER_TICK / 1000)</span>
<span class="cp">#define INT_OUT_MIN_TICKS 3	</span><span class="cm">/* min period is width of pulse in &quot;ticks&quot; */</span><span class="cp"></span>
<span class="cp">#define INT_OUT_MAX_TICKS INT_OUT_COUNT		</span><span class="cm">/* largest possible count */</span><span class="cp"></span>

<span class="cm">/* bitmasks for GPCR */</span>
<span class="cp">#define GPCR_DIR	0x000000ff	</span><span class="cm">/* tristate pin input or output */</span><span class="cp"></span>
<span class="cp">#define GPCR_DIR_PIN(x) (1&lt;&lt;(x))	</span><span class="cm">/* access one of the DIR bits */</span><span class="cp"></span>
<span class="cp">#define GPCR_EDGE	0x000f0000	</span><span class="cm">/* extint edge or level sensitive */</span><span class="cp"></span>
<span class="cp">#define GPCR_EDGE_PIN(x) (1&lt;&lt;((x)+15))	</span><span class="cm">/* access one of the EDGE bits */</span><span class="cp"></span>

<span class="cm">/* values for GPCR */</span>
<span class="cp">#define GPCR_INT_OUT_EN 0x00100000	</span><span class="cm">/* enable INT_OUT to pin 0 */</span><span class="cp"></span>
<span class="cp">#define GPCR_MLAN_EN	0x00200000	</span><span class="cm">/* enable MCR to pin 8 */</span><span class="cp"></span>
<span class="cp">#define GPCR_DIR_SERA_XCVR 0x00000080	</span><span class="cm">/* Port A Transceiver select enable */</span><span class="cp"></span>
<span class="cp">#define GPCR_DIR_SERB_XCVR 0x00000040	</span><span class="cm">/* Port B Transceiver select enable */</span><span class="cp"></span>
<span class="cp">#define GPCR_DIR_PHY_RST   0x00000020	</span><span class="cm">/* ethernet PHY reset enable */</span><span class="cp"></span>

<span class="cm">/* defs for some of the generic I/O pins */</span>
<span class="cp">#define GPCR_PHY_RESET		0x20	</span><span class="cm">/* pin is output to PHY reset */</span><span class="cp"></span>
<span class="cp">#define GPCR_UARTB_MODESEL	0x40	</span><span class="cm">/* pin is output to port B mode sel */</span><span class="cp"></span>
<span class="cp">#define GPCR_UARTA_MODESEL	0x80	</span><span class="cm">/* pin is output to port A mode sel */</span><span class="cp"></span>

<span class="cp">#define GPPR_PHY_RESET_PIN	5	</span><span class="cm">/* GIO pin controlling phy reset */</span><span class="cp"></span>
<span class="cp">#define GPPR_UARTB_MODESEL_PIN	6	</span><span class="cm">/* GIO pin controlling uart b mode select */</span><span class="cp"></span>
<span class="cp">#define GPPR_UARTA_MODESEL_PIN	7	</span><span class="cm">/* GIO pin controlling uart a mode select */</span><span class="cp"></span>

<span class="cp">#define EMCR_DUPLEX		0x00000001</span>
<span class="cp">#define EMCR_PROMISC		0x00000002</span>
<span class="cp">#define EMCR_PADEN		0x00000004</span>
<span class="cp">#define EMCR_RXOFF_MASK		0x000001f8</span>
<span class="cp">#define EMCR_RXOFF_SHIFT	3</span>
<span class="cp">#define EMCR_RAMPAR		0x00000200</span>
<span class="cp">#define EMCR_BADPAR		0x00000800</span>
<span class="cp">#define EMCR_BUFSIZ		0x00001000</span>
<span class="cp">#define EMCR_TXDMAEN		0x00002000</span>
<span class="cp">#define EMCR_TXEN		0x00004000</span>
<span class="cp">#define EMCR_RXDMAEN		0x00008000</span>
<span class="cp">#define EMCR_RXEN		0x00010000</span>
<span class="cp">#define EMCR_LOOPBACK		0x00020000</span>
<span class="cp">#define EMCR_ARB_DIAG		0x001c0000</span>
<span class="cp">#define EMCR_ARB_DIAG_IDLE	0x00200000</span>
<span class="cp">#define EMCR_RST		0x80000000</span>

<span class="cp">#define EISR_RXTIMERINT		0x00000001</span>
<span class="cp">#define EISR_RXTHRESHINT	0x00000002</span>
<span class="cp">#define EISR_RXOFLO		0x00000004</span>
<span class="cp">#define EISR_RXBUFOFLO		0x00000008</span>
<span class="cp">#define EISR_RXMEMERR		0x00000010</span>
<span class="cp">#define EISR_RXPARERR		0x00000020</span>
<span class="cp">#define EISR_TXEMPTY		0x00010000</span>
<span class="cp">#define EISR_TXRTRY		0x00020000</span>
<span class="cp">#define EISR_TXEXDEF		0x00040000</span>
<span class="cp">#define EISR_TXLCOL		0x00080000</span>
<span class="cp">#define EISR_TXGIANT		0x00100000</span>
<span class="cp">#define EISR_TXBUFUFLO		0x00200000</span>
<span class="cp">#define EISR_TXEXPLICIT		0x00400000</span>
<span class="cp">#define EISR_TXCOLLWRAP		0x00800000</span>
<span class="cp">#define EISR_TXDEFERWRAP	0x01000000</span>
<span class="cp">#define EISR_TXMEMERR		0x02000000</span>
<span class="cp">#define EISR_TXPARERR		0x04000000</span>

<span class="cp">#define ERCSR_THRESH_MASK	0x000001ff	</span><span class="cm">/* enet RX threshold */</span><span class="cp"></span>
<span class="cp">#define ERCSR_RX_TMR		0x40000000	</span><span class="cm">/* simulation only */</span><span class="cp"></span>
<span class="cp">#define ERCSR_DIAG_OFLO		0x80000000	</span><span class="cm">/* simulation only */</span><span class="cp"></span>

<span class="cp">#define ERBR_ALIGNMENT		4096</span>
<span class="cp">#define ERBR_L_RXRINGBASE_MASK	0xfffff000</span>

<span class="cp">#define ERBAR_BARRIER_BIT	0x0100</span>
<span class="cp">#define ERBAR_RXBARR_MASK	0xffff0000</span>
<span class="cp">#define ERBAR_RXBARR_SHIFT	16</span>

<span class="cp">#define ERCIR_RXCONSUME_MASK	0x00000fff</span>

<span class="cp">#define ERPIR_RXPRODUCE_MASK	0x00000fff</span>
<span class="cp">#define ERPIR_ARM		0x80000000</span>

<span class="cp">#define ERTR_CNT_MASK		0x000007ff</span>

<span class="cp">#define ETCSR_IPGT_MASK		0x0000007f</span>
<span class="cp">#define ETCSR_IPGR1_MASK	0x00007f00</span>
<span class="cp">#define ETCSR_IPGR1_SHIFT	8</span>
<span class="cp">#define ETCSR_IPGR2_MASK	0x007f0000</span>
<span class="cp">#define ETCSR_IPGR2_SHIFT	16</span>
<span class="cp">#define ETCSR_NOTXCLK		0x80000000</span>

<span class="cp">#define ETCDC_COLLCNT_MASK	0x0000ffff</span>
<span class="cp">#define ETCDC_DEFERCNT_MASK	0xffff0000</span>
<span class="cp">#define ETCDC_DEFERCNT_SHIFT	16</span>

<span class="cp">#define ETBR_ALIGNMENT		(64*1024)</span>
<span class="cp">#define ETBR_L_RINGSZ_MASK	0x00000001</span>
<span class="cp">#define ETBR_L_RINGSZ128	0</span>
<span class="cp">#define ETBR_L_RINGSZ512	1</span>
<span class="cp">#define ETBR_L_TXRINGBASE_MASK	0xffffc000</span>

<span class="cp">#define ETCIR_TXCONSUME_MASK	0x0000ffff</span>
<span class="cp">#define ETCIR_IDLE		0x80000000</span>

<span class="cp">#define ETPIR_TXPRODUCE_MASK	0x0000ffff</span>

<span class="cp">#define EBIR_TXBUFPROD_MASK	0x0000001f</span>
<span class="cp">#define EBIR_TXBUFCONS_MASK	0x00001f00</span>
<span class="cp">#define EBIR_TXBUFCONS_SHIFT	8</span>
<span class="cp">#define EBIR_RXBUFPROD_MASK	0x007fc000</span>
<span class="cp">#define EBIR_RXBUFPROD_SHIFT	14</span>
<span class="cp">#define EBIR_RXBUFCONS_MASK	0xff800000</span>
<span class="cp">#define EBIR_RXBUFCONS_SHIFT	23</span>

<span class="cp">#define MICR_REGADDR_MASK	0x0000001f</span>
<span class="cp">#define MICR_PHYADDR_MASK	0x000003e0</span>
<span class="cp">#define MICR_PHYADDR_SHIFT	5</span>
<span class="cp">#define MICR_READTRIG		0x00000400</span>
<span class="cp">#define MICR_BUSY		0x00000800</span>

<span class="cp">#define MIDR_DATA_MASK		0x0000ffff</span>

<span class="cp">#define ERXBUF_IPCKSUM_MASK	0x0000ffff</span>
<span class="cp">#define ERXBUF_BYTECNT_MASK	0x07ff0000</span>
<span class="cp">#define ERXBUF_BYTECNT_SHIFT	16</span>
<span class="cp">#define ERXBUF_V		0x80000000</span>

<span class="cp">#define ERXBUF_CRCERR		0x00000001	</span><span class="cm">/* aka RSV15 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_FRAMERR		0x00000002	</span><span class="cm">/* aka RSV14 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_CODERR		0x00000004	</span><span class="cm">/* aka RSV13 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_INVPREAMB	0x00000008	</span><span class="cm">/* aka RSV18 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_LOLEN		0x00007000	</span><span class="cm">/* aka RSV2_0 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_HILEN		0x03ff0000	</span><span class="cm">/* aka RSV12_3 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_MULTICAST	0x04000000	</span><span class="cm">/* aka RSV16 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_BROADCAST	0x08000000	</span><span class="cm">/* aka RSV17 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_LONGEVENT	0x10000000	</span><span class="cm">/* aka RSV19 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_BADPKT		0x20000000	</span><span class="cm">/* aka RSV20 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_GOODPKT		0x40000000	</span><span class="cm">/* aka RSV21 */</span><span class="cp"></span>
<span class="cp">#define ERXBUF_CARRIER		0x80000000	</span><span class="cm">/* aka RSV22 */</span><span class="cp"></span>

<span class="cp">#define ETXD_BYTECNT_MASK	0x000007ff	</span><span class="cm">/* total byte count */</span><span class="cp"></span>
<span class="cp">#define ETXD_INTWHENDONE	0x00001000	</span><span class="cm">/* intr when done */</span><span class="cp"></span>
<span class="cp">#define ETXD_D0V		0x00010000	</span><span class="cm">/* data 0 valid */</span><span class="cp"></span>
<span class="cp">#define ETXD_B1V		0x00020000	</span><span class="cm">/* buf 1 valid */</span><span class="cp"></span>
<span class="cp">#define ETXD_B2V		0x00040000	</span><span class="cm">/* buf 2 valid */</span><span class="cp"></span>
<span class="cp">#define ETXD_DOCHECKSUM		0x00080000	</span><span class="cm">/* insert ip cksum */</span><span class="cp"></span>
<span class="cp">#define ETXD_CHKOFF_MASK	0x07f00000	</span><span class="cm">/* cksum byte offset */</span><span class="cp"></span>
<span class="cp">#define ETXD_CHKOFF_SHIFT	20</span>

<span class="cp">#define ETXD_D0CNT_MASK		0x0000007f</span>
<span class="cp">#define ETXD_B1CNT_MASK		0x0007ff00</span>
<span class="cp">#define ETXD_B1CNT_SHIFT	8</span>
<span class="cp">#define ETXD_B2CNT_MASK		0x7ff00000</span>
<span class="cp">#define ETXD_B2CNT_SHIFT	20</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="n">ioc3_subdevs_e</span> <span class="p">{</span>
    <span class="n">ioc3_subdev_ether</span><span class="p">,</span>
    <span class="n">ioc3_subdev_generic</span><span class="p">,</span>
    <span class="n">ioc3_subdev_nic</span><span class="p">,</span>
    <span class="n">ioc3_subdev_kbms</span><span class="p">,</span>
    <span class="n">ioc3_subdev_ttya</span><span class="p">,</span>
    <span class="n">ioc3_subdev_ttyb</span><span class="p">,</span>
    <span class="n">ioc3_subdev_ecpp</span><span class="p">,</span>
    <span class="n">ioc3_subdev_rt</span><span class="p">,</span>
    <span class="n">ioc3_nsubdevs</span>
<span class="p">}</span> <span class="n">ioc3_subdev_t</span><span class="p">;</span>

<span class="cm">/* subdevice disable bits,</span>
<span class="cm"> * from the standard INFO_LBL_SUBDEVS</span>
<span class="cm"> */</span>
<span class="cp">#define IOC3_SDB_ETHER		(1&lt;&lt;ioc3_subdev_ether)</span>
<span class="cp">#define IOC3_SDB_GENERIC	(1&lt;&lt;ioc3_subdev_generic)</span>
<span class="cp">#define IOC3_SDB_NIC		(1&lt;&lt;ioc3_subdev_nic)</span>
<span class="cp">#define IOC3_SDB_KBMS		(1&lt;&lt;ioc3_subdev_kbms)</span>
<span class="cp">#define IOC3_SDB_TTYA		(1&lt;&lt;ioc3_subdev_ttya)</span>
<span class="cp">#define IOC3_SDB_TTYB		(1&lt;&lt;ioc3_subdev_ttyb)</span>
<span class="cp">#define IOC3_SDB_ECPP		(1&lt;&lt;ioc3_subdev_ecpp)</span>
<span class="cp">#define IOC3_SDB_RT		(1&lt;&lt;ioc3_subdev_rt)</span>

<span class="cp">#define IOC3_ALL_SUBDEVS	((1&lt;&lt;ioc3_nsubdevs)-1)</span>

<span class="cp">#define IOC3_SDB_SERIAL		(IOC3_SDB_TTYA|IOC3_SDB_TTYB)</span>

<span class="cp">#define IOC3_STD_SUBDEVS	IOC3_ALL_SUBDEVS</span>

<span class="cp">#define IOC3_INTA_SUBDEVS	IOC3_SDB_ETHER</span>
<span class="cp">#define IOC3_INTB_SUBDEVS	(IOC3_SDB_GENERIC|IOC3_SDB_KBMS|IOC3_SDB_SERIAL|IOC3_SDB_ECPP|IOC3_SDB_RT)</span>

<span class="cp">#endif </span><span class="cm">/* _IOC3_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
