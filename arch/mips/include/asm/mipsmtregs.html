<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › mipsmtregs.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>mipsmtregs.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * MT regs definitions, follows on from mipsregs.h</span>
<span class="cm"> * Copyright (C) 2004 - 2005 MIPS Technologies, Inc.  All rights reserved.</span>
<span class="cm"> * Elizabeth Clarke et. al.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _ASM_MIPSMTREGS_H</span>
<span class="cp">#define _ASM_MIPSMTREGS_H</span>

<span class="cp">#include &lt;asm/mipsregs.h&gt;</span>
<span class="cp">#include &lt;asm/war.h&gt;</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="cm">/*</span>
<span class="cm"> * C macros</span>
<span class="cm"> */</span>

<span class="cp">#define read_c0_mvpcontrol()		__read_32bit_c0_register($0, 1)</span>
<span class="cp">#define write_c0_mvpcontrol(val)	__write_32bit_c0_register($0, 1, val)</span>

<span class="cp">#define read_c0_mvpconf0()		__read_32bit_c0_register($0, 2)</span>
<span class="cp">#define read_c0_mvpconf1()		__read_32bit_c0_register($0, 3)</span>

<span class="cp">#define read_c0_vpecontrol()		__read_32bit_c0_register($1, 1)</span>
<span class="cp">#define write_c0_vpecontrol(val)	__write_32bit_c0_register($1, 1, val)</span>

<span class="cp">#define read_c0_vpeconf0()		__read_32bit_c0_register($1, 2)</span>
<span class="cp">#define write_c0_vpeconf0(val)		__write_32bit_c0_register($1, 2, val)</span>

<span class="cp">#define read_c0_tcstatus()		__read_32bit_c0_register($2, 1)</span>
<span class="cp">#define write_c0_tcstatus(val)		__write_32bit_c0_register($2, 1, val)</span>

<span class="cp">#define read_c0_tcbind()		__read_32bit_c0_register($2, 2)</span>

<span class="cp">#define read_c0_tccontext()		__read_32bit_c0_register($2, 5)</span>
<span class="cp">#define write_c0_tccontext(val)		__write_32bit_c0_register($2, 5, val)</span>

<span class="cp">#else </span><span class="cm">/* Assembly */</span><span class="cp"></span>
<span class="cm">/*</span>
<span class="cm"> * Macros for use in assembly language code</span>
<span class="cm"> */</span>

<span class="cp">#define CP0_MVPCONTROL		$0, 1</span>
<span class="cp">#define CP0_MVPCONF0		$0, 2</span>
<span class="cp">#define CP0_MVPCONF1		$0, 3</span>
<span class="cp">#define CP0_VPECONTROL		$1, 1</span>
<span class="cp">#define CP0_VPECONF0		$1, 2</span>
<span class="cp">#define CP0_VPECONF1		$1, 3</span>
<span class="cp">#define CP0_YQMASK		$1, 4</span>
<span class="cp">#define CP0_VPESCHEDULE	$1, 5</span>
<span class="cp">#define CP0_VPESCHEFBK		$1, 6</span>
<span class="cp">#define CP0_TCSTATUS		$2, 1</span>
<span class="cp">#define CP0_TCBIND		$2, 2</span>
<span class="cp">#define CP0_TCRESTART		$2, 3</span>
<span class="cp">#define CP0_TCHALT		$2, 4</span>
<span class="cp">#define CP0_TCCONTEXT		$2, 5</span>
<span class="cp">#define CP0_TCSCHEDULE		$2, 6</span>
<span class="cp">#define CP0_TCSCHEFBK		$2, 7</span>
<span class="cp">#define CP0_SRSCONF0		$6, 1</span>
<span class="cp">#define CP0_SRSCONF1		$6, 2</span>
<span class="cp">#define CP0_SRSCONF2		$6, 3</span>
<span class="cp">#define CP0_SRSCONF3		$6, 4</span>
<span class="cp">#define CP0_SRSCONF4		$6, 5</span>

<span class="cp">#endif</span>

<span class="cm">/* MVPControl fields */</span>
<span class="cp">#define MVPCONTROL_EVP		(_ULCAST_(1))</span>

<span class="cp">#define MVPCONTROL_VPC_SHIFT	1</span>
<span class="cp">#define MVPCONTROL_VPC		(_ULCAST_(1) &lt;&lt; MVPCONTROL_VPC_SHIFT)</span>

<span class="cp">#define MVPCONTROL_STLB_SHIFT	2</span>
<span class="cp">#define MVPCONTROL_STLB		(_ULCAST_(1) &lt;&lt; MVPCONTROL_STLB_SHIFT)</span>


<span class="cm">/* MVPConf0 fields */</span>
<span class="cp">#define MVPCONF0_PTC_SHIFT	0</span>
<span class="cp">#define MVPCONF0_PTC		( _ULCAST_(0xff))</span>
<span class="cp">#define MVPCONF0_PVPE_SHIFT	10</span>
<span class="cp">#define MVPCONF0_PVPE		( _ULCAST_(0xf) &lt;&lt; MVPCONF0_PVPE_SHIFT)</span>
<span class="cp">#define MVPCONF0_TCA_SHIFT	15</span>
<span class="cp">#define MVPCONF0_TCA		( _ULCAST_(1) &lt;&lt; MVPCONF0_TCA_SHIFT)</span>
<span class="cp">#define MVPCONF0_PTLBE_SHIFT	16</span>
<span class="cp">#define MVPCONF0_PTLBE		(_ULCAST_(0x3ff) &lt;&lt; MVPCONF0_PTLBE_SHIFT)</span>
<span class="cp">#define MVPCONF0_TLBS_SHIFT	29</span>
<span class="cp">#define MVPCONF0_TLBS		(_ULCAST_(1) &lt;&lt; MVPCONF0_TLBS_SHIFT)</span>
<span class="cp">#define MVPCONF0_M_SHIFT	31</span>
<span class="cp">#define MVPCONF0_M		(_ULCAST_(0x1) &lt;&lt; MVPCONF0_M_SHIFT)</span>


<span class="cm">/* config3 fields */</span>
<span class="cp">#define CONFIG3_MT_SHIFT	2</span>
<span class="cp">#define CONFIG3_MT		(_ULCAST_(1) &lt;&lt; CONFIG3_MT_SHIFT)</span>


<span class="cm">/* VPEControl fields (per VPE) */</span>
<span class="cp">#define VPECONTROL_TARGTC	(_ULCAST_(0xff))</span>

<span class="cp">#define VPECONTROL_TE_SHIFT	15</span>
<span class="cp">#define VPECONTROL_TE		(_ULCAST_(1) &lt;&lt; VPECONTROL_TE_SHIFT)</span>
<span class="cp">#define VPECONTROL_EXCPT_SHIFT	16</span>
<span class="cp">#define VPECONTROL_EXCPT	(_ULCAST_(0x7) &lt;&lt; VPECONTROL_EXCPT_SHIFT)</span>

<span class="cm">/* Thread Exception Codes for EXCPT field */</span>
<span class="cp">#define THREX_TU		0</span>
<span class="cp">#define THREX_TO		1</span>
<span class="cp">#define THREX_IYQ		2</span>
<span class="cp">#define THREX_GSX		3</span>
<span class="cp">#define THREX_YSCH		4</span>
<span class="cp">#define THREX_GSSCH		5</span>

<span class="cp">#define VPECONTROL_GSI_SHIFT	20</span>
<span class="cp">#define VPECONTROL_GSI		(_ULCAST_(1) &lt;&lt; VPECONTROL_GSI_SHIFT)</span>
<span class="cp">#define VPECONTROL_YSI_SHIFT	21</span>
<span class="cp">#define VPECONTROL_YSI		(_ULCAST_(1) &lt;&lt; VPECONTROL_YSI_SHIFT)</span>

<span class="cm">/* VPEConf0 fields (per VPE) */</span>
<span class="cp">#define VPECONF0_VPA_SHIFT	0</span>
<span class="cp">#define VPECONF0_VPA		(_ULCAST_(1) &lt;&lt; VPECONF0_VPA_SHIFT)</span>
<span class="cp">#define VPECONF0_MVP_SHIFT	1</span>
<span class="cp">#define VPECONF0_MVP		(_ULCAST_(1) &lt;&lt; VPECONF0_MVP_SHIFT)</span>
<span class="cp">#define VPECONF0_XTC_SHIFT	21</span>
<span class="cp">#define VPECONF0_XTC		(_ULCAST_(0xff) &lt;&lt; VPECONF0_XTC_SHIFT)</span>

<span class="cm">/* TCStatus fields (per TC) */</span>
<span class="cp">#define TCSTATUS_TASID		(_ULCAST_(0xff))</span>
<span class="cp">#define TCSTATUS_IXMT_SHIFT	10</span>
<span class="cp">#define TCSTATUS_IXMT		(_ULCAST_(1) &lt;&lt; TCSTATUS_IXMT_SHIFT)</span>
<span class="cp">#define TCSTATUS_TKSU_SHIFT	11</span>
<span class="cp">#define TCSTATUS_TKSU		(_ULCAST_(3) &lt;&lt; TCSTATUS_TKSU_SHIFT)</span>
<span class="cp">#define TCSTATUS_A_SHIFT	13</span>
<span class="cp">#define TCSTATUS_A		(_ULCAST_(1) &lt;&lt; TCSTATUS_A_SHIFT)</span>
<span class="cp">#define TCSTATUS_DA_SHIFT	15</span>
<span class="cp">#define TCSTATUS_DA		(_ULCAST_(1) &lt;&lt; TCSTATUS_DA_SHIFT)</span>
<span class="cp">#define TCSTATUS_DT_SHIFT	20</span>
<span class="cp">#define TCSTATUS_DT		(_ULCAST_(1) &lt;&lt; TCSTATUS_DT_SHIFT)</span>
<span class="cp">#define TCSTATUS_TDS_SHIFT	21</span>
<span class="cp">#define TCSTATUS_TDS		(_ULCAST_(1) &lt;&lt; TCSTATUS_TDS_SHIFT)</span>
<span class="cp">#define TCSTATUS_TSST_SHIFT	22</span>
<span class="cp">#define TCSTATUS_TSST		(_ULCAST_(1) &lt;&lt; TCSTATUS_TSST_SHIFT)</span>
<span class="cp">#define TCSTATUS_RNST_SHIFT	23</span>
<span class="cp">#define TCSTATUS_RNST		(_ULCAST_(3) &lt;&lt; TCSTATUS_RNST_SHIFT)</span>
<span class="cm">/* Codes for RNST */</span>
<span class="cp">#define TC_RUNNING		0</span>
<span class="cp">#define TC_WAITING		1</span>
<span class="cp">#define TC_YIELDING		2</span>
<span class="cp">#define TC_GATED		3</span>

<span class="cp">#define TCSTATUS_TMX_SHIFT	27</span>
<span class="cp">#define TCSTATUS_TMX		(_ULCAST_(1) &lt;&lt; TCSTATUS_TMX_SHIFT)</span>
<span class="cm">/* TCStatus TCU bits can use same definitions/offsets as CU bits in Status */</span>

<span class="cm">/* TCBind */</span>
<span class="cp">#define TCBIND_CURVPE_SHIFT	0</span>
<span class="cp">#define TCBIND_CURVPE		(_ULCAST_(0xf))</span>

<span class="cp">#define TCBIND_CURTC_SHIFT	21</span>

<span class="cp">#define TCBIND_CURTC		(_ULCAST_(0xff) &lt;&lt; TCBIND_CURTC_SHIFT)</span>

<span class="cm">/* TCHalt */</span>
<span class="cp">#define TCHALT_H		(_ULCAST_(1))</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">dvpe</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span>
	<span class="s">&quot;	.set	push						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	noreorder					</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	noat						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	mips32r2					</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.word	0x41610001		# dvpe $1		</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	move	%0, $1						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	ehb							</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	pop						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="o">:</span> <span class="s">&quot;=r&quot;</span> <span class="p">(</span><span class="n">res</span><span class="p">));</span>

	<span class="n">instruction_hazard</span><span class="p">();</span>

	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__raw_evpe</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span>
	<span class="s">&quot;	.set	push						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	noreorder					</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	noat						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	mips32r2					</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.word	0x41600021		# evpe			</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	ehb							</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	pop						</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Enable virtual processor execution if previous suggested it should be.</span>
<span class="cm">   EVPE_ENABLE to force */</span>

<span class="cp">#define EVPE_ENABLE MVPCONTROL_EVP</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">evpe</span><span class="p">(</span><span class="kt">int</span> <span class="n">previous</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">previous</span> <span class="o">&amp;</span> <span class="n">MVPCONTROL_EVP</span><span class="p">))</span>
		<span class="n">__raw_evpe</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">dmt</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">res</span><span class="p">;</span>

	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span>
	<span class="s">&quot;	.set	push						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	mips32r2					</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	noat						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.word	0x41610BC1			# dmt $1	</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	ehb							</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	move	%0, $1						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	pop						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="o">:</span> <span class="s">&quot;=r&quot;</span> <span class="p">(</span><span class="n">res</span><span class="p">));</span>

	<span class="n">instruction_hazard</span><span class="p">();</span>

	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">__raw_emt</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span>
	<span class="s">&quot;	.set	noreorder					</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	mips32r2					</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.word	0x41600be1			# emt		</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	ehb							</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	mips0						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	reorder&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* enable multi-threaded execution if previous suggested it should be.</span>
<span class="cm">   EMT_ENABLE to force */</span>

<span class="cp">#define EMT_ENABLE VPECONTROL_TE</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">emt</span><span class="p">(</span><span class="kt">int</span> <span class="n">previous</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">previous</span> <span class="o">&amp;</span> <span class="n">EMT_ENABLE</span><span class="p">))</span>
		<span class="n">__raw_emt</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ehb</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span>
	<span class="s">&quot;	.set	mips32r2				</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	ehb						</span><span class="se">\n</span><span class="s">&quot;</span>
	<span class="s">&quot;	.set	mips0					</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#define mftc0(rt,sel)							\</span>
<span class="cp">({									\</span>
<span class="cp">	 unsigned long  __res;						\</span>
<span class="cp">									\</span>
<span class="cp">	__asm__ __volatile__(						\</span>
<span class="cp">	&quot;	.set	push					\n&quot;	\</span>
<span class="cp">	&quot;	.set	mips32r2				\n&quot;	\</span>
<span class="cp">	&quot;	.set	noat					\n&quot;	\</span>
<span class="cp">	&quot;	# mftc0	$1, $&quot; #rt &quot;, &quot; #sel &quot;			\n&quot;	\</span>
<span class="cp">	&quot;	.word	0x41000800 | (&quot; #rt &quot; &lt;&lt; 16) | &quot; #sel &quot;	\n&quot;	\</span>
<span class="cp">	&quot;	move	%0, $1					\n&quot;	\</span>
<span class="cp">	&quot;	.set	pop					\n&quot;	\</span>
<span class="cp">	: &quot;=r&quot; (__res));						\</span>
<span class="cp">									\</span>
<span class="cp">	__res;								\</span>
<span class="cp">})</span>

<span class="cp">#define mftgpr(rt)							\</span>
<span class="cp">({									\</span>
<span class="cp">	unsigned long __res;						\</span>
<span class="cp">									\</span>
<span class="cp">	__asm__ __volatile__(						\</span>
<span class="cp">	&quot;	.set	push					\n&quot;	\</span>
<span class="cp">	&quot;	.set	noat					\n&quot;	\</span>
<span class="cp">	&quot;	.set	mips32r2				\n&quot;	\</span>
<span class="cp">	&quot;	# mftgpr $1,&quot; #rt &quot;				\n&quot;	\</span>
<span class="cp">	&quot;	.word	0x41000820 | (&quot; #rt &quot; &lt;&lt; 16)		\n&quot;	\</span>
<span class="cp">	&quot;	move	%0, $1					\n&quot;	\</span>
<span class="cp">	&quot;	.set	pop					\n&quot;	\</span>
<span class="cp">	: &quot;=r&quot; (__res));						\</span>
<span class="cp">									\</span>
<span class="cp">	__res;								\</span>
<span class="cp">})</span>

<span class="cp">#define mftr(rt, u, sel)							\</span>
<span class="cp">({									\</span>
<span class="cp">	unsigned long __res;						\</span>
<span class="cp">									\</span>
<span class="cp">	__asm__ __volatile__(						\</span>
<span class="cp">	&quot;	mftr	%0, &quot; #rt &quot;, &quot; #u &quot;, &quot; #sel &quot;		\n&quot;	\</span>
<span class="cp">	: &quot;=r&quot; (__res));						\</span>
<span class="cp">									\</span>
<span class="cp">	__res;								\</span>
<span class="cp">})</span>

<span class="cp">#define mttgpr(rd,v)							\</span>
<span class="cp">do {									\</span>
<span class="cp">	__asm__ __volatile__(						\</span>
<span class="cp">	&quot;	.set	push					\n&quot;	\</span>
<span class="cp">	&quot;	.set	mips32r2				\n&quot;	\</span>
<span class="cp">	&quot;	.set	noat					\n&quot;	\</span>
<span class="cp">	&quot;	move	$1, %0					\n&quot;	\</span>
<span class="cp">	&quot;	# mttgpr $1, &quot; #rd &quot;				\n&quot;	\</span>
<span class="cp">	&quot;	.word	0x41810020 | (&quot; #rd &quot; &lt;&lt; 11)		\n&quot;	\</span>
<span class="cp">	&quot;	.set	pop					\n&quot;	\</span>
<span class="cp">	: : &quot;r&quot; (v));							\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define mttc0(rd, sel, v)							\</span>
<span class="cp">({									\</span>
<span class="cp">	__asm__ __volatile__(						\</span>
<span class="cp">	&quot;	.set	push					\n&quot;	\</span>
<span class="cp">	&quot;	.set	mips32r2				\n&quot;	\</span>
<span class="cp">	&quot;	.set	noat					\n&quot;	\</span>
<span class="cp">	&quot;	move	$1, %0					\n&quot;	\</span>
<span class="cp">	&quot;	# mttc0 %0,&quot; #rd &quot;, &quot; #sel &quot;			\n&quot;	\</span>
<span class="cp">	&quot;	.word	0x41810000 | (&quot; #rd &quot; &lt;&lt; 11) | &quot; #sel &quot;	\n&quot;	\</span>
<span class="cp">	&quot;	.set	pop					\n&quot;	\</span>
<span class="cp">	:								\</span>
<span class="cp">	: &quot;r&quot; (v));							\</span>
<span class="cp">})</span>


<span class="cp">#define mttr(rd, u, sel, v)						\</span>
<span class="cp">({									\</span>
<span class="cp">	__asm__ __volatile__(						\</span>
<span class="cp">	&quot;mttr	%0,&quot; #rd &quot;, &quot; #u &quot;, &quot; #sel				\</span>
<span class="cp">	: : &quot;r&quot; (v));							\</span>
<span class="cp">})</span>


<span class="cp">#define settc(tc)							\</span>
<span class="cp">do {									\</span>
<span class="cp">	write_c0_vpecontrol((read_c0_vpecontrol()&amp;~VPECONTROL_TARGTC) | (tc)); \</span>
<span class="cp">	ehb();								\</span>
<span class="cp">} while (0)</span>


<span class="cm">/* you *must* set the target tc (settc) before trying to use these */</span>
<span class="cp">#define read_vpe_c0_vpecontrol()	mftc0(1, 1)</span>
<span class="cp">#define write_vpe_c0_vpecontrol(val)	mttc0(1, 1, val)</span>
<span class="cp">#define read_vpe_c0_vpeconf0()		mftc0(1, 2)</span>
<span class="cp">#define write_vpe_c0_vpeconf0(val)	mttc0(1, 2, val)</span>
<span class="cp">#define read_vpe_c0_count()		mftc0(9, 0)</span>
<span class="cp">#define write_vpe_c0_count(val)		mttc0(9, 0, val)</span>
<span class="cp">#define read_vpe_c0_status()		mftc0(12, 0)</span>
<span class="cp">#define write_vpe_c0_status(val)	mttc0(12, 0, val)</span>
<span class="cp">#define read_vpe_c0_cause()		mftc0(13, 0)</span>
<span class="cp">#define write_vpe_c0_cause(val)		mttc0(13, 0, val)</span>
<span class="cp">#define read_vpe_c0_config()		mftc0(16, 0)</span>
<span class="cp">#define write_vpe_c0_config(val)	mttc0(16, 0, val)</span>
<span class="cp">#define read_vpe_c0_config1()		mftc0(16, 1)</span>
<span class="cp">#define write_vpe_c0_config1(val)	mttc0(16, 1, val)</span>
<span class="cp">#define read_vpe_c0_config7()		mftc0(16, 7)</span>
<span class="cp">#define write_vpe_c0_config7(val)	mttc0(16, 7, val)</span>
<span class="cp">#define read_vpe_c0_ebase()		mftc0(15, 1)</span>
<span class="cp">#define write_vpe_c0_ebase(val)		mttc0(15, 1, val)</span>
<span class="cp">#define write_vpe_c0_compare(val)	mttc0(11, 0, val)</span>
<span class="cp">#define read_vpe_c0_badvaddr()		mftc0(8, 0)</span>
<span class="cp">#define read_vpe_c0_epc()		mftc0(14, 0)</span>
<span class="cp">#define write_vpe_c0_epc(val)		mttc0(14, 0, val)</span>


<span class="cm">/* TC */</span>
<span class="cp">#define read_tc_c0_tcstatus()		mftc0(2, 1)</span>
<span class="cp">#define write_tc_c0_tcstatus(val)	mttc0(2, 1, val)</span>
<span class="cp">#define read_tc_c0_tcbind()		mftc0(2, 2)</span>
<span class="cp">#define write_tc_c0_tcbind(val)		mttc0(2, 2, val)</span>
<span class="cp">#define read_tc_c0_tcrestart()		mftc0(2, 3)</span>
<span class="cp">#define write_tc_c0_tcrestart(val)	mttc0(2, 3, val)</span>
<span class="cp">#define read_tc_c0_tchalt()		mftc0(2, 4)</span>
<span class="cp">#define write_tc_c0_tchalt(val)		mttc0(2, 4, val)</span>
<span class="cp">#define read_tc_c0_tccontext()		mftc0(2, 5)</span>
<span class="cp">#define write_tc_c0_tccontext(val)	mttc0(2, 5, val)</span>

<span class="cm">/* GPR */</span>
<span class="cp">#define read_tc_gpr_sp()		mftgpr(29)</span>
<span class="cp">#define write_tc_gpr_sp(val)		mttgpr(29, val)</span>
<span class="cp">#define read_tc_gpr_gp()		mftgpr(28)</span>
<span class="cp">#define write_tc_gpr_gp(val)		mttgpr(28, val)</span>

<span class="n">__BUILD_SET_C0</span><span class="p">(</span><span class="n">mvpcontrol</span><span class="p">)</span>

<span class="cp">#endif </span><span class="cm">/* Not __ASSEMBLY__ */</span><span class="cp"></span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
