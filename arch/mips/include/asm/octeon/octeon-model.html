<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › octeon › octeon-model.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>octeon-model.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/***********************license start***************</span>
<span class="cm"> * Author: Cavium Networks</span>
<span class="cm"> *</span>
<span class="cm"> * Contact: support@caviumnetworks.com</span>
<span class="cm"> * This file is part of the OCTEON SDK</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2003-2010 Cavium Networks</span>
<span class="cm"> *</span>
<span class="cm"> * This file is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License, Version 2, as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This file is distributed in the hope that it will be useful, but</span>
<span class="cm"> * AS-IS and WITHOUT ANY WARRANTY; without even the implied warranty</span>
<span class="cm"> * of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE, TITLE, or</span>
<span class="cm"> * NONINFRINGEMENT.  See the GNU General Public License for more</span>
<span class="cm"> * details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this file; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA</span>
<span class="cm"> * or visit http://www.gnu.org/licenses/.</span>
<span class="cm"> *</span>
<span class="cm"> * This file may also be available under a different license from Cavium.</span>
<span class="cm"> * Contact Cavium Networks for more information</span>
<span class="cm"> ***********************license end**************************************/</span>
<span class="cp">#ifndef __OCTEON_MODEL_H__</span>
<span class="cp">#define __OCTEON_MODEL_H__</span>

<span class="cm">/*</span>
<span class="cm"> * The defines below should be used with the OCTEON_IS_MODEL() macro</span>
<span class="cm"> * to determine what model of chip the software is running on.  Models</span>
<span class="cm"> * ending in &#39;XX&#39; match multiple models (families), while specific</span>
<span class="cm"> * models match only that model.  If a pass (revision) is specified,</span>
<span class="cm"> * then only that revision will be matched.  Care should be taken when</span>
<span class="cm"> * checking for both specific models and families that the specific</span>
<span class="cm"> * models are checked for first.  While these defines are similar to</span>
<span class="cm"> * the processor ID, they are not intended to be used by anything</span>
<span class="cm"> * other that the OCTEON_IS_MODEL framework, and the values are</span>
<span class="cm"> * subject to change at anytime without notice.</span>
<span class="cm"> *</span>
<span class="cm"> * NOTE: only the OCTEON_IS_MODEL() macro/function and the OCTEON_CN*</span>
<span class="cm"> * macros should be used outside of this file.  All other macros are</span>
<span class="cm"> * for internal use only, and may change without notice.</span>
<span class="cm"> */</span>

<span class="cp">#define OCTEON_FAMILY_MASK      0x00ffff00</span>

<span class="cm">/* Flag bits in top byte */</span>
<span class="cm">/* Ignores revision in model checks */</span>
<span class="cp">#define OM_IGNORE_REVISION        0x01000000</span>
<span class="cm">/* Check submodels */</span>
<span class="cp">#define OM_CHECK_SUBMODEL         0x02000000</span>
<span class="cm">/* Match all models previous than the one specified */</span>
<span class="cp">#define OM_MATCH_PREVIOUS_MODELS  0x04000000</span>
<span class="cm">/* Ignores the minor revison on newer parts */</span>
<span class="cp">#define OM_IGNORE_MINOR_REVISION  0x08000000</span>
<span class="cp">#define OM_FLAG_MASK              0xff000000</span>

<span class="cm">/* Match all cn5XXX Octeon models. */</span>
<span class="cp">#define OM_MATCH_5XXX_FAMILY_MODELS     0x20000000</span>
<span class="cm">/* Match all cn6XXX Octeon models. */</span>
<span class="cp">#define OM_MATCH_6XXX_FAMILY_MODELS     0x40000000</span>

<span class="cm">/*</span>
<span class="cm"> * CN6XXX models with new revision encoding</span>
<span class="cm"> */</span>
<span class="cp">#define OCTEON_CN68XX_PASS1_0   0x000d9100</span>
<span class="cp">#define OCTEON_CN68XX_PASS1_1   0x000d9101</span>
<span class="cp">#define OCTEON_CN68XX_PASS1_2   0x000d9102</span>
<span class="cp">#define OCTEON_CN68XX_PASS2_0   0x000d9108</span>

<span class="cp">#define OCTEON_CN68XX           (OCTEON_CN68XX_PASS2_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN68XX_PASS1_X   (OCTEON_CN68XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN68XX_PASS2_X   (OCTEON_CN68XX_PASS2_0 | OM_IGNORE_MINOR_REVISION)</span>

<span class="cp">#define OCTEON_CN68XX_PASS1	OCTEON_CN68XX_PASS1_X</span>
<span class="cp">#define OCTEON_CN68XX_PASS2	OCTEON_CN68XX_PASS2_X</span>

<span class="cp">#define OCTEON_CN66XX_PASS1_0   0x000d9200</span>
<span class="cp">#define OCTEON_CN66XX_PASS1_2   0x000d9202</span>

<span class="cp">#define OCTEON_CN66XX           (OCTEON_CN66XX_PASS1_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN66XX_PASS1_X   (OCTEON_CN66XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>

<span class="cp">#define OCTEON_CN63XX_PASS1_0   0x000d9000</span>
<span class="cp">#define OCTEON_CN63XX_PASS1_1   0x000d9001</span>
<span class="cp">#define OCTEON_CN63XX_PASS1_2   0x000d9002</span>
<span class="cp">#define OCTEON_CN63XX_PASS2_0   0x000d9008</span>
<span class="cp">#define OCTEON_CN63XX_PASS2_1   0x000d9009</span>
<span class="cp">#define OCTEON_CN63XX_PASS2_2   0x000d900a</span>

<span class="cp">#define OCTEON_CN63XX           (OCTEON_CN63XX_PASS2_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN63XX_PASS1_X   (OCTEON_CN63XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN63XX_PASS2_X   (OCTEON_CN63XX_PASS2_0 | OM_IGNORE_MINOR_REVISION)</span>

<span class="cp">#define OCTEON_CN61XX_PASS1_0   0x000d9300</span>

<span class="cp">#define OCTEON_CN61XX           (OCTEON_CN61XX_PASS1_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN61XX_PASS1_X   (OCTEON_CN61XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>

<span class="cm">/*</span>
<span class="cm"> * CN5XXX models with new revision encoding</span>
<span class="cm"> */</span>
<span class="cp">#define OCTEON_CN58XX_PASS1_0   0x000d0300</span>
<span class="cp">#define OCTEON_CN58XX_PASS1_1   0x000d0301</span>
<span class="cp">#define OCTEON_CN58XX_PASS1_2   0x000d0303</span>
<span class="cp">#define OCTEON_CN58XX_PASS2_0   0x000d0308</span>
<span class="cp">#define OCTEON_CN58XX_PASS2_1   0x000d0309</span>
<span class="cp">#define OCTEON_CN58XX_PASS2_2   0x000d030a</span>
<span class="cp">#define OCTEON_CN58XX_PASS2_3   0x000d030b</span>

<span class="cp">#define OCTEON_CN58XX           (OCTEON_CN58XX_PASS1_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN58XX_PASS1_X   (OCTEON_CN58XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN58XX_PASS2_X   (OCTEON_CN58XX_PASS2_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN58XX_PASS1     OCTEON_CN58XX_PASS1_X</span>
<span class="cp">#define OCTEON_CN58XX_PASS2     OCTEON_CN58XX_PASS2_X</span>

<span class="cp">#define OCTEON_CN56XX_PASS1_0   0x000d0400</span>
<span class="cp">#define OCTEON_CN56XX_PASS1_1   0x000d0401</span>
<span class="cp">#define OCTEON_CN56XX_PASS2_0   0x000d0408</span>
<span class="cp">#define OCTEON_CN56XX_PASS2_1   0x000d0409</span>

<span class="cp">#define OCTEON_CN56XX           (OCTEON_CN56XX_PASS2_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN56XX_PASS1_X   (OCTEON_CN56XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN56XX_PASS2_X   (OCTEON_CN56XX_PASS2_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN56XX_PASS1     OCTEON_CN56XX_PASS1_X</span>
<span class="cp">#define OCTEON_CN56XX_PASS2     OCTEON_CN56XX_PASS2_X</span>

<span class="cp">#define OCTEON_CN57XX           OCTEON_CN56XX</span>
<span class="cp">#define OCTEON_CN57XX_PASS1     OCTEON_CN56XX_PASS1</span>
<span class="cp">#define OCTEON_CN57XX_PASS2     OCTEON_CN56XX_PASS2</span>

<span class="cp">#define OCTEON_CN55XX           OCTEON_CN56XX</span>
<span class="cp">#define OCTEON_CN55XX_PASS1     OCTEON_CN56XX_PASS1</span>
<span class="cp">#define OCTEON_CN55XX_PASS2     OCTEON_CN56XX_PASS2</span>

<span class="cp">#define OCTEON_CN54XX           OCTEON_CN56XX</span>
<span class="cp">#define OCTEON_CN54XX_PASS1     OCTEON_CN56XX_PASS1</span>
<span class="cp">#define OCTEON_CN54XX_PASS2     OCTEON_CN56XX_PASS2</span>

<span class="cp">#define OCTEON_CN50XX_PASS1_0   0x000d0600</span>

<span class="cp">#define OCTEON_CN50XX           (OCTEON_CN50XX_PASS1_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN50XX_PASS1_X   (OCTEON_CN50XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN50XX_PASS1     OCTEON_CN50XX_PASS1_X</span>

<span class="cm">/*</span>
<span class="cm"> * NOTE: Octeon CN5000F model is not identifiable using the</span>
<span class="cm"> * OCTEON_IS_MODEL() functions, but are treated as CN50XX.</span>
<span class="cm"> */</span>

<span class="cp">#define OCTEON_CN52XX_PASS1_0   0x000d0700</span>
<span class="cp">#define OCTEON_CN52XX_PASS2_0   0x000d0708</span>

<span class="cp">#define OCTEON_CN52XX           (OCTEON_CN52XX_PASS2_0 | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN52XX_PASS1_X   (OCTEON_CN52XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN52XX_PASS2_X   (OCTEON_CN52XX_PASS2_0 | OM_IGNORE_MINOR_REVISION)</span>
<span class="cp">#define OCTEON_CN52XX_PASS1     OCTEON_CN52XX_PASS1_X</span>
<span class="cp">#define OCTEON_CN52XX_PASS2     OCTEON_CN52XX_PASS2_X</span>

<span class="cm">/*</span>
<span class="cm"> * CN3XXX models with old revision enconding</span>
<span class="cm"> */</span>
<span class="cp">#define OCTEON_CN38XX_PASS1     0x000d0000</span>
<span class="cp">#define OCTEON_CN38XX_PASS2     0x000d0001</span>
<span class="cp">#define OCTEON_CN38XX_PASS3     0x000d0003</span>
<span class="cp">#define OCTEON_CN38XX           (OCTEON_CN38XX_PASS3 | OM_IGNORE_REVISION)</span>

<span class="cp">#define OCTEON_CN36XX           OCTEON_CN38XX</span>
<span class="cp">#define OCTEON_CN36XX_PASS2     OCTEON_CN38XX_PASS2</span>
<span class="cp">#define OCTEON_CN36XX_PASS3     OCTEON_CN38XX_PASS3</span>

<span class="cm">/* The OCTEON_CN31XX matches CN31XX models and the CN3020 */</span>
<span class="cp">#define OCTEON_CN31XX_PASS1     0x000d0100</span>
<span class="cp">#define OCTEON_CN31XX_PASS1_1   0x000d0102</span>
<span class="cp">#define OCTEON_CN31XX           (OCTEON_CN31XX_PASS1 | OM_IGNORE_REVISION)</span>

<span class="cm">/*</span>
<span class="cm"> * This model is only used for internal checks, it is not a valid</span>
<span class="cm"> * model for the OCTEON_MODEL environment variable.  This matches the</span>
<span class="cm"> * CN3010 and CN3005 but NOT the CN3020.</span>
<span class="cm"> */</span>
<span class="cp">#define OCTEON_CN30XX_PASS1     0x000d0200</span>
<span class="cp">#define OCTEON_CN30XX_PASS1_1   0x000d0202</span>
<span class="cp">#define OCTEON_CN30XX           (OCTEON_CN30XX_PASS1 | OM_IGNORE_REVISION)</span>

<span class="cp">#define OCTEON_CN3005_PASS1     (0x000d0210 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3005_PASS1_0   (0x000d0210 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3005_PASS1_1   (0x000d0212 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3005           (OCTEON_CN3005_PASS1 | OM_IGNORE_REVISION | OM_CHECK_SUBMODEL)</span>

<span class="cp">#define OCTEON_CN3010_PASS1     (0x000d0200 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3010_PASS1_0   (0x000d0200 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3010_PASS1_1   (0x000d0202 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3010           (OCTEON_CN3010_PASS1 | OM_IGNORE_REVISION | OM_CHECK_SUBMODEL)</span>

<span class="cp">#define OCTEON_CN3020_PASS1     (0x000d0110 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3020_PASS1_0   (0x000d0110 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3020_PASS1_1   (0x000d0112 | OM_CHECK_SUBMODEL)</span>
<span class="cp">#define OCTEON_CN3020           (OCTEON_CN3020_PASS1 | OM_IGNORE_REVISION | OM_CHECK_SUBMODEL)</span>

<span class="cm">/*</span>
<span class="cm"> * This matches the complete family of CN3xxx CPUs, and not subsequent</span>
<span class="cm"> * models</span>
<span class="cm"> */</span>
<span class="cp">#define OCTEON_CN3XXX           (OCTEON_CN58XX_PASS1_0 | OM_MATCH_PREVIOUS_MODELS | OM_IGNORE_REVISION)</span>
<span class="cp">#define OCTEON_CN5XXX           (OCTEON_CN58XX_PASS1_0 | OM_MATCH_5XXX_FAMILY_MODELS)</span>
<span class="cp">#define OCTEON_CN6XXX           (OCTEON_CN63XX_PASS1_0 | OM_MATCH_6XXX_FAMILY_MODELS)</span>

<span class="cm">/* The revision byte (low byte) has two different encodings.</span>
<span class="cm"> * CN3XXX:</span>
<span class="cm"> *</span>
<span class="cm"> *     bits</span>
<span class="cm"> *     &lt;7:5&gt;: reserved (0)</span>
<span class="cm"> *     &lt;4&gt;:   alternate package</span>
<span class="cm"> *     &lt;3:0&gt;: revision</span>
<span class="cm"> *</span>
<span class="cm"> * CN5XXX:</span>
<span class="cm"> *</span>
<span class="cm"> *     bits</span>
<span class="cm"> *     &lt;7&gt;:   reserved (0)</span>
<span class="cm"> *     &lt;6&gt;:   alternate package</span>
<span class="cm"> *     &lt;5:3&gt;: major revision</span>
<span class="cm"> *     &lt;2:0&gt;: minor revision</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/* Masks used for the various types of model/family/revision matching */</span>
<span class="cp">#define OCTEON_38XX_FAMILY_MASK      0x00ffff00</span>
<span class="cp">#define OCTEON_38XX_FAMILY_REV_MASK  0x00ffff0f</span>
<span class="cp">#define OCTEON_38XX_MODEL_MASK       0x00ffff10</span>
<span class="cp">#define OCTEON_38XX_MODEL_REV_MASK   (OCTEON_38XX_FAMILY_REV_MASK | OCTEON_38XX_MODEL_MASK)</span>

<span class="cm">/* CN5XXX and later use different layout of bits in the revision ID field */</span>
<span class="cp">#define OCTEON_58XX_FAMILY_MASK      OCTEON_38XX_FAMILY_MASK</span>
<span class="cp">#define OCTEON_58XX_FAMILY_REV_MASK  0x00ffff3f</span>
<span class="cp">#define OCTEON_58XX_MODEL_MASK       0x00ffffc0</span>
<span class="cp">#define OCTEON_58XX_MODEL_REV_MASK   (OCTEON_58XX_FAMILY_REV_MASK | OCTEON_58XX_MODEL_MASK)</span>
<span class="cp">#define OCTEON_58XX_MODEL_MINOR_REV_MASK (OCTEON_58XX_MODEL_REV_MASK &amp; 0x00fffff8)</span>
<span class="cp">#define OCTEON_5XXX_MODEL_MASK       0x00ff0fc0</span>

<span class="cm">/* forward declarations */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">uint32_t</span> <span class="n">cvmx_get_proc_id</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">pure</span><span class="p">));</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">uint64_t</span> <span class="n">cvmx_read_csr</span><span class="p">(</span><span class="kt">uint64_t</span> <span class="n">csr_addr</span><span class="p">);</span>

<span class="cp">#define __OCTEON_MATCH_MASK__(x, y, z) (((x) &amp; (z)) == ((y) &amp; (z)))</span>

<span class="cm">/* NOTE: This for internal use only! */</span>
<span class="cp">#define __OCTEON_IS_MODEL_COMPILE__(arg_model, chip_model)		\</span>
<span class="cp">((((arg_model &amp; OCTEON_38XX_FAMILY_MASK) &lt; OCTEON_CN58XX_PASS1_0)  &amp;&amp; (	\</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == (OM_IGNORE_REVISION | OM_CHECK_SUBMODEL)) \</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_38XX_MODEL_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == 0)			\</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_38XX_FAMILY_REV_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == OM_IGNORE_REVISION) \</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_38XX_FAMILY_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == OM_CHECK_SUBMODEL)	\</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_38XX_MODEL_REV_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_MATCH_PREVIOUS_MODELS)) == OM_MATCH_PREVIOUS_MODELS) \</span>
<span class="cp">			&amp;&amp; (((chip_model) &amp; OCTEON_38XX_MODEL_MASK) &lt; ((arg_model) &amp; OCTEON_38XX_MODEL_MASK))) \</span>
<span class="cp">		)) ||							\</span>
<span class="cp">	(((arg_model &amp; OCTEON_38XX_FAMILY_MASK) &gt;= OCTEON_CN58XX_PASS1_0)  &amp;&amp; (	\</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == (OM_IGNORE_REVISION | OM_CHECK_SUBMODEL)) \</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_58XX_MODEL_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == 0)			\</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_58XX_FAMILY_REV_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == OM_IGNORE_MINOR_REVISION) \</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_58XX_MODEL_MINOR_REV_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == OM_IGNORE_REVISION) \</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_58XX_FAMILY_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_FLAG_MASK)) == OM_CHECK_SUBMODEL)	\</span>
<span class="cp">			&amp;&amp; __OCTEON_MATCH_MASK__((chip_model), (arg_model), OCTEON_58XX_MODEL_REV_MASK)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_MATCH_5XXX_FAMILY_MODELS)) == OM_MATCH_5XXX_FAMILY_MODELS) \</span>
<span class="cp">			&amp;&amp; ((chip_model) &gt;= OCTEON_CN58XX_PASS1_0) &amp;&amp; ((chip_model) &lt; OCTEON_CN63XX_PASS1_0)) || \</span>
<span class="cp">		((((arg_model) &amp; (OM_MATCH_6XXX_FAMILY_MODELS)) == OM_MATCH_6XXX_FAMILY_MODELS) \</span>
<span class="cp">			&amp;&amp; ((chip_model) &gt;= OCTEON_CN63XX_PASS1_0)) ||	\</span>
<span class="cp">		((((arg_model) &amp; (OM_MATCH_PREVIOUS_MODELS)) == OM_MATCH_PREVIOUS_MODELS) \</span>
<span class="cp">			&amp;&amp; (((chip_model) &amp; OCTEON_58XX_MODEL_MASK) &lt; ((arg_model) &amp; OCTEON_58XX_MODEL_MASK))) \</span>
<span class="cp">		)))</span>

<span class="cm">/* NOTE: This for internal use only!!!!! */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">__octeon_is_model_runtime__</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">model</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">cpuid</span> <span class="o">=</span> <span class="n">cvmx_get_proc_id</span><span class="p">();</span>

	<span class="cm">/*</span>
<span class="cm">	 * Check for special case of mismarked 3005 samples. We only</span>
<span class="cm">	 * need to check if the sub model isn&#39;t being ignored</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">model</span> <span class="o">&amp;</span> <span class="n">OM_CHECK_SUBMODEL</span><span class="p">)</span> <span class="o">==</span> <span class="n">OM_CHECK_SUBMODEL</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">cpuid</span> <span class="o">==</span> <span class="n">OCTEON_CN3010_PASS1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cvmx_read_csr</span><span class="p">(</span><span class="mh">0x80011800800007B8ull</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1ull</span> <span class="o">&lt;&lt;</span> <span class="mi">34</span><span class="p">)))</span>
			<span class="n">cpuid</span> <span class="o">|=</span> <span class="mh">0x10</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">__OCTEON_IS_MODEL_COMPILE__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cpuid</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * The OCTEON_IS_MODEL macro should be used for all Octeon model checking done</span>
<span class="cm"> * in a program.</span>
<span class="cm"> * This should be kept runtime if at all possible  and must be conditionalized</span>
<span class="cm"> * with OCTEON_IS_COMMON_BINARY() if runtime checking support is required.</span>
<span class="cm"> *</span>
<span class="cm"> * Use of the macro in preprocessor directives ( #if OCTEON_IS_MODEL(...) )</span>
<span class="cm"> * is NOT SUPPORTED, and should be replaced with CVMX_COMPILED_FOR()</span>
<span class="cm"> * I.e.:</span>
<span class="cm"> *  #if OCTEON_IS_MODEL(OCTEON_CN56XX)  -&gt;  #if CVMX_COMPILED_FOR(OCTEON_CN56XX)</span>
<span class="cm"> */</span>
<span class="cp">#define OCTEON_IS_MODEL(x) __octeon_is_model_runtime__(x)</span>
<span class="cp">#define OCTEON_IS_COMMON_BINARY() 1</span>
<span class="cp">#undef OCTEON_MODEL</span>

<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">octeon_model_get_string</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">chip_id</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">octeon_model_get_string_buffer</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">chip_id</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">);</span>

<span class="cp">#include &quot;octeon-feature.h&quot;</span>

<span class="cp">#endif </span><span class="cm">/* __OCTEON_MODEL_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
