<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › txx9 › jmr3927.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>jmr3927.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Defines for the TJSYS JMR-TX3927</span>
<span class="cm"> *</span>
<span class="cm"> * This file is subject to the terms and conditions of the GNU General Public</span>
<span class="cm"> * License.  See the file &quot;COPYING&quot; in the main directory of this archive</span>
<span class="cm"> * for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2000-2001 Toshiba Corporation</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __ASM_TXX9_JMR3927_H</span>
<span class="cp">#define __ASM_TXX9_JMR3927_H</span>

<span class="cp">#include &lt;asm/txx9/tx3927.h&gt;</span>
<span class="cp">#include &lt;asm/addrspace.h&gt;</span>
<span class="cp">#include &lt;asm/txx9irq.h&gt;</span>

<span class="cm">/* CS */</span>
<span class="cp">#define JMR3927_ROMCE0	0x1fc00000	</span><span class="cm">/* 4M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_ROMCE1	0x1e000000	</span><span class="cm">/* 4M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_ROMCE2	0x14000000	</span><span class="cm">/* 16M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_ROMCE3	0x10000000	</span><span class="cm">/* 64M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_ROMCE5	0x1d000000	</span><span class="cm">/* 4M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_SDCS0	0x00000000	</span><span class="cm">/* 32M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_SDCS1	0x02000000	</span><span class="cm">/* 32M */</span><span class="cp"></span>
<span class="cm">/* PCI Direct Mappings */</span>

<span class="cp">#define JMR3927_PCIMEM	0x08000000</span>
<span class="cp">#define JMR3927_PCIMEM_SIZE	0x08000000	</span><span class="cm">/* 128M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_PCIIO	0x15000000</span>
<span class="cp">#define JMR3927_PCIIO_SIZE	0x01000000	</span><span class="cm">/* 16M */</span><span class="cp"></span>

<span class="cp">#define JMR3927_SDRAM_SIZE	0x02000000	</span><span class="cm">/* 32M */</span><span class="cp"></span>
<span class="cp">#define JMR3927_PORT_BASE	KSEG1</span>

<span class="cm">/* Address map (virtual address) */</span>
<span class="cp">#define JMR3927_ROM0_BASE	(KSEG1 + JMR3927_ROMCE0)</span>
<span class="cp">#define JMR3927_ROM1_BASE	(KSEG1 + JMR3927_ROMCE1)</span>
<span class="cp">#define JMR3927_IOC_BASE	(KSEG1 + JMR3927_ROMCE2)</span>
<span class="cp">#define JMR3927_PCIMEM_BASE	(KSEG1 + JMR3927_PCIMEM)</span>
<span class="cp">#define JMR3927_PCIIO_BASE	(KSEG1 + JMR3927_PCIIO)</span>

<span class="cp">#define JMR3927_IOC_REV_ADDR	(JMR3927_IOC_BASE + 0x00000000)</span>
<span class="cp">#define JMR3927_IOC_NVRAMB_ADDR	(JMR3927_IOC_BASE + 0x00010000)</span>
<span class="cp">#define JMR3927_IOC_LED_ADDR	(JMR3927_IOC_BASE + 0x00020000)</span>
<span class="cp">#define JMR3927_IOC_DIPSW_ADDR	(JMR3927_IOC_BASE + 0x00030000)</span>
<span class="cp">#define JMR3927_IOC_BREV_ADDR	(JMR3927_IOC_BASE + 0x00040000)</span>
<span class="cp">#define JMR3927_IOC_DTR_ADDR	(JMR3927_IOC_BASE + 0x00050000)</span>
<span class="cp">#define JMR3927_IOC_INTS1_ADDR	(JMR3927_IOC_BASE + 0x00080000)</span>
<span class="cp">#define JMR3927_IOC_INTS2_ADDR	(JMR3927_IOC_BASE + 0x00090000)</span>
<span class="cp">#define JMR3927_IOC_INTM_ADDR	(JMR3927_IOC_BASE + 0x000a0000)</span>
<span class="cp">#define JMR3927_IOC_INTP_ADDR	(JMR3927_IOC_BASE + 0x000b0000)</span>
<span class="cp">#define JMR3927_IOC_RESET_ADDR	(JMR3927_IOC_BASE + 0x000f0000)</span>

<span class="cm">/* Flash ROM */</span>
<span class="cp">#define JMR3927_FLASH_BASE	(JMR3927_ROM0_BASE)</span>
<span class="cp">#define JMR3927_FLASH_SIZE	0x00400000</span>

<span class="cm">/* bits for IOC_REV/IOC_BREV (high byte) */</span>
<span class="cp">#define JMR3927_IDT_MASK	0xfc</span>
<span class="cp">#define JMR3927_REV_MASK	0x03</span>
<span class="cp">#define JMR3927_IOC_IDT		0xe0</span>

<span class="cm">/* bits for IOC_INTS1/IOC_INTS2/IOC_INTM/IOC_INTP (high byte) */</span>
<span class="cp">#define JMR3927_IOC_INTB_PCIA	0</span>
<span class="cp">#define JMR3927_IOC_INTB_PCIB	1</span>
<span class="cp">#define JMR3927_IOC_INTB_PCIC	2</span>
<span class="cp">#define JMR3927_IOC_INTB_PCID	3</span>
<span class="cp">#define JMR3927_IOC_INTB_MODEM	4</span>
<span class="cp">#define JMR3927_IOC_INTB_INT6	5</span>
<span class="cp">#define JMR3927_IOC_INTB_INT7	6</span>
<span class="cp">#define JMR3927_IOC_INTB_SOFT	7</span>
<span class="cp">#define JMR3927_IOC_INTF_PCIA	(1 &lt;&lt; JMR3927_IOC_INTF_PCIA)</span>
<span class="cp">#define JMR3927_IOC_INTF_PCIB	(1 &lt;&lt; JMR3927_IOC_INTB_PCIB)</span>
<span class="cp">#define JMR3927_IOC_INTF_PCIC	(1 &lt;&lt; JMR3927_IOC_INTB_PCIC)</span>
<span class="cp">#define JMR3927_IOC_INTF_PCID	(1 &lt;&lt; JMR3927_IOC_INTB_PCID)</span>
<span class="cp">#define JMR3927_IOC_INTF_MODEM	(1 &lt;&lt; JMR3927_IOC_INTB_MODEM)</span>
<span class="cp">#define JMR3927_IOC_INTF_INT6	(1 &lt;&lt; JMR3927_IOC_INTB_INT6)</span>
<span class="cp">#define JMR3927_IOC_INTF_INT7	(1 &lt;&lt; JMR3927_IOC_INTB_INT7)</span>
<span class="cp">#define JMR3927_IOC_INTF_SOFT	(1 &lt;&lt; JMR3927_IOC_INTB_SOFT)</span>

<span class="cm">/* bits for IOC_RESET (high byte) */</span>
<span class="cp">#define JMR3927_IOC_RESET_CPU	1</span>
<span class="cp">#define JMR3927_IOC_RESET_PCI	2</span>

<span class="cp">#if defined(__BIG_ENDIAN)</span>
<span class="cp">#define jmr3927_ioc_reg_out(d, a)	((*(volatile unsigned char *)(a)) = (d))</span>
<span class="cp">#define jmr3927_ioc_reg_in(a)		(*(volatile unsigned char *)(a))</span>
<span class="cp">#elif defined(__LITTLE_ENDIAN)</span>
<span class="cp">#define jmr3927_ioc_reg_out(d, a)	((*(volatile unsigned char *)((a)^1)) = (d))</span>
<span class="cp">#define jmr3927_ioc_reg_in(a)		(*(volatile unsigned char *)((a)^1))</span>
<span class="cp">#else</span>
<span class="cp">#error &quot;No Endian&quot;</span>
<span class="cp">#endif</span>

<span class="cm">/* LED macro */</span>
<span class="cp">#define jmr3927_led_set(n</span><span class="cm">/*0-16*/</span><span class="cp">)	jmr3927_ioc_reg_out(~(n), JMR3927_IOC_LED_ADDR)</span>

<span class="cp">#define jmr3927_led_and_set(n</span><span class="cm">/*0-16*/</span><span class="cp">)	jmr3927_ioc_reg_out((~(n)) &amp; jmr3927_ioc_reg_in(JMR3927_IOC_LED_ADDR), JMR3927_IOC_LED_ADDR)</span>

<span class="cm">/* DIPSW4 macro */</span>
<span class="cp">#define jmr3927_dipsw1()	(gpio_get_value(11) == 0)</span>
<span class="cp">#define jmr3927_dipsw2()	(gpio_get_value(10) == 0)</span>
<span class="cp">#define jmr3927_dipsw3()	((jmr3927_ioc_reg_in(JMR3927_IOC_DIPSW_ADDR) &amp; 2) == 0)</span>
<span class="cp">#define jmr3927_dipsw4()	((jmr3927_ioc_reg_in(JMR3927_IOC_DIPSW_ADDR) &amp; 1) == 0)</span>

<span class="cm">/*</span>
<span class="cm"> * IRQ mappings</span>
<span class="cm"> */</span>

<span class="cm">/* These are the virtual IRQ numbers, we divide all IRQ&#39;s into</span>
<span class="cm"> * &#39;spaces&#39;, the &#39;space&#39; determines where and how to enable/disable</span>
<span class="cm"> * that particular IRQ on an JMR machine.  Add new &#39;spaces&#39; as new</span>
<span class="cm"> * IRQ hardware is supported.</span>
<span class="cm"> */</span>
<span class="cp">#define JMR3927_NR_IRQ_IRC	16	</span><span class="cm">/* On-Chip IRC */</span><span class="cp"></span>
<span class="cp">#define JMR3927_NR_IRQ_IOC	8	</span><span class="cm">/* PCI/MODEM/INT[6:7] */</span><span class="cp"></span>

<span class="cp">#define JMR3927_IRQ_IRC	TXX9_IRQ_BASE</span>
<span class="cp">#define JMR3927_IRQ_IOC	(JMR3927_IRQ_IRC + JMR3927_NR_IRQ_IRC)</span>
<span class="cp">#define JMR3927_IRQ_END	(JMR3927_IRQ_IOC + JMR3927_NR_IRQ_IOC)</span>

<span class="cp">#define JMR3927_IRQ_IRC_INT0	(JMR3927_IRQ_IRC + TX3927_IR_INT0)</span>
<span class="cp">#define JMR3927_IRQ_IRC_INT1	(JMR3927_IRQ_IRC + TX3927_IR_INT1)</span>
<span class="cp">#define JMR3927_IRQ_IRC_INT2	(JMR3927_IRQ_IRC + TX3927_IR_INT2)</span>
<span class="cp">#define JMR3927_IRQ_IRC_INT3	(JMR3927_IRQ_IRC + TX3927_IR_INT3)</span>
<span class="cp">#define JMR3927_IRQ_IRC_INT4	(JMR3927_IRQ_IRC + TX3927_IR_INT4)</span>
<span class="cp">#define JMR3927_IRQ_IRC_INT5	(JMR3927_IRQ_IRC + TX3927_IR_INT5)</span>
<span class="cp">#define JMR3927_IRQ_IRC_SIO0	(JMR3927_IRQ_IRC + TX3927_IR_SIO0)</span>
<span class="cp">#define JMR3927_IRQ_IRC_SIO1	(JMR3927_IRQ_IRC + TX3927_IR_SIO1)</span>
<span class="cp">#define JMR3927_IRQ_IRC_SIO(ch)	(JMR3927_IRQ_IRC + TX3927_IR_SIO(ch))</span>
<span class="cp">#define JMR3927_IRQ_IRC_DMA	(JMR3927_IRQ_IRC + TX3927_IR_DMA)</span>
<span class="cp">#define JMR3927_IRQ_IRC_PIO	(JMR3927_IRQ_IRC + TX3927_IR_PIO)</span>
<span class="cp">#define JMR3927_IRQ_IRC_PCI	(JMR3927_IRQ_IRC + TX3927_IR_PCI)</span>
<span class="cp">#define JMR3927_IRQ_IRC_TMR(ch)	(JMR3927_IRQ_IRC + TX3927_IR_TMR(ch))</span>
<span class="cp">#define JMR3927_IRQ_IOC_PCIA	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_PCIA)</span>
<span class="cp">#define JMR3927_IRQ_IOC_PCIB	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_PCIB)</span>
<span class="cp">#define JMR3927_IRQ_IOC_PCIC	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_PCIC)</span>
<span class="cp">#define JMR3927_IRQ_IOC_PCID	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_PCID)</span>
<span class="cp">#define JMR3927_IRQ_IOC_MODEM	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_MODEM)</span>
<span class="cp">#define JMR3927_IRQ_IOC_INT6	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_INT6)</span>
<span class="cp">#define JMR3927_IRQ_IOC_INT7	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_INT7)</span>
<span class="cp">#define JMR3927_IRQ_IOC_SOFT	(JMR3927_IRQ_IOC + JMR3927_IOC_INTB_SOFT)</span>

<span class="cm">/* IOC (PCI, MODEM) */</span>
<span class="cp">#define JMR3927_IRQ_IOCINT	JMR3927_IRQ_IRC_INT1</span>
<span class="cm">/* TC35815 100M Ether (JMR-TX3912:JPW4:2-3 Short) */</span>
<span class="cp">#define JMR3927_IRQ_ETHER0	JMR3927_IRQ_IRC_INT3</span>

<span class="cm">/* Clocks */</span>
<span class="cp">#define JMR3927_CORECLK	132710400	</span><span class="cm">/* 132.7MHz */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * TX3927 Pin Configuration:</span>
<span class="cm"> *</span>
<span class="cm"> *	PCFG bits		Avail			Dead</span>
<span class="cm"> *	SELSIO[1:0]:11		RXD[1:0], TXD[1:0]	PIO[6:3]</span>
<span class="cm"> *	SELSIOC[0]:1		CTS[0], RTS[0]		INT[5:4]</span>
<span class="cm"> *	SELSIOC[1]:0,SELDSF:0,	GSDAO[0],GPCST[3]	CTS[1], RTS[1],DSF,</span>
<span class="cm"> *	  GDBGE*					  PIO[2:1]</span>
<span class="cm"> *	SELDMA[2]:1		DMAREQ[2],DMAACK[2]	PIO[13:12]</span>
<span class="cm"> *	SELTMR[2:0]:000					TIMER[1:0]</span>
<span class="cm"> *	SELCS:0,SELDMA[1]:0	PIO[11;10]		SDCS_CE[7:6],</span>
<span class="cm"> *							  DMAREQ[1],DMAACK[1]</span>
<span class="cm"> *	SELDMA[0]:1		DMAREQ[0],DMAACK[0]	PIO[9:8]</span>
<span class="cm"> *	SELDMA[3]:1		DMAREQ[3],DMAACK[3]	PIO[15:14]</span>
<span class="cm"> *	SELDONE:1		DMADONE			PIO[7]</span>
<span class="cm"> *</span>
<span class="cm"> * Usable pins are:</span>
<span class="cm"> *	RXD[1;0],TXD[1:0],CTS[0],RTS[0],</span>
<span class="cm"> *	DMAREQ[0,2,3],DMAACK[0,2,3],DMADONE,PIO[0,10,11]</span>
<span class="cm"> *	INT[3:0]</span>
<span class="cm"> */</span>

<span class="kt">void</span> <span class="n">jmr3927_prom_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">jmr3927_irq_setup</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">pci_dev</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">jmr3927_pci_map_irq</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u8</span> <span class="n">slot</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pin</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __ASM_TXX9_JMR3927_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
