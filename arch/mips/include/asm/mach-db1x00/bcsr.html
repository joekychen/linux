<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › mach-db1x00 › bcsr.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>bcsr.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * bcsr.h -- Db1xxx/Pb1xxx Devboard CPLD registers (&quot;BCSR&quot;) abstraction.</span>
<span class="cm"> *</span>
<span class="cm"> * All Alchemy development boards (except, of course, the weird PB1000)</span>
<span class="cm"> * have a few registers in a CPLD with standardised layout; they mostly</span>
<span class="cm"> * only differ in base address and bit meanings in the RESETS and BOARD</span>
<span class="cm"> * registers.</span>
<span class="cm"> *</span>
<span class="cm"> * All data taken from the official AMD board documentation sheets.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _DB1XXX_BCSR_H_</span>
<span class="cp">#define _DB1XXX_BCSR_H_</span>


<span class="cm">/* BCSR base addresses on various boards. BCSR base 2 refers to the</span>
<span class="cm"> * physical address of the first HEXLEDS register, which is usually</span>
<span class="cm"> * a variable offset from the WHOAMI register.</span>
<span class="cm"> */</span>

<span class="cm">/* DB1000, DB1100, DB1500, PB1100, PB1500 */</span>
<span class="cp">#define DB1000_BCSR_PHYS_ADDR	0x0E000000</span>
<span class="cp">#define DB1000_BCSR_HEXLED_OFS	0x01000000</span>

<span class="cp">#define DB1550_BCSR_PHYS_ADDR	0x0F000000</span>
<span class="cp">#define DB1550_BCSR_HEXLED_OFS	0x00400000</span>

<span class="cp">#define PB1550_BCSR_PHYS_ADDR	0x0F000000</span>
<span class="cp">#define PB1550_BCSR_HEXLED_OFS	0x00800000</span>

<span class="cp">#define DB1200_BCSR_PHYS_ADDR	0x19800000</span>
<span class="cp">#define DB1200_BCSR_HEXLED_OFS	0x00400000</span>

<span class="cp">#define PB1200_BCSR_PHYS_ADDR	0x0D800000</span>
<span class="cp">#define PB1200_BCSR_HEXLED_OFS	0x00400000</span>

<span class="cp">#define DB1300_BCSR_PHYS_ADDR	0x19800000</span>
<span class="cp">#define DB1300_BCSR_HEXLED_OFS	0x00400000</span>

<span class="k">enum</span> <span class="n">bcsr_id</span> <span class="p">{</span>
	<span class="cm">/* BCSR base 1 */</span>
	<span class="n">BCSR_WHOAMI</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">BCSR_STATUS</span><span class="p">,</span>
	<span class="n">BCSR_SWITCHES</span><span class="p">,</span>
	<span class="n">BCSR_RESETS</span><span class="p">,</span>
	<span class="n">BCSR_PCMCIA</span><span class="p">,</span>
	<span class="n">BCSR_BOARD</span><span class="p">,</span>
	<span class="n">BCSR_LEDS</span><span class="p">,</span>
	<span class="n">BCSR_SYSTEM</span><span class="p">,</span>
	<span class="cm">/* Au1200/1300 based boards */</span>
	<span class="n">BCSR_INTCLR</span><span class="p">,</span>
	<span class="n">BCSR_INTSET</span><span class="p">,</span>
	<span class="n">BCSR_MASKCLR</span><span class="p">,</span>
	<span class="n">BCSR_MASKSET</span><span class="p">,</span>
	<span class="n">BCSR_SIGSTAT</span><span class="p">,</span>
	<span class="n">BCSR_INTSTAT</span><span class="p">,</span>

	<span class="cm">/* BCSR base 2 */</span>
	<span class="n">BCSR_HEXLEDS</span><span class="p">,</span>
	<span class="n">BCSR_RSVD1</span><span class="p">,</span>
	<span class="n">BCSR_HEXCLEAR</span><span class="p">,</span>

	<span class="n">BCSR_CNT</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* register offsets, valid for all Db1xxx/Pb1xxx boards */</span>
<span class="cp">#define BCSR_REG_WHOAMI		0x00</span>
<span class="cp">#define BCSR_REG_STATUS		0x04</span>
<span class="cp">#define BCSR_REG_SWITCHES	0x08</span>
<span class="cp">#define BCSR_REG_RESETS		0x0c</span>
<span class="cp">#define BCSR_REG_PCMCIA		0x10</span>
<span class="cp">#define BCSR_REG_BOARD		0x14</span>
<span class="cp">#define BCSR_REG_LEDS		0x18</span>
<span class="cp">#define BCSR_REG_SYSTEM		0x1c</span>
<span class="cm">/* Au1200/Au1300 based boards: CPLD IRQ muxer */</span>
<span class="cp">#define BCSR_REG_INTCLR		0x20</span>
<span class="cp">#define BCSR_REG_INTSET		0x24</span>
<span class="cp">#define BCSR_REG_MASKCLR	0x28</span>
<span class="cp">#define BCSR_REG_MASKSET	0x2c</span>
<span class="cp">#define BCSR_REG_SIGSTAT	0x30</span>
<span class="cp">#define BCSR_REG_INTSTAT	0x34</span>

<span class="cm">/* hexled control, offset from BCSR base 2 */</span>
<span class="cp">#define BCSR_REG_HEXLEDS	0x00</span>
<span class="cp">#define BCSR_REG_HEXCLEAR	0x08</span>

<span class="cm">/*</span>
<span class="cm"> * Register Bits and Pieces.</span>
<span class="cm"> */</span>
<span class="cp">#define BCSR_WHOAMI_DCID(x)		((x) &amp; 0xf)</span>
<span class="cp">#define BCSR_WHOAMI_CPLD(x)		(((x) &gt;&gt; 4) &amp; 0xf)</span>
<span class="cp">#define BCSR_WHOAMI_BOARD(x)		(((x) &gt;&gt; 8) &amp; 0xf)</span>

<span class="cm">/* register &quot;WHOAMI&quot; bits 11:8 identify the board */</span>
<span class="k">enum</span> <span class="n">bcsr_whoami_boards</span> <span class="p">{</span>
	<span class="n">BCSR_WHOAMI_PB1500</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1500R2</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1100</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_DB1000</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_DB1100</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_DB1500</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_DB1550</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1550_DDR</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1550</span> <span class="o">=</span> <span class="n">BCSR_WHOAMI_PB1550_DDR</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1550_SDR</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1200_DDR1</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1200</span> <span class="o">=</span> <span class="n">BCSR_WHOAMI_PB1200_DDR1</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_PB1200_DDR2</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_DB1200</span><span class="p">,</span>
	<span class="n">BCSR_WHOAMI_DB1300</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* STATUS reg.  Unless otherwise noted, they&#39;re valid on all boards.</span>
<span class="cm"> * PB1200 = DB1200.</span>
<span class="cm"> */</span>
<span class="cp">#define BCSR_STATUS_PC0VS		0x0003</span>
<span class="cp">#define BCSR_STATUS_PC1VS		0x000C</span>
<span class="cp">#define BCSR_STATUS_PC0FI		0x0010</span>
<span class="cp">#define BCSR_STATUS_PC1FI		0x0020</span>
<span class="cp">#define BCSR_STATUS_PB1550_SWAPBOOT	0x0040</span>
<span class="cp">#define BCSR_STATUS_SRAMWIDTH		0x0080</span>
<span class="cp">#define BCSR_STATUS_FLASHBUSY		0x0100</span>
<span class="cp">#define BCSR_STATUS_ROMBUSY		0x0400</span>
<span class="cp">#define BCSR_STATUS_SD0WP		0x0400	</span><span class="cm">/* DB1200/DB1300:SD1 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_SD1WP		0x0800</span>
<span class="cp">#define BCSR_STATUS_USBOTGID		0x0800	</span><span class="cm">/* PB/DB1550 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_DB1000_SWAPBOOT	0x2000</span>
<span class="cp">#define BCSR_STATUS_DB1200_SWAPBOOT	0x0040	</span><span class="cm">/* DB1200/1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_IDECBLID		0x0200	</span><span class="cm">/* DB1200/1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_DB1200_U0RXD	0x1000	</span><span class="cm">/* DB1200 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_DB1200_U1RXD	0x2000	</span><span class="cm">/* DB1200 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_FLASHDEN		0xC000</span>
<span class="cp">#define BCSR_STATUS_DB1550_U0RXD	0x1000	</span><span class="cm">/* DB1550 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_DB1550_U3RXD	0x2000	</span><span class="cm">/* DB1550 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_PB1550_U0RXD	0x1000	</span><span class="cm">/* PB1550 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_PB1550_U1RXD	0x2000	</span><span class="cm">/* PB1550 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_PB1550_U3RXD	0x8000	</span><span class="cm">/* PB1550 */</span><span class="cp"></span>

<span class="cp">#define BCSR_STATUS_CFWP		0x4000	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_USBOCn		0x2000	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_OTGOCn		0x1000	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_DCDMARQ		0x0010	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_STATUS_IDEDMARQ		0x0020	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>

<span class="cm">/* DB/PB1000,1100,1500,1550 */</span>
<span class="cp">#define BCSR_RESETS_PHY0		0x0001</span>
<span class="cp">#define BCSR_RESETS_PHY1		0x0002</span>
<span class="cp">#define BCSR_RESETS_DC			0x0004</span>
<span class="cp">#define BCSR_RESETS_FIR_SEL		0x2000</span>
<span class="cp">#define BCSR_RESETS_IRDA_MODE_MASK	0xC000</span>
<span class="cp">#define BCSR_RESETS_IRDA_MODE_FULL	0x0000</span>
<span class="cp">#define BCSR_RESETS_PB1550_WSCFSM	0x2000</span>
<span class="cp">#define BCSR_RESETS_IRDA_MODE_OFF	0x4000</span>
<span class="cp">#define BCSR_RESETS_IRDA_MODE_2_3	0x8000</span>
<span class="cp">#define BCSR_RESETS_IRDA_MODE_1_3	0xC000</span>
<span class="cp">#define BCSR_RESETS_DMAREQ		0x8000	</span><span class="cm">/* PB1550 */</span><span class="cp"></span>

<span class="cp">#define BCSR_BOARD_PCIM66EN		0x0001</span>
<span class="cp">#define BCSR_BOARD_SD0PWR		0x0040</span>
<span class="cp">#define BCSR_BOARD_SD1PWR		0x0080</span>
<span class="cp">#define BCSR_BOARD_PCIM33		0x0100</span>
<span class="cp">#define BCSR_BOARD_PCIEXTARB		0x0200</span>
<span class="cp">#define BCSR_BOARD_GPIO200RST		0x0400</span>
<span class="cp">#define BCSR_BOARD_PCICLKOUT		0x0800</span>
<span class="cp">#define BCSR_BOARD_PCICFG		0x1000</span>
<span class="cp">#define BCSR_BOARD_SPISEL		0x2000	</span><span class="cm">/* PB/DB1550 */</span><span class="cp"></span>
<span class="cp">#define BCSR_BOARD_SD0WP		0x4000	</span><span class="cm">/* DB1100 */</span><span class="cp"></span>
<span class="cp">#define BCSR_BOARD_SD1WP		0x8000	</span><span class="cm">/* DB1100 */</span><span class="cp"></span>


<span class="cm">/* DB/PB1200/1300 */</span>
<span class="cp">#define BCSR_RESETS_ETH			0x0001</span>
<span class="cp">#define BCSR_RESETS_CAMERA		0x0002</span>
<span class="cp">#define BCSR_RESETS_DC			0x0004</span>
<span class="cp">#define BCSR_RESETS_IDE			0x0008</span>
<span class="cp">#define BCSR_RESETS_TV			0x0010	</span><span class="cm">/* DB1200/1300 */</span><span class="cp"></span>
<span class="cm">/* Not resets but in the same register */</span>
<span class="cp">#define BCSR_RESETS_PWMR1MUX		0x0800	</span><span class="cm">/* DB1200 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_PB1200_WSCFSM	0x0800	</span><span class="cm">/* PB1200 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_PSC0MUX		0x1000</span>
<span class="cp">#define BCSR_RESETS_PSC1MUX		0x2000</span>
<span class="cp">#define BCSR_RESETS_SPISEL		0x4000</span>
<span class="cp">#define BCSR_RESETS_SD1MUX		0x8000	</span><span class="cm">/* PB1200 */</span><span class="cp"></span>

<span class="cp">#define BCSR_RESETS_VDDQSHDN		0x0200	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_OTPPGM		0x0400	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_OTPSCLK		0x0800	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_OTPWRPROT		0x1000	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_OTPCSB		0x2000	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_OTGPWR		0x4000	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_RESETS_USBHPWR		0x8000  </span><span class="cm">/* DB1300 */</span><span class="cp"></span>

<span class="cp">#define BCSR_BOARD_LCDVEE		0x0001</span>
<span class="cp">#define BCSR_BOARD_LCDVDD		0x0002</span>
<span class="cp">#define BCSR_BOARD_LCDBL		0x0004</span>
<span class="cp">#define BCSR_BOARD_CAMSNAP		0x0010</span>
<span class="cp">#define BCSR_BOARD_CAMPWR		0x0020</span>
<span class="cp">#define BCSR_BOARD_SD0PWR		0x0040</span>
<span class="cp">#define BCSR_BOARD_CAMCS		0x0010	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_BOARD_HDMI_DE		0x0040	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>

<span class="cp">#define BCSR_SWITCHES_DIP		0x00FF</span>
<span class="cp">#define BCSR_SWITCHES_DIP_1		0x0080</span>
<span class="cp">#define BCSR_SWITCHES_DIP_2		0x0040</span>
<span class="cp">#define BCSR_SWITCHES_DIP_3		0x0020</span>
<span class="cp">#define BCSR_SWITCHES_DIP_4		0x0010</span>
<span class="cp">#define BCSR_SWITCHES_DIP_5		0x0008</span>
<span class="cp">#define BCSR_SWITCHES_DIP_6		0x0004</span>
<span class="cp">#define BCSR_SWITCHES_DIP_7		0x0002</span>
<span class="cp">#define BCSR_SWITCHES_DIP_8		0x0001</span>
<span class="cp">#define BCSR_SWITCHES_ROTARY		0x0F00</span>


<span class="cp">#define BCSR_PCMCIA_PC0VPP		0x0003</span>
<span class="cp">#define BCSR_PCMCIA_PC0VCC		0x000C</span>
<span class="cp">#define BCSR_PCMCIA_PC0DRVEN		0x0010</span>
<span class="cp">#define BCSR_PCMCIA_PC0RST		0x0080</span>
<span class="cp">#define BCSR_PCMCIA_PC1VPP		0x0300</span>
<span class="cp">#define BCSR_PCMCIA_PC1VCC		0x0C00</span>
<span class="cp">#define BCSR_PCMCIA_PC1DRVEN		0x1000</span>
<span class="cp">#define BCSR_PCMCIA_PC1RST		0x8000</span>


<span class="cp">#define BCSR_LEDS_DECIMALS		0x0003</span>
<span class="cp">#define BCSR_LEDS_LED0			0x0100</span>
<span class="cp">#define BCSR_LEDS_LED1			0x0200</span>
<span class="cp">#define BCSR_LEDS_LED2			0x0400</span>
<span class="cp">#define BCSR_LEDS_LED3			0x0800</span>


<span class="cp">#define BCSR_SYSTEM_RESET		0x8000	</span><span class="cm">/* clear to reset */</span><span class="cp"></span>
<span class="cp">#define BCSR_SYSTEM_PWROFF		0x4000	</span><span class="cm">/* set to power off */</span><span class="cp"></span>
<span class="cp">#define BCSR_SYSTEM_VDDI		0x001F	</span><span class="cm">/* PB1xxx boards */</span><span class="cp"></span>
<span class="cp">#define BCSR_SYSTEM_DEBUGCSMASK		0x003F	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_SYSTEM_UDMAMODE		0x0100	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_SYSTEM_WAKEONIRQ		0x0200	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>
<span class="cp">#define BCSR_SYSTEM_VDDI1300		0x3C00	</span><span class="cm">/* DB1300 */</span><span class="cp"></span>



<span class="cm">/* initialize BCSR for a board. Provide the PHYSICAL addresses of both</span>
<span class="cm"> * BCSR spaces.</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="n">__init</span> <span class="n">bcsr_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">bcsr1_phys</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">bcsr2_phys</span><span class="p">);</span>

<span class="cm">/* read a board register */</span>
<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bcsr_read</span><span class="p">(</span><span class="k">enum</span> <span class="n">bcsr_id</span> <span class="n">reg</span><span class="p">);</span>

<span class="cm">/* write to a board register */</span>
<span class="kt">void</span> <span class="n">bcsr_write</span><span class="p">(</span><span class="k">enum</span> <span class="n">bcsr_id</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">val</span><span class="p">);</span>

<span class="cm">/* modify a register. clear bits set in &#39;clr&#39;, set bits set in &#39;set&#39; */</span>
<span class="kt">void</span> <span class="n">bcsr_mod</span><span class="p">(</span><span class="k">enum</span> <span class="n">bcsr_id</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">clr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">set</span><span class="p">);</span>

<span class="cm">/* install CPLD IRQ demuxer (DB1200/PB1200) */</span>
<span class="kt">void</span> <span class="n">__init</span> <span class="n">bcsr_init_irq</span><span class="p">(</span><span class="kt">int</span> <span class="n">csc_start</span><span class="p">,</span> <span class="kt">int</span> <span class="n">csc_end</span><span class="p">,</span> <span class="kt">int</span> <span class="n">hook_irq</span><span class="p">);</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
