<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › mips › include › asm › mach-au1x00 › au1xxx_ide.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>au1xxx_ide.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * include/asm-mips/mach-au1x00/au1xxx_ide.h  version 01.30.00   Aug. 02 2005</span>
<span class="cm"> *</span>
<span class="cm"> * BRIEF MODULE DESCRIPTION</span>
<span class="cm"> * AMD Alchemy Au1xxx IDE interface routines over the Static Bus</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2003-2005 AMD, Personal Connectivity Solutions</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it under</span>
<span class="cm"> * the terms of the GNU General Public License as published by the Free Software</span>
<span class="cm"> * Foundation; either version 2 of the License, or (at your option) any later</span>
<span class="cm"> * version.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS SOFTWARE IS PROVIDED ``AS IS&#39;&#39; AND ANY EXPRESS OR IMPLIED WARRANTIES,</span>
<span class="cm"> * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE AUTHOR</span>
<span class="cm"> * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class="cm"> * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class="cm"> * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class="cm"> * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class="cm"> * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="cm"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span>
<span class="cm"> * POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along with</span>
<span class="cm"> * this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm"> * 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * Note: for more information, please refer &quot;AMD Alchemy Au1200/Au1550 IDE</span>
<span class="cm"> *       Interface and Linux Device Driver&quot; Application Note.</span>
<span class="cm"> */</span>

<span class="cp">#ifdef CONFIG_BLK_DEV_IDE_AU1XXX_MDMA2_DBDMA</span>
<span class="cp">#define DMA_WAIT_TIMEOUT	100</span>
<span class="cp">#define NUM_DESCRIPTORS 	PRD_ENTRIES</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_BLK_DEV_IDE_AU1XXX_PIO_DBDMA */</span><span class="cp"></span>
<span class="cp">#define NUM_DESCRIPTORS 	2</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef AU1XXX_ATA_RQSIZE</span>
<span class="cp">#define AU1XXX_ATA_RQSIZE	128</span>
<span class="cp">#endif</span>

<span class="cm">/* Disable Burstable-Support for DBDMA */</span>
<span class="cp">#ifndef CONFIG_BLK_DEV_IDE_AU1XXX_BURSTABLE_ON</span>
<span class="cp">#define CONFIG_BLK_DEV_IDE_AU1XXX_BURSTABLE_ON	0</span>
<span class="cp">#endif</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">u32</span>			<span class="n">tx_dev_id</span><span class="p">,</span> <span class="n">rx_dev_id</span><span class="p">,</span> <span class="n">target_dev_id</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">tx_chan</span><span class="p">,</span> <span class="n">rx_chan</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">tx_desc_head</span><span class="p">,</span> <span class="o">*</span><span class="n">rx_desc_head</span><span class="p">;</span>
	<span class="n">ide_hwif_t</span>		<span class="o">*</span><span class="n">hwif</span><span class="p">;</span>
<span class="cp">#ifdef CONFIG_BLK_DEV_IDE_AU1XXX_MDMA2_DBDMA</span>
	<span class="n">ide_drive_t</span>		<span class="o">*</span><span class="n">drive</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dbdma_cmd</span>	<span class="o">*</span><span class="n">dma_table_cpu</span><span class="p">;</span>
	<span class="n">dma_addr_t</span>		<span class="n">dma_table_dma</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="kt">int</span>			<span class="n">irq</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">regbase</span><span class="p">;</span>
	<span class="kt">int</span>			<span class="n">ddma_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">_auide_hwif</span><span class="p">;</span>

<span class="cm">/******************************************************************************/</span>
<span class="cm">/* PIO Mode timing calculation :					      */</span>
<span class="cm">/*									      */</span>
<span class="cm">/* Static Bus Spec   ATA Spec						      */</span>
<span class="cm">/*	Tcsoe	   =	t1						      */</span>
<span class="cm">/*	Toecs	   =	t9						      */</span>
<span class="cm">/*	Twcs	   =	t9						      */</span>
<span class="cm">/*	Tcsh	   =	t2i | t2					      */</span>
<span class="cm">/*	Tcsoff	   =	t2i | t2					      */</span>
<span class="cm">/*	Twp	   =	t2						      */</span>
<span class="cm">/*	Tcsw	   =	t1						      */</span>
<span class="cm">/*	Tpm	   =	0						      */</span>
<span class="cm">/*	Ta	   =	t1+t2						      */</span>
<span class="cm">/******************************************************************************/</span>

<span class="cp">#define TCSOE_MASK		(0x07 &lt;&lt; 29)</span>
<span class="cp">#define TOECS_MASK		(0x07 &lt;&lt; 26)</span>
<span class="cp">#define TWCS_MASK		(0x07 &lt;&lt; 28)</span>
<span class="cp">#define TCSH_MASK		(0x0F &lt;&lt; 24)</span>
<span class="cp">#define TCSOFF_MASK		(0x07 &lt;&lt; 20)</span>
<span class="cp">#define TWP_MASK		(0x3F &lt;&lt; 14)</span>
<span class="cp">#define TCSW_MASK		(0x0F &lt;&lt; 10)</span>
<span class="cp">#define TPM_MASK		(0x0F &lt;&lt; 6)</span>
<span class="cp">#define TA_MASK 		(0x3F &lt;&lt; 0)</span>
<span class="cp">#define TS_MASK 		(1 &lt;&lt; 8)</span>

<span class="cm">/* Timing parameters PIO mode 0 */</span>
<span class="cp">#define SBC_IDE_PIO0_TCSOE	(0x04 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_PIO0_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_PIO0_TWCS	(0x02 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_PIO0_TCSH	(0x08 &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_PIO0_TCSOFF	(0x07 &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_PIO0_TWP	(0x10 &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_PIO0_TCSW	(0x04 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_PIO0_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_PIO0_TA 	(0x15 &lt;&lt; 0)</span>
<span class="cm">/* Timing parameters PIO mode 1 */</span>
<span class="cp">#define SBC_IDE_PIO1_TCSOE	(0x03 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_PIO1_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_PIO1_TWCS	(0x01 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_PIO1_TCSH	(0x06 &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_PIO1_TCSOFF	(0x06 &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_PIO1_TWP	(0x08 &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_PIO1_TCSW	(0x03 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_PIO1_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_PIO1_TA 	(0x0B &lt;&lt; 0)</span>
<span class="cm">/* Timing parameters PIO mode 2 */</span>
<span class="cp">#define SBC_IDE_PIO2_TCSOE	(0x05 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_PIO2_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_PIO2_TWCS	(0x01 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_PIO2_TCSH	(0x07 &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_PIO2_TCSOFF	(0x07 &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_PIO2_TWP	(0x1F &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_PIO2_TCSW	(0x05 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_PIO2_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_PIO2_TA 	(0x22 &lt;&lt; 0)</span>
<span class="cm">/* Timing parameters PIO mode 3 */</span>
<span class="cp">#define SBC_IDE_PIO3_TCSOE	(0x05 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_PIO3_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_PIO3_TWCS	(0x01 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_PIO3_TCSH	(0x0D &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_PIO3_TCSOFF	(0x0D &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_PIO3_TWP	(0x15 &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_PIO3_TCSW	(0x05 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_PIO3_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_PIO3_TA 	(0x1A &lt;&lt; 0)</span>
<span class="cm">/* Timing parameters PIO mode 4 */</span>
<span class="cp">#define SBC_IDE_PIO4_TCSOE	(0x04 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_PIO4_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_PIO4_TWCS	(0x01 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_PIO4_TCSH	(0x04 &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_PIO4_TCSOFF	(0x04 &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_PIO4_TWP	(0x0D &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_PIO4_TCSW	(0x03 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_PIO4_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_PIO4_TA 	(0x12 &lt;&lt; 0)</span>
<span class="cm">/* Timing parameters MDMA mode 0 */</span>
<span class="cp">#define SBC_IDE_MDMA0_TCSOE	(0x03 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_MDMA0_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_MDMA0_TWCS	(0x01 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_MDMA0_TCSH	(0x07 &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_MDMA0_TCSOFF	(0x07 &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_MDMA0_TWP	(0x0C &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_MDMA0_TCSW	(0x03 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_MDMA0_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_MDMA0_TA	(0x0F &lt;&lt; 0)</span>
<span class="cm">/* Timing parameters MDMA mode 1 */</span>
<span class="cp">#define SBC_IDE_MDMA1_TCSOE	(0x05 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_MDMA1_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_MDMA1_TWCS	(0x01 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_MDMA1_TCSH	(0x05 &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_MDMA1_TCSOFF	(0x05 &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_MDMA1_TWP	(0x0F &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_MDMA1_TCSW	(0x05 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_MDMA1_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_MDMA1_TA	(0x15 &lt;&lt; 0)</span>
<span class="cm">/* Timing parameters MDMA mode 2 */</span>
<span class="cp">#define SBC_IDE_MDMA2_TCSOE	(0x04 &lt;&lt; 29)</span>
<span class="cp">#define SBC_IDE_MDMA2_TOECS	(0x01 &lt;&lt; 26)</span>
<span class="cp">#define SBC_IDE_MDMA2_TWCS	(0x01 &lt;&lt; 28)</span>
<span class="cp">#define SBC_IDE_MDMA2_TCSH	(0x04 &lt;&lt; 24)</span>
<span class="cp">#define SBC_IDE_MDMA2_TCSOFF	(0x04 &lt;&lt; 20)</span>
<span class="cp">#define SBC_IDE_MDMA2_TWP	(0x0D &lt;&lt; 14)</span>
<span class="cp">#define SBC_IDE_MDMA2_TCSW	(0x04 &lt;&lt; 10)</span>
<span class="cp">#define SBC_IDE_MDMA2_TPM	(0x00 &lt;&lt; 6)</span>
<span class="cp">#define SBC_IDE_MDMA2_TA	(0x12 &lt;&lt; 0)</span>

<span class="cp">#define SBC_IDE_TIMING(mode) \</span>
<span class="cp">	(SBC_IDE_##mode##_TWCS | \</span>
<span class="cp">	 SBC_IDE_##mode##_TCSH | \</span>
<span class="cp">	 SBC_IDE_##mode##_TCSOFF | \</span>
<span class="cp">	 SBC_IDE_##mode##_TWP | \</span>
<span class="cp">	 SBC_IDE_##mode##_TCSW | \</span>
<span class="cp">	 SBC_IDE_##mode##_TPM | \</span>
<span class="cp">	 SBC_IDE_##mode##_TA)</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
