<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › xtensa › include › asm › elf.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>elf.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * include/asm-xtensa/elf.h</span>
<span class="cm"> *</span>
<span class="cm"> * ELF register definitions</span>
<span class="cm"> *</span>
<span class="cm"> * This file is subject to the terms and conditions of the GNU General Public</span>
<span class="cm"> * License.  See the file &quot;COPYING&quot; in the main directory of this archive</span>
<span class="cm"> * for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2001 - 2005 Tensilica Inc.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _XTENSA_ELF_H</span>
<span class="cp">#define _XTENSA_ELF_H</span>

<span class="cp">#include &lt;asm/ptrace.h&gt;</span>
<span class="cp">#include &lt;asm/coprocessor.h&gt;</span>

<span class="cm">/* Xtensa processor ELF architecture-magic number */</span>

<span class="cp">#define EM_XTENSA	94</span>
<span class="cp">#define EM_XTENSA_OLD	0xABC7</span>

<span class="cm">/* Xtensa relocations defined by the ABIs */</span>

<span class="cp">#define R_XTENSA_NONE           0</span>
<span class="cp">#define R_XTENSA_32             1</span>
<span class="cp">#define R_XTENSA_RTLD           2</span>
<span class="cp">#define R_XTENSA_GLOB_DAT       3</span>
<span class="cp">#define R_XTENSA_JMP_SLOT       4</span>
<span class="cp">#define R_XTENSA_RELATIVE       5</span>
<span class="cp">#define R_XTENSA_PLT            6</span>
<span class="cp">#define R_XTENSA_OP0            8</span>
<span class="cp">#define R_XTENSA_OP1            9</span>
<span class="cp">#define R_XTENSA_OP2            10</span>
<span class="cp">#define R_XTENSA_ASM_EXPAND	11</span>
<span class="cp">#define R_XTENSA_ASM_SIMPLIFY	12</span>
<span class="cp">#define R_XTENSA_GNU_VTINHERIT	15</span>
<span class="cp">#define R_XTENSA_GNU_VTENTRY	16</span>
<span class="cp">#define R_XTENSA_DIFF8		17</span>
<span class="cp">#define R_XTENSA_DIFF16		18</span>
<span class="cp">#define R_XTENSA_DIFF32		19</span>
<span class="cp">#define R_XTENSA_SLOT0_OP	20</span>
<span class="cp">#define R_XTENSA_SLOT1_OP	21</span>
<span class="cp">#define R_XTENSA_SLOT2_OP	22</span>
<span class="cp">#define R_XTENSA_SLOT3_OP	23</span>
<span class="cp">#define R_XTENSA_SLOT4_OP	24</span>
<span class="cp">#define R_XTENSA_SLOT5_OP	25</span>
<span class="cp">#define R_XTENSA_SLOT6_OP	26</span>
<span class="cp">#define R_XTENSA_SLOT7_OP	27</span>
<span class="cp">#define R_XTENSA_SLOT8_OP	28</span>
<span class="cp">#define R_XTENSA_SLOT9_OP	29</span>
<span class="cp">#define R_XTENSA_SLOT10_OP	30</span>
<span class="cp">#define R_XTENSA_SLOT11_OP	31</span>
<span class="cp">#define R_XTENSA_SLOT12_OP	32</span>
<span class="cp">#define R_XTENSA_SLOT13_OP	33</span>
<span class="cp">#define R_XTENSA_SLOT14_OP	34</span>
<span class="cp">#define R_XTENSA_SLOT0_ALT	35</span>
<span class="cp">#define R_XTENSA_SLOT1_ALT	36</span>
<span class="cp">#define R_XTENSA_SLOT2_ALT	37</span>
<span class="cp">#define R_XTENSA_SLOT3_ALT	38</span>
<span class="cp">#define R_XTENSA_SLOT4_ALT	39</span>
<span class="cp">#define R_XTENSA_SLOT5_ALT	40</span>
<span class="cp">#define R_XTENSA_SLOT6_ALT	41</span>
<span class="cp">#define R_XTENSA_SLOT7_ALT	42</span>
<span class="cp">#define R_XTENSA_SLOT8_ALT	43</span>
<span class="cp">#define R_XTENSA_SLOT9_ALT	44</span>
<span class="cp">#define R_XTENSA_SLOT10_ALT	45</span>
<span class="cp">#define R_XTENSA_SLOT11_ALT	46</span>
<span class="cp">#define R_XTENSA_SLOT12_ALT	47</span>
<span class="cp">#define R_XTENSA_SLOT13_ALT	48</span>
<span class="cp">#define R_XTENSA_SLOT14_ALT	49</span>

<span class="cm">/* ELF register definitions. This is needed for core dump support.  */</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_greg_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">elf_greg_t</span> <span class="n">pc</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">ps</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">lbeg</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">lend</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">lcount</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">sar</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">windowstart</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">windowbase</span><span class="p">;</span>
	<span class="n">elf_greg_t</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">8</span><span class="o">+</span><span class="mi">48</span><span class="p">];</span>
	<span class="n">elf_greg_t</span> <span class="n">a</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="p">}</span> <span class="n">xtensa_gregset_t</span><span class="p">;</span>

<span class="cp">#define ELF_NGREG	(sizeof(xtensa_gregset_t) / sizeof(elf_greg_t))</span>

<span class="k">typedef</span> <span class="n">elf_greg_t</span> <span class="n">elf_gregset_t</span><span class="p">[</span><span class="n">ELF_NGREG</span><span class="p">];</span>

<span class="cp">#define ELF_NFPREG	18</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">elf_fpreg_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">elf_fpreg_t</span> <span class="n">elf_fpregset_t</span><span class="p">[</span><span class="n">ELF_NFPREG</span><span class="p">];</span>

<span class="cp">#define ELF_CORE_COPY_REGS(_eregs, _pregs) 				\</span>
<span class="cp">	xtensa_elf_core_copy_regs ((xtensa_gregset_t*)&amp;(_eregs), _pregs);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">xtensa_elf_core_copy_regs</span> <span class="p">(</span><span class="n">xtensa_gregset_t</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pt_regs</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * This is used to ensure we don&#39;t load something for the wrong architecture.</span>
<span class="cm"> */</span>

<span class="cp">#define elf_check_arch(x) ( ( (x)-&gt;e_machine == EM_XTENSA )  || \</span>
<span class="cp">			    ( (x)-&gt;e_machine == EM_XTENSA_OLD ) )</span>

<span class="cm">/*</span>
<span class="cm"> * These are used to set parameters in the core dumps.</span>
<span class="cm"> */</span>

<span class="cp">#ifdef __XTENSA_EL__</span>
<span class="cp"># define ELF_DATA	ELFDATA2LSB</span>
<span class="cp">#elif defined(__XTENSA_EB__)</span>
<span class="cp"># define ELF_DATA	ELFDATA2MSB</span>
<span class="cp">#else</span>
<span class="cp"># error processor byte order undefined!</span>
<span class="cp">#endif</span>

<span class="cp">#define ELF_CLASS	ELFCLASS32</span>
<span class="cp">#define ELF_ARCH	EM_XTENSA</span>

<span class="cp">#define ELF_EXEC_PAGESIZE	PAGE_SIZE</span>

<span class="cm">/*</span>
<span class="cm"> * This is the location that an ET_DYN program is loaded if exec&#39;ed.  Typical</span>
<span class="cm"> * use of this is to invoke &quot;./ld.so someprog&quot; to test out a new version of</span>
<span class="cm"> * the loader.  We need to make sure that it is out of the way of the program</span>
<span class="cm"> * that it will &quot;exec&quot;, and that there is sufficient room for the brk.</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_ET_DYN_BASE         (2 * TASK_SIZE / 3)</span>

<span class="cm">/*</span>
<span class="cm"> * This yields a mask that user programs can use to figure out what</span>
<span class="cm"> * instruction set this CPU supports.  This could be done in user space,</span>
<span class="cm"> * but it&#39;s not easy, and we&#39;ve already done it here.</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_HWCAP	(0)</span>

<span class="cm">/*</span>
<span class="cm"> * This yields a string that ld.so will use to load implementation</span>
<span class="cm"> * specific libraries for optimization.  This is more specific in</span>
<span class="cm"> * intent than poking at uname or /proc/cpuinfo.</span>
<span class="cm"> * For the moment, we have only optimizations for the Intel generations,</span>
<span class="cm"> * but that could change...</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_PLATFORM  (NULL)</span>

<span class="cm">/*</span>
<span class="cm"> * The Xtensa processor ABI says that when the program starts, a2</span>
<span class="cm"> * contains a pointer to a function which might be registered using</span>
<span class="cm"> * `atexit&#39;.  This provides a mean for the dynamic linker to call</span>
<span class="cm"> * DT_FINI functions for shared libraries that have been loaded before</span>
<span class="cm"> * the code runs.</span>
<span class="cm"> *</span>
<span class="cm"> * A value of 0 tells we have no such handler.</span>
<span class="cm"> *</span>
<span class="cm"> * We might as well make sure everything else is cleared too (except</span>
<span class="cm"> * for the stack pointer in a1), just to make things more</span>
<span class="cm"> * deterministic.  Also, clearing a0 terminates debugger backtraces.</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_PLAT_INIT(_r, load_addr) \</span>
<span class="cp">  do { _r-&gt;areg[0]=0; </span><span class="cm">/*_r-&gt;areg[1]=0;*/</span><span class="cp"> _r-&gt;areg[2]=0;  _r-&gt;areg[3]=0;  \</span>
<span class="cp">       _r-&gt;areg[4]=0;  _r-&gt;areg[5]=0;    _r-&gt;areg[6]=0;  _r-&gt;areg[7]=0;  \</span>
<span class="cp">       _r-&gt;areg[8]=0;  _r-&gt;areg[9]=0;    _r-&gt;areg[10]=0; _r-&gt;areg[11]=0; \</span>
<span class="cp">       _r-&gt;areg[12]=0; _r-&gt;areg[13]=0;   _r-&gt;areg[14]=0; _r-&gt;areg[15]=0; \</span>
<span class="cp">  } while (0)</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">xtregs_opt_t</span>	<span class="n">opt</span><span class="p">;</span>
	<span class="n">xtregs_user_t</span>	<span class="n">user</span><span class="p">;</span>
<span class="cp">#if XTENSA_HAVE_COPROCESSORS</span>
	<span class="n">xtregs_cp0_t</span>	<span class="n">cp0</span><span class="p">;</span>
	<span class="n">xtregs_cp1_t</span>	<span class="n">cp1</span><span class="p">;</span>
	<span class="n">xtregs_cp2_t</span>	<span class="n">cp2</span><span class="p">;</span>
	<span class="n">xtregs_cp3_t</span>	<span class="n">cp3</span><span class="p">;</span>
	<span class="n">xtregs_cp4_t</span>	<span class="n">cp4</span><span class="p">;</span>
	<span class="n">xtregs_cp5_t</span>	<span class="n">cp5</span><span class="p">;</span>
	<span class="n">xtregs_cp6_t</span>	<span class="n">cp6</span><span class="p">;</span>
	<span class="n">xtregs_cp7_t</span>	<span class="n">cp7</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">}</span> <span class="n">elf_xtregs_t</span><span class="p">;</span>

<span class="cp">#define SET_PERSONALITY(ex) set_personality(PER_LINUX_32BIT)</span>

<span class="k">struct</span> <span class="n">task_struct</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">do_copy_regs</span> <span class="p">(</span><span class="n">xtensa_gregset_t</span><span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pt_regs</span><span class="o">*</span><span class="p">,</span>
			  <span class="k">struct</span> <span class="n">task_struct</span><span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">do_restore_regs</span> <span class="p">(</span><span class="n">xtensa_gregset_t</span><span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pt_regs</span><span class="o">*</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">task_struct</span><span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">do_save_fpregs</span> <span class="p">(</span><span class="n">elf_fpregset_t</span><span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pt_regs</span><span class="o">*</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">task_struct</span><span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">do_restore_fpregs</span> <span class="p">(</span><span class="n">elf_fpregset_t</span><span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pt_regs</span><span class="o">*</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">task_struct</span><span class="o">*</span><span class="p">);</span>

<span class="cp">#endif	</span><span class="cm">/* _XTENSA_ELF_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
