<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › arm › mach-pxa › include › mach › idp.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>idp.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  arch/arm/mach-pxa/include/mach/idp.h</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2001 Cliff Brake, Accelent Systems Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * 2001-09-13: Cliff Brake &lt;cbrake@accelent.com&gt;</span>
<span class="cm"> *             Initial code</span>
<span class="cm"> *</span>
<span class="cm"> * 2005-02-15: Cliff Brake &lt;cliff.brake@gmail.com&gt;</span>
<span class="cm"> *             &lt;http://www.vibren.com&gt; &lt;http://bec-systems.com&gt;</span>
<span class="cm"> *             Changes for 2.6 kernel.</span>
<span class="cm"> */</span>


<span class="cm">/*</span>
<span class="cm"> * Note: this file must be safe to include in assembly files</span>
<span class="cm"> *</span>
<span class="cm"> * Support for the Vibren PXA255 IDP requires rev04 or later</span>
<span class="cm"> * IDP hardware.</span>
<span class="cm"> */</span>


<span class="cp">#define IDP_FLASH_PHYS		(PXA_CS0_PHYS)</span>
<span class="cp">#define IDP_ALT_FLASH_PHYS	(PXA_CS1_PHYS)</span>
<span class="cp">#define IDP_MEDIAQ_PHYS		(PXA_CS3_PHYS)</span>
<span class="cp">#define IDP_IDE_PHYS		(PXA_CS5_PHYS + 0x03000000)</span>
<span class="cp">#define IDP_ETH_PHYS		(PXA_CS5_PHYS + 0x03400000)</span>
<span class="cp">#define IDP_COREVOLT_PHYS	(PXA_CS5_PHYS + 0x03800000)</span>
<span class="cp">#define IDP_CPLD_PHYS		(PXA_CS5_PHYS + 0x03C00000)</span>


<span class="cm">/*</span>
<span class="cm"> * virtual memory map</span>
<span class="cm"> */</span>

<span class="cp">#define IDP_COREVOLT_VIRT	(0xf0000000)</span>
<span class="cp">#define IDP_COREVOLT_SIZE	(1*1024*1024)</span>

<span class="cp">#define IDP_CPLD_VIRT		(IDP_COREVOLT_VIRT + IDP_COREVOLT_SIZE)</span>
<span class="cp">#define IDP_CPLD_SIZE		(1*1024*1024)</span>

<span class="cp">#if (IDP_CPLD_VIRT + IDP_CPLD_SIZE) &gt; 0xfc000000</span>
<span class="cp">#error Your custom IO space is getting a bit large !!</span>
<span class="cp">#endif</span>

<span class="cp">#define CPLD_P2V(x)		((x) - IDP_CPLD_PHYS + IDP_CPLD_VIRT)</span>
<span class="cp">#define CPLD_V2P(x)		((x) - IDP_CPLD_VIRT + IDP_CPLD_PHYS)</span>

<span class="cp">#ifndef __ASSEMBLY__</span>
<span class="cp">#  define __CPLD_REG(x)		(*((volatile unsigned long *)CPLD_P2V(x)))</span>
<span class="cp">#else</span>
<span class="cp">#  define __CPLD_REG(x)		CPLD_P2V(x)</span>
<span class="cp">#endif</span>

<span class="cm">/* board level registers in the CPLD: (offsets from CPLD_VIRT) */</span>

<span class="cp">#define _IDP_CPLD_REV			(IDP_CPLD_PHYS + 0x00)</span>
<span class="cp">#define _IDP_CPLD_PERIPH_PWR		(IDP_CPLD_PHYS + 0x04)</span>
<span class="cp">#define _IDP_CPLD_LED_CONTROL		(IDP_CPLD_PHYS + 0x08)</span>
<span class="cp">#define _IDP_CPLD_KB_COL_HIGH		(IDP_CPLD_PHYS + 0x0C)</span>
<span class="cp">#define _IDP_CPLD_KB_COL_LOW		(IDP_CPLD_PHYS + 0x10)</span>
<span class="cp">#define _IDP_CPLD_PCCARD_EN		(IDP_CPLD_PHYS + 0x14)</span>
<span class="cp">#define _IDP_CPLD_GPIOH_DIR		(IDP_CPLD_PHYS + 0x18)</span>
<span class="cp">#define _IDP_CPLD_GPIOH_VALUE		(IDP_CPLD_PHYS + 0x1C)</span>
<span class="cp">#define _IDP_CPLD_GPIOL_DIR		(IDP_CPLD_PHYS + 0x20)</span>
<span class="cp">#define _IDP_CPLD_GPIOL_VALUE		(IDP_CPLD_PHYS + 0x24)</span>
<span class="cp">#define _IDP_CPLD_PCCARD_PWR		(IDP_CPLD_PHYS + 0x28)</span>
<span class="cp">#define _IDP_CPLD_MISC_CTRL		(IDP_CPLD_PHYS + 0x2C)</span>
<span class="cp">#define _IDP_CPLD_LCD			(IDP_CPLD_PHYS + 0x30)</span>
<span class="cp">#define _IDP_CPLD_FLASH_WE		(IDP_CPLD_PHYS + 0x34)</span>

<span class="cp">#define _IDP_CPLD_KB_ROW		(IDP_CPLD_PHYS + 0x50)</span>
<span class="cp">#define _IDP_CPLD_PCCARD0_STATUS	(IDP_CPLD_PHYS + 0x54)</span>
<span class="cp">#define _IDP_CPLD_PCCARD1_STATUS	(IDP_CPLD_PHYS + 0x58)</span>
<span class="cp">#define _IDP_CPLD_MISC_STATUS		(IDP_CPLD_PHYS + 0x5C)</span>

<span class="cm">/* FPGA register virtual addresses */</span>

<span class="cp">#define IDP_CPLD_REV			__CPLD_REG(_IDP_CPLD_REV)</span>
<span class="cp">#define IDP_CPLD_PERIPH_PWR		__CPLD_REG(_IDP_CPLD_PERIPH_PWR)</span>
<span class="cp">#define IDP_CPLD_LED_CONTROL		__CPLD_REG(_IDP_CPLD_LED_CONTROL)</span>
<span class="cp">#define IDP_CPLD_KB_COL_HIGH		__CPLD_REG(_IDP_CPLD_KB_COL_HIGH)</span>
<span class="cp">#define IDP_CPLD_KB_COL_LOW		__CPLD_REG(_IDP_CPLD_KB_COL_LOW)</span>
<span class="cp">#define IDP_CPLD_PCCARD_EN		__CPLD_REG(_IDP_CPLD_PCCARD_EN)</span>
<span class="cp">#define IDP_CPLD_GPIOH_DIR		__CPLD_REG(_IDP_CPLD_GPIOH_DIR)</span>
<span class="cp">#define IDP_CPLD_GPIOH_VALUE		__CPLD_REG(_IDP_CPLD_GPIOH_VALUE)</span>
<span class="cp">#define IDP_CPLD_GPIOL_DIR		__CPLD_REG(_IDP_CPLD_GPIOL_DIR)</span>
<span class="cp">#define IDP_CPLD_GPIOL_VALUE		__CPLD_REG(_IDP_CPLD_GPIOL_VALUE)</span>
<span class="cp">#define IDP_CPLD_PCCARD_PWR		__CPLD_REG(_IDP_CPLD_PCCARD_PWR)</span>
<span class="cp">#define IDP_CPLD_MISC_CTRL		__CPLD_REG(_IDP_CPLD_MISC_CTRL)</span>
<span class="cp">#define IDP_CPLD_LCD			__CPLD_REG(_IDP_CPLD_LCD)</span>
<span class="cp">#define IDP_CPLD_FLASH_WE		__CPLD_REG(_IDP_CPLD_FLASH_WE)</span>

<span class="cp">#define IDP_CPLD_KB_ROW		        __CPLD_REG(_IDP_CPLD_KB_ROW)</span>
<span class="cp">#define IDP_CPLD_PCCARD0_STATUS	        __CPLD_REG(_IDP_CPLD_PCCARD0_STATUS)</span>
<span class="cp">#define IDP_CPLD_PCCARD1_STATUS	        __CPLD_REG(_IDP_CPLD_PCCARD1_STATUS)</span>
<span class="cp">#define IDP_CPLD_MISC_STATUS		__CPLD_REG(_IDP_CPLD_MISC_STATUS)</span>


<span class="cm">/*</span>
<span class="cm"> * Bit masks for various registers</span>
<span class="cm"> */</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>IDP<em>CPLD</em>PCCARD_PWR</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define PCC0_PWR0	(1 &lt;&lt; 0)</span>
<span class="cp">#define PCC0_PWR1	(1 &lt;&lt; 1)</span>
<span class="cp">#define PCC0_PWR2	(1 &lt;&lt; 2)</span>
<span class="cp">#define PCC0_PWR3	(1 &lt;&lt; 3)</span>
<span class="cp">#define PCC1_PWR0	(1 &lt;&lt; 4)</span>
<span class="cp">#define PCC1_PWR1	(1 &lt;&lt; 5)</span>
<span class="cp">#define PCC1_PWR2	(1 &lt;&lt; 6)</span>
<span class="cp">#define PCC1_PWR3	(1 &lt;&lt; 7)</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>IDP<em>CPLD</em>PCCARD_EN</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define PCC0_RESET	(1 &lt;&lt; 6)</span>
<span class="cp">#define PCC1_RESET	(1 &lt;&lt; 7)</span>
<span class="cp">#define PCC0_ENABLE	(1 &lt;&lt; 0)</span>
<span class="cp">#define PCC1_ENABLE	(1 &lt;&lt; 1)</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>IDP<em>CPLD</em>PCCARDx_STATUS</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define _PCC_WRPROT	(1 &lt;&lt; 7) </span><span class="c1">// 7-4 read as low true</span>
<span class="cp">#define _PCC_RESET	(1 &lt;&lt; 6)</span>
<span class="cp">#define _PCC_IRQ	(1 &lt;&lt; 5)</span>
<span class="cp">#define _PCC_INPACK	(1 &lt;&lt; 4)</span>
<span class="cp">#define PCC_BVD2	(1 &lt;&lt; 3)</span>
<span class="cp">#define PCC_BVD1	(1 &lt;&lt; 2)</span>
<span class="cp">#define PCC_VS2		(1 &lt;&lt; 1)</span>
<span class="cp">#define PCC_VS1		(1 &lt;&lt; 0)</span>

<span class="cm">/* A listing of interrupts used by external hardware devices */</span>

<span class="cp">#define TOUCH_PANEL_IRQ			PXA_GPIO_TO_IRQ(5)</span>
<span class="cp">#define IDE_IRQ				PXA_GPIO_TO_IRQ(21)</span>

<span class="cp">#define TOUCH_PANEL_IRQ_EDGE		IRQ_TYPE_EDGE_FALLING</span>

<span class="cp">#define ETHERNET_IRQ			PXA_GPIO_TO_IRQ(4)</span>
<span class="cp">#define ETHERNET_IRQ_EDGE		IRQ_TYPE_EDGE_RISING</span>

<span class="cp">#define IDE_IRQ_EDGE			IRQ_TYPE_EDGE_RISING</span>

<span class="cp">#define PCMCIA_S0_CD_VALID		PXA_GPIO_TO_IRQ(7)</span>
<span class="cp">#define PCMCIA_S0_CD_VALID_EDGE		IRQ_TYPE_EDGE_BOTH</span>

<span class="cp">#define PCMCIA_S1_CD_VALID		PXA_GPIO_TO_IRQ(8)</span>
<span class="cp">#define PCMCIA_S1_CD_VALID_EDGE		IRQ_TYPE_EDGE_BOTH</span>

<span class="cp">#define PCMCIA_S0_RDYINT		PXA_GPIO_TO_IRQ(19)</span>
<span class="cp">#define PCMCIA_S1_RDYINT		PXA_GPIO_TO_IRQ(22)</span>


<span class="cm">/*</span>
<span class="cm"> * Macros for LED Driver</span>
<span class="cm"> */</span>

<span class="cm">/* leds 0 = ON */</span>
<span class="cp">#define IDP_HB_LED	(1&lt;&lt;5)</span>
<span class="cp">#define IDP_BUSY_LED	(1&lt;&lt;6)</span>

<span class="cp">#define IDP_LEDS_MASK	(IDP_HB_LED | IDP_BUSY_LED)</span>

<span class="cm">/*</span>
<span class="cm"> * macros for MTD driver</span>
<span class="cm"> */</span>

<span class="cp">#define FLASH_WRITE_PROTECT_DISABLE()	((IDP_CPLD_FLASH_WE) &amp;= ~(0x1))</span>
<span class="cp">#define FLASH_WRITE_PROTECT_ENABLE()	((IDP_CPLD_FLASH_WE) |= (0x1))</span>

<span class="cm">/*</span>
<span class="cm"> * macros for matrix keyboard driver</span>
<span class="cm"> */</span>

<span class="cp">#define KEYBD_MATRIX_NUMBER_INPUTS	7</span>
<span class="cp">#define KEYBD_MATRIX_NUMBER_OUTPUTS	14</span>

<span class="cp">#define KEYBD_MATRIX_INVERT_OUTPUT_LOGIC	FALSE</span>
<span class="cp">#define KEYBD_MATRIX_INVERT_INPUT_LOGIC		FALSE</span>

<span class="cp">#define KEYBD_MATRIX_SETTLING_TIME_US			100</span>
<span class="cp">#define KEYBD_MATRIX_KEYSTATE_DEBOUNCE_CONSTANT		2</span>

<span class="cp">#define KEYBD_MATRIX_SET_OUTPUTS(outputs) \</span>
<span class="cp">{\</span>
<span class="cp">	IDP_CPLD_KB_COL_LOW = outputs;\</span>
<span class="cp">	IDP_CPLD_KB_COL_HIGH = outputs &gt;&gt; 7;\</span>
<span class="cp">}</span>

<span class="cp">#define KEYBD_MATRIX_GET_INPUTS(inputs) \</span>
<span class="cp">{\</span>
<span class="cp">	inputs = (IDP_CPLD_KB_ROW &amp; 0x7f);\</span>
<span class="cp">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
