<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › arm › mach-pxa › include › mach › bitfield.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>bitfield.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *	FILE    	bitfield.h</span>
<span class="cm"> *</span>
<span class="cm"> *	Version 	1.1</span>
<span class="cm"> *	Author  	Copyright (c) Marc A. Viredaz, 1998</span>
<span class="cm"> *	        	DEC Western Research Laboratory, Palo Alto, CA</span>
<span class="cm"> *	Date    	April 1998 (April 1997)</span>
<span class="cm"> *	System  	Advanced RISC Machine (ARM)</span>
<span class="cm"> *	Language	C or ARM Assembly</span>
<span class="cm"> *	Purpose 	Definition of macros to operate on bit fields.</span>
<span class="cm"> */</span>



<span class="cp">#ifndef __BITFIELD_H</span>
<span class="cp">#define __BITFIELD_H</span>

<span class="cp">#ifndef __ASSEMBLY__</span>
<span class="cp">#define UData(Data)	((unsigned long) (Data))</span>
<span class="cp">#else</span>
<span class="cp">#define UData(Data)	(Data)</span>
<span class="cp">#endif</span>


<span class="cm">/*</span>
<span class="cm"> * MACRO: Fld</span>
<span class="cm"> *</span>
<span class="cm"> * Purpose</span>
<span class="cm"> *    The macro &quot;Fld&quot; encodes a bit field, given its size and its shift value</span>
<span class="cm"> *    with respect to bit 0.</span>
<span class="cm"> *</span>
<span class="cm"> * Note</span>
<span class="cm"> *    A more intuitive way to encode bit fields would have been to use their</span>
<span class="cm"> *    mask. However, extracting size and shift value information from a bit</span>
<span class="cm"> *    field&#39;s mask is cumbersome and might break the assembler (255-character</span>
<span class="cm"> *    line-size limit).</span>
<span class="cm"> *</span>
<span class="cm"> * Input</span>
<span class="cm"> *    Size      	Size of the bit field, in number of bits.</span>
<span class="cm"> *    Shft      	Shift value of the bit field with respect to bit 0.</span>
<span class="cm"> *</span>
<span class="cm"> * Output</span>
<span class="cm"> *    Fld       	Encoded bit field.</span>
<span class="cm"> */</span>

<span class="cp">#define Fld(Size, Shft)	(((Size) &lt;&lt; 16) + (Shft))</span>


<span class="cm">/*</span>
<span class="cm"> * MACROS: FSize, FShft, FMsk, FAlnMsk, F1stBit</span>
<span class="cm"> *</span>
<span class="cm"> * Purpose</span>
<span class="cm"> *    The macros &quot;FSize&quot;, &quot;FShft&quot;, &quot;FMsk&quot;, &quot;FAlnMsk&quot;, and &quot;F1stBit&quot; return</span>
<span class="cm"> *    the size, shift value, mask, aligned mask, and first bit of a</span>
<span class="cm"> *    bit field.</span>
<span class="cm"> *</span>
<span class="cm"> * Input</span>
<span class="cm"> *    Field     	Encoded bit field (using the macro &quot;Fld&quot;).</span>
<span class="cm"> *</span>
<span class="cm"> * Output</span>
<span class="cm"> *    FSize     	Size of the bit field, in number of bits.</span>
<span class="cm"> *    FShft     	Shift value of the bit field with respect to bit 0.</span>
<span class="cm"> *    FMsk      	Mask for the bit field.</span>
<span class="cm"> *    FAlnMsk   	Mask for the bit field, aligned on bit 0.</span>
<span class="cm"> *    F1stBit   	First bit of the bit field.</span>
<span class="cm"> */</span>

<span class="cp">#define FSize(Field)	((Field) &gt;&gt; 16)</span>
<span class="cp">#define FShft(Field)	((Field) &amp; 0x0000FFFF)</span>
<span class="cp">#define FMsk(Field)	(((UData (1) &lt;&lt; FSize (Field)) - 1) &lt;&lt; FShft (Field))</span>
<span class="cp">#define FAlnMsk(Field)	((UData (1) &lt;&lt; FSize (Field)) - 1)</span>
<span class="cp">#define F1stBit(Field)	(UData (1) &lt;&lt; FShft (Field))</span>


<span class="cm">/*</span>
<span class="cm"> * MACRO: FInsrt</span>
<span class="cm"> *</span>
<span class="cm"> * Purpose</span>
<span class="cm"> *    The macro &quot;FInsrt&quot; inserts a value into a bit field by shifting the</span>
<span class="cm"> *    former appropriately.</span>
<span class="cm"> *</span>
<span class="cm"> * Input</span>
<span class="cm"> *    Value     	Bit-field value.</span>
<span class="cm"> *    Field     	Encoded bit field (using the macro &quot;Fld&quot;).</span>
<span class="cm"> *</span>
<span class="cm"> * Output</span>
<span class="cm"> *    FInsrt    	Bit-field value positioned appropriately.</span>
<span class="cm"> */</span>

<span class="cp">#define FInsrt(Value, Field) \</span>
<span class="cp">                	(UData (Value) &lt;&lt; FShft (Field))</span>


<span class="cm">/*</span>
<span class="cm"> * MACRO: FExtr</span>
<span class="cm"> *</span>
<span class="cm"> * Purpose</span>
<span class="cm"> *    The macro &quot;FExtr&quot; extracts the value of a bit field by masking and</span>
<span class="cm"> *    shifting it appropriately.</span>
<span class="cm"> *</span>
<span class="cm"> * Input</span>
<span class="cm"> *    Data      	Data containing the bit-field to be extracted.</span>
<span class="cm"> *    Field     	Encoded bit field (using the macro &quot;Fld&quot;).</span>
<span class="cm"> *</span>
<span class="cm"> * Output</span>
<span class="cm"> *    FExtr     	Bit-field value.</span>
<span class="cm"> */</span>

<span class="cp">#define FExtr(Data, Field) \</span>
<span class="cp">                	((UData (Data) &gt;&gt; FShft (Field)) &amp; FAlnMsk (Field))</span>


<span class="cp">#endif </span><span class="cm">/* __BITFIELD_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
