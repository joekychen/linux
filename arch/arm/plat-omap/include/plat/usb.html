<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › arm › plat-omap › include › plat › usb.h
| include/asm-arm/mach-omap/usb.h
</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>usb.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div><p>include/asm-arm/mach-omap/usb.h</p></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef	__ASM_ARCH_OMAP_USB_H</span>
<span class="cp">#define	__ASM_ARCH_OMAP_USB_H</span>

<span class="cp">#include &lt;linux/io.h&gt;</span>
<span class="cp">#include &lt;linux/usb/musb.h&gt;</span>
<span class="cp">#include &lt;plat/board.h&gt;</span>

<span class="cp">#define OMAP3_HS_USB_PORTS	3</span>

<span class="k">enum</span> <span class="n">usbhs_omap_port_mode</span> <span class="p">{</span>
	<span class="n">OMAP_USBHS_PORT_MODE_UNUSED</span><span class="p">,</span>
	<span class="n">OMAP_EHCI_PORT_MODE_PHY</span><span class="p">,</span>
	<span class="n">OMAP_EHCI_PORT_MODE_TLL</span><span class="p">,</span>
	<span class="n">OMAP_EHCI_PORT_MODE_HSIC</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_PHY_6PIN_DATSE0</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_PHY_6PIN_DPDM</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_PHY_3PIN_DATSE0</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_PHY_4PIN_DPDM</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_TLL_6PIN_DATSE0</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_TLL_6PIN_DPDM</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_TLL_3PIN_DATSE0</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_TLL_4PIN_DPDM</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_TLL_2PIN_DATSE0</span><span class="p">,</span>
	<span class="n">OMAP_OHCI_PORT_MODE_TLL_2PIN_DPDM</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">usbhs_omap_board_data</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">usbhs_omap_port_mode</span>	<span class="n">port_mode</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>

	<span class="cm">/* have to be valid if phy_reset is true and portx is in phy mode */</span>
	<span class="kt">int</span>	<span class="n">reset_gpio_port</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>

	<span class="cm">/* Set this to true for ES2.x silicon */</span>
	<span class="kt">unsigned</span>			<span class="n">es2_compatibility</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="kt">unsigned</span>			<span class="n">phy_reset</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * Regulators for USB PHYs.</span>
<span class="cm">	 * Each PHY can have a separate regulator.</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">regulator</span>		<span class="o">*</span><span class="n">regulator</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ehci_hcd_omap_platform_data</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">usbhs_omap_port_mode</span>	<span class="n">port_mode</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>
	<span class="kt">int</span>				<span class="n">reset_gpio_port</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">regulator</span>		<span class="o">*</span><span class="n">regulator</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>
	<span class="kt">unsigned</span>			<span class="n">phy_reset</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ohci_hcd_omap_platform_data</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">usbhs_omap_port_mode</span>	<span class="n">port_mode</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>
	<span class="kt">unsigned</span>			<span class="n">es2_compatibility</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">usbhs_omap_platform_data</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">usbhs_omap_port_mode</span>		<span class="n">port_mode</span><span class="p">[</span><span class="n">OMAP3_HS_USB_PORTS</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">ehci_hcd_omap_platform_data</span>	<span class="o">*</span><span class="n">ehci_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ohci_hcd_omap_platform_data</span>	<span class="o">*</span><span class="n">ohci_data</span><span class="p">;</span>
<span class="p">};</span>
<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cp">#define OMAP1_OTG_BASE			0xfffb0400</span>
<span class="cp">#define OMAP1_UDC_BASE			0xfffb4000</span>
<span class="cp">#define OMAP1_OHCI_BASE			0xfffba000</span>

<span class="cp">#define OMAP2_OHCI_BASE			0x4805e000</span>
<span class="cp">#define OMAP2_UDC_BASE			0x4805e200</span>
<span class="cp">#define OMAP2_OTG_BASE			0x4805e300</span>

<span class="cp">#ifdef CONFIG_ARCH_OMAP1</span>

<span class="cp">#define OTG_BASE			OMAP1_OTG_BASE</span>
<span class="cp">#define UDC_BASE			OMAP1_UDC_BASE</span>
<span class="cp">#define OMAP_OHCI_BASE			OMAP1_OHCI_BASE</span>

<span class="cp">#else</span>

<span class="cp">#define OTG_BASE			OMAP2_OTG_BASE</span>
<span class="cp">#define UDC_BASE			OMAP2_UDC_BASE</span>
<span class="cp">#define OMAP_OHCI_BASE			OMAP2_OHCI_BASE</span>

<span class="k">struct</span> <span class="n">omap_musb_board_data</span> <span class="p">{</span>
	<span class="n">u8</span>	<span class="n">interface_type</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">power</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">extvbus</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">set_phy_power</span><span class="p">)(</span><span class="n">u8</span> <span class="n">on</span><span class="p">);</span>
	<span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">clear_irq</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">set_mode</span><span class="p">)(</span><span class="n">u8</span> <span class="n">mode</span><span class="p">);</span>
	<span class="kt">void</span>	<span class="p">(</span><span class="o">*</span><span class="n">reset</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">musb_interface</span>    <span class="p">{</span><span class="n">MUSB_INTERFACE_ULPI</span><span class="p">,</span> <span class="n">MUSB_INTERFACE_UTMI</span><span class="p">};</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">usb_musb_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">omap_musb_board_data</span> <span class="o">*</span><span class="n">board_data</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">usbhs_init</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">usbhs_omap_board_data</span> <span class="o">*</span><span class="n">pdata</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">omap4430_phy_power</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ID</span><span class="p">,</span> <span class="kt">int</span> <span class="n">on</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">omap4430_phy_set_clk</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">on</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">omap4430_phy_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">omap4430_phy_exit</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">omap4430_phy_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">suspend</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * NOTE: Please update omap USB drivers to use ioremap + read/write</span>
<span class="cm"> */</span>

<span class="cp">#define OMAP2_L4_IO_OFFSET	0xb2000000</span>
<span class="cp">#define OMAP2_L4_IO_ADDRESS(pa)	IOMEM((pa) + OMAP2_L4_IO_OFFSET)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="nf">omap_readb</span><span class="p">(</span><span class="n">u32</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__raw_readb</span><span class="p">(</span><span class="n">OMAP2_L4_IO_ADDRESS</span><span class="p">(</span><span class="n">pa</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u16</span> <span class="nf">omap_readw</span><span class="p">(</span><span class="n">u32</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__raw_readw</span><span class="p">(</span><span class="n">OMAP2_L4_IO_ADDRESS</span><span class="p">(</span><span class="n">pa</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">omap_readl</span><span class="p">(</span><span class="n">u32</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__raw_readl</span><span class="p">(</span><span class="n">OMAP2_L4_IO_ADDRESS</span><span class="p">(</span><span class="n">pa</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">omap_writeb</span><span class="p">(</span><span class="n">u8</span> <span class="n">v</span><span class="p">,</span> <span class="n">u32</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__raw_writeb</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">OMAP2_L4_IO_ADDRESS</span><span class="p">(</span><span class="n">pa</span><span class="p">));</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">omap_writew</span><span class="p">(</span><span class="n">u16</span> <span class="n">v</span><span class="p">,</span> <span class="n">u32</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__raw_writew</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">OMAP2_L4_IO_ADDRESS</span><span class="p">(</span><span class="n">pa</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">omap_writel</span><span class="p">(</span><span class="n">u32</span> <span class="n">v</span><span class="p">,</span> <span class="n">u32</span> <span class="n">pa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__raw_writel</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">OMAP2_L4_IO_ADDRESS</span><span class="p">(</span><span class="n">pa</span><span class="p">));</span>
<span class="p">}</span>

<span class="cp">#endif</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">am35x_musb_reset</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">am35x_musb_phy_power</span><span class="p">(</span><span class="n">u8</span> <span class="n">on</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">am35x_musb_clear_irq</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">am35x_set_mode</span><span class="p">(</span><span class="n">u8</span> <span class="n">musb_mode</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ti81xx_musb_phy_power</span><span class="p">(</span><span class="n">u8</span> <span class="n">on</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * FIXME correct answer depends on hmc_mode,</span>
<span class="cm"> * as does (on omap1) any nonzero value for config-&gt;otg port number</span>
<span class="cm"> */</span>
<span class="cp">#ifdef	CONFIG_USB_GADGET_OMAP</span>
<span class="cp">#define	is_usb0_device(config)	1</span>
<span class="cp">#else</span>
<span class="cp">#define	is_usb0_device(config)	0</span>
<span class="cp">#endif</span>

<span class="kt">void</span> <span class="n">omap_otg_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">omap_usb_config</span> <span class="o">*</span><span class="n">config</span><span class="p">);</span>

<span class="cp">#if defined(CONFIG_USB) || defined(CONFIG_USB_MODULE)</span>
<span class="kt">void</span> <span class="n">omap1_usb_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">omap_usb_config</span> <span class="o">*</span><span class="n">pdata</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">omap1_usb_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">omap_usb_config</span> <span class="o">*</span><span class="n">pdata</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP_OTG) || defined(CONFIG_ARCH_OMAP_OTG_MODULE)</span>
<span class="kt">void</span> <span class="n">omap2_usbfs_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">omap_usb_config</span> <span class="o">*</span><span class="n">pdata</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">omap2_usbfs_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">omap_usb_config</span> <span class="o">*</span><span class="n">pdata</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * OTG and transceiver registers, for OMAPs starting with ARM926</span>
<span class="cm"> */</span>
<span class="cp">#define OTG_REV				(OTG_BASE + 0x00)</span>
<span class="cp">#define OTG_SYSCON_1			(OTG_BASE + 0x04)</span>
<span class="cp">#	define	 USB2_TRX_MODE(w)	(((w)&gt;&gt;24)&amp;0x07)</span>
<span class="cp">#	define	 USB1_TRX_MODE(w)	(((w)&gt;&gt;20)&amp;0x07)</span>
<span class="cp">#	define	 USB0_TRX_MODE(w)	(((w)&gt;&gt;16)&amp;0x07)</span>
<span class="cp">#	define	 OTG_IDLE_EN		(1 &lt;&lt; 15)</span>
<span class="cp">#	define	 HST_IDLE_EN		(1 &lt;&lt; 14)</span>
<span class="cp">#	define	 DEV_IDLE_EN		(1 &lt;&lt; 13)</span>
<span class="cp">#	define	 OTG_RESET_DONE		(1 &lt;&lt; 2)</span>
<span class="cp">#	define	 OTG_SOFT_RESET		(1 &lt;&lt; 1)</span>
<span class="cp">#define OTG_SYSCON_2			(OTG_BASE + 0x08)</span>
<span class="cp">#	define	 OTG_EN			(1 &lt;&lt; 31)</span>
<span class="cp">#	define	 USBX_SYNCHRO		(1 &lt;&lt; 30)</span>
<span class="cp">#	define	 OTG_MST16		(1 &lt;&lt; 29)</span>
<span class="cp">#	define	 SRP_GPDATA		(1 &lt;&lt; 28)</span>
<span class="cp">#	define	 SRP_GPDVBUS		(1 &lt;&lt; 27)</span>
<span class="cp">#	define	 SRP_GPUVBUS(w)		(((w)&gt;&gt;24)&amp;0x07)</span>
<span class="cp">#	define	 A_WAIT_VRISE(w)	(((w)&gt;&gt;20)&amp;0x07)</span>
<span class="cp">#	define	 B_ASE_BRST(w)		(((w)&gt;&gt;16)&amp;0x07)</span>
<span class="cp">#	define	 SRP_DPW		(1 &lt;&lt; 14)</span>
<span class="cp">#	define	 SRP_DATA		(1 &lt;&lt; 13)</span>
<span class="cp">#	define	 SRP_VBUS		(1 &lt;&lt; 12)</span>
<span class="cp">#	define	 OTG_PADEN		(1 &lt;&lt; 10)</span>
<span class="cp">#	define	 HMC_PADEN		(1 &lt;&lt; 9)</span>
<span class="cp">#	define	 UHOST_EN		(1 &lt;&lt; 8)</span>
<span class="cp">#	define	 HMC_TLLSPEED		(1 &lt;&lt; 7)</span>
<span class="cp">#	define	 HMC_TLLATTACH		(1 &lt;&lt; 6)</span>
<span class="cp">#	define	 OTG_HMC(w)		(((w)&gt;&gt;0)&amp;0x3f)</span>
<span class="cp">#define OTG_CTRL			(OTG_BASE + 0x0c)</span>
<span class="cp">#	define	 OTG_USB2_EN		(1 &lt;&lt; 29)</span>
<span class="cp">#	define	 OTG_USB2_DP		(1 &lt;&lt; 28)</span>
<span class="cp">#	define	 OTG_USB2_DM		(1 &lt;&lt; 27)</span>
<span class="cp">#	define	 OTG_USB1_EN		(1 &lt;&lt; 26)</span>
<span class="cp">#	define	 OTG_USB1_DP		(1 &lt;&lt; 25)</span>
<span class="cp">#	define	 OTG_USB1_DM		(1 &lt;&lt; 24)</span>
<span class="cp">#	define	 OTG_USB0_EN		(1 &lt;&lt; 23)</span>
<span class="cp">#	define	 OTG_USB0_DP		(1 &lt;&lt; 22)</span>
<span class="cp">#	define	 OTG_USB0_DM		(1 &lt;&lt; 21)</span>
<span class="cp">#	define	 OTG_ASESSVLD		(1 &lt;&lt; 20)</span>
<span class="cp">#	define	 OTG_BSESSEND		(1 &lt;&lt; 19)</span>
<span class="cp">#	define	 OTG_BSESSVLD		(1 &lt;&lt; 18)</span>
<span class="cp">#	define	 OTG_VBUSVLD		(1 &lt;&lt; 17)</span>
<span class="cp">#	define	 OTG_ID			(1 &lt;&lt; 16)</span>
<span class="cp">#	define	 OTG_DRIVER_SEL		(1 &lt;&lt; 15)</span>
<span class="cp">#	define	 OTG_A_SETB_HNPEN	(1 &lt;&lt; 12)</span>
<span class="cp">#	define	 OTG_A_BUSREQ		(1 &lt;&lt; 11)</span>
<span class="cp">#	define	 OTG_B_HNPEN		(1 &lt;&lt; 9)</span>
<span class="cp">#	define	 OTG_B_BUSREQ		(1 &lt;&lt; 8)</span>
<span class="cp">#	define	 OTG_BUSDROP		(1 &lt;&lt; 7)</span>
<span class="cp">#	define	 OTG_PULLDOWN		(1 &lt;&lt; 5)</span>
<span class="cp">#	define	 OTG_PULLUP		(1 &lt;&lt; 4)</span>
<span class="cp">#	define	 OTG_DRV_VBUS		(1 &lt;&lt; 3)</span>
<span class="cp">#	define	 OTG_PD_VBUS		(1 &lt;&lt; 2)</span>
<span class="cp">#	define	 OTG_PU_VBUS		(1 &lt;&lt; 1)</span>
<span class="cp">#	define	 OTG_PU_ID		(1 &lt;&lt; 0)</span>
<span class="cp">#define OTG_IRQ_EN			(OTG_BASE + 0x10)	</span><span class="cm">/* 16-bit */</span><span class="cp"></span>
<span class="cp">#	define	 DRIVER_SWITCH		(1 &lt;&lt; 15)</span>
<span class="cp">#	define	 A_VBUS_ERR		(1 &lt;&lt; 13)</span>
<span class="cp">#	define	 A_REQ_TMROUT		(1 &lt;&lt; 12)</span>
<span class="cp">#	define	 A_SRP_DETECT		(1 &lt;&lt; 11)</span>
<span class="cp">#	define	 B_HNP_FAIL		(1 &lt;&lt; 10)</span>
<span class="cp">#	define	 B_SRP_TMROUT		(1 &lt;&lt; 9)</span>
<span class="cp">#	define	 B_SRP_DONE		(1 &lt;&lt; 8)</span>
<span class="cp">#	define	 B_SRP_STARTED		(1 &lt;&lt; 7)</span>
<span class="cp">#	define	 OPRT_CHG		(1 &lt;&lt; 0)</span>
<span class="cp">#define OTG_IRQ_SRC			(OTG_BASE + 0x14)	</span><span class="cm">/* 16-bit */</span><span class="cp"></span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>same bits as in IRQ_EN</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define OTG_OUTCTRL			(OTG_BASE + 0x18)	</span><span class="cm">/* 16-bit */</span><span class="cp"></span>
<span class="cp">#	define	 OTGVPD			(1 &lt;&lt; 14)</span>
<span class="cp">#	define	 OTGVPU			(1 &lt;&lt; 13)</span>
<span class="cp">#	define	 OTGPUID		(1 &lt;&lt; 12)</span>
<span class="cp">#	define	 USB2VDR		(1 &lt;&lt; 10)</span>
<span class="cp">#	define	 USB2PDEN		(1 &lt;&lt; 9)</span>
<span class="cp">#	define	 USB2PUEN		(1 &lt;&lt; 8)</span>
<span class="cp">#	define	 USB1VDR		(1 &lt;&lt; 6)</span>
<span class="cp">#	define	 USB1PDEN		(1 &lt;&lt; 5)</span>
<span class="cp">#	define	 USB1PUEN		(1 &lt;&lt; 4)</span>
<span class="cp">#	define	 USB0VDR		(1 &lt;&lt; 2)</span>
<span class="cp">#	define	 USB0PDEN		(1 &lt;&lt; 1)</span>
<span class="cp">#	define	 USB0PUEN		(1 &lt;&lt; 0)</span>
<span class="cp">#define OTG_TEST			(OTG_BASE + 0x20)	</span><span class="cm">/* 16-bit */</span><span class="cp"></span>
<span class="cp">#define OTG_VENDOR_CODE			(OTG_BASE + 0xfc)	</span><span class="cm">/* 16-bit */</span><span class="cp"></span>

<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cm">/* OMAP1 */</span>
<span class="cp">#define	USB_TRANSCEIVER_CTRL		(0xfffe1000 + 0x0064)</span>
<span class="cp">#	define	CONF_USB2_UNI_R		(1 &lt;&lt; 8)</span>
<span class="cp">#	define	CONF_USB1_UNI_R		(1 &lt;&lt; 7)</span>
<span class="cp">#	define	CONF_USB_PORT0_R(x)	(((x)&gt;&gt;4)&amp;0x7)</span>
<span class="cp">#	define	CONF_USB0_ISOLATE_R	(1 &lt;&lt; 3)</span>
<span class="cp">#	define	CONF_USB_PWRDN_DM_R	(1 &lt;&lt; 2)</span>
<span class="cp">#	define	CONF_USB_PWRDN_DP_R	(1 &lt;&lt; 1)</span>

<span class="cm">/* OMAP2 */</span>
<span class="cp">#	define	USB_UNIDIR			0x0</span>
<span class="cp">#	define	USB_UNIDIR_TLL			0x1</span>
<span class="cp">#	define	USB_BIDIR			0x2</span>
<span class="cp">#	define	USB_BIDIR_TLL			0x3</span>
<span class="cp">#	define	USBTXWRMODEI(port, x)	((x) &lt;&lt; (22 - (port * 2)))</span>
<span class="cp">#	define	USBT2TLL5PI		(1 &lt;&lt; 17)</span>
<span class="cp">#	define	USB0PUENACTLOI		(1 &lt;&lt; 16)</span>
<span class="cp">#	define	USBSTANDBYCTRL		(1 &lt;&lt; 15)</span>
<span class="cm">/* AM35x */</span>
<span class="cm">/* USB 2.0 PHY Control */</span>
<span class="cp">#define CONF2_PHY_GPIOMODE	(1 &lt;&lt; 23)</span>
<span class="cp">#define CONF2_OTGMODE		(3 &lt;&lt; 14)</span>
<span class="cp">#define CONF2_NO_OVERRIDE	(0 &lt;&lt; 14)</span>
<span class="cp">#define CONF2_FORCE_HOST	(1 &lt;&lt; 14)</span>
<span class="cp">#define CONF2_FORCE_DEVICE	(2 &lt;&lt; 14)</span>
<span class="cp">#define CONF2_FORCE_HOST_VBUS_LOW (3 &lt;&lt; 14)</span>
<span class="cp">#define CONF2_SESENDEN		(1 &lt;&lt; 13)</span>
<span class="cp">#define CONF2_VBDTCTEN		(1 &lt;&lt; 12)</span>
<span class="cp">#define CONF2_REFFREQ_24MHZ	(2 &lt;&lt; 8)</span>
<span class="cp">#define CONF2_REFFREQ_26MHZ	(7 &lt;&lt; 8)</span>
<span class="cp">#define CONF2_REFFREQ_13MHZ	(6 &lt;&lt; 8)</span>
<span class="cp">#define CONF2_REFFREQ		(0xf &lt;&lt; 8)</span>
<span class="cp">#define CONF2_PHYCLKGD		(1 &lt;&lt; 7)</span>
<span class="cp">#define CONF2_VBUSSENSE		(1 &lt;&lt; 6)</span>
<span class="cp">#define CONF2_PHY_PLLON		(1 &lt;&lt; 5)</span>
<span class="cp">#define CONF2_RESET		(1 &lt;&lt; 4)</span>
<span class="cp">#define CONF2_PHYPWRDN		(1 &lt;&lt; 3)</span>
<span class="cp">#define CONF2_OTGPWRDN		(1 &lt;&lt; 2)</span>
<span class="cp">#define CONF2_DATPOL		(1 &lt;&lt; 1)</span>

<span class="cm">/* TI81XX specific definitions */</span>
<span class="cp">#define USBCTRL0	0x620</span>
<span class="cp">#define USBSTAT0	0x624</span>

<span class="cm">/* TI816X PHY controls bits */</span>
<span class="cp">#define TI816X_USBPHY0_NORMAL_MODE	(1 &lt;&lt; 0)</span>
<span class="cp">#define TI816X_USBPHY_REFCLK_OSC	(1 &lt;&lt; 8)</span>

<span class="cm">/* TI814X PHY controls bits */</span>
<span class="cp">#define USBPHY_CM_PWRDN		(1 &lt;&lt; 0)</span>
<span class="cp">#define USBPHY_OTG_PWRDN	(1 &lt;&lt; 1)</span>
<span class="cp">#define USBPHY_CHGDET_DIS	(1 &lt;&lt; 2)</span>
<span class="cp">#define USBPHY_CHGDET_RSTRT	(1 &lt;&lt; 3)</span>
<span class="cp">#define USBPHY_SRCONDM		(1 &lt;&lt; 4)</span>
<span class="cp">#define USBPHY_SINKONDP		(1 &lt;&lt; 5)</span>
<span class="cp">#define USBPHY_CHGISINK_EN	(1 &lt;&lt; 6)</span>
<span class="cp">#define USBPHY_CHGVSRC_EN	(1 &lt;&lt; 7)</span>
<span class="cp">#define USBPHY_DMPULLUP		(1 &lt;&lt; 8)</span>
<span class="cp">#define USBPHY_DPPULLUP		(1 &lt;&lt; 9)</span>
<span class="cp">#define USBPHY_CDET_EXTCTL	(1 &lt;&lt; 10)</span>
<span class="cp">#define USBPHY_GPIO_MODE	(1 &lt;&lt; 12)</span>
<span class="cp">#define USBPHY_DPOPBUFCTL	(1 &lt;&lt; 13)</span>
<span class="cp">#define USBPHY_DMOPBUFCTL	(1 &lt;&lt; 14)</span>
<span class="cp">#define USBPHY_DPINPUT		(1 &lt;&lt; 15)</span>
<span class="cp">#define USBPHY_DMINPUT		(1 &lt;&lt; 16)</span>
<span class="cp">#define USBPHY_DPGPIO_PD	(1 &lt;&lt; 17)</span>
<span class="cp">#define USBPHY_DMGPIO_PD	(1 &lt;&lt; 18)</span>
<span class="cp">#define USBPHY_OTGVDET_EN	(1 &lt;&lt; 19)</span>
<span class="cp">#define USBPHY_OTGSESSEND_EN	(1 &lt;&lt; 20)</span>
<span class="cp">#define USBPHY_DATA_POLARITY	(1 &lt;&lt; 23)</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP1) &amp;&amp; defined(CONFIG_USB)</span>
<span class="n">u32</span> <span class="n">omap1_usb0_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">nwires</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">is_device</span><span class="p">);</span>
<span class="n">u32</span> <span class="n">omap1_usb1_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">nwires</span><span class="p">);</span>
<span class="n">u32</span> <span class="n">omap1_usb2_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">nwires</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">alt_pingroup</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">omap1_usb0_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">nwires</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">is_device</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">omap1_usb1_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">nwires</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">omap1_usb2_init</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">nwires</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">alt_pingroup</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cp">#endif	</span><span class="cm">/* __ASM_ARCH_OMAP_USB_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
