<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › arm › plat-omap › include › plat › cpu.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>cpu.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * arch/arm/plat-omap/include/mach/cpu.h</span>
<span class="cm"> *</span>
<span class="cm"> * OMAP cpu type detection</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2004, 2008 Nokia Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2009-11 Texas Instruments.</span>
<span class="cm"> *</span>
<span class="cm"> * Written by Tony Lindgren &lt;tony.lindgren@nokia.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Added OMAP4 specific defines - Santosh Shilimkar&lt;santosh.shilimkar@ti.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __ASM_ARCH_OMAP_CPU_H</span>
<span class="cp">#define __ASM_ARCH_OMAP_CPU_H</span>

<span class="cp">#include &lt;linux/bitops.h&gt;</span>
<span class="cp">#include &lt;plat/multi.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Omap device type i.e. EMU/HS/TST/GP/BAD</span>
<span class="cm"> */</span>
<span class="cp">#define OMAP2_DEVICE_TYPE_TEST		0</span>
<span class="cp">#define OMAP2_DEVICE_TYPE_EMU		1</span>
<span class="cp">#define OMAP2_DEVICE_TYPE_SEC		2</span>
<span class="cp">#define OMAP2_DEVICE_TYPE_GP		3</span>
<span class="cp">#define OMAP2_DEVICE_TYPE_BAD		4</span>

<span class="kt">int</span> <span class="n">omap_type</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * omap_rev bits:</span>
<span class="cm"> * CPU id bits	(0730, 1510, 1710, 2422...)	[31:16]</span>
<span class="cm"> * CPU revision	(See _REV_ defined in cpu.h)	[15:08]</span>
<span class="cm"> * CPU class bits (15xx, 16xx, 24xx, 34xx...)	[07:00]</span>
<span class="cm"> */</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">omap_rev</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Get the CPU revision for OMAP devices</span>
<span class="cm"> */</span>
<span class="cp">#define GET_OMAP_REVISION()	((omap_rev() &gt;&gt; 8) &amp; 0xff)</span>

<span class="cm">/*</span>
<span class="cm"> * Macros to group OMAP into cpu classes.</span>
<span class="cm"> * These can be used in most places.</span>
<span class="cm"> * cpu_is_omap7xx():	True for OMAP730, OMAP850</span>
<span class="cm"> * cpu_is_omap15xx():	True for OMAP1510, OMAP5910 and OMAP310</span>
<span class="cm"> * cpu_is_omap16xx():	True for OMAP1610, OMAP5912 and OMAP1710</span>
<span class="cm"> * cpu_is_omap24xx():	True for OMAP2420, OMAP2422, OMAP2423, OMAP2430</span>
<span class="cm"> * cpu_is_omap242x():	True for OMAP2420, OMAP2422, OMAP2423</span>
<span class="cm"> * cpu_is_omap243x():	True for OMAP2430</span>
<span class="cm"> * cpu_is_omap343x():	True for OMAP3430</span>
<span class="cm"> * cpu_is_omap443x():	True for OMAP4430</span>
<span class="cm"> * cpu_is_omap446x():	True for OMAP4460</span>
<span class="cm"> * cpu_is_omap447x():	True for OMAP4470</span>
<span class="cm"> */</span>
<span class="cp">#define GET_OMAP_CLASS	(omap_rev() &amp; 0xff)</span>

<span class="cp">#define IS_OMAP_CLASS(class, id)			\</span>
<span class="cp">static inline int is_omap ##class (void)		\</span>
<span class="cp">{							\</span>
<span class="cp">	return (GET_OMAP_CLASS == (id)) ? 1 : 0;	\</span>
<span class="cp">}</span>

<span class="cp">#define GET_AM_CLASS	((omap_rev() &gt;&gt; 24) &amp; 0xff)</span>

<span class="cp">#define IS_AM_CLASS(class, id)				\</span>
<span class="cp">static inline int is_am ##class (void)			\</span>
<span class="cp">{							\</span>
<span class="cp">	return (GET_AM_CLASS == (id)) ? 1 : 0;		\</span>
<span class="cp">}</span>

<span class="cp">#define GET_TI_CLASS	((omap_rev() &gt;&gt; 24) &amp; 0xff)</span>

<span class="cp">#define IS_TI_CLASS(class, id)			\</span>
<span class="cp">static inline int is_ti ##class (void)		\</span>
<span class="cp">{							\</span>
<span class="cp">	return (GET_TI_CLASS == (id)) ? 1 : 0;	\</span>
<span class="cp">}</span>

<span class="cp">#define GET_OMAP_SUBCLASS	((omap_rev() &gt;&gt; 20) &amp; 0x0fff)</span>

<span class="cp">#define IS_OMAP_SUBCLASS(subclass, id)			\</span>
<span class="cp">static inline int is_omap ##subclass (void)		\</span>
<span class="cp">{							\</span>
<span class="cp">	return (GET_OMAP_SUBCLASS == (id)) ? 1 : 0;	\</span>
<span class="cp">}</span>

<span class="cp">#define IS_TI_SUBCLASS(subclass, id)			\</span>
<span class="cp">static inline int is_ti ##subclass (void)		\</span>
<span class="cp">{							\</span>
<span class="cp">	return (GET_OMAP_SUBCLASS == (id)) ? 1 : 0;	\</span>
<span class="cp">}</span>

<span class="cp">#define IS_AM_SUBCLASS(subclass, id)			\</span>
<span class="cp">static inline int is_am ##subclass (void)		\</span>
<span class="cp">{							\</span>
<span class="cp">	return (GET_OMAP_SUBCLASS == (id)) ? 1 : 0;	\</span>
<span class="cp">}</span>

<span class="n">IS_OMAP_CLASS</span><span class="p">(</span><span class="mi">7</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">)</span>
<span class="n">IS_OMAP_CLASS</span><span class="p">(</span><span class="mi">15</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">)</span>
<span class="n">IS_OMAP_CLASS</span><span class="p">(</span><span class="mi">16</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">)</span>
<span class="n">IS_OMAP_CLASS</span><span class="p">(</span><span class="mi">24</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">)</span>
<span class="n">IS_OMAP_CLASS</span><span class="p">(</span><span class="mi">34</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">)</span>
<span class="n">IS_OMAP_CLASS</span><span class="p">(</span><span class="mi">44</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">)</span>
<span class="n">IS_AM_CLASS</span><span class="p">(</span><span class="mi">35</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">)</span>
<span class="n">IS_AM_CLASS</span><span class="p">(</span><span class="mi">33</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">)</span>

<span class="n">IS_TI_CLASS</span><span class="p">(</span><span class="mi">81</span><span class="n">xx</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">)</span>

<span class="n">IS_OMAP_SUBCLASS</span><span class="p">(</span><span class="mi">242</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x242</span><span class="p">)</span>
<span class="n">IS_OMAP_SUBCLASS</span><span class="p">(</span><span class="mi">243</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x243</span><span class="p">)</span>
<span class="n">IS_OMAP_SUBCLASS</span><span class="p">(</span><span class="mi">343</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x343</span><span class="p">)</span>
<span class="n">IS_OMAP_SUBCLASS</span><span class="p">(</span><span class="mi">363</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x363</span><span class="p">)</span>
<span class="n">IS_OMAP_SUBCLASS</span><span class="p">(</span><span class="mi">443</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x443</span><span class="p">)</span>
<span class="n">IS_OMAP_SUBCLASS</span><span class="p">(</span><span class="mi">446</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x446</span><span class="p">)</span>
<span class="n">IS_OMAP_SUBCLASS</span><span class="p">(</span><span class="mi">447</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x447</span><span class="p">)</span>

<span class="n">IS_TI_SUBCLASS</span><span class="p">(</span><span class="mi">816</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x816</span><span class="p">)</span>
<span class="n">IS_TI_SUBCLASS</span><span class="p">(</span><span class="mi">814</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x814</span><span class="p">)</span>
<span class="n">IS_AM_SUBCLASS</span><span class="p">(</span><span class="mi">335</span><span class="n">x</span><span class="p">,</span> <span class="mh">0x335</span><span class="p">)</span>

<span class="cp">#define cpu_is_omap7xx()		0</span>
<span class="cp">#define cpu_is_omap15xx()		0</span>
<span class="cp">#define cpu_is_omap16xx()		0</span>
<span class="cp">#define cpu_is_omap24xx()		0</span>
<span class="cp">#define cpu_is_omap242x()		0</span>
<span class="cp">#define cpu_is_omap243x()		0</span>
<span class="cp">#define cpu_is_omap34xx()		0</span>
<span class="cp">#define cpu_is_omap343x()		0</span>
<span class="cp">#define cpu_is_ti81xx()			0</span>
<span class="cp">#define cpu_is_ti816x()			0</span>
<span class="cp">#define cpu_is_ti814x()			0</span>
<span class="cp">#define soc_is_am35xx()			0</span>
<span class="cp">#define cpu_is_am33xx()			0</span>
<span class="cp">#define cpu_is_am335x()			0</span>
<span class="cp">#define cpu_is_omap44xx()		0</span>
<span class="cp">#define cpu_is_omap443x()		0</span>
<span class="cp">#define cpu_is_omap446x()		0</span>
<span class="cp">#define cpu_is_omap447x()		0</span>

<span class="cp">#if defined(MULTI_OMAP1)</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP730)</span>
<span class="cp">#  undef  cpu_is_omap7xx</span>
<span class="cp">#  define cpu_is_omap7xx()		is_omap7xx()</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP850)</span>
<span class="cp">#  undef  cpu_is_omap7xx</span>
<span class="cp">#  define cpu_is_omap7xx()		is_omap7xx()</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP15XX)</span>
<span class="cp">#  undef  cpu_is_omap15xx</span>
<span class="cp">#  define cpu_is_omap15xx()		is_omap15xx()</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP16XX)</span>
<span class="cp">#  undef  cpu_is_omap16xx</span>
<span class="cp">#  define cpu_is_omap16xx()		is_omap16xx()</span>
<span class="cp"># endif</span>
<span class="cp">#else</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP730)</span>
<span class="cp">#  undef  cpu_is_omap7xx</span>
<span class="cp">#  define cpu_is_omap7xx()		1</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP850)</span>
<span class="cp">#  undef  cpu_is_omap7xx</span>
<span class="cp">#  define cpu_is_omap7xx()		1</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP15XX)</span>
<span class="cp">#  undef  cpu_is_omap15xx</span>
<span class="cp">#  define cpu_is_omap15xx()		1</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP16XX)</span>
<span class="cp">#  undef  cpu_is_omap16xx</span>
<span class="cp">#  define cpu_is_omap16xx()		1</span>
<span class="cp"># endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(MULTI_OMAP2)</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP2)</span>
<span class="cp">#  undef  cpu_is_omap24xx</span>
<span class="cp">#  define cpu_is_omap24xx()		is_omap24xx()</span>
<span class="cp"># endif</span>
<span class="cp"># if defined (CONFIG_SOC_OMAP2420)</span>
<span class="cp">#  undef  cpu_is_omap242x</span>
<span class="cp">#  define cpu_is_omap242x()		is_omap242x()</span>
<span class="cp"># endif</span>
<span class="cp"># if defined (CONFIG_SOC_OMAP2430)</span>
<span class="cp">#  undef  cpu_is_omap243x</span>
<span class="cp">#  define cpu_is_omap243x()		is_omap243x()</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP3)</span>
<span class="cp">#  undef  cpu_is_omap34xx</span>
<span class="cp">#  undef  cpu_is_omap343x</span>
<span class="cp">#  define cpu_is_omap34xx()		is_omap34xx()</span>
<span class="cp">#  define cpu_is_omap343x()		is_omap343x()</span>
<span class="cp"># endif</span>
<span class="cp">#else</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP2)</span>
<span class="cp">#  undef  cpu_is_omap24xx</span>
<span class="cp">#  define cpu_is_omap24xx()		1</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_SOC_OMAP2420)</span>
<span class="cp">#  undef  cpu_is_omap242x</span>
<span class="cp">#  define cpu_is_omap242x()		1</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_SOC_OMAP2430)</span>
<span class="cp">#  undef  cpu_is_omap243x</span>
<span class="cp">#  define cpu_is_omap243x()		1</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_ARCH_OMAP3)</span>
<span class="cp">#  undef  cpu_is_omap34xx</span>
<span class="cp">#  define cpu_is_omap34xx()		1</span>
<span class="cp"># endif</span>
<span class="cp"># if defined(CONFIG_SOC_OMAP3430)</span>
<span class="cp">#  undef  cpu_is_omap343x</span>
<span class="cp">#  define cpu_is_omap343x()		1</span>
<span class="cp"># endif</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * Macros to detect individual cpu types.</span>
<span class="cm"> * These are only rarely needed.</span>
<span class="cm"> * cpu_is_omap330():	True for OMAP330</span>
<span class="cm"> * cpu_is_omap730():	True for OMAP730</span>
<span class="cm"> * cpu_is_omap850():	True for OMAP850</span>
<span class="cm"> * cpu_is_omap1510():	True for OMAP1510</span>
<span class="cm"> * cpu_is_omap1610():	True for OMAP1610</span>
<span class="cm"> * cpu_is_omap1611():	True for OMAP1611</span>
<span class="cm"> * cpu_is_omap5912():	True for OMAP5912</span>
<span class="cm"> * cpu_is_omap1621():	True for OMAP1621</span>
<span class="cm"> * cpu_is_omap1710():	True for OMAP1710</span>
<span class="cm"> * cpu_is_omap2420():	True for OMAP2420</span>
<span class="cm"> * cpu_is_omap2422():	True for OMAP2422</span>
<span class="cm"> * cpu_is_omap2423():	True for OMAP2423</span>
<span class="cm"> * cpu_is_omap2430():	True for OMAP2430</span>
<span class="cm"> * cpu_is_omap3430():	True for OMAP3430</span>
<span class="cm"> */</span>
<span class="cp">#define GET_OMAP_TYPE	((omap_rev() &gt;&gt; 16) &amp; 0xffff)</span>

<span class="cp">#define IS_OMAP_TYPE(type, id)				\</span>
<span class="cp">static inline int is_omap ##type (void)			\</span>
<span class="cp">{							\</span>
<span class="cp">	return (GET_OMAP_TYPE == (id)) ? 1 : 0;		\</span>
<span class="cp">}</span>

<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">310</span><span class="p">,</span> <span class="mh">0x0310</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">730</span><span class="p">,</span> <span class="mh">0x0730</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">850</span><span class="p">,</span> <span class="mh">0x0850</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">1510</span><span class="p">,</span> <span class="mh">0x1510</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">1610</span><span class="p">,</span> <span class="mh">0x1610</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">1611</span><span class="p">,</span> <span class="mh">0x1611</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">5912</span><span class="p">,</span> <span class="mh">0x1611</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">1621</span><span class="p">,</span> <span class="mh">0x1621</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">1710</span><span class="p">,</span> <span class="mh">0x1710</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">2420</span><span class="p">,</span> <span class="mh">0x2420</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">2422</span><span class="p">,</span> <span class="mh">0x2422</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">2423</span><span class="p">,</span> <span class="mh">0x2423</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">2430</span><span class="p">,</span> <span class="mh">0x2430</span><span class="p">)</span>
<span class="n">IS_OMAP_TYPE</span><span class="p">(</span><span class="mi">3430</span><span class="p">,</span> <span class="mh">0x3430</span><span class="p">)</span>

<span class="cp">#define cpu_is_omap310()		0</span>
<span class="cp">#define cpu_is_omap730()		0</span>
<span class="cp">#define cpu_is_omap850()		0</span>
<span class="cp">#define cpu_is_omap1510()		0</span>
<span class="cp">#define cpu_is_omap1610()		0</span>
<span class="cp">#define cpu_is_omap5912()		0</span>
<span class="cp">#define cpu_is_omap1611()		0</span>
<span class="cp">#define cpu_is_omap1621()		0</span>
<span class="cp">#define cpu_is_omap1710()		0</span>
<span class="cp">#define cpu_is_omap2420()		0</span>
<span class="cp">#define cpu_is_omap2422()		0</span>
<span class="cp">#define cpu_is_omap2423()		0</span>
<span class="cp">#define cpu_is_omap2430()		0</span>
<span class="cp">#define cpu_is_omap3430()		0</span>
<span class="cp">#define cpu_is_omap3630()		0</span>

<span class="cm">/*</span>
<span class="cm"> * Whether we have MULTI_OMAP1 or not, we still need to distinguish</span>
<span class="cm"> * between 730 vs 850, 330 vs. 1510 and 1611B/5912 vs. 1710.</span>
<span class="cm"> */</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP730)</span>
<span class="cp"># undef  cpu_is_omap730</span>
<span class="cp"># define cpu_is_omap730()		is_omap730()</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP850)</span>
<span class="cp"># undef  cpu_is_omap850</span>
<span class="cp"># define cpu_is_omap850()		is_omap850()</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP15XX)</span>
<span class="cp"># undef  cpu_is_omap310</span>
<span class="cp"># undef  cpu_is_omap1510</span>
<span class="cp"># define cpu_is_omap310()		is_omap310()</span>
<span class="cp"># define cpu_is_omap1510()		is_omap1510()</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP16XX)</span>
<span class="cp"># undef  cpu_is_omap1610</span>
<span class="cp"># undef  cpu_is_omap1611</span>
<span class="cp"># undef  cpu_is_omap5912</span>
<span class="cp"># undef  cpu_is_omap1621</span>
<span class="cp"># undef  cpu_is_omap1710</span>
<span class="cp"># define cpu_is_omap1610()		is_omap1610()</span>
<span class="cp"># define cpu_is_omap1611()		is_omap1611()</span>
<span class="cp"># define cpu_is_omap5912()		is_omap5912()</span>
<span class="cp"># define cpu_is_omap1621()		is_omap1621()</span>
<span class="cp"># define cpu_is_omap1710()		is_omap1710()</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP2)</span>
<span class="cp"># undef  cpu_is_omap2420</span>
<span class="cp"># undef  cpu_is_omap2422</span>
<span class="cp"># undef  cpu_is_omap2423</span>
<span class="cp"># undef  cpu_is_omap2430</span>
<span class="cp"># define cpu_is_omap2420()		is_omap2420()</span>
<span class="cp"># define cpu_is_omap2422()		is_omap2422()</span>
<span class="cp"># define cpu_is_omap2423()		is_omap2423()</span>
<span class="cp"># define cpu_is_omap2430()		is_omap2430()</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_ARCH_OMAP3)</span>
<span class="cp"># undef cpu_is_omap3430</span>
<span class="cp"># undef cpu_is_ti81xx</span>
<span class="cp"># undef cpu_is_ti816x</span>
<span class="cp"># undef cpu_is_ti814x</span>
<span class="cp"># undef soc_is_am35xx</span>
<span class="cp"># undef cpu_is_am33xx</span>
<span class="cp"># undef cpu_is_am335x</span>
<span class="cp"># define cpu_is_omap3430()		is_omap3430()</span>
<span class="cp"># undef cpu_is_omap3630</span>
<span class="cp"># define cpu_is_omap3630()		is_omap363x()</span>
<span class="cp"># define cpu_is_ti81xx()		is_ti81xx()</span>
<span class="cp"># define cpu_is_ti816x()		is_ti816x()</span>
<span class="cp"># define cpu_is_ti814x()		is_ti814x()</span>
<span class="cp"># define soc_is_am35xx()		is_am35xx()</span>
<span class="cp"># define cpu_is_am33xx()		is_am33xx()</span>
<span class="cp"># define cpu_is_am335x()		is_am335x()</span>
<span class="cp">#endif</span>

<span class="cp"># if defined(CONFIG_ARCH_OMAP4)</span>
<span class="cp"># undef cpu_is_omap44xx</span>
<span class="cp"># undef cpu_is_omap443x</span>
<span class="cp"># undef cpu_is_omap446x</span>
<span class="cp"># undef cpu_is_omap447x</span>
<span class="cp"># define cpu_is_omap44xx()		is_omap44xx()</span>
<span class="cp"># define cpu_is_omap443x()		is_omap443x()</span>
<span class="cp"># define cpu_is_omap446x()		is_omap446x()</span>
<span class="cp"># define cpu_is_omap447x()		is_omap447x()</span>
<span class="cp"># endif</span>

<span class="cm">/* Macros to detect if we have OMAP1 or OMAP2 */</span>
<span class="cp">#define cpu_class_is_omap1()	(cpu_is_omap7xx() || cpu_is_omap15xx() || \</span>
<span class="cp">				cpu_is_omap16xx())</span>
<span class="cp">#define cpu_class_is_omap2()	(cpu_is_omap24xx() || cpu_is_omap34xx() || \</span>
<span class="cp">				cpu_is_omap44xx())</span>

<span class="cm">/* Various silicon revisions for omap2 */</span>
<span class="cp">#define OMAP242X_CLASS		0x24200024</span>
<span class="cp">#define OMAP2420_REV_ES1_0	OMAP242X_CLASS</span>
<span class="cp">#define OMAP2420_REV_ES2_0	(OMAP242X_CLASS | (0x1 &lt;&lt; 8))</span>

<span class="cp">#define OMAP243X_CLASS		0x24300024</span>
<span class="cp">#define OMAP2430_REV_ES1_0	OMAP243X_CLASS</span>

<span class="cp">#define OMAP343X_CLASS		0x34300034</span>
<span class="cp">#define OMAP3430_REV_ES1_0	OMAP343X_CLASS</span>
<span class="cp">#define OMAP3430_REV_ES2_0	(OMAP343X_CLASS | (0x1 &lt;&lt; 8))</span>
<span class="cp">#define OMAP3430_REV_ES2_1	(OMAP343X_CLASS | (0x2 &lt;&lt; 8))</span>
<span class="cp">#define OMAP3430_REV_ES3_0	(OMAP343X_CLASS | (0x3 &lt;&lt; 8))</span>
<span class="cp">#define OMAP3430_REV_ES3_1	(OMAP343X_CLASS | (0x4 &lt;&lt; 8))</span>
<span class="cp">#define OMAP3430_REV_ES3_1_2	(OMAP343X_CLASS | (0x5 &lt;&lt; 8))</span>

<span class="cp">#define OMAP363X_CLASS		0x36300034</span>
<span class="cp">#define OMAP3630_REV_ES1_0	OMAP363X_CLASS</span>
<span class="cp">#define OMAP3630_REV_ES1_1	(OMAP363X_CLASS | (0x1 &lt;&lt; 8))</span>
<span class="cp">#define OMAP3630_REV_ES1_2	(OMAP363X_CLASS | (0x2 &lt;&lt; 8))</span>

<span class="cp">#define TI816X_CLASS		0x81600034</span>
<span class="cp">#define TI8168_REV_ES1_0	TI816X_CLASS</span>
<span class="cp">#define TI8168_REV_ES1_1	(TI816X_CLASS | (0x1 &lt;&lt; 8))</span>

<span class="cp">#define TI814X_CLASS		0x81400034</span>
<span class="cp">#define TI8148_REV_ES1_0	TI814X_CLASS</span>
<span class="cp">#define TI8148_REV_ES2_0	(TI814X_CLASS | (0x1 &lt;&lt; 8))</span>
<span class="cp">#define TI8148_REV_ES2_1	(TI814X_CLASS | (0x2 &lt;&lt; 8))</span>

<span class="cp">#define AM35XX_CLASS		0x35170034</span>
<span class="cp">#define AM35XX_REV_ES1_0	AM35XX_CLASS</span>
<span class="cp">#define AM35XX_REV_ES1_1	(AM35XX_CLASS | (0x1 &lt;&lt; 8))</span>

<span class="cp">#define AM335X_CLASS		0x33500034</span>
<span class="cp">#define AM335X_REV_ES1_0	AM335X_CLASS</span>

<span class="cp">#define OMAP443X_CLASS		0x44300044</span>
<span class="cp">#define OMAP4430_REV_ES1_0	(OMAP443X_CLASS | (0x10 &lt;&lt; 8))</span>
<span class="cp">#define OMAP4430_REV_ES2_0	(OMAP443X_CLASS | (0x20 &lt;&lt; 8))</span>
<span class="cp">#define OMAP4430_REV_ES2_1	(OMAP443X_CLASS | (0x21 &lt;&lt; 8))</span>
<span class="cp">#define OMAP4430_REV_ES2_2	(OMAP443X_CLASS | (0x22 &lt;&lt; 8))</span>
<span class="cp">#define OMAP4430_REV_ES2_3	(OMAP443X_CLASS | (0x23 &lt;&lt; 8))</span>

<span class="cp">#define OMAP446X_CLASS		0x44600044</span>
<span class="cp">#define OMAP4460_REV_ES1_0	(OMAP446X_CLASS | (0x10 &lt;&lt; 8))</span>
<span class="cp">#define OMAP4460_REV_ES1_1	(OMAP446X_CLASS | (0x11 &lt;&lt; 8))</span>

<span class="cp">#define OMAP447X_CLASS		0x44700044</span>
<span class="cp">#define OMAP4470_REV_ES1_0	(OMAP447X_CLASS | (0x10 &lt;&lt; 8))</span>

<span class="kt">void</span> <span class="n">omap2xxx_check_revision</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">omap3xxx_check_revision</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">omap4xxx_check_revision</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">omap3xxx_check_features</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ti81xx_check_features</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">omap4xxx_check_features</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Runtime detection of OMAP3 features</span>
<span class="cm"> *</span>
<span class="cm"> * OMAP3_HAS_IO_CHAIN_CTRL: Some later members of the OMAP3 chip</span>
<span class="cm"> *    family have OS-level control over the I/O chain clock.  This is</span>
<span class="cm"> *    to avoid a window during which wakeups could potentially be lost</span>
<span class="cm"> *    during powerdomain transitions.  If this bit is set, it</span>
<span class="cm"> *    indicates that the chip does support OS-level control of this</span>
<span class="cm"> *    feature.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">omap_features</span><span class="p">;</span>

<span class="cp">#define OMAP3_HAS_L2CACHE		BIT(0)</span>
<span class="cp">#define OMAP3_HAS_IVA			BIT(1)</span>
<span class="cp">#define OMAP3_HAS_SGX			BIT(2)</span>
<span class="cp">#define OMAP3_HAS_NEON			BIT(3)</span>
<span class="cp">#define OMAP3_HAS_ISP			BIT(4)</span>
<span class="cp">#define OMAP3_HAS_192MHZ_CLK		BIT(5)</span>
<span class="cp">#define OMAP3_HAS_IO_WAKEUP		BIT(6)</span>
<span class="cp">#define OMAP3_HAS_SDRC			BIT(7)</span>
<span class="cp">#define OMAP3_HAS_IO_CHAIN_CTRL		BIT(8)</span>
<span class="cp">#define OMAP4_HAS_MPU_1GHZ		BIT(9)</span>
<span class="cp">#define OMAP4_HAS_MPU_1_2GHZ		BIT(10)</span>
<span class="cp">#define OMAP4_HAS_MPU_1_5GHZ		BIT(11)</span>


<span class="cp">#define OMAP3_HAS_FEATURE(feat,flag)			\</span>
<span class="cp">static inline unsigned int omap3_has_ ##feat(void)	\</span>
<span class="cp">{							\</span>
<span class="cp">	return omap_features &amp; OMAP3_HAS_ ##flag;	\</span>
<span class="cp">}							\</span>

<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">l2cache</span><span class="p">,</span> <span class="n">L2CACHE</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">sgx</span><span class="p">,</span> <span class="n">SGX</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">iva</span><span class="p">,</span> <span class="n">IVA</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">neon</span><span class="p">,</span> <span class="n">NEON</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">isp</span><span class="p">,</span> <span class="n">ISP</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="mi">192</span><span class="n">mhz_clk</span><span class="p">,</span> <span class="mi">192</span><span class="n">MHZ_CLK</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">io_wakeup</span><span class="p">,</span> <span class="n">IO_WAKEUP</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">sdrc</span><span class="p">,</span> <span class="n">SDRC</span><span class="p">)</span>
<span class="n">OMAP3_HAS_FEATURE</span><span class="p">(</span><span class="n">io_chain_ctrl</span><span class="p">,</span> <span class="n">IO_CHAIN_CTRL</span><span class="p">)</span>

<span class="cm">/*</span>
<span class="cm"> * Runtime detection of OMAP4 features</span>
<span class="cm"> */</span>
<span class="cp">#define OMAP4_HAS_FEATURE(feat, flag)			\</span>
<span class="cp">static inline unsigned int omap4_has_ ##feat(void)	\</span>
<span class="cp">{							\</span>
<span class="cp">	return omap_features &amp; OMAP4_HAS_ ##flag;	\</span>
<span class="cp">}							\</span>

<span class="n">OMAP4_HAS_FEATURE</span><span class="p">(</span><span class="n">mpu_1ghz</span><span class="p">,</span> <span class="n">MPU_1GHZ</span><span class="p">)</span>
<span class="n">OMAP4_HAS_FEATURE</span><span class="p">(</span><span class="n">mpu_1_2ghz</span><span class="p">,</span> <span class="n">MPU_1_2GHZ</span><span class="p">)</span>
<span class="n">OMAP4_HAS_FEATURE</span><span class="p">(</span><span class="n">mpu_1_5ghz</span><span class="p">,</span> <span class="n">MPU_1_5GHZ</span><span class="p">)</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
