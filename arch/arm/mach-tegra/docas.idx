f | board-harmony-pinmux.c | s | 7.8K | 151 | Stephen Warren | swarren@nvidia.com | 1334766399 |  | ARM: tegra: Switch to new pinctrl driver  * Rename old pinmux and new pinctrl platform driver and DT match table   entries, so the new driver gets instantiated. * Re-write board-pinmux.c, so that it uses pinctrl APIs to configura the   pinmux. * Re-write board-*-pinmux.c so that the pinmux configuration tables are   in pinctrl format.  Ventana's pin mux table needed some edits on top of the basic format conversion, since some mux options that were previously marked as reserved are now valid in the new pinctrl driver. Attempting to use the old reserved names will result in a failure. Specifically, groups lpw0, lpw2, lsc1, lsck, and lsda were changed from function rsvd4 to displaya, and group pta was changed from function rsvd2 to hdmi.  All boards' pin mux tables needed some edits on top of the based format conversion, since function i2c was split into i2c1 (first general I2C controller) and i2cp (power I2C controller) to better align function definitions with HW blocks.  Due to the split of mux tables into pure mux and pull/tristate tables, many entries in the separate Seaboard/Ventana tables could be merged into the common table, since the entries differed only in the portion in one of the tables, not both.  Most pin groups allow configuration of mux, tri-state, and pull. However, some don't allow pull configuration, which is instead configured by new groups that only allow pull configuration. This is a reflection of the true HW capabilities, which weren't fully represented by the old pinmux driver. This required adding new pull table entries for those new groups, and setting many other entries' pull configuration to TEGRA_PINCONFIG_DONT_SET.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Olof Johansson <olof@lixom.net>
f | usb_phy.c | s | 20K | 685 | Stephen Warren | swarren@nvidia.com | 1335388929 |  | ARM: tegra: add USB ULPI PHY reset GPIO to device tree  ULPI PHYs have a reset signal, and different boards use a different GPIO for this task. Add a property to device tree to represent this.  I'm not sure if adding this property to the EHCI controller node is entirely correct; perhaps eventually we should have explicit separate nodes for the various PHYs. However, we don't have that right now, so this binding seems like a reasonable choice.  Cc: <devicetree-discuss@lists.ozlabs.org> Cc: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Cc: <linux-usb@vger.kernel.org> Signed-off-by: Stephen Warren <swarren@nvidia.com>
f | board-paz00.h | s | 1.1K | 32 | Marc Dietrich | marvin24@gmx.de | 1328581970 |  | ARM: tegra: paz00: fix wrong SD1 power gpio  The power gpio for the external memory card was specified wrongly. Replace it with the correct value (tested with warmboot with fastboot).  Signed-off-by: Marc Dietrich <marvin24@gmx.de> Acked-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | board-harmony.h | s | 1.4K | 35 | Stephen Warren | swarren@nvidia.com | 1317079253 |  | ARM: 7101/1: arm/tegra: Replace <mach/gpio.h> with <mach/gpio-tegra.h>  This will eventually allow <mach/gpio.h> to be deleted. This mirrors LinusW's recent equivalent work on various other ARM platforms.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Olof Johansson <olof@lixom.net> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | common.c | s | 3.9K | 135 | Linus Torvalds | torvalds@linux-foundation.org | 1338063241 |  | 
f | Makefile | g | 2.0K |  | Stephen Warren | swarren@nvidia.com | 1334766399 |  | ARM: tegra: Remove pre-pinctrl pinmux driver  The pinctrl driver is now active and used by all boards. Remove the old pinmux driver.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Olof Johansson <olof@lixom.net>
f | reset.h | s | 1.4K | 41 | Peter De Schrijver | pdeschrijver@nvidia.com | 1330296284 |  | ARM: tegra: rework Tegra secondary CPU core bringup  Prepare the Tegra secondary CPU core bringup code for other Tegra variants. The reset handler is also generalized to allow for future introduction of powersaving modes which turn off the CPU cores.  Based on work by:  Scott Williams <scwilliams@nvidia.com> Chris Johnson <cwj@nvidia.com> Colin Cross <ccross@android.com>  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | pmc.c | s | 1.9K | 65 | Stephen Warren | swarren@nvidia.com | 1328581501 |  | ARM: tegra: Add a simple PMC driver  This PMC driver is enough to parse the nvidia,invert-interrupt property from device tree, and configure the PMC's to honor that.  In the future, this file could expand to centralize all other PMC accesses within the mach-tegra code.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | board-trimslice.c | s | 4.5K | 156 | Linus Torvalds | torvalds@linux-foundation.org | 1338063241 |  | 
f | devices.c | s | 14K | 637 | Linus Torvalds | torvalds@linux-foundation.org | 1338060147 |  | 
f | tegra2_emc.c | s | 7.8K | 293 | Stephen Warren | swarren@nvidia.com | 1328581501 |  | ARM: tegra: Fix EMC pdata initialization from registers  Commit d91eeb0 "ARM: tegra: emc: device tree support" modified the EMC driver to create an EMC table from existing register settings when none was provided through platform data or device tree. This code wrote the wrong clock rate into the table; the actual rate in Hz, rather than the expected half-rate in KHz. This caused the BUG_ON in tegra2_emc_clk_round_rate() to fire, since that enormous rate could not be generated.  Fixes:  [    2.425921] kernel BUG at arch/arm/mach-tegra/tegra2_clocks.c:1158! ... [    2.618766] [<c001c0e8>] (tegra2_emc_clk_round_rate+0x58/0x70) from [<c00198b4>] (clk_round_rate+0x48/0x68) [    2.628494] [<c00198b4>] (clk_round_rate+0x48/0x68) from [<c0019cc0>] (clk_set_rate_locked+0x40/0x68) [    2.637707] [<c0019cc0>] (clk_set_rate_locked+0x40/0x68) from [<c0019d10>] (clk_set_rate+0x28/0x40) [    2.646754] [<c0019d10>] (clk_set_rate+0x28/0x40) from [<c001ffc8>] (tegra_update_cpu_speed+0x54/0x144) [    2.656144] [<c001ffc8>] (tegra_update_cpu_speed+0x54/0x144) from [<c002016c>] (tegra_target+0xb4/0xe0) [    2.665538] [<c002016c>] (tegra_target+0xb4/0xe0) from [<c01a96c0>] (__cpufreq_driver_target+0x88/0xa4) [    2.674931] [<c01a96c0>] (__cpufreq_driver_target+0x88/0xa4) from [<c01ac9d0>] (dbs_check_cpu+0x324/0x340) [    2.684582] [<c01ac9d0>] (dbs_check_cpu+0x324/0x340) from [<c01aca40>] (do_dbs_timer+0x54/0xf4) [    2.693277] [<c01aca40>] (do_dbs_timer+0x54/0xf4) from [<c00369a8>] (process_one_work+0x1d4/0x320) [    2.702225] [<c00369a8>] (process_one_work+0x1d4/0x320) from [<c0036f34>] (worker_thread+0x134/0x230) [    2.711437] [<c0036f34>] (worker_thread+0x134/0x230) from [<c003add0>] (kthread+0x80/0x8c) [    2.719700] [<c003add0>] (kthread+0x80/0x8c) from [<c000ebf4>] (kernel_thread_exit+0x0/0x8)  Reported-by: Marc Dietrich <marvin24@gmx.de> Signed-off-by: Stephen Warren <swarren@nvidia.com> [olof: fixed calculation of printed values] Signed-off-by: Olof Johansson <olof@lixom.net>
f | apbio.h | s | 1019B | 32 | Olof Johansson | olof@lixom.net | 1328581498 |  | ARM: tegra: use APB DMA for accessing APB devices  Tegra2 hangs if APB registers are accessed from the cpu during an apb dma operation. The workaround is to use apb dma to read/write the registers instead.  There is a dependency loop between fuses, clocks, and APBDMA.  If dma is enabled, fuse reads must go through APBDMA to avoid corruption due to a hw bug.  APBDMA requires a clock to be enabled.  Clocks must read a fuse to determine allowable cpu frequencies.  Separate out the fuse DMA initialization, and allow the fuse read and write functions to be called without using DMA before the DMA initialization has been completed.  Access to the fuses before APBDMA is initialized won't hit the hardware bug because nothing else can be using DMA.  Original fuse registar access code from Varun Wadekar <vwadekar@nvidia.com>, improved by Colin Cross <ccross@android.com> and later moved to separate driver by Jon Mayo <jmayo@nvidia.com>.  Major refactoring/cleanup by Olof Johansson <olof@lixom.net>.  Changes since v1:  * fix 'return false' on error condition * dequeue dma ops in case of timeout  From: Jon Mayo <jmayo@nvidia.com>. Signed-off-by: Jon Mayo <jmayo@nvidia.com>. Signed-off-by: Olof Johansson <olof@lixom.net> Acked-by: Stephen Warren <swarren@nvidia.com>
f | fuse.h | s | 1.2K | 44 | Peter De Schrijver | pdeschrijver@nvidia.com | 1330296259 |  | ARM: tegra: export Tegra chipid  The powergating and reset handling code needs to differentiate between Tegra variants. Therefore we export the chipid here.  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | reset.c | s | 2.1K | 69 | Stephen Warren | swarren@nvidia.com | 1340062977 |  | ARM: tegra: make tegra_cpu_reset_handler_enable() __init  This solves a section mismatch warning. I hadn't noticed this before, because my compiler was inlining tegra_cpu_reset_handler_enable() inside tegra_cpu_reset_handler_init(), which is already __init, but I switched compilers and it stopped doing that.  Cc: <stable@kernel.org> # v3.4 Signed-off-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | hotplug.c | s | 2.5K | 113 | Russell King | rmk+kernel@arm.linux.org.uk | 1332955801 |  | ARM: move CP15 definitions to separate header file  Avoid namespace conflicts with drivers over the CP15 definitions by moving CP15 related prototypes and definitions to a private header file.  Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> [Tegra] Acked-by: H Hartley Sweeten <hsweeten@visionengravers.com> Tested-by: H Hartley Sweeten <hsweeten@visionengravers.com> [EP93xx] Acked-by: Nicolas Pitre <nico@linaro.org> Acked-by: Kukjin Kim <kgene.kim@samsung.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk> Signed-off-by: David Howells <dhowells@redhat.com>
f | cpuidle.c | s | 2.5K | 89 | Peter De Schrijver | pdeschrijver@nvidia.com | 1328548576 |  | ARM: tegra: cpuidle driver for tegra  CPUidle driver for tegra. In this version only LP3 (clockgating) is supported.  Based on work by:  Colin Cross <ccross@android.com> Gary King <gking@nvidia.com>  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Acked-by: Colin Cross <ccross@android.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | board-dt-tegra20.c | s | 3.9K | 105 | Linus Torvalds | torvalds@linux-foundation.org | 1338063241 |  | 
d | include |  | 1 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1338060147 |  | 
f | board-paz00-pinmux.c | s | 7.8K | 151 | Stephen Warren | swarren@nvidia.com | 1334766399 |  | ARM: tegra: Switch to new pinctrl driver  * Rename old pinmux and new pinctrl platform driver and DT match table   entries, so the new driver gets instantiated. * Re-write board-pinmux.c, so that it uses pinctrl APIs to configura the   pinmux. * Re-write board-*-pinmux.c so that the pinmux configuration tables are   in pinctrl format.  Ventana's pin mux table needed some edits on top of the basic format conversion, since some mux options that were previously marked as reserved are now valid in the new pinctrl driver. Attempting to use the old reserved names will result in a failure. Specifically, groups lpw0, lpw2, lsc1, lsck, and lsda were changed from function rsvd4 to displaya, and group pta was changed from function rsvd2 to hdmi.  All boards' pin mux tables needed some edits on top of the based format conversion, since function i2c was split into i2c1 (first general I2C controller) and i2cp (power I2C controller) to better align function definitions with HW blocks.  Due to the split of mux tables into pure mux and pull/tristate tables, many entries in the separate Seaboard/Ventana tables could be merged into the common table, since the entries differed only in the portion in one of the tables, not both.  Most pin groups allow configuration of mux, tri-state, and pull. However, some don't allow pull configuration, which is instead configured by new groups that only allow pull configuration. This is a reflection of the true HW capabilities, which weren't fully represented by the old pinmux driver. This required adding new pull table entries for those new groups, and setting many other entries' pull configuration to TEGRA_PINCONFIG_DONT_SET.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Olof Johansson <olof@lixom.net>
f | dma.c | s | 20K | 684 | Laxman Dewangan | ldewangan@nvidia.com | 1328581501 |  | ARM: tegra: dma: not required to move requestor when stopping.  It is not require to move the requestor of dma to INVALID option before stopping dma.  Signed-off-by: Laxman Dewangan <ldewangan@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | fuse.c | s | 3.2K | 108 | Linus Torvalds | torvalds@linux-foundation.org | 1332962680 |  | 
f | flowctrl.h | s | 1.4K | 38 | Peter De Schrijver | pdeschrijver@nvidia.com | 1330296282 |  | ARM: tegra: functions to access the flowcontroller  Introduce some functions to write to the flowcontroller registers. The flowcontroller controls CPU sleepstates and wakeup.  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | clock.c | s | 13K | 543 | Shawn Guo | shawn.guo@linaro.org | 1336480596 |  | ARM: tegra: use machine specific hook for late init  Cc: Colin Cross <ccross@android.com> Cc: Olof Johansson <olof@lixom.net> Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org>
f | board-trimslice.h | s | 952B | 24 | Stephen Warren | swarren@nvidia.com | 1317079253 |  | ARM: 7101/1: arm/tegra: Replace <mach/gpio.h> with <mach/gpio-tegra.h>  This will eventually allow <mach/gpio.h> to be deleted. This mirrors LinusW's recent equivalent work on various other ARM platforms.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Olof Johansson <olof@lixom.net> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | clock.h | s | 3.8K | 151 | Peter De Schrijver | pdeschrijver@nvidia.com | 1328548575 |  | ARM: tegra: enable tegra30 clock framework  Add init calls for clocks on tegra30.  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | board.h | s | 1.4K | 42 | Shawn Guo | shawn.guo@linaro.org | 1336480596 |  | ARM: tegra: use machine specific hook for late init  Cc: Colin Cross <ccross@android.com> Cc: Olof Johansson <olof@lixom.net> Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org>
f | board-harmony-pcie.c | s | 1.5K | 52 | Stephen Warren | swarren@nvidia.com | 1324346590 |  | arm/tegra: Harmony PCIe: Don't touch pinmux  The Harmony pinmux table is already set up to mux the PCIe signals onto the appropriate pin groups. Don't manually fiddle with the pinmux in the Harmony PCIe setup code.  Merge note: This will have a merge conflict with Peter De Schrijver's "arm/tegra: prepare pinmux code for multiple tegra variants" due to context. When merging the two, make sure to also remove the include of <mach/pinmux-tegra20.h> that his patch added, since it's no longer needed after this patch.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | gpio-names.h | s | 6.7K | 244 | Erik Gilling | konkers@android.com | 1281045422 |  | [ARM] tegra: add GPIO support  v2: fixes from Mike Rapoport: 	- move gpio-names.h to arch/arm/mach-tegra     fixes from Russell King 	- include linux/io.h and linux/gpio.h instead of asm/io.h 	  and asm/gpio.h     additional changes:     	- add macros to convert between irq and gpio numbers for platform data 	- change for_each_bit to for_each_set_bit in gpio.c v3: 	- minor bugfixes  Signed-off-by: Colin Cross <ccross@android.com> Signed-off-by: Erik Gilling <konkers@android.com>
f | board-harmony.c | s | 4.9K | 172 | Linus Torvalds | torvalds@linux-foundation.org | 1338063241 |  | 
f | board-trimslice-pinmux.c | s | 7.9K | 151 | Stephen Warren | swarren@nvidia.com | 1334766399 |  | ARM: tegra: Switch to new pinctrl driver  * Rename old pinmux and new pinctrl platform driver and DT match table   entries, so the new driver gets instantiated. * Re-write board-pinmux.c, so that it uses pinctrl APIs to configura the   pinmux. * Re-write board-*-pinmux.c so that the pinmux configuration tables are   in pinctrl format.  Ventana's pin mux table needed some edits on top of the basic format conversion, since some mux options that were previously marked as reserved are now valid in the new pinctrl driver. Attempting to use the old reserved names will result in a failure. Specifically, groups lpw0, lpw2, lsc1, lsck, and lsda were changed from function rsvd4 to displaya, and group pta was changed from function rsvd2 to hdmi.  All boards' pin mux tables needed some edits on top of the based format conversion, since function i2c was split into i2c1 (first general I2C controller) and i2cp (power I2C controller) to better align function definitions with HW blocks.  Due to the split of mux tables into pure mux and pull/tristate tables, many entries in the separate Seaboard/Ventana tables could be merged into the common table, since the entries differed only in the portion in one of the tables, not both.  Most pin groups allow configuration of mux, tri-state, and pull. However, some don't allow pull configuration, which is instead configured by new groups that only allow pull configuration. This is a reflection of the true HW capabilities, which weren't fully represented by the old pinmux driver. This required adding new pull table entries for those new groups, and setting many other entries' pull configuration to TEGRA_PINCONFIG_DONT_SET.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Olof Johansson <olof@lixom.net>
f | pcie.c | s | 23K | 770 | Russell King | rmk+kernel@arm.linux.org.uk | 1336925536 |  | ARM: PCI: get rid of pci_std_swizzle()  Most PCI implementations use the standard PCI swizzle function, which handles the well defined behaviour of PCI-to-PCI bridges which can be found on cards (eg, four port ethernet cards.)  Rather than having almost every platform specify the standard swizzle function, make this the default when no swizzle function is supplied. Therefore, a swizzle function only needs to be provided when there is something exceptional which needs to be handled.  This gets rid of the swizzle initializer from 47 files, and leaves us with just two platforms specifying a swizzle function: ARM Integrator and Chalice CATS.  Acked-by: Krzysztof Hałasa <khc@pm.waw.pl> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | apbio.c | s | 3.3K | 115 | Olof Johansson | olof@lixom.net | 1328581498 |  | ARM: tegra: use APB DMA for accessing APB devices  Tegra2 hangs if APB registers are accessed from the cpu during an apb dma operation. The workaround is to use apb dma to read/write the registers instead.  There is a dependency loop between fuses, clocks, and APBDMA.  If dma is enabled, fuse reads must go through APBDMA to avoid corruption due to a hw bug.  APBDMA requires a clock to be enabled.  Clocks must read a fuse to determine allowable cpu frequencies.  Separate out the fuse DMA initialization, and allow the fuse read and write functions to be called without using DMA before the DMA initialization has been completed.  Access to the fuses before APBDMA is initialized won't hit the hardware bug because nothing else can be using DMA.  Original fuse registar access code from Varun Wadekar <vwadekar@nvidia.com>, improved by Colin Cross <ccross@android.com> and later moved to separate driver by Jon Mayo <jmayo@nvidia.com>.  Major refactoring/cleanup by Olof Johansson <olof@lixom.net>.  Changes since v1:  * fix 'return false' on error condition * dequeue dma ops in case of timeout  From: Jon Mayo <jmayo@nvidia.com>. Signed-off-by: Jon Mayo <jmayo@nvidia.com>. Signed-off-by: Olof Johansson <olof@lixom.net> Acked-by: Stephen Warren <swarren@nvidia.com>
f | board-pinmux.h | s | 1.9K | 43 | Stephen Warren | swarren@nvidia.com | 1334766400 |  | pinctrl: tegra: refactor probe handling  Rather than having a single tegra-pinctrl driver that determines whether it's running on Tegra20 or Tegra30, instead have separate drivers for each that call into utility functions to implement the majority of the driver. This change is based on review feedback of the SPEAr pinctrl driver, which had originally copied to Tegra driver structure.  This requires that the two drivers have unique names. Update a couple spots in arch/arm/mach-tegra for the name change.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | sleep.S | g | 2.5K |  | Stephen Warren | swarren@wwwdotorg.org | 1332777322 |  | ARM: tegra: Include assembler.h in sleep.S to fix build break  Commit 6f6f6a7 "ARM: create a common IOMEM definition" moved macro IOMEM(), and requires users to include <asm/assembler.h>. Fix Tegra's sleep.S to do so. This fixes:  arch/arm/mach-tegra/sleep.S: Assembler messages: arch/arm/mach-tegra/sleep.S:77: Error: missing ')' arch/arm/mach-tegra/sleep.S:77: Error: garbage following instruction     -- `movw r0,#:lower16:(0x60007000-0x60000000+IOMEM(0xFE200000))'  Note: This only shows up after 0a25893 "ARM: tegra: update defconfig"  Signed-off-by: Stephen Warren <swarren@wwwdotorg.org>
f | tegra30_clocks.c | s | 90K | 2718 | Stephen Warren | swarren@nvidia.com | 1335388921 |  | ARM: tegra: provide clock aliases for AHUB configlink  The Tegra30 AHUB driver must call tegra_periph_reset_deassert() for all devices on the AHUB's configlink bus. The AHUB driver must be able to call clk_get_sys() to retrieve the clock parameter for this function. Add the necessary clock aliases to allow this.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Olof Johansson <olof@lixom.net>
f | headsmp.S | g | 5.2K |  | Peter De Schrijver | pdeschrijver@nvidia.com | 1330296286 |  | ARM: tegra: support for secondary cores on Tegra30  Add support for bringing up secondary cores on Tegra30. On Tegra30 secondary CPU cores are powergated, so we need to turn on the domains before we can bring the CPU cores online. Bringing secondary cores online happens early during the sytem boot, so we call powergating initialization from platform early_init function.  Based on work by:  Scott Williams <scwilliams@nvidia.com> Colin Cross <ccross@android.com> Alex Frid <afrid@nvidia.com>  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Acked-by: Colin Cross <ccross@android.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | board-paz00.c | s | 5.4K | 200 | Linus Torvalds | torvalds@linux-foundation.org | 1338063241 |  | 
f | board-seaboard.c | s | 7.5K | 258 | Linus Torvalds | torvalds@linux-foundation.org | 1338063241 |  | 
f | timer.c | s | 6.5K | 226 | Marc Zyngier | Marc.Zyngier@arm.com | 1336298961 |  | ARM: 7413/1: move read_{boot,persistent}_clock to the architecture level  At the moment, read_persistent_clock is implemented at the platform level, which makes it impossible to compile these platforms in a single kernel.  Implement these two functions at the architecture level, and provide a thin registration interface for both read_boot_clock and read_persistent_clock. The two affected platforms (OMAP and Tegra) are converted at the same time.  Reported-by: Jeff Ohlstein <johlstei@codeaurora.org> Tested-by: Stephen Warren <swarren@wwwdotorg.org> Tested-by: Tony Lindgren <tony@atomide.com> Signed-off-by: Marc Zyngier <marc.zyngier@arm.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | irq.c | s | 3.4K | 117 | Peter De Schrijver | pdeschrijver@nvidia.com | 1328548574 |  | ARM: tegra: add support for tegra30 interrupts  Tegra30 has 1 extra legacy interrupt controller. Use the GIC ITLinesNumber field to determine how many interrupt controllers we have and initialize appropriately. Also make room for the extra tegra30 interrupts by moving the GPIO IRQ base. This shouldn't affect existing code as it determines the correct IRQ number for GPIOs using TEGRA_GPIO_TO_IRQ().  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Acked-by: Colin Cross <ccross@android.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | devices.h | s | 2.2K | 53 | Linus Torvalds | torvalds@linux-foundation.org | 1338060147 |  | 
f | board-seaboard-pinmux.c | s | 9.4K | 186 | Stephen Warren | swarren@nvidia.com | 1334766399 |  | ARM: tegra: Switch to new pinctrl driver  * Rename old pinmux and new pinctrl platform driver and DT match table   entries, so the new driver gets instantiated. * Re-write board-pinmux.c, so that it uses pinctrl APIs to configura the   pinmux. * Re-write board-*-pinmux.c so that the pinmux configuration tables are   in pinctrl format.  Ventana's pin mux table needed some edits on top of the basic format conversion, since some mux options that were previously marked as reserved are now valid in the new pinctrl driver. Attempting to use the old reserved names will result in a failure. Specifically, groups lpw0, lpw2, lsc1, lsck, and lsda were changed from function rsvd4 to displaya, and group pta was changed from function rsvd2 to hdmi.  All boards' pin mux tables needed some edits on top of the based format conversion, since function i2c was split into i2c1 (first general I2C controller) and i2cp (power I2C controller) to better align function definitions with HW blocks.  Due to the split of mux tables into pure mux and pull/tristate tables, many entries in the separate Seaboard/Ventana tables could be merged into the common table, since the entries differed only in the portion in one of the tables, not both.  Most pin groups allow configuration of mux, tri-state, and pull. However, some don't allow pull configuration, which is instead configured by new groups that only allow pull configuration. This is a reflection of the true HW capabilities, which weren't fully represented by the old pinmux driver. This required adding new pull table entries for those new groups, and setting many other entries' pull configuration to TEGRA_PINCONFIG_DONT_SET.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Olof Johansson <olof@lixom.net>
f | tegra2_emc.h | s | 723B | 21 | Olof Johansson | olof@lixom.net | 1328581499 |  | ARM: tegra: emc: convert tegra2_emc to a platform driver  This is the first step in making it device-tree aware and get rid of the in-kernel EMC tables (of which there are none in mainline, thankfully).  Changes since v3:  * moved to devm_request_and_ioremap() in probe()  Changes since v2:  * D'oh -- missed a couple of variables that were added, never used and then   later removed in a later patch.  Changes since v1:  * Fixed messed up indentation * Removed code that should be gone (was added here and removed later in series)  Signed-off-by: Olof Johansson <olof@lixom.net> Acked-by: Stephen Warren <swarren@nvidia.com>
f | pmc.h | s | 760B | 20 | Stephen Warren | swarren@nvidia.com | 1328581501 |  | ARM: tegra: Add a simple PMC driver  This PMC driver is enough to parse the nvidia,invert-interrupt property from device tree, and configure the PMC's to honor that.  In the future, this file could expand to centralize all other PMC accesses within the mach-tegra code.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | Kconfig | g | 4.8K |  | Arnd Bergmann | arnd@arndb.de | 1337081441 |  | Merge branch 'for-3.5/ahb' of git://git.kernel.org/pub/scm/linux/kernel/git/swarren/linux-tegra into next/drivers  * tegra/ahb:   ARM: tegra: Add SMMU enabler in AHB   ARM: tegra: Add Tegra AHB driver  Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | powergate.c | s | 4.9K | 196 | Shawn Guo | shawn.guo@linaro.org | 1336480596 |  | ARM: tegra: use machine specific hook for late init  Cc: Colin Cross <ccross@android.com> Cc: Olof Johansson <olof@lixom.net> Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org>
f | board-seaboard.h | s | 1.7K | 41 | Arnd Bergmann | arnd@arndb.de | 1319208386 |  | Merge branch 'depends/rmk/gpio' into next/board  Conflicts: 	arch/arm/mach-at91/board-usb-a9260.c 	arch/arm/mach-at91/board-usb-a9263.c 	arch/arm/mach-tegra/board-paz00.h 	arch/arm/mach-tegra/board-seaboard.h
f | cpu-tegra.c | s | 5.7K | 202 | David Howells | dhowells@redhat.com | 1332955801 |  | Disintegrate asm/system.h for ARM  Disintegrate asm/system.h for ARM.  Signed-off-by: David Howells <dhowells@redhat.com> cc: Russell King <linux@arm.linux.org.uk> cc: linux-arm-kernel@lists.infradead.org
f | board-pinmux.c | s | 2.9K | 71 | Stephen Warren | swarren@nvidia.com | 1334766399 |  | ARM: dt: tegra20: add pinmux to device tree  This adds a complete pinmux configuration to all Tegra20 device tree files. This allows removal of board-dt-tegra20.c's use of the pinmux board files, and the special device tree handling in board-pinmux.c.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Olof Johansson <olof@lixom.net>
f | board-dt-tegra30.c | s | 3.1K | 86 | Linus Torvalds | torvalds@linux-foundation.org | 1338063241 |  | 
f | tegra2_clocks.c | s | 66K | 2098 | Linus Torvalds | torvalds@linux-foundation.org | 1338060147 |  | 
f | io.c | s | 1.5K | 58 | Rob Herring | rob.herring@calxeda.com | 1331091281 |  | ARM: tegra: clean-up mach/io.h  Move tegra specific mach/io.h parts into iomap.h.  Signed-off-by: Rob Herring <rob.herring@calxeda.com> Tested-by: Stephen Warren <swarren@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Cc: Colin Cross <ccross@android.com> Cc: Olof Johansson <olof@lixom.net>
f | flowctrl.c | s | 1.6K | 52 | Peter De Schrijver | pdeschrijver@nvidia.com | 1337012521 |  | ARM: tegra: Fix flow controller accesses  flowctrl_write_cpu_csr uses the cpu halt offsets and vice versa. This patch fixes this bug.  Reported-by: Dan Willemsen <dwillemsen@nvidia.com> Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> [swarren: This problem was introduced in v3.4-rc1, in commit 26fe681 "ARM:  tegra: functions to access the flowcontroller", when this file was first  added] Signed-off-by: Stephen Warren <swarren@nvidia.com>
f | board-harmony-power.c | s | 3.3K | 104 | Linus Torvalds | torvalds@linux-foundation.org | 1332891684 |  | 
f | platsmp.c | s | 4.5K | 156 | Peter De Schrijver | pdeschrijver@nvidia.com | 1330296286 |  | ARM: tegra: support for secondary cores on Tegra30  Add support for bringing up secondary cores on Tegra30. On Tegra30 secondary CPU cores are powergated, so we need to turn on the domains before we can bring the CPU cores online. Bringing secondary cores online happens early during the sytem boot, so we call powergating initialization from platform early_init function.  Based on work by:  Scott Williams <scwilliams@nvidia.com> Colin Cross <ccross@android.com> Alex Frid <afrid@nvidia.com>  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Tested-by: Stephen Warren <swarren@nvidia.com> Acked-by: Colin Cross <ccross@android.com> Signed-off-by: Olof Johansson <olof@lixom.net>
f | Makefile.boot | g | 454B |  | Peter De Schrijver | pdeschrijver@nvidia.com | 1324181738 |  | arm/tegra: add support for tegra30 based board cardhu  Add support for the tegra30 based cardhu development board. Cardhu is a tablet formfactor reference design for tegra30. The patch provides a device tree for the board, updates Makefile.boot to build the dtb, includes the platform in Kconfig and updates board-dt.c.  Signed-off-by: Peter De Schrijver <pdeschrijver@nvidia.com> Acked-by: Stephen Warren <swarren@nvidia.com> Acked-by: Colin Cross <ccross@android.com> Signed-off-by: Olof Johansson <olof@lixom.net>
