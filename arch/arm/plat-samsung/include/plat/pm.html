<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › arm › plat-samsung › include › plat › pm.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>pm.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* arch/arm/plat-samsung/include/plat/pm.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2004 Simtec Electronics</span>
<span class="cm"> *	http://armlinux.simtec.co.uk/</span>
<span class="cm"> *	Written by Ben Dooks, &lt;ben@simtec.co.uk&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm">*/</span>

<span class="cm">/* s3c_pm_init</span>
<span class="cm"> *</span>
<span class="cm"> * called from board at initialisation time to setup the power</span>
<span class="cm"> * management</span>
<span class="cm">*/</span>

<span class="cp">#include &lt;linux/irq.h&gt;</span>

<span class="k">struct</span> <span class="n">device</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_PM</span>

<span class="k">extern</span> <span class="n">__init</span> <span class="kt">int</span> <span class="n">s3c_pm_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">__init</span> <span class="kt">int</span> <span class="n">s3c64xx_pm_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#else</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">s3c_pm_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">s3c64xx_pm_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cm">/* configuration for the IRQ mask over sleep */</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">s3c_irqwake_intmask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">s3c_irqwake_eintmask</span><span class="p">;</span>

<span class="cm">/* IRQ masks for IRQs allowed to go to sleep (see irq.c) */</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">s3c_irqwake_intallow</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">s3c_irqwake_eintallow</span><span class="p">;</span>

<span class="cm">/* per-cpu sleep functions */</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">pm_cpu_prep</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">pm_cpu_sleep</span><span class="p">)(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>

<span class="cm">/* Flags for PM Control */</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">s3c_pm_flags</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pm_uart_udivslot</span><span class="p">;</span>  <span class="cm">/* true to save UART UDIVSLOT */</span>

<span class="cm">/* from sleep.S */</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_cpu_resume</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">s3c2410_cpu_suspend</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">);</span>

<span class="cm">/* sleep save info */</span>

<span class="cm">/**</span>
<span class="cm"> * struct sleep_save - save information for shared peripherals.</span>
<span class="cm"> * @reg: Pointer to the register to save.</span>
<span class="cm"> * @val: Holder for the value saved from reg.</span>
<span class="cm"> *</span>
<span class="cm"> * This describes a list of registers which is used by the pm core and</span>
<span class="cm"> * other subsystem to save and restore register values over suspend.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">sleep_save</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="n">__iomem</span>	<span class="o">*</span><span class="n">reg</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">val</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define SAVE_ITEM(x) \</span>
<span class="cp">	{ .reg = (x) }</span>

<span class="cm">/**</span>
<span class="cm"> * struct pm_uart_save - save block for core UART</span>
<span class="cm"> * @ulcon: Save value for S3C2410_ULCON</span>
<span class="cm"> * @ucon: Save value for S3C2410_UCON</span>
<span class="cm"> * @ufcon: Save value for S3C2410_UFCON</span>
<span class="cm"> * @umcon: Save value for S3C2410_UMCON</span>
<span class="cm"> * @ubrdiv: Save value for S3C2410_UBRDIV</span>
<span class="cm"> *</span>
<span class="cm"> * Save block for UART registers to be held over sleep and restored if they</span>
<span class="cm"> * are needed (say by debug).</span>
<span class="cm">*/</span>
<span class="k">struct</span> <span class="n">pm_uart_save</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">ulcon</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">ucon</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">ufcon</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">umcon</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">ubrdiv</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">udivslot</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* helper functions to save/restore lists of registers. */</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_do_save</span><span class="p">(</span><span class="k">struct</span> <span class="n">sleep_save</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_do_restore</span><span class="p">(</span><span class="k">struct</span> <span class="n">sleep_save</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_do_restore_core</span><span class="p">(</span><span class="k">struct</span> <span class="n">sleep_save</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">);</span>

<span class="cp">#ifdef CONFIG_PM</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">s3c_irqext_wake</span><span class="p">(</span><span class="k">struct</span> <span class="n">irq_data</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">state</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">s3c24xx_irq_suspend</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c24xx_irq_resume</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cp">#define s3c_irqext_wake NULL</span>
<span class="cp">#define s3c24xx_irq_suspend NULL</span>
<span class="cp">#define s3c24xx_irq_resume  NULL</span>
<span class="cp">#endif</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">syscore_ops</span> <span class="n">s3c24xx_irq_syscore_ops</span><span class="p">;</span>

<span class="cm">/* PM debug functions */</span>

<span class="cp">#ifdef CONFIG_SAMSUNG_PM_DEBUG</span>
<span class="cm">/**</span>
<span class="cm"> * s3c_pm_dbg() - low level debug function for use in suspend/resume.</span>
<span class="cm"> * @msg: The message to print.</span>
<span class="cm"> *</span>
<span class="cm"> * This function is used mainly to debug the resume process before the system</span>
<span class="cm"> * can rely on printk/console output. It uses the low-level debugging output</span>
<span class="cm"> * routine printascii() to do its work.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_dbg</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">msg</span><span class="p">,</span> <span class="p">...);</span>

<span class="cp">#define S3C_PMDBG(fmt...) s3c_pm_dbg(fmt)</span>
<span class="cp">#else</span>
<span class="cp">#define S3C_PMDBG(fmt...) printk(KERN_DEBUG fmt)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_S3C_PM_DEBUG_LED_SMDK</span>
<span class="cm">/**</span>
<span class="cm"> * s3c_pm_debug_smdkled() - Debug PM suspend/resume via SMDK Board LEDs</span>
<span class="cm"> * @set: set bits for the state of the LEDs</span>
<span class="cm"> * @clear: clear bits for the state of the LEDs.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_debug_smdkled</span><span class="p">(</span><span class="n">u32</span> <span class="n">set</span><span class="p">,</span> <span class="n">u32</span> <span class="n">clear</span><span class="p">);</span>

<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">s3c_pm_debug_smdkled</span><span class="p">(</span><span class="n">u32</span> <span class="n">set</span><span class="p">,</span> <span class="n">u32</span> <span class="n">clear</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_S3C_PM_DEBUG_LED_SMDK */</span><span class="cp"></span>

<span class="cm">/* suspend memory checking */</span>

<span class="cp">#ifdef CONFIG_SAMSUNG_PM_CHECK</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_check_prepare</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_check_restore</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_check_cleanup</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_check_store</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cp">#define s3c_pm_check_prepare() do { } while(0)</span>
<span class="cp">#define s3c_pm_check_restore() do { } while(0)</span>
<span class="cp">#define s3c_pm_check_cleanup() do { } while(0)</span>
<span class="cp">#define s3c_pm_check_store()   do { } while(0)</span>
<span class="cp">#endif</span>

<span class="cm">/**</span>
<span class="cm"> * s3c_pm_configure_extint() - ensure pins are correctly set for IRQ</span>
<span class="cm"> *</span>
<span class="cm"> * Setup all the necessary GPIO pins for waking the system on external</span>
<span class="cm"> * interrupt.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_configure_extint</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * samsung_pm_restore_gpios() - restore the state of the gpios after sleep.</span>
<span class="cm"> *</span>
<span class="cm"> * Restore the state of the GPIO pins after sleep, which may involve ensuring</span>
<span class="cm"> * that we do not glitch the state of the pins from that the bootloader&#39;s</span>
<span class="cm"> * resume code has done.</span>
<span class="cm">*/</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">samsung_pm_restore_gpios</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * samsung_pm_save_gpios() - save the state of the GPIOs for restoring after sleep.</span>
<span class="cm"> *</span>
<span class="cm"> * Save the GPIO states for resotration on resume. See samsung_pm_restore_gpios().</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">samsung_pm_save_gpios</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_save_core</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">s3c_pm_restore_core</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
