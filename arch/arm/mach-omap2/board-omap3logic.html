<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › arm › mach-omap2 › board-omap3logic.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>board-omap3logic.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * linux/arch/arm/mach-omap2/board-omap3logic.c</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2010 Li-Pro.Net</span>
<span class="cm"> * Stephan Linz &lt;linz@li-pro.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2010-2012 Logic Product Development, Inc.</span>
<span class="cm"> * Peter Barada &lt;peter.barada@logicpd.com&gt;</span>
<span class="cm"> * Ashwin BIhari &lt;ashwin.bihari@logicpd.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Modified from Beagle, EVM, and RX51</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/platform_device.h&gt;</span>
<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/err.h&gt;</span>
<span class="cp">#include &lt;linux/clk.h&gt;</span>
<span class="cp">#include &lt;linux/io.h&gt;</span>
<span class="cp">#include &lt;linux/gpio.h&gt;</span>

<span class="cp">#include &lt;linux/regulator/fixed.h&gt;</span>
<span class="cp">#include &lt;linux/regulator/machine.h&gt;</span>

<span class="cp">#include &lt;linux/i2c/twl.h&gt;</span>
<span class="cp">#include &lt;linux/mmc/host.h&gt;</span>

<span class="cp">#include &lt;mach/hardware.h&gt;</span>
<span class="cp">#include &lt;asm/mach-types.h&gt;</span>
<span class="cp">#include &lt;asm/mach/arch.h&gt;</span>
<span class="cp">#include &lt;asm/mach/map.h&gt;</span>

<span class="cp">#include &quot;mux.h&quot;</span>
<span class="cp">#include &quot;hsmmc.h&quot;</span>
<span class="cp">#include &quot;control.h&quot;</span>
<span class="cp">#include &quot;common-board-devices.h&quot;</span>

<span class="cp">#include &lt;plat/mux.h&gt;</span>
<span class="cp">#include &lt;plat/board.h&gt;</span>
<span class="cp">#include &quot;common.h&quot;</span>
<span class="cp">#include &lt;plat/gpmc-smsc911x.h&gt;</span>
<span class="cp">#include &lt;plat/gpmc.h&gt;</span>
<span class="cp">#include &lt;plat/sdrc.h&gt;</span>
<span class="cp">#include &lt;plat/usb.h&gt;</span>

<span class="cp">#define OMAP3LOGIC_SMSC911X_CS			1</span>

<span class="cp">#define OMAP3530_LV_SOM_MMC_GPIO_CD		110</span>
<span class="cp">#define OMAP3530_LV_SOM_MMC_GPIO_WP		126</span>
<span class="cp">#define OMAP3530_LV_SOM_SMSC911X_GPIO_IRQ	152</span>

<span class="cp">#define OMAP3_TORPEDO_MMC_GPIO_CD		127</span>
<span class="cp">#define OMAP3_TORPEDO_SMSC911X_GPIO_IRQ		129</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">regulator_consumer_supply</span> <span class="n">omap3logic_vmmc1_supply</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">REGULATOR_SUPPLY</span><span class="p">(</span><span class="s">&quot;vmmc&quot;</span><span class="p">,</span> <span class="s">&quot;omap_hsmmc.0&quot;</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* VMMC1 for MMC1 pins CMD, CLK, DAT0..DAT3 (20 mA, plus card == max 220 mA) */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">regulator_init_data</span> <span class="n">omap3logic_vmmc1</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span>			<span class="o">=</span> <span class="s">&quot;VMMC1&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">min_uV</span>			<span class="o">=</span> <span class="mi">1850000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">max_uV</span>			<span class="o">=</span> <span class="mi">3150000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">valid_modes_mask</span>	<span class="o">=</span> <span class="n">REGULATOR_MODE_NORMAL</span>
					<span class="o">|</span> <span class="n">REGULATOR_MODE_STANDBY</span><span class="p">,</span>
		<span class="p">.</span><span class="n">valid_ops_mask</span>		<span class="o">=</span> <span class="n">REGULATOR_CHANGE_VOLTAGE</span>
					<span class="o">|</span> <span class="n">REGULATOR_CHANGE_MODE</span>
					<span class="o">|</span> <span class="n">REGULATOR_CHANGE_STATUS</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">num_consumer_supplies</span>  <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">omap3logic_vmmc1_supply</span><span class="p">),</span>
	<span class="p">.</span><span class="n">consumer_supplies</span>      <span class="o">=</span> <span class="n">omap3logic_vmmc1_supply</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">twl4030_gpio_platform_data</span> <span class="n">omap3logic_gpio_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">gpio_base</span>	<span class="o">=</span> <span class="n">OMAP_MAX_GPIO_LINES</span><span class="p">,</span>
	<span class="p">.</span><span class="n">irq_base</span>	<span class="o">=</span> <span class="n">TWL4030_GPIO_IRQ_BASE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">irq_end</span>	<span class="o">=</span> <span class="n">TWL4030_GPIO_IRQ_END</span><span class="p">,</span>
	<span class="p">.</span><span class="n">use_leds</span>	<span class="o">=</span> <span class="nb">true</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pullups</span>	<span class="o">=</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="p">.</span><span class="n">pulldowns</span>	<span class="o">=</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
			<span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">twl4030_usb_data</span> <span class="n">omap3logic_usb_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">usb_mode</span>	<span class="o">=</span> <span class="n">T2_USB_MODE_ULPI</span><span class="p">,</span>
<span class="p">};</span>


<span class="k">static</span> <span class="k">struct</span> <span class="n">twl4030_platform_data</span> <span class="n">omap3logic_twldata</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">irq_base</span>	<span class="o">=</span> <span class="n">TWL4030_IRQ_BASE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">irq_end</span>	<span class="o">=</span> <span class="n">TWL4030_IRQ_END</span><span class="p">,</span>

	<span class="cm">/* platform_data for children goes here */</span>
	<span class="p">.</span><span class="n">gpio</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">omap3logic_gpio_data</span><span class="p">,</span>
	<span class="p">.</span><span class="n">vmmc1</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">omap3logic_vmmc1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">usb</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">omap3logic_usb_data</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">omap3logic_i2c_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">omap3_pmic_init</span><span class="p">(</span><span class="s">&quot;twl4030&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">omap3logic_twldata</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">omap2_hsmmc_info</span> <span class="n">__initdata</span> <span class="n">board_mmc_info</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">name</span>		<span class="o">=</span> <span class="s">&quot;external&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">mmc</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">caps</span>		<span class="o">=</span> <span class="n">MMC_CAP_4_BIT_DATA</span><span class="p">,</span>
		<span class="p">.</span><span class="n">gpio_cd</span>	<span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">,</span>
		<span class="p">.</span><span class="n">gpio_wp</span>	<span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{}</span>      <span class="cm">/* Terminator */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__init</span> <span class="nf">board_mmc_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">machine_is_omap3530_lv_som</span><span class="p">())</span> <span class="p">{</span>
		<span class="cm">/* OMAP3530 LV SOM board */</span>
		<span class="n">board_mmc_info</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">gpio_cd</span> <span class="o">=</span> <span class="n">OMAP3530_LV_SOM_MMC_GPIO_CD</span><span class="p">;</span>
		<span class="n">board_mmc_info</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">gpio_wp</span> <span class="o">=</span> <span class="n">OMAP3530_LV_SOM_MMC_GPIO_WP</span><span class="p">;</span>
		<span class="n">omap_mux_init_signal</span><span class="p">(</span><span class="s">&quot;gpio_110&quot;</span><span class="p">,</span> <span class="n">OMAP_PIN_OUTPUT</span><span class="p">);</span>
		<span class="n">omap_mux_init_signal</span><span class="p">(</span><span class="s">&quot;gpio_126&quot;</span><span class="p">,</span> <span class="n">OMAP_PIN_OUTPUT</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">machine_is_omap3_torpedo</span><span class="p">())</span> <span class="p">{</span>
		<span class="cm">/* OMAP3 Torpedo board */</span>
		<span class="n">board_mmc_info</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">gpio_cd</span> <span class="o">=</span> <span class="n">OMAP3_TORPEDO_MMC_GPIO_CD</span><span class="p">;</span>
		<span class="n">omap_mux_init_signal</span><span class="p">(</span><span class="s">&quot;gpio_127&quot;</span><span class="p">,</span> <span class="n">OMAP_PIN_OUTPUT</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* unsupported board */</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_ERR</span> <span class="s">&quot;%s(): unknown machine type</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">omap_hsmmc_init</span><span class="p">(</span><span class="n">board_mmc_info</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">omap_smsc911x_platform_data</span> <span class="n">__initdata</span> <span class="n">board_smsc911x_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cs</span>             <span class="o">=</span> <span class="n">OMAP3LOGIC_SMSC911X_CS</span><span class="p">,</span>
	<span class="p">.</span><span class="n">gpio_irq</span>       <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">,</span>
	<span class="p">.</span><span class="n">gpio_reset</span>     <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* TODO/FIXME (comment by Peter Barada, LogicPD):</span>
<span class="cm"> * Fix the PBIAS voltage for Torpedo MMC1 pins that</span>
<span class="cm"> * are used for other needs (IRQs, etc).            */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">omap3torpedo_fix_pbias_voltage</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u16</span> <span class="n">control_pbias_offset</span> <span class="o">=</span> <span class="n">OMAP343X_CONTROL_PBIAS_LITE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reg</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">machine_is_omap3_torpedo</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="cm">/* Set the bias for the pin */</span>
		<span class="n">reg</span> <span class="o">=</span> <span class="n">omap_ctrl_readl</span><span class="p">(</span><span class="n">control_pbias_offset</span><span class="p">);</span>

		<span class="n">reg</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">OMAP343X_PBIASLITEPWRDNZ1</span><span class="p">;</span>
		<span class="n">omap_ctrl_writel</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">control_pbias_offset</span><span class="p">);</span>

		<span class="cm">/* 100ms delay required for PBIAS configuration */</span>
		<span class="n">msleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>

		<span class="n">reg</span> <span class="o">|=</span> <span class="n">OMAP343X_PBIASLITEVMODE1</span><span class="p">;</span>
		<span class="n">reg</span> <span class="o">|=</span> <span class="n">OMAP343X_PBIASLITEPWRDNZ1</span><span class="p">;</span>
		<span class="n">omap_ctrl_writel</span><span class="p">(</span><span class="n">reg</span> <span class="o">|</span> <span class="mh">0x300</span><span class="p">,</span> <span class="n">control_pbias_offset</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="n">__init</span> <span class="nf">board_smsc911x_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">machine_is_omap3530_lv_som</span><span class="p">())</span> <span class="p">{</span>
		<span class="cm">/* OMAP3530 LV SOM board */</span>
		<span class="n">board_smsc911x_data</span><span class="p">.</span><span class="n">gpio_irq</span> <span class="o">=</span>
					<span class="n">OMAP3530_LV_SOM_SMSC911X_GPIO_IRQ</span><span class="p">;</span>
		<span class="n">omap_mux_init_signal</span><span class="p">(</span><span class="s">&quot;gpio_152&quot;</span><span class="p">,</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">machine_is_omap3_torpedo</span><span class="p">())</span> <span class="p">{</span>
		<span class="cm">/* OMAP3 Torpedo board */</span>
		<span class="n">board_smsc911x_data</span><span class="p">.</span><span class="n">gpio_irq</span> <span class="o">=</span> <span class="n">OMAP3_TORPEDO_SMSC911X_GPIO_IRQ</span><span class="p">;</span>
		<span class="n">omap_mux_init_signal</span><span class="p">(</span><span class="s">&quot;gpio_129&quot;</span><span class="p">,</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* unsupported board */</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_ERR</span> <span class="s">&quot;%s(): unknown machine type</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">gpmc_smsc911x_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">board_smsc911x_data</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#ifdef CONFIG_OMAP_MUX</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">omap_board_mux</span> <span class="n">board_mux</span><span class="p">[]</span> <span class="n">__initdata</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/* mUSB */</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_CLK</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_STP</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_OUTPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DIR</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_NXT</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA0</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA1</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA2</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA3</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA4</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA5</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA6</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>
	<span class="n">OMAP3_MUX</span><span class="p">(</span><span class="n">HSUSB0_DATA7</span><span class="p">,</span> <span class="n">OMAP_MUX_MODE0</span> <span class="o">|</span> <span class="n">OMAP_PIN_INPUT</span><span class="p">),</span>

	<span class="p">{</span> <span class="p">.</span><span class="n">reg_offset</span> <span class="o">=</span> <span class="n">OMAP_MUX_TERMINATOR</span> <span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">regulator_consumer_supply</span> <span class="n">dummy_supplies</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">REGULATOR_SUPPLY</span><span class="p">(</span><span class="s">&quot;vddvario&quot;</span><span class="p">,</span> <span class="s">&quot;smsc911x.0&quot;</span><span class="p">),</span>
	<span class="n">REGULATOR_SUPPLY</span><span class="p">(</span><span class="s">&quot;vdd33a&quot;</span><span class="p">,</span> <span class="s">&quot;smsc911x.0&quot;</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__init</span> <span class="nf">omap3logic_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">regulator_register_fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dummy_supplies</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">dummy_supplies</span><span class="p">));</span>
	<span class="n">omap3_mux_init</span><span class="p">(</span><span class="n">board_mux</span><span class="p">,</span> <span class="n">OMAP_PACKAGE_CBB</span><span class="p">);</span>
	<span class="n">omap3torpedo_fix_pbias_voltage</span><span class="p">();</span>
	<span class="n">omap3logic_i2c_init</span><span class="p">();</span>
	<span class="n">omap_serial_init</span><span class="p">();</span>
	<span class="n">omap_sdrc_init</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">board_mmc_init</span><span class="p">();</span>
	<span class="n">board_smsc911x_init</span><span class="p">();</span>

	<span class="n">usb_musb_init</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>

	<span class="cm">/* Ensure SDRC pins are mux&#39;d for self-refresh */</span>
	<span class="n">omap_mux_init_signal</span><span class="p">(</span><span class="s">&quot;sdrc_cke0&quot;</span><span class="p">,</span> <span class="n">OMAP_PIN_OUTPUT</span><span class="p">);</span>
	<span class="n">omap_mux_init_signal</span><span class="p">(</span><span class="s">&quot;sdrc_cke1&quot;</span><span class="p">,</span> <span class="n">OMAP_PIN_OUTPUT</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">MACHINE_START</span><span class="p">(</span><span class="n">OMAP3_TORPEDO</span><span class="p">,</span> <span class="s">&quot;Logic OMAP3 Torpedo board&quot;</span><span class="p">)</span>
	<span class="p">.</span><span class="n">atag_offset</span>	<span class="o">=</span> <span class="mh">0x100</span><span class="p">,</span>
	<span class="p">.</span><span class="n">reserve</span>	<span class="o">=</span> <span class="n">omap_reserve</span><span class="p">,</span>
	<span class="p">.</span><span class="n">map_io</span>		<span class="o">=</span> <span class="n">omap3_map_io</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_early</span>	<span class="o">=</span> <span class="n">omap35xx_init_early</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_irq</span>	<span class="o">=</span> <span class="n">omap3_init_irq</span><span class="p">,</span>
	<span class="p">.</span><span class="n">handle_irq</span>	<span class="o">=</span> <span class="n">omap3_intc_handle_irq</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_machine</span>	<span class="o">=</span> <span class="n">omap3logic_init</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_late</span>	<span class="o">=</span> <span class="n">omap35xx_init_late</span><span class="p">,</span>
	<span class="p">.</span><span class="n">timer</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">omap3_timer</span><span class="p">,</span>
	<span class="p">.</span><span class="n">restart</span>	<span class="o">=</span> <span class="n">omap_prcm_restart</span><span class="p">,</span>
<span class="n">MACHINE_END</span>

<span class="n">MACHINE_START</span><span class="p">(</span><span class="n">OMAP3530_LV_SOM</span><span class="p">,</span> <span class="s">&quot;OMAP Logic 3530 LV SOM board&quot;</span><span class="p">)</span>
	<span class="p">.</span><span class="n">atag_offset</span>	<span class="o">=</span> <span class="mh">0x100</span><span class="p">,</span>
	<span class="p">.</span><span class="n">reserve</span>	<span class="o">=</span> <span class="n">omap_reserve</span><span class="p">,</span>
	<span class="p">.</span><span class="n">map_io</span>		<span class="o">=</span> <span class="n">omap3_map_io</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_early</span>	<span class="o">=</span> <span class="n">omap35xx_init_early</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_irq</span>	<span class="o">=</span> <span class="n">omap3_init_irq</span><span class="p">,</span>
	<span class="p">.</span><span class="n">handle_irq</span>	<span class="o">=</span> <span class="n">omap3_intc_handle_irq</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_machine</span>	<span class="o">=</span> <span class="n">omap3logic_init</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init_late</span>	<span class="o">=</span> <span class="n">omap35xx_init_late</span><span class="p">,</span>
	<span class="p">.</span><span class="n">timer</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">omap3_timer</span><span class="p">,</span>
	<span class="p">.</span><span class="n">restart</span>	<span class="o">=</span> <span class="n">omap_prcm_restart</span><span class="p">,</span>
<span class="n">MACHINE_END</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
