<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › blackfin › mach-common › arch_checks.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>arch_checks.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Do some checking to make sure things are OK</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2007-2010 Analog Devices Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the GPL-2 or later.</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;asm/fixed_code.h&gt;</span>
<span class="cp">#include &lt;mach/anomaly.h&gt;</span>
<span class="cp">#include &lt;asm/clocks.h&gt;</span>

<span class="cp">#ifdef CONFIG_BFIN_KERNEL_CLOCK</span>

<span class="cp"># if (CONFIG_VCO_HZ &gt; CONFIG_MAX_VCO_HZ)</span>
<span class="cp">#  error &quot;VCO selected is more than maximum value. Please change the VCO multipler&quot;</span>
<span class="cp"># endif</span>

<span class="cp"># if (CONFIG_SCLK_HZ &gt; CONFIG_MAX_SCLK_HZ)</span>
<span class="cp"># error &quot;Sclk value selected is more than maximum. Please select a proper value for SCLK multiplier&quot;</span>
<span class="cp"># endif</span>

<span class="cp"># if (CONFIG_SCLK_HZ &lt; CONFIG_MIN_SCLK_HZ)</span>
<span class="cp"># error &quot;Sclk value selected is less than minimum. Please select a proper value for SCLK multiplier&quot;</span>
<span class="cp"># endif</span>

<span class="cp"># if (ANOMALY_05000273) &amp;&amp; (CONFIG_SCLK_HZ * 2 &gt; CONFIG_CCLK_HZ)</span>
<span class="cp"># error &quot;ANOMALY 05000273, please make sure CCLK is at least 2x SCLK&quot;</span>
<span class="cp"># endif</span>

<span class="cp"># if (CONFIG_SCLK_HZ &gt; CONFIG_CCLK_HZ) &amp;&amp; (CONFIG_SCLK_HZ != CONFIG_CLKIN_HZ) &amp;&amp; (CONFIG_CCLK_HZ != CONFIG_CLKIN_HZ)</span>
<span class="cp"># error &quot;Please select sclk less than cclk&quot;</span>
<span class="cp"># endif</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_BFIN_KERNEL_CLOCK */</span><span class="cp"></span>

<span class="cp">#if CONFIG_BOOT_LOAD &lt; FIXED_CODE_END</span>
<span class="cp"># error &quot;The kernel load address must be after the fixed code section&quot;</span>
<span class="cp">#endif</span>

<span class="cp">#if (CONFIG_BOOT_LOAD &amp; 0x3)</span>
<span class="cp"># error &quot;The kernel load address must be 4 byte aligned&quot;</span>
<span class="cp">#endif</span>

<span class="cm">/* The entire kernel must be able to make a 24bit pcrel call to start of L1 */</span>
<span class="cp">#if ((0xffffffff - L1_CODE_START + 1) + CONFIG_BOOT_LOAD) &gt; 0x1000000</span>
<span class="cp"># error &quot;The kernel load address is too high; keep it below 10meg for safety&quot;</span>
<span class="cp">#endif</span>

<span class="cp">#if ANOMALY_05000263 &amp;&amp; defined(CONFIG_MPU)</span>
<span class="cp"># error the MPU will not function safely while Anomaly 05000263 applies</span>
<span class="cp">#endif</span>

<span class="cp">#if ANOMALY_05000448</span>
<span class="cp"># error You are using a part with anomaly 05000448, this issue causes random memory read/write failures - that means random crashes.</span>
<span class="cp">#endif</span>

<span class="cm">/* if 220 exists, can not set External Memory WB and L2 not_cached, either External Memory not_cached and L2 WB */</span>
<span class="cp">#if ANOMALY_05000220 &amp;&amp; \</span>
<span class="cp">	(defined(CONFIG_BFIN_EXTMEM_WRITEBACK) || defined(CONFIG_BFIN_L2_WRITEBACK))</span>
<span class="cp"># error &quot;Anomaly 05000220 does not allow you to use Write Back cache with L2 or External Memory&quot;</span>
<span class="cp">#endif</span>

<span class="cp">#if ANOMALY_05000491 &amp;&amp; !defined(CONFIG_ICACHE_FLUSH_L1)</span>
<span class="cp"># error You need IFLUSH in L1 inst while Anomaly 05000491 applies</span>
<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
