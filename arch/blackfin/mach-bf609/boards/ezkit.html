<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › blackfin › mach-bf609 › boards › ezkit.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>ezkit.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright 2004-2009 Analog Devices Inc.</span>
<span class="cm"> *                2005 National ICT Australia (NICTA)</span>
<span class="cm"> *                      Aidan Williams &lt;aidan@nicta.com.au&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the GPL-2 or later.</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/device.h&gt;</span>
<span class="cp">#include &lt;linux/platform_device.h&gt;</span>
<span class="cp">#include &lt;linux/mtd/mtd.h&gt;</span>
<span class="cp">#include &lt;linux/mtd/partitions.h&gt;</span>
<span class="cp">#include &lt;linux/mtd/physmap.h&gt;</span>
<span class="cp">#include &lt;linux/spi/spi.h&gt;</span>
<span class="cp">#include &lt;linux/spi/flash.h&gt;</span>
<span class="cp">#include &lt;linux/irq.h&gt;</span>
<span class="cp">#include &lt;linux/i2c.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>
<span class="cp">#include &lt;linux/usb/musb.h&gt;</span>
<span class="cp">#include &lt;asm/bfin6xx_spi.h&gt;</span>
<span class="cp">#include &lt;asm/dma.h&gt;</span>
<span class="cp">#include &lt;asm/gpio.h&gt;</span>
<span class="cp">#include &lt;asm/nand.h&gt;</span>
<span class="cp">#include &lt;asm/dpmc.h&gt;</span>
<span class="cp">#include &lt;asm/portmux.h&gt;</span>
<span class="cp">#include &lt;asm/bfin_sdh.h&gt;</span>
<span class="cp">#include &lt;linux/input.h&gt;</span>
<span class="cp">#include &lt;linux/spi/ad7877.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Name the Board for the /proc/cpuinfo</span>
<span class="cm"> */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="n">bfin_board_name</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;ADI BF609-EZKIT&quot;</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> *  Driver needs to know address, irq and flag pin.</span>
<span class="cm"> */</span>

<span class="cp">#if defined(CONFIG_USB_ISP1760_HCD) || defined(CONFIG_USB_ISP1760_HCD_MODULE)</span>
<span class="cp">#include &lt;linux/usb/isp1760.h&gt;</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_isp1760_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">start</span>  <span class="o">=</span> <span class="mh">0x2C0C0000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>    <span class="o">=</span> <span class="mh">0x2C0C0000</span> <span class="o">+</span> <span class="mh">0xfffff</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span>  <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">start</span>  <span class="o">=</span> <span class="n">IRQ_PG7</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>    <span class="o">=</span> <span class="n">IRQ_PG7</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span>  <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">isp1760_platform_data</span> <span class="n">isp1760_priv</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">is_isp1761</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">bus_width_16</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">port1_otg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">analog_oc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dack_polarity_high</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dreq_polarity_high</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_isp1760_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span>           <span class="o">=</span> <span class="s">&quot;isp1760&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span>             <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">isp1760_priv</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">num_resources</span>  <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_isp1760_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span>       <span class="o">=</span> <span class="n">bfin_isp1760_resources</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_INPUT_BFIN_ROTARY) || defined(CONFIG_INPUT_BFIN_ROTARY_MODULE)</span>
<span class="cp">#include &lt;asm/bfin_rotary.h&gt;</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin_rotary_platform_data</span> <span class="n">bfin_rotary_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="cm">/*.rotary_up_key     = KEY_UP,*/</span>
	<span class="cm">/*.rotary_down_key   = KEY_DOWN,*/</span>
	<span class="p">.</span><span class="n">rotary_rel_code</span>   <span class="o">=</span> <span class="n">REL_WHEEL</span><span class="p">,</span>
	<span class="p">.</span><span class="n">rotary_button_key</span> <span class="o">=</span> <span class="n">KEY_ENTER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">debounce</span>	   <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>	<span class="cm">/* 0..17 */</span>
	<span class="p">.</span><span class="n">mode</span>		   <span class="o">=</span> <span class="n">ROT_QUAD_ENC</span> <span class="o">|</span> <span class="n">ROT_DEBE</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_rotary_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_CNT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_CNT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_rotary_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span>		<span class="o">=</span> <span class="s">&quot;bfin-rotary&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span>		<span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> 	<span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_rotary_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> 	<span class="o">=</span> <span class="n">bfin_rotary_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span>		<span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_rotary_data</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_STMMAC_ETH) || defined(CONFIG_STMMAC_ETH_MODULE)</span>
<span class="cp">#include &lt;linux/stmmac.h&gt;</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pins</span><span class="p">[]</span> <span class="o">=</span> <span class="n">P_RMII0</span><span class="p">;</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">stmmac_mdio_bus_data</span> <span class="n">phy_private_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">bus_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">phy_mask</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">plat_stmmacenet_data</span> <span class="n">eth_private_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">bus_id</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">enh_desc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">phy_addr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">mdio_bus_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">phy_private_data</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_eth_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span>           <span class="o">=</span> <span class="s">&quot;stmmaceth&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span>             <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">resource</span>       <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">resource</span><span class="p">[])</span> <span class="p">{</span>
		<span class="p">{</span>
			<span class="p">.</span><span class="n">start</span>  <span class="o">=</span> <span class="n">EMAC0_MACCFG</span><span class="p">,</span>
			<span class="p">.</span><span class="n">end</span>    <span class="o">=</span> <span class="n">EMAC0_MACCFG</span> <span class="o">+</span> <span class="mh">0x1274</span><span class="p">,</span>
			<span class="p">.</span><span class="n">flags</span>  <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="p">.</span><span class="n">name</span>   <span class="o">=</span> <span class="s">&quot;macirq&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">start</span>  <span class="o">=</span> <span class="n">IRQ_EMAC0_STAT</span><span class="p">,</span>
			<span class="p">.</span><span class="n">end</span>    <span class="o">=</span> <span class="n">IRQ_EMAC0_STAT</span><span class="p">,</span>
			<span class="p">.</span><span class="n">flags</span>  <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">power</span><span class="p">.</span><span class="n">can_wakeup</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">eth_private_data</span><span class="p">,</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_INPUT_ADXL34X) || defined(CONFIG_INPUT_ADXL34X_MODULE)</span>
<span class="cp">#include &lt;linux/input/adxl34x.h&gt;</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">adxl34x_platform_data</span> <span class="n">adxl34x_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">x_axis_offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">y_axis_offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">z_axis_offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tap_threshold</span> <span class="o">=</span> <span class="mh">0x31</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tap_duration</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tap_latency</span> <span class="o">=</span> <span class="mh">0x60</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tap_window</span> <span class="o">=</span> <span class="mh">0xF0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tap_axis_control</span> <span class="o">=</span> <span class="n">ADXL_TAP_X_EN</span> <span class="o">|</span> <span class="n">ADXL_TAP_Y_EN</span> <span class="o">|</span> <span class="n">ADXL_TAP_Z_EN</span><span class="p">,</span>
	<span class="p">.</span><span class="n">act_axis_control</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">,</span>
	<span class="p">.</span><span class="n">activity_threshold</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="p">.</span><span class="n">inactivity_threshold</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="p">.</span><span class="n">inactivity_time</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="p">.</span><span class="n">free_fall_threshold</span> <span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="p">.</span><span class="n">free_fall_time</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>
	<span class="p">.</span><span class="n">data_rate</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="p">.</span><span class="n">data_range</span> <span class="o">=</span> <span class="n">ADXL_FULL_RES</span><span class="p">,</span>

	<span class="p">.</span><span class="n">ev_type</span> <span class="o">=</span> <span class="n">EV_ABS</span><span class="p">,</span>
	<span class="p">.</span><span class="n">ev_code_x</span> <span class="o">=</span> <span class="n">ABS_X</span><span class="p">,</span>		<span class="cm">/* EV_REL */</span>
	<span class="p">.</span><span class="n">ev_code_y</span> <span class="o">=</span> <span class="n">ABS_Y</span><span class="p">,</span>		<span class="cm">/* EV_REL */</span>
	<span class="p">.</span><span class="n">ev_code_z</span> <span class="o">=</span> <span class="n">ABS_Z</span><span class="p">,</span>		<span class="cm">/* EV_REL */</span>

	<span class="p">.</span><span class="n">ev_code_tap</span> <span class="o">=</span> <span class="p">{</span><span class="n">BTN_TOUCH</span><span class="p">,</span> <span class="n">BTN_TOUCH</span><span class="p">,</span> <span class="n">BTN_TOUCH</span><span class="p">},</span> <span class="cm">/* EV_KEY x,y,z */</span>

<span class="cm">/*	.ev_code_ff = KEY_F,*/</span>		<span class="cm">/* EV_KEY */</span>
<span class="cm">/*	.ev_code_act_inactivity = KEY_A,*/</span>	<span class="cm">/* EV_KEY */</span>
	<span class="p">.</span><span class="n">power_mode</span> <span class="o">=</span> <span class="n">ADXL_AUTO_SLEEP</span> <span class="o">|</span> <span class="n">ADXL_LINK</span><span class="p">,</span>
	<span class="p">.</span><span class="n">fifo_mode</span> <span class="o">=</span> <span class="n">ADXL_FIFO_STREAM</span><span class="p">,</span>
	<span class="p">.</span><span class="n">orientation_enable</span> <span class="o">=</span> <span class="n">ADXL_EN_ORIENTATION_3D</span><span class="p">,</span>
	<span class="p">.</span><span class="n">deadzone_angle</span> <span class="o">=</span> <span class="n">ADXL_DEADZONE_ANGLE_10p8</span><span class="p">,</span>
	<span class="p">.</span><span class="n">divisor_length</span> <span class="o">=</span> <span class="n">ADXL_LP_FILTER_DIVISOR_16</span><span class="p">,</span>
	<span class="cm">/* EV_KEY {+Z, +Y, +X, -X, -Y, -Z} */</span>
	<span class="p">.</span><span class="n">ev_codes_orient_3d</span> <span class="o">=</span> <span class="p">{</span><span class="n">BTN_Z</span><span class="p">,</span> <span class="n">BTN_Y</span><span class="p">,</span> <span class="n">BTN_X</span><span class="p">,</span> <span class="n">BTN_A</span><span class="p">,</span> <span class="n">BTN_B</span><span class="p">,</span> <span class="n">BTN_C</span><span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_RTC_DRV_BFIN) || defined(CONFIG_RTC_DRV_BFIN_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">rtc_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;rtc-bfin&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span>   <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SERIAL_BFIN) || defined(CONFIG_SERIAL_BFIN_MODULE)</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_UART0</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_uart0_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">UART0_REVID</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">UART0_RXDIV</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART0_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART0_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_UART0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_UART0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_UART0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_UART0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#ifdef CONFIG_BFIN_UART0_CTSRTS</span>
	<span class="p">{</span>	<span class="cm">/* CTS pin -- 0 means not supported */</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">GPIO_PD10</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">GPIO_PD10</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>	<span class="cm">/* RTS pin -- 0 means not supported */</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">GPIO_PD9</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">GPIO_PD9</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bfin_uart0_peripherals</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_UART0_TX</span><span class="p">,</span> <span class="n">P_UART0_RX</span><span class="p">,</span>
<span class="cp">#ifdef CONFIG_BFIN_UART0_CTSRTS</span>
	<span class="n">P_UART0_RTS</span><span class="p">,</span> <span class="n">P_UART0_CTS</span><span class="p">,</span>
<span class="cp">#endif</span>
	<span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_uart0_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-uart&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_uart0_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_uart0_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_uart0_peripherals</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_UART1</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_uart1_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">UART1_REVID</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">UART1_RXDIV</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART1_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART1_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART1_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART1_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_UART1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_UART1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_UART1_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_UART1_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#ifdef CONFIG_BFIN_UART1_CTSRTS</span>
	<span class="p">{</span>	<span class="cm">/* CTS pin -- 0 means not supported */</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">GPIO_PG13</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">GPIO_PG13</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>	<span class="cm">/* RTS pin -- 0 means not supported */</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">GPIO_PG10</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">GPIO_PG10</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bfin_uart1_peripherals</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_UART1_TX</span><span class="p">,</span> <span class="n">P_UART1_RX</span><span class="p">,</span>
<span class="cp">#ifdef CONFIG_BFIN_UART1_CTSRTS</span>
	<span class="n">P_UART1_RTS</span><span class="p">,</span> <span class="n">P_UART1_CTS</span><span class="p">,</span>
<span class="cp">#endif</span>
	<span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_uart1_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-uart&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_uart1_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_uart1_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_uart1_peripherals</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_BFIN_SIR) || defined(CONFIG_BFIN_SIR_MODULE)</span>
<span class="cp">#ifdef CONFIG_BFIN_SIR0</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_sir0_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="mh">0xFFC00400</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="mh">0xFFC004FF</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART0_TX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_UART0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_UART0_TX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_sir0_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin_sir&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_sir0_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_sir0_resources</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_BFIN_SIR1</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_sir1_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="mh">0xFFC02000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="mh">0xFFC020FF</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_UART1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_UART1_TX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_UART1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_UART1_TX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_sir1_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin_sir&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_sir1_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_sir1_resources</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_USB_MUSB_HDRC) || defined(CONFIG_USB_MUSB_HDRC_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">musb_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">start</span>	<span class="o">=</span> <span class="mh">0xFFCC1000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>	<span class="o">=</span> <span class="mh">0xFFCC1398</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span>	<span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>	<span class="cm">/* general IRQ */</span>
		<span class="p">.</span><span class="n">start</span>	<span class="o">=</span> <span class="n">IRQ_USB_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>	<span class="o">=</span> <span class="n">IRQ_USB_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span>	<span class="o">=</span> <span class="n">IORESOURCE_IRQ</span> <span class="o">|</span> <span class="n">IORESOURCE_IRQ_HIGHLEVEL</span><span class="p">,</span>
		<span class="p">.</span><span class="n">name</span>	<span class="o">=</span> <span class="s">&quot;mc&quot;</span>
	<span class="p">},</span>
	<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>	<span class="cm">/* DMA IRQ */</span>
		<span class="p">.</span><span class="n">start</span>	<span class="o">=</span> <span class="n">IRQ_USB_DMA</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>	<span class="o">=</span> <span class="n">IRQ_USB_DMA</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span>	<span class="o">=</span> <span class="n">IORESOURCE_IRQ</span> <span class="o">|</span> <span class="n">IORESOURCE_IRQ_HIGHLEVEL</span><span class="p">,</span>
		<span class="p">.</span><span class="n">name</span>	<span class="o">=</span> <span class="s">&quot;dma&quot;</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">musb_hdrc_config</span> <span class="n">musb_config</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">multipoint</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dyn_fifo</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dma</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_eps</span>	<span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dma_channels</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="p">.</span><span class="n">clkin</span>          <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>           <span class="cm">/* musb CLKIN in MHZ */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">musb_hdrc_platform_data</span> <span class="n">musb_plat</span> <span class="o">=</span> <span class="p">{</span>
<span class="cp">#if defined(CONFIG_USB_MUSB_HDRC) &amp;&amp; defined(CONFIG_USB_GADGET_MUSB_HDRC)</span>
	<span class="p">.</span><span class="n">mode</span>		<span class="o">=</span> <span class="n">MUSB_OTG</span><span class="p">,</span>
<span class="cp">#elif defined(CONFIG_USB_MUSB_HDRC)</span>
	<span class="p">.</span><span class="n">mode</span>		<span class="o">=</span> <span class="n">MUSB_HOST</span><span class="p">,</span>
<span class="cp">#elif defined(CONFIG_USB_GADGET_MUSB_HDRC)</span>
	<span class="p">.</span><span class="n">mode</span>		<span class="o">=</span> <span class="n">MUSB_PERIPHERAL</span><span class="p">,</span>
<span class="cp">#endif</span>
	<span class="p">.</span><span class="n">config</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">musb_config</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="n">u64</span> <span class="n">musb_dmamask</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="mi">0</span><span class="p">;</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">musb_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span>		<span class="o">=</span> <span class="s">&quot;musb-blackfin&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">dma_mask</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">musb_dmamask</span><span class="p">,</span>
		<span class="p">.</span><span class="n">coherent_dma_mask</span>	<span class="o">=</span> <span class="mh">0xffffffff</span><span class="p">,</span>
		<span class="p">.</span><span class="n">platform_data</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">musb_plat</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">num_resources</span>	<span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">musb_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span>	<span class="o">=</span> <span class="n">musb_resources</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SERIAL_BFIN_SPORT) || defined(CONFIG_SERIAL_BFIN_SPORT_MODULE)</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT0_UART</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_sport0_uart_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">SPORT0_TCR1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">SPORT0_MRCS3</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_RX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_ERROR</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_ERROR</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bfin_sport0_peripherals</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_SPORT0_TFS</span><span class="p">,</span> <span class="n">P_SPORT0_DTPRI</span><span class="p">,</span> <span class="n">P_SPORT0_TSCLK</span><span class="p">,</span> <span class="n">P_SPORT0_RFS</span><span class="p">,</span>
	<span class="n">P_SPORT0_DRPRI</span><span class="p">,</span> <span class="n">P_SPORT0_RSCLK</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_sport0_uart_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-sport-uart&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_sport0_uart_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_sport0_uart_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_sport0_peripherals</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT1_UART</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_sport1_uart_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">SPORT1_TCR1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">SPORT1_MRCS3</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT1_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT1_RX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT1_ERROR</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT1_ERROR</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bfin_sport1_peripherals</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_SPORT1_TFS</span><span class="p">,</span> <span class="n">P_SPORT1_DTPRI</span><span class="p">,</span> <span class="n">P_SPORT1_TSCLK</span><span class="p">,</span> <span class="n">P_SPORT1_RFS</span><span class="p">,</span>
	<span class="n">P_SPORT1_DRPRI</span><span class="p">,</span> <span class="n">P_SPORT1_RSCLK</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_sport1_uart_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-sport-uart&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_sport1_uart_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_sport1_uart_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_sport1_peripherals</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT2_UART</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_sport2_uart_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">SPORT2_TCR1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">SPORT2_MRCS3</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT2_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT2_RX</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT2_ERROR</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT2_ERROR</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bfin_sport2_peripherals</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_SPORT2_TFS</span><span class="p">,</span> <span class="n">P_SPORT2_DTPRI</span><span class="p">,</span> <span class="n">P_SPORT2_TSCLK</span><span class="p">,</span> <span class="n">P_SPORT2_RFS</span><span class="p">,</span>
	<span class="n">P_SPORT2_DRPRI</span><span class="p">,</span> <span class="n">P_SPORT2_RSCLK</span><span class="p">,</span> <span class="n">P_SPORT2_DRSEC</span><span class="p">,</span> <span class="n">P_SPORT2_DTSEC</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_sport2_uart_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-sport-uart&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_sport2_uart_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_sport2_uart_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_sport2_peripherals</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_CAN_BFIN) || defined(CONFIG_CAN_BFIN_MODULE)</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bfin_can0_peripherals</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_CAN0_RX</span><span class="p">,</span> <span class="n">P_CAN0_TX</span><span class="p">,</span> <span class="mi">0</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_can0_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="mh">0xFFC00A00</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="mh">0xFFC00FFF</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_CAN0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_CAN0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_CAN0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_CAN0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_CAN0_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_CAN0_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_can0_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin_can&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_can0_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_can0_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_can0_peripherals</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_MTD_NAND_BF5XX) || defined(CONFIG_MTD_NAND_BF5XX_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">mtd_partition</span> <span class="n">partition_info</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bootloader(nand)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="mh">0x80000</span><span class="p">,</span>
	<span class="p">},</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;linux kernel(nand)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">MTDPART_OFS_APPEND</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;file system(nand)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">MTDPART_OFS_APPEND</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">MTDPART_SIZ_FULL</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bf5xx_nand_platform</span> <span class="n">bfin_nand_platform</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">data_width</span> <span class="o">=</span> <span class="n">NFC_NWIDTH_8</span><span class="p">,</span>
	<span class="p">.</span><span class="n">partitions</span> <span class="o">=</span> <span class="n">partition_info</span><span class="p">,</span>
	<span class="p">.</span><span class="n">nr_partitions</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">partition_info</span><span class="p">),</span>
	<span class="p">.</span><span class="n">rd_dly</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="p">.</span><span class="n">wr_dly</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_nand_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="mh">0xFFC03B00</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="mh">0xFFC03B4F</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_NFC</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_NFC</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_nand_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-nand&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_nand_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_nand_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_nand_platform</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SDH_BFIN) || defined(CONFIG_SDH_BFIN_MODULE)</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin_sd_host</span> <span class="n">bfin_sdh_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">dma_chan</span> <span class="o">=</span> <span class="n">CH_RSI</span><span class="p">,</span>
	<span class="p">.</span><span class="n">irq_int0</span> <span class="o">=</span> <span class="n">IRQ_RSI_INT0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pin_req</span> <span class="o">=</span> <span class="p">{</span><span class="n">P_RSI_DATA0</span><span class="p">,</span> <span class="n">P_RSI_DATA1</span><span class="p">,</span> <span class="n">P_RSI_DATA2</span><span class="p">,</span> <span class="n">P_RSI_DATA3</span><span class="p">,</span> <span class="n">P_RSI_CMD</span><span class="p">,</span> <span class="n">P_RSI_CLK</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_sdh_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-sdh&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_sdh_data</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_MTD_PHYSMAP) || defined(CONFIG_MTD_PHYSMAP_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">mtd_partition</span> <span class="n">ezkit_partitions</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">name</span>       <span class="o">=</span> <span class="s">&quot;bootloader(nor)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span>       <span class="o">=</span> <span class="mh">0x80000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span>     <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">},</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span>       <span class="o">=</span> <span class="s">&quot;linux kernel(nor)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span>       <span class="o">=</span> <span class="mh">0x400000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span>     <span class="o">=</span> <span class="n">MTDPART_OFS_APPEND</span><span class="p">,</span>
	<span class="p">},</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span>       <span class="o">=</span> <span class="s">&quot;file system(nor)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span>       <span class="o">=</span> <span class="mh">0x1000000</span> <span class="o">-</span> <span class="mh">0x80000</span> <span class="o">-</span> <span class="mh">0x400000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span>     <span class="o">=</span> <span class="n">MTDPART_OFS_APPEND</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="nf">bf609_nor_flash_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">platform_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#define CONFIG_SMC_GCTL_VAL     0x00000010</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pins</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="n">P_A3</span><span class="p">,</span> <span class="n">P_A4</span><span class="p">,</span> <span class="n">P_A5</span><span class="p">,</span> <span class="n">P_A6</span><span class="p">,</span> <span class="n">P_A7</span><span class="p">,</span> <span class="n">P_A8</span><span class="p">,</span> <span class="n">P_A9</span><span class="p">,</span> <span class="n">P_A10</span><span class="p">,</span> <span class="n">P_A11</span><span class="p">,</span> <span class="n">P_A12</span><span class="p">,</span>
		<span class="n">P_A13</span><span class="p">,</span> <span class="n">P_A14</span><span class="p">,</span> <span class="n">P_A15</span><span class="p">,</span> <span class="n">P_A16</span><span class="p">,</span> <span class="n">P_A17</span><span class="p">,</span> <span class="n">P_A18</span><span class="p">,</span> <span class="n">P_A19</span><span class="p">,</span> <span class="n">P_A20</span><span class="p">,</span> <span class="n">P_A21</span><span class="p">,</span>
		<span class="n">P_A22</span><span class="p">,</span> <span class="n">P_A23</span><span class="p">,</span> <span class="n">P_A24</span><span class="p">,</span> <span class="n">P_A25</span><span class="p">,</span> <span class="n">P_NORCK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">};</span>

	<span class="n">peripheral_request_list</span><span class="p">(</span><span class="n">pins</span><span class="p">,</span> <span class="s">&quot;smc0&quot;</span><span class="p">);</span>

	<span class="n">bfin_write32</span><span class="p">(</span><span class="n">SMC_GCTL</span><span class="p">,</span> <span class="n">CONFIG_SMC_GCTL_VAL</span><span class="p">);</span>
	<span class="n">bfin_write32</span><span class="p">(</span><span class="n">SMC_B0CTL</span><span class="p">,</span> <span class="mh">0x01002011</span><span class="p">);</span>
	<span class="n">bfin_write32</span><span class="p">(</span><span class="n">SMC_B0TIM</span><span class="p">,</span> <span class="mh">0x08170977</span><span class="p">);</span>
	<span class="n">bfin_write32</span><span class="p">(</span><span class="n">SMC_B0ETIM</span><span class="p">,</span> <span class="mh">0x00092231</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">physmap_flash_data</span> <span class="n">ezkit_flash_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">width</span>      <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">.</span><span class="n">parts</span>      <span class="o">=</span> <span class="n">ezkit_partitions</span><span class="p">,</span>
	<span class="p">.</span><span class="n">init</span> 	    <span class="o">=</span> <span class="n">bf609_nor_flash_init</span><span class="p">,</span>
	<span class="p">.</span><span class="n">nr_parts</span>   <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">ezkit_partitions</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">ezkit_flash_resource</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="mh">0xb0000000</span><span class="p">,</span>
	<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="mh">0xb0ffffff</span><span class="p">,</span>
	<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">ezkit_flash_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span>          <span class="o">=</span> <span class="s">&quot;physmap-flash&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span>            <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ezkit_flash_data</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">resource</span>      <span class="o">=</span> <span class="o">&amp;</span><span class="n">ezkit_flash_resource</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_MTD_M25P80) \</span>
<span class="cp">	|| defined(CONFIG_MTD_M25P80_MODULE)</span>
<span class="cm">/* SPI flash chip (w25q32) */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">mtd_partition</span> <span class="n">bfin_spi_flash_partitions</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bootloader(spi)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="mh">0x00080000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">mask_flags</span> <span class="o">=</span> <span class="n">MTD_CAP_ROM</span>
	<span class="p">},</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;linux kernel(spi)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="mh">0x00180000</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">MTDPART_OFS_APPEND</span><span class="p">,</span>
	<span class="p">},</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;file system(spi)&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">MTDPART_SIZ_FULL</span><span class="p">,</span>
		<span class="p">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">MTDPART_OFS_APPEND</span><span class="p">,</span>
	<span class="p">}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">flash_platform_data</span> <span class="n">bfin_spi_flash_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;m25p80&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">parts</span> <span class="o">=</span> <span class="n">bfin_spi_flash_partitions</span><span class="p">,</span>
	<span class="p">.</span><span class="n">nr_parts</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_spi_flash_partitions</span><span class="p">),</span>
	<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;w25q32&quot;</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin6xx_spi_chip</span> <span class="n">spi_flash_chip_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">enable_dma</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span>         <span class="cm">/* use dma transfer with this chip*/</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SPI_SPIDEV) || defined(CONFIG_SPI_SPIDEV_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin6xx_spi_chip</span> <span class="n">spidev_chip_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">enable_dma</span> <span class="o">=</span> <span class="nb">true</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SND_BF6XX_I2S) || defined(CONFIG_SND_BF6XX_I2S_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_i2s_pcm</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-i2s-pcm-audio&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SND_BF6XX_SOC_I2S) || \</span>
<span class="cp">	defined(CONFIG_SND_BF6XX_SOC_I2S_MODULE)</span>
<span class="cp">#include &lt;asm/bfin_sport3.h&gt;</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_snd_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">SPORT0_CTL_A</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">SPORT0_CTL_A</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">SPORT0_CTL_B</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">SPORT0_CTL_B</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_SPORT0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_SPORT0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_SPORT0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_SPORT0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_TX_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_TX_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_RX_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_SPORT0_RX_STAT</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bfin_snd_pin</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_SPORT0_ACLK</span><span class="p">,</span> <span class="n">P_SPORT0_AFS</span><span class="p">,</span> <span class="n">P_SPORT0_AD0</span><span class="p">,</span> <span class="n">P_SPORT0_BCLK</span><span class="p">,</span>
	<span class="n">P_SPORT0_BFS</span><span class="p">,</span> <span class="n">P_SPORT0_BD0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin_snd_platform_data</span> <span class="n">bfin_snd_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">pin_req</span> <span class="o">=</span> <span class="n">bfin_snd_pin</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_i2s</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-i2s&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_snd_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_snd_resources</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_snd_data</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SND_SOC_BFIN_EVAL_ADAU1X61) || \</span>
<span class="cp">	defined(CONFIG_SND_SOC_BFIN_EVAL_ADAU1X61_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">adau1761_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-eval-adau1x61&quot;</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SND_SOC_ADAU1761) || defined(CONFIG_SND_SOC_ADAU1761_MODULE)</span>
<span class="cp">#include &lt;sound/adau17x1.h&gt;</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">adau1761_platform_data</span> <span class="n">adau1761_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">lineout_mode</span> <span class="o">=</span> <span class="n">ADAU1761_OUTPUT_MODE_LINE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">headphone_mode</span> <span class="o">=</span> <span class="n">ADAU1761_OUTPUT_MODE_HEADPHONE_CAPLESS</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_VIDEO_BLACKFIN_CAPTURE) \</span>
<span class="cp">	|| defined(CONFIG_VIDEO_BLACKFIN_CAPTURE_MODULE)</span>
<span class="cp">#include &lt;linux/videodev2.h&gt;</span>
<span class="cp">#include &lt;media/blackfin/bfin_capture.h&gt;</span>
<span class="cp">#include &lt;media/blackfin/ppi.h&gt;</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ppi_req</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="n">P_PPI0_D0</span><span class="p">,</span> <span class="n">P_PPI0_D1</span><span class="p">,</span> <span class="n">P_PPI0_D2</span><span class="p">,</span> <span class="n">P_PPI0_D3</span><span class="p">,</span>
	<span class="n">P_PPI0_D4</span><span class="p">,</span> <span class="n">P_PPI0_D5</span><span class="p">,</span> <span class="n">P_PPI0_D6</span><span class="p">,</span> <span class="n">P_PPI0_D7</span><span class="p">,</span>
	<span class="n">P_PPI0_CLK</span><span class="p">,</span> <span class="n">P_PPI0_FS1</span><span class="p">,</span> <span class="n">P_PPI0_FS2</span><span class="p">,</span>
	<span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ppi_info</span> <span class="n">ppi_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">PPI_TYPE_EPPI3</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dma_ch</span> <span class="o">=</span> <span class="n">CH_EPPI0_CH0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">irq_err</span> <span class="o">=</span> <span class="n">IRQ_EPPI0_STAT</span><span class="p">,</span>
	<span class="p">.</span><span class="n">base</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">)</span><span class="n">EPPI0_STAT</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pin_req</span> <span class="o">=</span> <span class="n">ppi_req</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#if defined(CONFIG_VIDEO_VS6624) \</span>
<span class="cp">	|| defined(CONFIG_VIDEO_VS6624_MODULE)</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">v4l2_input</span> <span class="n">vs6624_inputs</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Camera&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">V4L2_INPUT_TYPE_CAMERA</span><span class="p">,</span>
		<span class="p">.</span><span class="n">std</span> <span class="o">=</span> <span class="n">V4L2_STD_UNKNOWN</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bcap_route</span> <span class="n">vs6624_routes</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">input</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">output</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="n">vs6624_ce_pin</span> <span class="o">=</span> <span class="n">GPIO_PD1</span><span class="p">;</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin_capture_config</span> <span class="n">bfin_capture_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">card_name</span> <span class="o">=</span> <span class="s">&quot;BF609&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">vs6624_inputs</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_inputs</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">vs6624_inputs</span><span class="p">),</span>
	<span class="p">.</span><span class="n">routes</span> <span class="o">=</span> <span class="n">vs6624_routes</span><span class="p">,</span>
	<span class="p">.</span><span class="n">i2c_adapter_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">board_info</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="s">&quot;vs6624&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">vs6624_ce_pin</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">.</span><span class="n">ppi_info</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ppi_info</span><span class="p">,</span>
	<span class="p">.</span><span class="n">ppi_control</span> <span class="o">=</span> <span class="p">(</span><span class="n">PACK_EN</span> <span class="o">|</span> <span class="n">DLEN_8</span> <span class="o">|</span> <span class="n">EPPI_CTL_FS1HI_FS2HI</span>
			<span class="o">|</span> <span class="n">EPPI_CTL_POLC3</span> <span class="o">|</span> <span class="n">EPPI_CTL_SYNC2</span> <span class="o">|</span> <span class="n">EPPI_CTL_NON656</span><span class="p">),</span>
	<span class="p">.</span><span class="n">blank_clocks</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_capture_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin_capture&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_capture_data</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_BFIN_CRC)</span>
<span class="cp">#define BFIN_CRC_NAME &quot;bfin-crc&quot;</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_crc0_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">REG_CRC0_CTL</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">REG_CRC0_REVID</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_CRC0_DCNTEXP</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_CRC0_DCNTEXP</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM0_SRC_CRC0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM0_SRC_CRC0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM0_DEST_CRC0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM0_DEST_CRC0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_crc0_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">BFIN_CRC_NAME</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_crc0_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_crc0_resources</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_crc1_resources</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">REG_CRC1_CTL</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">REG_CRC1_REVID</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_CRC1_DCNTEXP</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">IRQ_CRC1_DCNTEXP</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM1_SRC_CRC1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM1_SRC_CRC1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM1_DEST_CRC1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">CH_MEM_STREAM1_DEST_CRC1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_crc1_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">BFIN_CRC_NAME</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_crc1_resources</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_crc1_resources</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_TOUCHSCREEN_AD7877) || defined(CONFIG_TOUCHSCREEN_AD7877_MODULE)</span>
<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ad7877_platform_data</span> <span class="n">bfin_ad7877_ts_info</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">model</span>			<span class="o">=</span> <span class="mi">7877</span><span class="p">,</span>
	<span class="p">.</span><span class="n">vref_delay_usecs</span>	<span class="o">=</span> <span class="mi">50</span><span class="p">,</span>	<span class="cm">/* internal, no capacitor */</span>
	<span class="p">.</span><span class="n">x_plate_ohms</span>		<span class="o">=</span> <span class="mi">419</span><span class="p">,</span>
	<span class="p">.</span><span class="n">y_plate_ohms</span>		<span class="o">=</span> <span class="mi">486</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pressure_max</span>		<span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pressure_min</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">stopacq_polarity</span> 	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">first_conversion_delay</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="p">.</span><span class="n">acquisition_time</span> 	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">averaging</span> 		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pen_down_acc_interval</span> 	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">spi_board_info</span> <span class="n">bfin_spi_board_info</span><span class="p">[]</span> <span class="n">__initdata</span> <span class="o">=</span> <span class="p">{</span>
<span class="cp">#if defined(CONFIG_MTD_M25P80) \</span>
<span class="cp">	|| defined(CONFIG_MTD_M25P80_MODULE)</span>
	<span class="p">{</span>
		<span class="cm">/* the modalias must be the same as spi device driver name */</span>
		<span class="p">.</span><span class="n">modalias</span> <span class="o">=</span> <span class="s">&quot;m25p80&quot;</span><span class="p">,</span> <span class="cm">/* Name of spi_driver for this device */</span>
		<span class="p">.</span><span class="n">max_speed_hz</span> <span class="o">=</span> <span class="mi">25000000</span><span class="p">,</span>     <span class="cm">/* max spi clock (SCK) speed in HZ */</span>
		<span class="p">.</span><span class="n">bus_num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="cm">/* Framework bus number */</span>
		<span class="p">.</span><span class="n">chip_select</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="cm">/* SPI_SSEL1*/</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_spi_flash_data</span><span class="p">,</span>
		<span class="p">.</span><span class="n">controller_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spi_flash_chip_info</span><span class="p">,</span>
		<span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">SPI_MODE_3</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_TOUCHSCREEN_AD7877) || defined(CONFIG_TOUCHSCREEN_AD7877_MODULE)</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">modalias</span>		<span class="o">=</span> <span class="s">&quot;ad7877&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">platform_data</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_ad7877_ts_info</span><span class="p">,</span>
		<span class="p">.</span><span class="n">irq</span>			<span class="o">=</span> <span class="n">IRQ_PB4</span><span class="p">,</span>	<span class="cm">/* old boards (&lt;=Rev 1.3) use IRQ_PJ11 */</span>
		<span class="p">.</span><span class="n">max_speed_hz</span>		<span class="o">=</span> <span class="mi">12500000</span><span class="p">,</span>     <span class="cm">/* max spi clock (SCK) speed in HZ */</span>
		<span class="p">.</span><span class="n">bus_num</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">chip_select</span>  		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_SPI_SPIDEV) || defined(CONFIG_SPI_SPIDEV_MODULE)</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">modalias</span> <span class="o">=</span> <span class="s">&quot;spidev&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">max_speed_hz</span> <span class="o">=</span> <span class="mi">3125000</span><span class="p">,</span>     <span class="cm">/* max spi clock (SCK) speed in HZ */</span>
		<span class="p">.</span><span class="n">bus_num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">chip_select</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">controller_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">spidev_chip_info</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_INPUT_ADXL34X_SPI) || defined(CONFIG_INPUT_ADXL34X_SPI_MODULE)</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">modalias</span>		<span class="o">=</span> <span class="s">&quot;adxl34x&quot;</span><span class="p">,</span>
		<span class="p">.</span><span class="n">platform_data</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">adxl34x_info</span><span class="p">,</span>
		<span class="p">.</span><span class="n">irq</span>			<span class="o">=</span> <span class="n">IRQ_PC5</span><span class="p">,</span>
		<span class="p">.</span><span class="n">max_speed_hz</span>		<span class="o">=</span> <span class="mi">5000000</span><span class="p">,</span>     <span class="cm">/* max spi clock (SCK) speed in HZ */</span>
		<span class="p">.</span><span class="n">bus_num</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">chip_select</span>  		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
		<span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">SPI_MODE_3</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="p">};</span>
<span class="cp">#if defined(CONFIG_SPI_BFIN6XX) || defined(CONFIG_SPI_BFIN6XX_MODULE)</span>
<span class="cm">/* SPI (0) */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_spi0_resource</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">SPI0_REGBASE</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">SPI0_REGBASE</span> <span class="o">+</span> <span class="mh">0xFF</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_SPI0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">CH_SPI0_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_SPI0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">CH_SPI0_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="cm">/* SPI (1) */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_spi1_resource</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">SPI1_REGBASE</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">SPI1_REGBASE</span> <span class="o">+</span> <span class="mh">0xFF</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_SPI1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">CH_SPI1_TX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">CH_SPI1_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">CH_SPI1_RX</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span>
	<span class="p">},</span>

<span class="p">};</span>

<span class="cm">/* SPI controller data */</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin6xx_spi_master</span> <span class="n">bf60x_spi_master_info0</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">num_chipselect</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pin_req</span> <span class="o">=</span> <span class="p">{</span><span class="n">P_SPI0_SCK</span><span class="p">,</span> <span class="n">P_SPI0_MISO</span><span class="p">,</span> <span class="n">P_SPI0_MOSI</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bf60x_spi_master0</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-spi&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="cm">/* Bus number */</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_spi0_resource</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_spi0_resource</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bf60x_spi_master_info0</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin6xx_spi_master</span> <span class="n">bf60x_spi_master_info1</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">num_chipselect</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="p">.</span><span class="n">pin_req</span> <span class="o">=</span> <span class="p">{</span><span class="n">P_SPI1_SCK</span><span class="p">,</span> <span class="n">P_SPI1_MISO</span><span class="p">,</span> <span class="n">P_SPI1_MOSI</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bf60x_spi_master1</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin-spi&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="cm">/* Bus number */</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_spi1_resource</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_spi1_resource</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bf60x_spi_master_info1</span><span class="p">,</span> <span class="cm">/* Passed to driver */</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif  </span><span class="cm">/* spi master and devices */</span><span class="cp"></span>

<span class="cp">#if defined(CONFIG_I2C_BLACKFIN_TWI) || defined(CONFIG_I2C_BLACKFIN_TWI_MODULE)</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">u16</span> <span class="n">bfin_twi0_pins</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">P_TWI0_SCL</span><span class="p">,</span> <span class="n">P_TWI0_SDA</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_twi0_resource</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">TWI0_CLKDIV</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">TWI0_CLKDIV</span> <span class="o">+</span> <span class="mh">0xFF</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_TWI0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">IRQ_TWI0</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">i2c_bfin_twi0_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;i2c-bfin-twi&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_twi0_resource</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_twi0_resource</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_twi0_pins</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u16</span> <span class="n">bfin_twi1_pins</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="n">P_TWI1_SCL</span><span class="p">,</span> <span class="n">P_TWI1_SDA</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">resource</span> <span class="n">bfin_twi1_resource</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">TWI1_CLKDIV</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">TWI1_CLKDIV</span> <span class="o">+</span> <span class="mh">0xFF</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span>
	<span class="p">},</span>
	<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">IRQ_TWI1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">IRQ_TWI1</span><span class="p">,</span>
		<span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">i2c_bfin_twi1_device</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;i2c-bfin-twi&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">num_resources</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_twi1_resource</span><span class="p">),</span>
	<span class="p">.</span><span class="n">resource</span> <span class="o">=</span> <span class="n">bfin_twi1_resource</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_twi1_pins</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">i2c_board_info</span> <span class="n">__initdata</span> <span class="n">bfin_i2c_board_info0</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="cp">#if defined(CONFIG_INPUT_ADXL34X_I2C) || defined(CONFIG_INPUT_ADXL34X_I2C_MODULE)</span>
	<span class="p">{</span>
		<span class="n">I2C_BOARD_INFO</span><span class="p">(</span><span class="s">&quot;adxl34x&quot;</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">),</span>
		<span class="p">.</span><span class="n">irq</span> <span class="o">=</span> <span class="n">IRQ_PC5</span><span class="p">,</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">adxl34x_info</span><span class="p">,</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_SND_SOC_ADAU1761) || defined(CONFIG_SND_SOC_ADAU1761_MODULE)</span>
	<span class="p">{</span>
		<span class="n">I2C_BOARD_INFO</span><span class="p">(</span><span class="s">&quot;adau1761&quot;</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">),</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">adau1761_info</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">i2c_board_info</span> <span class="n">__initdata</span> <span class="n">bfin_i2c_board_info1</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cclk_vlev_datasheet</span><span class="p">[]</span> <span class="o">=</span>
<span class="p">{</span>
<span class="cm">/*</span>
<span class="cm"> * Internal VLEV BF54XSBBC1533</span>
<span class="cm"> ****temporarily using these values until data sheet is updated</span>
<span class="cm"> */</span>
	<span class="n">VRPAIR</span><span class="p">(</span><span class="n">VLEV_085</span><span class="p">,</span> <span class="mi">150000000</span><span class="p">),</span>
	<span class="n">VRPAIR</span><span class="p">(</span><span class="n">VLEV_090</span><span class="p">,</span> <span class="mi">250000000</span><span class="p">),</span>
	<span class="n">VRPAIR</span><span class="p">(</span><span class="n">VLEV_110</span><span class="p">,</span> <span class="mi">276000000</span><span class="p">),</span>
	<span class="n">VRPAIR</span><span class="p">(</span><span class="n">VLEV_115</span><span class="p">,</span> <span class="mi">301000000</span><span class="p">),</span>
	<span class="n">VRPAIR</span><span class="p">(</span><span class="n">VLEV_120</span><span class="p">,</span> <span class="mi">525000000</span><span class="p">),</span>
	<span class="n">VRPAIR</span><span class="p">(</span><span class="n">VLEV_125</span><span class="p">,</span> <span class="mi">550000000</span><span class="p">),</span>
	<span class="n">VRPAIR</span><span class="p">(</span><span class="n">VLEV_130</span><span class="p">,</span> <span class="mi">600000000</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">bfin_dpmc_platform_data</span> <span class="n">bfin_dmpc_vreg_data</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">tuple_tab</span> <span class="o">=</span> <span class="n">cclk_vlev_datasheet</span><span class="p">,</span>
	<span class="p">.</span><span class="n">tabsize</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">cclk_vlev_datasheet</span><span class="p">),</span>
	<span class="p">.</span><span class="n">vr_settling_time</span> <span class="o">=</span> <span class="mi">25</span> <span class="cm">/* us */</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="n">bfin_dpmc</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;bfin dpmc&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">bfin_dmpc_vreg_data</span><span class="p">,</span>
	<span class="p">},</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="o">*</span><span class="n">ezkit_devices</span><span class="p">[]</span> <span class="n">__initdata</span> <span class="o">=</span> <span class="p">{</span>

	<span class="o">&amp;</span><span class="n">bfin_dpmc</span><span class="p">,</span>

<span class="cp">#if defined(CONFIG_RTC_DRV_BFIN) || defined(CONFIG_RTC_DRV_BFIN_MODULE)</span>
	<span class="o">&amp;</span><span class="n">rtc_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SERIAL_BFIN) || defined(CONFIG_SERIAL_BFIN_MODULE)</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_UART0</span>
	<span class="o">&amp;</span><span class="n">bfin_uart0_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_UART1</span>
	<span class="o">&amp;</span><span class="n">bfin_uart1_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_BFIN_SIR) || defined(CONFIG_BFIN_SIR_MODULE)</span>
<span class="cp">#ifdef CONFIG_BFIN_SIR0</span>
	<span class="o">&amp;</span><span class="n">bfin_sir0_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_BFIN_SIR1</span>
	<span class="o">&amp;</span><span class="n">bfin_sir1_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_STMMAC_ETH) || defined(CONFIG_STMMAC_ETH_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_eth_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_USB_MUSB_HDRC) || defined(CONFIG_USB_MUSB_HDRC_MODULE)</span>
	<span class="o">&amp;</span><span class="n">musb_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_USB_ISP1760_HCD) || defined(CONFIG_USB_ISP1760_HCD_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_isp1760_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SERIAL_BFIN_SPORT) || defined(CONFIG_SERIAL_BFIN_SPORT_MODULE)</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT0_UART</span>
	<span class="o">&amp;</span><span class="n">bfin_sport0_uart_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT1_UART</span>
	<span class="o">&amp;</span><span class="n">bfin_sport1_uart_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT2_UART</span>
	<span class="o">&amp;</span><span class="n">bfin_sport2_uart_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_CAN_BFIN) || defined(CONFIG_CAN_BFIN_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_can0_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_MTD_NAND_BF5XX) || defined(CONFIG_MTD_NAND_BF5XX_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_nand_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SDH_BFIN) || defined(CONFIG_SDH_BFIN_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_sdh_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SPI_BFIN6XX) || defined(CONFIG_SPI_BFIN6XX_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bf60x_spi_master0</span><span class="p">,</span>
	<span class="o">&amp;</span><span class="n">bf60x_spi_master1</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_INPUT_BFIN_ROTARY) || defined(CONFIG_INPUT_BFIN_ROTARY_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_rotary_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_I2C_BLACKFIN_TWI) || defined(CONFIG_I2C_BLACKFIN_TWI_MODULE)</span>
	<span class="o">&amp;</span><span class="n">i2c_bfin_twi0_device</span><span class="p">,</span>
<span class="cp">#if !defined(CONFIG_BF542)</span>
	<span class="o">&amp;</span><span class="n">i2c_bfin_twi1_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_BFIN_CRC)</span>
	<span class="o">&amp;</span><span class="n">bfin_crc0_device</span><span class="p">,</span>
	<span class="o">&amp;</span><span class="n">bfin_crc1_device</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_KEYBOARD_GPIO) || defined(CONFIG_KEYBOARD_GPIO_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_device_gpiokeys</span><span class="p">,</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_MTD_PHYSMAP) || defined(CONFIG_MTD_PHYSMAP_MODULE)</span>
	<span class="o">&amp;</span><span class="n">ezkit_flash_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_SND_BF6XX_I2S) || defined(CONFIG_SND_BF6XX_I2S_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_i2s_pcm</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_SND_BF6XX_SOC_I2S) || \</span>
<span class="cp">	defined(CONFIG_SND_BF6XX_SOC_I2S_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_i2s</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_SND_SOC_BFIN_EVAL_ADAU1X61) || \</span>
<span class="cp">	defined(CONFIG_SND_SOC_BFIN_EVAL_ADAU1X61_MODULE)</span>
	<span class="o">&amp;</span><span class="n">adau1761_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#if defined(CONFIG_VIDEO_BLACKFIN_CAPTURE) \</span>
<span class="cp">	|| defined(CONFIG_VIDEO_BLACKFIN_CAPTURE_MODULE)</span>
	<span class="o">&amp;</span><span class="n">bfin_capture_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">ezkit_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;%s(): registering device resources</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>

	<span class="n">i2c_register_board_info</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">bfin_i2c_board_info0</span><span class="p">,</span>
				<span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_i2c_board_info0</span><span class="p">));</span>
	<span class="n">i2c_register_board_info</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">bfin_i2c_board_info1</span><span class="p">,</span>
				<span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_i2c_board_info1</span><span class="p">));</span>

<span class="cp">#if defined(CONFIG_STMMAC_ETH) || defined(CONFIG_STMMAC_ETH_MODULE)</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">peripheral_request_list</span><span class="p">(</span><span class="n">pins</span><span class="p">,</span> <span class="s">&quot;emac0&quot;</span><span class="p">))</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_ERR</span> <span class="s">&quot;%s(): request emac pins failed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
<span class="cp">#endif</span>

	<span class="n">platform_add_devices</span><span class="p">(</span><span class="n">ezkit_devices</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">ezkit_devices</span><span class="p">));</span>

	<span class="n">spi_register_board_info</span><span class="p">(</span><span class="n">bfin_spi_board_info</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">bfin_spi_board_info</span><span class="p">));</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">arch_initcall</span><span class="p">(</span><span class="n">ezkit_init</span><span class="p">);</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">platform_device</span> <span class="o">*</span><span class="n">ezkit_early_devices</span><span class="p">[]</span> <span class="n">__initdata</span> <span class="o">=</span> <span class="p">{</span>
<span class="cp">#if defined(CONFIG_SERIAL_BFIN_CONSOLE) || defined(CONFIG_EARLY_PRINTK)</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_UART0</span>
	<span class="o">&amp;</span><span class="n">bfin_uart0_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_UART1</span>
	<span class="o">&amp;</span><span class="n">bfin_uart1_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(CONFIG_SERIAL_BFIN_SPORT_CONSOLE)</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT0_UART</span>
	<span class="o">&amp;</span><span class="n">bfin_sport0_uart_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT1_UART</span>
	<span class="o">&amp;</span><span class="n">bfin_sport1_uart_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_SERIAL_BFIN_SPORT2_UART</span>
	<span class="o">&amp;</span><span class="n">bfin_sport2_uart_device</span><span class="p">,</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="n">__init</span> <span class="nf">native_machine_early_platform_add_devices</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;register early platform devices</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">early_platform_add_devices</span><span class="p">(</span><span class="n">ezkit_early_devices</span><span class="p">,</span>
		<span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">ezkit_early_devices</span><span class="p">));</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
