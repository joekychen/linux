<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › blackfin › include › asm › bfin_rotary.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>bfin_rotary.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * board initialization should put one of these structures into platform_data</span>
<span class="cm"> * and place the bfin-rotary onto platform_bus named &quot;bfin-rotary&quot;.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2008-2010 Analog Devices Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the GPL-2 or later.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _BFIN_ROTARY_H</span>
<span class="cp">#define _BFIN_ROTARY_H</span>

<span class="cm">/* mode bitmasks */</span>
<span class="cp">#define ROT_QUAD_ENC	CNTMODE_QUADENC	</span><span class="cm">/* quadrature/grey code encoder mode */</span><span class="cp"></span>
<span class="cp">#define ROT_BIN_ENC	CNTMODE_BINENC	</span><span class="cm">/* binary encoder mode */</span><span class="cp"></span>
<span class="cp">#define ROT_UD_CNT	CNTMODE_UDCNT	</span><span class="cm">/* rotary counter mode */</span><span class="cp"></span>
<span class="cp">#define ROT_DIR_CNT	CNTMODE_DIRCNT	</span><span class="cm">/* direction counter mode */</span><span class="cp"></span>

<span class="cp">#define ROT_DEBE	DEBE		</span><span class="cm">/* Debounce Enable */</span><span class="cp"></span>

<span class="cp">#define ROT_CDGINV	CDGINV		</span><span class="cm">/* CDG Pin Polarity Invert */</span><span class="cp"></span>
<span class="cp">#define ROT_CUDINV	CUDINV		</span><span class="cm">/* CUD Pin Polarity Invert */</span><span class="cp"></span>
<span class="cp">#define ROT_CZMINV	CZMINV		</span><span class="cm">/* CZM Pin Polarity Invert */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">bfin_rotary_platform_data</span> <span class="p">{</span>
	<span class="cm">/* set rotary UP KEY_### or BTN_### in case you prefer</span>
<span class="cm">	 * bfin-rotary to send EV_KEY otherwise set 0</span>
<span class="cm">	 */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rotary_up_key</span><span class="p">;</span>
	<span class="cm">/* set rotary DOWN KEY_### or BTN_### in case you prefer</span>
<span class="cm">	 * bfin-rotary to send EV_KEY otherwise set 0</span>
<span class="cm">	 */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rotary_down_key</span><span class="p">;</span>
	<span class="cm">/* set rotary BUTTON KEY_### or BTN_### */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rotary_button_key</span><span class="p">;</span>
	<span class="cm">/* set rotary Relative Axis REL_### in case you prefer</span>
<span class="cm">	 * bfin-rotary to send EV_REL otherwise set 0</span>
<span class="cm">	 */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rotary_rel_code</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">debounce</span><span class="p">;</span>	<span class="cm">/* 0..17 */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pm_wakeup</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* CNT_CONFIG bitmasks */</span>
<span class="cp">#define CNTE		(1 &lt;&lt; 0)	</span><span class="cm">/* Counter Enable */</span><span class="cp"></span>
<span class="cp">#define DEBE		(1 &lt;&lt; 1)	</span><span class="cm">/* Debounce Enable */</span><span class="cp"></span>
<span class="cp">#define CDGINV		(1 &lt;&lt; 4)	</span><span class="cm">/* CDG Pin Polarity Invert */</span><span class="cp"></span>
<span class="cp">#define CUDINV		(1 &lt;&lt; 5)	</span><span class="cm">/* CUD Pin Polarity Invert */</span><span class="cp"></span>
<span class="cp">#define CZMINV		(1 &lt;&lt; 6)	</span><span class="cm">/* CZM Pin Polarity Invert */</span><span class="cp"></span>
<span class="cp">#define CNTMODE_SHIFT	8</span>
<span class="cp">#define CNTMODE		(0x7 &lt;&lt; CNTMODE_SHIFT)	</span><span class="cm">/* Counter Operating Mode */</span><span class="cp"></span>
<span class="cp">#define ZMZC		(1 &lt;&lt; 1)	</span><span class="cm">/* CZM Zeroes Counter Enable */</span><span class="cp"></span>
<span class="cp">#define BNDMODE_SHIFT	12</span>
<span class="cp">#define BNDMODE		(0x3 &lt;&lt; BNDMODE_SHIFT)	</span><span class="cm">/* Boundary register Mode */</span><span class="cp"></span>
<span class="cp">#define INPDIS		(1 &lt;&lt; 15)	</span><span class="cm">/* CUG and CDG Input Disable */</span><span class="cp"></span>

<span class="cp">#define CNTMODE_QUADENC	(0 &lt;&lt; CNTMODE_SHIFT)	</span><span class="cm">/* quadrature encoder mode */</span><span class="cp"></span>
<span class="cp">#define CNTMODE_BINENC	(1 &lt;&lt; CNTMODE_SHIFT)	</span><span class="cm">/* binary encoder mode */</span><span class="cp"></span>
<span class="cp">#define CNTMODE_UDCNT	(2 &lt;&lt; CNTMODE_SHIFT)	</span><span class="cm">/* up/down counter mode */</span><span class="cp"></span>
<span class="cp">#define CNTMODE_DIRCNT	(4 &lt;&lt; CNTMODE_SHIFT)	</span><span class="cm">/* direction counter mode */</span><span class="cp"></span>
<span class="cp">#define CNTMODE_DIRTMR	(5 &lt;&lt; CNTMODE_SHIFT)	</span><span class="cm">/* direction timer mode */</span><span class="cp"></span>

<span class="cp">#define BNDMODE_COMP	(0 &lt;&lt; BNDMODE_SHIFT)	</span><span class="cm">/* boundary compare mode */</span><span class="cp"></span>
<span class="cp">#define BNDMODE_ZERO	(1 &lt;&lt; BNDMODE_SHIFT)	</span><span class="cm">/* boundary compare and zero mode */</span><span class="cp"></span>
<span class="cp">#define BNDMODE_CAPT	(2 &lt;&lt; BNDMODE_SHIFT)	</span><span class="cm">/* boundary capture mode */</span><span class="cp"></span>
<span class="cp">#define BNDMODE_AEXT	(3 &lt;&lt; BNDMODE_SHIFT)	</span><span class="cm">/* boundary auto-extend mode */</span><span class="cp"></span>

<span class="cm">/* CNT_IMASK bitmasks */</span>
<span class="cp">#define ICIE		(1 &lt;&lt; 0)	</span><span class="cm">/* Illegal Gray/Binary Code Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define UCIE		(1 &lt;&lt; 1)	</span><span class="cm">/* Up count Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define DCIE		(1 &lt;&lt; 2)	</span><span class="cm">/* Down count Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define MINCIE		(1 &lt;&lt; 3)	</span><span class="cm">/* Min Count Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define MAXCIE		(1 &lt;&lt; 4)	</span><span class="cm">/* Max Count Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define COV31IE		(1 &lt;&lt; 5)	</span><span class="cm">/* Bit 31 Overflow Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define COV15IE		(1 &lt;&lt; 6)	</span><span class="cm">/* Bit 15 Overflow Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define CZEROIE		(1 &lt;&lt; 7)	</span><span class="cm">/* Count to Zero Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define CZMIE		(1 &lt;&lt; 8)	</span><span class="cm">/* CZM Pin Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define CZMEIE		(1 &lt;&lt; 9)	</span><span class="cm">/* CZM Error Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define CZMZIE		(1 &lt;&lt; 10)	</span><span class="cm">/* CZM Zeroes Counter Interrupt Enable */</span><span class="cp"></span>

<span class="cm">/* CNT_STATUS bitmasks */</span>
<span class="cp">#define ICII		(1 &lt;&lt; 0)	</span><span class="cm">/* Illegal Gray/Binary Code Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define UCII		(1 &lt;&lt; 1)	</span><span class="cm">/* Up count Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define DCII		(1 &lt;&lt; 2)	</span><span class="cm">/* Down count Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define MINCII		(1 &lt;&lt; 3)	</span><span class="cm">/* Min Count Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define MAXCII		(1 &lt;&lt; 4)	</span><span class="cm">/* Max Count Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define COV31II		(1 &lt;&lt; 5)	</span><span class="cm">/* Bit 31 Overflow Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define COV15II		(1 &lt;&lt; 6)	</span><span class="cm">/* Bit 15 Overflow Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define CZEROII		(1 &lt;&lt; 7)	</span><span class="cm">/* Count to Zero Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define CZMII		(1 &lt;&lt; 8)	</span><span class="cm">/* CZM Pin Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define CZMEII		(1 &lt;&lt; 9)	</span><span class="cm">/* CZM Error Interrupt Identifier */</span><span class="cp"></span>
<span class="cp">#define CZMZII		(1 &lt;&lt; 10)	</span><span class="cm">/* CZM Zeroes Counter Interrupt Identifier */</span><span class="cp"></span>

<span class="cm">/* CNT_COMMAND bitmasks */</span>
<span class="cp">#define W1LCNT		0xf		</span><span class="cm">/* Load Counter Register */</span><span class="cp"></span>
<span class="cp">#define W1LMIN		0xf0		</span><span class="cm">/* Load Min Register */</span><span class="cp"></span>
<span class="cp">#define W1LMAX		0xf00		</span><span class="cm">/* Load Max Register */</span><span class="cp"></span>
<span class="cp">#define W1ZMONCE	(1 &lt;&lt; 12)	</span><span class="cm">/* Enable CZM Clear Counter Once */</span><span class="cp"></span>

<span class="cp">#define W1LCNT_ZERO	(1 &lt;&lt; 0)	</span><span class="cm">/* write 1 to load CNT_COUNTER with zero */</span><span class="cp"></span>
<span class="cp">#define W1LCNT_MIN	(1 &lt;&lt; 2)	</span><span class="cm">/* write 1 to load CNT_COUNTER from CNT_MIN */</span><span class="cp"></span>
<span class="cp">#define W1LCNT_MAX	(1 &lt;&lt; 3)	</span><span class="cm">/* write 1 to load CNT_COUNTER from CNT_MAX */</span><span class="cp"></span>

<span class="cp">#define W1LMIN_ZERO	(1 &lt;&lt; 4)	</span><span class="cm">/* write 1 to load CNT_MIN with zero */</span><span class="cp"></span>
<span class="cp">#define W1LMIN_CNT	(1 &lt;&lt; 5)	</span><span class="cm">/* write 1 to load CNT_MIN from CNT_COUNTER */</span><span class="cp"></span>
<span class="cp">#define W1LMIN_MAX	(1 &lt;&lt; 7)	</span><span class="cm">/* write 1 to load CNT_MIN from CNT_MAX */</span><span class="cp"></span>

<span class="cp">#define W1LMAX_ZERO	(1 &lt;&lt; 8)	</span><span class="cm">/* write 1 to load CNT_MAX with zero */</span><span class="cp"></span>
<span class="cp">#define W1LMAX_CNT	(1 &lt;&lt; 9)	</span><span class="cm">/* write 1 to load CNT_MAX from CNT_COUNTER */</span><span class="cp"></span>
<span class="cp">#define W1LMAX_MIN	(1 &lt;&lt; 10)	</span><span class="cm">/* write 1 to load CNT_MAX from CNT_MIN */</span><span class="cp"></span>

<span class="cm">/* CNT_DEBOUNCE bitmasks */</span>
<span class="cp">#define DPRESCALE	0xf		</span><span class="cm">/* Load Counter Register */</span><span class="cp"></span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
