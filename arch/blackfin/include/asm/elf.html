<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › blackfin › include › asm › elf.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>elf.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright 2004-2009 Analog Devices Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the GPL-2 or later.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __ASMBFIN_ELF_H</span>
<span class="cp">#define __ASMBFIN_ELF_H</span>

<span class="cm">/*</span>
<span class="cm"> * ELF register definitions..</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;asm/ptrace.h&gt;</span>
<span class="cp">#include &lt;asm/user.h&gt;</span>

<span class="cm">/* Processor specific flags for the ELF header e_flags field.  */</span>
<span class="cp">#define EF_BFIN_PIC		0x00000001	</span><span class="cm">/* -fpic */</span><span class="cp"></span>
<span class="cp">#define EF_BFIN_FDPIC		0x00000002	</span><span class="cm">/* -mfdpic */</span><span class="cp"></span>
<span class="cp">#define EF_BFIN_CODE_IN_L1	0x00000010	</span><span class="cm">/* --code-in-l1 */</span><span class="cp"></span>
<span class="cp">#define EF_BFIN_DATA_IN_L1	0x00000020	</span><span class="cm">/* --data-in-l1 */</span><span class="cp"></span>
<span class="cp">#define EF_BFIN_CODE_IN_L2	0x00000040	</span><span class="cm">/* --code-in-l2 */</span><span class="cp"></span>
<span class="cp">#define EF_BFIN_DATA_IN_L2	0x00000080	</span><span class="cm">/* --data-in-l2 */</span><span class="cp"></span>

<span class="cp">#if 1	</span><span class="cm">/* core dumps not supported, but linux/elfcore.h needs these */</span><span class="cp"></span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_greg_t</span><span class="p">;</span>

<span class="cp">#define ELF_NGREG (sizeof(struct pt_regs) / sizeof(elf_greg_t))</span>
<span class="k">typedef</span> <span class="n">elf_greg_t</span> <span class="n">elf_gregset_t</span><span class="p">[</span><span class="n">ELF_NGREG</span><span class="p">];</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span> <span class="p">}</span> <span class="n">elf_fpregset_t</span><span class="p">;</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * This is used to ensure we don&#39;t load something for the wrong architecture.</span>
<span class="cm"> */</span>
<span class="cp">#define elf_check_arch(x) ((x)-&gt;e_machine == EM_BLACKFIN)</span>

<span class="cp">#define elf_check_fdpic(x) ((x)-&gt;e_flags &amp; EF_BFIN_FDPIC </span><span class="cm">/* &amp;&amp; !((x)-&gt;e_flags &amp; EF_FRV_NON_PIC_RELOCS) */</span><span class="cp">)</span>
<span class="cp">#define elf_check_const_displacement(x) ((x)-&gt;e_flags &amp; EF_BFIN_PIC)</span>

<span class="cm">/* EM_BLACKFIN defined in linux/elf.h	*/</span>

<span class="cm">/*</span>
<span class="cm"> * These are used to set parameters in the core dumps.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_CLASS	ELFCLASS32</span>
<span class="cp">#define ELF_DATA	ELFDATA2LSB</span>
<span class="cp">#define ELF_ARCH	EM_BLACKFIN</span>

<span class="cp">#define ELF_PLAT_INIT(_r)	_r-&gt;p1 = 0</span>

<span class="cp">#define ELF_FDPIC_PLAT_INIT(_regs, _exec_map_addr, _interp_map_addr, _dynamic_addr)	\</span>
<span class="cp">do {											\</span>
<span class="cp">	_regs-&gt;r7	= 0;						\</span>
<span class="cp">	_regs-&gt;p0	= _exec_map_addr;				\</span>
<span class="cp">	_regs-&gt;p1	= _interp_map_addr;				\</span>
<span class="cp">	_regs-&gt;p2	= _dynamic_addr;				\</span>
<span class="cp">} while(0)</span>

<span class="cp">#if 0</span><span class="c"></span>
<span class="c">#define CORE_DUMP_USE_REGSET</span>
<span class="cp">#endif</span>
<span class="cp">#define ELF_FDPIC_CORE_EFLAGS	EF_BFIN_FDPIC</span>
<span class="cp">#define ELF_EXEC_PAGESIZE	4096</span>

<span class="cp">#define R_BFIN_UNUSED0         0   </span><span class="cm">/* relocation type 0 is not defined */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL5M2        1   </span><span class="cm">/* LSETUP part a */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_UNUSED1         2   </span><span class="cm">/* relocation type 2 is not defined */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL10         3   </span><span class="cm">/* type 3, if cc jump &lt;target&gt; */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL12_JUMP    4   </span><span class="cm">/* type 4, jump &lt;target&gt; */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_RIMM16          5   </span><span class="cm">/* type 0x5, rN = &lt;target&gt; */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_LUIMM16         6   </span><span class="cm">/* # 0x6, preg.l=&lt;target&gt; Load imm 16 to lower half */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_HUIMM16         7   </span><span class="cm">/* # 0x7, preg.h=&lt;target&gt; Load imm 16 to upper half */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL12_JUMP_S  8   </span><span class="cm">/* # 0x8 jump.s &lt;target&gt; */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL24_JUMP_X  9   </span><span class="cm">/* # 0x9 jump.x &lt;target&gt; */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL24         10  </span><span class="cm">/* # 0xa call &lt;target&gt; , not expandable */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_UNUSEDB         11  </span><span class="cm">/* # 0xb not generated */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_UNUSEDC         12  </span><span class="cm">/* # 0xc  not used */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL24_JUMP_L  13  </span><span class="cm">/* 0xd jump.l &lt;target&gt; */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL24_CALL_X  14  </span><span class="cm">/* 0xE, call.x &lt;target&gt; if &lt;target&gt; is above 24 bit limit call through P1 */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_VAR_EQ_SYMB     15  </span><span class="cm">/* 0xf, linker should treat it same as 0x12 */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_BYTE_DATA       16  </span><span class="cm">/* 0x10, .byte var = symbol */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_BYTE2_DATA      17  </span><span class="cm">/* 0x11, .byte2 var = symbol */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_BYTE4_DATA      18  </span><span class="cm">/* 0x12, .byte4 var = symbol and .var var=symbol */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_PCREL11         19  </span><span class="cm">/* 0x13, lsetup part b */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_UNUSED14        20  </span><span class="cm">/* 0x14, undefined */</span><span class="cp"></span>
<span class="cp">#define R_BFIN_UNUSED15        21  </span><span class="cm">/* not generated by VDSP 3.5 */</span><span class="cp"></span>

<span class="cm">/* arithmetic relocations */</span>
<span class="cp">#define R_BFIN_PUSH            0xE0</span>
<span class="cp">#define R_BFIN_CONST           0xE1</span>
<span class="cp">#define R_BFIN_ADD             0xE2</span>
<span class="cp">#define R_BFIN_SUB             0xE3</span>
<span class="cp">#define R_BFIN_MULT            0xE4</span>
<span class="cp">#define R_BFIN_DIV             0xE5</span>
<span class="cp">#define R_BFIN_MOD             0xE6</span>
<span class="cp">#define R_BFIN_LSHIFT          0xE7</span>
<span class="cp">#define R_BFIN_RSHIFT          0xE8</span>
<span class="cp">#define R_BFIN_AND             0xE9</span>
<span class="cp">#define R_BFIN_OR              0xEA</span>
<span class="cp">#define R_BFIN_XOR             0xEB</span>
<span class="cp">#define R_BFIN_LAND            0xEC</span>
<span class="cp">#define R_BFIN_LOR             0xED</span>
<span class="cp">#define R_BFIN_LEN             0xEE</span>
<span class="cp">#define R_BFIN_NEG             0xEF</span>
<span class="cp">#define R_BFIN_COMP            0xF0</span>
<span class="cp">#define R_BFIN_PAGE            0xF1</span>
<span class="cp">#define R_BFIN_HWPAGE          0xF2</span>
<span class="cp">#define R_BFIN_ADDR            0xF3</span>

<span class="cm">/* This is the location that an ET_DYN program is loaded if exec&#39;ed.  Typical</span>
<span class="cm">   use of this is to invoke &quot;./ld.so someprog&quot; to test out a new version of</span>
<span class="cm">   the loader.  We need to make sure that it is out of the way of the program</span>
<span class="cm">   that it will &quot;exec&quot;, and that there is sufficient room for the brk.  */</span>

<span class="cp">#define ELF_ET_DYN_BASE         0xD0000000UL</span>

<span class="cp">#define ELF_CORE_COPY_REGS(pr_reg, regs)	\</span>
<span class="cp">        memcpy((char *) &amp;pr_reg, (char *)regs,  \</span>
<span class="cp">               sizeof(struct pt_regs));</span>
<span class="cp">#define ELF_CORE_COPY_FPREGS(...) 0	</span><span class="cm">/* Blackfin has no FPU */</span><span class="cp"></span>

<span class="cm">/* This yields a mask that user programs can use to figure out what</span>
<span class="cm">   instruction set this cpu supports.  */</span>

<span class="cp">#define ELF_HWCAP	(0)</span>

<span class="cm">/* This yields a string that ld.so will use to load implementation</span>
<span class="cm">   specific libraries for optimization.  This is more specific in</span>
<span class="cm">   intent than poking at uname or /proc/cpuinfo.  */</span>

<span class="cp">#define ELF_PLATFORM  (NULL)</span>

<span class="cp">#define SET_PERSONALITY(ex) set_personality(PER_LINUX)</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
