<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › blackfin › include › asm › bfin_dma.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>bfin_dma.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * bfin_dma.h - Blackfin DMA defines/structures/etc...</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2004-2010 Analog Devices Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the GPL-2 or later.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __ASM_BFIN_DMA_H__</span>
<span class="cp">#define __ASM_BFIN_DMA_H__</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/* DMA_CONFIG Masks */</span>
<span class="cp">#define DMAEN			0x0001	</span><span class="cm">/* DMA Channel Enable */</span><span class="cp"></span>
<span class="cp">#define WNR				0x0002	</span><span class="cm">/* Channel Direction (W/R*) */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_8		0x0000	</span><span class="cm">/* Transfer Word Size = 8 */</span><span class="cp"></span>
<span class="cp">#define PSIZE_8			0x00000000	</span><span class="cm">/* Transfer Word Size = 16 */</span><span class="cp"></span>

<span class="cp">#ifdef CONFIG_BF60x</span>

<span class="cp">#define PSIZE_16		0x00000010	</span><span class="cm">/* Transfer Word Size = 16 */</span><span class="cp"></span>
<span class="cp">#define PSIZE_32		0x00000020	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define PSIZE_64		0x00000030	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_16		0x00000100	</span><span class="cm">/* Transfer Word Size = 16 */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_32		0x00000200	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_64		0x00000300	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_128		0x00000400	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_256		0x00000500	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define DMA2D			0x04000000	</span><span class="cm">/* DMA Mode (2D/1D*) */</span><span class="cp"></span>
<span class="cp">#define RESTART			0x00000004	</span><span class="cm">/* DMA Buffer Clear SYNC */</span><span class="cp"></span>
<span class="cp">#define DI_EN_X			0x00100000	</span><span class="cm">/* Data Interrupt Enable in X count */</span><span class="cp"></span>
<span class="cp">#define DI_EN_Y			0x00200000	</span><span class="cm">/* Data Interrupt Enable in Y count */</span><span class="cp"></span>
<span class="cp">#define DI_EN_P			0x00300000	</span><span class="cm">/* Data Interrupt Enable in Peripheral */</span><span class="cp"></span>
<span class="cp">#define DI_EN			DI_EN_X		</span><span class="cm">/* Data Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_0		0x00000000	</span><span class="cm">/* Next Descriptor Size = 1 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_1		0x00010000	</span><span class="cm">/* Next Descriptor Size = 2 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_2		0x00020000	</span><span class="cm">/* Next Descriptor Size = 3 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_3		0x00030000	</span><span class="cm">/* Next Descriptor Size = 4 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_4		0x00040000	</span><span class="cm">/* Next Descriptor Size = 5 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_5		0x00050000	</span><span class="cm">/* Next Descriptor Size = 6 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_6		0x00060000	</span><span class="cm">/* Next Descriptor Size = 7 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE			0x00070000	</span><span class="cm">/* Next Descriptor Size */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_OFFSET		16		</span><span class="cm">/* Next Descriptor Size Offset */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_LIST		0x00004000	</span><span class="cm">/* Descriptor List Mode */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_LARGE		DMAFLOW_LIST</span>
<span class="cp">#define DMAFLOW_ARRAY		0x00005000	</span><span class="cm">/* Descriptor Array Mode */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_LIST_DEMAND	0x00006000	</span><span class="cm">/* Descriptor Demand List Mode */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_ARRAY_DEMAND	0x00007000	</span><span class="cm">/* Descriptor Demand Array Mode */</span><span class="cp"></span>
<span class="cp">#define DMA_RUN_DFETCH		0x00000100	</span><span class="cm">/* DMA Channel Running Indicator (DFETCH) */</span><span class="cp"></span>
<span class="cp">#define DMA_RUN			0x00000200	</span><span class="cm">/* DMA Channel Running Indicator */</span><span class="cp"></span>
<span class="cp">#define DMA_RUN_WAIT_TRIG	0x00000300	</span><span class="cm">/* DMA Channel Running Indicator (WAIT TRIG) */</span><span class="cp"></span>
<span class="cp">#define DMA_RUN_WAIT_ACK	0x00000400	</span><span class="cm">/* DMA Channel Running Indicator (WAIT ACK) */</span><span class="cp"></span>

<span class="cp">#else</span>

<span class="cp">#define PSIZE_16		0x0000	</span><span class="cm">/* Transfer Word Size = 16 */</span><span class="cp"></span>
<span class="cp">#define PSIZE_32		0x0000	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_16		0x0004	</span><span class="cm">/* Transfer Word Size = 16 */</span><span class="cp"></span>
<span class="cp">#define WDSIZE_32		0x0008	</span><span class="cm">/* Transfer Word Size = 32 */</span><span class="cp"></span>
<span class="cp">#define DMA2D			0x0010	</span><span class="cm">/* DMA Mode (2D/1D*) */</span><span class="cp"></span>
<span class="cp">#define RESTART			0x0020	</span><span class="cm">/* DMA Buffer Clear */</span><span class="cp"></span>
<span class="cp">#define DI_SEL			0x0040	</span><span class="cm">/* Data Interrupt Timing Select */</span><span class="cp"></span>
<span class="cp">#define DI_EN			0x0080	</span><span class="cm">/* Data Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define DI_EN_X			0x00C0	</span><span class="cm">/* Data Interrupt Enable in X count*/</span><span class="cp"></span>
<span class="cp">#define DI_EN_Y			0x0080	</span><span class="cm">/* Data Interrupt Enable in Y count*/</span><span class="cp"></span>
<span class="cp">#define NDSIZE_0		0x0000	</span><span class="cm">/* Next Descriptor Size = 0 (Stop/Autobuffer) */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_1		0x0100	</span><span class="cm">/* Next Descriptor Size = 1 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_2		0x0200	</span><span class="cm">/* Next Descriptor Size = 2 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_3		0x0300	</span><span class="cm">/* Next Descriptor Size = 3 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_4		0x0400	</span><span class="cm">/* Next Descriptor Size = 4 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_5		0x0500	</span><span class="cm">/* Next Descriptor Size = 5 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_6		0x0600	</span><span class="cm">/* Next Descriptor Size = 6 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_7		0x0700	</span><span class="cm">/* Next Descriptor Size = 7 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_8		0x0800	</span><span class="cm">/* Next Descriptor Size = 8 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_9		0x0900	</span><span class="cm">/* Next Descriptor Size = 9 */</span><span class="cp"></span>
<span class="cp">#define NDSIZE			0x0f00	</span><span class="cm">/* Next Descriptor Size */</span><span class="cp"></span>
<span class="cp">#define NDSIZE_OFFSET		8	</span><span class="cm">/* Next Descriptor Size Offset */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_ARRAY	0x4000	</span><span class="cm">/* Descriptor Array Mode */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_SMALL	0x6000	</span><span class="cm">/* Small Model Descriptor List Mode */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_LARGE	0x7000	</span><span class="cm">/* Large Model Descriptor List Mode */</span><span class="cp"></span>
<span class="cp">#define DFETCH			0x0004	</span><span class="cm">/* DMA Descriptor Fetch Indicator */</span><span class="cp"></span>
<span class="cp">#define DMA_RUN			0x0008	</span><span class="cm">/* DMA Channel Running Indicator */</span><span class="cp"></span>

<span class="cp">#endif</span>
<span class="cp">#define DMAFLOW			0x7000	</span><span class="cm">/* Flow Control */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_STOP	0x0000	</span><span class="cm">/* Stop Mode */</span><span class="cp"></span>
<span class="cp">#define DMAFLOW_AUTO	0x1000	</span><span class="cm">/* Autobuffer Mode */</span><span class="cp"></span>

<span class="cm">/* DMA_IRQ_STATUS Masks */</span>
<span class="cp">#define DMA_DONE		0x0001	</span><span class="cm">/* DMA Completion Interrupt Status */</span><span class="cp"></span>
<span class="cp">#define DMA_ERR			0x0002	</span><span class="cm">/* DMA Error Interrupt Status */</span><span class="cp"></span>
<span class="cp">#ifdef CONFIG_BF60x</span>
<span class="cp">#define DMA_PIRQ		0x0004	</span><span class="cm">/* DMA Peripheral Error Interrupt Status */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp">#define DMA_PIRQ		0</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * All Blackfin system MMRs are padded to 32bits even if the register</span>
<span class="cm"> * itself is only 16bits.  So use a helper macro to streamline this.</span>
<span class="cm"> */</span>
<span class="cp">#define __BFP(m) u16 m; u16 __pad_##m</span>

<span class="cm">/*</span>
<span class="cm"> * bfin dma registers layout</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfin_dma_regs</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">next_desc_ptr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">start_addr</span><span class="p">;</span>
<span class="cp">#ifdef CONFIG_BF60x</span>
	<span class="n">u32</span> <span class="n">cfg</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">x_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">x_modify</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">y_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">y_modify</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pad1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pad2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_desc_ptr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">prev_desc_ptr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_addr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">irq_status</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_x_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_y_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pad3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">bw_limit_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_bw_limit_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">bw_monitor_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_bw_monitor_count</span><span class="p">;</span>
<span class="cp">#else</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">config</span><span class="p">);</span>
	<span class="n">u32</span> <span class="n">__pad0</span><span class="p">;</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">x_count</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">x_modify</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">y_count</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">y_modify</span><span class="p">);</span>
	<span class="n">u32</span> <span class="n">curr_desc_ptr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_addr</span><span class="p">;</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">irq_status</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">peripheral_map</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">curr_x_count</span><span class="p">);</span>
	<span class="n">u32</span> <span class="n">__pad1</span><span class="p">;</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">curr_y_count</span><span class="p">);</span>
	<span class="n">u32</span> <span class="n">__pad2</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="cp">#ifndef CONFIG_BF60x</span>
<span class="cm">/*</span>
<span class="cm"> * bfin handshake mdma registers layout</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfin_hmdma_regs</span> <span class="p">{</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">control</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">ecinit</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">bcinit</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">ecurgent</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">ecoverflow</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">ecount</span><span class="p">);</span>
	<span class="n">__BFP</span><span class="p">(</span><span class="n">bcount</span><span class="p">);</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#undef __BFP</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
