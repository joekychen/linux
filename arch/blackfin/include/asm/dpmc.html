<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › blackfin › include › asm › dpmc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>dpmc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Miscellaneous IOCTL commands for Dynamic Power Management Controller Driver</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2004-2009 Analog Device Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Licensed under the GPL-2</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _BLACKFIN_DPMC_H_</span>
<span class="cp">#define _BLACKFIN_DPMC_H_</span>

<span class="cp">#ifdef __ASSEMBLY__</span>
<span class="cp">#define PM_REG0  R7</span>
<span class="cp">#define PM_REG1  R6</span>
<span class="cp">#define PM_REG2  R5</span>
<span class="cp">#define PM_REG3  R4</span>
<span class="cp">#define PM_REG4  R3</span>
<span class="cp">#define PM_REG5  R2</span>
<span class="cp">#define PM_REG6  R1</span>
<span class="cp">#define PM_REG7  R0</span>
<span class="cp">#define PM_REG8  P5</span>
<span class="cp">#define PM_REG9  P4</span>
<span class="cp">#define PM_REG10 P3</span>
<span class="cp">#define PM_REG11 P2</span>
<span class="cp">#define PM_REG12 P1</span>
<span class="cp">#define PM_REG13 P0</span>

<span class="cp">#define PM_REGSET0  R7:7</span>
<span class="cp">#define PM_REGSET1  R7:6</span>
<span class="cp">#define PM_REGSET2  R7:5</span>
<span class="cp">#define PM_REGSET3  R7:4</span>
<span class="cp">#define PM_REGSET4  R7:3</span>
<span class="cp">#define PM_REGSET5  R7:2</span>
<span class="cp">#define PM_REGSET6  R7:1</span>
<span class="cp">#define PM_REGSET7  R7:0</span>
<span class="cp">#define PM_REGSET8  R7:0, P5:5</span>
<span class="cp">#define PM_REGSET9  R7:0, P5:4</span>
<span class="cp">#define PM_REGSET10 R7:0, P5:3</span>
<span class="cp">#define PM_REGSET11 R7:0, P5:2</span>
<span class="cp">#define PM_REGSET12 R7:0, P5:1</span>
<span class="cp">#define PM_REGSET13 R7:0, P5:0</span>

<span class="cp">#define _PM_PUSH(n, x, w, base) PM_REG##n = w[FP + ((x) - (base))];</span>
<span class="cp">#define _PM_POP(n, x, w, base)  w[FP + ((x) - (base))] = PM_REG##n;</span>
<span class="cp">#define PM_PUSH_SYNC(n)         [--sp] = (PM_REGSET##n);</span>
<span class="cp">#define PM_POP_SYNC(n)          (PM_REGSET##n) = [sp++];</span>
<span class="cp">#define PM_PUSH(n, x)		PM_REG##n = [FP++];</span>
<span class="cp">#define PM_POP(n, x)            [FP--] = PM_REG##n;</span>
<span class="cp">#define PM_CORE_PUSH(n, x)      _PM_PUSH(n, x, , COREMMR_BASE)</span>
<span class="cp">#define PM_CORE_POP(n, x)       _PM_POP(n, x, , COREMMR_BASE)</span>
<span class="cp">#define PM_SYS_PUSH(n, x)       _PM_PUSH(n, x, , SYSMMR_BASE)</span>
<span class="cp">#define PM_SYS_POP(n, x)        _PM_POP(n, x, , SYSMMR_BASE)</span>
<span class="cp">#define PM_SYS_PUSH16(n, x)     _PM_PUSH(n, x, w, SYSMMR_BASE)</span>
<span class="cp">#define PM_SYS_POP16(n, x)      _PM_POP(n, x, w, SYSMMR_BASE)</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">bfin_init_pm_bench_cycles</span>
<span class="cp">#ifdef CONFIG_BFIN_PM_WAKEUP_TIME_BENCH</span>
	<span class="n">R4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">CYCLES</span> <span class="o">=</span> <span class="n">R4</span><span class="p">;</span>
	<span class="n">CYCLES2</span> <span class="o">=</span> <span class="n">R4</span><span class="p">;</span>
	<span class="n">R4</span> <span class="o">=</span> <span class="n">SYSCFG</span><span class="p">;</span>
	<span class="n">BITSET</span><span class="p">(</span><span class="n">R4</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SYSCFG</span> <span class="o">=</span> <span class="n">R4</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">bfin_cpu_reg_save</span>
	<span class="cm">/*</span>
<span class="cm">	 * Save the core regs early so we can blow them away when</span>
<span class="cm">	 * saving/restoring MMR states</span>
<span class="cm">	 */</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">R7</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">P5</span><span class="o">:</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">fp</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">usp</span><span class="p">;</span>

	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">i0</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">i1</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">i2</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">i3</span><span class="p">;</span>

	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">m0</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">m1</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">m2</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">m3</span><span class="p">;</span>

	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">l0</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">l1</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">l2</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">l3</span><span class="p">;</span>

	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">b0</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">b1</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">b2</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">b3</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">a0</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">a0</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">a1</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">a1</span><span class="p">.</span><span class="n">w</span><span class="p">;</span>

	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">LC0</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">LC1</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">LT0</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">LT1</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">LB0</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">LB1</span><span class="p">;</span>

	<span class="cm">/* We can&#39;t push RETI directly as that&#39;ll change IPEND[4] */</span>
	<span class="n">r7</span> <span class="o">=</span> <span class="n">RETI</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">RETS</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">ASTAT</span><span class="p">;</span>
<span class="cp">#ifndef CONFIG_BFIN_PM_WAKEUP_TIME_BENCH</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">CYCLES</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">CYCLES2</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">SYSCFG</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">RETX</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">SEQSTAT</span><span class="p">;</span>
	<span class="p">[</span><span class="o">--</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">r7</span><span class="p">;</span>

	<span class="cm">/* Save first func arg in M3 */</span>
	<span class="n">M3</span> <span class="o">=</span> <span class="n">R0</span><span class="p">;</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">bfin_cpu_reg_restore</span>
	<span class="cm">/* Restore Core Registers */</span>
	<span class="n">RETI</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">SEQSTAT</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">RETX</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">SYSCFG</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
<span class="cp">#ifndef CONFIG_BFIN_PM_WAKEUP_TIME_BENCH</span>
	<span class="n">CYCLES2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">CYCLES</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
<span class="cp">#endif</span>
	<span class="n">ASTAT</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">RETS</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>

	<span class="n">LB1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">LB0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">LT1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">LT0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">LC1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">LC0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>

	<span class="n">a1</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">a1</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">a0</span><span class="p">.</span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">a0</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">b3</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">b2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">b1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">b0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>

	<span class="n">l3</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">l0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>

	<span class="n">m3</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">m2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">m1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">m0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>

	<span class="n">i3</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">i2</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">i1</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">i0</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>

	<span class="n">usp</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="n">fp</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>
	<span class="p">(</span><span class="n">R7</span><span class="o">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">P5</span><span class="o">:</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">++</span><span class="p">];</span>

	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">bfin_sys_mmr_save</span>
	<span class="cm">/* Save system MMRs */</span>
	<span class="n">FP</span><span class="p">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">hi</span><span class="p">(</span><span class="n">SYSMMR_BASE</span><span class="p">);</span>
	<span class="n">FP</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">SYSMMR_BASE</span><span class="p">);</span>
<span class="cp">#ifdef SIC_IMASK0</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SIC_IMASK0</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">SIC_IMASK1</span><span class="p">)</span>
<span class="cp"># ifdef SIC_IMASK2</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SIC_IMASK2</span><span class="p">)</span>
<span class="cp"># endif</span>
<span class="cp">#else</span>
<span class="cp"># ifdef SIC_IMASK</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SIC_IMASK</span><span class="p">)</span>
<span class="cp"># endif</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIC_IAR0</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">SIC_IAR0</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">SIC_IAR1</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">SIC_IAR2</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR3</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">SIC_IAR3</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR4</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">SIC_IAR4</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">SIC_IAR5</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">SIC_IAR6</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR7</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">SIC_IAR7</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR8</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">SIC_IAR8</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">SIC_IAR9</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">SIC_IAR10</span><span class="p">)</span>
<span class="cp">#endif</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="cp">#ifdef SIC_IAR11</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SIC_IAR11</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIC_IWR</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">SIC_IWR</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IWR0</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">SIC_IWR0</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IWR1</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SIC_IWR1</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IWR2</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">SIC_IWR2</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef PINT0_ASSIGN</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">PINT0_MASK_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">PINT1_MASK_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">PINT2_MASK_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">PINT3_MASK_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">PINT0_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">PINT1_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">PINT2_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">PINT3_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">PINT0_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">PINT1_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">PINT2_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">PINT3_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">PINT0_EDGE_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">PINT1_EDGE_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">PINT2_EDGE_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">PINT3_EDGE_SET</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SYSCR</span>
	<span class="n">PM_SYS_PUSH16</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">SYSCR</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef EBIU_AMGCTL</span>
	<span class="n">PM_SYS_PUSH16</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">EBIU_AMGCTL</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">EBIU_AMBCTL0</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">EBIU_AMBCTL1</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef EBIU_FCTL</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">EBIU_MBSCTL</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">EBIU_MODE</span><span class="p">)</span>
	<span class="n">PM_SYS_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">EBIU_FCTL</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="cp">#else</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="cp">#endif</span>
	<span class="p">.</span><span class="n">endm</span>


	<span class="p">.</span><span class="n">macro</span> <span class="n">bfin_sys_mmr_restore</span>
<span class="cm">/* Restore System MMRs */</span>
	<span class="n">FP</span><span class="p">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">hi</span><span class="p">(</span><span class="n">SYSMMR_BASE</span><span class="p">);</span>
	<span class="n">FP</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">SYSMMR_BASE</span><span class="p">);</span>

<span class="cp">#ifdef EBIU_FCTL</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">EBIU_FCTL</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">EBIU_MODE</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">EBIU_MBSCTL</span><span class="p">)</span>
<span class="cp">#else</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef EBIU_AMBCTL</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">EBIU_AMBCTL1</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">EBIU_AMBCTL0</span><span class="p">)</span>
	<span class="n">PM_SYS_POP16</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">EBIU_AMGCTL</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SYSCR</span>
	<span class="n">PM_SYS_POP16</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">SYSCR</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef PINT0_ASSIGN</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">PINT3_EDGE_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">PINT2_EDGE_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">PINT1_EDGE_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">PINT0_EDGE_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">PINT3_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">PINT2_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">PINT1_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">PINT0_INVERT_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">PINT3_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">PINT2_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">PINT1_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">PINT0_ASSIGN</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">PINT3_MASK_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">PINT2_MASK_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">PINT1_MASK_SET</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">PINT0_MASK_SET</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIC_IWR2</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">SIC_IWR2</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IWR1</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SIC_IWR1</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IWR0</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">SIC_IWR0</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IWR</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">SIC_IWR</span><span class="p">)</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef SIC_IAR11</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SIC_IAR11</span><span class="p">)</span>
<span class="cp">#endif</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="cp">#ifdef SIC_IAR8</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">SIC_IAR10</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">SIC_IAR9</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">SIC_IAR8</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR7</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">SIC_IAR7</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR6</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">SIC_IAR6</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">SIC_IAR5</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">SIC_IAR4</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR3</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">SIC_IAR3</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IAR0</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">SIC_IAR2</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">SIC_IAR1</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">SIC_IAR0</span><span class="p">)</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef SIC_IMASK0</span>
<span class="cp"># ifdef SIC_IMASK2</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">SIC_IMASK2</span><span class="p">)</span>
<span class="cp"># endif</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">SIC_IMASK1</span><span class="p">)</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SIC_IMASK0</span><span class="p">)</span>
<span class="cp">#else</span>
<span class="cp"># ifdef SIC_IMASK</span>
	<span class="n">PM_SYS_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">SIC_IMASK</span><span class="p">)</span>
<span class="cp"># endif</span>
<span class="cp">#endif</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">bfin_core_mmr_save</span>
	<span class="cm">/* Save Core MMRs */</span>
	<span class="n">I0</span><span class="p">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">hi</span><span class="p">(</span><span class="n">COREMMR_BASE</span><span class="p">);</span>
	<span class="n">I0</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">COREMMR_BASE</span><span class="p">);</span>
	<span class="n">I1</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">I2</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">I3</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B0</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B1</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B2</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B3</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">I1</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">DCPLB_ADDR0</span><span class="p">);</span>
	<span class="n">I2</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">DCPLB_DATA0</span><span class="p">);</span>
	<span class="n">I3</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">ICPLB_ADDR0</span><span class="p">);</span>
	<span class="n">B0</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">ICPLB_DATA0</span><span class="p">);</span>
	<span class="n">B1</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">EVT2</span><span class="p">);</span>
	<span class="n">B2</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">IMASK</span><span class="p">);</span>
	<span class="n">B3</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">TCNTL</span><span class="p">);</span>

	<span class="cm">/* Event Vectors */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B1</span><span class="p">;</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">EVT2</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EVT3</span><span class="p">)</span>
	<span class="n">FP</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>	<span class="cm">/* EVT4 */</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">EVT5</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">EVT6</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">EVT7</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">EVT8</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">EVT9</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EVT10</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">EVT11</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">EVT12</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">EVT13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">EVT14</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">EVT15</span><span class="p">)</span>

	<span class="cm">/* CEC */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B2</span><span class="p">;</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">IMASK</span><span class="p">)</span>
	<span class="n">FP</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>	<span class="cm">/* IPEND */</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ILAT</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">IPRIO</span><span class="p">)</span>

	<span class="cm">/* Core Timer */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B3</span><span class="p">;</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">TCNTL</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">TPERIOD</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">TSCALE</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">TCOUNT</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

	<span class="cm">/* Misc non-contiguous registers */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">PM_CORE_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DMEM_CONTROL</span><span class="p">);</span>
	<span class="n">PM_CORE_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">IMEM_CONTROL</span><span class="p">);</span>
	<span class="n">PM_CORE_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">TBUFCTL</span><span class="p">);</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

	<span class="cm">/* DCPLB Addr */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I1</span><span class="p">;</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DCPLB_ADDR0</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">DCPLB_ADDR1</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">DCPLB_ADDR2</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">DCPLB_ADDR3</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">DCPLB_ADDR4</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">DCPLB_ADDR5</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">DCPLB_ADDR6</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">DCPLB_ADDR7</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">DCPLB_ADDR8</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">DCPLB_ADDR9</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">DCPLB_ADDR10</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">DCPLB_ADDR11</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">DCPLB_ADDR12</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">DCPLB_ADDR13</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DCPLB_ADDR14</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">DCPLB_ADDR15</span><span class="p">)</span>

	<span class="cm">/* DCPLB Data */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I2</span><span class="p">;</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">DCPLB_DATA0</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">DCPLB_DATA1</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">DCPLB_DATA2</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">DCPLB_DATA3</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">DCPLB_DATA4</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">DCPLB_DATA5</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">DCPLB_DATA6</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">DCPLB_DATA7</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">DCPLB_DATA8</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">DCPLB_DATA9</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">DCPLB_DATA10</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">DCPLB_DATA11</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DCPLB_DATA12</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">DCPLB_DATA13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">DCPLB_DATA14</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">DCPLB_DATA15</span><span class="p">)</span>

	<span class="cm">/* ICPLB Addr */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I3</span><span class="p">;</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ICPLB_ADDR0</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ICPLB_ADDR1</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">ICPLB_ADDR2</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">ICPLB_ADDR3</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ICPLB_ADDR4</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">ICPLB_ADDR5</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">ICPLB_ADDR6</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">ICPLB_ADDR7</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">ICPLB_ADDR8</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">ICPLB_ADDR9</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ICPLB_ADDR10</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ICPLB_ADDR11</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ICPLB_ADDR12</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ICPLB_ADDR13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ICPLB_ADDR14</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ICPLB_ADDR15</span><span class="p">)</span>

	<span class="cm">/* ICPLB Data */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B0</span><span class="p">;</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">ICPLB_DATA0</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">ICPLB_DATA1</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ICPLB_DATA2</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">ICPLB_DATA3</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">ICPLB_DATA4</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">ICPLB_DATA5</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">ICPLB_DATA6</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">ICPLB_DATA7</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ICPLB_DATA8</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ICPLB_DATA9</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ICPLB_DATA10</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ICPLB_DATA11</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ICPLB_DATA12</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ICPLB_DATA13</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">ICPLB_DATA14</span><span class="p">)</span>
	<span class="n">PM_PUSH</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">ICPLB_DATA15</span><span class="p">)</span>
	<span class="n">PM_PUSH_SYNC</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">bfin_core_mmr_restore</span>
	<span class="cm">/* Restore Core MMRs */</span>
	<span class="n">I0</span><span class="p">.</span><span class="n">H</span> <span class="o">=</span> <span class="n">hi</span><span class="p">(</span><span class="n">COREMMR_BASE</span><span class="p">);</span>
	<span class="n">I0</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">COREMMR_BASE</span><span class="p">);</span>
	<span class="n">I1</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">I2</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">I3</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B0</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B1</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B2</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">B3</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">I1</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">DCPLB_ADDR15</span><span class="p">);</span>
	<span class="n">I2</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">DCPLB_DATA15</span><span class="p">);</span>
	<span class="n">I3</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">ICPLB_ADDR15</span><span class="p">);</span>
	<span class="n">B0</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">ICPLB_DATA15</span><span class="p">);</span>
	<span class="n">B1</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">EVT15</span><span class="p">);</span>
	<span class="n">B2</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">IPRIO</span><span class="p">);</span>
	<span class="n">B3</span><span class="p">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">lo</span><span class="p">(</span><span class="n">TCOUNT</span><span class="p">);</span>

	<span class="cm">/* ICPLB Data */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B0</span><span class="p">;</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">ICPLB_DATA15</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">ICPLB_DATA14</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ICPLB_DATA13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ICPLB_DATA12</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ICPLB_DATA11</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ICPLB_DATA10</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ICPLB_DATA9</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ICPLB_DATA8</span><span class="p">)</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">ICPLB_DATA7</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">ICPLB_DATA6</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">ICPLB_DATA5</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">ICPLB_DATA4</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">ICPLB_DATA3</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ICPLB_DATA2</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">ICPLB_DATA1</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">ICPLB_DATA0</span><span class="p">)</span>

	<span class="cm">/* ICPLB Addr */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I3</span><span class="p">;</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ICPLB_ADDR15</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ICPLB_ADDR14</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">ICPLB_ADDR13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">ICPLB_ADDR12</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ICPLB_ADDR11</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ICPLB_ADDR10</span><span class="p">)</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">ICPLB_ADDR9</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">ICPLB_ADDR8</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">ICPLB_ADDR7</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">ICPLB_ADDR6</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">ICPLB_ADDR5</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ICPLB_ADDR4</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">ICPLB_ADDR3</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">ICPLB_ADDR2</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">ICPLB_ADDR1</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">ICPLB_ADDR0</span><span class="p">)</span>

	<span class="cm">/* DCPLB Data */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I2</span><span class="p">;</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">DCPLB_DATA15</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">DCPLB_DATA14</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">DCPLB_DATA13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DCPLB_DATA12</span><span class="p">)</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">DCPLB_DATA11</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">DCPLB_DATA10</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">DCPLB_DATA9</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">DCPLB_DATA8</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">DCPLB_DATA7</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">DCPLB_DATA6</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">DCPLB_DATA5</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">DCPLB_DATA4</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">DCPLB_DATA3</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">DCPLB_DATA2</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">DCPLB_DATA1</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">DCPLB_DATA0</span><span class="p">)</span>

	<span class="cm">/* DCPLB Addr */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I1</span><span class="p">;</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">DCPLB_ADDR15</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DCPLB_ADDR14</span><span class="p">)</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">DCPLB_ADDR13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">DCPLB_ADDR12</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">DCPLB_ADDR11</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">DCPLB_ADDR10</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">DCPLB_ADDR9</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">DCPLB_ADDR8</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">DCPLB_ADDR7</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">DCPLB_ADDR6</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">DCPLB_ADDR5</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">DCPLB_ADDR4</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">DCPLB_ADDR3</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">DCPLB_ADDR2</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">DCPLB_ADDR1</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DCPLB_ADDR0</span><span class="p">)</span>


	<span class="cm">/* Misc non-contiguous registers */</span>

	<span class="cm">/* icache &amp; dcache will enable later </span>
<span class="cm">	   drop IMEM_CONTROL, DMEM_CONTROL pop</span>
<span class="cm">	*/</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">I0</span><span class="p">;</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
	<span class="n">PM_CORE_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">TBUFCTL</span><span class="p">)</span>
	<span class="n">PM_CORE_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">IMEM_CONTROL</span><span class="p">)</span>
	<span class="n">PM_CORE_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">DMEM_CONTROL</span><span class="p">)</span>

	<span class="cm">/* Core Timer */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B3</span><span class="p">;</span>
	<span class="n">R0</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">;</span>
	<span class="p">[</span><span class="n">FP</span> <span class="o">-</span> <span class="mh">0xC</span><span class="p">]</span> <span class="o">=</span> <span class="n">R0</span><span class="p">;</span>

	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B3</span><span class="p">;</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">TCOUNT</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">TSCALE</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">TPERIOD</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">TCNTL</span><span class="p">)</span>

	<span class="cm">/* CEC */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B2</span><span class="p">;</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">IPRIO</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">ILAT</span><span class="p">)</span>
	<span class="n">FP</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">4</span><span class="p">;</span>	<span class="cm">/* IPEND */</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">IMASK</span><span class="p">)</span>

	<span class="cm">/* Event Vectors */</span>
	<span class="n">FP</span> <span class="o">=</span> <span class="n">B1</span><span class="p">;</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">EVT15</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">EVT14</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">EVT13</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">EVT12</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">EVT11</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EVT10</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">EVT9</span><span class="p">)</span>
	<span class="n">PM_POP_SYNC</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">EVT8</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">EVT7</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">EVT6</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">EVT5</span><span class="p">)</span>
	<span class="n">FP</span> <span class="o">+=</span> <span class="o">-</span><span class="mi">4</span><span class="p">;</span>	<span class="cm">/* EVT4 */</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">EVT3</span><span class="p">)</span>
	<span class="n">PM_POP</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">EVT2</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>
<span class="cp">#endif</span>

<span class="cp">#include &lt;mach/pll.h&gt;</span>

<span class="cm">/* PLL_CTL Masks */</span>
<span class="cp">#define DF			0x0001	</span><span class="cm">/* 0: PLL = CLKIN, 1: PLL = CLKIN/2 */</span><span class="cp"></span>
<span class="cp">#define PLL_OFF			0x0002	</span><span class="cm">/* PLL Not Powered */</span><span class="cp"></span>
<span class="cp">#define STOPCK			0x0008	</span><span class="cm">/* Core Clock Off */</span><span class="cp"></span>
<span class="cp">#define PDWN			0x0020	</span><span class="cm">/* Enter Deep Sleep Mode */</span><span class="cp"></span>
<span class="cp">#ifdef __ADSPBF539__</span>
<span class="cp"># define IN_DELAY		0x0014	</span><span class="cm">/* Add 200ps Delay To EBIU Input Latches */</span><span class="cp"></span>
<span class="cp"># define OUT_DELAY		0x00C0	</span><span class="cm">/* Add 200ps Delay To EBIU Output Signals */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp"># define IN_DELAY		0x0040	</span><span class="cm">/* Add 200ps Delay To EBIU Input Latches */</span><span class="cp"></span>
<span class="cp"># define OUT_DELAY		0x0080	</span><span class="cm">/* Add 200ps Delay To EBIU Output Signals */</span><span class="cp"></span>
<span class="cp">#endif</span>
<span class="cp">#define BYPASS			0x0100	</span><span class="cm">/* Bypass the PLL */</span><span class="cp"></span>
<span class="cp">#define MSEL			0x7E00	</span><span class="cm">/* Multiplier Select For CCLK/VCO Factors */</span><span class="cp"></span>
<span class="cp">#define SPORT_HYST		0x8000	</span><span class="cm">/* Enable Additional Hysteresis on SPORT Input Pins */</span><span class="cp"></span>
<span class="cp">#define SET_MSEL(x)		(((x)&amp;0x3F) &lt;&lt; 0x9)	</span><span class="cm">/* Set MSEL = 0-63 --&gt; VCO = CLKIN*MSEL */</span><span class="cp"></span>

<span class="cm">/* PLL_DIV Masks */</span>
<span class="cp">#define SSEL			0x000F	</span><span class="cm">/* System Select */</span><span class="cp"></span>
<span class="cp">#define CSEL			0x0030	</span><span class="cm">/* Core Select */</span><span class="cp"></span>
<span class="cp">#define CSEL_DIV1		0x0000	</span><span class="cm">/* CCLK = VCO / 1 */</span><span class="cp"></span>
<span class="cp">#define CSEL_DIV2		0x0010	</span><span class="cm">/* CCLK = VCO / 2 */</span><span class="cp"></span>
<span class="cp">#define CSEL_DIV4		0x0020	</span><span class="cm">/* CCLK = VCO / 4 */</span><span class="cp"></span>
<span class="cp">#define CSEL_DIV8		0x0030	</span><span class="cm">/* CCLK = VCO / 8 */</span><span class="cp"></span>

<span class="cp">#define CCLK_DIV1 CSEL_DIV1</span>
<span class="cp">#define CCLK_DIV2 CSEL_DIV2</span>
<span class="cp">#define CCLK_DIV4 CSEL_DIV4</span>
<span class="cp">#define CCLK_DIV8 CSEL_DIV8</span>

<span class="cp">#define SET_SSEL(x)	((x) &amp; 0xF)	</span><span class="cm">/* Set SSEL = 0-15 --&gt; SCLK = VCO/SSEL */</span><span class="cp"></span>
<span class="cp">#define SCLK_DIV(x)	(x)		</span><span class="cm">/* SCLK = VCO / x */</span><span class="cp"></span>

<span class="cm">/* PLL_STAT Masks */</span>
<span class="cp">#define ACTIVE_PLLENABLED	0x0001	</span><span class="cm">/* Processor In Active Mode With PLL Enabled */</span><span class="cp"></span>
<span class="cp">#define FULL_ON			0x0002	</span><span class="cm">/* Processor In Full On Mode */</span><span class="cp"></span>
<span class="cp">#define ACTIVE_PLLDISABLED	0x0004	</span><span class="cm">/* Processor In Active Mode With PLL Disabled */</span><span class="cp"></span>
<span class="cp">#define PLL_LOCKED		0x0020	</span><span class="cm">/* PLL_LOCKCNT Has Been Reached */</span><span class="cp"></span>

<span class="cp">#define RTCWS			0x0400	</span><span class="cm">/* RTC/Reset Wake-Up Status */</span><span class="cp"></span>
<span class="cp">#define CANWS			0x0800	</span><span class="cm">/* CAN Wake-Up Status */</span><span class="cp"></span>
<span class="cp">#define USBWS			0x2000	</span><span class="cm">/* USB Wake-Up Status */</span><span class="cp"></span>
<span class="cp">#define KPADWS			0x4000	</span><span class="cm">/* Keypad Wake-Up Status */</span><span class="cp"></span>
<span class="cp">#define ROTWS			0x8000	</span><span class="cm">/* Rotary Wake-Up Status */</span><span class="cp"></span>
<span class="cp">#define GPWS			0x1000	</span><span class="cm">/* General-Purpose Wake-Up Status */</span><span class="cp"></span>

<span class="cm">/* VR_CTL Masks */</span>
<span class="cp">#if defined(__ADSPBF52x__) || defined(__ADSPBF51x__)</span>
<span class="cp">#define FREQ			0x3000	</span><span class="cm">/* Switching Oscillator Frequency For Regulator */</span><span class="cp"></span>
<span class="cp">#define FREQ_1000		0x3000	</span><span class="cm">/* Switching Frequency Is 1 MHz */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp">#define FREQ			0x0003	</span><span class="cm">/* Switching Oscillator Frequency For Regulator */</span><span class="cp"></span>
<span class="cp">#define FREQ_333		0x0001	</span><span class="cm">/* Switching Frequency Is 333 kHz */</span><span class="cp"></span>
<span class="cp">#define FREQ_667		0x0002	</span><span class="cm">/* Switching Frequency Is 667 kHz */</span><span class="cp"></span>
<span class="cp">#define FREQ_1000		0x0003	</span><span class="cm">/* Switching Frequency Is 1 MHz */</span><span class="cp"></span>
<span class="cp">#endif</span>
<span class="cp">#define HIBERNATE		0x0000	</span><span class="cm">/* Powerdown/Bypass On-Board Regulation */</span><span class="cp"></span>

<span class="cp">#define GAIN			0x000C	</span><span class="cm">/* Voltage Level Gain */</span><span class="cp"></span>
<span class="cp">#define GAIN_5			0x0000	</span><span class="cm">/* GAIN = 5 */</span><span class="cp"></span>
<span class="cp">#define GAIN_10			0x0004	</span><span class="cm">/* GAIN = 1 */</span><span class="cp"></span>
<span class="cp">#define GAIN_20			0x0008	</span><span class="cm">/* GAIN = 2 */</span><span class="cp"></span>
<span class="cp">#define GAIN_50			0x000C	</span><span class="cm">/* GAIN = 5 */</span><span class="cp"></span>

<span class="cp">#define VLEV			0x00F0	</span><span class="cm">/* Internal Voltage Level */</span><span class="cp"></span>
<span class="cp">#ifdef __ADSPBF52x__</span>
<span class="cp">#define VLEV_085		0x0040	</span><span class="cm">/* VLEV = 0.85 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_090		0x0050	</span><span class="cm">/* VLEV = 0.90 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_095		0x0060	</span><span class="cm">/* VLEV = 0.95 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_100		0x0070	</span><span class="cm">/* VLEV = 1.00 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_105		0x0080	</span><span class="cm">/* VLEV = 1.05 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_110		0x0090	</span><span class="cm">/* VLEV = 1.10 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_115		0x00A0	</span><span class="cm">/* VLEV = 1.15 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_120		0x00B0	</span><span class="cm">/* VLEV = 1.20 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp">#define VLEV_085		0x0060	</span><span class="cm">/* VLEV = 0.85 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_090		0x0070	</span><span class="cm">/* VLEV = 0.90 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_095		0x0080	</span><span class="cm">/* VLEV = 0.95 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_100		0x0090	</span><span class="cm">/* VLEV = 1.00 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_105		0x00A0	</span><span class="cm">/* VLEV = 1.05 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_110		0x00B0	</span><span class="cm">/* VLEV = 1.10 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_115		0x00C0	</span><span class="cm">/* VLEV = 1.15 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_120		0x00D0	</span><span class="cm">/* VLEV = 1.20 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_125		0x00E0	</span><span class="cm">/* VLEV = 1.25 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#define VLEV_130		0x00F0	</span><span class="cm">/* VLEV = 1.30 V (-5% - +10% Accuracy) */</span><span class="cp"></span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_BF60x</span>
<span class="cp">#define PA15WE			0x00000001 </span><span class="cm">/* Allow Wake-Up from PA15 */</span><span class="cp"></span>
<span class="cp">#define PB15WE			0x00000002 </span><span class="cm">/* Allow Wake-Up from PB15 */</span><span class="cp"></span>
<span class="cp">#define PC15WE			0x00000004 </span><span class="cm">/* Allow Wake-Up from PC15 */</span><span class="cp"></span>
<span class="cp">#define PD06WE			0x00000008 </span><span class="cm">/* Allow Wake-Up from PD06(ETH0_PHYINT) */</span><span class="cp"></span>
<span class="cp">#define PE12WE			0x00000010 </span><span class="cm">/* Allow Wake-Up from PE12(ETH1_PHYINT, PUSH BUTTON) */</span><span class="cp"></span>
<span class="cp">#define PG04WE			0x00000020 </span><span class="cm">/* Allow Wake-Up from PG04(CAN0_RX) */</span><span class="cp"></span>
<span class="cp">#define PG13WE			0x00000040 </span><span class="cm">/* Allow Wake-Up from PG13 */</span><span class="cp"></span>
<span class="cp">#define USBWE			0x00000080 </span><span class="cm">/* Allow Wake-Up from (USB) */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp">#define WAKE			0x0100	</span><span class="cm">/* Enable RTC/Reset Wakeup From Hibernate */</span><span class="cp"></span>
<span class="cp">#define CANWE			0x0200	</span><span class="cm">/* Enable CAN Wakeup From Hibernate */</span><span class="cp"></span>
<span class="cp">#define PHYWE			0x0400	</span><span class="cm">/* Enable PHY Wakeup From Hibernate */</span><span class="cp"></span>
<span class="cp">#define GPWE			0x0400	</span><span class="cm">/* General-Purpose Wake-Up Enable */</span><span class="cp"></span>
<span class="cp">#define MXVRWE			0x0400	</span><span class="cm">/* Enable MXVR Wakeup From Hibernate */</span><span class="cp"></span>
<span class="cp">#define KPADWE			0x1000	</span><span class="cm">/* Keypad Wake-Up Enable */</span><span class="cp"></span>
<span class="cp">#define ROTWE			0x2000	</span><span class="cm">/* Rotary Wake-Up Enable */</span><span class="cp"></span>
<span class="cp">#define CLKBUFOE		0x4000	</span><span class="cm">/* CLKIN Buffer Output Enable */</span><span class="cp"></span>
<span class="cp">#define SCKELOW			0x8000	</span><span class="cm">/* Do Not Drive SCKE High During Reset After Hibernate */</span><span class="cp"></span>

<span class="cp">#if defined(__ADSPBF52x__) || defined(__ADSPBF51x__)</span>
<span class="cp">#define USBWE			0x0200	</span><span class="cm">/* Enable USB Wakeup From Hibernate */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp">#define USBWE			0x0800	</span><span class="cm">/* Enable USB Wakeup From Hibernate */</span><span class="cp"></span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="kt">void</span> <span class="n">sleep_mode</span><span class="p">(</span><span class="n">u32</span> <span class="n">sic_iwr0</span><span class="p">,</span> <span class="n">u32</span> <span class="n">sic_iwr1</span><span class="p">,</span> <span class="n">u32</span> <span class="n">sic_iwr2</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">sleep_deeper</span><span class="p">(</span><span class="n">u32</span> <span class="n">sic_iwr0</span><span class="p">,</span> <span class="n">u32</span> <span class="n">sic_iwr1</span><span class="p">,</span> <span class="n">u32</span> <span class="n">sic_iwr2</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">do_hibernate</span><span class="p">(</span><span class="kt">int</span> <span class="n">wakeup</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">set_dram_srfs</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">unset_dram_srfs</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#define VRPAIR(vlev, freq) (((vlev) &lt;&lt; 16) | ((freq) &gt;&gt; 16))</span>

<span class="cp">#ifdef CONFIG_CPU_FREQ</span>
<span class="cp">#define CPUFREQ_CPU 0</span>
<span class="cp">#endif</span>
<span class="k">struct</span> <span class="n">bfin_dpmc_platform_data</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">tuple_tab</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">tabsize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">vr_settling_time</span><span class="p">;</span> <span class="cm">/* in us */</span>
<span class="p">};</span>

<span class="cp">#endif</span>

<span class="cp">#endif	</span><span class="cm">/*_BLACKFIN_DPMC_H_*/</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
