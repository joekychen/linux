f | init.c | s | 4.8K | 153 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for MN10300  Disintegrate asm/system.h for MN10300.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-am33-list@redhat.com
f | Makefile | g | 1.2K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | cache.inc | s | 2.6K | 110 | David Howells | dhowells@redhat.com | 1300467269 |  | MN10300: The icache invalidate functions should disable the icache first  The icache invalidate functions should disable the icache on AM33 and wait for it to quiesce before attempting to invalidate it, and should then wait for it to quiesce again before reenabling it, but on AM34 they should invalidate directly.  The same goes for the dcache invalidation, but this isn't used much.  Whilst we're at it, this can be wrapped in assembler macros to remove duplicate code.  The AM33 manual states that:  	An operation that invalidates the cache, switches the writing mode, or 	changes the way mode must be performed after disabling the cache, 	checking the busy bit, and confirming that the cache is not in 	operation.  for the dcache [sec 2.8.3.2.1].  This is not stated so for the icache [sec 2.8.3.1.1] but the example code there suggests that it is.  Whilst the AM34 manual states that the cache must be disabled for both the icache [sec 1.8.3.2.1] and the dcache [sec 1.8.3.2.1], the Panasonic hardware engineers say the manual is wrong and that disabling the caches for invalidation is wrong.  Furthermore, they say that disabling the caches on the AM34 whilst running an SMP kernel can lead to incoherency between the various CPU caches and should thus be avoided.  Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-dbg-inv-by-reg.S | g | 1.7K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | tlb-smp.c | s | 5.1K | 182 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for MN10300  Disintegrate asm/system.h for MN10300.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-am33-list@redhat.com
f | cache-flush-by-tag.S | g | 7.7K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-disabled.c | s | 606B | 20 | David Howells | dhowells@redhat.com | 1285722074 |  | MN10300: Handle missing sys_cacheflush() when caching disabled  When caching is disabled on the MN10300 arch, the sys_cacheflush() function is removed by conditional stuff in the makefiles, but is still referred to by the syscall table.  Provide a null version that just returns 0 when caching is disabled (or -EINVAL if the arguments are silly).  Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cache-smp-flush.c | s | 4.5K | 138 | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196927 |  | MN10300: Cache: Implement SMP global cache flushing  Implement SMP global cache flushing for MN10300.  This will be used by the AM34 which is SMP capable.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-inv-icache.c | s | 3.6K | 112 | David Howells | dhowells@redhat.com | 1300113929 |  | MN10300: The SMP_ICACHE_INV_FLUSH_RANGE IPI command does not exist  The invalidate-only versions of flush_icache_*range() are trying sending the SMP_ICACHE_INV_FLUSH_RANGE IPI command in SMP kernels when they should be sending SMP_ICACHE_INV_RANGE as the former does not exist.  Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-smp.c | s | 2.9K | 97 | KOSAKI Motohiro | kosaki.motohiro@jp.fujitsu.com | 1306337979 |  | mn10300: convert old cpumask API into new one  Adapt to the new API.  We plan to remove old cpumask APIs later.  Thus this patch converts them into the new one.  Signed-off-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: David Howells <dhowells@redhat.com> Cc: Koichi Yasutake <yasutake.koichi@jp.panasonic.com> Cc: Hugh Dickins <hughd@google.com> Cc: Chris Metcalf <cmetcalf@tilera.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cache-smp-inv.c | s | 4.3K | 135 | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196927 |  | MN10300: Cache: Implement SMP global cache flushing  Implement SMP global cache flushing for MN10300.  This will be used by the AM34 which is SMP capable.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-smp.h | s | 1.8K | 60 | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196927 |  | MN10300: Cache: Implement SMP global cache flushing  Implement SMP global cache flushing for MN10300.  This will be used by the AM34 which is SMP capable.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | Kconfig.cache | g | 4.5K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-inv-by-tag.S | g | 7.8K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | extable.c | s | 705B | 23 | David Howells | dhowells@redhat.com | 1202491350 |  | mn10300: add the MN10300/AM33 architecture to the kernel  Add architecture support for the MN10300/AM33 CPUs produced by MEI to the kernel.  This patch also adds board support for the ASB2303 with the ASB2308 daughter board, and the ASB2305.  The only processor supported is the MN103E010, which is an AM33v2 core plus on-chip devices.  [akpm@linux-foundation.org: nuke cvs control strings] Signed-off-by: Masakazu Urade <urade.masakazu@jp.panasonic.com> Signed-off-by: Koichi Yasutake <yasutake.koichi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cache-flush-by-reg.S | g | 7.6K |  | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196925 |  | MN10300: AM34: Add cacheflushing by using the AM34 purge registers  The AM34 CPU core provides an automated way of purging the cache rather than manually iterating over all the tags in the cache.  Make it possible to use these.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | misalignment.c | s | 29K | 860 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for MN10300  Disintegrate asm/system.h for MN10300.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-am33-list@redhat.com
f | cache-inv-by-reg.S | g | 8.3K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-flush-icache.c | s | 4.3K | 134 | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196927 |  | MN10300: Cache: Implement SMP global cache flushing  Implement SMP global cache flushing for MN10300.  This will be used by the AM34 which is SMP capable.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | dma-alloc.c | s | 2.0K | 60 | Julia Lawall | julia@diku.dk | 1282588884 |  | arch/mn10300/mm: eliminate NULL dereference  dev_name always dereferences its argument, so it should not be called if the argument is NULL.  The function indeed later tests the argument for being NULL.  The semantic match that finds this problem is as follows: (http://coccinelle.lip6.fr/)    // <smpl>   @@   expression dev,E;   @@    *dev_name(dev)   ... when != dev = E   (   *dev == NULL   ||   *dev != NULL   )   // </smpl>  Signed-off-by: Julia Lawall <julia@diku.dk> Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cache-dbg-flush-by-reg.S | g | 3.5K |  | David Howells | dhowells@redhat.com | 1307498632 |  | MN10300: Fix one of the kernel debugger cacheflush variants  One of the kernel debugger cacheflush variants escaped proper testing.  Two of the labels are wrong, being derived from the code that was copied to construct the variant.  The first label results in the following assembler message:      AS      arch/mn10300/mm/cache-dbg-flush-by-reg.o   arch/mn10300/mm/cache-dbg-flush-by-reg.S: Assembler messages:   arch/mn10300/mm/cache-dbg-flush-by-reg.S:123: Error: symbol `debugger_local_cache_flushinv_no_dcache' is already defined  And the second label results in the following linker message:    arch/mn10300/mm/built-in.o:(.text+0x1d39): undefined reference to `mn10300_local_icache_inv_range_reg_end'   arch/mn10300/mm/built-in.o:(.text+0x1d39): relocation truncated to fit: R_MN10300_PCREL16 against undefined symbol `mn10300_local_icache_inv_range_reg_end'  To test this file the following configuration pieces must be set:  	CONFIG_AM34=y 	CONFIG_MN10300_CACHE_WBACK=y 	CONFIG_MN10300_DEBUGGER_CACHE_FLUSH_BY_REG=y 	CONFIG_MN10300_CACHE_MANAGE_BY_REG=y 	CONFIG_AM34_HAS_CACHE_SNOOP=n  Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mmu-context.c | s | 1.6K | 55 | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196929 |  | MN10300: Make the use of PIDR to mark TLB entries controllable  Make controllable the use of the PIDR register to mark TLB entries as belonging to particular processes.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | cache.c | s | 1.6K | 50 | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196927 |  | MN10300: Cache: Implement SMP global cache flushing  Implement SMP global cache flushing for MN10300.  This will be used by the AM34 which is SMP capable.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-dbg-flush-by-tag.S | g | 3.2K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | pgtable.c | s | 4.5K | 149 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for MN10300  Disintegrate asm/system.h for MN10300.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-am33-list@redhat.com
f | tlb-mn10300.S | g | 5.0K |  | Akira Takeuchi | takeuchi.akr@jp.panasonic.com | 1288196930 |  | MN10300: Use the [ID]PTEL2 registers rather than [ID]PTEL for TLB control  Use the [ID]PTEL2 registers rather than [ID]PTEL for TLB control as the bits are a more suitable layout.  Signed-off-by: Akira Takeuchi <takeuchi.akr@jp.panasonic.com> Signed-off-by: Kiyoshi Owada <owada.kiyoshi@jp.panasonic.com> Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-dbg-inv.S | g | 1.3K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | cache-dbg-inv-by-tag.S | g | 3.1K |  | David Howells | dhowells@redhat.com | 1300467270 |  | MN10300: Create general kernel debugger cache flushing  Create general kernel debugger cache flushing for MN10300 and get rid of the old stuff that gdbstub was using.  Signed-off-by: David Howells <dhowells@redhat.com>
f | fault.c | s | 9.7K | 347 | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for MN10300  Disintegrate asm/system.h for MN10300.  Signed-off-by: David Howells <dhowells@redhat.com> cc: linux-am33-list@redhat.com
