<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › microblaze › include › asm › elf.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>elf.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 2008-2009 Michal Simek &lt;monstr@monstr.eu&gt;</span>
<span class="cm"> * Copyright (C) 2008-2009 PetaLogix</span>
<span class="cm"> * Copyright (C) 2006 Atmark Techno, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * This file is subject to the terms and conditions of the GNU General Public</span>
<span class="cm"> * License. See the file &quot;COPYING&quot; in the main directory of this archive</span>
<span class="cm"> * for more details.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _ASM_MICROBLAZE_ELF_H</span>
<span class="cp">#define _ASM_MICROBLAZE_ELF_H</span>

<span class="cm">/*</span>
<span class="cm"> * Note there is no &quot;official&quot; ELF designation for Microblaze.</span>
<span class="cm"> * I&#39;ve snaffled the value from the microblaze binutils source code</span>
<span class="cm"> * /binutils/microblaze/include/elf/microblaze.h</span>
<span class="cm"> */</span>
<span class="cp">#define EM_MICROBLAZE		189</span>
<span class="cp">#define EM_MICROBLAZE_OLD	0xbaab</span>
<span class="cp">#define ELF_ARCH		EM_MICROBLAZE</span>

<span class="cm">/*</span>
<span class="cm"> * This is used to ensure we don&#39;t load something for the wrong architecture.</span>
<span class="cm"> */</span>
<span class="cp">#define elf_check_arch(x)	((x)-&gt;e_machine == EM_MICROBLAZE \</span>
<span class="cp">				 || (x)-&gt;e_machine == EM_MICROBLAZE_OLD)</span>

<span class="cm">/*</span>
<span class="cm"> * These are used to set parameters in the core dumps.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_CLASS	ELFCLASS32</span>

<span class="cp">#ifndef __uClinux__</span>

<span class="cm">/*</span>
<span class="cm"> * ELF register definitions..</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;asm/ptrace.h&gt;</span>
<span class="cp">#include &lt;asm/byteorder.h&gt;</span>

<span class="cp">#ifndef ELF_GREG_T</span>
<span class="cp">#define ELF_GREG_T</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_greg_t</span><span class="p">;</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef ELF_NGREG</span>
<span class="cp">#define ELF_NGREG (sizeof(struct pt_regs) / sizeof(elf_greg_t))</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef ELF_GREGSET_T</span>
<span class="cp">#define ELF_GREGSET_T</span>
<span class="k">typedef</span> <span class="n">elf_greg_t</span> <span class="n">elf_gregset_t</span><span class="p">[</span><span class="n">ELF_NGREG</span><span class="p">];</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef ELF_FPREGSET_T</span>
<span class="cp">#define ELF_FPREGSET_T</span>

<span class="cm">/* TBD */</span>
<span class="cp">#define ELF_NFPREG	33	</span><span class="cm">/* includes fsr */</span><span class="cp"></span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_fpreg_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">elf_fpreg_t</span> <span class="n">elf_fpregset_t</span><span class="p">[</span><span class="n">ELF_NFPREG</span><span class="p">];</span>

<span class="cm">/* typedef struct user_fpu_struct elf_fpregset_t; */</span>
<span class="cp">#endif</span>

<span class="cm">/* This is the location that an ET_DYN program is loaded if exec&#39;ed.  Typical</span>
<span class="cm"> * use of this is to invoke &quot;./ld.so someprog&quot; to test out a new version of</span>
<span class="cm"> * the loader.  We need to make sure that it is out of the way of the program</span>
<span class="cm"> * that it will &quot;exec&quot;, and that there is sufficient room for the brk.</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_ET_DYN_BASE         (0x08000000)</span>

<span class="cp">#ifdef __MICROBLAZEEL__</span>
<span class="cp">#define ELF_DATA	ELFDATA2LSB</span>
<span class="cp">#else</span>
<span class="cp">#define ELF_DATA	ELFDATA2MSB</span>
<span class="cp">#endif</span>

<span class="cp">#define ELF_EXEC_PAGESIZE	PAGE_SIZE</span>


<span class="cp">#define ELF_CORE_COPY_REGS(_dest, _regs)			\</span>
<span class="cp">	memcpy((char *) &amp;_dest, (char *) _regs,		\</span>
<span class="cp">	sizeof(struct pt_regs));</span>

<span class="cm">/* This yields a mask that user programs can use to figure out what</span>
<span class="cm"> * instruction set this CPU supports.  This could be done in user space,</span>
<span class="cm"> * but it&#39;s not easy, and we&#39;ve already done it here.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_HWCAP	(0)</span>

<span class="cm">/* This yields a string that ld.so will use to load implementation</span>
<span class="cm"> * specific libraries for optimization.  This is more specific in</span>
<span class="cm"> * intent than poking at uname or /proc/cpuinfo.</span>

<span class="cm"> * For the moment, we have only optimizations for the Intel generations,</span>
<span class="cm"> * but that could change...</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_PLATFORM  (NULL)</span>

<span class="cm">/* Added _f parameter. Is this definition correct: TBD */</span>
<span class="cp">#define ELF_PLAT_INIT(_r, _f)				\</span>
<span class="cp">do {							\</span>
<span class="cp">	_r-&gt;r1 =  _r-&gt;r1 =  _r-&gt;r2 =  _r-&gt;r3 =		\</span>
<span class="cp">	_r-&gt;r4 =  _r-&gt;r5 =  _r-&gt;r6 =  _r-&gt;r7 =		\</span>
<span class="cp">	_r-&gt;r8 =  _r-&gt;r9 =  _r-&gt;r10 = _r-&gt;r11 =		\</span>
<span class="cp">	_r-&gt;r12 = _r-&gt;r13 = _r-&gt;r14 = _r-&gt;r15 =		\</span>
<span class="cp">	_r-&gt;r16 = _r-&gt;r17 = _r-&gt;r18 = _r-&gt;r19 =		\</span>
<span class="cp">	_r-&gt;r20 = _r-&gt;r21 = _r-&gt;r22 = _r-&gt;r23 =		\</span>
<span class="cp">	_r-&gt;r24 = _r-&gt;r25 = _r-&gt;r26 = _r-&gt;r27 =		\</span>
<span class="cp">	_r-&gt;r28 = _r-&gt;r29 = _r-&gt;r30 = _r-&gt;r31 =		\</span>
<span class="cp">	0;						\</span>
<span class="cp">} while (0)</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#define SET_PERSONALITY(ex) set_personality(PER_LINUX_32BIT)</span>
<span class="cp">#endif</span>

<span class="cp">#endif </span><span class="cm">/* __uClinux__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _ASM_MICROBLAZE_ELF_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
