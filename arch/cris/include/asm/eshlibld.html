<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › cris › include › asm › eshlibld.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>eshlibld.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*!**************************************************************************</span>
<span class="cm">*!</span>
<span class="cm">*! FILE NAME  : eshlibld.h</span>
<span class="cm">*!</span>
<span class="cm">*! DESCRIPTION: Prototypes for exported shared library functions</span>
<span class="cm">*!</span>
<span class="cm">*! FUNCTIONS  : perform_cris_aout_relocations, shlibmod_fork, shlibmod_exit</span>
<span class="cm">*! (EXPORTED)</span>
<span class="cm">*!</span>
<span class="cm">*!---------------------------------------------------------------------------</span>
<span class="cm">*!</span>
<span class="cm">*! (C) Copyright 1998, 1999 Axis Communications AB, LUND, SWEDEN</span>
<span class="cm">*!</span>
<span class="cm">*!**************************************************************************/</span>
<span class="cm">/* $Id: eshlibld.h,v 1.2 2001/02/23 13:47:33 bjornw Exp $ */</span>

<span class="cp">#ifndef _cris_relocate_h</span>
<span class="cp">#define _cris_relocate_h</span>

<span class="cm">/* Please note that this file is also compiled into the xsim simulator.</span>
<span class="cm">   Try to avoid breaking its double use (only works on a little-endian</span>
<span class="cm">   32-bit machine such as the i386 anyway).</span>

<span class="cm">   Use __KERNEL__ when you&#39;re about to use kernel functions,</span>
<span class="cm">       (which you should not do here anyway, since this file is</span>
<span class="cm">       used by glibc).</span>
<span class="cm">   Use defined(__KERNEL__) || defined(__elinux__) when doing</span>
<span class="cm">       things that only makes sense on an elinux system.</span>
<span class="cm">   Use __CRIS__ when you&#39;re about to do (really) CRIS-specific code.</span>
<span class="cm">*/</span>

<span class="cm">/* We have dependencies all over the place for the host system</span>
<span class="cm">   for xsim being a linux system, so let&#39;s not pretend anything</span>
<span class="cm">   else with #ifdef:s here until fixed.  */</span>
<span class="cp">#include &lt;linux/limits.h&gt;</span>

<span class="cm">/* Maybe do sanity checking if file input. */</span>
<span class="cp">#undef SANITYCHECK_RELOC</span>

<span class="cm">/* Maybe output debug messages. */</span>
<span class="cp">#undef RELOC_DEBUG</span>

<span class="cm">/* Maybe we want to share core as well as disk space.</span>
<span class="cm">   Mainly depends on the config macro CONFIG_SHARE_SHLIB_CORE, but it is</span>
<span class="cm">   assumed that we want to share code when debugging (exposes more</span>
<span class="cm">   trouble). */</span>
<span class="cp">#ifndef SHARE_LIB_CORE</span>
<span class="cp"># if (defined(__KERNEL__) || !defined(RELOC_DEBUG)) \</span>
<span class="cp">     &amp;&amp; !defined(CONFIG_SHARE_SHLIB_CORE)</span>
<span class="cp">#  define SHARE_LIB_CORE 0</span>
<span class="cp"># else</span>
<span class="cp">#  define SHARE_LIB_CORE 1</span>
<span class="cp"># endif </span><span class="cm">/* __KERNEL__ etc */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* SHARE_LIB_CORE */</span><span class="cp"></span>


<span class="cm">/* Main exported function; supposed to be called when the program a.out</span>
<span class="cm">   has been read in. */</span>
<span class="k">extern</span> <span class="kt">int</span>
<span class="n">perform_cris_aout_relocations</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">text</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tlength</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">dlength</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">baddr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">blength</span><span class="p">,</span>

			      <span class="cm">/* These may be zero when there&#39;s &quot;perfect&quot;</span>
<span class="cm">				 position-independent code. */</span>
			      <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">trel</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tsrel</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">dsrel</span><span class="p">,</span>

			      <span class="cm">/* These will be zero at a first try, to see</span>
<span class="cm">				 if code is statically linked.  Else a</span>
<span class="cm">				 second try, with the symbol table and</span>
<span class="cm">				 string table nonzero should be done. */</span>
			      <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">symlength</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">strings</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stringlength</span><span class="p">,</span>

			      <span class="cm">/* These will only be used when symbol table</span>
<span class="cm">			       information is present. */</span>
			      <span class="kt">char</span> <span class="o">**</span><span class="n">env</span><span class="p">,</span> <span class="kt">int</span> <span class="n">envc</span><span class="p">,</span>
			      <span class="kt">int</span> <span class="n">euid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">is_suid</span><span class="p">);</span>


<span class="cp">#ifdef RELOC_DEBUG</span>
<span class="cm">/* Task-specific debug stuff. */</span>
<span class="k">struct</span> <span class="n">task_reloc_debug</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">memdebug</span> <span class="o">*</span><span class="n">alloclast</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">alloc_total</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">export_total</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#endif </span><span class="cm">/* RELOC_DEBUG */</span><span class="cp"></span>

<span class="cp">#if SHARE_LIB_CORE</span>

<span class="cm">/* When code (and some very specific data) is shared and not just</span>
<span class="cm">   dynamically linked, we need to export hooks for exec beginning and</span>
<span class="cm">   end. */</span>

<span class="k">struct</span> <span class="n">shlibdep</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">void</span>
<span class="n">shlibmod_exit</span><span class="p">(</span><span class="k">struct</span> <span class="n">shlibdep</span> <span class="o">**</span><span class="n">deps</span><span class="p">);</span>

<span class="cm">/* Returns 0 if failure, nonzero for ok. */</span>
<span class="k">extern</span> <span class="kt">int</span>
<span class="n">shlibmod_fork</span><span class="p">(</span><span class="k">struct</span> <span class="n">shlibdep</span> <span class="o">**</span><span class="n">deps</span><span class="p">);</span>

<span class="cp">#else  </span><span class="cm">/* ! SHARE_LIB_CORE */</span><span class="cp"></span>
<span class="cp"># define shlibmod_exit(x)</span>
<span class="cp"># define shlibmod_fork(x) 1</span>
<span class="cp">#endif </span><span class="cm">/* ! SHARE_LIB_CORE */</span><span class="cp"></span>

<span class="cp">#endif _cris_relocate_h</span>
<span class="cm">/********************** END OF FILE eshlibld.h *****************************/</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
