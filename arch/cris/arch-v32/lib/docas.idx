f | Makefile | g | 162B |  | Jesper Nilsson | jesper.nilsson@axis.com | 1244640063 |  | CRISv32: Add arch optimized strcmp.  Add an optimized strcmp for CRISv32. This improves strcmp performance with about 25% when comparing a 55 character string with itself.  Signed-off-by: Edgar Iglesias <edgar@axis.com> Acked-by: Jesper Nilsson <jesper.nilsson@axis.com>
f | string.c | s | 6.9K | 201 | Jesper Nilsson | jesper.nilsson@axis.com | 1204677313 |  | CRIS: Import string.c (memcpy) from newlib: fixes compile error with gcc 4  Adrian Bunk reported another compile error with a SVN head GCC:  ...   CC      arch/cris/arch-v10/lib/string.o /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/string.c:138: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/string.c:138: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/string.c:139: error: lvalue required as increment operand ...  This is due to the use of the construct:  	*((long*)dst)++ = lc;  Which isn't legal since casts don't return an lvalue.  The solution is to import the implementation from newlib, which is continually autotested together with GCC mainline, and uses the construct:  	*(long *) dst = lc; dst += 4;  Since this is an import of a file from newlib, I'm not touching the formatting or correcting any checkpatch errors.  As for the earlier fix for memset.c, even if the two files for CRIS v10 and CRIS v32 are identical at the moment, it might be possible to tweak the CRIS v32 version. Thus, I'm not yet folding them into the same file, at least not until we've done some research on it.  Signed-off-by: Jesper Nilsson <jesper.nilsson@axis.com> Cc: Mikael Starvik <starvik@axis.com> Cc: Adrian Bunk <bunk@stusta.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | delay.c | s | 657B | 25 | Jesper Nilsson | jesper.nilsson@axis.com | 1202465195 |  | CRIS v32: Add precise delay loops for ETRAX FS and ARTPEC-3.  Implements cris_delay10ns.
f | csumcpfruser.S | g | 1.7K |  | Mikael Starvik | mikael.starvik@axis.com | 1122506761 |  | [PATCH] CRIS update: new subarchitecture v32  New CRIS sub architecture named v32.  From: Dave Jones <davej@redhat.com>  	Fix swapped kmalloc args  Signed-off-by: Mikael Starvik <starvik@axis.com> Signed-off-by: Dave Jones <davej@redhat.com> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | usercopy.c | s | 13K | 417 | Jesper Nilsson | jesper.nilsson@axis.com | 1204677316 |  | cris: correct usage of __user for copy to and from user space in lib/usercopy and uaccess.h  Function __copy_user_zeroing in arch/lib/usercopy.c had the wrong parameter set as __user, and in include/asm-cris/uaccess.h, it was not set at all for some of the calling functions.  This will cut the number of warnings quite dramatically when using sparse.  While we're here, remove useless CVS log and correct confusing typo.  Signed-off-by: Jesper Nilsson <jesper.nilsson@axis.com> Cc: Mikael Starvik <mikael.starvik@axis.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | spinlock.S | g | 588B |  | Jesper Nilsson | jesper.nilsson@axis.com | 1280919750 |  | CRIS: Add debug info for assembler code  Signed-off-by: Jesper Nilsson <jesper.nilsson@axis.com>
f | checksumcopy.S | g | 2.1K |  | Jesper Nilsson | jesper.nilsson@axis.com | 1280919749 |  | CRIS: Add debug symbols for assembler code  Signed-off-by: Jesper Nilsson <jesper.nilsson@axis.com>
f | strcmp.S | g | 416B |  | Jesper Nilsson | jesper.nilsson@axis.com | 1244640063 |  | CRISv32: Add arch optimized strcmp.  Add an optimized strcmp for CRISv32. This improves strcmp performance with about 25% when comparing a 55 character string with itself.  Signed-off-by: Edgar Iglesias <edgar@axis.com> Acked-by: Jesper Nilsson <jesper.nilsson@axis.com>
f | checksum.S | g | 1.7K |  | Jesper Nilsson | jesper.nilsson@axis.com | 1280919749 |  | CRIS: Add debug info for assembler code  Signed-off-by: Jesper Nilsson <jesper.nilsson@axis.com>
f | memset.c | s | 7.3K | 222 | Jesper Nilsson | jesper.nilsson@axis.com | 1203051484 |  | cris: import memset.c from newlib: fixes compile error with newer (pre4.3) gcc  Adrian Bunk reported the following compile error with a SVN head GCC:  ... CC arch/cris/arch-v10/lib/memset.o /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c: In function 'memset': /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c:164: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c:165: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c:166: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c:167: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c:185: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c:189: error: lvalue required as increment operand /home/bunk/linux/kernel-2.6/git/linux-2.6/arch/cris/arch-v10/lib/memset.c:192: error: lvalue required as increment operand ... etc ...  This is due to the use of the construct:  	*((long*)dst)++ = lc;  Which is no longer legal since casts don't return an lvalue.  The solution is to import the implementation from newlib, which is continually autotested together with GCC mainline, and uses the construct:  	*(long *) dst = lc; dst += 4;  With this change, the generated code actually shrinks 76 bytes since gcc notices that it can use autoincrement for the move instruction in CRIS.     text    data     bss     dec     hex filename     304       0       0     304     130 memset.old.o    text    data     bss     dec     hex filename     228       0       0     228      e4 memset.o  Since this is an import of a file from newlib, I'm not touching the formatting or correcting any checkpatch errors.  Note also that even if the two files for the CRIS v10 and CRIS v32 are identical at the moment, it might be possible to tweak the CRIS v32 version. Thus, I'm not yet folding them into the same file, at least not until we've done some research on it.  Signed-off-by: Jesper Nilsson <jesper.nilsson@axis.com> Cc: Mikael Starvik <mikael.starvik@axis.com> Cc: Adrian Bunk <bunk@stusta.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
