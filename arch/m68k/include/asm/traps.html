<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › m68k › include › asm › traps.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>traps.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  linux/include/asm/traps.h</span>
<span class="cm"> *</span>
<span class="cm"> *  Copyright (C) 1993        Hamish Macdonald</span>
<span class="cm"> *</span>
<span class="cm"> * This file is subject to the terms and conditions of the GNU General Public</span>
<span class="cm"> * License.  See the file COPYING in the main directory of this archive</span>
<span class="cm"> * for more details.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _M68K_TRAPS_H</span>
<span class="cp">#define _M68K_TRAPS_H</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="cp">#include &lt;linux/linkage.h&gt;</span>
<span class="cp">#include &lt;asm/ptrace.h&gt;</span>

<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">e_vector</span><span class="p">)(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">e_vector</span> <span class="n">vectors</span><span class="p">[];</span>
<span class="k">extern</span> <span class="n">e_vector</span> <span class="o">*</span><span class="n">_ramvec</span><span class="p">;</span>

<span class="n">asmlinkage</span> <span class="kt">void</span> <span class="n">auto_inthandler</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="n">asmlinkage</span> <span class="kt">void</span> <span class="n">user_inthandler</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="n">asmlinkage</span> <span class="kt">void</span> <span class="n">bad_inthandler</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#endif</span>

<span class="cp">#define VEC_RESETSP (0)</span>
<span class="cp">#define VEC_RESETPC (1)</span>
<span class="cp">#define VEC_BUSERR  (2)</span>
<span class="cp">#define VEC_ADDRERR (3)</span>
<span class="cp">#define VEC_ILLEGAL (4)</span>
<span class="cp">#define VEC_ZERODIV (5)</span>
<span class="cp">#define VEC_CHK     (6)</span>
<span class="cp">#define VEC_TRAP    (7)</span>
<span class="cp">#define VEC_PRIV    (8)</span>
<span class="cp">#define VEC_TRACE   (9)</span>
<span class="cp">#define VEC_LINE10  (10)</span>
<span class="cp">#define VEC_LINE11  (11)</span>
<span class="cp">#define VEC_RESV12  (12)</span>
<span class="cp">#define VEC_COPROC  (13)</span>
<span class="cp">#define VEC_FORMAT  (14)</span>
<span class="cp">#define VEC_UNINT   (15)</span>
<span class="cp">#define VEC_RESV16  (16)</span>
<span class="cp">#define VEC_RESV17  (17)</span>
<span class="cp">#define VEC_RESV18  (18)</span>
<span class="cp">#define VEC_RESV19  (19)</span>
<span class="cp">#define VEC_RESV20  (20)</span>
<span class="cp">#define VEC_RESV21  (21)</span>
<span class="cp">#define VEC_RESV22  (22)</span>
<span class="cp">#define VEC_RESV23  (23)</span>
<span class="cp">#define VEC_SPUR    (24)</span>
<span class="cp">#define VEC_INT1    (25)</span>
<span class="cp">#define VEC_INT2    (26)</span>
<span class="cp">#define VEC_INT3    (27)</span>
<span class="cp">#define VEC_INT4    (28)</span>
<span class="cp">#define VEC_INT5    (29)</span>
<span class="cp">#define VEC_INT6    (30)</span>
<span class="cp">#define VEC_INT7    (31)</span>
<span class="cp">#define VEC_SYS     (32)</span>
<span class="cp">#define VEC_TRAP1   (33)</span>
<span class="cp">#define VEC_TRAP2   (34)</span>
<span class="cp">#define VEC_TRAP3   (35)</span>
<span class="cp">#define VEC_TRAP4   (36)</span>
<span class="cp">#define VEC_TRAP5   (37)</span>
<span class="cp">#define VEC_TRAP6   (38)</span>
<span class="cp">#define VEC_TRAP7   (39)</span>
<span class="cp">#define VEC_TRAP8   (40)</span>
<span class="cp">#define VEC_TRAP9   (41)</span>
<span class="cp">#define VEC_TRAP10  (42)</span>
<span class="cp">#define VEC_TRAP11  (43)</span>
<span class="cp">#define VEC_TRAP12  (44)</span>
<span class="cp">#define VEC_TRAP13  (45)</span>
<span class="cp">#define VEC_TRAP14  (46)</span>
<span class="cp">#define VEC_TRAP15  (47)</span>
<span class="cp">#define VEC_FPBRUC  (48)</span>
<span class="cp">#define VEC_FPIR    (49)</span>
<span class="cp">#define VEC_FPDIVZ  (50)</span>
<span class="cp">#define VEC_FPUNDER (51)</span>
<span class="cp">#define VEC_FPOE    (52)</span>
<span class="cp">#define VEC_FPOVER  (53)</span>
<span class="cp">#define VEC_FPNAN   (54)</span>
<span class="cp">#define VEC_FPUNSUP (55)</span>
<span class="cp">#define VEC_MMUCFG  (56)</span>
<span class="cp">#define VEC_MMUILL  (57)</span>
<span class="cp">#define VEC_MMUACC  (58)</span>
<span class="cp">#define VEC_RESV59  (59)</span>
<span class="cp">#define	VEC_UNIMPEA (60)</span>
<span class="cp">#define	VEC_UNIMPII (61)</span>
<span class="cp">#define VEC_RESV62  (62)</span>
<span class="cp">#define VEC_RESV63  (63)</span>
<span class="cp">#define VEC_USER    (64)</span>

<span class="cp">#define VECOFF(vec) ((vec)&lt;&lt;2)</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="cm">/* Status register bits */</span>
<span class="cp">#define PS_T  (0x8000)</span>
<span class="cp">#define PS_S  (0x2000)</span>
<span class="cp">#define PS_M  (0x1000)</span>
<span class="cp">#define PS_C  (0x0001)</span>

<span class="cm">/* bits for 68020/68030 special status word */</span>

<span class="cp">#define FC    (0x8000)</span>
<span class="cp">#define FB    (0x4000)</span>
<span class="cp">#define RC    (0x2000)</span>
<span class="cp">#define RB    (0x1000)</span>
<span class="cp">#define DF    (0x0100)</span>
<span class="cp">#define RM    (0x0080)</span>
<span class="cp">#define RW    (0x0040)</span>
<span class="cp">#define SZ    (0x0030)</span>
<span class="cp">#define DFC   (0x0007)</span>

<span class="cm">/* bits for 68030 MMU status register (mmusr,psr) */</span>

<span class="cp">#define MMU_B	     (0x8000)    </span><span class="cm">/* bus error */</span><span class="cp"></span>
<span class="cp">#define MMU_L	     (0x4000)    </span><span class="cm">/* limit violation */</span><span class="cp"></span>
<span class="cp">#define MMU_S	     (0x2000)    </span><span class="cm">/* supervisor violation */</span><span class="cp"></span>
<span class="cp">#define MMU_WP	     (0x0800)    </span><span class="cm">/* write-protected */</span><span class="cp"></span>
<span class="cp">#define MMU_I	     (0x0400)    </span><span class="cm">/* invalid descriptor */</span><span class="cp"></span>
<span class="cp">#define MMU_M	     (0x0200)    </span><span class="cm">/* ATC entry modified */</span><span class="cp"></span>
<span class="cp">#define MMU_T	     (0x0040)    </span><span class="cm">/* transparent translation */</span><span class="cp"></span>
<span class="cp">#define MMU_NUM      (0x0007)    </span><span class="cm">/* number of levels traversed */</span><span class="cp"></span>


<span class="cm">/* bits for 68040 special status word */</span>
<span class="cp">#define CP_040	(0x8000)</span>
<span class="cp">#define CU_040	(0x4000)</span>
<span class="cp">#define CT_040	(0x2000)</span>
<span class="cp">#define CM_040	(0x1000)</span>
<span class="cp">#define MA_040	(0x0800)</span>
<span class="cp">#define ATC_040 (0x0400)</span>
<span class="cp">#define LK_040	(0x0200)</span>
<span class="cp">#define RW_040	(0x0100)</span>
<span class="cp">#define SIZ_040 (0x0060)</span>
<span class="cp">#define TT_040	(0x0018)</span>
<span class="cp">#define TM_040	(0x0007)</span>

<span class="cm">/* bits for 68040 write back status word */</span>
<span class="cp">#define WBV_040   (0x80)</span>
<span class="cp">#define WBSIZ_040 (0x60)</span>
<span class="cp">#define WBBYT_040 (0x20)</span>
<span class="cp">#define WBWRD_040 (0x40)</span>
<span class="cp">#define WBLNG_040 (0x00)</span>
<span class="cp">#define WBTT_040  (0x18)</span>
<span class="cp">#define WBTM_040  (0x07)</span>

<span class="cm">/* bus access size codes */</span>
<span class="cp">#define BA_SIZE_BYTE    (0x20)</span>
<span class="cp">#define BA_SIZE_WORD    (0x40)</span>
<span class="cp">#define BA_SIZE_LONG    (0x00)</span>
<span class="cp">#define BA_SIZE_LINE    (0x60)</span>

<span class="cm">/* bus access transfer type codes */</span>
<span class="cp">#define BA_TT_MOVE16    (0x08)</span>

<span class="cm">/* bits for 68040 MMU status register (mmusr) */</span>
<span class="cp">#define MMU_B_040   (0x0800)</span>
<span class="cp">#define MMU_G_040   (0x0400)</span>
<span class="cp">#define MMU_S_040   (0x0080)</span>
<span class="cp">#define MMU_CM_040  (0x0060)</span>
<span class="cp">#define MMU_M_040   (0x0010)</span>
<span class="cp">#define MMU_WP_040  (0x0004)</span>
<span class="cp">#define MMU_T_040   (0x0002)</span>
<span class="cp">#define MMU_R_040   (0x0001)</span>

<span class="cm">/* bits in the 68060 fault status long word (FSLW) */</span>
<span class="cp">#define	MMU060_MA	(0x08000000)	</span><span class="cm">/* misaligned */</span><span class="cp"></span>
<span class="cp">#define	MMU060_LK	(0x02000000)	</span><span class="cm">/* locked transfer */</span><span class="cp"></span>
<span class="cp">#define	MMU060_RW	(0x01800000)	</span><span class="cm">/* read/write */</span><span class="cp"></span>
<span class="cp"># define MMU060_RW_W	(0x00800000)	</span><span class="cm">/* write */</span><span class="cp"></span>
<span class="cp"># define MMU060_RW_R	(0x01000000)	</span><span class="cm">/* read */</span><span class="cp"></span>
<span class="cp"># define MMU060_RW_RMW	(0x01800000)	</span><span class="cm">/* read/modify/write */</span><span class="cp"></span>
<span class="cp"># define MMU060_W	(0x00800000)	</span><span class="cm">/* general write, includes rmw */</span><span class="cp"></span>
<span class="cp">#define	MMU060_SIZ	(0x00600000)	</span><span class="cm">/* transfer size */</span><span class="cp"></span>
<span class="cp">#define	MMU060_TT	(0x00180000)	</span><span class="cm">/* transfer type (TT) bits */</span><span class="cp"></span>
<span class="cp">#define	MMU060_TM	(0x00070000)	</span><span class="cm">/* transfer modifier (TM) bits */</span><span class="cp"></span>
<span class="cp">#define	MMU060_IO	(0x00008000)	</span><span class="cm">/* instruction or operand */</span><span class="cp"></span>
<span class="cp">#define	MMU060_PBE	(0x00004000)	</span><span class="cm">/* push buffer bus error */</span><span class="cp"></span>
<span class="cp">#define	MMU060_SBE	(0x00002000)	</span><span class="cm">/* store buffer bus error */</span><span class="cp"></span>
<span class="cp">#define	MMU060_PTA	(0x00001000)	</span><span class="cm">/* pointer A fault */</span><span class="cp"></span>
<span class="cp">#define	MMU060_PTB	(0x00000800)	</span><span class="cm">/* pointer B fault */</span><span class="cp"></span>
<span class="cp">#define	MMU060_IL	(0x00000400)	</span><span class="cm">/* double indirect descr fault */</span><span class="cp"></span>
<span class="cp">#define	MMU060_PF	(0x00000200)	</span><span class="cm">/* page fault (invalid descr) */</span><span class="cp"></span>
<span class="cp">#define	MMU060_SP	(0x00000100)	</span><span class="cm">/* supervisor protection */</span><span class="cp"></span>
<span class="cp">#define	MMU060_WP	(0x00000080)	</span><span class="cm">/* write protection */</span><span class="cp"></span>
<span class="cp">#define	MMU060_TWE	(0x00000040)	</span><span class="cm">/* bus error on table search */</span><span class="cp"></span>
<span class="cp">#define	MMU060_RE	(0x00000020)	</span><span class="cm">/* bus error on read */</span><span class="cp"></span>
<span class="cp">#define	MMU060_WE	(0x00000010)	</span><span class="cm">/* bus error on write */</span><span class="cp"></span>
<span class="cp">#define	MMU060_TTR	(0x00000008)	</span><span class="cm">/* error caused by TTR translation */</span><span class="cp"></span>
<span class="cp">#define	MMU060_BPE	(0x00000004)	</span><span class="cm">/* branch prediction error */</span><span class="cp"></span>
<span class="cp">#define	MMU060_SEE	(0x00000001)	</span><span class="cm">/* software emulated error */</span><span class="cp"></span>

<span class="cm">/* cases of missing or invalid descriptors */</span>
<span class="cp">#define MMU060_DESC_ERR (MMU060_PTA | MMU060_PTB | \</span>
<span class="cp">			 MMU060_IL  | MMU060_PF)</span>
<span class="cm">/* bits that indicate real errors */</span>
<span class="cp">#define MMU060_ERR_BITS (MMU060_PBE | MMU060_SBE | MMU060_DESC_ERR | MMU060_SP | \</span>
<span class="cp">			 MMU060_WP  | MMU060_TWE | MMU060_RE       | MMU060_WE)</span>

<span class="cm">/* structure for stack frames */</span>

<span class="k">struct</span> <span class="n">frame</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">pt_regs</span> <span class="n">ptregs</span><span class="p">;</span>
    <span class="k">union</span> <span class="p">{</span>
	    <span class="k">struct</span> <span class="p">{</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">iaddr</span><span class="p">;</span>    <span class="cm">/* instruction address */</span>
	    <span class="p">}</span> <span class="n">fmt2</span><span class="p">;</span>
	    <span class="k">struct</span> <span class="p">{</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">effaddr</span><span class="p">;</span>  <span class="cm">/* effective address */</span>
	    <span class="p">}</span> <span class="n">fmt3</span><span class="p">;</span>
	    <span class="k">struct</span> <span class="p">{</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">effaddr</span><span class="p">;</span>  <span class="cm">/* effective address */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">pc</span><span class="p">;</span>	     <span class="cm">/* pc of faulted instr */</span>
	    <span class="p">}</span> <span class="n">fmt4</span><span class="p">;</span>
	    <span class="k">struct</span> <span class="p">{</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">effaddr</span><span class="p">;</span>  <span class="cm">/* effective address */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ssw</span><span class="p">;</span>      <span class="cm">/* special status word */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">wb3s</span><span class="p">;</span>     <span class="cm">/* write back 3 status */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">wb2s</span><span class="p">;</span>     <span class="cm">/* write back 2 status */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">wb1s</span><span class="p">;</span>     <span class="cm">/* write back 1 status */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">faddr</span><span class="p">;</span>    <span class="cm">/* fault address */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">wb3a</span><span class="p">;</span>     <span class="cm">/* write back 3 address */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">wb3d</span><span class="p">;</span>     <span class="cm">/* write back 3 data */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">wb2a</span><span class="p">;</span>     <span class="cm">/* write back 2 address */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">wb2d</span><span class="p">;</span>     <span class="cm">/* write back 2 data */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">wb1a</span><span class="p">;</span>     <span class="cm">/* write back 1 address */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">wb1dpd0</span><span class="p">;</span>  <span class="cm">/* write back 1 data/push data 0*/</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">pd1</span><span class="p">;</span>      <span class="cm">/* push data 1*/</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">pd2</span><span class="p">;</span>      <span class="cm">/* push data 2*/</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">pd3</span><span class="p">;</span>      <span class="cm">/* push data 3*/</span>
	    <span class="p">}</span> <span class="n">fmt7</span><span class="p">;</span>
	    <span class="k">struct</span> <span class="p">{</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">iaddr</span><span class="p">;</span>    <span class="cm">/* instruction address */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>  <span class="cm">/* internal registers */</span>
	    <span class="p">}</span> <span class="n">fmt9</span><span class="p">;</span>
	    <span class="k">struct</span> <span class="p">{</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int1</span><span class="p">;</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ssw</span><span class="p">;</span>      <span class="cm">/* special status word */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">isc</span><span class="p">;</span>      <span class="cm">/* instruction stage c */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">isb</span><span class="p">;</span>      <span class="cm">/* instruction stage b */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">daddr</span><span class="p">;</span>    <span class="cm">/* data cycle fault address */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">dobuf</span><span class="p">;</span>    <span class="cm">/* data cycle output buffer */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	    <span class="p">}</span> <span class="n">fmta</span><span class="p">;</span>
	    <span class="k">struct</span> <span class="p">{</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int1</span><span class="p">;</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ssw</span><span class="p">;</span>     <span class="cm">/* special status word */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">isc</span><span class="p">;</span>     <span class="cm">/* instruction stage c */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">isb</span><span class="p">;</span>     <span class="cm">/* instruction stage b */</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">daddr</span><span class="p">;</span>   <span class="cm">/* data cycle fault address */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">dobuf</span><span class="p">;</span>   <span class="cm">/* data cycle output buffer */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int3</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">baddr</span><span class="p">;</span>   <span class="cm">/* stage B address */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int4</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		    <span class="kt">unsigned</span> <span class="kt">long</span>  <span class="n">dibuf</span><span class="p">;</span>   <span class="cm">/* data cycle input buffer */</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int5</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
		    <span class="kt">unsigned</span>	   <span class="n">ver</span> <span class="o">:</span> <span class="mi">4</span><span class="p">;</span> <span class="cm">/* stack frame version # */</span>
		    <span class="kt">unsigned</span>	   <span class="n">int6</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">int7</span><span class="p">[</span><span class="mi">18</span><span class="p">];</span>
	    <span class="p">}</span> <span class="n">fmtb</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">un</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _M68K_TRAPS_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
