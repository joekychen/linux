<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › m68k › include › asm › atarihw.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>atarihw.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">** linux/atarihw.h -- This header defines some macros and pointers for</span>
<span class="cm">**                    the various Atari custom hardware registers.</span>
<span class="cm">**</span>
<span class="cm">** Copyright 1994 by Björn Brauel</span>
<span class="cm">**</span>
<span class="cm">** 5/1/94 Roman Hodek:</span>
<span class="cm">**   Added definitions for TT specific chips.</span>
<span class="cm">**</span>
<span class="cm">** 1996-09-13 lars brinkhoff &lt;f93labr@dd.chalmers.se&gt;:</span>
<span class="cm">**   Finally added definitions for the matrix/codec and the DSP56001 host</span>
<span class="cm">**   interface.</span>
<span class="cm">**</span>
<span class="cm">** This file is subject to the terms and conditions of the GNU General Public</span>
<span class="cm">** License.  See the file COPYING in the main directory of this archive</span>
<span class="cm">** for more details.</span>
<span class="cm">**</span>
<span class="cm">*/</span>

<span class="cp">#ifndef _LINUX_ATARIHW_H_</span>
<span class="cp">#define _LINUX_ATARIHW_H_</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;asm/bootinfo.h&gt;</span>
<span class="cp">#include &lt;asm/raw_io.h&gt;</span>

<span class="k">extern</span> <span class="n">u_long</span> <span class="n">atari_mch_cookie</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">u_long</span> <span class="n">atari_mch_type</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">u_long</span> <span class="n">atari_switches</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">atari_rtc_year_offset</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">atari_dont_touch_floppy_select</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">atari_SCC_reset_done</span><span class="p">;</span>

<span class="cm">/* convenience macros for testing machine type */</span>
<span class="cp">#define MACH_IS_ST	((atari_mch_cookie &gt;&gt; 16) == ATARI_MCH_ST)</span>
<span class="cp">#define MACH_IS_STE	((atari_mch_cookie &gt;&gt; 16) == ATARI_MCH_STE &amp;&amp; \</span>
<span class="cp">			 (atari_mch_cookie &amp; 0xffff) == 0)</span>
<span class="cp">#define MACH_IS_MSTE	((atari_mch_cookie &gt;&gt; 16) == ATARI_MCH_STE &amp;&amp; \</span>
<span class="cp">			 (atari_mch_cookie &amp; 0xffff) == 0x10)</span>
<span class="cp">#define MACH_IS_TT	((atari_mch_cookie &gt;&gt; 16) == ATARI_MCH_TT)</span>
<span class="cp">#define MACH_IS_FALCON	((atari_mch_cookie &gt;&gt; 16) == ATARI_MCH_FALCON)</span>
<span class="cp">#define MACH_IS_MEDUSA	(atari_mch_type == ATARI_MACH_MEDUSA)</span>
<span class="cp">#define MACH_IS_AB40	(atari_mch_type == ATARI_MACH_AB40)</span>

<span class="cm">/* values for atari_switches */</span>
<span class="cp">#define ATARI_SWITCH_IKBD	0x01</span>
<span class="cp">#define ATARI_SWITCH_MIDI	0x02</span>
<span class="cp">#define ATARI_SWITCH_SND6	0x04</span>
<span class="cp">#define ATARI_SWITCH_SND7	0x08</span>
<span class="cp">#define ATARI_SWITCH_OVSC_SHIFT	16</span>
<span class="cp">#define ATARI_SWITCH_OVSC_IKBD	(ATARI_SWITCH_IKBD &lt;&lt; ATARI_SWITCH_OVSC_SHIFT)</span>
<span class="cp">#define ATARI_SWITCH_OVSC_MIDI	(ATARI_SWITCH_MIDI &lt;&lt; ATARI_SWITCH_OVSC_SHIFT)</span>
<span class="cp">#define ATARI_SWITCH_OVSC_SND6	(ATARI_SWITCH_SND6 &lt;&lt; ATARI_SWITCH_OVSC_SHIFT)</span>
<span class="cp">#define ATARI_SWITCH_OVSC_SND7	(ATARI_SWITCH_SND7 &lt;&lt; ATARI_SWITCH_OVSC_SHIFT)</span>
<span class="cp">#define ATARI_SWITCH_OVSC_MASK	0xffff0000</span>

<span class="cm">/*</span>
<span class="cm"> * Define several Hardware-Chips for indication so that for the ATARI we do</span>
<span class="cm"> * no longer decide whether it is a Falcon or other machine . It&#39;s just</span>
<span class="cm"> * important what hardware the machine uses</span>
<span class="cm"> */</span>

<span class="cm">/* ++roman 08/08/95: rewritten from ORing constants to a C bitfield */</span>

<span class="cp">#define ATARIHW_DECLARE(name)	unsigned name : 1</span>
<span class="cp">#define ATARIHW_SET(name)	(atari_hw_present.name = 1)</span>
<span class="cp">#define ATARIHW_PRESENT(name)	(atari_hw_present.name)</span>

<span class="k">struct</span> <span class="n">atari_hw_present</span> <span class="p">{</span>
    <span class="cm">/* video hardware */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">STND_SHIFTER</span><span class="p">);</span>	<span class="cm">/* ST-Shifter - no base low ! */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">EXTD_SHIFTER</span><span class="p">);</span>	<span class="cm">/* STe-Shifter - 24 bit address */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">TT_SHIFTER</span><span class="p">);</span>	<span class="cm">/* TT-Shifter */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">VIDEL_SHIFTER</span><span class="p">);</span>	<span class="cm">/* Falcon-Shifter */</span>
    <span class="cm">/* sound hardware */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">YM_2149</span><span class="p">);</span>		<span class="cm">/* Yamaha YM 2149 */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">PCM_8BIT</span><span class="p">);</span>		<span class="cm">/* PCM-Sound in STe-ATARI */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">CODEC</span><span class="p">);</span>		<span class="cm">/* CODEC Sound (Falcon) */</span>
    <span class="cm">/* disk storage interfaces */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">TT_SCSI</span><span class="p">);</span>		<span class="cm">/* Directly mapped NCR5380 */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">ST_SCSI</span><span class="p">);</span>		<span class="cm">/* NCR5380 via ST-DMA (Falcon) */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">ACSI</span><span class="p">);</span>		<span class="cm">/* Standard ACSI like in STs */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">IDE</span><span class="p">);</span>		<span class="cm">/* IDE Interface */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">FDCSPEED</span><span class="p">);</span>		<span class="cm">/* 8/16 MHz switch for FDC */</span>
    <span class="cm">/* other I/O hardware */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">ST_MFP</span><span class="p">);</span>		<span class="cm">/* The ST-MFP (there should be no Atari</span>
<span class="cm">					   without it... but who knows?) */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">TT_MFP</span><span class="p">);</span>		<span class="cm">/* 2nd MFP */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">SCC</span><span class="p">);</span>		<span class="cm">/* Serial Communications Contr. */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">ST_ESCC</span><span class="p">);</span>		<span class="cm">/* SCC Z83230 in an ST */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">ANALOG_JOY</span><span class="p">);</span>	<span class="cm">/* Paddle Interface for STe</span>
<span class="cm">					   and Falcon */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">MICROWIRE</span><span class="p">);</span>		<span class="cm">/* Microwire Interface */</span>
    <span class="cm">/* DMA */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">STND_DMA</span><span class="p">);</span>		<span class="cm">/* 24 Bit limited ST-DMA */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">EXTD_DMA</span><span class="p">);</span>		<span class="cm">/* 32 Bit ST-DMA */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">SCSI_DMA</span><span class="p">);</span>		<span class="cm">/* DMA for the NCR5380 */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">SCC_DMA</span><span class="p">);</span>		<span class="cm">/* DMA for the SCC */</span>
    <span class="cm">/* real time clocks */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">TT_CLK</span><span class="p">);</span>		<span class="cm">/* TT compatible clock chip */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">MSTE_CLK</span><span class="p">);</span>		<span class="cm">/* Mega ST(E) clock chip */</span>
    <span class="cm">/* supporting hardware */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">SCU</span><span class="p">);</span>		<span class="cm">/* System Control Unit */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">BLITTER</span><span class="p">);</span>		<span class="cm">/* Blitter */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">VME</span><span class="p">);</span>		<span class="cm">/* VME Bus */</span>
    <span class="n">ATARIHW_DECLARE</span><span class="p">(</span><span class="n">DSP56K</span><span class="p">);</span>		<span class="cm">/* DSP56k processor in Falcon */</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">atari_hw_present</span> <span class="n">atari_hw_present</span><span class="p">;</span>


<span class="cm">/* Reading the MFP port register gives a machine independent delay, since the</span>
<span class="cm"> * MFP always has a 8 MHz clock. This avoids problems with the varying length</span>
<span class="cm"> * of nops on various machines. Somebody claimed that the tstb takes 600 ns.</span>
<span class="cm"> */</span>
<span class="cp">#define	MFPDELAY() \</span>
<span class="cp">	__asm__ __volatile__ ( &quot;tstb %0&quot; : : &quot;m&quot; (st_mfp.par_dt_reg) : &quot;cc&quot; );</span>

<span class="cm">/* Do cache push/invalidate for DMA read/write. This function obeys the</span>
<span class="cm"> * snooping on some machines (Medusa) and processors: The Medusa itself can</span>
<span class="cm"> * snoop, but only the &#39;040 can source data from its cache to DMA writes i.e.,</span>
<span class="cm"> * reads from memory). Both &#39;040 and &#39;060 invalidate cache entries on snooped</span>
<span class="cm"> * DMA reads (i.e., writes to memory).</span>
<span class="cm"> */</span>


<span class="cp">#define atari_readb   raw_inb</span>
<span class="cp">#define atari_writeb  raw_outb</span>

<span class="cp">#define atari_inb_p   raw_inb</span>
<span class="cp">#define atari_outb_p  raw_outb</span>



<span class="cp">#include &lt;linux/mm.h&gt;</span>
<span class="cp">#include &lt;asm/cacheflush.h&gt;</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">dma_cache_maintenance</span><span class="p">(</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">paddr</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">len</span><span class="p">,</span>
					  <span class="kt">int</span> <span class="n">writeflag</span> <span class="p">)</span>

<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">writeflag</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">MACH_IS_MEDUSA</span> <span class="o">||</span> <span class="n">CPU_IS_060</span><span class="p">)</span>
			<span class="n">cache_push</span><span class="p">(</span> <span class="n">paddr</span><span class="p">,</span> <span class="n">len</span> <span class="p">);</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">MACH_IS_MEDUSA</span><span class="p">)</span>
			<span class="n">cache_clear</span><span class="p">(</span> <span class="n">paddr</span><span class="p">,</span> <span class="n">len</span> <span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm">** Shifter</span>
<span class="cm"> */</span>
<span class="cp">#define ST_LOW  0</span>
<span class="cp">#define ST_MID  1</span>
<span class="cp">#define ST_HIGH 2</span>
<span class="cp">#define TT_LOW  7</span>
<span class="cp">#define TT_MID  4</span>
<span class="cp">#define TT_HIGH 6</span>

<span class="cp">#define SHF_BAS (0xffff8200)</span>
<span class="k">struct</span> <span class="n">SHIFTER</span>
 <span class="p">{</span>
	<span class="n">u_char</span> <span class="n">pad1</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">bas_hi</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">pad2</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">bas_md</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">pad3</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="k">volatile</span> <span class="n">vcounthi</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">pad4</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="k">volatile</span> <span class="n">vcountmid</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">pad5</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="k">volatile</span> <span class="n">vcountlow</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="k">volatile</span> <span class="n">syncmode</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">pad6</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">pad7</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">bas_lo</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp"># define shifter ((*(volatile struct SHIFTER *)SHF_BAS))</span>

<span class="cp">#define SHF_FBAS (0xffff820e)</span>
<span class="k">struct</span> <span class="n">SHIFTER_F030</span>
 <span class="p">{</span>
  <span class="n">u_short</span> <span class="n">off_next</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">scn_width</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp"># define shifter_f030 ((*(volatile struct SHIFTER_F030 *)SHF_FBAS))</span>


<span class="cp">#define	SHF_TBAS (0xffff8200)</span>
<span class="k">struct</span> <span class="n">SHIFTER_TT</span> <span class="p">{</span>
	<span class="n">u_char</span>	<span class="n">char_dummy0</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">bas_hi</span><span class="p">;</span>			<span class="cm">/* video mem base addr, high and mid byte */</span>
	<span class="n">u_char</span>	<span class="n">char_dummy1</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">bas_md</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy2</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">vcount_hi</span><span class="p">;</span>		<span class="cm">/* pointer to currently displayed byte */</span>
	<span class="n">u_char</span>	<span class="n">char_dummy3</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">vcount_md</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy4</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">vcount_lo</span><span class="p">;</span>
	<span class="n">u_short</span>	<span class="n">st_sync</span><span class="p">;</span>		<span class="cm">/* ST compatible sync mode register, unused */</span>
	<span class="n">u_char</span>	<span class="n">char_dummy5</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">bas_lo</span><span class="p">;</span>			<span class="cm">/* video mem addr, low byte */</span>
	<span class="n">u_char</span>	<span class="n">char_dummy6</span><span class="p">[</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">16</span><span class="p">];</span>
	<span class="cm">/* $ffff8240: */</span>
	<span class="n">u_short</span>	<span class="n">color_reg</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* 16 color registers */</span>
	<span class="n">u_char</span>	<span class="n">st_shiftmode</span><span class="p">;</span>	<span class="cm">/* ST compatible shift mode register, unused */</span>
	<span class="n">u_char</span>  <span class="n">char_dummy7</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">tt_shiftmode</span><span class="p">;</span>	<span class="cm">/* TT shift mode register */</span>


<span class="p">};</span>
<span class="cp">#define	shifter_tt	((*(volatile struct SHIFTER_TT *)SHF_TBAS))</span>

<span class="cm">/* values for shifter_tt-&gt;tt_shiftmode */</span>
<span class="cp">#define	TT_SHIFTER_STLOW		0x0000</span>
<span class="cp">#define	TT_SHIFTER_STMID		0x0100</span>
<span class="cp">#define	TT_SHIFTER_STHIGH		0x0200</span>
<span class="cp">#define	TT_SHIFTER_TTLOW		0x0700</span>
<span class="cp">#define	TT_SHIFTER_TTMID		0x0400</span>
<span class="cp">#define	TT_SHIFTER_TTHIGH		0x0600</span>
<span class="cp">#define	TT_SHIFTER_MODEMASK	0x0700</span>
<span class="cp">#define TT_SHIFTER_NUMMODE	0x0008</span>
<span class="cp">#define	TT_SHIFTER_PALETTE_MASK	0x000f</span>
<span class="cp">#define	TT_SHIFTER_GRAYMODE		0x1000</span>

<span class="cm">/* 256 TT palette registers */</span>
<span class="cp">#define	TT_PALETTE_BASE	(0xffff8400)</span>
<span class="cp">#define	tt_palette	((volatile u_short *)TT_PALETTE_BASE)</span>

<span class="cp">#define	TT_PALETTE_RED_MASK		0x0f00</span>
<span class="cp">#define	TT_PALETTE_GREEN_MASK	0x00f0</span>
<span class="cp">#define	TT_PALETTE_BLUE_MASK	0x000f</span>

<span class="cm">/*</span>
<span class="cm">** Falcon030 VIDEL Video Controller</span>
<span class="cm">** for description see File &#39;linux\tools\atari\hardware.txt</span>
<span class="cm"> */</span>
<span class="cp">#define f030_col ((u_long *)		0xffff9800)</span>
<span class="cp">#define f030_xreg ((u_short*)		0xffff8282)</span>
<span class="cp">#define f030_yreg ((u_short*)		0xffff82a2)</span>
<span class="cp">#define f030_creg ((u_short*)		0xffff82c0)</span>
<span class="cp">#define f030_sreg ((u_short*)		0xffff8260)</span>
<span class="cp">#define f030_mreg ((u_short*)		0xffff820a)</span>
<span class="cp">#define f030_linewidth ((u_short*)      0xffff820e)</span>
<span class="cp">#define f030_hscroll ((u_char*)		0xffff8265)</span>

<span class="cp">#define VIDEL_BAS (0xffff8260)</span>
<span class="k">struct</span> <span class="n">VIDEL</span> <span class="p">{</span>
	<span class="n">u_short</span> <span class="n">st_shift</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">pad1</span><span class="p">;</span>
	<span class="n">u_char</span>  <span class="n">xoffset_s</span><span class="p">;</span>
	<span class="n">u_char</span>  <span class="n">xoffset</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">f_shift</span><span class="p">;</span>
	<span class="n">u_char</span>  <span class="n">pad2</span><span class="p">[</span><span class="mh">0x1a</span><span class="p">];</span>
	<span class="n">u_short</span> <span class="n">hht</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">hbb</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">hbe</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">hdb</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">hde</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">hss</span><span class="p">;</span>
	<span class="n">u_char</span>  <span class="n">pad3</span><span class="p">[</span><span class="mh">0x14</span><span class="p">];</span>
	<span class="n">u_short</span> <span class="n">vft</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">vbb</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">vbe</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">vdb</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">vde</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">vss</span><span class="p">;</span>
	<span class="n">u_char</span>  <span class="n">pad4</span><span class="p">[</span><span class="mh">0x12</span><span class="p">];</span>
	<span class="n">u_short</span> <span class="n">control</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">mode</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define	videl	((*(volatile struct VIDEL *)VIDEL_BAS))</span>

<span class="cm">/*</span>
<span class="cm">** DMA/WD1772 Disk Controller</span>
<span class="cm"> */</span>

<span class="cp">#define FWD_BAS (0xffff8604)</span>
<span class="k">struct</span> <span class="n">DMA_WD</span>
 <span class="p">{</span>
  <span class="n">u_short</span> <span class="n">fdc_acces_seccount</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">dma_mode_status</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">dma_vhi</span><span class="p">;</span>	<span class="cm">/* Some extended ST-DMAs can handle 32 bit addresses */</span>
  <span class="n">u_char</span> <span class="n">dma_hi</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy2</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">dma_md</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy3</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">dma_lo</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">fdc_speed</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp"># define dma_wd ((*(volatile struct DMA_WD *)FWD_BAS))</span>
<span class="cm">/* alias */</span>
<span class="cp">#define	st_dma dma_wd</span>
<span class="cm">/* The two highest bytes of an extended DMA as a short; this is a must</span>
<span class="cm"> * for the Medusa.</span>
<span class="cm"> */</span>
<span class="cp">#define st_dma_ext_dmahi (*((volatile unsigned short *)0xffff8608))</span>

<span class="cm">/*</span>
<span class="cm">** YM2149 Sound Chip</span>
<span class="cm">** access in bytes</span>
<span class="cm"> */</span>

<span class="cp">#define YM_BAS (0xffff8800)</span>
<span class="k">struct</span> <span class="n">SOUND_YM</span>
 <span class="p">{</span>
  <span class="n">u_char</span> <span class="n">rd_data_reg_sel</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy1</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">wd_data</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp">#define sound_ym ((*(volatile struct SOUND_YM *)YM_BAS))</span>

<span class="cm">/* TT SCSI DMA */</span>

<span class="cp">#define	TT_SCSI_DMA_BAS	(0xffff8700)</span>
<span class="k">struct</span> <span class="n">TT_DMA</span> <span class="p">{</span>
	<span class="n">u_char</span>	<span class="n">char_dummy0</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_addr_hi</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy1</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_addr_hmd</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy2</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_addr_lmd</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy3</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_addr_lo</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy4</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_cnt_hi</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy5</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_cnt_hmd</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy6</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_cnt_lmd</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy7</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dma_cnt_lo</span><span class="p">;</span>
	<span class="n">u_long</span>	<span class="n">dma_restdata</span><span class="p">;</span>
	<span class="n">u_short</span>	<span class="n">dma_ctrl</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define	tt_scsi_dma	((*(volatile struct TT_DMA *)TT_SCSI_DMA_BAS))</span>

<span class="cm">/* TT SCSI Controller 5380 */</span>

<span class="cp">#define	TT_5380_BAS	(0xffff8781)</span>
<span class="k">struct</span> <span class="n">TT_5380</span> <span class="p">{</span>
	<span class="n">u_char</span>	<span class="n">scsi_data</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy1</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">scsi_icr</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy2</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">scsi_mode</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy3</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">scsi_tcr</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy4</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">scsi_idstat</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy5</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">scsi_dmastat</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy6</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">scsi_targrcv</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy7</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">scsi_inircv</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define	tt_scsi			((*(volatile struct TT_5380 *)TT_5380_BAS))</span>
<span class="cp">#define	tt_scsi_regp	((volatile char *)TT_5380_BAS)</span>


<span class="cm">/*</span>
<span class="cm">** Falcon DMA Sound Subsystem</span>
<span class="cm"> */</span>

<span class="cp">#define MATRIX_BASE (0xffff8930)</span>
<span class="k">struct</span> <span class="n">MATRIX</span>
<span class="p">{</span>
  <span class="n">u_short</span> <span class="n">source</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">destination</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">external_frequency_divider</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">internal_frequency_divider</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define falcon_matrix (*(volatile struct MATRIX *)MATRIX_BASE)</span>

<span class="cp">#define CODEC_BASE (0xffff8936)</span>
<span class="k">struct</span> <span class="n">CODEC</span>
<span class="p">{</span>
  <span class="n">u_char</span> <span class="n">tracks</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">input_source</span><span class="p">;</span>
<span class="cp">#define CODEC_SOURCE_ADC        1</span>
<span class="cp">#define CODEC_SOURCE_MATRIX     2</span>
  <span class="n">u_char</span> <span class="n">adc_source</span><span class="p">;</span>
<span class="cp">#define ADC_SOURCE_RIGHT_PSG    1</span>
<span class="cp">#define ADC_SOURCE_LEFT_PSG     2</span>
  <span class="n">u_char</span> <span class="n">gain</span><span class="p">;</span>
<span class="cp">#define CODEC_GAIN_RIGHT        0x0f</span>
<span class="cp">#define CODEC_GAIN_LEFT         0xf0</span>
  <span class="n">u_char</span> <span class="n">attenuation</span><span class="p">;</span>
<span class="cp">#define CODEC_ATTENUATION_RIGHT 0x0f</span>
<span class="cp">#define CODEC_ATTENUATION_LEFT  0xf0</span>
  <span class="n">u_char</span> <span class="n">unused1</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">status</span><span class="p">;</span>
<span class="cp">#define CODEC_OVERFLOW_RIGHT    1</span>
<span class="cp">#define CODEC_OVERFLOW_LEFT     2</span>
  <span class="n">u_char</span> <span class="n">unused2</span><span class="p">,</span> <span class="n">unused3</span><span class="p">,</span> <span class="n">unused4</span><span class="p">,</span> <span class="n">unused5</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">gpio_directions</span><span class="p">;</span>
<span class="cp">#define CODEC_GPIO_IN           0</span>
<span class="cp">#define CODEC_GPIO_OUT          1</span>
  <span class="n">u_char</span> <span class="n">unused6</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">gpio_data</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define falcon_codec (*(volatile struct CODEC *)CODEC_BASE)</span>

<span class="cm">/*</span>
<span class="cm">** Falcon Blitter</span>
<span class="cm">*/</span>

<span class="cp">#define BLT_BAS (0xffff8a00)</span>

<span class="k">struct</span> <span class="n">BLITTER</span>
 <span class="p">{</span>
  <span class="n">u_short</span> <span class="n">halftone</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
  <span class="n">u_short</span> <span class="n">src_x_inc</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">src_y_inc</span><span class="p">;</span>
  <span class="n">u_long</span> <span class="n">src_address</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">endmask1</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">endmask2</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">endmask3</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">dst_x_inc</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">dst_y_inc</span><span class="p">;</span>
  <span class="n">u_long</span> <span class="n">dst_address</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">wd_per_line</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">ln_per_bb</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">hlf_op_reg</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">log_op_reg</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">lin_nm_reg</span><span class="p">;</span>
  <span class="n">u_short</span> <span class="n">skew_reg</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp"># define blitter ((*(volatile struct BLITTER *)BLT_BAS))</span>


<span class="cm">/*</span>
<span class="cm">** SCC Z8530</span>
<span class="cm"> */</span>

<span class="cp">#define SCC_BAS (0xffff8c81)</span>
<span class="k">struct</span> <span class="n">SCC</span>
 <span class="p">{</span>
  <span class="n">u_char</span> <span class="n">cha_a_ctrl</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy1</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">cha_a_data</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy2</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">cha_b_ctrl</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy3</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">cha_b_data</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp"># define atari_scc ((*(volatile struct SCC*)SCC_BAS))</span>

<span class="cm">/* The ESCC (Z85230) in an Atari ST. The channels are reversed! */</span>
<span class="cp"># define st_escc ((*(volatile struct SCC*)0xfffffa31))</span>
<span class="cp"># define st_escc_dsr ((*(volatile char *)0xfffffa39))</span>

<span class="cm">/* TT SCC DMA Controller (same chip as SCSI DMA) */</span>

<span class="cp">#define	TT_SCC_DMA_BAS	(0xffff8c00)</span>
<span class="cp">#define	tt_scc_dma	((*(volatile struct TT_DMA *)TT_SCC_DMA_BAS))</span>

<span class="cm">/*</span>
<span class="cm">** VIDEL Palette Register</span>
<span class="cm"> */</span>

<span class="cp">#define FPL_BAS (0xffff9800)</span>
<span class="k">struct</span> <span class="n">VIDEL_PALETTE</span>
 <span class="p">{</span>
  <span class="n">u_long</span> <span class="n">reg</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
 <span class="p">};</span>
<span class="cp"># define videl_palette ((*(volatile struct VIDEL_PALETTE*)FPL_BAS))</span>


<span class="cm">/*</span>
<span class="cm">** Falcon DSP Host Interface</span>
<span class="cm"> */</span>

<span class="cp">#define DSP56K_HOST_INTERFACE_BASE (0xffffa200)</span>
<span class="k">struct</span> <span class="n">DSP56K_HOST_INTERFACE</span> <span class="p">{</span>
  <span class="n">u_char</span> <span class="n">icr</span><span class="p">;</span>
<span class="cp">#define DSP56K_ICR_RREQ	0x01</span>
<span class="cp">#define DSP56K_ICR_TREQ	0x02</span>
<span class="cp">#define DSP56K_ICR_HF0	0x08</span>
<span class="cp">#define DSP56K_ICR_HF1	0x10</span>
<span class="cp">#define DSP56K_ICR_HM0	0x20</span>
<span class="cp">#define DSP56K_ICR_HM1	0x40</span>
<span class="cp">#define DSP56K_ICR_INIT	0x80</span>

  <span class="n">u_char</span> <span class="n">cvr</span><span class="p">;</span>
<span class="cp">#define DSP56K_CVR_HV_MASK 0x1f</span>
<span class="cp">#define DSP56K_CVR_HC	0x80</span>

  <span class="n">u_char</span> <span class="n">isr</span><span class="p">;</span>
<span class="cp">#define DSP56K_ISR_RXDF	0x01</span>
<span class="cp">#define DSP56K_ISR_TXDE	0x02</span>
<span class="cp">#define DSP56K_ISR_TRDY	0x04</span>
<span class="cp">#define DSP56K_ISR_HF2	0x08</span>
<span class="cp">#define DSP56K_ISR_HF3	0x10</span>
<span class="cp">#define DSP56K_ISR_DMA	0x40</span>
<span class="cp">#define DSP56K_ISR_HREQ	0x80</span>

  <span class="n">u_char</span> <span class="n">ivr</span><span class="p">;</span>

  <span class="k">union</span> <span class="p">{</span>
    <span class="n">u_char</span> <span class="n">b</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="n">u_short</span> <span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
    <span class="n">u_long</span> <span class="n">l</span><span class="p">;</span>
  <span class="p">}</span> <span class="n">data</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define dsp56k_host_interface ((*(volatile struct DSP56K_HOST_INTERFACE *)DSP56K_HOST_INTERFACE_BASE))</span>

<span class="cm">/*</span>
<span class="cm">** MFP 68901</span>
<span class="cm"> */</span>

<span class="cp">#define MFP_BAS (0xfffffa01)</span>
<span class="k">struct</span> <span class="n">MFP</span>
 <span class="p">{</span>
  <span class="n">u_char</span> <span class="n">par_dt_reg</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy1</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">active_edge</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy2</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">data_dir</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy3</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_en_a</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy4</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_en_b</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy5</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_pn_a</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy6</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_pn_b</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy7</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_sv_a</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy8</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_sv_b</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy9</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_mk_a</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy10</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">int_mk_b</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy11</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">vec_adr</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy12</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">tim_ct_a</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy13</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">tim_ct_b</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy14</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">tim_ct_cd</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy15</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">tim_dt_a</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy16</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">tim_dt_b</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy17</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">tim_dt_c</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy18</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">tim_dt_d</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy19</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">sync_char</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy20</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">usart_ctr</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy21</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">rcv_stat</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy22</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">trn_stat</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy23</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">usart_dta</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp"># define st_mfp ((*(volatile struct MFP*)MFP_BAS))</span>

<span class="cm">/* TT&#39;s second MFP */</span>

<span class="cp">#define	TT_MFP_BAS	(0xfffffa81)</span>
<span class="cp"># define tt_mfp ((*(volatile struct MFP*)TT_MFP_BAS))</span>


<span class="cm">/* TT System Control Unit */</span>

<span class="cp">#define	TT_SCU_BAS	(0xffff8e01)</span>
<span class="k">struct</span> <span class="n">TT_SCU</span> <span class="p">{</span>
	<span class="n">u_char</span>	<span class="n">sys_mask</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy1</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">sys_stat</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy2</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">softint</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy3</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">vmeint</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy4</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">gp_reg1</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy5</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">gp_reg2</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy6</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">vme_mask</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">char_dummy7</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">vme_stat</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define	tt_scu	((*(volatile struct TT_SCU *)TT_SCU_BAS))</span>

<span class="cm">/* TT real time clock */</span>

<span class="cp">#define	TT_RTC_BAS	(0xffff8961)</span>
<span class="k">struct</span> <span class="n">TT_RTC</span> <span class="p">{</span>
	<span class="n">u_char</span>	<span class="n">regsel</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dummy</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">data</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define	tt_rtc	((*(volatile struct TT_RTC *)TT_RTC_BAS))</span>


<span class="cm">/*</span>
<span class="cm">** ACIA 6850</span>
<span class="cm"> */</span>
<span class="cm">/* constants for the ACIA registers */</span>

<span class="cm">/* baudrate selection and reset (Baudrate = clock/factor) */</span>
<span class="cp">#define ACIA_DIV1  0</span>
<span class="cp">#define ACIA_DIV16 1</span>
<span class="cp">#define ACIA_DIV64 2</span>
<span class="cp">#define ACIA_RESET 3</span>

<span class="cm">/* character format */</span>
<span class="cp">#define ACIA_D7E2S (0&lt;&lt;2)	</span><span class="cm">/* 7 data, even parity, 2 stop */</span><span class="cp"></span>
<span class="cp">#define ACIA_D7O2S (1&lt;&lt;2)	</span><span class="cm">/* 7 data, odd parity, 2 stop */</span><span class="cp"></span>
<span class="cp">#define ACIA_D7E1S (2&lt;&lt;2)	</span><span class="cm">/* 7 data, even parity, 1 stop */</span><span class="cp"></span>
<span class="cp">#define ACIA_D7O1S (3&lt;&lt;2)	</span><span class="cm">/* 7 data, odd parity, 1 stop */</span><span class="cp"></span>
<span class="cp">#define ACIA_D8N2S (4&lt;&lt;2)	</span><span class="cm">/* 8 data, no parity, 2 stop */</span><span class="cp"></span>
<span class="cp">#define ACIA_D8N1S (5&lt;&lt;2)	</span><span class="cm">/* 8 data, no parity, 1 stop */</span><span class="cp"></span>
<span class="cp">#define ACIA_D8E1S (6&lt;&lt;2)	</span><span class="cm">/* 8 data, even parity, 1 stop */</span><span class="cp"></span>
<span class="cp">#define ACIA_D8O1S (7&lt;&lt;2)	</span><span class="cm">/* 8 data, odd parity, 1 stop */</span><span class="cp"></span>

<span class="cm">/* transmit control */</span>
<span class="cp">#define ACIA_RLTID (0&lt;&lt;5)	</span><span class="cm">/* RTS low, TxINT disabled */</span><span class="cp"></span>
<span class="cp">#define ACIA_RLTIE (1&lt;&lt;5)	</span><span class="cm">/* RTS low, TxINT enabled */</span><span class="cp"></span>
<span class="cp">#define ACIA_RHTID (2&lt;&lt;5)	</span><span class="cm">/* RTS high, TxINT disabled */</span><span class="cp"></span>
<span class="cp">#define ACIA_RLTIDSB (3&lt;&lt;5)	</span><span class="cm">/* RTS low, TxINT disabled, send break */</span><span class="cp"></span>

<span class="cm">/* receive control */</span>
<span class="cp">#define ACIA_RID (0&lt;&lt;7)		</span><span class="cm">/* RxINT disabled */</span><span class="cp"></span>
<span class="cp">#define ACIA_RIE (1&lt;&lt;7)		</span><span class="cm">/* RxINT enabled */</span><span class="cp"></span>

<span class="cm">/* status fields of the ACIA */</span>
<span class="cp">#define ACIA_RDRF 1		</span><span class="cm">/* Receive Data Register Full */</span><span class="cp"></span>
<span class="cp">#define ACIA_TDRE (1&lt;&lt;1)	</span><span class="cm">/* Transmit Data Register Empty */</span><span class="cp"></span>
<span class="cp">#define ACIA_DCD  (1&lt;&lt;2)	</span><span class="cm">/* Data Carrier Detect */</span><span class="cp"></span>
<span class="cp">#define ACIA_CTS  (1&lt;&lt;3)	</span><span class="cm">/* Clear To Send */</span><span class="cp"></span>
<span class="cp">#define ACIA_FE   (1&lt;&lt;4)	</span><span class="cm">/* Framing Error */</span><span class="cp"></span>
<span class="cp">#define ACIA_OVRN (1&lt;&lt;5)	</span><span class="cm">/* Receiver Overrun */</span><span class="cp"></span>
<span class="cp">#define ACIA_PE   (1&lt;&lt;6)	</span><span class="cm">/* Parity Error */</span><span class="cp"></span>
<span class="cp">#define ACIA_IRQ  (1&lt;&lt;7)	</span><span class="cm">/* Interrupt Request */</span><span class="cp"></span>

<span class="cp">#define ACIA_BAS (0xfffffc00)</span>
<span class="k">struct</span> <span class="n">ACIA</span>
 <span class="p">{</span>
  <span class="n">u_char</span> <span class="n">key_ctrl</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy1</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">key_data</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy2</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">mid_ctrl</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">char_dummy3</span><span class="p">;</span>
  <span class="n">u_char</span> <span class="n">mid_data</span><span class="p">;</span>
 <span class="p">};</span>
<span class="cp"># define acia ((*(volatile struct ACIA*)ACIA_BAS))</span>

<span class="cp">#define	TT_DMASND_BAS (0xffff8900)</span>
<span class="k">struct</span> <span class="n">TT_DMASND</span> <span class="p">{</span>
	<span class="n">u_char</span>	<span class="n">int_ctrl</span><span class="p">;</span>	<span class="cm">/* Falcon: Interrupt control */</span>
	<span class="n">u_char</span>	<span class="n">ctrl</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad2</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">bas_hi</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad3</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">bas_mid</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad4</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">bas_low</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad5</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">addr_hi</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad6</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">addr_mid</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad7</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">addr_low</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad8</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">end_hi</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad9</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">end_mid</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad10</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">end_low</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad11</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>
	<span class="n">u_char</span>	<span class="n">track_select</span><span class="p">;</span>	<span class="cm">/* Falcon */</span>
	<span class="n">u_char</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">pad12</span><span class="p">[</span><span class="mi">14</span><span class="p">];</span>
	<span class="cm">/* Falcon only: */</span>
	<span class="n">u_short</span>	<span class="n">cbar_src</span><span class="p">;</span>
	<span class="n">u_short</span> <span class="n">cbar_dst</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">ext_div</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">int_div</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">rec_track_select</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">dac_src</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">adc_src</span><span class="p">;</span>
	<span class="n">u_char</span>	<span class="n">input_gain</span><span class="p">;</span>
	<span class="n">u_short</span>	<span class="n">output_atten</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp"># define tt_dmasnd ((*(volatile struct TT_DMASND *)TT_DMASND_BAS))</span>

<span class="cp">#define DMASND_MFP_INT_REPLAY     0x01</span>
<span class="cp">#define DMASND_MFP_INT_RECORD     0x02</span>
<span class="cp">#define DMASND_TIMERA_INT_REPLAY  0x04</span>
<span class="cp">#define DMASND_TIMERA_INT_RECORD  0x08</span>

<span class="cp">#define	DMASND_CTRL_OFF		  0x00</span>
<span class="cp">#define	DMASND_CTRL_ON		  0x01</span>
<span class="cp">#define	DMASND_CTRL_REPEAT	  0x02</span>
<span class="cp">#define DMASND_CTRL_RECORD_ON     0x10</span>
<span class="cp">#define DMASND_CTRL_RECORD_OFF    0x00</span>
<span class="cp">#define DMASND_CTRL_RECORD_REPEAT 0x20</span>
<span class="cp">#define DMASND_CTRL_SELECT_REPLAY 0x00</span>
<span class="cp">#define DMASND_CTRL_SELECT_RECORD 0x80</span>
<span class="cp">#define	DMASND_MODE_MONO	  0x80</span>
<span class="cp">#define	DMASND_MODE_STEREO	  0x00</span>
<span class="cp">#define DMASND_MODE_8BIT	  0x00</span>
<span class="cp">#define DMASND_MODE_16BIT	  0x40	</span><span class="cm">/* Falcon only */</span><span class="cp"></span>
<span class="cp">#define	DMASND_MODE_6KHZ	  0x00	</span><span class="cm">/* Falcon: mute */</span><span class="cp"></span>
<span class="cp">#define	DMASND_MODE_12KHZ	  0x01</span>
<span class="cp">#define	DMASND_MODE_25KHZ	  0x02</span>
<span class="cp">#define	DMASND_MODE_50KHZ	  0x03</span>


<span class="cp">#define DMASNDSetBase(bufstart)						\</span>
<span class="cp">    do {								\</span>
<span class="cp">	tt_dmasnd.bas_hi  = (unsigned char)(((bufstart) &amp; 0xff0000) &gt;&gt; 16); \</span>
<span class="cp">	tt_dmasnd.bas_mid = (unsigned char)(((bufstart) &amp; 0x00ff00) &gt;&gt; 8); \</span>
<span class="cp">	tt_dmasnd.bas_low = (unsigned char) ((bufstart) &amp; 0x0000ff); \</span>
<span class="cp">    } while( 0 )</span>

<span class="cp">#define DMASNDGetAdr() ((tt_dmasnd.addr_hi &lt;&lt; 16) +	\</span>
<span class="cp">			(tt_dmasnd.addr_mid &lt;&lt; 8) +	\</span>
<span class="cp">			(tt_dmasnd.addr_low))</span>

<span class="cp">#define DMASNDSetEnd(bufend)				\</span>
<span class="cp">    do {						\</span>
<span class="cp">	tt_dmasnd.end_hi  = (unsigned char)(((bufend) &amp; 0xff0000) &gt;&gt; 16); \</span>
<span class="cp">	tt_dmasnd.end_mid = (unsigned char)(((bufend) &amp; 0x00ff00) &gt;&gt; 8); \</span>
<span class="cp">	tt_dmasnd.end_low = (unsigned char) ((bufend) &amp; 0x0000ff); \</span>
<span class="cp">    } while( 0 )</span>


<span class="cp">#define	TT_MICROWIRE_BAS	(0xffff8922)</span>
<span class="k">struct</span> <span class="n">TT_MICROWIRE</span> <span class="p">{</span>
	<span class="n">u_short</span>	<span class="n">data</span><span class="p">;</span>
	<span class="n">u_short</span>	<span class="n">mask</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp"># define tt_microwire ((*(volatile struct TT_MICROWIRE *)TT_MICROWIRE_BAS))</span>

<span class="cp">#define	MW_LM1992_ADDR		0x0400</span>

<span class="cp">#define	MW_LM1992_VOLUME(dB)	\</span>
<span class="cp">    (0x0c0 | ((dB) &lt; -80 ? 0 : (dB) &gt; 0 ? 40 : (((dB) + 80) / 2)))</span>
<span class="cp">#define	MW_LM1992_BALLEFT(dB)	\</span>
<span class="cp">    (0x140 | ((dB) &lt; -40 ? 0 : (dB) &gt; 0 ? 20 : (((dB) + 40) / 2)))</span>
<span class="cp">#define	MW_LM1992_BALRIGHT(dB)	\</span>
<span class="cp">    (0x100 | ((dB) &lt; -40 ? 0 : (dB) &gt; 0 ? 20 : (((dB) + 40) / 2)))</span>
<span class="cp">#define	MW_LM1992_TREBLE(dB)	\</span>
<span class="cp">    (0x080 | ((dB) &lt; -12 ? 0 : (dB) &gt; 12 ? 12 : (((dB) / 2) + 6)))</span>
<span class="cp">#define	MW_LM1992_BASS(dB)	\</span>
<span class="cp">    (0x040 | ((dB) &lt; -12 ? 0 : (dB) &gt; 12 ? 12 : (((dB) / 2) + 6)))</span>

<span class="cp">#define	MW_LM1992_PSG_LOW	0x000</span>
<span class="cp">#define	MW_LM1992_PSG_HIGH	0x001</span>
<span class="cp">#define	MW_LM1992_PSG_OFF	0x002</span>

<span class="cp">#define MSTE_RTC_BAS	(0xfffffc21)</span>

<span class="k">struct</span> <span class="n">MSTE_RTC</span> <span class="p">{</span>
	<span class="n">u_char</span> <span class="n">sec_ones</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy1</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">sec_tens</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy2</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">min_ones</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy3</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">min_tens</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy4</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">hr_ones</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy5</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">hr_tens</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy6</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">weekday</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy7</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">day_ones</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy8</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">day_tens</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy9</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">mon_ones</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy10</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">mon_tens</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy11</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">year_ones</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy12</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">year_tens</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy13</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">mode</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy14</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">test</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">dummy15</span><span class="p">;</span>
	<span class="n">u_char</span> <span class="n">reset</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define mste_rtc ((*(volatile struct MSTE_RTC *)MSTE_RTC_BAS))</span>

<span class="cp">#endif </span><span class="cm">/* linux/atarihw.h */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
