<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › m68k › include › asm › m68360_regs.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>m68360_regs.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/***********************************</span>
<span class="cm"> * $Id: m68360_regs.h,v 1.2 2002/10/26 15:03:55 gerg Exp $</span>
<span class="cm"> ***********************************</span>
<span class="cm"> *</span>
<span class="cm"> ***************************************</span>
<span class="cm"> * Definitions of the QUICC registers</span>
<span class="cm"> ***************************************</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __REGISTERS_H</span>
<span class="cp">#define __REGISTERS_H</span>

<span class="cp">#define CLEAR_BIT(x, bit)  x =bit </span>

<span class="cm">/*****************************************************************</span>
<span class="cm">        Command Register</span>
<span class="cm">*****************************************************************/</span>

<span class="cm">/* bit fields within command register */</span>
<span class="cp">#define SOFTWARE_RESET  0x8000</span>
<span class="cp">#define CMD_OPCODE      0x0f00</span>
<span class="cp">#define CMD_CHANNEL     0x00f0</span>
<span class="cp">#define CMD_FLAG        0x0001</span>

<span class="cm">/* general command opcodes */</span>
<span class="cp">#define INIT_RXTX_PARAMS        0x0000</span>
<span class="cp">#define INIT_RX_PARAMS          0x0100</span>
<span class="cp">#define INIT_TX_PARAMS          0x0200</span>
<span class="cp">#define ENTER_HUNT_MODE         0x0300</span>
<span class="cp">#define STOP_TX                 0x0400</span>
<span class="cp">#define GR_STOP_TX              0x0500</span>
<span class="cp">#define RESTART_TX              0x0600</span>
<span class="cp">#define CLOSE_RX_BD             0x0700</span>
<span class="cp">#define SET_ENET_GROUP          0x0800</span>
<span class="cp">#define RESET_ENET_GROUP        0x0900</span>

<span class="cm">/* quicc32 CP commands */</span>
<span class="cp">#define STOP_TX_32		0x0e00	</span><span class="cm">/*add chan# bits 2-6 */</span><span class="cp"></span>
<span class="cp">#define ENTER_HUNT_MODE_32	0x1e00</span>

<span class="cm">/* quicc32 mask/event SCC register */</span>
<span class="cp">#define GOV	0x01</span>
<span class="cp">#define GUN	0x02</span>
<span class="cp">#define GINT	0x04</span>
<span class="cp">#define IQOV	0x08</span>


<span class="cm">/* Timer commands */</span>
<span class="cp">#define SET_TIMER               0x0800</span>

<span class="cm">/* Multi channel Interrupt structure */</span>
<span class="cp">#define INTR_VALID	0x8000	</span><span class="cm">/* Valid interrupt entry */</span><span class="cp"></span>
<span class="cp">#define INTR_WRAP	0x4000	</span><span class="cm">/* Wrap bit in the interrupt entry table */</span><span class="cp"></span>
<span class="cp">#define INTR_CH_NU	0x07c0	</span><span class="cm">/* Channel Num in interrupt table */</span><span class="cp"></span>
<span class="cp">#define INTR_MASK_BITS	0x383f</span>

<span class="cm">/*</span>
<span class="cm"> * General SCC mode register (GSMR)</span>
<span class="cm"> */</span>

<span class="cp">#define MODE_HDLC               0x0</span>
<span class="cp">#define MODE_APPLE_TALK         0x2</span>
<span class="cp">#define MODE_SS7                0x3</span>
<span class="cp">#define MODE_UART               0x4</span>
<span class="cp">#define MODE_PROFIBUS           0x5</span>
<span class="cp">#define MODE_ASYNC_HDLC         0x6</span>
<span class="cp">#define MODE_V14                0x7</span>
<span class="cp">#define MODE_BISYNC             0x8</span>
<span class="cp">#define MODE_DDCMP              0x9</span>
<span class="cp">#define MODE_MULTI_CHANNEL      0xa</span>
<span class="cp">#define MODE_ETHERNET           0xc</span>

<span class="cp">#define DIAG_NORMAL             0x0</span>
<span class="cp">#define DIAG_LOCAL_LPB          0x1</span>
<span class="cp">#define DIAG_AUTO_ECHO          0x2</span>
<span class="cp">#define DIAG_LBP_ECHO           0x3</span>

<span class="cm">/* For RENC and TENC fields in GSMR */</span>
<span class="cp">#define ENC_NRZ                 0x0</span>
<span class="cp">#define ENC_NRZI                0x1</span>
<span class="cp">#define ENC_FM0                 0x2</span>
<span class="cp">#define ENC_MANCH               0x4</span>
<span class="cp">#define ENC_DIFF_MANC           0x6</span>

<span class="cm">/* For TDCR and RDCR fields in GSMR */</span>
<span class="cp">#define CLOCK_RATE_1            0x0</span>
<span class="cp">#define CLOCK_RATE_8            0x1</span>
<span class="cp">#define CLOCK_RATE_16           0x2</span>
<span class="cp">#define CLOCK_RATE_32           0x3</span>

<span class="cp">#define TPP_00                  0x0</span>
<span class="cp">#define TPP_10                  0x1</span>
<span class="cp">#define TPP_01                  0x2</span>
<span class="cp">#define TPP_11                  0x3</span>

<span class="cp">#define TPL_NO                  0x0</span>
<span class="cp">#define TPL_8                   0x1</span>
<span class="cp">#define TPL_16                  0x2</span>
<span class="cp">#define TPL_32                  0x3</span>
<span class="cp">#define TPL_48                  0x4</span>
<span class="cp">#define TPL_64                  0x5</span>
<span class="cp">#define TPL_128                 0x6</span>

<span class="cp">#define TSNC_INFINITE           0x0</span>
<span class="cp">#define TSNC_14_65              0x1</span>
<span class="cp">#define TSNC_4_15               0x2</span>
<span class="cp">#define TSNC_3_1                0x3</span>

<span class="cp">#define EDGE_BOTH               0x0</span>
<span class="cp">#define EDGE_POS                0x1</span>
<span class="cp">#define EDGE_NEG                0x2</span>
<span class="cp">#define EDGE_NO                 0x3</span>

<span class="cp">#define SYNL_NO                 0x0</span>
<span class="cp">#define SYNL_4                  0x1</span>
<span class="cp">#define SYNL_8                  0x2</span>
<span class="cp">#define SYNL_16                 0x3</span>

<span class="cp">#define TCRC_CCITT16            0x0</span>
<span class="cp">#define TCRC_CRC16              0x1</span>
<span class="cp">#define TCRC_CCITT32            0x2</span>


<span class="cm">/*****************************************************************</span>
<span class="cm">        TODR (Transmit on demand) Register</span>
<span class="cm">*****************************************************************/</span>
<span class="cp">#define TODR_TOD        0x8000  </span><span class="cm">/* Transmit on demand */</span><span class="cp"></span>


<span class="cm">/*****************************************************************</span>
<span class="cm">        CICR register settings</span>
<span class="cm">*****************************************************************/</span>

<span class="cm">/* note that relative irq priorities of the SCCs can be reordered</span>
<span class="cm"> * if desired - see p. 7-377 of the MC68360UM */</span>
<span class="cp">#define CICR_SCA_SCC1           ((uint)0x00000000)      </span><span class="cm">/* SCC1 @ SCCa */</span><span class="cp"></span>
<span class="cp">#define CICR_SCB_SCC2           ((uint)0x00040000)      </span><span class="cm">/* SCC2 @ SCCb */</span><span class="cp"></span>
<span class="cp">#define CICR_SCC_SCC3           ((uint)0x00200000)      </span><span class="cm">/* SCC3 @ SCCc */</span><span class="cp"></span>
<span class="cp">#define CICR_SCD_SCC4           ((uint)0x00c00000)      </span><span class="cm">/* SCC4 @ SCCd */</span><span class="cp"></span>

<span class="cp">#define CICR_IRL_MASK           ((uint)0x0000e000)      </span><span class="cm">/* Core interrupt */</span><span class="cp"></span>
<span class="cp">#define CICR_HP_MASK            ((uint)0x00001f00)      </span><span class="cm">/* Hi-pri int. */</span><span class="cp"></span>
<span class="cp">#define CICR_VBA_MASK           ((uint)0x000000e0)      </span><span class="cm">/* Vector Base Address */</span><span class="cp"></span>
<span class="cp">#define CICR_SPS                ((uint)0x00000001)      </span><span class="cm">/* SCC Spread */</span><span class="cp"></span>


<span class="cm">/*****************************************************************</span>
<span class="cm">       Interrupt bits for CIPR and CIMR (MC68360UM p. 7-379)</span>
<span class="cm">*****************************************************************/</span>

<span class="cp">#define INTR_PIO_PC0    0x80000000      </span><span class="cm">/* parallel I/O C bit 0 */</span><span class="cp"></span>
<span class="cp">#define INTR_SCC1       0x40000000      </span><span class="cm">/* SCC port 1 */</span><span class="cp"></span>
<span class="cp">#define INTR_SCC2       0x20000000      </span><span class="cm">/* SCC port 2 */</span><span class="cp"></span>
<span class="cp">#define INTR_SCC3       0x10000000      </span><span class="cm">/* SCC port 3 */</span><span class="cp"></span>
<span class="cp">#define INTR_SCC4       0x08000000      </span><span class="cm">/* SCC port 4 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC1    0x04000000      </span><span class="cm">/* parallel i/o C bit 1 */</span><span class="cp"></span>
<span class="cp">#define INTR_TIMER1     0x02000000      </span><span class="cm">/* timer 1 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC2    0x01000000      </span><span class="cm">/* parallel i/o C bit 2 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC3    0x00800000      </span><span class="cm">/* parallel i/o C bit 3 */</span><span class="cp"></span>
<span class="cp">#define INTR_SDMA_BERR  0x00400000      </span><span class="cm">/* SDMA channel bus error */</span><span class="cp"></span>
<span class="cp">#define INTR_DMA1       0x00200000      </span><span class="cm">/* idma 1 */</span><span class="cp"></span>
<span class="cp">#define INTR_DMA2       0x00100000      </span><span class="cm">/* idma 2 */</span><span class="cp"></span>
<span class="cp">#define INTR_TIMER2     0x00040000      </span><span class="cm">/* timer 2 */</span><span class="cp"></span>
<span class="cp">#define INTR_CP_TIMER   0x00020000      </span><span class="cm">/* CP timer */</span><span class="cp"></span>
<span class="cp">#define INTR_PIP_STATUS 0x00010000      </span><span class="cm">/* PIP status */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC4    0x00008000      </span><span class="cm">/* parallel i/o C bit 4 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC5    0x00004000      </span><span class="cm">/* parallel i/o C bit 5 */</span><span class="cp"></span>
<span class="cp">#define INTR_TIMER3     0x00001000      </span><span class="cm">/* timer 3 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC6    0x00000800      </span><span class="cm">/* parallel i/o C bit 6 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC7    0x00000400      </span><span class="cm">/* parallel i/o C bit 7 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC8    0x00000200      </span><span class="cm">/* parallel i/o C bit 8 */</span><span class="cp"></span>
<span class="cp">#define INTR_TIMER4     0x00000080      </span><span class="cm">/* timer 4 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC9    0x00000040      </span><span class="cm">/* parallel i/o C bit 9 */</span><span class="cp"></span>
<span class="cp">#define INTR_SCP        0x00000020      </span><span class="cm">/* SCP */</span><span class="cp"></span>
<span class="cp">#define INTR_SMC1       0x00000010      </span><span class="cm">/* SMC 1 */</span><span class="cp"></span>
<span class="cp">#define INTR_SMC2       0x00000008      </span><span class="cm">/* SMC 2 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC10   0x00000004      </span><span class="cm">/* parallel i/o C bit 10 */</span><span class="cp"></span>
<span class="cp">#define INTR_PIO_PC11   0x00000002      </span><span class="cm">/* parallel i/o C bit 11 */</span><span class="cp"></span>
<span class="cp">#define INTR_ERR        0x00000001      </span><span class="cm">/* error */</span><span class="cp"></span>


<span class="cm">/*****************************************************************</span>
<span class="cm">        CPM Interrupt vector encodings (MC68360UM p. 7-376)</span>
<span class="cm">*****************************************************************/</span>

<span class="cp">#define CPMVEC_NR		32</span>
<span class="cp">#define CPMVEC_PIO_PC0		0x1f</span>
<span class="cp">#define CPMVEC_SCC1		0x1e</span>
<span class="cp">#define CPMVEC_SCC2		0x1d</span>
<span class="cp">#define CPMVEC_SCC3		0x1c</span>
<span class="cp">#define CPMVEC_SCC4		0x1b</span>
<span class="cp">#define CPMVEC_PIO_PC1		0x1a</span>
<span class="cp">#define CPMVEC_TIMER1		0x19</span>
<span class="cp">#define CPMVEC_PIO_PC2		0x18</span>
<span class="cp">#define CPMVEC_PIO_PC3		0x17</span>
<span class="cp">#define CPMVEC_SDMA_CB_ERR	0x16</span>
<span class="cp">#define CPMVEC_IDMA1		0x15</span>
<span class="cp">#define CPMVEC_IDMA2		0x14</span>
<span class="cp">#define CPMVEC_RESERVED3	0x13</span>
<span class="cp">#define CPMVEC_TIMER2		0x12</span>
<span class="cp">#define CPMVEC_RISCTIMER	0x11</span>
<span class="cp">#define CPMVEC_RESERVED2	0x10</span>
<span class="cp">#define CPMVEC_PIO_PC4		0x0f</span>
<span class="cp">#define CPMVEC_PIO_PC5		0x0e</span>
<span class="cp">#define CPMVEC_TIMER3		0x0c</span>
<span class="cp">#define CPMVEC_PIO_PC6		0x0b</span>
<span class="cp">#define CPMVEC_PIO_PC7		0x0a</span>
<span class="cp">#define CPMVEC_PIO_PC8		0x09</span>
<span class="cp">#define CPMVEC_RESERVED1	0x08</span>
<span class="cp">#define CPMVEC_TIMER4		0x07</span>
<span class="cp">#define CPMVEC_PIO_PC9		0x06</span>
<span class="cp">#define CPMVEC_SPI		0x05</span>
<span class="cp">#define CPMVEC_SMC1		0x04</span>
<span class="cp">#define CPMVEC_SMC2		0x03</span>
<span class="cp">#define CPMVEC_PIO_PC10		0x02</span>
<span class="cp">#define CPMVEC_PIO_PC11		0x01</span>
<span class="cp">#define CPMVEC_ERROR		0x00</span>

<span class="cm">/* #define CPMVEC_PIO_PC0		((ushort)0x1f) */</span>
<span class="cm">/* #define CPMVEC_SCC1		((ushort)0x1e) */</span>
<span class="cm">/* #define CPMVEC_SCC2		((ushort)0x1d) */</span>
<span class="cm">/* #define CPMVEC_SCC3		((ushort)0x1c) */</span>
<span class="cm">/* #define CPMVEC_SCC4		((ushort)0x1b) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC1		((ushort)0x1a) */</span>
<span class="cm">/* #define CPMVEC_TIMER1		((ushort)0x19) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC2		((ushort)0x18) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC3		((ushort)0x17) */</span>
<span class="cm">/* #define CPMVEC_SDMA_CB_ERR	((ushort)0x16) */</span>
<span class="cm">/* #define CPMVEC_IDMA1		((ushort)0x15) */</span>
<span class="cm">/* #define CPMVEC_IDMA2		((ushort)0x14) */</span>
<span class="cm">/* #define CPMVEC_RESERVED3	((ushort)0x13) */</span>
<span class="cm">/* #define CPMVEC_TIMER2		((ushort)0x12) */</span>
<span class="cm">/* #define CPMVEC_RISCTIMER	((ushort)0x11) */</span>
<span class="cm">/* #define CPMVEC_RESERVED2	((ushort)0x10) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC4		((ushort)0x0f) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC5		((ushort)0x0e) */</span>
<span class="cm">/* #define CPMVEC_TIMER3		((ushort)0x0c) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC6		((ushort)0x0b) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC7		((ushort)0x0a) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC8		((ushort)0x09) */</span>
<span class="cm">/* #define CPMVEC_RESERVED1	((ushort)0x08) */</span>
<span class="cm">/* #define CPMVEC_TIMER4		((ushort)0x07) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC9		((ushort)0x06) */</span>
<span class="cm">/* #define CPMVEC_SPI		((ushort)0x05) */</span>
<span class="cm">/* #define CPMVEC_SMC1		((ushort)0x04) */</span>
<span class="cm">/* #define CPMVEC_SMC2		((ushort)0x03) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC10		((ushort)0x02) */</span>
<span class="cm">/* #define CPMVEC_PIO_PC11		((ushort)0x01) */</span>
<span class="cm">/* #define CPMVEC_ERROR		((ushort)0x00) */</span>


<span class="cm">/*****************************************************************</span>
<span class="cm"> *        PIO control registers</span>
<span class="cm"> *****************************************************************/</span>

<span class="cm">/* Port A - See 360UM p. 7-358</span>
<span class="cm"> * </span>
<span class="cm"> *  Note that most of these pins have alternate functions</span>
<span class="cm"> */</span>


<span class="cm">/* The macros are nice, but there are all sorts of references to 1-indexed</span>
<span class="cm"> * facilities on the 68360... */</span>
<span class="cm">/* #define PA_RXD(n)	((ushort)(0x01&lt;&lt;(2*n))) */</span>
<span class="cm">/* #define PA_TXD(n)	((ushort)(0x02&lt;&lt;(2*n))) */</span>

<span class="cp">#define PA_RXD1		((ushort)0x0001)</span>
<span class="cp">#define PA_TXD1		((ushort)0x0002)</span>
<span class="cp">#define PA_RXD2		((ushort)0x0004)</span>
<span class="cp">#define PA_TXD2		((ushort)0x0008)</span>
<span class="cp">#define PA_RXD3		((ushort)0x0010)</span>
<span class="cp">#define PA_TXD3		((ushort)0x0020)</span>
<span class="cp">#define PA_RXD4		((ushort)0x0040)</span>
<span class="cp">#define PA_TXD4		((ushort)0x0080)</span>

<span class="cp">#define PA_CLK1		((ushort)0x0100)</span>
<span class="cp">#define PA_CLK2		((ushort)0x0200)</span>
<span class="cp">#define PA_CLK3		((ushort)0x0400)</span>
<span class="cp">#define PA_CLK4		((ushort)0x0800)</span>
<span class="cp">#define PA_CLK5		((ushort)0x1000)</span>
<span class="cp">#define PA_CLK6		((ushort)0x2000)</span>
<span class="cp">#define PA_CLK7		((ushort)0x4000)</span>
<span class="cp">#define PA_CLK8		((ushort)0x8000)</span>


<span class="cm">/* Port B - See 360UM p. 7-362</span>
<span class="cm"> */</span>


<span class="cm">/* Port C - See 360UM p. 7-365</span>
<span class="cm"> */</span>

<span class="cp">#define PC_RTS1		((ushort)0x0001)</span>
<span class="cp">#define PC_RTS2		((ushort)0x0002)</span>
<span class="cp">#define PC__RTS3	((ushort)0x0004) </span><span class="cm">/* !RTS3 */</span><span class="cp"></span>
<span class="cp">#define PC__RTS4	((ushort)0x0008) </span><span class="cm">/* !RTS4 */</span><span class="cp"></span>

<span class="cp">#define PC_CTS1		((ushort)0x0010)</span>
<span class="cp">#define PC_CD1		((ushort)0x0020)</span>
<span class="cp">#define PC_CTS2		((ushort)0x0040)</span>
<span class="cp">#define PC_CD2		((ushort)0x0080)</span>
<span class="cp">#define PC_CTS3		((ushort)0x0100)</span>
<span class="cp">#define PC_CD3		((ushort)0x0200)</span>
<span class="cp">#define PC_CTS4		((ushort)0x0400)</span>
<span class="cp">#define PC_CD4		((ushort)0x0800)</span>



<span class="cm">/*****************************************************************</span>
<span class="cm">        chip select option register</span>
<span class="cm">*****************************************************************/</span>
<span class="cp">#define DTACK           0xe000</span>
<span class="cp">#define ADR_MASK        0x1ffc</span>
<span class="cp">#define RDWR_MASK       0x0002</span>
<span class="cp">#define FC_MASK         0x0001</span>

<span class="cm">/*****************************************************************</span>
<span class="cm">        tbase and rbase registers</span>
<span class="cm">*****************************************************************/</span>
<span class="cp">#define TBD_ADDR(quicc,pram) ((struct quicc_bd *) \</span>
<span class="cp">    (quicc-&gt;ch_or_u.u.udata_bd_ucode + pram-&gt;tbase))</span>
<span class="cp">#define RBD_ADDR(quicc,pram) ((struct quicc_bd *) \</span>
<span class="cp">    (quicc-&gt;ch_or_u.u.udata_bd_ucode + pram-&gt;rbase))</span>
<span class="cp">#define TBD_CUR_ADDR(quicc,pram) ((struct quicc_bd *) \</span>
<span class="cp">    (quicc-&gt;ch_or_u.u.udata_bd_ucode + pram-&gt;tbptr))</span>
<span class="cp">#define RBD_CUR_ADDR(quicc,pram) ((struct quicc_bd *) \</span>
<span class="cp">    (quicc-&gt;ch_or_u.u.udata_bd_ucode + pram-&gt;rbptr))</span>
<span class="cp">#define TBD_SET_CUR_ADDR(bd,quicc,pram) pram-&gt;tbptr = \</span>
<span class="cp">    ((unsigned short)((char *)(bd) - (char *)(quicc-&gt;ch_or_u.u.udata_bd_ucode)))</span>
<span class="cp">#define RBD_SET_CUR_ADDR(bd,quicc,pram) pram-&gt;rbptr = \</span>
<span class="cp">    ((unsigned short)((char *)(bd) - (char *)(quicc-&gt;ch_or_u.u.udata_bd_ucode)))</span>
<span class="cp">#define INCREASE_TBD(bd,quicc,pram) {  \</span>
<span class="cp">    if((bd)-&gt;status &amp; T_W)             \</span>
<span class="cp">        (bd) = TBD_ADDR(quicc,pram);   \</span>
<span class="cp">    else                               \</span>
<span class="cp">        (bd)++;                        \</span>
<span class="cp">}</span>
<span class="cp">#define DECREASE_TBD(bd,quicc,pram) {  \</span>
<span class="cp">    if ((bd) == TBD_ADDR(quicc, pram)) \</span>
<span class="cp">        while (!((bd)-&gt;status &amp; T_W))  \</span>
<span class="cp">            (bd)++;                    \</span>
<span class="cp">    else                               \</span>
<span class="cp">        (bd)--;                        \</span>
<span class="cp">}</span>
<span class="cp">#define INCREASE_RBD(bd,quicc,pram) {  \</span>
<span class="cp">    if((bd)-&gt;status &amp; R_W)             \</span>
<span class="cp">        (bd) = RBD_ADDR(quicc,pram);   \</span>
<span class="cp">    else                               \</span>
<span class="cp">        (bd)++;                        \</span>
<span class="cp">}</span>
<span class="cp">#define DECREASE_RBD(bd,quicc,pram) {  \</span>
<span class="cp">    if ((bd) == RBD_ADDR(quicc, pram)) \</span>
<span class="cp">        while (!((bd)-&gt;status &amp; T_W))  \</span>
<span class="cp">            (bd)++;                    \</span>
<span class="cp">    else                               \</span>
<span class="cp">        (bd)--;                        \</span>
<span class="cp">}</span>

<span class="cm">/*****************************************************************</span>
<span class="cm">        Macros for Multi channel</span>
<span class="cm">*****************************************************************/</span>
<span class="cp">#define QMC_BASE(quicc,page) (struct global_multi_pram *)(&amp;quicc-&gt;pram[page])</span>
<span class="cp">#define MCBASE(quicc,page) (unsigned long)(quicc-&gt;pram[page].m.mcbase)</span>
<span class="cp">#define CHANNEL_PRAM_BASE(quicc,channel) ((struct quicc32_pram *) \</span>
<span class="cp">		(&amp;(quicc-&gt;ch_or_u.ch_pram_tbl[channel])))</span>
<span class="cp">#define TBD_32_ADDR(quicc,page,channel) ((struct quicc_bd *) \</span>
<span class="cp">    (MCBASE(quicc,page) + (CHANNEL_PRAM_BASE(quicc,channel)-&gt;tbase)))</span>
<span class="cp">#define RBD_32_ADDR(quicc,page,channel) ((struct quicc_bd *) \</span>
<span class="cp">    (MCBASE(quicc,page) + (CHANNEL_PRAM_BASE(quicc,channel)-&gt;rbase)))</span>
<span class="cp">#define TBD_32_CUR_ADDR(quicc,page,channel) ((struct quicc_bd *) \</span>
<span class="cp">    (MCBASE(quicc,page) + (CHANNEL_PRAM_BASE(quicc,channel)-&gt;tbptr)))</span>
<span class="cp">#define RBD_32_CUR_ADDR(quicc,page,channel) ((struct quicc_bd *) \</span>
<span class="cp">    (MCBASE(quicc,page) + (CHANNEL_PRAM_BASE(quicc,channel)-&gt;rbptr)))</span>
<span class="cp">#define TBD_32_SET_CUR_ADDR(bd,quicc,page,channel) \</span>
<span class="cp">     CHANNEL_PRAM_BASE(quicc,channel)-&gt;tbptr = \</span>
<span class="cp">    ((unsigned short)((char *)(bd) - (char *)(MCBASE(quicc,page))))</span>
<span class="cp">#define RBD_32_SET_CUR_ADDR(bd,quicc,page,channel) \</span>
<span class="cp">     CHANNEL_PRAM_BASE(quicc,channel)-&gt;rbptr = \</span>
<span class="cp">    ((unsigned short)((char *)(bd) - (char *)(MCBASE(quicc,page))))</span>

<span class="cp">#define INCREASE_TBD_32(bd,quicc,page,channel) {  \</span>
<span class="cp">    if((bd)-&gt;status &amp; T_W)                        \</span>
<span class="cp">        (bd) = TBD_32_ADDR(quicc,page,channel);   \</span>
<span class="cp">    else                                          \</span>
<span class="cp">        (bd)++;                                   \</span>
<span class="cp">}</span>
<span class="cp">#define DECREASE_TBD_32(bd,quicc,page,channel) {  \</span>
<span class="cp">    if ((bd) == TBD_32_ADDR(quicc, page,channel)) \</span>
<span class="cp">        while (!((bd)-&gt;status &amp; T_W))             \</span>
<span class="cp">            (bd)++;                               \</span>
<span class="cp">    else                                          \</span>
<span class="cp">        (bd)--;                                   \</span>
<span class="cp">}</span>
<span class="cp">#define INCREASE_RBD_32(bd,quicc,page,channel) {  \</span>
<span class="cp">    if((bd)-&gt;status &amp; R_W)                        \</span>
<span class="cp">        (bd) = RBD_32_ADDR(quicc,page,channel);   \</span>
<span class="cp">    else                                          \</span>
<span class="cp">        (bd)++;                                   \</span>
<span class="cp">}</span>
<span class="cp">#define DECREASE_RBD_32(bd,quicc,page,channel) {  \</span>
<span class="cp">    if ((bd) == RBD_32_ADDR(quicc, page,channel)) \</span>
<span class="cp">        while (!((bd)-&gt;status &amp; T_W))             \</span>
<span class="cp">            (bd)++;                               \</span>
<span class="cp">    else                                          \</span>
<span class="cp">        (bd)--;                                   \</span>
<span class="cp">}</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
