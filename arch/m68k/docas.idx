d | kernel |  | 29 items |  | Greg Ungerer | gerg@uclinux.org | 1339466309 |  | m68k: make syscall_trace_enter/leave exist for non-MMU classic m68k types  The assembler entry code calls directly to the syscall_trace_enter() and syscall_trace_leave() functions. But currently they are conditionaly compiled out for the non-MMU classic m68k CPU types (so 68328 for example), resulting in a link error:        LD      vmlinux     arch/m68k/platform/68328/built-in.o: In function `do_trace':     (.text+0x1c): undefined reference to `syscall_trace_enter'     arch/m68k/platform/68328/built-in.o: In function `do_trace':     (.text+0x4c): undefined reference to `syscall_trace_leave'  Change the conditional check that includes these functions to be true for the !defined(CONFIG_MMU) case as well.  Signed-off-by: Greg Ungerer <gerg@uclinux.org> Acked-by: Geert Uytterhoeven <geert@linux-m68k.org>
d | amiga |  | 8 items |  | Geert Uytterhoeven | geert@linux-m68k.org | 1335118608 |  | m68k/amiga: Use arch_initcall() for registering platform devices  module_init() maps to device_initcall(), opening the possibility of race conditions between platform_driver_probe() and registering platform devices.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
f | Makefile | g | 5.2K |  | Linus Torvalds | torvalds@linux-foundation.org | 1337652903 |  | Merge branch 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/gerg/m68knommu  Pull m68knommu tree from Greg Ungerer:  "More merge and clean up of MMU and non-MMU common files, namely   signal.c and dma.c.  There is also a simplification of the ColdFire   GPIO setup tables.  Using a couple of simple macros we make the init   tables really small and easy to read, and save a couple of thousand   lines of code.  Also a move of all the ColdFire subarch support files   into the existing coldfire directory.  The sub-directories just ended   up duplicating Makefiles and now only contain really simple pieces of   code.  This saves quite a few lines of code too.    As always a couple of bugs fixes thrown in too.  Oh and a new   defconfig for the ColdFire platforms that support having the MMU   enabled."  * 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/gerg/m68knommu: (39 commits)   m68k: add a defconfig for the M5475EVB ColdFire with MMU board   m68knommu: unaligned.h fix for M68000 core   m68k: merge the MMU and non-MMU versions of the arch dma code   m68knommu: reorganize the no-MMU cache flushing to match m68k   m68knommu: move the 54xx platform code into the common ColdFire code directory   m68knommu: move the 532x platform code into the common ColdFire code directory   m68knommu: move the 5407 platform code into the common ColdFire code directory   m68knommu: move the 5307 platform code into the common ColdFire code directory   m68knommu: move the 528x platform code into the common ColdFire code directory   m68knommu: move the 527x platform code into the common ColdFire code directory   m68knommu: move the 5272 platform code into the common ColdFire code directory   m68knommu: move the 5249 platform code into the common ColdFire code directory   m68knommu: move the 523x platform code into the common ColdFire code directory   m68knommu: move the 520x platform code into the common ColdFire code directory   m68knommu: move the 5206 platform code into the common ColdFire code directory   m68knommu: simplify the ColdFire 5407 GPIO struct setup   m68knommu: simplify the ColdFire 532x GPIO struct setup   m68knommu: simplify the ColdFire 5307 GPIO struct setup   m68knommu: simplify the ColdFire 528x GPIO struct setup   m68knommu: simplify the ColdFire 527x GPIO struct setup   ...
d | tools |  | 1 items |  | Jan Engelhardt | jengelh@gmx.de | 1192828864 |  | Convert files to UTF-8 and some cleanups  * Convert files to UTF-8.    * Also correct some people's names     (one example is Eißfeldt, which was found in a source file.     Given that the author used an ß at all in a source file     indicates that the real name has in fact a 'ß' and not an 'ss',     which is commonly used as a substitute for 'ß' when limited to     7bit.)    * Correct town names (Goettingen -> Göttingen)    * Update Eberhard Mönkeberg's address (http://lkml.org/lkml/2007/1/8/313)  Signed-off-by: Jan Engelhardt <jengelh@gmx.de> Signed-off-by: Adrian Bunk <bunk@kernel.org>
d | include |  | 1 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1339618632 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/geert/linux-m68k  Pull m68k update from Geert Uytterhoeven.  This makes m68k use the generic library functions for the user-space strn[cpy||len] functions.  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/geert/linux-m68k:   m68k: Use generic strncpy_from_user(), strlen_user(), and strnlen_user()
f | Kconfig.debug | g | 1.1K |  | Linus Torvalds | torvalds@linux-foundation.org | 1325903292 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/geert/linux-m68k  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/geert/linux-m68k: (21 commits)   m68k/mac: Make CONFIG_HEARTBEAT unavailable on Mac   m68k/serial: Remove references to obsolete serial config options   m68k/net: Remove obsolete IRQ_FLG_* users   m68k: Don't comment out syscalls used by glibc   m68k/atari: Move declaration of atari_SCC_reset_done to header file   m68k/serial: Remove references to obsolete CONFIG_SERIAL167   m68k/hp300: Export hp300_ledstate   m68k: Initconst section fixes   m68k/mac: cleanup macro case   mac_scsi: fix mac_scsi on some powerbooks   m68k/mac: fix powerbook 150 adb_type   m68k/mac: fix baboon irq disable and shutdown   m68k/mac: oss irq fixes   m68k/mac: fix nubus slot irq disable and shutdown   m68k/mac: enable via_alt_mapping on performa 580   m68k/mac: cleanup forward declarations   m68k/mac: cleanup mac_irq_pending   m68k/mac: cleanup mac_clear_irq   m68k/mac: early console   m68k/mvme16x: Add support for EARLY_PRINTK   ...  Fix up trivial conflict in arch/m68k/Kconfig.debug due to new EARLY_PRINTK config option addition clashing with movement of the BOOTPARAM options.
f | install.sh | s | 1.2K | 43 | Sam Ravnborg | sam@ravnborg.org | 1253441894 |  | kbuild: use INSTALLKERNEL to select customized installkernel script  Replace the use of CROSS_COMPILE to select a customized installkernel script with the possibility to set INSTALLKERNEL to select a custom installkernel script when running make:      make INSTALLKERNEL=arm-installkernel install  With this patch we are now more consistent across different architectures - they did not all support use of CROSS_COMPILE.  The use of CROSS_COMPILE was a hack as this really belongs to gcc/binutils and the installkernel script does not change just because we change toolchain.  The use of CROSS_COMPILE caused troubles with an upcoming patch that saves CROSS_COMPILE when a kernel is built - it would no longer be installable. [Thanks to Peter Z. for this hint]  This patch undos what Ian did in commit:    0f8e2d62fa04441cd12c08ce521e84e5bd3f8a46   ("use ${CROSS_COMPILE}installkernel in arch/*/boot/install.sh")  The patch has been lightly tested on x86 only - but all changes looks obvious.  Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: Mike Frysinger <vapier@gentoo.org> [blackfin] Acked-by: Russell King <linux@arm.linux.org.uk> [arm] Acked-by: Paul Mundt <lethal@linux-sh.org> [sh] Acked-by: "H. Peter Anvin" <hpa@zytor.com> [x86] Cc: Ian Campbell <icampbell@arcom.com> Cc: Tony Luck <tony.luck@intel.com> [ia64] Cc: Fenghua Yu <fenghua.yu@intel.com> [ia64] Cc: Hirokazu Takata <takata@linux-m32r.org> [m32r] Cc: Geert Uytterhoeven <geert@linux-m68k.org> [m68k] Cc: Kyle McMartin <kyle@mcmartin.ca> [parisc] Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> [powerpc] Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> [s390] Cc: Thomas Gleixner <tglx@linutronix.de> [x86] Cc: Ingo Molnar <mingo@redhat.com> [x86] Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
d | fpsp040 |  | 44 items |  | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
d | mm |  | 13 items |  | Kautuk Consul | consul.kautuk@gmail.com | 1335118609 |  | m68k/mm: Port OOM changes to do_page_fault()  Commit d065bd810b6deb67d4897a14bfe21f8eb526ba99 (mm: retry page fault when blocking on disk transfer) and commit 37b23e0525d393d48a7d59f870b3bc061a30ccdb (x86,mm: make pagefault killable)  The above commits introduced changes into the x86 pagefault handler for making the page fault handler retryable as well as killable.  These changes reduce the mmap_sem hold time, which is crucial during OOM killer invocation.  Port these changes to m68k.  Signed-off-by: Kautuk Consul <consul.kautuk@gmail.com> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
d | mac |  | 11 items |  | Geert Uytterhoeven | geert@linux-m68k.org | 1333313871 |  | m68k/mac: Add missing platform check before registering platform devices  On multi-platform kernels, the Mac platform devices should be registered when running on Mac only. Else it may crash later.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Cc: stable@vger.kernel.org
d | emu |  | 5 items |  | Jiri Slaby | jslaby@suse.cz | 1331235478 |  | TTY: remove re-assignments to tty_driver members  All num, magic and owner are set by alloc_tty_driver. No need to re-set them on each allocation site.  pti driver sets something different to what it passes to alloc_tty_driver. It is not a bug, since we don't use the lines parameter in any way. Anyway this is fixed, and now we do the right thing.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Acked-by: Tilman Schmidt <tilman@imap.cc> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
d | ifpsp060 |  | 20 items |  | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
d | mvme16x |  | 3 items |  | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for M68K  Disintegrate asm/system.h for M68K.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Greg Ungerer <gerg@uclinux.org> cc: linux-m68k@lists.linux-m68k.org
d | math-emu |  | 15 items |  | Greg Dietsche | Gregory.Dietsche@cuw.edu | 1312053700 |  | m68k/math-emu: Remove unnecessary code  Remove unnecessary code that matches this coccinelle pattern  	if (...) 		return ret; 	return ret;  Signed-off-by: Greg Dietsche <Gregory.Dietsche@cuw.edu> Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
d | sun3 |  | 10 items |  | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for M68K  Disintegrate asm/system.h for M68K.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Greg Ungerer <gerg@uclinux.org> cc: linux-m68k@lists.linux-m68k.org
f | Kconfig.bus | g | 1.6K |  | Geert Uytterhoeven | geert@linux-m68k.org | 1320788146 |  | m68k: Revive lost DIO bus config option  commit 0e152d80507b75c00aac60f2ffc586360687cd52 ("m68k: reorganize Kconfig options to improve mmu/non-mmu selections") accidentally dropped the DIO bus config option. Re-add it to the "Bus support" section.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
d | atari |  | 9 items |  | Geert Uytterhoeven | geert@linux-m68k.org | 1335118609 |  | m68k/atari: Change VME irq numbers from unsigned long to unsigned int  Device interrupts numbers were changed to unsigned int in 1997, the year IRQ_MACHSPEC was killed as well.  Also kill a related cast while we're at it.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Cc: netdev@vger.kernel.org
d | q40 |  | 4 items |  | Geert Uytterhoeven | geert@linux-m68k.org | 1333313873 |  | m68k/q40: Add missing platform check before registering platform devices  On multi-platform kernels, the Q40/Q60 platform devices should be registered when running on Q40/Q60 only. Else it may crash later.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org>
d | apollo |  | 3 items |  | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for M68K  Disintegrate asm/system.h for M68K.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Greg Ungerer <gerg@uclinux.org> cc: linux-m68k@lists.linux-m68k.org
d | sun3x |  | 6 items |  | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for M68K  Disintegrate asm/system.h for M68K.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Greg Ungerer <gerg@uclinux.org> cc: linux-m68k@lists.linux-m68k.org
f | Kconfig.cpu | g | 11K |  | Linus Torvalds | torvalds@linux-foundation.org | 1337893306 |  | 
d | lib |  | 16 items |  | Geert Uytterhoeven | geert@linux-m68k.org | 1338989488 |  | m68k: Use generic strncpy_from_user(), strlen_user(), and strnlen_user()  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Acked-by: Greg Ungerer <gerg@uclinux.org>
d | mvme147 |  | 2 items |  | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for M68K  Disintegrate asm/system.h for M68K.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Greg Ungerer <gerg@uclinux.org> cc: linux-m68k@lists.linux-m68k.org
f | Kconfig.machine | g | 14K |  | Geert Uytterhoeven | geert@linux-m68k.org | 1325204449 |  | m68k/Kconfig: Separate classic m68k and coldfire early  While you can build multiplatform kernels for machines with classic m68k processors, you cannot mix support for classic m68k and coldfire processors. To avoid such hybrid kernels, introduce CONFIG_M68KCLASSIC as an antipole for CONFIG_COLDFIRE, and make all specific processor support depend on one of them. All classic m68k machine support also needs to depend on this.  The defaults (CONFIG_M68KCLASSIC if MMU, CONFIG_COLDFIRE if !MMU) are chosen such to make most of the existing configs build and work.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | Kconfig | g | 2.0K |  | Geert Uytterhoeven | geert@linux-m68k.org | 1338989488 |  | m68k: Use generic strncpy_from_user(), strlen_user(), and strnlen_user()  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Acked-by: Greg Ungerer <gerg@uclinux.org>
d | platform |  | 6 items |  | Greg Ungerer | gerg@uclinux.org | 1340579840 |  | m68knommu: define a local devm_clk_get() function  Commit f4d40de39a23f0c39cca55ac63e1175c69c3d2f7 ("net fec: do not depend on grouped clocks") breaks compilation of the FEC driver for non iMX platforms in linux-3.5-rc1. For example when compiling for ColdFire I get:        LD      vmlinux     drivers/built-in.o: In function `fec_probe':     fec.c:(.devinit.text+0x1e0): undefined reference to `devm_clk_get'  Define a simple devm_clk_get() function for the m68knommu architecture.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
d | hp300 |  | 7 items |  | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for M68K  Disintegrate asm/system.h for M68K.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Greg Ungerer <gerg@uclinux.org> cc: linux-m68k@lists.linux-m68k.org
d | bvme6000 |  | 3 items |  | David Howells | dhowells@redhat.com | 1332955802 |  | Disintegrate asm/system.h for M68K  Disintegrate asm/system.h for M68K.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Greg Ungerer <gerg@uclinux.org> cc: linux-m68k@lists.linux-m68k.org
d | configs |  | 19 items |  | Greg Ungerer | gerg@uclinux.org | 1337512985 |  | m68k: add a defconfig for the M5475EVB ColdFire with MMU board  Add a default configuration for the newly supported ColdFire CPUs running with MMU enabled. This is based on Freescales own M5475EVB demo board.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | Kconfig.devices | g | 3.6K |  | Geert Uytterhoeven | geert@linux-m68k.org | 1325712230 |  | m68k/mac: Make CONFIG_HEARTBEAT unavailable on Mac  mac_heartbeat() was never really implemented.  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Acked-by: Greg Ungerer <gerg@uclinux.org>
