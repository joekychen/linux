<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › m68k › math-emu › fp_decode.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>fp_decode.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * fp_decode.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright Roman Zippel, 1997.  All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Redistribution and use in source and binary forms, with or without</span>
<span class="cm"> * modification, are permitted provided that the following conditions</span>
<span class="cm"> * are met:</span>
<span class="cm"> * 1. Redistributions of source code must retain the above copyright</span>
<span class="cm"> *    notice, and the entire permission notice in its entirety,</span>
<span class="cm"> *    including the disclaimer of warranties.</span>
<span class="cm"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<span class="cm"> *    notice, this list of conditions and the following disclaimer in the</span>
<span class="cm"> *    documentation and/or other materials provided with the distribution.</span>
<span class="cm"> * 3. The name of the author may not be used to endorse or promote</span>
<span class="cm"> *    products derived from this software without specific prior</span>
<span class="cm"> *    written permission.</span>
<span class="cm"> *</span>
<span class="cm"> * ALTERNATIVELY, this product may be distributed under the terms of</span>
<span class="cm"> * the GNU General Public License, in which case the provisions of the GPL are</span>
<span class="cm"> * required INSTEAD OF the above restrictions.  (This clause is</span>
<span class="cm"> * necessary due to a potential bad interaction between the GPL and</span>
<span class="cm"> * the restrictions contained in a BSD-style copyright.)</span>
<span class="cm"> *</span>
<span class="cm"> * THIS SOFTWARE IS PROVIDED ``AS IS&#39;&#39; AND ANY EXPRESS OR IMPLIED</span>
<span class="cm"> * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span>
<span class="cm"> * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="cm"> * DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,</span>
<span class="cm"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<span class="cm"> * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="cm"> * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)</span>
<span class="cm"> * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,</span>
<span class="cm"> * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="cm"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED</span>
<span class="cm"> * OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _FP_DECODE_H</span>
<span class="cp">#define _FP_DECODE_H</span>

<span class="cm">/* These macros do the dirty work of the instr decoding, several variables</span>
<span class="cm"> * can be defined in the source file to modify the work of these macros,</span>
<span class="cm"> * currently the following variables are used:</span>
<span class="cm"> * ...</span>
<span class="cm"> * The register usage:</span>
<span class="cm"> * d0 - will contain source operand for data direct mode,</span>
<span class="cm"> *	otherwise scratch register</span>
<span class="cm"> * d1 - upper 16bit are reserved for caller</span>
<span class="cm"> *	lower 16bit may contain further arguments,</span>
<span class="cm"> *	is destroyed during decoding</span>
<span class="cm"> * d2 - contains first two instruction words,</span>
<span class="cm"> *	first word will be used for extension word</span>
<span class="cm"> * a0 - will point to source/dest operand for any indirect mode</span>
<span class="cm"> *	otherwise scratch register</span>
<span class="cm"> * a1 - scratch register</span>
<span class="cm"> * a2 - base addr to the task structure</span>
<span class="cm"> *</span>
<span class="cm"> * the current implementation doesn&#39;t check for every disallowed</span>
<span class="cm"> * addressing mode (e.g. pc relative modes as destination), as long</span>
<span class="cm"> * as it only means a new addressing mode, which should not appear</span>
<span class="cm"> * in a program and that doesn&#39;t crash the emulation, I think it&#39;s</span>
<span class="cm"> * not a problem to allow these modes.</span>
<span class="cm"> */</span>

<span class="n">do_fmovem</span><span class="o">=</span><span class="mi">0</span>
<span class="n">do_fmovem_cr</span><span class="o">=</span><span class="mi">0</span>
<span class="n">do_no_pc_mode</span><span class="o">=</span><span class="mi">0</span>
<span class="n">do_fscc</span><span class="o">=</span><span class="mi">0</span>

<span class="o">|</span> <span class="n">first</span> <span class="n">decoding</span> <span class="n">of</span> <span class="n">the</span> <span class="n">instr</span> <span class="n">type</span>
<span class="o">|</span> <span class="n">this</span> <span class="n">separates</span> <span class="n">the</span> <span class="n">conditional</span> <span class="n">instr</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_cond_instr_type</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">8</span><span class="p">,</span><span class="err">#</span><span class="mi">2</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jmp</span>	<span class="p">([</span><span class="mf">0f</span><span class="o">:</span><span class="n">w</span><span class="p">,</span><span class="o">%</span><span class="n">pc</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span>

	<span class="p">.</span><span class="n">align</span>	<span class="mi">4</span>
<span class="mi">0</span><span class="o">:</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;f&lt;op&gt;&quot;</span><span class="p">,</span><span class="s">&quot;fscc/fdbcc&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;fbccw&quot;</span><span class="p">,</span><span class="s">&quot;fbccl&quot;</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">second</span> <span class="n">decoding</span> <span class="n">of</span> <span class="n">the</span> <span class="n">instr</span> <span class="n">type</span>
<span class="o">|</span> <span class="n">this</span> <span class="n">separates</span> <span class="n">most</span> <span class="n">move</span> <span class="n">instr</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_move_instr_type</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">16</span><span class="p">,</span><span class="err">#</span><span class="mi">3</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jmp</span>	<span class="p">([</span><span class="mf">0f</span><span class="o">:</span><span class="n">w</span><span class="p">,</span><span class="o">%</span><span class="n">pc</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span>

	<span class="p">.</span><span class="n">align</span>	<span class="mi">4</span>
<span class="mi">0</span><span class="o">:</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;f&lt;op&gt; fpx,fpx&quot;</span><span class="p">,</span><span class="s">&quot;invalid instr&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;f&lt;op&gt; &lt;ea&gt;,fpx&quot;</span><span class="p">,</span><span class="s">&quot;fmove fpx,&lt;ea&gt;&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;fmovem &lt;ea&gt;,fpcr&quot;</span><span class="p">,</span><span class="s">&quot;fmovem &lt;ea&gt;,fpx&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;fmovem fpcr,&lt;ea&gt;&quot;</span><span class="p">,</span><span class="s">&quot;fmovem fpx,&lt;ea&gt;&quot;</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">extract</span> <span class="n">the</span> <span class="n">source</span> <span class="n">specifier</span><span class="p">,</span> <span class="n">specifies</span>
<span class="o">|</span> <span class="n">either</span> <span class="n">source</span> <span class="n">fp</span> <span class="k">register</span> <span class="n">or</span> <span class="n">data</span> <span class="n">format</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_sourcespec</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">19</span><span class="p">,</span><span class="err">#</span><span class="mi">3</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">decode</span> <span class="n">destination</span> <span class="n">format</span> <span class="k">for</span> <span class="n">fmove</span> <span class="n">reg</span><span class="p">,</span><span class="n">ea</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_dest_format</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">19</span><span class="p">,</span><span class="err">#</span><span class="mi">3</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">decode</span> <span class="n">source</span> <span class="k">register</span> <span class="k">for</span> <span class="n">fmove</span> <span class="n">reg</span><span class="p">,</span><span class="n">ea</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_src_reg</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">22</span><span class="p">,</span><span class="err">#</span><span class="mi">3</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">extract</span> <span class="n">the</span> <span class="n">addressing</span> <span class="n">mode</span>
<span class="o">|</span> <span class="n">it</span> <span class="n">depends</span> <span class="n">on</span> <span class="n">the</span> <span class="n">instr</span> <span class="n">which</span> <span class="n">of</span> <span class="n">the</span> <span class="n">modes</span> <span class="n">is</span> <span class="n">valid</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_addr_mode</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">10</span><span class="p">,</span><span class="err">#</span><span class="mi">3</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jmp</span>	<span class="p">([</span><span class="mf">0f</span><span class="o">:</span><span class="n">w</span><span class="p">,</span><span class="o">%</span><span class="n">pc</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span>

	<span class="p">.</span><span class="n">align</span>	<span class="mi">4</span>
<span class="mi">0</span><span class="o">:</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;data register direct&quot;</span><span class="p">,</span><span class="s">&quot;addr register direct&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;addr register indirect&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;addr register indirect postincrement&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;addr register indirect predecrement&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;addr register + index16&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;extension mode1&quot;</span><span class="p">,</span><span class="s">&quot;extension mode2&quot;</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">extract</span> <span class="n">the</span> <span class="k">register</span> <span class="k">for</span> <span class="n">the</span> <span class="n">addressing</span> <span class="n">mode</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_addr_reg</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">13</span><span class="p">,</span><span class="err">#</span><span class="mi">3</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">decode</span> <span class="n">the</span> <span class="mi">8</span><span class="n">bit</span> <span class="n">diplacement</span> <span class="n">from</span> <span class="n">the</span> <span class="n">brief</span> <span class="n">extension</span> <span class="n">word</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_disp8</span>
	<span class="n">move</span><span class="p">.</span><span class="n">b</span>	<span class="o">%</span><span class="n">d2</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">ext</span><span class="p">.</span><span class="n">w</span>	<span class="o">%</span><span class="n">d0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">decode</span> <span class="n">the</span> <span class="n">index</span> <span class="n">of</span> <span class="n">the</span> <span class="n">brief</span><span class="o">/</span><span class="n">full</span> <span class="n">extension</span> <span class="n">word</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_index</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">17</span><span class="p">,</span><span class="err">#</span><span class="mi">3</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>		<span class="o">|</span> <span class="n">get</span> <span class="n">the</span> <span class="k">register</span> <span class="n">nr</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">15</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>			<span class="o">|</span> <span class="n">test</span> <span class="k">for</span> <span class="n">data</span><span class="o">/</span><span class="n">addr</span> <span class="k">register</span>
	<span class="n">jne</span>	<span class="mi">1</span><span class="err">\@</span><span class="n">f</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;d%d&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jsr</span>	<span class="n">fp_get_data_reg</span>
	<span class="n">jra</span>	<span class="mi">2</span><span class="err">\@</span><span class="n">f</span>
<span class="mi">1</span><span class="err">\@</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;a%d&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jsr</span>	<span class="n">fp_get_addr_reg</span>
	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
<span class="mi">2</span><span class="err">\@</span><span class="o">:</span>
<span class="n">debug</span>	<span class="n">lea</span>	<span class="s">&quot;&#39;l&#39;.w,%a0&quot;</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">11</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>			<span class="o">|</span> <span class="mi">16</span><span class="o">/</span><span class="mi">32</span> <span class="n">bit</span> <span class="n">size</span><span class="o">?</span>
	<span class="n">jne</span>	<span class="mi">3</span><span class="err">\@</span><span class="n">f</span>
<span class="n">debug</span>	<span class="n">lea</span>	<span class="s">&quot;&#39;w&#39;.w,%a0&quot;</span>
	<span class="n">ext</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">d0</span>
<span class="mi">3</span><span class="err">\@</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;:%c&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">move</span><span class="p">.</span><span class="n">w</span>	<span class="o">%</span><span class="n">d2</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>			<span class="o">|</span> <span class="n">scale</span> <span class="n">factor</span>
	<span class="n">rol</span><span class="p">.</span><span class="n">w</span>	<span class="err">#</span><span class="mi">7</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>
	<span class="n">and</span><span class="p">.</span><span class="n">w</span>	<span class="err">#</span><span class="mi">3</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>
<span class="n">debug</span>	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="s">&quot;%d1,-(%sp)&quot;</span>
<span class="n">debug</span>	<span class="n">ext</span><span class="p">.</span><span class="n">l</span>	<span class="s">&quot;%d1&quot;</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;:%d&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>
<span class="n">debug</span>	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="s">&quot;(%sp)+,%d1&quot;</span>
	<span class="n">lsl</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">d1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">decode</span> <span class="n">the</span> <span class="n">base</span> <span class="n">displacement</span> <span class="n">size</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_basedisp</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">26</span><span class="p">,</span><span class="err">#</span><span class="mi">2</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jmp</span>	<span class="p">([</span><span class="mf">0f</span><span class="o">:</span><span class="n">w</span><span class="p">,</span><span class="o">%</span><span class="n">pc</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span>

	<span class="p">.</span><span class="n">align</span>	<span class="mi">4</span>
<span class="mi">0</span><span class="o">:</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;reserved&quot;</span><span class="p">,</span><span class="s">&quot;null displacement&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;word displacement&quot;</span><span class="p">,</span><span class="s">&quot;long displacement&quot;</span>
<span class="p">.</span><span class="n">endm</span>

<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_decode_outerdisp</span>
	<span class="n">bfextu</span>	<span class="o">%</span><span class="n">d2</span><span class="p">{</span><span class="err">#</span><span class="mi">30</span><span class="p">,</span><span class="err">#</span><span class="mi">2</span><span class="p">},</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jmp</span>	<span class="p">([</span><span class="mf">0f</span><span class="o">:</span><span class="n">w</span><span class="p">,</span><span class="o">%</span><span class="n">pc</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span>

	<span class="p">.</span><span class="n">align</span>	<span class="mi">4</span>
<span class="mi">0</span><span class="o">:</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;no memory indirect action/reserved&quot;</span><span class="p">,</span><span class="s">&quot;null outer displacement&quot;</span>
<span class="o">|</span>	<span class="p">.</span><span class="kt">long</span>	<span class="s">&quot;word outer displacement&quot;</span><span class="p">,</span><span class="s">&quot;long outer displacement&quot;</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">get</span> <span class="n">the</span> <span class="n">extension</span> <span class="n">word</span> <span class="n">and</span> <span class="n">test</span> <span class="k">for</span> <span class="n">brief</span> <span class="n">or</span> <span class="n">full</span> <span class="n">extension</span> <span class="n">type</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_get_test_extword</span> <span class="n">label</span>
	<span class="n">fp_get_instr_word</span> <span class="o">%</span><span class="n">d2</span><span class="p">,</span><span class="n">fp_err_ua1</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">8</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>
	<span class="n">jne</span>	<span class="err">\</span><span class="n">label</span>
<span class="p">.</span><span class="n">endm</span>


<span class="o">|</span> <span class="n">test</span> <span class="k">if</span> <span class="o">%</span><span class="n">pc</span> <span class="n">is</span> <span class="n">the</span> <span class="n">base</span> <span class="k">register</span> <span class="k">for</span> <span class="n">the</span> <span class="n">indirect</span> <span class="n">addr</span> <span class="n">mode</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_test_basereg_d16</span>	<span class="n">label</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">20</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>
	<span class="n">jeq</span>	<span class="err">\</span><span class="n">label</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">test</span> <span class="k">if</span> <span class="o">%</span><span class="n">pc</span> <span class="n">is</span> <span class="n">the</span> <span class="n">base</span> <span class="k">register</span> <span class="k">for</span> <span class="n">one</span> <span class="n">of</span> <span class="n">the</span> <span class="n">extended</span> <span class="n">modes</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_test_basereg_ext</span>	<span class="n">label</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">19</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>
	<span class="n">jeq</span>	<span class="err">\</span><span class="n">label</span>
<span class="p">.</span><span class="n">endm</span>

<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_test_suppr_index</span> <span class="n">label</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">6</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>
	<span class="n">jne</span>	<span class="err">\</span><span class="n">label</span>
<span class="p">.</span><span class="n">endm</span>


<span class="o">|</span> <span class="n">addressing</span> <span class="n">mode</span><span class="o">:</span> <span class="n">data</span> <span class="k">register</span> <span class="n">direct</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_data_direct</span>
	<span class="n">fp_decode_addr_reg</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;d%d&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">addressing</span> <span class="n">mode</span><span class="o">:</span> <span class="n">address</span> <span class="k">register</span> <span class="n">indirect</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_addr_indirect</span>
	<span class="n">fp_decode_addr_reg</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;(a%d)&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jsr</span>	<span class="n">fp_get_addr_reg</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">adjust</span> <span class="n">stack</span> <span class="k">for</span> <span class="n">byte</span> <span class="n">moves</span> <span class="n">from</span><span class="o">/</span><span class="n">to</span> <span class="n">stack</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_test_sp_byte_move</span>
	<span class="p">.</span><span class="k">if</span>	<span class="o">!</span><span class="n">do_fmovem</span>
	<span class="p">.</span><span class="k">if</span>	<span class="n">do_fscc</span>
	<span class="n">move</span><span class="p">.</span><span class="n">w</span>	<span class="err">#</span><span class="mi">6</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>
	<span class="p">.</span><span class="n">endif</span>
	<span class="n">cmp</span><span class="p">.</span><span class="n">w</span>	<span class="err">#</span><span class="mi">7</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jne</span>	<span class="mi">1</span><span class="err">\@</span><span class="n">f</span>
	<span class="p">.</span><span class="k">if</span>	<span class="o">!</span><span class="n">do_fscc</span>
	<span class="n">cmp</span><span class="p">.</span><span class="n">w</span>	<span class="err">#</span><span class="mi">6</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>
	<span class="n">jne</span>	<span class="mi">1</span><span class="err">\@</span><span class="n">f</span>
	<span class="p">.</span><span class="n">endif</span>
	<span class="n">move</span><span class="p">.</span><span class="n">w</span>	<span class="err">#</span><span class="mi">4</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>
<span class="mi">1</span><span class="err">\@</span><span class="o">:</span>
	<span class="p">.</span><span class="n">endif</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">addressing</span> <span class="n">mode</span><span class="o">:</span> <span class="n">address</span> <span class="k">register</span> <span class="n">indirect</span> <span class="n">with</span> <span class="n">postincrement</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_addr_indirect_postinc</span>
	<span class="n">fp_decode_addr_reg</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;(a%d)+&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">fp_test_sp_byte_move</span>
	<span class="n">jsr</span>	<span class="n">fp_get_addr_reg</span>
	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>			<span class="o">|</span> <span class="n">save</span> <span class="n">addr</span>
	<span class="p">.</span><span class="k">if</span>	<span class="n">do_fmovem</span>
	<span class="n">lea</span>	<span class="p">(</span><span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span><span class="p">.</span><span class="n">w</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span><span class="o">%</span><span class="n">a0</span>
	<span class="p">.</span><span class="k">if</span>	<span class="o">!</span><span class="n">do_fmovem_cr</span>
	<span class="n">lea</span>	<span class="p">(</span><span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span><span class="p">.</span><span class="n">w</span><span class="o">*</span><span class="mi">8</span><span class="p">),</span><span class="o">%</span><span class="n">a0</span>
	<span class="p">.</span><span class="n">endif</span>
	<span class="p">.</span><span class="k">else</span>
	<span class="n">add</span><span class="p">.</span><span class="n">w</span>	<span class="p">(</span><span class="n">fp_datasize</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span><span class="p">.</span><span class="n">w</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span><span class="o">%</span><span class="n">a0</span>
	<span class="p">.</span><span class="n">endif</span>
	<span class="n">jsr</span>	<span class="n">fp_put_addr_reg</span>
	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">addressing</span> <span class="n">mode</span><span class="o">:</span> <span class="n">address</span> <span class="k">register</span> <span class="n">indirect</span> <span class="n">with</span> <span class="n">predecrement</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_addr_indirect_predec</span>
	<span class="n">fp_decode_addr_reg</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;-(a%d)&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">fp_test_sp_byte_move</span>
	<span class="n">jsr</span>	<span class="n">fp_get_addr_reg</span>
	<span class="p">.</span><span class="k">if</span>	<span class="n">do_fmovem</span>
	<span class="p">.</span><span class="k">if</span>	<span class="o">!</span><span class="n">do_fmovem_cr</span>
	<span class="n">lea</span>	<span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span><span class="p">),</span><span class="o">%</span><span class="n">a1</span>		<span class="o">|</span> <span class="n">setup</span> <span class="n">to</span> <span class="n">addr</span> <span class="n">of</span> <span class="mi">1</span><span class="n">st</span> <span class="n">reg</span> <span class="n">to</span> <span class="n">move</span>
	<span class="n">neg</span><span class="p">.</span><span class="n">w</span>	<span class="o">%</span><span class="n">d1</span>
	<span class="n">lea</span>	<span class="p">(</span><span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span><span class="p">.</span><span class="n">w</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">add</span><span class="p">.</span><span class="n">w</span>	<span class="o">%</span><span class="n">d1</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span>
	<span class="n">lea</span>	<span class="p">(</span><span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span><span class="p">.</span><span class="n">w</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">jsr</span>	<span class="n">fp_put_addr_reg</span>
	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
	<span class="p">.</span><span class="k">else</span>
	<span class="n">neg</span><span class="p">.</span><span class="n">w</span>	<span class="o">%</span><span class="n">d1</span>
	<span class="n">lea</span>	<span class="p">(</span><span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span><span class="p">.</span><span class="n">w</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">jsr</span>	<span class="n">fp_put_addr_reg</span>
	<span class="p">.</span><span class="n">endif</span>
	<span class="p">.</span><span class="k">else</span>
	<span class="n">sub</span><span class="p">.</span><span class="n">w</span>	<span class="p">(</span><span class="n">fp_datasize</span><span class="p">,</span><span class="o">%</span><span class="n">d1</span><span class="p">.</span><span class="n">w</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">jsr</span>	<span class="n">fp_put_addr_reg</span>
	<span class="p">.</span><span class="n">endif</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">addressing</span> <span class="n">mode</span><span class="o">:</span> <span class="n">address</span> <span class="k">register</span><span class="o">/</span><span class="n">programm</span> <span class="n">counter</span> <span class="n">indirect</span>
<span class="o">|</span>		   <span class="n">with</span> <span class="mi">16</span><span class="n">bit</span> <span class="n">displacement</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_addr_indirect_disp16</span>
	<span class="p">.</span><span class="k">if</span>	<span class="o">!</span><span class="n">do_no_pc_mode</span>
	<span class="n">fp_test_basereg_d16</span> <span class="mf">1f</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;pc&quot;</span>
	<span class="n">fp_get_pc</span> <span class="o">%</span><span class="n">a0</span>
	<span class="n">jra</span>	<span class="mf">2f</span>
	<span class="p">.</span><span class="n">endif</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">fp_decode_addr_reg</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;a%d&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jsr</span>	<span class="n">fp_get_addr_reg</span>
<span class="mi">2</span><span class="o">:</span>	<span class="n">fp_get_instr_word</span> <span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="n">fp_err_ua1</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;@(%x)&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
	<span class="n">add</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">perform</span> <span class="n">preindex</span> <span class="p">(</span><span class="k">if</span> <span class="n">I</span><span class="o">/</span><span class="n">IS</span> <span class="o">==</span> <span class="mi">0</span><span class="n">xx</span> <span class="n">and</span> <span class="n">xx</span> <span class="o">!=</span> <span class="mo">00</span><span class="p">)</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_do_preindex</span>
	<span class="n">moveq</span>	<span class="err">#</span><span class="mi">3</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">and</span><span class="p">.</span><span class="n">w</span>	<span class="o">%</span><span class="n">d2</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jeq</span>	<span class="mf">1f</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">2</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>
	<span class="n">jne</span>	<span class="mf">1f</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;)@(&quot;</span>
	<span class="n">getuser</span><span class="p">.</span><span class="n">l</span> <span class="p">(</span><span class="o">%</span><span class="n">a1</span><span class="p">),</span><span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="n">fp_err_ua1</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
<span class="n">debug</span>	<span class="n">jra</span>	<span class="s">&quot;2f&quot;</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;,&quot;</span>
<span class="mi">2</span><span class="o">:</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">perform</span> <span class="n">postindex</span> <span class="p">(</span><span class="k">if</span> <span class="n">I</span><span class="o">/</span><span class="n">IS</span> <span class="o">==</span> <span class="mi">1</span><span class="n">xx</span><span class="p">)</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_do_postindex</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">2</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>
	<span class="n">jeq</span>	<span class="mf">1f</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;)@(&quot;</span>
	<span class="n">getuser</span><span class="p">.</span><span class="n">l</span> <span class="p">(</span><span class="o">%</span><span class="n">a1</span><span class="p">),</span><span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="n">fp_err_ua1</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
<span class="n">debug</span>	<span class="n">jra</span>	<span class="s">&quot;2f&quot;</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;,&quot;</span>
<span class="mi">2</span><span class="o">:</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">all</span> <span class="n">other</span> <span class="n">indirect</span> <span class="n">addressing</span> <span class="n">modes</span> <span class="n">will</span> <span class="n">finally</span> <span class="n">end</span> <span class="n">up</span> <span class="n">here</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_addr_indirect_extmode0</span>
	<span class="p">.</span><span class="k">if</span>	<span class="o">!</span><span class="n">do_no_pc_mode</span>
	<span class="n">fp_test_basereg_ext</span> <span class="mf">1f</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;pc&quot;</span>
	<span class="n">fp_get_pc</span> <span class="o">%</span><span class="n">a0</span>
	<span class="n">jra</span>	<span class="mf">2f</span>
	<span class="p">.</span><span class="n">endif</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">fp_decode_addr_reg</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;a%d&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">jsr</span>	<span class="n">fp_get_addr_reg</span>
<span class="mi">2</span><span class="o">:</span>	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
	<span class="n">swap</span>	<span class="o">%</span><span class="n">d2</span>
	<span class="n">fp_get_test_extword</span> <span class="mf">3f</span>
	<span class="o">|</span> <span class="n">addressing</span> <span class="n">mode</span><span class="o">:</span> <span class="n">address</span> <span class="k">register</span><span class="o">/</span><span class="n">programm</span> <span class="n">counter</span> <span class="n">indirect</span>
	<span class="o">|</span>		   <span class="n">with</span> <span class="n">index</span> <span class="n">and</span> <span class="mi">8</span><span class="n">bit</span> <span class="n">displacement</span>
	<span class="n">fp_decode_disp8</span>
<span class="n">debug</span>	<span class="n">ext</span><span class="p">.</span><span class="n">l</span>	<span class="s">&quot;%d0&quot;</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;@(%x,&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">d0</span>
	<span class="n">add</span><span class="p">.</span><span class="n">w</span>	<span class="o">%</span><span class="n">d0</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
	<span class="n">fp_decode_index</span>
	<span class="n">add</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">d0</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;)&quot;</span>
	<span class="n">jra</span>	<span class="mf">9f</span>
<span class="mi">3</span><span class="o">:</span>	<span class="o">|</span> <span class="n">addressing</span> <span class="n">mode</span><span class="o">:</span> <span class="n">address</span> <span class="k">register</span><span class="o">/</span><span class="n">programm</span> <span class="n">counter</span> <span class="n">memory</span> <span class="n">indirect</span>
	<span class="o">|</span>		   <span class="n">with</span> <span class="n">base</span> <span class="n">and</span><span class="o">/</span><span class="n">or</span> <span class="n">outer</span> <span class="n">displacement</span>
	<span class="n">btst</span>	<span class="err">#</span><span class="mi">7</span><span class="p">,</span><span class="o">%</span><span class="n">d2</span>			<span class="o">|</span> <span class="n">base</span> <span class="k">register</span> <span class="n">suppressed</span><span class="o">?</span>
	<span class="n">jeq</span>	<span class="mf">1f</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;!&quot;</span>
	<span class="n">sub</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;@(&quot;</span>
	<span class="n">fp_decode_basedisp</span>

	<span class="p">.</span><span class="kt">long</span>	<span class="n">fp_ill</span><span class="p">,</span><span class="mf">1f</span>
	<span class="p">.</span><span class="kt">long</span>	<span class="mf">2f</span><span class="p">,</span><span class="mf">3f</span>

<span class="cp">#ifdef FPU_EMU_DEBUG</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;0&quot;</span>		<span class="o">|</span> <span class="n">null</span> <span class="n">base</span> <span class="n">displacement</span>
	<span class="n">jra</span>	<span class="mf">1f</span>
<span class="cp">#endif</span>
<span class="mi">2</span><span class="o">:</span>	<span class="n">fp_get_instr_word</span> <span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="n">fp_err_ua1</span> <span class="o">|</span> <span class="mi">16</span><span class="n">bit</span> <span class="n">base</span> <span class="n">displacement</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;%x:w&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">jra</span>	<span class="mf">4f</span>
<span class="mi">3</span><span class="o">:</span>	<span class="n">fp_get_instr_long</span> <span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="n">fp_err_ua1</span> <span class="o">|</span> <span class="mi">32</span><span class="n">bit</span> <span class="n">base</span> <span class="n">displacement</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;%x:l&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
<span class="mi">4</span><span class="o">:</span>	<span class="n">add</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
<span class="mi">1</span><span class="o">:</span>
	<span class="n">fp_do_postindex</span>
	<span class="n">fp_test_suppr_index</span> <span class="mf">1f</span>
	<span class="n">fp_decode_index</span>
	<span class="n">add</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">d0</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">fp_do_preindex</span>

	<span class="n">fp_decode_outerdisp</span>

	<span class="p">.</span><span class="kt">long</span>	<span class="mf">5f</span><span class="p">,</span><span class="mf">1f</span>
	<span class="p">.</span><span class="kt">long</span>	<span class="mf">2f</span><span class="p">,</span><span class="mf">3f</span>

<span class="cp">#ifdef FPU_EMU_DEBUG</span>
<span class="mi">1</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;0&quot;</span>		<span class="o">|</span> <span class="n">null</span> <span class="n">outer</span> <span class="n">displacement</span>
	<span class="n">jra</span>	<span class="mf">1f</span>
<span class="cp">#endif</span>
<span class="mi">2</span><span class="o">:</span>	<span class="n">fp_get_instr_word</span> <span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="n">fp_err_ua1</span> <span class="o">|</span> <span class="mi">16</span><span class="n">bit</span> <span class="n">outer</span> <span class="n">displacement</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;%x:w&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">jra</span>	<span class="mf">4f</span>
<span class="mi">3</span><span class="o">:</span>	<span class="n">fp_get_instr_long</span> <span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="n">fp_err_ua1</span> <span class="o">|</span> <span class="mi">32</span><span class="n">bit</span> <span class="n">outer</span> <span class="n">displacement</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;%x:l&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
<span class="mi">4</span><span class="o">:</span>	<span class="n">add</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="o">%</span><span class="n">a1</span>
<span class="mi">1</span><span class="o">:</span>
<span class="mi">5</span><span class="o">:</span>	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;)&quot;</span>
<span class="mi">9</span><span class="o">:</span>	<span class="n">move</span><span class="p">.</span><span class="n">l</span>	<span class="o">%</span><span class="n">a1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
	<span class="n">swap</span>	<span class="o">%</span><span class="n">d2</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">get</span> <span class="n">the</span> <span class="n">absolute</span> <span class="kt">short</span> <span class="n">address</span> <span class="n">from</span> <span class="n">user</span> <span class="n">space</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_abs_short</span>
	<span class="n">fp_get_instr_word</span> <span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="n">fp_err_ua1</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;%x.w&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="o">|</span> <span class="n">get</span> <span class="n">the</span> <span class="n">absolute</span> <span class="kt">long</span> <span class="n">address</span> <span class="n">from</span> <span class="n">user</span> <span class="n">space</span>
<span class="p">.</span><span class="n">macro</span>	<span class="n">fp_mode_abs_long</span>
	<span class="n">fp_get_instr_long</span> <span class="o">%</span><span class="n">a0</span><span class="p">,</span><span class="n">fp_err_ua1</span>
	<span class="n">printf</span>	<span class="n">PDECODE</span><span class="p">,</span><span class="s">&quot;%x.l&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">%</span><span class="n">a0</span>
<span class="p">.</span><span class="n">endm</span>

<span class="cp">#endif </span><span class="cm">/* _FP_DECODE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
