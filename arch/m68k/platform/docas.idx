d | coldfire |  | 33 items |  | Greg Ungerer | gerg@uclinux.org | 1340579840 |  | m68knommu: define a local devm_clk_get() function  Commit f4d40de39a23f0c39cca55ac63e1175c69c3d2f7 ("net fec: do not depend on grouped clocks") breaks compilation of the FEC driver for non iMX platforms in linux-3.5-rc1. For example when compiling for ColdFire I get:        LD      vmlinux     drivers/built-in.o: In function `fec_probe':     fec.c:(.devinit.text+0x1e0): undefined reference to `devm_clk_get'  Define a simple devm_clk_get() function for the m68knommu architecture.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
d | 68EZ328 |  | 2 items |  | Greg Ungerer | gerg@uclinux.org | 1334553064 |  | m68knommu: move and fix the 68VZ328 platform bootlogo.h  The 68EZ328/bootlogo.h is not actually used in the 68EZ328 platform code at all. It is used by the 68VZ328 platform code though, so move it to be with the rest of the 68VZ328 platform code.  Commit c0e0c89c089f4bd66dbbd1a44da90abe74fe3f02 ("fix broken boot logo inclusion") modified the bootlogo code to not be included in asm code. Modify 68VZ328/bootlogo.h so that the bootlogo bit map is named correctly for direct use in the C code.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
d | 68VZ328 |  | 3 items |  | Greg Ungerer | gerg@uclinux.org | 1334553064 |  | m68knommu: move and fix the 68VZ328 platform bootlogo.h  The 68EZ328/bootlogo.h is not actually used in the 68EZ328 platform code at all. It is used by the 68VZ328 platform code though, so move it to be with the rest of the 68VZ328 platform code.  Commit c0e0c89c089f4bd66dbbd1a44da90abe74fe3f02 ("fix broken boot logo inclusion") modified the bootlogo code to not be included in asm code. Modify 68VZ328/bootlogo.h so that the bootlogo bit map is named correctly for direct use in the C code.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | Makefile | g | 48B |  | Greg Ungerer | gerg@uclinux.org | 1301025913 |  | m68k: merge m68k and m68knommu arch directories  There is a lot of common code that could be shared between the m68k and m68knommu arch branches. It makes sense to merge the two branches into a single directory structure so that we can more easily share that common code.  This is a brute force merge, based on a script from Stephen King <sfking@fdwdc.com>, which was originally written by Arnd Bergmann <arnd@arndb.de>.  > The script was inspired by the script Sam Ravnborg used to merge the > includes from m68knommu. For those files common to both arches but > differing in content, the m68k version of the file is renamed to > <file>_mm.<ext> and the m68knommu version of the file is moved into the > corresponding m68k directory and renamed <file>_no.<ext> and a small > wrapper file <file>.<ext> is used to select between the two version. Files > that are common to both but don't differ are removed from the m68knommu > tree and files and directories that are unique to the m68knommu tree are > moved to the m68k tree. Finally, the arch/m68knommu tree is removed. > > To select between the the versions of the files, the wrapper uses > > #ifdef CONFIG_MMU > #include <file>_mm.<ext> > #else > #include <file>_no.<ext> > #endif  On top of this file merge I have done a simplistic merge of m68k and m68knommu Kconfig, which primarily attempts to keep existing options and menus in place. Other than a handful of options being moved it produces identical .config outputs on m68k and m68knommu targets I tested it on.  With this in place there is now quite a bit of scope for merge cleanups in future patches.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
d | 68360 |  | 7 items |  | Greg Ungerer | gerg@uclinux.org | 1339466308 |  | m68knommu: fix 68360 local setting of timer interrupt handler  Compiling for 68360 based targets fails with:      arch/m68k/platform/68360/config.c: In function ‘hw_tick’:     arch/m68k/platform/68360/config.c:55:2: error: implicit declaration of function ‘arch_timer_interrupt’     arch/m68k/platform/68360/config.c: At top level:     arch/m68k/platform/68360/config.c:64:6: error: conflicting types for ‘hw_timer_init’     arch/m68k/include/asm/machdep.h:36:13: note: previous declaration of ‘hw_timer_init’ was here  Changes made to hw_timer_init() didn't get updated in the 68328 timer code. So process and call the "handler" arg that is now passed into that hw_timer_init() function.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
d | 68328 |  | 11 items |  | Greg Ungerer | gerg@uclinux.org | 1339466307 |  | m68knommu: fix 68328 local setting of timer interrupt handler  Compiling for 68328 based targets fails with:      arch/m68k/platform/68328/timers.c: In function ‘hw_tick’:     arch/m68k/platform/68328/timers.c:65:2: error: implicit declaration of function ‘arch_timer_interrupt’     arch/m68k/platform/68328/timers.c: At top level:     arch/m68k/platform/68328/timers.c:102:6: error: conflicting types for ‘hw_timer_init’     arch/m68k/include/asm/machdep.h:36:13: note: previous declaration of ‘hw_timer_init’ was here  Changes made to hw_timer_init() didn't get updated in the 68328 timer code. So process and call the "handler" arg that is now passed into that hw_timer_init() function.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
