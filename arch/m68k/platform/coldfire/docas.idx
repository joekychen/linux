f | Makefile | g | 1.3K |  | Greg Ungerer | gerg@uclinux.org | 1337512927 |  | m68knommu: move the 54xx platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | device.c | s | 6.6K | 291 | Steven King | sfking@fdwdc.com | 1336446411 |  | m68knommu: enable qspi support when SPI_COLDFIRE_QSPI = m  Enable Coldfire QSPI support when SPI_COLDFIRE_QSPI is built as a module.  This version of the patch combines changes to the config files and  device.c and uses IF_ENABLED (thanks to Sam Ravnborg for the suggestion).  Signed-off-by: Steven King <sfking@fdwdc.com> Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | timers.c | s | 5.3K | 156 | Greg Ungerer | gerg@uclinux.org | 1330904590 |  | m68knommu: move old ColdFire timers init from CPU init to timers code  The original ColdFire timer interrupt setup is used by most of the users of the original ColdFire timer code. But the code is currently duplicated in each of the ColdFire CPU specific init files. Move it to the timers code that it is really part of. It is strait forward to make it conditional on also having the original interrupt engine that it needs.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m5307.c | s | 1.9K | 53 | Greg Ungerer | gerg@uclinux.org | 1337512924 |  | m68knommu: move the 5307 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | vectors.c | s | 1.7K | 56 | Greg Ungerer | gerg@uclinux.org | 1330904583 |  | m68knommu: remove reduntant definitions of _ramvec  The base of the real RAM resident hardware vectors, _ramvec, is declared in our asm/traps.h. No need to have local declarations spread around in other files that use this. So remove them.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | gpio.c | s | 3.4K | 106 | Greg Ungerer | gerg@uclinux.org | 1337512907 |  | m68knommu: make duplicated ColdFire GPIO init code common for all  The code that adds each ColdFire platforms GPIO signals is duplicated in each platforms specific code. Remove it from each platforms code and put a single version in the existing ColdFire gpio subsystem init code.  Signed-off-by: Greg Ungerer <gerg@uclinux.org> Acked-by: Steven King <sfking@fdwdc.com>
f | head.S | g | 7.4K |  | Greg Ungerer | gerg@uclinux.org | 1330904583 |  | m68knommu: hard set the ColdFire MBAR register on startup  The ColdFire MBAR register that holds the mapping of the peripheral region on some ColdFire CPUs is configurable. It can be configured at some address different to that of the bootloader that loaded the kernel. So hard set the MBAR register mapping at kernel startup time.  Signed-off-by: Alexander Stein <alexander.stein@systec-electronic.com> Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m520x.c | s | 2.7K | 82 | Greg Ungerer | gerg@uclinux.org | 1337512919 |  | m68knommu: move the 520x platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | reset.c | s | 1.1K | 44 | Greg Ungerer | gerg@uclinux.org | 1330908148 |  | m68knommu: factor more common ColdFire cpu reset code  Most of the more modern ColdFire cores use the same code to reset the CPU (but it is different to most of the earlier cores). Currently that is duplicated in each of the sub-arch files. Pull out this common code and out a single copy of it with the other common reset code.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m523x.c | s | 2.2K | 71 | Greg Ungerer | gerg@uclinux.org | 1337512920 |  | m68knommu: move the 523x platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | pinmux.c | s | 760B | 24 | Greg Ungerer | gerg@uclinux.org | 1301025913 |  | m68k: merge m68k and m68knommu arch directories  There is a lot of common code that could be shared between the m68k and m68knommu arch branches. It makes sense to merge the two branches into a single directory structure so that we can more easily share that common code.  This is a brute force merge, based on a script from Stephen King <sfking@fdwdc.com>, which was originally written by Arnd Bergmann <arnd@arndb.de>.  > The script was inspired by the script Sam Ravnborg used to merge the > includes from m68knommu. For those files common to both arches but > differing in content, the m68k version of the file is renamed to > <file>_mm.<ext> and the m68knommu version of the file is moved into the > corresponding m68k directory and renamed <file>_no.<ext> and a small > wrapper file <file>.<ext> is used to select between the two version. Files > that are common to both but don't differ are removed from the m68knommu > tree and files and directories that are unique to the m68knommu tree are > moved to the m68k tree. Finally, the arch/m68knommu tree is removed. > > To select between the the versions of the files, the wrapper uses > > #ifdef CONFIG_MMU > #include <file>_mm.<ext> > #else > #include <file>_no.<ext> > #endif  On top of this file merge I have done a simplistic merge of m68k and m68knommu Kconfig, which primarily attempts to keep existing options and menus in place. Other than a handful of options being moved it produces identical .config outputs on m68k and m68knommu targets I tested it on.  With this in place there is now quite a bit of scope for merge cleanups in future patches.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m5249.c | s | 2.9K | 89 | Greg Ungerer | gerg@uclinux.org | 1337512921 |  | m68knommu: move the 5249 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | dma.c | s | 968B | 35 | Greg Ungerer | gerg@uclinux.org | 1306195431 |  | m68knommu: remove un-needed exporting of COLDFIRE symbols  There is no reason most of the symbols enclosed in a conditional on CONFIG_COLDFIRE need to be exported. And they sure don't need to be doing it in m68k_ksyms_no.c. Move the dma symbols export (which are currently needed) to the definitions of those, and remove the rest of the exporting here.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | intc.c | s | 3.6K | 129 | Greg Ungerer | gerg@uclinux.org | 1311556841 |  | m68knommu: correctly use trap_init  Currently trap_init() is an empty function for m68knommu. Instead the vectors are being setup as part of the IRQ initialization. This is inconsistent with m68k and other architectures.  Change the local init_vectors() to be trap_init(), and init the vectors at the correct time during startup. This will help merge of m68k and m68knommu trap code in the furture.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | intc-5249.c | s | 1.5K | 52 | Greg Ungerer | gerg@uclinux.org | 1337512921 |  | m68knommu: move the 5249 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m5407.c | s | 1.2K | 32 | Greg Ungerer | gerg@uclinux.org | 1337512925 |  | m68knommu: move the 5407 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | dma_timer.c | s | 2.1K | 67 | John Stultz | johnstul@us.ibm.com | 1321930861 |  | clocksource: m86k: Convert to clocksource_register_hz/khz  This converts the m86k clocksources to use clocksource_register_hz/khz  CC: Geert Uytterhoeven <geert@linux-m68k.org> CC: Greg Ungerer <gerg@uclinux.org> Acked-by: Greg Ungerer <gerg@uclinux.org> Signed-off-by: John Stultz <johnstul@us.ibm.com>
f | m5272.c | s | 3.3K | 96 | Greg Ungerer | gerg@uclinux.org | 1337512922 |  | m68knommu: move the 5272 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m528x.c | s | 3.4K | 112 | Greg Ungerer | gerg@uclinux.org | 1337512924 |  | m68knommu: move the 528x platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | nettel.c | s | 4.0K | 125 | Greg Ungerer | gerg@uclinux.org | 1337512924 |  | m68knommu: move the 5307 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | pit.c | s | 4.2K | 132 | Greg Ungerer | gerg@uclinux.org | 1330904584 |  | m68knommu: modify timer init code to make it consistent with m68k code  With a few small changes we can make the m68knommu timer init code the same as the m68k code. By using the mach_sched_init function pointer and reworking the current timer initializers to keep track of the common m68k timer_interrupt() handler we end up with almost identical code for m68knommu.  This will allow us to more easily merge the mmu and non-mmu m68k time.c in future patches.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | sltimers.c | s | 3.8K | 121 | Greg Ungerer | gerg@uclinux.org | 1330904584 |  | m68knommu: modify timer init code to make it consistent with m68k code  With a few small changes we can make the m68knommu timer init code the same as the m68k code. By using the mach_sched_init function pointer and reworking the current timer initializers to keep track of the common m68k timer_interrupt() handler we end up with almost identical code for m68knommu.  This will allow us to more easily merge the mmu and non-mmu m68k time.c in future patches.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | intc-simr.c | s | 4.4K | 157 | Greg Ungerer | gerg@uclinux.org | 1311556841 |  | m68knommu: correctly use trap_init  Currently trap_init() is an empty function for m68knommu. Instead the vectors are being setup as part of the IRQ initialization. This is inconsistent with m68k and other architectures.  Change the local init_vectors() to be trap_init(), and init the vectors at the correct time during startup. This will help merge of m68k and m68knommu trap code in the furture.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m5206.c | s | 1.3K | 36 | Greg Ungerer | gerg@uclinux.org | 1337512918 |  | m68knommu: move the 5206 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m532x.c | s | 11K | 391 | Linus Torvalds | torvalds@linux-foundation.org | 1337739770 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial  Pull trivial updates from Jiri Kosina:  "As usual, it's mostly typo fixes, redundant code elimination and some   documentation updates."  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/jikos/trivial: (57 commits)   edac, mips: don't change code that has been removed in edac/mips tree   xtensa: Change mail addresses of Hannes Weiner and Oskar Schirmer   lib: Change mail address of Oskar Schirmer   net: Change mail address of Oskar Schirmer   arm/m68k: Change mail address of Sebastian Hess   i2c: Change mail address of Oskar Schirmer   net: Fix tcp_build_and_update_options comment in struct tcp_sock   atomic64_32.h: fix parameter naming mismatch   Kconfig: replace "--- help ---" with "---help---"   c2port: fix bogus Kconfig "default no"   edac: Fix spelling errors.   qla1280: Remove redundant NULL check before release_firmware() call   remoteproc: remove redundant NULL check before release_firmware()   qla2xxx: Remove redundant NULL check before release_firmware() call.   aic94xx: Get rid of redundant NULL check before release_firmware() call   tehuti: delete redundant NULL check before release_firmware()   qlogic: get rid of a redundant test for NULL before call to release_firmware()   bna: remove redundant NULL test before release_firmware()   tg3: remove redundant NULL test before release_firmware() call   typhoon: get rid of redundant conditional before all to release_firmware()   ...
f | intc-2.c | s | 5.2K | 180 | Greg Ungerer | gerg@uclinux.org | 1311556841 |  | m68knommu: correctly use trap_init  Currently trap_init() is an empty function for m68knommu. Instead the vectors are being setup as part of the IRQ initialization. This is inconsistent with m68k and other architectures.  Change the local init_vectors() to be trap_init(), and init the vectors at the correct time during startup. This will help merge of m68k and m68knommu trap code in the furture.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | cache.c | s | 1.3K | 41 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | intc-5272.c | s | 6.0K | 167 | Greg Ungerer | gerg@uclinux.org | 1337512922 |  | m68knommu: move the 5272 platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | entry.S | g | 5.2K |  | Al Viro | viro@zeniv.linux.org.uk | 1337659187 |  | m68k: add TIF_NOTIFY_RESUME and handle it.  TIF_NOTIFY_RESUME added (as bit 5).  That way nommu glue needs no changes at all; mmu one needs just to replace jmi do_signal_return to jne do_signal_return There we have flags shifted up, until bit 6 (SIGPENDING) is in MSBit; instead of checking that MSBit is set (jmi) we check that MSBit or something below it is set (jne); bits 0..4 are never set, so that's precisely "bit 6 or bit 5 is set".  Usual handling of NOTIFY_RESUME/SIGPENDING is done in do_notify_resume(); glue calls it instead of do_signal().  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | clk.c | s | 1.0K | 41 | Greg Ungerer | gerg@uclinux.org | 1340579840 |  | m68knommu: define a local devm_clk_get() function  Commit f4d40de39a23f0c39cca55ac63e1175c69c3d2f7 ("net fec: do not depend on grouped clocks") breaks compilation of the FEC driver for non iMX platforms in linux-3.5-rc1. For example when compiling for ColdFire I get:        LD      vmlinux     drivers/built-in.o: In function `fec_probe':     fec.c:(.devinit.text+0x1e0): undefined reference to `devm_clk_get'  Define a simple devm_clk_get() function for the m68knommu architecture.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m527x.c | s | 3.6K | 120 | Greg Ungerer | gerg@uclinux.org | 1337512923 |  | m68knommu: move the 527x platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | firebee.c | s | 2.2K | 72 | Greg Ungerer | gerg@uclinux.org | 1337512927 |  | m68knommu: move the 54xx platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
f | m54xx.c | s | 3.1K | 89 | Greg Ungerer | gerg@uclinux.org | 1337512927 |  | m68knommu: move the 54xx platform code into the common ColdFire code directory  All these separate directories for each ColdFire CPU SoC varient seems like overkill. The majority of them only contain a single small config file. Move these into the common ColdFire code directory.  Signed-off-by: Greg Ungerer <gerg@uclinux.org>
