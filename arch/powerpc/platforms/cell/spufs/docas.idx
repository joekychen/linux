f | sched.c | s | 29K | 1003 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103844 |  | powerpc: remove non-required uses of include <linux/module.h>  None of the files touched here are modules, and they are not exporting any symbols either -- so there is no need to be including the module.h.  Builds of all the files remains successful.  Even kernel/module.c does not need to include it, since it includes linux/moduleloader.h instead.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | Makefile | g | 1.8K |  | Sam Ravnborg | sam@ravnborg.org | 1260619694 |  | kbuild: drop include2/ used for O=... builds  There is no longer any use of the include2/ directory. The generated files has moved to include/generated.  Drop all references to said directory.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | sputrace.h | s | 964B | 30 | Christoph Hellwig | hch@lst.de | 1250728161 |  | powerpc/sputrace: Use the generic event tracer  I wrote sputrace before generic tracing infrastrucure was available. Now that we have the generic event tracer we can convert it over and remove a lot of code:    8 files changed, 45 insertions(+), 285 deletions(-)  To use it make sure CONFIG_EVENT_TRACING is enabled and then enable the spufs trace channel by    echo 1 > /sys/kernel/debug/tracing/events/spufs/spufs_context/enable  and then read the trace records using e.g.    cat /sys/kernel/debug/tracing/trace  Signed-off-by: Christoph Hellwig <hch@lst.de> Acked-by: Jeremy Kerr <jk@ozlabs.org> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | spu_restore_crt0.S | g | 3.1K |  | Mark Nutter | mnutter@us.ibm.com | 1136778565 |  | [PATCH] spufs: add spu-side context switch code  Add the source code that is used to generate spu_save_dump.h and spu_restore_dump.h. Since a full spu tool chain is needed to generate these files, the default remains to use the shipped versions in order to keep the number of tools for building the kernel down.  Signed-off-by: Arnd Bergmann <arndb@de.ibm.com> Signed-off-by: Paul Mackerras <paulus@samba.org>
f | context.c | s | 4.8K | 165 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103844 |  | powerpc: remove non-required uses of include <linux/module.h>  None of the files touched here are modules, and they are not exporting any symbols either -- so there is no need to be including the module.h.  Builds of all the files remains successful.  Even kernel/module.c does not need to include it, since it includes linux/moduleloader.h instead.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spu_restore.c | s | 9.0K | 305 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | hw_ops.c | s | 9.2K | 306 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103844 |  | powerpc: remove non-required uses of include <linux/module.h>  None of the files touched here are modules, and they are not exporting any symbols either -- so there is no need to be including the module.h.  Builds of all the files remains successful.  Even kernel/module.c does not need to include it, since it includes linux/moduleloader.h instead.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spu_save_dump.h_shipped | g | 8.8K |  | arnd@arndb.de | arnd@arndb.de | 1150866092 |  | [POWERPC] spufs: one more fix for 64k pages  The SPU context save/restore code is currently built for a 4k page size and we provide a _shipped version of it since most people don't have the spu toolchain that is needed to rebuild that code.  This patch hardcodes the data structures to a 64k page alignment, which also guarantees 4k alignment but unfortunately wastes 60k of memory per SPU context that is created in the running system.  We will follow up on this with another patch to reduce that overhead or maybe redo the context save/restore logic to do this part entirely different, but for now it should make experimental systems work with either page size.  Signed-off-by: Arnd Bergmann <arnd.bergmann@de.ibm.com> Signed-off-by: Paul Mackerras <paulus@samba.org>
f | inode.c | s | 18K | 728 | Jan Kara | jack@suse.cz | 1336283021 |  | vfs: Rename end_writeback() to clear_inode()  After we moved inode_sync_wait() from end_writeback() it doesn't make sense to call the function end_writeback() anymore. Rename it to clear_inode() which well says what the function really does - set I_CLEAR flag.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Fengguang Wu <fengguang.wu@intel.com>
f | spu_restore_dump.h_shipped | g | 11K |  | Masato Noguchi | Masato.Noguchi@jp.sony.com | 1184960523 |  | [CELL] spufs: change decrementer restore timing  The SPU decrementer should be restored after the LSCSA DMA has completed.  Signed-off-by: Masato Noguchi <Masato.Noguchi@jp.sony.com> Signed-off-by: Jeremy Kerr <jk@ozlabs.org> Signed-off-by: Arnd Bergmann <arnd.bergmann@de.ibm.com>
f | backing_ops.c | s | 10K | 364 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103844 |  | powerpc: remove non-required uses of include <linux/module.h>  None of the files touched here are modules, and they are not exporting any symbols either -- so there is no need to be including the module.h.  Builds of all the files remains successful.  Even kernel/module.c does not need to include it, since it includes linux/moduleloader.h instead.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spu_save_crt0.S | g | 2.6K |  | Mark Nutter | mnutter@us.ibm.com | 1136778565 |  | [PATCH] spufs: add spu-side context switch code  Add the source code that is used to generate spu_save_dump.h and spu_restore_dump.h. Since a full spu tool chain is needed to generate these files, the default remains to use the shipped versions in order to keep the number of tools for building the kernel down.  Signed-off-by: Arnd Bergmann <arndb@de.ibm.com> Signed-off-by: Paul Mackerras <paulus@samba.org>
f | spufs.h | s | 11K | 328 | Al Viro | viro@zeniv.linux.org.uk | 1325649315 |  | switch spufs guts to umode_t  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | syscalls.c | s | 2.1K | 74 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1332288970 |  | powerpc/spufs: Fix double unlocks  spufs return path has a bug where it could end up trying to unlock an inode mutex twice. Fix it.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | lscsa_alloc.c | s | 4.7K | 147 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | gang.c | s | 2.1K | 75 | Arnd Bergmann | arnd@arndb.de | 1184960537 |  | [CELL] cell: add placement computation for scheduling of affinity contexts  This patch provides the spu affinity placement logic for the spufs scheduler. Each time a gang is going to be scheduled, the placement of a reference context is defined. The placement of all other contexts with affinity from the gang is defined based on this reference context location and on a precomputed displacement offset.  Signed-off-by: Andre Detsch <adetsch@br.ibm.com> Signed-off-by: Arnd Bergmann <arnd.bergmann@de.ibm.com>
f | coredump.c | s | 5.4K | 201 | David Howells | dhowells@redhat.com | 1329676252 |  | Wrap accesses to the fd_sets in struct fdtable  Wrap accesses to the fd_sets in struct fdtable (for recording open files and close-on-exec flags) so that we can move away from using fd_sets since we abuse the fd_set structs by not allocating the full-sized structure under normal circumstances and by non-core code looking at the internals of the fd_sets.  The first abuse means that use of FD_ZERO() on these fd_sets is not permitted, since that cannot be told about their abnormal lengths.  This introduces six wrapper functions for setting, clearing and testing close-on-exec flags and fd-is-open flags:  	void __set_close_on_exec(int fd, struct fdtable *fdt); 	void __clear_close_on_exec(int fd, struct fdtable *fdt); 	bool close_on_exec(int fd, const struct fdtable *fdt); 	void __set_open_fd(int fd, struct fdtable *fdt); 	void __clear_open_fd(int fd, struct fdtable *fdt); 	bool fd_is_open(int fd, const struct fdtable *fdt);  Note that I've prepended '__' to the names of the set/clear functions because they require the caller to hold a lock to use them.  Note also that I haven't added wrappers for looking behind the scenes at the the array.  Possibly that should exist too.  Signed-off-by: David Howells <dhowells@redhat.com> Link: http://lkml.kernel.org/r/20120216174942.23314.1364.stgit@warthog.procyon.org.uk Signed-off-by: H. Peter Anvin <hpa@zytor.com> Cc: Al Viro <viro@zeniv.linux.org.uk>
f | file.c | s | 64K | 2299 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103844 |  | powerpc: various straight conversions from module.h --> export.h  All these files were including module.h just for the basic EXPORT_SYMBOL infrastructure.  We can shift them off to the export.h header which is a way smaller footprint and thus realize some compile time gains.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | switch.c | s | 63K | 1964 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103844 |  | powerpc: various straight conversions from module.h --> export.h  All these files were including module.h just for the basic EXPORT_SYMBOL infrastructure.  We can shift them off to the export.h header which is a way smaller footprint and thus realize some compile time gains.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | spu_save.c | s | 4.8K | 170 | Sebastian Siewior | bigeasy@linux.vnet.ibm.com | 1183440284 |  | [POWERPC] spufs: fix building spufs/spu_save_dump.h  Currently it fails with gcc from sdk 2.1 because of a spec change [1]. Maybe we should start using the definitions from spu_mfcio.h.  [1] http://gcc.gnu.org/ml/gcc-patches/2006-11/msg01598.html  Signed-off-by: Sebastian Siewior <bigeasy@linux.vnet.ibm.com> Signed-off-by: Jeremy Kerr <jk@ozlabs.org> Signed-off-by: Paul Mackerras <paulus@samba.org>
f | fault.c | s | 5.1K | 163 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103844 |  | powerpc: remove non-required uses of include <linux/module.h>  None of the files touched here are modules, and they are not exporting any symbols either -- so there is no need to be including the module.h.  Builds of all the files remains successful.  Even kernel/module.c does not need to include it, since it includes linux/moduleloader.h instead.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | run.c | s | 10K | 383 | Jeremy Kerr | jk@ozlabs.org | 1235346539 |  | powerpc/spufs: Clear purge status before setting up isolated mode  Currently, we may setup the MFC for isolated mode initilaisation with the purge still active. This means that DMAs required to perform the init do not happen.  This change clears the purge status after doing the purge, so that the isolated init can proceed.  Signed-off-by: Jeremy Kerr <jk@ozlabs.org> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | spu_utils.h | s | 3.6K | 139 | Mark Nutter | mnutter@us.ibm.com | 1136778565 |  | [PATCH] spufs: add spu-side context switch code  Add the source code that is used to generate spu_save_dump.h and spu_restore_dump.h. Since a full spu tool chain is needed to generate these files, the default remains to use the shipped versions in order to keep the number of tools for building the kernel down.  Signed-off-by: Arnd Bergmann <arndb@de.ibm.com> Signed-off-by: Paul Mackerras <paulus@samba.org>
