f | pci.c | s | 10K | 340 | Linus Torvalds | torvalds@linux-foundation.org | 1311725530 |  | Merge branch 'next/cross-platform' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/linux-arm-soc  * 'next/cross-platform' of git://git.kernel.org/pub/scm/linux/kernel/git/arm/linux-arm-soc:   ARM: Consolidate the clkdev header files   ARM: set vga memory base at run-time   ARM: convert PCI defines to variables   ARM: pci: make pcibios_assign_all_busses use pci_has_flag   ARM: remove unnecessary mach/hardware.h includes   pci: move microblaze and powerpc pci flag functions into asm-generic   powerpc: rename ppc_pci_*_flags to pci_*_flags  Fix up conflicts in arch/microblaze/include/asm/pci-bridge.h
f | nvram.c | s | 2.2K | 77 | Julia Lawall | julia@diku.dk | 1283400454 |  | powerpc/chrp/nvram.c: Add of_node_put to avoid memory leak  Add a call to of_node_put in the error handling code following a call to of_find_node_by_type.  The semantic match that finds this problem is as follows: (http://coccinelle.lip6.fr/)  // <smpl> @r exists@ local idexpression x; expression E,E1,E2; statement S; @@  *x = (of_find_node_by_path ||of_find_node_by_name ||of_find_node_by_phandle ||of_get_parent ||of_get_next_parent ||of_get_next_child ||of_find_compatible_node ||of_match_node ||of_find_node_by_type ||of_find_node_with_property ||of_find_matching_node ||of_parse_phandle )(...); ... if (x == NULL) S <... when != x = E *if (...) {   ... when != of_node_put(x)       when != if (...) { ... of_node_put(x); ... } (   return <+...x...+>; || *  return ...; ) } ...> ( E2 = x; || of_node_put(x); ) // </smpl>  Signed-off-by: Julia Lawall <julia@diku.dk> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | time.c | s | 4.0K | 136 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1291090159 |  | powerpc/nvram: Move things out of asm/nvram.h  This moves a bunch of definitions out of asm/nvram.h to the files that use them or just outright remove completely unused stuff.  We leave the partition signatures definitions, they will be useful  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | Makefile | g | 107B |  | Arnd Bergmann | arnd@arndb.de | 1183100220 |  | [POWERPC] disallow building powermac and tsi108 without PCI  The TSI108 code and the 32 bit powermac and chrp platforms have dependency on PCI that is not easy or desirable to get rid of.  The easiest fix is to always select CONFIG_PCI if one of those platforms is enabled.  Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | setup.c | s | 14K | 537 | Kyle Moffett | Kyle.D.Moffett@boeing.com | 1329954600 |  | powerpc/mpic: Remove duplicate MPIC_WANTS_RESET flag  There are two separate flags controlling whether or not the MPIC is reset during initialization, which is completely unnecessary, and only one of them can be specified in the device tree.  Also, most platforms in-tree right now do actually want to reset the MPIC during initialization anyways, which means lots of duplicate code passing the MPIC_WANTS_RESET flag.  Fix all of the callers which currently do not pass the MPIC_WANTS_RESET flag to pass the MPIC_NO_RESET flag, then remove the MPIC_WANTS_RESET flag and make the code reset the MPIC by default.  Signed-off-by: Kyle Moffett <Kyle.D.Moffett@boeing.com> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | smp.c | s | 1.2K | 48 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pegasos_eth.c | s | 4.5K | 142 | Gabriel Paubert | paubert@iram.es | 1234328408 |  | powerpc: Disable mv643xx Ethernet port 0 on Pegasos  After the last changes, the mv643xx_eth driver now detects a spurious interface on port 0. Since only port 1 is actually connected to a PHY, remove its description.  Signed-off-by: Gabriel Paubert <paubert@iram.es> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | gg2.h | s | 2.4K | 53 | Kumar Gala | galak@kernel.crashing.org | 1187840609 |  | [POWERPC] Copy over headers from arch/ppc to arch/powerpc that we need  To build arch/powerpc without including asm-ppc/ we need these files in asm-powerpc/  Moved some headers under arch/powerpc/platforms if they were only used by platform or driver files and fixed up the source file includes to match the new locations  Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
f | Kconfig | g | 334B |  | Ralf Baechle | ralf@linux-mips.org | 1307624501 |  | pcspkr: Cleanup Kconfig dependencies  Lenghty lists of the kind "depends on ARCH1 |||| ARCH2 ... |||| ARCH123" are usually either wrong or too coarse grained.  Or plain an ugly sin.  [ tglx: Fixed up amigaone ]  Signed-off-by: Ralf Baechle <ralf@linux-mips.org> Cc: Richard Henderson <rth@twiddle.net> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: Matt Turner <mattst88@gmail.com> Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Paul Mackerras <paulus@samba.org> Cc: linux-alpha@vger.kernel.org Cc: linux-mips@linux-mips.org Cc: linuxppc-dev@lists.ozlabs.org Cc: Gerhard Pircher <gerhard_pircher@gmx.net> Link: http://lkml.kernel.org/r/20110601180610.984881988@duck.linux-mips.net Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | chrp.h | s | 308B | 9 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1165208404 |  | [POWERPC] Make pci_read_irq_line the default  This patch reworks the way IRQs are fixed up on PCI for arch powerpc.  It makes pci_read_irq_line() called by default in the PCI code for devices that are probed, and add an optional per-device fixup in ppc_md for platforms that really need to correct what they obtain from pci_read_irq_line().  It also removes ppc_md.irq_bus_setup which was only used by pSeries and should not be needed anymore.  I've also removed the pSeries s7a workaround as it can't work with the current interrupt code anyway. I'm trying to get one of these machines working so I can test a proper fix for that problem.  I also haven't updated the old-style fixup code from 85xx_cds.c because it's actually buggy :) It assigns pci_dev->irq hard coded numbers which is no good with the new IRQ mapping code. It should at least use irq_create_mapping(NULL, hard_coded_number); and possibly also set_irq_type() to set them as level low.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Signed-off-by: Paul Mackerras <paulus@samba.org>
