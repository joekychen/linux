<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › powerpc › boot › dcr.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>dcr.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _PPC_BOOT_DCR_H_</span>
<span class="cp">#define _PPC_BOOT_DCR_H_</span>

<span class="cp">#define mfdcr(rn) \</span>
<span class="cp">	({	\</span>
<span class="cp">		unsigned long rval; \</span>
<span class="cp">		asm volatile(&quot;mfdcr %0,%1&quot; : &quot;=r&quot;(rval) : &quot;i&quot;(rn)); \</span>
<span class="cp">		rval; \</span>
<span class="cp">	})</span>
<span class="cp">#define mtdcr(rn, val) \</span>
<span class="cp">	asm volatile(&quot;mtdcr %0,%1&quot; : : &quot;i&quot;(rn), &quot;r&quot;(val))</span>
<span class="cp">#define mfdcrx(rn) \</span>
<span class="cp">	({	\</span>
<span class="cp">		unsigned long rval; \</span>
<span class="cp">		asm volatile(&quot;mfdcrx %0,%1&quot; : &quot;=r&quot;(rval) : &quot;r&quot;(rn)); \</span>
<span class="cp">		rval; \</span>
<span class="cp">	})</span>

<span class="cm">/* 440GP/440GX SDRAM controller DCRs */</span>
<span class="cp">#define DCRN_SDRAM0_CFGADDR				0x010</span>
<span class="cp">#define DCRN_SDRAM0_CFGDATA				0x011</span>

<span class="cp">#define SDRAM0_READ(offset) ({\</span>
<span class="cp">	mtdcr(DCRN_SDRAM0_CFGADDR, offset); \</span>
<span class="cp">	mfdcr(DCRN_SDRAM0_CFGDATA); })</span>
<span class="cp">#define SDRAM0_WRITE(offset, data) ({\</span>
<span class="cp">	mtdcr(DCRN_SDRAM0_CFGADDR, offset); \</span>
<span class="cp">	mtdcr(DCRN_SDRAM0_CFGDATA, data); })</span>

<span class="cp">#define 	SDRAM0_B0CR				0x40</span>
<span class="cp">#define 	SDRAM0_B1CR				0x44</span>
<span class="cp">#define 	SDRAM0_B2CR				0x48</span>
<span class="cp">#define 	SDRAM0_B3CR				0x4c</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">sdram_bxcr</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span> <span class="n">SDRAM0_B0CR</span><span class="p">,</span> <span class="n">SDRAM0_B1CR</span><span class="p">,</span>
					    <span class="n">SDRAM0_B2CR</span><span class="p">,</span> <span class="n">SDRAM0_B3CR</span> <span class="p">};</span>

<span class="cp">#define			SDRAM_CONFIG_BANK_ENABLE        0x00000001</span>
<span class="cp">#define			SDRAM_CONFIG_SIZE_MASK          0x000e0000</span>
<span class="cp">#define			SDRAM_CONFIG_BANK_SIZE(reg)	\</span>
<span class="cp">	(0x00400000 &lt;&lt; ((reg &amp; SDRAM_CONFIG_SIZE_MASK) &gt;&gt; 17))</span>

<span class="cm">/* 440GP External Bus Controller (EBC) */</span>
<span class="cp">#define DCRN_EBC0_CFGADDR				0x012</span>
<span class="cp">#define DCRN_EBC0_CFGDATA				0x013</span>
<span class="cp">#define   EBC_NUM_BANKS					  8</span>
<span class="cp">#define   EBC_B0CR					  0x00</span>
<span class="cp">#define   EBC_B1CR					  0x01</span>
<span class="cp">#define   EBC_B2CR					  0x02</span>
<span class="cp">#define   EBC_B3CR					  0x03</span>
<span class="cp">#define   EBC_B4CR					  0x04</span>
<span class="cp">#define   EBC_B5CR					  0x05</span>
<span class="cp">#define   EBC_B6CR					  0x06</span>
<span class="cp">#define   EBC_B7CR					  0x07</span>
<span class="cp">#define   EBC_BXCR(n)					  (n)</span>
<span class="cp">#define	    EBC_BXCR_BAS				    0xfff00000</span>
<span class="cp">#define	    EBC_BXCR_BS				  	    0x000e0000</span>
<span class="cp">#define	    EBC_BXCR_BANK_SIZE(reg) \</span>
<span class="cp">	(0x100000 &lt;&lt; (((reg) &amp; EBC_BXCR_BS) &gt;&gt; 17))</span>
<span class="cp">#define	    EBC_BXCR_BU				  	    0x00018000</span>
<span class="cp">#define	      EBC_BXCR_BU_OFF			  	      0x00000000</span>
<span class="cp">#define	      EBC_BXCR_BU_RO			  	      0x00008000</span>
<span class="cp">#define	      EBC_BXCR_BU_WO			  	      0x00010000</span>
<span class="cp">#define	      EBC_BXCR_BU_RW			  	      0x00018000</span>
<span class="cp">#define	    EBC_BXCR_BW				  	    0x00006000</span>
<span class="cp">#define   EBC_B0AP					  0x10</span>
<span class="cp">#define   EBC_B1AP					  0x11</span>
<span class="cp">#define   EBC_B2AP					  0x12</span>
<span class="cp">#define   EBC_B3AP					  0x13</span>
<span class="cp">#define   EBC_B4AP					  0x14</span>
<span class="cp">#define   EBC_B5AP					  0x15</span>
<span class="cp">#define   EBC_B6AP					  0x16</span>
<span class="cp">#define   EBC_B7AP					  0x17</span>
<span class="cp">#define   EBC_BXAP(n)					  (0x10+(n))</span>
<span class="cp">#define   EBC_BEAR					  0x20</span>
<span class="cp">#define   EBC_BESR					  0x21</span>
<span class="cp">#define   EBC_CFG					  0x23</span>
<span class="cp">#define   EBC_CID					  0x24</span>

<span class="cm">/* 440GP Clock, PM, chip control */</span>
<span class="cp">#define DCRN_CPC0_SR					0x0b0</span>
<span class="cp">#define DCRN_CPC0_ER					0x0b1</span>
<span class="cp">#define DCRN_CPC0_FR					0x0b2</span>
<span class="cp">#define DCRN_CPC0_SYS0					0x0e0</span>
<span class="cp">#define	  CPC0_SYS0_TUNE				  0xffc00000</span>
<span class="cp">#define	  CPC0_SYS0_FBDV_MASK				  0x003c0000</span>
<span class="cp">#define	  CPC0_SYS0_FWDVA_MASK				  0x00038000</span>
<span class="cp">#define	  CPC0_SYS0_FWDVB_MASK				  0x00007000</span>
<span class="cp">#define	  CPC0_SYS0_OPDV_MASK				  0x00000c00</span>
<span class="cp">#define	  CPC0_SYS0_EPDV_MASK				  0x00000300</span>
<span class="cm">/* Helper macros to compute the actual clock divider values from the</span>
<span class="cm"> * encodings in the CPC0 register */</span>
<span class="cp">#define	  CPC0_SYS0_FBDV(reg) \</span>
<span class="cp">		((((((reg) &amp; CPC0_SYS0_FBDV_MASK) &gt;&gt; 18) - 1) &amp; 0xf) + 1)</span>
<span class="cp">#define	  CPC0_SYS0_FWDVA(reg) \</span>
<span class="cp">		(8 - (((reg) &amp; CPC0_SYS0_FWDVA_MASK) &gt;&gt; 15))</span>
<span class="cp">#define	  CPC0_SYS0_FWDVB(reg) \</span>
<span class="cp">		(8 - (((reg) &amp; CPC0_SYS0_FWDVB_MASK) &gt;&gt; 12))</span>
<span class="cp">#define	  CPC0_SYS0_OPDV(reg) \</span>
<span class="cp">		((((reg) &amp; CPC0_SYS0_OPDV_MASK) &gt;&gt; 10) + 1)</span>
<span class="cp">#define	  CPC0_SYS0_EPDV(reg) \</span>
<span class="cp">		((((reg) &amp; CPC0_SYS0_EPDV_MASK) &gt;&gt; 8) + 1)</span>
<span class="cp">#define	  CPC0_SYS0_EXTSL				  0x00000080</span>
<span class="cp">#define	  CPC0_SYS0_RW_MASK				  0x00000060</span>
<span class="cp">#define	  CPC0_SYS0_RL					  0x00000010</span>
<span class="cp">#define	  CPC0_SYS0_ZMIISL_MASK				  0x0000000c</span>
<span class="cp">#define	  CPC0_SYS0_BYPASS				  0x00000002</span>
<span class="cp">#define	  CPC0_SYS0_NTO1				  0x00000001</span>
<span class="cp">#define DCRN_CPC0_SYS1					0x0e1</span>
<span class="cp">#define DCRN_CPC0_CUST0					0x0e2</span>
<span class="cp">#define DCRN_CPC0_CUST1					0x0e3</span>
<span class="cp">#define DCRN_CPC0_STRP0					0x0e4</span>
<span class="cp">#define DCRN_CPC0_STRP1					0x0e5</span>
<span class="cp">#define DCRN_CPC0_STRP2					0x0e6</span>
<span class="cp">#define DCRN_CPC0_STRP3					0x0e7</span>
<span class="cp">#define DCRN_CPC0_GPIO					0x0e8</span>
<span class="cp">#define DCRN_CPC0_PLB					0x0e9</span>
<span class="cp">#define DCRN_CPC0_CR1					0x0ea</span>
<span class="cp">#define DCRN_CPC0_CR0					0x0eb</span>
<span class="cp">#define	  CPC0_CR0_SWE					  0x80000000</span>
<span class="cp">#define	  CPC0_CR0_CETE					  0x40000000</span>
<span class="cp">#define	  CPC0_CR0_U1FCS				  0x20000000</span>
<span class="cp">#define	  CPC0_CR0_U0DTE				  0x10000000</span>
<span class="cp">#define	  CPC0_CR0_U0DRE				  0x08000000</span>
<span class="cp">#define	  CPC0_CR0_U0DC					  0x04000000</span>
<span class="cp">#define	  CPC0_CR0_U1DTE				  0x02000000</span>
<span class="cp">#define	  CPC0_CR0_U1DRE				  0x01000000</span>
<span class="cp">#define	  CPC0_CR0_U1DC					  0x00800000</span>
<span class="cp">#define	  CPC0_CR0_U0EC					  0x00400000</span>
<span class="cp">#define	  CPC0_CR0_U1EC					  0x00200000</span>
<span class="cp">#define	  CPC0_CR0_UDIV_MASK				  0x001f0000</span>
<span class="cp">#define	  CPC0_CR0_UDIV(reg) \</span>
<span class="cp">		((((reg) &amp; CPC0_CR0_UDIV_MASK) &gt;&gt; 16) + 1)</span>
<span class="cp">#define DCRN_CPC0_MIRQ0					0x0ec</span>
<span class="cp">#define DCRN_CPC0_MIRQ1					0x0ed</span>
<span class="cp">#define DCRN_CPC0_JTAGID				0x0ef</span>

<span class="cp">#define DCRN_MAL0_CFG					0x180</span>
<span class="cp">#define MAL_RESET 0x80000000</span>

<span class="cm">/* 440EP Clock/Power-on Reset regs */</span>
<span class="cp">#define DCRN_CPR0_ADDR	0xc</span>
<span class="cp">#define DCRN_CPR0_DATA	0xd</span>
<span class="cp">#define CPR0_PLLD0	0x60</span>
<span class="cp">#define CPR0_OPBD0	0xc0</span>
<span class="cp">#define CPR0_PERD0	0xe0</span>
<span class="cp">#define CPR0_PRIMBD0	0xa0</span>
<span class="cp">#define CPR0_SCPID	0x120</span>
<span class="cp">#define CPR0_PLLC0	0x40</span>

<span class="cm">/* 405GP Clocking/Power Management/Chip Control regs */</span>
<span class="cp">#define DCRN_CPC0_PLLMR 0xb0</span>
<span class="cp">#define DCRN_405_CPC0_CR0 0xb1</span>
<span class="cp">#define DCRN_405_CPC0_CR1 0xb2</span>
<span class="cp">#define DCRN_405_CPC0_PSR 0xb4</span>

<span class="cm">/* 405EP Clocking/Power Management/Chip Control regs */</span>
<span class="cp">#define DCRN_CPC0_PLLMR0  0xf0</span>
<span class="cp">#define DCRN_CPC0_PLLMR1  0xf4</span>
<span class="cp">#define DCRN_CPC0_UCR     0xf5</span>

<span class="cm">/* 440GX/405EX Clock Control reg */</span>
<span class="cp">#define DCRN_CPR0_CLKUPD				0x020</span>
<span class="cp">#define DCRN_CPR0_PLLC					0x040</span>
<span class="cp">#define DCRN_CPR0_PLLD					0x060</span>
<span class="cp">#define DCRN_CPR0_PRIMAD				0x080</span>
<span class="cp">#define DCRN_CPR0_PRIMBD				0x0a0</span>
<span class="cp">#define DCRN_CPR0_OPBD					0x0c0</span>
<span class="cp">#define DCRN_CPR0_PERD					0x0e0</span>
<span class="cp">#define DCRN_CPR0_MALD					0x100</span>

<span class="cp">#define DCRN_SDR0_CONFIG_ADDR 	0xe</span>
<span class="cp">#define DCRN_SDR0_CONFIG_DATA	0xf</span>

<span class="cm">/* SDR read/write helper macros */</span>
<span class="cp">#define SDR0_READ(offset) ({\</span>
<span class="cp">	mtdcr(DCRN_SDR0_CONFIG_ADDR, offset); \</span>
<span class="cp">	mfdcr(DCRN_SDR0_CONFIG_DATA); })</span>
<span class="cp">#define SDR0_WRITE(offset, data) ({\</span>
<span class="cp">	mtdcr(DCRN_SDR0_CONFIG_ADDR, offset); \</span>
<span class="cp">	mtdcr(DCRN_SDR0_CONFIG_DATA, data); })</span>

<span class="cp">#define DCRN_SDR0_UART0		0x0120</span>
<span class="cp">#define DCRN_SDR0_UART1		0x0121</span>
<span class="cp">#define DCRN_SDR0_UART2		0x0122</span>
<span class="cp">#define DCRN_SDR0_UART3		0x0123</span>


<span class="cm">/* CPRs read/write helper macros - based off include/asm-ppc/ibm44x.h */</span>

<span class="cp">#define DCRN_CPR0_CFGADDR				0xc</span>
<span class="cp">#define DCRN_CPR0_CFGDATA				0xd</span>

<span class="cp">#define CPR0_READ(offset) ({\</span>
<span class="cp">	mtdcr(DCRN_CPR0_CFGADDR, offset); \</span>
<span class="cp">	mfdcr(DCRN_CPR0_CFGDATA); })</span>
<span class="cp">#define CPR0_WRITE(offset, data) ({\</span>
<span class="cp">	mtdcr(DCRN_CPR0_CFGADDR, offset); \</span>
<span class="cp">	mtdcr(DCRN_CPR0_CFGDATA, data); })</span>



<span class="cp">#endif	</span><span class="cm">/* _PPC_BOOT_DCR_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
