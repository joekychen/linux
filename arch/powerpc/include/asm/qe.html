<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › powerpc › include › asm › qe.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>qe.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 2006 Freescale Semicondutor, Inc. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Authors: 	Shlomi Gridish &lt;gridish@freescale.com&gt;</span>
<span class="cm"> * 		Li Yang &lt;leoli@freescale.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Description:</span>
<span class="cm"> * QUICC Engine (QE) external definitions and structure.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute  it and/or modify it</span>
<span class="cm"> * under  the terms of  the GNU General  Public License as published by the</span>
<span class="cm"> * Free Software Foundation;  either version 2 of the  License, or (at your</span>
<span class="cm"> * option) any later version.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _ASM_POWERPC_QE_H</span>
<span class="cp">#define _ASM_POWERPC_QE_H</span>
<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#include &lt;linux/spinlock.h&gt;</span>
<span class="cp">#include &lt;linux/errno.h&gt;</span>
<span class="cp">#include &lt;linux/err.h&gt;</span>
<span class="cp">#include &lt;asm/cpm.h&gt;</span>
<span class="cp">#include &lt;asm/immap_qe.h&gt;</span>

<span class="cp">#define QE_NUM_OF_SNUM	256	</span><span class="cm">/* There are 256 serial number in QE */</span><span class="cp"></span>
<span class="cp">#define QE_NUM_OF_BRGS	16</span>
<span class="cp">#define QE_NUM_OF_PORTS	1024</span>

<span class="cm">/* Memory partitions</span>
<span class="cm">*/</span>
<span class="cp">#define MEM_PART_SYSTEM		0</span>
<span class="cp">#define MEM_PART_SECONDARY	1</span>
<span class="cp">#define MEM_PART_MURAM		2</span>

<span class="cm">/* Clocks and BRGs */</span>
<span class="k">enum</span> <span class="n">qe_clock</span> <span class="p">{</span>
	<span class="n">QE_CLK_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">QE_BRG1</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 1 */</span>
	<span class="n">QE_BRG2</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 2 */</span>
	<span class="n">QE_BRG3</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 3 */</span>
	<span class="n">QE_BRG4</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 4 */</span>
	<span class="n">QE_BRG5</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 5 */</span>
	<span class="n">QE_BRG6</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 6 */</span>
	<span class="n">QE_BRG7</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 7 */</span>
	<span class="n">QE_BRG8</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 8 */</span>
	<span class="n">QE_BRG9</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 9 */</span>
	<span class="n">QE_BRG10</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 10 */</span>
	<span class="n">QE_BRG11</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 11 */</span>
	<span class="n">QE_BRG12</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 12 */</span>
	<span class="n">QE_BRG13</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 13 */</span>
	<span class="n">QE_BRG14</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 14 */</span>
	<span class="n">QE_BRG15</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 15 */</span>
	<span class="n">QE_BRG16</span><span class="p">,</span>		<span class="cm">/* Baud Rate Generator 16 */</span>
	<span class="n">QE_CLK1</span><span class="p">,</span>		<span class="cm">/* Clock 1 */</span>
	<span class="n">QE_CLK2</span><span class="p">,</span>		<span class="cm">/* Clock 2 */</span>
	<span class="n">QE_CLK3</span><span class="p">,</span>		<span class="cm">/* Clock 3 */</span>
	<span class="n">QE_CLK4</span><span class="p">,</span>		<span class="cm">/* Clock 4 */</span>
	<span class="n">QE_CLK5</span><span class="p">,</span>		<span class="cm">/* Clock 5 */</span>
	<span class="n">QE_CLK6</span><span class="p">,</span>		<span class="cm">/* Clock 6 */</span>
	<span class="n">QE_CLK7</span><span class="p">,</span>		<span class="cm">/* Clock 7 */</span>
	<span class="n">QE_CLK8</span><span class="p">,</span>		<span class="cm">/* Clock 8 */</span>
	<span class="n">QE_CLK9</span><span class="p">,</span>		<span class="cm">/* Clock 9 */</span>
	<span class="n">QE_CLK10</span><span class="p">,</span>		<span class="cm">/* Clock 10 */</span>
	<span class="n">QE_CLK11</span><span class="p">,</span>		<span class="cm">/* Clock 11 */</span>
	<span class="n">QE_CLK12</span><span class="p">,</span>		<span class="cm">/* Clock 12 */</span>
	<span class="n">QE_CLK13</span><span class="p">,</span>		<span class="cm">/* Clock 13 */</span>
	<span class="n">QE_CLK14</span><span class="p">,</span>		<span class="cm">/* Clock 14 */</span>
	<span class="n">QE_CLK15</span><span class="p">,</span>		<span class="cm">/* Clock 15 */</span>
	<span class="n">QE_CLK16</span><span class="p">,</span>		<span class="cm">/* Clock 16 */</span>
	<span class="n">QE_CLK17</span><span class="p">,</span>		<span class="cm">/* Clock 17 */</span>
	<span class="n">QE_CLK18</span><span class="p">,</span>		<span class="cm">/* Clock 18 */</span>
	<span class="n">QE_CLK19</span><span class="p">,</span>		<span class="cm">/* Clock 19 */</span>
	<span class="n">QE_CLK20</span><span class="p">,</span>		<span class="cm">/* Clock 20 */</span>
	<span class="n">QE_CLK21</span><span class="p">,</span>		<span class="cm">/* Clock 21 */</span>
	<span class="n">QE_CLK22</span><span class="p">,</span>		<span class="cm">/* Clock 22 */</span>
	<span class="n">QE_CLK23</span><span class="p">,</span>		<span class="cm">/* Clock 23 */</span>
	<span class="n">QE_CLK24</span><span class="p">,</span>		<span class="cm">/* Clock 24 */</span>
	<span class="n">QE_CLK_DUMMY</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">qe_clock_is_brg</span><span class="p">(</span><span class="k">enum</span> <span class="n">qe_clock</span> <span class="n">clk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">clk</span> <span class="o">&gt;=</span> <span class="n">QE_BRG1</span> <span class="o">&amp;&amp;</span> <span class="n">clk</span> <span class="o">&lt;=</span> <span class="n">QE_BRG16</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="n">spinlock_t</span> <span class="n">cmxgcr_lock</span><span class="p">;</span>

<span class="cm">/* Export QE common operations */</span>
<span class="cp">#ifdef CONFIG_QUICC_ENGINE</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">qe_reset</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qe_reset</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{}</span>
<span class="cp">#endif</span>

<span class="cm">/* QE PIO */</span>
<span class="cp">#define QE_PIO_PINS 32</span>

<span class="k">struct</span> <span class="n">qe_pio_regs</span> <span class="p">{</span>
	<span class="n">__be32</span>	<span class="n">cpodr</span><span class="p">;</span>		<span class="cm">/* Open drain register */</span>
	<span class="n">__be32</span>	<span class="n">cpdata</span><span class="p">;</span>		<span class="cm">/* Data register */</span>
	<span class="n">__be32</span>	<span class="n">cpdir1</span><span class="p">;</span>		<span class="cm">/* Direction register */</span>
	<span class="n">__be32</span>	<span class="n">cpdir2</span><span class="p">;</span>		<span class="cm">/* Direction register */</span>
	<span class="n">__be32</span>	<span class="n">cppar1</span><span class="p">;</span>		<span class="cm">/* Pin assignment register */</span>
	<span class="n">__be32</span>	<span class="n">cppar2</span><span class="p">;</span>		<span class="cm">/* Pin assignment register */</span>
<span class="cp">#ifdef CONFIG_PPC_85xx</span>
	<span class="n">u8</span>	<span class="n">pad</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="cp">#define QE_PIO_DIR_IN	2</span>
<span class="cp">#define QE_PIO_DIR_OUT	1</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__par_io_config_pin</span><span class="p">(</span><span class="k">struct</span> <span class="n">qe_pio_regs</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">par_io</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pin</span><span class="p">,</span>
				<span class="kt">int</span> <span class="n">dir</span><span class="p">,</span> <span class="kt">int</span> <span class="n">open_drain</span><span class="p">,</span> <span class="kt">int</span> <span class="n">assignment</span><span class="p">,</span>
				<span class="kt">int</span> <span class="n">has_irq</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_QUICC_ENGINE</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">par_io_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">np</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">par_io_of_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">np</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">par_io_config_pin</span><span class="p">(</span><span class="n">u8</span> <span class="n">port</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pin</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dir</span><span class="p">,</span> <span class="kt">int</span> <span class="n">open_drain</span><span class="p">,</span>
			     <span class="kt">int</span> <span class="n">assignment</span><span class="p">,</span> <span class="kt">int</span> <span class="n">has_irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">par_io_data_set</span><span class="p">(</span><span class="n">u8</span> <span class="n">port</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pin</span><span class="p">,</span> <span class="n">u8</span> <span class="n">val</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">par_io_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">np</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENOSYS</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">par_io_of_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">np</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENOSYS</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">par_io_config_pin</span><span class="p">(</span><span class="n">u8</span> <span class="n">port</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pin</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dir</span><span class="p">,</span> <span class="kt">int</span> <span class="n">open_drain</span><span class="p">,</span>
		<span class="kt">int</span> <span class="n">assignment</span><span class="p">,</span> <span class="kt">int</span> <span class="n">has_irq</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENOSYS</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">par_io_data_set</span><span class="p">(</span><span class="n">u8</span> <span class="n">port</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pin</span><span class="p">,</span> <span class="n">u8</span> <span class="n">val</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENOSYS</span><span class="p">;</span> <span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_QUICC_ENGINE */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Pin multiplexing functions.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">qe_pin</span><span class="p">;</span>
<span class="cp">#ifdef CONFIG_QE_GPIO</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="n">qe_pin_request</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">np</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">qe_pin_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="n">qe_pin</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">qe_pin_set_gpio</span><span class="p">(</span><span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="n">qe_pin</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">qe_pin_set_dedicated</span><span class="p">(</span><span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="n">pin</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="nf">qe_pin_request</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">np</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">ERR_PTR</span><span class="p">(</span><span class="o">-</span><span class="n">ENOSYS</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qe_pin_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="n">qe_pin</span><span class="p">)</span> <span class="p">{}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qe_pin_set_gpio</span><span class="p">(</span><span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="n">qe_pin</span><span class="p">)</span> <span class="p">{}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">qe_pin_set_dedicated</span><span class="p">(</span><span class="k">struct</span> <span class="n">qe_pin</span> <span class="o">*</span><span class="n">pin</span><span class="p">)</span> <span class="p">{}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_QE_GPIO */</span><span class="cp"></span>

<span class="cp">#ifdef CONFIG_QUICC_ENGINE</span>
<span class="kt">int</span> <span class="n">qe_issue_cmd</span><span class="p">(</span><span class="n">u32</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">u32</span> <span class="n">device</span><span class="p">,</span> <span class="n">u8</span> <span class="n">mcn_protocol</span><span class="p">,</span> <span class="n">u32</span> <span class="n">cmd_input</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">qe_issue_cmd</span><span class="p">(</span><span class="n">u32</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">u32</span> <span class="n">device</span><span class="p">,</span> <span class="n">u8</span> <span class="n">mcn_protocol</span><span class="p">,</span>
			       <span class="n">u32</span> <span class="n">cmd_input</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">ENOSYS</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_QUICC_ENGINE */</span><span class="cp"></span>

<span class="cm">/* QE internal API */</span>
<span class="k">enum</span> <span class="n">qe_clock</span> <span class="n">qe_clock_source</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">source</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">qe_get_brg_clk</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">qe_setbrg</span><span class="p">(</span><span class="k">enum</span> <span class="n">qe_clock</span> <span class="n">brg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">multiplier</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">qe_get_snum</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">qe_put_snum</span><span class="p">(</span><span class="n">u8</span> <span class="n">snum</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">qe_get_num_of_risc</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">qe_get_num_of_snums</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">qe_alive_during_sleep</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * MPC8568E reference manual says:</span>
<span class="cm">	 *</span>
<span class="cm">	 * &quot;...power down sequence waits for all I/O interfaces to become idle.</span>
<span class="cm">	 *  In some applications this may happen eventually without actively</span>
<span class="cm">	 *  shutting down interfaces, but most likely, software will have to</span>
<span class="cm">	 *  take steps to shut down the eTSEC, QUICC Engine Block, and PCI</span>
<span class="cm">	 *  interfaces before issuing the command (either the write to the core</span>
<span class="cm">	 *  MSR[WE] as described above or writing to POWMGTCSR) to put the</span>
<span class="cm">	 *  device into sleep state.&quot;</span>
<span class="cm">	 *</span>
<span class="cm">	 * MPC8569E reference manual has a similar paragraph.</span>
<span class="cm">	 */</span>
<span class="cp">#ifdef CONFIG_PPC_85xx</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="cp">#else</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="cm">/* we actually use cpm_muram implementation, define this for convenience */</span>
<span class="cp">#define qe_muram_init cpm_muram_init</span>
<span class="cp">#define qe_muram_alloc cpm_muram_alloc</span>
<span class="cp">#define qe_muram_alloc_fixed cpm_muram_alloc_fixed</span>
<span class="cp">#define qe_muram_free cpm_muram_free</span>
<span class="cp">#define qe_muram_addr cpm_muram_addr</span>
<span class="cp">#define qe_muram_offset cpm_muram_offset</span>

<span class="cm">/* Structure that defines QE firmware binary files.</span>
<span class="cm"> *</span>
<span class="cm"> * See Documentation/powerpc/qe_firmware.txt for a description of these</span>
<span class="cm"> * fields.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">qe_firmware</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qe_header</span> <span class="p">{</span>
		<span class="n">__be32</span> <span class="n">length</span><span class="p">;</span>  <span class="cm">/* Length of the entire structure, in bytes */</span>
		<span class="n">u8</span> <span class="n">magic</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>    <span class="cm">/* Set to { &#39;Q&#39;, &#39;E&#39;, &#39;F&#39; } */</span>
		<span class="n">u8</span> <span class="n">version</span><span class="p">;</span>     <span class="cm">/* Version of this layout. First ver is &#39;1&#39; */</span>
	<span class="p">}</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">[</span><span class="mi">62</span><span class="p">];</span>      <span class="cm">/* Null-terminated identifier string */</span>
	<span class="n">u8</span> <span class="n">split</span><span class="p">;</span>	<span class="cm">/* 0 = shared I-RAM, 1 = split I-RAM */</span>
	<span class="n">u8</span> <span class="n">count</span><span class="p">;</span>       <span class="cm">/* Number of microcode[] structures */</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">__be16</span> <span class="n">model</span><span class="p">;</span>   	<span class="cm">/* The SOC model  */</span>
		<span class="n">u8</span> <span class="n">major</span><span class="p">;</span>       	<span class="cm">/* The SOC revision major */</span>
		<span class="n">u8</span> <span class="n">minor</span><span class="p">;</span>       	<span class="cm">/* The SOC revision minor */</span>
	<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">soc</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">padding</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>			<span class="cm">/* Reserved, for alignment */</span>
	<span class="n">__be64</span> <span class="n">extended_modes</span><span class="p">;</span>		<span class="cm">/* Extended modes */</span>
	<span class="n">__be32</span> <span class="n">vtraps</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>		<span class="cm">/* Virtual trap addresses */</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>			<span class="cm">/* Reserved, for future expansion */</span>
	<span class="k">struct</span> <span class="n">qe_microcode</span> <span class="p">{</span>
		<span class="n">u8</span> <span class="n">id</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>      	<span class="cm">/* Null-terminated identifier */</span>
		<span class="n">__be32</span> <span class="n">traps</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>       <span class="cm">/* Trap addresses, 0 == ignore */</span>
		<span class="n">__be32</span> <span class="n">eccr</span><span class="p">;</span>    	<span class="cm">/* The value for the ECCR register */</span>
		<span class="n">__be32</span> <span class="n">iram_offset</span><span class="p">;</span>     <span class="cm">/* Offset into I-RAM for the code */</span>
		<span class="n">__be32</span> <span class="n">count</span><span class="p">;</span>   	<span class="cm">/* Number of 32-bit words of the code */</span>
		<span class="n">__be32</span> <span class="n">code_offset</span><span class="p">;</span>     <span class="cm">/* Offset of the actual microcode */</span>
		<span class="n">u8</span> <span class="n">major</span><span class="p">;</span>       	<span class="cm">/* The microcode version major */</span>
		<span class="n">u8</span> <span class="n">minor</span><span class="p">;</span>       	<span class="cm">/* The microcode version minor */</span>
		<span class="n">u8</span> <span class="n">revision</span><span class="p">;</span>		<span class="cm">/* The microcode version revision */</span>
		<span class="n">u8</span> <span class="n">padding</span><span class="p">;</span>		<span class="cm">/* Reserved, for alignment */</span>
		<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>		<span class="cm">/* Reserved, for future expansion */</span>
	<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">microcode</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* All microcode binaries should be located here */</span>
	<span class="cm">/* CRC32 should be located here, after the microcode binaries */</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">qe_firmware_info</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="n">id</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>		<span class="cm">/* Firmware name */</span>
	<span class="n">u32</span> <span class="n">vtraps</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>		<span class="cm">/* Virtual trap addresses */</span>
	<span class="n">u64</span> <span class="n">extended_modes</span><span class="p">;</span>	<span class="cm">/* Extended modes */</span>
<span class="p">};</span>

<span class="cp">#ifdef CONFIG_QUICC_ENGINE</span>
<span class="cm">/* Upload a firmware to the QE */</span>
<span class="kt">int</span> <span class="n">qe_upload_firmware</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">qe_firmware</span> <span class="o">*</span><span class="n">firmware</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">qe_upload_firmware</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">qe_firmware</span> <span class="o">*</span><span class="n">firmware</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">ENOSYS</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_QUICC_ENGINE */</span><span class="cp"></span>

<span class="cm">/* Obtain information on the uploaded firmware */</span>
<span class="k">struct</span> <span class="n">qe_firmware_info</span> <span class="o">*</span><span class="n">qe_get_firmware_info</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* QE USB */</span>
<span class="kt">int</span> <span class="n">qe_usb_clock_set</span><span class="p">(</span><span class="k">enum</span> <span class="n">qe_clock</span> <span class="n">clk</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">);</span>

<span class="cm">/* Buffer descriptors */</span>
<span class="k">struct</span> <span class="n">qe_bd</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">buf</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cp">#define BD_STATUS_MASK	0xffff0000</span>
<span class="cp">#define BD_LENGTH_MASK	0x0000ffff</span>

<span class="cm">/* Alignment */</span>
<span class="cp">#define QE_INTR_TABLE_ALIGN	16	</span><span class="cm">/* ??? */</span><span class="cp"></span>
<span class="cp">#define QE_ALIGNMENT_OF_BD	8</span>
<span class="cp">#define QE_ALIGNMENT_OF_PRAM	64</span>

<span class="cm">/* RISC allocation */</span>
<span class="cp">#define QE_RISC_ALLOCATION_RISC1	0x1  </span><span class="cm">/* RISC 1 */</span><span class="cp"></span>
<span class="cp">#define QE_RISC_ALLOCATION_RISC2	0x2  </span><span class="cm">/* RISC 2 */</span><span class="cp"></span>
<span class="cp">#define QE_RISC_ALLOCATION_RISC3	0x4  </span><span class="cm">/* RISC 3 */</span><span class="cp"></span>
<span class="cp">#define QE_RISC_ALLOCATION_RISC4	0x8  </span><span class="cm">/* RISC 4 */</span><span class="cp"></span>
<span class="cp">#define QE_RISC_ALLOCATION_RISC1_AND_RISC2	(QE_RISC_ALLOCATION_RISC1 | \</span>
<span class="cp">						 QE_RISC_ALLOCATION_RISC2)</span>
<span class="cp">#define QE_RISC_ALLOCATION_FOUR_RISCS	(QE_RISC_ALLOCATION_RISC1 | \</span>
<span class="cp">					 QE_RISC_ALLOCATION_RISC2 | \</span>
<span class="cp">					 QE_RISC_ALLOCATION_RISC3 | \</span>
<span class="cp">					 QE_RISC_ALLOCATION_RISC4)</span>

<span class="cm">/* QE extended filtering Table Lookup Key Size */</span>
<span class="k">enum</span> <span class="n">qe_fltr_tbl_lookup_key_size</span> <span class="p">{</span>
	<span class="n">QE_FLTR_TABLE_LOOKUP_KEY_SIZE_8_BYTES</span>
		<span class="o">=</span> <span class="mh">0x3f</span><span class="p">,</span>		<span class="cm">/* LookupKey parsed by the Generate LookupKey</span>
<span class="cm">				   CMD is truncated to 8 bytes */</span>
	<span class="n">QE_FLTR_TABLE_LOOKUP_KEY_SIZE_16_BYTES</span>
		<span class="o">=</span> <span class="mh">0x5f</span><span class="p">,</span>		<span class="cm">/* LookupKey parsed by the Generate LookupKey</span>
<span class="cm">				   CMD is truncated to 16 bytes */</span>
<span class="p">};</span>

<span class="cm">/* QE FLTR extended filtering Largest External Table Lookup Key Size */</span>
<span class="k">enum</span> <span class="n">qe_fltr_largest_external_tbl_lookup_key_size</span> <span class="p">{</span>
	<span class="n">QE_FLTR_LARGEST_EXTERNAL_TABLE_LOOKUP_KEY_SIZE_NONE</span>
		<span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span><span class="cm">/* not used */</span>
	<span class="n">QE_FLTR_LARGEST_EXTERNAL_TABLE_LOOKUP_KEY_SIZE_8_BYTES</span>
		<span class="o">=</span> <span class="n">QE_FLTR_TABLE_LOOKUP_KEY_SIZE_8_BYTES</span><span class="p">,</span>	<span class="cm">/* 8 bytes */</span>
	<span class="n">QE_FLTR_LARGEST_EXTERNAL_TABLE_LOOKUP_KEY_SIZE_16_BYTES</span>
		<span class="o">=</span> <span class="n">QE_FLTR_TABLE_LOOKUP_KEY_SIZE_16_BYTES</span><span class="p">,</span>	<span class="cm">/* 16 bytes */</span>
<span class="p">};</span>

<span class="cm">/* structure representing QE parameter RAM */</span>
<span class="k">struct</span> <span class="n">qe_timer_tables</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">tm_base</span><span class="p">;</span>		<span class="cm">/* QE timer table base adr */</span>
	<span class="n">u16</span> <span class="n">tm_ptr</span><span class="p">;</span>		<span class="cm">/* QE timer table pointer */</span>
	<span class="n">u16</span> <span class="n">r_tmr</span><span class="p">;</span>		<span class="cm">/* QE timer mode register */</span>
	<span class="n">u16</span> <span class="n">r_tmv</span><span class="p">;</span>		<span class="cm">/* QE timer valid register */</span>
	<span class="n">u32</span> <span class="n">tm_cmd</span><span class="p">;</span>		<span class="cm">/* QE timer cmd register */</span>
	<span class="n">u32</span> <span class="n">tm_cnt</span><span class="p">;</span>		<span class="cm">/* QE timer internal cnt */</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cp">#define QE_FLTR_TAD_SIZE	8</span>

<span class="cm">/* QE extended filtering Termination Action Descriptor (TAD) */</span>
<span class="k">struct</span> <span class="n">qe_fltr_tad</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">serialized</span><span class="p">[</span><span class="n">QE_FLTR_TAD_SIZE</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* Communication Direction */</span>
<span class="k">enum</span> <span class="n">comm_dir</span> <span class="p">{</span>
	<span class="n">COMM_DIR_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">COMM_DIR_RX</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">COMM_DIR_TX</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">COMM_DIR_RX_AND_TX</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>

<span class="cm">/* QE CMXUCR Registers.</span>
<span class="cm"> * There are two UCCs represented in each of the four CMXUCR registers.</span>
<span class="cm"> * These values are for the UCC in the LSBs</span>
<span class="cm"> */</span>
<span class="cp">#define QE_CMXUCR_MII_ENET_MNG		0x00007000</span>
<span class="cp">#define QE_CMXUCR_MII_ENET_MNG_SHIFT	12</span>
<span class="cp">#define QE_CMXUCR_GRANT			0x00008000</span>
<span class="cp">#define QE_CMXUCR_TSA			0x00004000</span>
<span class="cp">#define QE_CMXUCR_BKPT			0x00000100</span>
<span class="cp">#define QE_CMXUCR_TX_CLK_SRC_MASK	0x0000000F</span>

<span class="cm">/* QE CMXGCR Registers.</span>
<span class="cm">*/</span>
<span class="cp">#define QE_CMXGCR_MII_ENET_MNG		0x00007000</span>
<span class="cp">#define QE_CMXGCR_MII_ENET_MNG_SHIFT	12</span>
<span class="cp">#define QE_CMXGCR_USBCS			0x0000000f</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK3		0x1</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK5		0x2</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK7		0x3</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK9		0x4</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK13		0x5</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK17		0x6</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK19		0x7</span>
<span class="cp">#define QE_CMXGCR_USBCS_CLK21		0x8</span>
<span class="cp">#define QE_CMXGCR_USBCS_BRG9		0x9</span>
<span class="cp">#define QE_CMXGCR_USBCS_BRG10		0xa</span>

<span class="cm">/* QE CECR Commands.</span>
<span class="cm">*/</span>
<span class="cp">#define QE_CR_FLG			0x00010000</span>
<span class="cp">#define QE_RESET			0x80000000</span>
<span class="cp">#define QE_INIT_TX_RX			0x00000000</span>
<span class="cp">#define QE_INIT_RX			0x00000001</span>
<span class="cp">#define QE_INIT_TX			0x00000002</span>
<span class="cp">#define QE_ENTER_HUNT_MODE		0x00000003</span>
<span class="cp">#define QE_STOP_TX			0x00000004</span>
<span class="cp">#define QE_GRACEFUL_STOP_TX		0x00000005</span>
<span class="cp">#define QE_RESTART_TX			0x00000006</span>
<span class="cp">#define QE_CLOSE_RX_BD			0x00000007</span>
<span class="cp">#define QE_SWITCH_COMMAND		0x00000007</span>
<span class="cp">#define QE_SET_GROUP_ADDRESS		0x00000008</span>
<span class="cp">#define QE_START_IDMA			0x00000009</span>
<span class="cp">#define QE_MCC_STOP_RX			0x00000009</span>
<span class="cp">#define QE_ATM_TRANSMIT			0x0000000a</span>
<span class="cp">#define QE_HPAC_CLEAR_ALL		0x0000000b</span>
<span class="cp">#define QE_GRACEFUL_STOP_RX		0x0000001a</span>
<span class="cp">#define QE_RESTART_RX			0x0000001b</span>
<span class="cp">#define QE_HPAC_SET_PRIORITY		0x0000010b</span>
<span class="cp">#define QE_HPAC_STOP_TX			0x0000020b</span>
<span class="cp">#define QE_HPAC_STOP_RX			0x0000030b</span>
<span class="cp">#define QE_HPAC_GRACEFUL_STOP_TX	0x0000040b</span>
<span class="cp">#define QE_HPAC_GRACEFUL_STOP_RX	0x0000050b</span>
<span class="cp">#define QE_HPAC_START_TX		0x0000060b</span>
<span class="cp">#define QE_HPAC_START_RX		0x0000070b</span>
<span class="cp">#define QE_USB_STOP_TX			0x0000000a</span>
<span class="cp">#define QE_USB_RESTART_TX		0x0000000c</span>
<span class="cp">#define QE_QMC_STOP_TX			0x0000000c</span>
<span class="cp">#define QE_QMC_STOP_RX			0x0000000d</span>
<span class="cp">#define QE_SS7_SU_FIL_RESET		0x0000000e</span>
<span class="cm">/* jonathbr added from here down for 83xx */</span>
<span class="cp">#define QE_RESET_BCS			0x0000000a</span>
<span class="cp">#define QE_MCC_INIT_TX_RX_16		0x00000003</span>
<span class="cp">#define QE_MCC_STOP_TX			0x00000004</span>
<span class="cp">#define QE_MCC_INIT_TX_1		0x00000005</span>
<span class="cp">#define QE_MCC_INIT_RX_1		0x00000006</span>
<span class="cp">#define QE_MCC_RESET			0x00000007</span>
<span class="cp">#define QE_SET_TIMER			0x00000008</span>
<span class="cp">#define QE_RANDOM_NUMBER		0x0000000c</span>
<span class="cp">#define QE_ATM_MULTI_THREAD_INIT	0x00000011</span>
<span class="cp">#define QE_ASSIGN_PAGE			0x00000012</span>
<span class="cp">#define QE_ADD_REMOVE_HASH_ENTRY	0x00000013</span>
<span class="cp">#define QE_START_FLOW_CONTROL		0x00000014</span>
<span class="cp">#define QE_STOP_FLOW_CONTROL		0x00000015</span>
<span class="cp">#define QE_ASSIGN_PAGE_TO_DEVICE	0x00000016</span>

<span class="cp">#define QE_ASSIGN_RISC			0x00000010</span>
<span class="cp">#define QE_CR_MCN_NORMAL_SHIFT		6</span>
<span class="cp">#define QE_CR_MCN_USB_SHIFT		4</span>
<span class="cp">#define QE_CR_MCN_RISC_ASSIGN_SHIFT	8</span>
<span class="cp">#define QE_CR_SNUM_SHIFT		17</span>

<span class="cm">/* QE CECR Sub Block - sub block of QE command.</span>
<span class="cm">*/</span>
<span class="cp">#define QE_CR_SUBBLOCK_INVALID		0x00000000</span>
<span class="cp">#define QE_CR_SUBBLOCK_USB		0x03200000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST1		0x02000000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST2		0x02200000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST3		0x02400000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST4		0x02600000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST5		0x02800000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST6		0x02a00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST7		0x02c00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCFAST8		0x02e00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW1		0x00000000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW2		0x00200000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW3		0x00400000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW4		0x00600000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW5		0x00800000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW6		0x00a00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW7		0x00c00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_UCCSLOW8		0x00e00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_MCC1		0x03800000</span>
<span class="cp">#define QE_CR_SUBBLOCK_MCC2		0x03a00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_MCC3		0x03000000</span>
<span class="cp">#define QE_CR_SUBBLOCK_IDMA1		0x02800000</span>
<span class="cp">#define QE_CR_SUBBLOCK_IDMA2		0x02a00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_IDMA3		0x02c00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_IDMA4		0x02e00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_HPAC		0x01e00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_SPI1		0x01400000</span>
<span class="cp">#define QE_CR_SUBBLOCK_SPI2		0x01600000</span>
<span class="cp">#define QE_CR_SUBBLOCK_RAND		0x01c00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_TIMER		0x01e00000</span>
<span class="cp">#define QE_CR_SUBBLOCK_GENERAL		0x03c00000</span>

<span class="cm">/* QE CECR Protocol - For non-MCC, specifies mode for QE CECR command */</span>
<span class="cp">#define QE_CR_PROTOCOL_UNSPECIFIED	0x00	</span><span class="cm">/* For all other protocols */</span><span class="cp"></span>
<span class="cp">#define QE_CR_PROTOCOL_HDLC_TRANSPARENT	0x00</span>
<span class="cp">#define QE_CR_PROTOCOL_QMC		0x02</span>
<span class="cp">#define QE_CR_PROTOCOL_UART		0x04</span>
<span class="cp">#define QE_CR_PROTOCOL_ATM_POS		0x0A</span>
<span class="cp">#define QE_CR_PROTOCOL_ETHERNET		0x0C</span>
<span class="cp">#define QE_CR_PROTOCOL_L2_SWITCH	0x0D</span>

<span class="cm">/* BRG configuration register */</span>
<span class="cp">#define QE_BRGC_ENABLE		0x00010000</span>
<span class="cp">#define QE_BRGC_DIVISOR_SHIFT	1</span>
<span class="cp">#define QE_BRGC_DIVISOR_MAX	0xFFF</span>
<span class="cp">#define QE_BRGC_DIV16		1</span>

<span class="cm">/* QE Timers registers */</span>
<span class="cp">#define QE_GTCFR1_PCAS	0x80</span>
<span class="cp">#define QE_GTCFR1_STP2	0x20</span>
<span class="cp">#define QE_GTCFR1_RST2	0x10</span>
<span class="cp">#define QE_GTCFR1_GM2	0x08</span>
<span class="cp">#define QE_GTCFR1_GM1	0x04</span>
<span class="cp">#define QE_GTCFR1_STP1	0x02</span>
<span class="cp">#define QE_GTCFR1_RST1	0x01</span>

<span class="cm">/* SDMA registers */</span>
<span class="cp">#define QE_SDSR_BER1	0x02000000</span>
<span class="cp">#define QE_SDSR_BER2	0x01000000</span>

<span class="cp">#define QE_SDMR_GLB_1_MSK	0x80000000</span>
<span class="cp">#define QE_SDMR_ADR_SEL		0x20000000</span>
<span class="cp">#define QE_SDMR_BER1_MSK	0x02000000</span>
<span class="cp">#define QE_SDMR_BER2_MSK	0x01000000</span>
<span class="cp">#define QE_SDMR_EB1_MSK		0x00800000</span>
<span class="cp">#define QE_SDMR_ER1_MSK		0x00080000</span>
<span class="cp">#define QE_SDMR_ER2_MSK		0x00040000</span>
<span class="cp">#define QE_SDMR_CEN_MASK	0x0000E000</span>
<span class="cp">#define QE_SDMR_SBER_1		0x00000200</span>
<span class="cp">#define QE_SDMR_SBER_2		0x00000200</span>
<span class="cp">#define QE_SDMR_EB1_PR_MASK	0x000000C0</span>
<span class="cp">#define QE_SDMR_ER1_PR		0x00000008</span>

<span class="cp">#define QE_SDMR_CEN_SHIFT	13</span>
<span class="cp">#define QE_SDMR_EB1_PR_SHIFT	6</span>

<span class="cp">#define QE_SDTM_MSNUM_SHIFT	24</span>

<span class="cp">#define QE_SDEBCR_BA_MASK	0x01FFFFFF</span>

<span class="cm">/* Communication Processor */</span>
<span class="cp">#define QE_CP_CERCR_MEE		0x8000	</span><span class="cm">/* Multi-user RAM ECC enable */</span><span class="cp"></span>
<span class="cp">#define QE_CP_CERCR_IEE		0x4000	</span><span class="cm">/* Instruction RAM ECC enable */</span><span class="cp"></span>
<span class="cp">#define QE_CP_CERCR_CIR		0x0800	</span><span class="cm">/* Common instruction RAM */</span><span class="cp"></span>

<span class="cm">/* I-RAM */</span>
<span class="cp">#define QE_IRAM_IADD_AIE	0x80000000	</span><span class="cm">/* Auto Increment Enable */</span><span class="cp"></span>
<span class="cp">#define QE_IRAM_IADD_BADDR	0x00080000	</span><span class="cm">/* Base Address */</span><span class="cp"></span>

<span class="cm">/* UPC */</span>
<span class="cp">#define UPGCR_PROTOCOL	0x80000000	</span><span class="cm">/* protocol ul2 or pl2 */</span><span class="cp"></span>
<span class="cp">#define UPGCR_TMS	0x40000000	</span><span class="cm">/* Transmit master/slave mode */</span><span class="cp"></span>
<span class="cp">#define UPGCR_RMS	0x20000000	</span><span class="cm">/* Receive master/slave mode */</span><span class="cp"></span>
<span class="cp">#define UPGCR_ADDR	0x10000000	</span><span class="cm">/* Master MPHY Addr multiplexing */</span><span class="cp"></span>
<span class="cp">#define UPGCR_DIAG	0x01000000	</span><span class="cm">/* Diagnostic mode */</span><span class="cp"></span>

<span class="cm">/* UCC GUEMR register */</span>
<span class="cp">#define UCC_GUEMR_MODE_MASK_RX	0x02</span>
<span class="cp">#define UCC_GUEMR_MODE_FAST_RX	0x02</span>
<span class="cp">#define UCC_GUEMR_MODE_SLOW_RX	0x00</span>
<span class="cp">#define UCC_GUEMR_MODE_MASK_TX	0x01</span>
<span class="cp">#define UCC_GUEMR_MODE_FAST_TX	0x01</span>
<span class="cp">#define UCC_GUEMR_MODE_SLOW_TX	0x00</span>
<span class="cp">#define UCC_GUEMR_MODE_MASK (UCC_GUEMR_MODE_MASK_RX | UCC_GUEMR_MODE_MASK_TX)</span>
<span class="cp">#define UCC_GUEMR_SET_RESERVED3	0x10	</span><span class="cm">/* Bit 3 in the guemr is reserved but</span>
<span class="cm">					   must be set 1 */</span><span class="cp"></span>

<span class="cm">/* structure representing UCC SLOW parameter RAM */</span>
<span class="k">struct</span> <span class="n">ucc_slow_pram</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">rbase</span><span class="p">;</span>		<span class="cm">/* RX BD base address */</span>
	<span class="n">__be16</span> <span class="n">tbase</span><span class="p">;</span>		<span class="cm">/* TX BD base address */</span>
	<span class="n">u8</span> <span class="n">rbmr</span><span class="p">;</span>		<span class="cm">/* RX bus mode register (same as CPM&#39;s RFCR) */</span>
	<span class="n">u8</span> <span class="n">tbmr</span><span class="p">;</span>		<span class="cm">/* TX bus mode register (same as CPM&#39;s TFCR) */</span>
	<span class="n">__be16</span> <span class="n">mrblr</span><span class="p">;</span>		<span class="cm">/* Rx buffer length */</span>
	<span class="n">__be32</span> <span class="n">rstate</span><span class="p">;</span>		<span class="cm">/* Rx internal state */</span>
	<span class="n">__be32</span> <span class="n">rptr</span><span class="p">;</span>		<span class="cm">/* Rx internal data pointer */</span>
	<span class="n">__be16</span> <span class="n">rbptr</span><span class="p">;</span>		<span class="cm">/* rb BD Pointer */</span>
	<span class="n">__be16</span> <span class="n">rcount</span><span class="p">;</span>		<span class="cm">/* Rx internal byte count */</span>
	<span class="n">__be32</span> <span class="n">rtemp</span><span class="p">;</span>		<span class="cm">/* Rx temp */</span>
	<span class="n">__be32</span> <span class="n">tstate</span><span class="p">;</span>		<span class="cm">/* Tx internal state */</span>
	<span class="n">__be32</span> <span class="n">tptr</span><span class="p">;</span>		<span class="cm">/* Tx internal data pointer */</span>
	<span class="n">__be16</span> <span class="n">tbptr</span><span class="p">;</span>		<span class="cm">/* Tx BD pointer */</span>
	<span class="n">__be16</span> <span class="n">tcount</span><span class="p">;</span>		<span class="cm">/* Tx byte count */</span>
	<span class="n">__be32</span> <span class="n">ttemp</span><span class="p">;</span>		<span class="cm">/* Tx temp */</span>
	<span class="n">__be32</span> <span class="n">rcrc</span><span class="p">;</span>		<span class="cm">/* temp receive CRC */</span>
	<span class="n">__be32</span> <span class="n">tcrc</span><span class="p">;</span>		<span class="cm">/* temp transmit CRC */</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* General UCC SLOW Mode Register (GUMRH &amp; GUMRL) */</span>
<span class="cp">#define UCC_SLOW_GUMR_H_SAM_QMC		0x00000000</span>
<span class="cp">#define UCC_SLOW_GUMR_H_SAM_SATM	0x00008000</span>
<span class="cp">#define UCC_SLOW_GUMR_H_REVD		0x00002000</span>
<span class="cp">#define UCC_SLOW_GUMR_H_TRX		0x00001000</span>
<span class="cp">#define UCC_SLOW_GUMR_H_TTX		0x00000800</span>
<span class="cp">#define UCC_SLOW_GUMR_H_CDP		0x00000400</span>
<span class="cp">#define UCC_SLOW_GUMR_H_CTSP		0x00000200</span>
<span class="cp">#define UCC_SLOW_GUMR_H_CDS		0x00000100</span>
<span class="cp">#define UCC_SLOW_GUMR_H_CTSS		0x00000080</span>
<span class="cp">#define UCC_SLOW_GUMR_H_TFL		0x00000040</span>
<span class="cp">#define UCC_SLOW_GUMR_H_RFW		0x00000020</span>
<span class="cp">#define UCC_SLOW_GUMR_H_TXSY		0x00000010</span>
<span class="cp">#define UCC_SLOW_GUMR_H_4SYNC		0x00000004</span>
<span class="cp">#define UCC_SLOW_GUMR_H_8SYNC		0x00000008</span>
<span class="cp">#define UCC_SLOW_GUMR_H_16SYNC		0x0000000c</span>
<span class="cp">#define UCC_SLOW_GUMR_H_RTSM		0x00000002</span>
<span class="cp">#define UCC_SLOW_GUMR_H_RSYN		0x00000001</span>

<span class="cp">#define UCC_SLOW_GUMR_L_TCI		0x10000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RINV		0x02000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TINV		0x01000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TEND		0x00040000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TDCR_MASK	0x00030000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TDCR_32	        0x00030000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TDCR_16	        0x00020000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TDCR_8	        0x00010000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TDCR_1	        0x00000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RDCR_MASK	0x0000c000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RDCR_32		0x0000c000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RDCR_16	        0x00008000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RDCR_8	        0x00004000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RDCR_1		0x00000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RENC_NRZI	0x00000800</span>
<span class="cp">#define UCC_SLOW_GUMR_L_RENC_NRZ	0x00000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TENC_NRZI	0x00000100</span>
<span class="cp">#define UCC_SLOW_GUMR_L_TENC_NRZ	0x00000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_DIAG_MASK	0x000000c0</span>
<span class="cp">#define UCC_SLOW_GUMR_L_DIAG_LE	        0x000000c0</span>
<span class="cp">#define UCC_SLOW_GUMR_L_DIAG_ECHO	0x00000080</span>
<span class="cp">#define UCC_SLOW_GUMR_L_DIAG_LOOP	0x00000040</span>
<span class="cp">#define UCC_SLOW_GUMR_L_DIAG_NORM	0x00000000</span>
<span class="cp">#define UCC_SLOW_GUMR_L_ENR		0x00000020</span>
<span class="cp">#define UCC_SLOW_GUMR_L_ENT		0x00000010</span>
<span class="cp">#define UCC_SLOW_GUMR_L_MODE_MASK	0x0000000F</span>
<span class="cp">#define UCC_SLOW_GUMR_L_MODE_BISYNC	0x00000008</span>
<span class="cp">#define UCC_SLOW_GUMR_L_MODE_AHDLC	0x00000006</span>
<span class="cp">#define UCC_SLOW_GUMR_L_MODE_UART	0x00000004</span>
<span class="cp">#define UCC_SLOW_GUMR_L_MODE_QMC	0x00000002</span>

<span class="cm">/* General UCC FAST Mode Register */</span>
<span class="cp">#define UCC_FAST_GUMR_TCI	0x20000000</span>
<span class="cp">#define UCC_FAST_GUMR_TRX	0x10000000</span>
<span class="cp">#define UCC_FAST_GUMR_TTX	0x08000000</span>
<span class="cp">#define UCC_FAST_GUMR_CDP	0x04000000</span>
<span class="cp">#define UCC_FAST_GUMR_CTSP	0x02000000</span>
<span class="cp">#define UCC_FAST_GUMR_CDS	0x01000000</span>
<span class="cp">#define UCC_FAST_GUMR_CTSS	0x00800000</span>
<span class="cp">#define UCC_FAST_GUMR_TXSY	0x00020000</span>
<span class="cp">#define UCC_FAST_GUMR_RSYN	0x00010000</span>
<span class="cp">#define UCC_FAST_GUMR_RTSM	0x00002000</span>
<span class="cp">#define UCC_FAST_GUMR_REVD	0x00000400</span>
<span class="cp">#define UCC_FAST_GUMR_ENR	0x00000020</span>
<span class="cp">#define UCC_FAST_GUMR_ENT	0x00000010</span>

<span class="cm">/* UART Slow UCC Event Register (UCCE) */</span>
<span class="cp">#define UCC_UART_UCCE_AB	0x0200</span>
<span class="cp">#define UCC_UART_UCCE_IDLE	0x0100</span>
<span class="cp">#define UCC_UART_UCCE_GRA	0x0080</span>
<span class="cp">#define UCC_UART_UCCE_BRKE	0x0040</span>
<span class="cp">#define UCC_UART_UCCE_BRKS	0x0020</span>
<span class="cp">#define UCC_UART_UCCE_CCR	0x0008</span>
<span class="cp">#define UCC_UART_UCCE_BSY	0x0004</span>
<span class="cp">#define UCC_UART_UCCE_TX	0x0002</span>
<span class="cp">#define UCC_UART_UCCE_RX	0x0001</span>

<span class="cm">/* HDLC Slow UCC Event Register (UCCE) */</span>
<span class="cp">#define UCC_HDLC_UCCE_GLR	0x1000</span>
<span class="cp">#define UCC_HDLC_UCCE_GLT	0x0800</span>
<span class="cp">#define UCC_HDLC_UCCE_IDLE	0x0100</span>
<span class="cp">#define UCC_HDLC_UCCE_BRKE	0x0040</span>
<span class="cp">#define UCC_HDLC_UCCE_BRKS	0x0020</span>
<span class="cp">#define UCC_HDLC_UCCE_TXE	0x0010</span>
<span class="cp">#define UCC_HDLC_UCCE_RXF	0x0008</span>
<span class="cp">#define UCC_HDLC_UCCE_BSY	0x0004</span>
<span class="cp">#define UCC_HDLC_UCCE_TXB	0x0002</span>
<span class="cp">#define UCC_HDLC_UCCE_RXB	0x0001</span>

<span class="cm">/* BISYNC Slow UCC Event Register (UCCE) */</span>
<span class="cp">#define UCC_BISYNC_UCCE_GRA	0x0080</span>
<span class="cp">#define UCC_BISYNC_UCCE_TXE	0x0010</span>
<span class="cp">#define UCC_BISYNC_UCCE_RCH	0x0008</span>
<span class="cp">#define UCC_BISYNC_UCCE_BSY	0x0004</span>
<span class="cp">#define UCC_BISYNC_UCCE_TXB	0x0002</span>
<span class="cp">#define UCC_BISYNC_UCCE_RXB	0x0001</span>

<span class="cm">/* Gigabit Ethernet Fast UCC Event Register (UCCE) */</span>
<span class="cp">#define UCC_GETH_UCCE_MPD       0x80000000</span>
<span class="cp">#define UCC_GETH_UCCE_SCAR      0x40000000</span>
<span class="cp">#define UCC_GETH_UCCE_GRA       0x20000000</span>
<span class="cp">#define UCC_GETH_UCCE_CBPR      0x10000000</span>
<span class="cp">#define UCC_GETH_UCCE_BSY       0x08000000</span>
<span class="cp">#define UCC_GETH_UCCE_RXC       0x04000000</span>
<span class="cp">#define UCC_GETH_UCCE_TXC       0x02000000</span>
<span class="cp">#define UCC_GETH_UCCE_TXE       0x01000000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB7      0x00800000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB6      0x00400000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB5      0x00200000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB4      0x00100000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB3      0x00080000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB2      0x00040000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB1      0x00020000</span>
<span class="cp">#define UCC_GETH_UCCE_TXB0      0x00010000</span>
<span class="cp">#define UCC_GETH_UCCE_RXB7      0x00008000</span>
<span class="cp">#define UCC_GETH_UCCE_RXB6      0x00004000</span>
<span class="cp">#define UCC_GETH_UCCE_RXB5      0x00002000</span>
<span class="cp">#define UCC_GETH_UCCE_RXB4      0x00001000</span>
<span class="cp">#define UCC_GETH_UCCE_RXB3      0x00000800</span>
<span class="cp">#define UCC_GETH_UCCE_RXB2      0x00000400</span>
<span class="cp">#define UCC_GETH_UCCE_RXB1      0x00000200</span>
<span class="cp">#define UCC_GETH_UCCE_RXB0      0x00000100</span>
<span class="cp">#define UCC_GETH_UCCE_RXF7      0x00000080</span>
<span class="cp">#define UCC_GETH_UCCE_RXF6      0x00000040</span>
<span class="cp">#define UCC_GETH_UCCE_RXF5      0x00000020</span>
<span class="cp">#define UCC_GETH_UCCE_RXF4      0x00000010</span>
<span class="cp">#define UCC_GETH_UCCE_RXF3      0x00000008</span>
<span class="cp">#define UCC_GETH_UCCE_RXF2      0x00000004</span>
<span class="cp">#define UCC_GETH_UCCE_RXF1      0x00000002</span>
<span class="cp">#define UCC_GETH_UCCE_RXF0      0x00000001</span>

<span class="cm">/* UCC Protocol Specific Mode Register (UPSMR), when used for UART */</span>
<span class="cp">#define UCC_UART_UPSMR_FLC		0x8000</span>
<span class="cp">#define UCC_UART_UPSMR_SL		0x4000</span>
<span class="cp">#define UCC_UART_UPSMR_CL_MASK		0x3000</span>
<span class="cp">#define UCC_UART_UPSMR_CL_8		0x3000</span>
<span class="cp">#define UCC_UART_UPSMR_CL_7		0x2000</span>
<span class="cp">#define UCC_UART_UPSMR_CL_6		0x1000</span>
<span class="cp">#define UCC_UART_UPSMR_CL_5		0x0000</span>
<span class="cp">#define UCC_UART_UPSMR_UM_MASK		0x0c00</span>
<span class="cp">#define UCC_UART_UPSMR_UM_NORMAL	0x0000</span>
<span class="cp">#define UCC_UART_UPSMR_UM_MAN_MULTI	0x0400</span>
<span class="cp">#define UCC_UART_UPSMR_UM_AUTO_MULTI	0x0c00</span>
<span class="cp">#define UCC_UART_UPSMR_FRZ		0x0200</span>
<span class="cp">#define UCC_UART_UPSMR_RZS		0x0100</span>
<span class="cp">#define UCC_UART_UPSMR_SYN		0x0080</span>
<span class="cp">#define UCC_UART_UPSMR_DRT		0x0040</span>
<span class="cp">#define UCC_UART_UPSMR_PEN		0x0010</span>
<span class="cp">#define UCC_UART_UPSMR_RPM_MASK		0x000c</span>
<span class="cp">#define UCC_UART_UPSMR_RPM_ODD		0x0000</span>
<span class="cp">#define UCC_UART_UPSMR_RPM_LOW		0x0004</span>
<span class="cp">#define UCC_UART_UPSMR_RPM_EVEN		0x0008</span>
<span class="cp">#define UCC_UART_UPSMR_RPM_HIGH		0x000C</span>
<span class="cp">#define UCC_UART_UPSMR_TPM_MASK		0x0003</span>
<span class="cp">#define UCC_UART_UPSMR_TPM_ODD		0x0000</span>
<span class="cp">#define UCC_UART_UPSMR_TPM_LOW		0x0001</span>
<span class="cp">#define UCC_UART_UPSMR_TPM_EVEN		0x0002</span>
<span class="cp">#define UCC_UART_UPSMR_TPM_HIGH		0x0003</span>

<span class="cm">/* UCC Protocol Specific Mode Register (UPSMR), when used for Ethernet */</span>
<span class="cp">#define UCC_GETH_UPSMR_FTFE     0x80000000</span>
<span class="cp">#define UCC_GETH_UPSMR_PTPE     0x40000000</span>
<span class="cp">#define UCC_GETH_UPSMR_ECM      0x04000000</span>
<span class="cp">#define UCC_GETH_UPSMR_HSE      0x02000000</span>
<span class="cp">#define UCC_GETH_UPSMR_PRO      0x00400000</span>
<span class="cp">#define UCC_GETH_UPSMR_CAP      0x00200000</span>
<span class="cp">#define UCC_GETH_UPSMR_RSH      0x00100000</span>
<span class="cp">#define UCC_GETH_UPSMR_RPM      0x00080000</span>
<span class="cp">#define UCC_GETH_UPSMR_R10M     0x00040000</span>
<span class="cp">#define UCC_GETH_UPSMR_RLPB     0x00020000</span>
<span class="cp">#define UCC_GETH_UPSMR_TBIM     0x00010000</span>
<span class="cp">#define UCC_GETH_UPSMR_RES1     0x00002000</span>
<span class="cp">#define UCC_GETH_UPSMR_RMM      0x00001000</span>
<span class="cp">#define UCC_GETH_UPSMR_CAM      0x00000400</span>
<span class="cp">#define UCC_GETH_UPSMR_BRO      0x00000200</span>
<span class="cp">#define UCC_GETH_UPSMR_SMM	0x00000080</span>
<span class="cp">#define UCC_GETH_UPSMR_SGMM	0x00000020</span>

<span class="cm">/* UCC Transmit On Demand Register (UTODR) */</span>
<span class="cp">#define UCC_SLOW_TOD	0x8000</span>
<span class="cp">#define UCC_FAST_TOD	0x8000</span>

<span class="cm">/* UCC Bus Mode Register masks */</span>
<span class="cm">/* Not to be confused with the Bundle Mode Register */</span>
<span class="cp">#define UCC_BMR_GBL		0x20</span>
<span class="cp">#define UCC_BMR_BO_BE		0x10</span>
<span class="cp">#define UCC_BMR_CETM		0x04</span>
<span class="cp">#define UCC_BMR_DTB		0x02</span>
<span class="cp">#define UCC_BMR_BDB		0x01</span>

<span class="cm">/* Function code masks */</span>
<span class="cp">#define FC_GBL				0x20</span>
<span class="cp">#define FC_DTB_LCL			0x02</span>
<span class="cp">#define UCC_FAST_FUNCTION_CODE_GBL	0x20</span>
<span class="cp">#define UCC_FAST_FUNCTION_CODE_DTB_LCL	0x02</span>
<span class="cp">#define UCC_FAST_FUNCTION_CODE_BDB_LCL	0x01</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* _ASM_POWERPC_QE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
