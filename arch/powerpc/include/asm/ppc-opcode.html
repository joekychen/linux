<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › powerpc › include › asm › ppc-opcode.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>ppc-opcode.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright 2009 Freescale Semicondutor, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License</span>
<span class="cm"> * as published by the Free Software Foundation; either version</span>
<span class="cm"> * 2 of the License, or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * provides masks and opcode images for use by code generation, emulation</span>
<span class="cm"> * and for instructions that older assemblers might not know about</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _ASM_POWERPC_PPC_OPCODE_H</span>
<span class="cp">#define _ASM_POWERPC_PPC_OPCODE_H</span>

<span class="cp">#include &lt;linux/stringify.h&gt;</span>
<span class="cp">#include &lt;asm/asm-compat.h&gt;</span>

<span class="cm">/* sorted alphabetically */</span>
<span class="cp">#define PPC_INST_DCBA			0x7c0005ec</span>
<span class="cp">#define PPC_INST_DCBA_MASK		0xfc0007fe</span>
<span class="cp">#define PPC_INST_DCBAL			0x7c2005ec</span>
<span class="cp">#define PPC_INST_DCBZL			0x7c2007ec</span>
<span class="cp">#define PPC_INST_ISEL			0x7c00001e</span>
<span class="cp">#define PPC_INST_ISEL_MASK		0xfc00003e</span>
<span class="cp">#define PPC_INST_LDARX			0x7c0000a8</span>
<span class="cp">#define PPC_INST_LSWI			0x7c0004aa</span>
<span class="cp">#define PPC_INST_LSWX			0x7c00042a</span>
<span class="cp">#define PPC_INST_LWARX			0x7c000028</span>
<span class="cp">#define PPC_INST_LWSYNC			0x7c2004ac</span>
<span class="cp">#define PPC_INST_LXVD2X			0x7c000698</span>
<span class="cp">#define PPC_INST_MCRXR			0x7c000400</span>
<span class="cp">#define PPC_INST_MCRXR_MASK		0xfc0007fe</span>
<span class="cp">#define PPC_INST_MFSPR_PVR		0x7c1f42a6</span>
<span class="cp">#define PPC_INST_MFSPR_PVR_MASK		0xfc1fffff</span>
<span class="cp">#define PPC_INST_MSGSND			0x7c00019c</span>
<span class="cp">#define PPC_INST_NOP			0x60000000</span>
<span class="cp">#define PPC_INST_POPCNTB		0x7c0000f4</span>
<span class="cp">#define PPC_INST_POPCNTB_MASK		0xfc0007fe</span>
<span class="cp">#define PPC_INST_POPCNTD		0x7c0003f4</span>
<span class="cp">#define PPC_INST_POPCNTW		0x7c0002f4</span>
<span class="cp">#define PPC_INST_RFCI			0x4c000066</span>
<span class="cp">#define PPC_INST_RFDI			0x4c00004e</span>
<span class="cp">#define PPC_INST_RFMCI			0x4c00004c</span>
<span class="cp">#define PPC_INST_MFSPR_DSCR		0x7c1102a6</span>
<span class="cp">#define PPC_INST_MFSPR_DSCR_MASK	0xfc1fffff</span>
<span class="cp">#define PPC_INST_MTSPR_DSCR		0x7c1103a6</span>
<span class="cp">#define PPC_INST_MTSPR_DSCR_MASK	0xfc1fffff</span>
<span class="cp">#define PPC_INST_SLBFEE			0x7c0007a7</span>

<span class="cp">#define PPC_INST_STRING			0x7c00042a</span>
<span class="cp">#define PPC_INST_STRING_MASK		0xfc0007fe</span>
<span class="cp">#define PPC_INST_STRING_GEN_MASK	0xfc00067e</span>

<span class="cp">#define PPC_INST_STSWI			0x7c0005aa</span>
<span class="cp">#define PPC_INST_STSWX			0x7c00052a</span>
<span class="cp">#define PPC_INST_STXVD2X		0x7c000798</span>
<span class="cp">#define PPC_INST_TLBIE			0x7c000264</span>
<span class="cp">#define PPC_INST_TLBILX			0x7c000024</span>
<span class="cp">#define PPC_INST_WAIT			0x7c00007c</span>
<span class="cp">#define PPC_INST_TLBIVAX		0x7c000624</span>
<span class="cp">#define PPC_INST_TLBSRX_DOT		0x7c0006a5</span>
<span class="cp">#define PPC_INST_XXLOR			0xf0000510</span>

<span class="cp">#define PPC_INST_NAP			0x4c000364</span>
<span class="cp">#define PPC_INST_SLEEP			0x4c0003a4</span>

<span class="cm">/* A2 specific instructions */</span>
<span class="cp">#define PPC_INST_ERATWE			0x7c0001a6</span>
<span class="cp">#define PPC_INST_ERATRE			0x7c000166</span>
<span class="cp">#define PPC_INST_ERATILX		0x7c000066</span>
<span class="cp">#define PPC_INST_ERATIVAX		0x7c000666</span>
<span class="cp">#define PPC_INST_ERATSX			0x7c000126</span>
<span class="cp">#define PPC_INST_ERATSX_DOT		0x7c000127</span>

<span class="cm">/* Misc instructions for BPF compiler */</span>
<span class="cp">#define PPC_INST_LD			0xe8000000</span>
<span class="cp">#define PPC_INST_LHZ			0xa0000000</span>
<span class="cp">#define PPC_INST_LWZ			0x80000000</span>
<span class="cp">#define PPC_INST_STD			0xf8000000</span>
<span class="cp">#define PPC_INST_STDU			0xf8000001</span>
<span class="cp">#define PPC_INST_MFLR			0x7c0802a6</span>
<span class="cp">#define PPC_INST_MTLR			0x7c0803a6</span>
<span class="cp">#define PPC_INST_CMPWI			0x2c000000</span>
<span class="cp">#define PPC_INST_CMPDI			0x2c200000</span>
<span class="cp">#define PPC_INST_CMPLW			0x7c000040</span>
<span class="cp">#define PPC_INST_CMPLWI			0x28000000</span>
<span class="cp">#define PPC_INST_ADDI			0x38000000</span>
<span class="cp">#define PPC_INST_ADDIS			0x3c000000</span>
<span class="cp">#define PPC_INST_ADD			0x7c000214</span>
<span class="cp">#define PPC_INST_SUB			0x7c000050</span>
<span class="cp">#define PPC_INST_BLR			0x4e800020</span>
<span class="cp">#define PPC_INST_BLRL			0x4e800021</span>
<span class="cp">#define PPC_INST_MULLW			0x7c0001d6</span>
<span class="cp">#define PPC_INST_MULHWU			0x7c000016</span>
<span class="cp">#define PPC_INST_MULLI			0x1c000000</span>
<span class="cp">#define PPC_INST_DIVWU			0x7c0003d6</span>
<span class="cp">#define PPC_INST_RLWINM			0x54000000</span>
<span class="cp">#define PPC_INST_RLDICR			0x78000004</span>
<span class="cp">#define PPC_INST_SLW			0x7c000030</span>
<span class="cp">#define PPC_INST_SRW			0x7c000430</span>
<span class="cp">#define PPC_INST_AND			0x7c000038</span>
<span class="cp">#define PPC_INST_ANDDOT			0x7c000039</span>
<span class="cp">#define PPC_INST_OR			0x7c000378</span>
<span class="cp">#define PPC_INST_ANDI			0x70000000</span>
<span class="cp">#define PPC_INST_ORI			0x60000000</span>
<span class="cp">#define PPC_INST_ORIS			0x64000000</span>
<span class="cp">#define PPC_INST_NEG			0x7c0000d0</span>
<span class="cp">#define PPC_INST_BRANCH			0x48000000</span>
<span class="cp">#define PPC_INST_BRANCH_COND		0x40800000</span>

<span class="cm">/* macros to insert fields into opcodes */</span>
<span class="cp">#define __PPC_RA(a)	(((a) &amp; 0x1f) &lt;&lt; 16)</span>
<span class="cp">#define __PPC_RB(b)	(((b) &amp; 0x1f) &lt;&lt; 11)</span>
<span class="cp">#define __PPC_RS(s)	(((s) &amp; 0x1f) &lt;&lt; 21)</span>
<span class="cp">#define __PPC_RT(s)	__PPC_RS(s)</span>
<span class="cp">#define __PPC_XA(a)	((((a) &amp; 0x1f) &lt;&lt; 16) | (((a) &amp; 0x20) &gt;&gt; 3))</span>
<span class="cp">#define __PPC_XB(b)	((((b) &amp; 0x1f) &lt;&lt; 11) | (((b) &amp; 0x20) &gt;&gt; 4))</span>
<span class="cp">#define __PPC_XS(s)	((((s) &amp; 0x1f) &lt;&lt; 21) | (((s) &amp; 0x20) &gt;&gt; 5))</span>
<span class="cp">#define __PPC_XT(s)	__PPC_XS(s)</span>
<span class="cp">#define __PPC_T_TLB(t)	(((t) &amp; 0x3) &lt;&lt; 21)</span>
<span class="cp">#define __PPC_WC(w)	(((w) &amp; 0x3) &lt;&lt; 21)</span>
<span class="cp">#define __PPC_WS(w)	(((w) &amp; 0x1f) &lt;&lt; 11)</span>
<span class="cp">#define __PPC_SH(s)	__PPC_WS(s)</span>
<span class="cp">#define __PPC_MB(s)	(((s) &amp; 0x1f) &lt;&lt; 6)</span>
<span class="cp">#define __PPC_ME(s)	(((s) &amp; 0x1f) &lt;&lt; 1)</span>
<span class="cp">#define __PPC_BI(s)	(((s) &amp; 0x1f) &lt;&lt; 16)</span>

<span class="cm">/*</span>
<span class="cm"> * Only use the larx hint bit on 64bit CPUs. e500v1/v2 based CPUs will treat a</span>
<span class="cm"> * larx with EH set as an illegal instruction.</span>
<span class="cm"> */</span>
<span class="cp">#ifdef CONFIG_PPC64</span>
<span class="cp">#define __PPC_EH(eh)	(((eh) &amp; 0x1) &lt;&lt; 0)</span>
<span class="cp">#else</span>
<span class="cp">#define __PPC_EH(eh)	0</span>
<span class="cp">#endif</span>

<span class="cm">/* Deal with instructions that older assemblers aren&#39;t aware of */</span>
<span class="cp">#define	PPC_DCBAL(a, b)		stringify_in_c(.long PPC_INST_DCBAL | \</span>
<span class="cp">					__PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define	PPC_DCBZL(a, b)		stringify_in_c(.long PPC_INST_DCBZL | \</span>
<span class="cp">					__PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define PPC_LDARX(t, a, b, eh)	stringify_in_c(.long PPC_INST_LDARX | \</span>
<span class="cp">					__PPC_RT(t) | __PPC_RA(a) | \</span>
<span class="cp">					__PPC_RB(b) | __PPC_EH(eh))</span>
<span class="cp">#define PPC_LWARX(t, a, b, eh)	stringify_in_c(.long PPC_INST_LWARX | \</span>
<span class="cp">					__PPC_RT(t) | __PPC_RA(a) | \</span>
<span class="cp">					__PPC_RB(b) | __PPC_EH(eh))</span>
<span class="cp">#define PPC_MSGSND(b)		stringify_in_c(.long PPC_INST_MSGSND | \</span>
<span class="cp">					__PPC_RB(b))</span>
<span class="cp">#define PPC_POPCNTB(a, s)	stringify_in_c(.long PPC_INST_POPCNTB | \</span>
<span class="cp">					__PPC_RA(a) | __PPC_RS(s))</span>
<span class="cp">#define PPC_POPCNTD(a, s)	stringify_in_c(.long PPC_INST_POPCNTD | \</span>
<span class="cp">					__PPC_RA(a) | __PPC_RS(s))</span>
<span class="cp">#define PPC_POPCNTW(a, s)	stringify_in_c(.long PPC_INST_POPCNTW | \</span>
<span class="cp">					__PPC_RA(a) | __PPC_RS(s))</span>
<span class="cp">#define PPC_RFCI		stringify_in_c(.long PPC_INST_RFCI)</span>
<span class="cp">#define PPC_RFDI		stringify_in_c(.long PPC_INST_RFDI)</span>
<span class="cp">#define PPC_RFMCI		stringify_in_c(.long PPC_INST_RFMCI)</span>
<span class="cp">#define PPC_TLBILX(t, a, b)	stringify_in_c(.long PPC_INST_TLBILX | \</span>
<span class="cp">					__PPC_T_TLB(t) | __PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define PPC_TLBILX_ALL(a, b)	PPC_TLBILX(0, a, b)</span>
<span class="cp">#define PPC_TLBILX_PID(a, b)	PPC_TLBILX(1, a, b)</span>
<span class="cp">#define PPC_TLBILX_VA(a, b)	PPC_TLBILX(3, a, b)</span>
<span class="cp">#define PPC_WAIT(w)		stringify_in_c(.long PPC_INST_WAIT | \</span>
<span class="cp">					__PPC_WC(w))</span>
<span class="cp">#define PPC_TLBIE(lp,a) 	stringify_in_c(.long PPC_INST_TLBIE | \</span>
<span class="cp">					       __PPC_RB(a) | __PPC_RS(lp))</span>
<span class="cp">#define PPC_TLBSRX_DOT(a,b)	stringify_in_c(.long PPC_INST_TLBSRX_DOT | \</span>
<span class="cp">					__PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define PPC_TLBIVAX(a,b)	stringify_in_c(.long PPC_INST_TLBIVAX | \</span>
<span class="cp">					__PPC_RA(a) | __PPC_RB(b))</span>

<span class="cp">#define PPC_ERATWE(s, a, w)	stringify_in_c(.long PPC_INST_ERATWE | \</span>
<span class="cp">					__PPC_RS(s) | __PPC_RA(a) | __PPC_WS(w))</span>
<span class="cp">#define PPC_ERATRE(s, a, w)	stringify_in_c(.long PPC_INST_ERATRE | \</span>
<span class="cp">					__PPC_RS(s) | __PPC_RA(a) | __PPC_WS(w))</span>
<span class="cp">#define PPC_ERATILX(t, a, b)	stringify_in_c(.long PPC_INST_ERATILX | \</span>
<span class="cp">					__PPC_T_TLB(t) | __PPC_RA(a) | \</span>
<span class="cp">					__PPC_RB(b))</span>
<span class="cp">#define PPC_ERATIVAX(s, a, b)	stringify_in_c(.long PPC_INST_ERATIVAX | \</span>
<span class="cp">					__PPC_RS(s) | __PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define PPC_ERATSX(t, a, w)	stringify_in_c(.long PPC_INST_ERATSX | \</span>
<span class="cp">					__PPC_RS(t) | __PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define PPC_ERATSX_DOT(t, a, w)	stringify_in_c(.long PPC_INST_ERATSX_DOT | \</span>
<span class="cp">					__PPC_RS(t) | __PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define PPC_SLBFEE_DOT(t, b)	stringify_in_c(.long PPC_INST_SLBFEE | \</span>
<span class="cp">					__PPC_RT(t) | __PPC_RB(b))</span>

<span class="cm">/*</span>
<span class="cm"> * Define what the VSX XX1 form instructions will look like, then add</span>
<span class="cm"> * the 128 bit load store instructions based on that.</span>
<span class="cm"> */</span>
<span class="cp">#define VSX_XX1(s, a, b)	(__PPC_XS(s) | __PPC_RA(a) | __PPC_RB(b))</span>
<span class="cp">#define VSX_XX3(t, a, b)	(__PPC_XT(t) | __PPC_XA(a) | __PPC_XB(b))</span>
<span class="cp">#define STXVD2X(s, a, b)	stringify_in_c(.long PPC_INST_STXVD2X | \</span>
<span class="cp">					       VSX_XX1((s), (a), (b)))</span>
<span class="cp">#define LXVD2X(s, a, b)		stringify_in_c(.long PPC_INST_LXVD2X | \</span>
<span class="cp">					       VSX_XX1((s), (a), (b)))</span>
<span class="cp">#define XXLOR(t, a, b)		stringify_in_c(.long PPC_INST_XXLOR | \</span>
<span class="cp">					       VSX_XX3((t), (a), (b)))</span>

<span class="cp">#define PPC_NAP			stringify_in_c(.long PPC_INST_NAP)</span>
<span class="cp">#define PPC_SLEEP		stringify_in_c(.long PPC_INST_SLEEP)</span>

<span class="cp">#endif </span><span class="cm">/* _ASM_POWERPC_PPC_OPCODE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
