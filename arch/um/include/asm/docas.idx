f | processor-generic.h | s | 2.7K | 104 | Linus Torvalds | torvalds@linux-foundation.org | 1337795947 |  | Merge branch 'x86-fpu-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  Pull fpu state cleanups from Ingo Molnar:  "This tree streamlines further aspects of FPU handling by eliminating   the prepare_to_copy() complication and moving that logic to   arch_dup_task_struct().    It also fixes the FPU dumps in threaded core dumps, removes and old   (and now invalid) assumption plus micro-optimizes the exit path by   avoiding an FPU save for dead tasks."  Fixed up trivial add-add conflict in arch/sh/kernel/process.c that came in because we now do the FPU handling in arch_dup_task_struct() rather than the legacy (and now gone) prepare_to_copy().  * 'x86-fpu-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:   x86, fpu: drop the fpu state during thread exit   x86, xsave: remove thread_has_fpu() bug check in __sanitize_i387_state()   coredump: ensure the fpu state is flushed for proper multi-threaded core dump   fork: move the real prepare_to_copy() users to arch_dup_task_struct()
f | kvm_para.h | s | 34B | 1 | Eric B Munson | emunson@mgebm.net | 1333878539 |  | kvmclock: Add functions to check if the host has stopped the vm  When a host stops or suspends a VM it will set a flag to show this.  The watchdog will use these functions to determine if a softlockup is real, or the result of a suspended VM.  Signed-off-by: Eric B Munson <emunson@mgebm.net> asm-generic changes Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | kmap_types.h | s | 490B | 25 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | pgtable-2level.h | s | 1.5K | 40 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | tlb.h | s | 3.0K | 98 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1306337955 |  | um: mmu_gather rework  Fix up the um mmu_gather code to conform to the new API.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Jeff Dike <jdike@addtoit.com> Cc: Richard Weinberger <richard@nod.at> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: David Miller <davem@davemloft.net> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Tony Luck <tony.luck@intel.com> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Hugh Dickins <hughd@google.com> Cc: Mel Gorman <mel@csn.ul.ie> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Nick Piggin <npiggin@kernel.dk> Cc: Namhyung Kim <namhyung@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | smp.h | s | 504B | 20 | Stephen Boyd | sboyd@codeaurora.org | 1306337983 |  | Remove unused PROC_CHANGE_PENALTY constant  This constant hasn't been used since before the git era (2.6.12) and thus can be dropped.  Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Richard Weinberger <richard@nod.at> Cc: Hirokazu Takata <takata@linux-m32r.org> Cc: Kyle McMartin <kyle@mcmartin.ca> Cc: Richard Henderson <rth@twiddle.net> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: Matt Turner <mattst88@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bugs.h | s | 72B | 4 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | a.out-core.h | s | 695B | 22 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | mmu_context.h | s | 1.3K | 45 | Al Viro | viro@zeniv.linux.org.uk | 1332293390 |  | um: uml_dup_mmap() relies on ->mmap_sem being held, but activate_mm() doesn't hold it  ... while calling uml_dup_mmap()  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | fixmap.h | s | 3.0K | 86 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | setup.h | s | 234B | 7 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | dma.h | s | 141B | 6 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | Kbuild | g | 254B |  | Richard Weinberger | richard@nod.at | 1334009625 |  | um: Use asm-generic/switch_to.h  Signed-off-by: Richard Weinberger <richard@nod.at>
f | mmu.h | s | 558B | 18 | Al Viro | viro@zeniv.linux.org.uk | 1332293390 |  | um: embed ->stub_pages[] into mmu_context  seriously, kmalloc() for two-element array of pointers?  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | cache.h | s | 444B | 13 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | tlbflush.h | s | 978B | 26 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | pgalloc.h | s | 1.5K | 46 | Al Viro | viro@zeniv.linux.org.uk | 1332631795 |  | um: remove pointless include of asm/fixmap.h from asm/pgtable.h  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Richard Weinberger <richard@nod.at>
f | page.h | s | 3.4K | 87 | Al Viro | viro@ftp.linux.org.uk | 1320239687 |  | um: take vm-flags.h to sys-*/asm  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Richard Weinberger <richard@nod.at>
f | irqflags.h | s | 751B | 34 | Al Viro | viro@ftp.linux.org.uk | 1320239734 |  | um: kill system-um.h  most of it belonged in irqflags.h, actually  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Richard Weinberger <richard@nod.at>
f | irq.h | s | 454B | 20 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | thread_info.h | s | 2.3K | 69 | Al Viro | viro@zeniv.linux.org.uk | 1337624545 |  | um: bury unused _TIF_RESTORE_SIGMASK  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | pgtable.h | s | 10K | 309 | Richard Weinberger | richard@nod.at | 1337627375 |  | um: Fix __swp_type()  The current __swp_type() function uses a too small bitshift. Using more than one swap files causes bad pages because the type bits clash with other page flags.  CC: stable@kernel.org Analyzed-by: Hugh Dickins <hughd@google.com> Signed-off-by: Richard Weinberger <richard@nod.at>
f | ptrace-generic.h | s | 1.0K | 28 | Al Viro | viro@zeniv.linux.org.uk | 1332631795 |  | um: ptrace-generic.h doesn't need user.h  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Richard Weinberger <richard@nod.at>
f | timex.h | s | 170B | 9 | Al Viro | viro@zeniv.linux.org.uk | 1224741319 |  | x86, um: initial part of asm-um move  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | common.lds.S | g | 1.8K |  | Tejun Heo | tj@kernel.org | 1300989009 |  | percpu: Always align percpu output section to PAGE_SIZE  Percpu allocator honors alignment request upto PAGE_SIZE and both the percpu addresses in the percpu address space and the translated kernel addresses should be aligned accordingly.  The calculation of the former depends on the alignment of percpu output section in the kernel image.  The linker script macros PERCPU_VADDR() and PERCPU() are used to define this output section and the latter takes @align parameter. Several architectures are using @align smaller than PAGE_SIZE breaking percpu memory alignment.  This patch removes @align parameter from PERCPU(), renames it to PERCPU_SECTION() and makes it always align to PAGE_SIZE.  While at it, add PCPU_SETUP_BUG_ON() checks such that alignment problems are reliably detected and remove percpu alignment comment recently added in workqueue.c as the condition would trigger BUG way before reaching there.  For um, this patch raises the alignment of percpu area.  As the area is in .init, there shouldn't be any noticeable difference.  This problem was discovered by David Howells while debugging boot failure on mn10300.  Signed-off-by: Tejun Heo <tj@kernel.org> Acked-by: Mike Frysinger <vapier@gentoo.org> Cc: uclinux-dist-devel@blackfin.uclinux.org Cc: David Howells <dhowells@redhat.com> Cc: Jeff Dike <jdike@addtoit.com> Cc: user-mode-linux-devel@lists.sourceforge.net
f | pgtable-3level.h | s | 3.2K | 103 | H. Peter Anvin | hpa@zytor.com | 1280844016 |  | um, x86: Cast to (u64 *) inside set_64bit()  After tightening up the types passed to set_64bit(), the cast to (phys_t *) triggers a warning apparently because phys_t is defined as "unsigned long" when building on 64 bits; however, u64 is defined as "unsigned long long".  This is, however, a explicit cast inside a size-specific call, so just make the cast explicitly (u64 *).  Signed-off-by: H. Peter Anvin <hpa@zytor.com> Cc: Jeff Dike <jdike@addtoit.com> LKML-Reference: <tip-69309a05907546fb686b251d4ab041c26afe1e1d@git.kernel.org>
f | uaccess.h | s | 5.3K | 149 | Al Viro | viro@ftp.linux.org.uk | 1320239713 |  | um: kill um_uaccess.h  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Richard Weinberger <richard@nod.at>
