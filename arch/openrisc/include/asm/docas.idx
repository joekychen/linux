f | io.h | s | 1.3K | 43 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | kvm_para.h | s | 34B | 1 | Eric B Munson | emunson@mgebm.net | 1333878539 |  | kvmclock: Add functions to check if the host has stopped the vm  When a host stops or suspends a VM it will set a flag to show this.  The watchdog will use these functions to determine if a softlockup is real, or the result of a suspended VM.  Signed-off-by: Eric B Munson <emunson@mgebm.net> asm-generic changes Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | spr.h | s | 1.2K | 37 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | delay.h | s | 670B | 20 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | elf.h | s | 3.3K | 90 | Jonas Bonn | jonas@southpole.se | 1336470210 |  | openrisc: header file cleanups  elf.h: We can export some of these symbols to userspace.  libc needs them and we just as well provide them as asm/elf.h as copying them into separate libc headers.  ptrace.h: Having padding in the user_regs_struct isn't of any particular value and just confuses GDB.  spr_defs isn't needed in userspace; libc has its own copy anyway.  Signed-off-by: Jonas Bonn <jonas@southpole.se>
f | cpuinfo.h | s | 863B | 28 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | serial.h | s | 1.1K | 29 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | tlb.h | s | 1.0K | 30 | Jonas Bonn | jonas@southpole.se | 1311353188 |  | OpenRISC: Memory management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | dma-mapping.h | s | 2.8K | 83 | Jonas Bonn | jonas@southpole.se | 1336470231 |  | openrisc: provide dma_map_ops  This switches OpenRISC over to fully using the generic dma-mapping framework.  This was almost already the case as the architecture's implementation was essentially a copy of the generic header.  This also brings this architecture in line with the recent changes to dma_map_ops (adding attributes to ops->alloc).  Signed-off-by: Jonas Bonn <jonas@southpole.se>
f | prom.h | s | 2.2K | 59 | Grant Likely | grant.likely@secretlab.ca | 1330300086 |  | irq_domain: Centralize definition of irq_dispose_mapping()  Several architectures define their own empty irq_dispose_mapping().  Since the irq_domain code is centralized now, there is little need to do so.  This patch removes them and creates a new empty copy when !CONFIG_IRQ_DOMAIN is selected.  The patch also means that IRQ_DOMAIN becomes selectable on all architectures.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Cc: Rob Herring <rob.herring@calxeda.com> Cc: "David S. Miller" <davem@davemloft.net> Cc: Jonas Bonn <jonas@southpole.se> Cc: sparclinux@vger.kernel.org Cc: linux@lists.openrisc.net
f | unaligned.h | s | 1.7K | 47 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | spr_defs.h | s | 22K | 543 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | ptrace.h | s | 3.6K | 125 | Jonas Bonn | jonas@southpole.se | 1336470210 |  | openrisc: header file cleanups  elf.h: We can export some of these symbols to userspace.  libc needs them and we just as well provide them as asm/elf.h as copying them into separate libc headers.  ptrace.h: Having padding in the user_regs_struct isn't of any particular value and just confuses GDB.  spr_defs isn't needed in userspace; libc has its own copy anyway.  Signed-off-by: Jonas Bonn <jonas@southpole.se>
f | mmu_context.h | s | 1.3K | 34 | Jonas Bonn | jonas@southpole.se | 1311353188 |  | OpenRISC: Memory management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | fixmap.h | s | 2.7K | 77 | Jonas Bonn | jonas@southpole.se | 1311353188 |  | OpenRISC: Memory management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | bitops.h | s | 1.6K | 50 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | Kbuild | g | 1.5K |  | Linus Torvalds | torvalds@linux-foundation.org | 1338057220 |  | word-at-a-time: make the interfaces truly generic  This changes the interfaces in <asm/word-at-a-time.h> to be a bit more complicated, but a lot more generic.  In particular, it allows us to really do the operations efficiently on both little-endian and big-endian machines, pretty much regardless of machine details.  For example, if you can rely on a fast population count instruction on your architecture, this will allow you to make your optimized <asm/word-at-a-time.h> file with that.  NOTE! The "generic" version in include/asm-generic/word-at-a-time.h is not truly generic, it actually only works on big-endian.  Why? Because on little-endian the generic algorithms are wasteful, since you can inevitably do better. The x86 implementation is an example of that.  (The only truly non-generic part of the asm-generic implementation is the "find_zero()" function, and you could make a little-endian version of it.  And if the Kbuild infrastructure allowed us to pick a particular header file, that would be lovely)  The <asm/word-at-a-time.h> functions are as follows:   - WORD_AT_A_TIME_CONSTANTS: specific constants that the algorithm    uses.   - has_zero(): take a word, and determine if it has a zero byte in it.    It gets the word, the pointer to the constant pool, and a pointer to    an intermediate "data" field it can set.     This is the "quick-and-dirty" zero tester: it's what is run inside    the hot loops.   - "prep_zero_mask()": take the word, the data that has_zero() produced,    and the constant pool, and generate an *exact* mask of which byte had    the first zero.  This is run directly *outside* the loop, and allows    the "has_zero()" function to answer the "is there a zero byte"    question without necessarily getting exactly *which* byte is the    first one to contain a zero.     If you do multiple byte lookups concurrently (eg "hash_name()", which    looks for both NUL and '/' bytes), after you've done the prep_zero_mask()    phase, the result of those can be or'ed together to get the "either    or" case.   - The result from "prep_zero_mask()" can then be fed into "find_zero()"    (to find the byte offset of the first byte that was zero) or into    "zero_bytemask()" (to find the bytemask of the bytes preceding the    zero byte).     The existence of zero_bytemask() is optional, and is not necessary    for the normal string routines.  But dentry name hashing needs it, so    if you enable DENTRY_WORD_AT_A_TIME you need to expose it.  This changes the generic strncpy_from_user() function and the dentry hashing functions to use these modified word-at-a-time interfaces.  This gets us back to the optimized state of the x86 strncpy that we lost in the previous commit when moving over to the generic version.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sigcontext.h | s | 995B | 28 | Jonas Bonn | jonas@southpole.se | 1315225752 |  | openrisc: don't use pt_regs in struct sigcontext  As it was decided not to export struct pt_regs to userspace, struct sigcontext shouldn't be using it either.  The pt_regs struct for OpenRISC is kernel internal and the layout of the registers may change in the future.  The struct user_regs_struct is what is guaranteed to remain stable, so struct sigcontext may use that instead.  This patch removes the usage of struct pt_regs in struct sigcontext and makes according changes in signal.c to get the register layout right.  The usp field is removed from the sigcontext structure as this information is already contained in the user_regs_struct.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Emilio Cota <cota@braap.org>
f | cache.h | s | 849B | 25 | Jonas Bonn | jonas@southpole.se | 1311353188 |  | OpenRISC: Memory management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | mmu.h | s | 728B | 23 | Jonas Bonn | jonas@southpole.se | 1311353188 |  | OpenRISC: Memory management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | mutex.h | s | 905B | 25 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | irqflags.h | s | 866B | 24 | Jonas Bonn | jonas@southpole.se | 1311353193 |  | OpenRISC: IRQ  This patch adds support for the OpenRISC PIC.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Cc: tglx@linutronix.de Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | linkage.h | s | 764B | 22 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | tlbflush.h | s | 1.5K | 48 | Jonas Bonn | jonas@southpole.se | 1311353188 |  | OpenRISC: Memory management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | processor.h | s | 3.1K | 84 | Suresh Siddha | suresh.b.siddha@intel.com | 1337206586 |  | fork: move the real prepare_to_copy() users to arch_dup_task_struct()  Historical prepare_to_copy() is mostly a no-op, duplicated for majority of the architectures and the rest following the x86 model of flushing the extended register state like fpu there.  Remove it and use the arch_dup_task_struct() instead.  Suggested-by: Oleg Nesterov <oleg@redhat.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Suresh Siddha <suresh.b.siddha@intel.com> Link: http://lkml.kernel.org/r/1336692811-30576-1-git-send-email-suresh.b.siddha@intel.com Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: David Howells <dhowells@redhat.com> Cc: Koichi Yasutake <yasutake.koichi@jp.panasonic.com> Cc: Paul Mackerras <paulus@samba.org> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Chris Zankel <chris@zankel.net> Cc: Richard Henderson <rth@twiddle.net> Cc: Russell King <linux@arm.linux.org.uk> Cc: Haavard Skinnemoen <hskinnemoen@gmail.com> Cc: Mike Frysinger <vapier@gentoo.org> Cc: Mark Salter <msalter@redhat.com> Cc: Aurelien Jacquiot <a-jacquiot@ti.com> Cc: Mikael Starvik <starvik@axis.com> Cc: Yoshinori Sato <ysato@users.sourceforge.jp> Cc: Richard Kuo <rkuo@codeaurora.org> Cc: Tony Luck <tony.luck@intel.com> Cc: Michal Simek <monstr@monstr.eu> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Jonas Bonn <jonas@southpole.se> Cc: James E.J. Bottomley <jejb@parisc-linux.org> Cc: Helge Deller <deller@gmx.de> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Chen Liqin <liqin.chen@sunplusct.com> Cc: Lennox Wu <lennox.wu@gmail.com> Cc: David S. Miller <davem@davemloft.net> Cc: Chris Metcalf <cmetcalf@tilera.com> Cc: Jeff Dike <jdike@addtoit.com> Cc: Richard Weinberger <richard@nod.at> Cc: Guan Xuetao <gxt@mprc.pku.edu.cn> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>
f | syscall.h | s | 1.8K | 62 | Jonas Bonn | jonas@southpole.se | 1331026620 |  | openrisc: sanitize use of orig_gpr11  The pt_regs struct had both a 'syscallno' field and an 'orig_gpr11' field and it wasn't really clear how these were supposed to be used.  This patch removes the syscallno field altogether and makes orig_gpr11 work more like other architectures: keep track of syscall number in progress or hold -1 for non-syscall exceptions.  Signed-off-by: Jonas Bonn <jonas@southpole.se>
d | bitops |  | 4 items |  | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | unistd.h | s | 917B | 25 | Jonas Bonn | jonas@southpole.se | 1311353194 |  | OpenRISC: System calls  The OpenRISC Linux kernel conforms to the "generic" syscall interface which contains only the reduced set of syscalls deemed necessary for new architectures.  Unfortunately, the uClibc port for OpenRISC does not fully support this reduced set; as such, an additional patch available out-of-tree needs to be applied to the kernel in order to use the current uClibc.  This is just a temporary measure until the libc port can be straightened out; it is likely that OpenRISC will make the transition to glibc shortly where the generic syscall interface is better supported.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | page.h | s | 2.7K | 78 | Richard Weinberger | richard@nod.at | 1331026641 |  | OpenRISC: Remove memory_start/end prototypes  OpenRISC does not have global memory_start and memory_end symbols. The prototypes are in vain.  Signed-off-by: Richard Weinberger <richard@nod.at> Signed-off-by: Jonas Bonn <jonas@southpole.se>
f | pgalloc.h | s | 2.5K | 84 | Jonas Bonn | jonas@southpole.se | 1311353188 |  | OpenRISC: Memory management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | syscalls.h | s | 836B | 23 | Jonas Bonn | jonas@southpole.se | 1311353194 |  | OpenRISC: System calls  The OpenRISC Linux kernel conforms to the "generic" syscall interface which contains only the reduced set of syscalls deemed necessary for new architectures.  Unfortunately, the uClibc port for OpenRISC does not fully support this reduced set; as such, an additional patch available out-of-tree needs to be applied to the kernel in order to use the current uClibc.  This is just a temporary measure until the libc port can be straightened out; it is likely that OpenRISC will make the transition to glibc shortly where the generic syscall interface is better supported.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | param.h | s | 756B | 22 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | gpio.h | s | 106B | 4 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1336780814 |  | gpiolib/arches: Centralise bolierplate asm/gpio.h  Rather than requiring architectures that use gpiolib but don't have any need to define anything custom to copy an asm/gpio.h provide a Kconfig symbol which architectures must select in order to include gpio.h and for other architectures just provide the trivial implementation directly.  This makes it much easier to do gpiolib updates and is also a step towards making gpiolib APIs available on every architecture.  For architectures with existing boilerplate code leave a stub header in place which warns on direct inclusion of asm/gpio.h and includes linux/gpio.h to catch code that's doing this.  Direct inclusion of asm/gpio.h has long been deprecated.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Jonas Bonn <jonas@southpole.se> Acked-by: Tony Luck <tony.luck@intel.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | thread_info.h | s | 4.1K | 112 | Jonas Bonn | jonas@southpole.se | 1311353196 |  | OpenRISC: Scheduling/Process management  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | asm-offsets.h | s | 35B | 1 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | irq.h | s | 768B | 23 | Jonas Bonn | jonas@southpole.se | 1311353193 |  | OpenRISC: IRQ  This patch adds support for the OpenRISC PIC.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Cc: tglx@linutronix.de Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | uaccess.h | s | 9.5K | 280 | Jonas Bonn | jonas@southpole.se | 1338177632 |  | openrisc: use generic strnlen_user() function  The generic version is both easier to support and more correct.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pgtable.h | s | 14K | 381 | Javi Merino | javi.merino@arm.com | 1332547111 |  | Remove remaining bits of io_remap_page_range()  Commit 33bf56106d9b ("feature removal of io_remap_page_range()") removed io_remap_page_range(), but it is still included in some arch header files.  It has no in-tree users.  Signed-off-by: Javi Merino <javi.merino@arm.com> Cc: Russell King <linux@arm.linux.org.uk> Cc: Aurelien Jacquiot <a-jacquiot@ti.com> Cc: Michal Simek <monstr@monstr.eu> Cc: Jonas Bonn <jonas@southpole.se> Cc: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | timex.h | s | 884B | 29 | Jonas Bonn | jonas@southpole.se | 1311353192 |  | OpenRISC: Timekeeping  Implements support for the OpenRISC timer which is a 28 bit cycle counter that can be read out of a special purpose register.  This counter is used as a both a clock event and clocksource device.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Cc: tglx@linutronix.de Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | spinlock.h | s | 707B | 21 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | byteorder.h | s | 40B | 1 | Jonas Bonn | jonas@southpole.se | 1311353199 |  | OpenRISC: Headers  Signed-off-by: Jonas Bonn <jonas@southpole.se> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
