f | console_32.c | s | 1.2K | 50 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | init_64.c | s | 1.4K | 42 | Linus Torvalds | torvalds@linux-foundation.org | 1294678623 |  | Merge branch 'next-devicetree' of git://git.secretlab.ca/git/linux-2.6  * 'next-devicetree' of git://git.secretlab.ca/git/linux-2.6: (29 commits)   of/flattree: forward declare struct device_node in of_fdt.h   ipmi: explicitly include of_address.h and of_irq.h   sparc: explicitly cast negative phandle checks to s32   powerpc/405: Fix missing #{address,size}-cells in i2c node   powerpc/5200: dts: refactor dts files   powerpc/5200: dts: Change combatible strings on localbus   powerpc/5200: dts: remove unused properties   powerpc/5200: dts: rename nodes to prepare for refactoring dts files   of/flattree: Update dtc to current mainline.   of/device: Don't register disabled devices   powerpc/dts: fix syntax bugs in bluestone.dts   of: Fixes for OF probing on little endian systems   of: make drivers depend on CONFIG_OF instead of CONFIG_PPC_OF   of/flattree: Add of_flat_dt_match() helper function   of_serial: explicitly include of_irq.h   of/flattree: Refactor unflatten_device_tree and add fdt_unflatten_tree   of/flattree: Reorder unflatten_dt_node   of/flattree: Refactor unflatten_dt_node   of/flattree: Add non-boottime device tree functions   of/flattree: Add Kconfig for EARLY_FLATTREE   ...  Fix up trivial conflict in arch/sparc/prom/tree_32.c as per Grant.
f | misc_64.c | s | 8.9K | 370 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | Makefile | g | 507B |  | Sam Ravnborg | sam@ravnborg.org | 1336789664 |  | sparc32: drop sun4c support  Machines with sun4c support are very rare these days, and noone is using them for any practical purposes. The sun4c support has been know broken for quite some time too.  So rather than trying to keep it up-to-date, lets get rid of it. This allows us to do some very welcome cleanup of sparc32 support.  Updated the former sun4c specifc nmi (which was also used for sun4m UP) to be a generic UP NMI.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | console_64.c | s | 976B | 39 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | tree_32.c | s | 7.0K | 257 | Linus Torvalds | torvalds@linux-foundation.org | 1294678623 |  | Merge branch 'next-devicetree' of git://git.secretlab.ca/git/linux-2.6  * 'next-devicetree' of git://git.secretlab.ca/git/linux-2.6: (29 commits)   of/flattree: forward declare struct device_node in of_fdt.h   ipmi: explicitly include of_address.h and of_irq.h   sparc: explicitly cast negative phandle checks to s32   powerpc/405: Fix missing #{address,size}-cells in i2c node   powerpc/5200: dts: refactor dts files   powerpc/5200: dts: Change combatible strings on localbus   powerpc/5200: dts: remove unused properties   powerpc/5200: dts: rename nodes to prepare for refactoring dts files   of/flattree: Update dtc to current mainline.   of/device: Don't register disabled devices   powerpc/dts: fix syntax bugs in bluestone.dts   of: Fixes for OF probing on little endian systems   of: make drivers depend on CONFIG_OF instead of CONFIG_PPC_OF   of/flattree: Add of_flat_dt_match() helper function   of_serial: explicitly include of_irq.h   of/flattree: Refactor unflatten_device_tree and add fdt_unflatten_tree   of/flattree: Reorder unflatten_dt_node   of/flattree: Refactor unflatten_dt_node   of/flattree: Add non-boottime device tree functions   of/flattree: Add Kconfig for EARLY_FLATTREE   ...  Fix up trivial conflict in arch/sparc/prom/tree_32.c as per Grant.
f | ranges.c | s | 3.6K | 101 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | memory.c | s | 1.9K | 70 | Andres Salomon | dilinger@queued.net | 1286613214 |  | of/sparc: convert various prom_* functions to use phandle  Rather than passing around ints everywhere, use the phandle type where appropriate for the various functions that talk to the PROM.  Signed-off-by: Andres Salomon <dilinger@queued.net> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | misc_32.c | s | 2.6K | 110 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | printf.c | s | 1.7K | 58 | David S. Miller | davem@davemloft.net | 1291176958 |  | sparc: Write to prom console using indirect buffer.  sparc64 systems have a restriction in that passing in buffer addressses above 4GB to prom calls is not reliable.  We end up violating this when we do prom console writes, because we use an on-stack buffer to translate '\n' into '\r\n'.  So instead, do this translation into an intermediate buffer, which is in the kernel image and thus below 4GB, then pass that to the PROM console write calls.  On the 32-bit side we don't have to deal with any of these issues, so the new prom_console_write_buf() uses the existing prom_nbputchar() implementation.  However we can now mark those routines static.  Since the 64-bit side completely uses new code we can delete the putchar bits as they are now completely unused.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | init_32.c | s | 1.7K | 61 | Joe Perches | joe@perches.com | 1307487994 |  | sparc: Remove unnecessary semicolons  Semicolons are not necessary after switch/while/for/if braces so remove them.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bootstr_64.c | s | 1.0K | 36 | Sam Ravnborg | sam@ravnborg.org | 1228411037 |  | sparc,sparc64: unify prom/  - all files with identical names copied and renamed to *_64.c - the remaning files copied as is - added sparc64 specific files to sparc/prom/Makefile - teach sparc64 Makefile to look into sparc/prom/ - delete unused Makefile from sparc64/prom/  linking order was not kept for sparc64 with this change. It was not possible to keep linking order for both sparc and sparc64 and as sparc64 see more testing than sparc it was natural to break linking order on sparc64. Should it have any effect it would be detected sooner this way.  printf_32.c and printf_64.c are obvious candidates to be merged but they are not 100% equal so that was left for later  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | p1275.c | s | 1.2K | 45 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | mp.c | s | 988B | 37 | Joe Perches | joe@perches.com | 1307487994 |  | sparc: Remove unnecessary semicolons  Semicolons are not necessary after switch/while/for/if braces so remove them.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | tree_64.c | s | 8.0K | 322 | Andres Salomon | dilinger@queued.net | 1294110126 |  | sparc: explicitly cast negative phandle checks to s32  When we switched sparc from using 'int's to 'phandle's (which is a u32), we neglected to do anything with the various checks for -1.  For those tests, explicitly cast the phandles to s32.  Signed-off-by: Andres Salomon <dilinger@queued.net> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | cif.S | g | 989B |  | David S. Miller | davem@davemloft.net | 1282630257 |  | sparc64: Get rid of indirect p1275 PROM call buffer.  This is based upon a report by Meelis Roos showing that it's possible that we'll try to fetch a property that is 32K in size with some devices.  With the current fixed 3K buffer we use for moving data in and out of the firmware during PROM calls, that simply won't work.  In fact, it will scramble random kernel data during bootup.  The reasoning behind the temporary buffer is entirely historical.  It used to be the case that we had problems referencing dynamic kernel memory (including the stack) early in the boot process before we explicitly told the firwmare to switch us over to the kernel trap table.  So what we did was always give the firmware buffers that were locked into the main kernel image.  But we no longer have problems like that, so get rid of all of this indirect bounce buffering.  Besides fixing Meelis's bug, this also makes the kernel data about 3K smaller.  It was also discovered during these conversions that the implementation of prom_retain() was completely wrong, so that was fixed here as well.  Currently that interface is not in use.  Reported-by: Meelis Roos <mroos@linux.ee> Tested-by: Meelis Roos <mroos@linux.ee> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bootstr_32.c | s | 1.2K | 54 | Sam Ravnborg | sam@ravnborg.org | 1294085712 |  | sparc: fix sparse warnings in arch/sparc/prom for 32 bit build  Fix following sparse warnings: arch/sparc/prom/bootstr_32.c:32:35: warning: Using plain integer as NULL pointer arch/sparc/prom/memory.c:61:13: warning: symbol 'prom_meminit' was not declared. Should it be static? arch/sparc/prom/misc_32.c:74:1: error: symbol 'prom_halt' redeclared with different type (originally declared at arch/sparc/include/asm/oplib_32.h:67) - different modifiers arch/sparc/prom/ranges.c:16:26: warning: symbol 'promlib_obio_ranges' was not declared. Should it be static? arch/sparc/prom/ranges.c:17:5: warning: symbol 'num_obio_ranges' was not declared. Should it be static? arch/sparc/prom/ranges.c:39:1: warning: symbol 'prom_adjust_ranges' was not declared. Should it be static? arch/sparc/prom/ranges.c:69:13: warning: symbol 'prom_ranges_init' was not declared. Should it be static? arch/sparc/prom/tree_32.c:286:22: warning: Using plain integer as NULL pointer arch/sparc/prom/tree_32.c:286:38: warning: Using plain integer as NULL pointer  None of the warnings indicated any serious issues.  We are now sparse clean for 32 bit build in arch/sparc/prom.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
