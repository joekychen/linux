<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › sparc › include › asm › traps.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>traps.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * traps.h:  Format of entries for the Sparc trap table.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1995 David S. Miller (davem@caip.rutgers.edu)</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _SPARC_TRAPS_H</span>
<span class="cp">#define _SPARC_TRAPS_H</span>

<span class="cp">#define NUM_SPARC_TRAPS  255</span>

<span class="cp">#ifndef __ASSEMBLY__</span>
<span class="cp">#ifdef __KERNEL__</span>
<span class="cm">/* This is for V8 compliant Sparc CPUS */</span>
<span class="k">struct</span> <span class="n">tt_entry</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">inst_one</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">inst_two</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">inst_three</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">inst_four</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* We set this to _start in system setup. */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">tt_entry</span> <span class="o">*</span><span class="n">sparc_ttable</span><span class="p">;</span>

<span class="cp">#endif </span><span class="cm">/* (__KERNEL__) */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* !(__ASSEMBLY__) */</span><span class="cp"></span>

<span class="cm">/* For patching the trap table at boot time, we need to know how to</span>
<span class="cm"> * form various common Sparc instructions.  Thus these macros...</span>
<span class="cm"> */</span>

<span class="cp">#define SPARC_MOV_CONST_L3(const) (0xa6102000 | (const&amp;0xfff))</span>

<span class="cm">/* The following assumes that the branch lies before the place we</span>
<span class="cm"> * are branching to.  This is the case for a trap vector...</span>
<span class="cm"> * You have been warned.</span>
<span class="cm"> */</span>
<span class="cp">#define SPARC_BRANCH(dest_addr, inst_addr) \</span>
<span class="cp">          (0x10800000 | (((dest_addr-inst_addr)&gt;&gt;2)&amp;0x3fffff))</span>

<span class="cp">#define SPARC_RD_PSR_L0  (0xa1480000)</span>
<span class="cp">#define SPARC_RD_WIM_L3  (0xa7500000)</span>
<span class="cp">#define SPARC_NOP (0x01000000)</span>

<span class="cm">/* Various interesting trap levels. */</span>
<span class="cm">/* First, hardware traps. */</span>
<span class="cp">#define SP_TRAP_TFLT    0x1          </span><span class="cm">/* Text fault */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_II      0x2          </span><span class="cm">/* Illegal Instruction */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_PI      0x3          </span><span class="cm">/* Privileged Instruction */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_FPD     0x4          </span><span class="cm">/* Floating Point Disabled */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_WOVF    0x5          </span><span class="cm">/* Window Overflow */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_WUNF    0x6          </span><span class="cm">/* Window Underflow */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_MNA     0x7          </span><span class="cm">/* Memory Address Unaligned */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_FPE     0x8          </span><span class="cm">/* Floating Point Exception */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_DFLT    0x9          </span><span class="cm">/* Data Fault */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_TOF     0xa          </span><span class="cm">/* Tag Overflow */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_WDOG    0xb          </span><span class="cm">/* Watchpoint Detected */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ1    0x11         </span><span class="cm">/* IRQ level 1 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ2    0x12         </span><span class="cm">/* IRQ level 2 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ3    0x13         </span><span class="cm">/* IRQ level 3 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ4    0x14         </span><span class="cm">/* IRQ level 4 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ5    0x15         </span><span class="cm">/* IRQ level 5 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ6    0x16         </span><span class="cm">/* IRQ level 6 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ7    0x17         </span><span class="cm">/* IRQ level 7 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ8    0x18         </span><span class="cm">/* IRQ level 8 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ9    0x19         </span><span class="cm">/* IRQ level 9 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ10   0x1a         </span><span class="cm">/* IRQ level 10 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ11   0x1b         </span><span class="cm">/* IRQ level 11 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ12   0x1c         </span><span class="cm">/* IRQ level 12 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ13   0x1d         </span><span class="cm">/* IRQ level 13 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ14   0x1e         </span><span class="cm">/* IRQ level 14 */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IRQ15   0x1f         </span><span class="cm">/* IRQ level 15 Non-maskable */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_RACC    0x20         </span><span class="cm">/* Register Access Error ??? */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IACC    0x21         </span><span class="cm">/* Instruction Access Error */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_CPDIS   0x24         </span><span class="cm">/* Co-Processor Disabled */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_BADFL   0x25         </span><span class="cm">/* Unimplemented Flush Instruction */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_CPEXP   0x28         </span><span class="cm">/* Co-Processor Exception */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_DACC    0x29         </span><span class="cm">/* Data Access Error */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_DIVZ    0x2a         </span><span class="cm">/* Divide By Zero */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_DSTORE  0x2b         </span><span class="cm">/* Data Store Error ??? */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_DMM     0x2c         </span><span class="cm">/* Data Access MMU Miss ??? */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IMM     0x3c         </span><span class="cm">/* Instruction Access MMU Miss ??? */</span><span class="cp"></span>

<span class="cm">/* Now the Software Traps... */</span>
<span class="cp">#define SP_TRAP_SUNOS   0x80         </span><span class="cm">/* SunOS System Call */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_SBPT    0x81         </span><span class="cm">/* Software Breakpoint */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_SDIVZ   0x82         </span><span class="cm">/* Software Divide-by-Zero trap */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_FWIN    0x83         </span><span class="cm">/* Flush Windows */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_CWIN    0x84         </span><span class="cm">/* Clean Windows */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_RCHK    0x85         </span><span class="cm">/* Range Check */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_FUNA    0x86         </span><span class="cm">/* Fix Unaligned Access */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_IOWFL   0x87         </span><span class="cm">/* Integer Overflow */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_SOLARIS 0x88         </span><span class="cm">/* Solaris System Call */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_NETBSD  0x89         </span><span class="cm">/* NetBSD System Call */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_LINUX   0x90         </span><span class="cm">/* Linux System Call */</span><span class="cp"></span>

<span class="cm">/* Names used for compatibility with SunOS */</span>
<span class="cp">#define ST_SYSCALL              0x00</span>
<span class="cp">#define ST_BREAKPOINT           0x01</span>
<span class="cp">#define ST_DIV0                 0x02</span>
<span class="cp">#define ST_FLUSH_WINDOWS        0x03</span>
<span class="cp">#define ST_CLEAN_WINDOWS        0x04</span>
<span class="cp">#define ST_RANGE_CHECK          0x05</span>
<span class="cp">#define ST_FIX_ALIGN            0x06</span>
<span class="cp">#define ST_INT_OVERFLOW         0x07</span>

<span class="cm">/* Special traps... */</span>
<span class="cp">#define SP_TRAP_KBPT1   0xfe         </span><span class="cm">/* KADB/PROM Breakpoint one */</span><span class="cp"></span>
<span class="cp">#define SP_TRAP_KBPT2   0xff         </span><span class="cm">/* KADB/PROM Breakpoint two */</span><span class="cp"></span>

<span class="cm">/* Handy Macros */</span>
<span class="cm">/* Is this a trap we never expect to get? */</span>
<span class="cp">#define BAD_TRAP_P(level) \</span>
<span class="cp">        ((level &gt; SP_TRAP_WDOG &amp;&amp; level &lt; SP_TRAP_IRQ1) || \</span>
<span class="cp">	 (level &gt; SP_TRAP_IACC &amp;&amp; level &lt; SP_TRAP_CPDIS) || \</span>
<span class="cp">	 (level &gt; SP_TRAP_BADFL &amp;&amp; level &lt; SP_TRAP_CPEXP) || \</span>
<span class="cp">	 (level &gt; SP_TRAP_DMM &amp;&amp; level &lt; SP_TRAP_IMM) || \</span>
<span class="cp">	 (level &gt; SP_TRAP_IMM &amp;&amp; level &lt; SP_TRAP_SUNOS) || \</span>
<span class="cp">	 (level &gt; SP_TRAP_LINUX &amp;&amp; level &lt; SP_TRAP_KBPT1))</span>

<span class="cm">/* Is this a Hardware trap? */</span>
<span class="cp">#define HW_TRAP_P(level) ((level &gt; 0) &amp;&amp; (level &lt; SP_TRAP_SUNOS))</span>

<span class="cm">/* Is this a Software trap? */</span>
<span class="cp">#define SW_TRAP_P(level) ((level &gt;= SP_TRAP_SUNOS) &amp;&amp; (level &lt;= SP_TRAP_KBPT2))</span>

<span class="cm">/* Is this a system call for some OS we know about? */</span>
<span class="cp">#define SCALL_TRAP_P(level) ((level == SP_TRAP_SUNOS) || \</span>
<span class="cp">			     (level == SP_TRAP_SOLARIS) || \</span>
<span class="cp">			     (level == SP_TRAP_NETBSD) || \</span>
<span class="cp">			     (level == SP_TRAP_LINUX))</span>

<span class="cp">#endif </span><span class="cm">/* !(_SPARC_TRAPS_H) */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
