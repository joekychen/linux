<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › sparc › include › asm › head_64.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>head_64.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _SPARC64_HEAD_H</span>
<span class="cp">#define _SPARC64_HEAD_H</span>

<span class="cp">#include &lt;asm/pstate.h&gt;</span>

	<span class="cm">/* wrpr	%g0, val, %gl */</span>
<span class="cp">#define SET_GL(val)	\</span>
<span class="cp">	.word	0xa1902000 | val</span>

	<span class="cm">/* rdpr %gl, %gN */</span>
<span class="cp">#define GET_GL_GLOBAL(N)	\</span>
<span class="cp">	.word	0x81540000 | (N &lt;&lt; 25)</span>

<span class="cp">#define KERNBASE	0x400000</span>

<span class="cp">#define	PTREGS_OFF	(STACK_BIAS + STACKFRAME_SZ)</span>

<span class="cp">#define __CHEETAH_ID	0x003e0014</span>
<span class="cp">#define __JALAPENO_ID	0x003e0016</span>
<span class="cp">#define __SERRANO_ID	0x003e0022</span>

<span class="cp">#define CHEETAH_MANUF		0x003e</span>
<span class="cp">#define CHEETAH_IMPL		0x0014 </span><span class="cm">/* Ultra-III   */</span><span class="cp"></span>
<span class="cp">#define CHEETAH_PLUS_IMPL	0x0015 </span><span class="cm">/* Ultra-III+  */</span><span class="cp"></span>
<span class="cp">#define JALAPENO_IMPL		0x0016 </span><span class="cm">/* Ultra-IIIi  */</span><span class="cp"></span>
<span class="cp">#define JAGUAR_IMPL		0x0018 </span><span class="cm">/* Ultra-IV    */</span><span class="cp"></span>
<span class="cp">#define PANTHER_IMPL		0x0019 </span><span class="cm">/* Ultra-IV+   */</span><span class="cp"></span>
<span class="cp">#define SERRANO_IMPL		0x0022 </span><span class="cm">/* Ultra-IIIi+ */</span><span class="cp"></span>

<span class="cp">#define BRANCH_IF_SUN4V(tmp1,label)		\</span>
<span class="cp">	sethi	%hi(is_sun4v), %tmp1;		\</span>
<span class="cp">	lduw	[%tmp1 + %lo(is_sun4v)], %tmp1; \</span>
<span class="cp">	brnz,pn	%tmp1, label;			\</span>
<span class="cp">	 nop</span>

<span class="cp">#define BRANCH_IF_CHEETAH_BASE(tmp1,tmp2,label)	\</span>
<span class="cp">	rdpr	%ver, %tmp1;			\</span>
<span class="cp">	sethi	%hi(__CHEETAH_ID), %tmp2;	\</span>
<span class="cp">	srlx	%tmp1, 32, %tmp1;		\</span>
<span class="cp">	or	%tmp2, %lo(__CHEETAH_ID), %tmp2;\</span>
<span class="cp">	cmp	%tmp1, %tmp2;			\</span>
<span class="cp">	be,pn	%icc, label;			\</span>
<span class="cp">	 nop;</span>

<span class="cp">#define BRANCH_IF_JALAPENO(tmp1,tmp2,label)	\</span>
<span class="cp">	rdpr	%ver, %tmp1;			\</span>
<span class="cp">	sethi	%hi(__JALAPENO_ID), %tmp2;	\</span>
<span class="cp">	srlx	%tmp1, 32, %tmp1;		\</span>
<span class="cp">	or	%tmp2, %lo(__JALAPENO_ID), %tmp2;\</span>
<span class="cp">	cmp	%tmp1, %tmp2;			\</span>
<span class="cp">	be,pn	%icc, label;			\</span>
<span class="cp">	 nop;</span>

<span class="cp">#define BRANCH_IF_CHEETAH_PLUS_OR_FOLLOWON(tmp1,tmp2,label)	\</span>
<span class="cp">	rdpr	%ver, %tmp1;			\</span>
<span class="cp">	srlx	%tmp1, (32 + 16), %tmp2;	\</span>
<span class="cp">	cmp	%tmp2, CHEETAH_MANUF;		\</span>
<span class="cp">	bne,pt	%xcc, 99f;			\</span>
<span class="cp">	 sllx	%tmp1, 16, %tmp1;		\</span>
<span class="cp">	srlx	%tmp1, (32 + 16), %tmp2;	\</span>
<span class="cp">	cmp	%tmp2, CHEETAH_PLUS_IMPL;	\</span>
<span class="cp">	bgeu,pt	%xcc, label;			\</span>
<span class="cp">99:	 nop;</span>

<span class="cp">#define BRANCH_IF_ANY_CHEETAH(tmp1,tmp2,label)	\</span>
<span class="cp">	rdpr	%ver, %tmp1;			\</span>
<span class="cp">	srlx	%tmp1, (32 + 16), %tmp2;	\</span>
<span class="cp">	cmp	%tmp2, CHEETAH_MANUF;		\</span>
<span class="cp">	bne,pt	%xcc, 99f;			\</span>
<span class="cp">	 sllx	%tmp1, 16, %tmp1;		\</span>
<span class="cp">	srlx	%tmp1, (32 + 16), %tmp2;	\</span>
<span class="cp">	cmp	%tmp2, CHEETAH_IMPL;		\</span>
<span class="cp">	bgeu,pt	%xcc, label;			\</span>
<span class="cp">99:	 nop;</span>

<span class="cp">#endif </span><span class="cm">/* !(_SPARC64_HEAD_H) */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
