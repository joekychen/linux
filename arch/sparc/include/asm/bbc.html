<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › sparc › include › asm › bbc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>bbc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * bbc.h: Defines for BootBus Controller found on UltraSPARC-III</span>
<span class="cm"> *        systems.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2000 David S. Miller (davem@redhat.com)</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _SPARC64_BBC_H</span>
<span class="cp">#define _SPARC64_BBC_H</span>

<span class="cm">/* Register sizes are indicated by &quot;B&quot; (Byte, 1-byte),</span>
<span class="cm"> * &quot;H&quot; (Half-word, 2 bytes), &quot;W&quot; (Word, 4 bytes) or</span>
<span class="cm"> * &quot;Q&quot; (Quad, 8 bytes) inside brackets.</span>
<span class="cm"> */</span>

<span class="cp">#define BBC_AID		0x00	</span><span class="cm">/* [B] Agent ID			*/</span><span class="cp"></span>
<span class="cp">#define BBC_DEVP	0x01	</span><span class="cm">/* [B] Device Present		*/</span><span class="cp"></span>
<span class="cp">#define BBC_ARB		0x02	</span><span class="cm">/* [B] Arbitration		*/</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE	0x03	</span><span class="cm">/* [B] Quiesce			*/</span><span class="cp"></span>
<span class="cp">#define BBC_WDACTION	0x04	</span><span class="cm">/* [B] Watchdog Action		*/</span><span class="cp"></span>
<span class="cp">#define BBC_SPG		0x06	</span><span class="cm">/* [B] Soft POR Gen		*/</span><span class="cp"></span>
<span class="cp">#define BBC_SXG		0x07	</span><span class="cm">/* [B] Soft XIR Gen		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC	0x08	</span><span class="cm">/* [W] POR Source		*/</span><span class="cp"></span>
<span class="cp">#define BBC_XSRC	0x0c	</span><span class="cm">/* [B] XIR Source		*/</span><span class="cp"></span>
<span class="cp">#define BBC_CSC		0x0d	</span><span class="cm">/* [B] Clock Synthesizers Control*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_CTRL	0x0e	</span><span class="cm">/* [H] Energy Star Control	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_ACT	0x10	</span><span class="cm">/* [W] E* Assert Change Time	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_DACT	0x14	</span><span class="cm">/* [B] E* De-Assert Change Time	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_DABT	0x15	</span><span class="cm">/* [B] E* De-Assert Bypass Time	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_ABT	0x16	</span><span class="cm">/* [H] E* Assert Bypass Time	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_PST	0x18	</span><span class="cm">/* [W] E* PLL Settle Time	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_FSL	0x1c	</span><span class="cm">/* [W] E* Frequency Switch Latency*/</span><span class="cp"></span>
<span class="cp">#define BBC_EBUST	0x20	</span><span class="cm">/* [Q] EBUS Timing		*/</span><span class="cp"></span>
<span class="cp">#define BBC_JTAG_CMD	0x28	</span><span class="cm">/* [W] JTAG+ Command		*/</span><span class="cp"></span>
<span class="cp">#define BBC_JTAG_CTRL	0x2c	</span><span class="cm">/* [B] JTAG+ Control		*/</span><span class="cp"></span>
<span class="cp">#define BBC_I2C_SEL	0x2d	</span><span class="cm">/* [B] I2C Selection		*/</span><span class="cp"></span>
<span class="cp">#define BBC_I2C_0_S1	0x2e	</span><span class="cm">/* [B] I2C ctrlr-0 reg S1	*/</span><span class="cp"></span>
<span class="cp">#define BBC_I2C_0_S0	0x2f	</span><span class="cm">/* [B] I2C ctrlr-0 regs S0,S0&#39;,S2,S3*/</span><span class="cp"></span>
<span class="cp">#define BBC_I2C_1_S1	0x30	</span><span class="cm">/* [B] I2C ctrlr-1 reg S1	*/</span><span class="cp"></span>
<span class="cp">#define BBC_I2C_1_S0	0x31	</span><span class="cm">/* [B] I2C ctrlr-1 regs S0,S0&#39;,S2,S3*/</span><span class="cp"></span>
<span class="cp">#define BBC_KBD_BEEP	0x32	</span><span class="cm">/* [B] Keyboard Beep		*/</span><span class="cp"></span>
<span class="cp">#define BBC_KBD_BCNT	0x34	</span><span class="cm">/* [W] Keyboard Beep Counter	*/</span><span class="cp"></span>

<span class="cp">#define BBC_REGS_SIZE	0x40</span>

<span class="cm">/* There is a 2K scratch ram area at offset 0x80000 but I doubt</span>
<span class="cm"> * we will use it for anything.</span>
<span class="cm"> */</span>

<span class="cm">/* Agent ID register.  This register shows the Safari Agent ID</span>
<span class="cm"> * for the processors.  The value returned depends upon which</span>
<span class="cm"> * cpu is reading the register.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_AID_ID	0x07	</span><span class="cm">/* Safari ID		*/</span><span class="cp"></span>
<span class="cp">#define BBC_AID_RESV	0xf8	</span><span class="cm">/* Reserved		*/</span><span class="cp"></span>

<span class="cm">/* Device Present register.  One can determine which cpus are actually</span>
<span class="cm"> * present in the machine by interrogating this register.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_DEVP_CPU0	0x01	</span><span class="cm">/* Processor 0 present	*/</span><span class="cp"></span>
<span class="cp">#define BBC_DEVP_CPU1	0x02	</span><span class="cm">/* Processor 1 present	*/</span><span class="cp"></span>
<span class="cp">#define BBC_DEVP_CPU2	0x04	</span><span class="cm">/* Processor 2 present	*/</span><span class="cp"></span>
<span class="cp">#define BBC_DEVP_CPU3	0x08	</span><span class="cm">/* Processor 3 present	*/</span><span class="cp"></span>
<span class="cp">#define BBC_DEVP_RESV	0xf0	</span><span class="cm">/* Reserved		*/</span><span class="cp"></span>

<span class="cm">/* Arbitration register.  This register is used to block access to</span>
<span class="cm"> * the BBC from a particular cpu.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_ARB_CPU0	0x01	</span><span class="cm">/* Enable cpu 0 BBC arbitratrion */</span><span class="cp"></span>
<span class="cp">#define BBC_ARB_CPU1	0x02	</span><span class="cm">/* Enable cpu 1 BBC arbitratrion */</span><span class="cp"></span>
<span class="cp">#define BBC_ARB_CPU2	0x04	</span><span class="cm">/* Enable cpu 2 BBC arbitratrion */</span><span class="cp"></span>
<span class="cp">#define BBC_ARB_CPU3	0x08	</span><span class="cm">/* Enable cpu 3 BBC arbitratrion */</span><span class="cp"></span>
<span class="cp">#define BBC_ARB_RESV	0xf0	</span><span class="cm">/* Reserved			 */</span><span class="cp"></span>

<span class="cm">/* Quiesce register.  Bus and BBC segments for cpus can be disabled</span>
<span class="cm"> * with this register, ie. for hot plugging.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_QUIESCE_S02	0x01	</span><span class="cm">/* Quiesce Safari segment for cpu 0 and 2 */</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE_S13	0x02	</span><span class="cm">/* Quiesce Safari segment for cpu 1 and 3 */</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE_B02	0x04	</span><span class="cm">/* Quiesce BBC segment for cpu 0 and 2    */</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE_B13	0x08	</span><span class="cm">/* Quiesce BBC segment for cpu 1 and 3    */</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE_FD0 0x10	</span><span class="cm">/* Disable Fatal_Error[0] reporting	  */</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE_FD1 0x20	</span><span class="cm">/* Disable Fatal_Error[1] reporting	  */</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE_FD2 0x40	</span><span class="cm">/* Disable Fatal_Error[2] reporting	  */</span><span class="cp"></span>
<span class="cp">#define BBC_QUIESCE_FD3 0x80	</span><span class="cm">/* Disable Fatal_Error[3] reporting	  */</span><span class="cp"></span>

<span class="cm">/* Watchdog Action register.  When the watchdog device timer expires</span>
<span class="cm"> * a line is enabled to the BBC.  The action BBC takes when this line</span>
<span class="cm"> * is asserted can be controlled by this regiser.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_WDACTION_RST  0x01	</span><span class="cm">/* When set, watchdog causes system reset.</span>
<span class="cm">				 * When clear, BBC ignores watchdog signal.</span>
<span class="cm">				 */</span><span class="cp"></span>
<span class="cp">#define BBC_WDACTION_RESV 0xfe	</span><span class="cm">/* Reserved */</span><span class="cp"></span>

<span class="cm">/* Soft_POR_GEN register.  The POR (Power On Reset) signal may be asserted</span>
<span class="cm"> * for specific processors or all processors via this register.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_SPG_CPU0	0x01 </span><span class="cm">/* Assert POR for processor 0	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SPG_CPU1	0x02 </span><span class="cm">/* Assert POR for processor 1	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SPG_CPU2	0x04 </span><span class="cm">/* Assert POR for processor 2	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SPG_CPU3	0x08 </span><span class="cm">/* Assert POR for processor 3	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SPG_CPUALL	0x10 </span><span class="cm">/* Reset all processors and reset</span>
<span class="cm">			      * the entire system.</span>
<span class="cm">			      */</span><span class="cp"></span>
<span class="cp">#define BBC_SPG_RESV	0xe0 </span><span class="cm">/* Reserved			*/</span><span class="cp"></span>

<span class="cm">/* Soft_XIR_GEN register.  The XIR (eXternally Initiated Reset) signal</span>
<span class="cm"> * may be asserted to specific processors via this register.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_SXG_CPU0	0x01 </span><span class="cm">/* Assert XIR for processor 0	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SXG_CPU1	0x02 </span><span class="cm">/* Assert XIR for processor 1	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SXG_CPU2	0x04 </span><span class="cm">/* Assert XIR for processor 2	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SXG_CPU3	0x08 </span><span class="cm">/* Assert XIR for processor 3	*/</span><span class="cp"></span>
<span class="cp">#define BBC_SXG_RESV	0xf0 </span><span class="cm">/* Reserved			*/</span><span class="cp"></span>

<span class="cm">/* POR Source register.  One may identify the cause of the most recent</span>
<span class="cm"> * reset by reading this register.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_PSRC_SPG0	0x0001 </span><span class="cm">/* CPU 0 reset via BBC_SPG register	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_SPG1	0x0002 </span><span class="cm">/* CPU 1 reset via BBC_SPG register	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_SPG2	0x0004 </span><span class="cm">/* CPU 2 reset via BBC_SPG register	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_SPG3	0x0008 </span><span class="cm">/* CPU 3 reset via BBC_SPG register	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_SPGSYS	0x0010 </span><span class="cm">/* System reset via BBC_SPG register	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_JTAG	0x0020 </span><span class="cm">/* System reset via JTAG+		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_BUTTON	0x0040 </span><span class="cm">/* System reset via push-button dongle	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_PWRUP	0x0080 </span><span class="cm">/* System reset via power-up		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_FE0	0x0100 </span><span class="cm">/* CPU 0 reported Fatal_Error		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_FE1	0x0200 </span><span class="cm">/* CPU 1 reported Fatal_Error		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_FE2	0x0400 </span><span class="cm">/* CPU 2 reported Fatal_Error		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_FE3	0x0800 </span><span class="cm">/* CPU 3 reported Fatal_Error		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_FE4	0x1000 </span><span class="cm">/* Schizo reported Fatal_Error		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_FE5	0x2000 </span><span class="cm">/* Safari device 5 reported Fatal_Error	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_FE6	0x4000 </span><span class="cm">/* CPMS reported Fatal_Error		*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_SYNTH	0x8000 </span><span class="cm">/* System reset when on-board clock synthesizers</span>
<span class="cm">				* were updated.</span>
<span class="cm">				*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_WDT   0x10000 </span><span class="cm">/* System reset via Super I/O watchdog	*/</span><span class="cp"></span>
<span class="cp">#define BBC_PSRC_RSC   0x20000 </span><span class="cm">/* System reset via RSC remote monitoring</span>
<span class="cm">				* device</span>
<span class="cm">				*/</span><span class="cp"></span>

<span class="cm">/* XIR Source register.  The source of an XIR event sent to a processor may</span>
<span class="cm"> * be determined via this register.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_XSRC_SXG0	0x01	</span><span class="cm">/* CPU 0 received XIR via Soft_XIR_GEN reg */</span><span class="cp"></span>
<span class="cp">#define BBC_XSRC_SXG1	0x02	</span><span class="cm">/* CPU 1 received XIR via Soft_XIR_GEN reg */</span><span class="cp"></span>
<span class="cp">#define BBC_XSRC_SXG2	0x04	</span><span class="cm">/* CPU 2 received XIR via Soft_XIR_GEN reg */</span><span class="cp"></span>
<span class="cp">#define BBC_XSRC_SXG3	0x08	</span><span class="cm">/* CPU 3 received XIR via Soft_XIR_GEN reg */</span><span class="cp"></span>
<span class="cp">#define BBC_XSRC_JTAG	0x10	</span><span class="cm">/* All CPUs received XIR via JTAG+         */</span><span class="cp"></span>
<span class="cp">#define BBC_XSRC_W_OR_B	0x20	</span><span class="cm">/* All CPUs received XIR either because:</span>
<span class="cm">				 * a) Super I/O watchdog fired, or</span>
<span class="cm">				 * b) XIR push button was activated</span>
<span class="cm">				 */</span><span class="cp"></span>
<span class="cp">#define BBC_XSRC_RESV	0xc0	</span><span class="cm">/* Reserved				   */</span><span class="cp"></span>

<span class="cm">/* Clock Synthesizers Control register.  This register provides the big-bang</span>
<span class="cm"> * programming interface to the two clock synthesizers of the machine.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_CSC_SLOAD	0x01	</span><span class="cm">/* Directly connected to S_LOAD pins	*/</span><span class="cp"></span>
<span class="cp">#define BBC_CSC_SDATA	0x02	</span><span class="cm">/* Directly connected to S_DATA pins	*/</span><span class="cp"></span>
<span class="cp">#define BBC_CSC_SCLOCK	0x04	</span><span class="cm">/* Directly connected to S_CLOCK pins	*/</span><span class="cp"></span>
<span class="cp">#define BBC_CSC_RESV	0x78	</span><span class="cm">/* Reserved				*/</span><span class="cp"></span>
<span class="cp">#define BBC_CSC_RST	0x80	</span><span class="cm">/* Generate system reset when S_LOAD==1	*/</span><span class="cp"></span>

<span class="cm">/* Energy Star Control register.  This register is used to generate the</span>
<span class="cm"> * clock frequency change trigger to the main system devices (Schizo and</span>
<span class="cm"> * the processors).  The transition occurs when bits in this register</span>
<span class="cm"> * go from 0 to 1, only one bit must be set at once else no action</span>
<span class="cm"> * occurs.  Basically the sequence of events is:</span>
<span class="cm"> * a) Choose new frequency: full, 1/2 or 1/32</span>
<span class="cm"> * b) Program this desired frequency into the cpus and Schizo.</span>
<span class="cm"> * c) Set the same value in this register.</span>
<span class="cm"> * d) 16 system clocks later, clear this register.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_ES_CTRL_1_1		0x01	</span><span class="cm">/* Full frequency	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_CTRL_1_2		0x02	</span><span class="cm">/* 1/2 frequency	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_CTRL_1_32	0x20	</span><span class="cm">/* 1/32 frequency	*/</span><span class="cp"></span>
<span class="cp">#define BBC_ES_RESV		0xdc	</span><span class="cm">/* Reserved		*/</span><span class="cp"></span>

<span class="cm">/* Energy Star Assert Change Time register.  This determines the number</span>
<span class="cm"> * of BBC clock cycles (which is half the system frequency) between</span>
<span class="cm"> * the detection of FREEZE_ACK being asserted and the assertion of</span>
<span class="cm"> * the CLK_CHANGE_L[2:0] signals.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_ES_ACT_VAL	0xff</span>

<span class="cm">/* Energy Star Assert Bypass Time register.  This determines the number</span>
<span class="cm"> * of BBC clock cycles (which is half the system frequency) between</span>
<span class="cm"> * the assertion of the CLK_CHANGE_L[2:0] signals and the assertion of</span>
<span class="cm"> * the ESTAR_PLL_BYPASS signal.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_ES_ABT_VAL	0xffff</span>

<span class="cm">/* Energy Star PLL Settle Time register.  This determines the number of</span>
<span class="cm"> * BBC clock cycles (which is half the system frequency) between the</span>
<span class="cm"> * de-assertion of CLK_CHANGE_L[2:0] and the de-assertion of the FREEZE_L</span>
<span class="cm"> * signal.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_ES_PST_VAL	0xffffffff</span>

<span class="cm">/* Energy Star Frequency Switch Latency register.  This is the number of</span>
<span class="cm"> * BBC clocks between the de-assertion of CLK_CHANGE_L[2:0] and the first</span>
<span class="cm"> * edge of the Safari clock at the new frequency.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_ES_FSL_VAL	0xffffffff</span>

<span class="cm">/* Keyboard Beep control register.  This is a simple enabler for the audio</span>
<span class="cm"> * beep sound.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_KBD_BEEP_ENABLE	0x01 </span><span class="cm">/* Enable beep	*/</span><span class="cp"></span>
<span class="cp">#define BBC_KBD_BEEP_RESV	0xfe </span><span class="cm">/* Reserved	*/</span><span class="cp"></span>

<span class="cm">/* Keyboard Beep Counter register.  There is a free-running counter inside</span>
<span class="cm"> * the BBC which runs at half the system clock.  The bit set in this register</span>
<span class="cm"> * determines when the audio sound is generated.  So for example if bit</span>
<span class="cm"> * 10 is set, the audio beep will oscillate at 1/(2**12).  The keyboard beep</span>
<span class="cm"> * generator automatically selects a different bit to use if the system clock</span>
<span class="cm"> * is changed via Energy Star.</span>
<span class="cm"> */</span>
<span class="cp">#define BBC_KBD_BCNT_BITS	0x0007fc00</span>
<span class="cp">#define BBC_KBC_BCNT_RESV	0xfff803ff</span>

<span class="cp">#endif </span><span class="cm">/* _SPARC64_BBC_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
