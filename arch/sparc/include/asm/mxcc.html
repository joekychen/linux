<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › sparc › include › asm › mxcc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>mxcc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * mxcc.h:  Definitions of the Viking MXCC registers</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1995 David S. Miller (davem@caip.rutgers.edu)</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _SPARC_MXCC_H</span>
<span class="cp">#define _SPARC_MXCC_H</span>

<span class="cm">/* These registers are accessed through ASI 0x2. */</span>
<span class="cp">#define MXCC_DATSTREAM       0x1C00000  </span><span class="cm">/* Data stream register */</span><span class="cp"></span>
<span class="cp">#define MXCC_SRCSTREAM       0x1C00100  </span><span class="cm">/* Source stream register */</span><span class="cp"></span>
<span class="cp">#define MXCC_DESSTREAM       0x1C00200  </span><span class="cm">/* Destination stream register */</span><span class="cp"></span>
<span class="cp">#define MXCC_RMCOUNT         0x1C00300  </span><span class="cm">/* Count of references and misses */</span><span class="cp"></span>
<span class="cp">#define MXCC_STEST           0x1C00804  </span><span class="cm">/* Internal self-test */</span><span class="cp"></span>
<span class="cp">#define MXCC_CREG            0x1C00A04  </span><span class="cm">/* Control register */</span><span class="cp"></span>
<span class="cp">#define MXCC_SREG            0x1C00B00  </span><span class="cm">/* Status register */</span><span class="cp"></span>
<span class="cp">#define MXCC_RREG            0x1C00C04  </span><span class="cm">/* Reset register */</span><span class="cp"></span>
<span class="cp">#define MXCC_EREG            0x1C00E00  </span><span class="cm">/* Error code register */</span><span class="cp"></span>
<span class="cp">#define MXCC_PREG            0x1C00F04  </span><span class="cm">/* Address port register */</span><span class="cp"></span>

<span class="cm">/* Some MXCC constants. */</span>
<span class="cp">#define MXCC_STREAM_SIZE     0x20       </span><span class="cm">/* Size in bytes of one stream r/w */</span><span class="cp"></span>

<span class="cm">/* The MXCC Control Register:</span>
<span class="cm"> *</span>
<span class="cm"> * ----------------------------------------------------------------------</span>
<span class="cm"> * |                                   | RRC | RSV |PRE|MCE|PARE|ECE|RSV|</span>
<span class="cm"> * ----------------------------------------------------------------------</span>
<span class="cm"> *  31                              10    9    8-6   5   4    3   2  1-0</span>
<span class="cm"> *</span>
<span class="cm"> * RRC: Controls what you read from MXCC_RMCOUNT reg.</span>
<span class="cm"> *      0=Misses 1=References</span>
<span class="cm"> * PRE: Prefetch enable</span>
<span class="cm"> * MCE: Multiple Command Enable</span>
<span class="cm"> * PARE: Parity enable</span>
<span class="cm"> * ECE: External cache enable</span>
<span class="cm"> */</span>

<span class="cp">#define MXCC_CTL_RRC   0x00000200</span>
<span class="cp">#define MXCC_CTL_PRE   0x00000020</span>
<span class="cp">#define MXCC_CTL_MCE   0x00000010</span>
<span class="cp">#define MXCC_CTL_PARE  0x00000008</span>
<span class="cp">#define MXCC_CTL_ECE   0x00000004</span>

<span class="cm">/* The MXCC Error Register:</span>
<span class="cm"> *</span>
<span class="cm"> * --------------------------------------------------------</span>
<span class="cm"> * |ME| RSV|CE|PEW|PEE|ASE|EIV| MOPC|ECODE|PRIV|RSV|HPADDR|</span>
<span class="cm"> * --------------------------------------------------------</span>
<span class="cm"> *  31   30 29  28  27  26  25 24-15  14-7   6  5-3   2-0</span>
<span class="cm"> *</span>
<span class="cm"> * ME: Multiple Errors have occurred</span>
<span class="cm"> * CE: Cache consistency Error</span>
<span class="cm"> * PEW: Parity Error during a Write operation</span>
<span class="cm"> * PEE: Parity Error involving the External cache</span>
<span class="cm"> * ASE: ASynchronous Error</span>
<span class="cm"> * EIV: This register is toast</span>
<span class="cm"> * MOPC: MXCC Operation Code for instance causing error</span>
<span class="cm"> * ECODE: The Error CODE</span>
<span class="cm"> * PRIV: A privileged mode error? 0=no 1=yes</span>
<span class="cm"> * HPADDR: High PhysicalADDRess bits (35-32)</span>
<span class="cm"> */</span>

<span class="cp">#define MXCC_ERR_ME     0x80000000</span>
<span class="cp">#define MXCC_ERR_CE     0x20000000</span>
<span class="cp">#define MXCC_ERR_PEW    0x10000000</span>
<span class="cp">#define MXCC_ERR_PEE    0x08000000</span>
<span class="cp">#define MXCC_ERR_ASE    0x04000000</span>
<span class="cp">#define MXCC_ERR_EIV    0x02000000</span>
<span class="cp">#define MXCC_ERR_MOPC   0x01FF8000</span>
<span class="cp">#define MXCC_ERR_ECODE  0x00007F80</span>
<span class="cp">#define MXCC_ERR_PRIV   0x00000040</span>
<span class="cp">#define MXCC_ERR_HPADDR 0x0000000f</span>

<span class="cm">/* The MXCC Port register:</span>
<span class="cm"> *</span>
<span class="cm"> * -----------------------------------------------------</span>
<span class="cm"> * |                | MID |                            |</span>
<span class="cm"> * -----------------------------------------------------</span>
<span class="cm"> *  31            21 20-18 17                         0</span>
<span class="cm"> *</span>
<span class="cm"> * MID: The moduleID of the cpu your read this from.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">mxcc_set_stream_src</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">paddr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data0</span> <span class="o">=</span> <span class="n">paddr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data1</span> <span class="o">=</span> <span class="n">paddr</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

	<span class="n">__asm__</span> <span class="n">__volatile__</span> <span class="p">(</span><span class="s">&quot;or %%g0, %0, %%g2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			      <span class="s">&quot;or %%g0, %1, %%g3</span><span class="se">\n\t</span><span class="s">&quot;</span>
			      <span class="s">&quot;stda %%g2, [%2] %3</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="o">:</span>
			      <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">data0</span><span class="p">),</span> <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">data1</span><span class="p">),</span>
			      <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">MXCC_SRCSTREAM</span><span class="p">),</span>
			      <span class="s">&quot;i&quot;</span> <span class="p">(</span><span class="n">ASI_M_MXCC</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;g2&quot;</span><span class="p">,</span> <span class="s">&quot;g3&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">mxcc_set_stream_dst</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">paddr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data0</span> <span class="o">=</span> <span class="n">paddr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data1</span> <span class="o">=</span> <span class="n">paddr</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

	<span class="n">__asm__</span> <span class="n">__volatile__</span> <span class="p">(</span><span class="s">&quot;or %%g0, %0, %%g2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			      <span class="s">&quot;or %%g0, %1, %%g3</span><span class="se">\n\t</span><span class="s">&quot;</span>
			      <span class="s">&quot;stda %%g2, [%2] %3</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="o">:</span>
			      <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">data0</span><span class="p">),</span> <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">data1</span><span class="p">),</span>
			      <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">MXCC_DESSTREAM</span><span class="p">),</span>
			      <span class="s">&quot;i&quot;</span> <span class="p">(</span><span class="n">ASI_M_MXCC</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;g2&quot;</span><span class="p">,</span> <span class="s">&quot;g3&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">mxcc_get_creg</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mxcc_control</span><span class="p">;</span>

	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span><span class="s">&quot;set 0xffffffff, %%g2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			     <span class="s">&quot;set 0xffffffff, %%g3</span><span class="se">\n\t</span><span class="s">&quot;</span>
			     <span class="s">&quot;stda %%g2, [%1] %2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			     <span class="s">&quot;lda [%3] %2, %0</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span>
			     <span class="s">&quot;=r&quot;</span> <span class="p">(</span><span class="n">mxcc_control</span><span class="p">)</span> <span class="o">:</span>
			     <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">MXCC_EREG</span><span class="p">),</span> <span class="s">&quot;i&quot;</span> <span class="p">(</span><span class="n">ASI_M_MXCC</span><span class="p">),</span>
			     <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">MXCC_CREG</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;g2&quot;</span><span class="p">,</span> <span class="s">&quot;g3&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">mxcc_control</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">mxcc_set_creg</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mxcc_control</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span><span class="s">&quot;sta %0, [%1] %2</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="o">:</span>
			     <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">mxcc_control</span><span class="p">),</span> <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">MXCC_CREG</span><span class="p">),</span>
			     <span class="s">&quot;i&quot;</span> <span class="p">(</span><span class="n">ASI_M_MXCC</span><span class="p">));</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* !__ASSEMBLY__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* !(_SPARC_MXCC_H) */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
