f | io.h | s | 581B | 18 | Jan Andersson | jan@gaisler.com | 1305233069 |  | sparc: add {read,write}*_be routines  This patch adds {read,write}*_be big endian memory access routines to the io.h header used on SPARC32 and SPARC64.  Tested on SPARC32 (LEON)  Signed-off-by: Jan Andersson <jan@gaisler.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | kmap_types.h | s | 194B | 7 | Randy Dunlap | randy.dunlap@oracle.com | 1245206871 |  | kmap_types: make most arches use generic header file  Convert most arches to use asm-generic/kmap_types.h.  Move the KM_FENCE_ macro additions into asm-generic/kmap_types.h, controlled by __WITH_KM_FENCE from each arch's kmap_types.h file.  Would be nice to be able to add custom KM_types per arch, but I don't yet see a nice, clean way to do that.  Built on x86_64, i386, mips, sparc, alpha(tonyb), powerpc(tonyb), and 68k(tonyb).  Note: avr32 should be able to remove KM_PTE2 (since it's not used) and then just use the generic kmap_types.h file.  Get avr32 maintainer approval.  Signed-off-by: Randy Dunlap <randy.dunlap@oracle.com> Cc: <linux-arch@vger.kernel.org> Acked-by: Mike Frysinger <vapier@gentoo.org> Cc: Richard Henderson <rth@twiddle.net> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: Bryan Wu <cooloney@kernel.org> Cc: Mikael Starvik <starvik@axis.com> Cc: Hirokazu Takata <takata@linux-m32r.org> Cc: "Luck Tony" <tony.luck@intel.com> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: David Howells <dhowells@redhat.com> Cc: Kyle McMartin <kyle@mcmartin.ca> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Cc: "David S. Miller" <davem@davemloft.net> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: Arnd Bergmann <arnd@arndb.de> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bitext.h | s | 613B | 22 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | kvm_para.h | s | 34B | 1 | Eric B Munson | emunson@mgebm.net | 1333878539 |  | kvmclock: Add functions to check if the host has stopped the vm  When a host stops or suspends a VM it will set a flag to show this.  The watchdog will use these functions to determine if a softlockup is real, or the result of a suspended VM.  Signed-off-by: Eric B Munson <emunson@mgebm.net> asm-generic changes Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | tlb_32.h | s | 481B | 18 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | psrcompat.h | s | 2.0K | 39 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | sfafsr.h | s | 3.1K | 73 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | switch_to_32.h | s | 3.5K | 98 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | atomic_32.h | s | 2.1K | 47 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | compat.h | s | 5.0K | 210 | Eric W. Biederman | ebiederm@xmission.com | 1319806733 |  | compat: sync compat_stats with statfs.  This was found by inspection while tracking a similar bug in compat_statfs64, that has been fixed in mainline since decemeber.  - This fixes a bug where not all of the f_spare fields   were cleared on mips and s390. - Add the f_flags field to struct compat_statfs - Copy f_flags to userspace in case someone cares. - Use __clear_user to copy the f_spare field to userspace   to ensure that all of the elements of f_spare are cleared.   On some architectures f_spare is has 5 ints and on some   architectures f_spare only has 4 ints.  Which makes   the previous technique of clearing each int individually   broken.  I don't expect anyone actually uses the old statfs system call anymore but if they do let them benefit from having the compat and the native version working the same.  Signed-off-by: Eric W. Biederman <ebiederm@xmission.com> Signed-off-by: Christoph Hellwig <hch@lst.de>
f | pci.h | s | 210B | 9 | FUJITA Tomonori | fujita.tomonori@lab.ntt.co.jp | 1268437962 |  | pci-dma: add linux/pci-dma.h to linux/pci.h  All the architectures properly set NEED_DMA_MAP_STATE now so we can safely add linux/pci-dma.h to linux/pci.h and remove the linux/pci-dma.h inclusion in arch's asm/pci.h  Signed-off-by: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp> Acked-by: Arnd Bergmann <arnd@arndb.de> Cc: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sbi.h | s | 3.3K | 95 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | sections.h | s | 250B | 9 | Sam Ravnborg | sam@ravnborg.org | 1338187963 |  | sparc32: add support for run-time patching of leon/sun single instructions  This will be used to handle that MMUREGS has different ASI for SUN and LEON. This is the infrastructure only - users will come later.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Konrad Eisele <konrad@gaisler.com>
f | auxio_32.h | s | 2.5K | 71 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | cputime.h | s | 118B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pbm.h | s | 1.4K | 41 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pgtable_64.h | s | 24K | 682 | David S. Miller | davem@davemloft.net | 1336940596 |  | sparc: Kill mmu_{un,}lockarea().  These were used on sun4c during floppy data transfers since on that chip we had to lock the cpu mappings into the TLB because we cannot take a TLB miss during the assembler floppy interrupt handler that does the data transfer.  That is no longer necessary since we've removed sun4c support, thus this stuff can disappear completely.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | mmu_32.h | s | 170B | 7 | Sam Ravnborg | sam@ravnborg.org | 1300324748 |  | sparc32: add irq + smp declarations to headers  In preparation for cleaning up a number of files add declarations for irq and smp related data/functions to the relevant headers.  This showed that the extern declaration of cputypval differed in the two files where it was used. As cputypval is defined like this:  cputypval:         .asciz "sun4c"  the correct representation is a char array. Fix users to use the new declaration.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cmpxchg_64.h | s | 3.4K | 122 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | head.h | s | 172B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | agp.h | s | 395B | 12 | David Woodhouse | David.Woodhouse@intel.com | 1249286700 |  | agp: kill phys_to_gart() and gart_to_phys()  There seems to be no reason for these -- they're a 1:1 mapping on all platforms.  Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | chafsr.h | s | 9.4K | 195 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | delay_64.h | s | 378B | 12 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | barrier.h | s | 184B | 8 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | machines.h | s | 1.5K | 42 | David S. Miller | davem@davemloft.net | 1336808145 |  | sparc32: Trivial removal of sun4c references in comments.  I left some around, like the ones in the openprom headers, since we need to think about which pieces of those datastructures and code we can completely toss now.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | leon_amba.h | s | 8.0K | 225 | Sam Ravnborg | sam@ravnborg.org | 1338187966 |  | sparc32,leon: always include leon_kernel in build  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Konrad Eisele <konrad@gaisler.com>
f | oplib_64.h | s | 8.4K | 191 | David S. Miller | davem@davemloft.net | 1292194673 |  | sparc: Eliminate prom_stdin.  Completely unused.  Based upon a patch by Julian Calaby.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | kdebug_64.h | s | 311B | 17 | David S. Miller | davem@davemloft.net | 1233302633 |  | sparc64: Implement NMI watchdog on capable cpus.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | checksum_64.h | s | 4.3K | 149 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | iommu_32.h | s | 5.6K | 107 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | ecc.h | s | 4.3K | 112 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | delay.h | s | 176B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pcic.h | s | 5.8K | 121 | Daniel Hellstrom | daniel@gaisler.com | 1307050357 |  | sparc32: added CONFIG_PCIC_PCI Kconfig setting  Signed-off-by: Daniel Hellstrom <daniel@gaisler.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mmzone.h | s | 354B | 10 | KAMEZAWA Hiroyuki | kamezawa.hiroyu@jp.fujitsu.com | 1309209189 |  | Fix node_start/end_pfn() definition for mm/page_cgroup.c  commit 21a3c96 uses node_start/end_pfn(nid) for detection start/end of nodes. But, it's not defined in linux/mmzone.h but defined in /arch/???/include/mmzone.h which is included only under CONFIG_NEED_MULTIPLE_NODES=y.  Then, we see   mm/page_cgroup.c: In function 'page_cgroup_init':   mm/page_cgroup.c:308: error: implicit declaration of function 'node_start_pfn'   mm/page_cgroup.c:309: error: implicit declaration of function 'node_end_pfn'  So, fixiing page_cgroup.c is an idea...  But node_start_pfn()/node_end_pfn() is a very generic macro and should be implemented in the same manner for all archs. (m32r has different implementation...)  This patch removes definitions of node_start/end_pfn() in each archs and defines a unified one in linux/mmzone.h. It's not under CONFIG_NEED_MULTIPLE_NODES, now.  A result of macro expansion is here (mm/page_cgroup.c)  for !NUMA  start_pfn = ((&contig_page_data)->node_start_pfn);   end_pfn = ({ pg_data_t *__pgdat = (&contig_page_data); __pgdat->node_start_pfn + __pgdat->node_spanned_pages;});  for NUMA (x86-64)   start_pfn = ((node_data[nid])->node_start_pfn);   end_pfn = ({ pg_data_t *__pgdat = (node_data[nid]); __pgdat->node_start_pfn + __pgdat->node_spanned_pages;});  Changelog:  - fixed to avoid using "nid" twice in node_end_pfn() macro.  Reported-and-acked-by: Randy Dunlap <randy.dunlap@oracle.com> Reported-and-tested-by: Ingo Molnar <mingo@elte.hu> Acked-by: Mel Gorman <mgorman@suse.de> Signed-off-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | hvtramp.h | s | 750B | 28 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | cachetlb_32.h | s | 843B | 24 | David S. Miller | davem@davemloft.net | 1336967371 |  | sparc32: Move cache and TLB flushes over to method ops.  This eliminated most of the remaining users of btfixup.  There are some complications because of the special cases we have for sun4d, leon, and some flavors of viking.  It was found that there are no cases where a flush_page_for_dma method was not hooked up to something, so the "noflush" iommu methods were removed.  Add some documentation to the viking_sun4d_smp_ops to describe exactly the hardware bug which causes us to need special TLB flushing on sun4d.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | io_64.h | s | 13K | 438 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | mmu_context_32.h | s | 1.0K | 27 | Sam Ravnborg | sam@ravnborg.org | 1337029509 |  | sparc32: remove runtime btfix support  - remove all uses of btfixup header - remove the btfixup header - remove the btfixup code  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | intr_queue.h | s | 755B | 12 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | lsu.h | s | 1023B | 16 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | irqflags_32.h | s | 1.0K | 37 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | traps.h | s | 5.4K | 115 | Sam Ravnborg | sam@ravnborg.org | 1230960785 |  | sparc: drop get_tbr() in traps.h  get_tbr() has no users in the whole tree -drop it.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cacheflush.h | s | 334B | 10 | Sam Ravnborg | sam@ravnborg.org | 1337546016 |  | sparc32: use flushi when run-time patching in per_cpu_patch  Davis S. Miller wrote: " The way we do that now is overkill.  We only needed to use the MMU cache ops when we had sun4c around because sun4c lacked support for the "flush" instruction.  But all sun4m and later chips have it so we can use it unconditionally.  So in the per_cpu_patch() code, get rid of the cache ops invocation, and instead execute a "flush %reg" after each of the instruction patch assignments, where %reg is set to the address of the instruction that was stored into.  Perhaps take the flushi() definition from asm/cacheflush_64.h and place it into asm/cacheflush.h, then you can simply use that. "  Implemented as per suggestion. Moved run-time patching before we call paging_init(), so helper methods in paging_init() may utilise run-time patching too.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ide.h | s | 2.2K | 82 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pgalloc_64.h | s | 2.9K | 101 | David S. Miller | davem@davemloft.net | 1311652630 |  | sparc64: use RCU page table freeing  Make use of the generic RCU page table freeing on Sparc64, doing so allows for race-free software page-table walkers like gup_fast().  Signed-off-by: David S. Miller <davem@davemloft.net> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | timer.h | s | 176B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | stacktrace.h | s | 134B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | current.h | s | 952B | 30 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | thread_info_32.h | s | 4.0K | 117 | Al Viro | viro@zeniv.linux.org.uk | 1338569930 |  | TIF_RESTORE_SIGMASK can be set only when TIF_SIGPENDING is set  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | seccomp.h | s | 408B | 11 | Roland McGrath | roland@redhat.com | 1236037290 |  | x86-64: seccomp: fix 32/64 syscall hole  On x86-64, a 32-bit process (TIF_IA32) can switch to 64-bit mode with ljmp, and then use the "syscall" instruction to make a 64-bit system call.  A 64-bit process make a 32-bit system call with int $0x80.  In both these cases under CONFIG_SECCOMP=y, secure_computing() will use the wrong system call number table.  The fix is simple: test TS_COMPAT instead of TIF_IA32.  Here is an example exploit:  	/* test case for seccomp circumvention on x86-64  	   There are two failure modes: compile with -m64 or compile with -m32.  	   The -m64 case is the worst one, because it does "chmod 777 ." (could 	   be any chmod call).  The -m32 case demonstrates it was able to do 	   stat(), which can glean information but not harm anything directly.  	   A buggy kernel will let the test do something, print, and exit 1; a 	   fixed kernel will make it exit with SIGKILL before it does anything. 	*/  	#define _GNU_SOURCE 	#include <assert.h> 	#include <inttypes.h> 	#include <stdio.h> 	#include <linux/prctl.h> 	#include <sys/stat.h> 	#include <unistd.h> 	#include <asm/unistd.h>  	int 	main (int argc, char **argv) 	{ 	  char buf[100]; 	  static const char dot[] = "."; 	  long ret; 	  unsigned st[24];  	  if (prctl (PR_SET_SECCOMP, 1, 0, 0, 0) != 0) 	    perror ("prctl(PR_SET_SECCOMP) -- not compiled into kernel?");  	#ifdef __x86_64__ 	  assert ((uintptr_t) dot < (1UL << 32)); 	  asm ("int $0x80 # %0 <- %1(%2 %3)" 	       : "=a" (ret) : "0" (15), "b" (dot), "c" (0777)); 	  ret = snprintf (buf, sizeof buf, 			  "result %ld (check mode on .!)\n", ret); 	#elif defined __i386__ 	  asm (".code32\n" 	       "pushl %%cs\n" 	       "pushl $2f\n" 	       "ljmpl $0x33, $1f\n" 	       ".code64\n" 	       "1: syscall # %0 <- %1(%2 %3)\n" 	       "lretl\n" 	       ".code32\n" 	       "2:" 	       : "=a" (ret) : "0" (4), "D" (dot), "S" (&st)); 	  if (ret == 0) 	    ret = snprintf (buf, sizeof buf, 			    "stat . -> st_uid=%u\n", st[7]); 	  else 	    ret = snprintf (buf, sizeof buf, "result %ld\n", ret); 	#else 	# error "not this one" 	#endif  	  write (1, buf, ret);  	  syscall (__NR_exit, 1); 	  return 2; 	}  Signed-off-by: Roland McGrath <roland@redhat.com> [ I don't know if anybody actually uses seccomp, but it's enabled in   at least both Fedora and SuSE kernels, so maybe somebody is. - Linus ] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fpumacro.h | s | 671B | 24 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | auxio_64.h | s | 3.2K | 88 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | hypervisor.h | s | 97K | 2784 | David S. Miller | davem@davemloft.net | 1312345732 |  | sparc: Set reboot-cmd using reboot data hypervisor call if available.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | obio.h | s | 6.2K | 187 | Sam Ravnborg | sam@ravnborg.org | 1337029507 |  | sparc32: move smp ipi to method ops  I ended up renaming set_cpu_int to send_ipi to be consistent all way around. send_ipi was moved to the *_smp.c files so we could call the relevant method direct, without any _ops indirection.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | elf.h | s | 168B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | btext.h | s | 113B | 4 | David S. Miller | davem@davemloft.net | 1259372023 |  | sparc64: Faster early-boot framebuffer console.  Borrow the powerpc bootx text console driver.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | serial.h | s | 117B | 4 | David Miller | davem@davemloft.net | 1223916700 |  | serial: allow 8250 to be used on sparc  This requires three changes:  1) Remove !SPARC restriction in Kconfig.  2) Move Sparc specific serial drivers before 8250, so that serial    console devices don't change names on us, even if 8250 finds    devices.  3) Since the Sparc specific serial drivers try to use the    same major/minor device namespace as 8250, some coordination    is necessary.  Use the sunserial_*() layer routines to allocate    minor number space within TTY_MAJOR when CONFIG_SPARC.     This has no effect on other platforms.  Thanks to Josip Rodin for bringing up this issue and testing plus debugging various revisions of this patch.  Signed-off-by: David S. Miller <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Alan Cox <alan@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | shmparam_64.h | s | 267B | 7 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | resource.h | s | 707B | 25 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | tlb.h | s | 168B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | io_32.h | s | 9.3K | 297 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | percpu_64.h | s | 476B | 14 | David S. Miller | davem@davemloft.net | 1245153383 |  | sparc64: Get rid of real_setup_per_cpu_areas().  Now that we defer the cpu_data() initializations to the end of per-cpu setup, we can get rid of this local hack we had to setup the per-cpu areas eary.  This is a necessary step in order to support HAVE_DYNAMIC_PER_CPU_AREA since the per-cpu setup must run when page structs are available.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | mc146818rtc_32.h | s | 660B | 24 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | unaligned.h | s | 300B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | oplib_32.h | s | 6.1K | 137 | Sam Ravnborg | sam@ravnborg.org | 1336789664 |  | sparc32: drop sun4c support  Machines with sun4c support are very rare these days, and noone is using them for any practical purposes. The sun4c support has been know broken for quite some time too.  So rather than trying to keep it up-to-date, lets get rid of it. This allows us to do some very welcome cleanup of sparc32 support.  Updated the former sun4c specifc nmi (which was also used for sun4m UP) to be a generic UP NMI.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cpudata_64.h | s | 1.0K | 34 | David S. Miller | davem@davemloft.net | 1271137027 |  | sparc64: Use a seperate counter for timer interrupts and NMI checks, like x86.  This keeps us from having to use kstat_irqs_cpu() from the NMI handler, the former of which is a profiled function.  Instead we use a currently empty slot in the cpu_data  Signed-off-by: David S. Miller <davem@davemloft.net>
f | cpudata.h | s | 184B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | sfp-machine_64.h | s | 3.1K | 77 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | winmacro.h | s | 4.6K | 114 | David S. Miller | davem@davemloft.net | 1337027498 |  | sparc32: Implement hard_smp_processor_id() via instruction patching.  This is the last non-trivial user of btfixup.  Like sparc64, use a special patch section to resolve the various implementations of how to read the current CPU's ID when we don't have current_thread_info()->cpu necessarily available.  Signed-off-by: David S. Miller <davem@davemloft.net> Tested-by: Sam Ravnborg <sam@ravnborg.org>
f | termios.h | s | 5.5K | 169 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103854 |  | sparc: remove several unnecessary module.h include instances  Building an allyesconfig doesn't reveal a hidden need for any of these.  Since module.h brings in the whole kitchen sink, it just needlessly adds 30k+ lines to the cpp burden.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | ttable.h | s | 19K | 617 | David S. Miller | davem@davemloft.net | 1228411023 |  | sparc64: Make special trap return path for TRAP_NMI().  We don't want the rtrap path to try and run softirqs or anything like that when returning from a PIL==15 NMI.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | watchdog.h | s | 966B | 25 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | page_32.h | s | 4.0K | 113 | Sam Ravnborg | sam@ravnborg.org | 1337029509 |  | sparc32: remove runtime btfix support  - remove all uses of btfixup header - remove the btfixup header - remove the btfixup code  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | smp_64.h | s | 1.4K | 49 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | openpromio.h | s | 2.1K | 56 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | bitsperlong.h | s | 261B | 9 | Arnd Bergmann | arnd@arndb.de | 1244746934 |  | asm-generic: introduce asm/bitsperlong.h  This provides a reliable way for asm-generic/types.h and other files to find out if it is running on a 32 or 64 bit platform.  We cannot use CONFIG_64BIT for this in headers that are included from user space because CONFIG symbols are not available there. We also cannot do it inside of asm/types.h because some headers need the word size but cannot include types.h.  The solution is to introduce a new header <asm/bitsperlong.h> that defines both __BITS_PER_LONG for user space and BITS_PER_LONG for usage in the kernel. The asm-generic version falls back to 32 bit unless the architecture overrides it, which I did for all 64 bit platforms.  Signed-off-by: Remis Lima Baima <remis.developer@googlemail.com> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | leon.h | s | 7.5K | 219 | Sam Ravnborg | sam@ravnborg.org | 1338320858 |  | sparc: fix sparc64 build due to leon.h inclusion  Stephen Rothwell <sfr@canb.auug.org.au> reported following error: In file included from arch/sparc/kernel/prom_common.c:26:0: arch/sparc/include/asm/leon.h:221:9: error: unknown type name 'irq_flow_handler_t' arch/sparc/include/asm/leon.h:224:10: error: unknown type name 'irq_flow_handler_t'  Fix this by: 1) Avoid including leon.h in prom_commen.h (not needed) 2) Include irq.h in leon.h to avoid the missing symbol error  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ioctls.h | s | 5.6K | 131 | Kay Sievers | kay.sievers@vrfy.org | 1297980990 |  | tty: add TIOCVHANGUP to allow clean tty shutdown of all ttys  This is useful for system management software so that it can kick off things like gettys and everything that's started from a tty, before we reuse it from/for something else or shut it down.  Without this ioctl it would have to temporarily become the owner of the tty, then call vhangup() and then give it up again.  Cc: Lennart Poettering <lennart@poettering.net> Signed-off-by: Kay Sievers <kay.sievers@vrfy.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | vaddrs.h | s | 1.5K | 38 | David S. Miller | davem@davemloft.net | 1336794711 |  | sparc32: Kill SUN4C_LOCK_{VADDR,END} and associated comment.  No longer used.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | smp.h | s | 168B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | elf_32.h | s | 3.2K | 111 | David S. Miller | davem@davemloft.net | 1337102520 |  | sparc32: Remove cypress cpu support.  It's the one aberration in v8, the only cpu that didn't actually have hardware multiply and divide instructions.  Signed-off-by: David S. Miller <davem@davemloft.net> Acked-by: Sam Ravnborg <sam@ravnborg.org>
f | siginfo.h | s | 662B | 21 | David Howells | dhowells@redhat.com | 1323698075 |  | UAPI: Don't include linux/compat.h in sparc's asm/siginfo.h  Don't include linux/compat.h in sparc's asm/siginfo.h as it leads to a circular dependency:  	asm/siginfo.h -> linux/compat.h -> asm/siginfo.h  Signed-off-by: David Howells <dhowells@redhat.com> cc: David S. Miller <davem@davemloft.net> cc: sparclinux@vger.kernel.org
f | visasm.h | s | 1.5K | 53 | David S. Miller | davem@davemloft.net | 1221202000 |  | sparc64: Fix sparse warnings in visemul.c  1) edge8 tables should be static 2) add vis_emul() extern decl. to asm/visasm.h  Signed-off-by: David S. Miller <davem@davemloft.net>
f | oplib.h | s | 176B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | dma-mapping.h | s | 2.0K | 61 | Sam Ravnborg | sam@ravnborg.org | 1338187973 |  | sparc32,leon: always support leon in ioport  Unconditially define pci32_dma_ops as this is used for leon.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Konrad Eisele <konrad@gaisler.com>
f | starfire.h | s | 449B | 15 | David S. Miller | davem@davemloft.net | 1220172012 |  | sparc64: Delete starfire_cpu_setup().  It does nothing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | scratchpad.h | s | 508B | 11 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | swift.h | s | 3.0K | 90 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | smp_32.h | s | 3.4K | 103 | David S. Miller | davem@davemloft.net | 1337030637 |  | sparc32: Kill unused hard_smp{4m,4d,leon}_processor_id() inlined.  Reported-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | irq_32.h | s | 456B | 16 | Sam Ravnborg | sam@ravnborg.org | 1303276300 |  | sparc32: genirq support  The conversion of sparc32 to genirq is based on original work done by David S. Miller. Daniel Hellstrom has helped in the conversion and implemented the shutdowm functionality. Marcel van Nies <morcles@gmail.com> has tested this on Sparc Station 20  Test status: sun4c      - not tested sun4m,pci  - not tested sun4m,sbus - tested (Sparc Classic, Sparc Station 5, Sparc Station 20) sun4d      - not tested leon       - tested on various combinations of leon boards,              including SMP variants  generic    Introduce use of GENERIC_HARDIRQS and GENERIC_IRQ_SHOW    Allocate 64 IRQs - which is enough even for SS2000    Use a table of irq_bucket to maintain uses IRQs       irq_bucket is also used to chain several irq's that       must be called when the same intrrupt is asserted    Use irq_link to link a interrupt source to the irq    All plafforms must now supply their own build_device_irq method    handler_irq rewriten to use generic irq support  floppy    Read FLOPPY_IRQ from platform device    Use generic request_irq to register the floppy interrupt    Rewrote sparc_floppy_irq to use the generic irq support  pcic:    Introduce irq_chip    Store mask in chip_data for use in mask/unmask functions    Add build_device_irq for pcic    Use pcic_build_device_irq in pci_time_init    allocate virtual irqs in pcic_fill_irq  sun4c:    Introduce irq_chip    Store mask in chip_data for use in mask/unmask functions    Add build_device_irq for sun4c    Use sun4c_build_device_irq in sun4c_init_timers  sun4m:    Introduce irq_chip    Introduce dedicated mask/unmask methods    Introduce sun4m_handler_data that allow easy access to necessary      data in the mask/unmask functions    Add a helper method to enable profile_timer (used from smp)    Added sun4m_build_device_irq    Use sun4m_build_device_irq in sun4m_init_timers     TODO:       There is no replacement for smp_rotate that always scheduled       next CPU as interrupt target upon an interrupt  sun4d:    Introduce irq_chip    Introduce dedicated mask/unmask methods    Introduce sun4d_handler_data that allow easy access to    necessary data in mask/unmask fuctions    Rewrote sun4d_handler_irq to use generic irq support     TODO:       The original implmentation of enable/disable had:            if (irq < NR_IRQS)                return;        The new implmentation does not distingush between SBUS and cpu       interrupts.       I am no sure what is right here. I assume we need to do       something for the cpu interrupts.        I have not succeeded booting my sun4d box (with or without this patch)       and my understanding of this platfrom is limited.       So I would be a bit suprised if this works.  leon:    Introduce irq_chip    Store mask in chip_data for use in mask/unmask functions    Add build_device_irq for leon    Use leon_build_device_irq in leon_init_timers  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Acked-by: Daniel Hellstrom <daniel@gaisler.com> Tested-by: Daniel Hellstrom <daniel@gaisler.com> Tested-by: Marcel van Nies <morcles@gmail.com> Cc: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | prom.h | s | 2.2K | 57 | Grant Likely | grant.likely@secretlab.ca | 1330300086 |  | irq_domain: Centralize definition of irq_dispose_mapping()  Several architectures define their own empty irq_dispose_mapping().  Since the irq_domain code is centralized now, there is little need to do so.  This patch removes them and creates a new empty copy when !CONFIG_IRQ_DOMAIN is selected.  The patch also means that IRQ_DOMAIN becomes selectable on all architectures.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Cc: Rob Herring <rob.herring@calxeda.com> Cc: "David S. Miller" <davem@davemloft.net> Cc: Jonas Bonn <jonas@southpole.se> Cc: sparclinux@vger.kernel.org Cc: linux@lists.openrisc.net
f | spinlock_64.h | s | 4.4K | 190 | Mikael Pettersson | mikpe@it.uu.se | 1313444118 |  | sparc64: remove unnecessary macros from spinlock_64.h  The sparc64 spinlock_64.h contains a number of operations defined first as static inline functions, and then as macros with the same names and parameters as the functions.  Maybe this was needed at some point in the past, but now nothing seems to depend on these macros (checked with a recursive grep looking for ifdefs on these names).  Other archs don't define these identity-macros.  So this patch deletes these unnecessary macros.  Compile-tested with sparc64_defconfig.  Signed-off-by: Mikael Pettersson <mikpe@it.uu.se> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cpudata_32.h | s | 687B | 26 | Tkhai Kirill | tkhai@yandex.ru | 1334510930 |  | sparc32: generic clockevent support  The kernel uses l14 timers as clockevents. l10 timer is used as clocksource if platform master_l10_counter isn't constantly zero. The clocksource is continuous, so it's possible to use high resolution timers. l10 timer is also used as clockevent on UP configurations.  This realization is for sun4m, sun4d, sun4c, microsparc-IIep and LEON platforms. The appropriate LEON changes was made by Konrad Eisele.  In case of sun4m's oneshot mode, profile irq is zeroed in smp4m_percpu_timer_interrupt(). It is maybe needless (double, triple etc overflow does nothing).  sun4d is able to have oneshot mode too, but I haven't any way to test it. So code of its percpu timer handler is made as much equal to the current code as possible.  The patch is tested on sun4m box in SMP mode by me, and tested by Konrad on leon in up mode (leon smp is broken atm - due to other reasons).  Signed-off-by: Tkhai Kirill <tkhai@yandex.ru> Tested-by: Konrad Eisele <konrad@gaisler.com> [leon up] [sam: revised patch to provide generic support for leon] Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | contregs.h | s | 1.9K | 28 | David S. Miller | davem@davemloft.net | 1336796957 |  | sparc32: Remove sun4{,c} control reg definitions from contregs.h.  No longer used.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | bugs.h | s | 365B | 14 | David S. Miller | davem@davemloft.net | 1220341778 |  | sparc64: Implement SSTATE purely using notifiers and initcalls.  Don't clutter up the tree with sstate_blah() scattered all over the place.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | tsunami.h | s | 1.8K | 57 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | floppy_64.h | s | 18K | 647 | David S. Miller | davem@davemloft.net | 1337054365 |  | sparc64: Remove pointless assignment in floppy support.  Reported-by: Josip Rodin <joy@entuzijast.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | types.h | s | 498B | 13 | Al Viro | viro@zeniv.linux.org.uk | 1325649317 |  | consolidate umode_t declarations  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | tsb.h | s | 8.4K | 254 | David S. Miller | davem@davemloft.net | 1312530837 |  | sparc: Access kernel TSB using physical addressing when possible.  On sun4v this is basically required since we point the hypervisor and the TSB walking hardware at these tables using physical addressing too.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | shmparam_32.h | s | 214B | 6 | David S. Miller | davem@davemloft.net | 1336807403 |  | sparc32: Remove sun4 and sun4c from enum sparc_cpu.  All the remaining references are trivially removed since we've just eliminated the final reference to sparc_cpu_model from assembler code in commit b7d96ce189564e661909fbf8df39d7358149885b ("sparc32: Remove sparc_cpu_model read from floppy interrupt handler.")  Signed-off-by: David S. Miller <davem@davemloft.net>
f | timer_32.h | s | 1.2K | 33 | Sam Ravnborg | sam@ravnborg.org | 1337029509 |  | sparc32: remove runtime btfix support  - remove all uses of btfixup header - remove the btfixup header - remove the btfixup code  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | clock.h | s | 231B | 9 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | kdebug.h | s | 180B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | hw_irq.h | s | 88B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | xor_64.h | s | 2.6K | 65 | David S. Miller | davem@davemloft.net | 1316208093 |  | sparc64: Future proof Niagara cpu detection.  Recognize T4 and T5 chips.  Treating them both as "T2 plus other stuff" should be extremely safe and make sure distributions will work when those chips actually ship to customers.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | vio.h | s | 9.2K | 346 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1332894804 |  | powerpc+sparc/vio: Modernize driver registration  This makes vio_register_driver() get the module owner & name at compile time like PCI drivers do, and adds a name pointer directly in struct vio_driver to avoid having to explicitly initialize the embedded struct device.  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Acked-by: David S. Miller <davem@davemloft.net>
f | sparsemem.h | s | 249B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | bitops.h | s | 180B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | uaccess_32.h | s | 10K | 272 | David Miller | davem@davemloft.net | 1338057234 |  | sparc: use the new generic strnlen_user() function  This throws away the sparc-specific functions in favor of the generic optimized version.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dma.h | s | 6.6K | 128 | David S. Miller | davem@davemloft.net | 1336942625 |  | sparc32: Convert mmu_* interfaces from btfixup to method ops.  This set of changes displays one major danger of btfixup, interface signatures are not always type checked fully.  As seen here the iounit variant of the map_dma_area routine had an incorrect type for one of it's arguments.  It turns out to be harmless in this case, but just imagine trying to debug something involving this kind of problem.  No thanks.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | mdesc.h | s | 2.4K | 62 | David S. Miller | davem@davemloft.net | 1245153381 |  | sparc64: Make mdesc_fill_in_cpu_data take a cpumask_t pointer.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | checksum.h | s | 188B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | setup.h | s | 685B | 29 | David S. Miller | davem@davemloft.net | 1337489108 |  | sparc32: Remove unused empty_bad_page{,_table} declarations.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | errno.h | s | 5.4K | 108 | Huang Ying | ying.huang@intel.com | 1300378107 |  | mm: make __get_user_pages return -EHWPOISON for HWPOISON page optionally  Make __get_user_pages return -EHWPOISON for HWPOISON page only if FOLL_HWPOISON is specified.  With this patch, the interested callers can distinguish HWPOISON pages from general FAULT pages, while other callers will still get -EFAULT for all these pages, so the user space interface need not to be changed.  This feature is needed by KVM, where UCR MCE should be relayed to guest for HWPOISON page, while instruction emulation and MMIO will be tried for general FAULT page.  The idea comes from Andrew Morton.  Signed-off-by: Huang Ying <ying.huang@intel.com> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Avi Kivity <avi@redhat.com>
f | tlbflush_64.h | s | 1.2K | 35 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1306337953 |  | sparc: mmu_gather rework  Rework the sparc mmu_gather usage to conform to the new world order :-)  Sparc mmu_gather does two things:  - tracks vaddrs to unhash  - tracks pages to free  Split these two things like powerpc has done and keep the vaddrs in per-cpu data structures and flush them on context switch.  The remaining bits can then use the generic mmu_gather.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Acked-by: David Miller <davem@davemloft.net> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Jeff Dike <jdike@addtoit.com> Cc: Richard Weinberger <richard@nod.at> Cc: Tony Luck <tony.luck@intel.com> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Hugh Dickins <hughd@google.com> Cc: Mel Gorman <mel@csn.ul.ie> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Nick Piggin <npiggin@kernel.dk> Cc: Namhyung Kim <namhyung@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | kprobes.h | s | 1.2K | 38 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | asmmacro.h | s | 1.1K | 39 | Sam Ravnborg | sam@ravnborg.org | 1338187963 |  | sparc32: add support for run-time patching of leon/sun single instructions  This will be used to handle that MMUREGS has different ASI for SUN and LEON. This is the infrastructure only - users will come later.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Konrad Eisele <konrad@gaisler.com>
f | ptrace.h | s | 10K | 392 | Sam Ravnborg | sam@ravnborg.org | 1333156618 |  | sparc32: fix fallout from system.h removal  Build failures for the typical configs I use  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | idprom.h | s | 624B | 20 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | fixmap.h | s | 3.2K | 98 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | jump_label.h | s | 598B | 27 | Ingo Molnar | mingo@elte.hu | 1330074359 |  | static keys: Introduce 'struct static_key', static_key_true()/false() and static_key_slow_[inc||dec]()  So here's a boot tested patch on top of Jason's series that does all the cleanups I talked about and turns jump labels into a more intuitive to use facility. It should also address the various misconceptions and confusions that surround jump labels.  Typical usage scenarios:          #include <linux/static_key.h>          struct static_key key = STATIC_KEY_INIT_TRUE;          if (static_key_false(&key))                 do unlikely code         else                 do likely code  Or:          if (static_key_true(&key))                 do likely code         else                 do unlikely code  The static key is modified via:          static_key_slow_inc(&key);         ...         static_key_slow_dec(&key);  The 'slow' prefix makes it abundantly clear that this is an expensive operation.  I've updated all in-kernel code to use this everywhere. Note that I (intentionally) have not pushed through the rename blindly through to the lowest levels: the actual jump-label patching arch facility should be named like that, so we want to decouple jump labels from the static-key facility a bit.  On non-jump-label enabled architectures static keys default to likely()/unlikely() branches.  Signed-off-by: Ingo Molnar <mingo@elte.hu> Acked-by: Jason Baron <jbaron@redhat.com> Acked-by: Steven Rostedt <rostedt@goodmis.org> Cc: a.p.zijlstra@chello.nl Cc: mathieu.desnoyers@efficios.com Cc: davem@davemloft.net Cc: ddaney.cavm@gmail.com Cc: Linus Torvalds <torvalds@linux-foundation.org> Link: http://lkml.kernel.org/r/20120222085809.GA26397@elte.hu Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | barrier_64.h | s | 1.9K | 50 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | apc.h | s | 1.6K | 51 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | mmu_context.h | s | 200B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | string_32.h | s | 1.7K | 53 | David S. Miller | davem@davemloft.net | 1336791209 |  | sparc32: Remove inline strncmp "optimization" for constant counts.  Let the compiler do stuff like this.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | kdebug_32.h | s | 2.0K | 61 | Al Viro | viro@ftp.linux.org.uk | 1225568438 |  | sparc32: kernel/trace/trace.c wants DIE_OOPS  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | eeprom.h | s | 254B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | mc146818rtc.h | s | 200B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | topology_64.h | s | 1.3K | 42 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1336568455 |  | sched/numa: Rewrite the CONFIG_NUMA sched domain support  The current code groups up to 16 nodes in a level and then puts an ALLNODES domain spanning the entire tree on top of that. This doesn't reflect the numa topology and esp for the smaller not-fully-connected machines out there today this might make a difference.  Therefore, build a proper numa topology based on node_distance().  Since there's no fixed numa layers anymore, the static SD_NODE_INIT and SD_ALLNODES_INIT aren't usable anymore, the new code tries to construct something similar and scales some values either on the number of cpus in the domain and/or the node_distance() ratio.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Anton Blanchard <anton@samba.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Chris Metcalf <cmetcalf@tilera.com> Cc: David Howells <dhowells@redhat.com> Cc: "David S. Miller" <davem@davemloft.net> Cc: Fenghua Yu <fenghua.yu@intel.com> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: linux-alpha@vger.kernel.org Cc: linux-ia64@vger.kernel.org Cc: linux-kernel@vger.kernel.org Cc: linux-mips@linux-mips.org Cc: linuxppc-dev@lists.ozlabs.org Cc: linux-sh@vger.kernel.org Cc: Matt Turner <mattst88@gmail.com> Cc: Paul Mackerras <paulus@samba.org> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Richard Henderson <rth@twiddle.net> Cc: sparclinux@vger.kernel.org Cc: Tony Luck <tony.luck@intel.com> Cc: x86@kernel.org Cc: Dimitri Sivanich <sivanich@sgi.com> Cc: Greg Pearson <greg.pearson@hp.com> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: bob.picco@oracle.com Cc: chris.mason@oracle.com Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Andrew Morton <akpm@linux-foundation.org> Link: http://lkml.kernel.org/n/tip-r74n3n8hhuc2ynbrnp3vt954@git.kernel.org Signed-off-by: Ingo Molnar <mingo@kernel.org>
f | cache.h | s | 610B | 18 | David S. Miller | davem@davemloft.net | 1337487337 |  | sparc32: Remove completely unused code from asm/cache.h  Signed-off-by: David S. Miller <davem@davemloft.net>
f | ftrace.h | s | 510B | 19 | David S. Miller | davem@davemloft.net | 1245153413 |  | sparc64: Add proper dynamic ftrace support.  Signed-off-by: David S. Miller <davem@davemloft.net> Acked-by: Steven Rostedt <rostedt@goodmis.org> Acked-by: Ingo Molnar <mingo@elte.hu>
f | estate.h | s | 2.2K | 43 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | timex_32.h | s | 313B | 12 | Tkhai Kirill | tkhai@yandex.ru | 1334510930 |  | sparc32: generic clockevent support  The kernel uses l14 timers as clockevents. l10 timer is used as clocksource if platform master_l10_counter isn't constantly zero. The clocksource is continuous, so it's possible to use high resolution timers. l10 timer is also used as clockevent on UP configurations.  This realization is for sun4m, sun4d, sun4c, microsparc-IIep and LEON platforms. The appropriate LEON changes was made by Konrad Eisele.  In case of sun4m's oneshot mode, profile irq is zeroed in smp4m_percpu_timer_interrupt(). It is maybe needless (double, triple etc overflow does nothing).  sun4d is able to have oneshot mode too, but I haven't any way to test it. So code of its percpu timer handler is made as much equal to the current code as possible.  The patch is tested on sun4m box in SMP mode by me, and tested by Konrad on leon in up mode (leon smp is broken atm - due to other reasons).  Signed-off-by: Tkhai Kirill <tkhai@yandex.ru> Tested-by: Konrad Eisele <konrad@gaisler.com> [leon up] [sam: revised patch to provide generic support for leon] Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | upa.h | s | 3.7K | 87 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | barrier_32.h | s | 566B | 13 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | floppy.h | s | 180B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | cacheflush_64.h | s | 2.7K | 65 | Sam Ravnborg | sam@ravnborg.org | 1337546016 |  | sparc32: use flushi when run-time patching in per_cpu_patch  Davis S. Miller wrote: " The way we do that now is overkill.  We only needed to use the MMU cache ops when we had sun4c around because sun4c lacked support for the "flush" instruction.  But all sun4m and later chips have it so we can use it unconditionally.  So in the per_cpu_patch() code, get rid of the cache ops invocation, and instead execute a "flush %reg" after each of the instruction patch assignments, where %reg is set to the address of the instruction that was stored into.  Perhaps take the flushi() definition from asm/cacheflush_64.h and place it into asm/cacheflush.h, then you can simply use that. "  Implemented as per suggestion. Moved run-time patching before we call paging_init(), so helper methods in paging_init() may utilise run-time patching too.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | spinlock_32.h | s | 4.7K | 175 | Mikael Pettersson | mikpe@it.uu.se | 1313444119 |  | sparc32: unbreak arch_write_unlock()  The sparc32 version of arch_write_unlock() is just a plain assignment. Unfortunately this allows the compiler to schedule side-effects in a protected region to occur after the HW-level unlock, which is broken. E.g., the following trivial test case gets miscompiled:  	#include <linux/spinlock.h> 	rwlock_t lock; 	int counter; 	void foo(void) { write_lock(&lock); ++counter; write_unlock(&lock); }  Fixed by adding a compiler memory barrier to arch_write_unlock().  The sparc64 version combines the barrier and assignment into a single asm(), and implements the operation as a static inline, so that's what I did too.  Compile-tested with sparc32_defconfig + CONFIG_SMP=y.  Signed-off-by: Mikael Pettersson <mikpe@it.uu.se> Signed-off-by: David S. Miller <davem@davemloft.net>
f | elf_64.h | s | 5.6K | 181 | David S. Miller | davem@davemloft.net | 1311921086 |  | sparc: Sanitize cpu feature detection and reporting.  Instead of evaluating the cpu features for ELF_HWCAP every exec, calculate it once at boot time.  Add AV_SPARC_* capability flag bits, compatible with what Solaris reports to applications.  Report these capabilities once in the kernel log, and also via /proc/cpuinfo in a new "cpucaps" entry.  If available, fetch the cpu features from the machine description 'hwcap-list' property of the 'cpu' node.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | hardirq_32.h | s | 321B | 10 | Christoph Hellwig | hch@lst.de | 1254429913 |  | sparc32: convert to asm-generic/hardirq.h  From: Christoph Hellwig <hch@lst.de>  [akpm@linux-foundation.org: /arch/sparc/include/asm/irq_32.h: move NR_IRQS definition]  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | pci_64.h | s | 2.3K | 67 | Bjorn Helgaas | bhelgaas@google.com | 1330053544 |  | PCI: collapse pcibios_resource_to_bus  Everybody uses the generic pcibios_resource_to_bus() supplied by the core now, so remove the ARCH_HAS_GENERIC_PCI_OFFSETS used during conversion.  Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
f | nmi.h | s | 314B | 9 | David S. Miller | davem@davemloft.net | 1252589300 |  | sparc64: Initial hw perf counter support.  Only supports one simple counter and only UltraSPARC-IIIi chips.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | mc146818rtc_64.h | s | 650B | 24 | David S. Miller | davem@davemloft.net | 1220044608 |  | sparc64: Use generic CMOS driver.  Based largely upon a patch by Krzysztof Helt <krzysztof.h1@poczta.fm>  Signed-off-by: David S. Miller <davem@davemloft.net>
f | user.h | s | 102B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | mmu_context_64.h | s | 4.4K | 131 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | statfs.h | s | 101B | 4 | David Woodhouse | David.Woodhouse@intel.com | 1220725817 |  | SPARC: Use <asm-generic/statfs.h>  Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | exec.h | s | 108B | 4 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | memctrl.h | s | 272B | 6 | David S. Miller | davem@davemloft.net | 1219640914 |  | sparc64: Add generic interface for registering a dimm printing handler.  The way to do this varies by platform type and the exact memory controller the cpu uses.  For Spitfire cpus we currently just use prom_getunumber() and hope that works.  For Cheetah cpus we have a memory controller driver that can compute this information.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | termbits.h | s | 6.9K | 242 | hyc@symas.com | hyc@symas.com | 1281473259 |  | tty: Add EXTPROC support for LINEMODE  This patch is against the 2.6.34 source.  Paraphrased from the 1989 BSD patch by David Borman @ cray.com:       These are the changes needed for the kernel to support      LINEMODE in the server.       There is a new bit in the termios local flag word, EXTPROC.      When this bit is set, several aspects of the terminal driver      are disabled.  Input line editing, character echo, and mapping      of signals are all disabled.  This allows the telnetd to turn      off these functions when in linemode, but still keep track of      what state the user wants the terminal to be in.       New ioctl:          TIOCSIG         Generate a signal to processes in the                          current process group of the pty.       There is a new mode for packet driver, the TIOCPKT_IOCTL bit.      When packet mode is turned on in the pty, and the EXTPROC bit      is set, then whenever the state of the pty is changed, the      next read on the master side of the pty will have the TIOCPKT_IOCTL      bit set.  This allows the process on the server side of the pty      to know when the state of the terminal has changed; it can then      issue the appropriate ioctl to retrieve the new state.  Since the original BSD patches accompanied the source code for telnet I've left that reference here, but obviously the feature is useful for any remote terminal protocol, including ssh.  The corresponding feature has existed in the BSD tty driver since 1989. For historical reference, a good copy of the relevant files can be found here:  http://anonsvn.mit.edu/viewvc/krb5/trunk/src/appl/telnet/?pathrev=17741  Signed-off-by: Howard Chu <hyc@symas.com> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | sigcontext.h | s | 2.5K | 89 | David S. Miller | davem@davemloft.net | 1313885694 |  | sparc: Allow handling signals when stack is corrupted.  If we can't push the pending register windows onto the user's stack, we disallow signal delivery even if the signal would be delivered on a valid seperate signal stack.  Add a register window save area in the signal frame, and store any unsavable windows there.  On sigreturn, if any windows are still queued up in the signal frame, try to push them back onto the stack and if that fails we kill the process immediately.  This allows the debug/tst-longjmp_chk2 glibc test case to pass.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | xor.h | s | 168B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | topology_32.h | s | 131B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | cmpxchg_32.h | s | 2.5K | 73 | Sam Ravnborg | sam@ravnborg.org | 1337029509 |  | sparc32: remove runtime btfix support  - remove all uses of btfixup header - remove the btfixup header - remove the btfixup code  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | openprom.h | s | 7.2K | 227 | David S. Miller | davem@davemloft.net | 1291156409 |  | sparc: Pass buffer pointer all the way down to prom_{get,put}char().  This gets us closer to being able to eliminate the use of dynamic and stack based buffers, so that we can adhere to the "no buffer addresses above 4GB" rule for PROM calls.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | bug.h | s | 480B | 19 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | hardirq.h | s | 184B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | processor_64.h | s | 6.8K | 205 | Linus Torvalds | torvalds@linux-foundation.org | 1337897428 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/sparc  Pull sparc changes from David S. Miller:  "This has the generic strncpy_from_user() implementation architectures   can now use, which we've been developing on linux-arch over the past   few days.    For good measure I ran both a 32-bit and a 64-bit glibc testsuite run,   and the latter of which pointed out an adjustment I needed to make to   sparc's user_addr_max() definition.  Linus, you were right, STACK_TOP   was not the right thing to use, even on sparc itself :-)    From Sam Ravnborg, we have a conversion of sparc32 over to the common   alloc_thread_info_node(), since the aspect which originally blocked   our doing so (sun4c) has been removed."  Fix up trivial arch/sparc/Kconfig and lib/Makefile conflicts.  * git://git.kernel.org/pub/scm/linux/kernel/git/davem/sparc:   sparc: Fix user_addr_max() definition.   lib: Sparc's strncpy_from_user is generic enough, move under lib/   kernel: Move REPEAT_BYTE definition into linux/kernel.h   sparc: Increase portability of strncpy_from_user() implementation.   sparc: Optimize strncpy_from_user() zero byte search.   sparc: Add full proper error handling to strncpy_from_user().   sparc32: use the common implementation of alloc_thread_info_node()
f | Kbuild | g | 512B |  | Linus Torvalds | torvalds@linux-foundation.org | 1338057220 |  | word-at-a-time: make the interfaces truly generic  This changes the interfaces in <asm/word-at-a-time.h> to be a bit more complicated, but a lot more generic.  In particular, it allows us to really do the operations efficiently on both little-endian and big-endian machines, pretty much regardless of machine details.  For example, if you can rely on a fast population count instruction on your architecture, this will allow you to make your optimized <asm/word-at-a-time.h> file with that.  NOTE! The "generic" version in include/asm-generic/word-at-a-time.h is not truly generic, it actually only works on big-endian.  Why? Because on little-endian the generic algorithms are wasteful, since you can inevitably do better. The x86 implementation is an example of that.  (The only truly non-generic part of the asm-generic implementation is the "find_zero()" function, and you could make a little-endian version of it.  And if the Kbuild infrastructure allowed us to pick a particular header file, that would be lovely)  The <asm/word-at-a-time.h> functions are as follows:   - WORD_AT_A_TIME_CONSTANTS: specific constants that the algorithm    uses.   - has_zero(): take a word, and determine if it has a zero byte in it.    It gets the word, the pointer to the constant pool, and a pointer to    an intermediate "data" field it can set.     This is the "quick-and-dirty" zero tester: it's what is run inside    the hot loops.   - "prep_zero_mask()": take the word, the data that has_zero() produced,    and the constant pool, and generate an *exact* mask of which byte had    the first zero.  This is run directly *outside* the loop, and allows    the "has_zero()" function to answer the "is there a zero byte"    question without necessarily getting exactly *which* byte is the    first one to contain a zero.     If you do multiple byte lookups concurrently (eg "hash_name()", which    looks for both NUL and '/' bytes), after you've done the prep_zero_mask()    phase, the result of those can be or'ed together to get the "either    or" case.   - The result from "prep_zero_mask()" can then be fed into "find_zero()"    (to find the byte offset of the first byte that was zero) or into    "zero_bytemask()" (to find the bytemask of the bytes preceding the    zero byte).     The existence of zero_bytemask() is optional, and is not necessary    for the normal string routines.  But dentry name hashing needs it, so    if you enable DENTRY_WORD_AT_A_TIME you need to expose it.  This changes the generic strncpy_from_user() function and the dentry hashing functions to use these modified word-at-a-time interfaces.  This gets us back to the optimized state of the x86 strncpy that we lost in the previous commit when moving over to the generic version.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | parport.h | s | 5.7K | 205 | Grant Likely | grant.likely@secretlab.ca | 1298882199 |  | dt/sparc: Eliminate users of of_platform_{,un}register_driver  Get rid of old users of of_platform_driver in arch/sparc.  Most of_platform_driver users can be converted to use the platform_bus directly.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | fhc.h | s | 4.4K | 75 | David S. Miller | davem@davemloft.net | 1220241375 |  | sparc64: Rewrite central driver.  This driver is now limited to just doing the basic clock board and FHC chip initialization and registering the platform devices for the per-board LEDs, which are driven by the new LEDS_STARFIRE driver.  The IRQ register handling is already confined purely to the device tree code.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | posix_types.h | s | 1.4K | 35 | Al Viro | viro@zeniv.linux.org.uk | 1338426290 |  | bury __kernel_nlink_t, make internal nlink_t consistent  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | irq_64.h | s | 3.1K | 85 | Cong Wang | xiyou.wangcong@gmail.com | 1332547111 |  | nmi watchdog: do not use cpp symbol in Kconfig  ARCH_HAS_NMI_WATCHDOG is a macro defined by arch, but config HARDLOCKUP_DETECTOR depends on it.  This is wrong, ARCH_HAS_NMI_WATCHDOG has to be a Kconfig config, and arch's need it should select it explicitly.  Signed-off-by: WANG Cong <xiyou.wangcong@gmail.com> Acked-by: Don Zickus <dzickus@redhat.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Cc: David Howells <dhowells@redhat.com> Cc: David Miller <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | futex.h | s | 176B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | mmu.h | s | 168B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | device.h | s | 572B | 24 | Grant Likely | grant.likely@secretlab.ca | 1279987072 |  | of: remove asm/of_device.h  It is mostly unused now.  Sparc has a few defines left in it, but they can be moved to other headers.  Removing this header means that new architectures adding CONFIG_OF support don't need to also add this header file.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: David S. Miller <davem@davemloft.net>
f | spinlock_types.h | s | 377B | 14 | Thomas Gleixner | tglx@linutronix.de | 1260831332 |  | locking: Convert raw_rwlock to arch_rwlock  Not strictly necessary for -rt as -rt does not have non sleeping rwlocks, but it's odd to not have a consistent naming convention.  No functional change.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Ingo Molnar <mingo@elte.hu> Cc: linux-arch@vger.kernel.org
f | xor_32.h | s | 7.3K | 257 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | msi.h | s | 735B | 25 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pcr.h | s | 1.4K | 39 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | linkage.h | s | 86B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | atomic.h | s | 180B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | sunbpp.h | s | 3.2K | 71 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | iommu_64.h | s | 1.8K | 58 | David S. Miller | davem@davemloft.net | 1221113261 |  | sparc64: Get rid of pci_controller_info.  It is just used as a parent to encapsulate two PBM objects.  But that layout is only really relevant and necessary for psycho PCI controllers, which unlike all the others share a single IOMMU instance between sibling PCI busses.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | tlbflush.h | s | 188B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | hardirq_64.h | s | 402B | 13 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | envctrl.h | s | 3.4K | 94 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | perf_event.h | s | 763B | 26 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1290780896 |  | perf, arch: Cleanup perf-pmu init vs lockup-detector  The perf hardware pmu got initialized at various points in the boot, some before early_initcall() some after (notably arch_initcall).  The problem is that the NMI lockup detector is ran from early_initcall() and expects the hardware pmu to be present.  Sanitize this by moving all architecture hardware pmu implementations to initialize at early_initcall() and move the lockup detector to an explicit initcall right after that.  Cc: paulus <paulus@samba.org> Cc: davem <davem@davemloft.net> Cc: Michael Cree <mcree@orcon.net.nz> Cc: Deng-Cheng Zhu <dengcheng.zhu@gmail.com> Acked-by: Paul Mundt <lethal@linux-sh.org> Acked-by: Will Deacon <will.deacon@arm.com> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> LKML-Reference: <1290707759.2145.119.camel@laptop> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | jsflash.h | s | 865B | 32 | Sam Ravnborg | sam@ravnborg.org | 1230960673 |  | sparc: fix warning in userspace header jsflash.h  Fix following warnings in jsflash.h:  jsflash.h:11: include of <linux/types.h> is preferred over <asm/types.h> jsflash.h:24: found __[us]{8,16,32,64} type without #include <linux/types.h>  Fixed by changing the include to <linux/types.h>  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mutex.h | s | 308B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | hugetlb.h | s | 1.9K | 68 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | head_32.h | s | 2.4K | 65 | David S. Miller | davem@davemloft.net | 1336797791 |  | sparc32: Kill unused defines from asm/head_32.h  Signed-off-by: David S. Miller <davem@davemloft.net>
f | leon_pci.h | s | 456B | 17 | Ralf Baechle | ralf@linux-mips.org | 1311348366 |  | PCI: Make the struct pci_dev * argument of pci_fixup_irqs const.  Aside of the usual motivation for constification,  this function has a history of being abused a hook for interrupt and other fixups so I turned this function const ages ago in the MIPS code but it should be done treewide.  Due to function pointer passing in varous places a few other functions had to be constified as well.  Signed-off-by: Ralf Baechle <ralf@linux-mips.org> To: Anton Vorontsov <avorontsov@mvista.com> To: Chris Metcalf <cmetcalf@tilera.com> To: Colin Cross <ccross@android.com> Acked-by: "David S. Miller" <davem@davemloft.net> To: Eric Miao <eric.y.miao@gmail.com> To: Erik Gilling <konkers@android.com> Acked-by: Guan Xuetao <gxt@mprc.pku.edu.cn> To: "H. Peter Anvin" <hpa@zytor.com> To: Imre Kaloz <kaloz@openwrt.org> To: Ingo Molnar <mingo@redhat.com> To: Ivan Kokshaysky <ink@jurassic.park.msu.ru> To: Jesse Barnes <jbarnes@virtuousgeek.org> To: Krzysztof Halasa <khc@pm.waw.pl> To: Lennert Buytenhek <kernel@wantstofly.org> To: Matt Turner <mattst88@gmail.com> To: Nicolas Pitre <nico@fluxnic.net> To: Olof Johansson <olof@lixom.net> Acked-by: Paul Mundt <lethal@linux-sh.org> To: Richard Henderson <rth@twiddle.net> To: Russell King <linux@arm.linux.org.uk> To: Thomas Gleixner <tglx@linutronix.de> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: linux-alpha@vger.kernel.org Cc: linux-arm-kernel@lists.infradead.org Cc: linux-kernel@vger.kernel.org Cc: linux-mips@linux-mips.org Cc: linux-pci@vger.kernel.org Cc: linux-sh@vger.kernel.org Cc: linux-tegra@vger.kernel.org Cc: sparclinux@vger.kernel.org Cc: x86@kernel.org Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | timer_64.h | s | 690B | 22 | Sam Ravnborg | sam@ravnborg.org | 1231276768 |  | sparc64: Use unsigned long long for u64.  Andrew Morton wrote:      People keep on doing              printk("%llu", some_u64);      testing it only on x86_64 and this generates a warning storm on     powerpc, sparc64, etc.  Because they use `long', not `long long'.      Quite a few 64-bit architectures are using `long' for their     s64/u64 types.  We should convert them all to `long long'.  Update types.h so we use unsigned long long for u64 and fix all warnings in sparc64 code. Tested with an allnoconfig, defconfig and allmodconfig builds.  This patch introduces additional warnings in several drivers. These will be dealt with in separate patches.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | irqflags.h | s | 188B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pgtable_32.h | s | 12K | 415 | Sam Ravnborg | sam@ravnborg.org | 1337103828 |  | sparc32: cleanup mm/fault_32.c  - remove unused variables - fix coding style issues that hurts my eyes  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | unistd.h | s | 25K | 455 | David S. Miller | davem@davemloft.net | 1320133890 |  | sparc: Hook up process_vm_{readv,writev} syscalls.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | bitops_64.h | s | 1.8K | 46 | David S. Miller | davem@davemloft.net | 1312345733 |  | sparc: Use popc when possible for ffs/__ffs/ffz.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | topology.h | s | 188B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | spitfire.h | s | 9.2K | 285 | David S. Miller | davem@davemloft.net | 1316208093 |  | sparc64: Future proof Niagara cpu detection.  Recognize T4 and T5 chips.  Treating them both as "T2 plus other stuff" should be extremely safe and make sure distributions will work when those chips actually ship to customers.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | pil.h | s | 1.1K | 29 | David S. Miller | davem@davemloft.net | 1237445517 |  | sparc64: Reschedule KGDB capture to a software interrupt.  Otherwise it might interrupt switch_to() midstream and use half-cooked register window state.  Reported-by: Chris Torek <chris.torek@windriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | fbio.h | s | 9.8K | 285 | Daniel Mack | daniel@caiaq.de | 1265368962 |  | tree-wide: s/widht/width/g typo in comments  Signed-off-by: Daniel Mack <daniel@caiaq.de> Cc: Jiri Kosina <trivial@kernel.org> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | string.h | s | 180B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | page_64.h | s | 3.7K | 104 | Arnd Bergmann | arnd@arndb.de | 1244746937 |  | asm-generic: rename page.h and uaccess.h  The current asm-generic/page.h only contains the get_order function, and asm-generic/uaccess.h only implements unaligned accesses. This renames the file to getorder.h and uaccess-unaligned.h to make room for new page.h and uaccess.h file that will be usable by all simple (e.g. nommu) architectures.  Signed-off-by: Remis Lima Baima <remis.developer@googlemail.com> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | tlbflush_32.h | s | 582B | 20 | David S. Miller | davem@davemloft.net | 1336967371 |  | sparc32: Move cache and TLB flushes over to method ops.  This eliminated most of the remaining users of btfixup.  There are some complications because of the special cases we have for sun4d, leon, and some flavors of viking.  It was found that there are no cases where a flush_page_for_dma method was not hooked up to something, so the "noflush" iommu methods were removed.  Add some documentation to the viking_sun4d_smp_ops to describe exactly the hardware bug which causes us to need special TLB flushing on sun4d.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | syscall.h | s | 3.0K | 109 | Mike Frysinger | vapier@gentoo.org | 1266408441 |  | tracing: Unify arch_syscall_addr() implementations  Most implementations of arch_syscall_addr() are the same, so create a default version in common code and move the one piece that differs (the syscall table) to asm/syscall.h.  New arch ports don't have to waste time copying & pasting this simple function.  The s390/sparc versions need to be different, so document why.  Signed-off-by: Mike Frysinger <vapier@gentoo.org> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Paul Mundt <lethal@linux-sh.org> Acked-by: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Steven Rostedt <rostedt@goodmis.org> LKML-Reference: <1264498803-17278-1-git-send-email-vapier@gentoo.org> Signed-off-by: Frederic Weisbecker <fweisbec@gmail.com>
f | ioctl.h | s | 2.5K | 57 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | uaccess_64.h | s | 8.4K | 230 | David Miller | davem@davemloft.net | 1338057234 |  | sparc: use the new generic strnlen_user() function  This throws away the sparc-specific functions in favor of the generic optimized version.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | module.h | s | 686B | 20 | Sam Ravnborg | sam@ravnborg.org | 1230334541 |  | sparc: unify module.h  Use some preprocessor magic in combination with the newly introduced CONFIG_BITS to unify module.h.  A few additional symbols are added as they are needed in a follow-up patch  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | poll.h | s | 210B | 9 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | delay_32.h | s | 882B | 28 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | processor.h | s | 239B | 9 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | percpu.h | s | 180B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | display7seg.h | s | 1.8K | 71 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | viking.h | s | 8.1K | 228 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | thread_info_64.h | s | 8.4K | 227 | Al Viro | viro@zeniv.linux.org.uk | 1338569930 |  | set_restore_sigmask() is never called without SIGPENDING (and never should be)  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | io-unit.h | s | 2.4K | 50 | David S. Miller | davem@davemloft.net | 1220001323 |  | sparc32: Kill iounit_map_dma_*().  Unused.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | syscalls.h | s | 334B | 9 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | page.h | s | 172B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | cacheflush_32.h | s | 2.0K | 48 | David S. Miller | davem@davemloft.net | 1336967371 |  | sparc32: Move cache and TLB flushes over to method ops.  This eliminated most of the remaining users of btfixup.  There are some complications because of the special cases we have for sun4d, leon, and some flavors of viking.  It was found that there are no cases where a flush_page_for_dma method was not hooked up to something, so the "noflush" iommu methods were removed.  Add some documentation to the viking_sun4d_smp_ops to describe exactly the hardware bug which causes us to need special TLB flushing on sun4d.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | futex_64.h | s | 2.8K | 100 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | trap_block.h | s | 6.3K | 175 | David S. Miller | davem@davemloft.net | 1245153371 |  | sparc64: Store per-cpu offset in trap_block[]  Surprisingly this actually makes LOAD_PER_CPU_BASE() a little more efficient.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | cmpxchg.h | s | 184B | 8 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | head_64.h | s | 1.9K | 63 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | utrap.h | s | 1.4K | 46 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | turbosparc.h | s | 3.7K | 106 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | percpu_32.h | s | 129B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | highmem.h | s | 2.1K | 65 | Cong Wang | amwang@redhat.com | 1332251310 |  | highmem: kill all __kmap_atomic() [swarren@nvidia.com: highmem: Fix ARM build break due to __kmap_atomic rename]  Signed-off-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Cong Wang <amwang@redhat.com>
f | perfctr.h | s | 6.4K | 176 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | auxvec.h | s | 93B | 3 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | apb.h | s | 1.0K | 30 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | param.h | s | 190B | 5 | Robert P. J. Day | rpjday@crashcourse.ca | 1263293176 |  | sparc: Simplify param.h by simply including <asm-generic/param.h>  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Reviewed-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ldc.h | s | 4.1K | 113 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | timex_64.h | s | 384B | 14 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pstate.h | s | 4.8K | 85 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | gpio.h | s | 106B | 4 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1336780814 |  | gpiolib/arches: Centralise bolierplate asm/gpio.h  Rather than requiring architectures that use gpiolib but don't have any need to define anything custom to copy an asm/gpio.h provide a Kconfig symbol which architectures must select in order to include gpio.h and for other architectures just provide the trivial implementation directly.  This makes it much easier to do gpiolib updates and is also a step towards making gpiolib APIs available on every architecture.  For architectures with existing boilerplate code leave a stub header in place which warns on direct inclusion of asm/gpio.h and includes linux/gpio.h to catch code that's doing this.  Direct inclusion of asm/gpio.h has long been deprecated.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Jonas Bonn <jonas@southpole.se> Acked-by: Tony Luck <tony.luck@intel.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | asm-offsets.h | s | 35B | 1 | Sam Ravnborg | sam@ravnborg.org | 1260619694 |  | kbuild: move asm-offsets.h to include/generated  The simplest method was to add an extra asm-offsets.h file in arch/$ARCH/include/asm that references the generated file.  We can now migrate the architectures one-by-one to reference the generated file direct - and when done we can delete the temporary arch/$ARCH/include/asm/asm-offsets.h file.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | sfp-machine.h | s | 200B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pgalloc.h | s | 184B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | atomic_64.h | s | 3.3K | 91 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | scatterlist.h | s | 161B | 5 | FUJITA Tomonori | fujita.tomonori@lab.ntt.co.jp | 1281197750 |  | remove needless ISA_DMA_THRESHOLD  Architectures don't need to define ISA_DMA_THRESHOLD anymore.  Signed-off-by: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp> Acked-by: James Bottomley <James.Bottomley@suse.de> Acked-by: David Howells <dhowells@redhat.com> Signed-off-by: Jens Axboe <jaxboe@fusionio.com>
f | compat_signal.h | s | 611B | 24 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | sfp-machine_32.h | s | 6.9K | 187 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | irqflags_64.h | s | 1.9K | 82 | Steven Rostedt | rostedt@goodmis.org | 1309964429 |  | sparc/irqs: Do not trace arch_local_{*,irq_*} functions  Do not trace arch_local_save_flags(), arch_local_irq_*() and friends. Although they are marked inline, gcc may still make a function out of them and add it to the pool of functions that are traced by the function tracer. This can cause undesirable results (kernel panic, triple faults, etc).  Add the notrace notation to prevent them from ever being traced.  Signed-off-by: Steven Rostedt <rostedt@goodmis.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bitops_32.h | s | 2.9K | 83 | Akinobu Mita | akinobu.mita@gmail.com | 1300934782 |  | bitops: remove minix bitops from asm/bitops.h  minix bit operations are only used by minix filesystem and useless by other modules.  Because byte order of inode and block bitmaps is different on each architecture like below:  m68k: 	big-endian 16bit indexed bitmaps  h8300, microblaze, s390, sparc, m68knommu: 	big-endian 32 or 64bit indexed bitmaps  m32r, mips, sh, xtensa: 	big-endian 32 or 64bit indexed bitmaps for big-endian mode 	little-endian bitmaps for little-endian mode  Others: 	little-endian bitmaps  In order to move minix bit operations from asm/bitops.h to architecture independent code in minix filesystem, this provides two config options.  CONFIG_MINIX_FS_BIG_ENDIAN_16BIT_INDEXED is only selected by m68k. CONFIG_MINIX_FS_NATIVE_ENDIAN is selected by the architectures which use native byte order bitmaps (h8300, microblaze, s390, sparc, m68knommu, m32r, mips, sh, xtensa).  The architectures which always use little-endian bitmaps do not select these options.  Finally, we can remove minix bit operations from asm/bitops.h for all architectures.  Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Acked-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Greg Ungerer <gerg@uclinux.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Roman Zippel <zippel@linux-m68k.org> Cc: Andreas Schwab <schwab@linux-m68k.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Yoshinori Sato <ysato@users.sourceforge.jp> Cc: Michal Simek <monstr@monstr.eu> Cc: "David S. Miller" <davem@davemloft.net> Cc: Hirokazu Takata <takata@linux-m32r.org> Acked-by: Ralf Baechle <ralf@linux-mips.org> Acked-by: Paul Mundt <lethal@linux-sh.org> Cc: Chris Zankel <chris@zankel.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fb.h | s | 641B | 27 | David S. Miller | davem@davemloft.net | 1281986769 |  | sparc: Really fix "console=" for serial consoles.  If a video head and keyboard are hooked up, specifying "console=ttyS0" or similar to use a serial console will not work properly.  The key issue is that we must register all serial console capable devices with register_console(), otherwise the command line specified device won't be found.  The sun serial drivers would only register themselves as console devices if the OpenFirmware specified console device node matched.  To fix this part we now unconditionally get the serial console register by setting serial_drv->cons always.  Secondarily we must not add_preferred_console() using the firmware provided console setting if the user gaven an override on the kernel command line using "console="  The "primary framebuffer" matching logic was always triggering o n openfirmware device node match, make it not when a command line override was given.  Reported-by: Frans Pop <elendil@planet.nl> Tested-by: Frans Pop <elendil@planet.nl> Signed-off-by: David S. Miller <davem@davemloft.net>
f | swab.h | s | 932B | 36 | Harvey Harrison | harvey.harrison@gmail.com | 1231294227 |  | sparc: introduce asm/swab.h  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fcntl.h | s | 1.7K | 48 | Stephen Rothwell | sfr@canb.auug.org.au | 1300283642 |  | vfs: add nonconflicting values for O_PATH  [AV: on architectures where default conflicts with existing flags, that is]  Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | backoff.h | s | 618B | 25 | David S. Miller | davem@davemloft.net | 1282197206 |  | sparc64: Make lock backoff really a NOP on UP builds.  As noticed by Mikulas Patocka, the backoff macros don't completely nop out for UP builds, we still get a branch always and a delay slot nop.  Fix this by making the branch to the backoff spin loop selective, then we can nop out the spin loop completely.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | thread_info.h | s | 200B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | irq.h | s | 168B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | mxcc.h | s | 4.3K | 119 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | bbc.h | s | 9.7K | 201 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | timex.h | s | 176B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | mmu_64.h | s | 3.4K | 100 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | socket.h | s | 1.7K | 56 | Ben Greear | greearb@candelatech.com | 1330076255 |  | net: Add framework to allow sending packets with customized CRC.  This is useful for testing RX handling of frames with bad CRCs.  Requires driver support to actually put the packet on the wire properly.  Signed-off-by: Ben Greear <greearb@candelatech.com> Tested-by: Aaron Brown <aaron.f.brown@intel.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | rwsem.h | s | 2.7K | 104 | Thomas Gleixner | tglx@linutronix.de | 1296127839 |  | rwsem: Move duplicate function prototypes to linux/rwsem.h  All architecture specific rwsem headers carry the same function prototypes. Just x86 adds asmregparm, which is an empty define on all other architectures. S390 has a stale rwsem_downgrade_write() prototype.  Remove the duplicates and add the prototypes to linux/rwsem.h  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: Peter Zijlstra <peterz@infradead.org> Cc: David Howells <dhowells@redhat.com> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Richard Henderson <rth@twiddle.net> Acked-by: Tony Luck <tony.luck@intel.com> Acked-by: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Acked-by: David Miller <davem@davemloft.net> Cc: Chris Zankel <chris@zankel.net> LKML-Reference: <20110126195833.970840140@linutronix.de> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | switch_to_64.h | s | 2.6K | 67 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | pgtable.h | s | 184B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pgtsrmmu.h | s | 6.2K | 154 | Sam Ravnborg | sam@ravnborg.org | 1338187971 |  | sparc32: srmmu_probe now knows about leon too  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Konrad Eisele <konrad@gaisler.com>
f | ipcbuf.h | s | 700B | 29 | Sam Ravnborg | sam@ravnborg.org | 1231112692 |  | sparc: unify ipcbuf.h  The ony difference is the size of the mode. sparc has extra padding to compensate for this.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | uctx.h | s | 1.3K | 63 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | asm.h | s | 1.0K | 37 | David S. Miller | davem@davemloft.net | 1228812613 |  | sparc: Add asm/asm.h  This will contain macros that help share assembler code between the 32-bit and 64-bit platform.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | stat.h | s | 1.9K | 87 | Rob Landley | rob@landley.net | 1269704178 |  | sparc: Fix use of uid16_t and gid16_t in asm/stat.h  Signed-off-by: Rob Landley <rob@landley.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | shmbuf.h | s | 1.2K | 44 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | switch_to.h | s | 192B | 8 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | checksum_32.h | s | 6.7K | 218 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | uaccess.h | s | 344B | 11 | David S. Miller | davem@davemloft.net | 1337892118 |  | sparc: Fix user_addr_max() definition.  We need to use TASK_SIZE because for 64-bit tasks the value of STACK_TOP actually sits in the middle of the address space so we'll get false-negatives.  Adjust the TASK_SIZE definition on sparc64 to accomodate this, in the context in which user_addr_max() is used we have the test_thread_flag() definition available but not the one for test_tsk_thread_flag().  Signed-off-by: David S. Miller <davem@davemloft.net>
f | floppy_32.h | s | 10.0K | 346 | David S. Miller | davem@davemloft.net | 1336940596 |  | sparc: Kill mmu_{un,}lockarea().  These were used on sun4c during floppy data transfers since on that chip we had to lock the cpu mappings into the TLB because we cannot take a TLB miss during the assembler floppy interrupt handler that does the data transfer.  That is no longer necessary since we've removed sun4c support, thus this stuff can disappear completely.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | pci_32.h | s | 1.4K | 48 | Bjorn Helgaas | bhelgaas@google.com | 1330053544 |  | PCI: collapse pcibios_resource_to_bus  Everybody uses the generic pcibios_resource_to_bus() supplied by the core now, so remove the ARCH_HAS_GENERIC_PCI_OFFSETS used during conversion.  Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
f | dcu.h | s | 1.4K | 24 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | asi.h | s | 13K | 249 | Sam Ravnborg | sam@ravnborg.org | 1338187970 |  | sparc32: drop LEON hack for ASI_M_MMUREGS  All users of MMUREGS ASI is now LEON/SUN aware, so this is no longer required.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Konrad Eisele <konrad@gaisler.com>
f | processor_32.h | s | 3.3K | 101 | Linus Torvalds | torvalds@linux-foundation.org | 1337795947 |  | Merge branch 'x86-fpu-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  Pull fpu state cleanups from Ingo Molnar:  "This tree streamlines further aspects of FPU handling by eliminating   the prepare_to_copy() complication and moving that logic to   arch_dup_task_struct().    It also fixes the FPU dumps in threaded core dumps, removes and old   (and now invalid) assumption plus micro-optimizes the exit path by   avoiding an FPU save for dead tasks."  Fixed up trivial add-add conflict in arch/sh/kernel/process.c that came in because we now do the FPU handling in arch_dup_task_struct() rather than the legacy (and now gone) prepare_to_copy().  * 'x86-fpu-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:   x86, fpu: drop the fpu state during thread exit   x86, xsave: remove thread_has_fpu() bug check in __sanitize_i387_state()   coredump: ensure the fpu state is flushed for proper multi-threaded core dump   fork: move the real prepare_to_copy() users to arch_dup_task_struct()
f | vga.h | s | 461B | 24 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | chmctrl.h | s | 7.9K | 174 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pgalloc_32.h | s | 2.4K | 66 | Sam Ravnborg | sam@ravnborg.org | 1337029509 |  | sparc32: remove runtime btfix support  - remove all uses of btfixup header - remove the btfixup header - remove the btfixup code  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | tlb_64.h | s | 902B | 25 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1306337953 |  | sparc: mmu_gather rework  Rework the sparc mmu_gather usage to conform to the new world order :-)  Sparc mmu_gather does two things:  - tracks vaddrs to unhash  - tracks pages to free  Split these two things like powerpc has done and keep the vaddrs in per-cpu data structures and flush them on context switch.  The remaining bits can then use the generic mmu_gather.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Acked-by: David Miller <davem@davemloft.net> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Jeff Dike <jdike@addtoit.com> Cc: Richard Weinberger <richard@nod.at> Cc: Tony Luck <tony.luck@intel.com> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Hugh Dickins <hughd@google.com> Cc: Mel Gorman <mel@csn.ul.ie> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Nick Piggin <npiggin@kernel.dk> Cc: Namhyung Kim <namhyung@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | signal.h | s | 5.4K | 179 | Matt Fleming | matt.fleming@intel.com | 1326241854 |  | sparc: make SA_NOMASK a synonym of SA_NODEFER  Unlike other architectures, sparc currently has no SA_NODEFER definition but only the older SA_NOMASK.  Since SA_NOMASK is the historical name for SA_NODEFER, add SA_NODEFER and copy what other architectures do by making SA_NOMASK a synonym for SA_NODEFER.  Signed-off-by: Matt Fleming <matt.fleming@intel.com> Acked-by: Oleg Nesterov <oleg@redhat.com> Cc: "David S. Miller" <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | string_64.h | s | 1.6K | 46 | David S. Miller | davem@davemloft.net | 1260516730 |  | sparc: Stop trying to be so fancy and use __builtin_{memcpy,memset}()  This mirrors commit ff60fab71bb3b4fdbf8caf57ff3739ffd0887396 (x86: Use __builtin_memset and __builtin_memcpy for memset/memcpy)  Signed-off-by: David S. Miller <davem@davemloft.net>
f | mman.h | s | 1.3K | 25 | Arnd Bergmann | arnd@arndb.de | 1253629061 |  | mm: add MAP_HUGETLB for mmaping pseudo-anonymous huge page regions  Add a flag for mmap that will be used to request a huge page region that will look like anonymous memory to user space.  This is accomplished by using a file on the internal vfsmount.  MAP_HUGETLB is a modifier of MAP_ANONYMOUS and so must be specified with it.  The region will behave the same as a MAP_ANONYMOUS region using small pages.  The patch also adds the MAP_STACK flag, which was previously defined only on some architectures but not on others.  Since MAP_STACK is meant to be a hint only, architectures can define it without assigning a specific meaning to it.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Cc: Eric B Munson <ebmunson@us.ibm.com> Cc: Hugh Dickins <hugh.dickins@tiscali.co.uk> Cc: David Rientjes <rientjes@google.com> Cc: <linux-arch@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ebus_dma.h | s | 1.1K | 29 | David S. Miller | davem@davemloft.net | 1220076621 |  | sparc: Move EBUS DMA interfaces into seperate header file.  These have no dependencies on the EBUS probing layer, the clients setup the registers and all of those details.  The EBUS DMA layer just programs and manages the DMA controller found in EBUS.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | auxio.h | s | 176B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | dcr.h | s | 689B | 12 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | cpu_type.h | s | 540B | 21 | David S. Miller | davem@davemloft.net | 1336807403 |  | sparc32: Remove sun4 and sun4c from enum sparc_cpu.  All the remaining references are trivially removed since we've just eliminated the final reference to sparc_cpu_model from assembler code in commit b7d96ce189564e661909fbf8df39d7358149885b ("sparc32: Remove sparc_cpu_model read from floppy interrupt handler.")  Signed-off-by: David S. Miller <davem@davemloft.net>
f | mbus.h | s | 2.9K | 80 | David S. Miller | davem@davemloft.net | 1337102520 |  | sparc32: Remove cypress cpu support.  It's the one aberration in v8, the only cpu that didn't actually have hardware multiply and divide instructions.  Signed-off-by: David S. Miller <davem@davemloft.net> Acked-by: Sam Ravnborg <sam@ravnborg.org>
f | ross.h | s | 5.5K | 164 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | futex_32.h | s | 82B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | kgdb.h | s | 890B | 32 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | msgbuf.h | s | 1.1K | 34 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | iommu.h | s | 176B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | emergency-restart.h | s | 149B | 4 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | byteorder.h | s | 128B | 4 | Harvey Harrison | harvey.harrison@gmail.com | 1231991810 |  | byteorder: make swab.h include asm/swab.h like a regular header  Add swab.h to kbuild.asm and remove the individual entries from each arch, mark as unifdef as some arches have some kernel-only bits inside.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | spinlock.h | s | 188B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | sockios.h | s | 372B | 11 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | shmparam.h | s | 188B | 8 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | psr.h | s | 3.0K | 85 | Sam Ravnborg | sam@ravnborg.org | 1338187965 |  | sparc32: handle leon in cpu.c  A few hardcoded constant were replaced by symbolic versions to improve readability  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Cc: Daniel Hellstrom <daniel@gaisler.com> Cc: Konrad Eisele <konrad@gaisler.com>
f | ns87303.h | s | 3.2K | 95 | David Howells | dhowells@redhat.com | 1332955803 |  | Disintegrate asm/system.h for Sparc  Disintegrate asm/system.h for Sparc.  Signed-off-by: David Howells <dhowells@redhat.com> cc: sparclinux@vger.kernel.org
f | sembuf.h | s | 814B | 28 | Sam Ravnborg | sam@ravnborg.org | 1217192459 |  | sparc, sparc64: use arch/sparc/include  The majority of this patch was created by the following script:  *** ASM=arch/sparc/include/asm mkdir -p $ASM git mv include/asm-sparc64/ftrace.h $ASM git rm include/asm-sparc64/* git mv include/asm-sparc/* $ASM sed -ie 's/asm-sparc64/asm/g' $ASM/* sed -ie 's/asm-sparc/asm/g' $ASM/* ***  The rest was an update of the top-level Makefile to use sparc for header files when sparc64 is being build. And a small fixlet to pick up the correct unistd.h from sparc64 code.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
