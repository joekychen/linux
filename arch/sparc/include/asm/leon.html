<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › sparc › include › asm › leon.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>leon.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 2004 Konrad Eisele (eiselekd@web.de,konrad@gaisler.com) Gaisler Research</span>
<span class="cm"> * Copyright (C) 2004 Stefan Holst (mail@s-holst.de) Uni-Stuttgart</span>
<span class="cm"> * Copyright (C) 2009 Daniel Hellstrom (daniel@gaisler.com) Aeroflex Gaisler AB</span>
<span class="cm"> * Copyright (C) 2009 Konrad Eisele (konrad@gaisler.com) Aeroflex Gaisler AB</span>
<span class="cm"> */</span>

<span class="cp">#ifndef LEON_H_INCLUDE</span>
<span class="cp">#define LEON_H_INCLUDE</span>

<span class="cm">/* mmu register access, ASI_LEON_MMUREGS */</span>
<span class="cp">#define LEON_CNR_CTRL		0x000</span>
<span class="cp">#define LEON_CNR_CTXP		0x100</span>
<span class="cp">#define LEON_CNR_CTX		0x200</span>
<span class="cp">#define LEON_CNR_F		0x300</span>
<span class="cp">#define LEON_CNR_FADDR		0x400</span>

<span class="cp">#define LEON_CNR_CTX_NCTX	256	</span><span class="cm">/*number of MMU ctx */</span><span class="cp"></span>

<span class="cp">#define LEON_CNR_CTRL_TLBDIS	0x80000000</span>

<span class="cp">#define LEON_MMUTLB_ENT_MAX	64</span>

<span class="cm">/*</span>
<span class="cm"> * diagnostic access from mmutlb.vhd:</span>
<span class="cm"> * 0: pte address</span>
<span class="cm"> * 4: pte</span>
<span class="cm"> * 8: additional flags</span>
<span class="cm"> */</span>
<span class="cp">#define LEON_DIAGF_LVL		0x3</span>
<span class="cp">#define LEON_DIAGF_WR		0x8</span>
<span class="cp">#define LEON_DIAGF_WR_SHIFT	3</span>
<span class="cp">#define LEON_DIAGF_HIT		0x10</span>
<span class="cp">#define LEON_DIAGF_HIT_SHIFT	4</span>
<span class="cp">#define LEON_DIAGF_CTX		0x1fe0</span>
<span class="cp">#define LEON_DIAGF_CTX_SHIFT	5</span>
<span class="cp">#define LEON_DIAGF_VALID	0x2000</span>
<span class="cp">#define LEON_DIAGF_VALID_SHIFT	13</span>

<span class="cm">/* irq masks */</span>
<span class="cp">#define LEON_HARD_INT(x)	(1 &lt;&lt; (x))	</span><span class="cm">/* irq 0-15 */</span><span class="cp"></span>
<span class="cp">#define LEON_IRQMASK_R		0x0000fffe	</span><span class="cm">/* bit 15- 1 of lregs.irqmask */</span><span class="cp"></span>
<span class="cp">#define LEON_IRQPRIO_R		0xfffe0000	</span><span class="cm">/* bit 31-17 of lregs.irqmask */</span><span class="cp"></span>

<span class="cp">#define LEON_MCFG2_SRAMDIS		0x00002000</span>
<span class="cp">#define LEON_MCFG2_SDRAMEN		0x00004000</span>
<span class="cp">#define LEON_MCFG2_SRAMBANKSZ		0x00001e00	</span><span class="cm">/* [12-9] */</span><span class="cp"></span>
<span class="cp">#define LEON_MCFG2_SRAMBANKSZ_SHIFT	9</span>
<span class="cp">#define LEON_MCFG2_SDRAMBANKSZ		0x03800000	</span><span class="cm">/* [25-23] */</span><span class="cp"></span>
<span class="cp">#define LEON_MCFG2_SDRAMBANKSZ_SHIFT	23</span>

<span class="cp">#define LEON_TCNT0_MASK	0x7fffff</span>


<span class="cp">#define ASI_LEON3_SYSCTRL		0x02</span>
<span class="cp">#define ASI_LEON3_SYSCTRL_ICFG		0x08</span>
<span class="cp">#define ASI_LEON3_SYSCTRL_DCFG		0x0c</span>
<span class="cp">#define ASI_LEON3_SYSCTRL_CFG_SNOOPING (1 &lt;&lt; 27)</span>
<span class="cp">#define ASI_LEON3_SYSCTRL_CFG_SSIZE(c) (1 &lt;&lt; ((c &gt;&gt; 20) &amp; 0xf))</span>

<span class="cp">#ifndef __ASSEMBLY__</span>

<span class="cm">/* do a physical address bypass write, i.e. for 0x80000000 */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">leon_store_reg</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">paddr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span><span class="s">&quot;sta %0, [%1] %2</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="o">:</span> <span class="s">&quot;r&quot;</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="s">&quot;r&quot;</span><span class="p">(</span><span class="n">paddr</span><span class="p">),</span>
			     <span class="s">&quot;i&quot;</span><span class="p">(</span><span class="n">ASI_LEON_BYPASS</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;memory&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* do a physical address bypass load, i.e. for 0x80000000 */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">leon_load_reg</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">paddr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">retval</span><span class="p">;</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span><span class="s">&quot;lda [%1] %2, %0</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span>
			     <span class="s">&quot;=r&quot;</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span> <span class="o">:</span> <span class="s">&quot;r&quot;</span><span class="p">(</span><span class="n">paddr</span><span class="p">),</span> <span class="s">&quot;i&quot;</span><span class="p">(</span><span class="n">ASI_LEON_BYPASS</span><span class="p">));</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* macro access for leon_load_reg() and leon_store_reg() */</span>
<span class="cp">#define LEON3_BYPASS_LOAD_PA(x)	    (leon_load_reg((unsigned long)(x)))</span>
<span class="cp">#define LEON3_BYPASS_STORE_PA(x, v) (leon_store_reg((unsigned long)(x), (unsigned long)(v)))</span>
<span class="cp">#define LEON_BYPASS_LOAD_PA(x)      leon_load_reg((unsigned long)(x))</span>
<span class="cp">#define LEON_BYPASS_STORE_PA(x, v)  leon_store_reg((unsigned long)(x), (unsigned long)(v))</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_switch_mm</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_init_IRQ</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">sparc_leon3_get_dcachecfg</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">retval</span><span class="p">;</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span><span class="s">&quot;lda [%1] %2, %0</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span>
			     <span class="s">&quot;=r&quot;</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span> <span class="o">:</span>
			     <span class="s">&quot;r&quot;</span><span class="p">(</span><span class="n">ASI_LEON3_SYSCTRL_DCFG</span><span class="p">),</span>
			     <span class="s">&quot;i&quot;</span><span class="p">(</span><span class="n">ASI_LEON3_SYSCTRL</span><span class="p">));</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* enable snooping */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">sparc_leon3_enable_snooping</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span> <span class="p">(</span><span class="s">&quot;lda [%%g0] 2, %%l1</span><span class="se">\n\t</span><span class="s">&quot;</span>
			  <span class="s">&quot;set 0x800000, %%l2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			  <span class="s">&quot;or  %%l2, %%l1, %%l2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			  <span class="s">&quot;sta %%l2, [%%g0] 2</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="o">:</span> <span class="o">:</span> <span class="s">&quot;l1&quot;</span><span class="p">,</span> <span class="s">&quot;l2&quot;</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">sparc_leon3_snooping_enabled</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">cctrl</span><span class="p">;</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span><span class="p">(</span><span class="s">&quot;lda [%%g0] 2, %0</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="s">&quot;=r&quot;</span><span class="p">(</span><span class="n">cctrl</span><span class="p">));</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">cctrl</span> <span class="o">&gt;&gt;</span> <span class="mi">23</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">sparc_leon3_disable_cache</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span> <span class="p">(</span><span class="s">&quot;lda [%%g0] 2, %%l1</span><span class="se">\n\t</span><span class="s">&quot;</span>
			  <span class="s">&quot;set 0x00000f, %%l2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			  <span class="s">&quot;andn  %%l2, %%l1, %%l2</span><span class="se">\n\t</span><span class="s">&quot;</span>
			  <span class="s">&quot;sta %%l2, [%%g0] 2</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="o">:</span> <span class="o">:</span> <span class="s">&quot;l1&quot;</span><span class="p">,</span> <span class="s">&quot;l2&quot;</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">sparc_leon3_asr17</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">asr17</span><span class="p">;</span>
	<span class="n">__asm__</span> <span class="n">__volatile__</span> <span class="p">(</span><span class="s">&quot;rd %%asr17, %0</span><span class="se">\n\t</span><span class="s">&quot;</span> <span class="o">:</span> <span class="s">&quot;=r&quot;</span><span class="p">(</span><span class="n">asr17</span><span class="p">));</span>
	<span class="k">return</span> <span class="n">asr17</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">sparc_leon3_cpuid</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">sparc_leon3_asr17</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">28</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/*!__ASSEMBLY__*/</span><span class="cp"></span>

<span class="cp">#ifdef CONFIG_SMP</span>
<span class="cp"># define LEON3_IRQ_IPI_DEFAULT		13</span>
<span class="cp"># define LEON3_IRQ_TICKER		(leon3_ticker_irq)</span>
<span class="cp"># define LEON3_IRQ_CROSS_CALL		15</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(PAGE_SIZE_LEON_8K)</span>
<span class="cp">#define LEON_PAGE_SIZE_LEON 1</span>
<span class="cp">#elif defined(PAGE_SIZE_LEON_16K)</span>
<span class="cp">#define LEON_PAGE_SIZE_LEON 2)</span>
<span class="cp">#else</span>
<span class="cp">#define LEON_PAGE_SIZE_LEON 0</span>
<span class="cp">#endif</span>

<span class="cp">#if LEON_PAGE_SIZE_LEON == 0</span>
<span class="cm">/* [ 8, 6, 6 ] + 12 */</span>
<span class="cp">#define LEON_PGD_SH    24</span>
<span class="cp">#define LEON_PGD_M     0xff</span>
<span class="cp">#define LEON_PMD_SH    18</span>
<span class="cp">#define LEON_PMD_SH_V  (LEON_PGD_SH-2)</span>
<span class="cp">#define LEON_PMD_M     0x3f</span>
<span class="cp">#define LEON_PTE_SH    12</span>
<span class="cp">#define LEON_PTE_M     0x3f</span>
<span class="cp">#elif LEON_PAGE_SIZE_LEON == 1</span>
<span class="cm">/* [ 7, 6, 6 ] + 13 */</span>
<span class="cp">#define LEON_PGD_SH    25</span>
<span class="cp">#define LEON_PGD_M     0x7f</span>
<span class="cp">#define LEON_PMD_SH    19</span>
<span class="cp">#define LEON_PMD_SH_V  (LEON_PGD_SH-1)</span>
<span class="cp">#define LEON_PMD_M     0x3f</span>
<span class="cp">#define LEON_PTE_SH    13</span>
<span class="cp">#define LEON_PTE_M     0x3f</span>
<span class="cp">#elif LEON_PAGE_SIZE_LEON == 2</span>
<span class="cm">/* [ 6, 6, 6 ] + 14 */</span>
<span class="cp">#define LEON_PGD_SH    26</span>
<span class="cp">#define LEON_PGD_M     0x3f</span>
<span class="cp">#define LEON_PMD_SH    20</span>
<span class="cp">#define LEON_PMD_SH_V  (LEON_PGD_SH-0)</span>
<span class="cp">#define LEON_PMD_M     0x3f</span>
<span class="cp">#define LEON_PTE_SH    14</span>
<span class="cp">#define LEON_PTE_M     0x3f</span>
<span class="cp">#elif LEON_PAGE_SIZE_LEON == 3</span>
<span class="cm">/* [ 4, 7, 6 ] + 15 */</span>
<span class="cp">#define LEON_PGD_SH    28</span>
<span class="cp">#define LEON_PGD_M     0x0f</span>
<span class="cp">#define LEON_PMD_SH    21</span>
<span class="cp">#define LEON_PMD_SH_V  (LEON_PGD_SH-0)</span>
<span class="cp">#define LEON_PMD_M     0x7f</span>
<span class="cp">#define LEON_PTE_SH    15</span>
<span class="cp">#define LEON_PTE_M     0x3f</span>
<span class="cp">#else</span>
<span class="cp">#error cannot determine LEON_PAGE_SIZE_LEON</span>
<span class="cp">#endif</span>

<span class="cp">#define LEON3_XCCR_SETS_MASK  0x07000000UL</span>
<span class="cp">#define LEON3_XCCR_SSIZE_MASK 0x00f00000UL</span>

<span class="cp">#define LEON2_CCR_DSETS_MASK 0x03000000UL</span>
<span class="cp">#define LEON2_CFG_SSIZE_MASK 0x00007000UL</span>

<span class="cp">#ifndef __ASSEMBLY__</span>
<span class="k">struct</span> <span class="n">vm_area_struct</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">leon_swprobe</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vaddr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">paddr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_flush_icache_all</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_flush_dcache_all</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_flush_cache_all</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_flush_tlb_all</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">leon_flush_during_switch</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">leon_flush_needed</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_flush_pcache_all</span><span class="p">(</span><span class="k">struct</span> <span class="n">vm_area_struct</span> <span class="o">*</span><span class="n">vma</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">page</span><span class="p">);</span>

<span class="cm">/* struct that hold LEON3 cache configuration registers */</span>
<span class="k">struct</span> <span class="n">leon3_cacheregs</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ccr</span><span class="p">;</span>	<span class="cm">/* 0x00 - Cache Control Register  */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">iccr</span><span class="p">;</span>     <span class="cm">/* 0x08 - Instruction Cache Configuration Register */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">dccr</span><span class="p">;</span>	<span class="cm">/* 0x0c - Data Cache Configuration Register */</span>
<span class="p">};</span>

<span class="cp">#include &lt;linux/irq.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>

<span class="k">struct</span> <span class="n">device_node</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">task_struct</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">leon_build_device_irq</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">real_irq</span><span class="p">,</span>
					   <span class="n">irq_flow_handler_t</span> <span class="n">flow_handler</span><span class="p">,</span>
					   <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">do_ack</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_update_virq_handling</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">virq</span><span class="p">,</span>
			      <span class="n">irq_flow_handler_t</span> <span class="n">flow_handler</span><span class="p">,</span>
			      <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">do_ack</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_init_timers</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_trans_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">dp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_node_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">dp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">device_node</span> <span class="o">***</span><span class="n">nextp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">init_leon</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">poke_leonsparc</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon3_getCacheRegs</span><span class="p">(</span><span class="k">struct</span> <span class="n">leon3_cacheregs</span> <span class="o">*</span><span class="n">regs</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">leon3_ticker_irq</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_SMP</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">leon_smp_nrcpus</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_clear_profile_irq</span><span class="p">(</span><span class="kt">int</span> <span class="n">cpu</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_smp_done</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">leon_boot_cpus</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">leon_boot_one_cpu</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">leon_init_smp</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">leon_enable_irq_cpu</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">irq_nr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cpu</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">irqreturn_t</span> <span class="n">leon_percpu_timer_interrupt</span><span class="p">(</span><span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">unused</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">smpleon_ipi</span><span class="p">[];</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">linux_trap_ipi15_leon</span><span class="p">[];</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">leon_ipi_irq</span><span class="p">;</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_SMP */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>

<span class="cm">/* macros used in leon_mm.c */</span>
<span class="cp">#define PFN(x)           ((x) &gt;&gt; PAGE_SHIFT)</span>
<span class="cp">#define _pfn_valid(pfn)	 ((pfn &lt; last_valid_pfn) &amp;&amp; (pfn &gt;= PFN(phys_base)))</span>
<span class="cp">#define _SRMMU_PTE_PMASK_LEON 0xffffffff</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
