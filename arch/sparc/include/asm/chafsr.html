<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › sparc › include › asm › chafsr.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>chafsr.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _SPARC64_CHAFSR_H</span>
<span class="cp">#define _SPARC64_CHAFSR_H</span>

<span class="cm">/* Cheetah Asynchronous Fault Status register, ASI=0x4C VA&lt;63:0&gt;=0x0 */</span>

<span class="cm">/* Comments indicate which processor variants on which the bit definition</span>
<span class="cm"> * is valid.  Codes are:</span>
<span class="cm"> * ch	--&gt;	cheetah</span>
<span class="cm"> * ch+	--&gt;	cheetah plus</span>
<span class="cm"> * jp	--&gt;	jalapeno</span>
<span class="cm"> */</span>

<span class="cm">/* All bits of this register except M_SYNDROME and E_SYNDROME are</span>
<span class="cm"> * read, write 1 to clear.  M_SYNDROME and E_SYNDROME are read-only.</span>
<span class="cm"> */</span>

<span class="cm">/* Software bit set by linux trap handlers to indicate that the trap was</span>
<span class="cm"> * signalled at %tl &gt;= 1.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_TL1		(1UL &lt;&lt; 63UL) </span><span class="cm">/* n/a */</span><span class="cp"></span>

<span class="cm">/* Unmapped error from system bus for prefetch queue or</span>
<span class="cm"> * store queue read operation</span>
<span class="cm"> */</span>
<span class="cp">#define CHPAFSR_DTO		(1UL &lt;&lt; 59UL) </span><span class="cm">/* ch+ */</span><span class="cp"></span>

<span class="cm">/* Bus error from system bus for prefetch queue or store queue</span>
<span class="cm"> * read operation</span>
<span class="cm"> */</span>
<span class="cp">#define CHPAFSR_DBERR		(1UL &lt;&lt; 58UL) </span><span class="cm">/* ch+ */</span><span class="cp"></span>

<span class="cm">/* Hardware corrected E-cache Tag ECC error */</span>
<span class="cp">#define CHPAFSR_THCE		(1UL &lt;&lt; 57UL) </span><span class="cm">/* ch+ */</span><span class="cp"></span>
<span class="cm">/* System interface protocol error, hw timeout caused */</span>
<span class="cp">#define JPAFSR_JETO		(1UL &lt;&lt; 57UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* SW handled correctable E-cache Tag ECC error */</span>
<span class="cp">#define CHPAFSR_TSCE		(1UL &lt;&lt; 56UL) </span><span class="cm">/* ch+ */</span><span class="cp"></span>
<span class="cm">/* Parity error on system snoop results */</span>
<span class="cp">#define JPAFSR_SCE		(1UL &lt;&lt; 56UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable E-cache Tag ECC error */</span>
<span class="cp">#define CHPAFSR_TUE		(1UL &lt;&lt; 55UL) </span><span class="cm">/* ch+ */</span><span class="cp"></span>
<span class="cm">/* System interface protocol error, illegal command detected */</span>
<span class="cp">#define JPAFSR_JEIC		(1UL &lt;&lt; 55UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable system bus data ECC error due to prefetch</span>
<span class="cm"> * or store fill request</span>
<span class="cm"> */</span>
<span class="cp">#define CHPAFSR_DUE		(1UL &lt;&lt; 54UL) </span><span class="cm">/* ch+ */</span><span class="cp"></span>
<span class="cm">/* System interface protocol error, illegal ADTYPE detected */</span>
<span class="cp">#define JPAFSR_JEIT		(1UL &lt;&lt; 54UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Multiple errors of the same type have occurred.  This bit is set when</span>
<span class="cm"> * an uncorrectable error or a SW correctable error occurs and the status</span>
<span class="cm"> * bit to report that error is already set.  When multiple errors of</span>
<span class="cm"> * different types are indicated by setting multiple status bits.</span>
<span class="cm"> *</span>
<span class="cm"> * This bit is not set if multiple HW corrected errors with the same</span>
<span class="cm"> * status bit occur, only uncorrectable and SW correctable ones have</span>
<span class="cm"> * this behavior.</span>
<span class="cm"> *</span>
<span class="cm"> * This bit is not set when multiple ECC errors happen within a single</span>
<span class="cm"> * 64-byte system bus transaction.  Only the first ECC error in a 16-byte</span>
<span class="cm"> * subunit will be logged.  All errors in subsequent 16-byte subunits</span>
<span class="cm"> * from the same 64-byte transaction are ignored.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_ME		(1UL &lt;&lt; 53UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Privileged state error has occurred.  This is a capture of PSTATE.PRIV</span>
<span class="cm"> * at the time the error is detected.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_PRIV		(1UL &lt;&lt; 52UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* The following bits 51 (CHAFSR_PERR) to 33 (CHAFSR_CE) are sticky error</span>
<span class="cm"> * bits and record the most recently detected errors.  Bits accumulate</span>
<span class="cm"> * errors that have been detected since the last write to clear the bit.</span>
<span class="cm"> */</span>

<span class="cm">/* System interface protocol error.  The processor asserts its&#39; ERROR</span>
<span class="cm"> * pin when this event occurs and it also logs a specific cause code</span>
<span class="cm"> * into a JTAG scannable flop.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_PERR		(1UL &lt;&lt; 51UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Internal processor error.  The processor asserts its&#39; ERROR</span>
<span class="cm"> * pin when this event occurs and it also logs a specific cause code</span>
<span class="cm"> * into a JTAG scannable flop.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_IERR		(1UL &lt;&lt; 50UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* System request parity error on incoming address */</span>
<span class="cp">#define CHAFSR_ISAP		(1UL &lt;&lt; 49UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* HW Corrected system bus MTAG ECC error */</span>
<span class="cp">#define CHAFSR_EMC		(1UL &lt;&lt; 48UL) </span><span class="cm">/* ch,ch+ */</span><span class="cp"></span>
<span class="cm">/* Parity error on L2 cache tag SRAM */</span>
<span class="cp">#define JPAFSR_ETP		(1UL &lt;&lt; 48UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable system bus MTAG ECC error */</span>
<span class="cp">#define CHAFSR_EMU		(1UL &lt;&lt; 47UL) </span><span class="cm">/* ch,ch+ */</span><span class="cp"></span>
<span class="cm">/* Out of range memory error has occurred */</span>
<span class="cp">#define JPAFSR_OM		(1UL &lt;&lt; 47UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* HW Corrected system bus data ECC error for read of interrupt vector */</span>
<span class="cp">#define CHAFSR_IVC		(1UL &lt;&lt; 46UL) </span><span class="cm">/* ch,ch+ */</span><span class="cp"></span>
<span class="cm">/* Error due to unsupported store */</span>
<span class="cp">#define JPAFSR_UMS		(1UL &lt;&lt; 46UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable system bus data ECC error for read of interrupt vector */</span>
<span class="cp">#define CHAFSR_IVU		(1UL &lt;&lt; 45UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Unmapped error from system bus */</span>
<span class="cp">#define CHAFSR_TO		(1UL &lt;&lt; 44UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Bus error response from system bus */</span>
<span class="cp">#define CHAFSR_BERR		(1UL &lt;&lt; 43UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* SW Correctable E-cache ECC error for instruction fetch or data access</span>
<span class="cm"> * other than block load.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_UCC		(1UL &lt;&lt; 42UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable E-cache ECC error for instruction fetch or data access</span>
<span class="cm"> * other than block load.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_UCU		(1UL &lt;&lt; 41UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Copyout HW Corrected ECC error */</span>
<span class="cp">#define CHAFSR_CPC		(1UL &lt;&lt; 40UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Copyout Uncorrectable ECC error */</span>
<span class="cp">#define CHAFSR_CPU		(1UL &lt;&lt; 39UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* HW Corrected ECC error from E-cache for writeback */</span>
<span class="cp">#define CHAFSR_WDC		(1UL &lt;&lt; 38UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable ECC error from E-cache for writeback */</span>
<span class="cp">#define CHAFSR_WDU		(1UL &lt;&lt; 37UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* HW Corrected ECC error from E-cache for store merge or block load */</span>
<span class="cp">#define CHAFSR_EDC		(1UL &lt;&lt; 36UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable ECC error from E-cache for store merge or block load */</span>
<span class="cp">#define CHAFSR_EDU		(1UL &lt;&lt; 35UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable system bus data ECC error for read of memory or I/O */</span>
<span class="cp">#define CHAFSR_UE		(1UL &lt;&lt; 34UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* HW Corrected system bus data ECC error for read of memory or I/O */</span>
<span class="cp">#define CHAFSR_CE		(1UL &lt;&lt; 33UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>

<span class="cm">/* Uncorrectable ECC error from remote cache/memory */</span>
<span class="cp">#define JPAFSR_RUE		(1UL &lt;&lt; 32UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Correctable ECC error from remote cache/memory */</span>
<span class="cp">#define JPAFSR_RCE		(1UL &lt;&lt; 31UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* JBUS parity error on returned read data */</span>
<span class="cp">#define JPAFSR_BP		(1UL &lt;&lt; 30UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* JBUS parity error on data for writeback or block store */</span>
<span class="cp">#define JPAFSR_WBP		(1UL &lt;&lt; 29UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Foreign read to DRAM incurring correctable ECC error */</span>
<span class="cp">#define JPAFSR_FRC		(1UL &lt;&lt; 28UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cm">/* Foreign read to DRAM incurring uncorrectable ECC error */</span>
<span class="cp">#define JPAFSR_FRU		(1UL &lt;&lt; 27UL) </span><span class="cm">/* jp */</span><span class="cp"></span>

<span class="cp">#define CHAFSR_ERRORS		(CHAFSR_PERR | CHAFSR_IERR | CHAFSR_ISAP | CHAFSR_EMC | \</span>
<span class="cp">				 CHAFSR_EMU | CHAFSR_IVC | CHAFSR_IVU | CHAFSR_TO | \</span>
<span class="cp">				 CHAFSR_BERR | CHAFSR_UCC | CHAFSR_UCU | CHAFSR_CPC | \</span>
<span class="cp">				 CHAFSR_CPU | CHAFSR_WDC | CHAFSR_WDU | CHAFSR_EDC | \</span>
<span class="cp">				 CHAFSR_EDU | CHAFSR_UE | CHAFSR_CE)</span>
<span class="cp">#define CHPAFSR_ERRORS		(CHPAFSR_DTO | CHPAFSR_DBERR | CHPAFSR_THCE | \</span>
<span class="cp">				 CHPAFSR_TSCE | CHPAFSR_TUE | CHPAFSR_DUE | \</span>
<span class="cp">				 CHAFSR_PERR | CHAFSR_IERR | CHAFSR_ISAP | CHAFSR_EMC | \</span>
<span class="cp">				 CHAFSR_EMU | CHAFSR_IVC | CHAFSR_IVU | CHAFSR_TO | \</span>
<span class="cp">				 CHAFSR_BERR | CHAFSR_UCC | CHAFSR_UCU | CHAFSR_CPC | \</span>
<span class="cp">				 CHAFSR_CPU | CHAFSR_WDC | CHAFSR_WDU | CHAFSR_EDC | \</span>
<span class="cp">				 CHAFSR_EDU | CHAFSR_UE | CHAFSR_CE)</span>
<span class="cp">#define JPAFSR_ERRORS		(JPAFSR_JETO | JPAFSR_SCE | JPAFSR_JEIC | \</span>
<span class="cp">				 JPAFSR_JEIT | CHAFSR_PERR | CHAFSR_IERR | \</span>
<span class="cp">				 CHAFSR_ISAP | JPAFSR_ETP | JPAFSR_OM | \</span>
<span class="cp">				 JPAFSR_UMS | CHAFSR_IVU | CHAFSR_TO | \</span>
<span class="cp">				 CHAFSR_BERR | CHAFSR_UCC | CHAFSR_UCU | \</span>
<span class="cp">				 CHAFSR_CPC | CHAFSR_CPU | CHAFSR_WDC | \</span>
<span class="cp">				 CHAFSR_WDU | CHAFSR_EDC | CHAFSR_EDU | \</span>
<span class="cp">				 CHAFSR_UE | CHAFSR_CE | JPAFSR_RUE | \</span>
<span class="cp">				 JPAFSR_RCE | JPAFSR_BP | JPAFSR_WBP | \</span>
<span class="cp">				 JPAFSR_FRC | JPAFSR_FRU)</span>

<span class="cm">/* Active JBUS request signal when error occurred */</span>
<span class="cp">#define JPAFSR_JBREQ		(0x7UL &lt;&lt; 24UL) </span><span class="cm">/* jp */</span><span class="cp"></span>
<span class="cp">#define JPAFSR_JBREQ_SHIFT	24UL</span>

<span class="cm">/* L2 cache way information */</span>
<span class="cp">#define JPAFSR_ETW		(0x3UL &lt;&lt; 22UL) </span><span class="cm">/* jp */</span><span class="cp"></span>
<span class="cp">#define JPAFSR_ETW_SHIFT	22UL</span>

<span class="cm">/* System bus MTAG ECC syndrome.  This field captures the status of the</span>
<span class="cm"> * first occurrence of the highest-priority error according to the M_SYND</span>
<span class="cm"> * overwrite policy.  After the AFSR sticky bit, corresponding to the error</span>
<span class="cm"> * for which the M_SYND is reported, is cleared, the contents of the M_SYND</span>
<span class="cm"> * field will be unchanged by will be unfrozen for further error capture.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_M_SYNDROME	(0xfUL &lt;&lt; 16UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>
<span class="cp">#define CHAFSR_M_SYNDROME_SHIFT	16UL</span>

<span class="cm">/* Agenid Id of the foreign device causing the UE/CE errors */</span>
<span class="cp">#define JPAFSR_AID		(0x1fUL &lt;&lt; 9UL) </span><span class="cm">/* jp */</span><span class="cp"></span>
<span class="cp">#define JPAFSR_AID_SHIFT	9UL</span>

<span class="cm">/* System bus or E-cache data ECC syndrome.  This field captures the status</span>
<span class="cm"> * of the first occurrence of the highest-priority error according to the</span>
<span class="cm"> * E_SYND overwrite policy.  After the AFSR sticky bit, corresponding to the</span>
<span class="cm"> * error for which the E_SYND is reported, is cleare, the contents of the E_SYND</span>
<span class="cm"> * field will be unchanged but will be unfrozen for further error capture.</span>
<span class="cm"> */</span>
<span class="cp">#define CHAFSR_E_SYNDROME	(0x1ffUL &lt;&lt; 0UL) </span><span class="cm">/* ch,ch+,jp */</span><span class="cp"></span>
<span class="cp">#define CHAFSR_E_SYNDROME_SHIFT	0UL</span>

<span class="cm">/* The AFSR must be explicitly cleared by software, it is not cleared automatically</span>
<span class="cm"> * by a read.  Writes to bits &lt;51:33&gt; with bits set will clear the corresponding</span>
<span class="cm"> * bits in the AFSR.  Bits associated with disrupting traps must be cleared before</span>
<span class="cm"> * interrupts are re-enabled to prevent multiple traps for the same error.  I.e.</span>
<span class="cm"> * PSTATE.IE and AFSR bits control delivery of disrupting traps.</span>
<span class="cm"> *</span>
<span class="cm"> * Since there is only one AFAR, when multiple events have been logged by the</span>
<span class="cm"> * bits in the AFSR, at most one of these events will have its status captured</span>
<span class="cm"> * in the AFAR.  The highest priority of those event bits will get AFAR logging.</span>
<span class="cm"> * The AFAR will be unlocked and available to capture the address of another event</span>
<span class="cm"> * as soon as the one bit in AFSR that corresponds to the event logged in AFAR is</span>
<span class="cm"> * cleared.  For example, if AFSR.CE is detected, then AFSR.UE (which overwrites</span>
<span class="cm"> * the AFAR), and AFSR.UE is cleared by not AFSR.CE, then the AFAR will be unlocked</span>
<span class="cm"> * and ready for another event, even though AFSR.CE is still set.  The same rules</span>
<span class="cm"> * also apply to the M_SYNDROME and E_SYNDROME fields of the AFSR.</span>
<span class="cm"> */</span>

<span class="cp">#endif </span><span class="cm">/* _SPARC64_CHAFSR_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
