f | Makefile | g | 1.6K |  | David Miller | davem@davemloft.net | 1338057234 |  | sparc: use the new generic strnlen_user() function  This throws away the sparc-specific functions in favor of the generic optimized version.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | GENbzero.S | g | 3.2K |  | David S. Miller | davem@davemloft.net | 1234159255 |  | sparc64: Kill .fixup section bloat.  This is an implementation of a suggestion made by Chris Torek: -------------------- Something else I noticed in passing: the EX and EX_LD/EX_ST macros scattered throughout the various .S files make a fair bit of .fixup code, all of which does the same thing.  At the cost of one symbol in copy_in_user.S, you could just have one common two-instruction retl-and-mov-1 fixup that they all share. --------------------  The following is with a defconfig build:     text	   data	    bss	    dec	    hex	filename 3972767	 344024	 584449	4901240	 4ac978	vmlinux.orig 3968887	 344024	 584449	4897360	 4aba50	vmlinux  Signed-off-by: David S. Miller <davem@davemloft.net>
f | blockops.S | g | 2.5K |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | clear_page.S | g | 2.4K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bitops.S | g | 2.4K |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | NGbzero.S | g | 3.3K |  | David S. Miller | davem@davemloft.net | 1234159255 |  | sparc64: Kill .fixup section bloat.  This is an implementation of a suggestion made by Chris Torek: -------------------- Something else I noticed in passing: the EX and EX_LD/EX_ST macros scattered throughout the various .S files make a fair bit of .fixup code, all of which does the same thing.  At the cost of one symbol in copy_in_user.S, you could just have one common two-instruction retl-and-mov-1 fixup that they all share. --------------------  The following is with a defconfig build:     text	   data	    bss	    dec	    hex	filename 3972767	 344024	 584449	4901240	 4ac978	vmlinux.orig 3968887	 344024	 584449	4897360	 4aba50	vmlinux  Signed-off-by: David S. Miller <davem@davemloft.net>
f | PeeCeeI.c | s | 3.9K | 188 | Sam Ravnborg | sam@ravnborg.org | 1231462700 |  | sparc64: move EXPORT_SYMBOL to the symbols definition  Move all applicable EXPORT_SYMBOL()s to the file where the respective symbol is defined.  Removed all the includes that are no longer needed in sparc_ksyms_64.c  Comment all remaining EXPORT_SYMBOL()s in sparc_ksyms_64.c  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>  Additions by Julian Calaby: * Moved EXPORT_SYMBOL()s for prom functions to their rightful places. * Made some minor cleanups to the includes and comments of sparc_ksyms_64.c * Updated and tidied commit message. * Rebased patch over sparc-2.6.git HEAD. * Ensured that all modified files have the correct includes.  Signed-off-by: Julian Calaby <julian.calaby@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | COPYING.LIB | g | 24K |  | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | strncmp_32.S | g | 1.2K |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | NGpage.S | g | 3.4K |  | David S. Miller | davem@davemloft.net | 1312345712 |  | sparc: Minor tweaks to Niagara page copy/clear.  Don't use floating point on Niagara2, use the traditional plain Niagara code instead.  Unroll Niagara loops to 128 bytes for copy, and 256 bytes for clear.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | U3memcpy.S | g | 9.1K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | muldi3.S | g | 1.9K |  | David S. Miller | davem@davemloft.net | 1337106227 |  | sparc32: Kill off software 32-bit multiply/divide routines.  For the explicit calls to .udiv/.umul in assembler, I made a mechanical (read as: safe) transformation.  I didn't attempt to make any simplifications.  In particular, __ndelay and __udelay can be simplified significantly. Some of the %y reads are unnecessary and these routines have no need any longer for allocating a register window, they can be leaf functions.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | NG2copy_from_user.S | g | 703B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | iomap.c | s | 522B | 22 | Michael S. Tsirkin | mst@redhat.com | 1323007189 |  | sparc: switch to GENERIC_PCI_IOMAP  sparc copied pci_iomap from generic code, probably to avoid pulling the rest of iomap.c in.  Since that's in a separate file now, we can reuse the common implementation.  Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
f | NGmemcpy.S | g | 9.4K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | csum_copy.S | g | 6.9K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | NGcopy_from_user.S | g | 679B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | U1copy_to_user.S | g | 716B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | U3copy_to_user.S | g | 706B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | bitext.c | s | 2.9K | 119 | Akinobu Mita | akinobu.mita@gmail.com | 1297234373 |  | sparc: use bitmap_set()  Use bitmap_set() instead of calling __set_bit() each bit.  Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Cc: "David S. Miller" <davem@davemloft.net> Cc: sparclinux@vger.kernel.org Signed-off-by: David S. Miller <davem@davemloft.net>
f | memmove.S | g | 589B |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | xor.S | g | 15K |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | strncmp_64.S | g | 449B |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | VISsave.S | g | 2.9K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | usercopy.c | s | 196B | 8 | David S. Miller | davem@davemloft.net | 1337890348 |  | lib: Sparc's strncpy_from_user is generic enough, move under lib/  To use this, an architecture simply needs to:  1) Provide a user_addr_max() implementation via asm/uaccess.h  2) Add "select GENERIC_STRNCPY_FROM_USER" to their arch Kcnfig  3) Remove the existing strncpy_from_user() implementation and symbol    exports their architecture had.  Signed-off-by: David S. Miller <davem@davemloft.net> Acked-by: David Howells <dhowells@redhat.com>
f | memcpy.S | g | 11K |  | David S. Miller | davem@davemloft.net | 1319149043 |  | sparc32: Correct the return value of memcpy.  Properly return the original destination buffer pointer.  Signed-off-by: David S. Miller <davem@davemloft.net> Tested-by: Kjetil Oftedal <oftedal@gmail.com>
f | ashrdi3.S | g | 556B |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | memscan_32.S | g | 1.8K |  | Sam Ravnborg | sam@ravnborg.org | 1228411038 |  | sparc: prepare lib/ for unification  Identical named files renamed to <name>_32.S Refactored Makefile to prepare for unification.  Linking order was altered slightly - but this is a lib.a file so it should not matter.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mcount.S | g | 2.7K |  | David S. Miller | davem@davemloft.net | 1271210342 |  | sparc64: Allocate sufficient stack space in ftrace stubs.  128 bytes is sufficient for the register window save area, but the calling conventions allow the callee to save up to 6 incoming argument registers into the stack frame after the register window save area.  This means a minimal stack frame is 176 bytes (128 + (6 * 8)).  This fixes random crashes when using the function tracer.  Reported-by: Frederic Weisbecker <fweisbec@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | U3copy_from_user.S | g | 406B |  | David S. Miller | davem@davemloft.net | 1234159255 |  | sparc64: Kill .fixup section bloat.  This is an implementation of a suggestion made by Chris Torek: -------------------- Something else I noticed in passing: the EX and EX_LD/EX_ST macros scattered throughout the various .S files make a fair bit of .fixup code, all of which does the same thing.  At the cost of one symbol in copy_in_user.S, you could just have one common two-instruction retl-and-mov-1 fixup that they all share. --------------------  The following is with a defconfig build:     text	   data	    bss	    dec	    hex	filename 3972767	 344024	 584449	4901240	 4ac978	vmlinux.orig 3968887	 344024	 584449	4897360	 4aba50	vmlinux  Signed-off-by: David S. Miller <davem@davemloft.net>
f | NG2patch.S | g | 877B |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | memscan_64.S | g | 2.2K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ksyms.c | s | 4.2K | 135 | David Miller | davem@davemloft.net | 1338057234 |  | sparc: use the new generic strnlen_user() function  This throws away the sparc-specific functions in favor of the generic optimized version.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | user_fixup.c | s | 1.8K | 57 | Sam Ravnborg | sam@ravnborg.org | 1231462700 |  | sparc64: move EXPORT_SYMBOL to the symbols definition  Move all applicable EXPORT_SYMBOL()s to the file where the respective symbol is defined.  Removed all the includes that are no longer needed in sparc_ksyms_64.c  Comment all remaining EXPORT_SYMBOL()s in sparc_ksyms_64.c  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>  Additions by Julian Calaby: * Moved EXPORT_SYMBOL()s for prom functions to their rightful places. * Made some minor cleanups to the includes and comments of sparc_ksyms_64.c * Updated and tidied commit message. * Rebased patch over sparc-2.6.git HEAD. * Ensured that all modified files have the correct includes.  Signed-off-by: Julian Calaby <julian.calaby@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | copy_in_user.S | g | 1.6K |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | lshrdi3.S | g | 315B |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | memset.S | g | 3.7K |  | David S. Miller | davem@davemloft.net | 1260516730 |  | sparc: Stop trying to be so fancy and use __builtin_{memcpy,memset}()  This mirrors commit ff60fab71bb3b4fdbf8caf57ff3739ffd0887396 (x86: Use __builtin_memset and __builtin_memcpy for memset/memcpy)  Signed-off-by: David S. Miller <davem@davemloft.net>
f | ffs.S | g | 1.2K |  | David S. Miller | davem@davemloft.net | 1312345733 |  | sparc: Use popc when possible for ffs/__ffs/ffz.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | NGpatch.S | g | 866B |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | NG2memcpy.S | g | 11K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | U1copy_from_user.S | g | 720B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | csum_copy_from_user.S | g | 439B |  | David S. Miller | davem@davemloft.net | 1243638722 |  | sparc64: Fix section attribute warnings.  CSUM copy to/from user assembler was missing allocatable and executable attributes for .fixup  Signed-off-by: David S. Miller <davem@davemloft.net>
f | hweight.S | g | 846B |  | David S. Miller | davem@davemloft.net | 1312345730 |  | sparc: Use popc if possible for hweight routines.  Just like powerpc, we code patch at boot time.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | cmpdi2.c | s | 435B | 21 | David S. Miller | davem@sunset.davemloft.net | 1188179349 |  | [SPARC32]: Add __cmpdi2() libcall implementation ala. MIPS.  Device mapper generates calls to this with recent versions of gcc.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | divdi3.S | g | 5.5K |  | David S. Miller | davem@davemloft.net | 1337106227 |  | sparc32: Kill off software 32-bit multiply/divide routines.  For the explicit calls to .udiv/.umul in assembler, I made a mechanical (read as: safe) transformation.  I didn't attempt to make any simplifications.  In particular, __ndelay and __udelay can be simplified significantly. Some of the %y reads are unnecessary and these routines have no need any longer for allocating a register window, they can be leaf functions.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | atomic_64.S | g | 2.5K |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | memcmp.S | g | 478B |  | David S. Miller | davem@davemloft.net | 1228824547 |  | sparc: Commonize memcmp assembler.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | checksum_64.S | g | 3.8K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | GENcopy_from_user.S | g | 577B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | locks.S | g | 1.9K |  | Adrian Bunk | bunk@kernel.org | 1211268824 |  | sparc: remove CVS keywords  This patch removes the CVS keywords that weren't updated for a long time from comments.  Signed-off-by: Adrian Bunk <bunk@kernel.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | GENmemcpy.S | g | 1.9K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ucmpdi2.c | s | 501B | 17 | Sam Ravnborg | sam@ravnborg.org | 1337466237 |  | sparc32: add ucmpdi2  Based on copy from microblaze add ucmpdi2 implementation. This fixes build of niu driver which failed with:  drivers/built-in.o: In function `niu_get_nfc': niu.c:(.text+0x91494): undefined reference to `__ucmpdi2'  This driver will never be used on a sparc32 system, but patch added to fix build breakage with all*config builds.  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ashldi3.S | g | 462B |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | GENpatch.S | g | 874B |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | udivdi3.S | g | 5.3K |  | David S. Miller | davem@davemloft.net | 1337106227 |  | sparc32: Kill off software 32-bit multiply/divide routines.  For the explicit calls to .udiv/.umul in assembler, I made a mechanical (read as: safe) transformation.  I didn't attempt to make any simplifications.  In particular, __ndelay and __udelay can be simplified significantly. Some of the %y reads are unnecessary and these routines have no need any longer for allocating a register window, they can be leaf functions.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | libgcc.h | s | 262B | 13 | David S. Miller | davem@sunset.davemloft.net | 1188179349 |  | [SPARC32]: Add __cmpdi2() libcall implementation ala. MIPS.  Device mapper generates calls to this with recent versions of gcc.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | bzero.S | g | 3.3K |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | csum_copy_to_user.S | g | 431B |  | David S. Miller | davem@davemloft.net | 1243638722 |  | sparc64: Fix section attribute warnings.  CSUM copy to/from user assembler was missing allocatable and executable attributes for .fixup  Signed-off-by: David S. Miller <davem@davemloft.net>
f | copy_page.S | g | 5.8K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | GENpage.S | g | 1.6K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | NG2copy_to_user.S | g | 955B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | GENcopy_to_user.S | g | 697B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | U3patch.S | g | 881B |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | copy_user.S | g | 10K |  | David S. Miller | davem@sunset.davemloft.net | 1159571561 |  | [SPARC]: Don't zero out tail during copy_from_user_inatomic().  Actually, since we use the same code for all the copying types in and out of userspace, we check at runtime whether preemption is disabled.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | atomic32.c | s | 2.8K | 106 | Josip Rodin | joy@entuzijast.net | 1312451260 |  | sparc: Fix __atomic_add_unless() return value.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | checksum_32.S | g | 16K |  | Tkhai Kirill | tkhai@yandex.ru | 1305174904 |  | sparc32: Fixed unaligned memory copying in function __csum_partial_copy_sparc_generic  When we are in the label cc_dword_align, registers %o0 and %o1 have the same last 2 bits, but it's not guaranteed one of them is zero. So we can get unaligned memory access in label ccte. Example of parameters which lead to this: %o0=0x7ff183e9, %o1=0x8e709e7d, %g1=3  With the parameters I had a memory corruption, when the additional 5 bytes were rewritten. This patch corrects the error.  One comment to the patch. We don't care about the third bit in %o1, because cc_end_cruft stores word or less.  Signed-off-by: Tkhai Kirill <tkhai@yandex.ru> Signed-off-by: David S. Miller <davem@davemloft.net>
f | NGcopy_to_user.S | g | 752B |  | David S. Miller | davem@davemloft.net | 1234161151 |  | sparc64: Fix probe_kernel_{read,write}().  This is based upon a report from Chris Torek and his initial patch. From Chris's report:  -------------------- This came up in testing kgdb, using the built-in tests -- turn on CONFIG_KGDB_TESTS, then      echo V1 > /sys/module/kgdbts/parameters/kgdbts  -- but it would affect using kgdb if you were debugging and looking at bad pointers. --------------------  When we get a copy_{from,to}_user() request and the %asi is set to something other than ASI_AIUS (which is userspace) then we branch off to a routine called memcpy_user_stub().  It just does a straight memcpy since we are copying from kernel to kernel in this case.  The logic was that since source and destination are both kernel pointers we don't need to have exception checks.  But for what probe_kernel_{read,write}() is trying to do, we have to have the checks, otherwise things like kgdb bad kernel pointer accesses don't do the right thing.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | U1memcpy.S | g | 14K |  | Sam Ravnborg | sam@ravnborg.org | 1228411039 |  | sparc,sparc64: unify lib/  o Renamed files in sparc64 to <name>_64.S when identical   to sparc32 files. o iomap.c were equal for sparc32 and sparc64 o adjusted sparc/Makefile now we have only one lib/  Signed-off-by: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | strlen.S | g | 1.5K |  | David S. Miller | davem@davemloft.net | 1228813629 |  | sparc: Unify strlen assembler.  Use the new asm/asm.h header to help commonize the strlen assembler between 32-bit and 64-bit  While we're here, use proper linux/linkage.h macros instead of by-hand stuff.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | ipcsum.S | g | 616B |  | David S. Miller | davem@davemloft.net | 1336793602 |  | sparc: Convert some assembler over to linakge.h's ENTRY/ENDPROC  Use those, instead of doing it all by hand.  Signed-off-by: David S. Miller <davem@davemloft.net>
