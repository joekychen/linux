<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › alpha › include › asm › core_wildfire.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>core_wildfire.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __ALPHA_WILDFIRE__H__</span>
<span class="cp">#define __ALPHA_WILDFIRE__H__</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;asm/compiler.h&gt;</span>

<span class="cp">#define WILDFIRE_MAX_QBB	8	</span><span class="cm">/* more than 8 requires other mods */</span><span class="cp"></span>
<span class="cp">#define WILDFIRE_PCA_PER_QBB	4</span>
<span class="cp">#define WILDFIRE_IRQ_PER_PCA	64</span>

<span class="cp">#define WILDFIRE_NR_IRQS \</span>
<span class="cp">  (WILDFIRE_MAX_QBB * WILDFIRE_PCA_PER_QBB * WILDFIRE_IRQ_PER_PCA)</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">wildfire_hard_qbb_map</span><span class="p">[</span><span class="n">WILDFIRE_MAX_QBB</span><span class="p">];</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">wildfire_soft_qbb_map</span><span class="p">[</span><span class="n">WILDFIRE_MAX_QBB</span><span class="p">];</span>
<span class="cp">#define QBB_MAP_EMPTY	0xff</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_hard_qbb_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_soft_qbb_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_gp_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_hs_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_iop_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_ior_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_pca_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_cpu_mask</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">wildfire_mem_mask</span><span class="p">;</span>

<span class="cp">#define WILDFIRE_QBB_EXISTS(qbbno) (wildfire_soft_qbb_mask &amp; (1 &lt;&lt; (qbbno)))</span>

<span class="cp">#define WILDFIRE_MEM_EXISTS(qbbno) (wildfire_mem_mask &amp; (0xf &lt;&lt; ((qbbno) &lt;&lt; 2)))</span>

<span class="cp">#define WILDFIRE_PCA_EXISTS(qbbno, pcano) \</span>
<span class="cp">		(wildfire_pca_mask &amp; (1 &lt;&lt; (((qbbno) &lt;&lt; 2) + (pcano))))</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="k">volatile</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">csr</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">64</span><span class="p">)));</span>
<span class="p">}</span> <span class="n">wildfire_64</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="k">volatile</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">csr</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">256</span><span class="p">)));</span>
<span class="p">}</span> <span class="n">wildfire_256</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="k">volatile</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">csr</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">2048</span><span class="p">)));</span>
<span class="p">}</span> <span class="n">wildfire_2k</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_whami</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_rev</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_port_present</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_port_active</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_fault_ena</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_cpu_int_ena</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_mem_config</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">ce_sum</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">dev_init</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">it_int</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">ip_int</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">uce_sum</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">se_sum__non_dev_int</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">scratch</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_timer</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">qsd_diag</span><span class="p">;</span>
<span class="p">}</span> <span class="n">wildfire_qsd</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_256</span>	<span class="n">qsd_whami</span><span class="p">;</span>
	<span class="n">wildfire_256</span>	<span class="n">__pad1</span><span class="p">;</span>
	<span class="n">wildfire_256</span>	<span class="n">ce_sum</span><span class="p">;</span>
	<span class="n">wildfire_256</span>	<span class="n">dev_init</span><span class="p">;</span>
	<span class="n">wildfire_256</span>	<span class="n">it_int</span><span class="p">;</span>
	<span class="n">wildfire_256</span>	<span class="n">ip_int</span><span class="p">;</span>
	<span class="n">wildfire_256</span>	<span class="n">uce_sum</span><span class="p">;</span>
	<span class="n">wildfire_256</span>	<span class="n">se_sum</span><span class="p">;</span>
<span class="p">}</span> <span class="n">wildfire_fast_qsd</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_qbb_id</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">__pad1</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_port_ena</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_scratch</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_config</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_ref_int</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_qbb_pop</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_dtag_fc</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">__pad2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_diag</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_diag_lock</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">__pad3</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_cpu_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_misc_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_tmo_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_err_ena</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_tmo_config</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_ill_cmd_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">__pad4</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_busy_mask</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_arr_valid</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">__pad5</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_port_map</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_arr_addr</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">qsa_arr_mask</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">wildfire_qsa</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_config</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_config</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iop_switch_credits</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad1</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iop_hose_credits</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad2</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">wildfire_64</span>	<span class="n">__pad3</span><span class="p">;</span>
		<span class="n">wildfire_64</span>	<span class="n">init</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">iop_hose</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_hose_0_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_hose_0_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_hose_1_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_hose_1_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_hose_2_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_hose_2_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_hose_3_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_hose_3_ctrl</span><span class="p">;</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">wildfire_64</span>	<span class="n">target</span><span class="p">;</span>
		<span class="n">wildfire_64</span>	<span class="n">__pad4</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">iop_dev_int</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

	<span class="n">wildfire_64</span>	<span class="n">iop_err_int_target</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad5</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">iop_qbb_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad6</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iop_qbb_se_sum</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad7</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad8</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_diag_force_err</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_diag_force_err</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad9</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">iop_diag_send_err_int</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad10</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">ioa_scratch</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">iod_scratch</span><span class="p">;</span>
<span class="p">}</span> <span class="n">wildfire_iop</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_2k</span>	<span class="n">gpa_qbb_map</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_2k</span>	<span class="n">gpa_mem_pop_map</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">gpa_scratch</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">gpa_diag</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">gpa_config_0</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">__pad1</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">gpa_init_id</span><span class="p">;</span>
	<span class="n">wildfire_2k</span>	<span class="n">gpa_config_2</span><span class="p">;</span>
	<span class="cm">/* not complete */</span>
<span class="p">}</span> <span class="n">wildfire_gp</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_what_am_i</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_diag_force_err</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_diag_send_err_int</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_hose_credits</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_scratch</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_micro_addr</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_micro_data</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_pend_int</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_sent_int</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad1</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_stdio_edge_level</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad2</span><span class="p">[</span><span class="mi">52</span><span class="p">];</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">wildfire_64</span>	<span class="n">target</span><span class="p">;</span>
		<span class="n">wildfire_64</span>	<span class="n">enable</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">pca_int</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad3</span><span class="p">[</span><span class="mi">56</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">pca_alt_sent_int</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
<span class="p">}</span> <span class="n">wildfire_pca</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_64</span>	<span class="n">ne_what_am_i</span><span class="p">;</span>
	<span class="cm">/* not complete */</span>
<span class="p">}</span> <span class="n">wildfire_ne</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_64</span>	<span class="n">fe_what_am_i</span><span class="p">;</span>
	<span class="cm">/* not complete */</span>
<span class="p">}</span> <span class="n">wildfire_fe</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_io_addr_ext</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_ctrl</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_err_sum</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_err_addr</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_stall_cnt</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_iack_special</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_pend_int</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_sent_int</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">__pad2</span><span class="p">[</span><span class="mi">54</span><span class="p">];</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">wildfire_64</span>	<span class="n">wbase</span><span class="p">;</span>
		<span class="n">wildfire_64</span>	<span class="n">wmask</span><span class="p">;</span>
		<span class="n">wildfire_64</span>	<span class="n">tbase</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">pci_window</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_flush_tlb</span><span class="p">;</span>
	<span class="n">wildfire_64</span>	<span class="n">pci_perf_mon</span><span class="p">;</span>
<span class="p">}</span> <span class="n">wildfire_pci</span><span class="p">;</span>

<span class="cp">#define WILDFIRE_ENTITY_SHIFT		18</span>

<span class="cp">#define WILDFIRE_GP_ENTITY		(0x10UL &lt;&lt; WILDFIRE_ENTITY_SHIFT)</span>
<span class="cp">#define WILDFIRE_IOP_ENTITY		(0x08UL &lt;&lt; WILDFIRE_ENTITY_SHIFT)</span>
<span class="cp">#define WILDFIRE_QSA_ENTITY		(0x04UL &lt;&lt; WILDFIRE_ENTITY_SHIFT)</span>
<span class="cp">#define WILDFIRE_QSD_ENTITY_SLOW	(0x05UL &lt;&lt; WILDFIRE_ENTITY_SHIFT)</span>
<span class="cp">#define WILDFIRE_QSD_ENTITY_FAST	(0x01UL &lt;&lt; WILDFIRE_ENTITY_SHIFT)</span>

<span class="cp">#define WILDFIRE_PCA_ENTITY(pca)	((0xc|(pca))&lt;&lt;WILDFIRE_ENTITY_SHIFT)</span>

<span class="cp">#define WILDFIRE_BASE		(IDENT_ADDR | (1UL &lt;&lt; 40))</span>

<span class="cp">#define WILDFIRE_QBB_MASK	0x0fUL	</span><span class="cm">/* for now, only 4 bits/16 QBBs */</span><span class="cp"></span>

<span class="cp">#define WILDFIRE_QBB(q)		((~((long)(q)) &amp; WILDFIRE_QBB_MASK) &lt;&lt; 36)</span>
<span class="cp">#define WILDFIRE_HOSE(h)	((long)(h) &lt;&lt; 33)</span>

<span class="cp">#define WILDFIRE_QBB_IO(q)	(WILDFIRE_BASE | WILDFIRE_QBB(q))</span>
<span class="cp">#define WILDFIRE_QBB_HOSE(q,h)	(WILDFIRE_QBB_IO(q) | WILDFIRE_HOSE(h))</span>

<span class="cp">#define WILDFIRE_MEM(q,h)	(WILDFIRE_QBB_HOSE(q,h) | 0x000000000UL)</span>
<span class="cp">#define WILDFIRE_CONF(q,h)	(WILDFIRE_QBB_HOSE(q,h) | 0x1FE000000UL)</span>
<span class="cp">#define WILDFIRE_IO(q,h)	(WILDFIRE_QBB_HOSE(q,h) | 0x1FF000000UL)</span>

<span class="cp">#define WILDFIRE_qsd(q) \</span>
<span class="cp"> ((wildfire_qsd *)(WILDFIRE_QBB_IO(q)|WILDFIRE_QSD_ENTITY_SLOW|(((1UL&lt;&lt;13)-1)&lt;&lt;23)))</span>

<span class="cp">#define WILDFIRE_fast_qsd() \</span>
<span class="cp"> ((wildfire_fast_qsd *)(WILDFIRE_QBB_IO(0)|WILDFIRE_QSD_ENTITY_FAST|(((1UL&lt;&lt;13)-1)&lt;&lt;23)))</span>

<span class="cp">#define WILDFIRE_qsa(q) \</span>
<span class="cp"> ((wildfire_qsa *)(WILDFIRE_QBB_IO(q)|WILDFIRE_QSA_ENTITY|(((1UL&lt;&lt;13)-1)&lt;&lt;23)))</span>

<span class="cp">#define WILDFIRE_iop(q) \</span>
<span class="cp"> ((wildfire_iop *)(WILDFIRE_QBB_IO(q)|WILDFIRE_IOP_ENTITY|(((1UL&lt;&lt;13)-1)&lt;&lt;23)))</span>

<span class="cp">#define WILDFIRE_gp(q) \</span>
<span class="cp"> ((wildfire_gp *)(WILDFIRE_QBB_IO(q)|WILDFIRE_GP_ENTITY|(((1UL&lt;&lt;13)-1)&lt;&lt;23)))</span>

<span class="cp">#define WILDFIRE_pca(q,pca) \</span>
<span class="cp"> ((wildfire_pca *)(WILDFIRE_QBB_IO(q)|WILDFIRE_PCA_ENTITY(pca)|(((1UL&lt;&lt;13)-1)&lt;&lt;23)))</span>

<span class="cp">#define WILDFIRE_ne(q,pca) \</span>
<span class="cp"> ((wildfire_ne *)(WILDFIRE_QBB_IO(q)|WILDFIRE_PCA_ENTITY(pca)|(((1UL&lt;&lt;13)-1)&lt;&lt;23)|(1UL&lt;&lt;16)))</span>

<span class="cp">#define WILDFIRE_fe(q,pca) \</span>
<span class="cp"> ((wildfire_fe *)(WILDFIRE_QBB_IO(q)|WILDFIRE_PCA_ENTITY(pca)|(((1UL&lt;&lt;13)-1)&lt;&lt;23)|(3UL&lt;&lt;15)))</span>

<span class="cp">#define WILDFIRE_pci(q,h) \</span>
<span class="cp"> ((wildfire_pci *)(WILDFIRE_QBB_IO(q)|WILDFIRE_PCA_ENTITY(((h)&amp;6)&gt;&gt;1)|((((h)&amp;1)|2)&lt;&lt;16)|(((1UL&lt;&lt;13)-1)&lt;&lt;23)))</span>

<span class="cp">#define WILDFIRE_IO_BIAS        WILDFIRE_IO(0,0)</span>
<span class="cp">#define WILDFIRE_MEM_BIAS       WILDFIRE_MEM(0,0) </span><span class="cm">/* ??? */</span><span class="cp"></span>

<span class="cm">/* The IO address space is larger than 0xffff */</span>
<span class="cp">#define WILDFIRE_IO_SPACE	(8UL*1024*1024)</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#ifndef __EXTERN_INLINE</span>
<span class="cp">#define __EXTERN_INLINE extern inline</span>
<span class="cp">#define __IO_EXTERN_INLINE</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * Memory functions.  all accesses are done through linear space.</span>
<span class="cm"> */</span>

<span class="n">__EXTERN_INLINE</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="nf">wildfire_ioportmap</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">)(</span><span class="n">addr</span> <span class="o">+</span> <span class="n">WILDFIRE_IO_BIAS</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">__EXTERN_INLINE</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="nf">wildfire_ioremap</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">,</span> 
					       <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">size</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="p">)(</span><span class="n">addr</span> <span class="o">+</span> <span class="n">WILDFIRE_MEM_BIAS</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">__EXTERN_INLINE</span> <span class="kt">int</span> <span class="nf">wildfire_is_ioaddr</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">addr</span> <span class="o">&gt;=</span> <span class="n">WILDFIRE_BASE</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">__EXTERN_INLINE</span> <span class="kt">int</span> <span class="nf">wildfire_is_mmio</span><span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">xaddr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span><span class="n">xaddr</span><span class="p">;</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&amp;</span> <span class="mh">0x100000000UL</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#undef __IO_PREFIX</span>
<span class="cp">#define __IO_PREFIX			wildfire</span>
<span class="cp">#define wildfire_trivial_rw_bw		1</span>
<span class="cp">#define wildfire_trivial_rw_lq		1</span>
<span class="cp">#define wildfire_trivial_io_bw		1</span>
<span class="cp">#define wildfire_trivial_io_lq		1</span>
<span class="cp">#define wildfire_trivial_iounmap	1</span>
<span class="cp">#include &lt;asm/io_trivial.h&gt;</span>

<span class="cp">#ifdef __IO_EXTERN_INLINE</span>
<span class="cp">#undef __EXTERN_INLINE</span>
<span class="cp">#undef __IO_EXTERN_INLINE</span>
<span class="cp">#endif</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* __ALPHA_WILDFIRE__H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
