<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › alpha › include › asm › core_tsunami.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>core_tsunami.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __ALPHA_TSUNAMI__H__</span>
<span class="cp">#define __ALPHA_TSUNAMI__H__</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;asm/compiler.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * TSUNAMI/TYPHOON are the internal names for the core logic chipset which</span>
<span class="cm"> * provides memory controller and PCI access for the 21264 based systems.</span>
<span class="cm"> *</span>
<span class="cm"> * This file is based on:</span>
<span class="cm"> *</span>
<span class="cm"> * Tsunami System Programmers Manual</span>
<span class="cm"> * Preliminary, Chapters 2-5</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/* XXX: Do we need to conditionalize on this?  */</span>
<span class="cp">#ifdef USE_48_BIT_KSEG</span>
<span class="cp">#define TS_BIAS 0x80000000000UL</span>
<span class="cp">#else</span>
<span class="cp">#define TS_BIAS 0x10000000000UL</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * CChip, DChip, and PChip registers</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="k">volatile</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">csr</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">64</span><span class="p">)));</span>
<span class="p">}</span> <span class="n">tsunami_64</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">tsunami_64</span>	<span class="n">csc</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">mtr</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">misc</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">mpd</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">aar0</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">aar1</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">aar2</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">aar3</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dim0</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dim1</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dir0</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dir1</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">drir</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">prben</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">iic</span><span class="p">;</span>	<span class="cm">/* a.k.a. iic0 */</span>
	<span class="n">tsunami_64</span>	<span class="n">wdr</span><span class="p">;</span>	<span class="cm">/* a.k.a. iic1 */</span>
	<span class="n">tsunami_64</span>	<span class="n">mpr0</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">mpr1</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">mpr2</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">mpr3</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">mctl</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">__pad1</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">ttr</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">tdr</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dim2</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dim3</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dir2</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">dir3</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">iic2</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">iic3</span><span class="p">;</span>
<span class="p">}</span> <span class="n">tsunami_cchip</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">tsunami_64</span>	<span class="n">dsc</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">str</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">drev</span><span class="p">;</span>
<span class="p">}</span> <span class="n">tsunami_dchip</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">tsunami_64</span>	<span class="n">wsba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">tsunami_64</span>	<span class="n">wsm</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">tsunami_64</span>	<span class="n">tba</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">tsunami_64</span>	<span class="n">pctl</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">plat</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">reserved</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">perror</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">perrmask</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">perrset</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">tlbiv</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">tlbia</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">pmonctl</span><span class="p">;</span>
	<span class="n">tsunami_64</span>	<span class="n">pmoncnt</span><span class="p">;</span>
<span class="p">}</span> <span class="n">tsunami_pchip</span><span class="p">;</span>

<span class="cp">#define TSUNAMI_cchip  ((tsunami_cchip *)(IDENT_ADDR+TS_BIAS+0x1A0000000UL))</span>
<span class="cp">#define TSUNAMI_dchip  ((tsunami_dchip *)(IDENT_ADDR+TS_BIAS+0x1B0000800UL))</span>
<span class="cp">#define TSUNAMI_pchip0 ((tsunami_pchip *)(IDENT_ADDR+TS_BIAS+0x180000000UL))</span>
<span class="cp">#define TSUNAMI_pchip1 ((tsunami_pchip *)(IDENT_ADDR+TS_BIAS+0x380000000UL))</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">TSUNAMI_bootcpu</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * TSUNAMI Pchip Error register.</span>
<span class="cm"> */</span>

<span class="cp">#define perror_m_lost 0x1</span>
<span class="cp">#define perror_m_serr 0x2</span>
<span class="cp">#define perror_m_perr 0x4</span>
<span class="cp">#define perror_m_dcrto 0x8</span>
<span class="cp">#define perror_m_sge 0x10</span>
<span class="cp">#define perror_m_ape 0x20</span>
<span class="cp">#define perror_m_ta 0x40</span>
<span class="cp">#define perror_m_rdpe 0x80</span>
<span class="cp">#define perror_m_nds 0x100</span>
<span class="cp">#define perror_m_rto 0x200</span>
<span class="cp">#define perror_m_uecc 0x400</span>
<span class="cp">#define perror_m_cre 0x800</span>
<span class="cp">#define perror_m_addrl 0xFFFFFFFF0000UL</span>
<span class="cp">#define perror_m_addrh 0x7000000000000UL</span>
<span class="cp">#define perror_m_cmd 0xF0000000000000UL</span>
<span class="cp">#define perror_m_syn 0xFF00000000000000UL</span>
<span class="k">union</span> <span class="n">TPchipPERROR</span> <span class="p">{</span>   
	<span class="k">struct</span>  <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">perror_v_lost</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_serr</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_perr</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_dcrto</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_sge</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_ape</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_ta</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_rdpe</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_nds</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_rto</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_uecc</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_cre</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>                 
		<span class="kt">unsigned</span> <span class="n">perror_v_rsvd1</span> <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_addrl</span> <span class="o">:</span> <span class="mi">32</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_addrh</span> <span class="o">:</span> <span class="mi">3</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_rsvd2</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_cmd</span> <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perror_v_syn</span> <span class="o">:</span> <span class="mi">8</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">perror_r_bits</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">perror_q_whole</span> <span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>                       

<span class="cm">/*</span>
<span class="cm"> * TSUNAMI Pchip Window Space Base Address register.</span>
<span class="cm"> */</span>
<span class="cp">#define wsba_m_ena 0x1                </span>
<span class="cp">#define wsba_m_sg 0x2</span>
<span class="cp">#define wsba_m_ptp 0x4</span>
<span class="cp">#define wsba_m_addr 0xFFF00000  </span>
<span class="cp">#define wmask_k_sz1gb 0x3FF00000                   </span>
<span class="k">union</span> <span class="n">TPchipWSBA</span> <span class="p">{</span>
	<span class="k">struct</span>  <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="n">wsba_v_ena</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">wsba_v_sg</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">wsba_v_ptp</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">wsba_v_rsvd1</span> <span class="o">:</span> <span class="mi">17</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">wsba_v_addr</span> <span class="o">:</span> <span class="mi">12</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">wsba_v_rsvd2</span> <span class="o">:</span> <span class="mi">32</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">wsba_r_bits</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">wsba_q_whole</span> <span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * TSUNAMI Pchip Control Register</span>
<span class="cm"> */</span>
<span class="cp">#define pctl_m_fdsc 0x1</span>
<span class="cp">#define pctl_m_fbtb 0x2</span>
<span class="cp">#define pctl_m_thdis 0x4</span>
<span class="cp">#define pctl_m_chaindis 0x8</span>
<span class="cp">#define pctl_m_tgtlat 0x10</span>
<span class="cp">#define pctl_m_hole 0x20</span>
<span class="cp">#define pctl_m_mwin 0x40</span>
<span class="cp">#define pctl_m_arbena 0x80</span>
<span class="cp">#define pctl_m_prigrp 0x7F00</span>
<span class="cp">#define pctl_m_ppri 0x8000</span>
<span class="cp">#define pctl_m_rsvd1 0x30000</span>
<span class="cp">#define pctl_m_eccen 0x40000</span>
<span class="cp">#define pctl_m_padm 0x80000</span>
<span class="cp">#define pctl_m_cdqmax 0xF00000</span>
<span class="cp">#define pctl_m_rev 0xFF000000</span>
<span class="cp">#define pctl_m_crqmax 0xF00000000UL</span>
<span class="cp">#define pctl_m_ptpmax 0xF000000000UL</span>
<span class="cp">#define pctl_m_pclkx 0x30000000000UL</span>
<span class="cp">#define pctl_m_fdsdis 0x40000000000UL</span>
<span class="cp">#define pctl_m_fdwdis 0x80000000000UL</span>
<span class="cp">#define pctl_m_ptevrfy 0x100000000000UL</span>
<span class="cp">#define pctl_m_rpp 0x200000000000UL</span>
<span class="cp">#define pctl_m_pid 0xC00000000000UL</span>
<span class="cp">#define pctl_m_rsvd2 0xFFFF000000000000UL</span>

<span class="k">union</span> <span class="n">TPchipPCTL</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_fdsc</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_fbtb</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_thdis</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_chaindis</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_tgtlat</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_hole</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_mwin</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_arbena</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_prigrp</span> <span class="o">:</span> <span class="mi">7</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_ppri</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_rsvd1</span> <span class="o">:</span> <span class="mi">2</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_eccen</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_padm</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_cdqmax</span> <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_rev</span> <span class="o">:</span> <span class="mi">8</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_crqmax</span> <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_ptpmax</span> <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_pclkx</span> <span class="o">:</span> <span class="mi">2</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_fdsdis</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_fdwdis</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_ptevrfy</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_rpp</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_pid</span> <span class="o">:</span> <span class="mi">2</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">pctl_v_rsvd2</span> <span class="o">:</span> <span class="mi">16</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">pctl_r_bits</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">pctl_q_whole</span> <span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * TSUNAMI Pchip Error Mask Register.</span>
<span class="cm"> */</span>
<span class="cp">#define perrmask_m_lost 0x1</span>
<span class="cp">#define perrmask_m_serr 0x2</span>
<span class="cp">#define perrmask_m_perr 0x4</span>
<span class="cp">#define perrmask_m_dcrto 0x8</span>
<span class="cp">#define perrmask_m_sge 0x10</span>
<span class="cp">#define perrmask_m_ape 0x20</span>
<span class="cp">#define perrmask_m_ta 0x40</span>
<span class="cp">#define perrmask_m_rdpe 0x80</span>
<span class="cp">#define perrmask_m_nds 0x100</span>
<span class="cp">#define perrmask_m_rto 0x200</span>
<span class="cp">#define perrmask_m_uecc 0x400</span>
<span class="cp">#define perrmask_m_cre 0x800</span>
<span class="cp">#define perrmask_m_rsvd 0xFFFFFFFFFFFFF000UL</span>
<span class="k">union</span> <span class="n">TPchipPERRMASK</span> <span class="p">{</span>   
	<span class="k">struct</span>  <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">perrmask_v_lost</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_serr</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_perr</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_dcrto</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_sge</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_ape</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_ta</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_rdpe</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_nds</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_rto</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_uecc</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_cre</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>                 
		<span class="kt">unsigned</span> <span class="n">perrmask_v_rsvd1</span> <span class="o">:</span> <span class="mi">20</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="n">perrmask_v_rsvd2</span> <span class="o">:</span> <span class="mi">32</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">perrmask_r_bits</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">perrmask_q_whole</span> <span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>                       

<span class="cm">/*</span>
<span class="cm"> * Memory spaces:</span>
<span class="cm"> */</span>
<span class="cp">#define TSUNAMI_HOSE(h)		(((unsigned long)(h)) &lt;&lt; 33)</span>
<span class="cp">#define TSUNAMI_BASE		(IDENT_ADDR + TS_BIAS)</span>

<span class="cp">#define TSUNAMI_MEM(h)		(TSUNAMI_BASE+TSUNAMI_HOSE(h) + 0x000000000UL)</span>
<span class="cp">#define _TSUNAMI_IACK_SC(h)	(TSUNAMI_BASE+TSUNAMI_HOSE(h) + 0x1F8000000UL)</span>
<span class="cp">#define TSUNAMI_IO(h)		(TSUNAMI_BASE+TSUNAMI_HOSE(h) + 0x1FC000000UL)</span>
<span class="cp">#define TSUNAMI_CONF(h)		(TSUNAMI_BASE+TSUNAMI_HOSE(h) + 0x1FE000000UL)</span>

<span class="cp">#define TSUNAMI_IACK_SC		_TSUNAMI_IACK_SC(0) </span><span class="cm">/* hack! */</span><span class="cp"></span>


<span class="cm">/* </span>
<span class="cm"> * The canonical non-remaped I/O and MEM addresses have these values</span>
<span class="cm"> * subtracted out.  This is arranged so that folks manipulating ISA</span>
<span class="cm"> * devices can use their familiar numbers and have them map to bus 0.</span>
<span class="cm"> */</span>

<span class="cp">#define TSUNAMI_IO_BIAS          TSUNAMI_IO(0)</span>
<span class="cp">#define TSUNAMI_MEM_BIAS         TSUNAMI_MEM(0)</span>

<span class="cm">/* The IO address space is larger than 0xffff */</span>
<span class="cp">#define TSUNAMI_IO_SPACE	(TSUNAMI_CONF(0) - TSUNAMI_IO(0))</span>

<span class="cm">/* Offset between ram physical addresses and pci64 DAC bus addresses.  */</span>
<span class="cp">#define TSUNAMI_DAC_OFFSET	(1UL &lt;&lt; 40)</span>

<span class="cm">/*</span>
<span class="cm"> * Data structure for handling TSUNAMI machine checks:</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">el_TSUNAMI_sysdata_mcheck</span> <span class="p">{</span>
<span class="p">};</span>


<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#ifndef __EXTERN_INLINE</span>
<span class="cp">#define __EXTERN_INLINE extern inline</span>
<span class="cp">#define __IO_EXTERN_INLINE</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * I/O functions:</span>
<span class="cm"> *</span>
<span class="cm"> * TSUNAMI, the 21??? PCI/memory support chipset for the EV6 (21264)</span>
<span class="cm"> * can only use linear accesses to get at PCI memory and I/O spaces.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Memory functions.  all accesses are done through linear space.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">tsunami_ioportmap</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">tsunami_ioremap</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">size</span><span class="p">);</span>
<span class="n">__EXTERN_INLINE</span> <span class="kt">int</span> <span class="nf">tsunami_is_ioaddr</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">addr</span> <span class="o">&gt;=</span> <span class="n">TSUNAMI_BASE</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">__EXTERN_INLINE</span> <span class="kt">int</span> <span class="nf">tsunami_is_mmio</span><span class="p">(</span><span class="k">const</span> <span class="k">volatile</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">xaddr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="n">xaddr</span><span class="p">;</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">addr</span> <span class="o">&amp;</span> <span class="mh">0x100000000UL</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#undef __IO_PREFIX</span>
<span class="cp">#define __IO_PREFIX		tsunami</span>
<span class="cp">#define tsunami_trivial_rw_bw	1</span>
<span class="cp">#define tsunami_trivial_rw_lq	1</span>
<span class="cp">#define tsunami_trivial_io_bw	1</span>
<span class="cp">#define tsunami_trivial_io_lq	1</span>
<span class="cp">#define tsunami_trivial_iounmap	1</span>
<span class="cp">#include &lt;asm/io_trivial.h&gt;</span>

<span class="cp">#ifdef __IO_EXTERN_INLINE</span>
<span class="cp">#undef __EXTERN_INLINE</span>
<span class="cp">#undef __IO_EXTERN_INLINE</span>
<span class="cp">#endif</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* __ALPHA_TSUNAMI__H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
