<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › alpha › include › asm › elf.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>elf.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __ASM_ALPHA_ELF_H</span>
<span class="cp">#define __ASM_ALPHA_ELF_H</span>

<span class="cp">#include &lt;asm/auxvec.h&gt;</span>
<span class="cp">#include &lt;asm/special_insns.h&gt;</span>

<span class="cm">/* Special values for the st_other field in the symbol table.  */</span>

<span class="cp">#define STO_ALPHA_NOPV		0x80</span>
<span class="cp">#define STO_ALPHA_STD_GPLOAD	0x88</span>

<span class="cm">/*</span>
<span class="cm"> * Alpha ELF relocation types</span>
<span class="cm"> */</span>
<span class="cp">#define R_ALPHA_NONE            0       </span><span class="cm">/* No reloc */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_REFLONG         1       </span><span class="cm">/* Direct 32 bit */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_REFQUAD         2       </span><span class="cm">/* Direct 64 bit */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_GPREL32         3       </span><span class="cm">/* GP relative 32 bit */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_LITERAL         4       </span><span class="cm">/* GP relative 16 bit w/optimization */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_LITUSE          5       </span><span class="cm">/* Optimization hint for LITERAL */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_GPDISP          6       </span><span class="cm">/* Add displacement to GP */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_BRADDR          7       </span><span class="cm">/* PC+4 relative 23 bit shifted */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_HINT            8       </span><span class="cm">/* PC+4 relative 16 bit shifted */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_SREL16          9       </span><span class="cm">/* PC relative 16 bit */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_SREL32          10      </span><span class="cm">/* PC relative 32 bit */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_SREL64          11      </span><span class="cm">/* PC relative 64 bit */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_GPRELHIGH       17      </span><span class="cm">/* GP relative 32 bit, high 16 bits */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_GPRELLOW        18      </span><span class="cm">/* GP relative 32 bit, low 16 bits */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_GPREL16         19      </span><span class="cm">/* GP relative 16 bit */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_COPY            24      </span><span class="cm">/* Copy symbol at runtime */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_GLOB_DAT        25      </span><span class="cm">/* Create GOT entry */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_JMP_SLOT        26      </span><span class="cm">/* Create PLT entry */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_RELATIVE        27      </span><span class="cm">/* Adjust by program base */</span><span class="cp"></span>
<span class="cp">#define R_ALPHA_BRSGP		28</span>
<span class="cp">#define R_ALPHA_TLSGD           29</span>
<span class="cp">#define R_ALPHA_TLS_LDM         30</span>
<span class="cp">#define R_ALPHA_DTPMOD64        31</span>
<span class="cp">#define R_ALPHA_GOTDTPREL       32</span>
<span class="cp">#define R_ALPHA_DTPREL64        33</span>
<span class="cp">#define R_ALPHA_DTPRELHI        34</span>
<span class="cp">#define R_ALPHA_DTPRELLO        35</span>
<span class="cp">#define R_ALPHA_DTPREL16        36</span>
<span class="cp">#define R_ALPHA_GOTTPREL        37</span>
<span class="cp">#define R_ALPHA_TPREL64         38</span>
<span class="cp">#define R_ALPHA_TPRELHI         39</span>
<span class="cp">#define R_ALPHA_TPRELLO         40</span>
<span class="cp">#define R_ALPHA_TPREL16         41</span>

<span class="cp">#define SHF_ALPHA_GPREL		0x10000000</span>

<span class="cm">/* Legal values for e_flags field of Elf64_Ehdr.  */</span>

<span class="cp">#define EF_ALPHA_32BIT		1	</span><span class="cm">/* All addresses are below 2GB */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * ELF register definitions..</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * The OSF/1 version of &lt;sys/procfs.h&gt; makes gregset_t 46 entries long.</span>
<span class="cm"> * I have no idea why that is so.  For now, we just leave it at 33</span>
<span class="cm"> * (32 general regs + processor status word). </span>
<span class="cm"> */</span>
<span class="cp">#define ELF_NGREG	33</span>
<span class="cp">#define ELF_NFPREG	32</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_greg_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">elf_greg_t</span> <span class="n">elf_gregset_t</span><span class="p">[</span><span class="n">ELF_NGREG</span><span class="p">];</span>

<span class="k">typedef</span> <span class="kt">double</span> <span class="n">elf_fpreg_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">elf_fpreg_t</span> <span class="n">elf_fpregset_t</span><span class="p">[</span><span class="n">ELF_NFPREG</span><span class="p">];</span>

<span class="cm">/*</span>
<span class="cm"> * This is used to ensure we don&#39;t load something for the wrong architecture.</span>
<span class="cm"> */</span>
<span class="cp">#define elf_check_arch(x) ((x)-&gt;e_machine == EM_ALPHA)</span>

<span class="cm">/*</span>
<span class="cm"> * These are used to set parameters in the core dumps.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_CLASS	ELFCLASS64</span>
<span class="cp">#define ELF_DATA	ELFDATA2LSB</span>
<span class="cp">#define ELF_ARCH	EM_ALPHA</span>

<span class="cp">#define ELF_EXEC_PAGESIZE	8192</span>

<span class="cm">/* This is the location that an ET_DYN program is loaded if exec&#39;ed.  Typical</span>
<span class="cm">   use of this is to invoke &quot;./ld.so someprog&quot; to test out a new version of</span>
<span class="cm">   the loader.  We need to make sure that it is out of the way of the program</span>
<span class="cm">   that it will &quot;exec&quot;, and that there is sufficient room for the brk.  */</span>

<span class="cp">#define ELF_ET_DYN_BASE		(TASK_UNMAPPED_BASE + 0x1000000)</span>

<span class="cm">/* $0 is set by ld.so to a pointer to a function which might be </span>
<span class="cm">   registered using atexit.  This provides a mean for the dynamic</span>
<span class="cm">   linker to call DT_FINI functions for shared libraries that have</span>
<span class="cm">   been loaded before the code runs.</span>

<span class="cm">   So that we can use the same startup file with static executables,</span>
<span class="cm">   we start programs with a value of 0 to indicate that there is no</span>
<span class="cm">   such function.  */</span>

<span class="cp">#define ELF_PLAT_INIT(_r, load_addr)	_r-&gt;r0 = 0</span>

<span class="cm">/* The registers are laid out in pt_regs for PAL and syscall</span>
<span class="cm">   convenience.  Re-order them for the linear elf_gregset_t.  */</span>

<span class="k">struct</span> <span class="n">pt_regs</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">thread_info</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">task_struct</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">dump_elf_thread</span><span class="p">(</span><span class="n">elf_greg_t</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pt_regs</span> <span class="o">*</span><span class="n">pt</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">thread_info</span> <span class="o">*</span><span class="n">ti</span><span class="p">);</span>
<span class="cp">#define ELF_CORE_COPY_REGS(DEST, REGS) \</span>
<span class="cp">	dump_elf_thread(DEST, REGS, current_thread_info());</span>

<span class="cm">/* Similar, but for a thread other than current.  */</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">dump_elf_task</span><span class="p">(</span><span class="n">elf_greg_t</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">task</span><span class="p">);</span>
<span class="cp">#define ELF_CORE_COPY_TASK_REGS(TASK, DEST) \</span>
<span class="cp">	dump_elf_task(*(DEST), TASK)</span>

<span class="cm">/* Similar, but for the FP registers.  */</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">dump_elf_task_fp</span><span class="p">(</span><span class="n">elf_fpreg_t</span> <span class="o">*</span><span class="n">dest</span><span class="p">,</span> <span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">task</span><span class="p">);</span>
<span class="cp">#define ELF_CORE_COPY_FPREGS(TASK, DEST) \</span>
<span class="cp">	dump_elf_task_fp(*(DEST), TASK)</span>

<span class="cm">/* This yields a mask that user programs can use to figure out what</span>
<span class="cm">   instruction set this CPU supports.  This is trivial on Alpha, </span>
<span class="cm">   but not so on other machines. */</span>

<span class="cp">#define ELF_HWCAP  (~amask(-1))</span>

<span class="cm">/* This yields a string that ld.so will use to load implementation</span>
<span class="cm">   specific libraries for optimization.  This is more specific in</span>
<span class="cm">   intent than poking at uname or /proc/cpuinfo.  */</span>

<span class="cp">#define ELF_PLATFORM				\</span>
<span class="cp">({						\</span>
<span class="cp">	enum implver_enum i_ = implver();	\</span>
<span class="cp">	( i_ == IMPLVER_EV4 ? &quot;ev4&quot;		\</span>
<span class="cp">	: i_ == IMPLVER_EV5			\</span>
<span class="cp">	  ? (amask(AMASK_BWX) ? &quot;ev5&quot; : &quot;ev56&quot;)	\</span>
<span class="cp">	: amask (AMASK_CIX) ? &quot;ev6&quot; : &quot;ev67&quot;);	\</span>
<span class="cp">})</span>

<span class="cp">#define SET_PERSONALITY(EX)					\</span>
<span class="cp">	set_personality(((EX).e_flags &amp; EF_ALPHA_32BIT)		\</span>
<span class="cp">	   ? PER_LINUX_32BIT : PER_LINUX)</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">alpha_l1i_cacheshape</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">alpha_l1d_cacheshape</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">alpha_l2_cacheshape</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">alpha_l3_cacheshape</span><span class="p">;</span>

<span class="cm">/* update AT_VECTOR_SIZE_ARCH if the number of NEW_AUX_ENT entries changes */</span>
<span class="cp">#define ARCH_DLINFO						\</span>
<span class="cp">  do {								\</span>
<span class="cp">    NEW_AUX_ENT(AT_L1I_CACHESHAPE, alpha_l1i_cacheshape);	\</span>
<span class="cp">    NEW_AUX_ENT(AT_L1D_CACHESHAPE, alpha_l1d_cacheshape);	\</span>
<span class="cp">    NEW_AUX_ENT(AT_L2_CACHESHAPE, alpha_l2_cacheshape);		\</span>
<span class="cp">    NEW_AUX_ENT(AT_L3_CACHESHAPE, alpha_l3_cacheshape);		\</span>
<span class="cp">  } while (0)</span>

<span class="cp">#endif </span><span class="cm">/* __ASM_ALPHA_ELF_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
