<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › tile › include › arch › sim_def.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>sim_def.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright 2010 Tilera Corporation. All Rights Reserved.</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is free software; you can redistribute it and/or</span>
<span class="cm"> *   modify it under the terms of the GNU General Public License</span>
<span class="cm"> *   as published by the Free Software Foundation, version 2.</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> *   WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE, GOOD TITLE or</span>
<span class="cm"> *   NON INFRINGEMENT.  See the GNU General Public License for</span>
<span class="cm"> *   more details.</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * @file</span>
<span class="cm"> *</span>
<span class="cm"> * Some low-level simulator definitions.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __ARCH_SIM_DEF_H__</span>
<span class="cp">#define __ARCH_SIM_DEF_H__</span>


<span class="cm">/**</span>
<span class="cm"> * Internal: the low bits of the SIM_CONTROL_* SPR values specify</span>
<span class="cm"> * the operation to perform, and the remaining bits are</span>
<span class="cm"> * an operation-specific parameter (often unused).</span>
<span class="cm"> */</span>
<span class="cp">#define _SIM_CONTROL_OPERATOR_BITS 8</span>


<span class="cm">/*</span>
<span class="cm"> * Values which can be written to SPR_SIM_CONTROL.</span>
<span class="cm"> */</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, stops profiling. */</span>
<span class="cp">#define SIM_CONTROL_PROFILER_DISABLE 0</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, starts profiling. */</span>
<span class="cp">#define SIM_CONTROL_PROFILER_ENABLE 1</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, clears profiling counters. */</span>
<span class="cp">#define SIM_CONTROL_PROFILER_CLEAR 2</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, checkpoints the simulator. */</span>
<span class="cp">#define SIM_CONTROL_CHECKPOINT 3</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a mask (shifted by 8),</span>
<span class="cm"> * sets the tracing mask to the given mask. See &quot;sim_set_tracing()&quot;.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_SET_TRACING 4</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a mask (shifted by 8),</span>
<span class="cm"> * dumps the requested items of machine state to the log.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_DUMP 5</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, clears chip-level profiling counters. */</span>
<span class="cp">#define SIM_CONTROL_PROFILER_CHIP_CLEAR 6</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, disables chip-level profiling. */</span>
<span class="cp">#define SIM_CONTROL_PROFILER_CHIP_DISABLE 7</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, enables chip-level profiling. */</span>
<span class="cp">#define SIM_CONTROL_PROFILER_CHIP_ENABLE 8</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, enables chip-level functional mode */</span>
<span class="cp">#define SIM_CONTROL_ENABLE_FUNCTIONAL 9</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, disables chip-level functional mode. */</span>
<span class="cp">#define SIM_CONTROL_DISABLE_FUNCTIONAL 10</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, enables chip-level functional mode.</span>
<span class="cm"> * All tiles must perform this write for functional mode to be enabled.</span>
<span class="cm"> * Ignored in naked boot mode unless --functional is specified.</span>
<span class="cm"> * WARNING: Only the hypervisor startup code should use this!</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_ENABLE_FUNCTIONAL_BARRIER 11</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a character (shifted by 8),</span>
<span class="cm"> * writes a string directly to the simulator output.  Written to once for</span>
<span class="cm"> * each character in the string, plus a final NUL.  Instead of NUL,</span>
<span class="cm"> * you can also use &quot;SIM_PUTC_FLUSH_STRING&quot; or &quot;SIM_PUTC_FLUSH_BINARY&quot;.</span>
<span class="cm"> */</span>
<span class="cm">/* ISSUE: Document the meaning of &quot;newline&quot;, and the handling of NUL. */</span>
<span class="cp">#define SIM_CONTROL_PUTC 12</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, clears the --grind-coherence state for</span>
<span class="cm"> * this core.  This is intended to be used before a loop that will</span>
<span class="cm"> * invalidate the cache by loading new data and evicting all current data.</span>
<span class="cm"> * Generally speaking, this API should only be used by system code.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_GRINDER_CLEAR 13</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, shuts down the simulator. */</span>
<span class="cp">#define SIM_CONTROL_SHUTDOWN 14</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a pid (shifted by 8),</span>
<span class="cm"> * indicates that a fork syscall just created the given process.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_OS_FORK 15</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a pid (shifted by 8),</span>
<span class="cm"> * indicates that an exit syscall was just executed by the given process.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_OS_EXIT 16</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a pid (shifted by 8),</span>
<span class="cm"> * indicates that the OS just switched to the given process.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_OS_SWITCH 17</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a character (shifted by 8),</span>
<span class="cm"> * indicates that an exec syscall was just executed. Written to once for</span>
<span class="cm"> * each character in the executable name, plus a final NUL.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_OS_EXEC 18</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a character (shifted by 8),</span>
<span class="cm"> * indicates that an interpreter (PT_INTERP) was loaded.  Written to once</span>
<span class="cm"> * for each character in &quot;ADDR:PATH&quot;, plus a final NUL, where &quot;ADDR&quot; is a</span>
<span class="cm"> * hex load address starting with &quot;0x&quot;, and &quot;PATH&quot; is the executable name.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_OS_INTERP 19</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a character (shifted by 8),</span>
<span class="cm"> * indicates that a dll was loaded.  Written to once for each character</span>
<span class="cm"> * in &quot;ADDR:PATH&quot;, plus a final NUL, where &quot;ADDR&quot; is a hexadecimal load</span>
<span class="cm"> * address starting with &quot;0x&quot;, and &quot;PATH&quot; is the executable name.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_DLOPEN 20</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a character (shifted by 8),</span>
<span class="cm"> * indicates that a dll was unloaded.  Written to once for each character</span>
<span class="cm"> * in &quot;ADDR&quot;, plus a final NUL, where &quot;ADDR&quot; is a hexadecimal load</span>
<span class="cm"> * address starting with &quot;0x&quot;.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_DLCLOSE 21</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a flag (shifted by 8),</span>
<span class="cm"> * indicates whether to allow data reads to remotely-cached</span>
<span class="cm"> * dirty cache lines to be cached locally without grinder warnings or</span>
<span class="cm"> * assertions (used by Linux kernel fast memcpy).</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_ALLOW_MULTIPLE_CACHING 22</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, enables memory tracing. */</span>
<span class="cp">#define SIM_CONTROL_ENABLE_MEM_LOGGING 23</span>

<span class="cm">/** If written to SPR_SIM_CONTROL, disables memory tracing. */</span>
<span class="cp">#define SIM_CONTROL_DISABLE_MEM_LOGGING 24</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, changes the shaping parameters of one of</span>
<span class="cm"> * the gbe or xgbe shims. Must specify the shim id, the type, the units, and</span>
<span class="cm"> * the rate, as defined in SIM_SHAPING_SPR_ARG.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_SHAPING 25</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with character (shifted by 8),</span>
<span class="cm"> * requests that a simulator command be executed.  Written to once for each</span>
<span class="cm"> * character in the command, plus a final NUL.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_COMMAND 26</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, indicates that the simulated system</span>
<span class="cm"> * is panicking, to allow debugging via --debug-on-panic.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_PANIC 27</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, triggers a simulator syscall.</span>
<span class="cm"> * See &quot;sim_syscall()&quot; for more info.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_SYSCALL 32</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a pid (shifted by 8),</span>
<span class="cm"> * provides the pid that subsequent SIM_CONTROL_OS_FORK writes should</span>
<span class="cm"> * use as the pid, rather than the default previous SIM_CONTROL_OS_SWITCH.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_OS_FORK_PARENT 33</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a mPIPE shim number</span>
<span class="cm"> * (shifted by 8), clears the pending magic data section.  The cleared</span>
<span class="cm"> * pending magic data section and any subsequently appended magic bytes</span>
<span class="cm"> * will only take effect when the classifier blast programmer is run.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_CLEAR_MPIPE_MAGIC_BYTES 34</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a mPIPE shim number</span>
<span class="cm"> * (shifted by 8) and a byte of data (shifted by 16), appends that byte</span>
<span class="cm"> * to the shim&#39;s pending magic data section.  The pending magic data</span>
<span class="cm"> * section takes effect when the classifier blast programmer is run.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_APPEND_MPIPE_MAGIC_BYTE 35</span>

<span class="cm">/**</span>
<span class="cm"> * If written to SPR_SIM_CONTROL, combined with a mPIPE shim number</span>
<span class="cm"> * (shifted by 8), an enable=1/disable=0 bit (shifted by 16), and a</span>
<span class="cm"> * mask of links (shifted by 32), enable or disable the corresponding</span>
<span class="cm"> * mPIPE links.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_CONTROL_ENABLE_MPIPE_LINK_MAGIC_BYTE 36</span>


<span class="cm">/*</span>
<span class="cm"> * Syscall numbers for use with &quot;sim_syscall()&quot;.</span>
<span class="cm"> */</span>

<span class="cm">/** Syscall number for sim_add_watchpoint(). */</span>
<span class="cp">#define SIM_SYSCALL_ADD_WATCHPOINT 2</span>

<span class="cm">/** Syscall number for sim_remove_watchpoint(). */</span>
<span class="cp">#define SIM_SYSCALL_REMOVE_WATCHPOINT 3</span>

<span class="cm">/** Syscall number for sim_query_watchpoint(). */</span>
<span class="cp">#define SIM_SYSCALL_QUERY_WATCHPOINT 4</span>

<span class="cm">/**</span>
<span class="cm"> * Syscall number that asserts that the cache lines whose 64-bit PA</span>
<span class="cm"> * is passed as the second argument to sim_syscall(), and over a</span>
<span class="cm"> * range passed as the third argument, are no longer in cache.</span>
<span class="cm"> * The simulator raises an error if this is not the case.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_SYSCALL_VALIDATE_LINES_EVICTED 5</span>

<span class="cm">/** Syscall number for sim_query_cpu_speed(). */</span>
<span class="cp">#define SIM_SYSCALL_QUERY_CPU_SPEED 6</span>


<span class="cm">/*</span>
<span class="cm"> * Bit masks which can be shifted by 8, combined with</span>
<span class="cm"> * SIM_CONTROL_SET_TRACING, and written to SPR_SIM_CONTROL.</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * @addtogroup arch_sim</span>
<span class="cm"> * @{</span>
<span class="cm"> */</span>

<span class="cm">/** Enable --trace-cycle when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_CYCLES          0x01</span>

<span class="cm">/** Enable --trace-router when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_ROUTER          0x02</span>

<span class="cm">/** Enable --trace-register-writes when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_REGISTER_WRITES 0x04</span>

<span class="cm">/** Enable --trace-disasm when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_DISASM          0x08</span>

<span class="cm">/** Enable --trace-stall-info when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_STALL_INFO      0x10</span>

<span class="cm">/** Enable --trace-memory-controller when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_MEMORY_CONTROLLER 0x20</span>

<span class="cm">/** Enable --trace-l2 when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_L2_CACHE 0x40</span>

<span class="cm">/** Enable --trace-lines when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_LINES 0x80</span>

<span class="cm">/** Turn off all tracing when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_NONE 0</span>

<span class="cm">/** Turn on all tracing when passed to simulator_set_tracing(). */</span>
<span class="cp">#define SIM_TRACE_ALL (-1)</span>

<span class="cm">/** @} */</span>

<span class="cm">/** Computes the value to write to SPR_SIM_CONTROL to set tracing flags. */</span>
<span class="cp">#define SIM_TRACE_SPR_ARG(mask) \</span>
<span class="cp">  (SIM_CONTROL_SET_TRACING | ((mask) &lt;&lt; _SIM_CONTROL_OPERATOR_BITS))</span>


<span class="cm">/*</span>
<span class="cm"> * Bit masks which can be shifted by 8, combined with</span>
<span class="cm"> * SIM_CONTROL_DUMP, and written to SPR_SIM_CONTROL.</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * @addtogroup arch_sim</span>
<span class="cm"> * @{</span>
<span class="cm"> */</span>

<span class="cm">/** Dump the general-purpose registers. */</span>
<span class="cp">#define SIM_DUMP_REGS          0x001</span>

<span class="cm">/** Dump the SPRs. */</span>
<span class="cp">#define SIM_DUMP_SPRS          0x002</span>

<span class="cm">/** Dump the ITLB. */</span>
<span class="cp">#define SIM_DUMP_ITLB          0x004</span>

<span class="cm">/** Dump the DTLB. */</span>
<span class="cp">#define SIM_DUMP_DTLB          0x008</span>

<span class="cm">/** Dump the L1 I-cache. */</span>
<span class="cp">#define SIM_DUMP_L1I           0x010</span>

<span class="cm">/** Dump the L1 D-cache. */</span>
<span class="cp">#define SIM_DUMP_L1D           0x020</span>

<span class="cm">/** Dump the L2 cache. */</span>
<span class="cp">#define SIM_DUMP_L2            0x040</span>

<span class="cm">/** Dump the switch registers. */</span>
<span class="cp">#define SIM_DUMP_SNREGS        0x080</span>

<span class="cm">/** Dump the switch ITLB. */</span>
<span class="cp">#define SIM_DUMP_SNITLB        0x100</span>

<span class="cm">/** Dump the switch L1 I-cache. */</span>
<span class="cp">#define SIM_DUMP_SNL1I         0x200</span>

<span class="cm">/** Dump the current backtrace. */</span>
<span class="cp">#define SIM_DUMP_BACKTRACE     0x400</span>

<span class="cm">/** Only dump valid lines in caches. */</span>
<span class="cp">#define SIM_DUMP_VALID_LINES   0x800</span>

<span class="cm">/** Dump everything that is dumpable. */</span>
<span class="cp">#define SIM_DUMP_ALL (-1 &amp; ~SIM_DUMP_VALID_LINES)</span>

<span class="cm">/** @} */</span>

<span class="cm">/** Computes the value to write to SPR_SIM_CONTROL to dump machine state. */</span>
<span class="cp">#define SIM_DUMP_SPR_ARG(mask) \</span>
<span class="cp">  (SIM_CONTROL_DUMP | ((mask) &lt;&lt; _SIM_CONTROL_OPERATOR_BITS))</span>


<span class="cm">/*</span>
<span class="cm"> * Bit masks which can be shifted by 8, combined with</span>
<span class="cm"> * SIM_CONTROL_PROFILER_CHIP_xxx, and written to SPR_SIM_CONTROL.</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * @addtogroup arch_sim</span>
<span class="cm"> * @{</span>
<span class="cm"> */</span>

<span class="cm">/** Use with with SIM_PROFILER_CHIP_xxx to control the memory controllers. */</span>
<span class="cp">#define SIM_CHIP_MEMCTL        0x001</span>

<span class="cm">/** Use with with SIM_PROFILER_CHIP_xxx to control the XAUI interface. */</span>
<span class="cp">#define SIM_CHIP_XAUI          0x002</span>

<span class="cm">/** Use with with SIM_PROFILER_CHIP_xxx to control the PCIe interface. */</span>
<span class="cp">#define SIM_CHIP_PCIE          0x004</span>

<span class="cm">/** Use with with SIM_PROFILER_CHIP_xxx to control the MPIPE interface. */</span>
<span class="cp">#define SIM_CHIP_MPIPE         0x008</span>

<span class="cm">/** Use with with SIM_PROFILER_CHIP_xxx to control the TRIO interface. */</span>
<span class="cp">#define SIM_CHIP_TRIO          0x010</span>

<span class="cm">/** Reference all chip devices. */</span>
<span class="cp">#define SIM_CHIP_ALL (-1)</span>

<span class="cm">/** @} */</span>

<span class="cm">/** Computes the value to write to SPR_SIM_CONTROL to clear chip statistics. */</span>
<span class="cp">#define SIM_PROFILER_CHIP_CLEAR_SPR_ARG(mask) \</span>
<span class="cp">  (SIM_CONTROL_PROFILER_CHIP_CLEAR | ((mask) &lt;&lt; _SIM_CONTROL_OPERATOR_BITS))</span>

<span class="cm">/** Computes the value to write to SPR_SIM_CONTROL to disable chip statistics.*/</span>
<span class="cp">#define SIM_PROFILER_CHIP_DISABLE_SPR_ARG(mask) \</span>
<span class="cp">  (SIM_CONTROL_PROFILER_CHIP_DISABLE | ((mask) &lt;&lt; _SIM_CONTROL_OPERATOR_BITS))</span>

<span class="cm">/** Computes the value to write to SPR_SIM_CONTROL to enable chip statistics. */</span>
<span class="cp">#define SIM_PROFILER_CHIP_ENABLE_SPR_ARG(mask) \</span>
<span class="cp">  (SIM_CONTROL_PROFILER_CHIP_ENABLE | ((mask) &lt;&lt; _SIM_CONTROL_OPERATOR_BITS))</span>



<span class="cm">/* Shim bitrate controls. */</span>

<span class="cm">/** The number of bits used to store the shim id. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_SHIM_ID_BITS 3</span>

<span class="cm">/**</span>
<span class="cm"> * @addtogroup arch_sim</span>
<span class="cm"> * @{</span>
<span class="cm"> */</span>

<span class="cm">/** Change the gbe 0 bitrate. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_GBE_0 0x0</span>

<span class="cm">/** Change the gbe 1 bitrate. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_GBE_1 0x1</span>

<span class="cm">/** Change the gbe 2 bitrate. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_GBE_2 0x2</span>

<span class="cm">/** Change the gbe 3 bitrate. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_GBE_3 0x3</span>

<span class="cm">/** Change the xgbe 0 bitrate. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_XGBE_0 0x4</span>

<span class="cm">/** Change the xgbe 1 bitrate. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_XGBE_1 0x5</span>

<span class="cm">/** The type of shaping to do. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_TYPE_BITS 2</span>

<span class="cm">/** Control the multiplier. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_MULTIPLIER 0</span>

<span class="cm">/** Control the PPS. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_PPS 1</span>

<span class="cm">/** Control the BPS. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_BPS 2</span>

<span class="cm">/** The number of bits for the units for the shaping parameter. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_UNITS_BITS 2</span>

<span class="cm">/** Provide a number in single units. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_UNITS_SINGLE 0</span>

<span class="cm">/** Provide a number in kilo units. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_UNITS_KILO 1</span>

<span class="cm">/** Provide a number in mega units. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_UNITS_MEGA 2</span>

<span class="cm">/** Provide a number in giga units. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_UNITS_GIGA 3</span>

<span class="cm">/** @} */</span>

<span class="cm">/** How many bits are available for the rate. */</span>
<span class="cp">#define SIM_CONTROL_SHAPING_RATE_BITS \</span>
<span class="cp">  (32 - (_SIM_CONTROL_OPERATOR_BITS + \</span>
<span class="cp">         SIM_CONTROL_SHAPING_SHIM_ID_BITS + \</span>
<span class="cp">         SIM_CONTROL_SHAPING_TYPE_BITS + \</span>
<span class="cp">         SIM_CONTROL_SHAPING_UNITS_BITS))</span>

<span class="cm">/** Computes the value to write to SPR_SIM_CONTROL to change a bitrate. */</span>
<span class="cp">#define SIM_SHAPING_SPR_ARG(shim, type, units, rate) \</span>
<span class="cp">  (SIM_CONTROL_SHAPING | \</span>
<span class="cp">   ((shim) | \</span>
<span class="cp">   ((type) &lt;&lt; (SIM_CONTROL_SHAPING_SHIM_ID_BITS)) | \</span>
<span class="cp">   ((units) &lt;&lt; (SIM_CONTROL_SHAPING_SHIM_ID_BITS + \</span>
<span class="cp">                SIM_CONTROL_SHAPING_TYPE_BITS)) | \</span>
<span class="cp">   ((rate) &lt;&lt; (SIM_CONTROL_SHAPING_SHIM_ID_BITS + \</span>
<span class="cp">               SIM_CONTROL_SHAPING_TYPE_BITS + \</span>
<span class="cp">               SIM_CONTROL_SHAPING_UNITS_BITS))) &lt;&lt; _SIM_CONTROL_OPERATOR_BITS)</span>


<span class="cm">/*</span>
<span class="cm"> * Values returned when reading SPR_SIM_CONTROL.</span>
<span class="cm"> * ISSUE: These names should share a longer common prefix.</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * When reading SPR_SIM_CONTROL, the mask of simulator tracing bits</span>
<span class="cm"> * (SIM_TRACE_xxx values).</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_TRACE_FLAG_MASK 0xFFFF</span>

<span class="cm">/** When reading SPR_SIM_CONTROL, the mask for whether profiling is enabled. */</span>
<span class="cp">#define SIM_PROFILER_ENABLED_MASK 0x10000</span>


<span class="cm">/*</span>
<span class="cm"> * Special arguments for &quot;SIM_CONTROL_PUTC&quot;.</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * Flag value for forcing a PUTC string-flush, including</span>
<span class="cm"> * coordinate/cycle prefix and newline.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_PUTC_FLUSH_STRING 0x100</span>

<span class="cm">/**</span>
<span class="cm"> * Flag value for forcing a PUTC binary-data-flush, which skips the</span>
<span class="cm"> * prefix and does not append a newline.</span>
<span class="cm"> */</span>
<span class="cp">#define SIM_PUTC_FLUSH_BINARY 0x101</span>


<span class="cp">#endif </span><span class="cm">/* __ARCH_SIM_DEF_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
