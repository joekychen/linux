<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › parisc › include › asm › assembly.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>assembly.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 1999 Hewlett-Packard (Frank Rowand)</span>
<span class="cm"> * Copyright (C) 1999 Philipp Rumpf &lt;prumpf@tux.org&gt;</span>
<span class="cm"> * Copyright (C) 1999 SuSE GmbH</span>
<span class="cm"> *</span>
<span class="cm"> *    This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *    it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *    the Free Software Foundation; either version 2, or (at your option)</span>
<span class="cm"> *    any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *    This program is distributed in the hope that it will be useful,</span>
<span class="cm"> *    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *    GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *    You should have received a copy of the GNU General Public License</span>
<span class="cm"> *    along with this program; if not, write to the Free Software</span>
<span class="cm"> *    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _PARISC_ASSEMBLY_H</span>
<span class="cp">#define _PARISC_ASSEMBLY_H</span>

<span class="cp">#define CALLEE_FLOAT_FRAME_SIZE	80</span>

<span class="cp">#ifdef CONFIG_64BIT</span>
<span class="cp">#define LDREG	ldd</span>
<span class="cp">#define STREG	std</span>
<span class="cp">#define LDREGX  ldd,s</span>
<span class="cp">#define LDREGM	ldd,mb</span>
<span class="cp">#define STREGM	std,ma</span>
<span class="cp">#define SHRREG	shrd</span>
<span class="cp">#define SHLREG	shld</span>
<span class="cp">#define ANDCM   andcm,*</span>
<span class="cp">#define	COND(x)	* ## x</span>
<span class="cp">#define RP_OFFSET	16</span>
<span class="cp">#define FRAME_SIZE	128</span>
<span class="cp">#define CALLEE_REG_FRAME_SIZE	144</span>
<span class="cp">#define ASM_ULONG_INSN	.dword</span>
<span class="cp">#else	</span><span class="cm">/* CONFIG_64BIT */</span><span class="cp"></span>
<span class="cp">#define LDREG	ldw</span>
<span class="cp">#define STREG	stw</span>
<span class="cp">#define LDREGX  ldwx,s</span>
<span class="cp">#define LDREGM	ldwm</span>
<span class="cp">#define STREGM	stwm</span>
<span class="cp">#define SHRREG	shr</span>
<span class="cp">#define SHLREG	shlw</span>
<span class="cp">#define ANDCM   andcm</span>
<span class="cp">#define COND(x)	x</span>
<span class="cp">#define RP_OFFSET	20</span>
<span class="cp">#define FRAME_SIZE	64</span>
<span class="cp">#define CALLEE_REG_FRAME_SIZE	128</span>
<span class="cp">#define ASM_ULONG_INSN	.word</span>
<span class="cp">#endif</span>

<span class="cp">#define CALLEE_SAVE_FRAME_SIZE (CALLEE_REG_FRAME_SIZE + CALLEE_FLOAT_FRAME_SIZE)</span>

<span class="cp">#ifdef CONFIG_PA20</span>
<span class="cp">#define LDCW		ldcw,co</span>
<span class="cp">#define BL		b,l</span>
<span class="cp"># ifdef CONFIG_64BIT</span>
<span class="cp">#  define LEVEL		2.0w</span>
<span class="cp"># else</span>
<span class="cp">#  define LEVEL		2.0</span>
<span class="cp"># endif</span>
<span class="cp">#else</span>
<span class="cp">#define LDCW		ldcw</span>
<span class="cp">#define BL		bl</span>
<span class="cp">#define LEVEL		1.1</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef __ASSEMBLY__</span>

<span class="cp">#ifdef CONFIG_64BIT</span>
<span class="cm">/* the 64-bit pa gnu assembler unfortunately defaults to .level 1.1 or 2.0 so</span>
<span class="cm"> * work around that for now... */</span>
	<span class="p">.</span><span class="n">level</span> <span class="mf">2.0</span><span class="n">w</span>
<span class="cp">#endif</span>

<span class="cp">#include &lt;asm/asm-offsets.h&gt;</span>
<span class="cp">#include &lt;asm/page.h&gt;</span>
<span class="cp">#include &lt;asm/types.h&gt;</span>

<span class="cp">#include &lt;asm/asmregs.h&gt;</span>

	<span class="n">sp</span>	<span class="o">=</span>	<span class="mi">30</span>
	<span class="n">gp</span>	<span class="o">=</span>	<span class="mi">27</span>
	<span class="n">ipsw</span>	<span class="o">=</span>	<span class="mi">22</span>

	<span class="cm">/*</span>
<span class="cm">	 * We provide two versions of each macro to convert from physical</span>
<span class="cm">	 * to virtual and vice versa. The &quot;_r1&quot; versions take one argument</span>
<span class="cm">	 * register, but trashes r1 to do the conversion. The other</span>
<span class="cm">	 * version takes two arguments: a src and destination register.</span>
<span class="cm">	 * However, the source and destination registers can not be</span>
<span class="cm">	 * the same register.</span>
<span class="cm">	 */</span>

	<span class="p">.</span><span class="n">macro</span>  <span class="n">tophys</span>  <span class="n">grvirt</span><span class="p">,</span> <span class="n">grphys</span>
	<span class="n">ldil</span>    <span class="n">L</span><span class="o">%</span><span class="p">(</span><span class="n">__PAGE_OFFSET</span><span class="p">),</span> <span class="err">\</span><span class="n">grphys</span>
	<span class="n">sub</span>     <span class="err">\</span><span class="n">grvirt</span><span class="p">,</span> <span class="err">\</span><span class="n">grphys</span><span class="p">,</span> <span class="err">\</span><span class="n">grphys</span>
	<span class="p">.</span><span class="n">endm</span>
	
	<span class="p">.</span><span class="n">macro</span>  <span class="n">tovirt</span>  <span class="n">grphys</span><span class="p">,</span> <span class="n">grvirt</span>
	<span class="n">ldil</span>    <span class="n">L</span><span class="o">%</span><span class="p">(</span><span class="n">__PAGE_OFFSET</span><span class="p">),</span> <span class="err">\</span><span class="n">grvirt</span>
	<span class="n">add</span>     <span class="err">\</span><span class="n">grphys</span><span class="p">,</span> <span class="err">\</span><span class="n">grvirt</span><span class="p">,</span> <span class="err">\</span><span class="n">grvirt</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>  <span class="n">tophys_r1</span>  <span class="n">gr</span>
	<span class="n">ldil</span>    <span class="n">L</span><span class="o">%</span><span class="p">(</span><span class="n">__PAGE_OFFSET</span><span class="p">),</span> <span class="o">%</span><span class="n">r1</span>
	<span class="n">sub</span>     <span class="err">\</span><span class="n">gr</span><span class="p">,</span> <span class="o">%</span><span class="n">r1</span><span class="p">,</span> <span class="err">\</span><span class="n">gr</span>
	<span class="p">.</span><span class="n">endm</span>
	
	<span class="p">.</span><span class="n">macro</span>  <span class="n">tovirt_r1</span>  <span class="n">gr</span>
	<span class="n">ldil</span>    <span class="n">L</span><span class="o">%</span><span class="p">(</span><span class="n">__PAGE_OFFSET</span><span class="p">),</span> <span class="o">%</span><span class="n">r1</span>
	<span class="n">add</span>     <span class="err">\</span><span class="n">gr</span><span class="p">,</span> <span class="o">%</span><span class="n">r1</span><span class="p">,</span> <span class="err">\</span><span class="n">gr</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">delay</span> <span class="n">value</span>
	<span class="n">ldil</span>	<span class="n">L</span><span class="o">%</span><span class="err">\</span><span class="n">value</span><span class="p">,</span> <span class="mi">1</span>
	<span class="n">ldo</span>	<span class="n">R</span><span class="o">%</span><span class="err">\</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span>
	<span class="n">addib</span><span class="p">,</span><span class="n">UV</span><span class="p">,</span><span class="n">n</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,.</span>
	<span class="n">addib</span><span class="p">,</span><span class="n">NUV</span><span class="p">,</span><span class="n">n</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,.</span><span class="o">+</span><span class="mi">8</span>
	<span class="n">nop</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">debug</span> <span class="n">value</span>
	<span class="p">.</span><span class="n">endm</span>


	<span class="cm">/* Shift Left - note the r and t can NOT be the same! */</span>
	<span class="p">.</span><span class="n">macro</span> <span class="n">shl</span> <span class="n">r</span><span class="p">,</span> <span class="n">sa</span><span class="p">,</span> <span class="n">t</span>
	<span class="n">dep</span><span class="p">,</span><span class="n">z</span>	<span class="err">\</span><span class="n">r</span><span class="p">,</span> <span class="mi">31</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="mi">32</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="err">\</span><span class="n">t</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="cm">/* The PA 2.0 shift left */</span>
	<span class="p">.</span><span class="n">macro</span> <span class="n">shlw</span> <span class="n">r</span><span class="p">,</span> <span class="n">sa</span><span class="p">,</span> <span class="n">t</span>
	<span class="n">depw</span><span class="p">,</span><span class="n">z</span>	<span class="err">\</span><span class="n">r</span><span class="p">,</span> <span class="mi">31</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="mi">32</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="err">\</span><span class="n">t</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="cm">/* And the PA 2.0W shift left */</span>
	<span class="p">.</span><span class="n">macro</span> <span class="n">shld</span> <span class="n">r</span><span class="p">,</span> <span class="n">sa</span><span class="p">,</span> <span class="n">t</span>
	<span class="n">depd</span><span class="p">,</span><span class="n">z</span>	<span class="err">\</span><span class="n">r</span><span class="p">,</span> <span class="mi">63</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="mi">64</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="err">\</span><span class="n">t</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="cm">/* Shift Right - note the r and t can NOT be the same! */</span>
	<span class="p">.</span><span class="n">macro</span> <span class="n">shr</span> <span class="n">r</span><span class="p">,</span> <span class="n">sa</span><span class="p">,</span> <span class="n">t</span>
	<span class="n">extru</span> <span class="err">\</span><span class="n">r</span><span class="p">,</span> <span class="mi">31</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="mi">32</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="err">\</span><span class="n">t</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="cm">/* pa20w version of shift right */</span>
	<span class="p">.</span><span class="n">macro</span> <span class="n">shrd</span> <span class="n">r</span><span class="p">,</span> <span class="n">sa</span><span class="p">,</span> <span class="n">t</span>
	<span class="n">extrd</span><span class="p">,</span><span class="n">u</span> <span class="err">\</span><span class="n">r</span><span class="p">,</span> <span class="mi">63</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="mi">64</span><span class="o">-</span><span class="p">(</span><span class="err">\</span><span class="n">sa</span><span class="p">),</span> <span class="err">\</span><span class="n">t</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="cm">/* load 32-bit &#39;value&#39; into &#39;reg&#39; compensating for the ldil</span>
<span class="cm">	 * sign-extension when running in wide mode.</span>
<span class="cm">	 * WARNING!! neither &#39;value&#39; nor &#39;reg&#39; can be expressions</span>
<span class="cm">	 * containing &#39;.&#39;!!!! */</span>
	<span class="p">.</span><span class="n">macro</span>	<span class="n">load32</span> <span class="n">value</span><span class="p">,</span> <span class="n">reg</span>
	<span class="n">ldil</span>	<span class="n">L</span><span class="o">%</span><span class="err">\</span><span class="n">value</span><span class="p">,</span> <span class="err">\</span><span class="n">reg</span>
	<span class="n">ldo</span>	<span class="n">R</span><span class="o">%</span><span class="err">\</span><span class="n">value</span><span class="p">(</span><span class="err">\</span><span class="n">reg</span><span class="p">),</span> <span class="err">\</span><span class="n">reg</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span> <span class="n">loadgp</span>
<span class="cp">#ifdef CONFIG_64BIT</span>
	<span class="n">ldil</span>		<span class="n">L</span><span class="o">%</span><span class="n">__gp</span><span class="p">,</span> <span class="o">%</span><span class="n">r27</span>
	<span class="n">ldo</span>		<span class="n">R</span><span class="o">%</span><span class="n">__gp</span><span class="p">(</span><span class="o">%</span><span class="n">r27</span><span class="p">),</span> <span class="o">%</span><span class="n">r27</span>
<span class="cp">#else</span>
	<span class="n">ldil</span>		<span class="n">L</span><span class="o">%</span><span class="err">$</span><span class="n">global</span><span class="err">$</span><span class="p">,</span> <span class="o">%</span><span class="n">r27</span>
	<span class="n">ldo</span>		<span class="n">R</span><span class="o">%</span><span class="err">$</span><span class="n">global</span><span class="err">$</span><span class="p">(</span><span class="o">%</span><span class="n">r27</span><span class="p">),</span> <span class="o">%</span><span class="n">r27</span>
<span class="cp">#endif</span>
	<span class="p">.</span><span class="n">endm</span>

<span class="cp">#define SAVE_SP(r, where) mfsp r, %r1 ! STREG %r1, where</span>
<span class="cp">#define REST_SP(r, where) LDREG where, %r1 ! mtsp %r1, r</span>
<span class="cp">#define SAVE_CR(r, where) mfctl r, %r1 ! STREG %r1, where</span>
<span class="cp">#define REST_CR(r, where) LDREG where, %r1 ! mtctl %r1, r</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">save_general</span>	<span class="n">regs</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r1</span><span class="p">,</span> <span class="n">PT_GR1</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r2</span><span class="p">,</span> <span class="n">PT_GR2</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r3</span><span class="p">,</span> <span class="n">PT_GR3</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r4</span><span class="p">,</span> <span class="n">PT_GR4</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r5</span><span class="p">,</span> <span class="n">PT_GR5</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r6</span><span class="p">,</span> <span class="n">PT_GR6</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r7</span><span class="p">,</span> <span class="n">PT_GR7</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r8</span><span class="p">,</span> <span class="n">PT_GR8</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r9</span><span class="p">,</span> <span class="n">PT_GR9</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r10</span><span class="p">,</span> <span class="n">PT_GR10</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r11</span><span class="p">,</span> <span class="n">PT_GR11</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r12</span><span class="p">,</span> <span class="n">PT_GR12</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r13</span><span class="p">,</span> <span class="n">PT_GR13</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r14</span><span class="p">,</span> <span class="n">PT_GR14</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r15</span><span class="p">,</span> <span class="n">PT_GR15</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r16</span><span class="p">,</span> <span class="n">PT_GR16</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r17</span><span class="p">,</span> <span class="n">PT_GR17</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r18</span><span class="p">,</span> <span class="n">PT_GR18</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r19</span><span class="p">,</span> <span class="n">PT_GR19</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r20</span><span class="p">,</span> <span class="n">PT_GR20</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r21</span><span class="p">,</span> <span class="n">PT_GR21</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r22</span><span class="p">,</span> <span class="n">PT_GR22</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r23</span><span class="p">,</span> <span class="n">PT_GR23</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r24</span><span class="p">,</span> <span class="n">PT_GR24</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r25</span><span class="p">,</span> <span class="n">PT_GR25</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="cm">/* r26 is saved in get_stack and used to preserve a value across virt_map */</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r27</span><span class="p">,</span> <span class="n">PT_GR27</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r28</span><span class="p">,</span> <span class="n">PT_GR28</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="cm">/* r29 is saved in get_stack and used to point to saved registers */</span>
	<span class="cm">/* r30 stack pointer saved in get_stack */</span>
	<span class="n">STREG</span> <span class="o">%</span><span class="n">r31</span><span class="p">,</span> <span class="n">PT_GR31</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">rest_general</span>	<span class="n">regs</span>
	<span class="cm">/* r1 used as a temp in rest_stack and is restored there */</span>
	<span class="n">LDREG</span> <span class="n">PT_GR2</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r2</span>
	<span class="n">LDREG</span> <span class="n">PT_GR3</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r3</span>
	<span class="n">LDREG</span> <span class="n">PT_GR4</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r4</span>
	<span class="n">LDREG</span> <span class="n">PT_GR5</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r5</span>
	<span class="n">LDREG</span> <span class="n">PT_GR6</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r6</span>
	<span class="n">LDREG</span> <span class="n">PT_GR7</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r7</span>
	<span class="n">LDREG</span> <span class="n">PT_GR8</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r8</span>
	<span class="n">LDREG</span> <span class="n">PT_GR9</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r9</span>
	<span class="n">LDREG</span> <span class="n">PT_GR10</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r10</span>
	<span class="n">LDREG</span> <span class="n">PT_GR11</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r11</span>
	<span class="n">LDREG</span> <span class="n">PT_GR12</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r12</span>
	<span class="n">LDREG</span> <span class="n">PT_GR13</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r13</span>
	<span class="n">LDREG</span> <span class="n">PT_GR14</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r14</span>
	<span class="n">LDREG</span> <span class="n">PT_GR15</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r15</span>
	<span class="n">LDREG</span> <span class="n">PT_GR16</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r16</span>
	<span class="n">LDREG</span> <span class="n">PT_GR17</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r17</span>
	<span class="n">LDREG</span> <span class="n">PT_GR18</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r18</span>
	<span class="n">LDREG</span> <span class="n">PT_GR19</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r19</span>
	<span class="n">LDREG</span> <span class="n">PT_GR20</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r20</span>
	<span class="n">LDREG</span> <span class="n">PT_GR21</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r21</span>
	<span class="n">LDREG</span> <span class="n">PT_GR22</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r22</span>
	<span class="n">LDREG</span> <span class="n">PT_GR23</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r23</span>
	<span class="n">LDREG</span> <span class="n">PT_GR24</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r24</span>
	<span class="n">LDREG</span> <span class="n">PT_GR25</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r25</span>
	<span class="n">LDREG</span> <span class="n">PT_GR26</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r26</span>
	<span class="n">LDREG</span> <span class="n">PT_GR27</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r27</span>
	<span class="n">LDREG</span> <span class="n">PT_GR28</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r28</span>
	<span class="cm">/* r29 points to register save area, and is restored in rest_stack */</span>
	<span class="cm">/* r30 stack pointer restored in rest_stack */</span>
	<span class="n">LDREG</span> <span class="n">PT_GR31</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span> <span class="o">%</span><span class="n">r31</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">save_fp</span> 	<span class="n">regs</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>  <span class="o">%</span><span class="n">fr0</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr1</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr2</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr3</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr4</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr5</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr6</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr7</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr8</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr9</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr10</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr11</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr12</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr13</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr14</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr15</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr16</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr17</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr18</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr19</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr20</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr21</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr22</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr23</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr24</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr25</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr26</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr27</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr28</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr29</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	<span class="o">%</span><span class="n">fr30</span><span class="p">,</span> <span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="n">fstd</span>	<span class="o">%</span><span class="n">fr31</span><span class="p">,</span> <span class="mi">0</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">rest_fp</span> 	<span class="n">regs</span>
	<span class="n">fldd</span>	<span class="mi">0</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>	 <span class="o">%</span><span class="n">fr31</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr30</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr29</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr28</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr27</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr26</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr25</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr24</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr23</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr22</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr21</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr20</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr19</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr18</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr17</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr16</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr15</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr14</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr13</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr12</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr11</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr10</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr9</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr8</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr7</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr6</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr5</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr4</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr3</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr2</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr1</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">),</span>       <span class="o">%</span><span class="n">fr0</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">callee_save_float</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr12</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr13</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr14</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr15</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr16</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr17</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr18</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr19</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr20</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">fstd</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">fr21</span><span class="p">,</span>	<span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">callee_rest_float</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr21</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr20</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr19</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr18</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr17</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr16</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr15</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr14</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr13</span>
	<span class="n">fldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="mi">8</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">fr12</span>
	<span class="p">.</span><span class="n">endm</span>

<span class="cp">#ifdef CONFIG_64BIT</span>
	<span class="p">.</span><span class="n">macro</span>	<span class="n">callee_save</span>
	<span class="n">std</span><span class="p">,</span><span class="n">ma</span>	  <span class="o">%</span><span class="n">r3</span><span class="p">,</span>	 <span class="n">CALLEE_REG_FRAME_SIZE</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">mfctl</span>	  <span class="o">%</span><span class="n">cr27</span><span class="p">,</span> <span class="o">%</span><span class="n">r3</span>
	<span class="n">std</span>	  <span class="o">%</span><span class="n">r4</span><span class="p">,</span>	<span class="o">-</span><span class="mi">136</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	  <span class="o">%</span><span class="n">r5</span><span class="p">,</span>	<span class="o">-</span><span class="mi">128</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	  <span class="o">%</span><span class="n">r6</span><span class="p">,</span>	<span class="o">-</span><span class="mi">120</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	  <span class="o">%</span><span class="n">r7</span><span class="p">,</span>	<span class="o">-</span><span class="mi">112</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	  <span class="o">%</span><span class="n">r8</span><span class="p">,</span>	<span class="o">-</span><span class="mi">104</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	  <span class="o">%</span><span class="n">r9</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">96</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r10</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">88</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r11</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">80</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r12</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">72</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r13</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">64</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r14</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">56</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r15</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">48</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r16</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">40</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r17</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">32</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	 <span class="o">%</span><span class="n">r18</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">24</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">std</span>	  <span class="o">%</span><span class="n">r3</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">16</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">callee_rest</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">16</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r3</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">24</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r18</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">32</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r17</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">40</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r16</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">48</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r15</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">56</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r14</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">64</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r13</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">72</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r12</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">80</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r11</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">88</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r10</span>
	<span class="n">ldd</span>	 <span class="o">-</span><span class="mi">96</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r9</span>
	<span class="n">ldd</span>	<span class="o">-</span><span class="mi">104</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r8</span>
	<span class="n">ldd</span>	<span class="o">-</span><span class="mi">112</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r7</span>
	<span class="n">ldd</span>	<span class="o">-</span><span class="mi">120</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r6</span>
	<span class="n">ldd</span>	<span class="o">-</span><span class="mi">128</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r5</span>
	<span class="n">ldd</span>	<span class="o">-</span><span class="mi">136</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r4</span>
	<span class="n">mtctl</span>	<span class="o">%</span><span class="n">r3</span><span class="p">,</span> <span class="o">%</span><span class="n">cr27</span>
	<span class="n">ldd</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="n">CALLEE_REG_FRAME_SIZE</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r3</span>
	<span class="p">.</span><span class="n">endm</span>

<span class="cp">#else </span><span class="cm">/* ! CONFIG_64BIT */</span><span class="cp"></span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">callee_save</span>
	<span class="n">stw</span><span class="p">,</span><span class="n">ma</span>	 <span class="o">%</span><span class="n">r3</span><span class="p">,</span>	<span class="n">CALLEE_REG_FRAME_SIZE</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">mfctl</span>	 <span class="o">%</span><span class="n">cr27</span><span class="p">,</span> <span class="o">%</span><span class="n">r3</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r4</span><span class="p">,</span>	<span class="o">-</span><span class="mi">124</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r5</span><span class="p">,</span>	<span class="o">-</span><span class="mi">120</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r6</span><span class="p">,</span>	<span class="o">-</span><span class="mi">116</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r7</span><span class="p">,</span>	<span class="o">-</span><span class="mi">112</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r8</span><span class="p">,</span>	<span class="o">-</span><span class="mi">108</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r9</span><span class="p">,</span>	<span class="o">-</span><span class="mi">104</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r10</span><span class="p">,</span>	<span class="o">-</span><span class="mi">100</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r11</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">96</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r12</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">92</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r13</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">88</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r14</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">84</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r15</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">80</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r16</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">76</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r17</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">72</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	 <span class="o">%</span><span class="n">r18</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">68</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="n">stw</span>	  <span class="o">%</span><span class="n">r3</span><span class="p">,</span>	 <span class="o">-</span><span class="mi">64</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">callee_rest</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">64</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>    <span class="o">%</span><span class="n">r3</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">68</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r18</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">72</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r17</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">76</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r16</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">80</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r15</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">84</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r14</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">88</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r13</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">92</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r12</span>
	<span class="n">ldw</span>	 <span class="o">-</span><span class="mi">96</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r11</span>
	<span class="n">ldw</span>	<span class="o">-</span><span class="mi">100</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r10</span>
	<span class="n">ldw</span>	<span class="o">-</span><span class="mi">104</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r9</span>
	<span class="n">ldw</span>	<span class="o">-</span><span class="mi">108</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r8</span>
	<span class="n">ldw</span>	<span class="o">-</span><span class="mi">112</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r7</span>
	<span class="n">ldw</span>	<span class="o">-</span><span class="mi">116</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r6</span>
	<span class="n">ldw</span>	<span class="o">-</span><span class="mi">120</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r5</span>
	<span class="n">ldw</span>	<span class="o">-</span><span class="mi">124</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r4</span>
	<span class="n">mtctl</span>	<span class="o">%</span><span class="n">r3</span><span class="p">,</span> <span class="o">%</span><span class="n">cr27</span>
	<span class="n">ldw</span><span class="p">,</span><span class="n">mb</span>	<span class="o">-</span><span class="n">CALLEE_REG_FRAME_SIZE</span><span class="p">(</span><span class="o">%</span><span class="n">r30</span><span class="p">),</span>   <span class="o">%</span><span class="n">r3</span>
	<span class="p">.</span><span class="n">endm</span>
<span class="cp">#endif </span><span class="cm">/* ! CONFIG_64BIT */</span><span class="cp"></span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">save_specials</span>	<span class="n">regs</span>

	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr0</span><span class="p">,</span> <span class="n">PT_SR0</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr1</span><span class="p">,</span> <span class="n">PT_SR1</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr2</span><span class="p">,</span> <span class="n">PT_SR2</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr3</span><span class="p">,</span> <span class="n">PT_SR3</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr4</span><span class="p">,</span> <span class="n">PT_SR4</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr5</span><span class="p">,</span> <span class="n">PT_SR5</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr6</span><span class="p">,</span> <span class="n">PT_SR6</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">SAVE_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr7</span><span class="p">,</span> <span class="n">PT_SR7</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

	<span class="n">SAVE_CR</span>  <span class="p">(</span><span class="o">%</span><span class="n">cr17</span><span class="p">,</span> <span class="n">PT_IASQ0</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">mtctl</span>	 <span class="o">%</span><span class="n">r0</span><span class="p">,</span>	<span class="o">%</span><span class="n">cr17</span>
	<span class="n">SAVE_CR</span>  <span class="p">(</span><span class="o">%</span><span class="n">cr17</span><span class="p">,</span> <span class="n">PT_IASQ1</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

	<span class="n">SAVE_CR</span>  <span class="p">(</span><span class="o">%</span><span class="n">cr18</span><span class="p">,</span> <span class="n">PT_IAOQ0</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">mtctl</span>	 <span class="o">%</span><span class="n">r0</span><span class="p">,</span>	<span class="o">%</span><span class="n">cr18</span>
	<span class="n">SAVE_CR</span>  <span class="p">(</span><span class="o">%</span><span class="n">cr18</span><span class="p">,</span> <span class="n">PT_IAOQ1</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

<span class="cp">#ifdef CONFIG_64BIT</span>
	<span class="cm">/* cr11 (sar) is a funny one.  5 bits on PA1.1 and 6 bit on PA2.0</span>
<span class="cm">	 * For PA2.0 mtsar or mtctl always write 6 bits, but mfctl only</span>
<span class="cm">	 * reads 5 bits.  Use mfctl,w to read all six bits.  Otherwise</span>
<span class="cm">	 * we lose the 6th bit on a save/restore over interrupt.</span>
<span class="cm">	 */</span>
	<span class="n">mfctl</span><span class="p">,</span><span class="n">w</span>  <span class="o">%</span><span class="n">cr11</span><span class="p">,</span> <span class="o">%</span><span class="n">r1</span>
	<span class="n">STREG</span>    <span class="o">%</span><span class="n">r1</span><span class="p">,</span> <span class="n">PT_SAR</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
<span class="cp">#else</span>
	<span class="n">SAVE_CR</span>  <span class="p">(</span><span class="o">%</span><span class="n">cr11</span><span class="p">,</span> <span class="n">PT_SAR</span>  <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
<span class="cp">#endif</span>
	<span class="n">SAVE_CR</span>  <span class="p">(</span><span class="o">%</span><span class="n">cr19</span><span class="p">,</span> <span class="n">PT_IIR</span>  <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

	<span class="cm">/*</span>
<span class="cm">	 * Code immediately following this macro (in intr_save) relies</span>
<span class="cm">	 * on r8 containing ipsw.</span>
<span class="cm">	 */</span>
	<span class="n">mfctl</span>    <span class="o">%</span><span class="n">cr22</span><span class="p">,</span> <span class="o">%</span><span class="n">r8</span>
	<span class="n">STREG</span>    <span class="o">%</span><span class="n">r8</span><span class="p">,</span>   <span class="n">PT_PSW</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">)</span>
	<span class="p">.</span><span class="n">endm</span>

	<span class="p">.</span><span class="n">macro</span>	<span class="n">rest_specials</span>	<span class="n">regs</span>

	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr0</span><span class="p">,</span> <span class="n">PT_SR0</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr1</span><span class="p">,</span> <span class="n">PT_SR1</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr2</span><span class="p">,</span> <span class="n">PT_SR2</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr3</span><span class="p">,</span> <span class="n">PT_SR3</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr4</span><span class="p">,</span> <span class="n">PT_SR4</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr5</span><span class="p">,</span> <span class="n">PT_SR5</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr6</span><span class="p">,</span> <span class="n">PT_SR6</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_SP</span>  <span class="p">(</span><span class="o">%</span><span class="n">sr7</span><span class="p">,</span> <span class="n">PT_SR7</span> <span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

	<span class="n">REST_CR</span>	<span class="p">(</span><span class="o">%</span><span class="n">cr17</span><span class="p">,</span> <span class="n">PT_IASQ0</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_CR</span>	<span class="p">(</span><span class="o">%</span><span class="n">cr17</span><span class="p">,</span> <span class="n">PT_IASQ1</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

	<span class="n">REST_CR</span>	<span class="p">(</span><span class="o">%</span><span class="n">cr18</span><span class="p">,</span> <span class="n">PT_IAOQ0</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="n">REST_CR</span>	<span class="p">(</span><span class="o">%</span><span class="n">cr18</span><span class="p">,</span> <span class="n">PT_IAOQ1</span><span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

	<span class="n">REST_CR</span> <span class="p">(</span><span class="o">%</span><span class="n">cr11</span><span class="p">,</span> <span class="n">PT_SAR</span>	<span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>

	<span class="n">REST_CR</span>	<span class="p">(</span><span class="o">%</span><span class="n">cr22</span><span class="p">,</span> <span class="n">PT_PSW</span>	<span class="p">(</span><span class="err">\</span><span class="n">regs</span><span class="p">))</span>
	<span class="p">.</span><span class="n">endm</span>


	<span class="cm">/* First step to create a &quot;relied upon translation&quot;</span>
<span class="cm">	 * See PA 2.0 Arch. page F-4 and F-5.</span>
<span class="cm">	 *</span>
<span class="cm">	 * The ssm was originally necessary due to a &quot;PCxT bug&quot;.</span>
<span class="cm">	 * But someone decided it needed to be added to the architecture</span>
<span class="cm">	 * and this &quot;feature&quot; went into rev3 of PA-RISC 1.1 Arch Manual.</span>
<span class="cm">	 * It&#39;s been carried forward into PA 2.0 Arch as well. :^(</span>
<span class="cm">	 *</span>
<span class="cm">	 * &quot;ssm 0,%r0&quot; is a NOP with side effects (prefetch barrier).</span>
<span class="cm">	 * rsm/ssm prevents the ifetch unit from speculatively fetching</span>
<span class="cm">	 * instructions past this line in the code stream.</span>
<span class="cm">	 * PA 2.0 processor will single step all insn in the same QUAD (4 insn).</span>
<span class="cm">	 */</span>
	<span class="p">.</span><span class="n">macro</span>	<span class="n">pcxt_ssm_bug</span>
	<span class="n">rsm</span>	<span class="n">PSW_SM_I</span><span class="p">,</span><span class="o">%</span><span class="n">r0</span>
	<span class="n">nop</span>	<span class="cm">/* 1 */</span>
	<span class="n">nop</span>	<span class="cm">/* 2 */</span>
	<span class="n">nop</span>	<span class="cm">/* 3 */</span>
	<span class="n">nop</span>	<span class="cm">/* 4 */</span>
	<span class="n">nop</span>	<span class="cm">/* 5 */</span>
	<span class="n">nop</span>	<span class="cm">/* 6 */</span>
	<span class="n">nop</span>	<span class="cm">/* 7 */</span>
	<span class="p">.</span><span class="n">endm</span>

<span class="cp">#endif </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>
<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
