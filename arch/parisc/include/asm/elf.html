<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › parisc › include › asm › elf.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>elf.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __ASMPARISC_ELF_H</span>
<span class="cp">#define __ASMPARISC_ELF_H</span>

<span class="cm">/*</span>
<span class="cm"> * ELF register definitions..</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;asm/ptrace.h&gt;</span>

<span class="cp">#define EM_PARISC 15</span>

<span class="cm">/* HPPA specific definitions.  */</span>

<span class="cm">/* Legal values for e_flags field of Elf32_Ehdr.  */</span>

<span class="cp">#define EF_PARISC_TRAPNIL	0x00010000 </span><span class="cm">/* Trap nil pointer dereference.  */</span><span class="cp"></span>
<span class="cp">#define EF_PARISC_EXT		0x00020000 </span><span class="cm">/* Program uses arch. extensions. */</span><span class="cp"></span>
<span class="cp">#define EF_PARISC_LSB		0x00040000 </span><span class="cm">/* Program expects little endian. */</span><span class="cp"></span>
<span class="cp">#define EF_PARISC_WIDE		0x00080000 </span><span class="cm">/* Program expects wide mode.  */</span><span class="cp"></span>
<span class="cp">#define EF_PARISC_NO_KABP	0x00100000 </span><span class="cm">/* No kernel assisted branch</span>
<span class="cm">					      prediction.  */</span><span class="cp"></span>
<span class="cp">#define EF_PARISC_LAZYSWAP	0x00400000 </span><span class="cm">/* Allow lazy swapping.  */</span><span class="cp"></span>
<span class="cp">#define EF_PARISC_ARCH		0x0000ffff </span><span class="cm">/* Architecture version.  */</span><span class="cp"></span>

<span class="cm">/* Defined values for `e_flags &amp; EF_PARISC_ARCH&#39; are:  */</span>

<span class="cp">#define EFA_PARISC_1_0		    0x020b </span><span class="cm">/* PA-RISC 1.0 big-endian.  */</span><span class="cp"></span>
<span class="cp">#define EFA_PARISC_1_1		    0x0210 </span><span class="cm">/* PA-RISC 1.1 big-endian.  */</span><span class="cp"></span>
<span class="cp">#define EFA_PARISC_2_0		    0x0214 </span><span class="cm">/* PA-RISC 2.0 big-endian.  */</span><span class="cp"></span>

<span class="cm">/* Additional section indices.  */</span>

<span class="cp">#define SHN_PARISC_ANSI_COMMON	0xff00	   </span><span class="cm">/* Section for tenatively declared</span>
<span class="cm">					      symbols in ANSI C.  */</span><span class="cp"></span>
<span class="cp">#define SHN_PARISC_HUGE_COMMON	0xff01	   </span><span class="cm">/* Common blocks in huge model.  */</span><span class="cp"></span>

<span class="cm">/* Legal values for sh_type field of Elf32_Shdr.  */</span>

<span class="cp">#define SHT_PARISC_EXT		0x70000000 </span><span class="cm">/* Contains product specific ext. */</span><span class="cp"></span>
<span class="cp">#define SHT_PARISC_UNWIND	0x70000001 </span><span class="cm">/* Unwind information.  */</span><span class="cp"></span>
<span class="cp">#define SHT_PARISC_DOC		0x70000002 </span><span class="cm">/* Debug info for optimized code. */</span><span class="cp"></span>

<span class="cm">/* Legal values for sh_flags field of Elf32_Shdr.  */</span>

<span class="cp">#define SHF_PARISC_SHORT	0x20000000 </span><span class="cm">/* Section with short addressing. */</span><span class="cp"></span>
<span class="cp">#define SHF_PARISC_HUGE		0x40000000 </span><span class="cm">/* Section far from gp.  */</span><span class="cp"></span>
<span class="cp">#define SHF_PARISC_SBP		0x80000000 </span><span class="cm">/* Static branch prediction code. */</span><span class="cp"></span>

<span class="cm">/* Legal values for ST_TYPE subfield of st_info (symbol type).  */</span>

<span class="cp">#define STT_PARISC_MILLICODE	13	</span><span class="cm">/* Millicode function entry point.  */</span><span class="cp"></span>

<span class="cp">#define STT_HP_OPAQUE		(STT_LOOS + 0x1)</span>
<span class="cp">#define STT_HP_STUB		(STT_LOOS + 0x2)</span>

<span class="cm">/* HPPA relocs.  */</span>

<span class="cp">#define R_PARISC_NONE		0	</span><span class="cm">/* No reloc.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR32		1	</span><span class="cm">/* Direct 32-bit reference.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR21L		2	</span><span class="cm">/* Left 21 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR17R		3	</span><span class="cm">/* Right 17 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR17F		4	</span><span class="cm">/* 17 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR14R		6	</span><span class="cm">/* Right 14 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL32	9	</span><span class="cm">/* 32-bit rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL21L	10	</span><span class="cm">/* Left 21 bits of rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL17R	11	</span><span class="cm">/* Right 17 bits of rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL17F	12	</span><span class="cm">/* 17 bits of rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL14R	14	</span><span class="cm">/* Right 14 bits of rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DPREL21L	18	</span><span class="cm">/* Left 21 bits of rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DPREL14R	22	</span><span class="cm">/* Right 14 bits of rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL21L	26	</span><span class="cm">/* GP-relative, left 21 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL14R	30	</span><span class="cm">/* GP-relative, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF21L	34	</span><span class="cm">/* LT-relative, left 21 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF14R	38	</span><span class="cm">/* LT-relative, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_SECREL32	41	</span><span class="cm">/* 32 bits section rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_SEGBASE	48	</span><span class="cm">/* No relocation, set segment base.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_SEGREL32	49	</span><span class="cm">/* 32 bits segment rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLTOFF21L	50	</span><span class="cm">/* PLT rel. address, left 21 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLTOFF14R	54	</span><span class="cm">/* PLT rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR32	57	</span><span class="cm">/* 32 bits LT-rel. function pointer. */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR21L	58	</span><span class="cm">/* LT-rel. fct ptr, left 21 bits. */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR14R	62	</span><span class="cm">/* LT-rel. fct ptr, right 14 bits. */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_FPTR64		64	</span><span class="cm">/* 64 bits function address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLABEL32	65	</span><span class="cm">/* 32 bits function address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL64	72	</span><span class="cm">/* 64 bits PC-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL22F	74	</span><span class="cm">/* 22 bits PC-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL14WR	75	</span><span class="cm">/* PC-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL14DR	76	</span><span class="cm">/* PC rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL16F	77	</span><span class="cm">/* 16 bits PC-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL16WF	78	</span><span class="cm">/* 16 bits PC-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PCREL16DF	79	</span><span class="cm">/* 16 bits PC-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR64		80	</span><span class="cm">/* 64 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR14WR	83	</span><span class="cm">/* 14 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR14DR	84	</span><span class="cm">/* 14 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR16F		85	</span><span class="cm">/* 16 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR16WF	86	</span><span class="cm">/* 16 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_DIR16DF	87	</span><span class="cm">/* 16 bits of eff. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL64	88	</span><span class="cm">/* 64 bits of GP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL14WR	91	</span><span class="cm">/* GP-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL14DR	92	</span><span class="cm">/* GP-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL16F	93	</span><span class="cm">/* 16 bits GP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL16WF	94	</span><span class="cm">/* 16 bits GP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_GPREL16DF	95	</span><span class="cm">/* 16 bits GP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF64	96	</span><span class="cm">/* 64 bits LT-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF14WR	99	</span><span class="cm">/* LT-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF14DR	100	</span><span class="cm">/* LT-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF16F	101	</span><span class="cm">/* 16 bits LT-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF16WF	102	</span><span class="cm">/* 16 bits LT-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF16DF	103	</span><span class="cm">/* 16 bits LT-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_SECREL64	104	</span><span class="cm">/* 64 bits section rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_SEGREL64	112	</span><span class="cm">/* 64 bits segment rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLTOFF14WR	115	</span><span class="cm">/* PLT-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLTOFF14DR	116	</span><span class="cm">/* PLT-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLTOFF16F	117	</span><span class="cm">/* 16 bits LT-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLTOFF16WF	118	</span><span class="cm">/* 16 bits PLT-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_PLTOFF16DF	119	</span><span class="cm">/* 16 bits PLT-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR64	120	</span><span class="cm">/* 64 bits LT-rel. function ptr.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR14WR	123	</span><span class="cm">/* LT-rel. fct. ptr., right 14 bits. */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR14DR	124	</span><span class="cm">/* LT-rel. fct. ptr., right 14 bits. */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR16F	125	</span><span class="cm">/* 16 bits LT-rel. function ptr.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR16WF	126	</span><span class="cm">/* 16 bits LT-rel. function ptr.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_FPTR16DF	127	</span><span class="cm">/* 16 bits LT-rel. function ptr.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LORESERVE	128</span>
<span class="cp">#define R_PARISC_COPY		128	</span><span class="cm">/* Copy relocation.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_IPLT		129	</span><span class="cm">/* Dynamic reloc, imported PLT */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_EPLT		130	</span><span class="cm">/* Dynamic reloc, exported PLT */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL32	153	</span><span class="cm">/* 32 bits TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL21L	154	</span><span class="cm">/* TP-rel. address, left 21 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL14R	158	</span><span class="cm">/* TP-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP21L	162	</span><span class="cm">/* LT-TP-rel. address, left 21 bits. */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP14R	166	</span><span class="cm">/* LT-TP-rel. address, right 14 bits.*/</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP14F	167	</span><span class="cm">/* 14 bits LT-TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL64	216	</span><span class="cm">/* 64 bits TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL14WR	219	</span><span class="cm">/* TP-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL14DR	220	</span><span class="cm">/* TP-rel. address, right 14 bits.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL16F	221	</span><span class="cm">/* 16 bits TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL16WF	222	</span><span class="cm">/* 16 bits TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_TPREL16DF	223	</span><span class="cm">/* 16 bits TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP64	224	</span><span class="cm">/* 64 bits LT-TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP14WR	227	</span><span class="cm">/* LT-TP-rel. address, right 14 bits.*/</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP14DR	228	</span><span class="cm">/* LT-TP-rel. address, right 14 bits.*/</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP16F	229	</span><span class="cm">/* 16 bits LT-TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP16WF	230	</span><span class="cm">/* 16 bits LT-TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_LTOFF_TP16DF	231	</span><span class="cm">/* 16 bits LT-TP-rel. address.  */</span><span class="cp"></span>
<span class="cp">#define R_PARISC_HIRESERVE	255</span>

<span class="cp">#define PA_PLABEL_FDESC		0x02	</span><span class="cm">/* bit set if PLABEL points to</span>
<span class="cm">					 * a function descriptor, not</span>
<span class="cm">					 * an address */</span><span class="cp"></span>

<span class="cm">/* The following are PA function descriptors </span>
<span class="cm"> *</span>
<span class="cm"> * addr:	the absolute address of the function</span>
<span class="cm"> * gp:		either the data pointer (r27) for non-PIC code or the</span>
<span class="cm"> *		the PLT pointer (r19) for PIC code */</span>

<span class="cm">/* Format for the Elf32 Function descriptor */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">elf32_fdesc</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">addr</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">gp</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Elf32_Fdesc</span><span class="p">;</span>

<span class="cm">/* Format for the Elf64 Function descriptor */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">elf64_fdesc</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">dummy</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* FIXME: nothing uses these, why waste</span>
<span class="cm">			   * the space */</span>
	<span class="n">__u64</span>	<span class="n">addr</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">gp</span><span class="p">;</span>
<span class="p">}</span> <span class="n">Elf64_Fdesc</span><span class="p">;</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#ifdef CONFIG_64BIT</span>
<span class="cp">#define Elf_Fdesc	Elf64_Fdesc</span>
<span class="cp">#else</span>
<span class="cp">#define Elf_Fdesc	Elf32_Fdesc</span>
<span class="cp">#endif </span><span class="cm">/*CONFIG_64BIT*/</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/*__KERNEL__*/</span><span class="cp"></span>

<span class="cm">/* Legal values for p_type field of Elf32_Phdr/Elf64_Phdr.  */</span>

<span class="cp">#define PT_HP_TLS		(PT_LOOS + 0x0)</span>
<span class="cp">#define PT_HP_CORE_NONE		(PT_LOOS + 0x1)</span>
<span class="cp">#define PT_HP_CORE_VERSION	(PT_LOOS + 0x2)</span>
<span class="cp">#define PT_HP_CORE_KERNEL	(PT_LOOS + 0x3)</span>
<span class="cp">#define PT_HP_CORE_COMM		(PT_LOOS + 0x4)</span>
<span class="cp">#define PT_HP_CORE_PROC		(PT_LOOS + 0x5)</span>
<span class="cp">#define PT_HP_CORE_LOADABLE	(PT_LOOS + 0x6)</span>
<span class="cp">#define PT_HP_CORE_STACK	(PT_LOOS + 0x7)</span>
<span class="cp">#define PT_HP_CORE_SHM		(PT_LOOS + 0x8)</span>
<span class="cp">#define PT_HP_CORE_MMF		(PT_LOOS + 0x9)</span>
<span class="cp">#define PT_HP_PARALLEL		(PT_LOOS + 0x10)</span>
<span class="cp">#define PT_HP_FASTBIND		(PT_LOOS + 0x11)</span>
<span class="cp">#define PT_HP_OPT_ANNOT		(PT_LOOS + 0x12)</span>
<span class="cp">#define PT_HP_HSL_ANNOT		(PT_LOOS + 0x13)</span>
<span class="cp">#define PT_HP_STACK		(PT_LOOS + 0x14)</span>

<span class="cp">#define PT_PARISC_ARCHEXT	0x70000000</span>
<span class="cp">#define PT_PARISC_UNWIND	0x70000001</span>

<span class="cm">/* Legal values for p_flags field of Elf32_Phdr/Elf64_Phdr.  */</span>

<span class="cp">#define PF_PARISC_SBP		0x08000000</span>

<span class="cp">#define PF_HP_PAGE_SIZE		0x00100000</span>
<span class="cp">#define PF_HP_FAR_SHARED	0x00200000</span>
<span class="cp">#define PF_HP_NEAR_SHARED	0x00400000</span>
<span class="cp">#define PF_HP_CODE		0x01000000</span>
<span class="cp">#define PF_HP_MODIFY		0x02000000</span>
<span class="cp">#define PF_HP_LAZYSWAP		0x04000000</span>
<span class="cp">#define PF_HP_SBP		0x08000000</span>

<span class="cm">/*</span>
<span class="cm"> * The following definitions are those for 32-bit ELF binaries on a 32-bit</span>
<span class="cm"> * kernel and for 64-bit binaries on a 64-bit kernel.  To run 32-bit binaries</span>
<span class="cm"> * on a 64-bit kernel, arch/parisc/kernel/binfmt_elf32.c defines these</span>
<span class="cm"> * macros appropriately and then #includes binfmt_elf.c, which then includes</span>
<span class="cm"> * this file.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef ELF_CLASS</span>

<span class="cm">/*</span>
<span class="cm"> * This is used to ensure we don&#39;t load something for the wrong architecture.</span>
<span class="cm"> *</span>
<span class="cm"> * Note that this header file is used by default in fs/binfmt_elf.c. So</span>
<span class="cm"> * the following macros are for the default case. However, for the 64</span>
<span class="cm"> * bit kernel we also support 32 bit parisc binaries. To do that</span>
<span class="cm"> * arch/parisc/kernel/binfmt_elf32.c defines its own set of these</span>
<span class="cm"> * macros, and then it includes fs/binfmt_elf.c to provide an alternate</span>
<span class="cm"> * elf binary handler for 32 bit binaries (on the 64 bit kernel).</span>
<span class="cm"> */</span>
<span class="cp">#ifdef CONFIG_64BIT</span>
<span class="cp">#define ELF_CLASS   ELFCLASS64</span>
<span class="cp">#else</span>
<span class="cp">#define ELF_CLASS	ELFCLASS32</span>
<span class="cp">#endif</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">elf_greg_t</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * This yields a string that ld.so will use to load implementation</span>
<span class="cm"> * specific libraries for optimization.  This is more specific in</span>
<span class="cm"> * intent than poking at uname or /proc/cpuinfo.</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_PLATFORM  (&quot;PARISC\0&quot;)</span>

<span class="cp">#define SET_PERSONALITY(ex) \</span>
<span class="cp">	current-&gt;personality = PER_LINUX; \</span>
<span class="cp">	current-&gt;thread.map_base = DEFAULT_MAP_BASE; \</span>
<span class="cp">	current-&gt;thread.task_size = DEFAULT_TASK_SIZE \</span>

<span class="cm">/*</span>
<span class="cm"> * Fill in general registers in a core dump.  This saves pretty</span>
<span class="cm"> * much the same registers as hp-ux, although in a different order.</span>
<span class="cm"> * Registers marked # below are not currently saved in pt_regs, so</span>
<span class="cm"> * we use their current values here.</span>
<span class="cm"> *</span>
<span class="cm"> * 	gr0..gr31</span>
<span class="cm"> * 	sr0..sr7</span>
<span class="cm"> * 	iaoq0..iaoq1</span>
<span class="cm"> * 	iasq0..iasq1</span>
<span class="cm"> * 	cr11 (sar)</span>
<span class="cm"> * 	cr19 (iir)</span>
<span class="cm"> * 	cr20 (isr)</span>
<span class="cm"> * 	cr21 (ior)</span>
<span class="cm"> *  #	cr22 (ipsw)</span>
<span class="cm"> *  #	cr0 (recovery counter)</span>
<span class="cm"> *  #	cr24..cr31 (temporary registers)</span>
<span class="cm"> *  #	cr8,9,12,13 (protection IDs)</span>
<span class="cm"> *  #	cr10 (scr/ccr)</span>
<span class="cm"> *  #	cr15 (ext int enable mask)</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#define ELF_CORE_COPY_REGS(dst, pt)	\</span>
<span class="cp">	memset(dst, 0, sizeof(dst));	</span><span class="cm">/* don&#39;t leak any &quot;random&quot; bits */</span><span class="cp"> \</span>
<span class="cp">	memcpy(dst + 0, pt-&gt;gr, 32 * sizeof(elf_greg_t)); \</span>
<span class="cp">	memcpy(dst + 32, pt-&gt;sr, 8 * sizeof(elf_greg_t)); \</span>
<span class="cp">	memcpy(dst + 40, pt-&gt;iaoq, 2 * sizeof(elf_greg_t)); \</span>
<span class="cp">	memcpy(dst + 42, pt-&gt;iasq, 2 * sizeof(elf_greg_t)); \</span>
<span class="cp">	dst[44] = pt-&gt;sar;   dst[45] = pt-&gt;iir; \</span>
<span class="cp">	dst[46] = pt-&gt;isr;   dst[47] = pt-&gt;ior; \</span>
<span class="cp">	dst[48] = mfctl(22); dst[49] = mfctl(0); \</span>
<span class="cp">	dst[50] = mfctl(24); dst[51] = mfctl(25); \</span>
<span class="cp">	dst[52] = mfctl(26); dst[53] = mfctl(27); \</span>
<span class="cp">	dst[54] = mfctl(28); dst[55] = mfctl(29); \</span>
<span class="cp">	dst[56] = mfctl(30); dst[57] = mfctl(31); \</span>
<span class="cp">	dst[58] = mfctl( 8); dst[59] = mfctl( 9); \</span>
<span class="cp">	dst[60] = mfctl(12); dst[61] = mfctl(13); \</span>
<span class="cp">	dst[62] = mfctl(10); dst[63] = mfctl(15);</span>

<span class="cp">#endif </span><span class="cm">/* ! ELF_CLASS */</span><span class="cp"></span>

<span class="cp">#define ELF_NGREG 80	</span><span class="cm">/* We only need 64 at present, but leave space</span>
<span class="cm">			   for expansion. */</span><span class="cp"></span>
<span class="k">typedef</span> <span class="n">elf_greg_t</span> <span class="n">elf_gregset_t</span><span class="p">[</span><span class="n">ELF_NGREG</span><span class="p">];</span>

<span class="cp">#define ELF_NFPREG 32</span>
<span class="k">typedef</span> <span class="kt">double</span> <span class="n">elf_fpreg_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">elf_fpreg_t</span> <span class="n">elf_fpregset_t</span><span class="p">[</span><span class="n">ELF_NFPREG</span><span class="p">];</span>

<span class="k">struct</span> <span class="n">task_struct</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">dump_task_fpu</span> <span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="p">,</span> <span class="n">elf_fpregset_t</span> <span class="o">*</span><span class="p">);</span>
<span class="cp">#define ELF_CORE_COPY_FPREGS(tsk, elf_fpregs) dump_task_fpu(tsk, elf_fpregs)</span>

<span class="k">struct</span> <span class="n">pt_regs</span><span class="p">;</span>	<span class="cm">/* forward declaration... */</span>


<span class="cp">#define elf_check_arch(x) ((x)-&gt;e_machine == EM_PARISC &amp;&amp; (x)-&gt;e_ident[EI_CLASS] == ELF_CLASS)</span>

<span class="cm">/*</span>
<span class="cm"> * These are used to set parameters in the core dumps.</span>
<span class="cm"> */</span>
<span class="cp">#define ELF_DATA	ELFDATA2MSB</span>
<span class="cp">#define ELF_ARCH	EM_PARISC</span>
<span class="cp">#define ELF_OSABI 	ELFOSABI_LINUX</span>

<span class="cm">/* %r23 is set by ld.so to a pointer to a function which might be </span>
<span class="cm">   registered using atexit.  This provides a means for the dynamic</span>
<span class="cm">   linker to call DT_FINI functions for shared libraries that have</span>
<span class="cm">   been loaded before the code runs.</span>

<span class="cm">   So that we can use the same startup file with static executables,</span>
<span class="cm">   we start programs with a value of 0 to indicate that there is no</span>
<span class="cm">   such function.  */</span>
<span class="cp">#define ELF_PLAT_INIT(_r, load_addr)       _r-&gt;gr[23] = 0</span>

<span class="cp">#define ELF_EXEC_PAGESIZE	4096</span>

<span class="cm">/* This is the location that an ET_DYN program is loaded if exec&#39;ed.  Typical</span>
<span class="cm">   use of this is to invoke &quot;./ld.so someprog&quot; to test out a new version of</span>
<span class="cm">   the loader.  We need to make sure that it is out of the way of the program</span>
<span class="cm">   that it will &quot;exec&quot;, and that there is sufficient room for the brk.</span>

<span class="cm">   (2 * TASK_SIZE / 3) turns into something undefined when run through a</span>
<span class="cm">   32 bit preprocessor and in some cases results in the kernel trying to map</span>
<span class="cm">   ld.so to the kernel virtual base. Use a sane value instead. /Jes </span>
<span class="cm">  */</span>

<span class="cp">#define ELF_ET_DYN_BASE         (TASK_UNMAPPED_BASE + 0x01000000)</span>

<span class="cm">/* This yields a mask that user programs can use to figure out what</span>
<span class="cm">   instruction set this CPU supports.  This could be done in user space,</span>
<span class="cm">   but it&#39;s not easy, and we&#39;ve already done it here.  */</span>

<span class="cp">#define ELF_HWCAP	0</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
