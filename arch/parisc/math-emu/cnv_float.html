<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › parisc › math-emu › cnv_float.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>cnv_float.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Linux/PA-RISC Project (http://www.parisc-linux.org/)</span>
<span class="cm"> *</span>
<span class="cm"> * Floating-point emulation code</span>
<span class="cm"> *  Copyright (C) 2001 Hewlett-Packard (Paul Bame) &lt;bame@debian.org&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *    This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *    it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *    the Free Software Foundation; either version 2, or (at your option)</span>
<span class="cm"> *    any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *    This program is distributed in the hope that it will be useful,</span>
<span class="cm"> *    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *    GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *    You should have received a copy of the GNU General Public License</span>
<span class="cm"> *    along with this program; if not, write to the Free Software</span>
<span class="cm"> *    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="cm"> */</span>

<span class="cp">#ifdef __NO_PA_HDRS</span>
    <span class="n">PA</span> <span class="n">header</span> <span class="n">file</span> <span class="o">--</span> <span class="k">do</span> <span class="n">not</span> <span class="n">include</span> <span class="n">this</span> <span class="n">header</span> <span class="n">file</span> <span class="k">for</span> <span class="n">non</span><span class="o">-</span><span class="n">PA</span> <span class="n">builds</span><span class="p">.</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * Some more constants</span>
<span class="cm"> */</span>
<span class="cp">#define SGL_FX_MAX_EXP 30</span>
<span class="cp">#define DBL_FX_MAX_EXP 62</span>
<span class="cp">#define QUAD_FX_MAX_EXP 126</span>

<span class="cp">#define Dintp1(object) (object)</span>
<span class="cp">#define Dintp2(object) (object)</span>

<span class="cp">#define Duintp1(object) (object)</span>
<span class="cp">#define Duintp2(object) (object)</span>

<span class="cp">#define Qintp0(object) (object)</span>
<span class="cp">#define Qintp1(object) (object)</span>
<span class="cp">#define Qintp2(object) (object)</span>
<span class="cp">#define Qintp3(object) (object)</span>


<span class="cm">/*</span>
<span class="cm"> * These macros will be used specifically by the convert instructions.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * Single format macros</span>
<span class="cm"> */</span>

<span class="cp">#define Sgl_to_dbl_exponent(src_exponent,dest)			\</span>
<span class="cp">    Deposit_dexponent(dest,src_exponent+(DBL_BIAS-SGL_BIAS))</span>

<span class="cp">#define Sgl_to_dbl_mantissa(src_mantissa,destA,destB)	\</span>
<span class="cp">    Deposit_dmantissap1(destA,src_mantissa&gt;&gt;3);		\</span>
<span class="cp">    Dmantissap2(destB) = src_mantissa &lt;&lt; 29</span>

<span class="cp">#define Sgl_isinexact_to_fix(sgl_value,exponent)	\</span>
<span class="cp">    ((exponent &lt; (SGL_P - 1)) ?				\</span>
<span class="cp">     (Sall(sgl_value) &lt;&lt; (SGL_EXP_LENGTH + 1 + exponent)) : FALSE)</span>

<span class="cp">#define Int_isinexact_to_sgl(int_value)	(int_value &lt;&lt; 33 - SGL_EXP_LENGTH)</span>

<span class="cp">#define Sgl_roundnearest_from_int(int_value,sgl_value)			\</span>
<span class="cp">    if (int_value &amp; 1&lt;&lt;(SGL_EXP_LENGTH - 2))   </span><span class="cm">/* round bit */</span><span class="cp">		\</span>
<span class="cp">    	if ((int_value &lt;&lt; 34 - SGL_EXP_LENGTH) || Slow(sgl_value))	\</span>
<span class="cp">		Sall(sgl_value)++</span>

<span class="cp">#define Dint_isinexact_to_sgl(dint_valueA,dint_valueB)		\</span>
<span class="cp">    ((Dintp1(dint_valueA) &lt;&lt; 33 - SGL_EXP_LENGTH) || Dintp2(dint_valueB))</span>

<span class="cp">#define Sgl_roundnearest_from_dint(dint_valueA,dint_valueB,sgl_value)	\</span>
<span class="cp">    if (Dintp1(dint_valueA) &amp; 1&lt;&lt;(SGL_EXP_LENGTH - 2)) 			\</span>
<span class="cp">    	if ((Dintp1(dint_valueA) &lt;&lt; 34 - SGL_EXP_LENGTH) ||		\</span>
<span class="cp">    	Dintp2(dint_valueB) || Slow(sgl_value)) Sall(sgl_value)++</span>

<span class="cp">#define Dint_isinexact_to_dbl(dint_value) 	\</span>
<span class="cp">    (Dintp2(dint_value) &lt;&lt; 33 - DBL_EXP_LENGTH)</span>

<span class="cp">#define Dbl_roundnearest_from_dint(dint_opndB,dbl_opndA,dbl_opndB) 	\</span>
<span class="cp">    if (Dintp2(dint_opndB) &amp; 1&lt;&lt;(DBL_EXP_LENGTH - 2))			\</span>
<span class="cp">       if ((Dintp2(dint_opndB) &lt;&lt; 34 - DBL_EXP_LENGTH) || Dlowp2(dbl_opndB))  \</span>
<span class="cp">          if ((++Dallp2(dbl_opndB))==0) Dallp1(dbl_opndA)++</span>

<span class="cp">#define Sgl_isone_roundbit(sgl_value,exponent)			\</span>
<span class="cp">    ((Sall(sgl_value) &lt;&lt; (SGL_EXP_LENGTH + 1 + exponent)) &gt;&gt; 31)</span>

<span class="cp">#define Sgl_isone_stickybit(sgl_value,exponent)		\</span>
<span class="cp">    (exponent &lt; (SGL_P - 2) ?				\</span>
<span class="cp">     Sall(sgl_value) &lt;&lt; (SGL_EXP_LENGTH + 2 + exponent) : FALSE)</span>


<span class="cm">/* </span>
<span class="cm"> * Double format macros</span>
<span class="cm"> */</span>

<span class="cp">#define Dbl_to_sgl_exponent(src_exponent,dest)			\</span>
<span class="cp">    dest = src_exponent + (SGL_BIAS - DBL_BIAS)</span>

<span class="cp">#define Dbl_to_sgl_mantissa(srcA,srcB,dest,inexact,guard,sticky,odd)	\</span>
<span class="cp">    Shiftdouble(Dmantissap1(srcA),Dmantissap2(srcB),29,dest); 	\</span>
<span class="cp">    guard = Dbit3p2(srcB);					\</span>
<span class="cp">    sticky = Dallp2(srcB)&lt;&lt;4;					\</span>
<span class="cp">    inexact = guard | sticky;					\</span>
<span class="cp">    odd = Dbit2p2(srcB)</span>

<span class="cp">#define Dbl_to_sgl_denormalized(srcA,srcB,exp,dest,inexact,guard,sticky,odd,tiny) \</span>
<span class="cp">    Deposit_dexponent(srcA,1);						\</span>
<span class="cp">    tiny = TRUE;							\</span>
<span class="cp">    if (exp &gt;= -2) {							\</span>
<span class="cp">	if (exp == 0) {							\</span>
<span class="cp">	    inexact = Dallp2(srcB) &lt;&lt; 3;				\</span>
<span class="cp">	    guard = inexact &gt;&gt; 31;					\</span>
<span class="cp">	    sticky = inexact &lt;&lt; 1;					\</span>
<span class="cp">	    Shiftdouble(Dmantissap1(srcA),Dmantissap2(srcB),29,dest);	\</span>
<span class="cp">	    odd = dest &lt;&lt; 31;						\</span>
<span class="cp">	    if (inexact) {						\</span>
<span class="cp">		switch(Rounding_mode()) {				\</span>
<span class="cp">		    case ROUNDPLUS:					\</span>
<span class="cp">			if (Dbl_iszero_sign(srcA)) {			\</span>
<span class="cp">			    dest++;					\</span>
<span class="cp">			    if (Sgl_isone_hidden(dest))	\</span>
<span class="cp">				tiny = FALSE;				\</span>
<span class="cp">			    dest--;					\</span>
<span class="cp">			}						\</span>
<span class="cp">			break;						\</span>
<span class="cp">		    case ROUNDMINUS:					\</span>
<span class="cp">			if (Dbl_isone_sign(srcA)) {			\</span>
<span class="cp">			    dest++;					\</span>
<span class="cp">			    if (Sgl_isone_hidden(dest))	\</span>
<span class="cp">				tiny = FALSE;				\</span>
<span class="cp">			    dest--;					\</span>
<span class="cp">			}						\</span>
<span class="cp">			break;						\</span>
<span class="cp">		    case ROUNDNEAREST:					\</span>
<span class="cp">			if (guard &amp;&amp; (sticky || odd)) {			\</span>
<span class="cp">			    dest++;					\</span>
<span class="cp">			    if (Sgl_isone_hidden(dest))	\</span>
<span class="cp">				tiny = FALSE;				\</span>
<span class="cp">			    dest--;					\</span>
<span class="cp">			}						\</span>
<span class="cp">			break;						\</span>
<span class="cp">		}							\</span>
<span class="cp">	    }								\</span>
<span class="cp">		</span><span class="cm">/* shift right by one to get correct result */</span><span class="cp">		\</span>
<span class="cp">		guard = odd;						\</span>
<span class="cp">		sticky = inexact;					\</span>
<span class="cp">		inexact |= guard;					\</span>
<span class="cp">		dest &gt;&gt;= 1;						\</span>
<span class="cp">    		Deposit_dsign(srcA,0);					\</span>
<span class="cp">    	        Shiftdouble(Dallp1(srcA),Dallp2(srcB),30,dest);		\</span>
<span class="cp">	        odd = dest &lt;&lt; 31;					\</span>
<span class="cp">	}								\</span>
<span class="cp">	else {								\</span>
<span class="cp">    	    inexact = Dallp2(srcB) &lt;&lt; (2 + exp);			\</span>
<span class="cp">    	    guard = inexact &gt;&gt; 31;					\</span>
<span class="cp">    	    sticky = inexact &lt;&lt; 1; 					\</span>
<span class="cp">    	    Deposit_dsign(srcA,0);					\</span>
<span class="cp">    	    if (exp == -2) dest = Dallp1(srcA);				\</span>
<span class="cp">    	    else Variable_shift_double(Dallp1(srcA),Dallp2(srcB),30-exp,dest); \</span>
<span class="cp">    	    odd = dest &lt;&lt; 31;						\</span>
<span class="cp">	}								\</span>
<span class="cp">    }									\</span>
<span class="cp">    else {								\</span>
<span class="cp">    	Deposit_dsign(srcA,0);						\</span>
<span class="cp">    	if (exp &gt; (1 - SGL_P)) {					\</span>
<span class="cp">    	    dest = Dallp1(srcA) &gt;&gt; (- 2 - exp);				\</span>
<span class="cp">    	    inexact = Dallp1(srcA) &lt;&lt; (34 + exp);			\</span>
<span class="cp">    	    guard = inexact &gt;&gt; 31;					\</span>
<span class="cp">    	    sticky = (inexact &lt;&lt; 1) | Dallp2(srcB);			\</span>
<span class="cp">    	    inexact |= Dallp2(srcB); 					\</span>
<span class="cp">    	    odd = dest &lt;&lt; 31;						\</span>
<span class="cp">    	}								\</span>
<span class="cp">    	else {								\</span>
<span class="cp">    	    dest = 0;							\</span>
<span class="cp">    	    inexact = Dallp1(srcA) | Dallp2(srcB);			\</span>
<span class="cp">    	    if (exp == (1 - SGL_P)) {					\</span>
<span class="cp">    	    	guard = Dhidden(srcA);					\</span>
<span class="cp">    	    	sticky = Dmantissap1(srcA) | Dallp2(srcB); 		\</span>
<span class="cp">    	    }								\</span>
<span class="cp">    	    else {							\</span>
<span class="cp">    	    	guard = 0;						\</span>
<span class="cp">    	    	sticky = inexact;					\</span>
<span class="cp">    	    }								\</span>
<span class="cp">    	    odd = 0;							\</span>
<span class="cp">    	}								\</span>
<span class="cp">    }									\</span>
<span class="cp">    exp = 0</span>

<span class="cp">#define Dbl_isinexact_to_fix(dbl_valueA,dbl_valueB,exponent)		\</span>
<span class="cp">    (exponent &lt; (DBL_P-33) ? 						\</span>
<span class="cp">     Dallp2(dbl_valueB) || Dallp1(dbl_valueA) &lt;&lt; (DBL_EXP_LENGTH+1+exponent) : \</span>
<span class="cp">     (exponent &lt; (DBL_P-1) ? Dallp2(dbl_valueB) &lt;&lt; (exponent + (33-DBL_P)) :   \</span>
<span class="cp">      FALSE))</span>

<span class="cp">#define Dbl_isoverflow_to_int(exponent,dbl_valueA,dbl_valueB)		\</span>
<span class="cp">    ((exponent &gt; SGL_FX_MAX_EXP + 1) || Dsign(dbl_valueA)==0 ||		\</span>
<span class="cp">     Dmantissap1(dbl_valueA)!=0 || (Dallp2(dbl_valueB)&gt;&gt;21)!=0 ) </span>

<span class="cp">#define Dbl_isone_roundbit(dbl_valueA,dbl_valueB,exponent)              \</span>
<span class="cp">    ((exponent &lt; (DBL_P - 33) ?						\</span>
<span class="cp">      Dallp1(dbl_valueA) &gt;&gt; ((30 - DBL_EXP_LENGTH) - exponent) :	\</span>
<span class="cp">      Dallp2(dbl_valueB) &gt;&gt; ((DBL_P - 2) - exponent)) &amp; 1)</span>

<span class="cp">#define Dbl_isone_stickybit(dbl_valueA,dbl_valueB,exponent)		\</span>
<span class="cp">    (exponent &lt; (DBL_P-34) ? 						\</span>
<span class="cp">     (Dallp2(dbl_valueB) || Dallp1(dbl_valueA)&lt;&lt;(DBL_EXP_LENGTH+2+exponent)) : \</span>
<span class="cp">     (exponent&lt;(DBL_P-2) ? (Dallp2(dbl_valueB) &lt;&lt; (exponent + (34-DBL_P))) : \</span>
<span class="cp">      FALSE))</span>


<span class="cm">/* Int macros */</span>

<span class="cp">#define Int_from_sgl_mantissa(sgl_value,exponent)	\</span>
<span class="cp">    Sall(sgl_value) = 				\</span>
<span class="cp">    	(unsigned)(Sall(sgl_value) &lt;&lt; SGL_EXP_LENGTH)&gt;&gt;(31 - exponent)</span>

<span class="cp">#define Int_from_dbl_mantissa(dbl_valueA,dbl_valueB,exponent)	\</span>
<span class="cp">    Shiftdouble(Dallp1(dbl_valueA),Dallp2(dbl_valueB),22,Dallp1(dbl_valueA)); \</span>
<span class="cp">    if (exponent &lt; 31) Dallp1(dbl_valueA) &gt;&gt;= 30 - exponent;	\</span>
<span class="cp">    else Dallp1(dbl_valueA) &lt;&lt;= 1</span>

<span class="cp">#define Int_negate(int_value) int_value = -int_value</span>


<span class="cm">/* Dint macros */</span>

<span class="cp">#define Dint_from_sgl_mantissa(sgl_value,exponent,dresultA,dresultB)	\</span>
<span class="cp">    {Sall(sgl_value) &lt;&lt;= SGL_EXP_LENGTH;  </span><span class="cm">/*  left-justify  */</span><span class="cp">		\</span>
<span class="cp">    if (exponent &lt;= 31) {						\</span>
<span class="cp">    	Dintp1(dresultA) = 0;						\</span>
<span class="cp">    	Dintp2(dresultB) = (unsigned)Sall(sgl_value) &gt;&gt; (31 - exponent); \</span>
<span class="cp">    }									\</span>
<span class="cp">    else {								\</span>
<span class="cp">    	Dintp1(dresultA) = Sall(sgl_value) &gt;&gt; (63 - exponent);		\</span>
<span class="cp">    	Dintp2(dresultB) = Sall(sgl_value) &lt;&lt; (exponent - 31);		\</span>
<span class="cp">    }}</span>


<span class="cp">#define Dint_from_dbl_mantissa(dbl_valueA,dbl_valueB,exponent,destA,destB) \</span>
<span class="cp">    {if (exponent &lt; 32) {						\</span>
<span class="cp">    	Dintp1(destA) = 0;						\</span>
<span class="cp">    	if (exponent &lt;= 20)						\</span>
<span class="cp">    	    Dintp2(destB) = Dallp1(dbl_valueA) &gt;&gt; 20-exponent;		\</span>
<span class="cp">    	else Variable_shift_double(Dallp1(dbl_valueA),Dallp2(dbl_valueB), \</span>
<span class="cp">	     52-exponent,Dintp2(destB));					\</span>
<span class="cp">    }									\</span>
<span class="cp">    else {								\</span>
<span class="cp">    	if (exponent &lt;= 52) {						\</span>
<span class="cp">    	    Dintp1(destA) = Dallp1(dbl_valueA) &gt;&gt; 52-exponent;		\</span>
<span class="cp">	    if (exponent == 52) Dintp2(destB) = Dallp2(dbl_valueB);	\</span>
<span class="cp">	    else Variable_shift_double(Dallp1(dbl_valueA),Dallp2(dbl_valueB), \</span>
<span class="cp">	    52-exponent,Dintp2(destB));					\</span>
<span class="cp">        }								\</span>
<span class="cp">    	else {								\</span>
<span class="cp">    	    Variable_shift_double(Dallp1(dbl_valueA),Dallp2(dbl_valueB), \</span>
<span class="cp">	    84-exponent,Dintp1(destA));					\</span>
<span class="cp">    	    Dintp2(destB) = Dallp2(dbl_valueB) &lt;&lt; exponent-52;		\</span>
<span class="cp">    	}								\</span>
<span class="cp">    }}</span>

<span class="cp">#define Dint_setzero(dresultA,dresultB) 	\</span>
<span class="cp">    Dintp1(dresultA) = 0; 	\</span>
<span class="cp">    Dintp2(dresultB) = 0</span>

<span class="cp">#define Dint_setone_sign(dresultA,dresultB)		\</span>
<span class="cp">    Dintp1(dresultA) = ~Dintp1(dresultA);		\</span>
<span class="cp">    if ((Dintp2(dresultB) = -Dintp2(dresultB)) == 0) Dintp1(dresultA)++</span>

<span class="cp">#define Dint_set_minint(dresultA,dresultB)		\</span>
<span class="cp">    Dintp1(dresultA) = (unsigned int)1&lt;&lt;31;		\</span>
<span class="cp">    Dintp2(dresultB) = 0</span>

<span class="cp">#define Dint_isone_lowp2(dresultB)  (Dintp2(dresultB) &amp; 01)</span>

<span class="cp">#define Dint_increment(dresultA,dresultB) 		\</span>
<span class="cp">    if ((++Dintp2(dresultB))==0) Dintp1(dresultA)++</span>

<span class="cp">#define Dint_decrement(dresultA,dresultB) 		\</span>
<span class="cp">    if ((Dintp2(dresultB)--)==0) Dintp1(dresultA)--</span>

<span class="cp">#define Dint_negate(dresultA,dresultB)			\</span>
<span class="cp">    Dintp1(dresultA) = ~Dintp1(dresultA);		\</span>
<span class="cp">    if ((Dintp2(dresultB) = -Dintp2(dresultB))==0) Dintp1(dresultA)++</span>

<span class="cp">#define Dint_copyfromptr(src,destA,destB) \</span>
<span class="cp">     Dintp1(destA) = src-&gt;wd0;		\</span>
<span class="cp">     Dintp2(destB) = src-&gt;wd1</span>
<span class="cp">#define Dint_copytoptr(srcA,srcB,dest)	\</span>
<span class="cp">    dest-&gt;wd0 = Dintp1(srcA);		\</span>
<span class="cp">    dest-&gt;wd1 = Dintp2(srcB)</span>


<span class="cm">/* other macros  */</span>

<span class="cp">#define Find_ms_one_bit(value, position)	\</span>
<span class="cp">    {						\</span>
<span class="cp">	int var;				\</span>
<span class="cp">	for (var=8; var &gt;=1; var &gt;&gt;= 1) {	\</span>
<span class="cp">	    if (value &gt;&gt; 32 - position)		\</span>
<span class="cp">		position -= var;		\</span>
<span class="cp">		else position += var;		\</span>
<span class="cp">	}					\</span>
<span class="cp">	if ((value &gt;&gt; 32 - position) == 0)	\</span>
<span class="cp">	    position--;				\</span>
<span class="cp">	else position -= 2;			\</span>
<span class="cp">    }</span>


<span class="cm">/*</span>
<span class="cm"> * Unsigned int macros</span>
<span class="cm"> */</span>
<span class="cp">#define Duint_copyfromptr(src,destA,destB) \</span>
<span class="cp">    Dint_copyfromptr(src,destA,destB)</span>
<span class="cp">#define Duint_copytoptr(srcA,srcB,dest)	\</span>
<span class="cp">    Dint_copytoptr(srcA,srcB,dest)</span>

<span class="cp">#define Suint_isinexact_to_sgl(int_value) \</span>
<span class="cp">    (int_value &lt;&lt; 32 - SGL_EXP_LENGTH)</span>

<span class="cp">#define Sgl_roundnearest_from_suint(suint_value,sgl_value)		\</span>
<span class="cp">    if (suint_value &amp; 1&lt;&lt;(SGL_EXP_LENGTH - 1))   </span><span class="cm">/* round bit */</span><span class="cp">	\</span>
<span class="cp">    	if ((suint_value &lt;&lt; 33 - SGL_EXP_LENGTH) || Slow(sgl_value))	\</span>
<span class="cp">		Sall(sgl_value)++</span>

<span class="cp">#define Duint_isinexact_to_sgl(duint_valueA,duint_valueB)	\</span>
<span class="cp">    ((Duintp1(duint_valueA) &lt;&lt; 32 - SGL_EXP_LENGTH) || Duintp2(duint_valueB))</span>

<span class="cp">#define Sgl_roundnearest_from_duint(duint_valueA,duint_valueB,sgl_value) \</span>
<span class="cp">    if (Duintp1(duint_valueA) &amp; 1&lt;&lt;(SGL_EXP_LENGTH - 1))		\</span>
<span class="cp">    	if ((Duintp1(duint_valueA) &lt;&lt; 33 - SGL_EXP_LENGTH) ||		\</span>
<span class="cp">    	Duintp2(duint_valueB) || Slow(sgl_value)) Sall(sgl_value)++</span>

<span class="cp">#define Duint_isinexact_to_dbl(duint_value) 	\</span>
<span class="cp">    (Duintp2(duint_value) &lt;&lt; 32 - DBL_EXP_LENGTH)</span>

<span class="cp">#define Dbl_roundnearest_from_duint(duint_opndB,dbl_opndA,dbl_opndB) 	\</span>
<span class="cp">    if (Duintp2(duint_opndB) &amp; 1&lt;&lt;(DBL_EXP_LENGTH - 1))			\</span>
<span class="cp">       if ((Duintp2(duint_opndB) &lt;&lt; 33 - DBL_EXP_LENGTH) || Dlowp2(dbl_opndB)) \</span>
<span class="cp">          if ((++Dallp2(dbl_opndB))==0) Dallp1(dbl_opndA)++</span>

<span class="cp">#define Suint_from_sgl_mantissa(src,exponent,result)	\</span>
<span class="cp">    Sall(result) = (unsigned)(Sall(src) &lt;&lt; SGL_EXP_LENGTH)&gt;&gt;(31 - exponent)</span>

<span class="cp">#define Sgl_isinexact_to_unsigned(sgl_value,exponent)	\</span>
<span class="cp">    Sgl_isinexact_to_fix(sgl_value,exponent)</span>

<span class="cp">#define Duint_from_sgl_mantissa(sgl_value,exponent,dresultA,dresultB)	\</span>
<span class="cp">  {Sall(sgl_value) &lt;&lt;= SGL_EXP_LENGTH;  </span><span class="cm">/*  left-justify  */</span><span class="cp">		\</span>
<span class="cp">    if (exponent &lt;= 31) {						\</span>
<span class="cp">    	Dintp1(dresultA) = 0;						\</span>
<span class="cp">    	Dintp2(dresultB) = (unsigned)Sall(sgl_value) &gt;&gt; (31 - exponent); \</span>
<span class="cp">    }									\</span>
<span class="cp">    else {								\</span>
<span class="cp">    	Dintp1(dresultA) = Sall(sgl_value) &gt;&gt; (63 - exponent);		\</span>
<span class="cp">    	Dintp2(dresultB) = Sall(sgl_value) &lt;&lt; (exponent - 31);		\</span>
<span class="cp">    }									\</span>
<span class="cp">    Sall(sgl_value) &gt;&gt;= SGL_EXP_LENGTH;  </span><span class="cm">/* return to original */</span><span class="cp">	\</span>
<span class="cp">  }</span>

<span class="cp">#define Duint_setzero(dresultA,dresultB) 	\</span>
<span class="cp">    Dint_setzero(dresultA,dresultB)</span>

<span class="cp">#define Duint_increment(dresultA,dresultB) Dint_increment(dresultA,dresultB) </span>

<span class="cp">#define Duint_isone_lowp2(dresultB)  Dint_isone_lowp2(dresultB)</span>

<span class="cp">#define Suint_from_dbl_mantissa(srcA,srcB,exponent,dest) \</span>
<span class="cp">    Shiftdouble(Dallp1(srcA),Dallp2(srcB),21,dest); \</span>
<span class="cp">    dest = (unsigned)dest &gt;&gt; 31 - exponent</span>

<span class="cp">#define Dbl_isinexact_to_unsigned(dbl_valueA,dbl_valueB,exponent) \</span>
<span class="cp">    Dbl_isinexact_to_fix(dbl_valueA,dbl_valueB,exponent)</span>

<span class="cp">#define Duint_from_dbl_mantissa(dbl_valueA,dbl_valueB,exponent,destA,destB) \</span>
<span class="cp">    Dint_from_dbl_mantissa(dbl_valueA,dbl_valueB,exponent,destA,destB) </span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
