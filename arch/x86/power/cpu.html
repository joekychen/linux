<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › x86 › power › cpu.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>cpu.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Suspend support specific for i386/x86-64.</span>
<span class="cm"> *</span>
<span class="cm"> * Distribute under GPLv2</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2007 Rafael J. Wysocki &lt;rjw@sisk.pl&gt;</span>
<span class="cm"> * Copyright (c) 2002 Pavel Machek &lt;pavel@ucw.cz&gt;</span>
<span class="cm"> * Copyright (c) 2001 Patrick Mochel &lt;mochel@osdl.org&gt;</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/suspend.h&gt;</span>
<span class="cp">#include &lt;linux/export.h&gt;</span>
<span class="cp">#include &lt;linux/smp.h&gt;</span>

<span class="cp">#include &lt;asm/pgtable.h&gt;</span>
<span class="cp">#include &lt;asm/proto.h&gt;</span>
<span class="cp">#include &lt;asm/mtrr.h&gt;</span>
<span class="cp">#include &lt;asm/page.h&gt;</span>
<span class="cp">#include &lt;asm/mce.h&gt;</span>
<span class="cp">#include &lt;asm/xcr.h&gt;</span>
<span class="cp">#include &lt;asm/suspend.h&gt;</span>
<span class="cp">#include &lt;asm/debugreg.h&gt;</span>
<span class="cp">#include &lt;asm/fpu-internal.h&gt; </span><span class="cm">/* pcntxt_mask */</span><span class="cp"></span>

<span class="cp">#ifdef CONFIG_X86_32</span>
<span class="k">static</span> <span class="k">struct</span> <span class="n">saved_context</span> <span class="n">saved_context</span><span class="p">;</span>

<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">saved_context_ebx</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">saved_context_esp</span><span class="p">,</span> <span class="n">saved_context_ebp</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">saved_context_esi</span><span class="p">,</span> <span class="n">saved_context_edi</span><span class="p">;</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">saved_context_eflags</span><span class="p">;</span>
<span class="cp">#else</span>
<span class="cm">/* CONFIG_X86_64 */</span>
<span class="k">struct</span> <span class="n">saved_context</span> <span class="n">saved_context</span><span class="p">;</span>
<span class="cp">#endif</span>

<span class="cm">/**</span>
<span class="cm"> *	__save_processor_state - save CPU registers before creating a</span>
<span class="cm"> *		hibernation image and before restoring the memory state from it</span>
<span class="cm"> *	@ctxt - structure to store the registers contents in</span>
<span class="cm"> *</span>
<span class="cm"> *	NOTE: If there is a CPU register the modification of which by the</span>
<span class="cm"> *	boot kernel (ie. the kernel used for loading the hibernation image)</span>
<span class="cm"> *	might affect the operations of the restored target kernel (ie. the one</span>
<span class="cm"> *	saved in the hibernation image), then its contents must be saved by this</span>
<span class="cm"> *	function.  In other words, if kernel A is hibernated and different</span>
<span class="cm"> *	kernel B is used for loading the hibernation image into memory, the</span>
<span class="cm"> *	kernel A&#39;s __save_processor_state() function must save all registers</span>
<span class="cm"> *	needed by kernel A, so that it can operate correctly after the resume</span>
<span class="cm"> *	regardless of what kernel B does in the meantime.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">__save_processor_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">saved_context</span> <span class="o">*</span><span class="n">ctxt</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
	<span class="n">mtrr_save_fixed_ranges</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
<span class="cp">#endif</span>
	<span class="n">kernel_fpu_begin</span><span class="p">();</span>

	<span class="cm">/*</span>
<span class="cm">	 * descriptor tables</span>
<span class="cm">	 */</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
	<span class="n">store_gdt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gdt</span><span class="p">);</span>
	<span class="n">store_idt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">idt</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cm">/* CONFIG_X86_64 */</span>
	<span class="n">store_gdt</span><span class="p">((</span><span class="k">struct</span> <span class="n">desc_ptr</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gdt_limit</span><span class="p">);</span>
	<span class="n">store_idt</span><span class="p">((</span><span class="k">struct</span> <span class="n">desc_ptr</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">idt_limit</span><span class="p">);</span>
<span class="cp">#endif</span>
	<span class="n">store_tr</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">tr</span><span class="p">);</span>

	<span class="cm">/* XMM0..XMM15 should be handled by kernel_fpu_begin(). */</span>
	<span class="cm">/*</span>
<span class="cm">	 * segment registers</span>
<span class="cm">	 */</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
	<span class="n">savesegment</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">es</span><span class="p">);</span>
	<span class="n">savesegment</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">fs</span><span class="p">);</span>
	<span class="n">savesegment</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs</span><span class="p">);</span>
	<span class="n">savesegment</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">ss</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cm">/* CONFIG_X86_64 */</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %%ds, %0&quot;</span> <span class="o">:</span> <span class="s">&quot;=m&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">ds</span><span class="p">));</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %%es, %0&quot;</span> <span class="o">:</span> <span class="s">&quot;=m&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">es</span><span class="p">));</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %%fs, %0&quot;</span> <span class="o">:</span> <span class="s">&quot;=m&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">fs</span><span class="p">));</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %%gs, %0&quot;</span> <span class="o">:</span> <span class="s">&quot;=m&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs</span><span class="p">));</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %%ss, %0&quot;</span> <span class="o">:</span> <span class="s">&quot;=m&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">ss</span><span class="p">));</span>

	<span class="n">rdmsrl</span><span class="p">(</span><span class="n">MSR_FS_BASE</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">fs_base</span><span class="p">);</span>
	<span class="n">rdmsrl</span><span class="p">(</span><span class="n">MSR_GS_BASE</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs_base</span><span class="p">);</span>
	<span class="n">rdmsrl</span><span class="p">(</span><span class="n">MSR_KERNEL_GS_BASE</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs_kernel_base</span><span class="p">);</span>
	<span class="n">mtrr_save_fixed_ranges</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>

	<span class="n">rdmsrl</span><span class="p">(</span><span class="n">MSR_EFER</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">efer</span><span class="p">);</span>
<span class="cp">#endif</span>

	<span class="cm">/*</span>
<span class="cm">	 * control registers</span>
<span class="cm">	 */</span>
	<span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr0</span> <span class="o">=</span> <span class="n">read_cr0</span><span class="p">();</span>
	<span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr2</span> <span class="o">=</span> <span class="n">read_cr2</span><span class="p">();</span>
	<span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr3</span> <span class="o">=</span> <span class="n">read_cr3</span><span class="p">();</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
	<span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr4</span> <span class="o">=</span> <span class="n">read_cr4_safe</span><span class="p">();</span>
<span class="cp">#else</span>
<span class="cm">/* CONFIG_X86_64 */</span>
	<span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr4</span> <span class="o">=</span> <span class="n">read_cr4</span><span class="p">();</span>
	<span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr8</span> <span class="o">=</span> <span class="n">read_cr8</span><span class="p">();</span>
<span class="cp">#endif</span>
	<span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">misc_enable_saved</span> <span class="o">=</span> <span class="o">!</span><span class="n">rdmsrl_safe</span><span class="p">(</span><span class="n">MSR_IA32_MISC_ENABLE</span><span class="p">,</span>
					       <span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">misc_enable</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Needed by apm.c */</span>
<span class="kt">void</span> <span class="nf">save_processor_state</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__save_processor_state</span><span class="p">(</span><span class="o">&amp;</span><span class="n">saved_context</span><span class="p">);</span>
	<span class="n">x86_platform</span><span class="p">.</span><span class="n">save_sched_clock_state</span><span class="p">();</span>
<span class="p">}</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
<span class="n">EXPORT_SYMBOL</span><span class="p">(</span><span class="n">save_processor_state</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">do_fpu_end</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * Restore FPU regs if necessary.</span>
<span class="cm">	 */</span>
	<span class="n">kernel_fpu_end</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">fix_processor_context</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cpu</span> <span class="o">=</span> <span class="n">smp_processor_id</span><span class="p">();</span>
	<span class="k">struct</span> <span class="n">tss_struct</span> <span class="o">*</span><span class="n">t</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">per_cpu</span><span class="p">(</span><span class="n">init_tss</span><span class="p">,</span> <span class="n">cpu</span><span class="p">);</span>

	<span class="n">set_tss_desc</span><span class="p">(</span><span class="n">cpu</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>	<span class="cm">/*</span>
<span class="cm">				 * This just modifies memory; should not be</span>
<span class="cm">				 * necessary. But... This is necessary, because</span>
<span class="cm">				 * 386 hardware has concept of busy TSS or some</span>
<span class="cm">				 * similar stupidity.</span>
<span class="cm">				 */</span>

<span class="cp">#ifdef CONFIG_X86_64</span>
	<span class="n">get_cpu_gdt_table</span><span class="p">(</span><span class="n">cpu</span><span class="p">)[</span><span class="n">GDT_ENTRY_TSS</span><span class="p">].</span><span class="n">type</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>

	<span class="n">syscall_init</span><span class="p">();</span>				<span class="cm">/* This sets MSR_*STAR and related */</span>
<span class="cp">#endif</span>
	<span class="n">load_TR_desc</span><span class="p">();</span>				<span class="cm">/* This does ltr */</span>
	<span class="n">load_LDT</span><span class="p">(</span><span class="o">&amp;</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">active_mm</span><span class="o">-&gt;</span><span class="n">context</span><span class="p">);</span>	<span class="cm">/* This does lldt */</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> *	__restore_processor_state - restore the contents of CPU registers saved</span>
<span class="cm"> *		by __save_processor_state()</span>
<span class="cm"> *	@ctxt - structure to load the registers contents from</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">__restore_processor_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">saved_context</span> <span class="o">*</span><span class="n">ctxt</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">misc_enable_saved</span><span class="p">)</span>
		<span class="n">wrmsrl</span><span class="p">(</span><span class="n">MSR_IA32_MISC_ENABLE</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">misc_enable</span><span class="p">);</span>
	<span class="cm">/*</span>
<span class="cm">	 * control registers</span>
<span class="cm">	 */</span>
	<span class="cm">/* cr4 was introduced in the Pentium CPU */</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr4</span><span class="p">)</span>
		<span class="n">write_cr4</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr4</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cm">/* CONFIG X86_64 */</span>
	<span class="n">wrmsrl</span><span class="p">(</span><span class="n">MSR_EFER</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">efer</span><span class="p">);</span>
	<span class="n">write_cr8</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr8</span><span class="p">);</span>
	<span class="n">write_cr4</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr4</span><span class="p">);</span>
<span class="cp">#endif</span>
	<span class="n">write_cr3</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr3</span><span class="p">);</span>
	<span class="n">write_cr2</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr2</span><span class="p">);</span>
	<span class="n">write_cr0</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">cr0</span><span class="p">);</span>

	<span class="cm">/*</span>
<span class="cm">	 * now restore the descriptor tables to their proper values</span>
<span class="cm">	 * ltr is done i fix_processor_context().</span>
<span class="cm">	 */</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
	<span class="n">load_gdt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gdt</span><span class="p">);</span>
	<span class="n">load_idt</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">idt</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cm">/* CONFIG_X86_64 */</span>
	<span class="n">load_gdt</span><span class="p">((</span><span class="k">const</span> <span class="k">struct</span> <span class="n">desc_ptr</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gdt_limit</span><span class="p">);</span>
	<span class="n">load_idt</span><span class="p">((</span><span class="k">const</span> <span class="k">struct</span> <span class="n">desc_ptr</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">idt_limit</span><span class="p">);</span>
<span class="cp">#endif</span>

	<span class="cm">/*</span>
<span class="cm">	 * segment registers</span>
<span class="cm">	 */</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
	<span class="n">loadsegment</span><span class="p">(</span><span class="n">es</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">es</span><span class="p">);</span>
	<span class="n">loadsegment</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">fs</span><span class="p">);</span>
	<span class="n">loadsegment</span><span class="p">(</span><span class="n">gs</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs</span><span class="p">);</span>
	<span class="n">loadsegment</span><span class="p">(</span><span class="n">ss</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">ss</span><span class="p">);</span>

	<span class="cm">/*</span>
<span class="cm">	 * sysenter MSRs</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">boot_cpu_has</span><span class="p">(</span><span class="n">X86_FEATURE_SEP</span><span class="p">))</span>
		<span class="n">enable_sep_cpu</span><span class="p">();</span>
<span class="cp">#else</span>
<span class="cm">/* CONFIG_X86_64 */</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %0, %%ds&quot;</span> <span class="o">::</span> <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">ds</span><span class="p">));</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %0, %%es&quot;</span> <span class="o">::</span> <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">es</span><span class="p">));</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %0, %%fs&quot;</span> <span class="o">::</span> <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">fs</span><span class="p">));</span>
	<span class="n">load_gs_index</span><span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs</span><span class="p">);</span>
	<span class="n">asm</span> <span class="k">volatile</span> <span class="p">(</span><span class="s">&quot;movw %0, %%ss&quot;</span> <span class="o">::</span> <span class="s">&quot;r&quot;</span> <span class="p">(</span><span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">ss</span><span class="p">));</span>

	<span class="n">wrmsrl</span><span class="p">(</span><span class="n">MSR_FS_BASE</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">fs_base</span><span class="p">);</span>
	<span class="n">wrmsrl</span><span class="p">(</span><span class="n">MSR_GS_BASE</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs_base</span><span class="p">);</span>
	<span class="n">wrmsrl</span><span class="p">(</span><span class="n">MSR_KERNEL_GS_BASE</span><span class="p">,</span> <span class="n">ctxt</span><span class="o">-&gt;</span><span class="n">gs_kernel_base</span><span class="p">);</span>
<span class="cp">#endif</span>

	<span class="cm">/*</span>
<span class="cm">	 * restore XCR0 for xsave capable cpu&#39;s.</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cpu_has_xsave</span><span class="p">)</span>
		<span class="n">xsetbv</span><span class="p">(</span><span class="n">XCR_XFEATURE_ENABLED_MASK</span><span class="p">,</span> <span class="n">pcntxt_mask</span><span class="p">);</span>

	<span class="n">fix_processor_context</span><span class="p">();</span>

	<span class="n">do_fpu_end</span><span class="p">();</span>
	<span class="n">x86_platform</span><span class="p">.</span><span class="n">restore_sched_clock_state</span><span class="p">();</span>
	<span class="n">mtrr_bp_restore</span><span class="p">();</span>
<span class="p">}</span>

<span class="cm">/* Needed by apm.c */</span>
<span class="kt">void</span> <span class="nf">restore_processor_state</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__restore_processor_state</span><span class="p">(</span><span class="o">&amp;</span><span class="n">saved_context</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">#ifdef CONFIG_X86_32</span>
<span class="n">EXPORT_SYMBOL</span><span class="p">(</span><span class="n">restore_processor_state</span><span class="p">);</span>
<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
