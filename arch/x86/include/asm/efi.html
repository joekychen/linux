<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › x86 › include › asm › efi.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>efi.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _ASM_X86_EFI_H</span>
<span class="cp">#define _ASM_X86_EFI_H</span>

<span class="cp">#ifdef CONFIG_X86_32</span>

<span class="cp">#define EFI_LOADER_SIGNATURE	&quot;EL32&quot;</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">asmlinkage</span> <span class="n">efi_call_phys</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="p">...);</span>

<span class="cp">#define efi_call_phys0(f)		efi_call_phys(f)</span>
<span class="cp">#define efi_call_phys1(f, a1)		efi_call_phys(f, a1)</span>
<span class="cp">#define efi_call_phys2(f, a1, a2)	efi_call_phys(f, a1, a2)</span>
<span class="cp">#define efi_call_phys3(f, a1, a2, a3)	efi_call_phys(f, a1, a2, a3)</span>
<span class="cp">#define efi_call_phys4(f, a1, a2, a3, a4)	\</span>
<span class="cp">	efi_call_phys(f, a1, a2, a3, a4)</span>
<span class="cp">#define efi_call_phys5(f, a1, a2, a3, a4, a5)	\</span>
<span class="cp">	efi_call_phys(f, a1, a2, a3, a4, a5)</span>
<span class="cp">#define efi_call_phys6(f, a1, a2, a3, a4, a5, a6)	\</span>
<span class="cp">	efi_call_phys(f, a1, a2, a3, a4, a5, a6)</span>
<span class="cm">/*</span>
<span class="cm"> * Wrap all the virtual calls in a way that forces the parameters on the stack.</span>
<span class="cm"> */</span>

<span class="cp">#define efi_call_virt(f, args...) \</span>
<span class="cp">	((efi_##f##_t __attribute__((regparm(0)))*)efi.systab-&gt;runtime-&gt;f)(args)</span>

<span class="cp">#define efi_call_virt0(f)		efi_call_virt(f)</span>
<span class="cp">#define efi_call_virt1(f, a1)		efi_call_virt(f, a1)</span>
<span class="cp">#define efi_call_virt2(f, a1, a2)	efi_call_virt(f, a1, a2)</span>
<span class="cp">#define efi_call_virt3(f, a1, a2, a3)	efi_call_virt(f, a1, a2, a3)</span>
<span class="cp">#define efi_call_virt4(f, a1, a2, a3, a4)	\</span>
<span class="cp">	efi_call_virt(f, a1, a2, a3, a4)</span>
<span class="cp">#define efi_call_virt5(f, a1, a2, a3, a4, a5)	\</span>
<span class="cp">	efi_call_virt(f, a1, a2, a3, a4, a5)</span>
<span class="cp">#define efi_call_virt6(f, a1, a2, a3, a4, a5, a6)	\</span>
<span class="cp">	efi_call_virt(f, a1, a2, a3, a4, a5, a6)</span>

<span class="cp">#define efi_ioremap(addr, size, type)		ioremap_cache(addr, size)</span>

<span class="cp">#else </span><span class="cm">/* !CONFIG_X86_32 */</span><span class="cp"></span>

<span class="cp">#define EFI_LOADER_SIGNATURE	&quot;EL64&quot;</span>

<span class="k">extern</span> <span class="n">u64</span> <span class="n">efi_call0</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">fp</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">efi_call1</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg1</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">efi_call2</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg2</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">efi_call3</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg3</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">efi_call4</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg3</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg4</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">efi_call5</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg3</span><span class="p">,</span>
		     <span class="n">u64</span> <span class="n">arg4</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg5</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">efi_call6</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">fp</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg1</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg3</span><span class="p">,</span>
		     <span class="n">u64</span> <span class="n">arg4</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg5</span><span class="p">,</span> <span class="n">u64</span> <span class="n">arg6</span><span class="p">);</span>

<span class="cp">#define efi_call_phys0(f)			\</span>
<span class="cp">	efi_call0((void *)(f))</span>
<span class="cp">#define efi_call_phys1(f, a1)			\</span>
<span class="cp">	efi_call1((void *)(f), (u64)(a1))</span>
<span class="cp">#define efi_call_phys2(f, a1, a2)			\</span>
<span class="cp">	efi_call2((void *)(f), (u64)(a1), (u64)(a2))</span>
<span class="cp">#define efi_call_phys3(f, a1, a2, a3)				\</span>
<span class="cp">	efi_call3((void *)(f), (u64)(a1), (u64)(a2), (u64)(a3))</span>
<span class="cp">#define efi_call_phys4(f, a1, a2, a3, a4)				\</span>
<span class="cp">	efi_call4((void *)(f), (u64)(a1), (u64)(a2), (u64)(a3),		\</span>
<span class="cp">		  (u64)(a4))</span>
<span class="cp">#define efi_call_phys5(f, a1, a2, a3, a4, a5)				\</span>
<span class="cp">	efi_call5((void *)(f), (u64)(a1), (u64)(a2), (u64)(a3),		\</span>
<span class="cp">		  (u64)(a4), (u64)(a5))</span>
<span class="cp">#define efi_call_phys6(f, a1, a2, a3, a4, a5, a6)			\</span>
<span class="cp">	efi_call6((void *)(f), (u64)(a1), (u64)(a2), (u64)(a3),		\</span>
<span class="cp">		  (u64)(a4), (u64)(a5), (u64)(a6))</span>

<span class="cp">#define efi_call_virt0(f)				\</span>
<span class="cp">	efi_call0((void *)(efi.systab-&gt;runtime-&gt;f))</span>
<span class="cp">#define efi_call_virt1(f, a1)					\</span>
<span class="cp">	efi_call1((void *)(efi.systab-&gt;runtime-&gt;f), (u64)(a1))</span>
<span class="cp">#define efi_call_virt2(f, a1, a2)					\</span>
<span class="cp">	efi_call2((void *)(efi.systab-&gt;runtime-&gt;f), (u64)(a1), (u64)(a2))</span>
<span class="cp">#define efi_call_virt3(f, a1, a2, a3)					\</span>
<span class="cp">	efi_call3((void *)(efi.systab-&gt;runtime-&gt;f), (u64)(a1), (u64)(a2), \</span>
<span class="cp">		  (u64)(a3))</span>
<span class="cp">#define efi_call_virt4(f, a1, a2, a3, a4)				\</span>
<span class="cp">	efi_call4((void *)(efi.systab-&gt;runtime-&gt;f), (u64)(a1), (u64)(a2), \</span>
<span class="cp">		  (u64)(a3), (u64)(a4))</span>
<span class="cp">#define efi_call_virt5(f, a1, a2, a3, a4, a5)				\</span>
<span class="cp">	efi_call5((void *)(efi.systab-&gt;runtime-&gt;f), (u64)(a1), (u64)(a2), \</span>
<span class="cp">		  (u64)(a3), (u64)(a4), (u64)(a5))</span>
<span class="cp">#define efi_call_virt6(f, a1, a2, a3, a4, a5, a6)			\</span>
<span class="cp">	efi_call6((void *)(efi.systab-&gt;runtime-&gt;f), (u64)(a1), (u64)(a2), \</span>
<span class="cp">		  (u64)(a3), (u64)(a4), (u64)(a5), (u64)(a6))</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">efi_ioremap</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">size</span><span class="p">,</span>
				 <span class="n">u32</span> <span class="n">type</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_X86_32 */</span><span class="cp"></span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">add_efi_memmap</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">efi_set_executable</span><span class="p">(</span><span class="n">efi_memory_desc_t</span> <span class="o">*</span><span class="n">md</span><span class="p">,</span> <span class="n">bool</span> <span class="n">executable</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">efi_memblock_x86_reserve_range</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">efi_call_phys_prelog</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">efi_call_phys_epilog</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#ifndef CONFIG_EFI</span>
<span class="cm">/*</span>
<span class="cm"> * IF EFI is not configured, have the EFI calls return -ENOSYS.</span>
<span class="cm"> */</span>
<span class="cp">#define efi_call0(_f)					(-ENOSYS)</span>
<span class="cp">#define efi_call1(_f, _a1)				(-ENOSYS)</span>
<span class="cp">#define efi_call2(_f, _a1, _a2)				(-ENOSYS)</span>
<span class="cp">#define efi_call3(_f, _a1, _a2, _a3)			(-ENOSYS)</span>
<span class="cp">#define efi_call4(_f, _a1, _a2, _a3, _a4)		(-ENOSYS)</span>
<span class="cp">#define efi_call5(_f, _a1, _a2, _a3, _a4, _a5)		(-ENOSYS)</span>
<span class="cp">#define efi_call6(_f, _a1, _a2, _a3, _a4, _a5, _a6)	(-ENOSYS)</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_EFI */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _ASM_X86_EFI_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
