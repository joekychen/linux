<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › x86 › include › asm › setup.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>setup.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _ASM_X86_SETUP_H</span>
<span class="cp">#define _ASM_X86_SETUP_H</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#define COMMAND_LINE_SIZE 2048</span>

<span class="cp">#ifdef __i386__</span>

<span class="cp">#include &lt;linux/pfn.h&gt;</span>
<span class="cm">/*</span>
<span class="cm"> * Reserved space for vmalloc and iomap - defined in asm/page.h</span>
<span class="cm"> */</span>
<span class="cp">#define MAXMEM_PFN	PFN_DOWN(MAXMEM)</span>
<span class="cp">#define MAX_NONPAE_PFN	(1 &lt;&lt; 20)</span>

<span class="cp">#endif </span><span class="cm">/* __i386__ */</span><span class="cp"></span>

<span class="cp">#define PARAM_SIZE 4096		</span><span class="cm">/* sizeof(struct boot_params) */</span><span class="cp"></span>

<span class="cp">#define OLD_CL_MAGIC		0xA33F</span>
<span class="cp">#define OLD_CL_ADDRESS		0x020	</span><span class="cm">/* Relative to real mode data */</span><span class="cp"></span>
<span class="cp">#define NEW_CL_POINTER		0x228	</span><span class="cm">/* Relative to real mode data */</span><span class="cp"></span>

<span class="cp">#ifndef __ASSEMBLY__</span>
<span class="cp">#include &lt;asm/bootparam.h&gt;</span>
<span class="cp">#include &lt;asm/x86_init.h&gt;</span>

<span class="cm">/* Interrupt control for vSMPowered x86_64 systems */</span>
<span class="cp">#ifdef CONFIG_X86_64</span>
<span class="kt">void</span> <span class="n">vsmp_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">vsmp_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="cp">#endif</span>

<span class="kt">void</span> <span class="n">setup_bios_corruption_check</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#ifdef CONFIG_X86_VISWS</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">visws_early_detect</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">visws_early_detect</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="cp">#endif</span>

<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">saved_video_mode</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">reserve_standard_io_resources</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">i386_reserve_resources</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">setup_default_timer_irq</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#ifdef CONFIG_X86_INTEL_MID</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">x86_mrst_early_setup</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">x86_mrst_early_setup</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_X86_INTEL_CE</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">x86_ce4100_early_setup</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">x86_ce4100_early_setup</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef _SETUP</span>

<span class="cm">/*</span>
<span class="cm"> * This is set up by the setup-routine at boot-time</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">boot_params</span> <span class="n">boot_params</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Do NOT EVER look at the BIOS memory size location.</span>
<span class="cm"> * It does not work on many machines.</span>
<span class="cm"> */</span>
<span class="cp">#define LOWMEMSIZE()	(0x9f000)</span>

<span class="cm">/* exceedingly early brk-like allocator */</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">_brk_end</span><span class="p">;</span>
<span class="kt">void</span> <span class="o">*</span><span class="n">extend_brk</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">align</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Reserve space in the brk section.  The name must be unique within</span>
<span class="cm"> * the file, and somewhat descriptive.  The size is in bytes.  Must be</span>
<span class="cm"> * used at file scope.</span>
<span class="cm"> *</span>
<span class="cm"> * (This uses a temp function to wrap the asm so we can pass it the</span>
<span class="cm"> * size parameter; otherwise we wouldn&#39;t be able to.  We can&#39;t use a</span>
<span class="cm"> * &quot;section&quot; attribute on a normal variable because it always ends up</span>
<span class="cm"> * being @progbits, which ends up allocating space in the vmlinux</span>
<span class="cm"> * executable.)</span>
<span class="cm"> */</span>
<span class="cp">#define RESERVE_BRK(name,sz)						\</span>
<span class="cp">	static void __section(.discard.text) __used notrace		\</span>
<span class="cp">	__brk_reservation_fn_##name##__(void) {				\</span>
<span class="cp">		asm volatile (						\</span>
<span class="cp">			&quot;.pushsection .brk_reservation,\&quot;aw\&quot;,@nobits;&quot; \</span>
<span class="cp">			&quot;.brk.&quot; #name &quot;:&quot;				\</span>
<span class="cp">			&quot; 1:.skip %c0;&quot;					\</span>
<span class="cp">			&quot; .size .brk.&quot; #name &quot;, . - 1b;&quot;		\</span>
<span class="cp">			&quot; .popsection&quot;					\</span>
<span class="cp">			: : &quot;i&quot; (sz));					\</span>
<span class="cp">	}</span>

<span class="cm">/* Helper for reserving space for arrays of things */</span>
<span class="cp">#define RESERVE_BRK_ARRAY(type, name, entries)		\</span>
<span class="cp">	type *name;					\</span>
<span class="cp">	RESERVE_BRK(name, sizeof(type) * entries)</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">probe_roms</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#ifdef __i386__</span>

<span class="kt">void</span> <span class="n">__init</span> <span class="n">i386_start_kernel</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cp">#else</span>
<span class="kt">void</span> <span class="n">__init</span> <span class="n">x86_64_start_kernel</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">real_mode</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">__init</span> <span class="n">x86_64_start_reservations</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">real_mode_data</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __i386__ */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* _SETUP */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp">#define RESERVE_BRK(name,sz)				\</span>
<span class="cp">	.pushsection .brk_reservation,&quot;aw&quot;,@nobits;	\</span>
<span class="cp">.brk.name:						\</span>
<span class="cp">1:	.skip sz;					\</span>
<span class="cp">	.size .brk.name,.-1b;				\</span>
<span class="cp">	.popsection</span>
<span class="cp">#endif </span><span class="cm">/* __ASSEMBLY__ */</span><span class="cp"></span>
<span class="cp">#endif  </span><span class="cm">/*  __KERNEL__  */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _ASM_X86_SETUP_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
