<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › x86 › include › asm › svm.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>svm.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __SVM_H</span>
<span class="cp">#define __SVM_H</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">INTERCEPT_INTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_NMI</span><span class="p">,</span>
	<span class="n">INTERCEPT_SMI</span><span class="p">,</span>
	<span class="n">INTERCEPT_INIT</span><span class="p">,</span>
	<span class="n">INTERCEPT_VINTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_SELECTIVE_CR0</span><span class="p">,</span>
	<span class="n">INTERCEPT_STORE_IDTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_STORE_GDTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_STORE_LDTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_STORE_TR</span><span class="p">,</span>
	<span class="n">INTERCEPT_LOAD_IDTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_LOAD_GDTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_LOAD_LDTR</span><span class="p">,</span>
	<span class="n">INTERCEPT_LOAD_TR</span><span class="p">,</span>
	<span class="n">INTERCEPT_RDTSC</span><span class="p">,</span>
	<span class="n">INTERCEPT_RDPMC</span><span class="p">,</span>
	<span class="n">INTERCEPT_PUSHF</span><span class="p">,</span>
	<span class="n">INTERCEPT_POPF</span><span class="p">,</span>
	<span class="n">INTERCEPT_CPUID</span><span class="p">,</span>
	<span class="n">INTERCEPT_RSM</span><span class="p">,</span>
	<span class="n">INTERCEPT_IRET</span><span class="p">,</span>
	<span class="n">INTERCEPT_INTn</span><span class="p">,</span>
	<span class="n">INTERCEPT_INVD</span><span class="p">,</span>
	<span class="n">INTERCEPT_PAUSE</span><span class="p">,</span>
	<span class="n">INTERCEPT_HLT</span><span class="p">,</span>
	<span class="n">INTERCEPT_INVLPG</span><span class="p">,</span>
	<span class="n">INTERCEPT_INVLPGA</span><span class="p">,</span>
	<span class="n">INTERCEPT_IOIO_PROT</span><span class="p">,</span>
	<span class="n">INTERCEPT_MSR_PROT</span><span class="p">,</span>
	<span class="n">INTERCEPT_TASK_SWITCH</span><span class="p">,</span>
	<span class="n">INTERCEPT_FERR_FREEZE</span><span class="p">,</span>
	<span class="n">INTERCEPT_SHUTDOWN</span><span class="p">,</span>
	<span class="n">INTERCEPT_VMRUN</span><span class="p">,</span>
	<span class="n">INTERCEPT_VMMCALL</span><span class="p">,</span>
	<span class="n">INTERCEPT_VMLOAD</span><span class="p">,</span>
	<span class="n">INTERCEPT_VMSAVE</span><span class="p">,</span>
	<span class="n">INTERCEPT_STGI</span><span class="p">,</span>
	<span class="n">INTERCEPT_CLGI</span><span class="p">,</span>
	<span class="n">INTERCEPT_SKINIT</span><span class="p">,</span>
	<span class="n">INTERCEPT_RDTSCP</span><span class="p">,</span>
	<span class="n">INTERCEPT_ICEBP</span><span class="p">,</span>
	<span class="n">INTERCEPT_WBINVD</span><span class="p">,</span>
	<span class="n">INTERCEPT_MONITOR</span><span class="p">,</span>
	<span class="n">INTERCEPT_MWAIT</span><span class="p">,</span>
	<span class="n">INTERCEPT_MWAIT_COND</span><span class="p">,</span>
	<span class="n">INTERCEPT_XSETBV</span><span class="p">,</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">__packed__</span><span class="p">))</span> <span class="n">vmcb_control_area</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">intercept_cr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intercept_dr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intercept_exceptions</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">intercept</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_1</span><span class="p">[</span><span class="mi">42</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">pause_filter_count</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">iopm_base_pa</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">msrpm_base_pa</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tsc_offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">asid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tlb_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">int_ctl</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">int_vector</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">int_state</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_3</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">exit_code</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">exit_code_hi</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">exit_info_1</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">exit_info_2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">exit_int_info</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">exit_int_info_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">nested_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_4</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">event_inj</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">event_inj_err</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">nested_cr3</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">lbr_ctl</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">clean</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved_5</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">next_rip</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">insn_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">insn_bytes</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">reserved_6</span><span class="p">[</span><span class="mi">800</span><span class="p">];</span>
<span class="p">};</span>


<span class="cp">#define TLB_CONTROL_DO_NOTHING 0</span>
<span class="cp">#define TLB_CONTROL_FLUSH_ALL_ASID 1</span>
<span class="cp">#define TLB_CONTROL_FLUSH_ASID 3</span>
<span class="cp">#define TLB_CONTROL_FLUSH_ASID_LOCAL 7</span>

<span class="cp">#define V_TPR_MASK 0x0f</span>

<span class="cp">#define V_IRQ_SHIFT 8</span>
<span class="cp">#define V_IRQ_MASK (1 &lt;&lt; V_IRQ_SHIFT)</span>

<span class="cp">#define V_INTR_PRIO_SHIFT 16</span>
<span class="cp">#define V_INTR_PRIO_MASK (0x0f &lt;&lt; V_INTR_PRIO_SHIFT)</span>

<span class="cp">#define V_IGN_TPR_SHIFT 20</span>
<span class="cp">#define V_IGN_TPR_MASK (1 &lt;&lt; V_IGN_TPR_SHIFT)</span>

<span class="cp">#define V_INTR_MASKING_SHIFT 24</span>
<span class="cp">#define V_INTR_MASKING_MASK (1 &lt;&lt; V_INTR_MASKING_SHIFT)</span>

<span class="cp">#define SVM_INTERRUPT_SHADOW_MASK 1</span>

<span class="cp">#define SVM_IOIO_STR_SHIFT 2</span>
<span class="cp">#define SVM_IOIO_REP_SHIFT 3</span>
<span class="cp">#define SVM_IOIO_SIZE_SHIFT 4</span>
<span class="cp">#define SVM_IOIO_ASIZE_SHIFT 7</span>

<span class="cp">#define SVM_IOIO_TYPE_MASK 1</span>
<span class="cp">#define SVM_IOIO_STR_MASK (1 &lt;&lt; SVM_IOIO_STR_SHIFT)</span>
<span class="cp">#define SVM_IOIO_REP_MASK (1 &lt;&lt; SVM_IOIO_REP_SHIFT)</span>
<span class="cp">#define SVM_IOIO_SIZE_MASK (7 &lt;&lt; SVM_IOIO_SIZE_SHIFT)</span>
<span class="cp">#define SVM_IOIO_ASIZE_MASK (7 &lt;&lt; SVM_IOIO_ASIZE_SHIFT)</span>

<span class="cp">#define SVM_VM_CR_VALID_MASK	0x001fULL</span>
<span class="cp">#define SVM_VM_CR_SVM_LOCK_MASK 0x0008ULL</span>
<span class="cp">#define SVM_VM_CR_SVM_DIS_MASK  0x0010ULL</span>

<span class="k">struct</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">__packed__</span><span class="p">))</span> <span class="n">vmcb_seg</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">selector</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">attrib</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">limit</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">__packed__</span><span class="p">))</span> <span class="n">vmcb_save_area</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">es</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">cs</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">ss</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">ds</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">fs</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">gs</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">gdtr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">ldtr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">idtr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_seg</span> <span class="n">tr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_1</span><span class="p">[</span><span class="mi">43</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">cpl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_2</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">efer</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_3</span><span class="p">[</span><span class="mi">112</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">cr4</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">cr3</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">cr0</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">dr7</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">dr6</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rflags</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rip</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_4</span><span class="p">[</span><span class="mi">88</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">rsp</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_5</span><span class="p">[</span><span class="mi">24</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">rax</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">star</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">lstar</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">cstar</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">sfmask</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">kernel_gs_base</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">sysenter_cs</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">sysenter_esp</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">sysenter_eip</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">cr2</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved_6</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">g_pat</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">dbgctl</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">br_from</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">br_to</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">last_excp_from</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">last_excp_to</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">__packed__</span><span class="p">))</span> <span class="n">vmcb</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">vmcb_control_area</span> <span class="n">control</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">vmcb_save_area</span> <span class="n">save</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define SVM_CPUID_FEATURE_SHIFT 2</span>
<span class="cp">#define SVM_CPUID_FUNC 0x8000000a</span>

<span class="cp">#define SVM_VM_CR_SVM_DISABLE 4</span>

<span class="cp">#define SVM_SELECTOR_S_SHIFT 4</span>
<span class="cp">#define SVM_SELECTOR_DPL_SHIFT 5</span>
<span class="cp">#define SVM_SELECTOR_P_SHIFT 7</span>
<span class="cp">#define SVM_SELECTOR_AVL_SHIFT 8</span>
<span class="cp">#define SVM_SELECTOR_L_SHIFT 9</span>
<span class="cp">#define SVM_SELECTOR_DB_SHIFT 10</span>
<span class="cp">#define SVM_SELECTOR_G_SHIFT 11</span>

<span class="cp">#define SVM_SELECTOR_TYPE_MASK (0xf)</span>
<span class="cp">#define SVM_SELECTOR_S_MASK (1 &lt;&lt; SVM_SELECTOR_S_SHIFT)</span>
<span class="cp">#define SVM_SELECTOR_DPL_MASK (3 &lt;&lt; SVM_SELECTOR_DPL_SHIFT)</span>
<span class="cp">#define SVM_SELECTOR_P_MASK (1 &lt;&lt; SVM_SELECTOR_P_SHIFT)</span>
<span class="cp">#define SVM_SELECTOR_AVL_MASK (1 &lt;&lt; SVM_SELECTOR_AVL_SHIFT)</span>
<span class="cp">#define SVM_SELECTOR_L_MASK (1 &lt;&lt; SVM_SELECTOR_L_SHIFT)</span>
<span class="cp">#define SVM_SELECTOR_DB_MASK (1 &lt;&lt; SVM_SELECTOR_DB_SHIFT)</span>
<span class="cp">#define SVM_SELECTOR_G_MASK (1 &lt;&lt; SVM_SELECTOR_G_SHIFT)</span>

<span class="cp">#define SVM_SELECTOR_WRITE_MASK (1 &lt;&lt; 1)</span>
<span class="cp">#define SVM_SELECTOR_READ_MASK SVM_SELECTOR_WRITE_MASK</span>
<span class="cp">#define SVM_SELECTOR_CODE_MASK (1 &lt;&lt; 3)</span>

<span class="cp">#define INTERCEPT_CR0_READ	0</span>
<span class="cp">#define INTERCEPT_CR3_READ	3</span>
<span class="cp">#define INTERCEPT_CR4_READ	4</span>
<span class="cp">#define INTERCEPT_CR8_READ	8</span>
<span class="cp">#define INTERCEPT_CR0_WRITE	(16 + 0)</span>
<span class="cp">#define INTERCEPT_CR3_WRITE	(16 + 3)</span>
<span class="cp">#define INTERCEPT_CR4_WRITE	(16 + 4)</span>
<span class="cp">#define INTERCEPT_CR8_WRITE	(16 + 8)</span>

<span class="cp">#define INTERCEPT_DR0_READ	0</span>
<span class="cp">#define INTERCEPT_DR1_READ	1</span>
<span class="cp">#define INTERCEPT_DR2_READ	2</span>
<span class="cp">#define INTERCEPT_DR3_READ	3</span>
<span class="cp">#define INTERCEPT_DR4_READ	4</span>
<span class="cp">#define INTERCEPT_DR5_READ	5</span>
<span class="cp">#define INTERCEPT_DR6_READ	6</span>
<span class="cp">#define INTERCEPT_DR7_READ	7</span>
<span class="cp">#define INTERCEPT_DR0_WRITE	(16 + 0)</span>
<span class="cp">#define INTERCEPT_DR1_WRITE	(16 + 1)</span>
<span class="cp">#define INTERCEPT_DR2_WRITE	(16 + 2)</span>
<span class="cp">#define INTERCEPT_DR3_WRITE	(16 + 3)</span>
<span class="cp">#define INTERCEPT_DR4_WRITE	(16 + 4)</span>
<span class="cp">#define INTERCEPT_DR5_WRITE	(16 + 5)</span>
<span class="cp">#define INTERCEPT_DR6_WRITE	(16 + 6)</span>
<span class="cp">#define INTERCEPT_DR7_WRITE	(16 + 7)</span>

<span class="cp">#define SVM_EVTINJ_VEC_MASK 0xff</span>

<span class="cp">#define SVM_EVTINJ_TYPE_SHIFT 8</span>
<span class="cp">#define SVM_EVTINJ_TYPE_MASK (7 &lt;&lt; SVM_EVTINJ_TYPE_SHIFT)</span>

<span class="cp">#define SVM_EVTINJ_TYPE_INTR (0 &lt;&lt; SVM_EVTINJ_TYPE_SHIFT)</span>
<span class="cp">#define SVM_EVTINJ_TYPE_NMI (2 &lt;&lt; SVM_EVTINJ_TYPE_SHIFT)</span>
<span class="cp">#define SVM_EVTINJ_TYPE_EXEPT (3 &lt;&lt; SVM_EVTINJ_TYPE_SHIFT)</span>
<span class="cp">#define SVM_EVTINJ_TYPE_SOFT (4 &lt;&lt; SVM_EVTINJ_TYPE_SHIFT)</span>

<span class="cp">#define SVM_EVTINJ_VALID (1 &lt;&lt; 31)</span>
<span class="cp">#define SVM_EVTINJ_VALID_ERR (1 &lt;&lt; 11)</span>

<span class="cp">#define SVM_EXITINTINFO_VEC_MASK SVM_EVTINJ_VEC_MASK</span>
<span class="cp">#define SVM_EXITINTINFO_TYPE_MASK SVM_EVTINJ_TYPE_MASK</span>

<span class="cp">#define	SVM_EXITINTINFO_TYPE_INTR SVM_EVTINJ_TYPE_INTR</span>
<span class="cp">#define	SVM_EXITINTINFO_TYPE_NMI SVM_EVTINJ_TYPE_NMI</span>
<span class="cp">#define	SVM_EXITINTINFO_TYPE_EXEPT SVM_EVTINJ_TYPE_EXEPT</span>
<span class="cp">#define	SVM_EXITINTINFO_TYPE_SOFT SVM_EVTINJ_TYPE_SOFT</span>

<span class="cp">#define SVM_EXITINTINFO_VALID SVM_EVTINJ_VALID</span>
<span class="cp">#define SVM_EXITINTINFO_VALID_ERR SVM_EVTINJ_VALID_ERR</span>

<span class="cp">#define SVM_EXITINFOSHIFT_TS_REASON_IRET 36</span>
<span class="cp">#define SVM_EXITINFOSHIFT_TS_REASON_JMP 38</span>
<span class="cp">#define SVM_EXITINFOSHIFT_TS_HAS_ERROR_CODE 44</span>

<span class="cp">#define SVM_EXITINFO_REG_MASK 0x0F</span>

<span class="cp">#define	SVM_EXIT_READ_CR0 	0x000</span>
<span class="cp">#define	SVM_EXIT_READ_CR3 	0x003</span>
<span class="cp">#define	SVM_EXIT_READ_CR4 	0x004</span>
<span class="cp">#define	SVM_EXIT_READ_CR8 	0x008</span>
<span class="cp">#define	SVM_EXIT_WRITE_CR0 	0x010</span>
<span class="cp">#define	SVM_EXIT_WRITE_CR3 	0x013</span>
<span class="cp">#define	SVM_EXIT_WRITE_CR4 	0x014</span>
<span class="cp">#define	SVM_EXIT_WRITE_CR8 	0x018</span>
<span class="cp">#define	SVM_EXIT_READ_DR0 	0x020</span>
<span class="cp">#define	SVM_EXIT_READ_DR1 	0x021</span>
<span class="cp">#define	SVM_EXIT_READ_DR2 	0x022</span>
<span class="cp">#define	SVM_EXIT_READ_DR3 	0x023</span>
<span class="cp">#define	SVM_EXIT_READ_DR4 	0x024</span>
<span class="cp">#define	SVM_EXIT_READ_DR5 	0x025</span>
<span class="cp">#define	SVM_EXIT_READ_DR6 	0x026</span>
<span class="cp">#define	SVM_EXIT_READ_DR7 	0x027</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR0 	0x030</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR1 	0x031</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR2 	0x032</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR3 	0x033</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR4 	0x034</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR5 	0x035</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR6 	0x036</span>
<span class="cp">#define	SVM_EXIT_WRITE_DR7 	0x037</span>
<span class="cp">#define SVM_EXIT_EXCP_BASE      0x040</span>
<span class="cp">#define SVM_EXIT_INTR		0x060</span>
<span class="cp">#define SVM_EXIT_NMI		0x061</span>
<span class="cp">#define SVM_EXIT_SMI		0x062</span>
<span class="cp">#define SVM_EXIT_INIT		0x063</span>
<span class="cp">#define SVM_EXIT_VINTR		0x064</span>
<span class="cp">#define SVM_EXIT_CR0_SEL_WRITE	0x065</span>
<span class="cp">#define SVM_EXIT_IDTR_READ	0x066</span>
<span class="cp">#define SVM_EXIT_GDTR_READ	0x067</span>
<span class="cp">#define SVM_EXIT_LDTR_READ	0x068</span>
<span class="cp">#define SVM_EXIT_TR_READ	0x069</span>
<span class="cp">#define SVM_EXIT_IDTR_WRITE	0x06a</span>
<span class="cp">#define SVM_EXIT_GDTR_WRITE	0x06b</span>
<span class="cp">#define SVM_EXIT_LDTR_WRITE	0x06c</span>
<span class="cp">#define SVM_EXIT_TR_WRITE	0x06d</span>
<span class="cp">#define SVM_EXIT_RDTSC		0x06e</span>
<span class="cp">#define SVM_EXIT_RDPMC		0x06f</span>
<span class="cp">#define SVM_EXIT_PUSHF		0x070</span>
<span class="cp">#define SVM_EXIT_POPF		0x071</span>
<span class="cp">#define SVM_EXIT_CPUID		0x072</span>
<span class="cp">#define SVM_EXIT_RSM		0x073</span>
<span class="cp">#define SVM_EXIT_IRET		0x074</span>
<span class="cp">#define SVM_EXIT_SWINT		0x075</span>
<span class="cp">#define SVM_EXIT_INVD		0x076</span>
<span class="cp">#define SVM_EXIT_PAUSE		0x077</span>
<span class="cp">#define SVM_EXIT_HLT		0x078</span>
<span class="cp">#define SVM_EXIT_INVLPG		0x079</span>
<span class="cp">#define SVM_EXIT_INVLPGA	0x07a</span>
<span class="cp">#define SVM_EXIT_IOIO		0x07b</span>
<span class="cp">#define SVM_EXIT_MSR		0x07c</span>
<span class="cp">#define SVM_EXIT_TASK_SWITCH	0x07d</span>
<span class="cp">#define SVM_EXIT_FERR_FREEZE	0x07e</span>
<span class="cp">#define SVM_EXIT_SHUTDOWN	0x07f</span>
<span class="cp">#define SVM_EXIT_VMRUN		0x080</span>
<span class="cp">#define SVM_EXIT_VMMCALL	0x081</span>
<span class="cp">#define SVM_EXIT_VMLOAD		0x082</span>
<span class="cp">#define SVM_EXIT_VMSAVE		0x083</span>
<span class="cp">#define SVM_EXIT_STGI		0x084</span>
<span class="cp">#define SVM_EXIT_CLGI		0x085</span>
<span class="cp">#define SVM_EXIT_SKINIT		0x086</span>
<span class="cp">#define SVM_EXIT_RDTSCP		0x087</span>
<span class="cp">#define SVM_EXIT_ICEBP		0x088</span>
<span class="cp">#define SVM_EXIT_WBINVD		0x089</span>
<span class="cp">#define SVM_EXIT_MONITOR	0x08a</span>
<span class="cp">#define SVM_EXIT_MWAIT		0x08b</span>
<span class="cp">#define SVM_EXIT_MWAIT_COND	0x08c</span>
<span class="cp">#define SVM_EXIT_XSETBV		0x08d</span>
<span class="cp">#define SVM_EXIT_NPF  		0x400</span>

<span class="cp">#define SVM_EXIT_ERR		-1</span>

<span class="cp">#define SVM_CR0_SELECTIVE_MASK (X86_CR0_TS | X86_CR0_MP)</span>

<span class="cp">#define SVM_VMLOAD &quot;.byte 0x0f, 0x01, 0xda&quot;</span>
<span class="cp">#define SVM_VMRUN  &quot;.byte 0x0f, 0x01, 0xd8&quot;</span>
<span class="cp">#define SVM_VMSAVE &quot;.byte 0x0f, 0x01, 0xdb&quot;</span>
<span class="cp">#define SVM_CLGI   &quot;.byte 0x0f, 0x01, 0xdd&quot;</span>
<span class="cp">#define SVM_STGI   &quot;.byte 0x0f, 0x01, 0xdc&quot;</span>
<span class="cp">#define SVM_INVLPGA &quot;.byte 0x0f, 0x01, 0xdf&quot;</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
