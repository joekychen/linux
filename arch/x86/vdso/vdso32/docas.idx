f | note.S | g | 1.6K |  | Roland McGrath | roland@redhat.com | 1201696242 |  | x86 vDSO: i386 vdso32  This makes the i386 kernel use the new vDSO build in arch/x86/vdso/vdso32/ to replace the old one from arch/x86/kernel/.  Signed-off-by: Roland McGrath <roland@redhat.com> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | sigreturn.S | g | 4.9K |  | H. Peter Anvin | hpa@zytor.com | 1201696256 |  | x86: use generic register names in struct sigcontext  Switch struct sigcontext (defined in <asm/sigcontext*.h>) to using register names withut e- or r-prefixes for both 32- and 64-bit x86. This is intended as a preliminary step in unifying this code between architectures.  Signed-off-by: H. Peter Anvin <hpa@zytor.com> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | int80.S | g | 1.4K |  | Roland McGrath | roland@redhat.com | 1201696244 |  | x86 vDSO: canonicalize sysenter .eh_frame  Some assembler versions automagically optimize .eh_frame contents, changing their size.  The CFI in sysenter.S was not using optimal formatting, so it would be changed by newer/smarter assemblers. This ran afoul of the wired constant for padding out the other vDSO images to match its size.  This changes the original hand-coded source to use the optimal format encoding for its operations.  That leaves nothing more for a fancy assembler to do, so the sizes will match the wired-in expected size regardless of the assembler version.  Signed-off-by: Roland McGrath <roland@redhat.com> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | vdso32.lds.S | g | 953B |  | Roland McGrath | roland@redhat.com | 1201696242 |  | x86 vDSO: vdso32 build  This builds the 32-bit vDSO images in the arch/x86/vdso subdirectory. Nothing uses the images yet, but this paves the way for consolidating the vDSO build logic all in one place.  The new images use a linker script sharing the layout parts from vdso-layout.lds.S with the 64-bit vDSO.  A new vdso32-syms.lds is generated in the style of vdso-syms.lds.  Signed-off-by: Roland McGrath <roland@redhat.com> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | sysenter.S | g | 3.7K |  | H. Peter Anvin | hpa@linux.intel.com | 1314141610 |  | x86-32, vdso: On system call restart after SYSENTER, use int $0x80  When we enter a 32-bit system call via SYSENTER or SYSCALL, we shuffle the arguments to match the int $0x80 calling convention.  This was probably a design mistake, but it's what it is now.  This causes errors if the system call as to be restarted.  For SYSENTER, we have to invoke the instruction from the vdso as the return address is hardcoded.  Accordingly, we can simply replace the jump in the vdso with an int $0x80 instruction and use the slower entry point for a post-restart.  Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Link: http://lkml.kernel.org/r/CA%2B55aFztZ=r5wa0x26KJQxvZOaQq8s2v3u50wCyJcA-Sc4g8gQ@mail.gmail.com Cc: <stable@kernel.org>
f | syscall.S | g | 2.0K |  | Roland McGrath | roland@redhat.com | 1201696244 |  | x86 vDSO: canonicalize sysenter .eh_frame  Some assembler versions automagically optimize .eh_frame contents, changing their size.  The CFI in sysenter.S was not using optimal formatting, so it would be changed by newer/smarter assemblers. This ran afoul of the wired constant for padding out the other vDSO images to match its size.  This changes the original hand-coded source to use the optimal format encoding for its operations.  That leaves nothing more for a fancy assembler to do, so the sizes will match the wired-in expected size regardless of the assembler version.  Signed-off-by: Roland McGrath <roland@redhat.com> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
