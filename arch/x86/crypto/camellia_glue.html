<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › x86 › crypto › camellia_glue.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>camellia_glue.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Glue Code for assembler optimized version of Camellia</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2012 Jussi Kivilinna &lt;jussi.kivilinna@mbnet.fi&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Camellia parts based on code by:</span>
<span class="cm"> *  Copyright (C) 2006 NTT (Nippon Telegraph and Telephone Corporation)</span>
<span class="cm"> * CBC &amp; ECB parts based on code (crypto/cbc.c,ecb.c) by:</span>
<span class="cm"> *   Copyright (c) 2006 Herbert Xu &lt;herbert@gondor.apana.org.au&gt;</span>
<span class="cm"> * CTR part based on code (crypto/ctr.c) by:</span>
<span class="cm"> *   (C) Copyright IBM Corp. 2007 - Joy Latten &lt;latten@us.ibm.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307</span>
<span class="cm"> * USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;asm/processor.h&gt;</span>
<span class="cp">#include &lt;asm/unaligned.h&gt;</span>
<span class="cp">#include &lt;linux/crypto.h&gt;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;crypto/algapi.h&gt;</span>
<span class="cp">#include &lt;crypto/b128ops.h&gt;</span>
<span class="cp">#include &lt;crypto/lrw.h&gt;</span>
<span class="cp">#include &lt;crypto/xts.h&gt;</span>

<span class="cp">#define CAMELLIA_MIN_KEY_SIZE	16</span>
<span class="cp">#define CAMELLIA_MAX_KEY_SIZE	32</span>
<span class="cp">#define CAMELLIA_BLOCK_SIZE	16</span>
<span class="cp">#define CAMELLIA_TABLE_BYTE_LEN	272</span>

<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="p">{</span>
	<span class="n">u64</span> <span class="n">key_table</span><span class="p">[</span><span class="n">CAMELLIA_TABLE_BYTE_LEN</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u64</span><span class="p">)];</span>
	<span class="n">u32</span> <span class="n">key_length</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* regular block cipher functions */</span>
<span class="n">asmlinkage</span> <span class="kt">void</span> <span class="n">__camellia_enc_blk</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
				   <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="n">bool</span> <span class="n">xor</span><span class="p">);</span>
<span class="n">asmlinkage</span> <span class="kt">void</span> <span class="n">camellia_dec_blk</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
				 <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>

<span class="cm">/* 2-way parallel cipher functions */</span>
<span class="n">asmlinkage</span> <span class="kt">void</span> <span class="n">__camellia_enc_blk_2way</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					<span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="n">bool</span> <span class="n">xor</span><span class="p">);</span>
<span class="n">asmlinkage</span> <span class="kt">void</span> <span class="n">camellia_dec_blk_2way</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
				      <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">camellia_enc_blk</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
				    <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__camellia_enc_blk</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">camellia_enc_blk_xor</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					<span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__camellia_enc_blk</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">camellia_enc_blk_2way</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					 <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__camellia_enc_blk_2way</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">camellia_enc_blk_xor_2way</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					     <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__camellia_enc_blk_2way</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">camellia_enc_blk</span><span class="p">(</span><span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">camellia_dec_blk</span><span class="p">(</span><span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* camellia sboxes */</span>
<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp10011110</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x7000007070707000</span><span class="p">,</span> <span class="mh">0x8200008282828200</span><span class="p">,</span> <span class="mh">0x2c00002c2c2c2c00</span><span class="p">,</span>
	<span class="mh">0xec0000ecececec00</span><span class="p">,</span> <span class="mh">0xb30000b3b3b3b300</span><span class="p">,</span> <span class="mh">0x2700002727272700</span><span class="p">,</span>
	<span class="mh">0xc00000c0c0c0c000</span><span class="p">,</span> <span class="mh">0xe50000e5e5e5e500</span><span class="p">,</span> <span class="mh">0xe40000e4e4e4e400</span><span class="p">,</span>
	<span class="mh">0x8500008585858500</span><span class="p">,</span> <span class="mh">0x5700005757575700</span><span class="p">,</span> <span class="mh">0x3500003535353500</span><span class="p">,</span>
	<span class="mh">0xea0000eaeaeaea00</span><span class="p">,</span> <span class="mh">0x0c00000c0c0c0c00</span><span class="p">,</span> <span class="mh">0xae0000aeaeaeae00</span><span class="p">,</span>
	<span class="mh">0x4100004141414100</span><span class="p">,</span> <span class="mh">0x2300002323232300</span><span class="p">,</span> <span class="mh">0xef0000efefefef00</span><span class="p">,</span>
	<span class="mh">0x6b00006b6b6b6b00</span><span class="p">,</span> <span class="mh">0x9300009393939300</span><span class="p">,</span> <span class="mh">0x4500004545454500</span><span class="p">,</span>
	<span class="mh">0x1900001919191900</span><span class="p">,</span> <span class="mh">0xa50000a5a5a5a500</span><span class="p">,</span> <span class="mh">0x2100002121212100</span><span class="p">,</span>
	<span class="mh">0xed0000edededed00</span><span class="p">,</span> <span class="mh">0x0e00000e0e0e0e00</span><span class="p">,</span> <span class="mh">0x4f00004f4f4f4f00</span><span class="p">,</span>
	<span class="mh">0x4e00004e4e4e4e00</span><span class="p">,</span> <span class="mh">0x1d00001d1d1d1d00</span><span class="p">,</span> <span class="mh">0x6500006565656500</span><span class="p">,</span>
	<span class="mh">0x9200009292929200</span><span class="p">,</span> <span class="mh">0xbd0000bdbdbdbd00</span><span class="p">,</span> <span class="mh">0x8600008686868600</span><span class="p">,</span>
	<span class="mh">0xb80000b8b8b8b800</span><span class="p">,</span> <span class="mh">0xaf0000afafafaf00</span><span class="p">,</span> <span class="mh">0x8f00008f8f8f8f00</span><span class="p">,</span>
	<span class="mh">0x7c00007c7c7c7c00</span><span class="p">,</span> <span class="mh">0xeb0000ebebebeb00</span><span class="p">,</span> <span class="mh">0x1f00001f1f1f1f00</span><span class="p">,</span>
	<span class="mh">0xce0000cececece00</span><span class="p">,</span> <span class="mh">0x3e00003e3e3e3e00</span><span class="p">,</span> <span class="mh">0x3000003030303000</span><span class="p">,</span>
	<span class="mh">0xdc0000dcdcdcdc00</span><span class="p">,</span> <span class="mh">0x5f00005f5f5f5f00</span><span class="p">,</span> <span class="mh">0x5e00005e5e5e5e00</span><span class="p">,</span>
	<span class="mh">0xc50000c5c5c5c500</span><span class="p">,</span> <span class="mh">0x0b00000b0b0b0b00</span><span class="p">,</span> <span class="mh">0x1a00001a1a1a1a00</span><span class="p">,</span>
	<span class="mh">0xa60000a6a6a6a600</span><span class="p">,</span> <span class="mh">0xe10000e1e1e1e100</span><span class="p">,</span> <span class="mh">0x3900003939393900</span><span class="p">,</span>
	<span class="mh">0xca0000cacacaca00</span><span class="p">,</span> <span class="mh">0xd50000d5d5d5d500</span><span class="p">,</span> <span class="mh">0x4700004747474700</span><span class="p">,</span>
	<span class="mh">0x5d00005d5d5d5d00</span><span class="p">,</span> <span class="mh">0x3d00003d3d3d3d00</span><span class="p">,</span> <span class="mh">0xd90000d9d9d9d900</span><span class="p">,</span>
	<span class="mh">0x0100000101010100</span><span class="p">,</span> <span class="mh">0x5a00005a5a5a5a00</span><span class="p">,</span> <span class="mh">0xd60000d6d6d6d600</span><span class="p">,</span>
	<span class="mh">0x5100005151515100</span><span class="p">,</span> <span class="mh">0x5600005656565600</span><span class="p">,</span> <span class="mh">0x6c00006c6c6c6c00</span><span class="p">,</span>
	<span class="mh">0x4d00004d4d4d4d00</span><span class="p">,</span> <span class="mh">0x8b00008b8b8b8b00</span><span class="p">,</span> <span class="mh">0x0d00000d0d0d0d00</span><span class="p">,</span>
	<span class="mh">0x9a00009a9a9a9a00</span><span class="p">,</span> <span class="mh">0x6600006666666600</span><span class="p">,</span> <span class="mh">0xfb0000fbfbfbfb00</span><span class="p">,</span>
	<span class="mh">0xcc0000cccccccc00</span><span class="p">,</span> <span class="mh">0xb00000b0b0b0b000</span><span class="p">,</span> <span class="mh">0x2d00002d2d2d2d00</span><span class="p">,</span>
	<span class="mh">0x7400007474747400</span><span class="p">,</span> <span class="mh">0x1200001212121200</span><span class="p">,</span> <span class="mh">0x2b00002b2b2b2b00</span><span class="p">,</span>
	<span class="mh">0x2000002020202000</span><span class="p">,</span> <span class="mh">0xf00000f0f0f0f000</span><span class="p">,</span> <span class="mh">0xb10000b1b1b1b100</span><span class="p">,</span>
	<span class="mh">0x8400008484848400</span><span class="p">,</span> <span class="mh">0x9900009999999900</span><span class="p">,</span> <span class="mh">0xdf0000dfdfdfdf00</span><span class="p">,</span>
	<span class="mh">0x4c00004c4c4c4c00</span><span class="p">,</span> <span class="mh">0xcb0000cbcbcbcb00</span><span class="p">,</span> <span class="mh">0xc20000c2c2c2c200</span><span class="p">,</span>
	<span class="mh">0x3400003434343400</span><span class="p">,</span> <span class="mh">0x7e00007e7e7e7e00</span><span class="p">,</span> <span class="mh">0x7600007676767600</span><span class="p">,</span>
	<span class="mh">0x0500000505050500</span><span class="p">,</span> <span class="mh">0x6d00006d6d6d6d00</span><span class="p">,</span> <span class="mh">0xb70000b7b7b7b700</span><span class="p">,</span>
	<span class="mh">0xa90000a9a9a9a900</span><span class="p">,</span> <span class="mh">0x3100003131313100</span><span class="p">,</span> <span class="mh">0xd10000d1d1d1d100</span><span class="p">,</span>
	<span class="mh">0x1700001717171700</span><span class="p">,</span> <span class="mh">0x0400000404040400</span><span class="p">,</span> <span class="mh">0xd70000d7d7d7d700</span><span class="p">,</span>
	<span class="mh">0x1400001414141400</span><span class="p">,</span> <span class="mh">0x5800005858585800</span><span class="p">,</span> <span class="mh">0x3a00003a3a3a3a00</span><span class="p">,</span>
	<span class="mh">0x6100006161616100</span><span class="p">,</span> <span class="mh">0xde0000dededede00</span><span class="p">,</span> <span class="mh">0x1b00001b1b1b1b00</span><span class="p">,</span>
	<span class="mh">0x1100001111111100</span><span class="p">,</span> <span class="mh">0x1c00001c1c1c1c00</span><span class="p">,</span> <span class="mh">0x3200003232323200</span><span class="p">,</span>
	<span class="mh">0x0f00000f0f0f0f00</span><span class="p">,</span> <span class="mh">0x9c00009c9c9c9c00</span><span class="p">,</span> <span class="mh">0x1600001616161600</span><span class="p">,</span>
	<span class="mh">0x5300005353535300</span><span class="p">,</span> <span class="mh">0x1800001818181800</span><span class="p">,</span> <span class="mh">0xf20000f2f2f2f200</span><span class="p">,</span>
	<span class="mh">0x2200002222222200</span><span class="p">,</span> <span class="mh">0xfe0000fefefefe00</span><span class="p">,</span> <span class="mh">0x4400004444444400</span><span class="p">,</span>
	<span class="mh">0xcf0000cfcfcfcf00</span><span class="p">,</span> <span class="mh">0xb20000b2b2b2b200</span><span class="p">,</span> <span class="mh">0xc30000c3c3c3c300</span><span class="p">,</span>
	<span class="mh">0xb50000b5b5b5b500</span><span class="p">,</span> <span class="mh">0x7a00007a7a7a7a00</span><span class="p">,</span> <span class="mh">0x9100009191919100</span><span class="p">,</span>
	<span class="mh">0x2400002424242400</span><span class="p">,</span> <span class="mh">0x0800000808080800</span><span class="p">,</span> <span class="mh">0xe80000e8e8e8e800</span><span class="p">,</span>
	<span class="mh">0xa80000a8a8a8a800</span><span class="p">,</span> <span class="mh">0x6000006060606000</span><span class="p">,</span> <span class="mh">0xfc0000fcfcfcfc00</span><span class="p">,</span>
	<span class="mh">0x6900006969696900</span><span class="p">,</span> <span class="mh">0x5000005050505000</span><span class="p">,</span> <span class="mh">0xaa0000aaaaaaaa00</span><span class="p">,</span>
	<span class="mh">0xd00000d0d0d0d000</span><span class="p">,</span> <span class="mh">0xa00000a0a0a0a000</span><span class="p">,</span> <span class="mh">0x7d00007d7d7d7d00</span><span class="p">,</span>
	<span class="mh">0xa10000a1a1a1a100</span><span class="p">,</span> <span class="mh">0x8900008989898900</span><span class="p">,</span> <span class="mh">0x6200006262626200</span><span class="p">,</span>
	<span class="mh">0x9700009797979700</span><span class="p">,</span> <span class="mh">0x5400005454545400</span><span class="p">,</span> <span class="mh">0x5b00005b5b5b5b00</span><span class="p">,</span>
	<span class="mh">0x1e00001e1e1e1e00</span><span class="p">,</span> <span class="mh">0x9500009595959500</span><span class="p">,</span> <span class="mh">0xe00000e0e0e0e000</span><span class="p">,</span>
	<span class="mh">0xff0000ffffffff00</span><span class="p">,</span> <span class="mh">0x6400006464646400</span><span class="p">,</span> <span class="mh">0xd20000d2d2d2d200</span><span class="p">,</span>
	<span class="mh">0x1000001010101000</span><span class="p">,</span> <span class="mh">0xc40000c4c4c4c400</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span>
	<span class="mh">0x4800004848484800</span><span class="p">,</span> <span class="mh">0xa30000a3a3a3a300</span><span class="p">,</span> <span class="mh">0xf70000f7f7f7f700</span><span class="p">,</span>
	<span class="mh">0x7500007575757500</span><span class="p">,</span> <span class="mh">0xdb0000dbdbdbdb00</span><span class="p">,</span> <span class="mh">0x8a00008a8a8a8a00</span><span class="p">,</span>
	<span class="mh">0x0300000303030300</span><span class="p">,</span> <span class="mh">0xe60000e6e6e6e600</span><span class="p">,</span> <span class="mh">0xda0000dadadada00</span><span class="p">,</span>
	<span class="mh">0x0900000909090900</span><span class="p">,</span> <span class="mh">0x3f00003f3f3f3f00</span><span class="p">,</span> <span class="mh">0xdd0000dddddddd00</span><span class="p">,</span>
	<span class="mh">0x9400009494949400</span><span class="p">,</span> <span class="mh">0x8700008787878700</span><span class="p">,</span> <span class="mh">0x5c00005c5c5c5c00</span><span class="p">,</span>
	<span class="mh">0x8300008383838300</span><span class="p">,</span> <span class="mh">0x0200000202020200</span><span class="p">,</span> <span class="mh">0xcd0000cdcdcdcd00</span><span class="p">,</span>
	<span class="mh">0x4a00004a4a4a4a00</span><span class="p">,</span> <span class="mh">0x9000009090909000</span><span class="p">,</span> <span class="mh">0x3300003333333300</span><span class="p">,</span>
	<span class="mh">0x7300007373737300</span><span class="p">,</span> <span class="mh">0x6700006767676700</span><span class="p">,</span> <span class="mh">0xf60000f6f6f6f600</span><span class="p">,</span>
	<span class="mh">0xf30000f3f3f3f300</span><span class="p">,</span> <span class="mh">0x9d00009d9d9d9d00</span><span class="p">,</span> <span class="mh">0x7f00007f7f7f7f00</span><span class="p">,</span>
	<span class="mh">0xbf0000bfbfbfbf00</span><span class="p">,</span> <span class="mh">0xe20000e2e2e2e200</span><span class="p">,</span> <span class="mh">0x5200005252525200</span><span class="p">,</span>
	<span class="mh">0x9b00009b9b9b9b00</span><span class="p">,</span> <span class="mh">0xd80000d8d8d8d800</span><span class="p">,</span> <span class="mh">0x2600002626262600</span><span class="p">,</span>
	<span class="mh">0xc80000c8c8c8c800</span><span class="p">,</span> <span class="mh">0x3700003737373700</span><span class="p">,</span> <span class="mh">0xc60000c6c6c6c600</span><span class="p">,</span>
	<span class="mh">0x3b00003b3b3b3b00</span><span class="p">,</span> <span class="mh">0x8100008181818100</span><span class="p">,</span> <span class="mh">0x9600009696969600</span><span class="p">,</span>
	<span class="mh">0x6f00006f6f6f6f00</span><span class="p">,</span> <span class="mh">0x4b00004b4b4b4b00</span><span class="p">,</span> <span class="mh">0x1300001313131300</span><span class="p">,</span>
	<span class="mh">0xbe0000bebebebe00</span><span class="p">,</span> <span class="mh">0x6300006363636300</span><span class="p">,</span> <span class="mh">0x2e00002e2e2e2e00</span><span class="p">,</span>
	<span class="mh">0xe90000e9e9e9e900</span><span class="p">,</span> <span class="mh">0x7900007979797900</span><span class="p">,</span> <span class="mh">0xa70000a7a7a7a700</span><span class="p">,</span>
	<span class="mh">0x8c00008c8c8c8c00</span><span class="p">,</span> <span class="mh">0x9f00009f9f9f9f00</span><span class="p">,</span> <span class="mh">0x6e00006e6e6e6e00</span><span class="p">,</span>
	<span class="mh">0xbc0000bcbcbcbc00</span><span class="p">,</span> <span class="mh">0x8e00008e8e8e8e00</span><span class="p">,</span> <span class="mh">0x2900002929292900</span><span class="p">,</span>
	<span class="mh">0xf50000f5f5f5f500</span><span class="p">,</span> <span class="mh">0xf90000f9f9f9f900</span><span class="p">,</span> <span class="mh">0xb60000b6b6b6b600</span><span class="p">,</span>
	<span class="mh">0x2f00002f2f2f2f00</span><span class="p">,</span> <span class="mh">0xfd0000fdfdfdfd00</span><span class="p">,</span> <span class="mh">0xb40000b4b4b4b400</span><span class="p">,</span>
	<span class="mh">0x5900005959595900</span><span class="p">,</span> <span class="mh">0x7800007878787800</span><span class="p">,</span> <span class="mh">0x9800009898989800</span><span class="p">,</span>
	<span class="mh">0x0600000606060600</span><span class="p">,</span> <span class="mh">0x6a00006a6a6a6a00</span><span class="p">,</span> <span class="mh">0xe70000e7e7e7e700</span><span class="p">,</span>
	<span class="mh">0x4600004646464600</span><span class="p">,</span> <span class="mh">0x7100007171717100</span><span class="p">,</span> <span class="mh">0xba0000babababa00</span><span class="p">,</span>
	<span class="mh">0xd40000d4d4d4d400</span><span class="p">,</span> <span class="mh">0x2500002525252500</span><span class="p">,</span> <span class="mh">0xab0000abababab00</span><span class="p">,</span>
	<span class="mh">0x4200004242424200</span><span class="p">,</span> <span class="mh">0x8800008888888800</span><span class="p">,</span> <span class="mh">0xa20000a2a2a2a200</span><span class="p">,</span>
	<span class="mh">0x8d00008d8d8d8d00</span><span class="p">,</span> <span class="mh">0xfa0000fafafafa00</span><span class="p">,</span> <span class="mh">0x7200007272727200</span><span class="p">,</span>
	<span class="mh">0x0700000707070700</span><span class="p">,</span> <span class="mh">0xb90000b9b9b9b900</span><span class="p">,</span> <span class="mh">0x5500005555555500</span><span class="p">,</span>
	<span class="mh">0xf80000f8f8f8f800</span><span class="p">,</span> <span class="mh">0xee0000eeeeeeee00</span><span class="p">,</span> <span class="mh">0xac0000acacacac00</span><span class="p">,</span>
	<span class="mh">0x0a00000a0a0a0a00</span><span class="p">,</span> <span class="mh">0x3600003636363600</span><span class="p">,</span> <span class="mh">0x4900004949494900</span><span class="p">,</span>
	<span class="mh">0x2a00002a2a2a2a00</span><span class="p">,</span> <span class="mh">0x6800006868686800</span><span class="p">,</span> <span class="mh">0x3c00003c3c3c3c00</span><span class="p">,</span>
	<span class="mh">0x3800003838383800</span><span class="p">,</span> <span class="mh">0xf10000f1f1f1f100</span><span class="p">,</span> <span class="mh">0xa40000a4a4a4a400</span><span class="p">,</span>
	<span class="mh">0x4000004040404000</span><span class="p">,</span> <span class="mh">0x2800002828282800</span><span class="p">,</span> <span class="mh">0xd30000d3d3d3d300</span><span class="p">,</span>
	<span class="mh">0x7b00007b7b7b7b00</span><span class="p">,</span> <span class="mh">0xbb0000bbbbbbbb00</span><span class="p">,</span> <span class="mh">0xc90000c9c9c9c900</span><span class="p">,</span>
	<span class="mh">0x4300004343434300</span><span class="p">,</span> <span class="mh">0xc10000c1c1c1c100</span><span class="p">,</span> <span class="mh">0x1500001515151500</span><span class="p">,</span>
	<span class="mh">0xe30000e3e3e3e300</span><span class="p">,</span> <span class="mh">0xad0000adadadad00</span><span class="p">,</span> <span class="mh">0xf40000f4f4f4f400</span><span class="p">,</span>
	<span class="mh">0x7700007777777700</span><span class="p">,</span> <span class="mh">0xc70000c7c7c7c700</span><span class="p">,</span> <span class="mh">0x8000008080808000</span><span class="p">,</span>
	<span class="mh">0x9e00009e9e9e9e00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp22000222</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0xe0e0000000e0e0e0</span><span class="p">,</span> <span class="mh">0x0505000000050505</span><span class="p">,</span> <span class="mh">0x5858000000585858</span><span class="p">,</span>
	<span class="mh">0xd9d9000000d9d9d9</span><span class="p">,</span> <span class="mh">0x6767000000676767</span><span class="p">,</span> <span class="mh">0x4e4e0000004e4e4e</span><span class="p">,</span>
	<span class="mh">0x8181000000818181</span><span class="p">,</span> <span class="mh">0xcbcb000000cbcbcb</span><span class="p">,</span> <span class="mh">0xc9c9000000c9c9c9</span><span class="p">,</span>
	<span class="mh">0x0b0b0000000b0b0b</span><span class="p">,</span> <span class="mh">0xaeae000000aeaeae</span><span class="p">,</span> <span class="mh">0x6a6a0000006a6a6a</span><span class="p">,</span>
	<span class="mh">0xd5d5000000d5d5d5</span><span class="p">,</span> <span class="mh">0x1818000000181818</span><span class="p">,</span> <span class="mh">0x5d5d0000005d5d5d</span><span class="p">,</span>
	<span class="mh">0x8282000000828282</span><span class="p">,</span> <span class="mh">0x4646000000464646</span><span class="p">,</span> <span class="mh">0xdfdf000000dfdfdf</span><span class="p">,</span>
	<span class="mh">0xd6d6000000d6d6d6</span><span class="p">,</span> <span class="mh">0x2727000000272727</span><span class="p">,</span> <span class="mh">0x8a8a0000008a8a8a</span><span class="p">,</span>
	<span class="mh">0x3232000000323232</span><span class="p">,</span> <span class="mh">0x4b4b0000004b4b4b</span><span class="p">,</span> <span class="mh">0x4242000000424242</span><span class="p">,</span>
	<span class="mh">0xdbdb000000dbdbdb</span><span class="p">,</span> <span class="mh">0x1c1c0000001c1c1c</span><span class="p">,</span> <span class="mh">0x9e9e0000009e9e9e</span><span class="p">,</span>
	<span class="mh">0x9c9c0000009c9c9c</span><span class="p">,</span> <span class="mh">0x3a3a0000003a3a3a</span><span class="p">,</span> <span class="mh">0xcaca000000cacaca</span><span class="p">,</span>
	<span class="mh">0x2525000000252525</span><span class="p">,</span> <span class="mh">0x7b7b0000007b7b7b</span><span class="p">,</span> <span class="mh">0x0d0d0000000d0d0d</span><span class="p">,</span>
	<span class="mh">0x7171000000717171</span><span class="p">,</span> <span class="mh">0x5f5f0000005f5f5f</span><span class="p">,</span> <span class="mh">0x1f1f0000001f1f1f</span><span class="p">,</span>
	<span class="mh">0xf8f8000000f8f8f8</span><span class="p">,</span> <span class="mh">0xd7d7000000d7d7d7</span><span class="p">,</span> <span class="mh">0x3e3e0000003e3e3e</span><span class="p">,</span>
	<span class="mh">0x9d9d0000009d9d9d</span><span class="p">,</span> <span class="mh">0x7c7c0000007c7c7c</span><span class="p">,</span> <span class="mh">0x6060000000606060</span><span class="p">,</span>
	<span class="mh">0xb9b9000000b9b9b9</span><span class="p">,</span> <span class="mh">0xbebe000000bebebe</span><span class="p">,</span> <span class="mh">0xbcbc000000bcbcbc</span><span class="p">,</span>
	<span class="mh">0x8b8b0000008b8b8b</span><span class="p">,</span> <span class="mh">0x1616000000161616</span><span class="p">,</span> <span class="mh">0x3434000000343434</span><span class="p">,</span>
	<span class="mh">0x4d4d0000004d4d4d</span><span class="p">,</span> <span class="mh">0xc3c3000000c3c3c3</span><span class="p">,</span> <span class="mh">0x7272000000727272</span><span class="p">,</span>
	<span class="mh">0x9595000000959595</span><span class="p">,</span> <span class="mh">0xabab000000ababab</span><span class="p">,</span> <span class="mh">0x8e8e0000008e8e8e</span><span class="p">,</span>
	<span class="mh">0xbaba000000bababa</span><span class="p">,</span> <span class="mh">0x7a7a0000007a7a7a</span><span class="p">,</span> <span class="mh">0xb3b3000000b3b3b3</span><span class="p">,</span>
	<span class="mh">0x0202000000020202</span><span class="p">,</span> <span class="mh">0xb4b4000000b4b4b4</span><span class="p">,</span> <span class="mh">0xadad000000adadad</span><span class="p">,</span>
	<span class="mh">0xa2a2000000a2a2a2</span><span class="p">,</span> <span class="mh">0xacac000000acacac</span><span class="p">,</span> <span class="mh">0xd8d8000000d8d8d8</span><span class="p">,</span>
	<span class="mh">0x9a9a0000009a9a9a</span><span class="p">,</span> <span class="mh">0x1717000000171717</span><span class="p">,</span> <span class="mh">0x1a1a0000001a1a1a</span><span class="p">,</span>
	<span class="mh">0x3535000000353535</span><span class="p">,</span> <span class="mh">0xcccc000000cccccc</span><span class="p">,</span> <span class="mh">0xf7f7000000f7f7f7</span><span class="p">,</span>
	<span class="mh">0x9999000000999999</span><span class="p">,</span> <span class="mh">0x6161000000616161</span><span class="p">,</span> <span class="mh">0x5a5a0000005a5a5a</span><span class="p">,</span>
	<span class="mh">0xe8e8000000e8e8e8</span><span class="p">,</span> <span class="mh">0x2424000000242424</span><span class="p">,</span> <span class="mh">0x5656000000565656</span><span class="p">,</span>
	<span class="mh">0x4040000000404040</span><span class="p">,</span> <span class="mh">0xe1e1000000e1e1e1</span><span class="p">,</span> <span class="mh">0x6363000000636363</span><span class="p">,</span>
	<span class="mh">0x0909000000090909</span><span class="p">,</span> <span class="mh">0x3333000000333333</span><span class="p">,</span> <span class="mh">0xbfbf000000bfbfbf</span><span class="p">,</span>
	<span class="mh">0x9898000000989898</span><span class="p">,</span> <span class="mh">0x9797000000979797</span><span class="p">,</span> <span class="mh">0x8585000000858585</span><span class="p">,</span>
	<span class="mh">0x6868000000686868</span><span class="p">,</span> <span class="mh">0xfcfc000000fcfcfc</span><span class="p">,</span> <span class="mh">0xecec000000ececec</span><span class="p">,</span>
	<span class="mh">0x0a0a0000000a0a0a</span><span class="p">,</span> <span class="mh">0xdada000000dadada</span><span class="p">,</span> <span class="mh">0x6f6f0000006f6f6f</span><span class="p">,</span>
	<span class="mh">0x5353000000535353</span><span class="p">,</span> <span class="mh">0x6262000000626262</span><span class="p">,</span> <span class="mh">0xa3a3000000a3a3a3</span><span class="p">,</span>
	<span class="mh">0x2e2e0000002e2e2e</span><span class="p">,</span> <span class="mh">0x0808000000080808</span><span class="p">,</span> <span class="mh">0xafaf000000afafaf</span><span class="p">,</span>
	<span class="mh">0x2828000000282828</span><span class="p">,</span> <span class="mh">0xb0b0000000b0b0b0</span><span class="p">,</span> <span class="mh">0x7474000000747474</span><span class="p">,</span>
	<span class="mh">0xc2c2000000c2c2c2</span><span class="p">,</span> <span class="mh">0xbdbd000000bdbdbd</span><span class="p">,</span> <span class="mh">0x3636000000363636</span><span class="p">,</span>
	<span class="mh">0x2222000000222222</span><span class="p">,</span> <span class="mh">0x3838000000383838</span><span class="p">,</span> <span class="mh">0x6464000000646464</span><span class="p">,</span>
	<span class="mh">0x1e1e0000001e1e1e</span><span class="p">,</span> <span class="mh">0x3939000000393939</span><span class="p">,</span> <span class="mh">0x2c2c0000002c2c2c</span><span class="p">,</span>
	<span class="mh">0xa6a6000000a6a6a6</span><span class="p">,</span> <span class="mh">0x3030000000303030</span><span class="p">,</span> <span class="mh">0xe5e5000000e5e5e5</span><span class="p">,</span>
	<span class="mh">0x4444000000444444</span><span class="p">,</span> <span class="mh">0xfdfd000000fdfdfd</span><span class="p">,</span> <span class="mh">0x8888000000888888</span><span class="p">,</span>
	<span class="mh">0x9f9f0000009f9f9f</span><span class="p">,</span> <span class="mh">0x6565000000656565</span><span class="p">,</span> <span class="mh">0x8787000000878787</span><span class="p">,</span>
	<span class="mh">0x6b6b0000006b6b6b</span><span class="p">,</span> <span class="mh">0xf4f4000000f4f4f4</span><span class="p">,</span> <span class="mh">0x2323000000232323</span><span class="p">,</span>
	<span class="mh">0x4848000000484848</span><span class="p">,</span> <span class="mh">0x1010000000101010</span><span class="p">,</span> <span class="mh">0xd1d1000000d1d1d1</span><span class="p">,</span>
	<span class="mh">0x5151000000515151</span><span class="p">,</span> <span class="mh">0xc0c0000000c0c0c0</span><span class="p">,</span> <span class="mh">0xf9f9000000f9f9f9</span><span class="p">,</span>
	<span class="mh">0xd2d2000000d2d2d2</span><span class="p">,</span> <span class="mh">0xa0a0000000a0a0a0</span><span class="p">,</span> <span class="mh">0x5555000000555555</span><span class="p">,</span>
	<span class="mh">0xa1a1000000a1a1a1</span><span class="p">,</span> <span class="mh">0x4141000000414141</span><span class="p">,</span> <span class="mh">0xfafa000000fafafa</span><span class="p">,</span>
	<span class="mh">0x4343000000434343</span><span class="p">,</span> <span class="mh">0x1313000000131313</span><span class="p">,</span> <span class="mh">0xc4c4000000c4c4c4</span><span class="p">,</span>
	<span class="mh">0x2f2f0000002f2f2f</span><span class="p">,</span> <span class="mh">0xa8a8000000a8a8a8</span><span class="p">,</span> <span class="mh">0xb6b6000000b6b6b6</span><span class="p">,</span>
	<span class="mh">0x3c3c0000003c3c3c</span><span class="p">,</span> <span class="mh">0x2b2b0000002b2b2b</span><span class="p">,</span> <span class="mh">0xc1c1000000c1c1c1</span><span class="p">,</span>
	<span class="mh">0xffff000000ffffff</span><span class="p">,</span> <span class="mh">0xc8c8000000c8c8c8</span><span class="p">,</span> <span class="mh">0xa5a5000000a5a5a5</span><span class="p">,</span>
	<span class="mh">0x2020000000202020</span><span class="p">,</span> <span class="mh">0x8989000000898989</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span>
	<span class="mh">0x9090000000909090</span><span class="p">,</span> <span class="mh">0x4747000000474747</span><span class="p">,</span> <span class="mh">0xefef000000efefef</span><span class="p">,</span>
	<span class="mh">0xeaea000000eaeaea</span><span class="p">,</span> <span class="mh">0xb7b7000000b7b7b7</span><span class="p">,</span> <span class="mh">0x1515000000151515</span><span class="p">,</span>
	<span class="mh">0x0606000000060606</span><span class="p">,</span> <span class="mh">0xcdcd000000cdcdcd</span><span class="p">,</span> <span class="mh">0xb5b5000000b5b5b5</span><span class="p">,</span>
	<span class="mh">0x1212000000121212</span><span class="p">,</span> <span class="mh">0x7e7e0000007e7e7e</span><span class="p">,</span> <span class="mh">0xbbbb000000bbbbbb</span><span class="p">,</span>
	<span class="mh">0x2929000000292929</span><span class="p">,</span> <span class="mh">0x0f0f0000000f0f0f</span><span class="p">,</span> <span class="mh">0xb8b8000000b8b8b8</span><span class="p">,</span>
	<span class="mh">0x0707000000070707</span><span class="p">,</span> <span class="mh">0x0404000000040404</span><span class="p">,</span> <span class="mh">0x9b9b0000009b9b9b</span><span class="p">,</span>
	<span class="mh">0x9494000000949494</span><span class="p">,</span> <span class="mh">0x2121000000212121</span><span class="p">,</span> <span class="mh">0x6666000000666666</span><span class="p">,</span>
	<span class="mh">0xe6e6000000e6e6e6</span><span class="p">,</span> <span class="mh">0xcece000000cecece</span><span class="p">,</span> <span class="mh">0xeded000000ededed</span><span class="p">,</span>
	<span class="mh">0xe7e7000000e7e7e7</span><span class="p">,</span> <span class="mh">0x3b3b0000003b3b3b</span><span class="p">,</span> <span class="mh">0xfefe000000fefefe</span><span class="p">,</span>
	<span class="mh">0x7f7f0000007f7f7f</span><span class="p">,</span> <span class="mh">0xc5c5000000c5c5c5</span><span class="p">,</span> <span class="mh">0xa4a4000000a4a4a4</span><span class="p">,</span>
	<span class="mh">0x3737000000373737</span><span class="p">,</span> <span class="mh">0xb1b1000000b1b1b1</span><span class="p">,</span> <span class="mh">0x4c4c0000004c4c4c</span><span class="p">,</span>
	<span class="mh">0x9191000000919191</span><span class="p">,</span> <span class="mh">0x6e6e0000006e6e6e</span><span class="p">,</span> <span class="mh">0x8d8d0000008d8d8d</span><span class="p">,</span>
	<span class="mh">0x7676000000767676</span><span class="p">,</span> <span class="mh">0x0303000000030303</span><span class="p">,</span> <span class="mh">0x2d2d0000002d2d2d</span><span class="p">,</span>
	<span class="mh">0xdede000000dedede</span><span class="p">,</span> <span class="mh">0x9696000000969696</span><span class="p">,</span> <span class="mh">0x2626000000262626</span><span class="p">,</span>
	<span class="mh">0x7d7d0000007d7d7d</span><span class="p">,</span> <span class="mh">0xc6c6000000c6c6c6</span><span class="p">,</span> <span class="mh">0x5c5c0000005c5c5c</span><span class="p">,</span>
	<span class="mh">0xd3d3000000d3d3d3</span><span class="p">,</span> <span class="mh">0xf2f2000000f2f2f2</span><span class="p">,</span> <span class="mh">0x4f4f0000004f4f4f</span><span class="p">,</span>
	<span class="mh">0x1919000000191919</span><span class="p">,</span> <span class="mh">0x3f3f0000003f3f3f</span><span class="p">,</span> <span class="mh">0xdcdc000000dcdcdc</span><span class="p">,</span>
	<span class="mh">0x7979000000797979</span><span class="p">,</span> <span class="mh">0x1d1d0000001d1d1d</span><span class="p">,</span> <span class="mh">0x5252000000525252</span><span class="p">,</span>
	<span class="mh">0xebeb000000ebebeb</span><span class="p">,</span> <span class="mh">0xf3f3000000f3f3f3</span><span class="p">,</span> <span class="mh">0x6d6d0000006d6d6d</span><span class="p">,</span>
	<span class="mh">0x5e5e0000005e5e5e</span><span class="p">,</span> <span class="mh">0xfbfb000000fbfbfb</span><span class="p">,</span> <span class="mh">0x6969000000696969</span><span class="p">,</span>
	<span class="mh">0xb2b2000000b2b2b2</span><span class="p">,</span> <span class="mh">0xf0f0000000f0f0f0</span><span class="p">,</span> <span class="mh">0x3131000000313131</span><span class="p">,</span>
	<span class="mh">0x0c0c0000000c0c0c</span><span class="p">,</span> <span class="mh">0xd4d4000000d4d4d4</span><span class="p">,</span> <span class="mh">0xcfcf000000cfcfcf</span><span class="p">,</span>
	<span class="mh">0x8c8c0000008c8c8c</span><span class="p">,</span> <span class="mh">0xe2e2000000e2e2e2</span><span class="p">,</span> <span class="mh">0x7575000000757575</span><span class="p">,</span>
	<span class="mh">0xa9a9000000a9a9a9</span><span class="p">,</span> <span class="mh">0x4a4a0000004a4a4a</span><span class="p">,</span> <span class="mh">0x5757000000575757</span><span class="p">,</span>
	<span class="mh">0x8484000000848484</span><span class="p">,</span> <span class="mh">0x1111000000111111</span><span class="p">,</span> <span class="mh">0x4545000000454545</span><span class="p">,</span>
	<span class="mh">0x1b1b0000001b1b1b</span><span class="p">,</span> <span class="mh">0xf5f5000000f5f5f5</span><span class="p">,</span> <span class="mh">0xe4e4000000e4e4e4</span><span class="p">,</span>
	<span class="mh">0x0e0e0000000e0e0e</span><span class="p">,</span> <span class="mh">0x7373000000737373</span><span class="p">,</span> <span class="mh">0xaaaa000000aaaaaa</span><span class="p">,</span>
	<span class="mh">0xf1f1000000f1f1f1</span><span class="p">,</span> <span class="mh">0xdddd000000dddddd</span><span class="p">,</span> <span class="mh">0x5959000000595959</span><span class="p">,</span>
	<span class="mh">0x1414000000141414</span><span class="p">,</span> <span class="mh">0x6c6c0000006c6c6c</span><span class="p">,</span> <span class="mh">0x9292000000929292</span><span class="p">,</span>
	<span class="mh">0x5454000000545454</span><span class="p">,</span> <span class="mh">0xd0d0000000d0d0d0</span><span class="p">,</span> <span class="mh">0x7878000000787878</span><span class="p">,</span>
	<span class="mh">0x7070000000707070</span><span class="p">,</span> <span class="mh">0xe3e3000000e3e3e3</span><span class="p">,</span> <span class="mh">0x4949000000494949</span><span class="p">,</span>
	<span class="mh">0x8080000000808080</span><span class="p">,</span> <span class="mh">0x5050000000505050</span><span class="p">,</span> <span class="mh">0xa7a7000000a7a7a7</span><span class="p">,</span>
	<span class="mh">0xf6f6000000f6f6f6</span><span class="p">,</span> <span class="mh">0x7777000000777777</span><span class="p">,</span> <span class="mh">0x9393000000939393</span><span class="p">,</span>
	<span class="mh">0x8686000000868686</span><span class="p">,</span> <span class="mh">0x8383000000838383</span><span class="p">,</span> <span class="mh">0x2a2a0000002a2a2a</span><span class="p">,</span>
	<span class="mh">0xc7c7000000c7c7c7</span><span class="p">,</span> <span class="mh">0x5b5b0000005b5b5b</span><span class="p">,</span> <span class="mh">0xe9e9000000e9e9e9</span><span class="p">,</span>
	<span class="mh">0xeeee000000eeeeee</span><span class="p">,</span> <span class="mh">0x8f8f0000008f8f8f</span><span class="p">,</span> <span class="mh">0x0101000000010101</span><span class="p">,</span>
	<span class="mh">0x3d3d0000003d3d3d</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp03303033</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0038380038003838</span><span class="p">,</span> <span class="mh">0x0041410041004141</span><span class="p">,</span> <span class="mh">0x0016160016001616</span><span class="p">,</span>
	<span class="mh">0x0076760076007676</span><span class="p">,</span> <span class="mh">0x00d9d900d900d9d9</span><span class="p">,</span> <span class="mh">0x0093930093009393</span><span class="p">,</span>
	<span class="mh">0x0060600060006060</span><span class="p">,</span> <span class="mh">0x00f2f200f200f2f2</span><span class="p">,</span> <span class="mh">0x0072720072007272</span><span class="p">,</span>
	<span class="mh">0x00c2c200c200c2c2</span><span class="p">,</span> <span class="mh">0x00abab00ab00abab</span><span class="p">,</span> <span class="mh">0x009a9a009a009a9a</span><span class="p">,</span>
	<span class="mh">0x0075750075007575</span><span class="p">,</span> <span class="mh">0x0006060006000606</span><span class="p">,</span> <span class="mh">0x0057570057005757</span><span class="p">,</span>
	<span class="mh">0x00a0a000a000a0a0</span><span class="p">,</span> <span class="mh">0x0091910091009191</span><span class="p">,</span> <span class="mh">0x00f7f700f700f7f7</span><span class="p">,</span>
	<span class="mh">0x00b5b500b500b5b5</span><span class="p">,</span> <span class="mh">0x00c9c900c900c9c9</span><span class="p">,</span> <span class="mh">0x00a2a200a200a2a2</span><span class="p">,</span>
	<span class="mh">0x008c8c008c008c8c</span><span class="p">,</span> <span class="mh">0x00d2d200d200d2d2</span><span class="p">,</span> <span class="mh">0x0090900090009090</span><span class="p">,</span>
	<span class="mh">0x00f6f600f600f6f6</span><span class="p">,</span> <span class="mh">0x0007070007000707</span><span class="p">,</span> <span class="mh">0x00a7a700a700a7a7</span><span class="p">,</span>
	<span class="mh">0x0027270027002727</span><span class="p">,</span> <span class="mh">0x008e8e008e008e8e</span><span class="p">,</span> <span class="mh">0x00b2b200b200b2b2</span><span class="p">,</span>
	<span class="mh">0x0049490049004949</span><span class="p">,</span> <span class="mh">0x00dede00de00dede</span><span class="p">,</span> <span class="mh">0x0043430043004343</span><span class="p">,</span>
	<span class="mh">0x005c5c005c005c5c</span><span class="p">,</span> <span class="mh">0x00d7d700d700d7d7</span><span class="p">,</span> <span class="mh">0x00c7c700c700c7c7</span><span class="p">,</span>
	<span class="mh">0x003e3e003e003e3e</span><span class="p">,</span> <span class="mh">0x00f5f500f500f5f5</span><span class="p">,</span> <span class="mh">0x008f8f008f008f8f</span><span class="p">,</span>
	<span class="mh">0x0067670067006767</span><span class="p">,</span> <span class="mh">0x001f1f001f001f1f</span><span class="p">,</span> <span class="mh">0x0018180018001818</span><span class="p">,</span>
	<span class="mh">0x006e6e006e006e6e</span><span class="p">,</span> <span class="mh">0x00afaf00af00afaf</span><span class="p">,</span> <span class="mh">0x002f2f002f002f2f</span><span class="p">,</span>
	<span class="mh">0x00e2e200e200e2e2</span><span class="p">,</span> <span class="mh">0x0085850085008585</span><span class="p">,</span> <span class="mh">0x000d0d000d000d0d</span><span class="p">,</span>
	<span class="mh">0x0053530053005353</span><span class="p">,</span> <span class="mh">0x00f0f000f000f0f0</span><span class="p">,</span> <span class="mh">0x009c9c009c009c9c</span><span class="p">,</span>
	<span class="mh">0x0065650065006565</span><span class="p">,</span> <span class="mh">0x00eaea00ea00eaea</span><span class="p">,</span> <span class="mh">0x00a3a300a300a3a3</span><span class="p">,</span>
	<span class="mh">0x00aeae00ae00aeae</span><span class="p">,</span> <span class="mh">0x009e9e009e009e9e</span><span class="p">,</span> <span class="mh">0x00ecec00ec00ecec</span><span class="p">,</span>
	<span class="mh">0x0080800080008080</span><span class="p">,</span> <span class="mh">0x002d2d002d002d2d</span><span class="p">,</span> <span class="mh">0x006b6b006b006b6b</span><span class="p">,</span>
	<span class="mh">0x00a8a800a800a8a8</span><span class="p">,</span> <span class="mh">0x002b2b002b002b2b</span><span class="p">,</span> <span class="mh">0x0036360036003636</span><span class="p">,</span>
	<span class="mh">0x00a6a600a600a6a6</span><span class="p">,</span> <span class="mh">0x00c5c500c500c5c5</span><span class="p">,</span> <span class="mh">0x0086860086008686</span><span class="p">,</span>
	<span class="mh">0x004d4d004d004d4d</span><span class="p">,</span> <span class="mh">0x0033330033003333</span><span class="p">,</span> <span class="mh">0x00fdfd00fd00fdfd</span><span class="p">,</span>
	<span class="mh">0x0066660066006666</span><span class="p">,</span> <span class="mh">0x0058580058005858</span><span class="p">,</span> <span class="mh">0x0096960096009696</span><span class="p">,</span>
	<span class="mh">0x003a3a003a003a3a</span><span class="p">,</span> <span class="mh">0x0009090009000909</span><span class="p">,</span> <span class="mh">0x0095950095009595</span><span class="p">,</span>
	<span class="mh">0x0010100010001010</span><span class="p">,</span> <span class="mh">0x0078780078007878</span><span class="p">,</span> <span class="mh">0x00d8d800d800d8d8</span><span class="p">,</span>
	<span class="mh">0x0042420042004242</span><span class="p">,</span> <span class="mh">0x00cccc00cc00cccc</span><span class="p">,</span> <span class="mh">0x00efef00ef00efef</span><span class="p">,</span>
	<span class="mh">0x0026260026002626</span><span class="p">,</span> <span class="mh">0x00e5e500e500e5e5</span><span class="p">,</span> <span class="mh">0x0061610061006161</span><span class="p">,</span>
	<span class="mh">0x001a1a001a001a1a</span><span class="p">,</span> <span class="mh">0x003f3f003f003f3f</span><span class="p">,</span> <span class="mh">0x003b3b003b003b3b</span><span class="p">,</span>
	<span class="mh">0x0082820082008282</span><span class="p">,</span> <span class="mh">0x00b6b600b600b6b6</span><span class="p">,</span> <span class="mh">0x00dbdb00db00dbdb</span><span class="p">,</span>
	<span class="mh">0x00d4d400d400d4d4</span><span class="p">,</span> <span class="mh">0x0098980098009898</span><span class="p">,</span> <span class="mh">0x00e8e800e800e8e8</span><span class="p">,</span>
	<span class="mh">0x008b8b008b008b8b</span><span class="p">,</span> <span class="mh">0x0002020002000202</span><span class="p">,</span> <span class="mh">0x00ebeb00eb00ebeb</span><span class="p">,</span>
	<span class="mh">0x000a0a000a000a0a</span><span class="p">,</span> <span class="mh">0x002c2c002c002c2c</span><span class="p">,</span> <span class="mh">0x001d1d001d001d1d</span><span class="p">,</span>
	<span class="mh">0x00b0b000b000b0b0</span><span class="p">,</span> <span class="mh">0x006f6f006f006f6f</span><span class="p">,</span> <span class="mh">0x008d8d008d008d8d</span><span class="p">,</span>
	<span class="mh">0x0088880088008888</span><span class="p">,</span> <span class="mh">0x000e0e000e000e0e</span><span class="p">,</span> <span class="mh">0x0019190019001919</span><span class="p">,</span>
	<span class="mh">0x0087870087008787</span><span class="p">,</span> <span class="mh">0x004e4e004e004e4e</span><span class="p">,</span> <span class="mh">0x000b0b000b000b0b</span><span class="p">,</span>
	<span class="mh">0x00a9a900a900a9a9</span><span class="p">,</span> <span class="mh">0x000c0c000c000c0c</span><span class="p">,</span> <span class="mh">0x0079790079007979</span><span class="p">,</span>
	<span class="mh">0x0011110011001111</span><span class="p">,</span> <span class="mh">0x007f7f007f007f7f</span><span class="p">,</span> <span class="mh">0x0022220022002222</span><span class="p">,</span>
	<span class="mh">0x00e7e700e700e7e7</span><span class="p">,</span> <span class="mh">0x0059590059005959</span><span class="p">,</span> <span class="mh">0x00e1e100e100e1e1</span><span class="p">,</span>
	<span class="mh">0x00dada00da00dada</span><span class="p">,</span> <span class="mh">0x003d3d003d003d3d</span><span class="p">,</span> <span class="mh">0x00c8c800c800c8c8</span><span class="p">,</span>
	<span class="mh">0x0012120012001212</span><span class="p">,</span> <span class="mh">0x0004040004000404</span><span class="p">,</span> <span class="mh">0x0074740074007474</span><span class="p">,</span>
	<span class="mh">0x0054540054005454</span><span class="p">,</span> <span class="mh">0x0030300030003030</span><span class="p">,</span> <span class="mh">0x007e7e007e007e7e</span><span class="p">,</span>
	<span class="mh">0x00b4b400b400b4b4</span><span class="p">,</span> <span class="mh">0x0028280028002828</span><span class="p">,</span> <span class="mh">0x0055550055005555</span><span class="p">,</span>
	<span class="mh">0x0068680068006868</span><span class="p">,</span> <span class="mh">0x0050500050005050</span><span class="p">,</span> <span class="mh">0x00bebe00be00bebe</span><span class="p">,</span>
	<span class="mh">0x00d0d000d000d0d0</span><span class="p">,</span> <span class="mh">0x00c4c400c400c4c4</span><span class="p">,</span> <span class="mh">0x0031310031003131</span><span class="p">,</span>
	<span class="mh">0x00cbcb00cb00cbcb</span><span class="p">,</span> <span class="mh">0x002a2a002a002a2a</span><span class="p">,</span> <span class="mh">0x00adad00ad00adad</span><span class="p">,</span>
	<span class="mh">0x000f0f000f000f0f</span><span class="p">,</span> <span class="mh">0x00caca00ca00caca</span><span class="p">,</span> <span class="mh">0x0070700070007070</span><span class="p">,</span>
	<span class="mh">0x00ffff00ff00ffff</span><span class="p">,</span> <span class="mh">0x0032320032003232</span><span class="p">,</span> <span class="mh">0x0069690069006969</span><span class="p">,</span>
	<span class="mh">0x0008080008000808</span><span class="p">,</span> <span class="mh">0x0062620062006262</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span>
	<span class="mh">0x0024240024002424</span><span class="p">,</span> <span class="mh">0x00d1d100d100d1d1</span><span class="p">,</span> <span class="mh">0x00fbfb00fb00fbfb</span><span class="p">,</span>
	<span class="mh">0x00baba00ba00baba</span><span class="p">,</span> <span class="mh">0x00eded00ed00eded</span><span class="p">,</span> <span class="mh">0x0045450045004545</span><span class="p">,</span>
	<span class="mh">0x0081810081008181</span><span class="p">,</span> <span class="mh">0x0073730073007373</span><span class="p">,</span> <span class="mh">0x006d6d006d006d6d</span><span class="p">,</span>
	<span class="mh">0x0084840084008484</span><span class="p">,</span> <span class="mh">0x009f9f009f009f9f</span><span class="p">,</span> <span class="mh">0x00eeee00ee00eeee</span><span class="p">,</span>
	<span class="mh">0x004a4a004a004a4a</span><span class="p">,</span> <span class="mh">0x00c3c300c300c3c3</span><span class="p">,</span> <span class="mh">0x002e2e002e002e2e</span><span class="p">,</span>
	<span class="mh">0x00c1c100c100c1c1</span><span class="p">,</span> <span class="mh">0x0001010001000101</span><span class="p">,</span> <span class="mh">0x00e6e600e600e6e6</span><span class="p">,</span>
	<span class="mh">0x0025250025002525</span><span class="p">,</span> <span class="mh">0x0048480048004848</span><span class="p">,</span> <span class="mh">0x0099990099009999</span><span class="p">,</span>
	<span class="mh">0x00b9b900b900b9b9</span><span class="p">,</span> <span class="mh">0x00b3b300b300b3b3</span><span class="p">,</span> <span class="mh">0x007b7b007b007b7b</span><span class="p">,</span>
	<span class="mh">0x00f9f900f900f9f9</span><span class="p">,</span> <span class="mh">0x00cece00ce00cece</span><span class="p">,</span> <span class="mh">0x00bfbf00bf00bfbf</span><span class="p">,</span>
	<span class="mh">0x00dfdf00df00dfdf</span><span class="p">,</span> <span class="mh">0x0071710071007171</span><span class="p">,</span> <span class="mh">0x0029290029002929</span><span class="p">,</span>
	<span class="mh">0x00cdcd00cd00cdcd</span><span class="p">,</span> <span class="mh">0x006c6c006c006c6c</span><span class="p">,</span> <span class="mh">0x0013130013001313</span><span class="p">,</span>
	<span class="mh">0x0064640064006464</span><span class="p">,</span> <span class="mh">0x009b9b009b009b9b</span><span class="p">,</span> <span class="mh">0x0063630063006363</span><span class="p">,</span>
	<span class="mh">0x009d9d009d009d9d</span><span class="p">,</span> <span class="mh">0x00c0c000c000c0c0</span><span class="p">,</span> <span class="mh">0x004b4b004b004b4b</span><span class="p">,</span>
	<span class="mh">0x00b7b700b700b7b7</span><span class="p">,</span> <span class="mh">0x00a5a500a500a5a5</span><span class="p">,</span> <span class="mh">0x0089890089008989</span><span class="p">,</span>
	<span class="mh">0x005f5f005f005f5f</span><span class="p">,</span> <span class="mh">0x00b1b100b100b1b1</span><span class="p">,</span> <span class="mh">0x0017170017001717</span><span class="p">,</span>
	<span class="mh">0x00f4f400f400f4f4</span><span class="p">,</span> <span class="mh">0x00bcbc00bc00bcbc</span><span class="p">,</span> <span class="mh">0x00d3d300d300d3d3</span><span class="p">,</span>
	<span class="mh">0x0046460046004646</span><span class="p">,</span> <span class="mh">0x00cfcf00cf00cfcf</span><span class="p">,</span> <span class="mh">0x0037370037003737</span><span class="p">,</span>
	<span class="mh">0x005e5e005e005e5e</span><span class="p">,</span> <span class="mh">0x0047470047004747</span><span class="p">,</span> <span class="mh">0x0094940094009494</span><span class="p">,</span>
	<span class="mh">0x00fafa00fa00fafa</span><span class="p">,</span> <span class="mh">0x00fcfc00fc00fcfc</span><span class="p">,</span> <span class="mh">0x005b5b005b005b5b</span><span class="p">,</span>
	<span class="mh">0x0097970097009797</span><span class="p">,</span> <span class="mh">0x00fefe00fe00fefe</span><span class="p">,</span> <span class="mh">0x005a5a005a005a5a</span><span class="p">,</span>
	<span class="mh">0x00acac00ac00acac</span><span class="p">,</span> <span class="mh">0x003c3c003c003c3c</span><span class="p">,</span> <span class="mh">0x004c4c004c004c4c</span><span class="p">,</span>
	<span class="mh">0x0003030003000303</span><span class="p">,</span> <span class="mh">0x0035350035003535</span><span class="p">,</span> <span class="mh">0x00f3f300f300f3f3</span><span class="p">,</span>
	<span class="mh">0x0023230023002323</span><span class="p">,</span> <span class="mh">0x00b8b800b800b8b8</span><span class="p">,</span> <span class="mh">0x005d5d005d005d5d</span><span class="p">,</span>
	<span class="mh">0x006a6a006a006a6a</span><span class="p">,</span> <span class="mh">0x0092920092009292</span><span class="p">,</span> <span class="mh">0x00d5d500d500d5d5</span><span class="p">,</span>
	<span class="mh">0x0021210021002121</span><span class="p">,</span> <span class="mh">0x0044440044004444</span><span class="p">,</span> <span class="mh">0x0051510051005151</span><span class="p">,</span>
	<span class="mh">0x00c6c600c600c6c6</span><span class="p">,</span> <span class="mh">0x007d7d007d007d7d</span><span class="p">,</span> <span class="mh">0x0039390039003939</span><span class="p">,</span>
	<span class="mh">0x0083830083008383</span><span class="p">,</span> <span class="mh">0x00dcdc00dc00dcdc</span><span class="p">,</span> <span class="mh">0x00aaaa00aa00aaaa</span><span class="p">,</span>
	<span class="mh">0x007c7c007c007c7c</span><span class="p">,</span> <span class="mh">0x0077770077007777</span><span class="p">,</span> <span class="mh">0x0056560056005656</span><span class="p">,</span>
	<span class="mh">0x0005050005000505</span><span class="p">,</span> <span class="mh">0x001b1b001b001b1b</span><span class="p">,</span> <span class="mh">0x00a4a400a400a4a4</span><span class="p">,</span>
	<span class="mh">0x0015150015001515</span><span class="p">,</span> <span class="mh">0x0034340034003434</span><span class="p">,</span> <span class="mh">0x001e1e001e001e1e</span><span class="p">,</span>
	<span class="mh">0x001c1c001c001c1c</span><span class="p">,</span> <span class="mh">0x00f8f800f800f8f8</span><span class="p">,</span> <span class="mh">0x0052520052005252</span><span class="p">,</span>
	<span class="mh">0x0020200020002020</span><span class="p">,</span> <span class="mh">0x0014140014001414</span><span class="p">,</span> <span class="mh">0x00e9e900e900e9e9</span><span class="p">,</span>
	<span class="mh">0x00bdbd00bd00bdbd</span><span class="p">,</span> <span class="mh">0x00dddd00dd00dddd</span><span class="p">,</span> <span class="mh">0x00e4e400e400e4e4</span><span class="p">,</span>
	<span class="mh">0x00a1a100a100a1a1</span><span class="p">,</span> <span class="mh">0x00e0e000e000e0e0</span><span class="p">,</span> <span class="mh">0x008a8a008a008a8a</span><span class="p">,</span>
	<span class="mh">0x00f1f100f100f1f1</span><span class="p">,</span> <span class="mh">0x00d6d600d600d6d6</span><span class="p">,</span> <span class="mh">0x007a7a007a007a7a</span><span class="p">,</span>
	<span class="mh">0x00bbbb00bb00bbbb</span><span class="p">,</span> <span class="mh">0x00e3e300e300e3e3</span><span class="p">,</span> <span class="mh">0x0040400040004040</span><span class="p">,</span>
	<span class="mh">0x004f4f004f004f4f</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp00444404</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0000707070700070</span><span class="p">,</span> <span class="mh">0x00002c2c2c2c002c</span><span class="p">,</span> <span class="mh">0x0000b3b3b3b300b3</span><span class="p">,</span>
	<span class="mh">0x0000c0c0c0c000c0</span><span class="p">,</span> <span class="mh">0x0000e4e4e4e400e4</span><span class="p">,</span> <span class="mh">0x0000575757570057</span><span class="p">,</span>
	<span class="mh">0x0000eaeaeaea00ea</span><span class="p">,</span> <span class="mh">0x0000aeaeaeae00ae</span><span class="p">,</span> <span class="mh">0x0000232323230023</span><span class="p">,</span>
	<span class="mh">0x00006b6b6b6b006b</span><span class="p">,</span> <span class="mh">0x0000454545450045</span><span class="p">,</span> <span class="mh">0x0000a5a5a5a500a5</span><span class="p">,</span>
	<span class="mh">0x0000edededed00ed</span><span class="p">,</span> <span class="mh">0x00004f4f4f4f004f</span><span class="p">,</span> <span class="mh">0x00001d1d1d1d001d</span><span class="p">,</span>
	<span class="mh">0x0000929292920092</span><span class="p">,</span> <span class="mh">0x0000868686860086</span><span class="p">,</span> <span class="mh">0x0000afafafaf00af</span><span class="p">,</span>
	<span class="mh">0x00007c7c7c7c007c</span><span class="p">,</span> <span class="mh">0x00001f1f1f1f001f</span><span class="p">,</span> <span class="mh">0x00003e3e3e3e003e</span><span class="p">,</span>
	<span class="mh">0x0000dcdcdcdc00dc</span><span class="p">,</span> <span class="mh">0x00005e5e5e5e005e</span><span class="p">,</span> <span class="mh">0x00000b0b0b0b000b</span><span class="p">,</span>
	<span class="mh">0x0000a6a6a6a600a6</span><span class="p">,</span> <span class="mh">0x0000393939390039</span><span class="p">,</span> <span class="mh">0x0000d5d5d5d500d5</span><span class="p">,</span>
	<span class="mh">0x00005d5d5d5d005d</span><span class="p">,</span> <span class="mh">0x0000d9d9d9d900d9</span><span class="p">,</span> <span class="mh">0x00005a5a5a5a005a</span><span class="p">,</span>
	<span class="mh">0x0000515151510051</span><span class="p">,</span> <span class="mh">0x00006c6c6c6c006c</span><span class="p">,</span> <span class="mh">0x00008b8b8b8b008b</span><span class="p">,</span>
	<span class="mh">0x00009a9a9a9a009a</span><span class="p">,</span> <span class="mh">0x0000fbfbfbfb00fb</span><span class="p">,</span> <span class="mh">0x0000b0b0b0b000b0</span><span class="p">,</span>
	<span class="mh">0x0000747474740074</span><span class="p">,</span> <span class="mh">0x00002b2b2b2b002b</span><span class="p">,</span> <span class="mh">0x0000f0f0f0f000f0</span><span class="p">,</span>
	<span class="mh">0x0000848484840084</span><span class="p">,</span> <span class="mh">0x0000dfdfdfdf00df</span><span class="p">,</span> <span class="mh">0x0000cbcbcbcb00cb</span><span class="p">,</span>
	<span class="mh">0x0000343434340034</span><span class="p">,</span> <span class="mh">0x0000767676760076</span><span class="p">,</span> <span class="mh">0x00006d6d6d6d006d</span><span class="p">,</span>
	<span class="mh">0x0000a9a9a9a900a9</span><span class="p">,</span> <span class="mh">0x0000d1d1d1d100d1</span><span class="p">,</span> <span class="mh">0x0000040404040004</span><span class="p">,</span>
	<span class="mh">0x0000141414140014</span><span class="p">,</span> <span class="mh">0x00003a3a3a3a003a</span><span class="p">,</span> <span class="mh">0x0000dededede00de</span><span class="p">,</span>
	<span class="mh">0x0000111111110011</span><span class="p">,</span> <span class="mh">0x0000323232320032</span><span class="p">,</span> <span class="mh">0x00009c9c9c9c009c</span><span class="p">,</span>
	<span class="mh">0x0000535353530053</span><span class="p">,</span> <span class="mh">0x0000f2f2f2f200f2</span><span class="p">,</span> <span class="mh">0x0000fefefefe00fe</span><span class="p">,</span>
	<span class="mh">0x0000cfcfcfcf00cf</span><span class="p">,</span> <span class="mh">0x0000c3c3c3c300c3</span><span class="p">,</span> <span class="mh">0x00007a7a7a7a007a</span><span class="p">,</span>
	<span class="mh">0x0000242424240024</span><span class="p">,</span> <span class="mh">0x0000e8e8e8e800e8</span><span class="p">,</span> <span class="mh">0x0000606060600060</span><span class="p">,</span>
	<span class="mh">0x0000696969690069</span><span class="p">,</span> <span class="mh">0x0000aaaaaaaa00aa</span><span class="p">,</span> <span class="mh">0x0000a0a0a0a000a0</span><span class="p">,</span>
	<span class="mh">0x0000a1a1a1a100a1</span><span class="p">,</span> <span class="mh">0x0000626262620062</span><span class="p">,</span> <span class="mh">0x0000545454540054</span><span class="p">,</span>
	<span class="mh">0x00001e1e1e1e001e</span><span class="p">,</span> <span class="mh">0x0000e0e0e0e000e0</span><span class="p">,</span> <span class="mh">0x0000646464640064</span><span class="p">,</span>
	<span class="mh">0x0000101010100010</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span> <span class="mh">0x0000a3a3a3a300a3</span><span class="p">,</span>
	<span class="mh">0x0000757575750075</span><span class="p">,</span> <span class="mh">0x00008a8a8a8a008a</span><span class="p">,</span> <span class="mh">0x0000e6e6e6e600e6</span><span class="p">,</span>
	<span class="mh">0x0000090909090009</span><span class="p">,</span> <span class="mh">0x0000dddddddd00dd</span><span class="p">,</span> <span class="mh">0x0000878787870087</span><span class="p">,</span>
	<span class="mh">0x0000838383830083</span><span class="p">,</span> <span class="mh">0x0000cdcdcdcd00cd</span><span class="p">,</span> <span class="mh">0x0000909090900090</span><span class="p">,</span>
	<span class="mh">0x0000737373730073</span><span class="p">,</span> <span class="mh">0x0000f6f6f6f600f6</span><span class="p">,</span> <span class="mh">0x00009d9d9d9d009d</span><span class="p">,</span>
	<span class="mh">0x0000bfbfbfbf00bf</span><span class="p">,</span> <span class="mh">0x0000525252520052</span><span class="p">,</span> <span class="mh">0x0000d8d8d8d800d8</span><span class="p">,</span>
	<span class="mh">0x0000c8c8c8c800c8</span><span class="p">,</span> <span class="mh">0x0000c6c6c6c600c6</span><span class="p">,</span> <span class="mh">0x0000818181810081</span><span class="p">,</span>
	<span class="mh">0x00006f6f6f6f006f</span><span class="p">,</span> <span class="mh">0x0000131313130013</span><span class="p">,</span> <span class="mh">0x0000636363630063</span><span class="p">,</span>
	<span class="mh">0x0000e9e9e9e900e9</span><span class="p">,</span> <span class="mh">0x0000a7a7a7a700a7</span><span class="p">,</span> <span class="mh">0x00009f9f9f9f009f</span><span class="p">,</span>
	<span class="mh">0x0000bcbcbcbc00bc</span><span class="p">,</span> <span class="mh">0x0000292929290029</span><span class="p">,</span> <span class="mh">0x0000f9f9f9f900f9</span><span class="p">,</span>
	<span class="mh">0x00002f2f2f2f002f</span><span class="p">,</span> <span class="mh">0x0000b4b4b4b400b4</span><span class="p">,</span> <span class="mh">0x0000787878780078</span><span class="p">,</span>
	<span class="mh">0x0000060606060006</span><span class="p">,</span> <span class="mh">0x0000e7e7e7e700e7</span><span class="p">,</span> <span class="mh">0x0000717171710071</span><span class="p">,</span>
	<span class="mh">0x0000d4d4d4d400d4</span><span class="p">,</span> <span class="mh">0x0000abababab00ab</span><span class="p">,</span> <span class="mh">0x0000888888880088</span><span class="p">,</span>
	<span class="mh">0x00008d8d8d8d008d</span><span class="p">,</span> <span class="mh">0x0000727272720072</span><span class="p">,</span> <span class="mh">0x0000b9b9b9b900b9</span><span class="p">,</span>
	<span class="mh">0x0000f8f8f8f800f8</span><span class="p">,</span> <span class="mh">0x0000acacacac00ac</span><span class="p">,</span> <span class="mh">0x0000363636360036</span><span class="p">,</span>
	<span class="mh">0x00002a2a2a2a002a</span><span class="p">,</span> <span class="mh">0x00003c3c3c3c003c</span><span class="p">,</span> <span class="mh">0x0000f1f1f1f100f1</span><span class="p">,</span>
	<span class="mh">0x0000404040400040</span><span class="p">,</span> <span class="mh">0x0000d3d3d3d300d3</span><span class="p">,</span> <span class="mh">0x0000bbbbbbbb00bb</span><span class="p">,</span>
	<span class="mh">0x0000434343430043</span><span class="p">,</span> <span class="mh">0x0000151515150015</span><span class="p">,</span> <span class="mh">0x0000adadadad00ad</span><span class="p">,</span>
	<span class="mh">0x0000777777770077</span><span class="p">,</span> <span class="mh">0x0000808080800080</span><span class="p">,</span> <span class="mh">0x0000828282820082</span><span class="p">,</span>
	<span class="mh">0x0000ecececec00ec</span><span class="p">,</span> <span class="mh">0x0000272727270027</span><span class="p">,</span> <span class="mh">0x0000e5e5e5e500e5</span><span class="p">,</span>
	<span class="mh">0x0000858585850085</span><span class="p">,</span> <span class="mh">0x0000353535350035</span><span class="p">,</span> <span class="mh">0x00000c0c0c0c000c</span><span class="p">,</span>
	<span class="mh">0x0000414141410041</span><span class="p">,</span> <span class="mh">0x0000efefefef00ef</span><span class="p">,</span> <span class="mh">0x0000939393930093</span><span class="p">,</span>
	<span class="mh">0x0000191919190019</span><span class="p">,</span> <span class="mh">0x0000212121210021</span><span class="p">,</span> <span class="mh">0x00000e0e0e0e000e</span><span class="p">,</span>
	<span class="mh">0x00004e4e4e4e004e</span><span class="p">,</span> <span class="mh">0x0000656565650065</span><span class="p">,</span> <span class="mh">0x0000bdbdbdbd00bd</span><span class="p">,</span>
	<span class="mh">0x0000b8b8b8b800b8</span><span class="p">,</span> <span class="mh">0x00008f8f8f8f008f</span><span class="p">,</span> <span class="mh">0x0000ebebebeb00eb</span><span class="p">,</span>
	<span class="mh">0x0000cececece00ce</span><span class="p">,</span> <span class="mh">0x0000303030300030</span><span class="p">,</span> <span class="mh">0x00005f5f5f5f005f</span><span class="p">,</span>
	<span class="mh">0x0000c5c5c5c500c5</span><span class="p">,</span> <span class="mh">0x00001a1a1a1a001a</span><span class="p">,</span> <span class="mh">0x0000e1e1e1e100e1</span><span class="p">,</span>
	<span class="mh">0x0000cacacaca00ca</span><span class="p">,</span> <span class="mh">0x0000474747470047</span><span class="p">,</span> <span class="mh">0x00003d3d3d3d003d</span><span class="p">,</span>
	<span class="mh">0x0000010101010001</span><span class="p">,</span> <span class="mh">0x0000d6d6d6d600d6</span><span class="p">,</span> <span class="mh">0x0000565656560056</span><span class="p">,</span>
	<span class="mh">0x00004d4d4d4d004d</span><span class="p">,</span> <span class="mh">0x00000d0d0d0d000d</span><span class="p">,</span> <span class="mh">0x0000666666660066</span><span class="p">,</span>
	<span class="mh">0x0000cccccccc00cc</span><span class="p">,</span> <span class="mh">0x00002d2d2d2d002d</span><span class="p">,</span> <span class="mh">0x0000121212120012</span><span class="p">,</span>
	<span class="mh">0x0000202020200020</span><span class="p">,</span> <span class="mh">0x0000b1b1b1b100b1</span><span class="p">,</span> <span class="mh">0x0000999999990099</span><span class="p">,</span>
	<span class="mh">0x00004c4c4c4c004c</span><span class="p">,</span> <span class="mh">0x0000c2c2c2c200c2</span><span class="p">,</span> <span class="mh">0x00007e7e7e7e007e</span><span class="p">,</span>
	<span class="mh">0x0000050505050005</span><span class="p">,</span> <span class="mh">0x0000b7b7b7b700b7</span><span class="p">,</span> <span class="mh">0x0000313131310031</span><span class="p">,</span>
	<span class="mh">0x0000171717170017</span><span class="p">,</span> <span class="mh">0x0000d7d7d7d700d7</span><span class="p">,</span> <span class="mh">0x0000585858580058</span><span class="p">,</span>
	<span class="mh">0x0000616161610061</span><span class="p">,</span> <span class="mh">0x00001b1b1b1b001b</span><span class="p">,</span> <span class="mh">0x00001c1c1c1c001c</span><span class="p">,</span>
	<span class="mh">0x00000f0f0f0f000f</span><span class="p">,</span> <span class="mh">0x0000161616160016</span><span class="p">,</span> <span class="mh">0x0000181818180018</span><span class="p">,</span>
	<span class="mh">0x0000222222220022</span><span class="p">,</span> <span class="mh">0x0000444444440044</span><span class="p">,</span> <span class="mh">0x0000b2b2b2b200b2</span><span class="p">,</span>
	<span class="mh">0x0000b5b5b5b500b5</span><span class="p">,</span> <span class="mh">0x0000919191910091</span><span class="p">,</span> <span class="mh">0x0000080808080008</span><span class="p">,</span>
	<span class="mh">0x0000a8a8a8a800a8</span><span class="p">,</span> <span class="mh">0x0000fcfcfcfc00fc</span><span class="p">,</span> <span class="mh">0x0000505050500050</span><span class="p">,</span>
	<span class="mh">0x0000d0d0d0d000d0</span><span class="p">,</span> <span class="mh">0x00007d7d7d7d007d</span><span class="p">,</span> <span class="mh">0x0000898989890089</span><span class="p">,</span>
	<span class="mh">0x0000979797970097</span><span class="p">,</span> <span class="mh">0x00005b5b5b5b005b</span><span class="p">,</span> <span class="mh">0x0000959595950095</span><span class="p">,</span>
	<span class="mh">0x0000ffffffff00ff</span><span class="p">,</span> <span class="mh">0x0000d2d2d2d200d2</span><span class="p">,</span> <span class="mh">0x0000c4c4c4c400c4</span><span class="p">,</span>
	<span class="mh">0x0000484848480048</span><span class="p">,</span> <span class="mh">0x0000f7f7f7f700f7</span><span class="p">,</span> <span class="mh">0x0000dbdbdbdb00db</span><span class="p">,</span>
	<span class="mh">0x0000030303030003</span><span class="p">,</span> <span class="mh">0x0000dadadada00da</span><span class="p">,</span> <span class="mh">0x00003f3f3f3f003f</span><span class="p">,</span>
	<span class="mh">0x0000949494940094</span><span class="p">,</span> <span class="mh">0x00005c5c5c5c005c</span><span class="p">,</span> <span class="mh">0x0000020202020002</span><span class="p">,</span>
	<span class="mh">0x00004a4a4a4a004a</span><span class="p">,</span> <span class="mh">0x0000333333330033</span><span class="p">,</span> <span class="mh">0x0000676767670067</span><span class="p">,</span>
	<span class="mh">0x0000f3f3f3f300f3</span><span class="p">,</span> <span class="mh">0x00007f7f7f7f007f</span><span class="p">,</span> <span class="mh">0x0000e2e2e2e200e2</span><span class="p">,</span>
	<span class="mh">0x00009b9b9b9b009b</span><span class="p">,</span> <span class="mh">0x0000262626260026</span><span class="p">,</span> <span class="mh">0x0000373737370037</span><span class="p">,</span>
	<span class="mh">0x00003b3b3b3b003b</span><span class="p">,</span> <span class="mh">0x0000969696960096</span><span class="p">,</span> <span class="mh">0x00004b4b4b4b004b</span><span class="p">,</span>
	<span class="mh">0x0000bebebebe00be</span><span class="p">,</span> <span class="mh">0x00002e2e2e2e002e</span><span class="p">,</span> <span class="mh">0x0000797979790079</span><span class="p">,</span>
	<span class="mh">0x00008c8c8c8c008c</span><span class="p">,</span> <span class="mh">0x00006e6e6e6e006e</span><span class="p">,</span> <span class="mh">0x00008e8e8e8e008e</span><span class="p">,</span>
	<span class="mh">0x0000f5f5f5f500f5</span><span class="p">,</span> <span class="mh">0x0000b6b6b6b600b6</span><span class="p">,</span> <span class="mh">0x0000fdfdfdfd00fd</span><span class="p">,</span>
	<span class="mh">0x0000595959590059</span><span class="p">,</span> <span class="mh">0x0000989898980098</span><span class="p">,</span> <span class="mh">0x00006a6a6a6a006a</span><span class="p">,</span>
	<span class="mh">0x0000464646460046</span><span class="p">,</span> <span class="mh">0x0000babababa00ba</span><span class="p">,</span> <span class="mh">0x0000252525250025</span><span class="p">,</span>
	<span class="mh">0x0000424242420042</span><span class="p">,</span> <span class="mh">0x0000a2a2a2a200a2</span><span class="p">,</span> <span class="mh">0x0000fafafafa00fa</span><span class="p">,</span>
	<span class="mh">0x0000070707070007</span><span class="p">,</span> <span class="mh">0x0000555555550055</span><span class="p">,</span> <span class="mh">0x0000eeeeeeee00ee</span><span class="p">,</span>
	<span class="mh">0x00000a0a0a0a000a</span><span class="p">,</span> <span class="mh">0x0000494949490049</span><span class="p">,</span> <span class="mh">0x0000686868680068</span><span class="p">,</span>
	<span class="mh">0x0000383838380038</span><span class="p">,</span> <span class="mh">0x0000a4a4a4a400a4</span><span class="p">,</span> <span class="mh">0x0000282828280028</span><span class="p">,</span>
	<span class="mh">0x00007b7b7b7b007b</span><span class="p">,</span> <span class="mh">0x0000c9c9c9c900c9</span><span class="p">,</span> <span class="mh">0x0000c1c1c1c100c1</span><span class="p">,</span>
	<span class="mh">0x0000e3e3e3e300e3</span><span class="p">,</span> <span class="mh">0x0000f4f4f4f400f4</span><span class="p">,</span> <span class="mh">0x0000c7c7c7c700c7</span><span class="p">,</span>
	<span class="mh">0x00009e9e9e9e009e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp02220222</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x00e0e0e000e0e0e0</span><span class="p">,</span> <span class="mh">0x0005050500050505</span><span class="p">,</span> <span class="mh">0x0058585800585858</span><span class="p">,</span>
	<span class="mh">0x00d9d9d900d9d9d9</span><span class="p">,</span> <span class="mh">0x0067676700676767</span><span class="p">,</span> <span class="mh">0x004e4e4e004e4e4e</span><span class="p">,</span>
	<span class="mh">0x0081818100818181</span><span class="p">,</span> <span class="mh">0x00cbcbcb00cbcbcb</span><span class="p">,</span> <span class="mh">0x00c9c9c900c9c9c9</span><span class="p">,</span>
	<span class="mh">0x000b0b0b000b0b0b</span><span class="p">,</span> <span class="mh">0x00aeaeae00aeaeae</span><span class="p">,</span> <span class="mh">0x006a6a6a006a6a6a</span><span class="p">,</span>
	<span class="mh">0x00d5d5d500d5d5d5</span><span class="p">,</span> <span class="mh">0x0018181800181818</span><span class="p">,</span> <span class="mh">0x005d5d5d005d5d5d</span><span class="p">,</span>
	<span class="mh">0x0082828200828282</span><span class="p">,</span> <span class="mh">0x0046464600464646</span><span class="p">,</span> <span class="mh">0x00dfdfdf00dfdfdf</span><span class="p">,</span>
	<span class="mh">0x00d6d6d600d6d6d6</span><span class="p">,</span> <span class="mh">0x0027272700272727</span><span class="p">,</span> <span class="mh">0x008a8a8a008a8a8a</span><span class="p">,</span>
	<span class="mh">0x0032323200323232</span><span class="p">,</span> <span class="mh">0x004b4b4b004b4b4b</span><span class="p">,</span> <span class="mh">0x0042424200424242</span><span class="p">,</span>
	<span class="mh">0x00dbdbdb00dbdbdb</span><span class="p">,</span> <span class="mh">0x001c1c1c001c1c1c</span><span class="p">,</span> <span class="mh">0x009e9e9e009e9e9e</span><span class="p">,</span>
	<span class="mh">0x009c9c9c009c9c9c</span><span class="p">,</span> <span class="mh">0x003a3a3a003a3a3a</span><span class="p">,</span> <span class="mh">0x00cacaca00cacaca</span><span class="p">,</span>
	<span class="mh">0x0025252500252525</span><span class="p">,</span> <span class="mh">0x007b7b7b007b7b7b</span><span class="p">,</span> <span class="mh">0x000d0d0d000d0d0d</span><span class="p">,</span>
	<span class="mh">0x0071717100717171</span><span class="p">,</span> <span class="mh">0x005f5f5f005f5f5f</span><span class="p">,</span> <span class="mh">0x001f1f1f001f1f1f</span><span class="p">,</span>
	<span class="mh">0x00f8f8f800f8f8f8</span><span class="p">,</span> <span class="mh">0x00d7d7d700d7d7d7</span><span class="p">,</span> <span class="mh">0x003e3e3e003e3e3e</span><span class="p">,</span>
	<span class="mh">0x009d9d9d009d9d9d</span><span class="p">,</span> <span class="mh">0x007c7c7c007c7c7c</span><span class="p">,</span> <span class="mh">0x0060606000606060</span><span class="p">,</span>
	<span class="mh">0x00b9b9b900b9b9b9</span><span class="p">,</span> <span class="mh">0x00bebebe00bebebe</span><span class="p">,</span> <span class="mh">0x00bcbcbc00bcbcbc</span><span class="p">,</span>
	<span class="mh">0x008b8b8b008b8b8b</span><span class="p">,</span> <span class="mh">0x0016161600161616</span><span class="p">,</span> <span class="mh">0x0034343400343434</span><span class="p">,</span>
	<span class="mh">0x004d4d4d004d4d4d</span><span class="p">,</span> <span class="mh">0x00c3c3c300c3c3c3</span><span class="p">,</span> <span class="mh">0x0072727200727272</span><span class="p">,</span>
	<span class="mh">0x0095959500959595</span><span class="p">,</span> <span class="mh">0x00ababab00ababab</span><span class="p">,</span> <span class="mh">0x008e8e8e008e8e8e</span><span class="p">,</span>
	<span class="mh">0x00bababa00bababa</span><span class="p">,</span> <span class="mh">0x007a7a7a007a7a7a</span><span class="p">,</span> <span class="mh">0x00b3b3b300b3b3b3</span><span class="p">,</span>
	<span class="mh">0x0002020200020202</span><span class="p">,</span> <span class="mh">0x00b4b4b400b4b4b4</span><span class="p">,</span> <span class="mh">0x00adadad00adadad</span><span class="p">,</span>
	<span class="mh">0x00a2a2a200a2a2a2</span><span class="p">,</span> <span class="mh">0x00acacac00acacac</span><span class="p">,</span> <span class="mh">0x00d8d8d800d8d8d8</span><span class="p">,</span>
	<span class="mh">0x009a9a9a009a9a9a</span><span class="p">,</span> <span class="mh">0x0017171700171717</span><span class="p">,</span> <span class="mh">0x001a1a1a001a1a1a</span><span class="p">,</span>
	<span class="mh">0x0035353500353535</span><span class="p">,</span> <span class="mh">0x00cccccc00cccccc</span><span class="p">,</span> <span class="mh">0x00f7f7f700f7f7f7</span><span class="p">,</span>
	<span class="mh">0x0099999900999999</span><span class="p">,</span> <span class="mh">0x0061616100616161</span><span class="p">,</span> <span class="mh">0x005a5a5a005a5a5a</span><span class="p">,</span>
	<span class="mh">0x00e8e8e800e8e8e8</span><span class="p">,</span> <span class="mh">0x0024242400242424</span><span class="p">,</span> <span class="mh">0x0056565600565656</span><span class="p">,</span>
	<span class="mh">0x0040404000404040</span><span class="p">,</span> <span class="mh">0x00e1e1e100e1e1e1</span><span class="p">,</span> <span class="mh">0x0063636300636363</span><span class="p">,</span>
	<span class="mh">0x0009090900090909</span><span class="p">,</span> <span class="mh">0x0033333300333333</span><span class="p">,</span> <span class="mh">0x00bfbfbf00bfbfbf</span><span class="p">,</span>
	<span class="mh">0x0098989800989898</span><span class="p">,</span> <span class="mh">0x0097979700979797</span><span class="p">,</span> <span class="mh">0x0085858500858585</span><span class="p">,</span>
	<span class="mh">0x0068686800686868</span><span class="p">,</span> <span class="mh">0x00fcfcfc00fcfcfc</span><span class="p">,</span> <span class="mh">0x00ececec00ececec</span><span class="p">,</span>
	<span class="mh">0x000a0a0a000a0a0a</span><span class="p">,</span> <span class="mh">0x00dadada00dadada</span><span class="p">,</span> <span class="mh">0x006f6f6f006f6f6f</span><span class="p">,</span>
	<span class="mh">0x0053535300535353</span><span class="p">,</span> <span class="mh">0x0062626200626262</span><span class="p">,</span> <span class="mh">0x00a3a3a300a3a3a3</span><span class="p">,</span>
	<span class="mh">0x002e2e2e002e2e2e</span><span class="p">,</span> <span class="mh">0x0008080800080808</span><span class="p">,</span> <span class="mh">0x00afafaf00afafaf</span><span class="p">,</span>
	<span class="mh">0x0028282800282828</span><span class="p">,</span> <span class="mh">0x00b0b0b000b0b0b0</span><span class="p">,</span> <span class="mh">0x0074747400747474</span><span class="p">,</span>
	<span class="mh">0x00c2c2c200c2c2c2</span><span class="p">,</span> <span class="mh">0x00bdbdbd00bdbdbd</span><span class="p">,</span> <span class="mh">0x0036363600363636</span><span class="p">,</span>
	<span class="mh">0x0022222200222222</span><span class="p">,</span> <span class="mh">0x0038383800383838</span><span class="p">,</span> <span class="mh">0x0064646400646464</span><span class="p">,</span>
	<span class="mh">0x001e1e1e001e1e1e</span><span class="p">,</span> <span class="mh">0x0039393900393939</span><span class="p">,</span> <span class="mh">0x002c2c2c002c2c2c</span><span class="p">,</span>
	<span class="mh">0x00a6a6a600a6a6a6</span><span class="p">,</span> <span class="mh">0x0030303000303030</span><span class="p">,</span> <span class="mh">0x00e5e5e500e5e5e5</span><span class="p">,</span>
	<span class="mh">0x0044444400444444</span><span class="p">,</span> <span class="mh">0x00fdfdfd00fdfdfd</span><span class="p">,</span> <span class="mh">0x0088888800888888</span><span class="p">,</span>
	<span class="mh">0x009f9f9f009f9f9f</span><span class="p">,</span> <span class="mh">0x0065656500656565</span><span class="p">,</span> <span class="mh">0x0087878700878787</span><span class="p">,</span>
	<span class="mh">0x006b6b6b006b6b6b</span><span class="p">,</span> <span class="mh">0x00f4f4f400f4f4f4</span><span class="p">,</span> <span class="mh">0x0023232300232323</span><span class="p">,</span>
	<span class="mh">0x0048484800484848</span><span class="p">,</span> <span class="mh">0x0010101000101010</span><span class="p">,</span> <span class="mh">0x00d1d1d100d1d1d1</span><span class="p">,</span>
	<span class="mh">0x0051515100515151</span><span class="p">,</span> <span class="mh">0x00c0c0c000c0c0c0</span><span class="p">,</span> <span class="mh">0x00f9f9f900f9f9f9</span><span class="p">,</span>
	<span class="mh">0x00d2d2d200d2d2d2</span><span class="p">,</span> <span class="mh">0x00a0a0a000a0a0a0</span><span class="p">,</span> <span class="mh">0x0055555500555555</span><span class="p">,</span>
	<span class="mh">0x00a1a1a100a1a1a1</span><span class="p">,</span> <span class="mh">0x0041414100414141</span><span class="p">,</span> <span class="mh">0x00fafafa00fafafa</span><span class="p">,</span>
	<span class="mh">0x0043434300434343</span><span class="p">,</span> <span class="mh">0x0013131300131313</span><span class="p">,</span> <span class="mh">0x00c4c4c400c4c4c4</span><span class="p">,</span>
	<span class="mh">0x002f2f2f002f2f2f</span><span class="p">,</span> <span class="mh">0x00a8a8a800a8a8a8</span><span class="p">,</span> <span class="mh">0x00b6b6b600b6b6b6</span><span class="p">,</span>
	<span class="mh">0x003c3c3c003c3c3c</span><span class="p">,</span> <span class="mh">0x002b2b2b002b2b2b</span><span class="p">,</span> <span class="mh">0x00c1c1c100c1c1c1</span><span class="p">,</span>
	<span class="mh">0x00ffffff00ffffff</span><span class="p">,</span> <span class="mh">0x00c8c8c800c8c8c8</span><span class="p">,</span> <span class="mh">0x00a5a5a500a5a5a5</span><span class="p">,</span>
	<span class="mh">0x0020202000202020</span><span class="p">,</span> <span class="mh">0x0089898900898989</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span>
	<span class="mh">0x0090909000909090</span><span class="p">,</span> <span class="mh">0x0047474700474747</span><span class="p">,</span> <span class="mh">0x00efefef00efefef</span><span class="p">,</span>
	<span class="mh">0x00eaeaea00eaeaea</span><span class="p">,</span> <span class="mh">0x00b7b7b700b7b7b7</span><span class="p">,</span> <span class="mh">0x0015151500151515</span><span class="p">,</span>
	<span class="mh">0x0006060600060606</span><span class="p">,</span> <span class="mh">0x00cdcdcd00cdcdcd</span><span class="p">,</span> <span class="mh">0x00b5b5b500b5b5b5</span><span class="p">,</span>
	<span class="mh">0x0012121200121212</span><span class="p">,</span> <span class="mh">0x007e7e7e007e7e7e</span><span class="p">,</span> <span class="mh">0x00bbbbbb00bbbbbb</span><span class="p">,</span>
	<span class="mh">0x0029292900292929</span><span class="p">,</span> <span class="mh">0x000f0f0f000f0f0f</span><span class="p">,</span> <span class="mh">0x00b8b8b800b8b8b8</span><span class="p">,</span>
	<span class="mh">0x0007070700070707</span><span class="p">,</span> <span class="mh">0x0004040400040404</span><span class="p">,</span> <span class="mh">0x009b9b9b009b9b9b</span><span class="p">,</span>
	<span class="mh">0x0094949400949494</span><span class="p">,</span> <span class="mh">0x0021212100212121</span><span class="p">,</span> <span class="mh">0x0066666600666666</span><span class="p">,</span>
	<span class="mh">0x00e6e6e600e6e6e6</span><span class="p">,</span> <span class="mh">0x00cecece00cecece</span><span class="p">,</span> <span class="mh">0x00ededed00ededed</span><span class="p">,</span>
	<span class="mh">0x00e7e7e700e7e7e7</span><span class="p">,</span> <span class="mh">0x003b3b3b003b3b3b</span><span class="p">,</span> <span class="mh">0x00fefefe00fefefe</span><span class="p">,</span>
	<span class="mh">0x007f7f7f007f7f7f</span><span class="p">,</span> <span class="mh">0x00c5c5c500c5c5c5</span><span class="p">,</span> <span class="mh">0x00a4a4a400a4a4a4</span><span class="p">,</span>
	<span class="mh">0x0037373700373737</span><span class="p">,</span> <span class="mh">0x00b1b1b100b1b1b1</span><span class="p">,</span> <span class="mh">0x004c4c4c004c4c4c</span><span class="p">,</span>
	<span class="mh">0x0091919100919191</span><span class="p">,</span> <span class="mh">0x006e6e6e006e6e6e</span><span class="p">,</span> <span class="mh">0x008d8d8d008d8d8d</span><span class="p">,</span>
	<span class="mh">0x0076767600767676</span><span class="p">,</span> <span class="mh">0x0003030300030303</span><span class="p">,</span> <span class="mh">0x002d2d2d002d2d2d</span><span class="p">,</span>
	<span class="mh">0x00dedede00dedede</span><span class="p">,</span> <span class="mh">0x0096969600969696</span><span class="p">,</span> <span class="mh">0x0026262600262626</span><span class="p">,</span>
	<span class="mh">0x007d7d7d007d7d7d</span><span class="p">,</span> <span class="mh">0x00c6c6c600c6c6c6</span><span class="p">,</span> <span class="mh">0x005c5c5c005c5c5c</span><span class="p">,</span>
	<span class="mh">0x00d3d3d300d3d3d3</span><span class="p">,</span> <span class="mh">0x00f2f2f200f2f2f2</span><span class="p">,</span> <span class="mh">0x004f4f4f004f4f4f</span><span class="p">,</span>
	<span class="mh">0x0019191900191919</span><span class="p">,</span> <span class="mh">0x003f3f3f003f3f3f</span><span class="p">,</span> <span class="mh">0x00dcdcdc00dcdcdc</span><span class="p">,</span>
	<span class="mh">0x0079797900797979</span><span class="p">,</span> <span class="mh">0x001d1d1d001d1d1d</span><span class="p">,</span> <span class="mh">0x0052525200525252</span><span class="p">,</span>
	<span class="mh">0x00ebebeb00ebebeb</span><span class="p">,</span> <span class="mh">0x00f3f3f300f3f3f3</span><span class="p">,</span> <span class="mh">0x006d6d6d006d6d6d</span><span class="p">,</span>
	<span class="mh">0x005e5e5e005e5e5e</span><span class="p">,</span> <span class="mh">0x00fbfbfb00fbfbfb</span><span class="p">,</span> <span class="mh">0x0069696900696969</span><span class="p">,</span>
	<span class="mh">0x00b2b2b200b2b2b2</span><span class="p">,</span> <span class="mh">0x00f0f0f000f0f0f0</span><span class="p">,</span> <span class="mh">0x0031313100313131</span><span class="p">,</span>
	<span class="mh">0x000c0c0c000c0c0c</span><span class="p">,</span> <span class="mh">0x00d4d4d400d4d4d4</span><span class="p">,</span> <span class="mh">0x00cfcfcf00cfcfcf</span><span class="p">,</span>
	<span class="mh">0x008c8c8c008c8c8c</span><span class="p">,</span> <span class="mh">0x00e2e2e200e2e2e2</span><span class="p">,</span> <span class="mh">0x0075757500757575</span><span class="p">,</span>
	<span class="mh">0x00a9a9a900a9a9a9</span><span class="p">,</span> <span class="mh">0x004a4a4a004a4a4a</span><span class="p">,</span> <span class="mh">0x0057575700575757</span><span class="p">,</span>
	<span class="mh">0x0084848400848484</span><span class="p">,</span> <span class="mh">0x0011111100111111</span><span class="p">,</span> <span class="mh">0x0045454500454545</span><span class="p">,</span>
	<span class="mh">0x001b1b1b001b1b1b</span><span class="p">,</span> <span class="mh">0x00f5f5f500f5f5f5</span><span class="p">,</span> <span class="mh">0x00e4e4e400e4e4e4</span><span class="p">,</span>
	<span class="mh">0x000e0e0e000e0e0e</span><span class="p">,</span> <span class="mh">0x0073737300737373</span><span class="p">,</span> <span class="mh">0x00aaaaaa00aaaaaa</span><span class="p">,</span>
	<span class="mh">0x00f1f1f100f1f1f1</span><span class="p">,</span> <span class="mh">0x00dddddd00dddddd</span><span class="p">,</span> <span class="mh">0x0059595900595959</span><span class="p">,</span>
	<span class="mh">0x0014141400141414</span><span class="p">,</span> <span class="mh">0x006c6c6c006c6c6c</span><span class="p">,</span> <span class="mh">0x0092929200929292</span><span class="p">,</span>
	<span class="mh">0x0054545400545454</span><span class="p">,</span> <span class="mh">0x00d0d0d000d0d0d0</span><span class="p">,</span> <span class="mh">0x0078787800787878</span><span class="p">,</span>
	<span class="mh">0x0070707000707070</span><span class="p">,</span> <span class="mh">0x00e3e3e300e3e3e3</span><span class="p">,</span> <span class="mh">0x0049494900494949</span><span class="p">,</span>
	<span class="mh">0x0080808000808080</span><span class="p">,</span> <span class="mh">0x0050505000505050</span><span class="p">,</span> <span class="mh">0x00a7a7a700a7a7a7</span><span class="p">,</span>
	<span class="mh">0x00f6f6f600f6f6f6</span><span class="p">,</span> <span class="mh">0x0077777700777777</span><span class="p">,</span> <span class="mh">0x0093939300939393</span><span class="p">,</span>
	<span class="mh">0x0086868600868686</span><span class="p">,</span> <span class="mh">0x0083838300838383</span><span class="p">,</span> <span class="mh">0x002a2a2a002a2a2a</span><span class="p">,</span>
	<span class="mh">0x00c7c7c700c7c7c7</span><span class="p">,</span> <span class="mh">0x005b5b5b005b5b5b</span><span class="p">,</span> <span class="mh">0x00e9e9e900e9e9e9</span><span class="p">,</span>
	<span class="mh">0x00eeeeee00eeeeee</span><span class="p">,</span> <span class="mh">0x008f8f8f008f8f8f</span><span class="p">,</span> <span class="mh">0x0001010100010101</span><span class="p">,</span>
	<span class="mh">0x003d3d3d003d3d3d</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp30333033</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x3800383838003838</span><span class="p">,</span> <span class="mh">0x4100414141004141</span><span class="p">,</span> <span class="mh">0x1600161616001616</span><span class="p">,</span>
	<span class="mh">0x7600767676007676</span><span class="p">,</span> <span class="mh">0xd900d9d9d900d9d9</span><span class="p">,</span> <span class="mh">0x9300939393009393</span><span class="p">,</span>
	<span class="mh">0x6000606060006060</span><span class="p">,</span> <span class="mh">0xf200f2f2f200f2f2</span><span class="p">,</span> <span class="mh">0x7200727272007272</span><span class="p">,</span>
	<span class="mh">0xc200c2c2c200c2c2</span><span class="p">,</span> <span class="mh">0xab00ababab00abab</span><span class="p">,</span> <span class="mh">0x9a009a9a9a009a9a</span><span class="p">,</span>
	<span class="mh">0x7500757575007575</span><span class="p">,</span> <span class="mh">0x0600060606000606</span><span class="p">,</span> <span class="mh">0x5700575757005757</span><span class="p">,</span>
	<span class="mh">0xa000a0a0a000a0a0</span><span class="p">,</span> <span class="mh">0x9100919191009191</span><span class="p">,</span> <span class="mh">0xf700f7f7f700f7f7</span><span class="p">,</span>
	<span class="mh">0xb500b5b5b500b5b5</span><span class="p">,</span> <span class="mh">0xc900c9c9c900c9c9</span><span class="p">,</span> <span class="mh">0xa200a2a2a200a2a2</span><span class="p">,</span>
	<span class="mh">0x8c008c8c8c008c8c</span><span class="p">,</span> <span class="mh">0xd200d2d2d200d2d2</span><span class="p">,</span> <span class="mh">0x9000909090009090</span><span class="p">,</span>
	<span class="mh">0xf600f6f6f600f6f6</span><span class="p">,</span> <span class="mh">0x0700070707000707</span><span class="p">,</span> <span class="mh">0xa700a7a7a700a7a7</span><span class="p">,</span>
	<span class="mh">0x2700272727002727</span><span class="p">,</span> <span class="mh">0x8e008e8e8e008e8e</span><span class="p">,</span> <span class="mh">0xb200b2b2b200b2b2</span><span class="p">,</span>
	<span class="mh">0x4900494949004949</span><span class="p">,</span> <span class="mh">0xde00dedede00dede</span><span class="p">,</span> <span class="mh">0x4300434343004343</span><span class="p">,</span>
	<span class="mh">0x5c005c5c5c005c5c</span><span class="p">,</span> <span class="mh">0xd700d7d7d700d7d7</span><span class="p">,</span> <span class="mh">0xc700c7c7c700c7c7</span><span class="p">,</span>
	<span class="mh">0x3e003e3e3e003e3e</span><span class="p">,</span> <span class="mh">0xf500f5f5f500f5f5</span><span class="p">,</span> <span class="mh">0x8f008f8f8f008f8f</span><span class="p">,</span>
	<span class="mh">0x6700676767006767</span><span class="p">,</span> <span class="mh">0x1f001f1f1f001f1f</span><span class="p">,</span> <span class="mh">0x1800181818001818</span><span class="p">,</span>
	<span class="mh">0x6e006e6e6e006e6e</span><span class="p">,</span> <span class="mh">0xaf00afafaf00afaf</span><span class="p">,</span> <span class="mh">0x2f002f2f2f002f2f</span><span class="p">,</span>
	<span class="mh">0xe200e2e2e200e2e2</span><span class="p">,</span> <span class="mh">0x8500858585008585</span><span class="p">,</span> <span class="mh">0x0d000d0d0d000d0d</span><span class="p">,</span>
	<span class="mh">0x5300535353005353</span><span class="p">,</span> <span class="mh">0xf000f0f0f000f0f0</span><span class="p">,</span> <span class="mh">0x9c009c9c9c009c9c</span><span class="p">,</span>
	<span class="mh">0x6500656565006565</span><span class="p">,</span> <span class="mh">0xea00eaeaea00eaea</span><span class="p">,</span> <span class="mh">0xa300a3a3a300a3a3</span><span class="p">,</span>
	<span class="mh">0xae00aeaeae00aeae</span><span class="p">,</span> <span class="mh">0x9e009e9e9e009e9e</span><span class="p">,</span> <span class="mh">0xec00ececec00ecec</span><span class="p">,</span>
	<span class="mh">0x8000808080008080</span><span class="p">,</span> <span class="mh">0x2d002d2d2d002d2d</span><span class="p">,</span> <span class="mh">0x6b006b6b6b006b6b</span><span class="p">,</span>
	<span class="mh">0xa800a8a8a800a8a8</span><span class="p">,</span> <span class="mh">0x2b002b2b2b002b2b</span><span class="p">,</span> <span class="mh">0x3600363636003636</span><span class="p">,</span>
	<span class="mh">0xa600a6a6a600a6a6</span><span class="p">,</span> <span class="mh">0xc500c5c5c500c5c5</span><span class="p">,</span> <span class="mh">0x8600868686008686</span><span class="p">,</span>
	<span class="mh">0x4d004d4d4d004d4d</span><span class="p">,</span> <span class="mh">0x3300333333003333</span><span class="p">,</span> <span class="mh">0xfd00fdfdfd00fdfd</span><span class="p">,</span>
	<span class="mh">0x6600666666006666</span><span class="p">,</span> <span class="mh">0x5800585858005858</span><span class="p">,</span> <span class="mh">0x9600969696009696</span><span class="p">,</span>
	<span class="mh">0x3a003a3a3a003a3a</span><span class="p">,</span> <span class="mh">0x0900090909000909</span><span class="p">,</span> <span class="mh">0x9500959595009595</span><span class="p">,</span>
	<span class="mh">0x1000101010001010</span><span class="p">,</span> <span class="mh">0x7800787878007878</span><span class="p">,</span> <span class="mh">0xd800d8d8d800d8d8</span><span class="p">,</span>
	<span class="mh">0x4200424242004242</span><span class="p">,</span> <span class="mh">0xcc00cccccc00cccc</span><span class="p">,</span> <span class="mh">0xef00efefef00efef</span><span class="p">,</span>
	<span class="mh">0x2600262626002626</span><span class="p">,</span> <span class="mh">0xe500e5e5e500e5e5</span><span class="p">,</span> <span class="mh">0x6100616161006161</span><span class="p">,</span>
	<span class="mh">0x1a001a1a1a001a1a</span><span class="p">,</span> <span class="mh">0x3f003f3f3f003f3f</span><span class="p">,</span> <span class="mh">0x3b003b3b3b003b3b</span><span class="p">,</span>
	<span class="mh">0x8200828282008282</span><span class="p">,</span> <span class="mh">0xb600b6b6b600b6b6</span><span class="p">,</span> <span class="mh">0xdb00dbdbdb00dbdb</span><span class="p">,</span>
	<span class="mh">0xd400d4d4d400d4d4</span><span class="p">,</span> <span class="mh">0x9800989898009898</span><span class="p">,</span> <span class="mh">0xe800e8e8e800e8e8</span><span class="p">,</span>
	<span class="mh">0x8b008b8b8b008b8b</span><span class="p">,</span> <span class="mh">0x0200020202000202</span><span class="p">,</span> <span class="mh">0xeb00ebebeb00ebeb</span><span class="p">,</span>
	<span class="mh">0x0a000a0a0a000a0a</span><span class="p">,</span> <span class="mh">0x2c002c2c2c002c2c</span><span class="p">,</span> <span class="mh">0x1d001d1d1d001d1d</span><span class="p">,</span>
	<span class="mh">0xb000b0b0b000b0b0</span><span class="p">,</span> <span class="mh">0x6f006f6f6f006f6f</span><span class="p">,</span> <span class="mh">0x8d008d8d8d008d8d</span><span class="p">,</span>
	<span class="mh">0x8800888888008888</span><span class="p">,</span> <span class="mh">0x0e000e0e0e000e0e</span><span class="p">,</span> <span class="mh">0x1900191919001919</span><span class="p">,</span>
	<span class="mh">0x8700878787008787</span><span class="p">,</span> <span class="mh">0x4e004e4e4e004e4e</span><span class="p">,</span> <span class="mh">0x0b000b0b0b000b0b</span><span class="p">,</span>
	<span class="mh">0xa900a9a9a900a9a9</span><span class="p">,</span> <span class="mh">0x0c000c0c0c000c0c</span><span class="p">,</span> <span class="mh">0x7900797979007979</span><span class="p">,</span>
	<span class="mh">0x1100111111001111</span><span class="p">,</span> <span class="mh">0x7f007f7f7f007f7f</span><span class="p">,</span> <span class="mh">0x2200222222002222</span><span class="p">,</span>
	<span class="mh">0xe700e7e7e700e7e7</span><span class="p">,</span> <span class="mh">0x5900595959005959</span><span class="p">,</span> <span class="mh">0xe100e1e1e100e1e1</span><span class="p">,</span>
	<span class="mh">0xda00dadada00dada</span><span class="p">,</span> <span class="mh">0x3d003d3d3d003d3d</span><span class="p">,</span> <span class="mh">0xc800c8c8c800c8c8</span><span class="p">,</span>
	<span class="mh">0x1200121212001212</span><span class="p">,</span> <span class="mh">0x0400040404000404</span><span class="p">,</span> <span class="mh">0x7400747474007474</span><span class="p">,</span>
	<span class="mh">0x5400545454005454</span><span class="p">,</span> <span class="mh">0x3000303030003030</span><span class="p">,</span> <span class="mh">0x7e007e7e7e007e7e</span><span class="p">,</span>
	<span class="mh">0xb400b4b4b400b4b4</span><span class="p">,</span> <span class="mh">0x2800282828002828</span><span class="p">,</span> <span class="mh">0x5500555555005555</span><span class="p">,</span>
	<span class="mh">0x6800686868006868</span><span class="p">,</span> <span class="mh">0x5000505050005050</span><span class="p">,</span> <span class="mh">0xbe00bebebe00bebe</span><span class="p">,</span>
	<span class="mh">0xd000d0d0d000d0d0</span><span class="p">,</span> <span class="mh">0xc400c4c4c400c4c4</span><span class="p">,</span> <span class="mh">0x3100313131003131</span><span class="p">,</span>
	<span class="mh">0xcb00cbcbcb00cbcb</span><span class="p">,</span> <span class="mh">0x2a002a2a2a002a2a</span><span class="p">,</span> <span class="mh">0xad00adadad00adad</span><span class="p">,</span>
	<span class="mh">0x0f000f0f0f000f0f</span><span class="p">,</span> <span class="mh">0xca00cacaca00caca</span><span class="p">,</span> <span class="mh">0x7000707070007070</span><span class="p">,</span>
	<span class="mh">0xff00ffffff00ffff</span><span class="p">,</span> <span class="mh">0x3200323232003232</span><span class="p">,</span> <span class="mh">0x6900696969006969</span><span class="p">,</span>
	<span class="mh">0x0800080808000808</span><span class="p">,</span> <span class="mh">0x6200626262006262</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span>
	<span class="mh">0x2400242424002424</span><span class="p">,</span> <span class="mh">0xd100d1d1d100d1d1</span><span class="p">,</span> <span class="mh">0xfb00fbfbfb00fbfb</span><span class="p">,</span>
	<span class="mh">0xba00bababa00baba</span><span class="p">,</span> <span class="mh">0xed00ededed00eded</span><span class="p">,</span> <span class="mh">0x4500454545004545</span><span class="p">,</span>
	<span class="mh">0x8100818181008181</span><span class="p">,</span> <span class="mh">0x7300737373007373</span><span class="p">,</span> <span class="mh">0x6d006d6d6d006d6d</span><span class="p">,</span>
	<span class="mh">0x8400848484008484</span><span class="p">,</span> <span class="mh">0x9f009f9f9f009f9f</span><span class="p">,</span> <span class="mh">0xee00eeeeee00eeee</span><span class="p">,</span>
	<span class="mh">0x4a004a4a4a004a4a</span><span class="p">,</span> <span class="mh">0xc300c3c3c300c3c3</span><span class="p">,</span> <span class="mh">0x2e002e2e2e002e2e</span><span class="p">,</span>
	<span class="mh">0xc100c1c1c100c1c1</span><span class="p">,</span> <span class="mh">0x0100010101000101</span><span class="p">,</span> <span class="mh">0xe600e6e6e600e6e6</span><span class="p">,</span>
	<span class="mh">0x2500252525002525</span><span class="p">,</span> <span class="mh">0x4800484848004848</span><span class="p">,</span> <span class="mh">0x9900999999009999</span><span class="p">,</span>
	<span class="mh">0xb900b9b9b900b9b9</span><span class="p">,</span> <span class="mh">0xb300b3b3b300b3b3</span><span class="p">,</span> <span class="mh">0x7b007b7b7b007b7b</span><span class="p">,</span>
	<span class="mh">0xf900f9f9f900f9f9</span><span class="p">,</span> <span class="mh">0xce00cecece00cece</span><span class="p">,</span> <span class="mh">0xbf00bfbfbf00bfbf</span><span class="p">,</span>
	<span class="mh">0xdf00dfdfdf00dfdf</span><span class="p">,</span> <span class="mh">0x7100717171007171</span><span class="p">,</span> <span class="mh">0x2900292929002929</span><span class="p">,</span>
	<span class="mh">0xcd00cdcdcd00cdcd</span><span class="p">,</span> <span class="mh">0x6c006c6c6c006c6c</span><span class="p">,</span> <span class="mh">0x1300131313001313</span><span class="p">,</span>
	<span class="mh">0x6400646464006464</span><span class="p">,</span> <span class="mh">0x9b009b9b9b009b9b</span><span class="p">,</span> <span class="mh">0x6300636363006363</span><span class="p">,</span>
	<span class="mh">0x9d009d9d9d009d9d</span><span class="p">,</span> <span class="mh">0xc000c0c0c000c0c0</span><span class="p">,</span> <span class="mh">0x4b004b4b4b004b4b</span><span class="p">,</span>
	<span class="mh">0xb700b7b7b700b7b7</span><span class="p">,</span> <span class="mh">0xa500a5a5a500a5a5</span><span class="p">,</span> <span class="mh">0x8900898989008989</span><span class="p">,</span>
	<span class="mh">0x5f005f5f5f005f5f</span><span class="p">,</span> <span class="mh">0xb100b1b1b100b1b1</span><span class="p">,</span> <span class="mh">0x1700171717001717</span><span class="p">,</span>
	<span class="mh">0xf400f4f4f400f4f4</span><span class="p">,</span> <span class="mh">0xbc00bcbcbc00bcbc</span><span class="p">,</span> <span class="mh">0xd300d3d3d300d3d3</span><span class="p">,</span>
	<span class="mh">0x4600464646004646</span><span class="p">,</span> <span class="mh">0xcf00cfcfcf00cfcf</span><span class="p">,</span> <span class="mh">0x3700373737003737</span><span class="p">,</span>
	<span class="mh">0x5e005e5e5e005e5e</span><span class="p">,</span> <span class="mh">0x4700474747004747</span><span class="p">,</span> <span class="mh">0x9400949494009494</span><span class="p">,</span>
	<span class="mh">0xfa00fafafa00fafa</span><span class="p">,</span> <span class="mh">0xfc00fcfcfc00fcfc</span><span class="p">,</span> <span class="mh">0x5b005b5b5b005b5b</span><span class="p">,</span>
	<span class="mh">0x9700979797009797</span><span class="p">,</span> <span class="mh">0xfe00fefefe00fefe</span><span class="p">,</span> <span class="mh">0x5a005a5a5a005a5a</span><span class="p">,</span>
	<span class="mh">0xac00acacac00acac</span><span class="p">,</span> <span class="mh">0x3c003c3c3c003c3c</span><span class="p">,</span> <span class="mh">0x4c004c4c4c004c4c</span><span class="p">,</span>
	<span class="mh">0x0300030303000303</span><span class="p">,</span> <span class="mh">0x3500353535003535</span><span class="p">,</span> <span class="mh">0xf300f3f3f300f3f3</span><span class="p">,</span>
	<span class="mh">0x2300232323002323</span><span class="p">,</span> <span class="mh">0xb800b8b8b800b8b8</span><span class="p">,</span> <span class="mh">0x5d005d5d5d005d5d</span><span class="p">,</span>
	<span class="mh">0x6a006a6a6a006a6a</span><span class="p">,</span> <span class="mh">0x9200929292009292</span><span class="p">,</span> <span class="mh">0xd500d5d5d500d5d5</span><span class="p">,</span>
	<span class="mh">0x2100212121002121</span><span class="p">,</span> <span class="mh">0x4400444444004444</span><span class="p">,</span> <span class="mh">0x5100515151005151</span><span class="p">,</span>
	<span class="mh">0xc600c6c6c600c6c6</span><span class="p">,</span> <span class="mh">0x7d007d7d7d007d7d</span><span class="p">,</span> <span class="mh">0x3900393939003939</span><span class="p">,</span>
	<span class="mh">0x8300838383008383</span><span class="p">,</span> <span class="mh">0xdc00dcdcdc00dcdc</span><span class="p">,</span> <span class="mh">0xaa00aaaaaa00aaaa</span><span class="p">,</span>
	<span class="mh">0x7c007c7c7c007c7c</span><span class="p">,</span> <span class="mh">0x7700777777007777</span><span class="p">,</span> <span class="mh">0x5600565656005656</span><span class="p">,</span>
	<span class="mh">0x0500050505000505</span><span class="p">,</span> <span class="mh">0x1b001b1b1b001b1b</span><span class="p">,</span> <span class="mh">0xa400a4a4a400a4a4</span><span class="p">,</span>
	<span class="mh">0x1500151515001515</span><span class="p">,</span> <span class="mh">0x3400343434003434</span><span class="p">,</span> <span class="mh">0x1e001e1e1e001e1e</span><span class="p">,</span>
	<span class="mh">0x1c001c1c1c001c1c</span><span class="p">,</span> <span class="mh">0xf800f8f8f800f8f8</span><span class="p">,</span> <span class="mh">0x5200525252005252</span><span class="p">,</span>
	<span class="mh">0x2000202020002020</span><span class="p">,</span> <span class="mh">0x1400141414001414</span><span class="p">,</span> <span class="mh">0xe900e9e9e900e9e9</span><span class="p">,</span>
	<span class="mh">0xbd00bdbdbd00bdbd</span><span class="p">,</span> <span class="mh">0xdd00dddddd00dddd</span><span class="p">,</span> <span class="mh">0xe400e4e4e400e4e4</span><span class="p">,</span>
	<span class="mh">0xa100a1a1a100a1a1</span><span class="p">,</span> <span class="mh">0xe000e0e0e000e0e0</span><span class="p">,</span> <span class="mh">0x8a008a8a8a008a8a</span><span class="p">,</span>
	<span class="mh">0xf100f1f1f100f1f1</span><span class="p">,</span> <span class="mh">0xd600d6d6d600d6d6</span><span class="p">,</span> <span class="mh">0x7a007a7a7a007a7a</span><span class="p">,</span>
	<span class="mh">0xbb00bbbbbb00bbbb</span><span class="p">,</span> <span class="mh">0xe300e3e3e300e3e3</span><span class="p">,</span> <span class="mh">0x4000404040004040</span><span class="p">,</span>
	<span class="mh">0x4f004f4f4f004f4f</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp44044404</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x7070007070700070</span><span class="p">,</span> <span class="mh">0x2c2c002c2c2c002c</span><span class="p">,</span> <span class="mh">0xb3b300b3b3b300b3</span><span class="p">,</span>
	<span class="mh">0xc0c000c0c0c000c0</span><span class="p">,</span> <span class="mh">0xe4e400e4e4e400e4</span><span class="p">,</span> <span class="mh">0x5757005757570057</span><span class="p">,</span>
	<span class="mh">0xeaea00eaeaea00ea</span><span class="p">,</span> <span class="mh">0xaeae00aeaeae00ae</span><span class="p">,</span> <span class="mh">0x2323002323230023</span><span class="p">,</span>
	<span class="mh">0x6b6b006b6b6b006b</span><span class="p">,</span> <span class="mh">0x4545004545450045</span><span class="p">,</span> <span class="mh">0xa5a500a5a5a500a5</span><span class="p">,</span>
	<span class="mh">0xeded00ededed00ed</span><span class="p">,</span> <span class="mh">0x4f4f004f4f4f004f</span><span class="p">,</span> <span class="mh">0x1d1d001d1d1d001d</span><span class="p">,</span>
	<span class="mh">0x9292009292920092</span><span class="p">,</span> <span class="mh">0x8686008686860086</span><span class="p">,</span> <span class="mh">0xafaf00afafaf00af</span><span class="p">,</span>
	<span class="mh">0x7c7c007c7c7c007c</span><span class="p">,</span> <span class="mh">0x1f1f001f1f1f001f</span><span class="p">,</span> <span class="mh">0x3e3e003e3e3e003e</span><span class="p">,</span>
	<span class="mh">0xdcdc00dcdcdc00dc</span><span class="p">,</span> <span class="mh">0x5e5e005e5e5e005e</span><span class="p">,</span> <span class="mh">0x0b0b000b0b0b000b</span><span class="p">,</span>
	<span class="mh">0xa6a600a6a6a600a6</span><span class="p">,</span> <span class="mh">0x3939003939390039</span><span class="p">,</span> <span class="mh">0xd5d500d5d5d500d5</span><span class="p">,</span>
	<span class="mh">0x5d5d005d5d5d005d</span><span class="p">,</span> <span class="mh">0xd9d900d9d9d900d9</span><span class="p">,</span> <span class="mh">0x5a5a005a5a5a005a</span><span class="p">,</span>
	<span class="mh">0x5151005151510051</span><span class="p">,</span> <span class="mh">0x6c6c006c6c6c006c</span><span class="p">,</span> <span class="mh">0x8b8b008b8b8b008b</span><span class="p">,</span>
	<span class="mh">0x9a9a009a9a9a009a</span><span class="p">,</span> <span class="mh">0xfbfb00fbfbfb00fb</span><span class="p">,</span> <span class="mh">0xb0b000b0b0b000b0</span><span class="p">,</span>
	<span class="mh">0x7474007474740074</span><span class="p">,</span> <span class="mh">0x2b2b002b2b2b002b</span><span class="p">,</span> <span class="mh">0xf0f000f0f0f000f0</span><span class="p">,</span>
	<span class="mh">0x8484008484840084</span><span class="p">,</span> <span class="mh">0xdfdf00dfdfdf00df</span><span class="p">,</span> <span class="mh">0xcbcb00cbcbcb00cb</span><span class="p">,</span>
	<span class="mh">0x3434003434340034</span><span class="p">,</span> <span class="mh">0x7676007676760076</span><span class="p">,</span> <span class="mh">0x6d6d006d6d6d006d</span><span class="p">,</span>
	<span class="mh">0xa9a900a9a9a900a9</span><span class="p">,</span> <span class="mh">0xd1d100d1d1d100d1</span><span class="p">,</span> <span class="mh">0x0404000404040004</span><span class="p">,</span>
	<span class="mh">0x1414001414140014</span><span class="p">,</span> <span class="mh">0x3a3a003a3a3a003a</span><span class="p">,</span> <span class="mh">0xdede00dedede00de</span><span class="p">,</span>
	<span class="mh">0x1111001111110011</span><span class="p">,</span> <span class="mh">0x3232003232320032</span><span class="p">,</span> <span class="mh">0x9c9c009c9c9c009c</span><span class="p">,</span>
	<span class="mh">0x5353005353530053</span><span class="p">,</span> <span class="mh">0xf2f200f2f2f200f2</span><span class="p">,</span> <span class="mh">0xfefe00fefefe00fe</span><span class="p">,</span>
	<span class="mh">0xcfcf00cfcfcf00cf</span><span class="p">,</span> <span class="mh">0xc3c300c3c3c300c3</span><span class="p">,</span> <span class="mh">0x7a7a007a7a7a007a</span><span class="p">,</span>
	<span class="mh">0x2424002424240024</span><span class="p">,</span> <span class="mh">0xe8e800e8e8e800e8</span><span class="p">,</span> <span class="mh">0x6060006060600060</span><span class="p">,</span>
	<span class="mh">0x6969006969690069</span><span class="p">,</span> <span class="mh">0xaaaa00aaaaaa00aa</span><span class="p">,</span> <span class="mh">0xa0a000a0a0a000a0</span><span class="p">,</span>
	<span class="mh">0xa1a100a1a1a100a1</span><span class="p">,</span> <span class="mh">0x6262006262620062</span><span class="p">,</span> <span class="mh">0x5454005454540054</span><span class="p">,</span>
	<span class="mh">0x1e1e001e1e1e001e</span><span class="p">,</span> <span class="mh">0xe0e000e0e0e000e0</span><span class="p">,</span> <span class="mh">0x6464006464640064</span><span class="p">,</span>
	<span class="mh">0x1010001010100010</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span> <span class="mh">0xa3a300a3a3a300a3</span><span class="p">,</span>
	<span class="mh">0x7575007575750075</span><span class="p">,</span> <span class="mh">0x8a8a008a8a8a008a</span><span class="p">,</span> <span class="mh">0xe6e600e6e6e600e6</span><span class="p">,</span>
	<span class="mh">0x0909000909090009</span><span class="p">,</span> <span class="mh">0xdddd00dddddd00dd</span><span class="p">,</span> <span class="mh">0x8787008787870087</span><span class="p">,</span>
	<span class="mh">0x8383008383830083</span><span class="p">,</span> <span class="mh">0xcdcd00cdcdcd00cd</span><span class="p">,</span> <span class="mh">0x9090009090900090</span><span class="p">,</span>
	<span class="mh">0x7373007373730073</span><span class="p">,</span> <span class="mh">0xf6f600f6f6f600f6</span><span class="p">,</span> <span class="mh">0x9d9d009d9d9d009d</span><span class="p">,</span>
	<span class="mh">0xbfbf00bfbfbf00bf</span><span class="p">,</span> <span class="mh">0x5252005252520052</span><span class="p">,</span> <span class="mh">0xd8d800d8d8d800d8</span><span class="p">,</span>
	<span class="mh">0xc8c800c8c8c800c8</span><span class="p">,</span> <span class="mh">0xc6c600c6c6c600c6</span><span class="p">,</span> <span class="mh">0x8181008181810081</span><span class="p">,</span>
	<span class="mh">0x6f6f006f6f6f006f</span><span class="p">,</span> <span class="mh">0x1313001313130013</span><span class="p">,</span> <span class="mh">0x6363006363630063</span><span class="p">,</span>
	<span class="mh">0xe9e900e9e9e900e9</span><span class="p">,</span> <span class="mh">0xa7a700a7a7a700a7</span><span class="p">,</span> <span class="mh">0x9f9f009f9f9f009f</span><span class="p">,</span>
	<span class="mh">0xbcbc00bcbcbc00bc</span><span class="p">,</span> <span class="mh">0x2929002929290029</span><span class="p">,</span> <span class="mh">0xf9f900f9f9f900f9</span><span class="p">,</span>
	<span class="mh">0x2f2f002f2f2f002f</span><span class="p">,</span> <span class="mh">0xb4b400b4b4b400b4</span><span class="p">,</span> <span class="mh">0x7878007878780078</span><span class="p">,</span>
	<span class="mh">0x0606000606060006</span><span class="p">,</span> <span class="mh">0xe7e700e7e7e700e7</span><span class="p">,</span> <span class="mh">0x7171007171710071</span><span class="p">,</span>
	<span class="mh">0xd4d400d4d4d400d4</span><span class="p">,</span> <span class="mh">0xabab00ababab00ab</span><span class="p">,</span> <span class="mh">0x8888008888880088</span><span class="p">,</span>
	<span class="mh">0x8d8d008d8d8d008d</span><span class="p">,</span> <span class="mh">0x7272007272720072</span><span class="p">,</span> <span class="mh">0xb9b900b9b9b900b9</span><span class="p">,</span>
	<span class="mh">0xf8f800f8f8f800f8</span><span class="p">,</span> <span class="mh">0xacac00acacac00ac</span><span class="p">,</span> <span class="mh">0x3636003636360036</span><span class="p">,</span>
	<span class="mh">0x2a2a002a2a2a002a</span><span class="p">,</span> <span class="mh">0x3c3c003c3c3c003c</span><span class="p">,</span> <span class="mh">0xf1f100f1f1f100f1</span><span class="p">,</span>
	<span class="mh">0x4040004040400040</span><span class="p">,</span> <span class="mh">0xd3d300d3d3d300d3</span><span class="p">,</span> <span class="mh">0xbbbb00bbbbbb00bb</span><span class="p">,</span>
	<span class="mh">0x4343004343430043</span><span class="p">,</span> <span class="mh">0x1515001515150015</span><span class="p">,</span> <span class="mh">0xadad00adadad00ad</span><span class="p">,</span>
	<span class="mh">0x7777007777770077</span><span class="p">,</span> <span class="mh">0x8080008080800080</span><span class="p">,</span> <span class="mh">0x8282008282820082</span><span class="p">,</span>
	<span class="mh">0xecec00ececec00ec</span><span class="p">,</span> <span class="mh">0x2727002727270027</span><span class="p">,</span> <span class="mh">0xe5e500e5e5e500e5</span><span class="p">,</span>
	<span class="mh">0x8585008585850085</span><span class="p">,</span> <span class="mh">0x3535003535350035</span><span class="p">,</span> <span class="mh">0x0c0c000c0c0c000c</span><span class="p">,</span>
	<span class="mh">0x4141004141410041</span><span class="p">,</span> <span class="mh">0xefef00efefef00ef</span><span class="p">,</span> <span class="mh">0x9393009393930093</span><span class="p">,</span>
	<span class="mh">0x1919001919190019</span><span class="p">,</span> <span class="mh">0x2121002121210021</span><span class="p">,</span> <span class="mh">0x0e0e000e0e0e000e</span><span class="p">,</span>
	<span class="mh">0x4e4e004e4e4e004e</span><span class="p">,</span> <span class="mh">0x6565006565650065</span><span class="p">,</span> <span class="mh">0xbdbd00bdbdbd00bd</span><span class="p">,</span>
	<span class="mh">0xb8b800b8b8b800b8</span><span class="p">,</span> <span class="mh">0x8f8f008f8f8f008f</span><span class="p">,</span> <span class="mh">0xebeb00ebebeb00eb</span><span class="p">,</span>
	<span class="mh">0xcece00cecece00ce</span><span class="p">,</span> <span class="mh">0x3030003030300030</span><span class="p">,</span> <span class="mh">0x5f5f005f5f5f005f</span><span class="p">,</span>
	<span class="mh">0xc5c500c5c5c500c5</span><span class="p">,</span> <span class="mh">0x1a1a001a1a1a001a</span><span class="p">,</span> <span class="mh">0xe1e100e1e1e100e1</span><span class="p">,</span>
	<span class="mh">0xcaca00cacaca00ca</span><span class="p">,</span> <span class="mh">0x4747004747470047</span><span class="p">,</span> <span class="mh">0x3d3d003d3d3d003d</span><span class="p">,</span>
	<span class="mh">0x0101000101010001</span><span class="p">,</span> <span class="mh">0xd6d600d6d6d600d6</span><span class="p">,</span> <span class="mh">0x5656005656560056</span><span class="p">,</span>
	<span class="mh">0x4d4d004d4d4d004d</span><span class="p">,</span> <span class="mh">0x0d0d000d0d0d000d</span><span class="p">,</span> <span class="mh">0x6666006666660066</span><span class="p">,</span>
	<span class="mh">0xcccc00cccccc00cc</span><span class="p">,</span> <span class="mh">0x2d2d002d2d2d002d</span><span class="p">,</span> <span class="mh">0x1212001212120012</span><span class="p">,</span>
	<span class="mh">0x2020002020200020</span><span class="p">,</span> <span class="mh">0xb1b100b1b1b100b1</span><span class="p">,</span> <span class="mh">0x9999009999990099</span><span class="p">,</span>
	<span class="mh">0x4c4c004c4c4c004c</span><span class="p">,</span> <span class="mh">0xc2c200c2c2c200c2</span><span class="p">,</span> <span class="mh">0x7e7e007e7e7e007e</span><span class="p">,</span>
	<span class="mh">0x0505000505050005</span><span class="p">,</span> <span class="mh">0xb7b700b7b7b700b7</span><span class="p">,</span> <span class="mh">0x3131003131310031</span><span class="p">,</span>
	<span class="mh">0x1717001717170017</span><span class="p">,</span> <span class="mh">0xd7d700d7d7d700d7</span><span class="p">,</span> <span class="mh">0x5858005858580058</span><span class="p">,</span>
	<span class="mh">0x6161006161610061</span><span class="p">,</span> <span class="mh">0x1b1b001b1b1b001b</span><span class="p">,</span> <span class="mh">0x1c1c001c1c1c001c</span><span class="p">,</span>
	<span class="mh">0x0f0f000f0f0f000f</span><span class="p">,</span> <span class="mh">0x1616001616160016</span><span class="p">,</span> <span class="mh">0x1818001818180018</span><span class="p">,</span>
	<span class="mh">0x2222002222220022</span><span class="p">,</span> <span class="mh">0x4444004444440044</span><span class="p">,</span> <span class="mh">0xb2b200b2b2b200b2</span><span class="p">,</span>
	<span class="mh">0xb5b500b5b5b500b5</span><span class="p">,</span> <span class="mh">0x9191009191910091</span><span class="p">,</span> <span class="mh">0x0808000808080008</span><span class="p">,</span>
	<span class="mh">0xa8a800a8a8a800a8</span><span class="p">,</span> <span class="mh">0xfcfc00fcfcfc00fc</span><span class="p">,</span> <span class="mh">0x5050005050500050</span><span class="p">,</span>
	<span class="mh">0xd0d000d0d0d000d0</span><span class="p">,</span> <span class="mh">0x7d7d007d7d7d007d</span><span class="p">,</span> <span class="mh">0x8989008989890089</span><span class="p">,</span>
	<span class="mh">0x9797009797970097</span><span class="p">,</span> <span class="mh">0x5b5b005b5b5b005b</span><span class="p">,</span> <span class="mh">0x9595009595950095</span><span class="p">,</span>
	<span class="mh">0xffff00ffffff00ff</span><span class="p">,</span> <span class="mh">0xd2d200d2d2d200d2</span><span class="p">,</span> <span class="mh">0xc4c400c4c4c400c4</span><span class="p">,</span>
	<span class="mh">0x4848004848480048</span><span class="p">,</span> <span class="mh">0xf7f700f7f7f700f7</span><span class="p">,</span> <span class="mh">0xdbdb00dbdbdb00db</span><span class="p">,</span>
	<span class="mh">0x0303000303030003</span><span class="p">,</span> <span class="mh">0xdada00dadada00da</span><span class="p">,</span> <span class="mh">0x3f3f003f3f3f003f</span><span class="p">,</span>
	<span class="mh">0x9494009494940094</span><span class="p">,</span> <span class="mh">0x5c5c005c5c5c005c</span><span class="p">,</span> <span class="mh">0x0202000202020002</span><span class="p">,</span>
	<span class="mh">0x4a4a004a4a4a004a</span><span class="p">,</span> <span class="mh">0x3333003333330033</span><span class="p">,</span> <span class="mh">0x6767006767670067</span><span class="p">,</span>
	<span class="mh">0xf3f300f3f3f300f3</span><span class="p">,</span> <span class="mh">0x7f7f007f7f7f007f</span><span class="p">,</span> <span class="mh">0xe2e200e2e2e200e2</span><span class="p">,</span>
	<span class="mh">0x9b9b009b9b9b009b</span><span class="p">,</span> <span class="mh">0x2626002626260026</span><span class="p">,</span> <span class="mh">0x3737003737370037</span><span class="p">,</span>
	<span class="mh">0x3b3b003b3b3b003b</span><span class="p">,</span> <span class="mh">0x9696009696960096</span><span class="p">,</span> <span class="mh">0x4b4b004b4b4b004b</span><span class="p">,</span>
	<span class="mh">0xbebe00bebebe00be</span><span class="p">,</span> <span class="mh">0x2e2e002e2e2e002e</span><span class="p">,</span> <span class="mh">0x7979007979790079</span><span class="p">,</span>
	<span class="mh">0x8c8c008c8c8c008c</span><span class="p">,</span> <span class="mh">0x6e6e006e6e6e006e</span><span class="p">,</span> <span class="mh">0x8e8e008e8e8e008e</span><span class="p">,</span>
	<span class="mh">0xf5f500f5f5f500f5</span><span class="p">,</span> <span class="mh">0xb6b600b6b6b600b6</span><span class="p">,</span> <span class="mh">0xfdfd00fdfdfd00fd</span><span class="p">,</span>
	<span class="mh">0x5959005959590059</span><span class="p">,</span> <span class="mh">0x9898009898980098</span><span class="p">,</span> <span class="mh">0x6a6a006a6a6a006a</span><span class="p">,</span>
	<span class="mh">0x4646004646460046</span><span class="p">,</span> <span class="mh">0xbaba00bababa00ba</span><span class="p">,</span> <span class="mh">0x2525002525250025</span><span class="p">,</span>
	<span class="mh">0x4242004242420042</span><span class="p">,</span> <span class="mh">0xa2a200a2a2a200a2</span><span class="p">,</span> <span class="mh">0xfafa00fafafa00fa</span><span class="p">,</span>
	<span class="mh">0x0707000707070007</span><span class="p">,</span> <span class="mh">0x5555005555550055</span><span class="p">,</span> <span class="mh">0xeeee00eeeeee00ee</span><span class="p">,</span>
	<span class="mh">0x0a0a000a0a0a000a</span><span class="p">,</span> <span class="mh">0x4949004949490049</span><span class="p">,</span> <span class="mh">0x6868006868680068</span><span class="p">,</span>
	<span class="mh">0x3838003838380038</span><span class="p">,</span> <span class="mh">0xa4a400a4a4a400a4</span><span class="p">,</span> <span class="mh">0x2828002828280028</span><span class="p">,</span>
	<span class="mh">0x7b7b007b7b7b007b</span><span class="p">,</span> <span class="mh">0xc9c900c9c9c900c9</span><span class="p">,</span> <span class="mh">0xc1c100c1c1c100c1</span><span class="p">,</span>
	<span class="mh">0xe3e300e3e3e300e3</span><span class="p">,</span> <span class="mh">0xf4f400f4f4f400f4</span><span class="p">,</span> <span class="mh">0xc7c700c7c7c700c7</span><span class="p">,</span>
	<span class="mh">0x9e9e009e9e9e009e</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">const</span> <span class="n">u64</span> <span class="n">camellia_sp11101110</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x7070700070707000</span><span class="p">,</span> <span class="mh">0x8282820082828200</span><span class="p">,</span> <span class="mh">0x2c2c2c002c2c2c00</span><span class="p">,</span>
	<span class="mh">0xececec00ececec00</span><span class="p">,</span> <span class="mh">0xb3b3b300b3b3b300</span><span class="p">,</span> <span class="mh">0x2727270027272700</span><span class="p">,</span>
	<span class="mh">0xc0c0c000c0c0c000</span><span class="p">,</span> <span class="mh">0xe5e5e500e5e5e500</span><span class="p">,</span> <span class="mh">0xe4e4e400e4e4e400</span><span class="p">,</span>
	<span class="mh">0x8585850085858500</span><span class="p">,</span> <span class="mh">0x5757570057575700</span><span class="p">,</span> <span class="mh">0x3535350035353500</span><span class="p">,</span>
	<span class="mh">0xeaeaea00eaeaea00</span><span class="p">,</span> <span class="mh">0x0c0c0c000c0c0c00</span><span class="p">,</span> <span class="mh">0xaeaeae00aeaeae00</span><span class="p">,</span>
	<span class="mh">0x4141410041414100</span><span class="p">,</span> <span class="mh">0x2323230023232300</span><span class="p">,</span> <span class="mh">0xefefef00efefef00</span><span class="p">,</span>
	<span class="mh">0x6b6b6b006b6b6b00</span><span class="p">,</span> <span class="mh">0x9393930093939300</span><span class="p">,</span> <span class="mh">0x4545450045454500</span><span class="p">,</span>
	<span class="mh">0x1919190019191900</span><span class="p">,</span> <span class="mh">0xa5a5a500a5a5a500</span><span class="p">,</span> <span class="mh">0x2121210021212100</span><span class="p">,</span>
	<span class="mh">0xededed00ededed00</span><span class="p">,</span> <span class="mh">0x0e0e0e000e0e0e00</span><span class="p">,</span> <span class="mh">0x4f4f4f004f4f4f00</span><span class="p">,</span>
	<span class="mh">0x4e4e4e004e4e4e00</span><span class="p">,</span> <span class="mh">0x1d1d1d001d1d1d00</span><span class="p">,</span> <span class="mh">0x6565650065656500</span><span class="p">,</span>
	<span class="mh">0x9292920092929200</span><span class="p">,</span> <span class="mh">0xbdbdbd00bdbdbd00</span><span class="p">,</span> <span class="mh">0x8686860086868600</span><span class="p">,</span>
	<span class="mh">0xb8b8b800b8b8b800</span><span class="p">,</span> <span class="mh">0xafafaf00afafaf00</span><span class="p">,</span> <span class="mh">0x8f8f8f008f8f8f00</span><span class="p">,</span>
	<span class="mh">0x7c7c7c007c7c7c00</span><span class="p">,</span> <span class="mh">0xebebeb00ebebeb00</span><span class="p">,</span> <span class="mh">0x1f1f1f001f1f1f00</span><span class="p">,</span>
	<span class="mh">0xcecece00cecece00</span><span class="p">,</span> <span class="mh">0x3e3e3e003e3e3e00</span><span class="p">,</span> <span class="mh">0x3030300030303000</span><span class="p">,</span>
	<span class="mh">0xdcdcdc00dcdcdc00</span><span class="p">,</span> <span class="mh">0x5f5f5f005f5f5f00</span><span class="p">,</span> <span class="mh">0x5e5e5e005e5e5e00</span><span class="p">,</span>
	<span class="mh">0xc5c5c500c5c5c500</span><span class="p">,</span> <span class="mh">0x0b0b0b000b0b0b00</span><span class="p">,</span> <span class="mh">0x1a1a1a001a1a1a00</span><span class="p">,</span>
	<span class="mh">0xa6a6a600a6a6a600</span><span class="p">,</span> <span class="mh">0xe1e1e100e1e1e100</span><span class="p">,</span> <span class="mh">0x3939390039393900</span><span class="p">,</span>
	<span class="mh">0xcacaca00cacaca00</span><span class="p">,</span> <span class="mh">0xd5d5d500d5d5d500</span><span class="p">,</span> <span class="mh">0x4747470047474700</span><span class="p">,</span>
	<span class="mh">0x5d5d5d005d5d5d00</span><span class="p">,</span> <span class="mh">0x3d3d3d003d3d3d00</span><span class="p">,</span> <span class="mh">0xd9d9d900d9d9d900</span><span class="p">,</span>
	<span class="mh">0x0101010001010100</span><span class="p">,</span> <span class="mh">0x5a5a5a005a5a5a00</span><span class="p">,</span> <span class="mh">0xd6d6d600d6d6d600</span><span class="p">,</span>
	<span class="mh">0x5151510051515100</span><span class="p">,</span> <span class="mh">0x5656560056565600</span><span class="p">,</span> <span class="mh">0x6c6c6c006c6c6c00</span><span class="p">,</span>
	<span class="mh">0x4d4d4d004d4d4d00</span><span class="p">,</span> <span class="mh">0x8b8b8b008b8b8b00</span><span class="p">,</span> <span class="mh">0x0d0d0d000d0d0d00</span><span class="p">,</span>
	<span class="mh">0x9a9a9a009a9a9a00</span><span class="p">,</span> <span class="mh">0x6666660066666600</span><span class="p">,</span> <span class="mh">0xfbfbfb00fbfbfb00</span><span class="p">,</span>
	<span class="mh">0xcccccc00cccccc00</span><span class="p">,</span> <span class="mh">0xb0b0b000b0b0b000</span><span class="p">,</span> <span class="mh">0x2d2d2d002d2d2d00</span><span class="p">,</span>
	<span class="mh">0x7474740074747400</span><span class="p">,</span> <span class="mh">0x1212120012121200</span><span class="p">,</span> <span class="mh">0x2b2b2b002b2b2b00</span><span class="p">,</span>
	<span class="mh">0x2020200020202000</span><span class="p">,</span> <span class="mh">0xf0f0f000f0f0f000</span><span class="p">,</span> <span class="mh">0xb1b1b100b1b1b100</span><span class="p">,</span>
	<span class="mh">0x8484840084848400</span><span class="p">,</span> <span class="mh">0x9999990099999900</span><span class="p">,</span> <span class="mh">0xdfdfdf00dfdfdf00</span><span class="p">,</span>
	<span class="mh">0x4c4c4c004c4c4c00</span><span class="p">,</span> <span class="mh">0xcbcbcb00cbcbcb00</span><span class="p">,</span> <span class="mh">0xc2c2c200c2c2c200</span><span class="p">,</span>
	<span class="mh">0x3434340034343400</span><span class="p">,</span> <span class="mh">0x7e7e7e007e7e7e00</span><span class="p">,</span> <span class="mh">0x7676760076767600</span><span class="p">,</span>
	<span class="mh">0x0505050005050500</span><span class="p">,</span> <span class="mh">0x6d6d6d006d6d6d00</span><span class="p">,</span> <span class="mh">0xb7b7b700b7b7b700</span><span class="p">,</span>
	<span class="mh">0xa9a9a900a9a9a900</span><span class="p">,</span> <span class="mh">0x3131310031313100</span><span class="p">,</span> <span class="mh">0xd1d1d100d1d1d100</span><span class="p">,</span>
	<span class="mh">0x1717170017171700</span><span class="p">,</span> <span class="mh">0x0404040004040400</span><span class="p">,</span> <span class="mh">0xd7d7d700d7d7d700</span><span class="p">,</span>
	<span class="mh">0x1414140014141400</span><span class="p">,</span> <span class="mh">0x5858580058585800</span><span class="p">,</span> <span class="mh">0x3a3a3a003a3a3a00</span><span class="p">,</span>
	<span class="mh">0x6161610061616100</span><span class="p">,</span> <span class="mh">0xdedede00dedede00</span><span class="p">,</span> <span class="mh">0x1b1b1b001b1b1b00</span><span class="p">,</span>
	<span class="mh">0x1111110011111100</span><span class="p">,</span> <span class="mh">0x1c1c1c001c1c1c00</span><span class="p">,</span> <span class="mh">0x3232320032323200</span><span class="p">,</span>
	<span class="mh">0x0f0f0f000f0f0f00</span><span class="p">,</span> <span class="mh">0x9c9c9c009c9c9c00</span><span class="p">,</span> <span class="mh">0x1616160016161600</span><span class="p">,</span>
	<span class="mh">0x5353530053535300</span><span class="p">,</span> <span class="mh">0x1818180018181800</span><span class="p">,</span> <span class="mh">0xf2f2f200f2f2f200</span><span class="p">,</span>
	<span class="mh">0x2222220022222200</span><span class="p">,</span> <span class="mh">0xfefefe00fefefe00</span><span class="p">,</span> <span class="mh">0x4444440044444400</span><span class="p">,</span>
	<span class="mh">0xcfcfcf00cfcfcf00</span><span class="p">,</span> <span class="mh">0xb2b2b200b2b2b200</span><span class="p">,</span> <span class="mh">0xc3c3c300c3c3c300</span><span class="p">,</span>
	<span class="mh">0xb5b5b500b5b5b500</span><span class="p">,</span> <span class="mh">0x7a7a7a007a7a7a00</span><span class="p">,</span> <span class="mh">0x9191910091919100</span><span class="p">,</span>
	<span class="mh">0x2424240024242400</span><span class="p">,</span> <span class="mh">0x0808080008080800</span><span class="p">,</span> <span class="mh">0xe8e8e800e8e8e800</span><span class="p">,</span>
	<span class="mh">0xa8a8a800a8a8a800</span><span class="p">,</span> <span class="mh">0x6060600060606000</span><span class="p">,</span> <span class="mh">0xfcfcfc00fcfcfc00</span><span class="p">,</span>
	<span class="mh">0x6969690069696900</span><span class="p">,</span> <span class="mh">0x5050500050505000</span><span class="p">,</span> <span class="mh">0xaaaaaa00aaaaaa00</span><span class="p">,</span>
	<span class="mh">0xd0d0d000d0d0d000</span><span class="p">,</span> <span class="mh">0xa0a0a000a0a0a000</span><span class="p">,</span> <span class="mh">0x7d7d7d007d7d7d00</span><span class="p">,</span>
	<span class="mh">0xa1a1a100a1a1a100</span><span class="p">,</span> <span class="mh">0x8989890089898900</span><span class="p">,</span> <span class="mh">0x6262620062626200</span><span class="p">,</span>
	<span class="mh">0x9797970097979700</span><span class="p">,</span> <span class="mh">0x5454540054545400</span><span class="p">,</span> <span class="mh">0x5b5b5b005b5b5b00</span><span class="p">,</span>
	<span class="mh">0x1e1e1e001e1e1e00</span><span class="p">,</span> <span class="mh">0x9595950095959500</span><span class="p">,</span> <span class="mh">0xe0e0e000e0e0e000</span><span class="p">,</span>
	<span class="mh">0xffffff00ffffff00</span><span class="p">,</span> <span class="mh">0x6464640064646400</span><span class="p">,</span> <span class="mh">0xd2d2d200d2d2d200</span><span class="p">,</span>
	<span class="mh">0x1010100010101000</span><span class="p">,</span> <span class="mh">0xc4c4c400c4c4c400</span><span class="p">,</span> <span class="mh">0x0000000000000000</span><span class="p">,</span>
	<span class="mh">0x4848480048484800</span><span class="p">,</span> <span class="mh">0xa3a3a300a3a3a300</span><span class="p">,</span> <span class="mh">0xf7f7f700f7f7f700</span><span class="p">,</span>
	<span class="mh">0x7575750075757500</span><span class="p">,</span> <span class="mh">0xdbdbdb00dbdbdb00</span><span class="p">,</span> <span class="mh">0x8a8a8a008a8a8a00</span><span class="p">,</span>
	<span class="mh">0x0303030003030300</span><span class="p">,</span> <span class="mh">0xe6e6e600e6e6e600</span><span class="p">,</span> <span class="mh">0xdadada00dadada00</span><span class="p">,</span>
	<span class="mh">0x0909090009090900</span><span class="p">,</span> <span class="mh">0x3f3f3f003f3f3f00</span><span class="p">,</span> <span class="mh">0xdddddd00dddddd00</span><span class="p">,</span>
	<span class="mh">0x9494940094949400</span><span class="p">,</span> <span class="mh">0x8787870087878700</span><span class="p">,</span> <span class="mh">0x5c5c5c005c5c5c00</span><span class="p">,</span>
	<span class="mh">0x8383830083838300</span><span class="p">,</span> <span class="mh">0x0202020002020200</span><span class="p">,</span> <span class="mh">0xcdcdcd00cdcdcd00</span><span class="p">,</span>
	<span class="mh">0x4a4a4a004a4a4a00</span><span class="p">,</span> <span class="mh">0x9090900090909000</span><span class="p">,</span> <span class="mh">0x3333330033333300</span><span class="p">,</span>
	<span class="mh">0x7373730073737300</span><span class="p">,</span> <span class="mh">0x6767670067676700</span><span class="p">,</span> <span class="mh">0xf6f6f600f6f6f600</span><span class="p">,</span>
	<span class="mh">0xf3f3f300f3f3f300</span><span class="p">,</span> <span class="mh">0x9d9d9d009d9d9d00</span><span class="p">,</span> <span class="mh">0x7f7f7f007f7f7f00</span><span class="p">,</span>
	<span class="mh">0xbfbfbf00bfbfbf00</span><span class="p">,</span> <span class="mh">0xe2e2e200e2e2e200</span><span class="p">,</span> <span class="mh">0x5252520052525200</span><span class="p">,</span>
	<span class="mh">0x9b9b9b009b9b9b00</span><span class="p">,</span> <span class="mh">0xd8d8d800d8d8d800</span><span class="p">,</span> <span class="mh">0x2626260026262600</span><span class="p">,</span>
	<span class="mh">0xc8c8c800c8c8c800</span><span class="p">,</span> <span class="mh">0x3737370037373700</span><span class="p">,</span> <span class="mh">0xc6c6c600c6c6c600</span><span class="p">,</span>
	<span class="mh">0x3b3b3b003b3b3b00</span><span class="p">,</span> <span class="mh">0x8181810081818100</span><span class="p">,</span> <span class="mh">0x9696960096969600</span><span class="p">,</span>
	<span class="mh">0x6f6f6f006f6f6f00</span><span class="p">,</span> <span class="mh">0x4b4b4b004b4b4b00</span><span class="p">,</span> <span class="mh">0x1313130013131300</span><span class="p">,</span>
	<span class="mh">0xbebebe00bebebe00</span><span class="p">,</span> <span class="mh">0x6363630063636300</span><span class="p">,</span> <span class="mh">0x2e2e2e002e2e2e00</span><span class="p">,</span>
	<span class="mh">0xe9e9e900e9e9e900</span><span class="p">,</span> <span class="mh">0x7979790079797900</span><span class="p">,</span> <span class="mh">0xa7a7a700a7a7a700</span><span class="p">,</span>
	<span class="mh">0x8c8c8c008c8c8c00</span><span class="p">,</span> <span class="mh">0x9f9f9f009f9f9f00</span><span class="p">,</span> <span class="mh">0x6e6e6e006e6e6e00</span><span class="p">,</span>
	<span class="mh">0xbcbcbc00bcbcbc00</span><span class="p">,</span> <span class="mh">0x8e8e8e008e8e8e00</span><span class="p">,</span> <span class="mh">0x2929290029292900</span><span class="p">,</span>
	<span class="mh">0xf5f5f500f5f5f500</span><span class="p">,</span> <span class="mh">0xf9f9f900f9f9f900</span><span class="p">,</span> <span class="mh">0xb6b6b600b6b6b600</span><span class="p">,</span>
	<span class="mh">0x2f2f2f002f2f2f00</span><span class="p">,</span> <span class="mh">0xfdfdfd00fdfdfd00</span><span class="p">,</span> <span class="mh">0xb4b4b400b4b4b400</span><span class="p">,</span>
	<span class="mh">0x5959590059595900</span><span class="p">,</span> <span class="mh">0x7878780078787800</span><span class="p">,</span> <span class="mh">0x9898980098989800</span><span class="p">,</span>
	<span class="mh">0x0606060006060600</span><span class="p">,</span> <span class="mh">0x6a6a6a006a6a6a00</span><span class="p">,</span> <span class="mh">0xe7e7e700e7e7e700</span><span class="p">,</span>
	<span class="mh">0x4646460046464600</span><span class="p">,</span> <span class="mh">0x7171710071717100</span><span class="p">,</span> <span class="mh">0xbababa00bababa00</span><span class="p">,</span>
	<span class="mh">0xd4d4d400d4d4d400</span><span class="p">,</span> <span class="mh">0x2525250025252500</span><span class="p">,</span> <span class="mh">0xababab00ababab00</span><span class="p">,</span>
	<span class="mh">0x4242420042424200</span><span class="p">,</span> <span class="mh">0x8888880088888800</span><span class="p">,</span> <span class="mh">0xa2a2a200a2a2a200</span><span class="p">,</span>
	<span class="mh">0x8d8d8d008d8d8d00</span><span class="p">,</span> <span class="mh">0xfafafa00fafafa00</span><span class="p">,</span> <span class="mh">0x7272720072727200</span><span class="p">,</span>
	<span class="mh">0x0707070007070700</span><span class="p">,</span> <span class="mh">0xb9b9b900b9b9b900</span><span class="p">,</span> <span class="mh">0x5555550055555500</span><span class="p">,</span>
	<span class="mh">0xf8f8f800f8f8f800</span><span class="p">,</span> <span class="mh">0xeeeeee00eeeeee00</span><span class="p">,</span> <span class="mh">0xacacac00acacac00</span><span class="p">,</span>
	<span class="mh">0x0a0a0a000a0a0a00</span><span class="p">,</span> <span class="mh">0x3636360036363600</span><span class="p">,</span> <span class="mh">0x4949490049494900</span><span class="p">,</span>
	<span class="mh">0x2a2a2a002a2a2a00</span><span class="p">,</span> <span class="mh">0x6868680068686800</span><span class="p">,</span> <span class="mh">0x3c3c3c003c3c3c00</span><span class="p">,</span>
	<span class="mh">0x3838380038383800</span><span class="p">,</span> <span class="mh">0xf1f1f100f1f1f100</span><span class="p">,</span> <span class="mh">0xa4a4a400a4a4a400</span><span class="p">,</span>
	<span class="mh">0x4040400040404000</span><span class="p">,</span> <span class="mh">0x2828280028282800</span><span class="p">,</span> <span class="mh">0xd3d3d300d3d3d300</span><span class="p">,</span>
	<span class="mh">0x7b7b7b007b7b7b00</span><span class="p">,</span> <span class="mh">0xbbbbbb00bbbbbb00</span><span class="p">,</span> <span class="mh">0xc9c9c900c9c9c900</span><span class="p">,</span>
	<span class="mh">0x4343430043434300</span><span class="p">,</span> <span class="mh">0xc1c1c100c1c1c100</span><span class="p">,</span> <span class="mh">0x1515150015151500</span><span class="p">,</span>
	<span class="mh">0xe3e3e300e3e3e300</span><span class="p">,</span> <span class="mh">0xadadad00adadad00</span><span class="p">,</span> <span class="mh">0xf4f4f400f4f4f400</span><span class="p">,</span>
	<span class="mh">0x7777770077777700</span><span class="p">,</span> <span class="mh">0xc7c7c700c7c7c700</span><span class="p">,</span> <span class="mh">0x8080800080808000</span><span class="p">,</span>
	<span class="mh">0x9e9e9e009e9e9e00</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* key constants */</span>
<span class="cp">#define CAMELLIA_SIGMA1L (0xA09E667FL)</span>
<span class="cp">#define CAMELLIA_SIGMA1R (0x3BCC908BL)</span>
<span class="cp">#define CAMELLIA_SIGMA2L (0xB67AE858L)</span>
<span class="cp">#define CAMELLIA_SIGMA2R (0x4CAA73B2L)</span>
<span class="cp">#define CAMELLIA_SIGMA3L (0xC6EF372FL)</span>
<span class="cp">#define CAMELLIA_SIGMA3R (0xE94F82BEL)</span>
<span class="cp">#define CAMELLIA_SIGMA4L (0x54FF53A5L)</span>
<span class="cp">#define CAMELLIA_SIGMA4R (0xF1D36F1CL)</span>
<span class="cp">#define CAMELLIA_SIGMA5L (0x10E527FAL)</span>
<span class="cp">#define CAMELLIA_SIGMA5R (0xDE682D1DL)</span>
<span class="cp">#define CAMELLIA_SIGMA6L (0xB05688C2L)</span>
<span class="cp">#define CAMELLIA_SIGMA6R (0xB3E6C1FDL)</span>

<span class="cm">/* macros */</span>
<span class="cp">#define ROLDQ(l, r, bits) ({ \</span>
<span class="cp">	u64 t = l;					\</span>
<span class="cp">	l = (l &lt;&lt; bits) | (r &gt;&gt; (64 - bits));		\</span>
<span class="cp">	r = (r &lt;&lt; bits) | (t &gt;&gt; (64 - bits));		\</span>
<span class="cp">})</span>

<span class="cp">#define CAMELLIA_F(x, kl, kr, y) ({ \</span>
<span class="cp">	u64 ii = x ^ (((u64)kl &lt;&lt; 32) | kr);				\</span>
<span class="cp">	y = camellia_sp11101110[(uint8_t)ii];				\</span>
<span class="cp">	y ^= camellia_sp44044404[(uint8_t)(ii &gt;&gt; 8)];			\</span>
<span class="cp">	ii &gt;&gt;= 16;							\</span>
<span class="cp">	y ^= camellia_sp30333033[(uint8_t)ii];				\</span>
<span class="cp">	y ^= camellia_sp02220222[(uint8_t)(ii &gt;&gt; 8)];			\</span>
<span class="cp">	ii &gt;&gt;= 16;							\</span>
<span class="cp">	y ^= camellia_sp00444404[(uint8_t)ii];				\</span>
<span class="cp">	y ^= camellia_sp03303033[(uint8_t)(ii &gt;&gt; 8)];			\</span>
<span class="cp">	ii &gt;&gt;= 16;							\</span>
<span class="cp">	y ^= camellia_sp22000222[(uint8_t)ii];				\</span>
<span class="cp">	y ^= camellia_sp10011110[(uint8_t)(ii &gt;&gt; 8)];			\</span>
<span class="cp">	y = ror64(y, 32);						\</span>
<span class="cp">})</span>

<span class="cp">#define SET_SUBKEY_LR(INDEX, sRL) (subkey[(INDEX)] = ror64((sRL), 32))</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup_tail</span><span class="p">(</span><span class="n">u64</span> <span class="o">*</span><span class="n">subkey</span><span class="p">,</span> <span class="n">u64</span> <span class="o">*</span><span class="n">subRL</span><span class="p">,</span> <span class="kt">int</span> <span class="n">max</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u64</span> <span class="n">kw4</span><span class="p">,</span> <span class="n">tt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dw</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">;</span>

	<span class="cm">/* absorb kw2 to other subkeys */</span>
	<span class="cm">/* round 2 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 4 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 6 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

	<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">;</span>
	<span class="cm">/* modified for FLinv(kl2) */</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">9</span><span class="p">])</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">,</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="cm">/* round 8 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 10 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 12 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

	<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">17</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">;</span>
	<span class="cm">/* modified for FLinv(kl4) */</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">17</span><span class="p">])</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">,</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="cm">/* round 14 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 16 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 18 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">max</span> <span class="o">==</span> <span class="mi">24</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* kw3 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

		<span class="cm">/* absorb kw4 to other subkeys */</span>
		<span class="n">kw4</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">;</span>
		<span class="cm">/* modified for FLinv(kl6) */</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">])</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">,</span>
			<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

		<span class="cm">/* round 20 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="cm">/* round 22 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="cm">/* round 24 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="cm">/* kw3 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

		<span class="cm">/* absorb kw4 to other subkeys */</span>
		<span class="n">kw4</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
		<span class="cm">/* round 23 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
		<span class="cm">/* round 21 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
		<span class="cm">/* round 19 */</span>
		<span class="n">subRL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>

		<span class="n">kw4</span> <span class="o">^=</span> <span class="p">(</span><span class="n">kw4</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">;</span>
		<span class="cm">/* modified for FL(kl5) */</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="p">(</span><span class="n">kw4</span> <span class="o">&amp;</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">])</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">,</span>
			<span class="n">kw4</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="cm">/* round 17 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
	<span class="cm">/* round 15 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
	<span class="cm">/* round 13 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>

	<span class="n">kw4</span> <span class="o">^=</span> <span class="p">(</span><span class="n">kw4</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">;</span>
	<span class="cm">/* modified for FL(kl3) */</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="p">(</span><span class="n">kw4</span> <span class="o">&amp;</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">16</span><span class="p">])</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">,</span>
		<span class="n">kw4</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="cm">/* round 11 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
	<span class="cm">/* round 9 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
	<span class="cm">/* round 7 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>

	<span class="n">kw4</span> <span class="o">^=</span> <span class="p">(</span><span class="n">kw4</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">;</span>
	<span class="cm">/* modified for FL(kl1) */</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="p">(</span><span class="n">kw4</span> <span class="o">&amp;</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">,</span>
		<span class="n">kw4</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

	<span class="cm">/* round 5 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
	<span class="cm">/* round 3 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
	<span class="cm">/* round 1 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>
	<span class="cm">/* kw1 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4</span><span class="p">;</span>

	<span class="cm">/* key XOR is end of F-function */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>			<span class="cm">/* kw1 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>				<span class="cm">/* round 1 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>			<span class="cm">/* round 2 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>			<span class="cm">/* round 3 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>			<span class="cm">/* round 4 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">7</span><span class="p">]);</span>			<span class="cm">/* round 5 */</span>

	<span class="n">tl</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>				<span class="cm">/* FL(kl1) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span> <span class="o">|</span> <span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">tl</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">));</span>

	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">tt</span><span class="p">);</span>			<span class="cm">/* round 6 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span>				<span class="cm">/* FL(kl1) */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>				<span class="cm">/* FLinv(kl2) */</span>

	<span class="n">tl</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>				<span class="cm">/* FLinv(kl2) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span> <span class="o">|</span> <span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">tl</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">));</span>

	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^</span> <span class="n">tt</span><span class="p">);</span>			<span class="cm">/* round 7 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">12</span><span class="p">]);</span>		<span class="cm">/* round 8 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">13</span><span class="p">]);</span>		<span class="cm">/* round 9 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">14</span><span class="p">]);</span>		<span class="cm">/* round 10 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">15</span><span class="p">]);</span>		<span class="cm">/* round 11 */</span>

	<span class="n">tl</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">16</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>				<span class="cm">/* FL(kl3) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span> <span class="o">|</span> <span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">tl</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">));</span>

	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">^</span> <span class="n">tt</span><span class="p">);</span>			<span class="cm">/* round 12 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">16</span><span class="p">]);</span>				<span class="cm">/* FL(kl3) */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">17</span><span class="p">]);</span>				<span class="cm">/* FLinv(kl4) */</span>

	<span class="n">tl</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">17</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>				<span class="cm">/* FLinv(kl4) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span> <span class="o">|</span> <span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">tl</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">));</span>

	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">^</span> <span class="n">tt</span><span class="p">);</span>			<span class="cm">/* round 13 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">20</span><span class="p">]);</span>		<span class="cm">/* round 14 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">21</span><span class="p">]);</span>		<span class="cm">/* round 15 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">22</span><span class="p">]);</span>		<span class="cm">/* round 16 */</span>
	<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]);</span>		<span class="cm">/* round 17 */</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">max</span> <span class="o">==</span> <span class="mi">24</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">22</span><span class="p">]);</span>			<span class="cm">/* round 18 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]);</span>	<span class="cm">/* kw3 */</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">tl</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">]);</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>			<span class="cm">/* FL(kl5) */</span>
			<span class="n">tr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span> <span class="o">|</span> <span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">tl</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">));</span>

		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">^</span> <span class="n">tt</span><span class="p">);</span>		<span class="cm">/* round 18 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">]);</span>			<span class="cm">/* FL(kl5) */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">]);</span>			<span class="cm">/* FLinv(kl6) */</span>

		<span class="n">tl</span> <span class="o">=</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">^</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">]);</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">),</span>			<span class="cm">/* FLinv(kl6) */</span>
			<span class="n">tr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">tt</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span> <span class="o">|</span> <span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">tl</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">));</span>

		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">^</span> <span class="n">tt</span><span class="p">);</span>		<span class="cm">/* round 19 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">28</span><span class="p">]);</span>	<span class="cm">/* round 20 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">29</span><span class="p">]);</span>	<span class="cm">/* round 21 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">30</span><span class="p">]);</span>	<span class="cm">/* round 22 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">31</span><span class="p">]);</span>	<span class="cm">/* round 23 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">30</span><span class="p">]);</span>			<span class="cm">/* round 24 */</span>
		<span class="n">SET_SUBKEY_LR</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">^</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">31</span><span class="p">]);</span>	<span class="cm">/* kw3 */</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup128</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="n">u64</span> <span class="o">*</span><span class="n">subkey</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u64</span> <span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">ww</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span>

	<span class="cm">/**</span>
<span class="cm">	 *  k == kl || kr (|| is concatenation)</span>
<span class="cm">	 */</span>
	<span class="n">kl</span> <span class="o">=</span> <span class="n">get_unaligned_be64</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
	<span class="n">kr</span> <span class="o">=</span> <span class="n">get_unaligned_be64</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>

	<span class="cm">/* generate KL dependent subkeys */</span>
	<span class="cm">/* kw1 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* kw2 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* rotation left shift 15bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>

	<span class="cm">/* k3 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k4 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* rotation left shift 15+30bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>

	<span class="cm">/* k7 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k8 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* rotation left shift 15+30+15bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>

	<span class="cm">/* k10 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 15+30+15+17 bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>

	<span class="cm">/* kl3 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* kl4 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* rotation left shift 15+30+15+17+17 bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>

	<span class="cm">/* k13 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k14 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* rotation left shift 15+30+15+17+17+17 bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>

	<span class="cm">/* k17 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k18 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* generate KA */</span>
	<span class="n">kl</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">kr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA1L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA1R</span><span class="p">,</span> <span class="n">ww</span><span class="p">);</span>
	<span class="n">kr</span> <span class="o">^=</span> <span class="n">ww</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA2L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA2R</span><span class="p">,</span> <span class="n">kl</span><span class="p">);</span>

	<span class="cm">/* current status == (kll, klr, w0, w1) */</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA3L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA3R</span><span class="p">,</span> <span class="n">kr</span><span class="p">);</span>
	<span class="n">kr</span> <span class="o">^=</span> <span class="n">ww</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA4L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA4R</span><span class="p">,</span> <span class="n">ww</span><span class="p">);</span>
	<span class="n">kl</span> <span class="o">^=</span> <span class="n">ww</span><span class="p">;</span>

	<span class="cm">/* generate KA dependent subkeys */</span>
	<span class="cm">/* k1, k2 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k5,k6 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* kl1, kl2 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k9 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k11, k12 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>
	<span class="cm">/* k15, k16 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* kw3, kw4 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="n">camellia_setup_tail</span><span class="p">(</span><span class="n">subkey</span><span class="p">,</span> <span class="n">subRL</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup256</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="n">u64</span> <span class="o">*</span><span class="n">subkey</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u64</span> <span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">;</span>			<span class="cm">/* left half of key */</span>
	<span class="n">u64</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">;</span>			<span class="cm">/* right half of key */</span>
	<span class="n">u64</span> <span class="n">ww</span><span class="p">;</span>				<span class="cm">/* temporary variables */</span>
	<span class="n">u64</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">34</span><span class="p">];</span>

	<span class="cm">/**</span>
<span class="cm">	 *  key = (kl || kr || krl || krr) (|| is concatenation)</span>
<span class="cm">	 */</span>
	<span class="n">kl</span> <span class="o">=</span> <span class="n">get_unaligned_be64</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
	<span class="n">kr</span> <span class="o">=</span> <span class="n">get_unaligned_be64</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">=</span> <span class="n">get_unaligned_be64</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">16</span><span class="p">);</span>
	<span class="n">krr</span> <span class="o">=</span> <span class="n">get_unaligned_be64</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">24</span><span class="p">);</span>

	<span class="cm">/* generate KL dependent subkeys */</span>
	<span class="cm">/* kw1 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* kw2 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">45</span><span class="p">);</span>
	<span class="cm">/* k9 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k10 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* kl3 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* kl4 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* k17 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k18 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>
	<span class="cm">/* k23 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k24 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* generate KR dependent subkeys */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k3 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* k4 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* kl1 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* kl2 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k13 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* k14 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>
	<span class="cm">/* k19 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* k20 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>

	<span class="cm">/* generate KA */</span>
	<span class="n">kl</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">krl</span><span class="p">;</span>
	<span class="n">kr</span> <span class="o">=</span> <span class="n">subRL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">krr</span><span class="p">;</span>

	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA1L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA1R</span><span class="p">,</span> <span class="n">ww</span><span class="p">);</span>
	<span class="n">kr</span> <span class="o">^=</span> <span class="n">ww</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA2L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA2R</span><span class="p">,</span> <span class="n">kl</span><span class="p">);</span>
	<span class="n">kl</span> <span class="o">^=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA3L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA3R</span><span class="p">,</span> <span class="n">kr</span><span class="p">);</span>
	<span class="n">kr</span> <span class="o">^=</span> <span class="n">ww</span> <span class="o">^</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA4L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA4R</span><span class="p">,</span> <span class="n">ww</span><span class="p">);</span>
	<span class="n">kl</span> <span class="o">^=</span> <span class="n">ww</span><span class="p">;</span>

	<span class="cm">/* generate KB */</span>
	<span class="n">krl</span> <span class="o">^=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="n">krr</span> <span class="o">^=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA5L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA5R</span><span class="p">,</span> <span class="n">ww</span><span class="p">);</span>
	<span class="n">krr</span> <span class="o">^=</span> <span class="n">ww</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krr</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA6L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA6R</span><span class="p">,</span> <span class="n">ww</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">^=</span> <span class="n">ww</span><span class="p">;</span>

	<span class="cm">/* generate KA dependent subkeys */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k5 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k6 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k11 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k12 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 32bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
	<span class="cm">/* kl5 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* kl6 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 17 from k11,k12 -&gt; k21,k22 */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* k21 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="n">kl</span><span class="p">;</span>
	<span class="cm">/* k22 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="n">kr</span><span class="p">;</span>

	<span class="cm">/* generate KB dependent subkeys */</span>
	<span class="cm">/* k1 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* k2 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k7 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* k8 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k15 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* k16 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="mi">51</span><span class="p">);</span>
	<span class="cm">/* kw3 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* kw4 */</span>
	<span class="n">subRL</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>

	<span class="n">camellia_setup_tail</span><span class="p">(</span><span class="n">subkey</span><span class="p">,</span> <span class="n">subRL</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup192</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="n">u64</span> <span class="o">*</span><span class="n">subkey</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">kk</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u64</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">;</span>

	<span class="n">memcpy</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
	<span class="n">memcpy</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">krl</span><span class="p">,</span> <span class="n">key</span><span class="o">+</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
	<span class="n">krr</span> <span class="o">=</span> <span class="o">~</span><span class="n">krl</span><span class="p">;</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">kk</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">krr</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
	<span class="n">camellia_setup256</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">subkey</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">__camellia_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">cctx</span><span class="p">,</span>
			     <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
			     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">key_len</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">key_len</span> <span class="o">!=</span> <span class="mi">16</span> <span class="o">&amp;&amp;</span> <span class="n">key_len</span> <span class="o">!=</span> <span class="mi">24</span> <span class="o">&amp;&amp;</span> <span class="n">key_len</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">*</span><span class="n">flags</span> <span class="o">|=</span> <span class="n">CRYPTO_TFM_RES_BAD_KEY_LEN</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_length</span> <span class="o">=</span> <span class="n">key_len</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">key_len</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">16</span>:
		<span class="n">camellia_setup128</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">24</span>:
		<span class="n">camellia_setup192</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">32</span>:
		<span class="n">camellia_setup256</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">camellia_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">in_key</span><span class="p">,</span>
			   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">key_len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__camellia_setkey</span><span class="p">(</span><span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">in_key</span><span class="p">,</span> <span class="n">key_len</span><span class="p">,</span>
				 <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">crt_flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ecb_crypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="o">*</span><span class="n">walk</span><span class="p">,</span>
		     <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fn</span><span class="p">)(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="p">),</span>
		     <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fn_2way</span><span class="p">)(</span><span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="p">))</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bsize</span> <span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_virt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">walk</span><span class="p">);</span>

	<span class="k">while</span> <span class="p">((</span><span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">nbytes</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">u8</span> <span class="o">*</span><span class="n">wsrc</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">src</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
		<span class="n">u8</span> <span class="o">*</span><span class="n">wdst</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">dst</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>

		<span class="cm">/* Process two block batch */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">do</span> <span class="p">{</span>
				<span class="n">fn_2way</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">wdst</span><span class="p">,</span> <span class="n">wsrc</span><span class="p">);</span>

				<span class="n">wsrc</span> <span class="o">+=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
				<span class="n">wdst</span> <span class="o">+=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
				<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">bsize</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">done</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="cm">/* Handle leftovers */</span>
		<span class="k">do</span> <span class="p">{</span>
			<span class="n">fn</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">wdst</span><span class="p">,</span> <span class="n">wsrc</span><span class="p">);</span>

			<span class="n">wsrc</span> <span class="o">+=</span> <span class="n">bsize</span><span class="p">;</span>
			<span class="n">wdst</span> <span class="o">+=</span> <span class="n">bsize</span><span class="p">;</span>
			<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span><span class="p">);</span>

<span class="nl">done:</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_done</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">walk</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ecb_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="n">walk</span><span class="p">;</span>

	<span class="n">blkcipher_walk_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ecb_crypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">camellia_enc_blk</span><span class="p">,</span> <span class="n">camellia_enc_blk_2way</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ecb_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="n">walk</span><span class="p">;</span>

	<span class="n">blkcipher_walk_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ecb_crypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">camellia_dec_blk</span><span class="p">,</span> <span class="n">camellia_dec_blk_2way</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">__cbc_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="o">*</span><span class="n">walk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bsize</span> <span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">nbytes</span><span class="p">;</span>
	<span class="n">u128</span> <span class="o">*</span><span class="n">src</span> <span class="o">=</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">src</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="n">u128</span> <span class="o">*</span><span class="n">dst</span> <span class="o">=</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">dst</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="n">u128</span> <span class="o">*</span><span class="n">iv</span> <span class="o">=</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">;</span>

	<span class="k">do</span> <span class="p">{</span>
		<span class="n">u128_xor</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">iv</span><span class="p">);</span>
		<span class="n">camellia_enc_blk</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">dst</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">dst</span><span class="p">);</span>
		<span class="n">iv</span> <span class="o">=</span> <span class="n">dst</span><span class="p">;</span>

		<span class="n">src</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">dst</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span><span class="p">);</span>

	<span class="n">u128_xor</span><span class="p">((</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">,</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">,</span> <span class="n">iv</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">nbytes</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">cbc_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="n">walk</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">blkcipher_walk_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_virt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">);</span>

	<span class="k">while</span> <span class="p">((</span><span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="p">.</span><span class="n">nbytes</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">nbytes</span> <span class="o">=</span> <span class="n">__cbc_encrypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">);</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_done</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">__cbc_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="o">*</span><span class="n">walk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bsize</span> <span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">nbytes</span><span class="p">;</span>
	<span class="n">u128</span> <span class="o">*</span><span class="n">src</span> <span class="o">=</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">src</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="n">u128</span> <span class="o">*</span><span class="n">dst</span> <span class="o">=</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">dst</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="n">u128</span> <span class="n">ivs</span><span class="p">[</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">u128</span> <span class="n">last_iv</span><span class="p">;</span>

	<span class="cm">/* Start of the last block. */</span>
	<span class="n">src</span> <span class="o">+=</span> <span class="n">nbytes</span> <span class="o">/</span> <span class="n">bsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">dst</span> <span class="o">+=</span> <span class="n">nbytes</span> <span class="o">/</span> <span class="n">bsize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">last_iv</span> <span class="o">=</span> <span class="o">*</span><span class="n">src</span><span class="p">;</span>

	<span class="cm">/* Process two block batch */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">do</span> <span class="p">{</span>
			<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">src</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">dst</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>

			<span class="n">ivs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

			<span class="n">camellia_dec_blk_2way</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">dst</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">src</span><span class="p">);</span>

			<span class="n">u128_xor</span><span class="p">(</span><span class="n">dst</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dst</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ivs</span> <span class="o">+</span> <span class="mi">0</span><span class="p">);</span>

			<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">bsize</span><span class="p">)</span>
				<span class="k">goto</span> <span class="n">done</span><span class="p">;</span>

			<span class="n">u128_xor</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
			<span class="n">src</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">dst</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">bsize</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">done</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* Handle leftovers */</span>
	<span class="k">for</span> <span class="p">(;;)</span> <span class="p">{</span>
		<span class="n">camellia_dec_blk</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">dst</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">src</span><span class="p">);</span>

		<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">bsize</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>

		<span class="n">u128_xor</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">src</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">dst</span> <span class="o">-=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

<span class="nl">done:</span>
	<span class="n">u128_xor</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">);</span>
	<span class="o">*</span><span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span> <span class="o">=</span> <span class="n">last_iv</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">nbytes</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">cbc_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="n">walk</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">blkcipher_walk_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_virt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">);</span>

	<span class="k">while</span> <span class="p">((</span><span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="p">.</span><span class="n">nbytes</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">nbytes</span> <span class="o">=</span> <span class="n">__cbc_decrypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">);</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_done</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">u128_to_be128</span><span class="p">(</span><span class="n">be128</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u128</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">dst</span><span class="o">-&gt;</span><span class="n">a</span> <span class="o">=</span> <span class="n">cpu_to_be64</span><span class="p">(</span><span class="n">src</span><span class="o">-&gt;</span><span class="n">a</span><span class="p">);</span>
	<span class="n">dst</span><span class="o">-&gt;</span><span class="n">b</span> <span class="o">=</span> <span class="n">cpu_to_be64</span><span class="p">(</span><span class="n">src</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">be128_to_u128</span><span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">be128</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">dst</span><span class="o">-&gt;</span><span class="n">a</span> <span class="o">=</span> <span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="o">-&gt;</span><span class="n">a</span><span class="p">);</span>
	<span class="n">dst</span><span class="o">-&gt;</span><span class="n">b</span> <span class="o">=</span> <span class="n">be64_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">u128_inc</span><span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">i</span><span class="o">-&gt;</span><span class="n">b</span><span class="o">++</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">i</span><span class="o">-&gt;</span><span class="n">b</span><span class="p">)</span>
		<span class="n">i</span><span class="o">-&gt;</span><span class="n">a</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ctr_crypt_final</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="o">*</span><span class="n">walk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="n">u8</span> <span class="n">keystream</span><span class="p">[</span><span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">];</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">src</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">src</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">dst</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">dst</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">nbytes</span><span class="p">;</span>
	<span class="n">u128</span> <span class="n">ctrblk</span><span class="p">;</span>

	<span class="n">memcpy</span><span class="p">(</span><span class="n">keystream</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="n">camellia_enc_blk_xor</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">keystream</span><span class="p">,</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">);</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">keystream</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>

	<span class="n">be128_to_u128</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">,</span> <span class="p">(</span><span class="n">be128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">);</span>
	<span class="n">u128_inc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>
	<span class="n">u128_to_be128</span><span class="p">((</span><span class="n">be128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">__ctr_crypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="o">*</span><span class="n">walk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bsize</span> <span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="o">-&gt;</span><span class="n">nbytes</span><span class="p">;</span>
	<span class="n">u128</span> <span class="o">*</span><span class="n">src</span> <span class="o">=</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">src</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="n">u128</span> <span class="o">*</span><span class="n">dst</span> <span class="o">=</span> <span class="p">(</span><span class="n">u128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">dst</span><span class="p">.</span><span class="n">virt</span><span class="p">.</span><span class="n">addr</span><span class="p">;</span>
	<span class="n">u128</span> <span class="n">ctrblk</span><span class="p">;</span>
	<span class="n">be128</span> <span class="n">ctrblocks</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

	<span class="n">be128_to_u128</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">,</span> <span class="p">(</span><span class="n">be128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">);</span>

	<span class="cm">/* Process two block batch */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">do</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">dst</span> <span class="o">!=</span> <span class="n">src</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
				<span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
			<span class="p">}</span>

			<span class="cm">/* create ctrblks for parallel encrypt */</span>
			<span class="n">u128_to_be128</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblocks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>
			<span class="n">u128_inc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>
			<span class="n">u128_to_be128</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblocks</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>
			<span class="n">u128_inc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>

			<span class="n">camellia_enc_blk_xor_2way</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">dst</span><span class="p">,</span>
						 <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">ctrblocks</span><span class="p">);</span>

			<span class="n">src</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
			<span class="n">dst</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
			<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&lt;</span> <span class="n">bsize</span><span class="p">)</span>
			<span class="k">goto</span> <span class="n">done</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* Handle leftovers */</span>
	<span class="k">do</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">dst</span> <span class="o">!=</span> <span class="n">src</span><span class="p">)</span>
			<span class="o">*</span><span class="n">dst</span> <span class="o">=</span> <span class="o">*</span><span class="n">src</span><span class="p">;</span>

		<span class="n">u128_to_be128</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblocks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>
		<span class="n">u128_inc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>

		<span class="n">camellia_enc_blk_xor</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">dst</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">ctrblocks</span><span class="p">);</span>

		<span class="n">src</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">dst</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="n">bsize</span><span class="p">);</span>

<span class="nl">done:</span>
	<span class="n">u128_to_be128</span><span class="p">((</span><span class="n">be128</span> <span class="o">*</span><span class="p">)</span><span class="n">walk</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ctrblk</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">nbytes</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ctr_crypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		     <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">blkcipher_walk</span> <span class="n">walk</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">blkcipher_walk_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_virt_block</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">);</span>

	<span class="k">while</span> <span class="p">((</span><span class="n">nbytes</span> <span class="o">=</span> <span class="n">walk</span><span class="p">.</span><span class="n">nbytes</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">nbytes</span> <span class="o">=</span> <span class="n">__ctr_crypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">);</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_done</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">walk</span><span class="p">.</span><span class="n">nbytes</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ctr_crypt_final</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">);</span>
		<span class="n">err</span> <span class="o">=</span> <span class="n">blkcipher_walk_done</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">walk</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">encrypt_callback</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">srcdst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bsize</span> <span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">priv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bsize</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">camellia_enc_blk_2way</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">);</span>
		<span class="n">srcdst</span> <span class="o">+=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
		<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbytes</span> <span class="o">/</span> <span class="n">bsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">,</span> <span class="n">srcdst</span> <span class="o">+=</span> <span class="n">bsize</span><span class="p">)</span>
		<span class="n">camellia_enc_blk</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">decrypt_callback</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">srcdst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bsize</span> <span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">priv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">nbytes</span> <span class="o">&gt;=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">bsize</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">camellia_dec_blk_2way</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">);</span>
		<span class="n">srcdst</span> <span class="o">+=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
		<span class="n">nbytes</span> <span class="o">-=</span> <span class="n">bsize</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nbytes</span> <span class="o">/</span> <span class="n">bsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">,</span> <span class="n">srcdst</span> <span class="o">+=</span> <span class="n">bsize</span><span class="p">)</span>
		<span class="n">camellia_dec_blk</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">,</span> <span class="n">srcdst</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">camellia_lrw_ctx</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">lrw_table_ctx</span> <span class="n">lrw_table</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="n">camellia_ctx</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">lrw_camellia_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_lrw_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="n">__camellia_setkey</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">camellia_ctx</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span>
				<span class="n">keylen</span> <span class="o">-</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
				<span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">crt_flags</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">lrw_init_table</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">lrw_table</span><span class="p">,</span>
			      <span class="n">key</span> <span class="o">+</span> <span class="n">keylen</span> <span class="o">-</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">lrw_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_lrw_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="n">be128</span> <span class="n">buf</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">lrw_crypt_req</span> <span class="n">req</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">tbuf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">,</span>
		<span class="p">.</span><span class="n">tbuflen</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">),</span>

		<span class="p">.</span><span class="n">table_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">lrw_table</span><span class="p">,</span>
		<span class="p">.</span><span class="n">crypt_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">camellia_ctx</span><span class="p">,</span>
		<span class="p">.</span><span class="n">crypt_fn</span> <span class="o">=</span> <span class="n">encrypt_callback</span><span class="p">,</span>
	<span class="p">};</span>

	<span class="k">return</span> <span class="n">lrw_crypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">lrw_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_lrw_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="n">be128</span> <span class="n">buf</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">lrw_crypt_req</span> <span class="n">req</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">tbuf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">,</span>
		<span class="p">.</span><span class="n">tbuflen</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">),</span>

		<span class="p">.</span><span class="n">table_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">lrw_table</span><span class="p">,</span>
		<span class="p">.</span><span class="n">crypt_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">camellia_ctx</span><span class="p">,</span>
		<span class="p">.</span><span class="n">crypt_fn</span> <span class="o">=</span> <span class="n">decrypt_callback</span><span class="p">,</span>
	<span class="p">};</span>

	<span class="k">return</span> <span class="n">lrw_crypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">lrw_exit_tfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_lrw_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>

	<span class="n">lrw_free_table</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">lrw_table</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">camellia_xts_ctx</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="n">tweak_ctx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="n">crypt_ctx</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">xts_camellia_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_xts_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">flags</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">crt_flags</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="cm">/* key consists of keys of equal size concatenated, therefore</span>
<span class="cm">	 * the length must be even</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">keylen</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">*</span><span class="n">flags</span> <span class="o">|=</span> <span class="n">CRYPTO_TFM_RES_BAD_KEY_LEN</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* first half of xts-key is for crypt */</span>
	<span class="n">err</span> <span class="o">=</span> <span class="n">__camellia_setkey</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">crypt_ctx</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">keylen</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">err</span><span class="p">;</span>

	<span class="cm">/* second half of xts-key is for tweak */</span>
	<span class="k">return</span> <span class="n">__camellia_setkey</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">tweak_ctx</span><span class="p">,</span> <span class="n">key</span> <span class="o">+</span> <span class="n">keylen</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">keylen</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
				<span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">xts_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_xts_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="n">be128</span> <span class="n">buf</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">xts_crypt_req</span> <span class="n">req</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">tbuf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">,</span>
		<span class="p">.</span><span class="n">tbuflen</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">),</span>

		<span class="p">.</span><span class="n">tweak_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">tweak_ctx</span><span class="p">,</span>
		<span class="p">.</span><span class="n">tweak_fn</span> <span class="o">=</span> <span class="n">XTS_TWEAK_CAST</span><span class="p">(</span><span class="n">camellia_enc_blk</span><span class="p">),</span>
		<span class="p">.</span><span class="n">crypt_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">crypt_ctx</span><span class="p">,</span>
		<span class="p">.</span><span class="n">crypt_fn</span> <span class="o">=</span> <span class="n">encrypt_callback</span><span class="p">,</span>
	<span class="p">};</span>

	<span class="k">return</span> <span class="n">xts_crypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">xts_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_xts_ctx</span> <span class="o">*</span><span class="n">ctx</span> <span class="o">=</span> <span class="n">crypto_blkcipher_ctx</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">);</span>
	<span class="n">be128</span> <span class="n">buf</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">xts_crypt_req</span> <span class="n">req</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">tbuf</span> <span class="o">=</span> <span class="n">buf</span><span class="p">,</span>
		<span class="p">.</span><span class="n">tbuflen</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">),</span>

		<span class="p">.</span><span class="n">tweak_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">tweak_ctx</span><span class="p">,</span>
		<span class="p">.</span><span class="n">tweak_fn</span> <span class="o">=</span> <span class="n">XTS_TWEAK_CAST</span><span class="p">(</span><span class="n">camellia_enc_blk</span><span class="p">),</span>
		<span class="p">.</span><span class="n">crypt_ctx</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">crypt_ctx</span><span class="p">,</span>
		<span class="p">.</span><span class="n">crypt_fn</span> <span class="o">=</span> <span class="n">decrypt_callback</span><span class="p">,</span>
	<span class="p">};</span>

	<span class="k">return</span> <span class="n">xts_crypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">crypto_alg</span> <span class="n">camellia_algs</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cra_name</span>		<span class="o">=</span> <span class="s">&quot;camellia&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_driver_name</span>	<span class="o">=</span> <span class="s">&quot;camellia-asm&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_priority</span>		<span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_flags</span>		<span class="o">=</span> <span class="n">CRYPTO_ALG_TYPE_CIPHER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_blocksize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_ctxsize</span>		<span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_alignmask</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_module</span>		<span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_list</span>		<span class="o">=</span> <span class="n">LIST_HEAD_INIT</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cra_list</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_u</span>			<span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">cipher</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">cia_min_keysize</span> <span class="o">=</span> <span class="n">CAMELLIA_MIN_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_max_keysize</span> <span class="o">=</span> <span class="n">CAMELLIA_MAX_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_setkey</span>	 <span class="o">=</span> <span class="n">camellia_setkey</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_encrypt</span>	 <span class="o">=</span> <span class="n">camellia_encrypt</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_decrypt</span>	 <span class="o">=</span> <span class="n">camellia_decrypt</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cra_name</span>		<span class="o">=</span> <span class="s">&quot;ecb(camellia)&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_driver_name</span>	<span class="o">=</span> <span class="s">&quot;ecb-camellia-asm&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_priority</span>		<span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_flags</span>		<span class="o">=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_blocksize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_ctxsize</span>		<span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_alignmask</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_type</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">crypto_blkcipher_type</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_module</span>		<span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_list</span>		<span class="o">=</span> <span class="n">LIST_HEAD_INIT</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">cra_list</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_u</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">blkcipher</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">min_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MIN_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">max_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MAX_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">setkey</span>		<span class="o">=</span> <span class="n">camellia_setkey</span><span class="p">,</span>
			<span class="p">.</span><span class="n">encrypt</span>	<span class="o">=</span> <span class="n">ecb_encrypt</span><span class="p">,</span>
			<span class="p">.</span><span class="n">decrypt</span>	<span class="o">=</span> <span class="n">ecb_decrypt</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">},</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cra_name</span>		<span class="o">=</span> <span class="s">&quot;cbc(camellia)&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_driver_name</span>	<span class="o">=</span> <span class="s">&quot;cbc-camellia-asm&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_priority</span>		<span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_flags</span>		<span class="o">=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_blocksize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_ctxsize</span>		<span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_alignmask</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_type</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">crypto_blkcipher_type</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_module</span>		<span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_list</span>		<span class="o">=</span> <span class="n">LIST_HEAD_INIT</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">cra_list</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_u</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">blkcipher</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">min_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MIN_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">max_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MAX_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">ivsize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">setkey</span>		<span class="o">=</span> <span class="n">camellia_setkey</span><span class="p">,</span>
			<span class="p">.</span><span class="n">encrypt</span>	<span class="o">=</span> <span class="n">cbc_encrypt</span><span class="p">,</span>
			<span class="p">.</span><span class="n">decrypt</span>	<span class="o">=</span> <span class="n">cbc_decrypt</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">},</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cra_name</span>		<span class="o">=</span> <span class="s">&quot;ctr(camellia)&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_driver_name</span>	<span class="o">=</span> <span class="s">&quot;ctr-camellia-asm&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_priority</span>		<span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_flags</span>		<span class="o">=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_blocksize</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_ctxsize</span>		<span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_alignmask</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_type</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">crypto_blkcipher_type</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_module</span>		<span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_list</span>		<span class="o">=</span> <span class="n">LIST_HEAD_INIT</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">cra_list</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_u</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">blkcipher</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">min_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MIN_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">max_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MAX_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">ivsize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">setkey</span>		<span class="o">=</span> <span class="n">camellia_setkey</span><span class="p">,</span>
			<span class="p">.</span><span class="n">encrypt</span>	<span class="o">=</span> <span class="n">ctr_crypt</span><span class="p">,</span>
			<span class="p">.</span><span class="n">decrypt</span>	<span class="o">=</span> <span class="n">ctr_crypt</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">},</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cra_name</span>		<span class="o">=</span> <span class="s">&quot;lrw(camellia)&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_driver_name</span>	<span class="o">=</span> <span class="s">&quot;lrw-camellia-asm&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_priority</span>		<span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_flags</span>		<span class="o">=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_blocksize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_ctxsize</span>		<span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_lrw_ctx</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_alignmask</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_type</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">crypto_blkcipher_type</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_module</span>		<span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_list</span>		<span class="o">=</span> <span class="n">LIST_HEAD_INIT</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">cra_list</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_exit</span>		<span class="o">=</span> <span class="n">lrw_exit_tfm</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_u</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">blkcipher</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">min_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MIN_KEY_SIZE</span> <span class="o">+</span>
						<span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">max_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MAX_KEY_SIZE</span> <span class="o">+</span>
						<span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">ivsize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">setkey</span>		<span class="o">=</span> <span class="n">lrw_camellia_setkey</span><span class="p">,</span>
			<span class="p">.</span><span class="n">encrypt</span>	<span class="o">=</span> <span class="n">lrw_encrypt</span><span class="p">,</span>
			<span class="p">.</span><span class="n">decrypt</span>	<span class="o">=</span> <span class="n">lrw_decrypt</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">},</span>
<span class="p">},</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cra_name</span>		<span class="o">=</span> <span class="s">&quot;xts(camellia)&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_driver_name</span>	<span class="o">=</span> <span class="s">&quot;xts-camellia-asm&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_priority</span>		<span class="o">=</span> <span class="mi">300</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_flags</span>		<span class="o">=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_blocksize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_ctxsize</span>		<span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_xts_ctx</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_alignmask</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_type</span>		<span class="o">=</span> <span class="o">&amp;</span><span class="n">crypto_blkcipher_type</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_module</span>		<span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_list</span>		<span class="o">=</span> <span class="n">LIST_HEAD_INIT</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">cra_list</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_u</span> <span class="o">=</span> <span class="p">{</span>
		<span class="p">.</span><span class="n">blkcipher</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">min_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MIN_KEY_SIZE</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">max_keysize</span>	<span class="o">=</span> <span class="n">CAMELLIA_MAX_KEY_SIZE</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
			<span class="p">.</span><span class="n">ivsize</span>		<span class="o">=</span> <span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">setkey</span>		<span class="o">=</span> <span class="n">xts_camellia_setkey</span><span class="p">,</span>
			<span class="p">.</span><span class="n">encrypt</span>	<span class="o">=</span> <span class="n">xts_encrypt</span><span class="p">,</span>
			<span class="p">.</span><span class="n">decrypt</span>	<span class="o">=</span> <span class="n">xts_decrypt</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">},</span>
<span class="p">}</span> <span class="p">};</span>

<span class="k">static</span> <span class="n">bool</span> <span class="nf">is_blacklisted_cpu</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">boot_cpu_data</span><span class="p">.</span><span class="n">x86_vendor</span> <span class="o">!=</span> <span class="n">X86_VENDOR_INTEL</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">boot_cpu_data</span><span class="p">.</span><span class="n">x86</span> <span class="o">==</span> <span class="mh">0x0f</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/*</span>
<span class="cm">		 * On Pentium 4, camellia-asm is slower than original assembler</span>
<span class="cm">		 * implementation because excessive uses of 64bit rotate and</span>
<span class="cm">		 * left-shifts (which are really slow on P4) needed to store and</span>
<span class="cm">		 * handle 128bit block in two 64bit registers.</span>
<span class="cm">		 */</span>
		<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">force</span><span class="p">;</span>
<span class="n">module_param</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">MODULE_PARM_DESC</span><span class="p">(</span><span class="n">force</span><span class="p">,</span> <span class="s">&quot;Force module load, ignore CPU blacklist&quot;</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">force</span> <span class="o">&amp;&amp;</span> <span class="n">is_blacklisted_cpu</span><span class="p">())</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span>
			<span class="s">&quot;camellia-x86_64: performance on this CPU &quot;</span>
			<span class="s">&quot;would be suboptimal: disabling &quot;</span>
			<span class="s">&quot;camellia-x86_64.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">crypto_register_algs</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">fini</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_unregister_algs</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">,</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">camellia_algs</span><span class="p">));</span>
<span class="p">}</span>

<span class="n">module_init</span><span class="p">(</span><span class="n">init</span><span class="p">);</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">fini</span><span class="p">);</span>

<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>
<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;Camellia Cipher Algorithm, asm optimized&quot;</span><span class="p">);</span>
<span class="n">MODULE_ALIAS</span><span class="p">(</span><span class="s">&quot;camellia&quot;</span><span class="p">);</span>
<span class="n">MODULE_ALIAS</span><span class="p">(</span><span class="s">&quot;camellia-asm&quot;</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
