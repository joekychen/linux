<!DOCTYPE html>
<html><head><title>joekychen/linux » arch › x86 › kvm › trace.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>trace.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#if !defined(_TRACE_KVM_H) || defined(TRACE_HEADER_MULTI_READ)</span>
<span class="cp">#define _TRACE_KVM_H</span>

<span class="cp">#include &lt;linux/tracepoint.h&gt;</span>
<span class="cp">#include &lt;asm/vmx.h&gt;</span>
<span class="cp">#include &lt;asm/svm.h&gt;</span>

<span class="cp">#undef TRACE_SYSTEM</span>
<span class="cp">#define TRACE_SYSTEM kvm</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for guest mode entry.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_entry</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vcpu_id</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">vcpu_id</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">vcpu_id</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">vcpu_id</span>	<span class="o">=</span> <span class="n">vcpu_id</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;vcpu %u&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">vcpu_id</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for hypercall.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_hypercall</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">nr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a0</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a1</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a3</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">nr</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> 	<span class="n">nr</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">a0</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">a1</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">a2</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">a3</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nr</span>		<span class="o">=</span> <span class="n">nr</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a0</span>		<span class="o">=</span> <span class="n">a0</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a1</span>		<span class="o">=</span> <span class="n">a1</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a2</span>		<span class="o">=</span> <span class="n">a2</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a3</span>		<span class="o">=</span> <span class="n">a3</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;nr 0x%lx a0 0x%lx a1 0x%lx a2 0x%lx a3 0x%lx&quot;</span><span class="p">,</span>
		 <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nr</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a0</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a1</span><span class="p">,</span>  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a2</span><span class="p">,</span>
		 <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">a3</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for hypercall.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_hv_hypercall</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u16</span> <span class="n">code</span><span class="p">,</span> <span class="n">bool</span> <span class="n">fast</span><span class="p">,</span> <span class="n">__u16</span> <span class="n">rep_cnt</span><span class="p">,</span> <span class="n">__u16</span> <span class="n">rep_idx</span><span class="p">,</span>
		 <span class="n">__u64</span> <span class="n">ingpa</span><span class="p">,</span> <span class="n">__u64</span> <span class="n">outgpa</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">fast</span><span class="p">,</span> <span class="n">rep_cnt</span><span class="p">,</span> <span class="n">rep_idx</span><span class="p">,</span> <span class="n">ingpa</span><span class="p">,</span> <span class="n">outgpa</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u16</span><span class="p">,</span>		<span class="n">rep_cnt</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u16</span><span class="p">,</span>		<span class="n">rep_idx</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">ingpa</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">outgpa</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u16</span><span class="p">,</span> 		<span class="n">code</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">bool</span><span class="p">,</span>		<span class="n">fast</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rep_cnt</span>	<span class="o">=</span> <span class="n">rep_cnt</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rep_idx</span>	<span class="o">=</span> <span class="n">rep_idx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ingpa</span>		<span class="o">=</span> <span class="n">ingpa</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">outgpa</span>		<span class="o">=</span> <span class="n">outgpa</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">code</span>		<span class="o">=</span> <span class="n">code</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fast</span>		<span class="o">=</span> <span class="n">fast</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;code 0x%x %s cnt 0x%x idx 0x%x in 0x%llx out 0x%llx&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">code</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fast</span> <span class="o">?</span> <span class="s">&quot;fast&quot;</span> <span class="o">:</span> <span class="s">&quot;slow&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rep_cnt</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rep_idx</span><span class="p">,</span>  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ingpa</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">outgpa</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for PIO.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_pio</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rw</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">port</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">count</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">count</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> 	<span class="n">rw</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> 	<span class="n">port</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> 	<span class="n">size</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">count</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rw</span>		<span class="o">=</span> <span class="n">rw</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">port</span>		<span class="o">=</span> <span class="n">port</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span>		<span class="o">=</span> <span class="n">size</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span>		<span class="o">=</span> <span class="n">count</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;pio_%s at 0x%x size %d count %d&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rw</span> <span class="o">?</span> <span class="s">&quot;write&quot;</span> <span class="o">:</span> <span class="s">&quot;read&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">port</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">size</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for cpuid.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_cpuid</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">function</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rax</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rbx</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rcx</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rdx</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">rax</span><span class="p">,</span> <span class="n">rbx</span><span class="p">,</span> <span class="n">rcx</span><span class="p">,</span> <span class="n">rdx</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">function</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">rax</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">rbx</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">rcx</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">rdx</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">function</span>	<span class="o">=</span> <span class="n">function</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rax</span>		<span class="o">=</span> <span class="n">rax</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rbx</span>		<span class="o">=</span> <span class="n">rbx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcx</span>		<span class="o">=</span> <span class="n">rcx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rdx</span>		<span class="o">=</span> <span class="n">rdx</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;func %x rax %lx rbx %lx rcx %lx rdx %lx&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">function</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rax</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rbx</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcx</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rdx</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define AREG(x) { APIC_##x, &quot;APIC_&quot; #x }</span>

<span class="cp">#define kvm_trace_symbol_apic						    \</span>
<span class="cp">	AREG(ID), AREG(LVR), AREG(TASKPRI), AREG(ARBPRI), AREG(PROCPRI),    \</span>
<span class="cp">	AREG(EOI), AREG(RRR), AREG(LDR), AREG(DFR), AREG(SPIV), AREG(ISR),  \</span>
<span class="cp">	AREG(TMR), AREG(IRR), AREG(ESR), AREG(ICR), AREG(ICR2), AREG(LVTT), \</span>
<span class="cp">	AREG(LVTTHMR), AREG(LVTPC), AREG(LVT0), AREG(LVT1), AREG(LVTERR),   \</span>
<span class="cp">	AREG(TMICT), AREG(TMCCT), AREG(TDCR), AREG(SELF_IPI), AREG(EFEAT),  \</span>
<span class="cp">	AREG(ECTRL)</span>
<span class="cm">/*</span>
<span class="cm"> * Tracepoint for apic access.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_apic</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rw</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">val</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">val</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">rw</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">reg</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">val</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rw</span>		<span class="o">=</span> <span class="n">rw</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">reg</span>		<span class="o">=</span> <span class="n">reg</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">val</span>		<span class="o">=</span> <span class="n">val</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;apic_%s %s = 0x%x&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rw</span> <span class="o">?</span> <span class="s">&quot;write&quot;</span> <span class="o">:</span> <span class="s">&quot;read&quot;</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">reg</span><span class="p">,</span> <span class="n">kvm_trace_symbol_apic</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define trace_kvm_apic_read(reg, val)		trace_kvm_apic(0, reg, val)</span>
<span class="cp">#define trace_kvm_apic_write(reg, val)		trace_kvm_apic(1, reg, val)</span>

<span class="cp">#define KVM_ISA_VMX   1</span>
<span class="cp">#define KVM_ISA_SVM   2</span>

<span class="cp">#define VMX_EXIT_REASONS \</span>
<span class="cp">	{ EXIT_REASON_EXCEPTION_NMI,		&quot;EXCEPTION_NMI&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_EXTERNAL_INTERRUPT,	&quot;EXTERNAL_INTERRUPT&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_TRIPLE_FAULT,		&quot;TRIPLE_FAULT&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_PENDING_INTERRUPT,	&quot;PENDING_INTERRUPT&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_NMI_WINDOW,		&quot;NMI_WINDOW&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_TASK_SWITCH,		&quot;TASK_SWITCH&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_CPUID,			&quot;CPUID&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_HLT,			&quot;HLT&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_INVLPG,			&quot;INVLPG&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_RDPMC,			&quot;RDPMC&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_RDTSC,			&quot;RDTSC&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMCALL,			&quot;VMCALL&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMCLEAR,			&quot;VMCLEAR&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMLAUNCH,			&quot;VMLAUNCH&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMPTRLD,			&quot;VMPTRLD&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMPTRST,			&quot;VMPTRST&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMREAD,			&quot;VMREAD&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMRESUME,			&quot;VMRESUME&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMWRITE,			&quot;VMWRITE&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMOFF,			&quot;VMOFF&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_VMON,			&quot;VMON&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_CR_ACCESS,		&quot;CR_ACCESS&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_DR_ACCESS,		&quot;DR_ACCESS&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_IO_INSTRUCTION,		&quot;IO_INSTRUCTION&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_MSR_READ,			&quot;MSR_READ&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_MSR_WRITE,		&quot;MSR_WRITE&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_MWAIT_INSTRUCTION,	&quot;MWAIT_INSTRUCTION&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_MONITOR_INSTRUCTION,	&quot;MONITOR_INSTRUCTION&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_PAUSE_INSTRUCTION,	&quot;PAUSE_INSTRUCTION&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_MCE_DURING_VMENTRY,	&quot;MCE_DURING_VMENTRY&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_TPR_BELOW_THRESHOLD,	&quot;TPR_BELOW_THRESHOLD&quot; },	\</span>
<span class="cp">	{ EXIT_REASON_APIC_ACCESS,		&quot;APIC_ACCESS&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_EPT_VIOLATION,		&quot;EPT_VIOLATION&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_EPT_MISCONFIG,		&quot;EPT_MISCONFIG&quot; }, \</span>
<span class="cp">	{ EXIT_REASON_WBINVD,			&quot;WBINVD&quot; }</span>

<span class="cp">#define SVM_EXIT_REASONS \</span>
<span class="cp">	{ SVM_EXIT_READ_CR0,			&quot;read_cr0&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_READ_CR3,			&quot;read_cr3&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_READ_CR4,			&quot;read_cr4&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_READ_CR8,			&quot;read_cr8&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_CR0,			&quot;write_cr0&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_CR3,			&quot;write_cr3&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_CR4,			&quot;write_cr4&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_CR8,			&quot;write_cr8&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_READ_DR0,			&quot;read_dr0&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_READ_DR1,			&quot;read_dr1&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_READ_DR2,			&quot;read_dr2&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_READ_DR3,			&quot;read_dr3&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_DR0,			&quot;write_dr0&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_DR1,			&quot;write_dr1&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_DR2,			&quot;write_dr2&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_DR3,			&quot;write_dr3&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_DR5,			&quot;write_dr5&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WRITE_DR7,			&quot;write_dr7&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_EXCP_BASE + DB_VECTOR,	&quot;DB excp&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_EXCP_BASE + BP_VECTOR,	&quot;BP excp&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_EXCP_BASE + UD_VECTOR,	&quot;UD excp&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_EXCP_BASE + PF_VECTOR,	&quot;PF excp&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_EXCP_BASE + NM_VECTOR,	&quot;NM excp&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_EXCP_BASE + MC_VECTOR,	&quot;MC excp&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_INTR,			&quot;interrupt&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_NMI,				&quot;nmi&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_SMI,				&quot;smi&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_INIT,			&quot;init&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_VINTR,			&quot;vintr&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_CPUID,			&quot;cpuid&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_INVD,			&quot;invd&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_HLT,				&quot;hlt&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_INVLPG,			&quot;invlpg&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_INVLPGA,			&quot;invlpga&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_IOIO,			&quot;io&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_MSR,				&quot;msr&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_TASK_SWITCH,			&quot;task_switch&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_SHUTDOWN,			&quot;shutdown&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_VMRUN,			&quot;vmrun&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_VMMCALL,			&quot;hypercall&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_VMLOAD,			&quot;vmload&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_VMSAVE,			&quot;vmsave&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_STGI,			&quot;stgi&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_CLGI,			&quot;clgi&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_SKINIT,			&quot;skinit&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_WBINVD,			&quot;wbinvd&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_MONITOR,			&quot;monitor&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_MWAIT,			&quot;mwait&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_XSETBV,			&quot;xsetbv&quot; }, \</span>
<span class="cp">	{ SVM_EXIT_NPF,				&quot;npf&quot; }</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for kvm guest exit:</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_exit</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">exit_reason</span><span class="p">,</span> <span class="k">struct</span> <span class="n">kvm_vcpu</span> <span class="o">*</span><span class="n">vcpu</span><span class="p">,</span> <span class="n">u32</span> <span class="n">isa</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">exit_reason</span><span class="p">,</span> <span class="n">vcpu</span><span class="p">,</span> <span class="n">isa</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">exit_reason</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">guest_rip</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u32</span><span class="p">,</span>	        <span class="n">isa</span>             <span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u64</span><span class="p">,</span>	        <span class="n">info1</span>           <span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u64</span><span class="p">,</span>	        <span class="n">info2</span>           <span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_reason</span>	<span class="o">=</span> <span class="n">exit_reason</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">guest_rip</span>	<span class="o">=</span> <span class="n">kvm_rip_read</span><span class="p">(</span><span class="n">vcpu</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isa</span>            <span class="o">=</span> <span class="n">isa</span><span class="p">;</span>
		<span class="n">kvm_x86_ops</span><span class="o">-&gt;</span><span class="n">get_exit_info</span><span class="p">(</span><span class="n">vcpu</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">info1</span><span class="p">,</span>
					   <span class="o">&amp;</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">info2</span><span class="p">);</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;reason %s rip 0x%lx info %llx %llx&quot;</span><span class="p">,</span>
		 <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isa</span> <span class="o">==</span> <span class="n">KVM_ISA_VMX</span><span class="p">)</span> <span class="o">?</span>
		 <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_reason</span><span class="p">,</span> <span class="n">VMX_EXIT_REASONS</span><span class="p">)</span> <span class="o">:</span>
		 <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_reason</span><span class="p">,</span> <span class="n">SVM_EXIT_REASONS</span><span class="p">),</span>
		 <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">guest_rip</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">info1</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">info2</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for kvm interrupt injection:</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_inj_virq</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">irq</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">irq</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">irq</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">irq</span>		<span class="o">=</span> <span class="n">irq</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;irq %u&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">irq</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define EXS(x) { x##_VECTOR, &quot;#&quot; #x }</span>

<span class="cp">#define kvm_trace_sym_exc						\</span>
<span class="cp">	EXS(DE), EXS(DB), EXS(BP), EXS(OF), EXS(BR), EXS(UD), EXS(NM),	\</span>
<span class="cp">	EXS(DF), EXS(TS), EXS(NP), EXS(SS), EXS(GP), EXS(PF),		\</span>
<span class="cp">	EXS(MF), EXS(MC)</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for kvm interrupt injection:</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_inj_exception</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">exception</span><span class="p">,</span> <span class="n">bool</span> <span class="n">has_error</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">error_code</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">exception</span><span class="p">,</span> <span class="n">has_error</span><span class="p">,</span> <span class="n">error_code</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u8</span><span class="p">,</span>	<span class="n">exception</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u8</span><span class="p">,</span>	<span class="n">has_error</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u32</span><span class="p">,</span>	<span class="n">error_code</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exception</span>	<span class="o">=</span> <span class="n">exception</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">has_error</span>	<span class="o">=</span> <span class="n">has_error</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">error_code</span>	<span class="o">=</span> <span class="n">error_code</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s (0x%x)&quot;</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exception</span><span class="p">,</span> <span class="n">kvm_trace_sym_exc</span><span class="p">),</span>
		  <span class="cm">/* FIXME: don&#39;t print error_code if not present */</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">has_error</span> <span class="o">?</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">error_code</span> <span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for page fault.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_page_fault</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">fault_address</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">error_code</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">fault_address</span><span class="p">,</span> <span class="n">error_code</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">fault_address</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">error_code</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fault_address</span>	<span class="o">=</span> <span class="n">fault_address</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">error_code</span>	<span class="o">=</span> <span class="n">error_code</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;address %lx error_code %x&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">fault_address</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">error_code</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for guest MSR access.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_msr</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">write</span><span class="p">,</span> <span class="n">u32</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">u64</span> <span class="n">data</span><span class="p">,</span> <span class="n">bool</span> <span class="n">exception</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">write</span><span class="p">,</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">exception</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span><span class="p">,</span>	<span class="n">write</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u32</span><span class="p">,</span>		<span class="n">ecx</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u64</span><span class="p">,</span>		<span class="n">data</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">u8</span><span class="p">,</span>		<span class="n">exception</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">write</span>		<span class="o">=</span> <span class="n">write</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ecx</span>		<span class="o">=</span> <span class="n">ecx</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">data</span>		<span class="o">=</span> <span class="n">data</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exception</span>	<span class="o">=</span> <span class="n">exception</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;msr_%s %x = 0x%llx%s&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">write</span> <span class="o">?</span> <span class="s">&quot;write&quot;</span> <span class="o">:</span> <span class="s">&quot;read&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">ecx</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exception</span> <span class="o">?</span> <span class="s">&quot; (#GP)&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define trace_kvm_msr_read(ecx, data)      trace_kvm_msr(0, ecx, data, false)</span>
<span class="cp">#define trace_kvm_msr_write(ecx, data)     trace_kvm_msr(1, ecx, data, false)</span>
<span class="cp">#define trace_kvm_msr_read_ex(ecx)         trace_kvm_msr(0, ecx, 0, true)</span>
<span class="cp">#define trace_kvm_msr_write_ex(ecx, data)  trace_kvm_msr(1, ecx, data, true)</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for guest CR access.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_cr</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rw</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">val</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rw</span><span class="p">,</span> <span class="n">cr</span><span class="p">,</span> <span class="n">val</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">rw</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>	<span class="n">cr</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span>	<span class="n">val</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rw</span>		<span class="o">=</span> <span class="n">rw</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cr</span>		<span class="o">=</span> <span class="n">cr</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">val</span>		<span class="o">=</span> <span class="n">val</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;cr_%s %x = 0x%lx&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rw</span> <span class="o">?</span> <span class="s">&quot;write&quot;</span> <span class="o">:</span> <span class="s">&quot;read&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cr</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">val</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define trace_kvm_cr_read(cr, val)		trace_kvm_cr(0, cr, val)</span>
<span class="cp">#define trace_kvm_cr_write(cr, val)		trace_kvm_cr(1, cr, val)</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_pic_set_irq</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u8</span> <span class="n">chip</span><span class="p">,</span> <span class="n">__u8</span> <span class="n">pin</span><span class="p">,</span> <span class="n">__u8</span> <span class="n">elcr</span><span class="p">,</span> <span class="n">__u8</span> <span class="n">imr</span><span class="p">,</span> <span class="n">bool</span> <span class="n">coalesced</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">pin</span><span class="p">,</span> <span class="n">elcr</span><span class="p">,</span> <span class="n">imr</span><span class="p">,</span> <span class="n">coalesced</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u8</span><span class="p">,</span>		<span class="n">chip</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u8</span><span class="p">,</span>		<span class="n">pin</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u8</span><span class="p">,</span>		<span class="n">elcr</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u8</span><span class="p">,</span>		<span class="n">imr</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">bool</span><span class="p">,</span>		<span class="n">coalesced</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">chip</span>		<span class="o">=</span> <span class="n">chip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pin</span>		<span class="o">=</span> <span class="n">pin</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">elcr</span>		<span class="o">=</span> <span class="n">elcr</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">imr</span>		<span class="o">=</span> <span class="n">imr</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">coalesced</span>	<span class="o">=</span> <span class="n">coalesced</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;chip %u pin %u (%s%s)%s&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">chip</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pin</span><span class="p">,</span>
		  <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">elcr</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pin</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;level&quot;</span><span class="o">:</span><span class="s">&quot;edge&quot;</span><span class="p">,</span>
		  <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">imr</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pin</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;|masked&quot;</span><span class="o">:</span><span class="s">&quot;&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">coalesced</span> <span class="o">?</span> <span class="s">&quot; (coalesced)&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define kvm_apic_dst_shorthand		\</span>
<span class="cp">	{0x0, &quot;dst&quot;},			\</span>
<span class="cp">	{0x1, &quot;self&quot;},			\</span>
<span class="cp">	{0x2, &quot;all&quot;},			\</span>
<span class="cp">	{0x3, &quot;all-but-self&quot;}</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_apic_ipi</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u32</span> <span class="n">icr_low</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">dest_id</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">icr_low</span><span class="p">,</span> <span class="n">dest_id</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">icr_low</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">dest_id</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icr_low</span>	<span class="o">=</span> <span class="n">icr_low</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dest_id</span>	<span class="o">=</span> <span class="n">dest_id</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;dst %x vec %u (%s|%s|%s|%s|%s)&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dest_id</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icr_low</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">((</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icr_low</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">),</span>
				   <span class="n">kvm_deliver_mode</span><span class="p">),</span>
		  <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icr_low</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">11</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;logical&quot;</span> <span class="o">:</span> <span class="s">&quot;physical&quot;</span><span class="p">,</span>
		  <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icr_low</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">14</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;assert&quot;</span> <span class="o">:</span> <span class="s">&quot;de-assert&quot;</span><span class="p">,</span>
		  <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icr_low</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">15</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;level&quot;</span> <span class="o">:</span> <span class="s">&quot;edge&quot;</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">((</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">icr_low</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">),</span>
				   <span class="n">kvm_apic_dst_shorthand</span><span class="p">))</span>
<span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_apic_accept_irq</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u32</span> <span class="n">apicid</span><span class="p">,</span> <span class="n">__u16</span> <span class="n">dm</span><span class="p">,</span> <span class="n">__u8</span> <span class="n">tm</span><span class="p">,</span> <span class="n">__u8</span> <span class="n">vec</span><span class="p">,</span> <span class="n">bool</span> <span class="n">coalesced</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">apicid</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">tm</span><span class="p">,</span> <span class="n">vec</span><span class="p">,</span> <span class="n">coalesced</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">apicid</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u16</span><span class="p">,</span>		<span class="n">dm</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u8</span><span class="p">,</span>		<span class="n">tm</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u8</span><span class="p">,</span>		<span class="n">vec</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">bool</span><span class="p">,</span>		<span class="n">coalesced</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">apicid</span>		<span class="o">=</span> <span class="n">apicid</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dm</span>		<span class="o">=</span> <span class="n">dm</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tm</span>		<span class="o">=</span> <span class="n">tm</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">vec</span>		<span class="o">=</span> <span class="n">vec</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">coalesced</span>	<span class="o">=</span> <span class="n">coalesced</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;apicid %x vec %u (%s|%s)%s&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">apicid</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">vec</span><span class="p">,</span>
		  <span class="n">__print_symbolic</span><span class="p">((</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">dm</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">),</span> <span class="n">kvm_deliver_mode</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">tm</span> <span class="o">?</span> <span class="s">&quot;level&quot;</span> <span class="o">:</span> <span class="s">&quot;edge&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">coalesced</span> <span class="o">?</span> <span class="s">&quot; (coalesced)&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for nested VMRUN</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_nested_vmrun</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u64</span> <span class="n">rip</span><span class="p">,</span> <span class="n">__u64</span> <span class="n">vmcb</span><span class="p">,</span> <span class="n">__u64</span> <span class="n">nested_rip</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">int_ctl</span><span class="p">,</span>
		     <span class="n">__u32</span> <span class="n">event_inj</span><span class="p">,</span> <span class="n">bool</span> <span class="n">npt</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rip</span><span class="p">,</span> <span class="n">vmcb</span><span class="p">,</span> <span class="n">nested_rip</span><span class="p">,</span> <span class="n">int_ctl</span><span class="p">,</span> <span class="n">event_inj</span><span class="p">,</span> <span class="n">npt</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">rip</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">vmcb</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">nested_rip</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">int_ctl</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">event_inj</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">bool</span><span class="p">,</span>		<span class="n">npt</span>		<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span>		<span class="o">=</span> <span class="n">rip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">vmcb</span>		<span class="o">=</span> <span class="n">vmcb</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nested_rip</span>	<span class="o">=</span> <span class="n">nested_rip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">int_ctl</span>	<span class="o">=</span> <span class="n">int_ctl</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">event_inj</span>	<span class="o">=</span> <span class="n">event_inj</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">npt</span>		<span class="o">=</span> <span class="n">npt</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;rip: 0x%016llx vmcb: 0x%016llx nrip: 0x%016llx int_ctl: 0x%08x &quot;</span>
		  <span class="s">&quot;event_inj: 0x%08x npt: %s&quot;</span><span class="p">,</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">vmcb</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nested_rip</span><span class="p">,</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">int_ctl</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">event_inj</span><span class="p">,</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">npt</span> <span class="o">?</span> <span class="s">&quot;on&quot;</span> <span class="o">:</span> <span class="s">&quot;off&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_nested_intercepts</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u16</span> <span class="n">cr_read</span><span class="p">,</span> <span class="n">__u16</span> <span class="n">cr_write</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">__u64</span> <span class="n">intercept</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">cr_read</span><span class="p">,</span> <span class="n">cr_write</span><span class="p">,</span> <span class="n">exceptions</span><span class="p">,</span> <span class="n">intercept</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u16</span><span class="p">,</span>		<span class="n">cr_read</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u16</span><span class="p">,</span>		<span class="n">cr_write</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">exceptions</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">intercept</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cr_read</span>	<span class="o">=</span> <span class="n">cr_read</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cr_write</span>	<span class="o">=</span> <span class="n">cr_write</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exceptions</span>	<span class="o">=</span> <span class="n">exceptions</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">intercept</span>	<span class="o">=</span> <span class="n">intercept</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;cr_read: %04x cr_write: %04x excp: %08x intercept: %016llx&quot;</span><span class="p">,</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cr_read</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cr_write</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exceptions</span><span class="p">,</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">intercept</span><span class="p">)</span>
<span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> * Tracepoint for #VMEXIT while nested</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_nested_vmexit</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u64</span> <span class="n">rip</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">exit_code</span><span class="p">,</span>
		     <span class="n">__u64</span> <span class="n">exit_info1</span><span class="p">,</span> <span class="n">__u64</span> <span class="n">exit_info2</span><span class="p">,</span>
		     <span class="n">__u32</span> <span class="n">exit_int_info</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">exit_int_info_err</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">isa</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rip</span><span class="p">,</span> <span class="n">exit_code</span><span class="p">,</span> <span class="n">exit_info1</span><span class="p">,</span> <span class="n">exit_info2</span><span class="p">,</span>
		    <span class="n">exit_int_info</span><span class="p">,</span> <span class="n">exit_int_info_err</span><span class="p">,</span> <span class="n">isa</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">rip</span>			<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">exit_code</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">exit_info1</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">exit_info2</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">exit_int_info</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">exit_int_info_err</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">isa</span>			<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span>			<span class="o">=</span> <span class="n">rip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_code</span>		<span class="o">=</span> <span class="n">exit_code</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info1</span>		<span class="o">=</span> <span class="n">exit_info1</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info2</span>		<span class="o">=</span> <span class="n">exit_info2</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info</span>		<span class="o">=</span> <span class="n">exit_int_info</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info_err</span>	<span class="o">=</span> <span class="n">exit_int_info_err</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isa</span>			<span class="o">=</span> <span class="n">isa</span><span class="p">;</span>
	<span class="p">),</span>
	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;rip: 0x%016llx reason: %s ext_inf1: 0x%016llx &quot;</span>
		  <span class="s">&quot;ext_inf2: 0x%016llx ext_int: 0x%08x ext_int_err: 0x%08x&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span><span class="p">,</span>
		 <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isa</span> <span class="o">==</span> <span class="n">KVM_ISA_VMX</span><span class="p">)</span> <span class="o">?</span>
		 <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">VMX_EXIT_REASONS</span><span class="p">)</span> <span class="o">:</span>
		 <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">SVM_EXIT_REASONS</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info1</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info2</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info_err</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for #VMEXIT reinjected to the guest</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_nested_vmexit_inject</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u32</span> <span class="n">exit_code</span><span class="p">,</span>
		     <span class="n">__u64</span> <span class="n">exit_info1</span><span class="p">,</span> <span class="n">__u64</span> <span class="n">exit_info2</span><span class="p">,</span>
		     <span class="n">__u32</span> <span class="n">exit_int_info</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">exit_int_info_err</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">isa</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">exit_info1</span><span class="p">,</span> <span class="n">exit_info2</span><span class="p">,</span>
		    <span class="n">exit_int_info</span><span class="p">,</span> <span class="n">exit_int_info_err</span><span class="p">,</span> <span class="n">isa</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">exit_code</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">exit_info1</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>		<span class="n">exit_info2</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">exit_int_info</span>		<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">exit_int_info_err</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>		<span class="n">isa</span>			<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_code</span>		<span class="o">=</span> <span class="n">exit_code</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info1</span>		<span class="o">=</span> <span class="n">exit_info1</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info2</span>		<span class="o">=</span> <span class="n">exit_info2</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info</span>		<span class="o">=</span> <span class="n">exit_int_info</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info_err</span>	<span class="o">=</span> <span class="n">exit_int_info_err</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isa</span>			<span class="o">=</span> <span class="n">isa</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;reason: %s ext_inf1: 0x%016llx &quot;</span>
		  <span class="s">&quot;ext_inf2: 0x%016llx ext_int: 0x%08x ext_int_err: 0x%08x&quot;</span><span class="p">,</span>
		 <span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">isa</span> <span class="o">==</span> <span class="n">KVM_ISA_VMX</span><span class="p">)</span> <span class="o">?</span>
		 <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">VMX_EXIT_REASONS</span><span class="p">)</span> <span class="o">:</span>
		 <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_code</span><span class="p">,</span> <span class="n">SVM_EXIT_REASONS</span><span class="p">),</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info1</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_info2</span><span class="p">,</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">exit_int_info_err</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for nested #vmexit because of interrupt pending</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_nested_intr_vmexit</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u64</span> <span class="n">rip</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rip</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>	<span class="n">rip</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span>	<span class="o">=</span>	<span class="n">rip</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;rip: 0x%016llx&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for nested #vmexit because of interrupt pending</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_invlpga</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u64</span> <span class="n">rip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">asid</span><span class="p">,</span> <span class="n">u64</span> <span class="n">address</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rip</span><span class="p">,</span> <span class="n">asid</span><span class="p">,</span> <span class="n">address</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>	<span class="n">rip</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="kt">int</span><span class="p">,</span>	<span class="n">asid</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>	<span class="n">address</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span>		<span class="o">=</span>	<span class="n">rip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">asid</span>		<span class="o">=</span>	<span class="n">asid</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">address</span>	<span class="o">=</span>	<span class="n">address</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;rip: 0x%016llx asid: %d address: 0x%016llx&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">asid</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">address</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for nested #vmexit because of interrupt pending</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_skinit</span><span class="p">,</span>
	    <span class="n">TP_PROTO</span><span class="p">(</span><span class="n">__u64</span> <span class="n">rip</span><span class="p">,</span> <span class="n">__u32</span> <span class="n">slb</span><span class="p">),</span>
	    <span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rip</span><span class="p">,</span> <span class="n">slb</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u64</span><span class="p">,</span>	<span class="n">rip</span>	<span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>	<span class="n">__u32</span><span class="p">,</span>	<span class="n">slb</span>	<span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span>		<span class="o">=</span>	<span class="n">rip</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">slb</span>		<span class="o">=</span>	<span class="n">slb</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;rip: 0x%016llx slb: 0x%08x&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">slb</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#define __print_insn(insn, ilen) ({		                 \</span>
<span class="cp">	int i;							 \</span>
<span class="cp">	const char *ret = p-&gt;buffer + p-&gt;len;			 \</span>
<span class="cp">								 \</span>
<span class="cp">	for (i = 0; i &lt; ilen; ++i)				 \</span>
<span class="cp">		trace_seq_printf(p, &quot; %02x&quot;, insn[i]);		 \</span>
<span class="cp">	trace_seq_printf(p, &quot;%c&quot;, 0);				 \</span>
<span class="cp">	ret;							 \</span>
<span class="cp">	})</span>

<span class="cp">#define KVM_EMUL_INSN_F_CR0_PE (1 &lt;&lt; 0)</span>
<span class="cp">#define KVM_EMUL_INSN_F_EFL_VM (1 &lt;&lt; 1)</span>
<span class="cp">#define KVM_EMUL_INSN_F_CS_D   (1 &lt;&lt; 2)</span>
<span class="cp">#define KVM_EMUL_INSN_F_CS_L   (1 &lt;&lt; 3)</span>

<span class="cp">#define kvm_trace_symbol_emul_flags	                  \</span>
<span class="cp">	{ 0,   			    &quot;real&quot; },		  \</span>
<span class="cp">	{ KVM_EMUL_INSN_F_CR0_PE			  \</span>
<span class="cp">	  | KVM_EMUL_INSN_F_EFL_VM, &quot;vm16&quot; },		  \</span>
<span class="cp">	{ KVM_EMUL_INSN_F_CR0_PE,   &quot;prot16&quot; },		  \</span>
<span class="cp">	{ KVM_EMUL_INSN_F_CR0_PE			  \</span>
<span class="cp">	  | KVM_EMUL_INSN_F_CS_D,   &quot;prot32&quot; },		  \</span>
<span class="cp">	{ KVM_EMUL_INSN_F_CR0_PE			  \</span>
<span class="cp">	  | KVM_EMUL_INSN_F_CS_L,   &quot;prot64&quot; }</span>

<span class="cp">#define kei_decode_mode(mode) ({			\</span>
<span class="cp">	u8 flags = 0xff;				\</span>
<span class="cp">	switch (mode) {					\</span>
<span class="cp">	case X86EMUL_MODE_REAL:				\</span>
<span class="cp">		flags = 0;				\</span>
<span class="cp">		break;					\</span>
<span class="cp">	case X86EMUL_MODE_VM86:				\</span>
<span class="cp">		flags = KVM_EMUL_INSN_F_EFL_VM;		\</span>
<span class="cp">		break;					\</span>
<span class="cp">	case X86EMUL_MODE_PROT16:			\</span>
<span class="cp">		flags = KVM_EMUL_INSN_F_CR0_PE;		\</span>
<span class="cp">		break;					\</span>
<span class="cp">	case X86EMUL_MODE_PROT32:			\</span>
<span class="cp">		flags = KVM_EMUL_INSN_F_CR0_PE		\</span>
<span class="cp">			| KVM_EMUL_INSN_F_CS_D;		\</span>
<span class="cp">		break;					\</span>
<span class="cp">	case X86EMUL_MODE_PROT64:			\</span>
<span class="cp">		flags = KVM_EMUL_INSN_F_CR0_PE		\</span>
<span class="cp">			| KVM_EMUL_INSN_F_CS_L;		\</span>
<span class="cp">		break;					\</span>
<span class="cp">	}						\</span>
<span class="cp">	flags;						\</span>
<span class="cp">	})</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">kvm_emulate_insn</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="k">struct</span> <span class="n">kvm_vcpu</span> <span class="o">*</span><span class="n">vcpu</span><span class="p">,</span> <span class="n">__u8</span> <span class="n">failed</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">vcpu</span><span class="p">,</span> <span class="n">failed</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span>    <span class="n">__u64</span><span class="p">,</span> <span class="n">rip</span>                       <span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>    <span class="n">__u32</span><span class="p">,</span> <span class="n">csbase</span>                    <span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>    <span class="n">__u8</span><span class="p">,</span>  <span class="n">len</span>                       <span class="p">)</span>
		<span class="n">__array</span><span class="p">(</span>    <span class="n">__u8</span><span class="p">,</span>  <span class="n">insn</span><span class="p">,</span>    <span class="mi">15</span>	             <span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>    <span class="n">__u8</span><span class="p">,</span>  <span class="n">flags</span>       	   	     <span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span>    <span class="n">__u8</span><span class="p">,</span>  <span class="n">failed</span>                    <span class="p">)</span>
		<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span> <span class="o">=</span> <span class="n">vcpu</span><span class="o">-&gt;</span><span class="n">arch</span><span class="p">.</span><span class="n">emulate_ctxt</span><span class="p">.</span><span class="n">fetch</span><span class="p">.</span><span class="n">start</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">csbase</span> <span class="o">=</span> <span class="n">kvm_x86_ops</span><span class="o">-&gt;</span><span class="n">get_segment_base</span><span class="p">(</span><span class="n">vcpu</span><span class="p">,</span> <span class="n">VCPU_SREG_CS</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span> <span class="o">=</span> <span class="n">vcpu</span><span class="o">-&gt;</span><span class="n">arch</span><span class="p">.</span><span class="n">emulate_ctxt</span><span class="p">.</span><span class="n">_eip</span>
			       <span class="o">-</span> <span class="n">vcpu</span><span class="o">-&gt;</span><span class="n">arch</span><span class="p">.</span><span class="n">emulate_ctxt</span><span class="p">.</span><span class="n">fetch</span><span class="p">.</span><span class="n">start</span><span class="p">;</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">insn</span><span class="p">,</span>
		       <span class="n">vcpu</span><span class="o">-&gt;</span><span class="n">arch</span><span class="p">.</span><span class="n">emulate_ctxt</span><span class="p">.</span><span class="n">fetch</span><span class="p">.</span><span class="n">data</span><span class="p">,</span>
		       <span class="mi">15</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">=</span> <span class="n">kei_decode_mode</span><span class="p">(</span><span class="n">vcpu</span><span class="o">-&gt;</span><span class="n">arch</span><span class="p">.</span><span class="n">emulate_ctxt</span><span class="p">.</span><span class="n">mode</span><span class="p">);</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">failed</span> <span class="o">=</span> <span class="n">failed</span><span class="p">;</span>
		<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%x:%llx:%s (%s)%s&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">csbase</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rip</span><span class="p">,</span>
		  <span class="n">__print_insn</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">insn</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">),</span>
		  <span class="n">__print_symbolic</span><span class="p">(</span><span class="n">__entry</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span>
				   <span class="n">kvm_trace_symbol_emul_flags</span><span class="p">),</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">failed</span> <span class="o">?</span> <span class="s">&quot; failed&quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span>
		<span class="p">)</span>
	<span class="p">);</span>

<span class="cp">#define trace_kvm_emulate_insn_start(vcpu) trace_kvm_emulate_insn(vcpu, 0)</span>
<span class="cp">#define trace_kvm_emulate_insn_failed(vcpu) trace_kvm_emulate_insn(vcpu, 1)</span>

<span class="n">TRACE_EVENT</span><span class="p">(</span>
	<span class="n">vcpu_match_mmio</span><span class="p">,</span>
	<span class="n">TP_PROTO</span><span class="p">(</span><span class="n">gva_t</span> <span class="n">gva</span><span class="p">,</span> <span class="n">gpa_t</span> <span class="n">gpa</span><span class="p">,</span> <span class="n">bool</span> <span class="n">write</span><span class="p">,</span> <span class="n">bool</span> <span class="n">gpa_match</span><span class="p">),</span>
	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">gva</span><span class="p">,</span> <span class="n">gpa</span><span class="p">,</span> <span class="n">write</span><span class="p">,</span> <span class="n">gpa_match</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">gva_t</span><span class="p">,</span> <span class="n">gva</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">gpa_t</span><span class="p">,</span> <span class="n">gpa</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">bool</span><span class="p">,</span> <span class="n">write</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">bool</span><span class="p">,</span> <span class="n">gpa_match</span><span class="p">)</span>
		<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gva</span> <span class="o">=</span> <span class="n">gva</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpa</span> <span class="o">=</span> <span class="n">gpa</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">write</span> <span class="o">=</span> <span class="n">write</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpa_match</span> <span class="o">=</span> <span class="n">gpa_match</span>
		<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;gva %#lx gpa %#llx %s %s&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gva</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpa</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">write</span> <span class="o">?</span> <span class="s">&quot;Write&quot;</span> <span class="o">:</span> <span class="s">&quot;Read&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpa_match</span> <span class="o">?</span> <span class="s">&quot;GPA&quot;</span> <span class="o">:</span> <span class="s">&quot;GVA&quot;</span><span class="p">)</span>
<span class="p">);</span>
<span class="cp">#endif </span><span class="cm">/* _TRACE_KVM_H */</span><span class="cp"></span>

<span class="cp">#undef TRACE_INCLUDE_PATH</span>
<span class="cp">#define TRACE_INCLUDE_PATH arch/x86/kvm</span>
<span class="cp">#undef TRACE_INCLUDE_FILE</span>
<span class="cp">#define TRACE_INCLUDE_FILE trace</span>

<span class="cm">/* This part must be outside protection */</span>
<span class="cp">#include &lt;trace/define_trace.h&gt;</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
