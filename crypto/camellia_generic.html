<!DOCTYPE html>
<html><head><title>joekychen/linux » crypto › camellia_generic.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../index.html"></a><h1>camellia_generic.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 2006</span>
<span class="cm"> * NTT (Nippon Telegraph and Telephone Corporation).</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License</span>
<span class="cm"> * as published by the Free Software Foundation; either version 2</span>
<span class="cm"> * of the License, or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Algorithm Specification</span>
<span class="cm"> *  http://info.isl.ntt.co.jp/crypt/eng/camellia/specifications.html</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> * NOTE --- NOTE --- NOTE --- NOTE</span>
<span class="cm"> * This implementation assumes that all memory addresses passed</span>
<span class="cm"> * as parameters are four-byte aligned.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/crypto.h&gt;</span>
<span class="cp">#include &lt;linux/errno.h&gt;</span>
<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/bitops.h&gt;</span>
<span class="cp">#include &lt;asm/unaligned.h&gt;</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">camellia_sp1110</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x70707000</span><span class="p">,</span> <span class="mh">0x82828200</span><span class="p">,</span> <span class="mh">0x2c2c2c00</span><span class="p">,</span> <span class="mh">0xececec00</span><span class="p">,</span>
	<span class="mh">0xb3b3b300</span><span class="p">,</span> <span class="mh">0x27272700</span><span class="p">,</span> <span class="mh">0xc0c0c000</span><span class="p">,</span> <span class="mh">0xe5e5e500</span><span class="p">,</span>
	<span class="mh">0xe4e4e400</span><span class="p">,</span> <span class="mh">0x85858500</span><span class="p">,</span> <span class="mh">0x57575700</span><span class="p">,</span> <span class="mh">0x35353500</span><span class="p">,</span>
	<span class="mh">0xeaeaea00</span><span class="p">,</span> <span class="mh">0x0c0c0c00</span><span class="p">,</span> <span class="mh">0xaeaeae00</span><span class="p">,</span> <span class="mh">0x41414100</span><span class="p">,</span>
	<span class="mh">0x23232300</span><span class="p">,</span> <span class="mh">0xefefef00</span><span class="p">,</span> <span class="mh">0x6b6b6b00</span><span class="p">,</span> <span class="mh">0x93939300</span><span class="p">,</span>
	<span class="mh">0x45454500</span><span class="p">,</span> <span class="mh">0x19191900</span><span class="p">,</span> <span class="mh">0xa5a5a500</span><span class="p">,</span> <span class="mh">0x21212100</span><span class="p">,</span>
	<span class="mh">0xededed00</span><span class="p">,</span> <span class="mh">0x0e0e0e00</span><span class="p">,</span> <span class="mh">0x4f4f4f00</span><span class="p">,</span> <span class="mh">0x4e4e4e00</span><span class="p">,</span>
	<span class="mh">0x1d1d1d00</span><span class="p">,</span> <span class="mh">0x65656500</span><span class="p">,</span> <span class="mh">0x92929200</span><span class="p">,</span> <span class="mh">0xbdbdbd00</span><span class="p">,</span>
	<span class="mh">0x86868600</span><span class="p">,</span> <span class="mh">0xb8b8b800</span><span class="p">,</span> <span class="mh">0xafafaf00</span><span class="p">,</span> <span class="mh">0x8f8f8f00</span><span class="p">,</span>
	<span class="mh">0x7c7c7c00</span><span class="p">,</span> <span class="mh">0xebebeb00</span><span class="p">,</span> <span class="mh">0x1f1f1f00</span><span class="p">,</span> <span class="mh">0xcecece00</span><span class="p">,</span>
	<span class="mh">0x3e3e3e00</span><span class="p">,</span> <span class="mh">0x30303000</span><span class="p">,</span> <span class="mh">0xdcdcdc00</span><span class="p">,</span> <span class="mh">0x5f5f5f00</span><span class="p">,</span>
	<span class="mh">0x5e5e5e00</span><span class="p">,</span> <span class="mh">0xc5c5c500</span><span class="p">,</span> <span class="mh">0x0b0b0b00</span><span class="p">,</span> <span class="mh">0x1a1a1a00</span><span class="p">,</span>
	<span class="mh">0xa6a6a600</span><span class="p">,</span> <span class="mh">0xe1e1e100</span><span class="p">,</span> <span class="mh">0x39393900</span><span class="p">,</span> <span class="mh">0xcacaca00</span><span class="p">,</span>
	<span class="mh">0xd5d5d500</span><span class="p">,</span> <span class="mh">0x47474700</span><span class="p">,</span> <span class="mh">0x5d5d5d00</span><span class="p">,</span> <span class="mh">0x3d3d3d00</span><span class="p">,</span>
	<span class="mh">0xd9d9d900</span><span class="p">,</span> <span class="mh">0x01010100</span><span class="p">,</span> <span class="mh">0x5a5a5a00</span><span class="p">,</span> <span class="mh">0xd6d6d600</span><span class="p">,</span>
	<span class="mh">0x51515100</span><span class="p">,</span> <span class="mh">0x56565600</span><span class="p">,</span> <span class="mh">0x6c6c6c00</span><span class="p">,</span> <span class="mh">0x4d4d4d00</span><span class="p">,</span>
	<span class="mh">0x8b8b8b00</span><span class="p">,</span> <span class="mh">0x0d0d0d00</span><span class="p">,</span> <span class="mh">0x9a9a9a00</span><span class="p">,</span> <span class="mh">0x66666600</span><span class="p">,</span>
	<span class="mh">0xfbfbfb00</span><span class="p">,</span> <span class="mh">0xcccccc00</span><span class="p">,</span> <span class="mh">0xb0b0b000</span><span class="p">,</span> <span class="mh">0x2d2d2d00</span><span class="p">,</span>
	<span class="mh">0x74747400</span><span class="p">,</span> <span class="mh">0x12121200</span><span class="p">,</span> <span class="mh">0x2b2b2b00</span><span class="p">,</span> <span class="mh">0x20202000</span><span class="p">,</span>
	<span class="mh">0xf0f0f000</span><span class="p">,</span> <span class="mh">0xb1b1b100</span><span class="p">,</span> <span class="mh">0x84848400</span><span class="p">,</span> <span class="mh">0x99999900</span><span class="p">,</span>
	<span class="mh">0xdfdfdf00</span><span class="p">,</span> <span class="mh">0x4c4c4c00</span><span class="p">,</span> <span class="mh">0xcbcbcb00</span><span class="p">,</span> <span class="mh">0xc2c2c200</span><span class="p">,</span>
	<span class="mh">0x34343400</span><span class="p">,</span> <span class="mh">0x7e7e7e00</span><span class="p">,</span> <span class="mh">0x76767600</span><span class="p">,</span> <span class="mh">0x05050500</span><span class="p">,</span>
	<span class="mh">0x6d6d6d00</span><span class="p">,</span> <span class="mh">0xb7b7b700</span><span class="p">,</span> <span class="mh">0xa9a9a900</span><span class="p">,</span> <span class="mh">0x31313100</span><span class="p">,</span>
	<span class="mh">0xd1d1d100</span><span class="p">,</span> <span class="mh">0x17171700</span><span class="p">,</span> <span class="mh">0x04040400</span><span class="p">,</span> <span class="mh">0xd7d7d700</span><span class="p">,</span>
	<span class="mh">0x14141400</span><span class="p">,</span> <span class="mh">0x58585800</span><span class="p">,</span> <span class="mh">0x3a3a3a00</span><span class="p">,</span> <span class="mh">0x61616100</span><span class="p">,</span>
	<span class="mh">0xdedede00</span><span class="p">,</span> <span class="mh">0x1b1b1b00</span><span class="p">,</span> <span class="mh">0x11111100</span><span class="p">,</span> <span class="mh">0x1c1c1c00</span><span class="p">,</span>
	<span class="mh">0x32323200</span><span class="p">,</span> <span class="mh">0x0f0f0f00</span><span class="p">,</span> <span class="mh">0x9c9c9c00</span><span class="p">,</span> <span class="mh">0x16161600</span><span class="p">,</span>
	<span class="mh">0x53535300</span><span class="p">,</span> <span class="mh">0x18181800</span><span class="p">,</span> <span class="mh">0xf2f2f200</span><span class="p">,</span> <span class="mh">0x22222200</span><span class="p">,</span>
	<span class="mh">0xfefefe00</span><span class="p">,</span> <span class="mh">0x44444400</span><span class="p">,</span> <span class="mh">0xcfcfcf00</span><span class="p">,</span> <span class="mh">0xb2b2b200</span><span class="p">,</span>
	<span class="mh">0xc3c3c300</span><span class="p">,</span> <span class="mh">0xb5b5b500</span><span class="p">,</span> <span class="mh">0x7a7a7a00</span><span class="p">,</span> <span class="mh">0x91919100</span><span class="p">,</span>
	<span class="mh">0x24242400</span><span class="p">,</span> <span class="mh">0x08080800</span><span class="p">,</span> <span class="mh">0xe8e8e800</span><span class="p">,</span> <span class="mh">0xa8a8a800</span><span class="p">,</span>
	<span class="mh">0x60606000</span><span class="p">,</span> <span class="mh">0xfcfcfc00</span><span class="p">,</span> <span class="mh">0x69696900</span><span class="p">,</span> <span class="mh">0x50505000</span><span class="p">,</span>
	<span class="mh">0xaaaaaa00</span><span class="p">,</span> <span class="mh">0xd0d0d000</span><span class="p">,</span> <span class="mh">0xa0a0a000</span><span class="p">,</span> <span class="mh">0x7d7d7d00</span><span class="p">,</span>
	<span class="mh">0xa1a1a100</span><span class="p">,</span> <span class="mh">0x89898900</span><span class="p">,</span> <span class="mh">0x62626200</span><span class="p">,</span> <span class="mh">0x97979700</span><span class="p">,</span>
	<span class="mh">0x54545400</span><span class="p">,</span> <span class="mh">0x5b5b5b00</span><span class="p">,</span> <span class="mh">0x1e1e1e00</span><span class="p">,</span> <span class="mh">0x95959500</span><span class="p">,</span>
	<span class="mh">0xe0e0e000</span><span class="p">,</span> <span class="mh">0xffffff00</span><span class="p">,</span> <span class="mh">0x64646400</span><span class="p">,</span> <span class="mh">0xd2d2d200</span><span class="p">,</span>
	<span class="mh">0x10101000</span><span class="p">,</span> <span class="mh">0xc4c4c400</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x48484800</span><span class="p">,</span>
	<span class="mh">0xa3a3a300</span><span class="p">,</span> <span class="mh">0xf7f7f700</span><span class="p">,</span> <span class="mh">0x75757500</span><span class="p">,</span> <span class="mh">0xdbdbdb00</span><span class="p">,</span>
	<span class="mh">0x8a8a8a00</span><span class="p">,</span> <span class="mh">0x03030300</span><span class="p">,</span> <span class="mh">0xe6e6e600</span><span class="p">,</span> <span class="mh">0xdadada00</span><span class="p">,</span>
	<span class="mh">0x09090900</span><span class="p">,</span> <span class="mh">0x3f3f3f00</span><span class="p">,</span> <span class="mh">0xdddddd00</span><span class="p">,</span> <span class="mh">0x94949400</span><span class="p">,</span>
	<span class="mh">0x87878700</span><span class="p">,</span> <span class="mh">0x5c5c5c00</span><span class="p">,</span> <span class="mh">0x83838300</span><span class="p">,</span> <span class="mh">0x02020200</span><span class="p">,</span>
	<span class="mh">0xcdcdcd00</span><span class="p">,</span> <span class="mh">0x4a4a4a00</span><span class="p">,</span> <span class="mh">0x90909000</span><span class="p">,</span> <span class="mh">0x33333300</span><span class="p">,</span>
	<span class="mh">0x73737300</span><span class="p">,</span> <span class="mh">0x67676700</span><span class="p">,</span> <span class="mh">0xf6f6f600</span><span class="p">,</span> <span class="mh">0xf3f3f300</span><span class="p">,</span>
	<span class="mh">0x9d9d9d00</span><span class="p">,</span> <span class="mh">0x7f7f7f00</span><span class="p">,</span> <span class="mh">0xbfbfbf00</span><span class="p">,</span> <span class="mh">0xe2e2e200</span><span class="p">,</span>
	<span class="mh">0x52525200</span><span class="p">,</span> <span class="mh">0x9b9b9b00</span><span class="p">,</span> <span class="mh">0xd8d8d800</span><span class="p">,</span> <span class="mh">0x26262600</span><span class="p">,</span>
	<span class="mh">0xc8c8c800</span><span class="p">,</span> <span class="mh">0x37373700</span><span class="p">,</span> <span class="mh">0xc6c6c600</span><span class="p">,</span> <span class="mh">0x3b3b3b00</span><span class="p">,</span>
	<span class="mh">0x81818100</span><span class="p">,</span> <span class="mh">0x96969600</span><span class="p">,</span> <span class="mh">0x6f6f6f00</span><span class="p">,</span> <span class="mh">0x4b4b4b00</span><span class="p">,</span>
	<span class="mh">0x13131300</span><span class="p">,</span> <span class="mh">0xbebebe00</span><span class="p">,</span> <span class="mh">0x63636300</span><span class="p">,</span> <span class="mh">0x2e2e2e00</span><span class="p">,</span>
	<span class="mh">0xe9e9e900</span><span class="p">,</span> <span class="mh">0x79797900</span><span class="p">,</span> <span class="mh">0xa7a7a700</span><span class="p">,</span> <span class="mh">0x8c8c8c00</span><span class="p">,</span>
	<span class="mh">0x9f9f9f00</span><span class="p">,</span> <span class="mh">0x6e6e6e00</span><span class="p">,</span> <span class="mh">0xbcbcbc00</span><span class="p">,</span> <span class="mh">0x8e8e8e00</span><span class="p">,</span>
	<span class="mh">0x29292900</span><span class="p">,</span> <span class="mh">0xf5f5f500</span><span class="p">,</span> <span class="mh">0xf9f9f900</span><span class="p">,</span> <span class="mh">0xb6b6b600</span><span class="p">,</span>
	<span class="mh">0x2f2f2f00</span><span class="p">,</span> <span class="mh">0xfdfdfd00</span><span class="p">,</span> <span class="mh">0xb4b4b400</span><span class="p">,</span> <span class="mh">0x59595900</span><span class="p">,</span>
	<span class="mh">0x78787800</span><span class="p">,</span> <span class="mh">0x98989800</span><span class="p">,</span> <span class="mh">0x06060600</span><span class="p">,</span> <span class="mh">0x6a6a6a00</span><span class="p">,</span>
	<span class="mh">0xe7e7e700</span><span class="p">,</span> <span class="mh">0x46464600</span><span class="p">,</span> <span class="mh">0x71717100</span><span class="p">,</span> <span class="mh">0xbababa00</span><span class="p">,</span>
	<span class="mh">0xd4d4d400</span><span class="p">,</span> <span class="mh">0x25252500</span><span class="p">,</span> <span class="mh">0xababab00</span><span class="p">,</span> <span class="mh">0x42424200</span><span class="p">,</span>
	<span class="mh">0x88888800</span><span class="p">,</span> <span class="mh">0xa2a2a200</span><span class="p">,</span> <span class="mh">0x8d8d8d00</span><span class="p">,</span> <span class="mh">0xfafafa00</span><span class="p">,</span>
	<span class="mh">0x72727200</span><span class="p">,</span> <span class="mh">0x07070700</span><span class="p">,</span> <span class="mh">0xb9b9b900</span><span class="p">,</span> <span class="mh">0x55555500</span><span class="p">,</span>
	<span class="mh">0xf8f8f800</span><span class="p">,</span> <span class="mh">0xeeeeee00</span><span class="p">,</span> <span class="mh">0xacacac00</span><span class="p">,</span> <span class="mh">0x0a0a0a00</span><span class="p">,</span>
	<span class="mh">0x36363600</span><span class="p">,</span> <span class="mh">0x49494900</span><span class="p">,</span> <span class="mh">0x2a2a2a00</span><span class="p">,</span> <span class="mh">0x68686800</span><span class="p">,</span>
	<span class="mh">0x3c3c3c00</span><span class="p">,</span> <span class="mh">0x38383800</span><span class="p">,</span> <span class="mh">0xf1f1f100</span><span class="p">,</span> <span class="mh">0xa4a4a400</span><span class="p">,</span>
	<span class="mh">0x40404000</span><span class="p">,</span> <span class="mh">0x28282800</span><span class="p">,</span> <span class="mh">0xd3d3d300</span><span class="p">,</span> <span class="mh">0x7b7b7b00</span><span class="p">,</span>
	<span class="mh">0xbbbbbb00</span><span class="p">,</span> <span class="mh">0xc9c9c900</span><span class="p">,</span> <span class="mh">0x43434300</span><span class="p">,</span> <span class="mh">0xc1c1c100</span><span class="p">,</span>
	<span class="mh">0x15151500</span><span class="p">,</span> <span class="mh">0xe3e3e300</span><span class="p">,</span> <span class="mh">0xadadad00</span><span class="p">,</span> <span class="mh">0xf4f4f400</span><span class="p">,</span>
	<span class="mh">0x77777700</span><span class="p">,</span> <span class="mh">0xc7c7c700</span><span class="p">,</span> <span class="mh">0x80808000</span><span class="p">,</span> <span class="mh">0x9e9e9e00</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">camellia_sp0222</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x00e0e0e0</span><span class="p">,</span> <span class="mh">0x00050505</span><span class="p">,</span> <span class="mh">0x00585858</span><span class="p">,</span> <span class="mh">0x00d9d9d9</span><span class="p">,</span>
	<span class="mh">0x00676767</span><span class="p">,</span> <span class="mh">0x004e4e4e</span><span class="p">,</span> <span class="mh">0x00818181</span><span class="p">,</span> <span class="mh">0x00cbcbcb</span><span class="p">,</span>
	<span class="mh">0x00c9c9c9</span><span class="p">,</span> <span class="mh">0x000b0b0b</span><span class="p">,</span> <span class="mh">0x00aeaeae</span><span class="p">,</span> <span class="mh">0x006a6a6a</span><span class="p">,</span>
	<span class="mh">0x00d5d5d5</span><span class="p">,</span> <span class="mh">0x00181818</span><span class="p">,</span> <span class="mh">0x005d5d5d</span><span class="p">,</span> <span class="mh">0x00828282</span><span class="p">,</span>
	<span class="mh">0x00464646</span><span class="p">,</span> <span class="mh">0x00dfdfdf</span><span class="p">,</span> <span class="mh">0x00d6d6d6</span><span class="p">,</span> <span class="mh">0x00272727</span><span class="p">,</span>
	<span class="mh">0x008a8a8a</span><span class="p">,</span> <span class="mh">0x00323232</span><span class="p">,</span> <span class="mh">0x004b4b4b</span><span class="p">,</span> <span class="mh">0x00424242</span><span class="p">,</span>
	<span class="mh">0x00dbdbdb</span><span class="p">,</span> <span class="mh">0x001c1c1c</span><span class="p">,</span> <span class="mh">0x009e9e9e</span><span class="p">,</span> <span class="mh">0x009c9c9c</span><span class="p">,</span>
	<span class="mh">0x003a3a3a</span><span class="p">,</span> <span class="mh">0x00cacaca</span><span class="p">,</span> <span class="mh">0x00252525</span><span class="p">,</span> <span class="mh">0x007b7b7b</span><span class="p">,</span>
	<span class="mh">0x000d0d0d</span><span class="p">,</span> <span class="mh">0x00717171</span><span class="p">,</span> <span class="mh">0x005f5f5f</span><span class="p">,</span> <span class="mh">0x001f1f1f</span><span class="p">,</span>
	<span class="mh">0x00f8f8f8</span><span class="p">,</span> <span class="mh">0x00d7d7d7</span><span class="p">,</span> <span class="mh">0x003e3e3e</span><span class="p">,</span> <span class="mh">0x009d9d9d</span><span class="p">,</span>
	<span class="mh">0x007c7c7c</span><span class="p">,</span> <span class="mh">0x00606060</span><span class="p">,</span> <span class="mh">0x00b9b9b9</span><span class="p">,</span> <span class="mh">0x00bebebe</span><span class="p">,</span>
	<span class="mh">0x00bcbcbc</span><span class="p">,</span> <span class="mh">0x008b8b8b</span><span class="p">,</span> <span class="mh">0x00161616</span><span class="p">,</span> <span class="mh">0x00343434</span><span class="p">,</span>
	<span class="mh">0x004d4d4d</span><span class="p">,</span> <span class="mh">0x00c3c3c3</span><span class="p">,</span> <span class="mh">0x00727272</span><span class="p">,</span> <span class="mh">0x00959595</span><span class="p">,</span>
	<span class="mh">0x00ababab</span><span class="p">,</span> <span class="mh">0x008e8e8e</span><span class="p">,</span> <span class="mh">0x00bababa</span><span class="p">,</span> <span class="mh">0x007a7a7a</span><span class="p">,</span>
	<span class="mh">0x00b3b3b3</span><span class="p">,</span> <span class="mh">0x00020202</span><span class="p">,</span> <span class="mh">0x00b4b4b4</span><span class="p">,</span> <span class="mh">0x00adadad</span><span class="p">,</span>
	<span class="mh">0x00a2a2a2</span><span class="p">,</span> <span class="mh">0x00acacac</span><span class="p">,</span> <span class="mh">0x00d8d8d8</span><span class="p">,</span> <span class="mh">0x009a9a9a</span><span class="p">,</span>
	<span class="mh">0x00171717</span><span class="p">,</span> <span class="mh">0x001a1a1a</span><span class="p">,</span> <span class="mh">0x00353535</span><span class="p">,</span> <span class="mh">0x00cccccc</span><span class="p">,</span>
	<span class="mh">0x00f7f7f7</span><span class="p">,</span> <span class="mh">0x00999999</span><span class="p">,</span> <span class="mh">0x00616161</span><span class="p">,</span> <span class="mh">0x005a5a5a</span><span class="p">,</span>
	<span class="mh">0x00e8e8e8</span><span class="p">,</span> <span class="mh">0x00242424</span><span class="p">,</span> <span class="mh">0x00565656</span><span class="p">,</span> <span class="mh">0x00404040</span><span class="p">,</span>
	<span class="mh">0x00e1e1e1</span><span class="p">,</span> <span class="mh">0x00636363</span><span class="p">,</span> <span class="mh">0x00090909</span><span class="p">,</span> <span class="mh">0x00333333</span><span class="p">,</span>
	<span class="mh">0x00bfbfbf</span><span class="p">,</span> <span class="mh">0x00989898</span><span class="p">,</span> <span class="mh">0x00979797</span><span class="p">,</span> <span class="mh">0x00858585</span><span class="p">,</span>
	<span class="mh">0x00686868</span><span class="p">,</span> <span class="mh">0x00fcfcfc</span><span class="p">,</span> <span class="mh">0x00ececec</span><span class="p">,</span> <span class="mh">0x000a0a0a</span><span class="p">,</span>
	<span class="mh">0x00dadada</span><span class="p">,</span> <span class="mh">0x006f6f6f</span><span class="p">,</span> <span class="mh">0x00535353</span><span class="p">,</span> <span class="mh">0x00626262</span><span class="p">,</span>
	<span class="mh">0x00a3a3a3</span><span class="p">,</span> <span class="mh">0x002e2e2e</span><span class="p">,</span> <span class="mh">0x00080808</span><span class="p">,</span> <span class="mh">0x00afafaf</span><span class="p">,</span>
	<span class="mh">0x00282828</span><span class="p">,</span> <span class="mh">0x00b0b0b0</span><span class="p">,</span> <span class="mh">0x00747474</span><span class="p">,</span> <span class="mh">0x00c2c2c2</span><span class="p">,</span>
	<span class="mh">0x00bdbdbd</span><span class="p">,</span> <span class="mh">0x00363636</span><span class="p">,</span> <span class="mh">0x00222222</span><span class="p">,</span> <span class="mh">0x00383838</span><span class="p">,</span>
	<span class="mh">0x00646464</span><span class="p">,</span> <span class="mh">0x001e1e1e</span><span class="p">,</span> <span class="mh">0x00393939</span><span class="p">,</span> <span class="mh">0x002c2c2c</span><span class="p">,</span>
	<span class="mh">0x00a6a6a6</span><span class="p">,</span> <span class="mh">0x00303030</span><span class="p">,</span> <span class="mh">0x00e5e5e5</span><span class="p">,</span> <span class="mh">0x00444444</span><span class="p">,</span>
	<span class="mh">0x00fdfdfd</span><span class="p">,</span> <span class="mh">0x00888888</span><span class="p">,</span> <span class="mh">0x009f9f9f</span><span class="p">,</span> <span class="mh">0x00656565</span><span class="p">,</span>
	<span class="mh">0x00878787</span><span class="p">,</span> <span class="mh">0x006b6b6b</span><span class="p">,</span> <span class="mh">0x00f4f4f4</span><span class="p">,</span> <span class="mh">0x00232323</span><span class="p">,</span>
	<span class="mh">0x00484848</span><span class="p">,</span> <span class="mh">0x00101010</span><span class="p">,</span> <span class="mh">0x00d1d1d1</span><span class="p">,</span> <span class="mh">0x00515151</span><span class="p">,</span>
	<span class="mh">0x00c0c0c0</span><span class="p">,</span> <span class="mh">0x00f9f9f9</span><span class="p">,</span> <span class="mh">0x00d2d2d2</span><span class="p">,</span> <span class="mh">0x00a0a0a0</span><span class="p">,</span>
	<span class="mh">0x00555555</span><span class="p">,</span> <span class="mh">0x00a1a1a1</span><span class="p">,</span> <span class="mh">0x00414141</span><span class="p">,</span> <span class="mh">0x00fafafa</span><span class="p">,</span>
	<span class="mh">0x00434343</span><span class="p">,</span> <span class="mh">0x00131313</span><span class="p">,</span> <span class="mh">0x00c4c4c4</span><span class="p">,</span> <span class="mh">0x002f2f2f</span><span class="p">,</span>
	<span class="mh">0x00a8a8a8</span><span class="p">,</span> <span class="mh">0x00b6b6b6</span><span class="p">,</span> <span class="mh">0x003c3c3c</span><span class="p">,</span> <span class="mh">0x002b2b2b</span><span class="p">,</span>
	<span class="mh">0x00c1c1c1</span><span class="p">,</span> <span class="mh">0x00ffffff</span><span class="p">,</span> <span class="mh">0x00c8c8c8</span><span class="p">,</span> <span class="mh">0x00a5a5a5</span><span class="p">,</span>
	<span class="mh">0x00202020</span><span class="p">,</span> <span class="mh">0x00898989</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x00909090</span><span class="p">,</span>
	<span class="mh">0x00474747</span><span class="p">,</span> <span class="mh">0x00efefef</span><span class="p">,</span> <span class="mh">0x00eaeaea</span><span class="p">,</span> <span class="mh">0x00b7b7b7</span><span class="p">,</span>
	<span class="mh">0x00151515</span><span class="p">,</span> <span class="mh">0x00060606</span><span class="p">,</span> <span class="mh">0x00cdcdcd</span><span class="p">,</span> <span class="mh">0x00b5b5b5</span><span class="p">,</span>
	<span class="mh">0x00121212</span><span class="p">,</span> <span class="mh">0x007e7e7e</span><span class="p">,</span> <span class="mh">0x00bbbbbb</span><span class="p">,</span> <span class="mh">0x00292929</span><span class="p">,</span>
	<span class="mh">0x000f0f0f</span><span class="p">,</span> <span class="mh">0x00b8b8b8</span><span class="p">,</span> <span class="mh">0x00070707</span><span class="p">,</span> <span class="mh">0x00040404</span><span class="p">,</span>
	<span class="mh">0x009b9b9b</span><span class="p">,</span> <span class="mh">0x00949494</span><span class="p">,</span> <span class="mh">0x00212121</span><span class="p">,</span> <span class="mh">0x00666666</span><span class="p">,</span>
	<span class="mh">0x00e6e6e6</span><span class="p">,</span> <span class="mh">0x00cecece</span><span class="p">,</span> <span class="mh">0x00ededed</span><span class="p">,</span> <span class="mh">0x00e7e7e7</span><span class="p">,</span>
	<span class="mh">0x003b3b3b</span><span class="p">,</span> <span class="mh">0x00fefefe</span><span class="p">,</span> <span class="mh">0x007f7f7f</span><span class="p">,</span> <span class="mh">0x00c5c5c5</span><span class="p">,</span>
	<span class="mh">0x00a4a4a4</span><span class="p">,</span> <span class="mh">0x00373737</span><span class="p">,</span> <span class="mh">0x00b1b1b1</span><span class="p">,</span> <span class="mh">0x004c4c4c</span><span class="p">,</span>
	<span class="mh">0x00919191</span><span class="p">,</span> <span class="mh">0x006e6e6e</span><span class="p">,</span> <span class="mh">0x008d8d8d</span><span class="p">,</span> <span class="mh">0x00767676</span><span class="p">,</span>
	<span class="mh">0x00030303</span><span class="p">,</span> <span class="mh">0x002d2d2d</span><span class="p">,</span> <span class="mh">0x00dedede</span><span class="p">,</span> <span class="mh">0x00969696</span><span class="p">,</span>
	<span class="mh">0x00262626</span><span class="p">,</span> <span class="mh">0x007d7d7d</span><span class="p">,</span> <span class="mh">0x00c6c6c6</span><span class="p">,</span> <span class="mh">0x005c5c5c</span><span class="p">,</span>
	<span class="mh">0x00d3d3d3</span><span class="p">,</span> <span class="mh">0x00f2f2f2</span><span class="p">,</span> <span class="mh">0x004f4f4f</span><span class="p">,</span> <span class="mh">0x00191919</span><span class="p">,</span>
	<span class="mh">0x003f3f3f</span><span class="p">,</span> <span class="mh">0x00dcdcdc</span><span class="p">,</span> <span class="mh">0x00797979</span><span class="p">,</span> <span class="mh">0x001d1d1d</span><span class="p">,</span>
	<span class="mh">0x00525252</span><span class="p">,</span> <span class="mh">0x00ebebeb</span><span class="p">,</span> <span class="mh">0x00f3f3f3</span><span class="p">,</span> <span class="mh">0x006d6d6d</span><span class="p">,</span>
	<span class="mh">0x005e5e5e</span><span class="p">,</span> <span class="mh">0x00fbfbfb</span><span class="p">,</span> <span class="mh">0x00696969</span><span class="p">,</span> <span class="mh">0x00b2b2b2</span><span class="p">,</span>
	<span class="mh">0x00f0f0f0</span><span class="p">,</span> <span class="mh">0x00313131</span><span class="p">,</span> <span class="mh">0x000c0c0c</span><span class="p">,</span> <span class="mh">0x00d4d4d4</span><span class="p">,</span>
	<span class="mh">0x00cfcfcf</span><span class="p">,</span> <span class="mh">0x008c8c8c</span><span class="p">,</span> <span class="mh">0x00e2e2e2</span><span class="p">,</span> <span class="mh">0x00757575</span><span class="p">,</span>
	<span class="mh">0x00a9a9a9</span><span class="p">,</span> <span class="mh">0x004a4a4a</span><span class="p">,</span> <span class="mh">0x00575757</span><span class="p">,</span> <span class="mh">0x00848484</span><span class="p">,</span>
	<span class="mh">0x00111111</span><span class="p">,</span> <span class="mh">0x00454545</span><span class="p">,</span> <span class="mh">0x001b1b1b</span><span class="p">,</span> <span class="mh">0x00f5f5f5</span><span class="p">,</span>
	<span class="mh">0x00e4e4e4</span><span class="p">,</span> <span class="mh">0x000e0e0e</span><span class="p">,</span> <span class="mh">0x00737373</span><span class="p">,</span> <span class="mh">0x00aaaaaa</span><span class="p">,</span>
	<span class="mh">0x00f1f1f1</span><span class="p">,</span> <span class="mh">0x00dddddd</span><span class="p">,</span> <span class="mh">0x00595959</span><span class="p">,</span> <span class="mh">0x00141414</span><span class="p">,</span>
	<span class="mh">0x006c6c6c</span><span class="p">,</span> <span class="mh">0x00929292</span><span class="p">,</span> <span class="mh">0x00545454</span><span class="p">,</span> <span class="mh">0x00d0d0d0</span><span class="p">,</span>
	<span class="mh">0x00787878</span><span class="p">,</span> <span class="mh">0x00707070</span><span class="p">,</span> <span class="mh">0x00e3e3e3</span><span class="p">,</span> <span class="mh">0x00494949</span><span class="p">,</span>
	<span class="mh">0x00808080</span><span class="p">,</span> <span class="mh">0x00505050</span><span class="p">,</span> <span class="mh">0x00a7a7a7</span><span class="p">,</span> <span class="mh">0x00f6f6f6</span><span class="p">,</span>
	<span class="mh">0x00777777</span><span class="p">,</span> <span class="mh">0x00939393</span><span class="p">,</span> <span class="mh">0x00868686</span><span class="p">,</span> <span class="mh">0x00838383</span><span class="p">,</span>
	<span class="mh">0x002a2a2a</span><span class="p">,</span> <span class="mh">0x00c7c7c7</span><span class="p">,</span> <span class="mh">0x005b5b5b</span><span class="p">,</span> <span class="mh">0x00e9e9e9</span><span class="p">,</span>
	<span class="mh">0x00eeeeee</span><span class="p">,</span> <span class="mh">0x008f8f8f</span><span class="p">,</span> <span class="mh">0x00010101</span><span class="p">,</span> <span class="mh">0x003d3d3d</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">camellia_sp3033</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x38003838</span><span class="p">,</span> <span class="mh">0x41004141</span><span class="p">,</span> <span class="mh">0x16001616</span><span class="p">,</span> <span class="mh">0x76007676</span><span class="p">,</span>
	<span class="mh">0xd900d9d9</span><span class="p">,</span> <span class="mh">0x93009393</span><span class="p">,</span> <span class="mh">0x60006060</span><span class="p">,</span> <span class="mh">0xf200f2f2</span><span class="p">,</span>
	<span class="mh">0x72007272</span><span class="p">,</span> <span class="mh">0xc200c2c2</span><span class="p">,</span> <span class="mh">0xab00abab</span><span class="p">,</span> <span class="mh">0x9a009a9a</span><span class="p">,</span>
	<span class="mh">0x75007575</span><span class="p">,</span> <span class="mh">0x06000606</span><span class="p">,</span> <span class="mh">0x57005757</span><span class="p">,</span> <span class="mh">0xa000a0a0</span><span class="p">,</span>
	<span class="mh">0x91009191</span><span class="p">,</span> <span class="mh">0xf700f7f7</span><span class="p">,</span> <span class="mh">0xb500b5b5</span><span class="p">,</span> <span class="mh">0xc900c9c9</span><span class="p">,</span>
	<span class="mh">0xa200a2a2</span><span class="p">,</span> <span class="mh">0x8c008c8c</span><span class="p">,</span> <span class="mh">0xd200d2d2</span><span class="p">,</span> <span class="mh">0x90009090</span><span class="p">,</span>
	<span class="mh">0xf600f6f6</span><span class="p">,</span> <span class="mh">0x07000707</span><span class="p">,</span> <span class="mh">0xa700a7a7</span><span class="p">,</span> <span class="mh">0x27002727</span><span class="p">,</span>
	<span class="mh">0x8e008e8e</span><span class="p">,</span> <span class="mh">0xb200b2b2</span><span class="p">,</span> <span class="mh">0x49004949</span><span class="p">,</span> <span class="mh">0xde00dede</span><span class="p">,</span>
	<span class="mh">0x43004343</span><span class="p">,</span> <span class="mh">0x5c005c5c</span><span class="p">,</span> <span class="mh">0xd700d7d7</span><span class="p">,</span> <span class="mh">0xc700c7c7</span><span class="p">,</span>
	<span class="mh">0x3e003e3e</span><span class="p">,</span> <span class="mh">0xf500f5f5</span><span class="p">,</span> <span class="mh">0x8f008f8f</span><span class="p">,</span> <span class="mh">0x67006767</span><span class="p">,</span>
	<span class="mh">0x1f001f1f</span><span class="p">,</span> <span class="mh">0x18001818</span><span class="p">,</span> <span class="mh">0x6e006e6e</span><span class="p">,</span> <span class="mh">0xaf00afaf</span><span class="p">,</span>
	<span class="mh">0x2f002f2f</span><span class="p">,</span> <span class="mh">0xe200e2e2</span><span class="p">,</span> <span class="mh">0x85008585</span><span class="p">,</span> <span class="mh">0x0d000d0d</span><span class="p">,</span>
	<span class="mh">0x53005353</span><span class="p">,</span> <span class="mh">0xf000f0f0</span><span class="p">,</span> <span class="mh">0x9c009c9c</span><span class="p">,</span> <span class="mh">0x65006565</span><span class="p">,</span>
	<span class="mh">0xea00eaea</span><span class="p">,</span> <span class="mh">0xa300a3a3</span><span class="p">,</span> <span class="mh">0xae00aeae</span><span class="p">,</span> <span class="mh">0x9e009e9e</span><span class="p">,</span>
	<span class="mh">0xec00ecec</span><span class="p">,</span> <span class="mh">0x80008080</span><span class="p">,</span> <span class="mh">0x2d002d2d</span><span class="p">,</span> <span class="mh">0x6b006b6b</span><span class="p">,</span>
	<span class="mh">0xa800a8a8</span><span class="p">,</span> <span class="mh">0x2b002b2b</span><span class="p">,</span> <span class="mh">0x36003636</span><span class="p">,</span> <span class="mh">0xa600a6a6</span><span class="p">,</span>
	<span class="mh">0xc500c5c5</span><span class="p">,</span> <span class="mh">0x86008686</span><span class="p">,</span> <span class="mh">0x4d004d4d</span><span class="p">,</span> <span class="mh">0x33003333</span><span class="p">,</span>
	<span class="mh">0xfd00fdfd</span><span class="p">,</span> <span class="mh">0x66006666</span><span class="p">,</span> <span class="mh">0x58005858</span><span class="p">,</span> <span class="mh">0x96009696</span><span class="p">,</span>
	<span class="mh">0x3a003a3a</span><span class="p">,</span> <span class="mh">0x09000909</span><span class="p">,</span> <span class="mh">0x95009595</span><span class="p">,</span> <span class="mh">0x10001010</span><span class="p">,</span>
	<span class="mh">0x78007878</span><span class="p">,</span> <span class="mh">0xd800d8d8</span><span class="p">,</span> <span class="mh">0x42004242</span><span class="p">,</span> <span class="mh">0xcc00cccc</span><span class="p">,</span>
	<span class="mh">0xef00efef</span><span class="p">,</span> <span class="mh">0x26002626</span><span class="p">,</span> <span class="mh">0xe500e5e5</span><span class="p">,</span> <span class="mh">0x61006161</span><span class="p">,</span>
	<span class="mh">0x1a001a1a</span><span class="p">,</span> <span class="mh">0x3f003f3f</span><span class="p">,</span> <span class="mh">0x3b003b3b</span><span class="p">,</span> <span class="mh">0x82008282</span><span class="p">,</span>
	<span class="mh">0xb600b6b6</span><span class="p">,</span> <span class="mh">0xdb00dbdb</span><span class="p">,</span> <span class="mh">0xd400d4d4</span><span class="p">,</span> <span class="mh">0x98009898</span><span class="p">,</span>
	<span class="mh">0xe800e8e8</span><span class="p">,</span> <span class="mh">0x8b008b8b</span><span class="p">,</span> <span class="mh">0x02000202</span><span class="p">,</span> <span class="mh">0xeb00ebeb</span><span class="p">,</span>
	<span class="mh">0x0a000a0a</span><span class="p">,</span> <span class="mh">0x2c002c2c</span><span class="p">,</span> <span class="mh">0x1d001d1d</span><span class="p">,</span> <span class="mh">0xb000b0b0</span><span class="p">,</span>
	<span class="mh">0x6f006f6f</span><span class="p">,</span> <span class="mh">0x8d008d8d</span><span class="p">,</span> <span class="mh">0x88008888</span><span class="p">,</span> <span class="mh">0x0e000e0e</span><span class="p">,</span>
	<span class="mh">0x19001919</span><span class="p">,</span> <span class="mh">0x87008787</span><span class="p">,</span> <span class="mh">0x4e004e4e</span><span class="p">,</span> <span class="mh">0x0b000b0b</span><span class="p">,</span>
	<span class="mh">0xa900a9a9</span><span class="p">,</span> <span class="mh">0x0c000c0c</span><span class="p">,</span> <span class="mh">0x79007979</span><span class="p">,</span> <span class="mh">0x11001111</span><span class="p">,</span>
	<span class="mh">0x7f007f7f</span><span class="p">,</span> <span class="mh">0x22002222</span><span class="p">,</span> <span class="mh">0xe700e7e7</span><span class="p">,</span> <span class="mh">0x59005959</span><span class="p">,</span>
	<span class="mh">0xe100e1e1</span><span class="p">,</span> <span class="mh">0xda00dada</span><span class="p">,</span> <span class="mh">0x3d003d3d</span><span class="p">,</span> <span class="mh">0xc800c8c8</span><span class="p">,</span>
	<span class="mh">0x12001212</span><span class="p">,</span> <span class="mh">0x04000404</span><span class="p">,</span> <span class="mh">0x74007474</span><span class="p">,</span> <span class="mh">0x54005454</span><span class="p">,</span>
	<span class="mh">0x30003030</span><span class="p">,</span> <span class="mh">0x7e007e7e</span><span class="p">,</span> <span class="mh">0xb400b4b4</span><span class="p">,</span> <span class="mh">0x28002828</span><span class="p">,</span>
	<span class="mh">0x55005555</span><span class="p">,</span> <span class="mh">0x68006868</span><span class="p">,</span> <span class="mh">0x50005050</span><span class="p">,</span> <span class="mh">0xbe00bebe</span><span class="p">,</span>
	<span class="mh">0xd000d0d0</span><span class="p">,</span> <span class="mh">0xc400c4c4</span><span class="p">,</span> <span class="mh">0x31003131</span><span class="p">,</span> <span class="mh">0xcb00cbcb</span><span class="p">,</span>
	<span class="mh">0x2a002a2a</span><span class="p">,</span> <span class="mh">0xad00adad</span><span class="p">,</span> <span class="mh">0x0f000f0f</span><span class="p">,</span> <span class="mh">0xca00caca</span><span class="p">,</span>
	<span class="mh">0x70007070</span><span class="p">,</span> <span class="mh">0xff00ffff</span><span class="p">,</span> <span class="mh">0x32003232</span><span class="p">,</span> <span class="mh">0x69006969</span><span class="p">,</span>
	<span class="mh">0x08000808</span><span class="p">,</span> <span class="mh">0x62006262</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0x24002424</span><span class="p">,</span>
	<span class="mh">0xd100d1d1</span><span class="p">,</span> <span class="mh">0xfb00fbfb</span><span class="p">,</span> <span class="mh">0xba00baba</span><span class="p">,</span> <span class="mh">0xed00eded</span><span class="p">,</span>
	<span class="mh">0x45004545</span><span class="p">,</span> <span class="mh">0x81008181</span><span class="p">,</span> <span class="mh">0x73007373</span><span class="p">,</span> <span class="mh">0x6d006d6d</span><span class="p">,</span>
	<span class="mh">0x84008484</span><span class="p">,</span> <span class="mh">0x9f009f9f</span><span class="p">,</span> <span class="mh">0xee00eeee</span><span class="p">,</span> <span class="mh">0x4a004a4a</span><span class="p">,</span>
	<span class="mh">0xc300c3c3</span><span class="p">,</span> <span class="mh">0x2e002e2e</span><span class="p">,</span> <span class="mh">0xc100c1c1</span><span class="p">,</span> <span class="mh">0x01000101</span><span class="p">,</span>
	<span class="mh">0xe600e6e6</span><span class="p">,</span> <span class="mh">0x25002525</span><span class="p">,</span> <span class="mh">0x48004848</span><span class="p">,</span> <span class="mh">0x99009999</span><span class="p">,</span>
	<span class="mh">0xb900b9b9</span><span class="p">,</span> <span class="mh">0xb300b3b3</span><span class="p">,</span> <span class="mh">0x7b007b7b</span><span class="p">,</span> <span class="mh">0xf900f9f9</span><span class="p">,</span>
	<span class="mh">0xce00cece</span><span class="p">,</span> <span class="mh">0xbf00bfbf</span><span class="p">,</span> <span class="mh">0xdf00dfdf</span><span class="p">,</span> <span class="mh">0x71007171</span><span class="p">,</span>
	<span class="mh">0x29002929</span><span class="p">,</span> <span class="mh">0xcd00cdcd</span><span class="p">,</span> <span class="mh">0x6c006c6c</span><span class="p">,</span> <span class="mh">0x13001313</span><span class="p">,</span>
	<span class="mh">0x64006464</span><span class="p">,</span> <span class="mh">0x9b009b9b</span><span class="p">,</span> <span class="mh">0x63006363</span><span class="p">,</span> <span class="mh">0x9d009d9d</span><span class="p">,</span>
	<span class="mh">0xc000c0c0</span><span class="p">,</span> <span class="mh">0x4b004b4b</span><span class="p">,</span> <span class="mh">0xb700b7b7</span><span class="p">,</span> <span class="mh">0xa500a5a5</span><span class="p">,</span>
	<span class="mh">0x89008989</span><span class="p">,</span> <span class="mh">0x5f005f5f</span><span class="p">,</span> <span class="mh">0xb100b1b1</span><span class="p">,</span> <span class="mh">0x17001717</span><span class="p">,</span>
	<span class="mh">0xf400f4f4</span><span class="p">,</span> <span class="mh">0xbc00bcbc</span><span class="p">,</span> <span class="mh">0xd300d3d3</span><span class="p">,</span> <span class="mh">0x46004646</span><span class="p">,</span>
	<span class="mh">0xcf00cfcf</span><span class="p">,</span> <span class="mh">0x37003737</span><span class="p">,</span> <span class="mh">0x5e005e5e</span><span class="p">,</span> <span class="mh">0x47004747</span><span class="p">,</span>
	<span class="mh">0x94009494</span><span class="p">,</span> <span class="mh">0xfa00fafa</span><span class="p">,</span> <span class="mh">0xfc00fcfc</span><span class="p">,</span> <span class="mh">0x5b005b5b</span><span class="p">,</span>
	<span class="mh">0x97009797</span><span class="p">,</span> <span class="mh">0xfe00fefe</span><span class="p">,</span> <span class="mh">0x5a005a5a</span><span class="p">,</span> <span class="mh">0xac00acac</span><span class="p">,</span>
	<span class="mh">0x3c003c3c</span><span class="p">,</span> <span class="mh">0x4c004c4c</span><span class="p">,</span> <span class="mh">0x03000303</span><span class="p">,</span> <span class="mh">0x35003535</span><span class="p">,</span>
	<span class="mh">0xf300f3f3</span><span class="p">,</span> <span class="mh">0x23002323</span><span class="p">,</span> <span class="mh">0xb800b8b8</span><span class="p">,</span> <span class="mh">0x5d005d5d</span><span class="p">,</span>
	<span class="mh">0x6a006a6a</span><span class="p">,</span> <span class="mh">0x92009292</span><span class="p">,</span> <span class="mh">0xd500d5d5</span><span class="p">,</span> <span class="mh">0x21002121</span><span class="p">,</span>
	<span class="mh">0x44004444</span><span class="p">,</span> <span class="mh">0x51005151</span><span class="p">,</span> <span class="mh">0xc600c6c6</span><span class="p">,</span> <span class="mh">0x7d007d7d</span><span class="p">,</span>
	<span class="mh">0x39003939</span><span class="p">,</span> <span class="mh">0x83008383</span><span class="p">,</span> <span class="mh">0xdc00dcdc</span><span class="p">,</span> <span class="mh">0xaa00aaaa</span><span class="p">,</span>
	<span class="mh">0x7c007c7c</span><span class="p">,</span> <span class="mh">0x77007777</span><span class="p">,</span> <span class="mh">0x56005656</span><span class="p">,</span> <span class="mh">0x05000505</span><span class="p">,</span>
	<span class="mh">0x1b001b1b</span><span class="p">,</span> <span class="mh">0xa400a4a4</span><span class="p">,</span> <span class="mh">0x15001515</span><span class="p">,</span> <span class="mh">0x34003434</span><span class="p">,</span>
	<span class="mh">0x1e001e1e</span><span class="p">,</span> <span class="mh">0x1c001c1c</span><span class="p">,</span> <span class="mh">0xf800f8f8</span><span class="p">,</span> <span class="mh">0x52005252</span><span class="p">,</span>
	<span class="mh">0x20002020</span><span class="p">,</span> <span class="mh">0x14001414</span><span class="p">,</span> <span class="mh">0xe900e9e9</span><span class="p">,</span> <span class="mh">0xbd00bdbd</span><span class="p">,</span>
	<span class="mh">0xdd00dddd</span><span class="p">,</span> <span class="mh">0xe400e4e4</span><span class="p">,</span> <span class="mh">0xa100a1a1</span><span class="p">,</span> <span class="mh">0xe000e0e0</span><span class="p">,</span>
	<span class="mh">0x8a008a8a</span><span class="p">,</span> <span class="mh">0xf100f1f1</span><span class="p">,</span> <span class="mh">0xd600d6d6</span><span class="p">,</span> <span class="mh">0x7a007a7a</span><span class="p">,</span>
	<span class="mh">0xbb00bbbb</span><span class="p">,</span> <span class="mh">0xe300e3e3</span><span class="p">,</span> <span class="mh">0x40004040</span><span class="p">,</span> <span class="mh">0x4f004f4f</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="n">u32</span> <span class="n">camellia_sp4404</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x70700070</span><span class="p">,</span> <span class="mh">0x2c2c002c</span><span class="p">,</span> <span class="mh">0xb3b300b3</span><span class="p">,</span> <span class="mh">0xc0c000c0</span><span class="p">,</span>
	<span class="mh">0xe4e400e4</span><span class="p">,</span> <span class="mh">0x57570057</span><span class="p">,</span> <span class="mh">0xeaea00ea</span><span class="p">,</span> <span class="mh">0xaeae00ae</span><span class="p">,</span>
	<span class="mh">0x23230023</span><span class="p">,</span> <span class="mh">0x6b6b006b</span><span class="p">,</span> <span class="mh">0x45450045</span><span class="p">,</span> <span class="mh">0xa5a500a5</span><span class="p">,</span>
	<span class="mh">0xeded00ed</span><span class="p">,</span> <span class="mh">0x4f4f004f</span><span class="p">,</span> <span class="mh">0x1d1d001d</span><span class="p">,</span> <span class="mh">0x92920092</span><span class="p">,</span>
	<span class="mh">0x86860086</span><span class="p">,</span> <span class="mh">0xafaf00af</span><span class="p">,</span> <span class="mh">0x7c7c007c</span><span class="p">,</span> <span class="mh">0x1f1f001f</span><span class="p">,</span>
	<span class="mh">0x3e3e003e</span><span class="p">,</span> <span class="mh">0xdcdc00dc</span><span class="p">,</span> <span class="mh">0x5e5e005e</span><span class="p">,</span> <span class="mh">0x0b0b000b</span><span class="p">,</span>
	<span class="mh">0xa6a600a6</span><span class="p">,</span> <span class="mh">0x39390039</span><span class="p">,</span> <span class="mh">0xd5d500d5</span><span class="p">,</span> <span class="mh">0x5d5d005d</span><span class="p">,</span>
	<span class="mh">0xd9d900d9</span><span class="p">,</span> <span class="mh">0x5a5a005a</span><span class="p">,</span> <span class="mh">0x51510051</span><span class="p">,</span> <span class="mh">0x6c6c006c</span><span class="p">,</span>
	<span class="mh">0x8b8b008b</span><span class="p">,</span> <span class="mh">0x9a9a009a</span><span class="p">,</span> <span class="mh">0xfbfb00fb</span><span class="p">,</span> <span class="mh">0xb0b000b0</span><span class="p">,</span>
	<span class="mh">0x74740074</span><span class="p">,</span> <span class="mh">0x2b2b002b</span><span class="p">,</span> <span class="mh">0xf0f000f0</span><span class="p">,</span> <span class="mh">0x84840084</span><span class="p">,</span>
	<span class="mh">0xdfdf00df</span><span class="p">,</span> <span class="mh">0xcbcb00cb</span><span class="p">,</span> <span class="mh">0x34340034</span><span class="p">,</span> <span class="mh">0x76760076</span><span class="p">,</span>
	<span class="mh">0x6d6d006d</span><span class="p">,</span> <span class="mh">0xa9a900a9</span><span class="p">,</span> <span class="mh">0xd1d100d1</span><span class="p">,</span> <span class="mh">0x04040004</span><span class="p">,</span>
	<span class="mh">0x14140014</span><span class="p">,</span> <span class="mh">0x3a3a003a</span><span class="p">,</span> <span class="mh">0xdede00de</span><span class="p">,</span> <span class="mh">0x11110011</span><span class="p">,</span>
	<span class="mh">0x32320032</span><span class="p">,</span> <span class="mh">0x9c9c009c</span><span class="p">,</span> <span class="mh">0x53530053</span><span class="p">,</span> <span class="mh">0xf2f200f2</span><span class="p">,</span>
	<span class="mh">0xfefe00fe</span><span class="p">,</span> <span class="mh">0xcfcf00cf</span><span class="p">,</span> <span class="mh">0xc3c300c3</span><span class="p">,</span> <span class="mh">0x7a7a007a</span><span class="p">,</span>
	<span class="mh">0x24240024</span><span class="p">,</span> <span class="mh">0xe8e800e8</span><span class="p">,</span> <span class="mh">0x60600060</span><span class="p">,</span> <span class="mh">0x69690069</span><span class="p">,</span>
	<span class="mh">0xaaaa00aa</span><span class="p">,</span> <span class="mh">0xa0a000a0</span><span class="p">,</span> <span class="mh">0xa1a100a1</span><span class="p">,</span> <span class="mh">0x62620062</span><span class="p">,</span>
	<span class="mh">0x54540054</span><span class="p">,</span> <span class="mh">0x1e1e001e</span><span class="p">,</span> <span class="mh">0xe0e000e0</span><span class="p">,</span> <span class="mh">0x64640064</span><span class="p">,</span>
	<span class="mh">0x10100010</span><span class="p">,</span> <span class="mh">0x00000000</span><span class="p">,</span> <span class="mh">0xa3a300a3</span><span class="p">,</span> <span class="mh">0x75750075</span><span class="p">,</span>
	<span class="mh">0x8a8a008a</span><span class="p">,</span> <span class="mh">0xe6e600e6</span><span class="p">,</span> <span class="mh">0x09090009</span><span class="p">,</span> <span class="mh">0xdddd00dd</span><span class="p">,</span>
	<span class="mh">0x87870087</span><span class="p">,</span> <span class="mh">0x83830083</span><span class="p">,</span> <span class="mh">0xcdcd00cd</span><span class="p">,</span> <span class="mh">0x90900090</span><span class="p">,</span>
	<span class="mh">0x73730073</span><span class="p">,</span> <span class="mh">0xf6f600f6</span><span class="p">,</span> <span class="mh">0x9d9d009d</span><span class="p">,</span> <span class="mh">0xbfbf00bf</span><span class="p">,</span>
	<span class="mh">0x52520052</span><span class="p">,</span> <span class="mh">0xd8d800d8</span><span class="p">,</span> <span class="mh">0xc8c800c8</span><span class="p">,</span> <span class="mh">0xc6c600c6</span><span class="p">,</span>
	<span class="mh">0x81810081</span><span class="p">,</span> <span class="mh">0x6f6f006f</span><span class="p">,</span> <span class="mh">0x13130013</span><span class="p">,</span> <span class="mh">0x63630063</span><span class="p">,</span>
	<span class="mh">0xe9e900e9</span><span class="p">,</span> <span class="mh">0xa7a700a7</span><span class="p">,</span> <span class="mh">0x9f9f009f</span><span class="p">,</span> <span class="mh">0xbcbc00bc</span><span class="p">,</span>
	<span class="mh">0x29290029</span><span class="p">,</span> <span class="mh">0xf9f900f9</span><span class="p">,</span> <span class="mh">0x2f2f002f</span><span class="p">,</span> <span class="mh">0xb4b400b4</span><span class="p">,</span>
	<span class="mh">0x78780078</span><span class="p">,</span> <span class="mh">0x06060006</span><span class="p">,</span> <span class="mh">0xe7e700e7</span><span class="p">,</span> <span class="mh">0x71710071</span><span class="p">,</span>
	<span class="mh">0xd4d400d4</span><span class="p">,</span> <span class="mh">0xabab00ab</span><span class="p">,</span> <span class="mh">0x88880088</span><span class="p">,</span> <span class="mh">0x8d8d008d</span><span class="p">,</span>
	<span class="mh">0x72720072</span><span class="p">,</span> <span class="mh">0xb9b900b9</span><span class="p">,</span> <span class="mh">0xf8f800f8</span><span class="p">,</span> <span class="mh">0xacac00ac</span><span class="p">,</span>
	<span class="mh">0x36360036</span><span class="p">,</span> <span class="mh">0x2a2a002a</span><span class="p">,</span> <span class="mh">0x3c3c003c</span><span class="p">,</span> <span class="mh">0xf1f100f1</span><span class="p">,</span>
	<span class="mh">0x40400040</span><span class="p">,</span> <span class="mh">0xd3d300d3</span><span class="p">,</span> <span class="mh">0xbbbb00bb</span><span class="p">,</span> <span class="mh">0x43430043</span><span class="p">,</span>
	<span class="mh">0x15150015</span><span class="p">,</span> <span class="mh">0xadad00ad</span><span class="p">,</span> <span class="mh">0x77770077</span><span class="p">,</span> <span class="mh">0x80800080</span><span class="p">,</span>
	<span class="mh">0x82820082</span><span class="p">,</span> <span class="mh">0xecec00ec</span><span class="p">,</span> <span class="mh">0x27270027</span><span class="p">,</span> <span class="mh">0xe5e500e5</span><span class="p">,</span>
	<span class="mh">0x85850085</span><span class="p">,</span> <span class="mh">0x35350035</span><span class="p">,</span> <span class="mh">0x0c0c000c</span><span class="p">,</span> <span class="mh">0x41410041</span><span class="p">,</span>
	<span class="mh">0xefef00ef</span><span class="p">,</span> <span class="mh">0x93930093</span><span class="p">,</span> <span class="mh">0x19190019</span><span class="p">,</span> <span class="mh">0x21210021</span><span class="p">,</span>
	<span class="mh">0x0e0e000e</span><span class="p">,</span> <span class="mh">0x4e4e004e</span><span class="p">,</span> <span class="mh">0x65650065</span><span class="p">,</span> <span class="mh">0xbdbd00bd</span><span class="p">,</span>
	<span class="mh">0xb8b800b8</span><span class="p">,</span> <span class="mh">0x8f8f008f</span><span class="p">,</span> <span class="mh">0xebeb00eb</span><span class="p">,</span> <span class="mh">0xcece00ce</span><span class="p">,</span>
	<span class="mh">0x30300030</span><span class="p">,</span> <span class="mh">0x5f5f005f</span><span class="p">,</span> <span class="mh">0xc5c500c5</span><span class="p">,</span> <span class="mh">0x1a1a001a</span><span class="p">,</span>
	<span class="mh">0xe1e100e1</span><span class="p">,</span> <span class="mh">0xcaca00ca</span><span class="p">,</span> <span class="mh">0x47470047</span><span class="p">,</span> <span class="mh">0x3d3d003d</span><span class="p">,</span>
	<span class="mh">0x01010001</span><span class="p">,</span> <span class="mh">0xd6d600d6</span><span class="p">,</span> <span class="mh">0x56560056</span><span class="p">,</span> <span class="mh">0x4d4d004d</span><span class="p">,</span>
	<span class="mh">0x0d0d000d</span><span class="p">,</span> <span class="mh">0x66660066</span><span class="p">,</span> <span class="mh">0xcccc00cc</span><span class="p">,</span> <span class="mh">0x2d2d002d</span><span class="p">,</span>
	<span class="mh">0x12120012</span><span class="p">,</span> <span class="mh">0x20200020</span><span class="p">,</span> <span class="mh">0xb1b100b1</span><span class="p">,</span> <span class="mh">0x99990099</span><span class="p">,</span>
	<span class="mh">0x4c4c004c</span><span class="p">,</span> <span class="mh">0xc2c200c2</span><span class="p">,</span> <span class="mh">0x7e7e007e</span><span class="p">,</span> <span class="mh">0x05050005</span><span class="p">,</span>
	<span class="mh">0xb7b700b7</span><span class="p">,</span> <span class="mh">0x31310031</span><span class="p">,</span> <span class="mh">0x17170017</span><span class="p">,</span> <span class="mh">0xd7d700d7</span><span class="p">,</span>
	<span class="mh">0x58580058</span><span class="p">,</span> <span class="mh">0x61610061</span><span class="p">,</span> <span class="mh">0x1b1b001b</span><span class="p">,</span> <span class="mh">0x1c1c001c</span><span class="p">,</span>
	<span class="mh">0x0f0f000f</span><span class="p">,</span> <span class="mh">0x16160016</span><span class="p">,</span> <span class="mh">0x18180018</span><span class="p">,</span> <span class="mh">0x22220022</span><span class="p">,</span>
	<span class="mh">0x44440044</span><span class="p">,</span> <span class="mh">0xb2b200b2</span><span class="p">,</span> <span class="mh">0xb5b500b5</span><span class="p">,</span> <span class="mh">0x91910091</span><span class="p">,</span>
	<span class="mh">0x08080008</span><span class="p">,</span> <span class="mh">0xa8a800a8</span><span class="p">,</span> <span class="mh">0xfcfc00fc</span><span class="p">,</span> <span class="mh">0x50500050</span><span class="p">,</span>
	<span class="mh">0xd0d000d0</span><span class="p">,</span> <span class="mh">0x7d7d007d</span><span class="p">,</span> <span class="mh">0x89890089</span><span class="p">,</span> <span class="mh">0x97970097</span><span class="p">,</span>
	<span class="mh">0x5b5b005b</span><span class="p">,</span> <span class="mh">0x95950095</span><span class="p">,</span> <span class="mh">0xffff00ff</span><span class="p">,</span> <span class="mh">0xd2d200d2</span><span class="p">,</span>
	<span class="mh">0xc4c400c4</span><span class="p">,</span> <span class="mh">0x48480048</span><span class="p">,</span> <span class="mh">0xf7f700f7</span><span class="p">,</span> <span class="mh">0xdbdb00db</span><span class="p">,</span>
	<span class="mh">0x03030003</span><span class="p">,</span> <span class="mh">0xdada00da</span><span class="p">,</span> <span class="mh">0x3f3f003f</span><span class="p">,</span> <span class="mh">0x94940094</span><span class="p">,</span>
	<span class="mh">0x5c5c005c</span><span class="p">,</span> <span class="mh">0x02020002</span><span class="p">,</span> <span class="mh">0x4a4a004a</span><span class="p">,</span> <span class="mh">0x33330033</span><span class="p">,</span>
	<span class="mh">0x67670067</span><span class="p">,</span> <span class="mh">0xf3f300f3</span><span class="p">,</span> <span class="mh">0x7f7f007f</span><span class="p">,</span> <span class="mh">0xe2e200e2</span><span class="p">,</span>
	<span class="mh">0x9b9b009b</span><span class="p">,</span> <span class="mh">0x26260026</span><span class="p">,</span> <span class="mh">0x37370037</span><span class="p">,</span> <span class="mh">0x3b3b003b</span><span class="p">,</span>
	<span class="mh">0x96960096</span><span class="p">,</span> <span class="mh">0x4b4b004b</span><span class="p">,</span> <span class="mh">0xbebe00be</span><span class="p">,</span> <span class="mh">0x2e2e002e</span><span class="p">,</span>
	<span class="mh">0x79790079</span><span class="p">,</span> <span class="mh">0x8c8c008c</span><span class="p">,</span> <span class="mh">0x6e6e006e</span><span class="p">,</span> <span class="mh">0x8e8e008e</span><span class="p">,</span>
	<span class="mh">0xf5f500f5</span><span class="p">,</span> <span class="mh">0xb6b600b6</span><span class="p">,</span> <span class="mh">0xfdfd00fd</span><span class="p">,</span> <span class="mh">0x59590059</span><span class="p">,</span>
	<span class="mh">0x98980098</span><span class="p">,</span> <span class="mh">0x6a6a006a</span><span class="p">,</span> <span class="mh">0x46460046</span><span class="p">,</span> <span class="mh">0xbaba00ba</span><span class="p">,</span>
	<span class="mh">0x25250025</span><span class="p">,</span> <span class="mh">0x42420042</span><span class="p">,</span> <span class="mh">0xa2a200a2</span><span class="p">,</span> <span class="mh">0xfafa00fa</span><span class="p">,</span>
	<span class="mh">0x07070007</span><span class="p">,</span> <span class="mh">0x55550055</span><span class="p">,</span> <span class="mh">0xeeee00ee</span><span class="p">,</span> <span class="mh">0x0a0a000a</span><span class="p">,</span>
	<span class="mh">0x49490049</span><span class="p">,</span> <span class="mh">0x68680068</span><span class="p">,</span> <span class="mh">0x38380038</span><span class="p">,</span> <span class="mh">0xa4a400a4</span><span class="p">,</span>
	<span class="mh">0x28280028</span><span class="p">,</span> <span class="mh">0x7b7b007b</span><span class="p">,</span> <span class="mh">0xc9c900c9</span><span class="p">,</span> <span class="mh">0xc1c100c1</span><span class="p">,</span>
	<span class="mh">0xe3e300e3</span><span class="p">,</span> <span class="mh">0xf4f400f4</span><span class="p">,</span> <span class="mh">0xc7c700c7</span><span class="p">,</span> <span class="mh">0x9e9e009e</span><span class="p">,</span>
<span class="p">};</span>


<span class="cp">#define CAMELLIA_MIN_KEY_SIZE        16</span>
<span class="cp">#define CAMELLIA_MAX_KEY_SIZE        32</span>
<span class="cp">#define CAMELLIA_BLOCK_SIZE          16</span>
<span class="cp">#define CAMELLIA_TABLE_BYTE_LEN     272</span>

<span class="cm">/*</span>
<span class="cm"> * NB: L and R below stand for &#39;left&#39; and &#39;right&#39; as in written numbers.</span>
<span class="cm"> * That is, in (xxxL,xxxR) pair xxxL holds most significant digits,</span>
<span class="cm"> * _not_ least significant ones!</span>
<span class="cm"> */</span>


<span class="cm">/* key constants */</span>

<span class="cp">#define CAMELLIA_SIGMA1L (0xA09E667FL)</span>
<span class="cp">#define CAMELLIA_SIGMA1R (0x3BCC908BL)</span>
<span class="cp">#define CAMELLIA_SIGMA2L (0xB67AE858L)</span>
<span class="cp">#define CAMELLIA_SIGMA2R (0x4CAA73B2L)</span>
<span class="cp">#define CAMELLIA_SIGMA3L (0xC6EF372FL)</span>
<span class="cp">#define CAMELLIA_SIGMA3R (0xE94F82BEL)</span>
<span class="cp">#define CAMELLIA_SIGMA4L (0x54FF53A5L)</span>
<span class="cp">#define CAMELLIA_SIGMA4R (0xF1D36F1CL)</span>
<span class="cp">#define CAMELLIA_SIGMA5L (0x10E527FAL)</span>
<span class="cp">#define CAMELLIA_SIGMA5R (0xDE682D1DL)</span>
<span class="cp">#define CAMELLIA_SIGMA6L (0xB05688C2L)</span>
<span class="cp">#define CAMELLIA_SIGMA6R (0xB3E6C1FDL)</span>

<span class="cm">/*</span>
<span class="cm"> *  macros</span>
<span class="cm"> */</span>
<span class="cp">#define ROLDQ(ll, lr, rl, rr, w0, w1, bits) ({		\</span>
<span class="cp">	w0 = ll;					\</span>
<span class="cp">	ll = (ll &lt;&lt; bits) + (lr &gt;&gt; (32 - bits));	\</span>
<span class="cp">	lr = (lr &lt;&lt; bits) + (rl &gt;&gt; (32 - bits));	\</span>
<span class="cp">	rl = (rl &lt;&lt; bits) + (rr &gt;&gt; (32 - bits));	\</span>
<span class="cp">	rr = (rr &lt;&lt; bits) + (w0 &gt;&gt; (32 - bits));	\</span>
<span class="cp">})</span>

<span class="cp">#define ROLDQo32(ll, lr, rl, rr, w0, w1, bits) ({	\</span>
<span class="cp">	w0 = ll;					\</span>
<span class="cp">	w1 = lr;					\</span>
<span class="cp">	ll = (lr &lt;&lt; (bits - 32)) + (rl &gt;&gt; (64 - bits));	\</span>
<span class="cp">	lr = (rl &lt;&lt; (bits - 32)) + (rr &gt;&gt; (64 - bits));	\</span>
<span class="cp">	rl = (rr &lt;&lt; (bits - 32)) + (w0 &gt;&gt; (64 - bits));	\</span>
<span class="cp">	rr = (w0 &lt;&lt; (bits - 32)) + (w1 &gt;&gt; (64 - bits));	\</span>
<span class="cp">})</span>

<span class="cp">#define CAMELLIA_F(xl, xr, kl, kr, yl, yr, il, ir, t0, t1) ({	\</span>
<span class="cp">	il = xl ^ kl;						\</span>
<span class="cp">	ir = xr ^ kr;						\</span>
<span class="cp">	t0 = il &gt;&gt; 16;						\</span>
<span class="cp">	t1 = ir &gt;&gt; 16;						\</span>
<span class="cp">	yl = camellia_sp1110[(u8)(ir)]				\</span>
<span class="cp">	   ^ camellia_sp0222[(u8)(t1 &gt;&gt; 8)]			\</span>
<span class="cp">	   ^ camellia_sp3033[(u8)(t1)]				\</span>
<span class="cp">	   ^ camellia_sp4404[(u8)(ir &gt;&gt; 8)];			\</span>
<span class="cp">	yr = camellia_sp1110[(u8)(t0 &gt;&gt; 8)]			\</span>
<span class="cp">	   ^ camellia_sp0222[(u8)(t0)]				\</span>
<span class="cp">	   ^ camellia_sp3033[(u8)(il &gt;&gt; 8)]			\</span>
<span class="cp">	   ^ camellia_sp4404[(u8)(il)];				\</span>
<span class="cp">	yl ^= yr;						\</span>
<span class="cp">	yr = ror32(yr, 8);					\</span>
<span class="cp">	yr ^= yl;						\</span>
<span class="cp">})</span>

<span class="cp">#define SUBKEY_L(INDEX) (subkey[(INDEX)*2])</span>
<span class="cp">#define SUBKEY_R(INDEX) (subkey[(INDEX)*2 + 1])</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup_tail</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="n">subkey</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">subL</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">subR</span><span class="p">,</span> <span class="kt">int</span> <span class="n">max</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">dw</span><span class="p">,</span> <span class="n">tl</span><span class="p">,</span> <span class="n">tr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">kw4l</span><span class="p">,</span> <span class="n">kw4r</span><span class="p">;</span>

	<span class="cm">/* absorb kw2 to other subkeys */</span>
	<span class="cm">/* round 2 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 4 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 6 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>
		<span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* modified for FLinv(kl2) */</span>
	<span class="cm">/* round 8 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 10 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 12 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span>
		<span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* modified for FLinv(kl4) */</span>
	<span class="cm">/* round 14 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 16 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="cm">/* round 18 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">max</span> <span class="o">==</span> <span class="mi">24</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* kw3 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

	<span class="cm">/* absorb kw4 to other subkeys */</span>
		<span class="n">kw4l</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span> <span class="n">kw4r</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span>
			<span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* modified for FLinv(kl6) */</span>
		<span class="cm">/* round 20 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="cm">/* round 22 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="cm">/* round 24 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="cm">/* kw3 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">subR</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">^=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

	<span class="cm">/* absorb kw4 to other subkeys */</span>
		<span class="n">kw4l</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span> <span class="n">kw4r</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
		<span class="cm">/* round 23 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
		<span class="cm">/* round 21 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
		<span class="cm">/* round 19 */</span>
		<span class="n">subL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
		<span class="n">kw4l</span> <span class="o">^=</span> <span class="n">kw4r</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">24</span><span class="p">];</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="n">kw4l</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span>
			<span class="n">kw4r</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* modified for FL(kl5) */</span>
	<span class="p">}</span>
	<span class="cm">/* round 17 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="cm">/* round 15 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="cm">/* round 13 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="n">kw4l</span> <span class="o">^=</span> <span class="n">kw4r</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">kw4l</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span>
		<span class="n">kw4r</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* modified for FL(kl3) */</span>
	<span class="cm">/* round 11 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="cm">/* round 9 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="cm">/* round 7 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="n">kw4l</span> <span class="o">^=</span> <span class="n">kw4r</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">kw4l</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>
		<span class="n">kw4r</span> <span class="o">^=</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* modified for FL(kl1) */</span>
	<span class="cm">/* round 5 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="cm">/* round 3 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="cm">/* round 1 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>
	<span class="cm">/* kw1 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4l</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="n">kw4r</span><span class="p">;</span>

	<span class="cm">/* key XOR is end of F-function */</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="cm">/* kw1 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>       <span class="cm">/* round 1 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="cm">/* round 2 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span> <span class="cm">/* round 3 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span> <span class="cm">/* round 4 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span> <span class="cm">/* round 5 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="n">tl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">subR</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span>  <span class="cm">/* FL(kl1) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">tl</span><span class="p">;</span> <span class="cm">/* round 6 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">tr</span><span class="p">;</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>       <span class="cm">/* FL(kl1) */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>       <span class="cm">/* FLinv(kl2) */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
	<span class="n">tl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">subR</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">9</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span>  <span class="cm">/* FLinv(kl2) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span> <span class="cm">/* round 7 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span> <span class="cm">/* round 8 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span> <span class="cm">/* round 9 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">14</span><span class="p">];</span> <span class="cm">/* round 10 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">14</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span> <span class="cm">/* round 11 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">15</span><span class="p">];</span>
	<span class="n">tl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">subR</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">16</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="cm">/* FL(kl3) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">^</span> <span class="n">tl</span><span class="p">;</span> <span class="cm">/* round 12 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">^</span> <span class="n">tr</span><span class="p">;</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>     <span class="cm">/* FL(kl3) */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>     <span class="cm">/* FLinv(kl4) */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="n">tl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">subR</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">17</span><span class="p">]);</span>
	<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="cm">/* FLinv(kl4) */</span>
		<span class="n">tr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">19</span><span class="p">];</span> <span class="cm">/* round 13 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">19</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span> <span class="cm">/* round 14 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">20</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">21</span><span class="p">];</span> <span class="cm">/* round 15 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">21</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span> <span class="cm">/* round 16 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span>
	<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">23</span><span class="p">];</span> <span class="cm">/* round 17 */</span>
	<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">23</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">max</span> <span class="o">==</span> <span class="mi">24</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span>     <span class="cm">/* round 18 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">22</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">23</span><span class="p">];</span> <span class="cm">/* kw3 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">23</span><span class="p">];</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">tl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">subR</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">24</span><span class="p">]);</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="cm">/* FL(kl5) */</span>
			<span class="n">tr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">^</span> <span class="n">tl</span><span class="p">;</span> <span class="cm">/* round 18 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">^</span> <span class="n">tr</span><span class="p">;</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">24</span><span class="p">];</span>     <span class="cm">/* FL(kl5) */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">24</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>     <span class="cm">/* FLinv(kl6) */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
		<span class="n">tl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">subR</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">subR</span><span class="p">[</span><span class="mi">25</span><span class="p">]);</span>
		<span class="n">dw</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">&amp;</span> <span class="n">subL</span><span class="p">[</span><span class="mi">25</span><span class="p">],</span> <span class="cm">/* FLinv(kl6) */</span>
			<span class="n">tr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol32</span><span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">=</span> <span class="n">tl</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">27</span><span class="p">];</span> <span class="cm">/* round 19 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">27</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">28</span><span class="p">];</span> <span class="cm">/* round 20 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">28</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span> <span class="cm">/* round 21 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">29</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span> <span class="cm">/* round 22 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span> <span class="cm">/* round 23 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>     <span class="cm">/* round 24 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">30</span><span class="p">];</span>
		<span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">^</span> <span class="n">subL</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span> <span class="cm">/* kw3 */</span>
		<span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">^</span> <span class="n">subR</span><span class="p">[</span><span class="mi">31</span><span class="p">];</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup128</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">subkey</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">subL</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">subR</span><span class="p">[</span><span class="mi">26</span><span class="p">];</span>

	<span class="cm">/**</span>
<span class="cm">	 *  k == kll || klr || krl || krr (|| is concatenation)</span>
<span class="cm">	 */</span>
	<span class="n">kll</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
	<span class="n">klr</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
	<span class="n">krr</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">12</span><span class="p">);</span>

	<span class="cm">/* generate KL dependent subkeys */</span>
	<span class="cm">/* kw1 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* kw2 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 15bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k3 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k4 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 15+30bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k7 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k8 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 15+30+15bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k10 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 15+30+15+17 bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* kl3 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* kl4 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 15+30+15+17+17 bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* k13 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k14 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 15+30+15+17+17+17 bit */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* k17 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k18 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>

	<span class="cm">/* generate KA */</span>
	<span class="n">kll</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">klr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">krl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">krr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA1L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA1R</span><span class="p">,</span>
		   <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">^=</span> <span class="n">w0</span><span class="p">;</span> <span class="n">krr</span> <span class="o">^=</span> <span class="n">w1</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA2L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA2R</span><span class="p">,</span>
		   <span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="cm">/* current status == (kll, klr, w0, w1) */</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA3L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA3R</span><span class="p">,</span>
		   <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">^=</span> <span class="n">w0</span><span class="p">;</span> <span class="n">krr</span> <span class="o">^=</span> <span class="n">w1</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA4L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA4R</span><span class="p">,</span>
		   <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">kll</span> <span class="o">^=</span> <span class="n">w0</span><span class="p">;</span> <span class="n">klr</span> <span class="o">^=</span> <span class="n">w1</span><span class="p">;</span>

	<span class="cm">/* generate KA dependent subkeys */</span>
	<span class="cm">/* k1, k2 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k5,k6 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* kl1, kl2 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k9 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k11, k12 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQo32</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>
	<span class="cm">/* k15, k16 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* kw3, kw4 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>

	<span class="n">camellia_setup_tail</span><span class="p">(</span><span class="n">subkey</span><span class="p">,</span> <span class="n">subL</span><span class="p">,</span> <span class="n">subR</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup256</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">subkey</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">;</span>        <span class="cm">/* left half of key */</span>
	<span class="n">u32</span> <span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">;</span>    <span class="cm">/* right half of key */</span>
	<span class="n">u32</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">;</span>    <span class="cm">/* temporary variables */</span>
	<span class="n">u32</span> <span class="n">subL</span><span class="p">[</span><span class="mi">34</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">subR</span><span class="p">[</span><span class="mi">34</span><span class="p">];</span>

	<span class="cm">/**</span>
<span class="cm">	 *  key = (kll || klr || krl || krr || krll || krlr || krrl || krrr)</span>
<span class="cm">	 *  (|| is concatenation)</span>
<span class="cm">	 */</span>
	<span class="n">kll</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
	<span class="n">klr</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
	<span class="n">krr</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">12</span><span class="p">);</span>
	<span class="n">krll</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">16</span><span class="p">);</span>
	<span class="n">krlr</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">20</span><span class="p">);</span>
	<span class="n">krrl</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">24</span><span class="p">);</span>
	<span class="n">krrr</span> <span class="o">=</span> <span class="n">get_unaligned_be32</span><span class="p">(</span><span class="n">key</span> <span class="o">+</span> <span class="mi">28</span><span class="p">);</span>

	<span class="cm">/* generate KL dependent subkeys */</span>
	<span class="cm">/* kw1 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* kw2 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQo32</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">45</span><span class="p">);</span>
	<span class="cm">/* k9 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k10 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* kl3 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* kl4 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">17</span><span class="p">);</span>
	<span class="cm">/* k17 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k18 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">23</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQo32</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>
	<span class="cm">/* k23 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">30</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k24 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>

	<span class="cm">/* generate KR dependent subkeys */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k3 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* k4 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* kl1 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* kl2 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k13 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* k14 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">ROLDQo32</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>
	<span class="cm">/* k19 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* k20 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">ROLDQo32</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">34</span><span class="p">);</span>

	<span class="cm">/* generate KA */</span>
	<span class="n">kll</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">krll</span><span class="p">;</span> <span class="n">klr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="n">krl</span> <span class="o">=</span> <span class="n">subL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">krr</span> <span class="o">=</span> <span class="n">subR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA1L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA1R</span><span class="p">,</span>
		   <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">^=</span> <span class="n">w0</span><span class="p">;</span> <span class="n">krr</span> <span class="o">^=</span> <span class="n">w1</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA2L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA2R</span><span class="p">,</span>
		   <span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">kll</span> <span class="o">^=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">klr</span> <span class="o">^=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA3L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA3R</span><span class="p">,</span>
		   <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">krl</span> <span class="o">^=</span> <span class="n">w0</span> <span class="o">^</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">krr</span> <span class="o">^=</span> <span class="n">w1</span> <span class="o">^</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA4L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA4R</span><span class="p">,</span>
		   <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">kll</span> <span class="o">^=</span> <span class="n">w0</span><span class="p">;</span> <span class="n">klr</span> <span class="o">^=</span> <span class="n">w1</span><span class="p">;</span>

	<span class="cm">/* generate KB */</span>
	<span class="n">krll</span> <span class="o">^=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">krlr</span> <span class="o">^=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="n">krrl</span> <span class="o">^=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">krrr</span> <span class="o">^=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA5L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA5R</span><span class="p">,</span>
		   <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">krrl</span> <span class="o">^=</span> <span class="n">w0</span><span class="p">;</span> <span class="n">krrr</span> <span class="o">^=</span> <span class="n">w1</span><span class="p">;</span>
	<span class="n">CAMELLIA_F</span><span class="p">(</span><span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span>
		   <span class="n">CAMELLIA_SIGMA6L</span><span class="p">,</span> <span class="n">CAMELLIA_SIGMA6R</span><span class="p">,</span>
		   <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">);</span>
	<span class="n">krll</span> <span class="o">^=</span> <span class="n">w0</span><span class="p">;</span> <span class="n">krlr</span> <span class="o">^=</span> <span class="n">w1</span><span class="p">;</span>

	<span class="cm">/* generate KA dependent subkeys */</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">15</span><span class="p">);</span>
	<span class="cm">/* k5 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k6 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k11 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">14</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k12 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 32bit */</span>
	<span class="cm">/* kl5 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span>
	<span class="cm">/* kl6 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">25</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span>
	<span class="cm">/* rotation left shift 49 from k11,k12 -&gt; k21,k22 */</span>
	<span class="n">ROLDQo32</span><span class="p">(</span><span class="n">kll</span><span class="p">,</span> <span class="n">klr</span><span class="p">,</span> <span class="n">krl</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">49</span><span class="p">);</span>
	<span class="cm">/* k21 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="n">kll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">28</span><span class="p">]</span> <span class="o">=</span> <span class="n">klr</span><span class="p">;</span>
	<span class="cm">/* k22 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="n">krl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span> <span class="o">=</span> <span class="n">krr</span><span class="p">;</span>

	<span class="cm">/* generate KB dependent subkeys */</span>
	<span class="cm">/* k1 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* k2 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k7 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* k8 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">ROLDQ</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="cm">/* k15 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* k16 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>
	<span class="n">ROLDQo32</span><span class="p">(</span><span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="mi">51</span><span class="p">);</span>
	<span class="cm">/* kw3 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="n">krll</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="n">krlr</span><span class="p">;</span>
	<span class="cm">/* kw4 */</span>
	<span class="n">subL</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrl</span><span class="p">;</span> <span class="n">subR</span><span class="p">[</span><span class="mi">33</span><span class="p">]</span> <span class="o">=</span> <span class="n">krrr</span><span class="p">;</span>

	<span class="n">camellia_setup_tail</span><span class="p">(</span><span class="n">subkey</span><span class="p">,</span> <span class="n">subL</span><span class="p">,</span> <span class="n">subR</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_setup192</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">subkey</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">kk</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">krll</span><span class="p">,</span> <span class="n">krlr</span><span class="p">,</span> <span class="n">krrl</span><span class="p">,</span> <span class="n">krrr</span><span class="p">;</span>

	<span class="n">memcpy</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
	<span class="n">memcpy</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">krll</span><span class="p">,</span> <span class="n">key</span><span class="o">+</span><span class="mi">16</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">memcpy</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">krlr</span><span class="p">,</span> <span class="n">key</span><span class="o">+</span><span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">krrl</span> <span class="o">=</span> <span class="o">~</span><span class="n">krll</span><span class="p">;</span>
	<span class="n">krrr</span> <span class="o">=</span> <span class="o">~</span><span class="n">krlr</span><span class="p">;</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">kk</span><span class="o">+</span><span class="mi">24</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">krrl</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">kk</span><span class="o">+</span><span class="mi">28</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">krrr</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
	<span class="n">camellia_setup256</span><span class="p">(</span><span class="n">kk</span><span class="p">,</span> <span class="n">subkey</span><span class="p">);</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * Encrypt/decrypt</span>
<span class="cm"> */</span>
<span class="cp">#define CAMELLIA_FLS(ll, lr, rl, rr, kll, klr, krl, krr, t0, t1, t2, t3) ({ \</span>
<span class="cp">	t0 = kll;							\</span>
<span class="cp">	t2 = krr;							\</span>
<span class="cp">	t0 &amp;= ll;							\</span>
<span class="cp">	t2 |= rr;							\</span>
<span class="cp">	rl ^= t2;							\</span>
<span class="cp">	lr ^= rol32(t0, 1);						\</span>
<span class="cp">	t3 = krl;							\</span>
<span class="cp">	t1 = klr;							\</span>
<span class="cp">	t3 &amp;= rl;							\</span>
<span class="cp">	t1 |= lr;							\</span>
<span class="cp">	ll ^= t1;							\</span>
<span class="cp">	rr ^= rol32(t3, 1);						\</span>
<span class="cp">})</span>

<span class="cp">#define CAMELLIA_ROUNDSM(xl, xr, kl, kr, yl, yr, il, ir) ({		\</span>
<span class="cp">	yl ^= kl;							\</span>
<span class="cp">	yr ^= kr;							\</span>
<span class="cp">	ir =  camellia_sp1110[(u8)xr];					\</span>
<span class="cp">	il =  camellia_sp1110[(u8)(xl &gt;&gt; 24)];				\</span>
<span class="cp">	ir ^= camellia_sp0222[(u8)(xr &gt;&gt; 24)];				\</span>
<span class="cp">	il ^= camellia_sp0222[(u8)(xl &gt;&gt; 16)];				\</span>
<span class="cp">	ir ^= camellia_sp3033[(u8)(xr &gt;&gt; 16)];				\</span>
<span class="cp">	il ^= camellia_sp3033[(u8)(xl &gt;&gt; 8)];				\</span>
<span class="cp">	ir ^= camellia_sp4404[(u8)(xr &gt;&gt; 8)];				\</span>
<span class="cp">	il ^= camellia_sp4404[(u8)xl];					\</span>
<span class="cp">	ir ^= il;							\</span>
<span class="cp">	yl ^= ir;							\</span>
<span class="cp">	yr ^= ror32(il, 8) ^ ir;					\</span>
<span class="cp">})</span>

<span class="cm">/* max = 24: 128bit encrypt, max = 32: 256bit encrypt */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_do_encrypt</span><span class="p">(</span><span class="k">const</span> <span class="n">u32</span> <span class="o">*</span><span class="n">subkey</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">io</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">max</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">;</span>            <span class="cm">/* temporary variables */</span>

	<span class="cm">/* pre whitening but absorb kw2 */</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

	<span class="cm">/* main iteration */</span>
<span class="cp">#define ROUNDS(i) ({ \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[0], io[1], \</span>
<span class="cp">			 SUBKEY_L(i + 2), SUBKEY_R(i + 2), \</span>
<span class="cp">			 io[2], io[3], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[2], io[3], \</span>
<span class="cp">			 SUBKEY_L(i + 3), SUBKEY_R(i + 3), \</span>
<span class="cp">			 io[0], io[1], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[0], io[1], \</span>
<span class="cp">			 SUBKEY_L(i + 4), SUBKEY_R(i + 4), \</span>
<span class="cp">			 io[2], io[3], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[2], io[3], \</span>
<span class="cp">			 SUBKEY_L(i + 5), SUBKEY_R(i + 5), \</span>
<span class="cp">			 io[0], io[1], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[0], io[1], \</span>
<span class="cp">			 SUBKEY_L(i + 6), SUBKEY_R(i + 6), \</span>
<span class="cp">			 io[2], io[3], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[2], io[3], \</span>
<span class="cp">			 SUBKEY_L(i + 7), SUBKEY_R(i + 7), \</span>
<span class="cp">			 io[0], io[1], il, ir); \</span>
<span class="cp">})</span>
<span class="cp">#define FLS(i) ({ \</span>
<span class="cp">	CAMELLIA_FLS(io[0], io[1], io[2], io[3], \</span>
<span class="cp">		     SUBKEY_L(i + 0), SUBKEY_R(i + 0), \</span>
<span class="cp">		     SUBKEY_L(i + 1), SUBKEY_R(i + 1), \</span>
<span class="cp">		     t0, t1, il, ir); \</span>
<span class="cp">})</span>

	<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">FLS</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
	<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
	<span class="n">FLS</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
	<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">max</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">FLS</span><span class="p">(</span><span class="mi">24</span><span class="p">);</span>
		<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">24</span><span class="p">);</span>
	<span class="p">}</span>

<span class="cp">#undef ROUNDS</span>
<span class="cp">#undef FLS</span>

	<span class="cm">/* post whitening but kw4 */</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_L</span><span class="p">(</span><span class="n">max</span><span class="p">);</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_R</span><span class="p">(</span><span class="n">max</span><span class="p">);</span>
	<span class="cm">/* NB: io[0],[1] should be swapped with [2],[3] by caller! */</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_do_decrypt</span><span class="p">(</span><span class="k">const</span> <span class="n">u32</span> <span class="o">*</span><span class="n">subkey</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">io</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">il</span><span class="p">,</span> <span class="n">ir</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t1</span><span class="p">;</span>            <span class="cm">/* temporary variables */</span>

	<span class="cm">/* pre whitening but absorb kw2 */</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_L</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_R</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

	<span class="cm">/* main iteration */</span>
<span class="cp">#define ROUNDS(i) ({ \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[0], io[1], \</span>
<span class="cp">			 SUBKEY_L(i + 7), SUBKEY_R(i + 7), \</span>
<span class="cp">			 io[2], io[3], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[2], io[3], \</span>
<span class="cp">			 SUBKEY_L(i + 6), SUBKEY_R(i + 6), \</span>
<span class="cp">			 io[0], io[1], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[0], io[1], \</span>
<span class="cp">			 SUBKEY_L(i + 5), SUBKEY_R(i + 5), \</span>
<span class="cp">			 io[2], io[3], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[2], io[3], \</span>
<span class="cp">			 SUBKEY_L(i + 4), SUBKEY_R(i + 4), \</span>
<span class="cp">			 io[0], io[1], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[0], io[1], \</span>
<span class="cp">			 SUBKEY_L(i + 3), SUBKEY_R(i + 3), \</span>
<span class="cp">			 io[2], io[3], il, ir); \</span>
<span class="cp">	CAMELLIA_ROUNDSM(io[2], io[3], \</span>
<span class="cp">			 SUBKEY_L(i + 2), SUBKEY_R(i + 2), \</span>
<span class="cp">			 io[0], io[1], il, ir); \</span>
<span class="cp">})</span>
<span class="cp">#define FLS(i) ({ \</span>
<span class="cp">	CAMELLIA_FLS(io[0], io[1], io[2], io[3], \</span>
<span class="cp">		     SUBKEY_L(i + 1), SUBKEY_R(i + 1), \</span>
<span class="cp">		     SUBKEY_L(i + 0), SUBKEY_R(i + 0), \</span>
<span class="cp">		     t0, t1, il, ir); \</span>
<span class="cp">})</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">24</span><span class="p">);</span>
		<span class="n">FLS</span><span class="p">(</span><span class="mi">24</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
	<span class="n">FLS</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
	<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
	<span class="n">FLS</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
	<span class="n">ROUNDS</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="cp">#undef ROUNDS</span>
<span class="cp">#undef FLS</span>

	<span class="cm">/* post whitening but kw4 */</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_L</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="n">io</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^=</span> <span class="n">SUBKEY_R</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="cm">/* NB: 0,1 should be swapped with 2,3 by caller! */</span>
<span class="p">}</span>


<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">key_length</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">key_table</span><span class="p">[</span><span class="n">CAMELLIA_TABLE_BYTE_LEN</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">)];</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span>
<span class="nf">camellia_set_key</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">in_key</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">key_len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">cctx</span> <span class="o">=</span> <span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
	<span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">in_key</span><span class="p">;</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">flags</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">crt_flags</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">key_len</span> <span class="o">!=</span> <span class="mi">16</span> <span class="o">&amp;&amp;</span> <span class="n">key_len</span> <span class="o">!=</span> <span class="mi">24</span> <span class="o">&amp;&amp;</span> <span class="n">key_len</span> <span class="o">!=</span> <span class="mi">32</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">*</span><span class="n">flags</span> <span class="o">|=</span> <span class="n">CRYPTO_TFM_RES_BAD_KEY_LEN</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_length</span> <span class="o">=</span> <span class="n">key_len</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">key_len</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">16</span>:
		<span class="n">camellia_setup128</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">24</span>:
		<span class="n">camellia_setup192</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">32</span>:
		<span class="n">camellia_setup256</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">in</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">cctx</span> <span class="o">=</span> <span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">__be32</span> <span class="o">*</span><span class="n">src</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">__be32</span> <span class="o">*</span><span class="p">)</span><span class="n">in</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="o">*</span><span class="n">dst</span> <span class="o">=</span> <span class="p">(</span><span class="n">__be32</span> <span class="o">*</span><span class="p">)</span><span class="n">out</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">max</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

	<span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_length</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span>
		<span class="n">max</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">max</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span> <span class="cm">/* for key lengths of 24 and 32 */</span>

	<span class="n">camellia_do_encrypt</span><span class="p">(</span><span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">max</span><span class="p">);</span>

	<span class="cm">/* do_encrypt returns 0,1 swapped with 2,3 */</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">camellia_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">in</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">camellia_ctx</span> <span class="o">*</span><span class="n">cctx</span> <span class="o">=</span> <span class="n">crypto_tfm_ctx</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
	<span class="k">const</span> <span class="n">__be32</span> <span class="o">*</span><span class="n">src</span> <span class="o">=</span> <span class="p">(</span><span class="k">const</span> <span class="n">__be32</span> <span class="o">*</span><span class="p">)</span><span class="n">in</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="o">*</span><span class="n">dst</span> <span class="o">=</span> <span class="p">(</span><span class="n">__be32</span> <span class="o">*</span><span class="p">)</span><span class="n">out</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">max</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

	<span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
	<span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">be32_to_cpu</span><span class="p">(</span><span class="n">src</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_length</span> <span class="o">==</span> <span class="mi">16</span><span class="p">)</span>
		<span class="n">max</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">max</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span> <span class="cm">/* for key lengths of 24 and 32 */</span>

	<span class="n">camellia_do_decrypt</span><span class="p">(</span><span class="n">cctx</span><span class="o">-&gt;</span><span class="n">key_table</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">max</span><span class="p">);</span>

	<span class="cm">/* do_decrypt returns 0,1 swapped with 2,3 */</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">dst</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">cpu_to_be32</span><span class="p">(</span><span class="n">tmp</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">crypto_alg</span> <span class="n">camellia_alg</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">cra_name</span>		<span class="o">=</span>	<span class="s">&quot;camellia&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_driver_name</span>	<span class="o">=</span>	<span class="s">&quot;camellia-generic&quot;</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_priority</span>		<span class="o">=</span>	<span class="mi">100</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_flags</span>		<span class="o">=</span>	<span class="n">CRYPTO_ALG_TYPE_CIPHER</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_blocksize</span>		<span class="o">=</span>	<span class="n">CAMELLIA_BLOCK_SIZE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_ctxsize</span>		<span class="o">=</span>	<span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">camellia_ctx</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_alignmask</span>		<span class="o">=</span>	<span class="mi">3</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_module</span>		<span class="o">=</span>	<span class="n">THIS_MODULE</span><span class="p">,</span>
	<span class="p">.</span><span class="n">cra_list</span>		<span class="o">=</span>	<span class="n">LIST_HEAD_INIT</span><span class="p">(</span><span class="n">camellia_alg</span><span class="p">.</span><span class="n">cra_list</span><span class="p">),</span>
	<span class="p">.</span><span class="n">cra_u</span>			<span class="o">=</span>	<span class="p">{</span>
		<span class="p">.</span><span class="n">cipher</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">cia_min_keysize</span>	<span class="o">=</span>	<span class="n">CAMELLIA_MIN_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_max_keysize</span>	<span class="o">=</span>	<span class="n">CAMELLIA_MAX_KEY_SIZE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_setkey</span>		<span class="o">=</span>	<span class="n">camellia_set_key</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_encrypt</span>		<span class="o">=</span>	<span class="n">camellia_encrypt</span><span class="p">,</span>
			<span class="p">.</span><span class="n">cia_decrypt</span>		<span class="o">=</span>	<span class="n">camellia_decrypt</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">camellia_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_register_alg</span><span class="p">(</span><span class="o">&amp;</span><span class="n">camellia_alg</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">camellia_fini</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_unregister_alg</span><span class="p">(</span><span class="o">&amp;</span><span class="n">camellia_alg</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">module_init</span><span class="p">(</span><span class="n">camellia_init</span><span class="p">);</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">camellia_fini</span><span class="p">);</span>

<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;Camellia Cipher Algorithm&quot;</span><span class="p">);</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>
<span class="n">MODULE_ALIAS</span><span class="p">(</span><span class="s">&quot;camellia&quot;</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:1}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../javascript/docco.min.js"></script>
</html>
