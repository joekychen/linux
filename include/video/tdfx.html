<!DOCTYPE html>
<html><head><title>joekychen/linux » include › video › tdfx.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>tdfx.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _TDFX_H</span>
<span class="cp">#define _TDFX_H</span>

<span class="cp">#include &lt;linux/i2c.h&gt;</span>
<span class="cp">#include &lt;linux/i2c-algo-bit.h&gt;</span>

<span class="cm">/* membase0 register offsets */</span>
<span class="cp">#define STATUS		0x00</span>
<span class="cp">#define PCIINIT0	0x04</span>
<span class="cp">#define SIPMONITOR	0x08</span>
<span class="cp">#define LFBMEMORYCONFIG	0x0c</span>
<span class="cp">#define MISCINIT0	0x10</span>
<span class="cp">#define MISCINIT1	0x14</span>
<span class="cp">#define DRAMINIT0	0x18</span>
<span class="cp">#define DRAMINIT1	0x1c</span>
<span class="cp">#define AGPINIT		0x20</span>
<span class="cp">#define TMUGBEINIT	0x24</span>
<span class="cp">#define VGAINIT0	0x28</span>
<span class="cp">#define VGAINIT1	0x2c</span>
<span class="cp">#define DRAMCOMMAND	0x30</span>
<span class="cp">#define DRAMDATA	0x34</span>
<span class="cm">/* reserved	0x38 */</span>
<span class="cm">/* reserved	0x3c */</span>
<span class="cp">#define PLLCTRL0	0x40</span>
<span class="cp">#define PLLCTRL1	0x44</span>
<span class="cp">#define PLLCTRL2	0x48</span>
<span class="cp">#define DACMODE		0x4c</span>
<span class="cp">#define DACADDR		0x50</span>
<span class="cp">#define DACDATA		0x54</span>
<span class="cp">#define RGBMAXDELTA	0x58</span>
<span class="cp">#define VIDPROCCFG	0x5c</span>
<span class="cp">#define HWCURPATADDR	0x60</span>
<span class="cp">#define HWCURLOC	0x64</span>
<span class="cp">#define HWCURC0		0x68</span>
<span class="cp">#define HWCURC1		0x6c</span>
<span class="cp">#define VIDINFORMAT	0x70</span>
<span class="cp">#define VIDINSTATUS	0x74</span>
<span class="cp">#define VIDSERPARPORT	0x78</span>
<span class="cp">#define VIDINXDELTA	0x7c</span>
<span class="cp">#define VIDININITERR	0x80</span>
<span class="cp">#define VIDINYDELTA	0x84</span>
<span class="cp">#define VIDPIXBUFTHOLD	0x88</span>
<span class="cp">#define VIDCHRMIN	0x8c</span>
<span class="cp">#define VIDCHRMAX	0x90</span>
<span class="cp">#define VIDCURLIN	0x94</span>
<span class="cp">#define VIDSCREENSIZE	0x98</span>
<span class="cp">#define VIDOVRSTARTCRD	0x9c</span>
<span class="cp">#define VIDOVRENDCRD	0xa0</span>
<span class="cp">#define VIDOVRDUDX	0xa4</span>
<span class="cp">#define VIDOVRDUDXOFF	0xa8</span>
<span class="cp">#define VIDOVRDVDY	0xac</span>
<span class="cm">/* ... */</span>
<span class="cp">#define VIDOVRDVDYOFF	0xe0</span>
<span class="cp">#define VIDDESKSTART	0xe4</span>
<span class="cp">#define VIDDESKSTRIDE	0xe8</span>
<span class="cp">#define VIDINADDR0	0xec</span>
<span class="cp">#define VIDINADDR1	0xf0</span>
<span class="cp">#define VIDINADDR2	0xf4</span>
<span class="cp">#define VIDINSTRIDE	0xf8</span>
<span class="cp">#define VIDCUROVRSTART	0xfc</span>

<span class="cp">#define INTCTRL		(0x00100000 + 0x04)</span>
<span class="cp">#define CLIP0MIN	(0x00100000 + 0x08)</span>
<span class="cp">#define CLIP0MAX	(0x00100000 + 0x0c)</span>
<span class="cp">#define DSTBASE		(0x00100000 + 0x10)</span>
<span class="cp">#define DSTFORMAT	(0x00100000 + 0x14)</span>
<span class="cp">#define SRCBASE		(0x00100000 + 0x34)</span>
<span class="cp">#define COMMANDEXTRA_2D	(0x00100000 + 0x38)</span>
<span class="cp">#define CLIP1MIN	(0x00100000 + 0x4c)</span>
<span class="cp">#define CLIP1MAX	(0x00100000 + 0x50)</span>
<span class="cp">#define SRCFORMAT	(0x00100000 + 0x54)</span>
<span class="cp">#define SRCSIZE		(0x00100000 + 0x58)</span>
<span class="cp">#define SRCXY		(0x00100000 + 0x5c)</span>
<span class="cp">#define COLORBACK	(0x00100000 + 0x60)</span>
<span class="cp">#define COLORFORE	(0x00100000 + 0x64)</span>
<span class="cp">#define DSTSIZE		(0x00100000 + 0x68)</span>
<span class="cp">#define DSTXY		(0x00100000 + 0x6c)</span>
<span class="cp">#define COMMAND_2D	(0x00100000 + 0x70)</span>
<span class="cp">#define LAUNCH_2D	(0x00100000 + 0x80)</span>

<span class="cp">#define COMMAND_3D	(0x00200000 + 0x120)</span>

<span class="cm">/* register bitfields (not all, only as needed) */</span>

<span class="cm">/* COMMAND_2D reg. values */</span>
<span class="cp">#define TDFX_ROP_COPY		0xcc	</span><span class="cm">/* src */</span><span class="cp"></span>
<span class="cp">#define TDFX_ROP_INVERT		0x55	</span><span class="cm">/* NOT dst */</span><span class="cp"></span>
<span class="cp">#define TDFX_ROP_XOR		0x66	</span><span class="cm">/* src XOR dst */</span><span class="cp"></span>

<span class="cp">#define AUTOINC_DSTX			BIT(10)</span>
<span class="cp">#define AUTOINC_DSTY			BIT(11)</span>
<span class="cp">#define COMMAND_2D_FILLRECT		0x05</span>
<span class="cp">#define COMMAND_2D_S2S_BITBLT		0x01	</span><span class="cm">/* screen to screen */</span><span class="cp"></span>
<span class="cp">#define COMMAND_2D_H2S_BITBLT		0x03	</span><span class="cm">/* host to screen */</span><span class="cp"></span>

<span class="cp">#define COMMAND_3D_NOP			0x00</span>
<span class="cp">#define STATUS_RETRACE			BIT(6)</span>
<span class="cp">#define STATUS_BUSY			BIT(9)</span>
<span class="cp">#define MISCINIT1_CLUT_INV		BIT(0)</span>
<span class="cp">#define MISCINIT1_2DBLOCK_DIS		BIT(15)</span>
<span class="cp">#define DRAMINIT0_SGRAM_NUM		BIT(26)</span>
<span class="cp">#define DRAMINIT0_SGRAM_TYPE		BIT(27)</span>
<span class="cp">#define DRAMINIT0_SGRAM_TYPE_MASK       (BIT(27) | BIT(28) | BIT(29))</span>
<span class="cp">#define DRAMINIT0_SGRAM_TYPE_SHIFT      27</span>
<span class="cp">#define DRAMINIT1_MEM_SDRAM		BIT(30)</span>
<span class="cp">#define VGAINIT0_VGA_DISABLE		BIT(0)</span>
<span class="cp">#define VGAINIT0_EXT_TIMING		BIT(1)</span>
<span class="cp">#define VGAINIT0_8BIT_DAC		BIT(2)</span>
<span class="cp">#define VGAINIT0_EXT_ENABLE		BIT(6)</span>
<span class="cp">#define VGAINIT0_WAKEUP_3C3		BIT(8)</span>
<span class="cp">#define VGAINIT0_LEGACY_DISABLE		BIT(9)</span>
<span class="cp">#define VGAINIT0_ALT_READBACK		BIT(10)</span>
<span class="cp">#define VGAINIT0_FAST_BLINK		BIT(11)</span>
<span class="cp">#define VGAINIT0_EXTSHIFTOUT		BIT(12)</span>
<span class="cp">#define VGAINIT0_DECODE_3C6		BIT(13)</span>
<span class="cp">#define VGAINIT0_SGRAM_HBLANK_DISABLE	BIT(22)</span>
<span class="cp">#define VGAINIT1_MASK			0x1fffff</span>
<span class="cp">#define VIDCFG_VIDPROC_ENABLE		BIT(0)</span>
<span class="cp">#define VIDCFG_CURS_X11			BIT(1)</span>
<span class="cp">#define VIDCFG_INTERLACE		BIT(3)</span>
<span class="cp">#define VIDCFG_HALF_MODE		BIT(4)</span>
<span class="cp">#define VIDCFG_DESK_ENABLE		BIT(7)</span>
<span class="cp">#define VIDCFG_CLUT_BYPASS		BIT(10)</span>
<span class="cp">#define VIDCFG_2X			BIT(26)</span>
<span class="cp">#define VIDCFG_HWCURSOR_ENABLE		BIT(27)</span>
<span class="cp">#define VIDCFG_PIXFMT_SHIFT             18</span>
<span class="cp">#define DACMODE_2X			BIT(0)</span>

<span class="cm">/* I2C bit locations in the VIDSERPARPORT register */</span>
<span class="cp">#define DDC_ENAB	0x00040000</span>
<span class="cp">#define DDC_SCL_OUT	0x00080000</span>
<span class="cp">#define DDC_SDA_OUT	0x00100000</span>
<span class="cp">#define DDC_SCL_IN	0x00200000</span>
<span class="cp">#define DDC_SDA_IN	0x00400000</span>
<span class="cp">#define I2C_ENAB	0x00800000</span>
<span class="cp">#define I2C_SCL_OUT	0x01000000</span>
<span class="cp">#define I2C_SDA_OUT	0x02000000</span>
<span class="cp">#define I2C_SCL_IN	0x04000000</span>
<span class="cp">#define I2C_SDA_IN	0x08000000</span>

<span class="cm">/* VGA rubbish, need to change this for multihead support */</span>
<span class="cp">#define MISC_W		0x3c2</span>
<span class="cp">#define MISC_R		0x3cc</span>
<span class="cp">#define SEQ_I		0x3c4</span>
<span class="cp">#define SEQ_D		0x3c5</span>
<span class="cp">#define CRT_I		0x3d4</span>
<span class="cp">#define CRT_D		0x3d5</span>
<span class="cp">#define ATT_IW		0x3c0</span>
<span class="cp">#define IS1_R		0x3da</span>
<span class="cp">#define GRA_I		0x3ce</span>
<span class="cp">#define GRA_D		0x3cf</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="k">struct</span> <span class="n">banshee_reg</span> <span class="p">{</span>
	<span class="cm">/* VGA rubbish */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">att</span><span class="p">[</span><span class="mi">21</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">crt</span><span class="p">[</span><span class="mi">25</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">gra</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">misc</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">seq</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

	<span class="cm">/* Banshee extensions */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ext</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vidcfg</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vidpll</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mempll</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gfxpll</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">dacmode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vgainit0</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">vgainit1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">screensize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">stride</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cursloc</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">curspataddr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cursc0</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cursc1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">startaddr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">clip0min</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">clip0max</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">clip1min</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">clip1max</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">miscinit0</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tdfx_par</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">tdfxfb_i2c_chan</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">tdfx_par</span> <span class="o">*</span><span class="n">par</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">i2c_adapter</span> <span class="n">adapter</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">i2c_algo_bit_data</span> <span class="n">algo</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tdfx_par</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">max_pixclock</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">palette</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">regbase_virt</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">iobase</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">mtrr_handle</span><span class="p">;</span>
<span class="cp">#ifdef CONFIG_FB_3DFX_I2C</span>
	<span class="k">struct</span> <span class="n">tdfxfb_i2c_chan</span> <span class="n">chan</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="cp">#endif	</span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>

<span class="cp">#endif	</span><span class="cm">/* _TDFX_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
