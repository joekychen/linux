<!DOCTYPE html>
<html><head><title>joekychen/linux » include › video › sstfb.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>sstfb.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * linux/drivers/video/sstfb.h -- voodoo graphics frame buffer</span>
<span class="cm"> *</span>
<span class="cm"> *     Copyright (c) 2000,2001 Ghozlane Toumi &lt;gtoumi@messel.emse.fr&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *     Created 28 Aug 2001 by Ghozlane Toumi</span>
<span class="cm"> */</span>


<span class="cp">#ifndef _SSTFB_H_</span>
<span class="cp">#define _SSTFB_H_</span>

<span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> *  Debug Stuff</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifdef SST_DEBUG</span>
<span class="cp">#  define dprintk(X...)		printk(&quot;sstfb: &quot; X)</span>
<span class="cp">#  define SST_DEBUG_REG  1</span>
<span class="cp">#  define SST_DEBUG_FUNC 1</span>
<span class="cp">#  define SST_DEBUG_VAR  1</span>
<span class="cp">#else</span>
<span class="cp">#  define dprintk(X...)</span>
<span class="cp">#  define SST_DEBUG_REG  0</span>
<span class="cp">#  define SST_DEBUG_FUNC 0</span>
<span class="cp">#  define SST_DEBUG_VAR  0</span>
<span class="cp">#endif</span>

<span class="cp">#if (SST_DEBUG_REG &gt; 0)</span>
<span class="cp">#  define r_dprintk(X...)	dprintk(X)</span>
<span class="cp">#else</span>
<span class="cp">#  define r_dprintk(X...)</span>
<span class="cp">#endif</span>
<span class="cp">#if (SST_DEBUG_REG &gt; 1)</span>
<span class="cp">#  define r_ddprintk(X...)	dprintk(&quot; &quot; X)</span>
<span class="cp">#else</span>
<span class="cp">#  define r_ddprintk(X...)</span>
<span class="cp">#endif</span>

<span class="cp">#if (SST_DEBUG_FUNC &gt; 0)</span>
<span class="cp">#  define f_dprintk(X...)	dprintk(X)</span>
<span class="cp">#else</span>
<span class="cp">#  define f_dprintk(X...)</span>
<span class="cp">#endif</span>
<span class="cp">#if (SST_DEBUG_FUNC &gt; 1)</span>
<span class="cp">#  define f_ddprintk(X...)	dprintk(&quot; &quot; X)</span>
<span class="cp">#else</span>
<span class="cp">#  define f_ddprintk(X...)</span>
<span class="cp">#endif</span>
<span class="cp">#if (SST_DEBUG_FUNC &gt; 2)</span>
<span class="cp">#  define f_dddprintk(X...)	dprintk(&quot; &quot; X)</span>
<span class="cp">#else</span>
<span class="cp">#  define f_dddprintk(X...)</span>
<span class="cp">#endif</span>

<span class="cp">#if (SST_DEBUG_VAR &gt; 0)</span>
<span class="cp">#  define v_dprintk(X...)	dprintk(X)</span>
<span class="cp">#  define print_var(V, X...)	\</span>
<span class="cp">   {				\</span>
<span class="cp">     dprintk(X);		\</span>
<span class="cp">     printk(&quot; :\n&quot;);		\</span>
<span class="cp">     sst_dbg_print_var(V);	\</span>
<span class="cp">   }</span>
<span class="cp">#else</span>
<span class="cp">#  define v_dprintk(X...)</span>
<span class="cp">#  define print_var(X,Y...)</span>
<span class="cp">#endif</span>

<span class="cp">#define POW2(x)		(1ul&lt;&lt;(x))</span>

<span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> *  Const</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/* pci stuff */</span>
<span class="cp">#define PCI_INIT_ENABLE		0x40</span>
<span class="cp">#  define PCI_EN_INIT_WR	  BIT(0)</span>
<span class="cp">#  define PCI_EN_FIFO_WR	  BIT(1)</span>
<span class="cp">#  define PCI_REMAP_DAC		  BIT(2)</span>
<span class="cp">#define PCI_VCLK_ENABLE		0xc0	</span><span class="cm">/* enable video */</span><span class="cp"></span>
<span class="cp">#define PCI_VCLK_DISABLE	0xe0</span>

<span class="cm">/* register offsets from memBaseAddr */</span>
<span class="cp">#define STATUS			0x0000</span>
<span class="cp">#  define STATUS_FBI_BUSY	  BIT(7)</span>
<span class="cp">#define FBZMODE			0x0110</span>
<span class="cp">#  define EN_CLIPPING		  BIT(0)	</span><span class="cm">/* enable clipping */</span><span class="cp"></span>
<span class="cp">#  define EN_RGB_WRITE		  BIT(9)	</span><span class="cm">/* enable writes to rgb area */</span><span class="cp"></span>
<span class="cp">#  define EN_ALPHA_WRITE	  BIT(10)</span>
<span class="cp">#  define ENGINE_INVERT_Y	  BIT(17)	</span><span class="cm">/* invert Y origin (pipe) */</span><span class="cp"></span>
<span class="cp">#define LFBMODE			0x0114</span>
<span class="cp">#  define LFB_565		  0		</span><span class="cm">/* bits 3:0 .16 bits RGB */</span><span class="cp"></span>
<span class="cp">#  define LFB_888		  4		</span><span class="cm">/* 24 bits RGB */</span><span class="cp"></span>
<span class="cp">#  define LFB_8888		  5		</span><span class="cm">/* 32 bits ARGB */</span><span class="cp"></span>
<span class="cp">#  define WR_BUFF_FRONT		  0		</span><span class="cm">/* write buf select (front) */</span><span class="cp"></span>
<span class="cp">#  define WR_BUFF_BACK		  (1 &lt;&lt; 4)	</span><span class="cm">/* back */</span><span class="cp"></span>
<span class="cp">#  define RD_BUFF_FRONT		  0		</span><span class="cm">/* read buff select (front) */</span><span class="cp"></span>
<span class="cp">#  define RD_BUFF_BACK		  (1 &lt;&lt; 6)	</span><span class="cm">/* back */</span><span class="cp"></span>
<span class="cp">#  define EN_PXL_PIPELINE	  BIT(8)	</span><span class="cm">/* pixel pipeline (clip..)*/</span><span class="cp"></span>
<span class="cp">#  define LFB_WORD_SWIZZLE_WR	  BIT(11)	</span><span class="cm">/* enable write-wordswap (big-endian) */</span><span class="cp"></span>
<span class="cp">#  define LFB_BYTE_SWIZZLE_WR	  BIT(12)	</span><span class="cm">/* enable write-byteswap (big-endian) */</span><span class="cp"></span>
<span class="cp">#  define LFB_INVERT_Y		  BIT(13)	</span><span class="cm">/* invert Y origin (LFB) */</span><span class="cp"></span>
<span class="cp">#  define LFB_WORD_SWIZZLE_RD	  BIT(15)	</span><span class="cm">/* enable read-wordswap (big-endian) */</span><span class="cp"></span>
<span class="cp">#  define LFB_BYTE_SWIZZLE_RD	  BIT(16)	</span><span class="cm">/* enable read-byteswap (big-endian) */</span><span class="cp"></span>
<span class="cp">#define CLIP_LEFT_RIGHT		0x0118</span>
<span class="cp">#define CLIP_LOWY_HIGHY		0x011c</span>
<span class="cp">#define NOPCMD			0x0120</span>
<span class="cp">#define FASTFILLCMD		0x0124</span>
<span class="cp">#define SWAPBUFFCMD		0x0128</span>
<span class="cp">#define FBIINIT4		0x0200		</span><span class="cm">/* misc controls */</span><span class="cp"></span>
<span class="cp">#  define FAST_PCI_READS	  0		</span><span class="cm">/* 1 waitstate */</span><span class="cp"></span>
<span class="cp">#  define SLOW_PCI_READS	  BIT(0)	</span><span class="cm">/* 2 ws */</span><span class="cp"></span>
<span class="cp">#  define LFB_READ_AHEAD	  BIT(1)</span>
<span class="cp">#define BACKPORCH		0x0208</span>
<span class="cp">#define VIDEODIMENSIONS		0x020c</span>
<span class="cp">#define FBIINIT0		0x0210		</span><span class="cm">/* misc+fifo  controls */</span><span class="cp"></span>
<span class="cp">#  define DIS_VGA_PASSTHROUGH	  BIT(0)</span>
<span class="cp">#  define FBI_RESET		  BIT(1)</span>
<span class="cp">#  define FIFO_RESET		  BIT(2)</span>
<span class="cp">#define FBIINIT1		0x0214		</span><span class="cm">/* PCI + video controls */</span><span class="cp"></span>
<span class="cp">#  define VIDEO_MASK		  0x8080010f	</span><span class="cm">/* masks video related bits V1+V2*/</span><span class="cp"></span>
<span class="cp">#  define FAST_PCI_WRITES	  0		</span><span class="cm">/* 0 ws */</span><span class="cp"></span>
<span class="cp">#  define SLOW_PCI_WRITES	  BIT(1)	</span><span class="cm">/* 1 ws */</span><span class="cp"></span>
<span class="cp">#  define EN_LFB_READ		  BIT(3)</span>
<span class="cp">#  define TILES_IN_X_SHIFT	  4</span>
<span class="cp">#  define VIDEO_RESET		  BIT(8)</span>
<span class="cp">#  define EN_BLANKING		  BIT(12)</span>
<span class="cp">#  define EN_DATA_OE		  BIT(13)</span>
<span class="cp">#  define EN_BLANK_OE		  BIT(14)</span>
<span class="cp">#  define EN_HVSYNC_OE		  BIT(15)</span>
<span class="cp">#  define EN_DCLK_OE		  BIT(16)</span>
<span class="cp">#  define SEL_INPUT_VCLK_2X	  0		</span><span class="cm">/* bit 17 */</span><span class="cp"></span>
<span class="cp">#  define SEL_INPUT_VCLK_SLAVE	  BIT(17)</span>
<span class="cp">#  define SEL_SOURCE_VCLK_SLAVE	  0		</span><span class="cm">/* bits 21:20 */</span><span class="cp"></span>
<span class="cp">#  define SEL_SOURCE_VCLK_2X_DIV2 (0x01 &lt;&lt; 20)</span>
<span class="cp">#  define SEL_SOURCE_VCLK_2X_SEL  (0x02 &lt;&lt; 20)</span>
<span class="cp">#  define EN_24BPP		  BIT(22)</span>
<span class="cp">#  define TILES_IN_X_MSB_SHIFT	  24		</span><span class="cm">/* v2 */</span><span class="cp"></span>
<span class="cp">#  define VCLK_2X_SEL_DEL_SHIFT	  27		</span><span class="cm">/* vclk out delay 0,4,6,8ns */</span><span class="cp"></span>
<span class="cp">#  define VCLK_DEL_SHIFT	  29		</span><span class="cm">/* vclk in delay */</span><span class="cp"></span>
<span class="cp">#define FBIINIT2		0x0218		</span><span class="cm">/* Dram controls */</span><span class="cp"></span>
<span class="cp">#  define EN_FAST_RAS_READ	  BIT(5)</span>
<span class="cp">#  define EN_DRAM_OE		  BIT(6)</span>
<span class="cp">#  define EN_FAST_RD_AHEAD_WR	  BIT(7)</span>
<span class="cp">#  define VIDEO_OFFSET_SHIFT	  11		</span><span class="cm">/* unit: #rows tile 64x16/2 */</span><span class="cp"></span>
<span class="cp">#  define SWAP_DACVSYNC		  0</span>
<span class="cp">#  define SWAP_DACDATA0		  (1 &lt;&lt; 9)</span>
<span class="cp">#  define SWAP_FIFO_STALL	  (2 &lt;&lt; 9)</span>
<span class="cp">#  define EN_RD_AHEAD_FIFO	  BIT(21)</span>
<span class="cp">#  define EN_DRAM_REFRESH	  BIT(22)</span>
<span class="cp">#  define DRAM_REFRESH_16	  (0x30 &lt;&lt; 23)	</span><span class="cm">/* dram 16 ms */</span><span class="cp"></span>
<span class="cp">#define DAC_READ		FBIINIT2	</span><span class="cm">/* in remap mode */</span><span class="cp"></span>
<span class="cp">#define FBIINIT3		0x021c		</span><span class="cm">/* fbi controls */</span><span class="cp"></span>
<span class="cp">#  define DISABLE_TEXTURE	  BIT(6)</span>
<span class="cp">#  define Y_SWAP_ORIGIN_SHIFT	  22		</span><span class="cm">/* Y swap subtraction value */</span><span class="cp"></span>
<span class="cp">#define HSYNC			0x0220</span>
<span class="cp">#define VSYNC			0x0224</span>
<span class="cp">#define DAC_DATA		0x022c</span>
<span class="cp">#  define DAC_READ_CMD		  BIT(11)	</span><span class="cm">/* set read dacreg mode */</span><span class="cp"></span>
<span class="cp">#define FBIINIT5		0x0244		</span><span class="cm">/* v2 specific */</span><span class="cp"></span>
<span class="cp">#  define FBIINIT5_MASK		  0xfa40ffff    </span><span class="cm">/* mask video bits*/</span><span class="cp"></span>
<span class="cp">#  define HDOUBLESCAN		  BIT(20)</span>
<span class="cp">#  define VDOUBLESCAN		  BIT(21)</span>
<span class="cp">#  define HSYNC_HIGH 		  BIT(23)</span>
<span class="cp">#  define VSYNC_HIGH 		  BIT(24)</span>
<span class="cp">#  define INTERLACE		  BIT(26)</span>
<span class="cp">#define FBIINIT6		0x0248		</span><span class="cm">/* v2 specific */</span><span class="cp"></span>
<span class="cp">#  define TILES_IN_X_LSB_SHIFT	  30		</span><span class="cm">/* v2 */</span><span class="cp"></span>
<span class="cp">#define FBIINIT7		0x024c		</span><span class="cm">/* v2 specific */</span><span class="cp"></span>

<span class="cp">#define BLTSRCBASEADDR		0x02c0	</span><span class="cm">/* BitBLT Source base address */</span><span class="cp"></span>
<span class="cp">#define BLTDSTBASEADDR		0x02c4	</span><span class="cm">/* BitBLT Destination base address */</span><span class="cp"></span>
<span class="cp">#define BLTXYSTRIDES		0x02c8	</span><span class="cm">/* BitBLT Source and Destination strides */</span><span class="cp"></span>
<span class="cp">#define BLTSRCCHROMARANGE	0x02cc	</span><span class="cm">/* BitBLT Source Chroma key range */</span><span class="cp"></span>
<span class="cp">#define BLTDSTCHROMARANGE	0x02d0	</span><span class="cm">/* BitBLT Destination Chroma key range */</span><span class="cp"></span>
<span class="cp">#define BLTCLIPX		0x02d4	</span><span class="cm">/* BitBLT Min/Max X clip values */</span><span class="cp"></span>
<span class="cp">#define BLTCLIPY		0x02d8	</span><span class="cm">/* BitBLT Min/Max Y clip values */</span><span class="cp"></span>
<span class="cp">#define BLTSRCXY		0x02e0	</span><span class="cm">/* BitBLT Source starting XY coordinates */</span><span class="cp"></span>
<span class="cp">#define BLTDSTXY		0x02e4	</span><span class="cm">/* BitBLT Destination starting XY coordinates */</span><span class="cp"></span>
<span class="cp">#define BLTSIZE			0x02e8	</span><span class="cm">/* BitBLT width and height */</span><span class="cp"></span>
<span class="cp">#define BLTROP			0x02ec	</span><span class="cm">/* BitBLT Raster operations */</span><span class="cp"></span>
<span class="cp">#  define BLTROP_COPY		  0x0cccc</span>
<span class="cp">#  define BLTROP_INVERT		  0x05555</span>
<span class="cp">#  define BLTROP_XOR		  0x06666</span>
<span class="cp">#define BLTCOLOR		0x02f0	</span><span class="cm">/* BitBLT and foreground background colors */</span><span class="cp"></span>
<span class="cp">#define BLTCOMMAND		0x02f8	</span><span class="cm">/* BitBLT command mode (v2 specific) */</span><span class="cp"></span>
<span class="cp"># define BLT_SCR2SCR_BITBLT	  0	  </span><span class="cm">/* Screen-to-Screen BitBLT */</span><span class="cp"></span>
<span class="cp"># define BLT_CPU2SCR_BITBLT	  1	  </span><span class="cm">/* CPU-to-screen BitBLT */</span><span class="cp"></span>
<span class="cp"># define BLT_RECFILL_BITBLT	  2	  </span><span class="cm">/* BitBLT Rectangle Fill */</span><span class="cp"></span>
<span class="cp"># define BLT_16BPP_FMT		  2	  </span><span class="cm">/* 16 BPP (5-6-5 RGB) */</span><span class="cp"></span>
<span class="cp">#define BLTDATA			0x02fc	</span><span class="cm">/* BitBLT data for CPU-to-Screen BitBLTs */</span><span class="cp"></span>
<span class="cp">#  define LAUNCH_BITBLT		  BIT(31) </span><span class="cm">/* Launch BitBLT in BltCommand, bltDstXY or bltSize */</span><span class="cp"></span>

<span class="cm">/* Dac Registers */</span>
<span class="cp">#define DACREG_WMA		0x0	</span><span class="cm">/* pixel write mode address */</span><span class="cp"></span>
<span class="cp">#define DACREG_LUT		0x01	</span><span class="cm">/* color value */</span><span class="cp"></span>
<span class="cp">#define DACREG_RMR		0x02	</span><span class="cm">/* pixel mask */</span><span class="cp"></span>
<span class="cp">#define DACREG_RMA		0x03	</span><span class="cm">/* pixel read mode address */</span><span class="cp"></span>
<span class="cm">/*Dac registers in indexed mode (TI, ATT dacs) */</span>
<span class="cp">#define DACREG_ADDR_I		DACREG_WMA</span>
<span class="cp">#define DACREG_DATA_I		DACREG_RMR</span>
<span class="cp">#define DACREG_RMR_I		0x00</span>
<span class="cp">#define DACREG_CR0_I		0x01</span>
<span class="cp">#  define DACREG_CR0_EN_INDEXED	  BIT(0)	</span><span class="cm">/* enable indexec mode */</span><span class="cp"></span>
<span class="cp">#  define DACREG_CR0_8BIT	  BIT(1)	</span><span class="cm">/* set dac to 8 bits/read */</span><span class="cp"></span>
<span class="cp">#  define DACREG_CR0_PWDOWN	  BIT(3)	</span><span class="cm">/* powerdown dac */</span><span class="cp"></span>
<span class="cp">#  define DACREG_CR0_16BPP	  0x30		</span><span class="cm">/* mode 3 */</span><span class="cp"></span>
<span class="cp">#  define DACREG_CR0_24BPP	  0x50		</span><span class="cm">/* mode 5 */</span><span class="cp"></span>
<span class="cp">#define	DACREG_CR1_I		0x05</span>
<span class="cp">#define DACREG_CC_I		0x06</span>
<span class="cp">#  define DACREG_CC_CLKA	  BIT(7)	</span><span class="cm">/* clk A controlled by regs */</span><span class="cp"></span>
<span class="cp">#  define DACREG_CC_CLKA_C	  (2&lt;&lt;4)	</span><span class="cm">/* clk A uses reg C */</span><span class="cp"></span>
<span class="cp">#  define DACREG_CC_CLKB	  BIT(3)	</span><span class="cm">/* clk B controlled by regs */</span><span class="cp"></span>
<span class="cp">#  define DACREG_CC_CLKB_D	  3		</span><span class="cm">/* clkB uses reg D */</span><span class="cp"></span>
<span class="cp">#define DACREG_AC0_I		0x48		</span><span class="cm">/* clock A reg C */</span><span class="cp"></span>
<span class="cp">#define DACREG_AC1_I		0x49</span>
<span class="cp">#define DACREG_BD0_I		0x6c		</span><span class="cm">/* clock B reg D */</span><span class="cp"></span>
<span class="cp">#define DACREG_BD1_I		0x6d</span>

<span class="cm">/* identification constants */</span>
<span class="cp">#define DACREG_MIR_TI		0x97</span>
<span class="cp">#define DACREG_DIR_TI		0x09</span>
<span class="cp">#define DACREG_MIR_ATT		0x84</span>
<span class="cp">#define DACREG_DIR_ATT		0x09</span>
<span class="cm">/* ics dac specific registers */</span>
<span class="cp">#define DACREG_ICS_PLLWMA	0x04	</span><span class="cm">/* PLL write mode address */</span><span class="cp"></span>
<span class="cp">#define DACREG_ICS_PLLDATA	0x05	</span><span class="cm">/* PLL data /parameter */</span><span class="cp"></span>
<span class="cp">#define DACREG_ICS_CMD		0x06	</span><span class="cm">/* command */</span><span class="cp"></span>
<span class="cp">#  define DACREG_ICS_CMD_16BPP	  0x50	</span><span class="cm">/* ics color mode 6 (16bpp bypass)*/</span><span class="cp"></span>
<span class="cp">#  define DACREG_ICS_CMD_24BPP	  0x70	</span><span class="cm">/* ics color mode 7 (24bpp bypass)*/</span><span class="cp"></span>
<span class="cp">#  define DACREG_ICS_CMD_PWDOWN BIT(0)	</span><span class="cm">/* powerdown dac */</span><span class="cp"></span>
<span class="cp">#define DACREG_ICS_PLLRMA	0x07	</span><span class="cm">/* PLL read mode address */</span><span class="cp"></span>
<span class="cm">/*</span>
<span class="cm"> * pll parameter register:</span>
<span class="cm"> * indexed : write addr to PLLWMA, write data in PLLDATA.</span>
<span class="cm"> * for reads use PLLRMA .</span>
<span class="cm"> * 8 freq registers (0-7) for video clock (CLK0)</span>
<span class="cm"> * 2 freq registers (a-b) for graphic clock (CLK1)</span>
<span class="cm"> */</span>
<span class="cp">#define DACREG_ICS_PLL_CLK0_1_INI 0x55	</span><span class="cm">/* initial pll M value for freq f1  */</span><span class="cp"></span>
<span class="cp">#define DACREG_ICS_PLL_CLK0_7_INI 0x71	</span><span class="cm">/* f7 */</span><span class="cp"></span>
<span class="cp">#define DACREG_ICS_PLL_CLK1_B_INI 0x79	</span><span class="cm">/* fb */</span><span class="cp"></span>
<span class="cp">#define DACREG_ICS_PLL_CTRL	0x0e</span>
<span class="cp">#  define DACREG_ICS_CLK0	  BIT(5)</span>
<span class="cp">#  define DACREG_ICS_CLK0_0	  0</span>
<span class="cp">#  define DACREG_ICS_CLK1_A	  0	</span><span class="cm">/* bit4 */</span><span class="cp"></span>

<span class="cm">/* sst default init registers */</span>
<span class="cp">#define FBIINIT0_DEFAULT DIS_VGA_PASSTHROUGH</span>

<span class="cp">#define FBIINIT1_DEFAULT 	\</span>
<span class="cp">	(			\</span>
<span class="cp">	  FAST_PCI_WRITES	\</span>
<span class="cm">/*	  SLOW_PCI_WRITES*/</span><span class="cp">	\</span>
<span class="cp">	| VIDEO_RESET		\</span>
<span class="cp">	| 10 &lt;&lt; TILES_IN_X_SHIFT\</span>
<span class="cp">	| SEL_SOURCE_VCLK_2X_SEL\</span>
<span class="cp">	| EN_LFB_READ		\</span>
<span class="cp">	)</span>

<span class="cp">#define FBIINIT2_DEFAULT	\</span>
<span class="cp">	(			\</span>
<span class="cp">	 SWAP_DACVSYNC		\</span>
<span class="cp">	| EN_DRAM_OE		\</span>
<span class="cp">	| DRAM_REFRESH_16	\</span>
<span class="cp">	| EN_DRAM_REFRESH	\</span>
<span class="cp">	| EN_FAST_RAS_READ	\</span>
<span class="cp">	| EN_RD_AHEAD_FIFO	\</span>
<span class="cp">	| EN_FAST_RD_AHEAD_WR	\</span>
<span class="cp">	)</span>

<span class="cp">#define FBIINIT3_DEFAULT 	\</span>
<span class="cp">	( DISABLE_TEXTURE )</span>

<span class="cp">#define FBIINIT4_DEFAULT	\</span>
<span class="cp">	(			\</span>
<span class="cp">	  FAST_PCI_READS	\</span>
<span class="cm">/*	  SLOW_PCI_READS*/</span><span class="cp">	\</span>
<span class="cp">	| LFB_READ_AHEAD	\</span>
<span class="cp">	)</span>
<span class="cm">/* Careful with this one : writing back the data just read will trash the DAC</span>
<span class="cm">   reading some fields give logic value on pins, but setting this field will</span>
<span class="cm">   set the source signal driving the pin. conclusion : just use the default</span>
<span class="cm">   as a base before writing back .</span>
<span class="cm">*/</span>
<span class="cp">#define FBIINIT6_DEFAULT	(0x0)</span>

<span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> * Misc Const</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cm">/* ioctl to enable/disable VGA passthrough */</span>
<span class="cp">#define SSTFB_SET_VGAPASS	_IOW(&#39;F&#39;, 0xdd, __u32)</span>
<span class="cp">#define SSTFB_GET_VGAPASS	_IOR(&#39;F&#39;, 0xdd, __u32)</span>


<span class="cm">/* used to know witch clock to set */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">VID_CLOCK</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
	<span class="n">GFX_CLOCK</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* freq max */</span>
<span class="cp">#define DAC_FREF	14318	</span><span class="cm">/* DAC reference freq (Khz) */</span><span class="cp"></span>
<span class="cp">#define VCO_MAX		260000</span>

<span class="cm">/*</span>
<span class="cm"> *  driver structs</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">pll_timing</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">m</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">p</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">dac_switch</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">detect</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">fb_info</span> <span class="o">*</span><span class="n">info</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">set_pll</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">fb_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">pll_timing</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">clock</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_vidmod</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">fb_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">bpp</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">sst_spec</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="o">*</span> <span class="n">name</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">default_gfx_clock</span><span class="p">;</span>	<span class="cm">/* 50000 for voodoo1, 75000 for voodoo2 */</span>
	<span class="kt">int</span> <span class="n">max_gfxclk</span><span class="p">;</span> 	<span class="cm">/* ! in Mhz ie 60 for voodoo 1 */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">sstfb_par</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">palette</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">yDim</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hSyncOn</span><span class="p">;</span>	<span class="cm">/* hsync_len */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hSyncOff</span><span class="p">;</span>	<span class="cm">/* left_margin + xres + right_margin */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hBackPorch</span><span class="p">;</span><span class="cm">/* left_margin */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vSyncOn</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vSyncOff</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vBackPorch</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pll_timing</span> <span class="n">pll</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tiles_in_X</span><span class="p">;</span><span class="cm">/* num of tiles in X res */</span>
	<span class="n">u8</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">mmio_vbase</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dac_switch</span> 	<span class="n">dac_sw</span><span class="p">;</span>	<span class="cm">/* dac specific functions */</span>
	<span class="k">struct</span> <span class="n">pci_dev</span>		<span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">type</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">revision</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">vgapass</span><span class="p">;</span>	<span class="cm">/* VGA pass through: 1=enabled, 0=disabled */</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* _SSTFB_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
