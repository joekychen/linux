f | drm_crtc.h | s | 37K | 945 | Paulo Zanoni | paulo.r.zanoni@intel.com | 1339511791 |  | drm: increase DRM_OBJECT_MAX_PROPERTY to 24  Before Kernel 3.5, no one was checking for the return value of drm_connector_attach_property, so we never noticed that we were unable to create some properties. Commit "drm: WARN() when drm_connector_attach_property fails" added a WARN when we fail to create a property, and the transition from "connector properties" to "object properties" changed the warning message a little bit.  On i915 machines with many TV connectors we hit the maximum number of properties (since each TV connector uses a lot of properties), so we get a few backtraces in our logs. This commit increases the maximum number of properties to 24 hoping we'll have enough room for everybody.  Chris suggested that we convert this code to "lists", but I believe this conversion can come after we make sure people's dmesgs are not spammed by our driver.  Signed-off-by: Paulo Zanoni <paulo.r.zanoni@intel.com> Reported-by: Dave Jones <davej@redhat.com> Tested-by: Daniel Vetter <daniel.vetter@ffwll.ch> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | mga_drm.h | s | 12K | 364 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | drm_encoder_slave.h | s | 5.7K | 144 | Pekka Paalanen | pq@iki.fi | 1250662009 |  | drm/kms: no need to return void value (encoder)  Cc: Francisco Jerez <currojerez@riseup.net> Signed-off-by: Pekka Paalanen <pq@iki.fi> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_sysfs.h | s | 300B | 9 | Thomas Hellstrom | thellstrom@vmware.com | 1250662131 |  | drm: Enable drm drivers to add drm sysfs devices.  Export utility functions for drivers to add specialized devices in the sysfs drm class subdirectory.  Initially this will be needed form TTM to add a virtual device that handles power management.  Signed-off-by: Thomas Hellstrom <thellstrom@vmware.com> Signed-off-by: Dave Airlie <airlied@linux.ie>
f | drm_fourcc.h | s | 8.0K | 114 | Seung-Woo Kim | sw0312.kim@samsung.com | 1325125302 |  | drm: Add multi buffer plane pixel formats  Multi buffer plane pixel format has seperated memory spaces for each plane. For example, NV12M has Y plane and CbCr plane and these are in non contiguous memory region. Compared with NV12, NV12M's memory shape is like following. NV12  : ______(Y)(CbCr)_______ NV12M : __(Y)_ ..... _(CbCr)__  Signed-off-by: Seung-Woo Kim <sw0312.kim@samsung.com> Signed-off-by: Inki Dae <inki.dae@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com>
f | vmwgfx_drm.h | s | 21K | 702 | Thomas Hellstrom | thellstrom@vmware.com | 1320222631 |  | vmwgfx: Reinstate the update_layout ioctl  We need to redefine a connector as "connected" if it matches a window in the host preferred GUI layout. Otherwise "smart" window managers would turn on Xorg outputs that we don't want to be on.  This reinstates the update_layout and adds the following information to the modesetting system. a) Connection status <-> Equivalent to real hardware connection status b) Preferred mode <-> Equivalent to real hardware reading EDID c) Host window position <-> Equivalent to a real hardware scanout address dynamic register.  It should be noted that there is no assumption here about what should be displayed and where. Only how to access the host windows.  This also bumps minor to signal availability of the new IOCTL.  Based on code originally written by Jakob Bornecrantz  Signed-off-by: Thomas Hellstrom <thellstrom@vmware.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_fixed.h | s | 2.2K | 59 | Robert Morell | rmorell@nvidia.com | 1335515375 |  | drm: fixed: Add dfixed_frac  This helper macro retrieves the fractional part of a fixed20_12 20.12 fixed-point number.  Signed-off-by: Robert Morell <rmorell@nvidia.com> Signed-off-by: Olof Johansson <olofj@chromium.org> Signed-off-by: Thierry Reding <thierry.reding@avionic-design.de> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_usb.h | s | 375B | 10 | Dave Airlie | airlied@gmail.com | 1297048182 |  | drm: add usb framework  This adds an initial framework to plug USB graphics devices into the drm/kms subsystem.  I've started writing a displaylink driver using this interface.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | exynos_drm.h | s | 7.5K | 238 | Inki Dae | inki.dae@samsung.com | 1338864707 |  | drm/exynos: fixed size type.  size type of drm_exynos_gem_mmap struct is changed to uint64_t and it adds pad for the struct to be aligned as 64bit.  Signed-off-by: Inki Dae <inki.dae@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com>
f | drm_edid.h | s | 7.6K | 233 | Takashi Iwai | tiwai@suse.de | 1335199277 |  | drm/edid: Add packed attribute to new gtf2 and cvt structs  The new structs added in struct detailed_data_monitor_range must be marked with packed attribute although the outer struct itself is already marked as packed.  Otherwise these 7-bytes structs may be aligned, and give the wrong position and size for the data.  Signed-off-by: Takashi Iwai <tiwai@suse.de> Acked-by: Adam Jackson <ajax@redhat.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | i810_drm.h | s | 9.7K | 249 | Dave Airlie | airlied@redhat.com | 1215996301 |  | drm: reorganise drm tree to be more future proof.  With the coming of kernel based modesetting and the memory manager stuff, the everything in one directory approach was getting very ugly and starting to be unmanageable.  This restructures the drm along the lines of other kernel components.  It creates a drivers/gpu/drm directory and moves the hw drivers into subdirectores. It moves the includes into an include/drm, and sets up the unifdef for the userspace headers we should be exporting.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_buffer.h | s | 4.5K | 136 | Pauli Nieminen | suokkos@gmail.com | 1266882380 |  | drm: Add generic multipart buffer.  Allocating multiple pages of memory for data that is coming from user space may fail. To fix memory allocation failures the buffer object should be split to multiple independ pages.  drm buffer provides generic interface to copy and process large data arrays from user space.  Interface includes allocation and free functions to allocate the buffer object and data storage pages.  All access operations are performed relative to a internal pointer which is advanced with drm_buffer_advance function.  The buffer can be accessed using drm_buffer_pointer_to_XXX functions if it is known that requested object doesn't split over a page boundary. These functions don't do any error checking to maximize performance.  If there is large object which could be split there is special drm_buffer_read_object function. drm_buffer_read_object takes a pointer as argument which is used as temporary store for data if it is split over boundary in the buffer.  Signed-off-by: Pauli Nieminen <suokkos@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_dp_helper.h | s | 8.9K | 208 | Adam Jackson | ajax@redhat.com | 1337678316 |  | drm/dp: Add DPCD defines for register 0x007  Low four bits are downstream port count.  High bit indicates peer OUI support.  OUI matching will allow us to do additional per-sink handling for things like DP->VGA bandwidth limits or (hopefully) the iMac-as- display hack.  Signed-off-by: Adam Jackson <ajax@redhat.com> Reviewed-by: Jerome Glisse <jglisse@redhat.com> Acked-by: Daniel Vetter <daniel.vetter@ffwll.ch> Acked-by: Alex Deucher <alexander.deucher@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_crtc_helper.h | s | 6.3K | 147 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1337679273 |  | drm: Miscellaneous typo fixes and documentation updates  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Reviewed-by: Alex Deucher <alexander.deucher@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_fb_helper.h | s | 4.1K | 105 | Sascha Hauer | s.hauer@pengutronix.de | 1328262952 |  | drm fb helper: remove unused variable crtc_id  crtc_id is set but never used, so remove it from struct drm_fb_helper_crtc.  Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_core.h | s | 1.4K | 31 | Benjamin Herrenschmidt | benh@kernel.crashing.org | 1281392420 |  | drm: Fix support for PCI domains  (For some reason I thought that went in ages ago ...)  This fixes support for PCI domains in what should hopefully be a backward compatible way along with a change to libdrm.  When the interface version is set to 1.4, we assume userspace understands domains and the world is at peace. We thus pass proper domain numbers instead of 0 to userspace.  The newer libdrm will then try 1.4 first, and fallback to 1.1, along with ignoring domains in the later case (well, except on alpha of course)  Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drmP.h | s | 58K | 1534 | Dave Airlie | airlied@redhat.com | 1337766357 |  | drm/prime: introduce sg->pages/addr arrays helper  the ttm drivers need this currently, in order to get fault handling working and efficient.  It also allows addrs to be NULL for devices like udl.  Reviewed-by: Alex Deucher <alexander.deucher@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | savage_drm.h | s | 6.9K | 187 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | drm_os_linux.h | s | 3.9K | 111 | Daniel Vetter | daniel.vetter@ffwll.ch | 1257461227 |  | drm/i915: add i915_lp_ring_sync helper  This just waits until the hw passed the current ring position with cmd execution. This slightly changes the existing i915_wait_request function to make uninterruptible waiting possible - no point in returning to userspace while mucking around with the overlay, that piece of hw is just too fragile.  Also replace a magic 0 with the symbolic constant (and kill the then superflous comment) while I was looking at the code.  Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch> Signed-off-by: Eric Anholt <eric@anholt.net>
f | r128_drm.h | s | 9.7K | 285 | Dave Airlie | airlied@redhat.com | 1215996301 |  | drm: reorganise drm tree to be more future proof.  With the coming of kernel based modesetting and the memory manager stuff, the everything in one directory approach was getting very ugly and starting to be unmanageable.  This restructures the drm along the lines of other kernel components.  It creates a drivers/gpu/drm directory and moves the hw drivers into subdirectores. It moves the includes into an include/drm, and sets up the unifdef for the userspace headers we should be exporting.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | i915_drm.h | s | 26K | 788 | Daniel Vetter | daniel.vetter@ffwll.ch | 1332276940 |  | drm/i915: add HAS_ALIASING_PPGTT parameter for userspace  On Sanybridge a few MI read/write commands only work when ppgtt is enabled.  Userspace therefore needs to be able to check whether ppgtt is enabled. For added hilarity, you need to reset the "use global GTT" bit on snb when ppgtt is enabled, otherwise it won't work.  Despite what bspec says about automatically using ppgtt ...  Luckily PIPE_CONTROL (the only write cmd current userspace uses) is not affected by all this, as tested by tests/gem_pipe_control_store_loop.  Reviewed-and-tested-by: Chris Wilson <chris@chris-wilson.co.uk> Signed-Off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
f | drm_mem_util.h | s | 2.0K | 55 | Xi Wang | xi.wang@gmail.com | 1338511766 |  | introduce SIZE_MAX  ULONG_MAX is often used to check for integer overflow when calculating allocation size.  While ULONG_MAX happens to work on most systems, there is no guarantee that `size_t' must be the same size as `long'.  This patch introduces SIZE_MAX, the maximum value of `size_t', to improve portability and readability for allocation size validation.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Acked-by: Alex Elder <elder@dreamhost.com> Cc: David Airlie <airlied@linux.ie> Cc: Pekka Enberg <penberg@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | drm_sarea.h | s | 2.6K | 73 | Dave Airlie | airlied@redhat.com | 1230536842 |  | drm: move to kref per-master structures.  This is step one towards having multiple masters sharing a drm device in order to get fast-user-switching to work.  It splits out the information associated with the drm master into a separate kref counted structure, and allocates this when a master opens the device node. It also allows the current master to abdicate (say while VT switched), and a new master to take over the hardware.  It moves the Intel and radeon drivers to using the sarea from within the new master structures.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_global.h | s | 2.0K | 49 | Dave Airlie | airlied@redhat.com | 1280879166 |  | drm: move ttm global code to core drm  I wrote this for the prime sharing work, but I also noticed other external non-upstream drivers from a large company carrying a similiar patch, so I may as well ship it in master.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_pciids.h | s | 58K | 750 | Dave Airlie | airlied@redhat.com | 1340359495 |  | drm: drop comment about this header being autogenerated.  This comment is well out of date.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | intel-gtt.h | s | 1.7K | 43 | Daniel Vetter | daniel.vetter@ffwll.ch | 1333375147 |  | drm/i915: disable ppgtt on snb when dmar is enabled  Totally unexpected that this regressed. Luckily it sounds like we just need to have dmar disable on the igfx, not the entire system. At least that's what a few days of testing between Tony Vroon and me indicates.  Reported-by: Tony Vroon <tony@linx.net> Cc: Tony Vroon <tony@linx.net> Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=43024 Acked-by: Chris Wilson <chris@chris-wilson.co.uk> Signed-Off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
f | Kbuild | g | 351B |  | Kamil Debski | k.debski@samsung.com | 1329269352 |  | drm/exynos: exynos_drm.h header file fixes  First of all #ifdef __KERNEL__ was added to exynos_drm.h to mark the part that should be left out of userspace. Secondly exynos_drm.h was added to include/drm/Kbuild, so it will be included when doing make headers_install.  Signed-off-by: Kamil Debski <k.debski@samsung.com> Signed-off-by: Inki Dae <inki.dae@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com>
f | drm_hashtab.h | s | 2.5K | 56 | Chris Wilson | chris@chris-wilson.co.uk | 1298423800 |  | drm: Remove unused members from struct drm_open_hash  Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | nouveau_drm.h | s | 6.8K | 190 | Ben Skeggs | bskeggs@redhat.com | 1298580367 |  | drm/nv50: support for compression  Signed-off-by: Ben Skeggs <bskeggs@redhat.com>
f | sis_drm.h | s | 2.5K | 63 | Daniel Vetter | daniel.vetter@ffwll.ch | 1324510395 |  | drm/sis: track obj->drm_fd relations in the driver  By attach a driver private struct to each open drm fd.  Because we steal the owner_list from drm_sman until things settle, use list_move instead of list_add.  This requires to export a drm_sman function temporarily before drm_sman will die for real completely.  Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
f | drm_memory.h | s | 1.9K | 52 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1253442778 |  | includecheck fix: include/drm, drm_memory.h  fix the following 'make includecheck' warning:    include/drm/drm_memory.h: linux/vmalloc.h is included more than once.  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com> Cc: Sam Ravnborg <sam@ravnborg.org> LKML-Reference: <1247068169.4382.99.camel@ht.satnam> Acked-by: Dave Airlie <airlied@redhat.com>
f | drm_cache.h | s | 1.5K | 35 | Dave Airlie | airlied@redhat.com | 1251330827 |  | drm/ttm: consolidate cache flushing code in one place.  This merges the TTM and drm cache flushing into one file in the drm core.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm.h | s | 25K | 736 | Dave Airlie | airlied@redhat.com | 1337335936 |  | drm/prime: expose capability flags for userspace.  This lets the kernel tell userspace if the device supports prime import/export.  This is useful for -modesetting at least, but would be nice for other drivers.  Reviewed-by: Chris Wilson <chris@chris-wilson.co.uk> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_mode.h | s | 12K | 396 | Rob Clark | rob@ti.com | 1337680456 |  | drm: add bitmask property type  A bitmask property is similar to an enum.  The enum value is a bit position (0-63), and valid property values consist of a mask of zero or more of (1 << enum_val[n]).  [airlied: 1LL -> 1ULL]  Signed-off-by: Rob Clark <rob@ti.com> Reviewed-by: Paulo Zanoni <paulo.r.zanoni@intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | gma_drm.h | s | 2.4K | 80 | Kirill A. Shutemov | kirill.shutemov@linux.intel.com | 1331384764 |  | gma500: fix ioctl confict  Move DRM_GMA_GET_PIPE_FROM_CRTC_ID to 0x08 to avoid confict with DRM_GMA_GEM_MMAP.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
d | i2c |  | 2 items |  | Francisco Jerez | currojerez@riseup.net | 1280708473 |  | drm: Import driver for the sil164 I2C TMDS transmitter.  sil164 transmitters are used for DVI outputs on Intel/nvidia and ATI setups.  So far only nouveau can use this driver.  Signed-off-by: Francisco Jerez <currojerez@riseup.net> Tested-by: Patrice Mandin <patmandin@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | radeon_drm.h | s | 33K | 869 | Jerome Glisse | jglisse@redhat.com | 1336580532 |  | drm/radeon: fix possible lack of synchronization btw ttm and other ring  We need to sync with the GFX ring as ttm might have schedule bo move on it and new command scheduled for other ring need to wait for bo data to be in place.  Signed-off-by: Jerome Glisse <jglisse@redhat.com> Reviewed by: Christian König <christian.koenig@amd.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
d | ttm |  | 9 items |  | Dave Airlie | airlied@redhat.com | 1337766387 |  | ttm: add prime sharing support to TTM (v2)  This adds the ability for ttm common code to take an SG table and use it as the backing for a slave TTM object.  The drivers can then populate their GTT tables using the SG object.  v2: make sure to setup VM for sg bos as well.  Reviewed-by: Alex Deucher <alexander.deucher@amd.com> Reviewed-by: Jerome Glisse <jglisse@redhat.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | drm_mm.h | s | 6.2K | 178 | Daniel Vetter | daniel.vetter@ffwll.ch | 1304896485 |  | drm: mm: fix debug output  The looping helper didn't do anything due to a superficial semicolon. Furthermore one of the two dump functions suffered from copy&paste fail.  While staring at the code I've also noticed that the replace helper (currently unused) is a bit broken.  Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | via_drm.h | s | 8.2K | 238 | Daniel Vetter | daniel.vetter@ffwll.ch | 1324510399 |  | drm/via: track obj->drm_fd relations in the driver  Exactly like the previous patch for sis.  Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
