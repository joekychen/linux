<!DOCTYPE html>
<html><head><title>joekychen/linux » include › media › msp3400.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>msp3400.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">    msp3400.h - definition for msp3400 inputs and outputs</span>

<span class="cm">    Copyright (C) 2006 Hans Verkuil (hverkuil@xs4all.nl)</span>

<span class="cm">    This program is free software; you can redistribute it and/or modify</span>
<span class="cm">    it under the terms of the GNU General Public License as published by</span>
<span class="cm">    the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm">    (at your option) any later version.</span>

<span class="cm">    This program is distributed in the hope that it will be useful,</span>
<span class="cm">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm">    GNU General Public License for more details.</span>

<span class="cm">    You should have received a copy of the GNU General Public License</span>
<span class="cm">    along with this program; if not, write to the Free Software</span>
<span class="cm">    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>
<span class="cm">*/</span>

<span class="cp">#ifndef _MSP3400_H_</span>
<span class="cp">#define _MSP3400_H_</span>

<span class="cm">/* msp3400 routing</span>
<span class="cm">   ===============</span>

<span class="cm">   The msp3400 has a complicated routing scheme with many possible</span>
<span class="cm">   combinations. The details are all in the datasheets but I will try</span>
<span class="cm">   to give a short description here.</span>

<span class="cm">   Inputs</span>
<span class="cm">   ======</span>

<span class="cm">   There are 1) tuner inputs, 2) I2S inputs, 3) SCART inputs. You will have</span>
<span class="cm">   to select which tuner input to use and which SCART input to use. The</span>
<span class="cm">   selected tuner input, the selected SCART input and all I2S inputs go to</span>
<span class="cm">   the DSP (the tuner input first goes through the demodulator).</span>

<span class="cm">   The DSP handles things like volume, bass/treble, balance, and some chips</span>
<span class="cm">   have support for surround sound. It has several outputs: MAIN, AUX, I2S</span>
<span class="cm">   and SCART1/2. Each output can select which DSP input to use. So the MAIN</span>
<span class="cm">   output can select the tuner input while at the same time the SCART1 output</span>
<span class="cm">   uses the I2S input.</span>

<span class="cm">   Outputs</span>
<span class="cm">   =======</span>

<span class="cm">   Most DSP outputs are also the outputs of the msp3400. However, the SCART</span>
<span class="cm">   outputs of the msp3400 can select which input to use: either the SCART1 or</span>
<span class="cm">   SCART2 output from the DSP, or the msp3400 SCART inputs, thus completely</span>
<span class="cm">   bypassing the DSP.</span>

<span class="cm">   Summary</span>
<span class="cm">   =======</span>

<span class="cm">   So to specify a complete routing scheme for the msp3400 you will have to</span>
<span class="cm">   specify in the &#39;input&#39; arg of the s_routing function:</span>

<span class="cm">   1) which tuner input to use</span>
<span class="cm">   2) which SCART input to use</span>
<span class="cm">   3) which DSP input to use for each DSP output</span>

<span class="cm">   And in the &#39;output&#39; arg of the s_routing function you specify:</span>

<span class="cm">   1) which SCART input to use for each SCART output</span>

<span class="cm">   Depending on how the msp is wired to the other components you can</span>
<span class="cm">   ignore or mute certain inputs or outputs.</span>

<span class="cm">   Also, depending on the msp version only a subset of the inputs or</span>
<span class="cm">   outputs may be present. At the end of this header some tables are</span>
<span class="cm">   added containing a list of what is available for each msp version.</span>
<span class="cm"> */</span>

<span class="cm">/* Inputs to the DSP unit: two independent selections have to be made:</span>
<span class="cm">   1) the tuner (SIF) input</span>
<span class="cm">   2) the SCART input</span>
<span class="cm">   Bits 0-2 are used for the SCART input select, bit 3 is used for the tuner</span>
<span class="cm">   input, bits 4-7 are reserved.</span>
<span class="cm"> */</span>

<span class="cm">/* SCART input to DSP selection */</span>
<span class="cp">#define MSP_IN_SCART1  		0  </span><span class="cm">/* Pin SC1_IN */</span><span class="cp"></span>
<span class="cp">#define MSP_IN_SCART2  		1  </span><span class="cm">/* Pin SC2_IN */</span><span class="cp"></span>
<span class="cp">#define MSP_IN_SCART3  		2  </span><span class="cm">/* Pin SC3_IN */</span><span class="cp"></span>
<span class="cp">#define MSP_IN_SCART4  		3  </span><span class="cm">/* Pin SC4_IN */</span><span class="cp"></span>
<span class="cp">#define MSP_IN_MONO     	6  </span><span class="cm">/* Pin MONO_IN */</span><span class="cp"></span>
<span class="cp">#define MSP_IN_MUTE     	7  </span><span class="cm">/* Mute DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_SCART_TO_DSP(in) 	(in)</span>
<span class="cm">/* Tuner input to demodulator and DSP selection */</span>
<span class="cp">#define MSP_IN_TUNER1 		0  </span><span class="cm">/* Analog Sound IF input pin ANA_IN1 */</span><span class="cp"></span>
<span class="cp">#define MSP_IN_TUNER2 		1  </span><span class="cm">/* Analog Sound IF input pin ANA_IN2 */</span><span class="cp"></span>
<span class="cp">#define MSP_TUNER_TO_DSP(in) 	((in) &lt;&lt; 3)</span>

<span class="cm">/* The msp has up to 5 DSP outputs, each output can independently select</span>
<span class="cm">   a DSP input.</span>

<span class="cm">   The DSP outputs are: loudspeaker output (aka MAIN), headphones output</span>
<span class="cm">   (aka AUX), SCART1 DA output, SCART2 DA output and an I2S output.</span>
<span class="cm">   There also is a quasi-peak detector output, but that is not used by</span>
<span class="cm">   this driver and is set to the same input as the loudspeaker output.</span>
<span class="cm">   Not all outputs are supported by all msp models. Setting the input</span>
<span class="cm">   of an unsupported output will be ignored by the driver.</span>

<span class="cm">   There are up to 16 DSP inputs to choose from, so each output is</span>
<span class="cm">   assigned 4 bits.</span>

<span class="cm">   Note: the 44x8G can mix two inputs and feed the result back to the</span>
<span class="cm">   DSP. This is currently not implemented. Also not implemented is the</span>
<span class="cm">   multi-channel capable I2S3 input of the 44x0G. If someone can demonstrate</span>
<span class="cm">   a need for one of those features then additional support can be added. */</span>
<span class="cp">#define MSP_DSP_IN_TUNER 	0  </span><span class="cm">/* Tuner DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_IN_SCART 	2  </span><span class="cm">/* SCART DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_IN_I2S1 	5  </span><span class="cm">/* I2S1 DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_IN_I2S2 	6  </span><span class="cm">/* I2S2 DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_IN_I2S3    	7  </span><span class="cm">/* I2S3 DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_IN_MAIN_AVC 	11 </span><span class="cm">/* MAIN AVC processed DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_IN_MAIN 	12 </span><span class="cm">/* MAIN DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_IN_AUX 		13 </span><span class="cm">/* AUX DSP input */</span><span class="cp"></span>
<span class="cp">#define MSP_DSP_TO_MAIN(in)   	((in) &lt;&lt; 4)</span>
<span class="cp">#define MSP_DSP_TO_AUX(in)    	((in) &lt;&lt; 8)</span>
<span class="cp">#define MSP_DSP_TO_SCART1(in) 	((in) &lt;&lt; 12)</span>
<span class="cp">#define MSP_DSP_TO_SCART2(in) 	((in) &lt;&lt; 16)</span>
<span class="cp">#define MSP_DSP_TO_I2S(in)    	((in) &lt;&lt; 20)</span>

<span class="cm">/* Output SCART select: the SCART outputs can select which input</span>
<span class="cm">   to use. */</span>
<span class="cp">#define MSP_SC_IN_SCART1 	0  </span><span class="cm">/* SCART1 input, bypassing the DSP */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_IN_SCART2 	1  </span><span class="cm">/* SCART2 input, bypassing the DSP */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_IN_SCART3 	2  </span><span class="cm">/* SCART3 input, bypassing the DSP */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_IN_SCART4 	3  </span><span class="cm">/* SCART4 input, bypassing the DSP */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_IN_DSP_SCART1 	4  </span><span class="cm">/* DSP SCART1 input */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_IN_DSP_SCART2 	5  </span><span class="cm">/* DSP SCART2 input */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_IN_MONO 		6  </span><span class="cm">/* MONO input, bypassing the DSP */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_IN_MUTE 		7  </span><span class="cm">/* MUTE output */</span><span class="cp"></span>
<span class="cp">#define MSP_SC_TO_SCART1(in)	(in)</span>
<span class="cp">#define MSP_SC_TO_SCART2(in)	((in) &lt;&lt; 4)</span>

<span class="cm">/* Shortcut macros */</span>
<span class="cp">#define MSP_INPUT(sc, t, main_aux_src, sc_i2s_src) \</span>
<span class="cp">	(MSP_SCART_TO_DSP(sc) | \</span>
<span class="cp">	 MSP_TUNER_TO_DSP(t) | \</span>
<span class="cp">	 MSP_DSP_TO_MAIN(main_aux_src) | \</span>
<span class="cp">	 MSP_DSP_TO_AUX(main_aux_src) | \</span>
<span class="cp">	 MSP_DSP_TO_SCART1(sc_i2s_src) | \</span>
<span class="cp">	 MSP_DSP_TO_SCART2(sc_i2s_src) | \</span>
<span class="cp">	 MSP_DSP_TO_I2S(sc_i2s_src))</span>
<span class="cp">#define MSP_INPUT_DEFAULT MSP_INPUT(MSP_IN_SCART1, MSP_IN_TUNER1, \</span>
<span class="cp">				    MSP_DSP_IN_TUNER, MSP_DSP_IN_TUNER)</span>
<span class="cp">#define MSP_OUTPUT(sc) \</span>
<span class="cp">	(MSP_SC_TO_SCART1(sc) | \</span>
<span class="cp">	 MSP_SC_TO_SCART2(sc))</span>
<span class="cm">/* This equals the RESET position of the msp3400 ACB register */</span>
<span class="cp">#define MSP_OUTPUT_DEFAULT (MSP_SC_TO_SCART1(MSP_SC_IN_SCART3) | \</span>
<span class="cp">			    MSP_SC_TO_SCART2(MSP_SC_IN_DSP_SCART1))</span>

<span class="cm">/* Tuner inputs vs. msp version */</span>
<span class="cm">/* Chip      TUNER_1   TUNER_2</span>
<span class="cm">   -------------------------</span>
<span class="cm">   msp34x0b  y         y</span>
<span class="cm">   msp34x0c  y         y</span>
<span class="cm">   msp34x0d  y         y</span>
<span class="cm">   msp34x5d  y         n</span>
<span class="cm">   msp34x7d  y         n</span>
<span class="cm">   msp34x0g  y         y</span>
<span class="cm">   msp34x1g  y         y</span>
<span class="cm">   msp34x2g  y         y</span>
<span class="cm">   msp34x5g  y         n</span>
<span class="cm">   msp34x7g  y         n</span>
<span class="cm">   msp44x0g  y         y</span>
<span class="cm">   msp44x8g  y         y</span>
<span class="cm"> */</span>

<span class="cm">/* SCART inputs vs. msp version */</span>
<span class="cm">/* Chip      SC1 SC2 SC3 SC4</span>
<span class="cm">   -------------------------</span>
<span class="cm">   msp34x0b  y   y   y   n</span>
<span class="cm">   msp34x0c  y   y   y   n</span>
<span class="cm">   msp34x0d  y   y   y   y</span>
<span class="cm">   msp34x5d  y   y   n   n</span>
<span class="cm">   msp34x7d  y   n   n   n</span>
<span class="cm">   msp34x0g  y   y   y   y</span>
<span class="cm">   msp34x1g  y   y   y   y</span>
<span class="cm">   msp34x2g  y   y   y   y</span>
<span class="cm">   msp34x5g  y   y   n   n</span>
<span class="cm">   msp34x7g  y   n   n   n</span>
<span class="cm">   msp44x0g  y   y   y   y</span>
<span class="cm">   msp44x8g  y   y   y   y</span>
<span class="cm"> */</span>

<span class="cm">/* DSP inputs vs. msp version (tuner and SCART inputs are always available) */</span>
<span class="cm">/* Chip      I2S1 I2S2 I2S3 MAIN_AVC MAIN AUX</span>
<span class="cm">   ------------------------------------------</span>
<span class="cm">   msp34x0b  y    n    n    n        n    n</span>
<span class="cm">   msp34x0c  y    y    n    n        n    n</span>
<span class="cm">   msp34x0d  y    y    n    n        n    n</span>
<span class="cm">   msp34x5d  y    y    n    n        n    n</span>
<span class="cm">   msp34x7d  n    n    n    n        n    n</span>
<span class="cm">   msp34x0g  y    y    n    n        n    n</span>
<span class="cm">   msp34x1g  y    y    n    n        n    n</span>
<span class="cm">   msp34x2g  y    y    n    y        y    y</span>
<span class="cm">   msp34x5g  y    y    n    n        n    n</span>
<span class="cm">   msp34x7g  n    n    n    n        n    n</span>
<span class="cm">   msp44x0g  y    y    y    y        y    y</span>
<span class="cm">   msp44x8g  y    y    y    n        n    n</span>
<span class="cm"> */</span>

<span class="cm">/* DSP outputs vs. msp version */</span>
<span class="cm">/* Chip      MAIN AUX SCART1 SCART2 I2S</span>
<span class="cm">   ------------------------------------</span>
<span class="cm">   msp34x0b  y    y   y      n      y</span>
<span class="cm">   msp34x0c  y    y   y      n      y</span>
<span class="cm">   msp34x0d  y    y   y      y      y</span>
<span class="cm">   msp34x5d  y    n   y      n      y</span>
<span class="cm">   msp34x7d  y    n   y      n      n</span>
<span class="cm">   msp34x0g  y    y   y      y      y</span>
<span class="cm">   msp34x1g  y    y   y      y      y</span>
<span class="cm">   msp34x2g  y    y   y      y      y</span>
<span class="cm">   msp34x5g  y    n   y      n      y</span>
<span class="cm">   msp34x7g  y    n   y      n      n</span>
<span class="cm">   msp44x0g  y    y   y      y      y</span>
<span class="cm">   msp44x8g  y    y   y      y      y</span>
<span class="cm"> */</span>

<span class="cp">#endif </span><span class="cm">/* MSP3400_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
