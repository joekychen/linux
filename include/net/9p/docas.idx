f | 9p.h | s | 16K | 535 | Joe Perches | joe@perches.com | 1325782304 |  | 9p: Reduce object size with CONFIG_NET_9P_DEBUG  Reduce object size by deduplicating formats.  Use vsprintf extension %pV. Rename P9_DPRINTK uses to p9_debug, align arguments. Add function for _p9_debug and macro to add __func__. Add missing "\n"s to p9_debug uses. Remove embedded function names as p9_debug adds it. Remove P9_EPRINTK macro and convert use to pr_<level>. Add and use pr_fmt and pr_<level>.  $ size fs/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   62133	    984	  16000	  79117	  1350d	fs/9p/built-in.o.new   67342	    984	  16928	  85254	  14d06	fs/9p/built-in.o.old $ size net/9p/built-in.o*    text	   data	    bss	    dec	    hex	filename   88792	   4148	  22024	 114964	  1c114	net/9p/built-in.o.new   94072	   4148	  23232	 121452	  1da6c	net/9p/built-in.o.old  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | client.h | s | 9.0K | 243 | Aneesh Kumar K.V | aneesh.kumar@linux.vnet.ibm.com | 1319472792 |  | net/9p: Convert net/9p protocol dumps to tracepoints  This helps in more control over debugging. root@qemu-img-64:~# ls /pass/123 ls: cannot access /pass/123: No such file or directory root@qemu-img-64:~# cat /sys/kernel/debug/tracing/trace # tracer: nop # #           TASK-PID    CPU#    TIMESTAMP  FUNCTION #              || ||       ||          ||         ||               ls-1536  [001]    70.928584: 9p_protocol_dump: clnt 18446612132784021504 P9_TWALK(tag = 1) 000: 16 00 00 00 6e 01 00 01 00 00 00 02 00 00 00 01 010: 00 03 00 31 32 33 00 00 00 ff ff ff ff 00 00 00                ls-1536  [001]    70.928587: <stack trace>  => trace_9p_protocol_dump  => p9pdu_finalize  => p9_client_rpc  => p9_client_walk  => v9fs_vfs_lookup  => d_alloc_and_lookup  => walk_component  => path_lookupat               ls-1536  [000]    70.929696: 9p_protocol_dump: clnt 18446612132784021504 P9_RLERROR(tag = 1) 000: 0b 00 00 00 07 01 00 02 00 00 00 4e 03 00 02 00 010: 00 00 00 00 03 00 02 00 00 00 00 00 ff 43 00 00                ls-1536  [000]    70.929697: <stack trace>  => trace_9p_protocol_dump  => p9_client_rpc  => p9_client_walk  => v9fs_vfs_lookup  => d_alloc_and_lookup  => walk_component  => path_lookupat  => do_path_lookup  Signed-off-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
f | transport.h | s | 2.6K | 63 | Aneesh Kumar K.V | aneesh.kumar@linux.vnet.ibm.com | 1319472791 |  | fs/9p: Update zero-copy implementation in 9p  * remove lot of update to different data structure * add a seperate callback for zero copy request. * above makes non zero copy code path simpler * remove conditionalizing TREAD/TREADDIR/TWRITE in the zero copy path * Fix the dotu p9_check_errors with zero copy. Add sufficient doc around * Add support for both in and output buffers in zero copy callback * pin and unpin pages in the same context * use helpers instead of defining page offset and rest of page ourself * Fix mem leak in p9_check_errors * Remove 'E' and 'F' in p9pdu_vwritef  Signed-off-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Signed-off-by: Eric Van Hensbergen <ericvh@gmail.com>
