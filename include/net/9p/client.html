<!DOCTYPE html>
<html><head><title>joekychen/linux » include › net › 9p › client.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>client.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * include/net/9p/client.h</span>
<span class="cm"> *</span>
<span class="cm"> * 9P Client Definitions</span>
<span class="cm"> *</span>
<span class="cm"> *  Copyright (C) 2008 by Eric Van Hensbergen &lt;ericvh@gmail.com&gt;</span>
<span class="cm"> *  Copyright (C) 2007 by Latchesar Ionkov &lt;lucho@ionkov.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *  This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *  it under the terms of the GNU General Public License version 2</span>
<span class="cm"> *  as published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> *  This program is distributed in the hope that it will be useful,</span>
<span class="cm"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *  GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *  You should have received a copy of the GNU General Public License</span>
<span class="cm"> *  along with this program; if not, write to:</span>
<span class="cm"> *  Free Software Foundation</span>
<span class="cm"> *  51 Franklin Street, Fifth Floor</span>
<span class="cm"> *  Boston, MA  02111-1301  USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef NET_9P_CLIENT_H</span>
<span class="cp">#define NET_9P_CLIENT_H</span>

<span class="cm">/* Number of requests per row */</span>
<span class="cp">#define P9_ROW_MAXTAG 255</span>

<span class="cm">/** enum p9_proto_versions - 9P protocol versions</span>
<span class="cm"> * @p9_proto_legacy: 9P Legacy mode, pre-9P2000.u</span>
<span class="cm"> * @p9_proto_2000u: 9P2000.u extension</span>
<span class="cm"> * @p9_proto_2000L: 9P2000.L extension</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">p9_proto_versions</span><span class="p">{</span>
	<span class="n">p9_proto_legacy</span><span class="p">,</span>
	<span class="n">p9_proto_2000u</span><span class="p">,</span>
	<span class="n">p9_proto_2000L</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * enum p9_trans_status - different states of underlying transports</span>
<span class="cm"> * @Connected: transport is connected and healthy</span>
<span class="cm"> * @Disconnected: transport has been disconnected</span>
<span class="cm"> * @Hung: transport is connected by wedged</span>
<span class="cm"> *</span>
<span class="cm"> * This enumeration details the various states a transport</span>
<span class="cm"> * instatiation can be in.</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">p9_trans_status</span> <span class="p">{</span>
	<span class="n">Connected</span><span class="p">,</span>
	<span class="n">BeginDisconnect</span><span class="p">,</span>
	<span class="n">Disconnected</span><span class="p">,</span>
	<span class="n">Hung</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * enum p9_req_status_t - status of a request</span>
<span class="cm"> * @REQ_STATUS_IDLE: request slot unused</span>
<span class="cm"> * @REQ_STATUS_ALLOC: request has been allocated but not sent</span>
<span class="cm"> * @REQ_STATUS_UNSENT: request waiting to be sent</span>
<span class="cm"> * @REQ_STATUS_SENT: request sent to server</span>
<span class="cm"> * @REQ_STATUS_FLSH: a flush has been sent for this request</span>
<span class="cm"> * @REQ_STATUS_RCVD: response received from server</span>
<span class="cm"> * @REQ_STATUS_FLSHD: request has been flushed</span>
<span class="cm"> * @REQ_STATUS_ERROR: request encountered an error on the client side</span>
<span class="cm"> *</span>
<span class="cm"> * The @REQ_STATUS_IDLE state is used to mark a request slot as unused</span>
<span class="cm"> * but use is actually tracked by the idpool structure which handles tag</span>
<span class="cm"> * id allocation.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">p9_req_status_t</span> <span class="p">{</span>
	<span class="n">REQ_STATUS_IDLE</span><span class="p">,</span>
	<span class="n">REQ_STATUS_ALLOC</span><span class="p">,</span>
	<span class="n">REQ_STATUS_UNSENT</span><span class="p">,</span>
	<span class="n">REQ_STATUS_SENT</span><span class="p">,</span>
	<span class="n">REQ_STATUS_FLSH</span><span class="p">,</span>
	<span class="n">REQ_STATUS_RCVD</span><span class="p">,</span>
	<span class="n">REQ_STATUS_FLSHD</span><span class="p">,</span>
	<span class="n">REQ_STATUS_ERROR</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct p9_req_t - request slots</span>
<span class="cm"> * @status: status of this request slot</span>
<span class="cm"> * @t_err: transport error</span>
<span class="cm"> * @flush_tag: tag of request being flushed (for flush requests)</span>
<span class="cm"> * @wq: wait_queue for the client to block on for this request</span>
<span class="cm"> * @tc: the request fcall structure</span>
<span class="cm"> * @rc: the response fcall structure</span>
<span class="cm"> * @aux: transport specific data (provided for trans_fd migration)</span>
<span class="cm"> * @req_list: link for higher level objects to chain requests</span>
<span class="cm"> *</span>
<span class="cm"> * Transport use an array to track outstanding requests</span>
<span class="cm"> * instead of a list.  While this may incurr overhead during initial</span>
<span class="cm"> * allocation or expansion, it makes request lookup much easier as the</span>
<span class="cm"> * tag id is a index into an array.  (We use tag+1 so that we can accommodate</span>
<span class="cm"> * the -1 tag for the T_VERSION request).</span>
<span class="cm"> * This also has the nice effect of only having to allocate wait_queues</span>
<span class="cm"> * once, instead of constantly allocating and freeing them.  Its possible</span>
<span class="cm"> * other resources could benefit from this scheme as well.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">p9_req_t</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">status</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">t_err</span><span class="p">;</span>
	<span class="n">wait_queue_head_t</span> <span class="o">*</span><span class="n">wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">p9_fcall</span> <span class="o">*</span><span class="n">tc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">p9_fcall</span> <span class="o">*</span><span class="n">rc</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">aux</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">req_list</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct p9_client - per client instance state</span>
<span class="cm"> * @lock: protect @fidlist</span>
<span class="cm"> * @msize: maximum data size negotiated by protocol</span>
<span class="cm"> * @dotu: extension flags negotiated by protocol</span>
<span class="cm"> * @proto_version: 9P protocol version to use</span>
<span class="cm"> * @trans_mod: module API instantiated with this client</span>
<span class="cm"> * @trans: tranport instance state and API</span>
<span class="cm"> * @conn: connection state information used by trans_fd</span>
<span class="cm"> * @fidpool: fid handle accounting for session</span>
<span class="cm"> * @fidlist: List of active fid handles</span>
<span class="cm"> * @tagpool - transaction id accounting for session</span>
<span class="cm"> * @reqs - 2D array of requests</span>
<span class="cm"> * @max_tag - current maximum tag id allocated</span>
<span class="cm"> *</span>
<span class="cm"> * The client structure is used to keep track of various per-client</span>
<span class="cm"> * state that has been instantiated.</span>
<span class="cm"> * In order to minimize per-transaction overhead we use a</span>
<span class="cm"> * simple array to lookup requests instead of a hash table</span>
<span class="cm"> * or linked list.  In order to support larger number of</span>
<span class="cm"> * transactions, we make this a 2D array, allocating new rows</span>
<span class="cm"> * when we need to grow the total number of the transactions.</span>
<span class="cm"> *</span>
<span class="cm"> * Each row is 256 requests and we&#39;ll support up to 256 rows for</span>
<span class="cm"> * a total of 64k concurrent requests per session.</span>
<span class="cm"> *</span>
<span class="cm"> * Bugs: duplicated data and potentially unnecessary elements.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">p9_client</span> <span class="p">{</span>
	<span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span> <span class="cm">/* protect client structure */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">msize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">proto_version</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">p9_trans_module</span> <span class="o">*</span><span class="n">trans_mod</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">p9_trans_status</span> <span class="n">status</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">trans</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">p9_conn</span> <span class="o">*</span><span class="n">conn</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">p9_idpool</span> <span class="o">*</span><span class="n">fidpool</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">fidlist</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">p9_idpool</span> <span class="o">*</span><span class="n">tagpool</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">p9_req_t</span> <span class="o">*</span><span class="n">reqs</span><span class="p">[</span><span class="n">P9_ROW_MAXTAG</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">max_tag</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct p9_fid - file system entity handle</span>
<span class="cm"> * @clnt: back pointer to instantiating &amp;p9_client</span>
<span class="cm"> * @fid: numeric identifier for this handle</span>
<span class="cm"> * @mode: current mode of this fid (enum?)</span>
<span class="cm"> * @qid: the &amp;p9_qid server identifier this handle points to</span>
<span class="cm"> * @iounit: the server reported maximum transaction size for this file</span>
<span class="cm"> * @uid: the numeric uid of the local user who owns this handle</span>
<span class="cm"> * @rdir: readdir accounting structure (allocated on demand)</span>
<span class="cm"> * @flist: per-client-instance fid tracking</span>
<span class="cm"> * @dlist: per-dentry fid tracking</span>
<span class="cm"> *</span>
<span class="cm"> * TODO: This needs lots of explanation.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">p9_fid</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">fid</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">p9_qid</span> <span class="n">qid</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">iounit</span><span class="p">;</span>
	<span class="n">uid_t</span> <span class="n">uid</span><span class="p">;</span>

	<span class="kt">void</span> <span class="o">*</span><span class="n">rdir</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">flist</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">dlist</span><span class="p">;</span>	<span class="cm">/* list of all fids attached to a dentry */</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct p9_dirent - directory entry structure</span>
<span class="cm"> * @qid: The p9 server qid for this dirent</span>
<span class="cm"> * @d_off: offset to the next dirent</span>
<span class="cm"> * @d_type: type of file</span>
<span class="cm"> * @d_name: file name</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">p9_dirent</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">p9_qid</span> <span class="n">qid</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">d_off</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">d_type</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">d_name</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">p9_client_statfs</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_rstatfs</span> <span class="o">*</span><span class="n">sb</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_rename</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">newdirfid</span><span class="p">,</span>
		     <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_renameat</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">olddirfid</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">old_name</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">newdirfid</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">new_name</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">p9_client_create</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">dev_name</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">options</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">p9_client_destroy</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">p9_client_disconnect</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">p9_client_begin_disconnect</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">p9_client_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">afid</span><span class="p">,</span>
					<span class="kt">char</span> <span class="o">*</span><span class="n">uname</span><span class="p">,</span> <span class="n">u32</span> <span class="n">n_uname</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">aname</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">p9_client_walk</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">oldfid</span><span class="p">,</span> <span class="kt">uint16_t</span> <span class="n">nwname</span><span class="p">,</span>
		<span class="kt">char</span> <span class="o">**</span><span class="n">wnames</span><span class="p">,</span> <span class="kt">int</span> <span class="n">clone</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_fcreate</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">perm</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span>
							<span class="kt">char</span> <span class="o">*</span><span class="n">extension</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_link</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">oldfid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">newname</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_symlink</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">symname</span><span class="p">,</span> <span class="n">gid_t</span> <span class="n">gid</span><span class="p">,</span>
							<span class="k">struct</span> <span class="n">p9_qid</span> <span class="o">*</span><span class="n">qid</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_create_dotl</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">ofid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mode</span><span class="p">,</span>
		<span class="n">gid_t</span> <span class="n">gid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_qid</span> <span class="o">*</span><span class="n">qid</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_clunk</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_fsync</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">datasync</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_remove</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_unlinkat</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">dfid</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">udata</span><span class="p">,</span>
							<span class="n">u64</span> <span class="n">offset</span><span class="p">,</span> <span class="n">u32</span> <span class="n">count</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">udata</span><span class="p">,</span>
							<span class="n">u64</span> <span class="n">offset</span><span class="p">,</span> <span class="n">u32</span> <span class="n">count</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_readdir</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="n">u32</span> <span class="n">count</span><span class="p">,</span> <span class="n">u64</span> <span class="n">offset</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9dirent_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">,</span>
		  <span class="k">struct</span> <span class="n">p9_dirent</span> <span class="o">*</span><span class="n">dirent</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">p9_wstat</span> <span class="o">*</span><span class="n">p9_client_stat</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_wstat</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_wstat</span> <span class="o">*</span><span class="n">wst</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_setattr</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_iattr_dotl</span> <span class="o">*</span><span class="n">attr</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">p9_stat_dotl</span> <span class="o">*</span><span class="n">p9_client_getattr_dotl</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span>
							<span class="n">u64</span> <span class="n">request_mask</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">p9_client_mknod_dotl</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">oldfid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span>
			<span class="n">dev_t</span> <span class="n">rdev</span><span class="p">,</span> <span class="n">gid_t</span> <span class="n">gid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_qid</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_mkdir_dotl</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">,</span>
				<span class="n">gid_t</span> <span class="n">gid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_qid</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_lock_dotl</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_flock</span> <span class="o">*</span><span class="n">flock</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">status</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_getlock_dotl</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_getlock</span> <span class="o">*</span><span class="n">fl</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">p9_req_t</span> <span class="o">*</span><span class="n">p9_tag_lookup</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="p">,</span> <span class="n">u16</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">p9_client_cb</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">c</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_req_t</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">p9_parse_header</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fcall</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int32_t</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int8_t</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int16_t</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9stat_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="k">struct</span> <span class="n">p9_wstat</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">p9stat_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_wstat</span> <span class="o">*</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">p9_is_proto_dotu</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_is_proto_dotl</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_client</span> <span class="o">*</span><span class="n">clnt</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">p9_client_xattrwalk</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">u64</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_xattrcreate</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">u64</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">p9_client_readlink</span><span class="p">(</span><span class="k">struct</span> <span class="n">p9_fid</span> <span class="o">*</span><span class="n">fid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">target</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* NET_9P_CLIENT_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
