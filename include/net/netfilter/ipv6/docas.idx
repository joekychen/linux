f | nf_defrag_ipv6.h | s | 482B | 12 | KOVACS Krisztian | hidden@balabit.hu | 1294860308 |  | netfilter: fix compilation when conntrack is disabled but tproxy is enabled  The IPv6 tproxy patches split IPv6 defragmentation off of conntrack, but failed to update the #ifdef stanzas guarding the defragmentation related fields and code in skbuff and conntrack related code in nf_defrag_ipv6.c.  This patch adds the required #ifdefs so that IPv6 tproxy can truly be used without connection tracking.  Original report: http://marc.info/?l=linux-netdev&m=129010118516341&w=2  Reported-by: Randy Dunlap <randy.dunlap@oracle.com> Acked-by: Randy Dunlap <randy.dunlap@oracle.com> Signed-off-by: KOVACS Krisztian <hidden@balabit.hu> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | nf_conntrack_ipv6.h | s | 422B | 9 | KOVACS Krisztian | hidden@balabit.hu | 1294860308 |  | netfilter: fix compilation when conntrack is disabled but tproxy is enabled  The IPv6 tproxy patches split IPv6 defragmentation off of conntrack, but failed to update the #ifdef stanzas guarding the defragmentation related fields and code in skbuff and conntrack related code in nf_defrag_ipv6.c.  This patch adds the required #ifdefs so that IPv6 tproxy can truly be used without connection tracking.  Original report: http://marc.info/?l=linux-netdev&m=129010118516341&w=2  Reported-by: Randy Dunlap <randy.dunlap@oracle.com> Acked-by: Randy Dunlap <randy.dunlap@oracle.com> Signed-off-by: KOVACS Krisztian <hidden@balabit.hu> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | nf_conntrack_icmpv6.h | s | 429B | 17 | Jan Kasprzak | kas@fi.muni.cz | 1244469223 |  | netfilter: nf_ct_icmp: keep the ICMP ct entries longer  Current conntrack code kills the ICMP conntrack entry as soon as the first reply is received. This is incorrect, as we then see only the first ICMP echo reply out of several possible duplicates as ESTABLISHED, while the rest will be INVALID. Also this unnecessarily increases the conntrackd traffic on H-A firewalls.  Make all the ICMP conntrack entries (including the replied ones) last for the default of nf_conntrack_icmp{,v6}_timeout seconds.  Signed-off-by: Jan "Yenya" Kasprzak <kas@fi.muni.cz> Signed-off-by: Patrick McHardy <kaber@trash.net>
