<!DOCTYPE html>
<html><head><title>joekychen/linux » include › net › ieee80211_radiotap.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>ieee80211_radiotap.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2003, 2004 David Young.  All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Redistribution and use in source and binary forms, with or without</span>
<span class="cm"> * modification, are permitted provided that the following conditions</span>
<span class="cm"> * are met:</span>
<span class="cm"> * 1. Redistributions of source code must retain the above copyright</span>
<span class="cm"> *    notice, this list of conditions and the following disclaimer.</span>
<span class="cm"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<span class="cm"> *    notice, this list of conditions and the following disclaimer in the</span>
<span class="cm"> *    documentation and/or other materials provided with the distribution.</span>
<span class="cm"> * 3. The name of David Young may not be used to endorse or promote</span>
<span class="cm"> *    products derived from this software without specific prior</span>
<span class="cm"> *    written permission.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS SOFTWARE IS PROVIDED BY DAVID YOUNG ``AS IS&#39;&#39; AND ANY</span>
<span class="cm"> * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,</span>
<span class="cm"> * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A</span>
<span class="cm"> * PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL DAVID</span>
<span class="cm"> * YOUNG BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
<span class="cm"> * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED</span>
<span class="cm"> * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="cm"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<span class="cm"> * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="cm"> * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY</span>
<span class="cm"> * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY</span>
<span class="cm"> * OF SUCH DAMAGE.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Modifications to fit into the linux IEEE 802.11 stack,</span>
<span class="cm"> * Mike Kershaw (dragorn@kismetwireless.net)</span>
<span class="cm"> */</span>

<span class="cp">#ifndef IEEE80211RADIOTAP_H</span>
<span class="cp">#define IEEE80211RADIOTAP_H</span>

<span class="cp">#include &lt;linux/if_ether.h&gt;</span>
<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;asm/unaligned.h&gt;</span>

<span class="cm">/* Base version of the radiotap packet header data */</span>
<span class="cp">#define PKTHDR_RADIOTAP_VERSION		0</span>

<span class="cm">/* A generic radio capture format is desirable. There is one for</span>
<span class="cm"> * Linux, but it is neither rigidly defined (there were not even</span>
<span class="cm"> * units given for some fields) nor easily extensible.</span>
<span class="cm"> *</span>
<span class="cm"> * I suggest the following extensible radio capture format. It is</span>
<span class="cm"> * based on a bitmap indicating which fields are present.</span>
<span class="cm"> *</span>
<span class="cm"> * I am trying to describe precisely what the application programmer</span>
<span class="cm"> * should expect in the following, and for that reason I tell the</span>
<span class="cm"> * units and origin of each measurement (where it applies), or else I</span>
<span class="cm"> * use sufficiently weaselly language (&quot;is a monotonically nondecreasing</span>
<span class="cm"> * function of...&quot;) that I cannot set false expectations for lawyerly</span>
<span class="cm"> * readers.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * The radio capture header precedes the 802.11 header.</span>
<span class="cm"> * All data in the header is little endian on all platforms.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_radiotap_header</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">it_version</span><span class="p">;</span>		<span class="cm">/* Version 0. Only increases</span>
<span class="cm">				 * for drastic changes,</span>
<span class="cm">				 * introduction of compatible</span>
<span class="cm">				 * new fields does not count.</span>
<span class="cm">				 */</span>
	<span class="n">u8</span> <span class="n">it_pad</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">it_len</span><span class="p">;</span>		<span class="cm">/* length of the whole</span>
<span class="cm">				 * header in bytes, including</span>
<span class="cm">				 * it_version, it_pad,</span>
<span class="cm">				 * it_len, and data fields.</span>
<span class="cm">				 */</span>
	<span class="n">__le32</span> <span class="n">it_present</span><span class="p">;</span>	<span class="cm">/* A bitmap telling which</span>
<span class="cm">				 * fields are present. Set bit 31</span>
<span class="cm">				 * (0x80000000) to extend the</span>
<span class="cm">				 * bitmap by another 32 bits.</span>
<span class="cm">				 * Additional extensions are made</span>
<span class="cm">				 * by setting bit 31.</span>
<span class="cm">				 */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Name                                 Data type    Units</span>
<span class="cm"> * ----                                 ---------    -----</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_TSFT              __le64       microseconds</span>
<span class="cm"> *</span>
<span class="cm"> *      Value in microseconds of the MAC&#39;s 64-bit 802.11 Time</span>
<span class="cm"> *      Synchronization Function timer when the first bit of the</span>
<span class="cm"> *      MPDU arrived at the MAC. For received frames, only.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_CHANNEL           2 x __le16   MHz, bitmap</span>
<span class="cm"> *</span>
<span class="cm"> *      Tx/Rx frequency in MHz, followed by flags (see below).</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_FHSS              __le16       see below</span>
<span class="cm"> *</span>
<span class="cm"> *      For frequency-hopping radios, the hop set (first byte)</span>
<span class="cm"> *      and pattern (second byte).</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_RATE              u8           500kb/s</span>
<span class="cm"> *</span>
<span class="cm"> *      Tx/Rx data rate</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_DBM_ANTSIGNAL     s8           decibels from</span>
<span class="cm"> *                                                   one milliwatt (dBm)</span>
<span class="cm"> *</span>
<span class="cm"> *      RF signal power at the antenna, decibel difference from</span>
<span class="cm"> *      one milliwatt.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_DBM_ANTNOISE      s8           decibels from</span>
<span class="cm"> *                                                   one milliwatt (dBm)</span>
<span class="cm"> *</span>
<span class="cm"> *      RF noise power at the antenna, decibel difference from one</span>
<span class="cm"> *      milliwatt.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_DB_ANTSIGNAL      u8           decibel (dB)</span>
<span class="cm"> *</span>
<span class="cm"> *      RF signal power at the antenna, decibel difference from an</span>
<span class="cm"> *      arbitrary, fixed reference.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_DB_ANTNOISE       u8           decibel (dB)</span>
<span class="cm"> *</span>
<span class="cm"> *      RF noise power at the antenna, decibel difference from an</span>
<span class="cm"> *      arbitrary, fixed reference point.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_LOCK_QUALITY      __le16       unitless</span>
<span class="cm"> *</span>
<span class="cm"> *      Quality of Barker code lock. Unitless. Monotonically</span>
<span class="cm"> *      nondecreasing with &quot;better&quot; lock strength. Called &quot;Signal</span>
<span class="cm"> *      Quality&quot; in datasheets.  (Is there a standard way to measure</span>
<span class="cm"> *      this?)</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_TX_ATTENUATION    __le16       unitless</span>
<span class="cm"> *</span>
<span class="cm"> *      Transmit power expressed as unitless distance from max</span>
<span class="cm"> *      power set at factory calibration.  0 is max power.</span>
<span class="cm"> *      Monotonically nondecreasing with lower power levels.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_DB_TX_ATTENUATION __le16       decibels (dB)</span>
<span class="cm"> *</span>
<span class="cm"> *      Transmit power expressed as decibel distance from max power</span>
<span class="cm"> *      set at factory calibration.  0 is max power.  Monotonically</span>
<span class="cm"> *      nondecreasing with lower power levels.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_DBM_TX_POWER      s8           decibels from</span>
<span class="cm"> *                                                   one milliwatt (dBm)</span>
<span class="cm"> *</span>
<span class="cm"> *      Transmit power expressed as dBm (decibels from a 1 milliwatt</span>
<span class="cm"> *      reference). This is the absolute power level measured at</span>
<span class="cm"> *      the antenna port.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_FLAGS             u8           bitmap</span>
<span class="cm"> *</span>
<span class="cm"> *      Properties of transmitted and received frames. See flags</span>
<span class="cm"> *      defined below.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_ANTENNA           u8           antenna index</span>
<span class="cm"> *</span>
<span class="cm"> *      Unitless indication of the Rx/Tx antenna for this packet.</span>
<span class="cm"> *      The first antenna is antenna 0.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_RX_FLAGS          __le16       bitmap</span>
<span class="cm"> *</span>
<span class="cm"> *     Properties of received frames. See flags defined below.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_TX_FLAGS          __le16       bitmap</span>
<span class="cm"> *</span>
<span class="cm"> *     Properties of transmitted frames. See flags defined below.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_RTS_RETRIES       u8           data</span>
<span class="cm"> *</span>
<span class="cm"> *     Number of rts retries a transmitted frame used.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_DATA_RETRIES      u8           data</span>
<span class="cm"> *</span>
<span class="cm"> *     Number of unicast retries a transmitted frame used.</span>
<span class="cm"> *</span>
<span class="cm"> * IEEE80211_RADIOTAP_MCS	u8, u8, u8		unitless</span>
<span class="cm"> *</span>
<span class="cm"> *     Contains a bitmap of known fields/flags, the flags, and</span>
<span class="cm"> *     the MCS index.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ieee80211_radiotap_type</span> <span class="p">{</span>
	<span class="n">IEEE80211_RADIOTAP_TSFT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_FLAGS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_RATE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_CHANNEL</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_FHSS</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_DBM_ANTSIGNAL</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_DBM_ANTNOISE</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_LOCK_QUALITY</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_TX_ATTENUATION</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_DB_TX_ATTENUATION</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_DBM_TX_POWER</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_ANTENNA</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_DB_ANTSIGNAL</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_DB_ANTNOISE</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_RX_FLAGS</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_TX_FLAGS</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_RTS_RETRIES</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_DATA_RETRIES</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>

	<span class="n">IEEE80211_RADIOTAP_MCS</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>

	<span class="cm">/* valid in every it_present bitmap, even vendor namespaces */</span>
	<span class="n">IEEE80211_RADIOTAP_RADIOTAP_NAMESPACE</span> <span class="o">=</span> <span class="mi">29</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_VENDOR_NAMESPACE</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
	<span class="n">IEEE80211_RADIOTAP_EXT</span> <span class="o">=</span> <span class="mi">31</span>
<span class="p">};</span>

<span class="cm">/* Channel flags. */</span>
<span class="cp">#define	IEEE80211_CHAN_TURBO	0x0010	</span><span class="cm">/* Turbo channel */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_CHAN_CCK	0x0020	</span><span class="cm">/* CCK channel */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_CHAN_OFDM	0x0040	</span><span class="cm">/* OFDM channel */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_CHAN_2GHZ	0x0080	</span><span class="cm">/* 2 GHz spectrum channel. */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_CHAN_5GHZ	0x0100	</span><span class="cm">/* 5 GHz spectrum channel */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_CHAN_PASSIVE	0x0200	</span><span class="cm">/* Only passive scan allowed */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_CHAN_DYN	0x0400	</span><span class="cm">/* Dynamic CCK-OFDM channel */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_CHAN_GFSK	0x0800	</span><span class="cm">/* GFSK channel (FHSS PHY) */</span><span class="cp"></span>

<span class="cm">/* For IEEE80211_RADIOTAP_FLAGS */</span>
<span class="cp">#define	IEEE80211_RADIOTAP_F_CFP	0x01	</span><span class="cm">/* sent/received</span>
<span class="cm">						 * during CFP</span>
<span class="cm">						 */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_RADIOTAP_F_SHORTPRE	0x02	</span><span class="cm">/* sent/received</span>
<span class="cm">						 * with short</span>
<span class="cm">						 * preamble</span>
<span class="cm">						 */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_RADIOTAP_F_WEP	0x04	</span><span class="cm">/* sent/received</span>
<span class="cm">						 * with WEP encryption</span>
<span class="cm">						 */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_RADIOTAP_F_FRAG	0x08	</span><span class="cm">/* sent/received</span>
<span class="cm">						 * with fragmentation</span>
<span class="cm">						 */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_RADIOTAP_F_FCS	0x10	</span><span class="cm">/* frame includes FCS */</span><span class="cp"></span>
<span class="cp">#define	IEEE80211_RADIOTAP_F_DATAPAD	0x20	</span><span class="cm">/* frame has padding between</span>
<span class="cm">						 * 802.11 header and payload</span>
<span class="cm">						 * (to 32-bit boundary)</span>
<span class="cm">						 */</span><span class="cp"></span>
<span class="cp">#define IEEE80211_RADIOTAP_F_BADFCS	0x40	</span><span class="cm">/* bad FCS */</span><span class="cp"></span>

<span class="cm">/* For IEEE80211_RADIOTAP_RX_FLAGS */</span>
<span class="cp">#define IEEE80211_RADIOTAP_F_RX_BADPLCP	0x0002	</span><span class="cm">/* frame has bad PLCP */</span><span class="cp"></span>

<span class="cm">/* For IEEE80211_RADIOTAP_TX_FLAGS */</span>
<span class="cp">#define IEEE80211_RADIOTAP_F_TX_FAIL	0x0001	</span><span class="cm">/* failed due to excessive</span>
<span class="cm">						 * retries */</span><span class="cp"></span>
<span class="cp">#define IEEE80211_RADIOTAP_F_TX_CTS	0x0002	</span><span class="cm">/* used cts &#39;protection&#39; */</span><span class="cp"></span>
<span class="cp">#define IEEE80211_RADIOTAP_F_TX_RTS	0x0004	</span><span class="cm">/* used rts/cts handshake */</span><span class="cp"></span>
<span class="cp">#define IEEE80211_RADIOTAP_F_TX_NOACK	0x0008	</span><span class="cm">/* don&#39;t expect an ack */</span><span class="cp"></span>


<span class="cm">/* For IEEE80211_RADIOTAP_MCS */</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_HAVE_BW		0x01</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_HAVE_MCS		0x02</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_HAVE_GI		0x04</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_HAVE_FMT		0x08</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_HAVE_FEC		0x10</span>

<span class="cp">#define IEEE80211_RADIOTAP_MCS_BW_MASK		0x03</span>
<span class="cp">#define		IEEE80211_RADIOTAP_MCS_BW_20	0</span>
<span class="cp">#define		IEEE80211_RADIOTAP_MCS_BW_40	1</span>
<span class="cp">#define		IEEE80211_RADIOTAP_MCS_BW_20L	2</span>
<span class="cp">#define		IEEE80211_RADIOTAP_MCS_BW_20U	3</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_SGI		0x04</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_FMT_GF		0x08</span>
<span class="cp">#define IEEE80211_RADIOTAP_MCS_FEC_LDPC		0x10</span>


<span class="cm">/* helpers */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_get_radiotap_len</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_radiotap_header</span> <span class="o">*</span><span class="n">hdr</span> <span class="o">=</span>
		<span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_radiotap_header</span> <span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">get_unaligned_le16</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">it_len</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#endif				</span><span class="cm">/* IEEE80211_RADIOTAP_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
