<!DOCTYPE html>
<html><head><title>joekychen/linux » include › net › bluetooth › hci.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>hci.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">   BlueZ - Bluetooth protocol stack for Linux</span>
<span class="cm">   Copyright (C) 2000-2001 Qualcomm Incorporated</span>

<span class="cm">   Written 2000,2001 by Maxim Krasnyansky &lt;maxk@qualcomm.com&gt;</span>

<span class="cm">   This program is free software; you can redistribute it and/or modify</span>
<span class="cm">   it under the terms of the GNU General Public License version 2 as</span>
<span class="cm">   published by the Free Software Foundation;</span>

<span class="cm">   THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS</span>
<span class="cm">   OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="cm">   FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT OF THIRD PARTY RIGHTS.</span>
<span class="cm">   IN NO EVENT SHALL THE COPYRIGHT HOLDER(S) AND AUTHOR(S) BE LIABLE FOR ANY</span>
<span class="cm">   CLAIM, OR ANY SPECIAL INDIRECT OR CONSEQUENTIAL DAMAGES, OR ANY DAMAGES</span>
<span class="cm">   WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="cm">   ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="cm">   OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>

<span class="cm">   ALL LIABILITY, INCLUDING LIABILITY FOR INFRINGEMENT OF ANY PATENTS,</span>
<span class="cm">   COPYRIGHTS, TRADEMARKS OR OTHER RIGHTS, RELATING TO USE OF THIS</span>
<span class="cm">   SOFTWARE IS DISCLAIMED.</span>
<span class="cm">*/</span>

<span class="cp">#ifndef __HCI_H</span>
<span class="cp">#define __HCI_H</span>

<span class="cp">#define HCI_MAX_ACL_SIZE	1024</span>
<span class="cp">#define HCI_MAX_SCO_SIZE	255</span>
<span class="cp">#define HCI_MAX_EVENT_SIZE	260</span>
<span class="cp">#define HCI_MAX_FRAME_SIZE	(HCI_MAX_ACL_SIZE + 4)</span>

<span class="cm">/* HCI dev events */</span>
<span class="cp">#define HCI_DEV_REG			1</span>
<span class="cp">#define HCI_DEV_UNREG			2</span>
<span class="cp">#define HCI_DEV_UP			3</span>
<span class="cp">#define HCI_DEV_DOWN			4</span>
<span class="cp">#define HCI_DEV_SUSPEND			5</span>
<span class="cp">#define HCI_DEV_RESUME			6</span>

<span class="cm">/* HCI notify events */</span>
<span class="cp">#define HCI_NOTIFY_CONN_ADD		1</span>
<span class="cp">#define HCI_NOTIFY_CONN_DEL		2</span>
<span class="cp">#define HCI_NOTIFY_VOICE_SETTING	3</span>

<span class="cm">/* HCI bus types */</span>
<span class="cp">#define HCI_VIRTUAL	0</span>
<span class="cp">#define HCI_USB		1</span>
<span class="cp">#define HCI_PCCARD	2</span>
<span class="cp">#define HCI_UART	3</span>
<span class="cp">#define HCI_RS232	4</span>
<span class="cp">#define HCI_PCI		5</span>
<span class="cp">#define HCI_SDIO	6</span>

<span class="cm">/* HCI controller types */</span>
<span class="cp">#define HCI_BREDR	0x00</span>
<span class="cp">#define HCI_AMP		0x01</span>

<span class="cm">/* HCI device quirks */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">HCI_QUIRK_NO_RESET</span><span class="p">,</span>
	<span class="n">HCI_QUIRK_RAW_DEVICE</span><span class="p">,</span>
	<span class="n">HCI_QUIRK_FIXUP_BUFFER_SIZE</span>
<span class="p">};</span>

<span class="cm">/* HCI device flags */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">HCI_UP</span><span class="p">,</span>
	<span class="n">HCI_INIT</span><span class="p">,</span>
	<span class="n">HCI_RUNNING</span><span class="p">,</span>

	<span class="n">HCI_PSCAN</span><span class="p">,</span>
	<span class="n">HCI_ISCAN</span><span class="p">,</span>
	<span class="n">HCI_AUTH</span><span class="p">,</span>
	<span class="n">HCI_ENCRYPT</span><span class="p">,</span>
	<span class="n">HCI_INQUIRY</span><span class="p">,</span>

	<span class="n">HCI_RAW</span><span class="p">,</span>

	<span class="n">HCI_RESET</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * BR/EDR and/or LE controller flags: the flags defined here should represent</span>
<span class="cm"> * states from the controller.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">HCI_SETUP</span><span class="p">,</span>
	<span class="n">HCI_AUTO_OFF</span><span class="p">,</span>
	<span class="n">HCI_MGMT</span><span class="p">,</span>
	<span class="n">HCI_PAIRABLE</span><span class="p">,</span>
	<span class="n">HCI_SERVICE_CACHE</span><span class="p">,</span>
	<span class="n">HCI_LINK_KEYS</span><span class="p">,</span>
	<span class="n">HCI_DEBUG_KEYS</span><span class="p">,</span>
	<span class="n">HCI_UNREGISTER</span><span class="p">,</span>

	<span class="n">HCI_LE_SCAN</span><span class="p">,</span>
	<span class="n">HCI_SSP_ENABLED</span><span class="p">,</span>
	<span class="n">HCI_HS_ENABLED</span><span class="p">,</span>
	<span class="n">HCI_LE_ENABLED</span><span class="p">,</span>
	<span class="n">HCI_CONNECTABLE</span><span class="p">,</span>
	<span class="n">HCI_DISCOVERABLE</span><span class="p">,</span>
	<span class="n">HCI_LINK_SECURITY</span><span class="p">,</span>
	<span class="n">HCI_PENDING_CLASS</span><span class="p">,</span>
	<span class="n">HCI_PERIODIC_INQ</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* HCI ioctl defines */</span>
<span class="cp">#define HCIDEVUP	_IOW(&#39;H&#39;, 201, int)</span>
<span class="cp">#define HCIDEVDOWN	_IOW(&#39;H&#39;, 202, int)</span>
<span class="cp">#define HCIDEVRESET	_IOW(&#39;H&#39;, 203, int)</span>
<span class="cp">#define HCIDEVRESTAT	_IOW(&#39;H&#39;, 204, int)</span>

<span class="cp">#define HCIGETDEVLIST	_IOR(&#39;H&#39;, 210, int)</span>
<span class="cp">#define HCIGETDEVINFO	_IOR(&#39;H&#39;, 211, int)</span>
<span class="cp">#define HCIGETCONNLIST	_IOR(&#39;H&#39;, 212, int)</span>
<span class="cp">#define HCIGETCONNINFO	_IOR(&#39;H&#39;, 213, int)</span>
<span class="cp">#define HCIGETAUTHINFO	_IOR(&#39;H&#39;, 215, int)</span>

<span class="cp">#define HCISETRAW	_IOW(&#39;H&#39;, 220, int)</span>
<span class="cp">#define HCISETSCAN	_IOW(&#39;H&#39;, 221, int)</span>
<span class="cp">#define HCISETAUTH	_IOW(&#39;H&#39;, 222, int)</span>
<span class="cp">#define HCISETENCRYPT	_IOW(&#39;H&#39;, 223, int)</span>
<span class="cp">#define HCISETPTYPE	_IOW(&#39;H&#39;, 224, int)</span>
<span class="cp">#define HCISETLINKPOL	_IOW(&#39;H&#39;, 225, int)</span>
<span class="cp">#define HCISETLINKMODE	_IOW(&#39;H&#39;, 226, int)</span>
<span class="cp">#define HCISETACLMTU	_IOW(&#39;H&#39;, 227, int)</span>
<span class="cp">#define HCISETSCOMTU	_IOW(&#39;H&#39;, 228, int)</span>

<span class="cp">#define HCIBLOCKADDR	_IOW(&#39;H&#39;, 230, int)</span>
<span class="cp">#define HCIUNBLOCKADDR	_IOW(&#39;H&#39;, 231, int)</span>

<span class="cp">#define HCIINQUIRY	_IOR(&#39;H&#39;, 240, int)</span>

<span class="cm">/* HCI timeouts */</span>
<span class="cp">#define HCI_CONNECT_TIMEOUT	(40000)	</span><span class="cm">/* 40 seconds */</span><span class="cp"></span>
<span class="cp">#define HCI_DISCONN_TIMEOUT	(2000)	</span><span class="cm">/* 2 seconds */</span><span class="cp"></span>
<span class="cp">#define HCI_PAIRING_TIMEOUT	(60000)	</span><span class="cm">/* 60 seconds */</span><span class="cp"></span>
<span class="cp">#define HCI_IDLE_TIMEOUT	(6000)	</span><span class="cm">/* 6 seconds */</span><span class="cp"></span>
<span class="cp">#define HCI_INIT_TIMEOUT	(10000)	</span><span class="cm">/* 10 seconds */</span><span class="cp"></span>
<span class="cp">#define HCI_CMD_TIMEOUT		(1000)	</span><span class="cm">/* 1 seconds */</span><span class="cp"></span>
<span class="cp">#define HCI_ACL_TX_TIMEOUT	(45000)	</span><span class="cm">/* 45 seconds */</span><span class="cp"></span>

<span class="cm">/* HCI data types */</span>
<span class="cp">#define HCI_COMMAND_PKT		0x01</span>
<span class="cp">#define HCI_ACLDATA_PKT		0x02</span>
<span class="cp">#define HCI_SCODATA_PKT		0x03</span>
<span class="cp">#define HCI_EVENT_PKT		0x04</span>
<span class="cp">#define HCI_VENDOR_PKT		0xff</span>

<span class="cm">/* HCI packet types */</span>
<span class="cp">#define HCI_DM1		0x0008</span>
<span class="cp">#define HCI_DM3		0x0400</span>
<span class="cp">#define HCI_DM5		0x4000</span>
<span class="cp">#define HCI_DH1		0x0010</span>
<span class="cp">#define HCI_DH3		0x0800</span>
<span class="cp">#define HCI_DH5		0x8000</span>

<span class="cp">#define HCI_HV1		0x0020</span>
<span class="cp">#define HCI_HV2		0x0040</span>
<span class="cp">#define HCI_HV3		0x0080</span>

<span class="cp">#define SCO_PTYPE_MASK	(HCI_HV1 | HCI_HV2 | HCI_HV3)</span>
<span class="cp">#define ACL_PTYPE_MASK	(~SCO_PTYPE_MASK)</span>

<span class="cm">/* eSCO packet types */</span>
<span class="cp">#define ESCO_HV1	0x0001</span>
<span class="cp">#define ESCO_HV2	0x0002</span>
<span class="cp">#define ESCO_HV3	0x0004</span>
<span class="cp">#define ESCO_EV3	0x0008</span>
<span class="cp">#define ESCO_EV4	0x0010</span>
<span class="cp">#define ESCO_EV5	0x0020</span>
<span class="cp">#define ESCO_2EV3	0x0040</span>
<span class="cp">#define ESCO_3EV3	0x0080</span>
<span class="cp">#define ESCO_2EV5	0x0100</span>
<span class="cp">#define ESCO_3EV5	0x0200</span>

<span class="cp">#define SCO_ESCO_MASK  (ESCO_HV1 | ESCO_HV2 | ESCO_HV3)</span>
<span class="cp">#define EDR_ESCO_MASK  (ESCO_2EV3 | ESCO_3EV3 | ESCO_2EV5 | ESCO_3EV5)</span>

<span class="cm">/* ACL flags */</span>
<span class="cp">#define ACL_START_NO_FLUSH	0x00</span>
<span class="cp">#define ACL_CONT		0x01</span>
<span class="cp">#define ACL_START		0x02</span>
<span class="cp">#define ACL_ACTIVE_BCAST	0x04</span>
<span class="cp">#define ACL_PICO_BCAST		0x08</span>

<span class="cm">/* Baseband links */</span>
<span class="cp">#define SCO_LINK	0x00</span>
<span class="cp">#define ACL_LINK	0x01</span>
<span class="cp">#define ESCO_LINK	0x02</span>
<span class="cm">/* Low Energy links do not have defined link type. Use invented one */</span>
<span class="cp">#define LE_LINK		0x80</span>

<span class="cm">/* LMP features */</span>
<span class="cp">#define LMP_3SLOT	0x01</span>
<span class="cp">#define LMP_5SLOT	0x02</span>
<span class="cp">#define LMP_ENCRYPT	0x04</span>
<span class="cp">#define LMP_SOFFSET	0x08</span>
<span class="cp">#define LMP_TACCURACY	0x10</span>
<span class="cp">#define LMP_RSWITCH	0x20</span>
<span class="cp">#define LMP_HOLD	0x40</span>
<span class="cp">#define LMP_SNIFF	0x80</span>

<span class="cp">#define LMP_PARK	0x01</span>
<span class="cp">#define LMP_RSSI	0x02</span>
<span class="cp">#define LMP_QUALITY	0x04</span>
<span class="cp">#define LMP_SCO		0x08</span>
<span class="cp">#define LMP_HV2		0x10</span>
<span class="cp">#define LMP_HV3		0x20</span>
<span class="cp">#define LMP_ULAW	0x40</span>
<span class="cp">#define LMP_ALAW	0x80</span>

<span class="cp">#define LMP_CVSD	0x01</span>
<span class="cp">#define LMP_PSCHEME	0x02</span>
<span class="cp">#define LMP_PCONTROL	0x04</span>

<span class="cp">#define LMP_RSSI_INQ	0x40</span>
<span class="cp">#define LMP_ESCO	0x80</span>

<span class="cp">#define LMP_EV4		0x01</span>
<span class="cp">#define LMP_EV5		0x02</span>
<span class="cp">#define LMP_NO_BREDR	0x20</span>
<span class="cp">#define LMP_LE		0x40</span>

<span class="cp">#define LMP_SNIFF_SUBR	0x02</span>
<span class="cp">#define LMP_PAUSE_ENC	0x04</span>
<span class="cp">#define LMP_EDR_ESCO_2M	0x20</span>
<span class="cp">#define LMP_EDR_ESCO_3M	0x40</span>
<span class="cp">#define LMP_EDR_3S_ESCO	0x80</span>

<span class="cp">#define LMP_EXT_INQ	0x01</span>
<span class="cp">#define LMP_SIMUL_LE_BR	0x02</span>
<span class="cp">#define LMP_SIMPLE_PAIR	0x08</span>
<span class="cp">#define LMP_NO_FLUSH	0x40</span>

<span class="cp">#define LMP_LSTO	0x01</span>
<span class="cp">#define LMP_INQ_TX_PWR	0x02</span>
<span class="cp">#define LMP_EXTFEATURES	0x80</span>

<span class="cm">/* Extended LMP features */</span>
<span class="cp">#define LMP_HOST_SSP		0x01</span>
<span class="cp">#define LMP_HOST_LE		0x02</span>
<span class="cp">#define LMP_HOST_LE_BREDR	0x04</span>

<span class="cm">/* Connection modes */</span>
<span class="cp">#define HCI_CM_ACTIVE	0x0000</span>
<span class="cp">#define HCI_CM_HOLD	0x0001</span>
<span class="cp">#define HCI_CM_SNIFF	0x0002</span>
<span class="cp">#define HCI_CM_PARK	0x0003</span>

<span class="cm">/* Link policies */</span>
<span class="cp">#define HCI_LP_RSWITCH	0x0001</span>
<span class="cp">#define HCI_LP_HOLD	0x0002</span>
<span class="cp">#define HCI_LP_SNIFF	0x0004</span>
<span class="cp">#define HCI_LP_PARK	0x0008</span>

<span class="cm">/* Link modes */</span>
<span class="cp">#define HCI_LM_ACCEPT	0x8000</span>
<span class="cp">#define HCI_LM_MASTER	0x0001</span>
<span class="cp">#define HCI_LM_AUTH	0x0002</span>
<span class="cp">#define HCI_LM_ENCRYPT	0x0004</span>
<span class="cp">#define HCI_LM_TRUSTED	0x0008</span>
<span class="cp">#define HCI_LM_RELIABLE	0x0010</span>
<span class="cp">#define HCI_LM_SECURE	0x0020</span>

<span class="cm">/* Authentication types */</span>
<span class="cp">#define HCI_AT_NO_BONDING		0x00</span>
<span class="cp">#define HCI_AT_NO_BONDING_MITM		0x01</span>
<span class="cp">#define HCI_AT_DEDICATED_BONDING	0x02</span>
<span class="cp">#define HCI_AT_DEDICATED_BONDING_MITM	0x03</span>
<span class="cp">#define HCI_AT_GENERAL_BONDING		0x04</span>
<span class="cp">#define HCI_AT_GENERAL_BONDING_MITM	0x05</span>

<span class="cm">/* Link Key types */</span>
<span class="cp">#define HCI_LK_COMBINATION		0x00</span>
<span class="cp">#define HCI_LK_LOCAL_UNIT		0x01</span>
<span class="cp">#define HCI_LK_REMOTE_UNIT		0x02</span>
<span class="cp">#define HCI_LK_DEBUG_COMBINATION	0x03</span>
<span class="cp">#define HCI_LK_UNAUTH_COMBINATION	0x04</span>
<span class="cp">#define HCI_LK_AUTH_COMBINATION		0x05</span>
<span class="cp">#define HCI_LK_CHANGED_COMBINATION	0x06</span>
<span class="cm">/* The spec doesn&#39;t define types for SMP keys, the _MASTER suffix is implied */</span>
<span class="cp">#define HCI_SMP_STK			0x80</span>
<span class="cp">#define HCI_SMP_STK_SLAVE		0x81</span>
<span class="cp">#define HCI_SMP_LTK			0x82</span>
<span class="cp">#define HCI_SMP_LTK_SLAVE		0x83</span>

<span class="cm">/* ---- HCI Error Codes ---- */</span>
<span class="cp">#define HCI_ERROR_AUTH_FAILURE		0x05</span>
<span class="cp">#define HCI_ERROR_REJ_BAD_ADDR		0x0f</span>
<span class="cp">#define HCI_ERROR_REMOTE_USER_TERM	0x13</span>
<span class="cp">#define HCI_ERROR_LOCAL_HOST_TERM	0x16</span>
<span class="cp">#define HCI_ERROR_PAIRING_NOT_ALLOWED	0x18</span>

<span class="cm">/* Flow control modes */</span>
<span class="cp">#define HCI_FLOW_CTL_MODE_PACKET_BASED	0x00</span>
<span class="cp">#define HCI_FLOW_CTL_MODE_BLOCK_BASED	0x01</span>

<span class="cm">/* Extended Inquiry Response field types */</span>
<span class="cp">#define EIR_FLAGS		0x01 </span><span class="cm">/* flags */</span><span class="cp"></span>
<span class="cp">#define EIR_UUID16_SOME		0x02 </span><span class="cm">/* 16-bit UUID, more available */</span><span class="cp"></span>
<span class="cp">#define EIR_UUID16_ALL		0x03 </span><span class="cm">/* 16-bit UUID, all listed */</span><span class="cp"></span>
<span class="cp">#define EIR_UUID32_SOME		0x04 </span><span class="cm">/* 32-bit UUID, more available */</span><span class="cp"></span>
<span class="cp">#define EIR_UUID32_ALL		0x05 </span><span class="cm">/* 32-bit UUID, all listed */</span><span class="cp"></span>
<span class="cp">#define EIR_UUID128_SOME	0x06 </span><span class="cm">/* 128-bit UUID, more available */</span><span class="cp"></span>
<span class="cp">#define EIR_UUID128_ALL		0x07 </span><span class="cm">/* 128-bit UUID, all listed */</span><span class="cp"></span>
<span class="cp">#define EIR_NAME_SHORT		0x08 </span><span class="cm">/* shortened local name */</span><span class="cp"></span>
<span class="cp">#define EIR_NAME_COMPLETE	0x09 </span><span class="cm">/* complete local name */</span><span class="cp"></span>
<span class="cp">#define EIR_TX_POWER		0x0A </span><span class="cm">/* transmit power level */</span><span class="cp"></span>
<span class="cp">#define EIR_CLASS_OF_DEV	0x0D </span><span class="cm">/* Class of Device */</span><span class="cp"></span>
<span class="cp">#define EIR_SSP_HASH_C		0x0E </span><span class="cm">/* Simple Pairing Hash C */</span><span class="cp"></span>
<span class="cp">#define EIR_SSP_RAND_R		0x0F </span><span class="cm">/* Simple Pairing Randomizer R */</span><span class="cp"></span>
<span class="cp">#define EIR_DEVICE_ID		0x10 </span><span class="cm">/* device ID */</span><span class="cp"></span>

<span class="cm">/* -----  HCI Commands ---- */</span>
<span class="cp">#define HCI_OP_NOP			0x0000</span>

<span class="cp">#define HCI_OP_INQUIRY			0x0401</span>
<span class="k">struct</span> <span class="n">hci_cp_inquiry</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">lap</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__u8</span>     <span class="n">length</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">num_rsp</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_INQUIRY_CANCEL		0x0402</span>

<span class="cp">#define HCI_OP_PERIODIC_INQ		0x0403</span>

<span class="cp">#define HCI_OP_EXIT_PERIODIC_INQ	0x0404</span>

<span class="cp">#define HCI_OP_CREATE_CONN		0x0405</span>
<span class="k">struct</span> <span class="n">hci_cp_create_conn</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pkt_type</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_rep_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_mode</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">clock_offset</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">role_switch</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_DISCONNECT		0x0406</span>
<span class="k">struct</span> <span class="n">hci_cp_disconnect</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_ADD_SCO			0x0407</span>
<span class="k">struct</span> <span class="n">hci_cp_add_sco</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pkt_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_CREATE_CONN_CANCEL	0x0408</span>
<span class="k">struct</span> <span class="n">hci_cp_create_conn_cancel</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_ACCEPT_CONN_REQ		0x0409</span>
<span class="k">struct</span> <span class="n">hci_cp_accept_conn_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">role</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_REJECT_CONN_REQ		0x040a</span>
<span class="k">struct</span> <span class="n">hci_cp_reject_conn_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LINK_KEY_REPLY		0x040b</span>
<span class="k">struct</span> <span class="n">hci_cp_link_key_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">link_key</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LINK_KEY_NEG_REPLY	0x040c</span>
<span class="k">struct</span> <span class="n">hci_cp_link_key_neg_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_PIN_CODE_REPLY		0x040d</span>
<span class="k">struct</span> <span class="n">hci_cp_pin_code_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pin_len</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pin_code</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_pin_code_reply</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_PIN_CODE_NEG_REPLY	0x040e</span>
<span class="k">struct</span> <span class="n">hci_cp_pin_code_neg_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_pin_code_neg_reply</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_CHANGE_CONN_PTYPE	0x040f</span>
<span class="k">struct</span> <span class="n">hci_cp_change_conn_ptype</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pkt_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_AUTH_REQUESTED		0x0411</span>
<span class="k">struct</span> <span class="n">hci_cp_auth_requested</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_SET_CONN_ENCRYPT		0x0413</span>
<span class="k">struct</span> <span class="n">hci_cp_set_conn_encrypt</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">encrypt</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_CHANGE_CONN_LINK_KEY	0x0415</span>
<span class="k">struct</span> <span class="n">hci_cp_change_conn_link_key</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_REMOTE_NAME_REQ		0x0419</span>
<span class="k">struct</span> <span class="n">hci_cp_remote_name_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_rep_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_mode</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">clock_offset</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_REMOTE_NAME_REQ_CANCEL	0x041a</span>
<span class="k">struct</span> <span class="n">hci_cp_remote_name_req_cancel</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_REMOTE_FEATURES	0x041b</span>
<span class="k">struct</span> <span class="n">hci_cp_read_remote_features</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_REMOTE_EXT_FEATURES	0x041c</span>
<span class="k">struct</span> <span class="n">hci_cp_read_remote_ext_features</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">page</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_REMOTE_VERSION	0x041d</span>
<span class="k">struct</span> <span class="n">hci_cp_read_remote_version</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_SETUP_SYNC_CONN		0x0428</span>
<span class="k">struct</span> <span class="n">hci_cp_setup_sync_conn</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">tx_bandwidth</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">rx_bandwidth</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">voice_setting</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">retrans_effort</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pkt_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_ACCEPT_SYNC_CONN_REQ	0x0429</span>
<span class="k">struct</span> <span class="n">hci_cp_accept_sync_conn_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">tx_bandwidth</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">rx_bandwidth</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">content_format</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">retrans_effort</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pkt_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_REJECT_SYNC_CONN_REQ	0x042a</span>
<span class="k">struct</span> <span class="n">hci_cp_reject_sync_conn_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_IO_CAPABILITY_REPLY	0x042b</span>
<span class="k">struct</span> <span class="n">hci_cp_io_capability_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">capability</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">oob_data</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">authentication</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_USER_CONFIRM_REPLY		0x042c</span>
<span class="k">struct</span> <span class="n">hci_cp_user_confirm_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_user_confirm_reply</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_USER_CONFIRM_NEG_REPLY	0x042d</span>

<span class="cp">#define HCI_OP_USER_PASSKEY_REPLY		0x042e</span>
<span class="k">struct</span> <span class="n">hci_cp_user_passkey_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">passkey</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_USER_PASSKEY_NEG_REPLY	0x042f</span>

<span class="cp">#define HCI_OP_REMOTE_OOB_DATA_REPLY	0x0430</span>
<span class="k">struct</span> <span class="n">hci_cp_remote_oob_data_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">hash</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">__u8</span>     <span class="n">randomizer</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_REMOTE_OOB_DATA_NEG_REPLY	0x0433</span>
<span class="k">struct</span> <span class="n">hci_cp_remote_oob_data_neg_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_IO_CAPABILITY_NEG_REPLY	0x0434</span>
<span class="k">struct</span> <span class="n">hci_cp_io_capability_neg_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_SNIFF_MODE		0x0803</span>
<span class="k">struct</span> <span class="n">hci_cp_sniff_mode</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_interval</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">min_interval</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">attempt</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">timeout</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_EXIT_SNIFF_MODE		0x0804</span>
<span class="k">struct</span> <span class="n">hci_cp_exit_sniff_mode</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_ROLE_DISCOVERY		0x0809</span>
<span class="k">struct</span> <span class="n">hci_cp_role_discovery</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_role_discovery</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">role</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_SWITCH_ROLE		0x080b</span>
<span class="k">struct</span> <span class="n">hci_cp_switch_role</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">role</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_LINK_POLICY		0x080c</span>
<span class="k">struct</span> <span class="n">hci_cp_read_link_policy</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_read_link_policy</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">policy</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_LINK_POLICY	0x080d</span>
<span class="k">struct</span> <span class="n">hci_cp_write_link_policy</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">policy</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_write_link_policy</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_DEF_LINK_POLICY	0x080e</span>
<span class="k">struct</span> <span class="n">hci_rp_read_def_link_policy</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">policy</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_DEF_LINK_POLICY	0x080f</span>
<span class="k">struct</span> <span class="n">hci_cp_write_def_link_policy</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">policy</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_SNIFF_SUBRATE		0x0811</span>
<span class="k">struct</span> <span class="n">hci_cp_sniff_subrate</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">min_remote_timeout</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">min_local_timeout</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_SET_EVENT_MASK		0x0c01</span>
<span class="k">struct</span> <span class="n">hci_cp_set_event_mask</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">mask</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_RESET			0x0c03</span>

<span class="cp">#define HCI_OP_SET_EVENT_FLT		0x0c05</span>
<span class="k">struct</span> <span class="n">hci_cp_set_event_flt</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">flt_type</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">cond_type</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">condition</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Filter types */</span>
<span class="cp">#define HCI_FLT_CLEAR_ALL	0x00</span>
<span class="cp">#define HCI_FLT_INQ_RESULT	0x01</span>
<span class="cp">#define HCI_FLT_CONN_SETUP	0x02</span>

<span class="cm">/* CONN_SETUP Condition types */</span>
<span class="cp">#define HCI_CONN_SETUP_ALLOW_ALL	0x00</span>
<span class="cp">#define HCI_CONN_SETUP_ALLOW_CLASS	0x01</span>
<span class="cp">#define HCI_CONN_SETUP_ALLOW_BDADDR	0x02</span>

<span class="cm">/* CONN_SETUP Conditions */</span>
<span class="cp">#define HCI_CONN_SETUP_AUTO_OFF	0x01</span>
<span class="cp">#define HCI_CONN_SETUP_AUTO_ON	0x02</span>

<span class="cp">#define HCI_OP_DELETE_STORED_LINK_KEY	0x0c12</span>
<span class="k">struct</span> <span class="n">hci_cp_delete_stored_link_key</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">delete_all</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_MAX_NAME_LENGTH		248</span>

<span class="cp">#define HCI_OP_WRITE_LOCAL_NAME		0x0c13</span>
<span class="k">struct</span> <span class="n">hci_cp_write_local_name</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">name</span><span class="p">[</span><span class="n">HCI_MAX_NAME_LENGTH</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_LOCAL_NAME		0x0c14</span>
<span class="k">struct</span> <span class="n">hci_rp_read_local_name</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">name</span><span class="p">[</span><span class="n">HCI_MAX_NAME_LENGTH</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_CA_TIMEOUT		0x0c16</span>

<span class="cp">#define HCI_OP_WRITE_PG_TIMEOUT		0x0c18</span>

<span class="cp">#define HCI_OP_WRITE_SCAN_ENABLE	0x0c1a</span>
	<span class="cp">#define SCAN_DISABLED		0x00</span>
	<span class="cp">#define SCAN_INQUIRY		0x01</span>
	<span class="cp">#define SCAN_PAGE		0x02</span>

<span class="cp">#define HCI_OP_READ_AUTH_ENABLE		0x0c1f</span>

<span class="cp">#define HCI_OP_WRITE_AUTH_ENABLE	0x0c20</span>
	<span class="cp">#define AUTH_DISABLED		0x00</span>
	<span class="cp">#define AUTH_ENABLED		0x01</span>

<span class="cp">#define HCI_OP_READ_ENCRYPT_MODE	0x0c21</span>

<span class="cp">#define HCI_OP_WRITE_ENCRYPT_MODE	0x0c22</span>
	<span class="cp">#define ENCRYPT_DISABLED	0x00</span>
	<span class="cp">#define ENCRYPT_P2P		0x01</span>
	<span class="cp">#define ENCRYPT_BOTH		0x02</span>

<span class="cp">#define HCI_OP_READ_CLASS_OF_DEV	0x0c23</span>
<span class="k">struct</span> <span class="n">hci_rp_read_class_of_dev</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">dev_class</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_CLASS_OF_DEV	0x0c24</span>
<span class="k">struct</span> <span class="n">hci_cp_write_class_of_dev</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">dev_class</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_VOICE_SETTING	0x0c25</span>
<span class="k">struct</span> <span class="n">hci_rp_read_voice_setting</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">voice_setting</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_VOICE_SETTING	0x0c26</span>
<span class="k">struct</span> <span class="n">hci_cp_write_voice_setting</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">voice_setting</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_HOST_BUFFER_SIZE		0x0c33</span>
<span class="k">struct</span> <span class="n">hci_cp_host_buffer_size</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">acl_mtu</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">sco_mtu</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">acl_max_pkt</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">sco_max_pkt</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_INQUIRY_MODE	0x0c45</span>

<span class="cp">#define HCI_MAX_EIR_LENGTH		240</span>

<span class="cp">#define HCI_OP_WRITE_EIR		0x0c52</span>
<span class="k">struct</span> <span class="n">hci_cp_write_eir</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">fec</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">data</span><span class="p">[</span><span class="n">HCI_MAX_EIR_LENGTH</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_SSP_MODE		0x0c55</span>
<span class="k">struct</span> <span class="n">hci_rp_read_ssp_mode</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_SSP_MODE		0x0c56</span>
<span class="k">struct</span> <span class="n">hci_cp_write_ssp_mode</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_LOCAL_OOB_DATA		0x0c57</span>
<span class="k">struct</span> <span class="n">hci_rp_read_local_oob_data</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">hash</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">__u8</span>     <span class="n">randomizer</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_INQ_RSP_TX_POWER	0x0c58</span>
<span class="k">struct</span> <span class="n">hci_rp_read_inq_rsp_tx_power</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__s8</span>     <span class="n">tx_power</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_FLOW_CONTROL_MODE	0x0c66</span>
<span class="k">struct</span> <span class="n">hci_rp_read_flow_control_mode</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_LE_HOST_SUPPORTED	0x0c6d</span>
<span class="k">struct</span> <span class="n">hci_cp_write_le_host_supported</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">le</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">simul</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_LOCAL_VERSION	0x1001</span>
<span class="k">struct</span> <span class="n">hci_rp_read_local_version</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">hci_ver</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">hci_rev</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">lmp_ver</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">manufacturer</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">lmp_subver</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_LOCAL_COMMANDS	0x1002</span>
<span class="k">struct</span> <span class="n">hci_rp_read_local_commands</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">commands</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_LOCAL_FEATURES	0x1003</span>
<span class="k">struct</span> <span class="n">hci_rp_read_local_features</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">features</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_LOCAL_EXT_FEATURES	0x1004</span>
<span class="k">struct</span> <span class="n">hci_cp_read_local_ext_features</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">page</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_read_local_ext_features</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">page</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">max_page</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">features</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_BUFFER_SIZE		0x1005</span>
<span class="k">struct</span> <span class="n">hci_rp_read_buffer_size</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">acl_mtu</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">sco_mtu</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">acl_max_pkt</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">sco_max_pkt</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_BD_ADDR		0x1009</span>
<span class="k">struct</span> <span class="n">hci_rp_read_bd_addr</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_READ_DATA_BLOCK_SIZE	0x100a</span>
<span class="k">struct</span> <span class="n">hci_rp_read_data_block_size</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_acl_len</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">block_len</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">num_blocks</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_PAGE_SCAN_ACTIVITY	0x0c1c</span>
<span class="k">struct</span> <span class="n">hci_cp_write_page_scan_activity</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">interval</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">window</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_WRITE_PAGE_SCAN_TYPE	0x0c47</span>
	<span class="cp">#define PAGE_SCAN_TYPE_STANDARD		0x00</span>
	<span class="cp">#define PAGE_SCAN_TYPE_INTERLACED	0x01</span>

<span class="cp">#define HCI_OP_READ_LOCAL_AMP_INFO	0x1409</span>
<span class="k">struct</span> <span class="n">hci_rp_read_local_amp_info</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">amp_status</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">total_bw</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">max_bw</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">min_latency</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">max_pdu</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">amp_type</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pal_cap</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_assoc_size</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">max_flush_to</span><span class="p">;</span>
	<span class="n">__le32</span>   <span class="n">be_flush_to</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_SET_EVENT_MASK	0x2001</span>
<span class="k">struct</span> <span class="n">hci_cp_le_set_event_mask</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">mask</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_READ_BUFFER_SIZE	0x2002</span>
<span class="k">struct</span> <span class="n">hci_rp_le_read_buffer_size</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">le_mtu</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">le_max_pkt</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_SET_SCAN_PARAM	0x200b</span>
<span class="k">struct</span> <span class="n">hci_cp_le_set_scan_param</span> <span class="p">{</span>
	<span class="n">__u8</span>    <span class="n">type</span><span class="p">;</span>
	<span class="n">__le16</span>  <span class="n">interval</span><span class="p">;</span>
	<span class="n">__le16</span>  <span class="n">window</span><span class="p">;</span>
	<span class="n">__u8</span>    <span class="n">own_address_type</span><span class="p">;</span>
	<span class="n">__u8</span>    <span class="n">filter_policy</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define LE_SCANNING_DISABLED		0x00</span>
<span class="cp">#define LE_SCANNING_ENABLED		0x01</span>

<span class="cp">#define HCI_OP_LE_SET_SCAN_ENABLE	0x200c</span>
<span class="k">struct</span> <span class="n">hci_cp_le_set_scan_enable</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">enable</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">filter_dup</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_CREATE_CONN		0x200d</span>
<span class="k">struct</span> <span class="n">hci_cp_le_create_conn</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">scan_interval</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">scan_window</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">filter_policy</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">peer_addr_type</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">peer_addr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">own_address_type</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">conn_interval_min</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">conn_interval_max</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">conn_latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">supervision_timeout</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">min_ce_len</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_ce_len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_CREATE_CONN_CANCEL	0x200e</span>

<span class="cp">#define HCI_OP_LE_CONN_UPDATE		0x2013</span>
<span class="k">struct</span> <span class="n">hci_cp_le_conn_update</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">conn_interval_min</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">conn_interval_max</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">conn_latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">supervision_timeout</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">min_ce_len</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_ce_len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_START_ENC		0x2019</span>
<span class="k">struct</span> <span class="n">hci_cp_le_start_enc</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">rand</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">__le16</span>	<span class="n">ediv</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">ltk</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_LTK_REPLY		0x201a</span>
<span class="k">struct</span> <span class="n">hci_cp_le_ltk_reply</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">ltk</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_le_ltk_reply</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_OP_LE_LTK_NEG_REPLY		0x201b</span>
<span class="k">struct</span> <span class="n">hci_cp_le_ltk_neg_reply</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_rp_le_ltk_neg_reply</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* ---- HCI Events ---- */</span>
<span class="cp">#define HCI_EV_INQUIRY_COMPLETE		0x01</span>

<span class="cp">#define HCI_EV_INQUIRY_RESULT		0x02</span>
<span class="k">struct</span> <span class="n">inquiry_info</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_rep_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_period_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">dev_class</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__le16</span>   <span class="n">clock_offset</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_CONN_COMPLETE		0x03</span>
<span class="k">struct</span> <span class="n">hci_ev_conn_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">link_type</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">encr_mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_CONN_REQUEST		0x04</span>
<span class="k">struct</span> <span class="n">hci_ev_conn_request</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">dev_class</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__u8</span>     <span class="n">link_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_DISCONN_COMPLETE		0x05</span>
<span class="k">struct</span> <span class="n">hci_ev_disconn_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_AUTH_COMPLETE		0x06</span>
<span class="k">struct</span> <span class="n">hci_ev_auth_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_REMOTE_NAME		0x07</span>
<span class="k">struct</span> <span class="n">hci_ev_remote_name</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">name</span><span class="p">[</span><span class="n">HCI_MAX_NAME_LENGTH</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_ENCRYPT_CHANGE		0x08</span>
<span class="k">struct</span> <span class="n">hci_ev_encrypt_change</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">encrypt</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_CHANGE_LINK_KEY_COMPLETE	0x09</span>
<span class="k">struct</span> <span class="n">hci_ev_change_link_key_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_REMOTE_FEATURES		0x0b</span>
<span class="k">struct</span> <span class="n">hci_ev_remote_features</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">features</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_REMOTE_VERSION		0x0c</span>
<span class="k">struct</span> <span class="n">hci_ev_remote_version</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">lmp_ver</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">manufacturer</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">lmp_subver</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_QOS_SETUP_COMPLETE	0x0d</span>
<span class="k">struct</span> <span class="n">hci_qos</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">service_type</span><span class="p">;</span>
	<span class="n">__u32</span>    <span class="n">token_rate</span><span class="p">;</span>
	<span class="n">__u32</span>    <span class="n">peak_bandwidth</span><span class="p">;</span>
	<span class="n">__u32</span>    <span class="n">latency</span><span class="p">;</span>
	<span class="n">__u32</span>    <span class="n">delay_variation</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">hci_ev_qos_setup_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="k">struct</span>   <span class="n">hci_qos</span> <span class="n">qos</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_CMD_COMPLETE		0x0e</span>
<span class="k">struct</span> <span class="n">hci_ev_cmd_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">ncmd</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">opcode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_CMD_STATUS		0x0f</span>
<span class="k">struct</span> <span class="n">hci_ev_cmd_status</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">ncmd</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">opcode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_ROLE_CHANGE		0x12</span>
<span class="k">struct</span> <span class="n">hci_ev_role_change</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">role</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_NUM_COMP_PKTS		0x13</span>
<span class="k">struct</span> <span class="n">hci_comp_pkts_info</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">count</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hci_ev_num_comp_pkts</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">num_hndl</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hci_comp_pkts_info</span> <span class="n">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_MODE_CHANGE		0x14</span>
<span class="k">struct</span> <span class="n">hci_ev_mode_change</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">mode</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">interval</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_PIN_CODE_REQ		0x16</span>
<span class="k">struct</span> <span class="n">hci_ev_pin_code_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_LINK_KEY_REQ		0x17</span>
<span class="k">struct</span> <span class="n">hci_ev_link_key_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_LINK_KEY_NOTIFY		0x18</span>
<span class="k">struct</span> <span class="n">hci_ev_link_key_notify</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">link_key</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">__u8</span>     <span class="n">key_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_CLOCK_OFFSET		0x1c</span>
<span class="k">struct</span> <span class="n">hci_ev_clock_offset</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">clock_offset</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_PKT_TYPE_CHANGE		0x1d</span>
<span class="k">struct</span> <span class="n">hci_ev_pkt_type_change</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pkt_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_PSCAN_REP_MODE		0x20</span>
<span class="k">struct</span> <span class="n">hci_ev_pscan_rep_mode</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_rep_mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_INQUIRY_RESULT_WITH_RSSI	0x22</span>
<span class="k">struct</span> <span class="n">inquiry_info_with_rssi</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_rep_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_period_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">dev_class</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__le16</span>   <span class="n">clock_offset</span><span class="p">;</span>
	<span class="n">__s8</span>     <span class="n">rssi</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">inquiry_info_with_rssi_and_pscan_mode</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_rep_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_period_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">dev_class</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__le16</span>   <span class="n">clock_offset</span><span class="p">;</span>
	<span class="n">__s8</span>     <span class="n">rssi</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_REMOTE_EXT_FEATURES	0x23</span>
<span class="k">struct</span> <span class="n">hci_ev_remote_ext_features</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">page</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">max_page</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">features</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_SYNC_CONN_COMPLETE	0x2c</span>
<span class="k">struct</span> <span class="n">hci_ev_sync_conn_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">link_type</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">tx_interval</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">retrans_window</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">rx_pkt_len</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">tx_pkt_len</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">air_mode</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_SYNC_CONN_CHANGED	0x2d</span>
<span class="k">struct</span> <span class="n">hci_ev_sync_conn_changed</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">tx_interval</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">retrans_window</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">rx_pkt_len</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">tx_pkt_len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_SNIFF_SUBRATE		0x2e</span>
<span class="k">struct</span> <span class="n">hci_ev_sniff_subrate</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_tx_latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_rx_latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_remote_timeout</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">max_local_timeout</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_EXTENDED_INQUIRY_RESULT	0x2f</span>
<span class="k">struct</span> <span class="n">extended_inquiry_info</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_rep_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">pscan_period_mode</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">dev_class</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__le16</span>   <span class="n">clock_offset</span><span class="p">;</span>
	<span class="n">__s8</span>     <span class="n">rssi</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">data</span><span class="p">[</span><span class="mi">240</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_KEY_REFRESH_COMPLETE	0x30</span>
<span class="k">struct</span> <span class="n">hci_ev_key_refresh_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_IO_CAPA_REQUEST		0x31</span>
<span class="k">struct</span> <span class="n">hci_ev_io_capa_request</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_IO_CAPA_REPLY		0x32</span>
<span class="k">struct</span> <span class="n">hci_ev_io_capa_reply</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">capability</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">oob_data</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">authentication</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_USER_CONFIRM_REQUEST	0x33</span>
<span class="k">struct</span> <span class="n">hci_ev_user_confirm_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span>	<span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__le32</span>		<span class="n">passkey</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_USER_PASSKEY_REQUEST	0x34</span>
<span class="k">struct</span> <span class="n">hci_ev_user_passkey_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span>	<span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_REMOTE_OOB_DATA_REQUEST	0x35</span>
<span class="k">struct</span> <span class="n">hci_ev_remote_oob_data_request</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_SIMPLE_PAIR_COMPLETE	0x36</span>
<span class="k">struct</span> <span class="n">hci_ev_simple_pair_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_REMOTE_HOST_FEATURES	0x3d</span>
<span class="k">struct</span> <span class="n">hci_ev_remote_host_features</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">features</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_LE_META			0x3e</span>
<span class="k">struct</span> <span class="n">hci_ev_le_meta</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">subevent</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_NUM_COMP_BLOCKS		0x48</span>
<span class="k">struct</span> <span class="n">hci_comp_blocks_info</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">pkts</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">blocks</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hci_ev_num_comp_blocks</span> <span class="p">{</span>
	<span class="n">__le16</span>   <span class="n">num_blocks</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">num_hndl</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hci_comp_blocks_info</span> <span class="n">handles</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Low energy meta events */</span>
<span class="cp">#define HCI_EV_LE_CONN_COMPLETE		0x01</span>
<span class="k">struct</span> <span class="n">hci_ev_le_conn_complete</span> <span class="p">{</span>
	<span class="n">__u8</span>     <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">role</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">bdaddr_type</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">interval</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">latency</span><span class="p">;</span>
	<span class="n">__le16</span>   <span class="n">supervision_timeout</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">clk_accurancy</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_LE_LTK_REQ		0x05</span>
<span class="k">struct</span> <span class="n">hci_ev_le_ltk_req</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">random</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
	<span class="n">__le16</span>	<span class="n">ediv</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Advertising report event types */</span>
<span class="cp">#define ADV_IND		0x00</span>
<span class="cp">#define ADV_DIRECT_IND	0x01</span>
<span class="cp">#define ADV_SCAN_IND	0x02</span>
<span class="cp">#define ADV_NONCONN_IND	0x03</span>
<span class="cp">#define ADV_SCAN_RSP	0x04</span>

<span class="cp">#define ADDR_LE_DEV_PUBLIC	0x00</span>
<span class="cp">#define ADDR_LE_DEV_RANDOM	0x01</span>

<span class="cp">#define HCI_EV_LE_ADVERTISING_REPORT	0x02</span>
<span class="k">struct</span> <span class="n">hci_ev_le_advertising_info</span> <span class="p">{</span>
	<span class="n">__u8</span>	 <span class="n">evt_type</span><span class="p">;</span>
	<span class="n">__u8</span>	 <span class="n">bdaddr_type</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>	 <span class="n">length</span><span class="p">;</span>
	<span class="n">__u8</span>	 <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Internal events generated by Bluetooth stack */</span>
<span class="cp">#define HCI_EV_STACK_INTERNAL	0xfd</span>
<span class="k">struct</span> <span class="n">hci_ev_stack_internal</span> <span class="p">{</span>
	<span class="n">__u16</span>    <span class="n">type</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_SI_DEVICE	0x01</span>
<span class="k">struct</span> <span class="n">hci_ev_si_device</span> <span class="p">{</span>
	<span class="n">__u16</span>    <span class="n">event</span><span class="p">;</span>
	<span class="n">__u16</span>    <span class="n">dev_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define HCI_EV_SI_SECURITY	0x02</span>
<span class="k">struct</span> <span class="n">hci_ev_si_security</span> <span class="p">{</span>
	<span class="n">__u16</span>    <span class="n">event</span><span class="p">;</span>
	<span class="n">__u16</span>    <span class="n">proto</span><span class="p">;</span>
	<span class="n">__u16</span>    <span class="n">subproto</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">incoming</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* ---- HCI Packet structures ---- */</span>
<span class="cp">#define HCI_COMMAND_HDR_SIZE 3</span>
<span class="cp">#define HCI_EVENT_HDR_SIZE   2</span>
<span class="cp">#define HCI_ACL_HDR_SIZE     4</span>
<span class="cp">#define HCI_SCO_HDR_SIZE     3</span>

<span class="k">struct</span> <span class="n">hci_command_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">opcode</span><span class="p">;</span>		<span class="cm">/* OCF &amp; OGF */</span>
	<span class="n">__u8</span>	<span class="n">plen</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hci_event_hdr</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">evt</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">plen</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hci_acl_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>		<span class="cm">/* Handle &amp; Flags(PB, BC) */</span>
	<span class="n">__le16</span>	<span class="n">dlen</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">hci_sco_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">handle</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">dlen</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#include &lt;linux/skbuff.h&gt;</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">hci_event_hdr</span> <span class="o">*</span><span class="nf">hci_event_hdr</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">hci_event_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">skb</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">hci_acl_hdr</span> <span class="o">*</span><span class="nf">hci_acl_hdr</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">hci_acl_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">skb</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">hci_sco_hdr</span> <span class="o">*</span><span class="nf">hci_sco_hdr</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">hci_sco_hdr</span> <span class="o">*</span><span class="p">)</span> <span class="n">skb</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Command opcode pack/unpack */</span>
<span class="cp">#define hci_opcode_pack(ogf, ocf)	(__u16) ((ocf &amp; 0x03ff)|(ogf &lt;&lt; 10))</span>
<span class="cp">#define hci_opcode_ogf(op)		(op &gt;&gt; 10)</span>
<span class="cp">#define hci_opcode_ocf(op)		(op &amp; 0x03ff)</span>

<span class="cm">/* ACL handle and flags pack/unpack */</span>
<span class="cp">#define hci_handle_pack(h, f)	(__u16) ((h &amp; 0x0fff)|(f &lt;&lt; 12))</span>
<span class="cp">#define hci_handle(h)		(h &amp; 0x0fff)</span>
<span class="cp">#define hci_flags(h)		(h &gt;&gt; 12)</span>

<span class="cm">/* ---- HCI Sockets ---- */</span>

<span class="cm">/* Socket options */</span>
<span class="cp">#define HCI_DATA_DIR	1</span>
<span class="cp">#define HCI_FILTER	2</span>
<span class="cp">#define HCI_TIME_STAMP	3</span>

<span class="cm">/* CMSG flags */</span>
<span class="cp">#define HCI_CMSG_DIR	0x0001</span>
<span class="cp">#define HCI_CMSG_TSTAMP	0x0002</span>

<span class="k">struct</span> <span class="n">sockaddr_hci</span> <span class="p">{</span>
	<span class="n">sa_family_t</span>    <span class="n">hci_family</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hci_dev</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hci_channel</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define HCI_DEV_NONE	0xffff</span>

<span class="cp">#define HCI_CHANNEL_RAW		0</span>
<span class="cp">#define HCI_CHANNEL_MONITOR	2</span>
<span class="cp">#define HCI_CHANNEL_CONTROL	3</span>

<span class="k">struct</span> <span class="n">hci_filter</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">type_mask</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">event_mask</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">opcode</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_ufilter</span> <span class="p">{</span>
	<span class="n">__u32</span>  <span class="n">type_mask</span><span class="p">;</span>
	<span class="n">__u32</span>  <span class="n">event_mask</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">opcode</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define HCI_FLT_TYPE_BITS	31</span>
<span class="cp">#define HCI_FLT_EVENT_BITS	63</span>
<span class="cp">#define HCI_FLT_OGF_BITS	63</span>
<span class="cp">#define HCI_FLT_OCF_BITS	127</span>

<span class="cm">/* ---- HCI Ioctl requests structures ---- */</span>
<span class="k">struct</span> <span class="n">hci_dev_stats</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">err_rx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">err_tx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">cmd_tx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">evt_rx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">acl_tx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">acl_rx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">sco_tx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">sco_rx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">byte_rx</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">byte_tx</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_dev_info</span> <span class="p">{</span>
	<span class="n">__u16</span> <span class="n">dev_id</span><span class="p">;</span>
	<span class="kt">char</span>  <span class="n">name</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>

	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>

	<span class="n">__u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__u8</span>  <span class="n">type</span><span class="p">;</span>

	<span class="n">__u8</span>  <span class="n">features</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>

	<span class="n">__u32</span> <span class="n">pkt_type</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">link_policy</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">link_mode</span><span class="p">;</span>

	<span class="n">__u16</span> <span class="n">acl_mtu</span><span class="p">;</span>
	<span class="n">__u16</span> <span class="n">acl_pkts</span><span class="p">;</span>
	<span class="n">__u16</span> <span class="n">sco_mtu</span><span class="p">;</span>
	<span class="n">__u16</span> <span class="n">sco_pkts</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">hci_dev_stats</span> <span class="n">stat</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_conn_info</span> <span class="p">{</span>
	<span class="n">__u16</span>    <span class="n">handle</span><span class="p">;</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">type</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">out</span><span class="p">;</span>
	<span class="n">__u16</span>    <span class="n">state</span><span class="p">;</span>
	<span class="n">__u32</span>    <span class="n">link_mode</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_dev_req</span> <span class="p">{</span>
	<span class="n">__u16</span>  <span class="n">dev_id</span><span class="p">;</span>
	<span class="n">__u32</span>  <span class="n">dev_opt</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_dev_list_req</span> <span class="p">{</span>
	<span class="n">__u16</span>  <span class="n">dev_num</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hci_dev_req</span> <span class="n">dev_req</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/* hci_dev_req structures */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_conn_list_req</span> <span class="p">{</span>
	<span class="n">__u16</span>  <span class="n">dev_id</span><span class="p">;</span>
	<span class="n">__u16</span>  <span class="n">conn_num</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">hci_conn_info</span> <span class="n">conn_info</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_conn_info_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">type</span><span class="p">;</span>
	<span class="k">struct</span>   <span class="n">hci_conn_info</span> <span class="n">conn_info</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_auth_info_req</span> <span class="p">{</span>
	<span class="n">bdaddr_t</span> <span class="n">bdaddr</span><span class="p">;</span>
	<span class="n">__u8</span>     <span class="n">type</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hci_inquiry_req</span> <span class="p">{</span>
	<span class="n">__u16</span> <span class="n">dev_id</span><span class="p">;</span>
	<span class="n">__u16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__u8</span>  <span class="n">lap</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__u8</span>  <span class="n">length</span><span class="p">;</span>
	<span class="n">__u8</span>  <span class="n">num_rsp</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define IREQ_CACHE_FLUSH 0x0001</span>

<span class="k">extern</span> <span class="n">bool</span> <span class="n">enable_hs</span><span class="p">;</span>

<span class="cp">#endif </span><span class="cm">/* __HCI_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
