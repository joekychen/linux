<!DOCTYPE html>
<html><head><title>joekychen/linux » include › net › sctp › constants.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>constants.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* SCTP kernel implementation</span>
<span class="cm"> * (C) Copyright IBM Corp. 2001, 2004</span>
<span class="cm"> * Copyright (c) 1999-2000 Cisco, Inc.</span>
<span class="cm"> * Copyright (c) 1999-2001 Motorola, Inc.</span>
<span class="cm"> * Copyright (c) 2001 Intel Corp.</span>
<span class="cm"> *</span>
<span class="cm"> * This file is part of the SCTP kernel implementation</span>
<span class="cm"> *</span>
<span class="cm"> * This SCTP implementation is free software;</span>
<span class="cm"> * you can redistribute it and/or modify it under the terms of</span>
<span class="cm"> * the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2, or (at your option)</span>
<span class="cm"> * any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This SCTP implementation is distributed in the hope that it</span>
<span class="cm"> * will be useful, but WITHOUT ANY WARRANTY; without even the implied</span>
<span class="cm"> *                 ************************</span>
<span class="cm"> * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="cm"> * See the GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with GNU CC; see the file COPYING.  If not, write to</span>
<span class="cm"> * the Free Software Foundation, 59 Temple Place - Suite 330,</span>
<span class="cm"> * Boston, MA 02111-1307, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * Please send any bug reports or fixes you make to the</span>
<span class="cm"> * email address(es):</span>
<span class="cm"> *    lksctp developers &lt;lksctp-developers@lists.sourceforge.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Or submit a bug report through the following website:</span>
<span class="cm"> *    http://www.sf.net/projects/lksctp</span>
<span class="cm"> *</span>
<span class="cm"> * Written or modified by:</span>
<span class="cm"> *   La Monte H.P. Yarroll &lt;piggy@acm.org&gt;</span>
<span class="cm"> *   Karl Knutson          &lt;karl@athena.chicago.il.us&gt;</span>
<span class="cm"> *   Randall Stewart       &lt;randall@stewart.chicago.il.us&gt;</span>
<span class="cm"> *   Ken Morneau           &lt;kmorneau@cisco.com&gt;</span>
<span class="cm"> *   Qiaobing Xie          &lt;qxie1@motorola.com&gt;</span>
<span class="cm"> *   Xingang Guo           &lt;xingang.guo@intel.com&gt;</span>
<span class="cm"> *   Sridhar Samudrala     &lt;samudrala@us.ibm.com&gt;</span>
<span class="cm"> *   Daisy Chang           &lt;daisyc@us.ibm.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Any bugs reported given to us we will try to fix... any fixes shared will</span>
<span class="cm"> * be incorporated into the next SCTP release.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __sctp_constants_h__</span>
<span class="cp">#define __sctp_constants_h__</span>

<span class="cp">#include &lt;linux/sctp.h&gt;</span>
<span class="cp">#include &lt;linux/ipv6.h&gt; </span><span class="cm">/* For ipv6hdr. */</span><span class="cp"></span>
<span class="cp">#include &lt;net/sctp/user.h&gt;</span>
<span class="cp">#include &lt;net/tcp_states.h&gt;  </span><span class="cm">/* For TCP states used in sctp_sock_state_t */</span><span class="cp"></span>

<span class="cm">/* Value used for stream negotiation. */</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_MAX_STREAM</span> <span class="o">=</span> <span class="mh">0xffff</span> <span class="p">};</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_DEFAULT_OUTSTREAMS</span> <span class="o">=</span> <span class="mi">10</span> <span class="p">};</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_DEFAULT_INSTREAMS</span> <span class="o">=</span> <span class="n">SCTP_MAX_STREAM</span> <span class="p">};</span>

<span class="cm">/* Since CIDs are sparse, we need all four of the following</span>
<span class="cm"> * symbols.  CIDs are dense through SCTP_CID_BASE_MAX.</span>
<span class="cm"> */</span>
<span class="cp">#define SCTP_CID_BASE_MAX		SCTP_CID_SHUTDOWN_COMPLETE</span>

<span class="cp">#define SCTP_NUM_BASE_CHUNK_TYPES	(SCTP_CID_BASE_MAX + 1)</span>

<span class="cp">#define SCTP_NUM_ADDIP_CHUNK_TYPES	2</span>

<span class="cp">#define SCTP_NUM_PRSCTP_CHUNK_TYPES	1</span>

<span class="cp">#define SCTP_NUM_AUTH_CHUNK_TYPES	1</span>

<span class="cp">#define SCTP_NUM_CHUNK_TYPES		(SCTP_NUM_BASE_CHUNK_TYPES + \</span>
<span class="cp">					 SCTP_NUM_ADDIP_CHUNK_TYPES +\</span>
<span class="cp">					 SCTP_NUM_PRSCTP_CHUNK_TYPES +\</span>
<span class="cp">					 SCTP_NUM_AUTH_CHUNK_TYPES)</span>

<span class="cm">/* These are the different flavours of event.  */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>

	<span class="n">SCTP_EVENT_T_CHUNK</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_T_TIMEOUT</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_T_OTHER</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_T_PRIMITIVE</span>

<span class="p">}</span> <span class="n">sctp_event_t</span><span class="p">;</span>

<span class="cm">/* As a convenience for the state machine, we append SCTP_EVENT_* and</span>
<span class="cm"> * SCTP_ULP_* to the list of possible chunks.</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_EVENT_TIMEOUT_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_T1_COOKIE</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_T1_INIT</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_T2_SHUTDOWN</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_T3_RTX</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_T4_RTO</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_HEARTBEAT</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_SACK</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_TIMEOUT_AUTOCLOSE</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_event_timeout_t</span><span class="p">;</span>

<span class="cp">#define SCTP_EVENT_TIMEOUT_MAX		SCTP_EVENT_TIMEOUT_AUTOCLOSE</span>
<span class="cp">#define SCTP_NUM_TIMEOUT_TYPES		(SCTP_EVENT_TIMEOUT_MAX + 1)</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_EVENT_NO_PENDING_TSN</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SCTP_EVENT_ICMP_PROTO_UNREACH</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_event_other_t</span><span class="p">;</span>

<span class="cp">#define SCTP_EVENT_OTHER_MAX		SCTP_EVENT_ICMP_PROTO_UNREACH</span>
<span class="cp">#define SCTP_NUM_OTHER_TYPES		(SCTP_EVENT_OTHER_MAX + 1)</span>

<span class="cm">/* These are primitive requests from the ULP.  */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_PRIMITIVE_ASSOCIATE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SCTP_PRIMITIVE_SHUTDOWN</span><span class="p">,</span>
	<span class="n">SCTP_PRIMITIVE_ABORT</span><span class="p">,</span>
	<span class="n">SCTP_PRIMITIVE_SEND</span><span class="p">,</span>
	<span class="n">SCTP_PRIMITIVE_REQUESTHEARTBEAT</span><span class="p">,</span>
	<span class="n">SCTP_PRIMITIVE_ASCONF</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_event_primitive_t</span><span class="p">;</span>

<span class="cp">#define SCTP_EVENT_PRIMITIVE_MAX	SCTP_PRIMITIVE_ASCONF</span>
<span class="cp">#define SCTP_NUM_PRIMITIVE_TYPES	(SCTP_EVENT_PRIMITIVE_MAX + 1)</span>

<span class="cm">/* We define here a utility type for manipulating subtypes.</span>
<span class="cm"> * The subtype constructors all work like this:</span>
<span class="cm"> *</span>
<span class="cm"> * 	sctp_subtype_t foo = SCTP_ST_CHUNK(SCTP_CID_INIT);</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
	<span class="n">sctp_cid_t</span> <span class="n">chunk</span><span class="p">;</span>
	<span class="n">sctp_event_timeout_t</span> <span class="n">timeout</span><span class="p">;</span>
	<span class="n">sctp_event_other_t</span> <span class="n">other</span><span class="p">;</span>
	<span class="n">sctp_event_primitive_t</span> <span class="n">primitive</span><span class="p">;</span>
<span class="p">}</span> <span class="n">sctp_subtype_t</span><span class="p">;</span>

<span class="cp">#define SCTP_SUBTYPE_CONSTRUCTOR(_name, _type, _elt) \</span>
<span class="cp">static inline sctp_subtype_t	\</span>
<span class="cp">SCTP_ST_## _name (_type _arg)		\</span>
<span class="cp">{ sctp_subtype_t _retval; _retval._elt = _arg; return _retval; }</span>

<span class="n">SCTP_SUBTYPE_CONSTRUCTOR</span><span class="p">(</span><span class="n">CHUNK</span><span class="p">,</span>		<span class="n">sctp_cid_t</span><span class="p">,</span>		<span class="n">chunk</span><span class="p">)</span>
<span class="n">SCTP_SUBTYPE_CONSTRUCTOR</span><span class="p">(</span><span class="n">TIMEOUT</span><span class="p">,</span>	<span class="n">sctp_event_timeout_t</span><span class="p">,</span>	<span class="n">timeout</span><span class="p">)</span>
<span class="n">SCTP_SUBTYPE_CONSTRUCTOR</span><span class="p">(</span><span class="n">OTHER</span><span class="p">,</span>		<span class="n">sctp_event_other_t</span><span class="p">,</span>	<span class="n">other</span><span class="p">)</span>
<span class="n">SCTP_SUBTYPE_CONSTRUCTOR</span><span class="p">(</span><span class="n">PRIMITIVE</span><span class="p">,</span>	<span class="n">sctp_event_primitive_t</span><span class="p">,</span>	<span class="n">primitive</span><span class="p">)</span>


<span class="cp">#define sctp_chunk_is_data(a) (a-&gt;chunk_hdr-&gt;type == SCTP_CID_DATA)</span>

<span class="cm">/* Calculate the actual data size in a data chunk */</span>
<span class="cp">#define SCTP_DATA_SNDSIZE(c) ((int)((unsigned long)(c-&gt;chunk_end)\</span>
<span class="cp">		       		- (unsigned long)(c-&gt;chunk_hdr)\</span>
<span class="cp">				- sizeof(sctp_data_chunk_t)))</span>

<span class="cm">/* Internal error codes */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>

	<span class="n">SCTP_IERROR_NO_ERROR</span>	        <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_BASE</span>		<span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_NO_COOKIE</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_BAD_SIG</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_STALE_COOKIE</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_NOMEM</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_MALFORMED</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_BAD_TAG</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_BIG_GAP</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_DUP_TSN</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_HIGH_TSN</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_IGNORE_TSN</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_NO_DATA</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_BAD_STREAM</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_BAD_PORTS</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_AUTH_BAD_HMAC</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_AUTH_BAD_KEYID</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_PROTO_VIOLATION</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_ERROR</span><span class="p">,</span>
	<span class="n">SCTP_IERROR_ABORT</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_ierror_t</span><span class="p">;</span>



<span class="cm">/* SCTP state defines for internal state machine */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>

	<span class="n">SCTP_STATE_CLOSED</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SCTP_STATE_COOKIE_WAIT</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">SCTP_STATE_COOKIE_ECHOED</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">SCTP_STATE_ESTABLISHED</span>		<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">SCTP_STATE_SHUTDOWN_PENDING</span>	<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">SCTP_STATE_SHUTDOWN_SENT</span>	<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">SCTP_STATE_SHUTDOWN_RECEIVED</span>	<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">SCTP_STATE_SHUTDOWN_ACK_SENT</span>	<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>

<span class="p">}</span> <span class="n">sctp_state_t</span><span class="p">;</span>

<span class="cp">#define SCTP_STATE_MAX			SCTP_STATE_SHUTDOWN_ACK_SENT</span>
<span class="cp">#define SCTP_STATE_NUM_STATES		(SCTP_STATE_MAX + 1)</span>

<span class="cm">/* These are values for sk-&gt;state.</span>
<span class="cm"> * For a UDP-style SCTP socket, the states are defined as follows</span>
<span class="cm"> * - A socket in SCTP_SS_CLOSED state indicates that it is not willing to</span>
<span class="cm"> *   accept new associations, but it can initiate the creation of new ones.</span>
<span class="cm"> * - A socket in SCTP_SS_LISTENING state indicates that it is willing to</span>
<span class="cm"> *   accept new  associations and can initiate the creation of new ones.</span>
<span class="cm"> * - A socket in SCTP_SS_ESTABLISHED state indicates that it is a peeled off</span>
<span class="cm"> *   socket with one association.</span>
<span class="cm"> * For a TCP-style SCTP socket, the states are defined as follows</span>
<span class="cm"> * - A socket in SCTP_SS_CLOSED state indicates that it is not willing to</span>
<span class="cm"> *   accept new associations, but it can initiate the creation of new ones.</span>
<span class="cm"> * - A socket in SCTP_SS_LISTENING state indicates that it is willing to</span>
<span class="cm"> *   accept new associations, but cannot initiate the creation of new ones.</span>
<span class="cm"> * - A socket in SCTP_SS_ESTABLISHED state indicates that it has a single </span>
<span class="cm"> *   association.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_SS_CLOSED</span>         <span class="o">=</span> <span class="n">TCP_CLOSE</span><span class="p">,</span>
	<span class="n">SCTP_SS_LISTENING</span>      <span class="o">=</span> <span class="n">TCP_LISTEN</span><span class="p">,</span>
	<span class="n">SCTP_SS_ESTABLISHING</span>   <span class="o">=</span> <span class="n">TCP_SYN_SENT</span><span class="p">,</span>
	<span class="n">SCTP_SS_ESTABLISHED</span>    <span class="o">=</span> <span class="n">TCP_ESTABLISHED</span><span class="p">,</span>
	<span class="n">SCTP_SS_CLOSING</span>        <span class="o">=</span> <span class="n">TCP_CLOSING</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_sock_state_t</span><span class="p">;</span>

<span class="cm">/* These functions map various type to printable names.  */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">sctp_cname</span><span class="p">(</span><span class="k">const</span> <span class="n">sctp_subtype_t</span><span class="p">);</span>	<span class="cm">/* chunk types */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">sctp_oname</span><span class="p">(</span><span class="k">const</span> <span class="n">sctp_subtype_t</span><span class="p">);</span>	<span class="cm">/* other events */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">sctp_tname</span><span class="p">(</span><span class="k">const</span> <span class="n">sctp_subtype_t</span><span class="p">);</span>	<span class="cm">/* timeouts */</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">sctp_pname</span><span class="p">(</span><span class="k">const</span> <span class="n">sctp_subtype_t</span><span class="p">);</span>	<span class="cm">/* primitives */</span>

<span class="cm">/* This is a table of printable names of sctp_state_t&#39;s.  */</span>
<span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">sctp_state_tbl</span><span class="p">[];</span>
<span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">sctp_evttype_tbl</span><span class="p">[];</span>
<span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="k">const</span> <span class="n">sctp_status_tbl</span><span class="p">[];</span>

<span class="cm">/* Maximum chunk length considering padding requirements. */</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_MAX_CHUNK_LEN</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">__u32</span><span class="p">))</span> <span class="p">};</span>

<span class="cm">/* Encourage Cookie-Echo bundling by pre-fragmenting chunks a little</span>
<span class="cm"> * harder (until reaching ESTABLISHED state).</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_ARBITRARY_COOKIE_ECHO_LEN</span> <span class="o">=</span> <span class="mi">200</span> <span class="p">};</span>

<span class="cm">/* Guess at how big to make the TSN mapping array.</span>
<span class="cm"> * We guarantee that we can handle at least this big a gap between the</span>
<span class="cm"> * cumulative ACK and the highest TSN.  In practice, we can often</span>
<span class="cm"> * handle up to twice this value.</span>
<span class="cm"> *</span>
<span class="cm"> * NEVER make this more than 32767 (2^15-1).  The Gap Ack Blocks in a</span>
<span class="cm"> * SACK (see  section 3.3.4) are only 16 bits, so 2*SCTP_TSN_MAP_SIZE</span>
<span class="cm"> * must be less than 65535 (2^16 - 1), or we will have overflow</span>
<span class="cm"> * problems creating SACK&#39;s.</span>
<span class="cm"> */</span>
<span class="cp">#define SCTP_TSN_MAP_INITIAL BITS_PER_LONG</span>
<span class="cp">#define SCTP_TSN_MAP_INCREMENT SCTP_TSN_MAP_INITIAL</span>
<span class="cp">#define SCTP_TSN_MAP_SIZE 4096</span>

<span class="cm">/* We will not record more than this many duplicate TSNs between two</span>
<span class="cm"> * SACKs.  The minimum PMTU is 576.  Remove all the headers and there</span>
<span class="cm"> * is enough room for 131 duplicate reports.  Round down to the</span>
<span class="cm"> * nearest power of 2.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_MIN_PMTU</span> <span class="o">=</span> <span class="mi">576</span> <span class="p">};</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_MAX_DUP_TSNS</span> <span class="o">=</span> <span class="mi">16</span> <span class="p">};</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_MAX_GABS</span> <span class="o">=</span> <span class="mi">16</span> <span class="p">};</span>

<span class="cm">/* Heartbeat interval - 30 secs */</span>
<span class="cp">#define SCTP_DEFAULT_TIMEOUT_HEARTBEAT	(30*1000)</span>

<span class="cm">/* Delayed sack timer - 200ms */</span>
<span class="cp">#define SCTP_DEFAULT_TIMEOUT_SACK	(200)</span>

<span class="cm">/* RTO.Initial              - 3  seconds</span>
<span class="cm"> * RTO.Min                  - 1  second</span>
<span class="cm"> * RTO.Max                  - 60 seconds</span>
<span class="cm"> * RTO.Alpha                - 1/8</span>
<span class="cm"> * RTO.Beta                 - 1/4</span>
<span class="cm"> */</span>
<span class="cp">#define SCTP_RTO_INITIAL	(3 * 1000)</span>
<span class="cp">#define SCTP_RTO_MIN		(1 * 1000)</span>
<span class="cp">#define SCTP_RTO_MAX		(60 * 1000)</span>

<span class="cp">#define SCTP_RTO_ALPHA          3   </span><span class="cm">/* 1/8 when converted to right shifts. */</span><span class="cp"></span>
<span class="cp">#define SCTP_RTO_BETA           2   </span><span class="cm">/* 1/4 when converted to right shifts. */</span><span class="cp"></span>

<span class="cm">/* Maximum number of new data packets that can be sent in a burst.  */</span>
<span class="cp">#define SCTP_DEFAULT_MAX_BURST		4</span>

<span class="cp">#define SCTP_CLOCK_GRANULARITY	1	</span><span class="cm">/* 1 jiffy */</span><span class="cp"></span>

<span class="cp">#define SCTP_DEFAULT_COOKIE_LIFE	(60 * 1000) </span><span class="cm">/* 60 seconds */</span><span class="cp"></span>

<span class="cp">#define SCTP_DEFAULT_MINWINDOW	1500	</span><span class="cm">/* default minimum rwnd size */</span><span class="cp"></span>
<span class="cp">#define SCTP_DEFAULT_MAXWINDOW	65535	</span><span class="cm">/* default rwnd size */</span><span class="cp"></span>
<span class="cp">#define SCTP_DEFAULT_RWND_SHIFT  4	</span><span class="cm">/* by default, update on 1/16 of</span>
<span class="cm">					 * rcvbuf, which is 1/8 of initial</span>
<span class="cm">					 * window</span>
<span class="cm">					 */</span><span class="cp"></span>
<span class="cp">#define SCTP_DEFAULT_MAXSEGMENT 1500	</span><span class="cm">/* MTU size, this is the limit</span>
<span class="cm">                                         * to which we will raise the P-MTU.</span>
<span class="cm">					 */</span><span class="cp"></span>
<span class="cp">#define SCTP_DEFAULT_MINSEGMENT 512	</span><span class="cm">/* MTU size ... if no mtu disc */</span><span class="cp"></span>
<span class="cp">#define SCTP_HOW_MANY_SECRETS 2		</span><span class="cm">/* How many secrets I keep */</span><span class="cp"></span>
<span class="cp">#define SCTP_SECRET_SIZE 32		</span><span class="cm">/* Number of octets in a 256 bits. */</span><span class="cp"></span>

<span class="cp">#define SCTP_SIGNATURE_SIZE 20	        </span><span class="cm">/* size of a SLA-1 signature */</span><span class="cp"></span>

<span class="cp">#define SCTP_COOKIE_MULTIPLE 32 </span><span class="cm">/* Pad out our cookie to make our hash</span>
<span class="cm">				 * functions simpler to write.</span>
<span class="cm">				 */</span><span class="cp"></span>

<span class="cp">#if defined (CONFIG_SCTP_HMAC_MD5)</span>
<span class="cp">#define SCTP_COOKIE_HMAC_ALG &quot;hmac(md5)&quot;</span>
<span class="cp">#elif defined (CONFIG_SCTP_HMAC_SHA1)</span>
<span class="cp">#define SCTP_COOKIE_HMAC_ALG &quot;hmac(sha1)&quot;</span>
<span class="cp">#else</span>
<span class="cp">#define SCTP_COOKIE_HMAC_ALG NULL</span>
<span class="cp">#endif</span>

<span class="cm">/* These return values describe the success or failure of a number of</span>
<span class="cm"> * routines which form the lower interface to SCTP_outqueue.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_XMIT_OK</span><span class="p">,</span>
	<span class="n">SCTP_XMIT_PMTU_FULL</span><span class="p">,</span>
	<span class="n">SCTP_XMIT_RWND_FULL</span><span class="p">,</span>
	<span class="n">SCTP_XMIT_NAGLE_DELAY</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_xmit_t</span><span class="p">;</span>

<span class="cm">/* These are the commands for manipulating transports.  */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_TRANSPORT_UP</span><span class="p">,</span>
	<span class="n">SCTP_TRANSPORT_DOWN</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_transport_cmd_t</span><span class="p">;</span>

<span class="cm">/* These are the address scopes defined mainly for IPv4 addresses</span>
<span class="cm"> * based on draft of SCTP IPv4 scoping &lt;draft-stewart-tsvwg-sctp-ipv4-00.txt&gt;.</span>
<span class="cm"> * These scopes are hopefully generic enough to be used on scoping both</span>
<span class="cm"> * IPv4 and IPv6 addresses in SCTP.</span>
<span class="cm"> * At this point, the IPv6 scopes will be mapped to these internal scopes</span>
<span class="cm"> * as much as possible.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_SCOPE_GLOBAL</span><span class="p">,</span>		<span class="cm">/* IPv4 global addresses */</span>
	<span class="n">SCTP_SCOPE_PRIVATE</span><span class="p">,</span>		<span class="cm">/* IPv4 private addresses */</span>
	<span class="n">SCTP_SCOPE_LINK</span><span class="p">,</span>		<span class="cm">/* IPv4 link local address */</span>
	<span class="n">SCTP_SCOPE_LOOPBACK</span><span class="p">,</span>		<span class="cm">/* IPv4 loopback address */</span>
	<span class="n">SCTP_SCOPE_UNUSABLE</span><span class="p">,</span>		<span class="cm">/* IPv4 unusable addresses */</span>
<span class="p">}</span> <span class="n">sctp_scope_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_SCOPE_POLICY_DISABLE</span><span class="p">,</span>	<span class="cm">/* Disable IPv4 address scoping */</span>
	<span class="n">SCTP_SCOPE_POLICY_ENABLE</span><span class="p">,</span>	<span class="cm">/* Enable IPv4 address scoping */</span>
	<span class="n">SCTP_SCOPE_POLICY_PRIVATE</span><span class="p">,</span>	<span class="cm">/* Follow draft but allow IPv4 private addresses */</span>
	<span class="n">SCTP_SCOPE_POLICY_LINK</span><span class="p">,</span>		<span class="cm">/* Follow draft but allow IPv4 link local addresses */</span>
<span class="p">}</span> <span class="n">sctp_scope_policy_t</span><span class="p">;</span>

<span class="cm">/* Based on IPv4 scoping &lt;draft-stewart-tsvwg-sctp-ipv4-00.txt&gt;,</span>
<span class="cm"> * SCTP IPv4 unusable addresses: 0.0.0.0/8, 224.0.0.0/4, 198.18.0.0/24,</span>
<span class="cm"> * 192.88.99.0/24.</span>
<span class="cm"> * Also, RFC 8.4, non-unicast addresses are not considered valid SCTP</span>
<span class="cm"> * addresses.</span>
<span class="cm"> */</span>
<span class="cp">#define IS_IPV4_UNUSABLE_ADDRESS(a)	    \</span>
<span class="cp">	((htonl(INADDR_BROADCAST) == a) ||  \</span>
<span class="cp">	 ipv4_is_multicast(a) ||	    \</span>
<span class="cp">	 ipv4_is_zeronet(a) ||		    \</span>
<span class="cp">	 ipv4_is_test_198(a) ||		    \</span>
<span class="cp">	 ipv4_is_anycast_6to4(a))</span>

<span class="cm">/* Flags used for the bind address copy functions.  */</span>
<span class="cp">#define SCTP_ADDR6_ALLOWED	0x00000001	</span><span class="cm">/* IPv6 address is allowed by</span>
<span class="cm">						   local sock family */</span><span class="cp"></span>
<span class="cp">#define SCTP_ADDR4_PEERSUPP	0x00000002	</span><span class="cm">/* IPv4 address is supported by</span>
<span class="cm">						   peer */</span><span class="cp"></span>
<span class="cp">#define SCTP_ADDR6_PEERSUPP	0x00000004	</span><span class="cm">/* IPv6 address is supported by</span>
<span class="cm">						   peer */</span><span class="cp"></span>

<span class="cm">/* Reasons to retransmit. */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_RTXR_T3_RTX</span><span class="p">,</span>
	<span class="n">SCTP_RTXR_FAST_RTX</span><span class="p">,</span>
	<span class="n">SCTP_RTXR_PMTUD</span><span class="p">,</span>
	<span class="n">SCTP_RTXR_T1_RTX</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_retransmit_reason_t</span><span class="p">;</span>

<span class="cm">/* Reasons to lower cwnd. */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_LOWER_CWND_T3_RTX</span><span class="p">,</span>
	<span class="n">SCTP_LOWER_CWND_FAST_RTX</span><span class="p">,</span>
	<span class="n">SCTP_LOWER_CWND_ECNE</span><span class="p">,</span>
	<span class="n">SCTP_LOWER_CWND_INACTIVE</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_lower_cwnd_t</span><span class="p">;</span>


<span class="cm">/* SCTP-AUTH Necessary constants */</span>

<span class="cm">/* SCTP-AUTH, Section 3.3</span>
<span class="cm"> *</span>
<span class="cm"> *  The following Table 2 shows the currently defined values for HMAC</span>
<span class="cm"> *  identifiers.</span>
<span class="cm"> *</span>
<span class="cm"> *  +-----------------+--------------------------+</span>
<span class="cm"> *  | HMAC Identifier | Message Digest Algorithm |</span>
<span class="cm"> *  +-----------------+--------------------------+</span>
<span class="cm"> *  | 0               | Reserved                 |</span>
<span class="cm"> *  | 1               | SHA-1 defined in [8]     |</span>
<span class="cm"> *  | 2               | Reserved                 |</span>
<span class="cm"> *  | 3               | SHA-256 defined in [8]   |</span>
<span class="cm"> *  +-----------------+--------------------------+</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_AUTH_HMAC_ID_RESERVED_0</span><span class="p">,</span>
	<span class="n">SCTP_AUTH_HMAC_ID_SHA1</span><span class="p">,</span>
	<span class="n">SCTP_AUTH_HMAC_ID_RESERVED_2</span><span class="p">,</span>
<span class="cp">#if defined (CONFIG_CRYPTO_SHA256) || defined (CONFIG_CRYPTO_SHA256_MODULE)</span>
	<span class="n">SCTP_AUTH_HMAC_ID_SHA256</span><span class="p">,</span>
<span class="cp">#endif</span>
	<span class="n">__SCTP_AUTH_HMAC_MAX</span>
<span class="p">};</span>

<span class="cp">#define SCTP_AUTH_HMAC_ID_MAX	__SCTP_AUTH_HMAC_MAX - 1</span>
<span class="cp">#define SCTP_AUTH_NUM_HMACS 	__SCTP_AUTH_HMAC_MAX</span>
<span class="cp">#define SCTP_SHA1_SIG_SIZE 20</span>
<span class="cp">#define SCTP_SHA256_SIG_SIZE 32</span>

<span class="cm">/*  SCTP-AUTH, Section 3.2</span>
<span class="cm"> *     The chunk types for INIT, INIT-ACK, SHUTDOWN-COMPLETE and AUTH chunks</span>
<span class="cm"> *     MUST NOT be listed in the CHUNKS parameter</span>
<span class="cm"> */</span>
<span class="cp">#define SCTP_NUM_NOAUTH_CHUNKS	4</span>
<span class="cp">#define SCTP_AUTH_MAX_CHUNKS	(SCTP_NUM_CHUNK_TYPES - SCTP_NUM_NOAUTH_CHUNKS)</span>

<span class="cm">/* SCTP-AUTH Section 6.1</span>
<span class="cm"> * The RANDOM parameter MUST contain a 32 byte random number.</span>
<span class="cm"> */</span>
<span class="cp">#define SCTP_AUTH_RANDOM_LENGTH 32</span>

<span class="cp">#endif </span><span class="cm">/* __sctp_constants_h__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
