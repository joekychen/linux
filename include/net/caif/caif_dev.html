<!DOCTYPE html>
<html><head><title>joekychen/linux » include › net › caif › caif_dev.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>caif_dev.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) ST-Ericsson AB 2010</span>
<span class="cm"> * Author:	Sjur Brendeland/ sjur.brandeland@stericsson.com</span>
<span class="cm"> * License terms: GNU General Public License (GPL) version 2</span>
<span class="cm"> */</span>

<span class="cp">#ifndef CAIF_DEV_H_</span>
<span class="cp">#define CAIF_DEV_H_</span>

<span class="cp">#include &lt;net/caif/caif_layer.h&gt;</span>
<span class="cp">#include &lt;net/caif/cfcnfg.h&gt;</span>
<span class="cp">#include &lt;net/caif/caif_device.h&gt;</span>
<span class="cp">#include &lt;linux/caif/caif_socket.h&gt;</span>
<span class="cp">#include &lt;linux/if.h&gt;</span>
<span class="cp">#include &lt;linux/net.h&gt;</span>

<span class="cm">/**</span>
<span class="cm"> * struct caif_param - CAIF parameters.</span>
<span class="cm"> * @size:	Length of data</span>
<span class="cm"> * @data:	Binary Data Blob</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">caif_param</span> <span class="p">{</span>
	<span class="n">u16</span>  <span class="n">size</span><span class="p">;</span>
	<span class="n">u8</span>   <span class="n">data</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct caif_connect_request - Request data for CAIF channel setup.</span>
<span class="cm"> * @protocol:		Type of CAIF protocol to use (at, datagram etc)</span>
<span class="cm"> * @sockaddr:		Socket address to connect.</span>
<span class="cm"> * @priority:		Priority of the connection.</span>
<span class="cm"> * @link_selector:	Link selector (high bandwidth or low latency)</span>
<span class="cm"> * @ifindex:		kernel index of the interface.</span>
<span class="cm"> * @param:		Connect Request parameters (CAIF_SO_REQ_PARAM).</span>
<span class="cm"> *</span>
<span class="cm"> * This struct is used when connecting a CAIF channel.</span>
<span class="cm"> * It contains all CAIF channel configuration options.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">caif_connect_request</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">caif_protocol_type</span> <span class="n">protocol</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sockaddr_caif</span> <span class="n">sockaddr</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">caif_channel_priority</span> <span class="n">priority</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">caif_link_selector</span> <span class="n">link_selector</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ifindex</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">caif_param</span> <span class="n">param</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * caif_connect_client - Connect a client to CAIF Core Stack.</span>
<span class="cm"> * @config:		Channel setup parameters, specifying what address</span>
<span class="cm"> *			to connect on the Modem.</span>
<span class="cm"> * @client_layer:	User implementation of client layer. This layer</span>
<span class="cm"> *			MUST have receive and control callback functions</span>
<span class="cm"> *			implemented.</span>
<span class="cm"> * @ifindex:		Link layer interface index used for this connection.</span>
<span class="cm"> * @headroom:		Head room needed by CAIF protocol.</span>
<span class="cm"> * @tailroom:		Tail room needed by CAIF protocol.</span>
<span class="cm"> *</span>
<span class="cm"> * This function connects a CAIF channel. The Client must implement</span>
<span class="cm"> * the struct cflayer. This layer represents the Client layer and holds</span>
<span class="cm"> * receive functions and control callback functions. Control callback</span>
<span class="cm"> * function will receive information about connect/disconnect responses,</span>
<span class="cm"> * flow control etc (see enum caif_control).</span>
<span class="cm"> * E.g. CAIF Socket will call this function for each socket it connects</span>
<span class="cm"> * and have one client_layer instance for each socket.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">caif_connect_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">net</span> <span class="o">*</span><span class="n">net</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">caif_connect_request</span> <span class="o">*</span><span class="n">conn_req</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">cflayer</span> <span class="o">*</span><span class="n">client_layer</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">ifindex</span><span class="p">,</span>
			<span class="kt">int</span> <span class="o">*</span><span class="n">headroom</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">tailroom</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * caif_disconnect_client - Disconnects a client from the CAIF stack.</span>
<span class="cm"> *</span>
<span class="cm"> * @client_layer: Client layer to be disconnected.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">caif_disconnect_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">net</span> <span class="o">*</span><span class="n">net</span><span class="p">,</span> <span class="k">struct</span> <span class="n">cflayer</span> <span class="o">*</span><span class="n">client_layer</span><span class="p">);</span>


<span class="cm">/**</span>
<span class="cm"> * caif_client_register_refcnt - register ref-count functions provided by client.</span>
<span class="cm"> *</span>
<span class="cm"> * @adapt_layer: Client layer using CAIF Stack.</span>
<span class="cm"> * @hold:	Function provided by client layer increasing ref-count</span>
<span class="cm"> * @put:	Function provided by client layer decreasing ref-count</span>
<span class="cm"> *</span>
<span class="cm"> * Client of the CAIF Stack must register functions for reference counting.</span>
<span class="cm"> * These functions are called by the CAIF Stack for every upstream packet,</span>
<span class="cm"> * and must therefore be implemented efficiently.</span>
<span class="cm"> *</span>
<span class="cm"> * Client should call caif_free_client when reference count degrease to zero.</span>
<span class="cm"> */</span>

<span class="kt">void</span> <span class="n">caif_client_register_refcnt</span><span class="p">(</span><span class="k">struct</span> <span class="n">cflayer</span> <span class="o">*</span><span class="n">adapt_layer</span><span class="p">,</span>
					<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">hold</span><span class="p">)(</span><span class="k">struct</span> <span class="n">cflayer</span> <span class="o">*</span><span class="n">lyr</span><span class="p">),</span>
					<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">put</span><span class="p">)(</span><span class="k">struct</span> <span class="n">cflayer</span> <span class="o">*</span><span class="n">lyr</span><span class="p">));</span>
<span class="cm">/**</span>
<span class="cm"> * caif_free_client - Free memory used to manage the client in the CAIF Stack.</span>
<span class="cm"> *</span>
<span class="cm"> * @client_layer: Client layer to be removed.</span>
<span class="cm"> *</span>
<span class="cm"> * This function must be called from client layer in order to free memory.</span>
<span class="cm"> * Caller must guarantee that no packets are in flight upstream when calling</span>
<span class="cm"> * this function.</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="n">caif_free_client</span><span class="p">(</span><span class="k">struct</span> <span class="n">cflayer</span> <span class="o">*</span><span class="n">adap_layer</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * struct caif_enroll_dev - Enroll a net-device as a CAIF Link layer</span>
<span class="cm"> * @dev:		Network device to enroll.</span>
<span class="cm"> * @caifdev:		Configuration information from CAIF Link Layer</span>
<span class="cm"> * @link_support:	Link layer support layer</span>
<span class="cm"> * @head_room:		Head room needed by link support layer</span>
<span class="cm"> * @layer:		Lowest layer in CAIF stack</span>
<span class="cm"> * @rcv_fun:		Receive function for CAIF stack.</span>
<span class="cm"> *</span>
<span class="cm"> * This function enroll a CAIF link layer into CAIF Stack and</span>
<span class="cm"> * expects the interface to be able to handle CAIF payload.</span>
<span class="cm"> * The link_support layer is used to add any Link Layer specific</span>
<span class="cm"> * framing.</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="n">caif_enroll_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">caif_dev_common</span> <span class="o">*</span><span class="n">caifdev</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">cflayer</span> <span class="o">*</span><span class="n">link_support</span><span class="p">,</span> <span class="kt">int</span> <span class="n">head_room</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">cflayer</span> <span class="o">**</span><span class="n">layer</span><span class="p">,</span> <span class="kt">int</span> <span class="p">(</span><span class="o">**</span><span class="n">rcv_func</span><span class="p">)(</span>
				<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">packet_type</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="p">));</span>

<span class="cp">#endif </span><span class="cm">/* CAIF_DEV_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
