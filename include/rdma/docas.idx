f | ib_pack.h | s | 8.0K | 240 | Eli Cohen | eli@dev.mellanox.co.il | 1288027239 |  | IB/core: Add VLAN support for IBoE  Add 802.1q VLAN support to IBoE. The VLAN tag is encoded within the GID derived from a link local address in the following way:      GID[11] GID[12] contain the VLAN ID when the GID contains a VLAN.  The 3 bits user priority field of the packets are identical to the 3 bits of the SL.  In case of rdma_cm apps, the TOS field is used to generate the SL field by doing a shift right of 5 bits effectively taking to 3 MS bits of the TOS field.  Signed-off-by: Eli Cohen <eli@mellanox.co.il> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | ib_user_cm.h | s | 6.4K | 288 | Roland Dreier | roland@purestorage.com | 1306356383 |  | RDMA: Update exported headers list  Various RDMA headers are intended to be exported to userspace, so add them to the headers-y list.  Add a (strictly speaking, superfluous) include of <linux/types.h> to avoid a headers_check warning.  Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_fmr_pool.h | s | 3.4K | 82 | Dotan Barak | dotanba@gmail.com | 1216104524 |  | RDMA: Improve include file coding style  Remove subversion $Id lines and improve readability by fixing other coding style problems pointed out by checkpatch.pl.  Signed-off-by: Dotan Barak <dotanba@gmail.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | rdma_cm_ib.h | s | 2.1K | 49 | Sean Hefty | sean.hefty@intel.com | 1216104523 |  | RDMA: Fix license text  The license text for several files references a third software license that was inadvertently copied in.  Update the license to what was intended.  This update was based on a request from HP.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | rdma_user_cm.h | s | 4.9K | 215 | Sean Hefty | sean.hefty@intel.com | 1318524036 |  | RDMA/ucm: Allow user to specify QP type when creating id  Allow the user to indicate the QP type separately from the port space when allocating an rdma_cm_id.  With RDMA_PS_IB, there is no longer a 1:1 relationship between the QP type and port space, so we need to switch on the QP type to select between UD and connected QPs.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | rdma_cm.h | s | 11K | 328 | Sean Hefty | sean.hefty@intel.com | 1318523992 |  | RDMA/cm: Define new RDMA port space specific to IB  Add RDMA_PS_IB.  XRC QP types will use the IB port space when operating over the RDMA CM.  For the 'IP protocol' field value, we select 0x3F, which is listed as being for 'any local network'.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_cm.h | s | 18K | 543 | Sean Hefty | sean.hefty@intel.com | 1325697465 |  | rdma/core: Fix sparse warnings  Clean up sparse warnings in the rdma core layer.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_pma.h | s | 5.4K | 142 | Or Gerlitz | ogerlitz@mellanox.com | 1311048275 |  | IB/pma: Add include file for IBA performance counters definitions  Move the various definitions and mad structures needed for software implementation of IBA PM agent from the ipath and qib drivers into a single include file, which in turn could be used by more consumers.  Signed-off-by: Or Gerlitz <ogerlitz@mellanox.co.il> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_sa.h | s | 14K | 357 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ib_smi.h | s | 4.3K | 119 | Harvey Harrison | harvey.harrison@gmail.com | 1232241117 |  | IB: Remove __constant_{endian} uses  The base versions handle constant folding just fine, use them directly.  The replacements are OK in the include/ files as they are not exported to userspace so we don't need the __ prefixed versions.  This patch does not affect code generation at all.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | ib_umem.h | s | 2.6K | 71 | Arthur Kepner | akepner@sgi.com | 1209481572 |  | IB: expand ib_umem_get() prototype  Add a new parameter, dmasync, to the ib_umem_get() prototype.  Use dmasync = 1 when mapping user-allocated CQs with ib_umem_get().  Signed-off-by: Arthur Kepner <akepner@sgi.com> Cc: Tony Luck <tony.luck@intel.com> Cc: Jesse Barnes <jbarnes@virtuousgeek.org> Cc: Jes Sorensen <jes@sgi.com> Cc: Randy Dunlap <randy.dunlap@oracle.com> Cc: Roland Dreier <rdreier@cisco.com> Cc: James Bottomley <James.Bottomley@HansenPartnership.com> Cc: David Miller <davem@davemloft.net> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Grant Grundler <grundler@parisc-linux.org> Cc: Michael Ellerman <michael@ellerman.id.au> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ib_user_mad.h | s | 7.0K | 189 | Dotan Barak | dotanba@gmail.com | 1216104524 |  | RDMA: Improve include file coding style  Remove subversion $Id lines and improve readability by fixing other coding style problems pointed out by checkpatch.pl.  Signed-off-by: Dotan Barak <dotanba@gmail.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | ib_verbs.h | s | 62K | 1977 | Roland Dreier | roland@purestorage.com | 1337616047 |  | Merge branches 'core', 'cxgb4', 'ipath', 'iser', 'lockdep', 'mlx4', 'nes', 'ocrdma', 'qib' and 'raw-qp' into for-linus
f | ib_user_verbs.h | s | 14K | 659 | Sean Hefty | sean.hefty@intel.com | 1318524656 |  | RDMA/uverbs: Export ib_open_qp() capability to user space  Allow processes that share the same XRC domain to open an existing shareable QP.  This permits those processes to receive events on the shared QP and transfer ownership, so that any process may modify the QP.  The latter allows the creating process to exit, while a remaining process can still transition it for path migration purposes.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_user_sa.h | s | 2.2K | 70 | Sean Hefty | sean.hefty@intel.com | 1258392633 |  | RDMA/ucma: Add option to manually set IB path  Export rdma_set_ib_paths to user space to allow applications to manually set the IB path used for connections.  This allows alternative ways for a user space application or library to obtain path record information, including retrieving path information from cached data, avoiding direct interaction with the IB SA. The IB SA is a single, centralized entity that can limit scaling on large clusters running MPI applications.  Future changes to the rdma cm can expand on this framework to support the full range of features allowed by the IB CM, such as separate forward and reverse paths and APM.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Reviewed-By: Jason Gunthorpe <jgunthorpe@obsidianresearch.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | Kbuild | g | 158B |  | Roland Dreier | roland@purestorage.com | 1306356383 |  | RDMA: Update exported headers list  Various RDMA headers are intended to be exported to userspace, so add them to the headers-y list.  Add a (strictly speaking, superfluous) include of <linux/types.h> to avoid a headers_check warning.  Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_mad.h | s | 22K | 604 | Jack Morgenstein | jackm@dev.mellanox.co.il | 1337386571 |  | IB/core: Fix IB_SA_COMP_MASK macro  It needs parentheses around the argument, so that it can be used with complex arguments (e.g., "n+5").  Signed-off-by: Jack Morgenstein <jackm@dev.mellanox.co.il> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | rdma_netlink.h | s | 2.2K | 77 | Nir Muchtar | nirm@voltaire.com | 1306356383 |  | RDMA/cma: Add support for netlink statistics export  Add callbacks and data types for statistics export of all current devices/ids.  The schema for RDMA CM is a series of netlink messages. Each one contains an rdma_cm_stat struct.  Additionally, two netlink attributes are created for the addresses for each message (if applicable).  Their types used are: RDMA_NL_RDMA_CM_ATTR_SRC_ADDR (The source address for this ID) RDMA_NL_RDMA_CM_ATTR_DST_ADDR (The destination address for this ID) sockaddr_* structs are encapsulated within these attributes.  In other words, every transaction contains a series of messages like:  -------message 1------- struct rdma_cm_id_stats {        __u32 qp_num;        __u32 bound_dev_if;        __u32 port_space;        __s32 pid;        __u8 cm_state;        __u8 node_type;        __u8 port_num;        __u8 reserved; } RDMA_NL_RDMA_CM_ATTR_SRC_ADDR attribute - contains the source address RDMA_NL_RDMA_CM_ATTR_DST_ADDR attribute - contains the destination address -------end 1------- -------message 2------- struct rdma_cm_id_stats RDMA_NL_RDMA_CM_ATTR_SRC_ADDR attribute RDMA_NL_RDMA_CM_ATTR_DST_ADDR attribute -------end 2-------  Signed-off-by: Nir Muchtar <nirm@voltaire.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_addr.h | s | 8.2K | 248 | Sean Hefty | sean.hefty@intel.com | 1325697465 |  | rdma/core: Fix sparse warnings  Clean up sparse warnings in the rdma core layer.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_marshall.h | s | 2.0K | 46 | Sean Hefty | sean.hefty@intel.com | 1165953022 |  | RDMA/cma: Export rdma cm interface to userspace  Export the rdma cm interfaces to userspace via a misc device.  Signed-off-by: Sean Hefty <sean.hefty@intel.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
f | iw_cm.h | s | 8.2K | 224 | Kumar Sanghvi | kumaras@chelsio.com | 1317919072 |  | RDMA/iwcm: Propagate ird/ord values upwards  Update struct iw_cm_event to support propagating the ird/ord values upwards to the application.  Signed-off-by: Kumar Sanghvi <kumaras@chelsio.com> Reviewed-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Roland Dreier <roland@purestorage.com>
f | ib_cache.h | s | 4.2K | 108 | Dotan Barak | dotanba@gmail.com | 1216104524 |  | RDMA: Improve include file coding style  Remove subversion $Id lines and improve readability by fixing other coding style problems pointed out by checkpatch.pl.  Signed-off-by: Dotan Barak <dotanba@gmail.com> Signed-off-by: Roland Dreier <rolandd@cisco.com>
