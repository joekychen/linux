<!DOCTYPE html>
<html><head><title>joekychen/linux » include › rdma › ib_cm.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>ib_cm.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2004, 2005 Intel Corporation.  All rights reserved.</span>
<span class="cm"> * Copyright (c) 2004 Topspin Corporation.  All rights reserved.</span>
<span class="cm"> * Copyright (c) 2004 Voltaire Corporation.  All rights reserved.</span>
<span class="cm"> * Copyright (c) 2005 Sun Microsystems, Inc. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This software is available to you under a choice of one of two</span>
<span class="cm"> * licenses.  You may choose to be licensed under the terms of the GNU</span>
<span class="cm"> * General Public License (GPL) Version 2, available from the file</span>
<span class="cm"> * COPYING in the main directory of this source tree, or the</span>
<span class="cm"> * OpenIB.org BSD license below:</span>
<span class="cm"> *</span>
<span class="cm"> *     Redistribution and use in source and binary forms, with or</span>
<span class="cm"> *     without modification, are permitted provided that the following</span>
<span class="cm"> *     conditions are met:</span>
<span class="cm"> *</span>
<span class="cm"> *      - Redistributions of source code must retain the above</span>
<span class="cm"> *        copyright notice, this list of conditions and the following</span>
<span class="cm"> *        disclaimer.</span>
<span class="cm"> *</span>
<span class="cm"> *      - Redistributions in binary form must reproduce the above</span>
<span class="cm"> *        copyright notice, this list of conditions and the following</span>
<span class="cm"> *        disclaimer in the documentation and/or other materials</span>
<span class="cm"> *        provided with the distribution.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<span class="cm"> * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span>
<span class="cm"> * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS</span>
<span class="cm"> * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN</span>
<span class="cm"> * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</span>
<span class="cm"> * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="cm"> * SOFTWARE.</span>
<span class="cm"> */</span>
<span class="cp">#if !defined(IB_CM_H)</span>
<span class="cp">#define IB_CM_H</span>

<span class="cp">#include &lt;rdma/ib_mad.h&gt;</span>
<span class="cp">#include &lt;rdma/ib_sa.h&gt;</span>

<span class="cm">/* ib_cm and ib_user_cm modules share /sys/class/infiniband_cm */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">class</span> <span class="n">cm_class</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">ib_cm_state</span> <span class="p">{</span>
	<span class="n">IB_CM_IDLE</span><span class="p">,</span>
	<span class="n">IB_CM_LISTEN</span><span class="p">,</span>
	<span class="n">IB_CM_REQ_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_REQ_RCVD</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_REQ_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_REQ_RCVD</span><span class="p">,</span>
	<span class="n">IB_CM_REP_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_REP_RCVD</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_REP_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_REP_RCVD</span><span class="p">,</span>
	<span class="n">IB_CM_ESTABLISHED</span><span class="p">,</span>
	<span class="n">IB_CM_DREQ_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_DREQ_RCVD</span><span class="p">,</span>
	<span class="n">IB_CM_TIMEWAIT</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REQ_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REQ_RCVD</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ib_cm_lap_state</span> <span class="p">{</span>
	<span class="n">IB_CM_LAP_UNINIT</span><span class="p">,</span>
	<span class="n">IB_CM_LAP_IDLE</span><span class="p">,</span>
	<span class="n">IB_CM_LAP_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_LAP_RCVD</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_LAP_SENT</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_LAP_RCVD</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ib_cm_event_type</span> <span class="p">{</span>
	<span class="n">IB_CM_REQ_ERROR</span><span class="p">,</span>
	<span class="n">IB_CM_REQ_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_REP_ERROR</span><span class="p">,</span>
	<span class="n">IB_CM_REP_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_RTU_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_USER_ESTABLISHED</span><span class="p">,</span>
	<span class="n">IB_CM_DREQ_ERROR</span><span class="p">,</span>
	<span class="n">IB_CM_DREQ_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_DREP_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_TIMEWAIT_EXIT</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_LAP_ERROR</span><span class="p">,</span>
	<span class="n">IB_CM_LAP_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_APR_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REQ_ERROR</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REQ_RECEIVED</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REP_RECEIVED</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ib_cm_data_size</span> <span class="p">{</span>
	<span class="n">IB_CM_REQ_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">92</span><span class="p">,</span>
	<span class="n">IB_CM_MRA_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">222</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">148</span><span class="p">,</span>
	<span class="n">IB_CM_REP_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">196</span><span class="p">,</span>
	<span class="n">IB_CM_RTU_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">224</span><span class="p">,</span>
	<span class="n">IB_CM_DREQ_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">220</span><span class="p">,</span>
	<span class="n">IB_CM_DREP_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">224</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_ARI_LENGTH</span>		 <span class="o">=</span> <span class="mi">72</span><span class="p">,</span>
	<span class="n">IB_CM_LAP_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">168</span><span class="p">,</span>
	<span class="n">IB_CM_APR_PRIVATE_DATA_SIZE</span>	 <span class="o">=</span> <span class="mi">148</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INFO_LENGTH</span>		 <span class="o">=</span> <span class="mi">72</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REQ_PRIVATE_DATA_SIZE</span> <span class="o">=</span> <span class="mi">216</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REP_PRIVATE_DATA_SIZE</span> <span class="o">=</span> <span class="mi">136</span><span class="p">,</span>
	<span class="n">IB_CM_SIDR_REP_INFO_LENGTH</span>	 <span class="o">=</span> <span class="mi">72</span><span class="p">,</span>
	<span class="n">IB_CM_COMPARE_SIZE</span>		 <span class="o">=</span> <span class="mi">64</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_id</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ib_cm_req_event_param</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ib_cm_id</span>		<span class="o">*</span><span class="n">listen_id</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">port</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ib_sa_path_rec</span>	<span class="o">*</span><span class="n">primary_path</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ib_sa_path_rec</span>	<span class="o">*</span><span class="n">alternate_path</span><span class="p">;</span>

	<span class="n">__be64</span>			<span class="n">remote_ca_guid</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">remote_qkey</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">remote_qpn</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ib_qp_type</span>		<span class="n">qp_type</span><span class="p">;</span>

	<span class="n">u32</span>			<span class="n">starting_psn</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">responder_resources</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">initiator_depth</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">local_cm_response_timeout</span><span class="o">:</span><span class="mi">5</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">flow_control</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">remote_cm_response_timeout</span><span class="o">:</span><span class="mi">5</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">retry_count</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">rnr_retry_count</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">srq</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_rep_event_param</span> <span class="p">{</span>
	<span class="n">__be64</span>			<span class="n">remote_ca_guid</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">remote_qkey</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">remote_qpn</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">starting_psn</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">responder_resources</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">initiator_depth</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">target_ack_delay</span><span class="o">:</span><span class="mi">5</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">failover_accepted</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">flow_control</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">rnr_retry_count</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">srq</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ib_cm_rej_reason</span> <span class="p">{</span>
	<span class="n">IB_CM_REJ_NO_QP</span>				<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_NO_EEC</span>			<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_NO_RESOURCES</span>			<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_TIMEOUT</span>			<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_UNSUPPORTED</span>			<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_COMM_ID</span>		<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_COMM_INSTANCE</span>		<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_SERVICE_ID</span>		<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_TRANSPORT_TYPE</span>	<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_STALE_CONN</span>			<span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_RDC_NOT_EXIST</span>			<span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_GID</span>			<span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_LID</span>			<span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_SL</span>			<span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_TRAFFIC_CLASS</span>		<span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_HOP_LIMIT</span>		<span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_PACKET_RATE</span>		<span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_ALT_GID</span>		<span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_ALT_LID</span>		<span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_ALT_SL</span>		<span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_ALT_TRAFFIC_CLASS</span>	<span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_ALT_HOP_LIMIT</span>		<span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_ALT_PACKET_RATE</span>	<span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_PORT_CM_REDIRECT</span>		<span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_PORT_REDIRECT</span>			<span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_MTU</span>			<span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INSUFFICIENT_RESP_RESOURCES</span>	<span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_CONSUMER_DEFINED</span>		<span class="o">=</span> <span class="mi">28</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_RNR_RETRY</span>		<span class="o">=</span> <span class="mi">29</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_DUPLICATE_LOCAL_COMM_ID</span>	<span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_CLASS_VERSION</span>		<span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_FLOW_LABEL</span>		<span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">IB_CM_REJ_INVALID_ALT_FLOW_LABEL</span>	<span class="o">=</span> <span class="mi">33</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_rej_event_param</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">ib_cm_rej_reason</span>	<span class="n">reason</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">ari</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">ari_length</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_mra_event_param</span> <span class="p">{</span>
	<span class="n">u8</span>	<span class="n">service_timeout</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_lap_event_param</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ib_sa_path_rec</span>	<span class="o">*</span><span class="n">alternate_path</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ib_cm_apr_status</span> <span class="p">{</span>
	<span class="n">IB_CM_APR_SUCCESS</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_COMM_ID</span><span class="p">,</span>
	<span class="n">IB_CM_APR_UNSUPPORTED</span><span class="p">,</span>
	<span class="n">IB_CM_APR_REJECT</span><span class="p">,</span>
	<span class="n">IB_CM_APR_REDIRECT</span><span class="p">,</span>
	<span class="n">IB_CM_APR_IS_CURRENT</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_QPN_EECN</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_LID</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_GID</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_FLOW_LABEL</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_TCLASS</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_HOP_LIMIT</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_PACKET_RATE</span><span class="p">,</span>
	<span class="n">IB_CM_APR_INVALID_SL</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_apr_event_param</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">ib_cm_apr_status</span>	<span class="n">ap_status</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">apr_info</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">info_len</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_sidr_req_event_param</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ib_cm_id</span>		<span class="o">*</span><span class="n">listen_id</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">port</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="n">pkey</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ib_cm_sidr_status</span> <span class="p">{</span>
	<span class="n">IB_SIDR_SUCCESS</span><span class="p">,</span>
	<span class="n">IB_SIDR_UNSUPPORTED</span><span class="p">,</span>
	<span class="n">IB_SIDR_REJECT</span><span class="p">,</span>
	<span class="n">IB_SIDR_NO_QP</span><span class="p">,</span>
	<span class="n">IB_SIDR_REDIRECT</span><span class="p">,</span>
	<span class="n">IB_SIDR_UNSUPPORTED_VERSION</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_sidr_rep_event_param</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">ib_cm_sidr_status</span>	<span class="n">status</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">qkey</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">qpn</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">info</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">info_len</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ib_cm_event</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">ib_cm_event_type</span>	<span class="n">event</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">ib_cm_req_event_param</span>	<span class="n">req_rcvd</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">ib_cm_rep_event_param</span>	<span class="n">rep_rcvd</span><span class="p">;</span>
		<span class="cm">/* No data for RTU received events. */</span>
		<span class="k">struct</span> <span class="n">ib_cm_rej_event_param</span>	<span class="n">rej_rcvd</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">ib_cm_mra_event_param</span>	<span class="n">mra_rcvd</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">ib_cm_lap_event_param</span>	<span class="n">lap_rcvd</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">ib_cm_apr_event_param</span>	<span class="n">apr_rcvd</span><span class="p">;</span>
		<span class="cm">/* No data for DREQ/DREP received events. */</span>
		<span class="k">struct</span> <span class="n">ib_cm_sidr_req_event_param</span> <span class="n">sidr_req_rcvd</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">ib_cm_sidr_rep_event_param</span> <span class="n">sidr_rep_rcvd</span><span class="p">;</span>
		<span class="k">enum</span> <span class="n">ib_wc_status</span>		<span class="n">send_status</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">param</span><span class="p">;</span>

	<span class="kt">void</span>			<span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * ib_cm_handler - User-defined callback to process communication events.</span>
<span class="cm"> * @cm_id: Communication identifier associated with the reported event.</span>
<span class="cm"> * @event: Information about the communication event.</span>
<span class="cm"> *</span>
<span class="cm"> * IB_CM_REQ_RECEIVED and IB_CM_SIDR_REQ_RECEIVED communication events</span>
<span class="cm"> * generated as a result of listen requests result in the allocation of a</span>
<span class="cm"> * new @cm_id.  The new @cm_id is returned to the user through this callback.</span>
<span class="cm"> * Clients are responsible for destroying the new @cm_id.  For peer-to-peer</span>
<span class="cm"> * IB_CM_REQ_RECEIVED and all other events, the returned @cm_id corresponds</span>
<span class="cm"> * to a user&#39;s existing communication identifier.</span>
<span class="cm"> *</span>
<span class="cm"> * Users may not call ib_destroy_cm_id while in the context of this callback;</span>
<span class="cm"> * however, returning a non-zero value instructs the communication manager to</span>
<span class="cm"> * destroy the @cm_id after the callback completes.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">ib_cm_handler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">ib_cm_event</span> <span class="o">*</span><span class="n">event</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="p">{</span>
	<span class="n">ib_cm_handler</span>		<span class="n">cm_handler</span><span class="p">;</span>
	<span class="kt">void</span>			<span class="o">*</span><span class="n">context</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ib_device</span>	<span class="o">*</span><span class="n">device</span><span class="p">;</span>
	<span class="n">__be64</span>			<span class="n">service_id</span><span class="p">;</span>
	<span class="n">__be64</span>			<span class="n">service_mask</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ib_cm_state</span>	<span class="n">state</span><span class="p">;</span>		<span class="cm">/* internal CM/debug use */</span>
	<span class="k">enum</span> <span class="n">ib_cm_lap_state</span>	<span class="n">lap_state</span><span class="p">;</span>	<span class="cm">/* internal CM/debug use */</span>
	<span class="n">__be32</span>			<span class="n">local_id</span><span class="p">;</span>
	<span class="n">__be32</span>			<span class="n">remote_id</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">remote_cm_qpn</span><span class="p">;</span>  <span class="cm">/* 1 unless redirected */</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * ib_create_cm_id - Allocate a communication identifier.</span>
<span class="cm"> * @device: Device associated with the cm_id.  All related communication will</span>
<span class="cm"> * be associated with the specified device.</span>
<span class="cm"> * @cm_handler: Callback invoked to notify the user of CM events.</span>
<span class="cm"> * @context: User specified context associated with the communication</span>
<span class="cm"> *   identifier.</span>
<span class="cm"> *</span>
<span class="cm"> * Communication identifiers are used to track connection states, service</span>
<span class="cm"> * ID resolution requests, and listen requests.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">ib_create_cm_id</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_device</span> <span class="o">*</span><span class="n">device</span><span class="p">,</span>
				 <span class="n">ib_cm_handler</span> <span class="n">cm_handler</span><span class="p">,</span>
				 <span class="kt">void</span> <span class="o">*</span><span class="n">context</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_destroy_cm_id - Destroy a connection identifier.</span>
<span class="cm"> * @cm_id: Connection identifier to destroy.</span>
<span class="cm"> *</span>
<span class="cm"> * This call blocks until the connection identifier is destroyed.</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="n">ib_destroy_cm_id</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">);</span>

<span class="cp">#define IB_SERVICE_ID_AGN_MASK	cpu_to_be64(0xFF00000000000000ULL)</span>
<span class="cp">#define IB_CM_ASSIGN_SERVICE_ID	cpu_to_be64(0x0200000000000000ULL)</span>
<span class="cp">#define IB_CMA_SERVICE_ID	cpu_to_be64(0x0000000001000000ULL)</span>
<span class="cp">#define IB_CMA_SERVICE_ID_MASK	cpu_to_be64(0xFFFFFFFFFF000000ULL)</span>
<span class="cp">#define IB_SDP_SERVICE_ID	cpu_to_be64(0x0000000000010000ULL)</span>
<span class="cp">#define IB_SDP_SERVICE_ID_MASK	cpu_to_be64(0xFFFFFFFFFFFF0000ULL)</span>

<span class="k">struct</span> <span class="n">ib_cm_compare_data</span> <span class="p">{</span>
	<span class="n">u8</span>  <span class="n">data</span><span class="p">[</span><span class="n">IB_CM_COMPARE_SIZE</span><span class="p">];</span>
	<span class="n">u8</span>  <span class="n">mask</span><span class="p">[</span><span class="n">IB_CM_COMPARE_SIZE</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * ib_cm_listen - Initiates listening on the specified service ID for</span>
<span class="cm"> *   connection and service ID resolution requests.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the listen request.</span>
<span class="cm"> * @service_id: Service identifier matched against incoming connection</span>
<span class="cm"> *   and service ID resolution requests.  The service ID should be specified</span>
<span class="cm"> *   network-byte order.  If set to IB_CM_ASSIGN_SERVICE_ID, the CM will</span>
<span class="cm"> *   assign a service ID to the caller.</span>
<span class="cm"> * @service_mask: Mask applied to service ID used to listen across a</span>
<span class="cm"> *   range of service IDs.  If set to 0, the service ID is matched</span>
<span class="cm"> *   exactly.  This parameter is ignored if %service_id is set to</span>
<span class="cm"> *   IB_CM_ASSIGN_SERVICE_ID.</span>
<span class="cm"> * @compare_data: This parameter is optional.  It specifies data that must</span>
<span class="cm"> *   appear in the private data of a connection request for the specified</span>
<span class="cm"> *   listen request.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_cm_listen</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span> <span class="n">__be64</span> <span class="n">service_id</span><span class="p">,</span> <span class="n">__be64</span> <span class="n">service_mask</span><span class="p">,</span>
		 <span class="k">struct</span> <span class="n">ib_cm_compare_data</span> <span class="o">*</span><span class="n">compare_data</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ib_cm_req_param</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ib_sa_path_rec</span>	<span class="o">*</span><span class="n">primary_path</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ib_sa_path_rec</span>	<span class="o">*</span><span class="n">alternate_path</span><span class="p">;</span>
	<span class="n">__be64</span>			<span class="n">service_id</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">qp_num</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ib_qp_type</span>		<span class="n">qp_type</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">starting_psn</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">void</span>		<span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">private_data_len</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">peer_to_peer</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">responder_resources</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">initiator_depth</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">remote_cm_response_timeout</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">flow_control</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">local_cm_response_timeout</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">retry_count</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">rnr_retry_count</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">max_cm_retries</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">srq</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_req - Sends a connection request to the remote node.</span>
<span class="cm"> * @cm_id: Connection identifier that will be associated with the</span>
<span class="cm"> *   connection request.</span>
<span class="cm"> * @param: Connection request information needed to establish the</span>
<span class="cm"> *   connection.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_req</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		   <span class="k">struct</span> <span class="n">ib_cm_req_param</span> <span class="o">*</span><span class="n">param</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ib_cm_rep_param</span> <span class="p">{</span>
	<span class="n">u32</span>		<span class="n">qp_num</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">starting_psn</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">void</span>	<span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">private_data_len</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">responder_resources</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">initiator_depth</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">failover_accepted</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">flow_control</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rnr_retry_count</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">srq</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_rep - Sends a connection reply in response to a connection</span>
<span class="cm"> *   request.</span>
<span class="cm"> * @cm_id: Connection identifier that will be associated with the</span>
<span class="cm"> *   connection request.</span>
<span class="cm"> * @param: Connection reply information needed to establish the</span>
<span class="cm"> *   connection.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_rep</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		   <span class="k">struct</span> <span class="n">ib_cm_rep_param</span> <span class="o">*</span><span class="n">param</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_rtu - Sends a connection ready to use message in response</span>
<span class="cm"> *   to a connection reply message.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the connection request.</span>
<span class="cm"> * @private_data: Optional user-defined private data sent with the</span>
<span class="cm"> *   ready to use message.</span>
<span class="cm"> * @private_data_len: Size of the private data buffer, in bytes.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_rtu</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		   <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">private_data_len</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_dreq - Sends a disconnection request for an existing</span>
<span class="cm"> *   connection.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the connection being</span>
<span class="cm"> *   released.</span>
<span class="cm"> * @private_data: Optional user-defined private data sent with the</span>
<span class="cm"> *   disconnection request message.</span>
<span class="cm"> * @private_data_len: Size of the private data buffer, in bytes.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_dreq</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		    <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span>
		    <span class="n">u8</span> <span class="n">private_data_len</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_drep - Sends a disconnection reply to a disconnection request.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the connection being</span>
<span class="cm"> *   released.</span>
<span class="cm"> * @private_data: Optional user-defined private data sent with the</span>
<span class="cm"> *   disconnection reply message.</span>
<span class="cm"> * @private_data_len: Size of the private data buffer, in bytes.</span>
<span class="cm"> *</span>
<span class="cm"> * If the cm_id is in the correct state, the CM will transition the connection</span>
<span class="cm"> * to the timewait state, even if an error occurs sending the DREP message.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_drep</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		    <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span>
		    <span class="n">u8</span> <span class="n">private_data_len</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_cm_notify - Notifies the CM of an event reported to the consumer.</span>
<span class="cm"> * @cm_id: Connection identifier to transition to established.</span>
<span class="cm"> * @event: Type of event.</span>
<span class="cm"> *</span>
<span class="cm"> * This routine should be invoked by users to notify the CM of relevant</span>
<span class="cm"> * communication events.  Events that should be reported to the CM and</span>
<span class="cm"> * when to report them are:</span>
<span class="cm"> *</span>
<span class="cm"> * IB_EVENT_COMM_EST - Used when a message is received on a connected</span>
<span class="cm"> *    QP before an RTU has been received.</span>
<span class="cm"> * IB_EVENT_PATH_MIG - Notifies the CM that the connection has failed over</span>
<span class="cm"> *   to the alternate path.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_cm_notify</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span> <span class="k">enum</span> <span class="n">ib_event_type</span> <span class="n">event</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_rej - Sends a connection rejection message to the</span>
<span class="cm"> *   remote node.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the connection being</span>
<span class="cm"> *   rejected.</span>
<span class="cm"> * @reason: Reason for the connection request rejection.</span>
<span class="cm"> * @ari: Optional additional rejection information.</span>
<span class="cm"> * @ari_length: Size of the additional rejection information, in bytes.</span>
<span class="cm"> * @private_data: Optional user-defined private data sent with the</span>
<span class="cm"> *   rejection message.</span>
<span class="cm"> * @private_data_len: Size of the private data buffer, in bytes.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_rej</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		   <span class="k">enum</span> <span class="n">ib_cm_rej_reason</span> <span class="n">reason</span><span class="p">,</span>
		   <span class="kt">void</span> <span class="o">*</span><span class="n">ari</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">ari_length</span><span class="p">,</span>
		   <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">private_data_len</span><span class="p">);</span>

<span class="cp">#define IB_CM_MRA_FLAG_DELAY 0x80  </span><span class="cm">/* Send MRA only after a duplicate msg */</span><span class="cp"></span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_mra - Sends a message receipt acknowledgement to a connection</span>
<span class="cm"> *   message.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the connection message.</span>
<span class="cm"> * @service_timeout: The lower 5-bits specify the maximum time required for</span>
<span class="cm"> *   the sender to reply to the connection message.  The upper 3-bits</span>
<span class="cm"> *   specify additional control flags.</span>
<span class="cm"> * @private_data: Optional user-defined private data sent with the</span>
<span class="cm"> *   message receipt acknowledgement.</span>
<span class="cm"> * @private_data_len: Size of the private data buffer, in bytes.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_mra</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">service_timeout</span><span class="p">,</span>
		   <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">private_data_len</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_lap - Sends a load alternate path request.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the load alternate path</span>
<span class="cm"> *   message.</span>
<span class="cm"> * @alternate_path: A path record that identifies the alternate path to</span>
<span class="cm"> *   load.</span>
<span class="cm"> * @private_data: Optional user-defined private data sent with the</span>
<span class="cm"> *   load alternate path message.</span>
<span class="cm"> * @private_data_len: Size of the private data buffer, in bytes.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_lap</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		   <span class="k">struct</span> <span class="n">ib_sa_path_rec</span> <span class="o">*</span><span class="n">alternate_path</span><span class="p">,</span>
		   <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">private_data_len</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_cm_init_qp_attr - Initializes the QP attributes for use in transitioning</span>
<span class="cm"> *   to a specified QP state.</span>
<span class="cm"> * @cm_id: Communication identifier associated with the QP attributes to</span>
<span class="cm"> *   initialize.</span>
<span class="cm"> * @qp_attr: On input, specifies the desired QP state.  On output, the</span>
<span class="cm"> *   mandatory and desired optional attributes will be set in order to</span>
<span class="cm"> *   modify the QP to the specified state.</span>
<span class="cm"> * @qp_attr_mask: The QP attribute mask that may be used to transition the</span>
<span class="cm"> *   QP to the specified state.</span>
<span class="cm"> *</span>
<span class="cm"> * Users must set the @qp_attr-&gt;qp_state to the desired QP state.  This call</span>
<span class="cm"> * will set all required attributes for the given transition, along with</span>
<span class="cm"> * known optional attributes.  Users may override the attributes returned from</span>
<span class="cm"> * this call before calling ib_modify_qp.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_cm_init_qp_attr</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">ib_qp_attr</span> <span class="o">*</span><span class="n">qp_attr</span><span class="p">,</span>
		       <span class="kt">int</span> <span class="o">*</span><span class="n">qp_attr_mask</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_apr - Sends an alternate path response message in response to</span>
<span class="cm"> *   a load alternate path request.</span>
<span class="cm"> * @cm_id: Connection identifier associated with the alternate path response.</span>
<span class="cm"> * @status: Reply status sent with the alternate path response.</span>
<span class="cm"> * @info: Optional additional information sent with the alternate path</span>
<span class="cm"> *   response.</span>
<span class="cm"> * @info_length: Size of the additional information, in bytes.</span>
<span class="cm"> * @private_data: Optional user-defined private data sent with the</span>
<span class="cm"> *   alternate path response message.</span>
<span class="cm"> * @private_data_len: Size of the private data buffer, in bytes.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_apr</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
		   <span class="k">enum</span> <span class="n">ib_cm_apr_status</span> <span class="n">status</span><span class="p">,</span>
		   <span class="kt">void</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">info_length</span><span class="p">,</span>
		   <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span>
		   <span class="n">u8</span> <span class="n">private_data_len</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ib_cm_sidr_req_param</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ib_sa_path_rec</span>	<span class="o">*</span><span class="n">path</span><span class="p">;</span>
	<span class="n">__be64</span>			<span class="n">service_id</span><span class="p">;</span>
	<span class="kt">int</span>			<span class="n">timeout_ms</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">void</span>		<span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">private_data_len</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">max_cm_retries</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_sidr_req - Sends a service ID resolution request to the</span>
<span class="cm"> *   remote node.</span>
<span class="cm"> * @cm_id: Communication identifier that will be associated with the</span>
<span class="cm"> *   service ID resolution request.</span>
<span class="cm"> * @param: Service ID resolution request information.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_sidr_req</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">ib_cm_sidr_req_param</span> <span class="o">*</span><span class="n">param</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ib_cm_sidr_rep_param</span> <span class="p">{</span>
	<span class="n">u32</span>			<span class="n">qp_num</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">qkey</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ib_cm_sidr_status</span>	<span class="n">status</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">void</span>		<span class="o">*</span><span class="n">info</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">info_length</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">void</span>		<span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">private_data_len</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * ib_send_cm_sidr_rep - Sends a service ID resolution reply to the</span>
<span class="cm"> *   remote node.</span>
<span class="cm"> * @cm_id: Communication identifier associated with the received service ID</span>
<span class="cm"> *   resolution request.</span>
<span class="cm"> * @param: Service ID resolution reply information.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">ib_send_cm_sidr_rep</span><span class="p">(</span><span class="k">struct</span> <span class="n">ib_cm_id</span> <span class="o">*</span><span class="n">cm_id</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">ib_cm_sidr_rep_param</span> <span class="o">*</span><span class="n">param</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* IB_CM_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
