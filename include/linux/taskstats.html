<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › taskstats.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>taskstats.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* taskstats.h - exporting per-task statistics</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) Shailabh Nagar, IBM Corp. 2006</span>
<span class="cm"> *           (C) Balbir Singh,   IBM Corp. 2006</span>
<span class="cm"> *           (C) Jay Lan,        SGI, 2006</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of version 2.1 of the GNU Lesser General Public License</span>
<span class="cm"> * as published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it would be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_TASKSTATS_H</span>
<span class="cp">#define _LINUX_TASKSTATS_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/* Format for per-task data returned to userland when</span>
<span class="cm"> *	- a task exits</span>
<span class="cm"> *	- listener requests stats for a task</span>
<span class="cm"> *</span>
<span class="cm"> * The struct is versioned. Newer versions should only add fields to</span>
<span class="cm"> * the bottom of the struct to maintain backward compatibility.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * To add new fields</span>
<span class="cm"> *	a) bump up TASKSTATS_VERSION</span>
<span class="cm"> *	b) add comment indicating new version number at end of struct</span>
<span class="cm"> *	c) add new fields after version comment; maintain 64-bit alignment</span>
<span class="cm"> */</span>


<span class="cp">#define TASKSTATS_VERSION	8</span>
<span class="cp">#define TS_COMM_LEN		32	</span><span class="cm">/* should be &gt;= TASK_COMM_LEN</span>
<span class="cm">					 * in linux/sched.h */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">taskstats</span> <span class="p">{</span>

	<span class="cm">/* The version number of this struct. This field is always set to</span>
<span class="cm">	 * TAKSTATS_VERSION, which is defined in &lt;linux/taskstats.h&gt;.</span>
<span class="cm">	 * Each time the struct is changed, the value should be incremented.</span>
<span class="cm">	 */</span>
	<span class="n">__u16</span>	<span class="n">version</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">ac_exitcode</span><span class="p">;</span>		<span class="cm">/* Exit status */</span>

	<span class="cm">/* The accounting flags of a task as defined in &lt;linux/acct.h&gt;</span>
<span class="cm">	 * Defined values are AFORK, ASU, ACOMPAT, ACORE, and AXSIG.</span>
<span class="cm">	 */</span>
	<span class="n">__u8</span>	<span class="n">ac_flag</span><span class="p">;</span>		<span class="cm">/* Record flags */</span>
	<span class="n">__u8</span>	<span class="n">ac_nice</span><span class="p">;</span>		<span class="cm">/* task_nice */</span>

	<span class="cm">/* Delay accounting fields start</span>
<span class="cm">	 *</span>
<span class="cm">	 * All values, until comment &quot;Delay accounting fields end&quot; are</span>
<span class="cm">	 * available only if delay accounting is enabled, even though the last</span>
<span class="cm">	 * few fields are not delays</span>
<span class="cm">	 *</span>
<span class="cm">	 * xxx_count is the number of delay values recorded</span>
<span class="cm">	 * xxx_delay_total is the corresponding cumulative delay in nanoseconds</span>
<span class="cm">	 *</span>
<span class="cm">	 * xxx_delay_total wraps around to zero on overflow</span>
<span class="cm">	 * xxx_count incremented regardless of overflow</span>
<span class="cm">	 */</span>

	<span class="cm">/* Delay waiting for cpu, while runnable</span>
<span class="cm">	 * count, delay_total NOT updated atomically</span>
<span class="cm">	 */</span>
	<span class="n">__u64</span>	<span class="n">cpu_count</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">8</span><span class="p">)));</span>
	<span class="n">__u64</span>	<span class="n">cpu_delay_total</span><span class="p">;</span>

	<span class="cm">/* Following four fields atomically updated using task-&gt;delays-&gt;lock */</span>

	<span class="cm">/* Delay waiting for synchronous block I/O to complete</span>
<span class="cm">	 * does not account for delays in I/O submission</span>
<span class="cm">	 */</span>
	<span class="n">__u64</span>	<span class="n">blkio_count</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">blkio_delay_total</span><span class="p">;</span>

	<span class="cm">/* Delay waiting for page fault I/O (swap in only) */</span>
	<span class="n">__u64</span>	<span class="n">swapin_count</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">swapin_delay_total</span><span class="p">;</span>

	<span class="cm">/* cpu &quot;wall-clock&quot; running time</span>
<span class="cm">	 * On some architectures, value will adjust for cpu time stolen</span>
<span class="cm">	 * from the kernel in involuntary waits due to virtualization.</span>
<span class="cm">	 * Value is cumulative, in nanoseconds, without a corresponding count</span>
<span class="cm">	 * and wraps around to zero silently on overflow</span>
<span class="cm">	 */</span>
	<span class="n">__u64</span>	<span class="n">cpu_run_real_total</span><span class="p">;</span>

	<span class="cm">/* cpu &quot;virtual&quot; running time</span>
<span class="cm">	 * Uses time intervals seen by the kernel i.e. no adjustment</span>
<span class="cm">	 * for kernel&#39;s involuntary waits due to virtualization.</span>
<span class="cm">	 * Value is cumulative, in nanoseconds, without a corresponding count</span>
<span class="cm">	 * and wraps around to zero silently on overflow</span>
<span class="cm">	 */</span>
	<span class="n">__u64</span>	<span class="n">cpu_run_virtual_total</span><span class="p">;</span>
	<span class="cm">/* Delay accounting fields end */</span>
	<span class="cm">/* version 1 ends here */</span>

	<span class="cm">/* Basic Accounting Fields start */</span>
	<span class="kt">char</span>	<span class="n">ac_comm</span><span class="p">[</span><span class="n">TS_COMM_LEN</span><span class="p">];</span>	<span class="cm">/* Command name */</span>
	<span class="n">__u8</span>	<span class="n">ac_sched</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">8</span><span class="p">)));</span>
					<span class="cm">/* Scheduling discipline */</span>
	<span class="n">__u8</span>	<span class="n">ac_pad</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">__u32</span>	<span class="n">ac_uid</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">8</span><span class="p">)));</span>
					<span class="cm">/* User ID */</span>
	<span class="n">__u32</span>	<span class="n">ac_gid</span><span class="p">;</span>			<span class="cm">/* Group ID */</span>
	<span class="n">__u32</span>	<span class="n">ac_pid</span><span class="p">;</span>			<span class="cm">/* Process ID */</span>
	<span class="n">__u32</span>	<span class="n">ac_ppid</span><span class="p">;</span>		<span class="cm">/* Parent process ID */</span>
	<span class="n">__u32</span>	<span class="n">ac_btime</span><span class="p">;</span>		<span class="cm">/* Begin time [sec since 1970] */</span>
	<span class="n">__u64</span>	<span class="n">ac_etime</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">8</span><span class="p">)));</span>
					<span class="cm">/* Elapsed time [usec] */</span>
	<span class="n">__u64</span>	<span class="n">ac_utime</span><span class="p">;</span>		<span class="cm">/* User CPU time [usec] */</span>
	<span class="n">__u64</span>	<span class="n">ac_stime</span><span class="p">;</span>		<span class="cm">/* SYstem CPU time [usec] */</span>
	<span class="n">__u64</span>	<span class="n">ac_minflt</span><span class="p">;</span>		<span class="cm">/* Minor Page Fault Count */</span>
	<span class="n">__u64</span>	<span class="n">ac_majflt</span><span class="p">;</span>		<span class="cm">/* Major Page Fault Count */</span>
	<span class="cm">/* Basic Accounting Fields end */</span>

	<span class="cm">/* Extended accounting fields start */</span>
	<span class="cm">/* Accumulated RSS usage in duration of a task, in MBytes-usecs.</span>
<span class="cm">	 * The current rss usage is added to this counter every time</span>
<span class="cm">	 * a tick is charged to a task&#39;s system time. So, at the end we</span>
<span class="cm">	 * will have memory usage multiplied by system time. Thus an</span>
<span class="cm">	 * average usage per system time unit can be calculated.</span>
<span class="cm">	 */</span>
	<span class="n">__u64</span>	<span class="n">coremem</span><span class="p">;</span>		<span class="cm">/* accumulated RSS usage in MB-usec */</span>
	<span class="cm">/* Accumulated virtual memory usage in duration of a task.</span>
<span class="cm">	 * Same as acct_rss_mem1 above except that we keep track of VM usage.</span>
<span class="cm">	 */</span>
	<span class="n">__u64</span>	<span class="n">virtmem</span><span class="p">;</span>		<span class="cm">/* accumulated VM  usage in MB-usec */</span>

	<span class="cm">/* High watermark of RSS and virtual memory usage in duration of</span>
<span class="cm">	 * a task, in KBytes.</span>
<span class="cm">	 */</span>
	<span class="n">__u64</span>	<span class="n">hiwater_rss</span><span class="p">;</span>		<span class="cm">/* High-watermark of RSS usage, in KB */</span>
	<span class="n">__u64</span>	<span class="n">hiwater_vm</span><span class="p">;</span>		<span class="cm">/* High-water VM usage, in KB */</span>

	<span class="cm">/* The following four fields are I/O statistics of a task. */</span>
	<span class="n">__u64</span>	<span class="n">read_char</span><span class="p">;</span>		<span class="cm">/* bytes read */</span>
	<span class="n">__u64</span>	<span class="n">write_char</span><span class="p">;</span>		<span class="cm">/* bytes written */</span>
	<span class="n">__u64</span>	<span class="n">read_syscalls</span><span class="p">;</span>		<span class="cm">/* read syscalls */</span>
	<span class="n">__u64</span>	<span class="n">write_syscalls</span><span class="p">;</span>		<span class="cm">/* write syscalls */</span>
	<span class="cm">/* Extended accounting fields end */</span>

<span class="cp">#define TASKSTATS_HAS_IO_ACCOUNTING</span>
	<span class="cm">/* Per-task storage I/O accounting starts */</span>
	<span class="n">__u64</span>	<span class="n">read_bytes</span><span class="p">;</span>		<span class="cm">/* bytes of read I/O */</span>
	<span class="n">__u64</span>	<span class="n">write_bytes</span><span class="p">;</span>		<span class="cm">/* bytes of write I/O */</span>
	<span class="n">__u64</span>	<span class="n">cancelled_write_bytes</span><span class="p">;</span>	<span class="cm">/* bytes of cancelled write I/O */</span>

	<span class="n">__u64</span>  <span class="n">nvcsw</span><span class="p">;</span>			<span class="cm">/* voluntary_ctxt_switches */</span>
	<span class="n">__u64</span>  <span class="n">nivcsw</span><span class="p">;</span>			<span class="cm">/* nonvoluntary_ctxt_switches */</span>

	<span class="cm">/* time accounting for SMT machines */</span>
	<span class="n">__u64</span>	<span class="n">ac_utimescaled</span><span class="p">;</span>		<span class="cm">/* utime scaled on frequency etc */</span>
	<span class="n">__u64</span>	<span class="n">ac_stimescaled</span><span class="p">;</span>		<span class="cm">/* stime scaled on frequency etc */</span>
	<span class="n">__u64</span>	<span class="n">cpu_scaled_run_real_total</span><span class="p">;</span> <span class="cm">/* scaled cpu_run_real_total */</span>

	<span class="cm">/* Delay waiting for memory reclaim */</span>
	<span class="n">__u64</span>	<span class="n">freepages_count</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">freepages_delay_total</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * Commands sent from userspace</span>
<span class="cm"> * Not versioned. New commands should only be inserted at the enum&#39;s end</span>
<span class="cm"> * prior to __TASKSTATS_CMD_MAX</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TASKSTATS_CMD_UNSPEC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>	<span class="cm">/* Reserved */</span>
	<span class="n">TASKSTATS_CMD_GET</span><span class="p">,</span>		<span class="cm">/* user-&gt;kernel request/get-response */</span>
	<span class="n">TASKSTATS_CMD_NEW</span><span class="p">,</span>		<span class="cm">/* kernel-&gt;user event */</span>
	<span class="n">__TASKSTATS_CMD_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TASKSTATS_CMD_MAX (__TASKSTATS_CMD_MAX - 1)</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TASKSTATS_TYPE_UNSPEC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>	<span class="cm">/* Reserved */</span>
	<span class="n">TASKSTATS_TYPE_PID</span><span class="p">,</span>		<span class="cm">/* Process id */</span>
	<span class="n">TASKSTATS_TYPE_TGID</span><span class="p">,</span>		<span class="cm">/* Thread group id */</span>
	<span class="n">TASKSTATS_TYPE_STATS</span><span class="p">,</span>		<span class="cm">/* taskstats structure */</span>
	<span class="n">TASKSTATS_TYPE_AGGR_PID</span><span class="p">,</span>	<span class="cm">/* contains pid + stats */</span>
	<span class="n">TASKSTATS_TYPE_AGGR_TGID</span><span class="p">,</span>	<span class="cm">/* contains tgid + stats */</span>
	<span class="n">TASKSTATS_TYPE_NULL</span><span class="p">,</span>		<span class="cm">/* contains nothing */</span>
	<span class="n">__TASKSTATS_TYPE_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TASKSTATS_TYPE_MAX (__TASKSTATS_TYPE_MAX - 1)</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TASKSTATS_CMD_ATTR_UNSPEC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">TASKSTATS_CMD_ATTR_PID</span><span class="p">,</span>
	<span class="n">TASKSTATS_CMD_ATTR_TGID</span><span class="p">,</span>
	<span class="n">TASKSTATS_CMD_ATTR_REGISTER_CPUMASK</span><span class="p">,</span>
	<span class="n">TASKSTATS_CMD_ATTR_DEREGISTER_CPUMASK</span><span class="p">,</span>
	<span class="n">__TASKSTATS_CMD_ATTR_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TASKSTATS_CMD_ATTR_MAX (__TASKSTATS_CMD_ATTR_MAX - 1)</span>

<span class="cm">/* NETLINK_GENERIC related info */</span>

<span class="cp">#define TASKSTATS_GENL_NAME	&quot;TASKSTATS&quot;</span>
<span class="cp">#define TASKSTATS_GENL_VERSION	0x1</span>

<span class="cp">#endif </span><span class="cm">/* _LINUX_TASKSTATS_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
