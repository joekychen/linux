<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › xfrm.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>xfrm.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _LINUX_XFRM_H</span>
<span class="cp">#define _LINUX_XFRM_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/* All of the structures in this file may not change size as they are</span>
<span class="cm"> * passed into the kernel from userspace via netlink sockets.</span>
<span class="cm"> */</span>

<span class="cm">/* Structure to encapsulate addresses. I do not want to use</span>
<span class="cm"> * &quot;standard&quot; structure. My apologies.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
	<span class="n">__be32</span>		<span class="n">a4</span><span class="p">;</span>
	<span class="n">__be32</span>		<span class="n">a6</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">}</span> <span class="n">xfrm_address_t</span><span class="p">;</span>

<span class="cm">/* Ident of a specific xfrm_state. It is used on input to lookup</span>
<span class="cm"> * the state by (spi,daddr,ah/esp) or to store information about</span>
<span class="cm"> * spi, protocol and tunnel address on output.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">xfrm_id</span> <span class="p">{</span>
	<span class="n">xfrm_address_t</span>	<span class="n">daddr</span><span class="p">;</span>
	<span class="n">__be32</span>		<span class="n">spi</span><span class="p">;</span>
	<span class="n">__u8</span>		<span class="n">proto</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_sec_ctx</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">ctx_doi</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">ctx_alg</span><span class="p">;</span>
	<span class="n">__u16</span>	<span class="n">ctx_len</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">ctx_sid</span><span class="p">;</span>
	<span class="kt">char</span>	<span class="n">ctx_str</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* Security Context Domains of Interpretation */</span>
<span class="cp">#define XFRM_SC_DOI_RESERVED 0</span>
<span class="cp">#define XFRM_SC_DOI_LSM 1</span>

<span class="cm">/* Security Context Algorithms */</span>
<span class="cp">#define XFRM_SC_ALG_RESERVED 0</span>
<span class="cp">#define XFRM_SC_ALG_SELINUX 1</span>

<span class="cm">/* Selector, used as selector both on policy rules (SPD) and SAs. */</span>

<span class="k">struct</span> <span class="n">xfrm_selector</span> <span class="p">{</span>
	<span class="n">xfrm_address_t</span>	<span class="n">daddr</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>	<span class="n">saddr</span><span class="p">;</span>
	<span class="n">__be16</span>	<span class="n">dport</span><span class="p">;</span>
	<span class="n">__be16</span>	<span class="n">dport_mask</span><span class="p">;</span>
	<span class="n">__be16</span>	<span class="n">sport</span><span class="p">;</span>
	<span class="n">__be16</span>	<span class="n">sport_mask</span><span class="p">;</span>
	<span class="n">__u16</span>	<span class="n">family</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">prefixlen_d</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">prefixlen_s</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">proto</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">ifindex</span><span class="p">;</span>
	<span class="n">__kernel_uid32_t</span>	<span class="n">user</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define XFRM_INF (~(__u64)0)</span>

<span class="k">struct</span> <span class="n">xfrm_lifetime_cfg</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">soft_byte_limit</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">hard_byte_limit</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">soft_packet_limit</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">hard_packet_limit</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">soft_add_expires_seconds</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">hard_add_expires_seconds</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">soft_use_expires_seconds</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">hard_use_expires_seconds</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_lifetime_cur</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">bytes</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">packets</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">add_time</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">use_time</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_replay_state</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">oseq</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">seq</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">bitmap</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_replay_state_esn</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">bmp_len</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">oseq</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">seq</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">oseq_hi</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">seq_hi</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">replay_window</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">bmp</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_algo</span> <span class="p">{</span>
	<span class="kt">char</span>		<span class="n">alg_name</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">alg_key_len</span><span class="p">;</span>    <span class="cm">/* in bits */</span>
	<span class="kt">char</span>		<span class="n">alg_key</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_algo_auth</span> <span class="p">{</span>
	<span class="kt">char</span>		<span class="n">alg_name</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">alg_key_len</span><span class="p">;</span>    <span class="cm">/* in bits */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">alg_trunc_len</span><span class="p">;</span>  <span class="cm">/* in bits */</span>
	<span class="kt">char</span>		<span class="n">alg_key</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_algo_aead</span> <span class="p">{</span>
	<span class="kt">char</span>		<span class="n">alg_name</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">alg_key_len</span><span class="p">;</span>	<span class="cm">/* in bits */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">alg_icv_len</span><span class="p">;</span>	<span class="cm">/* in bits */</span>
	<span class="kt">char</span>		<span class="n">alg_key</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_stats</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">replay_window</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">replay</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">integrity_failed</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">XFRM_POLICY_TYPE_MAIN</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">XFRM_POLICY_TYPE_SUB</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">XFRM_POLICY_TYPE_MAX</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">XFRM_POLICY_TYPE_ANY</span>	<span class="o">=</span> <span class="mi">255</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">XFRM_POLICY_IN</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">XFRM_POLICY_OUT</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">XFRM_POLICY_FWD</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">XFRM_POLICY_MASK</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">XFRM_POLICY_MAX</span>	<span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">XFRM_SHARE_ANY</span><span class="p">,</span>		<span class="cm">/* No limitations */</span>
	<span class="n">XFRM_SHARE_SESSION</span><span class="p">,</span>	<span class="cm">/* For this session only */</span>
	<span class="n">XFRM_SHARE_USER</span><span class="p">,</span>	<span class="cm">/* For this user only */</span>
	<span class="n">XFRM_SHARE_UNIQUE</span>	<span class="cm">/* Use once */</span>
<span class="p">};</span>

<span class="cp">#define XFRM_MODE_TRANSPORT 0</span>
<span class="cp">#define XFRM_MODE_TUNNEL 1</span>
<span class="cp">#define XFRM_MODE_ROUTEOPTIMIZATION 2</span>
<span class="cp">#define XFRM_MODE_IN_TRIGGER 3</span>
<span class="cp">#define XFRM_MODE_BEET 4</span>
<span class="cp">#define XFRM_MODE_MAX 5</span>

<span class="cm">/* Netlink configuration messages.  */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">XFRM_MSG_BASE</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>

	<span class="n">XFRM_MSG_NEWSA</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_NEWSA XFRM_MSG_NEWSA</span>
	<span class="n">XFRM_MSG_DELSA</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_DELSA XFRM_MSG_DELSA</span>
	<span class="n">XFRM_MSG_GETSA</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_GETSA XFRM_MSG_GETSA</span>

	<span class="n">XFRM_MSG_NEWPOLICY</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_NEWPOLICY XFRM_MSG_NEWPOLICY</span>
	<span class="n">XFRM_MSG_DELPOLICY</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_DELPOLICY XFRM_MSG_DELPOLICY</span>
	<span class="n">XFRM_MSG_GETPOLICY</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_GETPOLICY XFRM_MSG_GETPOLICY</span>

	<span class="n">XFRM_MSG_ALLOCSPI</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_ALLOCSPI XFRM_MSG_ALLOCSPI</span>
	<span class="n">XFRM_MSG_ACQUIRE</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_ACQUIRE XFRM_MSG_ACQUIRE</span>
	<span class="n">XFRM_MSG_EXPIRE</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_EXPIRE XFRM_MSG_EXPIRE</span>

	<span class="n">XFRM_MSG_UPDPOLICY</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_UPDPOLICY XFRM_MSG_UPDPOLICY</span>
	<span class="n">XFRM_MSG_UPDSA</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_UPDSA XFRM_MSG_UPDSA</span>

	<span class="n">XFRM_MSG_POLEXPIRE</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_POLEXPIRE XFRM_MSG_POLEXPIRE</span>

	<span class="n">XFRM_MSG_FLUSHSA</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_FLUSHSA XFRM_MSG_FLUSHSA</span>
	<span class="n">XFRM_MSG_FLUSHPOLICY</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_FLUSHPOLICY XFRM_MSG_FLUSHPOLICY</span>

	<span class="n">XFRM_MSG_NEWAE</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_NEWAE XFRM_MSG_NEWAE</span>
	<span class="n">XFRM_MSG_GETAE</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_GETAE XFRM_MSG_GETAE</span>

	<span class="n">XFRM_MSG_REPORT</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_REPORT XFRM_MSG_REPORT</span>

	<span class="n">XFRM_MSG_MIGRATE</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_MIGRATE XFRM_MSG_MIGRATE</span>

	<span class="n">XFRM_MSG_NEWSADINFO</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_NEWSADINFO XFRM_MSG_NEWSADINFO</span>
	<span class="n">XFRM_MSG_GETSADINFO</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_GETSADINFO XFRM_MSG_GETSADINFO</span>

	<span class="n">XFRM_MSG_NEWSPDINFO</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_NEWSPDINFO XFRM_MSG_NEWSPDINFO</span>
	<span class="n">XFRM_MSG_GETSPDINFO</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_GETSPDINFO XFRM_MSG_GETSPDINFO</span>

	<span class="n">XFRM_MSG_MAPPING</span><span class="p">,</span>
<span class="cp">#define XFRM_MSG_MAPPING XFRM_MSG_MAPPING</span>
	<span class="n">__XFRM_MSG_MAX</span>
<span class="p">};</span>
<span class="cp">#define XFRM_MSG_MAX (__XFRM_MSG_MAX - 1)</span>

<span class="cp">#define XFRM_NR_MSGTYPES (XFRM_MSG_MAX + 1 - XFRM_MSG_BASE)</span>

<span class="cm">/*</span>
<span class="cm"> * Generic LSM security context for comunicating to user space</span>
<span class="cm"> * NOTE: Same format as sadb_x_sec_ctx</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">xfrm_user_sec_ctx</span> <span class="p">{</span>
	<span class="n">__u16</span>			<span class="n">len</span><span class="p">;</span>
	<span class="n">__u16</span>			<span class="n">exttype</span><span class="p">;</span>
	<span class="n">__u8</span>			<span class="n">ctx_alg</span><span class="p">;</span>  <span class="cm">/* LSMs: e.g., selinux == 1 */</span>
	<span class="n">__u8</span>			<span class="n">ctx_doi</span><span class="p">;</span>
	<span class="n">__u16</span>			<span class="n">ctx_len</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_user_tmpl</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_id</span>		<span class="n">id</span><span class="p">;</span>
	<span class="n">__u16</span>			<span class="n">family</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>		<span class="n">saddr</span><span class="p">;</span>
	<span class="n">__u32</span>			<span class="n">reqid</span><span class="p">;</span>
	<span class="n">__u8</span>			<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u8</span>			<span class="n">share</span><span class="p">;</span>
	<span class="n">__u8</span>			<span class="n">optional</span><span class="p">;</span>
	<span class="n">__u32</span>			<span class="n">aalgos</span><span class="p">;</span>
	<span class="n">__u32</span>			<span class="n">ealgos</span><span class="p">;</span>
	<span class="n">__u32</span>			<span class="n">calgos</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_encap_tmpl</span> <span class="p">{</span>
	<span class="n">__u16</span>		<span class="n">encap_type</span><span class="p">;</span>
	<span class="n">__be16</span>		<span class="n">encap_sport</span><span class="p">;</span>
	<span class="n">__be16</span>		<span class="n">encap_dport</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>	<span class="n">encap_oa</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* AEVENT flags  */</span>
<span class="k">enum</span> <span class="n">xfrm_ae_ftype_t</span> <span class="p">{</span>
	<span class="n">XFRM_AE_UNSPEC</span><span class="p">,</span>
	<span class="n">XFRM_AE_RTHR</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>	<span class="cm">/* replay threshold*/</span>
	<span class="n">XFRM_AE_RVAL</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="cm">/* replay value */</span>
	<span class="n">XFRM_AE_LVAL</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="cm">/* lifetime value */</span>
	<span class="n">XFRM_AE_ETHR</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="cm">/* expiry timer threshold */</span>
	<span class="n">XFRM_AE_CR</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="cm">/* Event cause is replay update */</span>
	<span class="n">XFRM_AE_CE</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="cm">/* Event cause is timer expiry */</span>
	<span class="n">XFRM_AE_CU</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="cm">/* Event cause is policy update */</span>
	<span class="n">__XFRM_AE_MAX</span>

<span class="cp">#define XFRM_AE_MAX (__XFRM_AE_MAX - 1)</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_userpolicy_type</span> <span class="p">{</span>
	<span class="n">__u8</span>		<span class="n">type</span><span class="p">;</span>
	<span class="n">__u16</span>		<span class="n">reserved1</span><span class="p">;</span>
	<span class="n">__u8</span>		<span class="n">reserved2</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Netlink message attributes.  */</span>
<span class="k">enum</span> <span class="n">xfrm_attr_type_t</span> <span class="p">{</span>
	<span class="n">XFRMA_UNSPEC</span><span class="p">,</span>
	<span class="n">XFRMA_ALG_AUTH</span><span class="p">,</span>		<span class="cm">/* struct xfrm_algo */</span>
	<span class="n">XFRMA_ALG_CRYPT</span><span class="p">,</span>	<span class="cm">/* struct xfrm_algo */</span>
	<span class="n">XFRMA_ALG_COMP</span><span class="p">,</span>		<span class="cm">/* struct xfrm_algo */</span>
	<span class="n">XFRMA_ENCAP</span><span class="p">,</span>		<span class="cm">/* struct xfrm_algo + struct xfrm_encap_tmpl */</span>
	<span class="n">XFRMA_TMPL</span><span class="p">,</span>		<span class="cm">/* 1 or more struct xfrm_user_tmpl */</span>
	<span class="n">XFRMA_SA</span><span class="p">,</span>		<span class="cm">/* struct xfrm_usersa_info  */</span>
	<span class="n">XFRMA_POLICY</span><span class="p">,</span>		<span class="cm">/*struct xfrm_userpolicy_info */</span>
	<span class="n">XFRMA_SEC_CTX</span><span class="p">,</span>		<span class="cm">/* struct xfrm_sec_ctx */</span>
	<span class="n">XFRMA_LTIME_VAL</span><span class="p">,</span>
	<span class="n">XFRMA_REPLAY_VAL</span><span class="p">,</span>
	<span class="n">XFRMA_REPLAY_THRESH</span><span class="p">,</span>
	<span class="n">XFRMA_ETIMER_THRESH</span><span class="p">,</span>
	<span class="n">XFRMA_SRCADDR</span><span class="p">,</span>		<span class="cm">/* xfrm_address_t */</span>
	<span class="n">XFRMA_COADDR</span><span class="p">,</span>		<span class="cm">/* xfrm_address_t */</span>
	<span class="n">XFRMA_LASTUSED</span><span class="p">,</span>		<span class="cm">/* unsigned long  */</span>
	<span class="n">XFRMA_POLICY_TYPE</span><span class="p">,</span>	<span class="cm">/* struct xfrm_userpolicy_type */</span>
	<span class="n">XFRMA_MIGRATE</span><span class="p">,</span>
	<span class="n">XFRMA_ALG_AEAD</span><span class="p">,</span>		<span class="cm">/* struct xfrm_algo_aead */</span>
	<span class="n">XFRMA_KMADDRESS</span><span class="p">,</span>        <span class="cm">/* struct xfrm_user_kmaddress */</span>
	<span class="n">XFRMA_ALG_AUTH_TRUNC</span><span class="p">,</span>	<span class="cm">/* struct xfrm_algo_auth */</span>
	<span class="n">XFRMA_MARK</span><span class="p">,</span>		<span class="cm">/* struct xfrm_mark */</span>
	<span class="n">XFRMA_TFCPAD</span><span class="p">,</span>		<span class="cm">/* __u32 */</span>
	<span class="n">XFRMA_REPLAY_ESN_VAL</span><span class="p">,</span>	<span class="cm">/* struct xfrm_replay_esn */</span>
	<span class="n">__XFRMA_MAX</span>

<span class="cp">#define XFRMA_MAX (__XFRMA_MAX - 1)</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_mark</span> <span class="p">{</span>
	<span class="n">__u32</span>           <span class="n">v</span><span class="p">;</span> <span class="cm">/* value */</span>
	<span class="n">__u32</span>           <span class="n">m</span><span class="p">;</span> <span class="cm">/* mask */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">xfrm_sadattr_type_t</span> <span class="p">{</span>
	<span class="n">XFRMA_SAD_UNSPEC</span><span class="p">,</span>
	<span class="n">XFRMA_SAD_CNT</span><span class="p">,</span>
	<span class="n">XFRMA_SAD_HINFO</span><span class="p">,</span>
	<span class="n">__XFRMA_SAD_MAX</span>

<span class="cp">#define XFRMA_SAD_MAX (__XFRMA_SAD_MAX - 1)</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrmu_sadhinfo</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">sadhcnt</span><span class="p">;</span> <span class="cm">/* current hash bkts */</span>
	<span class="n">__u32</span> <span class="n">sadhmcnt</span><span class="p">;</span> <span class="cm">/* max allowed hash bkts */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">xfrm_spdattr_type_t</span> <span class="p">{</span>
	<span class="n">XFRMA_SPD_UNSPEC</span><span class="p">,</span>
	<span class="n">XFRMA_SPD_INFO</span><span class="p">,</span>
	<span class="n">XFRMA_SPD_HINFO</span><span class="p">,</span>
	<span class="n">__XFRMA_SPD_MAX</span>

<span class="cp">#define XFRMA_SPD_MAX (__XFRMA_SPD_MAX - 1)</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrmu_spdinfo</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">incnt</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">outcnt</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">fwdcnt</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">inscnt</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">outscnt</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">fwdscnt</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrmu_spdhinfo</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">spdhcnt</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">spdhmcnt</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_usersa_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_selector</span>		<span class="n">sel</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_id</span>			<span class="n">id</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">saddr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_lifetime_cfg</span>	<span class="n">lft</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_lifetime_cur</span>	<span class="n">curlft</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_stats</span>		<span class="n">stats</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">seq</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">reqid</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">family</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">mode</span><span class="p">;</span>		<span class="cm">/* XFRM_MODE_xxx */</span>
	<span class="n">__u8</span>				<span class="n">replay_window</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">flags</span><span class="p">;</span>
<span class="cp">#define XFRM_STATE_NOECN	1</span>
<span class="cp">#define XFRM_STATE_DECAP_DSCP	2</span>
<span class="cp">#define XFRM_STATE_NOPMTUDISC	4</span>
<span class="cp">#define XFRM_STATE_WILDRECV	8</span>
<span class="cp">#define XFRM_STATE_ICMP		16</span>
<span class="cp">#define XFRM_STATE_AF_UNSPEC	32</span>
<span class="cp">#define XFRM_STATE_ALIGN4	64</span>
<span class="cp">#define XFRM_STATE_ESN		128</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_usersa_id</span> <span class="p">{</span>
	<span class="n">xfrm_address_t</span>			<span class="n">daddr</span><span class="p">;</span>
	<span class="n">__be32</span>				<span class="n">spi</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">family</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">proto</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_aevent_id</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_usersa_id</span>		<span class="n">sa_id</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">saddr</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">reqid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_userspi_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_usersa_info</span>		<span class="n">info</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">min</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">max</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_userpolicy_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_selector</span>		<span class="n">sel</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_lifetime_cfg</span>	<span class="n">lft</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_lifetime_cur</span>	<span class="n">curlft</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">priority</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">index</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dir</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">action</span><span class="p">;</span>
<span class="cp">#define XFRM_POLICY_ALLOW	0</span>
<span class="cp">#define XFRM_POLICY_BLOCK	1</span>
	<span class="n">__u8</span>				<span class="n">flags</span><span class="p">;</span>
<span class="cp">#define XFRM_POLICY_LOCALOK	1	</span><span class="cm">/* Allow user to override global policy */</span><span class="cp"></span>
	<span class="cm">/* Automatically expand selector to include matching ICMP payloads. */</span>
<span class="cp">#define XFRM_POLICY_ICMP	2</span>
	<span class="n">__u8</span>				<span class="n">share</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_userpolicy_id</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_selector</span>		<span class="n">sel</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">index</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dir</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_user_acquire</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_id</span>			<span class="n">id</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">saddr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_selector</span>		<span class="n">sel</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_userpolicy_info</span>	<span class="n">policy</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">aalgos</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">ealgos</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">calgos</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">seq</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_user_expire</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_usersa_info</span>		<span class="n">state</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">hard</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_user_polexpire</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_userpolicy_info</span>	<span class="n">pol</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">hard</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_usersa_flush</span> <span class="p">{</span>
	<span class="n">__u8</span>				<span class="n">proto</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_user_report</span> <span class="p">{</span>
	<span class="n">__u8</span>				<span class="n">proto</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xfrm_selector</span>		<span class="n">sel</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Used by MIGRATE to pass addresses IKE should use to perform</span>
<span class="cm"> * SA negotiation with the peer */</span>
<span class="k">struct</span> <span class="n">xfrm_user_kmaddress</span> <span class="p">{</span>
	<span class="n">xfrm_address_t</span>                  <span class="n">local</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>                  <span class="n">remote</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">reserved</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">family</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_user_migrate</span> <span class="p">{</span>
	<span class="n">xfrm_address_t</span>			<span class="n">old_daddr</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">old_saddr</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">new_daddr</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">new_saddr</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">proto</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">reserved</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">reqid</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">old_family</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">new_family</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xfrm_user_mapping</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xfrm_usersa_id</span>		<span class="n">id</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">reqid</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">old_saddr</span><span class="p">;</span>
	<span class="n">xfrm_address_t</span>			<span class="n">new_saddr</span><span class="p">;</span>
	<span class="n">__be16</span>				<span class="n">old_sport</span><span class="p">;</span>
	<span class="n">__be16</span>				<span class="n">new_sport</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#ifndef __KERNEL__</span>
<span class="cm">/* backwards compatibility for userspace */</span>
<span class="cp">#define XFRMGRP_ACQUIRE		1</span>
<span class="cp">#define XFRMGRP_EXPIRE		2</span>
<span class="cp">#define XFRMGRP_SA		4</span>
<span class="cp">#define XFRMGRP_POLICY		8</span>
<span class="cp">#define XFRMGRP_REPORT		0x20</span>
<span class="cp">#endif</span>

<span class="k">enum</span> <span class="n">xfrm_nlgroups</span> <span class="p">{</span>
	<span class="n">XFRMNLGRP_NONE</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_NONE		XFRMNLGRP_NONE</span>
	<span class="n">XFRMNLGRP_ACQUIRE</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_ACQUIRE	XFRMNLGRP_ACQUIRE</span>
	<span class="n">XFRMNLGRP_EXPIRE</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_EXPIRE	XFRMNLGRP_EXPIRE</span>
	<span class="n">XFRMNLGRP_SA</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_SA		XFRMNLGRP_SA</span>
	<span class="n">XFRMNLGRP_POLICY</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_POLICY	XFRMNLGRP_POLICY</span>
	<span class="n">XFRMNLGRP_AEVENTS</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_AEVENTS	XFRMNLGRP_AEVENTS</span>
	<span class="n">XFRMNLGRP_REPORT</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_REPORT	XFRMNLGRP_REPORT</span>
	<span class="n">XFRMNLGRP_MIGRATE</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_MIGRATE	XFRMNLGRP_MIGRATE</span>
	<span class="n">XFRMNLGRP_MAPPING</span><span class="p">,</span>
<span class="cp">#define XFRMNLGRP_MAPPING	XFRMNLGRP_MAPPING</span>
	<span class="n">__XFRMNLGRP_MAX</span>
<span class="p">};</span>
<span class="cp">#define XFRMNLGRP_MAX	(__XFRMNLGRP_MAX - 1)</span>

<span class="cp">#endif </span><span class="cm">/* _LINUX_XFRM_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
