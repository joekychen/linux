<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › mmc › mmc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>mmc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Header for MultiMediaCard (MMC)</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2002 Hewlett-Packard Company</span>
<span class="cm"> *</span>
<span class="cm"> * Use consistent with the GNU GPL is permitted,</span>
<span class="cm"> * provided that this copyright notice is</span>
<span class="cm"> * preserved in its entirety in all copies and derived works.</span>
<span class="cm"> *</span>
<span class="cm"> * HEWLETT-PACKARD COMPANY MAKES NO WARRANTIES, EXPRESSED OR IMPLIED,</span>
<span class="cm"> * AS TO THE USEFULNESS OR CORRECTNESS OF THIS CODE OR ITS</span>
<span class="cm"> * FITNESS FOR ANY PARTICULAR PURPOSE.</span>
<span class="cm"> *</span>
<span class="cm"> * Many thanks to Alessandro Rubini and Jonathan Corbet!</span>
<span class="cm"> *</span>
<span class="cm"> * Based strongly on code by:</span>
<span class="cm"> *</span>
<span class="cm"> * Author: Yong-iL Joh &lt;tolkien@mizi.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Author:  Andrew Christian</span>
<span class="cm"> *          15 May 2002</span>
<span class="cm"> */</span>

<span class="cp">#ifndef LINUX_MMC_MMC_H</span>
<span class="cp">#define LINUX_MMC_MMC_H</span>

<span class="cm">/* Standard MMC commands (4.1)           type  argument     response */</span>
   <span class="cm">/* class 1 */</span>
<span class="cp">#define MMC_GO_IDLE_STATE         0   </span><span class="cm">/* bc                          */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_OP_COND          1   </span><span class="cm">/* bcr  [31:0] OCR         R3  */</span><span class="cp"></span>
<span class="cp">#define MMC_ALL_SEND_CID          2   </span><span class="cm">/* bcr                     R2  */</span><span class="cp"></span>
<span class="cp">#define MMC_SET_RELATIVE_ADDR     3   </span><span class="cm">/* ac   [31:16] RCA        R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_SET_DSR               4   </span><span class="cm">/* bc   [31:16] RCA            */</span><span class="cp"></span>
<span class="cp">#define MMC_SLEEP_AWAKE		  5   </span><span class="cm">/* ac   [31:16] RCA 15:flg R1b */</span><span class="cp"></span>
<span class="cp">#define MMC_SWITCH                6   </span><span class="cm">/* ac   [31:0] See below   R1b */</span><span class="cp"></span>
<span class="cp">#define MMC_SELECT_CARD           7   </span><span class="cm">/* ac   [31:16] RCA        R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_EXT_CSD          8   </span><span class="cm">/* adtc                    R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_CSD              9   </span><span class="cm">/* ac   [31:16] RCA        R2  */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_CID             10   </span><span class="cm">/* ac   [31:16] RCA        R2  */</span><span class="cp"></span>
<span class="cp">#define MMC_READ_DAT_UNTIL_STOP  11   </span><span class="cm">/* adtc [31:0] dadr        R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_STOP_TRANSMISSION    12   </span><span class="cm">/* ac                      R1b */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_STATUS          13   </span><span class="cm">/* ac   [31:16] RCA        R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_BUS_TEST_R           14   </span><span class="cm">/* adtc                    R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_GO_INACTIVE_STATE    15   </span><span class="cm">/* ac   [31:16] RCA            */</span><span class="cp"></span>
<span class="cp">#define MMC_BUS_TEST_W           19   </span><span class="cm">/* adtc                    R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_SPI_READ_OCR         58   </span><span class="cm">/* spi                  spi_R3 */</span><span class="cp"></span>
<span class="cp">#define MMC_SPI_CRC_ON_OFF       59   </span><span class="cm">/* spi  [0:0] flag      spi_R1 */</span><span class="cp"></span>

  <span class="cm">/* class 2 */</span>
<span class="cp">#define MMC_SET_BLOCKLEN         16   </span><span class="cm">/* ac   [31:0] block len   R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_READ_SINGLE_BLOCK    17   </span><span class="cm">/* adtc [31:0] data addr   R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_READ_MULTIPLE_BLOCK  18   </span><span class="cm">/* adtc [31:0] data addr   R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_TUNING_BLOCK    19   </span><span class="cm">/* adtc                    R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_TUNING_BLOCK_HS200	21	</span><span class="cm">/* adtc R1  */</span><span class="cp"></span>

  <span class="cm">/* class 3 */</span>
<span class="cp">#define MMC_WRITE_DAT_UNTIL_STOP 20   </span><span class="cm">/* adtc [31:0] data addr   R1  */</span><span class="cp"></span>

  <span class="cm">/* class 4 */</span>
<span class="cp">#define MMC_SET_BLOCK_COUNT      23   </span><span class="cm">/* adtc [31:0] data addr   R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_WRITE_BLOCK          24   </span><span class="cm">/* adtc [31:0] data addr   R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_WRITE_MULTIPLE_BLOCK 25   </span><span class="cm">/* adtc                    R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_PROGRAM_CID          26   </span><span class="cm">/* adtc                    R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_PROGRAM_CSD          27   </span><span class="cm">/* adtc                    R1  */</span><span class="cp"></span>

  <span class="cm">/* class 6 */</span>
<span class="cp">#define MMC_SET_WRITE_PROT       28   </span><span class="cm">/* ac   [31:0] data addr   R1b */</span><span class="cp"></span>
<span class="cp">#define MMC_CLR_WRITE_PROT       29   </span><span class="cm">/* ac   [31:0] data addr   R1b */</span><span class="cp"></span>
<span class="cp">#define MMC_SEND_WRITE_PROT      30   </span><span class="cm">/* adtc [31:0] wpdata addr R1  */</span><span class="cp"></span>

  <span class="cm">/* class 5 */</span>
<span class="cp">#define MMC_ERASE_GROUP_START    35   </span><span class="cm">/* ac   [31:0] data addr   R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_ERASE_GROUP_END      36   </span><span class="cm">/* ac   [31:0] data addr   R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_ERASE                38   </span><span class="cm">/* ac                      R1b */</span><span class="cp"></span>

  <span class="cm">/* class 9 */</span>
<span class="cp">#define MMC_FAST_IO              39   </span><span class="cm">/* ac   &lt;Complex&gt;          R4  */</span><span class="cp"></span>
<span class="cp">#define MMC_GO_IRQ_STATE         40   </span><span class="cm">/* bcr                     R5  */</span><span class="cp"></span>

  <span class="cm">/* class 7 */</span>
<span class="cp">#define MMC_LOCK_UNLOCK          42   </span><span class="cm">/* adtc                    R1b */</span><span class="cp"></span>

  <span class="cm">/* class 8 */</span>
<span class="cp">#define MMC_APP_CMD              55   </span><span class="cm">/* ac   [31:16] RCA        R1  */</span><span class="cp"></span>
<span class="cp">#define MMC_GEN_CMD              56   </span><span class="cm">/* adtc [0] RD/WR          R1  */</span><span class="cp"></span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">mmc_op_multi</span><span class="p">(</span><span class="n">u32</span> <span class="n">opcode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">opcode</span> <span class="o">==</span> <span class="n">MMC_WRITE_MULTIPLE_BLOCK</span> <span class="o">||</span>
	       <span class="n">opcode</span> <span class="o">==</span> <span class="n">MMC_READ_MULTIPLE_BLOCK</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * MMC_SWITCH argument format:</span>
<span class="cm"> *</span>
<span class="cm"> *	[31:26] Always 0</span>
<span class="cm"> *	[25:24] Access Mode</span>
<span class="cm"> *	[23:16] Location of target Byte in EXT_CSD</span>
<span class="cm"> *	[15:08] Value Byte</span>
<span class="cm"> *	[07:03] Always 0</span>
<span class="cm"> *	[02:00] Command Set</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm">  MMC status in R1, for native mode (SPI bits are different)</span>
<span class="cm">  Type</span>
<span class="cm">	e : error bit</span>
<span class="cm">	s : status bit</span>
<span class="cm">	r : detected and set for the actual command response</span>
<span class="cm">	x : detected and set during command execution. the host must poll</span>
<span class="cm">            the card by sending status command in order to read these bits.</span>
<span class="cm">  Clear condition</span>
<span class="cm">	a : according to the card state</span>
<span class="cm">	b : always related to the previous command. Reception of</span>
<span class="cm">            a valid command will clear it (with a delay of one command)</span>
<span class="cm">	c : clear by read</span>
<span class="cm"> */</span>

<span class="cp">#define R1_OUT_OF_RANGE		(1 &lt;&lt; 31)	</span><span class="cm">/* er, c */</span><span class="cp"></span>
<span class="cp">#define R1_ADDRESS_ERROR	(1 &lt;&lt; 30)	</span><span class="cm">/* erx, c */</span><span class="cp"></span>
<span class="cp">#define R1_BLOCK_LEN_ERROR	(1 &lt;&lt; 29)	</span><span class="cm">/* er, c */</span><span class="cp"></span>
<span class="cp">#define R1_ERASE_SEQ_ERROR      (1 &lt;&lt; 28)	</span><span class="cm">/* er, c */</span><span class="cp"></span>
<span class="cp">#define R1_ERASE_PARAM		(1 &lt;&lt; 27)	</span><span class="cm">/* ex, c */</span><span class="cp"></span>
<span class="cp">#define R1_WP_VIOLATION		(1 &lt;&lt; 26)	</span><span class="cm">/* erx, c */</span><span class="cp"></span>
<span class="cp">#define R1_CARD_IS_LOCKED	(1 &lt;&lt; 25)	</span><span class="cm">/* sx, a */</span><span class="cp"></span>
<span class="cp">#define R1_LOCK_UNLOCK_FAILED	(1 &lt;&lt; 24)	</span><span class="cm">/* erx, c */</span><span class="cp"></span>
<span class="cp">#define R1_COM_CRC_ERROR	(1 &lt;&lt; 23)	</span><span class="cm">/* er, b */</span><span class="cp"></span>
<span class="cp">#define R1_ILLEGAL_COMMAND	(1 &lt;&lt; 22)	</span><span class="cm">/* er, b */</span><span class="cp"></span>
<span class="cp">#define R1_CARD_ECC_FAILED	(1 &lt;&lt; 21)	</span><span class="cm">/* ex, c */</span><span class="cp"></span>
<span class="cp">#define R1_CC_ERROR		(1 &lt;&lt; 20)	</span><span class="cm">/* erx, c */</span><span class="cp"></span>
<span class="cp">#define R1_ERROR		(1 &lt;&lt; 19)	</span><span class="cm">/* erx, c */</span><span class="cp"></span>
<span class="cp">#define R1_UNDERRUN		(1 &lt;&lt; 18)	</span><span class="cm">/* ex, c */</span><span class="cp"></span>
<span class="cp">#define R1_OVERRUN		(1 &lt;&lt; 17)	</span><span class="cm">/* ex, c */</span><span class="cp"></span>
<span class="cp">#define R1_CID_CSD_OVERWRITE	(1 &lt;&lt; 16)	</span><span class="cm">/* erx, c, CID/CSD overwrite */</span><span class="cp"></span>
<span class="cp">#define R1_WP_ERASE_SKIP	(1 &lt;&lt; 15)	</span><span class="cm">/* sx, c */</span><span class="cp"></span>
<span class="cp">#define R1_CARD_ECC_DISABLED	(1 &lt;&lt; 14)	</span><span class="cm">/* sx, a */</span><span class="cp"></span>
<span class="cp">#define R1_ERASE_RESET		(1 &lt;&lt; 13)	</span><span class="cm">/* sr, c */</span><span class="cp"></span>
<span class="cp">#define R1_STATUS(x)            (x &amp; 0xFFFFE000)</span>
<span class="cp">#define R1_CURRENT_STATE(x)	((x &amp; 0x00001E00) &gt;&gt; 9)	</span><span class="cm">/* sx, b (4 bits) */</span><span class="cp"></span>
<span class="cp">#define R1_READY_FOR_DATA	(1 &lt;&lt; 8)	</span><span class="cm">/* sx, a */</span><span class="cp"></span>
<span class="cp">#define R1_SWITCH_ERROR		(1 &lt;&lt; 7)	</span><span class="cm">/* sx, c */</span><span class="cp"></span>
<span class="cp">#define R1_APP_CMD		(1 &lt;&lt; 5)	</span><span class="cm">/* sr, c */</span><span class="cp"></span>

<span class="cp">#define R1_STATE_IDLE	0</span>
<span class="cp">#define R1_STATE_READY	1</span>
<span class="cp">#define R1_STATE_IDENT	2</span>
<span class="cp">#define R1_STATE_STBY	3</span>
<span class="cp">#define R1_STATE_TRAN	4</span>
<span class="cp">#define R1_STATE_DATA	5</span>
<span class="cp">#define R1_STATE_RCV	6</span>
<span class="cp">#define R1_STATE_PRG	7</span>
<span class="cp">#define R1_STATE_DIS	8</span>

<span class="cm">/*</span>
<span class="cm"> * MMC/SD in SPI mode reports R1 status always, and R2 for SEND_STATUS</span>
<span class="cm"> * R1 is the low order byte; R2 is the next highest byte, when present.</span>
<span class="cm"> */</span>
<span class="cp">#define R1_SPI_IDLE		(1 &lt;&lt; 0)</span>
<span class="cp">#define R1_SPI_ERASE_RESET	(1 &lt;&lt; 1)</span>
<span class="cp">#define R1_SPI_ILLEGAL_COMMAND	(1 &lt;&lt; 2)</span>
<span class="cp">#define R1_SPI_COM_CRC		(1 &lt;&lt; 3)</span>
<span class="cp">#define R1_SPI_ERASE_SEQ	(1 &lt;&lt; 4)</span>
<span class="cp">#define R1_SPI_ADDRESS		(1 &lt;&lt; 5)</span>
<span class="cp">#define R1_SPI_PARAMETER	(1 &lt;&lt; 6)</span>
<span class="cm">/* R1 bit 7 is always zero */</span>
<span class="cp">#define R2_SPI_CARD_LOCKED	(1 &lt;&lt; 8)</span>
<span class="cp">#define R2_SPI_WP_ERASE_SKIP	(1 &lt;&lt; 9)	</span><span class="cm">/* or lock/unlock fail */</span><span class="cp"></span>
<span class="cp">#define R2_SPI_LOCK_UNLOCK_FAIL	R2_SPI_WP_ERASE_SKIP</span>
<span class="cp">#define R2_SPI_ERROR		(1 &lt;&lt; 10)</span>
<span class="cp">#define R2_SPI_CC_ERROR		(1 &lt;&lt; 11)</span>
<span class="cp">#define R2_SPI_CARD_ECC_ERROR	(1 &lt;&lt; 12)</span>
<span class="cp">#define R2_SPI_WP_VIOLATION	(1 &lt;&lt; 13)</span>
<span class="cp">#define R2_SPI_ERASE_PARAM	(1 &lt;&lt; 14)</span>
<span class="cp">#define R2_SPI_OUT_OF_RANGE	(1 &lt;&lt; 15)	</span><span class="cm">/* or CSD overwrite */</span><span class="cp"></span>
<span class="cp">#define R2_SPI_CSD_OVERWRITE	R2_SPI_OUT_OF_RANGE</span>

<span class="cm">/* These are unpacked versions of the actual responses */</span>

<span class="k">struct</span> <span class="n">_mmc_csd</span> <span class="p">{</span>
	<span class="n">u8</span>  <span class="n">csd_structure</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">spec_vers</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">taac</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">nsac</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">tran_speed</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">ccc</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">read_bl_len</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">read_bl_partial</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">write_blk_misalign</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">read_blk_misalign</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">dsr_imp</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">c_size</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">vdd_r_curr_min</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">vdd_r_curr_max</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">vdd_w_curr_min</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">vdd_w_curr_max</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">c_size_mult</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span> <span class="cm">/* MMC system specification version 3.1 */</span>
			<span class="n">u8</span>  <span class="n">erase_grp_size</span><span class="p">;</span>
			<span class="n">u8</span>  <span class="n">erase_grp_mult</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">v31</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span> <span class="cm">/* MMC system specification version 2.2 */</span>
			<span class="n">u8</span>  <span class="n">sector_size</span><span class="p">;</span>
			<span class="n">u8</span>  <span class="n">erase_grp_size</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">v22</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">erase</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">wp_grp_size</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">wp_grp_enable</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">default_ecc</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">r2w_factor</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">write_bl_len</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">write_bl_partial</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">file_format_grp</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">copy</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">perm_write_protect</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">tmp_write_protect</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">file_format</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">ecc</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * OCR bits are mostly in host.h</span>
<span class="cm"> */</span>
<span class="cp">#define MMC_CARD_BUSY	0x80000000	</span><span class="cm">/* Card Power up status bit */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Card Command Classes (CCC)</span>
<span class="cm"> */</span>
<span class="cp">#define CCC_BASIC		(1&lt;&lt;0)	</span><span class="cm">/* (0) Basic protocol functions */</span><span class="cp"></span>
					<span class="cm">/* (CMD0,1,2,3,4,7,9,10,12,13,15) */</span>
					<span class="cm">/* (and for SPI, CMD58,59) */</span>
<span class="cp">#define CCC_STREAM_READ		(1&lt;&lt;1)	</span><span class="cm">/* (1) Stream read commands */</span><span class="cp"></span>
					<span class="cm">/* (CMD11) */</span>
<span class="cp">#define CCC_BLOCK_READ		(1&lt;&lt;2)	</span><span class="cm">/* (2) Block read commands */</span><span class="cp"></span>
					<span class="cm">/* (CMD16,17,18) */</span>
<span class="cp">#define CCC_STREAM_WRITE	(1&lt;&lt;3)	</span><span class="cm">/* (3) Stream write commands */</span><span class="cp"></span>
					<span class="cm">/* (CMD20) */</span>
<span class="cp">#define CCC_BLOCK_WRITE		(1&lt;&lt;4)	</span><span class="cm">/* (4) Block write commands */</span><span class="cp"></span>
					<span class="cm">/* (CMD16,24,25,26,27) */</span>
<span class="cp">#define CCC_ERASE		(1&lt;&lt;5)	</span><span class="cm">/* (5) Ability to erase blocks */</span><span class="cp"></span>
					<span class="cm">/* (CMD32,33,34,35,36,37,38,39) */</span>
<span class="cp">#define CCC_WRITE_PROT		(1&lt;&lt;6)	</span><span class="cm">/* (6) Able to write protect blocks */</span><span class="cp"></span>
					<span class="cm">/* (CMD28,29,30) */</span>
<span class="cp">#define CCC_LOCK_CARD		(1&lt;&lt;7)	</span><span class="cm">/* (7) Able to lock down card */</span><span class="cp"></span>
					<span class="cm">/* (CMD16,CMD42) */</span>
<span class="cp">#define CCC_APP_SPEC		(1&lt;&lt;8)	</span><span class="cm">/* (8) Application specific */</span><span class="cp"></span>
					<span class="cm">/* (CMD55,56,57,ACMD*) */</span>
<span class="cp">#define CCC_IO_MODE		(1&lt;&lt;9)	</span><span class="cm">/* (9) I/O mode */</span><span class="cp"></span>
					<span class="cm">/* (CMD5,39,40,52,53) */</span>
<span class="cp">#define CCC_SWITCH		(1&lt;&lt;10)	</span><span class="cm">/* (10) High speed switch */</span><span class="cp"></span>
					<span class="cm">/* (CMD6,34,35,36,37,50) */</span>
					<span class="cm">/* (11) Reserved */</span>
					<span class="cm">/* (CMD?) */</span>

<span class="cm">/*</span>
<span class="cm"> * CSD field definitions</span>
<span class="cm"> */</span>

<span class="cp">#define CSD_STRUCT_VER_1_0  0           </span><span class="cm">/* Valid for system specification 1.0 - 1.2 */</span><span class="cp"></span>
<span class="cp">#define CSD_STRUCT_VER_1_1  1           </span><span class="cm">/* Valid for system specification 1.4 - 2.2 */</span><span class="cp"></span>
<span class="cp">#define CSD_STRUCT_VER_1_2  2           </span><span class="cm">/* Valid for system specification 3.1 - 3.2 - 3.31 - 4.0 - 4.1 */</span><span class="cp"></span>
<span class="cp">#define CSD_STRUCT_EXT_CSD  3           </span><span class="cm">/* Version is coded in CSD_STRUCTURE in EXT_CSD */</span><span class="cp"></span>

<span class="cp">#define CSD_SPEC_VER_0      0           </span><span class="cm">/* Implements system specification 1.0 - 1.2 */</span><span class="cp"></span>
<span class="cp">#define CSD_SPEC_VER_1      1           </span><span class="cm">/* Implements system specification 1.4 */</span><span class="cp"></span>
<span class="cp">#define CSD_SPEC_VER_2      2           </span><span class="cm">/* Implements system specification 2.0 - 2.2 */</span><span class="cp"></span>
<span class="cp">#define CSD_SPEC_VER_3      3           </span><span class="cm">/* Implements system specification 3.1 - 3.2 - 3.31 */</span><span class="cp"></span>
<span class="cp">#define CSD_SPEC_VER_4      4           </span><span class="cm">/* Implements system specification 4.0 - 4.1 */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * EXT_CSD fields</span>
<span class="cm"> */</span>

<span class="cp">#define EXT_CSD_FLUSH_CACHE		32      </span><span class="cm">/* W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_CACHE_CTRL		33      </span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_POWER_OFF_NOTIFICATION	34	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_DATA_SECTOR_SIZE	61	</span><span class="cm">/* R */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_GP_SIZE_MULT		143	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PARTITION_ATTRIBUTE	156	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PARTITION_SUPPORT	160	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_HPI_MGMT		161	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_RST_N_FUNCTION		162	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_SANITIZE_START		165     </span><span class="cm">/* W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_WR_REL_PARAM		166	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_BOOT_WP			173	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_ERASE_GROUP_DEF		175	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PART_CONFIG		179	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_ERASED_MEM_CONT		181	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_BUS_WIDTH		183	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_HS_TIMING		185	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_POWER_CLASS		187	</span><span class="cm">/* R/W */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_REV			192	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_STRUCTURE		194	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_CARD_TYPE		196	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_OUT_OF_INTERRUPT_TIME	198	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PART_SWITCH_TIME        199     </span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_52_195		200	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_26_195		201	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_52_360		202	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_26_360		203	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_SEC_CNT			212	</span><span class="cm">/* RO, 4 bytes */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_S_A_TIMEOUT		217	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_REL_WR_SEC_C		222	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_HC_WP_GRP_SIZE		221	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_ERASE_TIMEOUT_MULT	223	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_HC_ERASE_GRP_SIZE	224	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_BOOT_MULT		226	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_SEC_TRIM_MULT		229	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_SEC_ERASE_MULT		230	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_SEC_FEATURE_SUPPORT	231	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_TRIM_MULT		232	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_200_195		236	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_200_360		237	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_DDR_52_195	238	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_DDR_52_360	239	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_POWER_OFF_LONG_TIME	247	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_GENERIC_CMD6_TIME	248	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_CACHE_SIZE		249	</span><span class="cm">/* RO, 4 bytes */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_TAG_UNIT_SIZE		498	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_DATA_TAG_SUPPORT	499	</span><span class="cm">/* RO */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_HPI_FEATURES		503	</span><span class="cm">/* RO */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * EXT_CSD field definitions</span>
<span class="cm"> */</span>

<span class="cp">#define EXT_CSD_WR_REL_PARAM_EN		(1&lt;&lt;2)</span>

<span class="cp">#define EXT_CSD_BOOT_WP_B_PWR_WP_DIS	(0x40)</span>
<span class="cp">#define EXT_CSD_BOOT_WP_B_PERM_WP_DIS	(0x10)</span>
<span class="cp">#define EXT_CSD_BOOT_WP_B_PERM_WP_EN	(0x04)</span>
<span class="cp">#define EXT_CSD_BOOT_WP_B_PWR_WP_EN	(0x01)</span>

<span class="cp">#define EXT_CSD_PART_CONFIG_ACC_MASK	(0x7)</span>
<span class="cp">#define EXT_CSD_PART_CONFIG_ACC_BOOT0	(0x1)</span>
<span class="cp">#define EXT_CSD_PART_CONFIG_ACC_GP0	(0x4)</span>

<span class="cp">#define EXT_CSD_PART_SUPPORT_PART_EN	(0x1)</span>

<span class="cp">#define EXT_CSD_CMD_SET_NORMAL		(1&lt;&lt;0)</span>
<span class="cp">#define EXT_CSD_CMD_SET_SECURE		(1&lt;&lt;1)</span>
<span class="cp">#define EXT_CSD_CMD_SET_CPSECURE	(1&lt;&lt;2)</span>

<span class="cp">#define EXT_CSD_CARD_TYPE_26	(1&lt;&lt;0)	</span><span class="cm">/* Card can run at 26MHz */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_CARD_TYPE_52	(1&lt;&lt;1)	</span><span class="cm">/* Card can run at 52MHz */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_CARD_TYPE_MASK	0x3F	</span><span class="cm">/* Mask out reserved bits */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_CARD_TYPE_DDR_1_8V  (1&lt;&lt;2)   </span><span class="cm">/* Card can run at 52MHz */</span><span class="cp"></span>
					     <span class="cm">/* DDR mode @1.8V or 3V I/O */</span>
<span class="cp">#define EXT_CSD_CARD_TYPE_DDR_1_2V  (1&lt;&lt;3)   </span><span class="cm">/* Card can run at 52MHz */</span><span class="cp"></span>
					     <span class="cm">/* DDR mode @1.2V I/O */</span>
<span class="cp">#define EXT_CSD_CARD_TYPE_DDR_52       (EXT_CSD_CARD_TYPE_DDR_1_8V  \</span>
<span class="cp">					| EXT_CSD_CARD_TYPE_DDR_1_2V)</span>
<span class="cp">#define EXT_CSD_CARD_TYPE_SDR_1_8V	(1&lt;&lt;4)	</span><span class="cm">/* Card can run at 200MHz */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_CARD_TYPE_SDR_1_2V	(1&lt;&lt;5)	</span><span class="cm">/* Card can run at 200MHz */</span><span class="cp"></span>
						<span class="cm">/* SDR mode @1.2V I/O */</span>

<span class="cp">#define EXT_CSD_BUS_WIDTH_1	0	</span><span class="cm">/* Card is in 1 bit mode */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_BUS_WIDTH_4	1	</span><span class="cm">/* Card is in 4 bit mode */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_BUS_WIDTH_8	2	</span><span class="cm">/* Card is in 8 bit mode */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_DDR_BUS_WIDTH_4	5	</span><span class="cm">/* Card is in 4 bit DDR mode */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_DDR_BUS_WIDTH_8	6	</span><span class="cm">/* Card is in 8 bit DDR mode */</span><span class="cp"></span>

<span class="cp">#define EXT_CSD_SEC_ER_EN	BIT(0)</span>
<span class="cp">#define EXT_CSD_SEC_BD_BLK_EN	BIT(2)</span>
<span class="cp">#define EXT_CSD_SEC_GB_CL_EN	BIT(4)</span>
<span class="cp">#define EXT_CSD_SEC_SANITIZE	BIT(6)  </span><span class="cm">/* v4.5 only */</span><span class="cp"></span>

<span class="cp">#define EXT_CSD_RST_N_EN_MASK	0x3</span>
<span class="cp">#define EXT_CSD_RST_N_ENABLED	1	</span><span class="cm">/* RST_n is enabled on card */</span><span class="cp"></span>

<span class="cp">#define EXT_CSD_NO_POWER_NOTIFICATION	0</span>
<span class="cp">#define EXT_CSD_POWER_ON		1</span>
<span class="cp">#define EXT_CSD_POWER_OFF_SHORT		2</span>
<span class="cp">#define EXT_CSD_POWER_OFF_LONG		3</span>

<span class="cp">#define EXT_CSD_PWR_CL_8BIT_MASK	0xF0	</span><span class="cm">/* 8 bit PWR CLS */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_4BIT_MASK	0x0F	</span><span class="cm">/* 8 bit PWR CLS */</span><span class="cp"></span>
<span class="cp">#define EXT_CSD_PWR_CL_8BIT_SHIFT	4</span>
<span class="cp">#define EXT_CSD_PWR_CL_4BIT_SHIFT	0</span>
<span class="cm">/*</span>
<span class="cm"> * MMC_SWITCH access modes</span>
<span class="cm"> */</span>

<span class="cp">#define MMC_SWITCH_MODE_CMD_SET		0x00	</span><span class="cm">/* Change the command set */</span><span class="cp"></span>
<span class="cp">#define MMC_SWITCH_MODE_SET_BITS	0x01	</span><span class="cm">/* Set bits which are 1 in value */</span><span class="cp"></span>
<span class="cp">#define MMC_SWITCH_MODE_CLEAR_BITS	0x02	</span><span class="cm">/* Clear bits which are 1 in value */</span><span class="cp"></span>
<span class="cp">#define MMC_SWITCH_MODE_WRITE_BYTE	0x03	</span><span class="cm">/* Set target to value */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* LINUX_MMC_MMC_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
