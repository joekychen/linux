f | card.h | s | 15K | 436 | Seungwon Jeon | tgih.jun@samsung.com | 1336572201 |  | mmc: core: fix the decision of HS200/DDR card-type  Current implementation decides the card type exclusively. Even though eMMC device can support both HS200 and DDR mode, card type will be set only for HS200. If the host doesn't support HS200 but has DDR capability, then DDR mode can't be selected.  Signed-off-by: Seungwon Jeon <tgih.jun@samsung.com> Reviewed-by: Subhash Jadavani <subhashj@codeaurora.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | mmc.h | s | 14K | 350 | Seungwon Jeon | tgih.jun@samsung.com | 1336572201 |  | mmc: core: fix the decision of HS200/DDR card-type  Current implementation decides the card type exclusively. Even though eMMC device can support both HS200 and DDR mode, card type will be set only for HS200. If the host doesn't support HS200 but has DDR capability, then DDR mode can't be selected.  Signed-off-by: Seungwon Jeon <tgih.jun@samsung.com> Reviewed-by: Subhash Jadavani <subhashj@codeaurora.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sh_mobile_sdhi.h | s | 1.0K | 31 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1332865219 |  | mmc: sh_mobile_sdhi: support modular mmc-core with non-standard hotplug  Currently if a platform wants to implement a non-standard card-detection method, it would need to call tmio_mmc_cd_wakeup(), which is an inline function, calling mmc_detect_change(). For this the platform would have to link mmc_core statically into the kernel, losing the ability to build it as a module. This patch adds a callback to the sh_mobile_sdhi driver, which eliminates this dependency.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Magnus Damm <damm@opensource.se> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdio.h | s | 6.2K | 150 | Yong Ding | yongd@marvell.com | 1338988973 |  | mmc: sdio: fix setting card data bus width as 4-bit  SDIO_CCCR_IF[1:0] in SDIO card is used for card data bus width setting as below:       00b: 1-bit bus      01b: Reserved      10b: 4-bit bus      11b: 8-bit bus (only for embedded SDIO)  And sdio_enable_wide is for setting data bus width as 4-bit. But currently, it first reads the register, second OR' 1b with SDIO_CCCR_IF[1], and then writes it back.  As we can see, this is based on such assumption that the SDIO_CCCR_IF[0] is always 0. Apparently, this is not right.  Signed-off-by: Yong Ding <yongd@marvell.com> Acked-by: Philip Rakity <prakity@marvell.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | host.h | s | 14K | 356 | Nicolas Pitre | nicolas.pitre@linaro.org | 1335107848 |  | mmc: sdio: avoid spurious calls to interrupt handlers  Commit 06e8935feb ("optimized SDIO IRQ handling for single irq") introduced some spurious calls to SDIO function interrupt handlers, such as when the SDIO IRQ thread is started, or the safety check performed upon a system resume.  Let's add a flag to perform the optimization only when a real interrupt is signaled by the host driver and we know there is no point confirming it.  Reported-by: Sujit Reddy Thumma <sthumma@codeaurora.org> Signed-off-by: Nicolas Pitre <nico@linaro.org> Cc: stable <stable@vger.kernel.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | core.h | s | 6.8K | 163 | Linus Torvalds | torvalds@linux-foundation.org | 1332993585 |  | 
f | sdhci-spear.h | s | 1.2K | 38 | Viresh Kumar | viresh.linux@gmail.com | 1340228376 |  | Viresh has moved  viresh.kumar@st.com email-id doesn't exist anymore as I have left the company.  Replace ST's id with viresh.linux@gmail.com.  It also updates .mailmap file to fix address for 'git shortlog'  Signed-off-by: Viresh Kumar <viresh.linux@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | boot.h | s | 175B | 5 | Robert P. J. Day | rpjday@crashcourse.ca | 1311196848 |  | mmc: Standardize header file inclusion checks.  Standardize the checks for multiple MMC header file inclusion, including adding comments to terminating #endif's, and fixing one incorrect comment.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sh_mmcif.h | s | 5.9K | 183 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1332865220 |  | mmc: sh_mmcif: simplify bitmask macros  Purely cosmetic readability improvement, no functional change.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sd.h | s | 2.7K | 79 | Robert P. J. Day | rpjday@crashcourse.ca | 1311196848 |  | mmc: Standardize header file inclusion checks.  Standardize the checks for multiple MMC header file inclusion, including adding comments to terminating #endif's, and fixing one incorrect comment.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Signed-off-by: Chris Ball <cjb@laptop.org>
f | pm.h | s | 1.0K | 25 | Robert P. J. Day | rpjday@crashcourse.ca | 1311196848 |  | mmc: Standardize header file inclusion checks.  Standardize the checks for multiple MMC header file inclusion, including adding comments to terminating #endif's, and fixing one incorrect comment.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Signed-off-by: Chris Ball <cjb@laptop.org>
f | Kbuild | g | 20B |  | John Calixto | john.calixto@modsystems.com | 1306285374 |  | mmc: core: Add mmc CMD+ACMD passthrough ioctl  Allows appropriately-privileged applications to send CMD (normal) and ACMD (application-specific; preceded with CMD55) commands to cards/devices on the mmc bus.  This is primarily useful for enabling the security functionality built in to every SD card.  It can also be used as a generic passthrough (e.g. to enable virtual machines to control mmc bus devices directly).  However, this use case has not been tested rigorously.  Generic passthrough testing was only conducted for a few non-security opcodes to prove the feasibility of the passthrough.  Since any opcode can be sent using this passthrough, it is very possible to render the card/device unusable.  Applications that use this ioctl must have CAP_SYS_RAWIO.  Security commands tested on TI PCIxx12 (SDHCI), Sigma Designs SMP8652 SoC, TI OMAP3621/OMAP3630 SoC, Samsung S5PC110 SoC, Qualcomm MSM7200A SoC.  Signed-off-by: John Calixto <john.calixto@modsystems.com> Reviewed-by: Andrei Warkentin <andreiw@motorola.com> Reviewed-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | cd-gpio.h | s | 495B | 15 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1332865214 |  | mmc: simplify mmc_cd_gpio_request() by removing two parameters  Calculate the IRQ number, using gpio_to_irq() and use fixed flags: trigger on both edges. This makes two out of four arguments of the mmc_cd_gpio_request() function redundant.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | tmio.h | s | 2.1K | 61 | Simon Horman | horms@verge.net.au | 1311196857 |  | mmc: sdhi: Add write16_hook  Some controllers require waiting for the bus to become idle before writing to some registers. I have implemented this by adding a hook to sd_ctrl_write16() and implementing a hook for SDHI which waits for the bus to become idle.  Cc: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Cc: Magnus Damm <magnus.damm@gmail.com> Signed-off-by: Simon Horman <horms@verge.net.au> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdio_ids.h | s | 1.7K | 40 | Robert P. J. Day | rpjday@crashcourse.ca | 1311196848 |  | mmc: Standardize header file inclusion checks.  Standardize the checks for multiple MMC header file inclusion, including adding comments to terminating #endif's, and fixing one incorrect comment.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Signed-off-by: Chris Ball <cjb@laptop.org>
f | mxs-mmc.h | s | 537B | 16 | Shawn Guo | shawn.guo@linaro.org | 1336867538 |  | mmc: mxs-mmc: move header from mach into linux folder  Rename arch/arm/mach-mxs/include/mach/mmc.h to include/linux/mmc/mxs-mmc.h, so that mxs-mmc driver becomes <mach/*> inclusion free.  Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Marek Vasut <marex@denx.de> Acked-by: Chris Ball <cjb@laptop.org>
f | dw_mmc.h | s | 7.9K | 227 | Thomas Abraham | thomas.abraham@linaro.org | 1336572850 |  | mmc: dw_mmc: make multiple instances of dw_mci_card_workqueue  The variable 'dw_mci_card_workqueue' is a global variable shared between multiple instances of the dw_mmc host controller. Due to this, data corruption has been noticed when multiple instances of dw_mmc controllers are actively reading/writing the media. Fix this by adding a instance of 'struct workqueue_struct' for each host instance and removing the global 'dw_mci_card_workqueue' instance.  Signed-off-by: Thomas Abraham <thomas.abraham@linaro.org> Acked-by: Jaehoon Chung <jh80.chung@samsung.com> Acked-by: Will Newton <will.newton@imgtec.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci.h | s | 7.1K | 145 | Adrian Hunter | adrian.hunter@intel.com | 1332865208 |  | mmc: sdhci: add quirk for keeping card power during suspend  Add quirk SDHCI_QUIRK2_HOST_OFF_CARD_ON to cater for the case when the card keeps power during suspend but the host controller does not i.e. the card power is not controlled by the host controller.  In that case, the controller must be fully reset on resume.  Signed-off-by: Adrian Hunter <adrian.hunter@intel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | ioctl.h | s | 1.6K | 47 | Bobby Powers | bobbypowers@gmail.com | 1332547111 |  | headers: include linux/types.h where appropriate  This addresses some header check warnings.  DRM headers which include "drm.h" have been excluded, as they indirectly include types.h.  Signed-off-by: Bobby Powers <bobbypowers@gmail.com> Cc: Chris Ball <cjb@laptop.org> Cc: Dave Airlie <airlied@linux.ie> Cc: James Bottomley <James.Bottomley@HansenPartnership.com> Cc: Takashi Iwai <tiwai@suse.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sdhci-pci-data.h | s | 443B | 14 | Adrian Hunter | adrian.hunter@intel.com | 1326344327 |  | mmc: sdhci-pci: add platform data  Add a means of getting platform data for the SDHCI PCI devices.  The data is stored against the slot not the device in order to support multi-slot devices.  The data allows platform-specific setup (such as getting GPIO numbers from firmware or setting up wl12xx for SDIO) to be done in platform support files instead of the sdhci-pci driver.  Signed-off-by: Adrian Hunter <adrian.hunter@intel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdio_func.h | s | 5.0K | 126 | Robert P. J. Day | rpjday@crashcourse.ca | 1311196848 |  | mmc: Standardize header file inclusion checks.  Standardize the checks for multiple MMC header file inclusion, including adding comments to terminating #endif's, and fixing one incorrect comment.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Signed-off-by: Chris Ball <cjb@laptop.org>
