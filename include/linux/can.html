<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › can.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>can.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * linux/can.h</span>
<span class="cm"> *</span>
<span class="cm"> * Definitions for CAN network layer (socket addr / CAN frame / CAN filter)</span>
<span class="cm"> *</span>
<span class="cm"> * Authors: Oliver Hartkopp &lt;oliver.hartkopp@volkswagen.de&gt;</span>
<span class="cm"> *          Urs Thuermann   &lt;urs.thuermann@volkswagen.de&gt;</span>
<span class="cm"> * Copyright (c) 2002-2007 Volkswagen Group Electronic Research</span>
<span class="cm"> * All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef CAN_H</span>
<span class="cp">#define CAN_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/socket.h&gt;</span>

<span class="cm">/* controller area network (CAN) kernel definitions */</span>

<span class="cm">/* special address description flags for the CAN_ID */</span>
<span class="cp">#define CAN_EFF_FLAG 0x80000000U </span><span class="cm">/* EFF/SFF is set in the MSB */</span><span class="cp"></span>
<span class="cp">#define CAN_RTR_FLAG 0x40000000U </span><span class="cm">/* remote transmission request */</span><span class="cp"></span>
<span class="cp">#define CAN_ERR_FLAG 0x20000000U </span><span class="cm">/* error frame */</span><span class="cp"></span>

<span class="cm">/* valid bits in CAN ID for frame formats */</span>
<span class="cp">#define CAN_SFF_MASK 0x000007FFU </span><span class="cm">/* standard frame format (SFF) */</span><span class="cp"></span>
<span class="cp">#define CAN_EFF_MASK 0x1FFFFFFFU </span><span class="cm">/* extended frame format (EFF) */</span><span class="cp"></span>
<span class="cp">#define CAN_ERR_MASK 0x1FFFFFFFU </span><span class="cm">/* omit EFF, RTR, ERR flags */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Controller Area Network Identifier structure</span>
<span class="cm"> *</span>
<span class="cm"> * bit 0-28	: CAN identifier (11/29 bit)</span>
<span class="cm"> * bit 29	: error frame flag (0 = data frame, 1 = error frame)</span>
<span class="cm"> * bit 30	: remote transmission request flag (1 = rtr frame)</span>
<span class="cm"> * bit 31	: frame format flag (0 = standard 11 bit, 1 = extended 29 bit)</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="n">__u32</span> <span class="n">canid_t</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Controller Area Network Error Frame Mask structure</span>
<span class="cm"> *</span>
<span class="cm"> * bit 0-28	: error class mask (see include/linux/can/error.h)</span>
<span class="cm"> * bit 29-31	: set to zero</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="n">__u32</span> <span class="n">can_err_mask_t</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * struct can_frame - basic CAN frame structure</span>
<span class="cm"> * @can_id:  the CAN ID of the frame and CAN_*_FLAG flags, see above.</span>
<span class="cm"> * @can_dlc: the data length field of the CAN frame</span>
<span class="cm"> * @data:    the CAN frame payload.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">can_frame</span> <span class="p">{</span>
	<span class="n">canid_t</span> <span class="n">can_id</span><span class="p">;</span>  <span class="cm">/* 32 bit CAN_ID + EFF/RTR/ERR flags */</span>
	<span class="n">__u8</span>    <span class="n">can_dlc</span><span class="p">;</span> <span class="cm">/* data length code: 0 .. 8 */</span>
	<span class="n">__u8</span>    <span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">aligned</span><span class="p">(</span><span class="mi">8</span><span class="p">)));</span>
<span class="p">};</span>

<span class="cm">/* particular protocols of the protocol family PF_CAN */</span>
<span class="cp">#define CAN_RAW		1 </span><span class="cm">/* RAW sockets */</span><span class="cp"></span>
<span class="cp">#define CAN_BCM		2 </span><span class="cm">/* Broadcast Manager */</span><span class="cp"></span>
<span class="cp">#define CAN_TP16	3 </span><span class="cm">/* VAG Transport Protocol v1.6 */</span><span class="cp"></span>
<span class="cp">#define CAN_TP20	4 </span><span class="cm">/* VAG Transport Protocol v2.0 */</span><span class="cp"></span>
<span class="cp">#define CAN_MCNET	5 </span><span class="cm">/* Bosch MCNet */</span><span class="cp"></span>
<span class="cp">#define CAN_ISOTP	6 </span><span class="cm">/* ISO 15765-2 Transport Protocol */</span><span class="cp"></span>
<span class="cp">#define CAN_NPROTO	7</span>

<span class="cp">#define SOL_CAN_BASE 100</span>

<span class="cm">/**</span>
<span class="cm"> * struct sockaddr_can - the sockaddr structure for CAN sockets</span>
<span class="cm"> * @can_family:  address family number AF_CAN.</span>
<span class="cm"> * @can_ifindex: CAN network interface index.</span>
<span class="cm"> * @can_addr:    protocol specific address information</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">sockaddr_can</span> <span class="p">{</span>
	<span class="n">__kernel_sa_family_t</span> <span class="n">can_family</span><span class="p">;</span>
	<span class="kt">int</span>         <span class="n">can_ifindex</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="cm">/* transport protocol class address information (e.g. ISOTP) */</span>
		<span class="k">struct</span> <span class="p">{</span> <span class="n">canid_t</span> <span class="n">rx_id</span><span class="p">,</span> <span class="n">tx_id</span><span class="p">;</span> <span class="p">}</span> <span class="n">tp</span><span class="p">;</span>

		<span class="cm">/* reserved for future CAN protocols address information */</span>
	<span class="p">}</span> <span class="n">can_addr</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct can_filter - CAN ID based filter in can_register().</span>
<span class="cm"> * @can_id:   relevant bits of CAN ID which are not masked out.</span>
<span class="cm"> * @can_mask: CAN mask (see description)</span>
<span class="cm"> *</span>
<span class="cm"> * Description:</span>
<span class="cm"> * A filter matches, when</span>
<span class="cm"> *</span>
<span class="cm"> *          &lt;received_can_id&gt; &amp; mask == can_id &amp; mask</span>
<span class="cm"> *</span>
<span class="cm"> * The filter can be inverted (CAN_INV_FILTER bit set in can_id) or it can</span>
<span class="cm"> * filter for error frames (CAN_ERR_FLAG bit set in mask).</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">can_filter</span> <span class="p">{</span>
	<span class="n">canid_t</span> <span class="n">can_id</span><span class="p">;</span>
	<span class="n">canid_t</span> <span class="n">can_mask</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define CAN_INV_FILTER 0x20000000U </span><span class="cm">/* to be set in can_filter.can_id */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* CAN_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
