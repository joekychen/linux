<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › audit.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>audit.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* audit.h -- Auditing support</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2003-2004 Red Hat Inc., Durham, North Carolina.</span>
<span class="cm"> * All Rights Reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="cm"> *</span>
<span class="cm"> * Written by Rickard E. (Rik) Faith &lt;faith@redhat.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_AUDIT_H_</span>
<span class="cp">#define _LINUX_AUDIT_H_</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/elf-em.h&gt;</span>
<span class="cp">#include &lt;linux/ptrace.h&gt;</span>

<span class="cm">/* The netlink messages for the audit system is divided into blocks:</span>
<span class="cm"> * 1000 - 1099 are for commanding the audit system</span>
<span class="cm"> * 1100 - 1199 user space trusted application messages</span>
<span class="cm"> * 1200 - 1299 messages internal to the audit daemon</span>
<span class="cm"> * 1300 - 1399 audit event messages</span>
<span class="cm"> * 1400 - 1499 SE Linux use</span>
<span class="cm"> * 1500 - 1599 kernel LSPP events</span>
<span class="cm"> * 1600 - 1699 kernel crypto events</span>
<span class="cm"> * 1700 - 1799 kernel anomaly records</span>
<span class="cm"> * 1800 - 1899 kernel integrity events</span>
<span class="cm"> * 1900 - 1999 future kernel use</span>
<span class="cm"> * 2000 is for otherwise unclassified kernel audit messages (legacy)</span>
<span class="cm"> * 2001 - 2099 unused (kernel)</span>
<span class="cm"> * 2100 - 2199 user space anomaly records</span>
<span class="cm"> * 2200 - 2299 user space actions taken in response to anomalies</span>
<span class="cm"> * 2300 - 2399 user space generated LSPP events</span>
<span class="cm"> * 2400 - 2499 user space crypto events</span>
<span class="cm"> * 2500 - 2999 future user space (maybe integrity labels and related events)</span>
<span class="cm"> *</span>
<span class="cm"> * Messages from 1000-1199 are bi-directional. 1200-1299 &amp; 2100 - 2999 are</span>
<span class="cm"> * exclusively user space. 1300-2099 is kernel --&gt; user space </span>
<span class="cm"> * communication.</span>
<span class="cm"> */</span>
<span class="cp">#define AUDIT_GET		1000	</span><span class="cm">/* Get status */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SET		1001	</span><span class="cm">/* Set status (enable/disable/auditd) */</span><span class="cp"></span>
<span class="cp">#define AUDIT_LIST		1002	</span><span class="cm">/* List syscall rules -- deprecated */</span><span class="cp"></span>
<span class="cp">#define AUDIT_ADD		1003	</span><span class="cm">/* Add syscall rule -- deprecated */</span><span class="cp"></span>
<span class="cp">#define AUDIT_DEL		1004	</span><span class="cm">/* Delete syscall rule -- deprecated */</span><span class="cp"></span>
<span class="cp">#define AUDIT_USER		1005	</span><span class="cm">/* Message from userspace -- deprecated */</span><span class="cp"></span>
<span class="cp">#define AUDIT_LOGIN		1006	</span><span class="cm">/* Define the login id and information */</span><span class="cp"></span>
<span class="cp">#define AUDIT_WATCH_INS		1007	</span><span class="cm">/* Insert file/dir watch entry */</span><span class="cp"></span>
<span class="cp">#define AUDIT_WATCH_REM		1008	</span><span class="cm">/* Remove file/dir watch entry */</span><span class="cp"></span>
<span class="cp">#define AUDIT_WATCH_LIST	1009	</span><span class="cm">/* List all file/dir watches */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SIGNAL_INFO	1010	</span><span class="cm">/* Get info about sender of signal to auditd */</span><span class="cp"></span>
<span class="cp">#define AUDIT_ADD_RULE		1011	</span><span class="cm">/* Add syscall filtering rule */</span><span class="cp"></span>
<span class="cp">#define AUDIT_DEL_RULE		1012	</span><span class="cm">/* Delete syscall filtering rule */</span><span class="cp"></span>
<span class="cp">#define AUDIT_LIST_RULES	1013	</span><span class="cm">/* List syscall filtering rules */</span><span class="cp"></span>
<span class="cp">#define AUDIT_TRIM		1014	</span><span class="cm">/* Trim junk from watched tree */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAKE_EQUIV	1015	</span><span class="cm">/* Append to watched tree */</span><span class="cp"></span>
<span class="cp">#define AUDIT_TTY_GET		1016	</span><span class="cm">/* Get TTY auditing status */</span><span class="cp"></span>
<span class="cp">#define AUDIT_TTY_SET		1017	</span><span class="cm">/* Set TTY auditing status */</span><span class="cp"></span>

<span class="cp">#define AUDIT_FIRST_USER_MSG	1100	</span><span class="cm">/* Userspace messages mostly uninteresting to kernel */</span><span class="cp"></span>
<span class="cp">#define AUDIT_USER_AVC		1107	</span><span class="cm">/* We filter this differently */</span><span class="cp"></span>
<span class="cp">#define AUDIT_USER_TTY		1124	</span><span class="cm">/* Non-ICANON TTY input meaning */</span><span class="cp"></span>
<span class="cp">#define AUDIT_LAST_USER_MSG	1199</span>
<span class="cp">#define AUDIT_FIRST_USER_MSG2	2100	</span><span class="cm">/* More user space messages */</span><span class="cp"></span>
<span class="cp">#define AUDIT_LAST_USER_MSG2	2999</span>
 
<span class="cp">#define AUDIT_DAEMON_START      1200    </span><span class="cm">/* Daemon startup record */</span><span class="cp"></span>
<span class="cp">#define AUDIT_DAEMON_END        1201    </span><span class="cm">/* Daemon normal stop record */</span><span class="cp"></span>
<span class="cp">#define AUDIT_DAEMON_ABORT      1202    </span><span class="cm">/* Daemon error stop record */</span><span class="cp"></span>
<span class="cp">#define AUDIT_DAEMON_CONFIG     1203    </span><span class="cm">/* Daemon config change */</span><span class="cp"></span>

<span class="cp">#define AUDIT_SYSCALL		1300	</span><span class="cm">/* Syscall event */</span><span class="cp"></span>
<span class="cm">/* #define AUDIT_FS_WATCH	1301	 * Deprecated */</span>
<span class="cp">#define AUDIT_PATH		1302	</span><span class="cm">/* Filename path information */</span><span class="cp"></span>
<span class="cp">#define AUDIT_IPC		1303	</span><span class="cm">/* IPC record */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SOCKETCALL	1304	</span><span class="cm">/* sys_socketcall arguments */</span><span class="cp"></span>
<span class="cp">#define AUDIT_CONFIG_CHANGE	1305	</span><span class="cm">/* Audit system configuration change */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SOCKADDR		1306	</span><span class="cm">/* sockaddr copied as syscall arg */</span><span class="cp"></span>
<span class="cp">#define AUDIT_CWD		1307	</span><span class="cm">/* Current working directory */</span><span class="cp"></span>
<span class="cp">#define AUDIT_EXECVE		1309	</span><span class="cm">/* execve arguments */</span><span class="cp"></span>
<span class="cp">#define AUDIT_IPC_SET_PERM	1311	</span><span class="cm">/* IPC new permissions record type */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MQ_OPEN		1312	</span><span class="cm">/* POSIX MQ open record type */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MQ_SENDRECV	1313	</span><span class="cm">/* POSIX MQ send/receive record type */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MQ_NOTIFY		1314	</span><span class="cm">/* POSIX MQ notify record type */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MQ_GETSETATTR	1315	</span><span class="cm">/* POSIX MQ get/set attribute record type */</span><span class="cp"></span>
<span class="cp">#define AUDIT_KERNEL_OTHER	1316	</span><span class="cm">/* For use by 3rd party modules */</span><span class="cp"></span>
<span class="cp">#define AUDIT_FD_PAIR		1317    </span><span class="cm">/* audit record for pipe/socketpair */</span><span class="cp"></span>
<span class="cp">#define AUDIT_OBJ_PID		1318	</span><span class="cm">/* ptrace target */</span><span class="cp"></span>
<span class="cp">#define AUDIT_TTY		1319	</span><span class="cm">/* Input on an administrative TTY */</span><span class="cp"></span>
<span class="cp">#define AUDIT_EOE		1320	</span><span class="cm">/* End of multi-record event */</span><span class="cp"></span>
<span class="cp">#define AUDIT_BPRM_FCAPS	1321	</span><span class="cm">/* Information about fcaps increasing perms */</span><span class="cp"></span>
<span class="cp">#define AUDIT_CAPSET		1322	</span><span class="cm">/* Record showing argument to sys_capset */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MMAP		1323	</span><span class="cm">/* Record showing descriptor and flags in mmap */</span><span class="cp"></span>
<span class="cp">#define AUDIT_NETFILTER_PKT	1324	</span><span class="cm">/* Packets traversing netfilter chains */</span><span class="cp"></span>
<span class="cp">#define AUDIT_NETFILTER_CFG	1325	</span><span class="cm">/* Netfilter chain modifications */</span><span class="cp"></span>

<span class="cp">#define AUDIT_AVC		1400	</span><span class="cm">/* SE Linux avc denial or grant */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SELINUX_ERR	1401	</span><span class="cm">/* Internal SE Linux Errors */</span><span class="cp"></span>
<span class="cp">#define AUDIT_AVC_PATH		1402	</span><span class="cm">/* dentry, vfsmount pair from avc */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_POLICY_LOAD	1403	</span><span class="cm">/* Policy file load */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_STATUS	1404	</span><span class="cm">/* Changed enforcing,permissive,off */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_CONFIG_CHANGE	1405	</span><span class="cm">/* Changes to booleans */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_UNLBL_ALLOW	1406	</span><span class="cm">/* NetLabel: allow unlabeled traffic */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_CIPSOV4_ADD	1407	</span><span class="cm">/* NetLabel: add CIPSOv4 DOI entry */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_CIPSOV4_DEL	1408	</span><span class="cm">/* NetLabel: del CIPSOv4 DOI entry */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_MAP_ADD	1409	</span><span class="cm">/* NetLabel: add LSM domain mapping */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_MAP_DEL	1410	</span><span class="cm">/* NetLabel: del LSM domain mapping */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_IPSEC_ADDSA	1411	</span><span class="cm">/* Not used */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_IPSEC_DELSA	1412	</span><span class="cm">/* Not used  */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_IPSEC_ADDSPD	1413	</span><span class="cm">/* Not used */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_IPSEC_DELSPD	1414	</span><span class="cm">/* Not used */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_IPSEC_EVENT	1415	</span><span class="cm">/* Audit an IPSec event */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_UNLBL_STCADD	1416	</span><span class="cm">/* NetLabel: add a static label */</span><span class="cp"></span>
<span class="cp">#define AUDIT_MAC_UNLBL_STCDEL	1417	</span><span class="cm">/* NetLabel: del a static label */</span><span class="cp"></span>

<span class="cp">#define AUDIT_FIRST_KERN_ANOM_MSG   1700</span>
<span class="cp">#define AUDIT_LAST_KERN_ANOM_MSG    1799</span>
<span class="cp">#define AUDIT_ANOM_PROMISCUOUS      1700 </span><span class="cm">/* Device changed promiscuous mode */</span><span class="cp"></span>
<span class="cp">#define AUDIT_ANOM_ABEND            1701 </span><span class="cm">/* Process ended abnormally */</span><span class="cp"></span>
<span class="cp">#define AUDIT_INTEGRITY_DATA	    1800 </span><span class="cm">/* Data integrity verification */</span><span class="cp"></span>
<span class="cp">#define AUDIT_INTEGRITY_METADATA    1801 </span><span class="cm">/* Metadata integrity verification */</span><span class="cp"></span>
<span class="cp">#define AUDIT_INTEGRITY_STATUS	    1802 </span><span class="cm">/* Integrity enable status */</span><span class="cp"></span>
<span class="cp">#define AUDIT_INTEGRITY_HASH	    1803 </span><span class="cm">/* Integrity HASH type */</span><span class="cp"></span>
<span class="cp">#define AUDIT_INTEGRITY_PCR	    1804 </span><span class="cm">/* PCR invalidation msgs */</span><span class="cp"></span>
<span class="cp">#define AUDIT_INTEGRITY_RULE	    1805 </span><span class="cm">/* policy rule */</span><span class="cp"></span>

<span class="cp">#define AUDIT_KERNEL		2000	</span><span class="cm">/* Asynchronous audit record. NOT A REQUEST. */</span><span class="cp"></span>

<span class="cm">/* Rule flags */</span>
<span class="cp">#define AUDIT_FILTER_USER	0x00	</span><span class="cm">/* Apply rule to user-generated messages */</span><span class="cp"></span>
<span class="cp">#define AUDIT_FILTER_TASK	0x01	</span><span class="cm">/* Apply rule at task creation (not syscall) */</span><span class="cp"></span>
<span class="cp">#define AUDIT_FILTER_ENTRY	0x02	</span><span class="cm">/* Apply rule at syscall entry */</span><span class="cp"></span>
<span class="cp">#define AUDIT_FILTER_WATCH	0x03	</span><span class="cm">/* Apply rule to file system watches */</span><span class="cp"></span>
<span class="cp">#define AUDIT_FILTER_EXIT	0x04	</span><span class="cm">/* Apply rule at syscall exit */</span><span class="cp"></span>
<span class="cp">#define AUDIT_FILTER_TYPE	0x05	</span><span class="cm">/* Apply rule at audit_log_start */</span><span class="cp"></span>

<span class="cp">#define AUDIT_NR_FILTERS	6</span>

<span class="cp">#define AUDIT_FILTER_PREPEND	0x10	</span><span class="cm">/* Prepend to front of list */</span><span class="cp"></span>

<span class="cm">/* Rule actions */</span>
<span class="cp">#define AUDIT_NEVER    0	</span><span class="cm">/* Do not build context if rule matches */</span><span class="cp"></span>
<span class="cp">#define AUDIT_POSSIBLE 1	</span><span class="cm">/* Build context if rule matches  */</span><span class="cp"></span>
<span class="cp">#define AUDIT_ALWAYS   2	</span><span class="cm">/* Generate audit record if rule matches */</span><span class="cp"></span>

<span class="cm">/* Rule structure sizes -- if these change, different AUDIT_ADD and</span>
<span class="cm"> * AUDIT_LIST commands must be implemented. */</span>
<span class="cp">#define AUDIT_MAX_FIELDS   64</span>
<span class="cp">#define AUDIT_MAX_KEY_LEN  256</span>
<span class="cp">#define AUDIT_BITMASK_SIZE 64</span>
<span class="cp">#define AUDIT_WORD(nr) ((__u32)((nr)/32))</span>
<span class="cp">#define AUDIT_BIT(nr)  (1 &lt;&lt; ((nr) - AUDIT_WORD(nr)*32))</span>

<span class="cp">#define AUDIT_SYSCALL_CLASSES 16</span>
<span class="cp">#define AUDIT_CLASS_DIR_WRITE 0</span>
<span class="cp">#define AUDIT_CLASS_DIR_WRITE_32 1</span>
<span class="cp">#define AUDIT_CLASS_CHATTR 2</span>
<span class="cp">#define AUDIT_CLASS_CHATTR_32 3</span>
<span class="cp">#define AUDIT_CLASS_READ 4</span>
<span class="cp">#define AUDIT_CLASS_READ_32 5</span>
<span class="cp">#define AUDIT_CLASS_WRITE 6</span>
<span class="cp">#define AUDIT_CLASS_WRITE_32 7</span>
<span class="cp">#define AUDIT_CLASS_SIGNAL 8</span>
<span class="cp">#define AUDIT_CLASS_SIGNAL_32 9</span>

<span class="cm">/* This bitmask is used to validate user input.  It represents all bits that</span>
<span class="cm"> * are currently used in an audit field constant understood by the kernel.</span>
<span class="cm"> * If you are adding a new #define AUDIT_&lt;whatever&gt;, please ensure that</span>
<span class="cm"> * AUDIT_UNUSED_BITS is updated if need be. */</span>
<span class="cp">#define AUDIT_UNUSED_BITS	0x07FFFC00</span>

<span class="cm">/* AUDIT_FIELD_COMPARE rule list */</span>
<span class="cp">#define AUDIT_COMPARE_UID_TO_OBJ_UID	1</span>
<span class="cp">#define AUDIT_COMPARE_GID_TO_OBJ_GID	2</span>
<span class="cp">#define AUDIT_COMPARE_EUID_TO_OBJ_UID	3</span>
<span class="cp">#define AUDIT_COMPARE_EGID_TO_OBJ_GID	4</span>
<span class="cp">#define AUDIT_COMPARE_AUID_TO_OBJ_UID	5</span>
<span class="cp">#define AUDIT_COMPARE_SUID_TO_OBJ_UID	6</span>
<span class="cp">#define AUDIT_COMPARE_SGID_TO_OBJ_GID	7</span>
<span class="cp">#define AUDIT_COMPARE_FSUID_TO_OBJ_UID	8</span>
<span class="cp">#define AUDIT_COMPARE_FSGID_TO_OBJ_GID	9</span>

<span class="cp">#define AUDIT_COMPARE_UID_TO_AUID	10</span>
<span class="cp">#define AUDIT_COMPARE_UID_TO_EUID	11</span>
<span class="cp">#define AUDIT_COMPARE_UID_TO_FSUID	12</span>
<span class="cp">#define AUDIT_COMPARE_UID_TO_SUID	13</span>

<span class="cp">#define AUDIT_COMPARE_AUID_TO_FSUID	14</span>
<span class="cp">#define AUDIT_COMPARE_AUID_TO_SUID	15</span>
<span class="cp">#define AUDIT_COMPARE_AUID_TO_EUID	16</span>

<span class="cp">#define AUDIT_COMPARE_EUID_TO_SUID	17</span>
<span class="cp">#define AUDIT_COMPARE_EUID_TO_FSUID	18</span>

<span class="cp">#define AUDIT_COMPARE_SUID_TO_FSUID	19</span>

<span class="cp">#define AUDIT_COMPARE_GID_TO_EGID	20</span>
<span class="cp">#define AUDIT_COMPARE_GID_TO_FSGID	21</span>
<span class="cp">#define AUDIT_COMPARE_GID_TO_SGID	22</span>

<span class="cp">#define AUDIT_COMPARE_EGID_TO_FSGID	23</span>
<span class="cp">#define AUDIT_COMPARE_EGID_TO_SGID	24</span>
<span class="cp">#define AUDIT_COMPARE_SGID_TO_FSGID	25</span>

<span class="cp">#define AUDIT_MAX_FIELD_COMPARE		AUDIT_COMPARE_SGID_TO_FSGID</span>

<span class="cm">/* Rule fields */</span>
				<span class="cm">/* These are useful when checking the</span>
<span class="cm">				 * task structure at task creation time</span>
<span class="cm">				 * (AUDIT_PER_TASK).  */</span>
<span class="cp">#define AUDIT_PID	0</span>
<span class="cp">#define AUDIT_UID	1</span>
<span class="cp">#define AUDIT_EUID	2</span>
<span class="cp">#define AUDIT_SUID	3</span>
<span class="cp">#define AUDIT_FSUID	4</span>
<span class="cp">#define AUDIT_GID	5</span>
<span class="cp">#define AUDIT_EGID	6</span>
<span class="cp">#define AUDIT_SGID	7</span>
<span class="cp">#define AUDIT_FSGID	8</span>
<span class="cp">#define AUDIT_LOGINUID	9</span>
<span class="cp">#define AUDIT_PERS	10</span>
<span class="cp">#define AUDIT_ARCH	11</span>
<span class="cp">#define AUDIT_MSGTYPE	12</span>
<span class="cp">#define AUDIT_SUBJ_USER	13	</span><span class="cm">/* security label user */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SUBJ_ROLE	14	</span><span class="cm">/* security label role */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SUBJ_TYPE	15	</span><span class="cm">/* security label type */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SUBJ_SEN	16	</span><span class="cm">/* security label sensitivity label */</span><span class="cp"></span>
<span class="cp">#define AUDIT_SUBJ_CLR	17	</span><span class="cm">/* security label clearance label */</span><span class="cp"></span>
<span class="cp">#define AUDIT_PPID	18</span>
<span class="cp">#define AUDIT_OBJ_USER	19</span>
<span class="cp">#define AUDIT_OBJ_ROLE	20</span>
<span class="cp">#define AUDIT_OBJ_TYPE	21</span>
<span class="cp">#define AUDIT_OBJ_LEV_LOW	22</span>
<span class="cp">#define AUDIT_OBJ_LEV_HIGH	23</span>

				<span class="cm">/* These are ONLY useful when checking</span>
<span class="cm">				 * at syscall exit time (AUDIT_AT_EXIT). */</span>
<span class="cp">#define AUDIT_DEVMAJOR	100</span>
<span class="cp">#define AUDIT_DEVMINOR	101</span>
<span class="cp">#define AUDIT_INODE	102</span>
<span class="cp">#define AUDIT_EXIT	103</span>
<span class="cp">#define AUDIT_SUCCESS   104	</span><span class="cm">/* exit &gt;= 0; value ignored */</span><span class="cp"></span>
<span class="cp">#define AUDIT_WATCH	105</span>
<span class="cp">#define AUDIT_PERM	106</span>
<span class="cp">#define AUDIT_DIR	107</span>
<span class="cp">#define AUDIT_FILETYPE	108</span>
<span class="cp">#define AUDIT_OBJ_UID	109</span>
<span class="cp">#define AUDIT_OBJ_GID	110</span>
<span class="cp">#define AUDIT_FIELD_COMPARE	111</span>

<span class="cp">#define AUDIT_ARG0      200</span>
<span class="cp">#define AUDIT_ARG1      (AUDIT_ARG0+1)</span>
<span class="cp">#define AUDIT_ARG2      (AUDIT_ARG0+2)</span>
<span class="cp">#define AUDIT_ARG3      (AUDIT_ARG0+3)</span>

<span class="cp">#define AUDIT_FILTERKEY	210</span>

<span class="cp">#define AUDIT_NEGATE			0x80000000</span>

<span class="cm">/* These are the supported operators.</span>
<span class="cm"> *	4  2  1  8</span>
<span class="cm"> *	=  &gt;  &lt;  ?</span>
<span class="cm"> *	----------</span>
<span class="cm"> *	0  0  0	 0	00	nonsense</span>
<span class="cm"> *	0  0  0	 1	08	&amp;  bit mask</span>
<span class="cm"> *	0  0  1	 0	10	&lt;</span>
<span class="cm"> *	0  1  0	 0	20	&gt;</span>
<span class="cm"> *	0  1  1	 0	30	!=</span>
<span class="cm"> *	1  0  0	 0	40	=</span>
<span class="cm"> *	1  0  0	 1	48	&amp;=  bit test</span>
<span class="cm"> *	1  0  1	 0	50	&lt;=</span>
<span class="cm"> *	1  1  0	 0	60	&gt;=</span>
<span class="cm"> *	1  1  1	 1	78	all operators</span>
<span class="cm"> */</span>
<span class="cp">#define AUDIT_BIT_MASK			0x08000000</span>
<span class="cp">#define AUDIT_LESS_THAN			0x10000000</span>
<span class="cp">#define AUDIT_GREATER_THAN		0x20000000</span>
<span class="cp">#define AUDIT_NOT_EQUAL			0x30000000</span>
<span class="cp">#define AUDIT_EQUAL			0x40000000</span>
<span class="cp">#define AUDIT_BIT_TEST			(AUDIT_BIT_MASK|AUDIT_EQUAL)</span>
<span class="cp">#define AUDIT_LESS_THAN_OR_EQUAL	(AUDIT_LESS_THAN|AUDIT_EQUAL)</span>
<span class="cp">#define AUDIT_GREATER_THAN_OR_EQUAL	(AUDIT_GREATER_THAN|AUDIT_EQUAL)</span>
<span class="cp">#define AUDIT_OPERATORS			(AUDIT_EQUAL|AUDIT_NOT_EQUAL|AUDIT_BIT_MASK)</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">Audit_equal</span><span class="p">,</span>
	<span class="n">Audit_not_equal</span><span class="p">,</span>
	<span class="n">Audit_bitmask</span><span class="p">,</span>
	<span class="n">Audit_bittest</span><span class="p">,</span>
	<span class="n">Audit_lt</span><span class="p">,</span>
	<span class="n">Audit_gt</span><span class="p">,</span>
	<span class="n">Audit_le</span><span class="p">,</span>
	<span class="n">Audit_ge</span><span class="p">,</span>
	<span class="n">Audit_bad</span>
<span class="p">};</span>

<span class="cm">/* Status symbols */</span>
				<span class="cm">/* Mask values */</span>
<span class="cp">#define AUDIT_STATUS_ENABLED		0x0001</span>
<span class="cp">#define AUDIT_STATUS_FAILURE		0x0002</span>
<span class="cp">#define AUDIT_STATUS_PID		0x0004</span>
<span class="cp">#define AUDIT_STATUS_RATE_LIMIT		0x0008</span>
<span class="cp">#define AUDIT_STATUS_BACKLOG_LIMIT	0x0010</span>
				<span class="cm">/* Failure-to-log actions */</span>
<span class="cp">#define AUDIT_FAIL_SILENT	0</span>
<span class="cp">#define AUDIT_FAIL_PRINTK	1</span>
<span class="cp">#define AUDIT_FAIL_PANIC	2</span>

<span class="cm">/* distinguish syscall tables */</span>
<span class="cp">#define __AUDIT_ARCH_64BIT 0x80000000</span>
<span class="cp">#define __AUDIT_ARCH_LE	   0x40000000</span>
<span class="cp">#define AUDIT_ARCH_ALPHA	(EM_ALPHA|__AUDIT_ARCH_64BIT|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_ARM		(EM_ARM|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_ARMEB	(EM_ARM)</span>
<span class="cp">#define AUDIT_ARCH_CRIS		(EM_CRIS|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_FRV		(EM_FRV)</span>
<span class="cp">#define AUDIT_ARCH_H8300	(EM_H8_300)</span>
<span class="cp">#define AUDIT_ARCH_I386		(EM_386|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_IA64		(EM_IA_64|__AUDIT_ARCH_64BIT|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_M32R		(EM_M32R)</span>
<span class="cp">#define AUDIT_ARCH_M68K		(EM_68K)</span>
<span class="cp">#define AUDIT_ARCH_MIPS		(EM_MIPS)</span>
<span class="cp">#define AUDIT_ARCH_MIPSEL	(EM_MIPS|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_MIPS64	(EM_MIPS|__AUDIT_ARCH_64BIT)</span>
<span class="cp">#define AUDIT_ARCH_MIPSEL64	(EM_MIPS|__AUDIT_ARCH_64BIT|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_PARISC	(EM_PARISC)</span>
<span class="cp">#define AUDIT_ARCH_PARISC64	(EM_PARISC|__AUDIT_ARCH_64BIT)</span>
<span class="cp">#define AUDIT_ARCH_PPC		(EM_PPC)</span>
<span class="cp">#define AUDIT_ARCH_PPC64	(EM_PPC64|__AUDIT_ARCH_64BIT)</span>
<span class="cp">#define AUDIT_ARCH_S390		(EM_S390)</span>
<span class="cp">#define AUDIT_ARCH_S390X	(EM_S390|__AUDIT_ARCH_64BIT)</span>
<span class="cp">#define AUDIT_ARCH_SH		(EM_SH)</span>
<span class="cp">#define AUDIT_ARCH_SHEL		(EM_SH|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_SH64		(EM_SH|__AUDIT_ARCH_64BIT)</span>
<span class="cp">#define AUDIT_ARCH_SHEL64	(EM_SH|__AUDIT_ARCH_64BIT|__AUDIT_ARCH_LE)</span>
<span class="cp">#define AUDIT_ARCH_SPARC	(EM_SPARC)</span>
<span class="cp">#define AUDIT_ARCH_SPARC64	(EM_SPARCV9|__AUDIT_ARCH_64BIT)</span>
<span class="cp">#define AUDIT_ARCH_X86_64	(EM_X86_64|__AUDIT_ARCH_64BIT|__AUDIT_ARCH_LE)</span>

<span class="cp">#define AUDIT_PERM_EXEC		1</span>
<span class="cp">#define AUDIT_PERM_WRITE	2</span>
<span class="cp">#define AUDIT_PERM_READ		4</span>
<span class="cp">#define AUDIT_PERM_ATTR		8</span>

<span class="k">struct</span> <span class="n">audit_status</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">mask</span><span class="p">;</span>		<span class="cm">/* Bit mask for valid entries */</span>
	<span class="n">__u32</span>		<span class="n">enabled</span><span class="p">;</span>	<span class="cm">/* 1 = enabled, 0 = disabled */</span>
	<span class="n">__u32</span>		<span class="n">failure</span><span class="p">;</span>	<span class="cm">/* Failure-to-log action */</span>
	<span class="n">__u32</span>		<span class="n">pid</span><span class="p">;</span>		<span class="cm">/* pid of auditd process */</span>
	<span class="n">__u32</span>		<span class="n">rate_limit</span><span class="p">;</span>	<span class="cm">/* messages rate limit (per second) */</span>
	<span class="n">__u32</span>		<span class="n">backlog_limit</span><span class="p">;</span>	<span class="cm">/* waiting messages limit */</span>
	<span class="n">__u32</span>		<span class="n">lost</span><span class="p">;</span>		<span class="cm">/* messages lost */</span>
	<span class="n">__u32</span>		<span class="n">backlog</span><span class="p">;</span>	<span class="cm">/* messages waiting in queue */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">audit_tty_status</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">enabled</span><span class="p">;</span> <span class="cm">/* 1 = enabled, 0 = disabled */</span>
<span class="p">};</span>

<span class="cm">/* audit_rule_data supports filter rules with both integer and string</span>
<span class="cm"> * fields.  It corresponds with AUDIT_ADD_RULE, AUDIT_DEL_RULE and</span>
<span class="cm"> * AUDIT_LIST_RULES requests.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">audit_rule_data</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">flags</span><span class="p">;</span>	<span class="cm">/* AUDIT_PER_{TASK,CALL}, AUDIT_PREPEND */</span>
	<span class="n">__u32</span>		<span class="n">action</span><span class="p">;</span>	<span class="cm">/* AUDIT_NEVER, AUDIT_POSSIBLE, AUDIT_ALWAYS */</span>
	<span class="n">__u32</span>		<span class="n">field_count</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">mask</span><span class="p">[</span><span class="n">AUDIT_BITMASK_SIZE</span><span class="p">];</span> <span class="cm">/* syscall(s) affected */</span>
	<span class="n">__u32</span>		<span class="n">fields</span><span class="p">[</span><span class="n">AUDIT_MAX_FIELDS</span><span class="p">];</span>
	<span class="n">__u32</span>		<span class="n">values</span><span class="p">[</span><span class="n">AUDIT_MAX_FIELDS</span><span class="p">];</span>
	<span class="n">__u32</span>		<span class="n">fieldflags</span><span class="p">[</span><span class="n">AUDIT_MAX_FIELDS</span><span class="p">];</span>
	<span class="n">__u32</span>		<span class="n">buflen</span><span class="p">;</span>	<span class="cm">/* total length of string fields */</span>
	<span class="kt">char</span>		<span class="n">buf</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/* string fields buffer */</span>
<span class="p">};</span>

<span class="cm">/* audit_rule is supported to maintain backward compatibility with</span>
<span class="cm"> * userspace.  It supports integer fields only and corresponds to</span>
<span class="cm"> * AUDIT_ADD, AUDIT_DEL and AUDIT_LIST requests.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">audit_rule</span> <span class="p">{</span>		<span class="cm">/* for AUDIT_LIST, AUDIT_ADD, and AUDIT_DEL */</span>
	<span class="n">__u32</span>		<span class="n">flags</span><span class="p">;</span>	<span class="cm">/* AUDIT_PER_{TASK,CALL}, AUDIT_PREPEND */</span>
	<span class="n">__u32</span>		<span class="n">action</span><span class="p">;</span>	<span class="cm">/* AUDIT_NEVER, AUDIT_POSSIBLE, AUDIT_ALWAYS */</span>
	<span class="n">__u32</span>		<span class="n">field_count</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">mask</span><span class="p">[</span><span class="n">AUDIT_BITMASK_SIZE</span><span class="p">];</span>
	<span class="n">__u32</span>		<span class="n">fields</span><span class="p">[</span><span class="n">AUDIT_MAX_FIELDS</span><span class="p">];</span>
	<span class="n">__u32</span>		<span class="n">values</span><span class="p">[</span><span class="n">AUDIT_MAX_FIELDS</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#include &lt;linux/sched.h&gt;</span>

<span class="k">struct</span> <span class="n">audit_sig_info</span> <span class="p">{</span>
	<span class="n">uid_t</span>		<span class="n">uid</span><span class="p">;</span>
	<span class="n">pid_t</span>		<span class="n">pid</span><span class="p">;</span>
	<span class="kt">char</span>		<span class="n">ctx</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">audit_buffer</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">audit_context</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">inode</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">netlink_skb_parms</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">path</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">linux_binprm</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">mq_attr</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">mqstat</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">audit_watch</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">audit_tree</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">audit_krule</span> <span class="p">{</span>
	<span class="kt">int</span>			<span class="n">vers_ops</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">flags</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">listnr</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">action</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">mask</span><span class="p">[</span><span class="n">AUDIT_BITMASK_SIZE</span><span class="p">];</span>
	<span class="n">u32</span>			<span class="n">buflen</span><span class="p">;</span> <span class="cm">/* for data alloc on list rules */</span>
	<span class="n">u32</span>			<span class="n">field_count</span><span class="p">;</span>
	<span class="kt">char</span>			<span class="o">*</span><span class="n">filterkey</span><span class="p">;</span> <span class="cm">/* ties events to rules */</span>
	<span class="k">struct</span> <span class="n">audit_field</span>	<span class="o">*</span><span class="n">fields</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">audit_field</span>	<span class="o">*</span><span class="n">arch_f</span><span class="p">;</span> <span class="cm">/* quick access to arch field */</span>
	<span class="k">struct</span> <span class="n">audit_field</span>	<span class="o">*</span><span class="n">inode_f</span><span class="p">;</span> <span class="cm">/* quick access to an inode field */</span>
	<span class="k">struct</span> <span class="n">audit_watch</span>	<span class="o">*</span><span class="n">watch</span><span class="p">;</span>	<span class="cm">/* associated watch */</span>
	<span class="k">struct</span> <span class="n">audit_tree</span>	<span class="o">*</span><span class="n">tree</span><span class="p">;</span>	<span class="cm">/* associated watched tree */</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">rlist</span><span class="p">;</span>	<span class="cm">/* entry in audit_{watch,tree}.rules list */</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">list</span><span class="p">;</span>	<span class="cm">/* for AUDIT_LIST* purposes only */</span>
	<span class="n">u64</span>			<span class="n">prio</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">audit_field</span> <span class="p">{</span>
	<span class="n">u32</span>				<span class="n">type</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">val</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">op</span><span class="p">;</span>
	<span class="kt">char</span>				<span class="o">*</span><span class="n">lsm_str</span><span class="p">;</span>
	<span class="kt">void</span>				<span class="o">*</span><span class="n">lsm_rule</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">__init</span> <span class="n">audit_register_class</span><span class="p">(</span><span class="kt">int</span> <span class="n">class</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="o">*</span><span class="n">list</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">audit_classify_syscall</span><span class="p">(</span><span class="kt">int</span> <span class="n">abi</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">syscall</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">audit_classify_arch</span><span class="p">(</span><span class="kt">int</span> <span class="n">arch</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_AUDITSYSCALL</span>
<span class="cm">/* These are defined in auditsc.c */</span>
				<span class="cm">/* Public API */</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">audit_alloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">task</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">task</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_syscall_entry</span><span class="p">(</span><span class="kt">int</span> <span class="n">arch</span><span class="p">,</span>
				  <span class="kt">int</span> <span class="n">major</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a0</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a1</span><span class="p">,</span>
				  <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a3</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_syscall_exit</span><span class="p">(</span><span class="kt">int</span> <span class="n">ret_success</span><span class="p">,</span> <span class="kt">long</span> <span class="n">ret_value</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_getname</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">audit_putname</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_inode</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="n">dentry</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_inode_child</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="n">dentry</span><span class="p">,</span>
				<span class="k">const</span> <span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">parent</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_seccomp</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">syscall</span><span class="p">,</span> <span class="kt">long</span> <span class="n">signr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">code</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_ptrace</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">t</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">audit_dummy_context</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">audit_context</span><span class="p">;</span>
	<span class="k">return</span> <span class="o">!</span><span class="n">p</span> <span class="o">||</span> <span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">p</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">task</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="n">task</span><span class="o">-&gt;</span><span class="n">audit_context</span><span class="p">))</span>
		<span class="n">__audit_free</span><span class="p">(</span><span class="n">task</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_syscall_entry</span><span class="p">(</span><span class="kt">int</span> <span class="n">arch</span><span class="p">,</span> <span class="kt">int</span> <span class="n">major</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a0</span><span class="p">,</span>
				       <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a2</span><span class="p">,</span>
				       <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">a3</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_syscall_entry</span><span class="p">(</span><span class="n">arch</span><span class="p">,</span> <span class="n">major</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_syscall_exit</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">pt_regs</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="n">current</span><span class="o">-&gt;</span><span class="n">audit_context</span><span class="p">))</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">success</span> <span class="o">=</span> <span class="n">is_syscall_success</span><span class="p">(</span><span class="n">pt_regs</span><span class="p">);</span>
		<span class="kt">int</span> <span class="n">return_code</span> <span class="o">=</span> <span class="n">regs_return_value</span><span class="p">(</span><span class="n">pt_regs</span><span class="p">);</span>

		<span class="n">__audit_syscall_exit</span><span class="p">(</span><span class="n">success</span><span class="p">,</span> <span class="n">return_code</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_getname</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_getname</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_inode</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="n">dentry</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_inode</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">dentry</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_inode_child</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="n">dentry</span><span class="p">,</span>
				     <span class="k">const</span> <span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">parent</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_inode_child</span><span class="p">(</span><span class="n">dentry</span><span class="p">,</span> <span class="n">parent</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="n">audit_core_dumps</span><span class="p">(</span><span class="kt">long</span> <span class="n">signr</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_seccomp</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">syscall</span><span class="p">,</span> <span class="kt">long</span> <span class="n">signr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">code</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_seccomp</span><span class="p">(</span><span class="n">syscall</span><span class="p">,</span> <span class="n">signr</span><span class="p">,</span> <span class="n">code</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_ptrace</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_ptrace</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="p">}</span>

				<span class="cm">/* Private API (for audit.c only) */</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">audit_serial</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">auditsc_get_stamp</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">timespec</span> <span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">serial</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">audit_set_loginuid</span><span class="p">(</span><span class="n">uid_t</span> <span class="n">loginuid</span><span class="p">);</span>
<span class="cp">#define audit_get_loginuid(t) ((t)-&gt;loginuid)</span>
<span class="cp">#define audit_get_sessionid(t) ((t)-&gt;sessionid)</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">audit_log_task_context</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_ipc_obj</span><span class="p">(</span><span class="k">struct</span> <span class="n">kern_ipc_perm</span> <span class="o">*</span><span class="n">ipcp</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_ipc_set_perm</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">qbytes</span><span class="p">,</span> <span class="n">uid_t</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid_t</span> <span class="n">gid</span><span class="p">,</span> <span class="n">umode_t</span> <span class="n">mode</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">__audit_bprm</span><span class="p">(</span><span class="k">struct</span> <span class="n">linux_binprm</span> <span class="o">*</span><span class="n">bprm</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_socketcall</span><span class="p">(</span><span class="kt">int</span> <span class="n">nargs</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">args</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">__audit_sockaddr</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">addr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_fd_pair</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fd2</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_mq_open</span><span class="p">(</span><span class="kt">int</span> <span class="n">oflag</span><span class="p">,</span> <span class="n">umode_t</span> <span class="n">mode</span><span class="p">,</span> <span class="k">struct</span> <span class="n">mq_attr</span> <span class="o">*</span><span class="n">attr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_mq_sendrecv</span><span class="p">(</span><span class="n">mqd_t</span> <span class="n">mqdes</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">msg_len</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">msg_prio</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">timespec</span> <span class="o">*</span><span class="n">abs_timeout</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_mq_notify</span><span class="p">(</span><span class="n">mqd_t</span> <span class="n">mqdes</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">sigevent</span> <span class="o">*</span><span class="n">notification</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_mq_getsetattr</span><span class="p">(</span><span class="n">mqd_t</span> <span class="n">mqdes</span><span class="p">,</span> <span class="k">struct</span> <span class="n">mq_attr</span> <span class="o">*</span><span class="n">mqstat</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">__audit_log_bprm_fcaps</span><span class="p">(</span><span class="k">struct</span> <span class="n">linux_binprm</span> <span class="o">*</span><span class="n">bprm</span><span class="p">,</span>
				  <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">new</span><span class="p">,</span>
				  <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">old</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_log_capset</span><span class="p">(</span><span class="n">pid_t</span> <span class="n">pid</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">new</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">old</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">__audit_mmap_fd</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_ipc_obj</span><span class="p">(</span><span class="k">struct</span> <span class="n">kern_ipc_perm</span> <span class="o">*</span><span class="n">ipcp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_ipc_obj</span><span class="p">(</span><span class="n">ipcp</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_fd_pair</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fd2</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_fd_pair</span><span class="p">(</span><span class="n">fd1</span><span class="p">,</span> <span class="n">fd2</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_ipc_set_perm</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">qbytes</span><span class="p">,</span> <span class="n">uid_t</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid_t</span> <span class="n">gid</span><span class="p">,</span> <span class="n">umode_t</span> <span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_ipc_set_perm</span><span class="p">(</span><span class="n">qbytes</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">mode</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">audit_bprm</span><span class="p">(</span><span class="k">struct</span> <span class="n">linux_binprm</span> <span class="o">*</span><span class="n">bprm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="k">return</span> <span class="n">__audit_bprm</span><span class="p">(</span><span class="n">bprm</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_socketcall</span><span class="p">(</span><span class="kt">int</span> <span class="n">nargs</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_socketcall</span><span class="p">(</span><span class="n">nargs</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">audit_sockaddr</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="k">return</span> <span class="n">__audit_sockaddr</span><span class="p">(</span><span class="n">len</span><span class="p">,</span> <span class="n">addr</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_mq_open</span><span class="p">(</span><span class="kt">int</span> <span class="n">oflag</span><span class="p">,</span> <span class="n">umode_t</span> <span class="n">mode</span><span class="p">,</span> <span class="k">struct</span> <span class="n">mq_attr</span> <span class="o">*</span><span class="n">attr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_mq_open</span><span class="p">(</span><span class="n">oflag</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">attr</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_mq_sendrecv</span><span class="p">(</span><span class="n">mqd_t</span> <span class="n">mqdes</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">msg_len</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">msg_prio</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">timespec</span> <span class="o">*</span><span class="n">abs_timeout</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_mq_sendrecv</span><span class="p">(</span><span class="n">mqdes</span><span class="p">,</span> <span class="n">msg_len</span><span class="p">,</span> <span class="n">msg_prio</span><span class="p">,</span> <span class="n">abs_timeout</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_mq_notify</span><span class="p">(</span><span class="n">mqd_t</span> <span class="n">mqdes</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">sigevent</span> <span class="o">*</span><span class="n">notification</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_mq_notify</span><span class="p">(</span><span class="n">mqdes</span><span class="p">,</span> <span class="n">notification</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_mq_getsetattr</span><span class="p">(</span><span class="n">mqd_t</span> <span class="n">mqdes</span><span class="p">,</span> <span class="k">struct</span> <span class="n">mq_attr</span> <span class="o">*</span><span class="n">mqstat</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_mq_getsetattr</span><span class="p">(</span><span class="n">mqdes</span><span class="p">,</span> <span class="n">mqstat</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">audit_log_bprm_fcaps</span><span class="p">(</span><span class="k">struct</span> <span class="n">linux_binprm</span> <span class="o">*</span><span class="n">bprm</span><span class="p">,</span>
				       <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">new</span><span class="p">,</span>
				       <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">old</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="k">return</span> <span class="n">__audit_log_bprm_fcaps</span><span class="p">(</span><span class="n">bprm</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">old</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_log_capset</span><span class="p">(</span><span class="n">pid_t</span> <span class="n">pid</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">new</span><span class="p">,</span>
				   <span class="k">const</span> <span class="k">struct</span> <span class="n">cred</span> <span class="o">*</span><span class="n">old</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_log_capset</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="n">old</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">audit_mmap_fd</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">audit_dummy_context</span><span class="p">()))</span>
		<span class="n">__audit_mmap_fd</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">audit_n_rules</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">audit_signals</span><span class="p">;</span>
<span class="cp">#else </span><span class="cm">/* CONFIG_AUDITSYSCALL */</span><span class="cp"></span>
<span class="cp">#define audit_alloc(t) ({ 0; })</span>
<span class="cp">#define audit_free(t) do { ; } while (0)</span>
<span class="cp">#define audit_syscall_entry(ta,a,b,c,d,e) do { ; } while (0)</span>
<span class="cp">#define audit_syscall_exit(r) do { ; } while (0)</span>
<span class="cp">#define audit_dummy_context() 1</span>
<span class="cp">#define audit_getname(n) do { ; } while (0)</span>
<span class="cp">#define audit_putname(n) do { ; } while (0)</span>
<span class="cp">#define __audit_inode(n,d) do { ; } while (0)</span>
<span class="cp">#define __audit_inode_child(i,p) do { ; } while (0)</span>
<span class="cp">#define audit_inode(n,d) do { (void)(d); } while (0)</span>
<span class="cp">#define audit_inode_child(i,p) do { ; } while (0)</span>
<span class="cp">#define audit_core_dumps(i) do { ; } while (0)</span>
<span class="cp">#define audit_seccomp(i,s,c) do { ; } while (0)</span>
<span class="cp">#define auditsc_get_stamp(c,t,s) (0)</span>
<span class="cp">#define audit_get_loginuid(t) (-1)</span>
<span class="cp">#define audit_get_sessionid(t) (-1)</span>
<span class="cp">#define audit_log_task_context(b) do { ; } while (0)</span>
<span class="cp">#define audit_ipc_obj(i) ((void)0)</span>
<span class="cp">#define audit_ipc_set_perm(q,u,g,m) ((void)0)</span>
<span class="cp">#define audit_bprm(p) ({ 0; })</span>
<span class="cp">#define audit_socketcall(n,a) ((void)0)</span>
<span class="cp">#define audit_fd_pair(n,a) ((void)0)</span>
<span class="cp">#define audit_sockaddr(len, addr) ({ 0; })</span>
<span class="cp">#define audit_mq_open(o,m,a) ((void)0)</span>
<span class="cp">#define audit_mq_sendrecv(d,l,p,t) ((void)0)</span>
<span class="cp">#define audit_mq_notify(d,n) ((void)0)</span>
<span class="cp">#define audit_mq_getsetattr(d,s) ((void)0)</span>
<span class="cp">#define audit_log_bprm_fcaps(b, ncr, ocr) ({ 0; })</span>
<span class="cp">#define audit_log_capset(pid, ncr, ocr) ((void)0)</span>
<span class="cp">#define audit_mmap_fd(fd, flags) ((void)0)</span>
<span class="cp">#define audit_ptrace(t) ((void)0)</span>
<span class="cp">#define audit_n_rules 0</span>
<span class="cp">#define audit_signals 0</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_AUDITSYSCALL */</span><span class="cp"></span>

<span class="cp">#ifdef CONFIG_AUDIT</span>
<span class="cm">/* These are defined in audit.c */</span>
				<span class="cm">/* Public API */</span>
<span class="k">extern</span> <span class="n">__printf</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="kt">void</span> <span class="n">audit_log</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">gfp_t</span> <span class="n">gfp_mask</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
	       <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fmt</span><span class="p">,</span> <span class="p">...);</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">audit_log_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_context</span> <span class="o">*</span><span class="n">ctx</span><span class="p">,</span> <span class="n">gfp_t</span> <span class="n">gfp_mask</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">__printf</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="kt">void</span> <span class="n">audit_log_format</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">fmt</span><span class="p">,</span> <span class="p">...);</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_end</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>		    <span class="n">audit_string_contains_control</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">string</span><span class="p">,</span>
							  <span class="kt">size_t</span> <span class="n">len</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_n_hex</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span>
					  <span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
					  <span class="kt">size_t</span> <span class="n">len</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_n_string</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span>
					       <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span>
					       <span class="kt">size_t</span> <span class="n">n</span><span class="p">);</span>
<span class="cp">#define audit_log_string(a,b) audit_log_n_string(a, b, strlen(b));</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_n_untrustedstring</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span>
							<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">string</span><span class="p">,</span>
							<span class="kt">size_t</span> <span class="n">n</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_untrustedstring</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span>
						      <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">string</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_d_path</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span>
					     <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">prefix</span><span class="p">,</span>
					     <span class="k">const</span> <span class="k">struct</span> <span class="n">path</span> <span class="o">*</span><span class="n">path</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_key</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span>
					  <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>		    <span class="n">audit_log_lost</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">message</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_SECURITY</span>
<span class="k">extern</span> <span class="kt">void</span> 		    <span class="n">audit_log_secctx</span><span class="p">(</span><span class="k">struct</span> <span class="n">audit_buffer</span> <span class="o">*</span><span class="n">ab</span><span class="p">,</span> <span class="n">u32</span> <span class="n">secid</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="cp">#define audit_log_secctx(b,s) do { ; } while (0)</span>
<span class="cp">#endif</span>

<span class="k">extern</span> <span class="kt">int</span>		    <span class="n">audit_update_lsm_rules</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

				<span class="cm">/* Private API (for audit.c only) */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">audit_filter_user</span><span class="p">(</span><span class="k">struct</span> <span class="n">netlink_skb_parms</span> <span class="o">*</span><span class="n">cb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">audit_filter_type</span><span class="p">(</span><span class="kt">int</span> <span class="n">type</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">audit_receive_filter</span><span class="p">(</span><span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">uid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">seq</span><span class="p">,</span>
				<span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">datasz</span><span class="p">,</span> <span class="n">uid_t</span> <span class="n">loginuid</span><span class="p">,</span>
				<span class="n">u32</span> <span class="n">sessionid</span><span class="p">,</span> <span class="n">u32</span> <span class="n">sid</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">audit_enabled</span><span class="p">;</span>
<span class="cp">#else</span>
<span class="cp">#define audit_log(c,g,t,f,...) do { ; } while (0)</span>
<span class="cp">#define audit_log_start(c,g,t) ({ NULL; })</span>
<span class="cp">#define audit_log_vformat(b,f,a) do { ; } while (0)</span>
<span class="cp">#define audit_log_format(b,f,...) do { ; } while (0)</span>
<span class="cp">#define audit_log_end(b) do { ; } while (0)</span>
<span class="cp">#define audit_log_n_hex(a,b,l) do { ; } while (0)</span>
<span class="cp">#define audit_log_n_string(a,c,l) do { ; } while (0)</span>
<span class="cp">#define audit_log_string(a,c) do { ; } while (0)</span>
<span class="cp">#define audit_log_n_untrustedstring(a,n,s) do { ; } while (0)</span>
<span class="cp">#define audit_log_untrustedstring(a,s) do { ; } while (0)</span>
<span class="cp">#define audit_log_d_path(b, p, d) do { ; } while (0)</span>
<span class="cp">#define audit_log_key(b, k) do { ; } while (0)</span>
<span class="cp">#define audit_log_secctx(b,s) do { ; } while (0)</span>
<span class="cp">#define audit_enabled 0</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
