<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › nfs4.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>nfs4.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  include/linux/nfs4.h</span>
<span class="cm"> *</span>
<span class="cm"> *  NFSv4 protocol definitions.</span>
<span class="cm"> *</span>
<span class="cm"> *  Copyright (c) 2002 The Regents of the University of Michigan.</span>
<span class="cm"> *  All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> *  Kendrick Smith &lt;kmsmith@umich.edu&gt;</span>
<span class="cm"> *  Andy Adamson   &lt;andros@umich.edu&gt;</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_NFS4_H</span>
<span class="cp">#define _LINUX_NFS4_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cp">#define NFS4_BITMAP_SIZE	2</span>
<span class="cp">#define NFS4_VERIFIER_SIZE	8</span>
<span class="cp">#define NFS4_STATEID_SEQID_SIZE 4</span>
<span class="cp">#define NFS4_STATEID_OTHER_SIZE 12</span>
<span class="cp">#define NFS4_STATEID_SIZE	(NFS4_STATEID_SEQID_SIZE + NFS4_STATEID_OTHER_SIZE)</span>
<span class="cp">#define NFS4_FHSIZE		128</span>
<span class="cp">#define NFS4_MAXPATHLEN		PATH_MAX</span>
<span class="cp">#define NFS4_MAXNAMLEN		NAME_MAX</span>
<span class="cp">#define NFS4_OPAQUE_LIMIT	1024</span>
<span class="cp">#define NFS4_MAX_SESSIONID_LEN	16</span>

<span class="cp">#define NFS4_ACCESS_READ        0x0001</span>
<span class="cp">#define NFS4_ACCESS_LOOKUP      0x0002</span>
<span class="cp">#define NFS4_ACCESS_MODIFY      0x0004</span>
<span class="cp">#define NFS4_ACCESS_EXTEND      0x0008</span>
<span class="cp">#define NFS4_ACCESS_DELETE      0x0010</span>
<span class="cp">#define NFS4_ACCESS_EXECUTE     0x0020</span>

<span class="cp">#define NFS4_FH_PERSISTENT		0x0000</span>
<span class="cp">#define NFS4_FH_NOEXPIRE_WITH_OPEN	0x0001</span>
<span class="cp">#define NFS4_FH_VOLATILE_ANY		0x0002</span>
<span class="cp">#define NFS4_FH_VOL_MIGRATION		0x0004</span>
<span class="cp">#define NFS4_FH_VOL_RENAME		0x0008</span>

<span class="cp">#define NFS4_OPEN_RESULT_CONFIRM 0x0002</span>
<span class="cp">#define NFS4_OPEN_RESULT_LOCKTYPE_POSIX 0x0004</span>

<span class="cp">#define NFS4_SHARE_ACCESS_MASK	0x000F</span>
<span class="cp">#define NFS4_SHARE_ACCESS_READ	0x0001</span>
<span class="cp">#define NFS4_SHARE_ACCESS_WRITE	0x0002</span>
<span class="cp">#define NFS4_SHARE_ACCESS_BOTH	0x0003</span>
<span class="cp">#define NFS4_SHARE_DENY_READ	0x0001</span>
<span class="cp">#define NFS4_SHARE_DENY_WRITE	0x0002</span>
<span class="cp">#define NFS4_SHARE_DENY_BOTH	0x0003</span>

<span class="cm">/* nfs41 */</span>
<span class="cp">#define NFS4_SHARE_WANT_MASK		0xFF00</span>
<span class="cp">#define NFS4_SHARE_WANT_NO_PREFERENCE	0x0000</span>
<span class="cp">#define NFS4_SHARE_WANT_READ_DELEG	0x0100</span>
<span class="cp">#define NFS4_SHARE_WANT_WRITE_DELEG	0x0200</span>
<span class="cp">#define NFS4_SHARE_WANT_ANY_DELEG	0x0300</span>
<span class="cp">#define NFS4_SHARE_WANT_NO_DELEG	0x0400</span>
<span class="cp">#define NFS4_SHARE_WANT_CANCEL		0x0500</span>

<span class="cp">#define NFS4_SHARE_WHEN_MASK		0xF0000</span>
<span class="cp">#define NFS4_SHARE_SIGNAL_DELEG_WHEN_RESRC_AVAIL	0x10000</span>
<span class="cp">#define NFS4_SHARE_PUSH_DELEG_WHEN_UNCONTENDED		0x20000</span>

<span class="cp">#define NFS4_CDFC4_FORE	0x1</span>
<span class="cp">#define NFS4_CDFC4_BACK 0x2</span>
<span class="cp">#define NFS4_CDFC4_BOTH 0x3</span>
<span class="cp">#define NFS4_CDFC4_FORE_OR_BOTH 0x3</span>
<span class="cp">#define NFS4_CDFC4_BACK_OR_BOTH 0x7</span>

<span class="cp">#define NFS4_CDFS4_FORE 0x1</span>
<span class="cp">#define NFS4_CDFS4_BACK 0x2</span>
<span class="cp">#define NFS4_CDFS4_BOTH 0x3</span>

<span class="cp">#define NFS4_SET_TO_SERVER_TIME	0</span>
<span class="cp">#define NFS4_SET_TO_CLIENT_TIME	1</span>

<span class="cp">#define NFS4_ACE_ACCESS_ALLOWED_ACE_TYPE 0</span>
<span class="cp">#define NFS4_ACE_ACCESS_DENIED_ACE_TYPE  1</span>
<span class="cp">#define NFS4_ACE_SYSTEM_AUDIT_ACE_TYPE   2</span>
<span class="cp">#define NFS4_ACE_SYSTEM_ALARM_ACE_TYPE   3</span>

<span class="cp">#define ACL4_SUPPORT_ALLOW_ACL 0x01</span>
<span class="cp">#define ACL4_SUPPORT_DENY_ACL  0x02</span>
<span class="cp">#define ACL4_SUPPORT_AUDIT_ACL 0x04</span>
<span class="cp">#define ACL4_SUPPORT_ALARM_ACL 0x08</span>

<span class="cp">#define NFS4_ACE_FILE_INHERIT_ACE             0x00000001</span>
<span class="cp">#define NFS4_ACE_DIRECTORY_INHERIT_ACE        0x00000002</span>
<span class="cp">#define NFS4_ACE_NO_PROPAGATE_INHERIT_ACE     0x00000004</span>
<span class="cp">#define NFS4_ACE_INHERIT_ONLY_ACE             0x00000008</span>
<span class="cp">#define NFS4_ACE_SUCCESSFUL_ACCESS_ACE_FLAG   0x00000010</span>
<span class="cp">#define NFS4_ACE_FAILED_ACCESS_ACE_FLAG       0x00000020</span>
<span class="cp">#define NFS4_ACE_IDENTIFIER_GROUP             0x00000040</span>

<span class="cp">#define NFS4_ACE_READ_DATA                    0x00000001</span>
<span class="cp">#define NFS4_ACE_LIST_DIRECTORY               0x00000001</span>
<span class="cp">#define NFS4_ACE_WRITE_DATA                   0x00000002</span>
<span class="cp">#define NFS4_ACE_ADD_FILE                     0x00000002</span>
<span class="cp">#define NFS4_ACE_APPEND_DATA                  0x00000004</span>
<span class="cp">#define NFS4_ACE_ADD_SUBDIRECTORY             0x00000004</span>
<span class="cp">#define NFS4_ACE_READ_NAMED_ATTRS             0x00000008</span>
<span class="cp">#define NFS4_ACE_WRITE_NAMED_ATTRS            0x00000010</span>
<span class="cp">#define NFS4_ACE_EXECUTE                      0x00000020</span>
<span class="cp">#define NFS4_ACE_DELETE_CHILD                 0x00000040</span>
<span class="cp">#define NFS4_ACE_READ_ATTRIBUTES              0x00000080</span>
<span class="cp">#define NFS4_ACE_WRITE_ATTRIBUTES             0x00000100</span>
<span class="cp">#define NFS4_ACE_DELETE                       0x00010000</span>
<span class="cp">#define NFS4_ACE_READ_ACL                     0x00020000</span>
<span class="cp">#define NFS4_ACE_WRITE_ACL                    0x00040000</span>
<span class="cp">#define NFS4_ACE_WRITE_OWNER                  0x00080000</span>
<span class="cp">#define NFS4_ACE_SYNCHRONIZE                  0x00100000</span>
<span class="cp">#define NFS4_ACE_GENERIC_READ                 0x00120081</span>
<span class="cp">#define NFS4_ACE_GENERIC_WRITE                0x00160106</span>
<span class="cp">#define NFS4_ACE_GENERIC_EXECUTE              0x001200A0</span>
<span class="cp">#define NFS4_ACE_MASK_ALL                     0x001F01FF</span>

<span class="cp">#define EXCHGID4_FLAG_SUPP_MOVED_REFER		0x00000001</span>
<span class="cp">#define EXCHGID4_FLAG_SUPP_MOVED_MIGR		0x00000002</span>
<span class="cp">#define EXCHGID4_FLAG_BIND_PRINC_STATEID	0x00000100</span>

<span class="cp">#define EXCHGID4_FLAG_USE_NON_PNFS		0x00010000</span>
<span class="cp">#define EXCHGID4_FLAG_USE_PNFS_MDS		0x00020000</span>
<span class="cp">#define EXCHGID4_FLAG_USE_PNFS_DS		0x00040000</span>
<span class="cp">#define EXCHGID4_FLAG_MASK_PNFS			0x00070000</span>

<span class="cp">#define EXCHGID4_FLAG_UPD_CONFIRMED_REC_A	0x40000000</span>
<span class="cp">#define EXCHGID4_FLAG_CONFIRMED_R		0x80000000</span>
<span class="cm">/*</span>
<span class="cm"> * Since the validity of these bits depends on whether</span>
<span class="cm"> * they&#39;re set in the argument or response, have separate</span>
<span class="cm"> * invalid flag masks for arg (_A) and resp (_R).</span>
<span class="cm"> */</span>
<span class="cp">#define EXCHGID4_FLAG_MASK_A			0x40070103</span>
<span class="cp">#define EXCHGID4_FLAG_MASK_R			0x80070103</span>

<span class="cp">#define SEQ4_STATUS_CB_PATH_DOWN		0x00000001</span>
<span class="cp">#define SEQ4_STATUS_CB_GSS_CONTEXTS_EXPIRING	0x00000002</span>
<span class="cp">#define SEQ4_STATUS_CB_GSS_CONTEXTS_EXPIRED	0x00000004</span>
<span class="cp">#define SEQ4_STATUS_EXPIRED_ALL_STATE_REVOKED	0x00000008</span>
<span class="cp">#define SEQ4_STATUS_EXPIRED_SOME_STATE_REVOKED	0x00000010</span>
<span class="cp">#define SEQ4_STATUS_ADMIN_STATE_REVOKED		0x00000020</span>
<span class="cp">#define SEQ4_STATUS_RECALLABLE_STATE_REVOKED	0x00000040</span>
<span class="cp">#define SEQ4_STATUS_LEASE_MOVED			0x00000080</span>
<span class="cp">#define SEQ4_STATUS_RESTART_RECLAIM_NEEDED	0x00000100</span>
<span class="cp">#define SEQ4_STATUS_CB_PATH_DOWN_SESSION	0x00000200</span>
<span class="cp">#define SEQ4_STATUS_BACKCHANNEL_FAULT		0x00000400</span>

<span class="cp">#define NFS4_SECINFO_STYLE4_CURRENT_FH	0</span>
<span class="cp">#define NFS4_SECINFO_STYLE4_PARENT	1</span>

<span class="cp">#define NFS4_MAX_UINT64	(~(u64)0)</span>

<span class="cm">/* An NFS4 sessions server must support at least NFS4_MAX_OPS operations.</span>
<span class="cm"> * If a compound requires more operations, adjust NFS4_MAX_OPS accordingly.</span>
<span class="cm"> */</span>
<span class="cp">#define NFS4_MAX_OPS   8</span>

<span class="cm">/* Our NFS4 client back channel server only wants the cb_sequene and the</span>
<span class="cm"> * actual operation per compound</span>
<span class="cm"> */</span>
<span class="cp">#define NFS4_MAX_BACK_CHANNEL_OPS 2</span>

<span class="k">enum</span> <span class="n">nfs4_acl_whotype</span> <span class="p">{</span>
	<span class="n">NFS4_ACL_WHO_NAMED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4_ACL_WHO_OWNER</span><span class="p">,</span>
	<span class="n">NFS4_ACL_WHO_GROUP</span><span class="p">,</span>
	<span class="n">NFS4_ACL_WHO_EVERYONE</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#include &lt;linux/list.h&gt;</span>

<span class="k">struct</span> <span class="n">nfs4_ace</span> <span class="p">{</span>
	<span class="kt">uint32_t</span>	<span class="n">type</span><span class="p">;</span>
	<span class="kt">uint32_t</span>	<span class="n">flag</span><span class="p">;</span>
	<span class="kt">uint32_t</span>	<span class="n">access_mask</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">whotype</span><span class="p">;</span>
	<span class="n">uid_t</span>		<span class="n">who</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">nfs4_acl</span> <span class="p">{</span>
	<span class="kt">uint32_t</span>	<span class="n">naces</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">nfs4_ace</span>	<span class="n">aces</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span> <span class="kt">char</span> <span class="n">data</span><span class="p">[</span><span class="n">NFS4_VERIFIER_SIZE</span><span class="p">];</span> <span class="p">}</span> <span class="n">nfs4_verifier</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">nfs_stateid4</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">seqid</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">other</span><span class="p">[</span><span class="n">NFS4_STATEID_OTHER_SIZE</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">nfs_stateid4</span> <span class="n">nfs4_stateid</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">nfs_opnum4</span> <span class="p">{</span>
	<span class="n">OP_ACCESS</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">OP_CLOSE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">OP_COMMIT</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">OP_CREATE</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">OP_DELEGPURGE</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">OP_DELEGRETURN</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">OP_GETATTR</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">OP_GETFH</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">OP_LINK</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">OP_LOCK</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">OP_LOCKT</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">OP_LOCKU</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">OP_LOOKUP</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">OP_LOOKUPP</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">OP_NVERIFY</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">OP_OPEN</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">OP_OPENATTR</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">OP_OPEN_CONFIRM</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">OP_OPEN_DOWNGRADE</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">OP_PUTFH</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">OP_PUTPUBFH</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">OP_PUTROOTFH</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
	<span class="n">OP_READ</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
	<span class="n">OP_READDIR</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
	<span class="n">OP_READLINK</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
	<span class="n">OP_REMOVE</span> <span class="o">=</span> <span class="mi">28</span><span class="p">,</span>
	<span class="n">OP_RENAME</span> <span class="o">=</span> <span class="mi">29</span><span class="p">,</span>
	<span class="n">OP_RENEW</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
	<span class="n">OP_RESTOREFH</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
	<span class="n">OP_SAVEFH</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">OP_SECINFO</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">OP_SETATTR</span> <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">OP_SETCLIENTID</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">OP_SETCLIENTID_CONFIRM</span> <span class="o">=</span> <span class="mi">36</span><span class="p">,</span>
	<span class="n">OP_VERIFY</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">OP_WRITE</span> <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">OP_RELEASE_LOCKOWNER</span> <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>

	<span class="cm">/* nfs41 */</span>
	<span class="n">OP_BACKCHANNEL_CTL</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
	<span class="n">OP_BIND_CONN_TO_SESSION</span> <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>
	<span class="n">OP_EXCHANGE_ID</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">OP_CREATE_SESSION</span> <span class="o">=</span> <span class="mi">43</span><span class="p">,</span>
	<span class="n">OP_DESTROY_SESSION</span> <span class="o">=</span> <span class="mi">44</span><span class="p">,</span>
	<span class="n">OP_FREE_STATEID</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	<span class="n">OP_GET_DIR_DELEGATION</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span>
	<span class="n">OP_GETDEVICEINFO</span> <span class="o">=</span> <span class="mi">47</span><span class="p">,</span>
	<span class="n">OP_GETDEVICELIST</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
	<span class="n">OP_LAYOUTCOMMIT</span> <span class="o">=</span> <span class="mi">49</span><span class="p">,</span>
	<span class="n">OP_LAYOUTGET</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
	<span class="n">OP_LAYOUTRETURN</span> <span class="o">=</span> <span class="mi">51</span><span class="p">,</span>
	<span class="n">OP_SECINFO_NO_NAME</span> <span class="o">=</span> <span class="mi">52</span><span class="p">,</span>
	<span class="n">OP_SEQUENCE</span> <span class="o">=</span> <span class="mi">53</span><span class="p">,</span>
	<span class="n">OP_SET_SSV</span> <span class="o">=</span> <span class="mi">54</span><span class="p">,</span>
	<span class="n">OP_TEST_STATEID</span> <span class="o">=</span> <span class="mi">55</span><span class="p">,</span>
	<span class="n">OP_WANT_DELEGATION</span> <span class="o">=</span> <span class="mi">56</span><span class="p">,</span>
	<span class="n">OP_DESTROY_CLIENTID</span> <span class="o">=</span> <span class="mi">57</span><span class="p">,</span>
	<span class="n">OP_RECLAIM_COMPLETE</span> <span class="o">=</span> <span class="mi">58</span><span class="p">,</span>

	<span class="n">OP_ILLEGAL</span> <span class="o">=</span> <span class="mi">10044</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*Defining first and last NFS4 operations implemented.</span>
<span class="cm">Needs to be updated if more operations are defined in future.*/</span>

<span class="cp">#define FIRST_NFS4_OP	OP_ACCESS</span>
<span class="cp">#define LAST_NFS4_OP 	OP_RECLAIM_COMPLETE</span>

<span class="k">enum</span> <span class="n">nfsstat4</span> <span class="p">{</span>
	<span class="n">NFS4_OK</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4ERR_PERM</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">NFS4ERR_NOENT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">NFS4ERR_IO</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">NFS4ERR_NXIO</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">NFS4ERR_ACCESS</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">NFS4ERR_EXIST</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">NFS4ERR_XDEV</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="cm">/* Unused/reserved 19 */</span>
	<span class="n">NFS4ERR_NOTDIR</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">NFS4ERR_ISDIR</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">NFS4ERR_INVAL</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">NFS4ERR_FBIG</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
	<span class="n">NFS4ERR_NOSPC</span> <span class="o">=</span> <span class="mi">28</span><span class="p">,</span>
	<span class="n">NFS4ERR_ROFS</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
	<span class="n">NFS4ERR_MLINK</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
	<span class="n">NFS4ERR_NAMETOOLONG</span> <span class="o">=</span> <span class="mi">63</span><span class="p">,</span>
	<span class="n">NFS4ERR_NOTEMPTY</span> <span class="o">=</span> <span class="mi">66</span><span class="p">,</span>
	<span class="n">NFS4ERR_DQUOT</span> <span class="o">=</span> <span class="mi">69</span><span class="p">,</span>
	<span class="n">NFS4ERR_STALE</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADHANDLE</span> <span class="o">=</span> <span class="mi">10001</span><span class="p">,</span>
	<span class="n">NFS4ERR_BAD_COOKIE</span> <span class="o">=</span> <span class="mi">10003</span><span class="p">,</span>
	<span class="n">NFS4ERR_NOTSUPP</span> <span class="o">=</span> <span class="mi">10004</span><span class="p">,</span>
	<span class="n">NFS4ERR_TOOSMALL</span> <span class="o">=</span> <span class="mi">10005</span><span class="p">,</span>
	<span class="n">NFS4ERR_SERVERFAULT</span> <span class="o">=</span> <span class="mi">10006</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADTYPE</span> <span class="o">=</span> <span class="mi">10007</span><span class="p">,</span>
	<span class="n">NFS4ERR_DELAY</span> <span class="o">=</span> <span class="mi">10008</span><span class="p">,</span>
	<span class="n">NFS4ERR_SAME</span> <span class="o">=</span> <span class="mi">10009</span><span class="p">,</span>
	<span class="n">NFS4ERR_DENIED</span> <span class="o">=</span> <span class="mi">10010</span><span class="p">,</span>
	<span class="n">NFS4ERR_EXPIRED</span> <span class="o">=</span> <span class="mi">10011</span><span class="p">,</span>
	<span class="n">NFS4ERR_LOCKED</span> <span class="o">=</span> <span class="mi">10012</span><span class="p">,</span>
	<span class="n">NFS4ERR_GRACE</span> <span class="o">=</span> <span class="mi">10013</span><span class="p">,</span>
	<span class="n">NFS4ERR_FHEXPIRED</span> <span class="o">=</span> <span class="mi">10014</span><span class="p">,</span>
	<span class="n">NFS4ERR_SHARE_DENIED</span> <span class="o">=</span> <span class="mi">10015</span><span class="p">,</span>
	<span class="n">NFS4ERR_WRONGSEC</span> <span class="o">=</span> <span class="mi">10016</span><span class="p">,</span>
	<span class="n">NFS4ERR_CLID_INUSE</span> <span class="o">=</span> <span class="mi">10017</span><span class="p">,</span>
	<span class="n">NFS4ERR_RESOURCE</span> <span class="o">=</span> <span class="mi">10018</span><span class="p">,</span>
	<span class="n">NFS4ERR_MOVED</span> <span class="o">=</span> <span class="mi">10019</span><span class="p">,</span>
	<span class="n">NFS4ERR_NOFILEHANDLE</span> <span class="o">=</span> <span class="mi">10020</span><span class="p">,</span>
	<span class="n">NFS4ERR_MINOR_VERS_MISMATCH</span> <span class="o">=</span> <span class="mi">10021</span><span class="p">,</span>
	<span class="n">NFS4ERR_STALE_CLIENTID</span> <span class="o">=</span> <span class="mi">10022</span><span class="p">,</span>
	<span class="n">NFS4ERR_STALE_STATEID</span> <span class="o">=</span> <span class="mi">10023</span><span class="p">,</span>
	<span class="n">NFS4ERR_OLD_STATEID</span> <span class="o">=</span> <span class="mi">10024</span><span class="p">,</span>
	<span class="n">NFS4ERR_BAD_STATEID</span> <span class="o">=</span> <span class="mi">10025</span><span class="p">,</span>
	<span class="n">NFS4ERR_BAD_SEQID</span> <span class="o">=</span> <span class="mi">10026</span><span class="p">,</span>
	<span class="n">NFS4ERR_NOT_SAME</span> <span class="o">=</span> <span class="mi">10027</span><span class="p">,</span>
	<span class="n">NFS4ERR_LOCK_RANGE</span> <span class="o">=</span> <span class="mi">10028</span><span class="p">,</span>
	<span class="n">NFS4ERR_SYMLINK</span> <span class="o">=</span> <span class="mi">10029</span><span class="p">,</span>
	<span class="n">NFS4ERR_RESTOREFH</span> <span class="o">=</span> <span class="mi">10030</span><span class="p">,</span>
	<span class="n">NFS4ERR_LEASE_MOVED</span> <span class="o">=</span> <span class="mi">10031</span><span class="p">,</span>
	<span class="n">NFS4ERR_ATTRNOTSUPP</span> <span class="o">=</span> <span class="mi">10032</span><span class="p">,</span>
	<span class="n">NFS4ERR_NO_GRACE</span> <span class="o">=</span> <span class="mi">10033</span><span class="p">,</span>
	<span class="n">NFS4ERR_RECLAIM_BAD</span> <span class="o">=</span> <span class="mi">10034</span><span class="p">,</span>
	<span class="n">NFS4ERR_RECLAIM_CONFLICT</span> <span class="o">=</span> <span class="mi">10035</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADXDR</span> <span class="o">=</span> <span class="mi">10036</span><span class="p">,</span>
	<span class="n">NFS4ERR_LOCKS_HELD</span> <span class="o">=</span> <span class="mi">10037</span><span class="p">,</span>
	<span class="n">NFS4ERR_OPENMODE</span> <span class="o">=</span> <span class="mi">10038</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADOWNER</span> <span class="o">=</span> <span class="mi">10039</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADCHAR</span> <span class="o">=</span> <span class="mi">10040</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADNAME</span> <span class="o">=</span> <span class="mi">10041</span><span class="p">,</span>
	<span class="n">NFS4ERR_BAD_RANGE</span> <span class="o">=</span> <span class="mi">10042</span><span class="p">,</span>
	<span class="n">NFS4ERR_LOCK_NOTSUPP</span> <span class="o">=</span> <span class="mi">10043</span><span class="p">,</span>
	<span class="n">NFS4ERR_OP_ILLEGAL</span> <span class="o">=</span> <span class="mi">10044</span><span class="p">,</span>
	<span class="n">NFS4ERR_DEADLOCK</span> <span class="o">=</span> <span class="mi">10045</span><span class="p">,</span>
	<span class="n">NFS4ERR_FILE_OPEN</span> <span class="o">=</span> <span class="mi">10046</span><span class="p">,</span>
	<span class="n">NFS4ERR_ADMIN_REVOKED</span> <span class="o">=</span> <span class="mi">10047</span><span class="p">,</span>
	<span class="n">NFS4ERR_CB_PATH_DOWN</span> <span class="o">=</span> <span class="mi">10048</span><span class="p">,</span>

	<span class="cm">/* nfs41 */</span>
	<span class="n">NFS4ERR_BADIOMODE</span>	<span class="o">=</span> <span class="mi">10049</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADLAYOUT</span>	<span class="o">=</span> <span class="mi">10050</span><span class="p">,</span>
	<span class="n">NFS4ERR_BAD_SESSION_DIGEST</span> <span class="o">=</span> <span class="mi">10051</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADSESSION</span>	<span class="o">=</span> <span class="mi">10052</span><span class="p">,</span>
	<span class="n">NFS4ERR_BADSLOT</span>		<span class="o">=</span> <span class="mi">10053</span><span class="p">,</span>
	<span class="n">NFS4ERR_COMPLETE_ALREADY</span> <span class="o">=</span> <span class="mi">10054</span><span class="p">,</span>
	<span class="n">NFS4ERR_CONN_NOT_BOUND_TO_SESSION</span> <span class="o">=</span> <span class="mi">10055</span><span class="p">,</span>
	<span class="n">NFS4ERR_DELEG_ALREADY_WANTED</span> <span class="o">=</span> <span class="mi">10056</span><span class="p">,</span>
	<span class="n">NFS4ERR_BACK_CHAN_BUSY</span>	<span class="o">=</span> <span class="mi">10057</span><span class="p">,</span>	<span class="cm">/* backchan reqs outstanding */</span>
	<span class="n">NFS4ERR_LAYOUTTRYLATER</span>	<span class="o">=</span> <span class="mi">10058</span><span class="p">,</span>
	<span class="n">NFS4ERR_LAYOUTUNAVAILABLE</span> <span class="o">=</span> <span class="mi">10059</span><span class="p">,</span>
	<span class="n">NFS4ERR_NOMATCHING_LAYOUT</span> <span class="o">=</span> <span class="mi">10060</span><span class="p">,</span>
	<span class="n">NFS4ERR_RECALLCONFLICT</span>	<span class="o">=</span> <span class="mi">10061</span><span class="p">,</span>
	<span class="n">NFS4ERR_UNKNOWN_LAYOUTTYPE</span> <span class="o">=</span> <span class="mi">10062</span><span class="p">,</span>
	<span class="n">NFS4ERR_SEQ_MISORDERED</span> <span class="o">=</span> <span class="mi">10063</span><span class="p">,</span> 	<span class="cm">/* unexpected seq.id in req */</span>
	<span class="n">NFS4ERR_SEQUENCE_POS</span>	<span class="o">=</span> <span class="mi">10064</span><span class="p">,</span>	<span class="cm">/* [CB_]SEQ. op not 1st op */</span>
	<span class="n">NFS4ERR_REQ_TOO_BIG</span>	<span class="o">=</span> <span class="mi">10065</span><span class="p">,</span>	<span class="cm">/* request too big */</span>
	<span class="n">NFS4ERR_REP_TOO_BIG</span>	<span class="o">=</span> <span class="mi">10066</span><span class="p">,</span>	<span class="cm">/* reply too big */</span>
	<span class="n">NFS4ERR_REP_TOO_BIG_TO_CACHE</span> <span class="o">=</span> <span class="mi">10067</span><span class="p">,</span>	<span class="cm">/* rep. not all cached */</span>
	<span class="n">NFS4ERR_RETRY_UNCACHED_REP</span> <span class="o">=</span> <span class="mi">10068</span><span class="p">,</span>	<span class="cm">/* retry &amp; rep. uncached */</span>
	<span class="n">NFS4ERR_UNSAFE_COMPOUND</span> <span class="o">=</span> <span class="mi">10069</span><span class="p">,</span>	<span class="cm">/* retry/recovery too hard */</span>
	<span class="n">NFS4ERR_TOO_MANY_OPS</span>	<span class="o">=</span> <span class="mi">10070</span><span class="p">,</span>	<span class="cm">/* too many ops in [CB_]COMP */</span>
	<span class="n">NFS4ERR_OP_NOT_IN_SESSION</span> <span class="o">=</span> <span class="mi">10071</span><span class="p">,</span>	<span class="cm">/* op needs [CB_]SEQ. op */</span>
	<span class="n">NFS4ERR_HASH_ALG_UNSUPP</span> <span class="o">=</span> <span class="mi">10072</span><span class="p">,</span>	<span class="cm">/* hash alg. not supp. */</span>
						<span class="cm">/* Error 10073 is unused. */</span>
	<span class="n">NFS4ERR_CLIENTID_BUSY</span>	<span class="o">=</span> <span class="mi">10074</span><span class="p">,</span>	<span class="cm">/* clientid has state */</span>
	<span class="n">NFS4ERR_PNFS_IO_HOLE</span>	<span class="o">=</span> <span class="mi">10075</span><span class="p">,</span>	<span class="cm">/* IO to _SPARSE file hole */</span>
	<span class="n">NFS4ERR_SEQ_FALSE_RETRY</span>	<span class="o">=</span> <span class="mi">10076</span><span class="p">,</span>	<span class="cm">/* retry not original */</span>
	<span class="n">NFS4ERR_BAD_HIGH_SLOT</span>	<span class="o">=</span> <span class="mi">10077</span><span class="p">,</span>	<span class="cm">/* sequence arg bad */</span>
	<span class="n">NFS4ERR_DEADSESSION</span>	<span class="o">=</span> <span class="mi">10078</span><span class="p">,</span>	<span class="cm">/* persistent session dead */</span>
	<span class="n">NFS4ERR_ENCR_ALG_UNSUPP</span> <span class="o">=</span> <span class="mi">10079</span><span class="p">,</span>	<span class="cm">/* SSV alg mismatch */</span>
	<span class="n">NFS4ERR_PNFS_NO_LAYOUT</span>	<span class="o">=</span> <span class="mi">10080</span><span class="p">,</span>	<span class="cm">/* direct I/O with no layout */</span>
	<span class="n">NFS4ERR_NOT_ONLY_OP</span>	<span class="o">=</span> <span class="mi">10081</span><span class="p">,</span>	<span class="cm">/* bad compound */</span>
	<span class="n">NFS4ERR_WRONG_CRED</span>	<span class="o">=</span> <span class="mi">10082</span><span class="p">,</span>	<span class="cm">/* permissions:state change */</span>
	<span class="n">NFS4ERR_WRONG_TYPE</span>	<span class="o">=</span> <span class="mi">10083</span><span class="p">,</span>	<span class="cm">/* current operation mismatch */</span>
	<span class="n">NFS4ERR_DIRDELEG_UNAVAIL</span> <span class="o">=</span> <span class="mi">10084</span><span class="p">,</span>	<span class="cm">/* no directory delegation */</span>
	<span class="n">NFS4ERR_REJECT_DELEG</span>	<span class="o">=</span> <span class="mi">10085</span><span class="p">,</span>	<span class="cm">/* on callback */</span>
	<span class="n">NFS4ERR_RETURNCONFLICT</span>	<span class="o">=</span> <span class="mi">10086</span><span class="p">,</span>	<span class="cm">/* outstanding layoutreturn */</span>
	<span class="n">NFS4ERR_DELEG_REVOKED</span>	<span class="o">=</span> <span class="mi">10087</span><span class="p">,</span>	<span class="cm">/* deleg./layout revoked */</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">seqid_mutating_err</span><span class="p">(</span><span class="n">u32</span> <span class="n">err</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* rfc 3530 section 8.1.5: */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">NFS4ERR_STALE_CLIENTID</span>:
	<span class="k">case</span> <span class="n">NFS4ERR_STALE_STATEID</span>:
	<span class="k">case</span> <span class="n">NFS4ERR_BAD_STATEID</span>:
	<span class="k">case</span> <span class="n">NFS4ERR_BAD_SEQID</span>:
	<span class="k">case</span> <span class="n">NFS4ERR_BADXDR</span>:
	<span class="k">case</span> <span class="n">NFS4ERR_RESOURCE</span>:
	<span class="k">case</span> <span class="n">NFS4ERR_NOFILEHANDLE</span>:
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
	<span class="p">};</span>
	<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Note: NF4BAD is not actually part of the protocol; it is just used</span>
<span class="cm"> * internally by nfsd.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">nfs_ftype4</span> <span class="p">{</span>
	<span class="n">NF4BAD</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">NF4REG</span>          <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>    <span class="cm">/* Regular File */</span>
        <span class="n">NF4DIR</span>          <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>    <span class="cm">/* Directory */</span>
        <span class="n">NF4BLK</span>          <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>    <span class="cm">/* Special File - block device */</span>
        <span class="n">NF4CHR</span>          <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>    <span class="cm">/* Special File - character device */</span>
        <span class="n">NF4LNK</span>          <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>    <span class="cm">/* Symbolic Link */</span>
        <span class="n">NF4SOCK</span>         <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>    <span class="cm">/* Special File - socket */</span>
        <span class="n">NF4FIFO</span>         <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>    <span class="cm">/* Special File - fifo */</span>
        <span class="n">NF4ATTRDIR</span>      <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>    <span class="cm">/* Attribute Directory */</span>
        <span class="n">NF4NAMEDATTR</span>    <span class="o">=</span> <span class="mi">9</span>     <span class="cm">/* Named Attribute */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">open_claim_type4</span> <span class="p">{</span>
	<span class="n">NFS4_OPEN_CLAIM_NULL</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_CLAIM_PREVIOUS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_CLAIM_DELEGATE_CUR</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_CLAIM_DELEGATE_PREV</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_CLAIM_FH</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="cm">/* 4.1 */</span>
	<span class="n">NFS4_OPEN_CLAIM_DELEG_CUR_FH</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="cm">/* 4.1 */</span>
	<span class="n">NFS4_OPEN_CLAIM_DELEG_PREV_FH</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="cm">/* 4.1 */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">opentype4</span> <span class="p">{</span>
	<span class="n">NFS4_OPEN_NOCREATE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_CREATE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">createmode4</span> <span class="p">{</span>
	<span class="n">NFS4_CREATE_UNCHECKED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4_CREATE_GUARDED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">NFS4_CREATE_EXCLUSIVE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="cm">/*</span>
<span class="cm">	 * New to NFSv4.1. If session is persistent,</span>
<span class="cm">	 * GUARDED4 MUST be used. Otherwise, use</span>
<span class="cm">	 * EXCLUSIVE4_1 instead of EXCLUSIVE4.</span>
<span class="cm">	 */</span>
	<span class="n">NFS4_CREATE_EXCLUSIVE4_1</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">limit_by4</span> <span class="p">{</span>
	<span class="n">NFS4_LIMIT_SIZE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">NFS4_LIMIT_BLOCKS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">open_delegation_type4</span> <span class="p">{</span>
	<span class="n">NFS4_OPEN_DELEGATE_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_DELEGATE_READ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_DELEGATE_WRITE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">NFS4_OPEN_DELEGATE_NONE_EXT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="cm">/* 4.1 */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">why_no_delegation4</span> <span class="p">{</span> <span class="cm">/* new to v4.1 */</span>
	<span class="n">WND4_NOT_WANTED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WND4_CONTENTION</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WND4_RESOURCE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WND4_NOT_SUPP_FTYPE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WND4_WRITE_DELEG_NOT_SUPP_FTYPE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WND4_NOT_SUPP_UPGRADE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">WND4_NOT_SUPP_DOWNGRADE</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">WND4_CANCELLED</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">WND4_IS_DIR</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">lock_type4</span> <span class="p">{</span>
	<span class="n">NFS4_UNLOCK_LT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFS4_READ_LT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">NFS4_WRITE_LT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">NFS4_READW_LT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">NFS4_WRITEW_LT</span> <span class="o">=</span> <span class="mi">4</span>
<span class="p">};</span>


<span class="cm">/* Mandatory Attributes */</span>
<span class="cp">#define FATTR4_WORD0_SUPPORTED_ATTRS    (1UL &lt;&lt; 0)</span>
<span class="cp">#define FATTR4_WORD0_TYPE               (1UL &lt;&lt; 1)</span>
<span class="cp">#define FATTR4_WORD0_FH_EXPIRE_TYPE     (1UL &lt;&lt; 2)</span>
<span class="cp">#define FATTR4_WORD0_CHANGE             (1UL &lt;&lt; 3)</span>
<span class="cp">#define FATTR4_WORD0_SIZE               (1UL &lt;&lt; 4)</span>
<span class="cp">#define FATTR4_WORD0_LINK_SUPPORT       (1UL &lt;&lt; 5)</span>
<span class="cp">#define FATTR4_WORD0_SYMLINK_SUPPORT    (1UL &lt;&lt; 6)</span>
<span class="cp">#define FATTR4_WORD0_NAMED_ATTR         (1UL &lt;&lt; 7)</span>
<span class="cp">#define FATTR4_WORD0_FSID               (1UL &lt;&lt; 8)</span>
<span class="cp">#define FATTR4_WORD0_UNIQUE_HANDLES     (1UL &lt;&lt; 9)</span>
<span class="cp">#define FATTR4_WORD0_LEASE_TIME         (1UL &lt;&lt; 10)</span>
<span class="cp">#define FATTR4_WORD0_RDATTR_ERROR       (1UL &lt;&lt; 11)</span>
<span class="cm">/* Mandatory in NFSv4.1 */</span>
<span class="cp">#define FATTR4_WORD2_SUPPATTR_EXCLCREAT (1UL &lt;&lt; 11)</span>

<span class="cm">/* Recommended Attributes */</span>
<span class="cp">#define FATTR4_WORD0_ACL                (1UL &lt;&lt; 12)</span>
<span class="cp">#define FATTR4_WORD0_ACLSUPPORT         (1UL &lt;&lt; 13)</span>
<span class="cp">#define FATTR4_WORD0_ARCHIVE            (1UL &lt;&lt; 14)</span>
<span class="cp">#define FATTR4_WORD0_CANSETTIME         (1UL &lt;&lt; 15)</span>
<span class="cp">#define FATTR4_WORD0_CASE_INSENSITIVE   (1UL &lt;&lt; 16)</span>
<span class="cp">#define FATTR4_WORD0_CASE_PRESERVING    (1UL &lt;&lt; 17)</span>
<span class="cp">#define FATTR4_WORD0_CHOWN_RESTRICTED   (1UL &lt;&lt; 18)</span>
<span class="cp">#define FATTR4_WORD0_FILEHANDLE         (1UL &lt;&lt; 19)</span>
<span class="cp">#define FATTR4_WORD0_FILEID             (1UL &lt;&lt; 20)</span>
<span class="cp">#define FATTR4_WORD0_FILES_AVAIL        (1UL &lt;&lt; 21)</span>
<span class="cp">#define FATTR4_WORD0_FILES_FREE         (1UL &lt;&lt; 22)</span>
<span class="cp">#define FATTR4_WORD0_FILES_TOTAL        (1UL &lt;&lt; 23)</span>
<span class="cp">#define FATTR4_WORD0_FS_LOCATIONS       (1UL &lt;&lt; 24)</span>
<span class="cp">#define FATTR4_WORD0_HIDDEN             (1UL &lt;&lt; 25)</span>
<span class="cp">#define FATTR4_WORD0_HOMOGENEOUS        (1UL &lt;&lt; 26)</span>
<span class="cp">#define FATTR4_WORD0_MAXFILESIZE        (1UL &lt;&lt; 27)</span>
<span class="cp">#define FATTR4_WORD0_MAXLINK            (1UL &lt;&lt; 28)</span>
<span class="cp">#define FATTR4_WORD0_MAXNAME            (1UL &lt;&lt; 29)</span>
<span class="cp">#define FATTR4_WORD0_MAXREAD            (1UL &lt;&lt; 30)</span>
<span class="cp">#define FATTR4_WORD0_MAXWRITE           (1UL &lt;&lt; 31)</span>
<span class="cp">#define FATTR4_WORD1_MIMETYPE           (1UL &lt;&lt; 0)</span>
<span class="cp">#define FATTR4_WORD1_MODE               (1UL &lt;&lt; 1)</span>
<span class="cp">#define FATTR4_WORD1_NO_TRUNC           (1UL &lt;&lt; 2)</span>
<span class="cp">#define FATTR4_WORD1_NUMLINKS           (1UL &lt;&lt; 3)</span>
<span class="cp">#define FATTR4_WORD1_OWNER              (1UL &lt;&lt; 4)</span>
<span class="cp">#define FATTR4_WORD1_OWNER_GROUP        (1UL &lt;&lt; 5)</span>
<span class="cp">#define FATTR4_WORD1_QUOTA_HARD         (1UL &lt;&lt; 6)</span>
<span class="cp">#define FATTR4_WORD1_QUOTA_SOFT         (1UL &lt;&lt; 7)</span>
<span class="cp">#define FATTR4_WORD1_QUOTA_USED         (1UL &lt;&lt; 8)</span>
<span class="cp">#define FATTR4_WORD1_RAWDEV             (1UL &lt;&lt; 9)</span>
<span class="cp">#define FATTR4_WORD1_SPACE_AVAIL        (1UL &lt;&lt; 10)</span>
<span class="cp">#define FATTR4_WORD1_SPACE_FREE         (1UL &lt;&lt; 11)</span>
<span class="cp">#define FATTR4_WORD1_SPACE_TOTAL        (1UL &lt;&lt; 12)</span>
<span class="cp">#define FATTR4_WORD1_SPACE_USED         (1UL &lt;&lt; 13)</span>
<span class="cp">#define FATTR4_WORD1_SYSTEM             (1UL &lt;&lt; 14)</span>
<span class="cp">#define FATTR4_WORD1_TIME_ACCESS        (1UL &lt;&lt; 15)</span>
<span class="cp">#define FATTR4_WORD1_TIME_ACCESS_SET    (1UL &lt;&lt; 16)</span>
<span class="cp">#define FATTR4_WORD1_TIME_BACKUP        (1UL &lt;&lt; 17)</span>
<span class="cp">#define FATTR4_WORD1_TIME_CREATE        (1UL &lt;&lt; 18)</span>
<span class="cp">#define FATTR4_WORD1_TIME_DELTA         (1UL &lt;&lt; 19)</span>
<span class="cp">#define FATTR4_WORD1_TIME_METADATA      (1UL &lt;&lt; 20)</span>
<span class="cp">#define FATTR4_WORD1_TIME_MODIFY        (1UL &lt;&lt; 21)</span>
<span class="cp">#define FATTR4_WORD1_TIME_MODIFY_SET    (1UL &lt;&lt; 22)</span>
<span class="cp">#define FATTR4_WORD1_MOUNTED_ON_FILEID  (1UL &lt;&lt; 23)</span>
<span class="cp">#define FATTR4_WORD1_FS_LAYOUT_TYPES    (1UL &lt;&lt; 30)</span>
<span class="cp">#define FATTR4_WORD2_LAYOUT_BLKSIZE     (1UL &lt;&lt; 1)</span>
<span class="cp">#define FATTR4_WORD2_MDSTHRESHOLD       (1UL &lt;&lt; 4)</span>

<span class="cm">/* MDS threshold bitmap bits */</span>
<span class="cp">#define THRESHOLD_RD                    (1UL &lt;&lt; 0)</span>
<span class="cp">#define THRESHOLD_WR                    (1UL &lt;&lt; 1)</span>
<span class="cp">#define THRESHOLD_RD_IO                 (1UL &lt;&lt; 2)</span>
<span class="cp">#define THRESHOLD_WR_IO                 (1UL &lt;&lt; 3)</span>

<span class="cp">#define NFSPROC4_NULL 0</span>
<span class="cp">#define NFSPROC4_COMPOUND 1</span>
<span class="cp">#define NFS4_VERSION 4</span>
<span class="cp">#define NFS4_MINOR_VERSION 0</span>

<span class="cp">#if defined(CONFIG_NFS_V4_1)</span>
<span class="cp">#define NFS4_MAX_MINOR_VERSION 1</span>
<span class="cp">#else</span>
<span class="cp">#define NFS4_MAX_MINOR_VERSION 0</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_NFS_V4_1 */</span><span class="cp"></span>

<span class="cp">#define NFS4_DEBUG 1</span>

<span class="cm">/* Index of predefined Linux client operations */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">NFSPROC4_CLNT_NULL</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* Unused */</span>
	<span class="n">NFSPROC4_CLNT_READ</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_WRITE</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_COMMIT</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_OPEN</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_OPEN_CONFIRM</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_OPEN_NOATTR</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_OPEN_DOWNGRADE</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_CLOSE</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SETATTR</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_FSINFO</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_RENEW</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SETCLIENTID</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SETCLIENTID_CONFIRM</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LOCK</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LOCKT</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LOCKU</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_ACCESS</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_GETATTR</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LOOKUP</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LOOKUP_ROOT</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_REMOVE</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_RENAME</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LINK</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SYMLINK</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_CREATE</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_PATHCONF</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_STATFS</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_READLINK</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_READDIR</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SERVER_CAPS</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_DELEGRETURN</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_GETACL</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SETACL</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_FS_LOCATIONS</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_RELEASE_LOCKOWNER</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SECINFO</span><span class="p">,</span>

	<span class="cm">/* nfs41 */</span>
	<span class="n">NFSPROC4_CLNT_EXCHANGE_ID</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_CREATE_SESSION</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_DESTROY_SESSION</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SEQUENCE</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_GET_LEASE_TIME</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_RECLAIM_COMPLETE</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LAYOUTGET</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_GETDEVICEINFO</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LAYOUTCOMMIT</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_LAYOUTRETURN</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_SECINFO_NO_NAME</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_TEST_STATEID</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_FREE_STATEID</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_GETDEVICELIST</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_BIND_CONN_TO_SESSION</span><span class="p">,</span>
	<span class="n">NFSPROC4_CLNT_DESTROY_CLIENTID</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* nfs41 types */</span>
<span class="k">struct</span> <span class="n">nfs4_sessionid</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">[</span><span class="n">NFS4_MAX_SESSIONID_LEN</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* Create Session Flags */</span>
<span class="cp">#define SESSION4_PERSIST	0x001</span>
<span class="cp">#define SESSION4_BACK_CHAN	0x002</span>
<span class="cp">#define SESSION4_RDMA		0x004</span>

<span class="cp">#define SESSION4_FLAG_MASK_A	0x007</span>

<span class="k">enum</span> <span class="n">state_protect_how4</span> <span class="p">{</span>
	<span class="n">SP4_NONE</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SP4_MACH_CRED</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">SP4_SSV</span>		<span class="o">=</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">pnfs_layouttype</span> <span class="p">{</span>
	<span class="n">LAYOUT_NFSV4_1_FILES</span>  <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">LAYOUT_OSD2_OBJECTS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">LAYOUT_BLOCK_VOLUME</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* used for both layout return and recall */</span>
<span class="k">enum</span> <span class="n">pnfs_layoutreturn_type</span> <span class="p">{</span>
	<span class="n">RETURN_FILE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">RETURN_FSID</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">RETURN_ALL</span>  <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">pnfs_iomode</span> <span class="p">{</span>
	<span class="n">IOMODE_READ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IOMODE_RW</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">IOMODE_ANY</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">pnfs_notify_deviceid_type4</span> <span class="p">{</span>
	<span class="n">NOTIFY_DEVICEID4_CHANGE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">NOTIFY_DEVICEID4_DELETE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define NFL4_UFLG_MASK			0x0000003F</span>
<span class="cp">#define NFL4_UFLG_DENSE			0x00000001</span>
<span class="cp">#define NFL4_UFLG_COMMIT_THRU_MDS	0x00000002</span>
<span class="cp">#define NFL4_UFLG_STRIPE_UNIT_SIZE_MASK	0xFFFFFFC0</span>

<span class="cm">/* Encoded in the loh_body field of type layouthint4 */</span>
<span class="k">enum</span> <span class="n">filelayout_hint_care4</span> <span class="p">{</span>
	<span class="n">NFLH4_CARE_DENSE</span>		<span class="o">=</span> <span class="n">NFL4_UFLG_DENSE</span><span class="p">,</span>
	<span class="n">NFLH4_CARE_COMMIT_THRU_MDS</span>	<span class="o">=</span> <span class="n">NFL4_UFLG_COMMIT_THRU_MDS</span><span class="p">,</span>
	<span class="n">NFLH4_CARE_STRIPE_UNIT_SIZE</span>	<span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
	<span class="n">NFLH4_CARE_STRIPE_COUNT</span>		<span class="o">=</span> <span class="mh">0x00000080</span>
<span class="p">};</span>

<span class="cp">#define NFS4_DEVICEID4_SIZE 16</span>

<span class="k">struct</span> <span class="n">nfs4_deviceid</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="n">data</span><span class="p">[</span><span class="n">NFS4_DEVICEID4_SIZE</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * Local variables:</span>
<span class="cm"> *  c-basic-offset: 8</span>
<span class="cm"> * End:</span>
<span class="cm"> */</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
