<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › sunrpc › gss_krb5.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>gss_krb5.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  linux/include/linux/sunrpc/gss_krb5_types.h</span>
<span class="cm"> *</span>
<span class="cm"> *  Adapted from MIT Kerberos 5-1.2.1 lib/include/krb5.h,</span>
<span class="cm"> *  lib/gssapi/krb5/gssapiP_krb5.h, and others</span>
<span class="cm"> *</span>
<span class="cm"> *  Copyright (c) 2000-2008 The Regents of the University of Michigan.</span>
<span class="cm"> *  All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> *  Andy Adamson   &lt;andros@umich.edu&gt;</span>
<span class="cm"> *  Bruce Fields   &lt;bfields@umich.edu&gt;</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Copyright 1995 by the Massachusetts Institute of Technology.</span>
<span class="cm"> * All Rights Reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Export of this software from the United States of America may</span>
<span class="cm"> *   require a specific license from the United States Government.</span>
<span class="cm"> *   It is the responsibility of any person or organization contemplating</span>
<span class="cm"> *   export to obtain such a license before exporting.</span>
<span class="cm"> *</span>
<span class="cm"> * WITHIN THAT CONSTRAINT, permission to use, copy, modify, and</span>
<span class="cm"> * distribute this software and its documentation for any purpose and</span>
<span class="cm"> * without fee is hereby granted, provided that the above copyright</span>
<span class="cm"> * notice appear in all copies and that both that copyright notice and</span>
<span class="cm"> * this permission notice appear in supporting documentation, and that</span>
<span class="cm"> * the name of M.I.T. not be used in advertising or publicity pertaining</span>
<span class="cm"> * to distribution of the software without specific, written prior</span>
<span class="cm"> * permission.  Furthermore if you modify this software you must label</span>
<span class="cm"> * your software as modified software and not distribute it in such a</span>
<span class="cm"> * fashion that it might be confused with the original M.I.T. software.</span>
<span class="cm"> * M.I.T. makes no representations about the suitability of</span>
<span class="cm"> * this software for any purpose.  It is provided &quot;as is&quot; without express</span>
<span class="cm"> * or implied warranty.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/crypto.h&gt;</span>
<span class="cp">#include &lt;linux/sunrpc/auth_gss.h&gt;</span>
<span class="cp">#include &lt;linux/sunrpc/gss_err.h&gt;</span>
<span class="cp">#include &lt;linux/sunrpc/gss_asn1.h&gt;</span>

<span class="cm">/* Length of constant used in key derivation */</span>
<span class="cp">#define GSS_KRB5_K5CLENGTH (5)</span>

<span class="cm">/* Maximum key length (in bytes) for the supported crypto algorithms*/</span>
<span class="cp">#define GSS_KRB5_MAX_KEYLEN (32)</span>

<span class="cm">/* Maximum checksum function output for the supported crypto algorithms */</span>
<span class="cp">#define GSS_KRB5_MAX_CKSUM_LEN  (20)</span>

<span class="cm">/* Maximum blocksize for the supported crypto algorithms */</span>
<span class="cp">#define GSS_KRB5_MAX_BLOCKSIZE  (16)</span>

<span class="k">struct</span> <span class="n">krb5_ctx</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">gss_krb5_enctype</span> <span class="p">{</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">etype</span><span class="p">;</span>		<span class="cm">/* encryption (key) type */</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">ctype</span><span class="p">;</span>		<span class="cm">/* checksum type */</span>
	<span class="k">const</span> <span class="kt">char</span>		<span class="o">*</span><span class="n">name</span><span class="p">;</span>		<span class="cm">/* &quot;friendly&quot; name */</span>
	<span class="k">const</span> <span class="kt">char</span>		<span class="o">*</span><span class="n">encrypt_name</span><span class="p">;</span>	<span class="cm">/* crypto encrypt name */</span>
	<span class="k">const</span> <span class="kt">char</span>		<span class="o">*</span><span class="n">cksum_name</span><span class="p">;</span>	<span class="cm">/* crypto checksum name */</span>
	<span class="k">const</span> <span class="n">u16</span>		<span class="n">signalg</span><span class="p">;</span>	<span class="cm">/* signing algorithm */</span>
	<span class="k">const</span> <span class="n">u16</span>		<span class="n">sealalg</span><span class="p">;</span>	<span class="cm">/* sealing algorithm */</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">blocksize</span><span class="p">;</span>	<span class="cm">/* encryption blocksize */</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">conflen</span><span class="p">;</span>	<span class="cm">/* confounder length</span>
<span class="cm">						   (normally the same as</span>
<span class="cm">						   the blocksize) */</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">cksumlength</span><span class="p">;</span>	<span class="cm">/* checksum length */</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">keyed_cksum</span><span class="p">;</span>	<span class="cm">/* is it a keyed cksum? */</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">keybytes</span><span class="p">;</span>	<span class="cm">/* raw key len, in bytes */</span>
	<span class="k">const</span> <span class="n">u32</span>		<span class="n">keylength</span><span class="p">;</span>	<span class="cm">/* final key len, in bytes */</span>
	<span class="n">u32</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
			<span class="kt">void</span> <span class="o">*</span><span class="n">iv</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span>
			<span class="kt">int</span> <span class="n">length</span><span class="p">);</span>		<span class="cm">/* encryption function */</span>
	<span class="n">u32</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
			<span class="kt">void</span> <span class="o">*</span><span class="n">iv</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span>
			<span class="kt">int</span> <span class="n">length</span><span class="p">);</span>		<span class="cm">/* decryption function */</span>
	<span class="n">u32</span> <span class="p">(</span><span class="o">*</span><span class="n">mk_key</span><span class="p">)</span> <span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">gss_krb5_enctype</span> <span class="o">*</span><span class="n">gk5e</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">out</span><span class="p">);</span>	<span class="cm">/* complete key generation */</span>
	<span class="n">u32</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt_v2</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ec</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">page</span> <span class="o">**</span><span class="n">pages</span><span class="p">);</span> <span class="cm">/* v2 encryption function */</span>
	<span class="n">u32</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt_v2</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">headskip</span><span class="p">,</span>
			   <span class="n">u32</span> <span class="o">*</span><span class="n">tailskip</span><span class="p">);</span>	<span class="cm">/* v2 decryption function */</span>
<span class="p">};</span>

<span class="cm">/* krb5_ctx flags definitions */</span>
<span class="cp">#define KRB5_CTX_FLAG_INITIATOR         0x00000001</span>
<span class="cp">#define KRB5_CTX_FLAG_CFX               0x00000002</span>
<span class="cp">#define KRB5_CTX_FLAG_ACCEPTOR_SUBKEY   0x00000004</span>

<span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="p">{</span>
	<span class="kt">int</span>			<span class="n">initiate</span><span class="p">;</span> <span class="cm">/* 1 = initiating, 0 = accepting */</span>
	<span class="n">u32</span>			<span class="n">enctype</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">flags</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">gss_krb5_enctype</span> <span class="o">*</span><span class="n">gk5e</span><span class="p">;</span> <span class="cm">/* enctype-specific info */</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span>	<span class="o">*</span><span class="n">enc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span>	<span class="o">*</span><span class="n">seq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">acceptor_enc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">initiator_enc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">acceptor_enc_aux</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">initiator_enc_aux</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">Ksess</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span> <span class="cm">/* session key */</span>
	<span class="n">u8</span>			<span class="n">cksum</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span>
	<span class="n">s32</span>			<span class="n">endtime</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">seq_send</span><span class="p">;</span>
	<span class="n">u64</span>			<span class="n">seq_send64</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xdr_netobj</span>	<span class="n">mech_used</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">initiator_sign</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span>
	<span class="n">u8</span>			<span class="n">acceptor_sign</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span>
	<span class="n">u8</span>			<span class="n">initiator_seal</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span>
	<span class="n">u8</span>			<span class="n">acceptor_seal</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span>
	<span class="n">u8</span>			<span class="n">initiator_integ</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span>
	<span class="n">u8</span>			<span class="n">acceptor_integ</span><span class="p">[</span><span class="n">GSS_KRB5_MAX_KEYLEN</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="n">spinlock_t</span> <span class="n">krb5_seq_lock</span><span class="p">;</span>

<span class="cm">/* The length of the Kerberos GSS token header */</span>
<span class="cp">#define GSS_KRB5_TOK_HDR_LEN	(16)</span>

<span class="cp">#define KG_TOK_MIC_MSG    0x0101</span>
<span class="cp">#define KG_TOK_WRAP_MSG   0x0201</span>

<span class="cp">#define KG2_TOK_INITIAL     0x0101</span>
<span class="cp">#define KG2_TOK_RESPONSE    0x0202</span>
<span class="cp">#define KG2_TOK_MIC         0x0404</span>
<span class="cp">#define KG2_TOK_WRAP        0x0504</span>

<span class="cp">#define KG2_TOKEN_FLAG_SENTBYACCEPTOR   0x01</span>
<span class="cp">#define KG2_TOKEN_FLAG_SEALED           0x02</span>
<span class="cp">#define KG2_TOKEN_FLAG_ACCEPTORSUBKEY   0x04</span>

<span class="cp">#define KG2_RESP_FLAG_ERROR             0x0001</span>
<span class="cp">#define KG2_RESP_FLAG_DELEG_OK          0x0002</span>

<span class="k">enum</span> <span class="n">sgn_alg</span> <span class="p">{</span>
	<span class="n">SGN_ALG_DES_MAC_MD5</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">,</span>
	<span class="n">SGN_ALG_MD2_5</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>
	<span class="n">SGN_ALG_DES_MAC</span> <span class="o">=</span> <span class="mh">0x0002</span><span class="p">,</span>
	<span class="n">SGN_ALG_3</span> <span class="o">=</span> <span class="mh">0x0003</span><span class="p">,</span>		<span class="cm">/* not published */</span>
	<span class="n">SGN_ALG_HMAC_MD5</span> <span class="o">=</span> <span class="mh">0x0011</span><span class="p">,</span>	<span class="cm">/* microsoft w2k; no support */</span>
	<span class="n">SGN_ALG_HMAC_SHA1_DES3_KD</span> <span class="o">=</span> <span class="mh">0x0004</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="n">seal_alg</span> <span class="p">{</span>
	<span class="n">SEAL_ALG_NONE</span> <span class="o">=</span> <span class="mh">0xffff</span><span class="p">,</span>
	<span class="n">SEAL_ALG_DES</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">,</span>
	<span class="n">SEAL_ALG_1</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>		<span class="cm">/* not published */</span>
	<span class="n">SEAL_ALG_MICROSOFT_RC4</span> <span class="o">=</span> <span class="mh">0x0010</span><span class="p">,</span><span class="cm">/* microsoft w2k; no support */</span>
	<span class="n">SEAL_ALG_DES3KD</span> <span class="o">=</span> <span class="mh">0x0002</span>
<span class="p">};</span>

<span class="cp">#define CKSUMTYPE_CRC32			0x0001</span>
<span class="cp">#define CKSUMTYPE_RSA_MD4		0x0002</span>
<span class="cp">#define CKSUMTYPE_RSA_MD4_DES		0x0003</span>
<span class="cp">#define CKSUMTYPE_DESCBC		0x0004</span>
<span class="cp">#define CKSUMTYPE_RSA_MD5		0x0007</span>
<span class="cp">#define CKSUMTYPE_RSA_MD5_DES		0x0008</span>
<span class="cp">#define CKSUMTYPE_NIST_SHA		0x0009</span>
<span class="cp">#define CKSUMTYPE_HMAC_SHA1_DES3	0x000c</span>
<span class="cp">#define CKSUMTYPE_HMAC_SHA1_96_AES128   0x000f</span>
<span class="cp">#define CKSUMTYPE_HMAC_SHA1_96_AES256   0x0010</span>
<span class="cp">#define CKSUMTYPE_HMAC_MD5_ARCFOUR      -138 </span><span class="cm">/* Microsoft md5 hmac cksumtype */</span><span class="cp"></span>

<span class="cm">/* from gssapi_err_krb5.h */</span>
<span class="cp">#define KG_CCACHE_NOMATCH                        (39756032L)</span>
<span class="cp">#define KG_KEYTAB_NOMATCH                        (39756033L)</span>
<span class="cp">#define KG_TGT_MISSING                           (39756034L)</span>
<span class="cp">#define KG_NO_SUBKEY                             (39756035L)</span>
<span class="cp">#define KG_CONTEXT_ESTABLISHED                   (39756036L)</span>
<span class="cp">#define KG_BAD_SIGN_TYPE                         (39756037L)</span>
<span class="cp">#define KG_BAD_LENGTH                            (39756038L)</span>
<span class="cp">#define KG_CTX_INCOMPLETE                        (39756039L)</span>
<span class="cp">#define KG_CONTEXT                               (39756040L)</span>
<span class="cp">#define KG_CRED                                  (39756041L)</span>
<span class="cp">#define KG_ENC_DESC                              (39756042L)</span>
<span class="cp">#define KG_BAD_SEQ                               (39756043L)</span>
<span class="cp">#define KG_EMPTY_CCACHE                          (39756044L)</span>
<span class="cp">#define KG_NO_CTYPES                             (39756045L)</span>

<span class="cm">/* per Kerberos v5 protocol spec crypto types from the wire. </span>
<span class="cm"> * these get mapped to linux kernel crypto routines.  </span>
<span class="cm"> */</span>
<span class="cp">#define ENCTYPE_NULL            0x0000</span>
<span class="cp">#define ENCTYPE_DES_CBC_CRC     0x0001	</span><span class="cm">/* DES cbc mode with CRC-32 */</span><span class="cp"></span>
<span class="cp">#define ENCTYPE_DES_CBC_MD4     0x0002	</span><span class="cm">/* DES cbc mode with RSA-MD4 */</span><span class="cp"></span>
<span class="cp">#define ENCTYPE_DES_CBC_MD5     0x0003	</span><span class="cm">/* DES cbc mode with RSA-MD5 */</span><span class="cp"></span>
<span class="cp">#define ENCTYPE_DES_CBC_RAW     0x0004	</span><span class="cm">/* DES cbc mode raw */</span><span class="cp"></span>
<span class="cm">/* XXX deprecated? */</span>
<span class="cp">#define ENCTYPE_DES3_CBC_SHA    0x0005	</span><span class="cm">/* DES-3 cbc mode with NIST-SHA */</span><span class="cp"></span>
<span class="cp">#define ENCTYPE_DES3_CBC_RAW    0x0006	</span><span class="cm">/* DES-3 cbc mode raw */</span><span class="cp"></span>
<span class="cp">#define ENCTYPE_DES_HMAC_SHA1   0x0008</span>
<span class="cp">#define ENCTYPE_DES3_CBC_SHA1   0x0010</span>
<span class="cp">#define ENCTYPE_AES128_CTS_HMAC_SHA1_96 0x0011</span>
<span class="cp">#define ENCTYPE_AES256_CTS_HMAC_SHA1_96 0x0012</span>
<span class="cp">#define ENCTYPE_ARCFOUR_HMAC            0x0017</span>
<span class="cp">#define ENCTYPE_ARCFOUR_HMAC_EXP        0x0018</span>
<span class="cp">#define ENCTYPE_UNKNOWN         0x01ff</span>

<span class="cm">/*</span>
<span class="cm"> * Constants used for key derivation</span>
<span class="cm"> */</span>
<span class="cm">/* for 3DES */</span>
<span class="cp">#define KG_USAGE_SEAL (22)</span>
<span class="cp">#define KG_USAGE_SIGN (23)</span>
<span class="cp">#define KG_USAGE_SEQ  (24)</span>

<span class="cm">/* from rfc3961 */</span>
<span class="cp">#define KEY_USAGE_SEED_CHECKSUM         (0x99)</span>
<span class="cp">#define KEY_USAGE_SEED_ENCRYPTION       (0xAA)</span>
<span class="cp">#define KEY_USAGE_SEED_INTEGRITY        (0x55)</span>

<span class="cm">/* from rfc4121 */</span>
<span class="cp">#define KG_USAGE_ACCEPTOR_SEAL  (22)</span>
<span class="cp">#define KG_USAGE_ACCEPTOR_SIGN  (23)</span>
<span class="cp">#define KG_USAGE_INITIATOR_SEAL (24)</span>
<span class="cp">#define KG_USAGE_INITIATOR_SIGN (25)</span>

<span class="cm">/*</span>
<span class="cm"> * This compile-time check verifies that we will not exceed the</span>
<span class="cm"> * slack space allotted by the client and server auth_gss code</span>
<span class="cm"> * before they call gss_wrap().</span>
<span class="cm"> */</span>
<span class="cp">#define GSS_KRB5_MAX_SLACK_NEEDED \</span>
<span class="cp">	(GSS_KRB5_TOK_HDR_LEN     </span><span class="cm">/* gss token header */</span><span class="cp">         \</span>
<span class="cp">	+ GSS_KRB5_MAX_CKSUM_LEN  </span><span class="cm">/* gss token checksum */</span><span class="cp">       \</span>
<span class="cp">	+ GSS_KRB5_MAX_BLOCKSIZE  </span><span class="cm">/* confounder */</span><span class="cp">               \</span>
<span class="cp">	+ GSS_KRB5_MAX_BLOCKSIZE  </span><span class="cm">/* possible padding */</span><span class="cp">         \</span>
<span class="cp">	+ GSS_KRB5_TOK_HDR_LEN    </span><span class="cm">/* encrypted hdr in v2 token */</span><span class="cp">\</span>
<span class="cp">	+ GSS_KRB5_MAX_CKSUM_LEN  </span><span class="cm">/* encryption hmac */</span><span class="cp">          \</span>
<span class="cp">	+ 4 + 4                   </span><span class="cm">/* RPC verifier */</span><span class="cp">             \</span>
<span class="cp">	+ GSS_KRB5_TOK_HDR_LEN                                   \</span>
<span class="cp">	+ GSS_KRB5_MAX_CKSUM_LEN)</span>

<span class="n">u32</span>
<span class="n">make_checksum</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">header</span><span class="p">,</span> <span class="kt">int</span> <span class="n">hdrlen</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">body</span><span class="p">,</span> <span class="kt">int</span> <span class="n">body_offset</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">cksumkey</span><span class="p">,</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">usage</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">cksumout</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">make_checksum_v2</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">header</span><span class="p">,</span> <span class="kt">int</span> <span class="n">hdrlen</span><span class="p">,</span>
		 <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">body</span><span class="p">,</span> <span class="kt">int</span> <span class="n">body_offset</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">usage</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">cksum</span><span class="p">);</span>

<span class="n">u32</span> <span class="n">gss_get_mic_kerberos</span><span class="p">(</span><span class="k">struct</span> <span class="n">gss_ctx</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="p">);</span>

<span class="n">u32</span> <span class="n">gss_verify_mic_kerberos</span><span class="p">(</span><span class="k">struct</span> <span class="n">gss_ctx</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">gss_wrap_kerberos</span><span class="p">(</span><span class="k">struct</span> <span class="n">gss_ctx</span> <span class="o">*</span><span class="n">ctx_id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">outbuf</span><span class="p">,</span> <span class="k">struct</span> <span class="n">page</span> <span class="o">**</span><span class="n">pages</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">gss_unwrap_kerberos</span><span class="p">(</span><span class="k">struct</span> <span class="n">gss_ctx</span> <span class="o">*</span><span class="n">ctx_id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">);</span>


<span class="n">u32</span>
<span class="n">krb5_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	     <span class="kt">void</span> <span class="o">*</span><span class="n">iv</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">krb5_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	     <span class="kt">void</span> <span class="o">*</span><span class="n">iv</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">in</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">out</span><span class="p">,</span> <span class="kt">int</span> <span class="n">length</span><span class="p">);</span> 

<span class="kt">int</span>
<span class="n">gss_encrypt_xdr_buf</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">outbuf</span><span class="p">,</span>
		    <span class="kt">int</span> <span class="n">offset</span><span class="p">,</span> <span class="k">struct</span> <span class="n">page</span> <span class="o">**</span><span class="n">pages</span><span class="p">);</span>

<span class="kt">int</span>
<span class="n">gss_decrypt_xdr_buf</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">inbuf</span><span class="p">,</span>
		    <span class="kt">int</span> <span class="n">offset</span><span class="p">);</span>

<span class="n">s32</span>
<span class="n">krb5_make_seq_num</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
		<span class="kt">int</span> <span class="n">direction</span><span class="p">,</span>
		<span class="n">u32</span> <span class="n">seqnum</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cksum</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">);</span>

<span class="n">s32</span>
<span class="n">krb5_get_seq_num</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span>
	       <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cksum</span><span class="p">,</span>
	       <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">direction</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">seqnum</span><span class="p">);</span>

<span class="kt">int</span>
<span class="n">xdr_extend_head</span><span class="p">(</span><span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">base</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">shiftlen</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">krb5_derive_key</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">gss_krb5_enctype</span> <span class="o">*</span><span class="n">gk5e</span><span class="p">,</span>
		<span class="k">const</span> <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">inkey</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">outkey</span><span class="p">,</span>
		<span class="k">const</span> <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">in_constant</span><span class="p">,</span>
		<span class="n">gfp_t</span> <span class="n">gfp_mask</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">gss_krb5_des3_make_key</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">gss_krb5_enctype</span> <span class="o">*</span><span class="n">gk5e</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">randombits</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">gss_krb5_aes_make_key</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">gss_krb5_enctype</span> <span class="o">*</span><span class="n">gk5e</span><span class="p">,</span>
		      <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">randombits</span><span class="p">,</span>
		      <span class="k">struct</span> <span class="n">xdr_netobj</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">gss_krb5_aes_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
		     <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ec</span><span class="p">,</span>
		     <span class="k">struct</span> <span class="n">page</span> <span class="o">**</span><span class="n">pages</span><span class="p">);</span>

<span class="n">u32</span>
<span class="n">gss_krb5_aes_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span> <span class="n">u32</span> <span class="n">offset</span><span class="p">,</span>
		     <span class="k">struct</span> <span class="n">xdr_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="n">plainoffset</span><span class="p">,</span>
		     <span class="n">u32</span> <span class="o">*</span><span class="n">plainlen</span><span class="p">);</span>

<span class="kt">int</span>
<span class="n">krb5_rc4_setup_seq_key</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">cipher</span><span class="p">,</span>
		       <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">cksum</span><span class="p">);</span>

<span class="kt">int</span>
<span class="n">krb5_rc4_setup_enc_key</span><span class="p">(</span><span class="k">struct</span> <span class="n">krb5_ctx</span> <span class="o">*</span><span class="n">kctx</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">cipher</span><span class="p">,</span>
		       <span class="n">s32</span> <span class="n">seqnum</span><span class="p">);</span>
<span class="kt">void</span>
<span class="n">gss_krb5_make_confounder</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">u32</span> <span class="n">conflen</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
