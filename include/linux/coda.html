<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › coda.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>coda.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* </span>
<span class="cm">   You may distribute this file under either of the two licenses that</span>
<span class="cm">   follow at your discretion.</span>
<span class="cm">*/</span>

<span class="cm">/* BLURB lgpl</span>

<span class="cm">                           Coda File System</span>
<span class="cm">                              Release 5</span>

<span class="cm">          Copyright (c) 1987-1999 Carnegie Mellon University</span>
<span class="cm">                  Additional copyrights listed below</span>

<span class="cm">This code is distributed &quot;AS IS&quot; without warranty of any kind under</span>
<span class="cm">the terms of the GNU Library General Public Licence Version 2, as</span>
<span class="cm">shown in the file LICENSE, or under the license shown below. The</span>
<span class="cm">technical and financial contributors to Coda are listed in the file</span>
<span class="cm">CREDITS.</span>

<span class="cm">                        Additional copyrights </span>
<span class="cm">*/</span>

<span class="cm">/*</span>

<span class="cm">            Coda: an Experimental Distributed File System</span>
<span class="cm">                             Release 4.0</span>

<span class="cm">          Copyright (c) 1987-1999 Carnegie Mellon University</span>
<span class="cm">                         All Rights Reserved</span>

<span class="cm">Permission  to  use, copy, modify and distribute this software and its</span>
<span class="cm">documentation is hereby granted,  provided  that  both  the  copyright</span>
<span class="cm">notice  and  this  permission  notice  appear  in  all  copies  of the</span>
<span class="cm">software, derivative works or  modified  versions,  and  any  portions</span>
<span class="cm">thereof, and that both notices appear in supporting documentation, and</span>
<span class="cm">that credit is given to Carnegie Mellon University  in  all  documents</span>
<span class="cm">and publicity pertaining to direct or indirect use of this code or its</span>
<span class="cm">derivatives.</span>

<span class="cm">CODA IS AN EXPERIMENTAL SOFTWARE SYSTEM AND IS  KNOWN  TO  HAVE  BUGS,</span>
<span class="cm">SOME  OF  WHICH MAY HAVE SERIOUS CONSEQUENCES.  CARNEGIE MELLON ALLOWS</span>
<span class="cm">FREE USE OF THIS SOFTWARE IN ITS &quot;AS IS&quot; CONDITION.   CARNEGIE  MELLON</span>
<span class="cm">DISCLAIMS  ANY  LIABILITY  OF  ANY  KIND  FOR  ANY  DAMAGES WHATSOEVER</span>
<span class="cm">RESULTING DIRECTLY OR INDIRECTLY FROM THE USE OF THIS SOFTWARE  OR  OF</span>
<span class="cm">ANY DERIVATIVE WORK.</span>

<span class="cm">Carnegie  Mellon  encourages  users  of  this  software  to return any</span>
<span class="cm">improvements or extensions that  they  make,  and  to  grant  Carnegie</span>
<span class="cm">Mellon the rights to redistribute these changes without encumbrance.</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> * Based on cfs.h from Mach, but revamped for increased simplicity.</span>
<span class="cm"> * Linux modifications by </span>
<span class="cm"> * Peter Braam, Aug 1996</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _CODA_HEADER_</span>
<span class="cp">#define _CODA_HEADER_</span>


<span class="cm">/* Catch new _KERNEL defn for NetBSD and DJGPP/__CYGWIN32__ */</span>
<span class="cp">#if defined(__NetBSD__) || \</span>
<span class="cp">  ((defined(DJGPP) || defined(__CYGWIN32__)) &amp;&amp; !defined(KERNEL))</span>
<span class="cp">#include &lt;sys/types.h&gt;</span>
<span class="cp">#endif </span>

<span class="cp">#ifndef CODA_MAXSYMLINKS</span>
<span class="cp">#define CODA_MAXSYMLINKS 10</span>
<span class="cp">#endif</span>

<span class="cp">#if defined(DJGPP) || defined(__CYGWIN32__)</span>
<span class="cp">#ifdef KERNEL</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">u_long</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">u_int</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">u_short</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">u_long</span> <span class="n">ino_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">u_long</span> <span class="n">dev_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">void</span> <span class="o">*</span> <span class="n">caddr_t</span><span class="p">;</span>
<span class="cp">#ifdef DOS</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">u_quad_t</span><span class="p">;</span>
<span class="cp">#else </span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">u_quad_t</span><span class="p">;</span>
<span class="cp">#endif</span>

<span class="cp">#define inline</span>

<span class="k">struct</span> <span class="n">timespec</span> <span class="p">{</span>
        <span class="kt">long</span>       <span class="n">ts_sec</span><span class="p">;</span>
        <span class="kt">long</span>       <span class="n">ts_nsec</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#else  </span><span class="cm">/* DJGPP but not KERNEL */</span><span class="cp"></span>
<span class="cp">#include &lt;sys/time.h&gt;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">u_quad_t</span><span class="p">;</span>
<span class="cp">#endif </span><span class="cm">/* !KERNEL */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* !DJGPP */</span><span class="cp"></span>


<span class="cp">#if defined(__linux__)</span>
<span class="cp">#include &lt;linux/time.h&gt;</span>
<span class="cp">#define cdev_t u_quad_t</span>
<span class="cp">#ifndef __KERNEL__</span>
<span class="cp">#if !defined(_UQUAD_T_) &amp;&amp; (!defined(__GLIBC__) || __GLIBC__ &lt; 2)</span>
<span class="cp">#define _UQUAD_T_ 1</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">u_quad_t</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="cp">#else </span><span class="cm">/*__KERNEL__ */</span><span class="cp"></span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">u_quad_t</span><span class="p">;</span>
<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>
<span class="cp">#else</span>
<span class="cp">#define cdev_t dev_t</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef __CYGWIN32__</span>
<span class="k">struct</span> <span class="n">timespec</span> <span class="p">{</span>
        <span class="kt">time_t</span>  <span class="n">tv_sec</span><span class="p">;</span>         <span class="cm">/* seconds */</span>
        <span class="kt">long</span>    <span class="n">tv_nsec</span><span class="p">;</span>        <span class="cm">/* nanoseconds */</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef __BIT_TYPES_DEFINED__</span>
<span class="cp">#define __BIT_TYPES_DEFINED__</span>
<span class="k">typedef</span> <span class="kt">signed</span> <span class="kt">char</span>	      <span class="kt">int8_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">char</span>	    <span class="n">u_int8_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">short</span>		     <span class="kt">int16_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">short</span>	   <span class="n">u_int16_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">int</span>		     <span class="kt">int32_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">int</span>	   <span class="n">u_int32_t</span><span class="p">;</span>
<span class="cp">#endif</span>


<span class="cm">/*</span>
<span class="cm"> * Cfs constants</span>
<span class="cm"> */</span>
<span class="cp">#define CODA_MAXNAMLEN   255</span>
<span class="cp">#define CODA_MAXPATHLEN  1024</span>
<span class="cp">#define CODA_MAXSYMLINK  10</span>

<span class="cm">/* these are Coda&#39;s version of O_RDONLY etc combinations</span>
<span class="cm"> * to deal with VFS open modes</span>
<span class="cm"> */</span>
<span class="cp">#define	C_O_READ	0x001</span>
<span class="cp">#define	C_O_WRITE       0x002</span>
<span class="cp">#define C_O_TRUNC       0x010</span>
<span class="cp">#define C_O_EXCL	0x100</span>
<span class="cp">#define C_O_CREAT	0x200</span>

<span class="cm">/* these are to find mode bits in Venus */</span> 
<span class="cp">#define C_M_READ  00400</span>
<span class="cp">#define C_M_WRITE 00200</span>

<span class="cm">/* for access Venus will use */</span>
<span class="cp">#define C_A_C_OK    8               </span><span class="cm">/* Test for writing upon create.  */</span><span class="cp"></span>
<span class="cp">#define C_A_R_OK    4               </span><span class="cm">/* Test for read permission.  */</span><span class="cp"></span>
<span class="cp">#define C_A_W_OK    2               </span><span class="cm">/* Test for write permission.  */</span><span class="cp"></span>
<span class="cp">#define C_A_X_OK    1               </span><span class="cm">/* Test for execute permission.  */</span><span class="cp"></span>
<span class="cp">#define C_A_F_OK    0               </span><span class="cm">/* Test for existence.  */</span><span class="cp"></span>



<span class="cp">#ifndef _VENUS_DIRENT_T_</span>
<span class="cp">#define _VENUS_DIRENT_T_ 1</span>
<span class="k">struct</span> <span class="n">venus_dirent</span> <span class="p">{</span>
        <span class="n">u_int32_t</span> <span class="n">d_fileno</span><span class="p">;</span>		<span class="cm">/* file number of entry */</span>
        <span class="n">u_int16_t</span> <span class="n">d_reclen</span><span class="p">;</span>		<span class="cm">/* length of this record */</span>
        <span class="n">u_int8_t</span>  <span class="n">d_type</span><span class="p">;</span>			<span class="cm">/* file type, see below */</span>
        <span class="n">u_int8_t</span>  <span class="n">d_namlen</span><span class="p">;</span>		<span class="cm">/* length of string in d_name */</span>
        <span class="kt">char</span>	  <span class="n">d_name</span><span class="p">[</span><span class="n">CODA_MAXNAMLEN</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span><span class="cm">/* name must be no longer than this */</span>
<span class="p">};</span>
<span class="cp">#undef DIRSIZ</span>
<span class="cp">#define DIRSIZ(dp)      ((sizeof (struct venus_dirent) - (CODA_MAXNAMLEN+1)) + \</span>
<span class="cp">                         (((dp)-&gt;d_namlen+1 + 3) &amp;~ 3))</span>

<span class="cm">/*</span>
<span class="cm"> * File types</span>
<span class="cm"> */</span>
<span class="cp">#define	CDT_UNKNOWN	 0</span>
<span class="cp">#define	CDT_FIFO	 1</span>
<span class="cp">#define	CDT_CHR		 2</span>
<span class="cp">#define	CDT_DIR		 4</span>
<span class="cp">#define	CDT_BLK		 6</span>
<span class="cp">#define	CDT_REG		 8</span>
<span class="cp">#define	CDT_LNK		10</span>
<span class="cp">#define	CDT_SOCK	12</span>
<span class="cp">#define	CDT_WHT		14</span>

<span class="cm">/*</span>
<span class="cm"> * Convert between stat structure types and directory types.</span>
<span class="cm"> */</span>
<span class="cp">#define	IFTOCDT(mode)	(((mode) &amp; 0170000) &gt;&gt; 12)</span>
<span class="cp">#define	CDTTOIF(dirtype)	((dirtype) &lt;&lt; 12)</span>

<span class="cp">#endif</span>

<span class="cp">#ifndef _VUID_T_</span>
<span class="cp">#define _VUID_T_</span>
<span class="k">typedef</span> <span class="n">u_int32_t</span> <span class="n">vuid_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">u_int32_t</span> <span class="n">vgid_t</span><span class="p">;</span>
<span class="cp">#endif </span><span class="cm">/*_VUID_T_ */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">CodaFid</span> <span class="p">{</span>
	<span class="n">u_int32_t</span> <span class="n">opaque</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define coda_f2i(fid)\</span>
<span class="cp">	(fid ? (fid-&gt;opaque[3] ^ (fid-&gt;opaque[2]&lt;&lt;10) ^ (fid-&gt;opaque[1]&lt;&lt;20) ^ fid-&gt;opaque[0]) : 0)</span>

<span class="cp">#ifndef _VENUS_VATTR_T_</span>
<span class="cp">#define _VENUS_VATTR_T_</span>
<span class="cm">/*</span>
<span class="cm"> * Vnode types.  VNON means no type.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">coda_vtype</span>	<span class="p">{</span> <span class="n">C_VNON</span><span class="p">,</span> <span class="n">C_VREG</span><span class="p">,</span> <span class="n">C_VDIR</span><span class="p">,</span> <span class="n">C_VBLK</span><span class="p">,</span> <span class="n">C_VCHR</span><span class="p">,</span> <span class="n">C_VLNK</span><span class="p">,</span> <span class="n">C_VSOCK</span><span class="p">,</span> <span class="n">C_VFIFO</span><span class="p">,</span> <span class="n">C_VBAD</span> <span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_vattr</span> <span class="p">{</span>
	<span class="kt">long</span>     	<span class="n">va_type</span><span class="p">;</span>	<span class="cm">/* vnode type (for create) */</span>
	<span class="n">u_short</span>		<span class="n">va_mode</span><span class="p">;</span>	<span class="cm">/* files access mode and type */</span>
	<span class="kt">short</span>		<span class="n">va_nlink</span><span class="p">;</span>	<span class="cm">/* number of references to file */</span>
	<span class="n">vuid_t</span>		<span class="n">va_uid</span><span class="p">;</span>		<span class="cm">/* owner user id */</span>
	<span class="n">vgid_t</span>		<span class="n">va_gid</span><span class="p">;</span>		<span class="cm">/* owner group id */</span>
	<span class="kt">long</span>		<span class="n">va_fileid</span><span class="p">;</span>	<span class="cm">/* file id */</span>
	<span class="n">u_quad_t</span>	<span class="n">va_size</span><span class="p">;</span>	<span class="cm">/* file size in bytes */</span>
	<span class="kt">long</span>		<span class="n">va_blocksize</span><span class="p">;</span>	<span class="cm">/* blocksize preferred for i/o */</span>
	<span class="k">struct</span> <span class="n">timespec</span>	<span class="n">va_atime</span><span class="p">;</span>	<span class="cm">/* time of last access */</span>
	<span class="k">struct</span> <span class="n">timespec</span>	<span class="n">va_mtime</span><span class="p">;</span>	<span class="cm">/* time of last modification */</span>
	<span class="k">struct</span> <span class="n">timespec</span>	<span class="n">va_ctime</span><span class="p">;</span>	<span class="cm">/* time file changed */</span>
	<span class="n">u_long</span>		<span class="n">va_gen</span><span class="p">;</span>		<span class="cm">/* generation number of file */</span>
	<span class="n">u_long</span>		<span class="n">va_flags</span><span class="p">;</span>	<span class="cm">/* flags defined for file */</span>
	<span class="n">cdev_t</span>	        <span class="n">va_rdev</span><span class="p">;</span>	<span class="cm">/* device special file represents */</span>
	<span class="n">u_quad_t</span>	<span class="n">va_bytes</span><span class="p">;</span>	<span class="cm">/* bytes of disk space held by file */</span>
	<span class="n">u_quad_t</span>	<span class="n">va_filerev</span><span class="p">;</span>	<span class="cm">/* file modification number */</span>
<span class="p">};</span>

<span class="cp">#endif </span>

<span class="cm">/* structure used by CODA_STATFS for getting cache information from venus */</span>
<span class="k">struct</span> <span class="n">coda_statfs</span> <span class="p">{</span>
    <span class="kt">int32_t</span> <span class="n">f_blocks</span><span class="p">;</span>
    <span class="kt">int32_t</span> <span class="n">f_bfree</span><span class="p">;</span>
    <span class="kt">int32_t</span> <span class="n">f_bavail</span><span class="p">;</span>
    <span class="kt">int32_t</span> <span class="n">f_files</span><span class="p">;</span>
    <span class="kt">int32_t</span> <span class="n">f_ffree</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Kernel &lt;--&gt; Venus communications.</span>
<span class="cm"> */</span>

<span class="cp">#define CODA_ROOT	2</span>
<span class="cp">#define CODA_OPEN_BY_FD	3</span>
<span class="cp">#define CODA_OPEN	4</span>
<span class="cp">#define CODA_CLOSE	5</span>
<span class="cp">#define CODA_IOCTL	6</span>
<span class="cp">#define CODA_GETATTR	7</span>
<span class="cp">#define CODA_SETATTR	8</span>
<span class="cp">#define CODA_ACCESS	9</span>
<span class="cp">#define CODA_LOOKUP	10</span>
<span class="cp">#define CODA_CREATE	11</span>
<span class="cp">#define CODA_REMOVE	12</span>
<span class="cp">#define CODA_LINK	13</span>
<span class="cp">#define CODA_RENAME	14</span>
<span class="cp">#define CODA_MKDIR	15</span>
<span class="cp">#define CODA_RMDIR	16</span>
<span class="cp">#define CODA_SYMLINK	18</span>
<span class="cp">#define CODA_READLINK	19</span>
<span class="cp">#define CODA_FSYNC	20</span>
<span class="cp">#define CODA_VGET	22</span>
<span class="cp">#define CODA_SIGNAL	23</span>
<span class="cp">#define CODA_REPLACE	 24 </span><span class="cm">/* DOWNCALL */</span><span class="cp"></span>
<span class="cp">#define CODA_FLUSH       25 </span><span class="cm">/* DOWNCALL */</span><span class="cp"></span>
<span class="cp">#define CODA_PURGEUSER   26 </span><span class="cm">/* DOWNCALL */</span><span class="cp"></span>
<span class="cp">#define CODA_ZAPFILE     27 </span><span class="cm">/* DOWNCALL */</span><span class="cp"></span>
<span class="cp">#define CODA_ZAPDIR      28 </span><span class="cm">/* DOWNCALL */</span><span class="cp"></span>
<span class="cp">#define CODA_PURGEFID    30 </span><span class="cm">/* DOWNCALL */</span><span class="cp"></span>
<span class="cp">#define CODA_OPEN_BY_PATH 31</span>
<span class="cp">#define CODA_RESOLVE     32</span>
<span class="cp">#define CODA_REINTEGRATE 33</span>
<span class="cp">#define CODA_STATFS	 34</span>
<span class="cp">#define CODA_STORE	 35</span>
<span class="cp">#define CODA_RELEASE	 36</span>
<span class="cp">#define CODA_NCALLS 37</span>

<span class="cp">#define DOWNCALL(opcode) (opcode &gt;= CODA_REPLACE &amp;&amp; opcode &lt;= CODA_PURGEFID)</span>

<span class="cp">#define VC_MAXDATASIZE	    8192</span>
<span class="cp">#define VC_MAXMSGSIZE      sizeof(union inputArgs)+sizeof(union outputArgs) +\</span>
<span class="cp">                            VC_MAXDATASIZE  </span>

<span class="cp">#define CIOC_KERNEL_VERSION _IOWR(&#39;c&#39;, 10, size_t)</span>

<span class="cp">#define CODA_KERNEL_VERSION 3 </span><span class="cm">/* 128-bit file identifiers */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> *        Venus &lt;-&gt; Coda  RPC arguments</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="p">{</span>
    <span class="n">u_int32_t</span> <span class="n">opcode</span><span class="p">;</span>
    <span class="n">u_int32_t</span> <span class="n">unique</span><span class="p">;</span>	    <span class="cm">/* Keep multiple outstanding msgs distinct */</span>
    <span class="n">pid_t</span> <span class="n">pid</span><span class="p">;</span>
    <span class="n">pid_t</span> <span class="n">pgid</span><span class="p">;</span>
    <span class="n">vuid_t</span> <span class="n">uid</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Really important that opcode and unique are 1st two fields! */</span>
<span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="p">{</span>
    <span class="n">u_int32_t</span> <span class="n">opcode</span><span class="p">;</span>
    <span class="n">u_int32_t</span> <span class="n">unique</span><span class="p">;</span>	
    <span class="n">u_int32_t</span> <span class="n">result</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_root: NO_IN */</span>
<span class="k">struct</span> <span class="n">coda_root_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_root_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">in</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_open: */</span>
<span class="k">struct</span> <span class="n">coda_open_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_open_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="n">cdev_t</span>	<span class="n">dev</span><span class="p">;</span>
    <span class="n">ino_t</span>	<span class="n">inode</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* coda_store: */</span>
<span class="k">struct</span> <span class="n">coda_store_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_store_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_release: */</span>
<span class="k">struct</span> <span class="n">coda_release_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_release_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_close: */</span>
<span class="k">struct</span> <span class="n">coda_close_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_close_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_ioctl: */</span>
<span class="k">struct</span> <span class="n">coda_ioctl_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">cmd</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">len</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">rwflag</span><span class="p">;</span>
    <span class="kt">char</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>			<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_ioctl_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">len</span><span class="p">;</span>
    <span class="n">caddr_t</span>	<span class="n">data</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>


<span class="cm">/* coda_getattr: */</span>
<span class="k">struct</span> <span class="n">coda_getattr_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_getattr_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vattr</span> <span class="n">attr</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* coda_setattr: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_setattr_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vattr</span> <span class="n">attr</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_setattr_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_access: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_access_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_access_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* lookup flags */</span>
<span class="cp">#define CLU_CASE_SENSITIVE     0x01</span>
<span class="cp">#define CLU_CASE_INSENSITIVE   0x02</span>

<span class="cm">/* coda_lookup: */</span>
<span class="k">struct</span>  <span class="n">coda_lookup_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>         <span class="n">name</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
    <span class="kt">int</span>         <span class="n">flags</span><span class="p">;</span>	
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_lookup_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">vtype</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* coda_create: */</span>
<span class="k">struct</span> <span class="n">coda_create_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vattr</span> <span class="n">attr</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">excl</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>
    <span class="kt">int</span> 	<span class="n">name</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_create_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vattr</span> <span class="n">attr</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* coda_remove: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_remove_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">name</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_remove_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_link: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_link_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">sourceFid</span><span class="p">;</span>	<span class="cm">/* cnode to link *to* */</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">destFid</span><span class="p">;</span>	<span class="cm">/* Directory in which to place link */</span>
    <span class="kt">int</span> <span class="n">tname</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_link_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* coda_rename: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_rename_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">sourceFid</span><span class="p">;</span>
    <span class="kt">int</span> 	<span class="n">srcname</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">destFid</span><span class="p">;</span>
    <span class="kt">int</span> 	<span class="n">destname</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_rename_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_mkdir: */</span>
<span class="k">struct</span> <span class="n">coda_mkdir_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vattr</span> <span class="n">attr</span><span class="p">;</span>
    <span class="kt">int</span>	   <span class="n">name</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_mkdir_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vattr</span> <span class="n">attr</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* coda_rmdir: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_rmdir_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">name</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_rmdir_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_symlink: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_symlink_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>	<span class="cm">/* Directory to put symlink in */</span>
    <span class="kt">int</span> <span class="n">srcname</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vattr</span> <span class="n">attr</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">tname</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_symlink_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_readlink: */</span>
<span class="k">struct</span> <span class="n">coda_readlink_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_readlink_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">count</span><span class="p">;</span>
    <span class="n">caddr_t</span>	<span class="n">data</span><span class="p">;</span>		<span class="cm">/* Place holder for data. */</span>
<span class="p">};</span>


<span class="cm">/* coda_fsync: NO_OUT */</span>
<span class="k">struct</span> <span class="n">coda_fsync_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_fsync_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_vget: */</span>
<span class="k">struct</span> <span class="n">coda_vget_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_vget_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">vtype</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/* CODA_SIGNAL is out-of-band, doesn&#39;t need data. */</span>
<span class="cm">/* CODA_INVALIDATE is a venus-&gt;kernel call */</span>
<span class="cm">/* CODA_FLUSH is a venus-&gt;kernel call */</span>

<span class="cm">/* coda_purgeuser: */</span>
<span class="cm">/* CODA_PURGEUSER is a venus-&gt;kernel call */</span>
<span class="k">struct</span> <span class="n">coda_purgeuser_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="n">vuid_t</span> <span class="n">uid</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_zapfile: */</span>
<span class="cm">/* CODA_ZAPFILE is a venus-&gt;kernel call */</span>
<span class="k">struct</span> <span class="n">coda_zapfile_out</span> <span class="p">{</span>  
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">CodaFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_zapdir: */</span>
<span class="cm">/* CODA_ZAPDIR is a venus-&gt;kernel call */</span>	
<span class="k">struct</span> <span class="n">coda_zapdir_out</span> <span class="p">{</span>	  
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">CodaFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_purgefid: */</span>
<span class="cm">/* CODA_PURGEFID is a venus-&gt;kernel call */</span>	
<span class="k">struct</span> <span class="n">coda_purgefid_out</span> <span class="p">{</span> 
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">CodaFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_replace: */</span>
<span class="cm">/* CODA_REPLACE is a venus-&gt;kernel call */</span>	
<span class="k">struct</span> <span class="n">coda_replace_out</span> <span class="p">{</span> <span class="cm">/* coda_replace is a venus-&gt;kernel call */</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">NewFid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">OldFid</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_open_by_fd: */</span>
<span class="k">struct</span> <span class="n">coda_open_by_fd_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>        <span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_open_by_fd_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>

<span class="cp">#ifdef __KERNEL__</span>
    <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">fh</span><span class="p">;</span> <span class="cm">/* not passed from userspace but used in-kernel only */</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="cm">/* coda_open_by_path: */</span>
<span class="k">struct</span> <span class="n">coda_open_by_path_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">CodaFid</span> <span class="n">VFid</span><span class="p">;</span>
    <span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_open_by_path_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">path</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* coda_statfs: NO_IN */</span>
<span class="k">struct</span> <span class="n">coda_statfs_in</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">in</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">coda_statfs_out</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_statfs</span> <span class="n">stat</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* </span>
<span class="cm"> * Occasionally, we don&#39;t cache the fid returned by CODA_LOOKUP. </span>
<span class="cm"> * For instance, if the fid is inconsistent. </span>
<span class="cm"> * This case is handled by setting the top bit of the type result parameter.</span>
<span class="cm"> */</span>
<span class="cp">#define CODA_NOCACHE          0x80000000</span>

<span class="k">union</span> <span class="n">inputArgs</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_in_hdr</span> <span class="n">ih</span><span class="p">;</span>		<span class="cm">/* NB: every struct below begins with an ih */</span>
    <span class="k">struct</span> <span class="n">coda_open_in</span> <span class="n">coda_open</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_store_in</span> <span class="n">coda_store</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_release_in</span> <span class="n">coda_release</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_close_in</span> <span class="n">coda_close</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_ioctl_in</span> <span class="n">coda_ioctl</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_getattr_in</span> <span class="n">coda_getattr</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_setattr_in</span> <span class="n">coda_setattr</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_access_in</span> <span class="n">coda_access</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_lookup_in</span> <span class="n">coda_lookup</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_create_in</span> <span class="n">coda_create</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_remove_in</span> <span class="n">coda_remove</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_link_in</span> <span class="n">coda_link</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_rename_in</span> <span class="n">coda_rename</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_mkdir_in</span> <span class="n">coda_mkdir</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_rmdir_in</span> <span class="n">coda_rmdir</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_symlink_in</span> <span class="n">coda_symlink</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_readlink_in</span> <span class="n">coda_readlink</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_fsync_in</span> <span class="n">coda_fsync</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vget_in</span> <span class="n">coda_vget</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_open_by_fd_in</span> <span class="n">coda_open_by_fd</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_open_by_path_in</span> <span class="n">coda_open_by_path</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_statfs_in</span> <span class="n">coda_statfs</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">union</span> <span class="n">outputArgs</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">coda_out_hdr</span> <span class="n">oh</span><span class="p">;</span>		<span class="cm">/* NB: every struct below begins with an oh */</span>
    <span class="k">struct</span> <span class="n">coda_root_out</span> <span class="n">coda_root</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_open_out</span> <span class="n">coda_open</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_ioctl_out</span> <span class="n">coda_ioctl</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_getattr_out</span> <span class="n">coda_getattr</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_lookup_out</span> <span class="n">coda_lookup</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_create_out</span> <span class="n">coda_create</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_mkdir_out</span> <span class="n">coda_mkdir</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_readlink_out</span> <span class="n">coda_readlink</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_vget_out</span> <span class="n">coda_vget</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_purgeuser_out</span> <span class="n">coda_purgeuser</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_zapfile_out</span> <span class="n">coda_zapfile</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_zapdir_out</span> <span class="n">coda_zapdir</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_purgefid_out</span> <span class="n">coda_purgefid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_replace_out</span> <span class="n">coda_replace</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_open_by_fd_out</span> <span class="n">coda_open_by_fd</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_open_by_path_out</span> <span class="n">coda_open_by_path</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_statfs_out</span> <span class="n">coda_statfs</span><span class="p">;</span>
<span class="p">};</span>    

<span class="k">union</span> <span class="n">coda_downcalls</span> <span class="p">{</span>
    <span class="cm">/* CODA_INVALIDATE is a venus-&gt;kernel call */</span>
    <span class="cm">/* CODA_FLUSH is a venus-&gt;kernel call */</span>
    <span class="k">struct</span> <span class="n">coda_purgeuser_out</span> <span class="n">purgeuser</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_zapfile_out</span> <span class="n">zapfile</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_zapdir_out</span> <span class="n">zapdir</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_purgefid_out</span> <span class="n">purgefid</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">coda_replace_out</span> <span class="n">replace</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * Used for identifying usage of &quot;Control&quot; and pioctls</span>
<span class="cm"> */</span>

<span class="cp">#define PIOCPARM_MASK 0x0000ffff</span>
<span class="k">struct</span> <span class="n">ViceIoctl</span> <span class="p">{</span>
        <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">in</span><span class="p">;</span>        <span class="cm">/* Data to be transferred in */</span>
        <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">out</span><span class="p">;</span>       <span class="cm">/* Data to be transferred out */</span>
        <span class="n">u_short</span> <span class="n">in_size</span><span class="p">;</span>        <span class="cm">/* Size of input buffer &lt;= 2K */</span>
        <span class="n">u_short</span> <span class="n">out_size</span><span class="p">;</span>       <span class="cm">/* Maximum size of output buffer, &lt;= 2K */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">PioctlData</span> <span class="p">{</span>
        <span class="k">const</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">path</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">follow</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">ViceIoctl</span> <span class="n">vi</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define CODA_CONTROL		&quot;.CONTROL&quot;</span>
<span class="cp">#define CODA_CONTROLLEN		8</span>
<span class="cp">#define CTL_INO			-1</span>

<span class="cm">/* Data passed to mount */</span>

<span class="cp">#define CODA_MOUNT_VERSION 1</span>

<span class="k">struct</span> <span class="n">coda_mount_data</span> <span class="p">{</span>
	<span class="kt">int</span>		<span class="n">version</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">fd</span><span class="p">;</span>       <span class="cm">/* Opened device */</span>
<span class="p">};</span>

<span class="cp">#endif </span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
