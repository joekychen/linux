<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › nfs_iostat.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>nfs_iostat.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  User-space visible declarations for NFS client per-mount</span>
<span class="cm"> *  point statistics</span>
<span class="cm"> *</span>
<span class="cm"> *  Copyright (C) 2005, 2006 Chuck Lever &lt;cel@netapp.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *  NFS client per-mount statistics provide information about the</span>
<span class="cm"> *  health of the NFS client and the health of each NFS mount point.</span>
<span class="cm"> *  Generally these are not for detailed problem diagnosis, but</span>
<span class="cm"> *  simply to indicate that there is a problem.</span>
<span class="cm"> *</span>
<span class="cm"> *  These counters are not meant to be human-readable, but are meant</span>
<span class="cm"> *  to be integrated into system monitoring tools such as &quot;sar&quot; and</span>
<span class="cm"> *  &quot;iostat&quot;.  As such, the counters are sampled by the tools over</span>
<span class="cm"> *  time, and are never zeroed after a file system is mounted.</span>
<span class="cm"> *  Moving averages can be computed by the tools by taking the</span>
<span class="cm"> *  difference between two instantaneous samples  and dividing that</span>
<span class="cm"> *  by the time between the samples.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_NFS_IOSTAT</span>
<span class="cp">#define _LINUX_NFS_IOSTAT</span>

<span class="cp">#define NFS_IOSTAT_VERS		&quot;1.1&quot;</span>

<span class="cm">/*</span>
<span class="cm"> * NFS byte counters</span>
<span class="cm"> *</span>
<span class="cm"> * 1.  SERVER - the number of payload bytes read from or written</span>
<span class="cm"> *     to the server by the NFS client via an NFS READ or WRITE</span>
<span class="cm"> *     request.</span>
<span class="cm"> *</span>
<span class="cm"> * 2.  NORMAL - the number of bytes read or written by applications</span>
<span class="cm"> *     via the read(2) and write(2) system call interfaces.</span>
<span class="cm"> *</span>
<span class="cm"> * 3.  DIRECT - the number of bytes read or written from files</span>
<span class="cm"> *     opened with the O_DIRECT flag.</span>
<span class="cm"> *</span>
<span class="cm"> * These counters give a view of the data throughput into and out</span>
<span class="cm"> * of the NFS client.  Comparing the number of bytes requested by</span>
<span class="cm"> * an application with the number of bytes the client requests from</span>
<span class="cm"> * the server can provide an indication of client efficiency</span>
<span class="cm"> * (per-op, cache hits, etc).</span>
<span class="cm"> *</span>
<span class="cm"> * These counters can also help characterize which access methods</span>
<span class="cm"> * are in use.  DIRECT by itself shows whether there is any O_DIRECT</span>
<span class="cm"> * traffic.  NORMAL + DIRECT shows how much data is going through</span>
<span class="cm"> * the system call interface.  A large amount of SERVER traffic</span>
<span class="cm"> * without much NORMAL or DIRECT traffic shows that applications</span>
<span class="cm"> * are using mapped files.</span>
<span class="cm"> *</span>
<span class="cm"> * NFS page counters</span>
<span class="cm"> *</span>
<span class="cm"> * These count the number of pages read or written via nfs_readpage(),</span>
<span class="cm"> * nfs_readpages(), or their write equivalents.</span>
<span class="cm"> *</span>
<span class="cm"> * NB: When adding new byte counters, please include the measured</span>
<span class="cm"> * units in the name of each byte counter to help users of this</span>
<span class="cm"> * interface determine what exactly is being counted.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">nfs_stat_bytecounters</span> <span class="p">{</span>
	<span class="n">NFSIOS_NORMALREADBYTES</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFSIOS_NORMALWRITTENBYTES</span><span class="p">,</span>
	<span class="n">NFSIOS_DIRECTREADBYTES</span><span class="p">,</span>
	<span class="n">NFSIOS_DIRECTWRITTENBYTES</span><span class="p">,</span>
	<span class="n">NFSIOS_SERVERREADBYTES</span><span class="p">,</span>
	<span class="n">NFSIOS_SERVERWRITTENBYTES</span><span class="p">,</span>
	<span class="n">NFSIOS_READPAGES</span><span class="p">,</span>
	<span class="n">NFSIOS_WRITEPAGES</span><span class="p">,</span>
	<span class="n">__NFSIOS_BYTESMAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * NFS event counters</span>
<span class="cm"> *</span>
<span class="cm"> * These counters provide a low-overhead way of monitoring client</span>
<span class="cm"> * activity without enabling NFS trace debugging.  The counters</span>
<span class="cm"> * show the rate at which VFS requests are made, and how often the</span>
<span class="cm"> * client invalidates its data and attribute caches.  This allows</span>
<span class="cm"> * system administrators to monitor such things as how close-to-open</span>
<span class="cm"> * is working, and answer questions such as &quot;why are there so many</span>
<span class="cm"> * GETATTR requests on the wire?&quot;</span>
<span class="cm"> *</span>
<span class="cm"> * They also count anamolous events such as short reads and writes,</span>
<span class="cm"> * silly renames due to close-after-delete, and operations that</span>
<span class="cm"> * change the size of a file (such operations can often be the</span>
<span class="cm"> * source of data corruption if applications aren&#39;t using file</span>
<span class="cm"> * locking properly).</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">nfs_stat_eventcounters</span> <span class="p">{</span>
	<span class="n">NFSIOS_INODEREVALIDATE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">NFSIOS_DENTRYREVALIDATE</span><span class="p">,</span>
	<span class="n">NFSIOS_DATAINVALIDATE</span><span class="p">,</span>
	<span class="n">NFSIOS_ATTRINVALIDATE</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSOPEN</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSLOOKUP</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSACCESS</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSUPDATEPAGE</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSREADPAGE</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSREADPAGES</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSWRITEPAGE</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSWRITEPAGES</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSGETDENTS</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSSETATTR</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSFLUSH</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSFSYNC</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSLOCK</span><span class="p">,</span>
	<span class="n">NFSIOS_VFSRELEASE</span><span class="p">,</span>
	<span class="n">NFSIOS_CONGESTIONWAIT</span><span class="p">,</span>
	<span class="n">NFSIOS_SETATTRTRUNC</span><span class="p">,</span>
	<span class="n">NFSIOS_EXTENDWRITE</span><span class="p">,</span>
	<span class="n">NFSIOS_SILLYRENAME</span><span class="p">,</span>
	<span class="n">NFSIOS_SHORTREAD</span><span class="p">,</span>
	<span class="n">NFSIOS_SHORTWRITE</span><span class="p">,</span>
	<span class="n">NFSIOS_DELAY</span><span class="p">,</span>
	<span class="n">NFSIOS_PNFS_READ</span><span class="p">,</span>
	<span class="n">NFSIOS_PNFS_WRITE</span><span class="p">,</span>
	<span class="n">__NFSIOS_COUNTSMAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * NFS local caching servicing counters</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">nfs_stat_fscachecounters</span> <span class="p">{</span>
	<span class="n">NFSIOS_FSCACHE_PAGES_READ_OK</span><span class="p">,</span>
	<span class="n">NFSIOS_FSCACHE_PAGES_READ_FAIL</span><span class="p">,</span>
	<span class="n">NFSIOS_FSCACHE_PAGES_WRITTEN_OK</span><span class="p">,</span>
	<span class="n">NFSIOS_FSCACHE_PAGES_WRITTEN_FAIL</span><span class="p">,</span>
	<span class="n">NFSIOS_FSCACHE_PAGES_UNCACHED</span><span class="p">,</span>
	<span class="n">__NFSIOS_FSCACHEMAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#endif	</span><span class="cm">/* _LINUX_NFS_IOSTAT */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
