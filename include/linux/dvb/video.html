<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › dvb › video.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>video.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * video.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2000 Marcus Metzler &lt;marcus@convergence.de&gt;</span>
<span class="cm"> *                  &amp; Ralph  Metzler &lt;ralph@convergence.de&gt;</span>
<span class="cm"> *                    for convergence integrated media GmbH</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU Lesser General Public License</span>
<span class="cm"> * as published by the Free Software Foundation; either version 2.1</span>
<span class="cm"> * of the License, or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU Lesser General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _DVBVIDEO_H_</span>
<span class="cp">#define _DVBVIDEO_H_</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#include &lt;linux/compiler.h&gt;</span>
<span class="cp">#else</span>
<span class="cp">#include &lt;stdint.h&gt;</span>
<span class="cp">#include &lt;time.h&gt;</span>
<span class="cp">#endif</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">VIDEO_FORMAT_4_3</span><span class="p">,</span>     <span class="cm">/* Select 4:3 format */</span>
	<span class="n">VIDEO_FORMAT_16_9</span><span class="p">,</span>    <span class="cm">/* Select 16:9 format. */</span>
	<span class="n">VIDEO_FORMAT_221_1</span>    <span class="cm">/* 2.21:1 */</span>
<span class="p">}</span> <span class="n">video_format_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	 <span class="n">VIDEO_SYSTEM_PAL</span><span class="p">,</span>
	 <span class="n">VIDEO_SYSTEM_NTSC</span><span class="p">,</span>
	 <span class="n">VIDEO_SYSTEM_PALN</span><span class="p">,</span>
	 <span class="n">VIDEO_SYSTEM_PALNc</span><span class="p">,</span>
	 <span class="n">VIDEO_SYSTEM_PALM</span><span class="p">,</span>
	 <span class="n">VIDEO_SYSTEM_NTSC60</span><span class="p">,</span>
	 <span class="n">VIDEO_SYSTEM_PAL60</span><span class="p">,</span>
	 <span class="n">VIDEO_SYSTEM_PALM60</span>
<span class="p">}</span> <span class="n">video_system_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">VIDEO_PAN_SCAN</span><span class="p">,</span>       <span class="cm">/* use pan and scan format */</span>
	<span class="n">VIDEO_LETTER_BOX</span><span class="p">,</span>     <span class="cm">/* use letterbox format */</span>
	<span class="n">VIDEO_CENTER_CUT_OUT</span>  <span class="cm">/* use center cut out format */</span>
<span class="p">}</span> <span class="n">video_displayformat_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">w</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">h</span><span class="p">;</span>
	<span class="n">video_format_t</span> <span class="n">aspect_ratio</span><span class="p">;</span>
<span class="p">}</span> <span class="n">video_size_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">VIDEO_SOURCE_DEMUX</span><span class="p">,</span> <span class="cm">/* Select the demux as the main source */</span>
	<span class="n">VIDEO_SOURCE_MEMORY</span> <span class="cm">/* If this source is selected, the stream</span>
<span class="cm">			       comes from the user through the write</span>
<span class="cm">			       system call */</span>
<span class="p">}</span> <span class="n">video_stream_source_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">VIDEO_STOPPED</span><span class="p">,</span> <span class="cm">/* Video is stopped */</span>
	<span class="n">VIDEO_PLAYING</span><span class="p">,</span> <span class="cm">/* Video is currently playing */</span>
	<span class="n">VIDEO_FREEZED</span>  <span class="cm">/* Video is freezed */</span>
<span class="p">}</span> <span class="n">video_play_state_t</span><span class="p">;</span>


<span class="cm">/* Decoder commands */</span>
<span class="cp">#define VIDEO_CMD_PLAY        (0)</span>
<span class="cp">#define VIDEO_CMD_STOP        (1)</span>
<span class="cp">#define VIDEO_CMD_FREEZE      (2)</span>
<span class="cp">#define VIDEO_CMD_CONTINUE    (3)</span>

<span class="cm">/* Flags for VIDEO_CMD_FREEZE */</span>
<span class="cp">#define VIDEO_CMD_FREEZE_TO_BLACK     	(1 &lt;&lt; 0)</span>

<span class="cm">/* Flags for VIDEO_CMD_STOP */</span>
<span class="cp">#define VIDEO_CMD_STOP_TO_BLACK      	(1 &lt;&lt; 0)</span>
<span class="cp">#define VIDEO_CMD_STOP_IMMEDIATELY     	(1 &lt;&lt; 1)</span>

<span class="cm">/* Play input formats: */</span>
<span class="cm">/* The decoder has no special format requirements */</span>
<span class="cp">#define VIDEO_PLAY_FMT_NONE         (0)</span>
<span class="cm">/* The decoder requires full GOPs */</span>
<span class="cp">#define VIDEO_PLAY_FMT_GOP          (1)</span>

<span class="cm">/* The structure must be zeroed before use by the application</span>
<span class="cm">   This ensures it can be extended safely in the future. */</span>
<span class="k">struct</span> <span class="n">video_command</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__u64</span> <span class="n">pts</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">stop</span><span class="p">;</span>

		<span class="k">struct</span> <span class="p">{</span>
			<span class="cm">/* 0 or 1000 specifies normal speed,</span>
<span class="cm">			   1 specifies forward single stepping,</span>
<span class="cm">			   -1 specifies backward single stepping,</span>
<span class="cm">			   &gt;1: playback at speed/1000 of the normal speed,</span>
<span class="cm">			   &lt;-1: reverse playback at (-speed/1000) of the normal speed. */</span>
			<span class="n">__s32</span> <span class="n">speed</span><span class="p">;</span>
			<span class="n">__u32</span> <span class="n">format</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">play</span><span class="p">;</span>

		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__u32</span> <span class="n">data</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">raw</span><span class="p">;</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="cm">/* FIELD_UNKNOWN can be used if the hardware does not know whether</span>
<span class="cm">   the Vsync is for an odd, even or progressive (i.e. non-interlaced)</span>
<span class="cm">   field. */</span>
<span class="cp">#define VIDEO_VSYNC_FIELD_UNKNOWN  	(0)</span>
<span class="cp">#define VIDEO_VSYNC_FIELD_ODD 		(1)</span>
<span class="cp">#define VIDEO_VSYNC_FIELD_EVEN		(2)</span>
<span class="cp">#define VIDEO_VSYNC_FIELD_PROGRESSIVE	(3)</span>

<span class="k">struct</span> <span class="n">video_event</span> <span class="p">{</span>
	<span class="n">__s32</span> <span class="n">type</span><span class="p">;</span>
<span class="cp">#define VIDEO_EVENT_SIZE_CHANGED	1</span>
<span class="cp">#define VIDEO_EVENT_FRAME_RATE_CHANGED	2</span>
<span class="cp">#define VIDEO_EVENT_DECODER_STOPPED 	3</span>
<span class="cp">#define VIDEO_EVENT_VSYNC 		4</span>
	<span class="n">__kernel_time_t</span> <span class="n">timestamp</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">video_size_t</span> <span class="n">size</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">frame_rate</span><span class="p">;</span>	<span class="cm">/* in frames per 1000sec */</span>
		<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">vsync_field</span><span class="p">;</span>	<span class="cm">/* unknown/odd/even/progressive */</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">video_status</span> <span class="p">{</span>
	<span class="kt">int</span>                   <span class="n">video_blank</span><span class="p">;</span>   <span class="cm">/* blank video on freeze? */</span>
	<span class="n">video_play_state_t</span>    <span class="n">play_state</span><span class="p">;</span>    <span class="cm">/* current state of playback */</span>
	<span class="n">video_stream_source_t</span> <span class="n">stream_source</span><span class="p">;</span> <span class="cm">/* current source (demux/memory) */</span>
	<span class="n">video_format_t</span>        <span class="n">video_format</span><span class="p">;</span>  <span class="cm">/* current aspect ratio of stream*/</span>
	<span class="n">video_displayformat_t</span> <span class="n">display_format</span><span class="p">;</span><span class="cm">/* selected cropping mode */</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">video_still_picture</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">iFrame</span><span class="p">;</span>        <span class="cm">/* pointer to a single iframe in memory */</span>
	<span class="n">__s32</span> <span class="n">size</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">typedef</span>
<span class="k">struct</span> <span class="n">video_highlight</span> <span class="p">{</span>
	<span class="kt">int</span>     <span class="n">active</span><span class="p">;</span>      <span class="cm">/*    1=show highlight, 0=hide highlight */</span>
	<span class="n">__u8</span>    <span class="n">contrast1</span><span class="p">;</span>   <span class="cm">/*    7- 4  Pattern pixel contrast */</span>
			     <span class="cm">/*    3- 0  Background pixel contrast */</span>
	<span class="n">__u8</span>    <span class="n">contrast2</span><span class="p">;</span>   <span class="cm">/*    7- 4  Emphasis pixel-2 contrast */</span>
			     <span class="cm">/*    3- 0  Emphasis pixel-1 contrast */</span>
	<span class="n">__u8</span>    <span class="n">color1</span><span class="p">;</span>      <span class="cm">/*    7- 4  Pattern pixel color */</span>
			     <span class="cm">/*    3- 0  Background pixel color */</span>
	<span class="n">__u8</span>    <span class="n">color2</span><span class="p">;</span>      <span class="cm">/*    7- 4  Emphasis pixel-2 color */</span>
			     <span class="cm">/*    3- 0  Emphasis pixel-1 color */</span>
	<span class="n">__u32</span>    <span class="n">ypos</span><span class="p">;</span>       <span class="cm">/*   23-22  auto action mode */</span>
			     <span class="cm">/*   21-12  start y */</span>
			     <span class="cm">/*    9- 0  end y */</span>
	<span class="n">__u32</span>    <span class="n">xpos</span><span class="p">;</span>       <span class="cm">/*   23-22  button color number */</span>
			     <span class="cm">/*   21-12  start x */</span>
			     <span class="cm">/*    9- 0  end x */</span>
<span class="p">}</span> <span class="n">video_highlight_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">video_spu</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">active</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">stream_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">video_spu_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">video_spu_palette</span> <span class="p">{</span>      <span class="cm">/* SPU Palette information */</span>
	<span class="kt">int</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">__user</span> <span class="o">*</span><span class="n">palette</span><span class="p">;</span>
<span class="p">}</span> <span class="n">video_spu_palette_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">video_navi_pack</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">length</span><span class="p">;</span>          <span class="cm">/* 0 ... 1024 */</span>
	<span class="n">__u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="p">}</span> <span class="n">video_navi_pack_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="n">__u16</span> <span class="n">video_attributes_t</span><span class="p">;</span>
<span class="cm">/*   bits: descr. */</span>
<span class="cm">/*   15-14 Video compression mode (0=MPEG-1, 1=MPEG-2) */</span>
<span class="cm">/*   13-12 TV system (0=525/60, 1=625/50) */</span>
<span class="cm">/*   11-10 Aspect ratio (0=4:3, 3=16:9) */</span>
<span class="cm">/*    9- 8 permitted display mode on 4:3 monitor (0=both, 1=only pan-sca */</span>
<span class="cm">/*    7    line 21-1 data present in GOP (1=yes, 0=no) */</span>
<span class="cm">/*    6    line 21-2 data present in GOP (1=yes, 0=no) */</span>
<span class="cm">/*    5- 3 source resolution (0=720x480/576, 1=704x480/576, 2=352x480/57 */</span>
<span class="cm">/*    2    source letterboxed (1=yes, 0=no) */</span>
<span class="cm">/*    0    film/camera mode (0=camera, 1=film (625/50 only)) */</span>


<span class="cm">/* bit definitions for capabilities: */</span>
<span class="cm">/* can the hardware decode MPEG1 and/or MPEG2? */</span>
<span class="cp">#define VIDEO_CAP_MPEG1   1</span>
<span class="cp">#define VIDEO_CAP_MPEG2   2</span>
<span class="cm">/* can you send a system and/or program stream to video device?</span>
<span class="cm">   (you still have to open the video and the audio device but only</span>
<span class="cm">    send the stream to the video device) */</span>
<span class="cp">#define VIDEO_CAP_SYS     4</span>
<span class="cp">#define VIDEO_CAP_PROG    8</span>
<span class="cm">/* can the driver also handle SPU, NAVI and CSS encoded data?</span>
<span class="cm">   (CSS API is not present yet) */</span>
<span class="cp">#define VIDEO_CAP_SPU    16</span>
<span class="cp">#define VIDEO_CAP_NAVI   32</span>
<span class="cp">#define VIDEO_CAP_CSS    64</span>


<span class="cp">#define VIDEO_STOP                 _IO(&#39;o&#39;, 21)</span>
<span class="cp">#define VIDEO_PLAY                 _IO(&#39;o&#39;, 22)</span>
<span class="cp">#define VIDEO_FREEZE               _IO(&#39;o&#39;, 23)</span>
<span class="cp">#define VIDEO_CONTINUE             _IO(&#39;o&#39;, 24)</span>
<span class="cp">#define VIDEO_SELECT_SOURCE        _IO(&#39;o&#39;, 25)</span>
<span class="cp">#define VIDEO_SET_BLANK            _IO(&#39;o&#39;, 26)</span>
<span class="cp">#define VIDEO_GET_STATUS           _IOR(&#39;o&#39;, 27, struct video_status)</span>
<span class="cp">#define VIDEO_GET_EVENT            _IOR(&#39;o&#39;, 28, struct video_event)</span>
<span class="cp">#define VIDEO_SET_DISPLAY_FORMAT   _IO(&#39;o&#39;, 29)</span>
<span class="cp">#define VIDEO_STILLPICTURE         _IOW(&#39;o&#39;, 30, struct video_still_picture)</span>
<span class="cp">#define VIDEO_FAST_FORWARD         _IO(&#39;o&#39;, 31)</span>
<span class="cp">#define VIDEO_SLOWMOTION           _IO(&#39;o&#39;, 32)</span>
<span class="cp">#define VIDEO_GET_CAPABILITIES     _IOR(&#39;o&#39;, 33, unsigned int)</span>
<span class="cp">#define VIDEO_CLEAR_BUFFER         _IO(&#39;o&#39;,  34)</span>
<span class="cp">#define VIDEO_SET_ID               _IO(&#39;o&#39;, 35)</span>
<span class="cp">#define VIDEO_SET_STREAMTYPE       _IO(&#39;o&#39;, 36)</span>
<span class="cp">#define VIDEO_SET_FORMAT           _IO(&#39;o&#39;, 37)</span>
<span class="cp">#define VIDEO_SET_SYSTEM           _IO(&#39;o&#39;, 38)</span>
<span class="cp">#define VIDEO_SET_HIGHLIGHT        _IOW(&#39;o&#39;, 39, video_highlight_t)</span>
<span class="cp">#define VIDEO_SET_SPU              _IOW(&#39;o&#39;, 50, video_spu_t)</span>
<span class="cp">#define VIDEO_SET_SPU_PALETTE      _IOW(&#39;o&#39;, 51, video_spu_palette_t)</span>
<span class="cp">#define VIDEO_GET_NAVI             _IOR(&#39;o&#39;, 52, video_navi_pack_t)</span>
<span class="cp">#define VIDEO_SET_ATTRIBUTES       _IO(&#39;o&#39;, 53)</span>
<span class="cp">#define VIDEO_GET_SIZE             _IOR(&#39;o&#39;, 55, video_size_t)</span>
<span class="cp">#define VIDEO_GET_FRAME_RATE       _IOR(&#39;o&#39;, 56, unsigned int)</span>

<span class="cm">/**</span>
<span class="cm"> * VIDEO_GET_PTS</span>
<span class="cm"> *</span>
<span class="cm"> * Read the 33 bit presentation time stamp as defined</span>
<span class="cm"> * in ITU T-REC-H.222.0 / ISO/IEC 13818-1.</span>
<span class="cm"> *</span>
<span class="cm"> * The PTS should belong to the currently played</span>
<span class="cm"> * frame if possible, but may also be a value close to it</span>
<span class="cm"> * like the PTS of the last decoded frame or the last PTS</span>
<span class="cm"> * extracted by the PES parser.</span>
<span class="cm"> */</span>
<span class="cp">#define VIDEO_GET_PTS              _IOR(&#39;o&#39;, 57, __u64)</span>

<span class="cm">/* Read the number of displayed frames since the decoder was started */</span>
<span class="cp">#define VIDEO_GET_FRAME_COUNT  	   _IOR(&#39;o&#39;, 58, __u64)</span>

<span class="cp">#define VIDEO_COMMAND     	   _IOWR(&#39;o&#39;, 59, struct video_command)</span>
<span class="cp">#define VIDEO_TRY_COMMAND 	   _IOWR(&#39;o&#39;, 60, struct video_command)</span>

<span class="cp">#endif </span><span class="cm">/*_DVBVIDEO_H_*/</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
