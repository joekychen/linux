<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › crypto.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>crypto.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Scatterlist Cryptographic API.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2002 James Morris &lt;jmorris@intercode.com.au&gt;</span>
<span class="cm"> * Copyright (c) 2002 David S. Miller (davem@redhat.com)</span>
<span class="cm"> * Copyright (c) 2005 Herbert Xu &lt;herbert@gondor.apana.org.au&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Portions derived from Cryptoapi, by Alexander Kjeldaas &lt;astor@fast.no&gt;</span>
<span class="cm"> * and Nettle, by Niels Möller.</span>
<span class="cm"> * </span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License as published by the Free</span>
<span class="cm"> * Software Foundation; either version 2 of the License, or (at your option) </span>
<span class="cm"> * any later version.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _LINUX_CRYPTO_H</span>
<span class="cp">#define _LINUX_CRYPTO_H</span>

<span class="cp">#include &lt;linux/atomic.h&gt;</span>
<span class="cp">#include &lt;linux/kernel.h&gt;</span>
<span class="cp">#include &lt;linux/list.h&gt;</span>
<span class="cp">#include &lt;linux/bug.h&gt;</span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>
<span class="cp">#include &lt;linux/string.h&gt;</span>
<span class="cp">#include &lt;linux/uaccess.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Algorithm masks and types.</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_ALG_TYPE_MASK		0x0000000f</span>
<span class="cp">#define CRYPTO_ALG_TYPE_CIPHER		0x00000001</span>
<span class="cp">#define CRYPTO_ALG_TYPE_COMPRESS	0x00000002</span>
<span class="cp">#define CRYPTO_ALG_TYPE_AEAD		0x00000003</span>
<span class="cp">#define CRYPTO_ALG_TYPE_BLKCIPHER	0x00000004</span>
<span class="cp">#define CRYPTO_ALG_TYPE_ABLKCIPHER	0x00000005</span>
<span class="cp">#define CRYPTO_ALG_TYPE_GIVCIPHER	0x00000006</span>
<span class="cp">#define CRYPTO_ALG_TYPE_DIGEST		0x00000008</span>
<span class="cp">#define CRYPTO_ALG_TYPE_HASH		0x00000008</span>
<span class="cp">#define CRYPTO_ALG_TYPE_SHASH		0x00000009</span>
<span class="cp">#define CRYPTO_ALG_TYPE_AHASH		0x0000000a</span>
<span class="cp">#define CRYPTO_ALG_TYPE_RNG		0x0000000c</span>
<span class="cp">#define CRYPTO_ALG_TYPE_PCOMPRESS	0x0000000f</span>

<span class="cp">#define CRYPTO_ALG_TYPE_HASH_MASK	0x0000000e</span>
<span class="cp">#define CRYPTO_ALG_TYPE_AHASH_MASK	0x0000000c</span>
<span class="cp">#define CRYPTO_ALG_TYPE_BLKCIPHER_MASK	0x0000000c</span>

<span class="cp">#define CRYPTO_ALG_LARVAL		0x00000010</span>
<span class="cp">#define CRYPTO_ALG_DEAD			0x00000020</span>
<span class="cp">#define CRYPTO_ALG_DYING		0x00000040</span>
<span class="cp">#define CRYPTO_ALG_ASYNC		0x00000080</span>

<span class="cm">/*</span>
<span class="cm"> * Set this bit if and only if the algorithm requires another algorithm of</span>
<span class="cm"> * the same type to handle corner cases.</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_ALG_NEED_FALLBACK	0x00000100</span>

<span class="cm">/*</span>
<span class="cm"> * This bit is set for symmetric key ciphers that have already been wrapped</span>
<span class="cm"> * with a generic IV generator to prevent them from being wrapped again.</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_ALG_GENIV		0x00000200</span>

<span class="cm">/*</span>
<span class="cm"> * Set if the algorithm has passed automated run-time testing.  Note that</span>
<span class="cm"> * if there is no run-time testing for a given algorithm it is considered</span>
<span class="cm"> * to have passed.</span>
<span class="cm"> */</span>

<span class="cp">#define CRYPTO_ALG_TESTED		0x00000400</span>

<span class="cm">/*</span>
<span class="cm"> * Set if the algorithm is an instance that is build from templates.</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_ALG_INSTANCE		0x00000800</span>

<span class="cm">/* Set this bit if the algorithm provided is hardware accelerated but</span>
<span class="cm"> * not available to userspace via instruction set or so.</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_ALG_KERN_DRIVER_ONLY	0x00001000</span>

<span class="cm">/*</span>
<span class="cm"> * Transform masks and values (for crt_flags).</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_TFM_REQ_MASK		0x000fff00</span>
<span class="cp">#define CRYPTO_TFM_RES_MASK		0xfff00000</span>

<span class="cp">#define CRYPTO_TFM_REQ_WEAK_KEY		0x00000100</span>
<span class="cp">#define CRYPTO_TFM_REQ_MAY_SLEEP	0x00000200</span>
<span class="cp">#define CRYPTO_TFM_REQ_MAY_BACKLOG	0x00000400</span>
<span class="cp">#define CRYPTO_TFM_RES_WEAK_KEY		0x00100000</span>
<span class="cp">#define CRYPTO_TFM_RES_BAD_KEY_LEN   	0x00200000</span>
<span class="cp">#define CRYPTO_TFM_RES_BAD_KEY_SCHED 	0x00400000</span>
<span class="cp">#define CRYPTO_TFM_RES_BAD_BLOCK_LEN 	0x00800000</span>
<span class="cp">#define CRYPTO_TFM_RES_BAD_FLAGS 	0x01000000</span>

<span class="cm">/*</span>
<span class="cm"> * Miscellaneous stuff.</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_MAX_ALG_NAME		64</span>

<span class="cm">/*</span>
<span class="cm"> * The macro CRYPTO_MINALIGN_ATTR (along with the void * type in the actual</span>
<span class="cm"> * declaration) is used to ensure that the crypto_tfm context structure is</span>
<span class="cm"> * aligned correctly for the given architecture so that there are no alignment</span>
<span class="cm"> * faults for C data types.  In particular, this is required on platforms such</span>
<span class="cm"> * as arm where pointers are 32-bit aligned but there are data types such as</span>
<span class="cm"> * u64 which require 64-bit alignment.</span>
<span class="cm"> */</span>
<span class="cp">#define CRYPTO_MINALIGN ARCH_KMALLOC_MINALIGN</span>

<span class="cp">#define CRYPTO_MINALIGN_ATTR __attribute__ ((__aligned__(CRYPTO_MINALIGN)))</span>

<span class="k">struct</span> <span class="n">scatterlist</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_ablkcipher</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_async_request</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_aead</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_blkcipher</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_hash</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_rng</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_tfm</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">crypto_type</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">aead_givcrypt_request</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">skcipher_givcrypt_request</span><span class="p">;</span>

<span class="k">typedef</span> <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">crypto_completion_t</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_async_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span> <span class="kt">int</span> <span class="n">err</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">crypto_async_request</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="n">crypto_completion_t</span> <span class="n">complete</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_async_request</span> <span class="n">base</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">;</span>

	<span class="kt">void</span> <span class="o">*</span><span class="n">info</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">;</span>

	<span class="kt">void</span> <span class="o">*</span><span class="n">__ctx</span><span class="p">[]</span> <span class="n">CRYPTO_MINALIGN_ATTR</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> *	struct aead_request - AEAD request</span>
<span class="cm"> *	@base: Common attributes for async crypto requests</span>
<span class="cm"> *	@assoclen: Length in bytes of associated data for authentication</span>
<span class="cm"> *	@cryptlen: Length of data to be encrypted or decrypted</span>
<span class="cm"> *	@iv: Initialisation vector</span>
<span class="cm"> *	@assoc: Associated data</span>
<span class="cm"> *	@src: Source data</span>
<span class="cm"> *	@dst: Destination data</span>
<span class="cm"> *	@__ctx: Start of private context data</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">aead_request</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_async_request</span> <span class="n">base</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">assoclen</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cryptlen</span><span class="p">;</span>

	<span class="n">u8</span> <span class="o">*</span><span class="n">iv</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">assoc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">;</span>

	<span class="kt">void</span> <span class="o">*</span><span class="n">__ctx</span><span class="p">[]</span> <span class="n">CRYPTO_MINALIGN_ATTR</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">info</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">cipher_desc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">crfn</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">prfn</span><span class="p">)(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">cipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
			     <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">info</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hash_desc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Algorithms: modular crypto algorithm implementations, managed</span>
<span class="cm"> * via crypto_register_alg() and crypto_unregister_alg().</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ablkcipher_alg</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	              <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givencrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">skcipher_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givdecrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">skcipher_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">geniv</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">min_keysize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">max_keysize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ivsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">aead_alg</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	              <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setauthsize</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">authsize</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givencrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givdecrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">geniv</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ivsize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">maxauthsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">blkcipher_alg</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	              <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
		       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
		       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">);</span>

	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">geniv</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">min_keysize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">max_keysize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ivsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">cipher_alg</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cia_min_keysize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cia_max_keysize</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cia_setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	                  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cia_encrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cia_decrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">compress_alg</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">coa_compress</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
			    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">dlen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">coa_decompress</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">dlen</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rng_alg</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">rng_make_random</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_rng</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">rdata</span><span class="p">,</span>
			       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dlen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">rng_reset</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_rng</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">seed</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">);</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seedsize</span><span class="p">;</span>
<span class="p">};</span>


<span class="cp">#define cra_ablkcipher	cra_u.ablkcipher</span>
<span class="cp">#define cra_aead	cra_u.aead</span>
<span class="cp">#define cra_blkcipher	cra_u.blkcipher</span>
<span class="cp">#define cra_cipher	cra_u.cipher</span>
<span class="cp">#define cra_compress	cra_u.compress</span>
<span class="cp">#define cra_rng		cra_u.rng</span>

<span class="k">struct</span> <span class="n">crypto_alg</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">cra_list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">cra_users</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">cra_flags</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cra_blocksize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cra_ctxsize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cra_alignmask</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">cra_priority</span><span class="p">;</span>
	<span class="n">atomic_t</span> <span class="n">cra_refcnt</span><span class="p">;</span>

	<span class="kt">char</span> <span class="n">cra_name</span><span class="p">[</span><span class="n">CRYPTO_MAX_ALG_NAME</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">cra_driver_name</span><span class="p">[</span><span class="n">CRYPTO_MAX_ALG_NAME</span><span class="p">];</span>

	<span class="k">const</span> <span class="k">struct</span> <span class="n">crypto_type</span> <span class="o">*</span><span class="n">cra_type</span><span class="p">;</span>

	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">ablkcipher_alg</span> <span class="n">ablkcipher</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">aead_alg</span> <span class="n">aead</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">blkcipher_alg</span> <span class="n">blkcipher</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">cipher_alg</span> <span class="n">cipher</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">compress_alg</span> <span class="n">compress</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">rng_alg</span> <span class="n">rng</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">cra_u</span><span class="p">;</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cra_init</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cra_exit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cra_destroy</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_alg</span> <span class="o">*</span><span class="n">alg</span><span class="p">);</span>
	
	<span class="k">struct</span> <span class="n">module</span> <span class="o">*</span><span class="n">cra_module</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Algorithm registration interface.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">crypto_register_alg</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_alg</span> <span class="o">*</span><span class="n">alg</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">crypto_unregister_alg</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_alg</span> <span class="o">*</span><span class="n">alg</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">crypto_register_algs</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_alg</span> <span class="o">*</span><span class="n">algs</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">crypto_unregister_algs</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_alg</span> <span class="o">*</span><span class="n">algs</span><span class="p">,</span> <span class="kt">int</span> <span class="n">count</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Algorithm query interface.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">crypto_has_alg</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Transforms: user-instantiated objects which encapsulate algorithms</span>
<span class="cm"> * and core processing logic.  Managed via crypto_alloc_*() and</span>
<span class="cm"> * crypto_free_*(), as well as the various helpers below.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">ablkcipher_tfm</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	              <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givencrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">skcipher_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givdecrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">skcipher_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>

	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">base</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ivsize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reqsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">aead_tfm</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
	              <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givencrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">givdecrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">aead_givcrypt_request</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>

	<span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">base</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ivsize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">authsize</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reqsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">blkcipher_tfm</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">iv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">encrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">decrypt</span><span class="p">)(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">cipher_tfm</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cit_setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
	                  <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cit_encrypt_one</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">cit_decrypt_one</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">hash_tfm</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">update</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
		      <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">sg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nsg</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">final</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">out</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">digest</span><span class="p">)(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">sg</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nsg</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">out</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">setkey</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">digestsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">compress_tfm</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cot_compress</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
	                    <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">,</span>
	                    <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">dlen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">cot_decompress</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
	                      <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">,</span>
	                      <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">dlen</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rng_tfm</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">rng_gen_random</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_rng</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">rdata</span><span class="p">,</span>
			      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dlen</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">rng_reset</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_rng</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">seed</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#define crt_ablkcipher	crt_u.ablkcipher</span>
<span class="cp">#define crt_aead	crt_u.aead</span>
<span class="cp">#define crt_blkcipher	crt_u.blkcipher</span>
<span class="cp">#define crt_cipher	crt_u.cipher</span>
<span class="cp">#define crt_hash	crt_u.hash</span>
<span class="cp">#define crt_compress	crt_u.compress</span>
<span class="cp">#define crt_rng		crt_u.rng</span>

<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="p">{</span>

	<span class="n">u32</span> <span class="n">crt_flags</span><span class="p">;</span>
	
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">ablkcipher_tfm</span> <span class="n">ablkcipher</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">aead_tfm</span> <span class="n">aead</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">blkcipher_tfm</span> <span class="n">blkcipher</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">cipher_tfm</span> <span class="n">cipher</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">hash_tfm</span> <span class="n">hash</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">compress_tfm</span> <span class="n">compress</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">rng_tfm</span> <span class="n">rng</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">crt_u</span><span class="p">;</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">exit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">);</span>
	
	<span class="k">struct</span> <span class="n">crypto_alg</span> <span class="o">*</span><span class="n">__crt_alg</span><span class="p">;</span>

	<span class="kt">void</span> <span class="o">*</span><span class="n">__crt_ctx</span><span class="p">[]</span> <span class="n">CRYPTO_MINALIGN_ATTR</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_aead</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_comp</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_hash</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_rng</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="n">base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">CRYPTOA_UNSPEC</span><span class="p">,</span>
	<span class="n">CRYPTOA_ALG</span><span class="p">,</span>
	<span class="n">CRYPTOA_TYPE</span><span class="p">,</span>
	<span class="n">CRYPTOA_U32</span><span class="p">,</span>
	<span class="n">__CRYPTOA_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define CRYPTOA_MAX (__CRYPTOA_MAX - 1)</span>

<span class="cm">/* Maximum number of (rtattr) parameters for each template. */</span>
<span class="cp">#define CRYPTO_MAX_ATTRS 32</span>

<span class="k">struct</span> <span class="n">crypto_attr_alg</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">CRYPTO_MAX_ALG_NAME</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_attr_type</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mask</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">crypto_attr_u32</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">num</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* </span>
<span class="cm"> * Transform user interface.</span>
<span class="cm"> */</span>
 
<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">crypto_alloc_base</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">crypto_destroy_tfm</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">mem</span><span class="p">,</span> <span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_free_tfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_destroy_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">,</span> <span class="n">tfm</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">alg_test</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">driver</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Transform helpers which query the underlying algorithm.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">crypto_tfm_alg_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_alg</span><span class="o">-&gt;</span><span class="n">cra_name</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">crypto_tfm_alg_driver_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_alg</span><span class="o">-&gt;</span><span class="n">cra_driver_name</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_tfm_alg_priority</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_alg</span><span class="o">-&gt;</span><span class="n">cra_priority</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_tfm_alg_type</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_alg</span><span class="o">-&gt;</span><span class="n">cra_flags</span> <span class="o">&amp;</span> <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_tfm_alg_blocksize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_alg</span><span class="o">-&gt;</span><span class="n">cra_blocksize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_tfm_alg_alignmask</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_alg</span><span class="o">-&gt;</span><span class="n">cra_alignmask</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_tfm_get_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">crt_flags</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_tfm_set_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">tfm</span><span class="o">-&gt;</span><span class="n">crt_flags</span> <span class="o">|=</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_tfm_clear_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">tfm</span><span class="o">-&gt;</span><span class="n">crt_flags</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">flags</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">crypto_tfm_ctx</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_ctx</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_tfm_ctx_alignment</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">__alignof__</span><span class="p">(</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">__crt_ctx</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * API wrappers.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="nf">__crypto_ablkcipher_cast</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="p">)</span><span class="n">tfm</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_skcipher_type</span><span class="p">(</span><span class="n">u32</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">CRYPTO_ALG_TYPE_MASK</span> <span class="o">|</span> <span class="n">CRYPTO_ALG_GENIV</span><span class="p">);</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">type</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_skcipher_mask</span><span class="p">(</span><span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mask</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">CRYPTO_ALG_TYPE_MASK</span> <span class="o">|</span> <span class="n">CRYPTO_ALG_GENIV</span><span class="p">);</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER_MASK</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">mask</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">crypto_alloc_ablkcipher</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span>
						  <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="nf">crypto_ablkcipher_tfm</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_free_ablkcipher</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_free_tfm</span><span class="p">(</span><span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_has_ablkcipher</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span>
					<span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_has_alg</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">crypto_skcipher_type</span><span class="p">(</span><span class="n">type</span><span class="p">),</span>
			      <span class="n">crypto_skcipher_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">ablkcipher_tfm</span> <span class="o">*</span><span class="nf">crypto_ablkcipher_crt</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">crt_ablkcipher</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_ablkcipher_ivsize</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_ablkcipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ivsize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_ablkcipher_blocksize</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_blocksize</span><span class="p">(</span><span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_ablkcipher_alignmask</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_alignmask</span><span class="p">(</span><span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_ablkcipher_get_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_get_flags</span><span class="p">(</span><span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_ablkcipher_set_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					       <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_set_flags</span><span class="p">(</span><span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_ablkcipher_clear_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
						 <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_clear_flags</span><span class="p">(</span><span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_ablkcipher_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					   <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ablkcipher_tfm</span> <span class="o">*</span><span class="n">crt</span> <span class="o">=</span> <span class="n">crypto_ablkcipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">crt</span><span class="o">-&gt;</span><span class="n">setkey</span><span class="p">(</span><span class="n">crt</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">keylen</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="nf">crypto_ablkcipher_reqtfm</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__crypto_ablkcipher_cast</span><span class="p">(</span><span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">tfm</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_ablkcipher_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ablkcipher_tfm</span> <span class="o">*</span><span class="n">crt</span> <span class="o">=</span>
		<span class="n">crypto_ablkcipher_crt</span><span class="p">(</span><span class="n">crypto_ablkcipher_reqtfm</span><span class="p">(</span><span class="n">req</span><span class="p">));</span>
	<span class="k">return</span> <span class="n">crt</span><span class="o">-&gt;</span><span class="n">encrypt</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_ablkcipher_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ablkcipher_tfm</span> <span class="o">*</span><span class="n">crt</span> <span class="o">=</span>
		<span class="n">crypto_ablkcipher_crt</span><span class="p">(</span><span class="n">crypto_ablkcipher_reqtfm</span><span class="p">(</span><span class="n">req</span><span class="p">));</span>
	<span class="k">return</span> <span class="n">crt</span><span class="o">-&gt;</span><span class="n">decrypt</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_ablkcipher_reqsize</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_ablkcipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">reqsize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ablkcipher_request_set_tfm</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span> <span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">tfm</span> <span class="o">=</span> <span class="n">crypto_ablkcipher_tfm</span><span class="p">(</span><span class="n">crypto_ablkcipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="nf">ablkcipher_request_cast</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_async_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">container_of</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ablkcipher_request</span><span class="p">,</span> <span class="n">base</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="nf">ablkcipher_request_alloc</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_ablkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">gfp_t</span> <span class="n">gfp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">;</span>

	<span class="n">req</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span><span class="p">)</span> <span class="o">+</span>
		      <span class="n">crypto_ablkcipher_reqsize</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">gfp</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">likely</span><span class="p">(</span><span class="n">req</span><span class="p">))</span>
		<span class="n">ablkcipher_request_set_tfm</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">tfm</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">req</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ablkcipher_request_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">kzfree</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ablkcipher_request_set_callback</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">,</span> <span class="n">crypto_completion_t</span> <span class="n">complete</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">complete</span> <span class="o">=</span> <span class="n">complete</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ablkcipher_request_set_crypt</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">ablkcipher_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">iv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">dst</span> <span class="o">=</span> <span class="n">dst</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">nbytes</span> <span class="o">=</span> <span class="n">nbytes</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">info</span> <span class="o">=</span> <span class="n">iv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="nf">__crypto_aead_cast</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="p">)</span><span class="n">tfm</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">crypto_alloc_aead</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="nf">crypto_aead_tfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_free_aead</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_free_tfm</span><span class="p">(</span><span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">aead_tfm</span> <span class="o">*</span><span class="nf">crypto_aead_crt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">crt_aead</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_aead_ivsize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_aead_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ivsize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_aead_authsize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_aead_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">authsize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_aead_blocksize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_blocksize</span><span class="p">(</span><span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_aead_alignmask</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_alignmask</span><span class="p">(</span><span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_aead_get_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_get_flags</span><span class="p">(</span><span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_aead_set_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_set_flags</span><span class="p">(</span><span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_aead_clear_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_clear_flags</span><span class="p">(</span><span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_aead_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">aead_tfm</span> <span class="o">*</span><span class="n">crt</span> <span class="o">=</span> <span class="n">crypto_aead_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">crt</span><span class="o">-&gt;</span><span class="n">setkey</span><span class="p">(</span><span class="n">crt</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">keylen</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">crypto_aead_setauthsize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">authsize</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="nf">crypto_aead_reqtfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__crypto_aead_cast</span><span class="p">(</span><span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">tfm</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_aead_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_aead_crt</span><span class="p">(</span><span class="n">crypto_aead_reqtfm</span><span class="p">(</span><span class="n">req</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">encrypt</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_aead_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_aead_crt</span><span class="p">(</span><span class="n">crypto_aead_reqtfm</span><span class="p">(</span><span class="n">req</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">decrypt</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_aead_reqsize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_aead_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">reqsize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">aead_request_set_tfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">tfm</span> <span class="o">=</span> <span class="n">crypto_aead_tfm</span><span class="p">(</span><span class="n">crypto_aead_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="nf">aead_request_alloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_aead</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
						      <span class="n">gfp_t</span> <span class="n">gfp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">;</span>

	<span class="n">req</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">req</span><span class="p">)</span> <span class="o">+</span> <span class="n">crypto_aead_reqsize</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">gfp</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">likely</span><span class="p">(</span><span class="n">req</span><span class="p">))</span>
		<span class="n">aead_request_set_tfm</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">tfm</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">req</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">aead_request_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">kzfree</span><span class="p">(</span><span class="n">req</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">aead_request_set_callback</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
					     <span class="n">u32</span> <span class="n">flags</span><span class="p">,</span>
					     <span class="n">crypto_completion_t</span> <span class="n">complete</span><span class="p">,</span>
					     <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">complete</span> <span class="o">=</span> <span class="n">complete</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">.</span><span class="n">flags</span> <span class="o">=</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">aead_request_set_crypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
					  <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
					  <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cryptlen</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">iv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">src</span> <span class="o">=</span> <span class="n">src</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">dst</span> <span class="o">=</span> <span class="n">dst</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">cryptlen</span> <span class="o">=</span> <span class="n">cryptlen</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">iv</span> <span class="o">=</span> <span class="n">iv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">aead_request_set_assoc</span><span class="p">(</span><span class="k">struct</span> <span class="n">aead_request</span> <span class="o">*</span><span class="n">req</span><span class="p">,</span>
					  <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">assoc</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">assoclen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">assoc</span> <span class="o">=</span> <span class="n">assoc</span><span class="p">;</span>
	<span class="n">req</span><span class="o">-&gt;</span><span class="n">assoclen</span> <span class="o">=</span> <span class="n">assoclen</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="nf">__crypto_blkcipher_cast</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="p">)</span><span class="n">tfm</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="nf">crypto_blkcipher_cast</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BUG_ON</span><span class="p">(</span><span class="n">crypto_tfm_alg_type</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span> <span class="o">!=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">__crypto_blkcipher_cast</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="nf">crypto_alloc_blkcipher</span><span class="p">(</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">__crypto_blkcipher_cast</span><span class="p">(</span><span class="n">crypto_alloc_base</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="nf">crypto_blkcipher_tfm</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_free_blkcipher</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_free_tfm</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_has_blkcipher</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_BLKCIPHER</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">crypto_has_alg</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">crypto_blkcipher_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_name</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">blkcipher_tfm</span> <span class="o">*</span><span class="nf">crypto_blkcipher_crt</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">crt_blkcipher</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">blkcipher_alg</span> <span class="o">*</span><span class="nf">crypto_blkcipher_alg</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">__crt_alg</span><span class="o">-&gt;</span><span class="n">cra_blkcipher</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_ivsize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_blkcipher_alg</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">ivsize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_blocksize</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_blocksize</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_alignmask</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_alignmask</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_blkcipher_get_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_get_flags</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_blkcipher_set_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					      <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_set_flags</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_blkcipher_clear_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
						<span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_clear_flags</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					  <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">setkey</span><span class="p">(</span><span class="n">crypto_blkcipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span>
						 <span class="n">key</span><span class="p">,</span> <span class="n">keylen</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_encrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">desc</span><span class="o">-&gt;</span><span class="n">info</span> <span class="o">=</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">encrypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_encrypt_iv</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
					      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">encrypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_decrypt</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					   <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">desc</span><span class="o">-&gt;</span><span class="n">info</span> <span class="o">=</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">decrypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_blkcipher_decrypt_iv</span><span class="p">(</span><span class="k">struct</span> <span class="n">blkcipher_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span>
					      <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span>
					      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">decrypt</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_blkcipher_set_iv</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					   <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_blkcipher_get_iv</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_blkcipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					   <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">crypto_blkcipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">iv</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="nf">__crypto_cipher_cast</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="p">)</span><span class="n">tfm</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="nf">crypto_cipher_cast</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BUG_ON</span><span class="p">(</span><span class="n">crypto_tfm_alg_type</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span> <span class="o">!=</span> <span class="n">CRYPTO_ALG_TYPE_CIPHER</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">__crypto_cipher_cast</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="nf">crypto_alloc_cipher</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span>
							<span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_CIPHER</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">__crypto_cipher_cast</span><span class="p">(</span><span class="n">crypto_alloc_base</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="nf">crypto_cipher_tfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_free_cipher</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_free_tfm</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_has_cipher</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_CIPHER</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">crypto_has_alg</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">cipher_tfm</span> <span class="o">*</span><span class="nf">crypto_cipher_crt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">crt_cipher</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_cipher_blocksize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_blocksize</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_cipher_alignmask</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_alignmask</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_cipher_get_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_get_flags</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_cipher_set_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					   <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_set_flags</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_cipher_clear_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					     <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_clear_flags</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_cipher_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_cipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">cit_setkey</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span>
						  <span class="n">key</span><span class="p">,</span> <span class="n">keylen</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_cipher_encrypt_one</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					     <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_cipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">cit_encrypt_one</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span>
						<span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_cipher_decrypt_one</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_cipher</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
					     <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_cipher_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">cit_decrypt_one</span><span class="p">(</span><span class="n">crypto_cipher_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span>
						<span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="nf">__crypto_hash_cast</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="p">)</span><span class="n">tfm</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="nf">crypto_hash_cast</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BUG_ON</span><span class="p">((</span><span class="n">crypto_tfm_alg_type</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span> <span class="o">^</span> <span class="n">CRYPTO_ALG_TYPE_HASH</span><span class="p">)</span> <span class="o">&amp;</span>
	       <span class="n">CRYPTO_ALG_TYPE_HASH_MASK</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">__crypto_hash_cast</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="nf">crypto_alloc_hash</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span>
						    <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_HASH</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_HASH_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">__crypto_hash_cast</span><span class="p">(</span><span class="n">crypto_alloc_base</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="nf">crypto_hash_tfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_free_hash</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_free_tfm</span><span class="p">(</span><span class="n">crypto_hash_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_has_hash</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_HASH</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_HASH_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">crypto_has_alg</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">hash_tfm</span> <span class="o">*</span><span class="nf">crypto_hash_crt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">crypto_hash_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">crt_hash</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_hash_blocksize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_blocksize</span><span class="p">(</span><span class="n">crypto_hash_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_hash_alignmask</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_alignmask</span><span class="p">(</span><span class="n">crypto_hash_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">crypto_hash_digestsize</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_hash_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">digestsize</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">crypto_hash_get_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_get_flags</span><span class="p">(</span><span class="n">crypto_hash_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_hash_set_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_set_flags</span><span class="p">(</span><span class="n">crypto_hash_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_hash_clear_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span> <span class="n">u32</span> <span class="n">flags</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_tfm_clear_flags</span><span class="p">(</span><span class="n">crypto_hash_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_hash_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_hash_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">init</span><span class="p">(</span><span class="n">desc</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_hash_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
				     <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">sg</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_hash_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">sg</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_hash_final</span><span class="p">(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_hash_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">final</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_hash_digest</span><span class="p">(</span><span class="k">struct</span> <span class="n">hash_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">,</span>
				     <span class="k">struct</span> <span class="n">scatterlist</span> <span class="o">*</span><span class="n">sg</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nbytes</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">out</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_hash_crt</span><span class="p">(</span><span class="n">desc</span><span class="o">-&gt;</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">digest</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">sg</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="n">out</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_hash_setkey</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_hash</span> <span class="o">*</span><span class="n">hash</span><span class="p">,</span>
				     <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">key</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">keylen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_hash_crt</span><span class="p">(</span><span class="n">hash</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">setkey</span><span class="p">(</span><span class="n">hash</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">keylen</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="nf">__crypto_comp_cast</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="p">)</span><span class="n">tfm</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="nf">crypto_comp_cast</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BUG_ON</span><span class="p">((</span><span class="n">crypto_tfm_alg_type</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span> <span class="o">^</span> <span class="n">CRYPTO_ALG_TYPE_COMPRESS</span><span class="p">)</span> <span class="o">&amp;</span>
	       <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">__crypto_comp_cast</span><span class="p">(</span><span class="n">tfm</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="nf">crypto_alloc_comp</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span>
						    <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_COMPRESS</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">__crypto_comp_cast</span><span class="p">(</span><span class="n">crypto_alloc_base</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">crypto_tfm</span> <span class="o">*</span><span class="nf">crypto_comp_tfm</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">tfm</span><span class="o">-&gt;</span><span class="n">base</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">crypto_free_comp</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">crypto_free_tfm</span><span class="p">(</span><span class="n">crypto_comp_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_has_comp</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">u32</span> <span class="n">type</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mask</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">type</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>
	<span class="n">type</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_COMPRESS</span><span class="p">;</span>
	<span class="n">mask</span> <span class="o">|=</span> <span class="n">CRYPTO_ALG_TYPE_MASK</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">crypto_has_alg</span><span class="p">(</span><span class="n">alg_name</span><span class="p">,</span> <span class="n">type</span><span class="p">,</span> <span class="n">mask</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">crypto_comp_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_tfm_alg_name</span><span class="p">(</span><span class="n">crypto_comp_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">compress_tfm</span> <span class="o">*</span><span class="nf">crypto_comp_crt</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="n">tfm</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">&amp;</span><span class="n">crypto_comp_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">crt_compress</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_comp_compress</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
                                       <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">,</span>
                                       <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">dlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_comp_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">cot_compress</span><span class="p">(</span><span class="n">crypto_comp_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span>
						  <span class="n">src</span><span class="p">,</span> <span class="n">slen</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">dlen</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">crypto_comp_decompress</span><span class="p">(</span><span class="k">struct</span> <span class="n">crypto_comp</span> <span class="o">*</span><span class="n">tfm</span><span class="p">,</span>
                                         <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">src</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">slen</span><span class="p">,</span>
                                         <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">dlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">crypto_comp_crt</span><span class="p">(</span><span class="n">tfm</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">cot_decompress</span><span class="p">(</span><span class="n">crypto_comp_tfm</span><span class="p">(</span><span class="n">tfm</span><span class="p">),</span>
						    <span class="n">src</span><span class="p">,</span> <span class="n">slen</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">dlen</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#endif	</span><span class="cm">/* _LINUX_CRYPTO_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
