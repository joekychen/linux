<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › wimax › i2400m.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>i2400m.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Intel Wireless WiMax Connection 2400m</span>
<span class="cm"> * Host-Device protocol interface definitions</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2007-2008 Intel Corporation. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Redistribution and use in source and binary forms, with or without</span>
<span class="cm"> * modification, are permitted provided that the following conditions</span>
<span class="cm"> * are met:</span>
<span class="cm"> *</span>
<span class="cm"> *   * Redistributions of source code must retain the above copyright</span>
<span class="cm"> *     notice, this list of conditions and the following disclaimer.</span>
<span class="cm"> *   * Redistributions in binary form must reproduce the above copyright</span>
<span class="cm"> *     notice, this list of conditions and the following disclaimer in</span>
<span class="cm"> *     the documentation and/or other materials provided with the</span>
<span class="cm"> *     distribution.</span>
<span class="cm"> *   * Neither the name of Intel Corporation nor the names of its</span>
<span class="cm"> *     contributors may be used to endorse or promote products derived</span>
<span class="cm"> *     from this software without specific prior written permission.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="cm"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="cm"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="cm"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="cm"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="cm"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="cm"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="cm"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="cm"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="cm"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="cm"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * Intel Corporation &lt;linux-wimax@intel.com&gt;</span>
<span class="cm"> * Inaky Perez-Gonzalez &lt;inaky.perez-gonzalez@intel.com&gt;</span>
<span class="cm"> *  - Initial implementation</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * This header defines the data structures and constants used to</span>
<span class="cm"> * communicate with the device.</span>
<span class="cm"> *</span>
<span class="cm"> * BOOTMODE/BOOTROM/FIRMWARE UPLOAD PROTOCOL</span>
<span class="cm"> *</span>
<span class="cm"> * The firmware upload protocol is quite simple and only requires a</span>
<span class="cm"> * handful of commands. See drivers/net/wimax/i2400m/fw.c for more</span>
<span class="cm"> * details.</span>
<span class="cm"> *</span>
<span class="cm"> * The BCF data structure is for the firmware file header.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * THE DATA / CONTROL PROTOCOL</span>
<span class="cm"> *</span>
<span class="cm"> * This is the normal protocol spoken with the device once the</span>
<span class="cm"> * firmware is uploaded. It transports data payloads and control</span>
<span class="cm"> * messages back and forth.</span>
<span class="cm"> *</span>
<span class="cm"> * It consists &#39;messages&#39; that pack one or more payloads each. The</span>
<span class="cm"> * format is described in detail in drivers/net/wimax/i2400m/rx.c and</span>
<span class="cm"> * tx.c.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * THE L3L4 PROTOCOL</span>
<span class="cm"> *</span>
<span class="cm"> * The term L3L4 refers to Layer 3 (the device), Layer 4 (the</span>
<span class="cm"> * driver/host software).</span>
<span class="cm"> *</span>
<span class="cm"> * This is the control protocol used by the host to control the i2400m</span>
<span class="cm"> * device (scan, connect, disconnect...). This is sent to / received</span>
<span class="cm"> * as control frames. These frames consist of a header and zero or</span>
<span class="cm"> * more TLVs with information. We call each control frame a &quot;message&quot;.</span>
<span class="cm"> *</span>
<span class="cm"> * Each message is composed of:</span>
<span class="cm"> *</span>
<span class="cm"> * HEADER</span>
<span class="cm"> * [TLV0 + PAYLOAD0]</span>
<span class="cm"> * [TLV1 + PAYLOAD1]</span>
<span class="cm"> * [...]</span>
<span class="cm"> * [TLVN + PAYLOADN]</span>
<span class="cm"> *</span>
<span class="cm"> * The HEADER is defined by &#39;struct i2400m_l3l4_hdr&#39;. The payloads are</span>
<span class="cm"> * defined by a TLV structure (Type Length Value) which is a &#39;header&#39;</span>
<span class="cm"> * (struct i2400m_tlv_hdr) and then the payload.</span>
<span class="cm"> *</span>
<span class="cm"> * All integers are represented as Little Endian.</span>
<span class="cm"> *</span>
<span class="cm"> * - REQUESTS AND EVENTS</span>
<span class="cm"> *</span>
<span class="cm"> * The requests can be clasified as follows:</span>
<span class="cm"> *</span>
<span class="cm"> *   COMMAND:  implies a request from the host to the device requesting</span>
<span class="cm"> *             an action being performed. The device will reply with a</span>
<span class="cm"> *             message (with the same type as the command), status and</span>
<span class="cm"> *             no (TLV) payload. Execution of a command might cause</span>
<span class="cm"> *             events (of different type) to be sent later on as</span>
<span class="cm"> *             device&#39;s state changes.</span>
<span class="cm"> *</span>
<span class="cm"> *   GET/SET:  similar to COMMAND, but will not cause other</span>
<span class="cm"> *             EVENTs. The reply, in the case of GET, will contain</span>
<span class="cm"> *             TLVs with the requested information.</span>
<span class="cm"> *</span>
<span class="cm"> *   EVENT:    asynchronous messages sent from the device, maybe as a</span>
<span class="cm"> *             consequence of previous COMMANDs but disassociated from</span>
<span class="cm"> *             them.</span>
<span class="cm"> *</span>
<span class="cm"> * Only one request might be pending at the same time (ie: don&#39;t</span>
<span class="cm"> * parallelize nor post another GET request before the previous</span>
<span class="cm"> * COMMAND has been acknowledged with it&#39;s corresponding reply by the</span>
<span class="cm"> * device).</span>
<span class="cm"> *</span>
<span class="cm"> * The different requests and their formats are described below:</span>
<span class="cm"> *</span>
<span class="cm"> *  I2400M_MT_*   Message types</span>
<span class="cm"> *  I2400M_MS_*   Message status (for replies, events)</span>
<span class="cm"> *  i2400m_tlv_*  TLVs</span>
<span class="cm"> *</span>
<span class="cm"> * data types are named &#39;struct i2400m_msg_OPNAME&#39;, OPNAME matching the</span>
<span class="cm"> * operation.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __LINUX__WIMAX__I2400M_H__</span>
<span class="cp">#define __LINUX__WIMAX__I2400M_H__</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>


<span class="cm">/*</span>
<span class="cm"> * Host Device Interface (HDI) common to all busses</span>
<span class="cm"> */</span>

<span class="cm">/* Boot-mode (firmware upload mode) commands */</span>

<span class="cm">/* Header for the firmware file */</span>
<span class="k">struct</span> <span class="n">i2400m_bcf_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">module_type</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">header_len</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">header_version</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">module_id</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">module_vendor</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">date</span><span class="p">;</span>		<span class="cm">/* BCD YYYMMDD */</span>
	<span class="n">__le32</span> <span class="n">size</span><span class="p">;</span>            <span class="cm">/* in dwords */</span>
	<span class="n">__le32</span> <span class="n">key_size</span><span class="p">;</span>	<span class="cm">/* in dwords */</span>
	<span class="n">__le32</span> <span class="n">modulus_size</span><span class="p">;</span>	<span class="cm">/* in dwords */</span>
	<span class="n">__le32</span> <span class="n">exponent_size</span><span class="p">;</span>	<span class="cm">/* in dwords */</span>
	<span class="n">__u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">88</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* Boot mode opcodes */</span>
<span class="k">enum</span> <span class="n">i2400m_brh_opcode</span> <span class="p">{</span>
	<span class="n">I2400M_BRH_READ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">I2400M_BRH_WRITE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">I2400M_BRH_JUMP</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">I2400M_BRH_SIGNED_JUMP</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">I2400M_BRH_HASH_PAYLOAD_ONLY</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Boot mode command masks and stuff */</span>
<span class="k">enum</span> <span class="n">i2400m_brh</span> <span class="p">{</span>
	<span class="n">I2400M_BRH_SIGNATURE</span> <span class="o">=</span> <span class="mh">0xcbbc0000</span><span class="p">,</span>
	<span class="n">I2400M_BRH_SIGNATURE_MASK</span> <span class="o">=</span> <span class="mh">0xffff0000</span><span class="p">,</span>
	<span class="n">I2400M_BRH_SIGNATURE_SHIFT</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">I2400M_BRH_OPCODE_MASK</span> <span class="o">=</span> <span class="mh">0x0000000f</span><span class="p">,</span>
	<span class="n">I2400M_BRH_RESPONSE_MASK</span> <span class="o">=</span> <span class="mh">0x000000f0</span><span class="p">,</span>
	<span class="n">I2400M_BRH_RESPONSE_SHIFT</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">I2400M_BRH_DIRECT_ACCESS</span> <span class="o">=</span> <span class="mh">0x00000400</span><span class="p">,</span>
	<span class="n">I2400M_BRH_RESPONSE_REQUIRED</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
	<span class="n">I2400M_BRH_USE_CHECKSUM</span> <span class="o">=</span> <span class="mh">0x00000100</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * i2400m_bootrom_header - Header for a boot-mode command</span>
<span class="cm"> *</span>
<span class="cm"> * @cmd: the above command descriptor</span>
<span class="cm"> * @target_addr: where on the device memory should the action be performed.</span>
<span class="cm"> * @data_size: for read/write, amount of data to be read/written</span>
<span class="cm"> * @block_checksum: checksum value (if applicable)</span>
<span class="cm"> * @payload: the beginning of data attached to this header</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">i2400m_bootrom_header</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">command</span><span class="p">;</span>		<span class="cm">/* Compose with enum i2400_brh */</span>
	<span class="n">__le32</span> <span class="n">target_addr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">data_size</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">block_checksum</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/*</span>
<span class="cm"> * Data / control protocol</span>
<span class="cm"> */</span>

<span class="cm">/* Packet types for the host-device interface */</span>
<span class="k">enum</span> <span class="n">i2400m_pt</span> <span class="p">{</span>
	<span class="n">I2400M_PT_DATA</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">I2400M_PT_CTRL</span><span class="p">,</span>
	<span class="n">I2400M_PT_TRACE</span><span class="p">,</span>	<span class="cm">/* For device debug */</span>
	<span class="n">I2400M_PT_RESET_WARM</span><span class="p">,</span>	<span class="cm">/* device reset */</span>
	<span class="n">I2400M_PT_RESET_COLD</span><span class="p">,</span>	<span class="cm">/* USB[transport] reset, like reconnect */</span>
	<span class="n">I2400M_PT_EDATA</span><span class="p">,</span>	<span class="cm">/* Extended RX data */</span>
	<span class="n">I2400M_PT_ILLEGAL</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * Payload for a data packet</span>
<span class="cm"> *</span>
<span class="cm"> * This is prefixed to each and every outgoing DATA type.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">i2400m_pl_data_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/*</span>
<span class="cm"> * Payload for an extended data packet</span>
<span class="cm"> *</span>
<span class="cm"> * New in fw v1.4</span>
<span class="cm"> *</span>
<span class="cm"> * @reorder: if this payload has to be reorder or not (and how)</span>
<span class="cm"> * @cs: the type of data in the packet, as defined per (802.16e</span>
<span class="cm"> *     T11.13.19.1). Currently only 2 (IPv4 packet) supported.</span>
<span class="cm"> *</span>
<span class="cm"> * This is prefixed to each and every INCOMING DATA packet.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">i2400m_pl_edata_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">reorder</span><span class="p">;</span>		<span class="cm">/* bits defined in i2400m_ro */</span>
	<span class="n">__u8</span> <span class="n">cs</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">11</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">enum</span> <span class="n">i2400m_cs</span> <span class="p">{</span>
	<span class="n">I2400M_CS_IPV4_0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">I2400M_CS_IPV4</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">i2400m_ro</span> <span class="p">{</span>
	<span class="n">I2400M_RO_NEEDED</span>     <span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">I2400M_RO_TYPE</span>       <span class="o">=</span> <span class="mh">0x03</span><span class="p">,</span>
	<span class="n">I2400M_RO_TYPE_SHIFT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">I2400M_RO_CIN</span>        <span class="o">=</span> <span class="mh">0x0f</span><span class="p">,</span>
	<span class="n">I2400M_RO_CIN_SHIFT</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">I2400M_RO_FBN</span>        <span class="o">=</span> <span class="mh">0x07ff</span><span class="p">,</span>
	<span class="n">I2400M_RO_FBN_SHIFT</span>  <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">I2400M_RO_SN</span>         <span class="o">=</span> <span class="mh">0x07ff</span><span class="p">,</span>
	<span class="n">I2400M_RO_SN_SHIFT</span>   <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">i2400m_ro_type</span> <span class="p">{</span>
	<span class="n">I2400M_RO_TYPE_RESET</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">I2400M_RO_TYPE_PACKET</span><span class="p">,</span>
	<span class="n">I2400M_RO_TYPE_WS</span><span class="p">,</span>
	<span class="n">I2400M_RO_TYPE_PACKET_WS</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/* Misc constants */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">I2400M_PL_ALIGN</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>	<span class="cm">/* Payload data size alignment */</span>
	<span class="n">I2400M_PL_SIZE_MAX</span> <span class="o">=</span> <span class="mh">0x3EFF</span><span class="p">,</span>
	<span class="n">I2400M_MAX_PLS_IN_MSG</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
	<span class="cm">/* protocol barkers: sync sequences; for notifications they</span>
<span class="cm">	 * are sent in groups of four. */</span>
	<span class="n">I2400M_H2D_PREVIEW_BARKER</span> <span class="o">=</span> <span class="mh">0xcafe900d</span><span class="p">,</span>
	<span class="n">I2400M_COLD_RESET_BARKER</span> <span class="o">=</span> <span class="mh">0xc01dc01d</span><span class="p">,</span>
	<span class="n">I2400M_WARM_RESET_BARKER</span> <span class="o">=</span> <span class="mh">0x50f750f7</span><span class="p">,</span>
	<span class="n">I2400M_NBOOT_BARKER</span> <span class="o">=</span> <span class="mh">0xdeadbeef</span><span class="p">,</span>
	<span class="n">I2400M_SBOOT_BARKER</span> <span class="o">=</span> <span class="mh">0x0ff1c1a1</span><span class="p">,</span>
	<span class="n">I2400M_SBOOT_BARKER_6050</span> <span class="o">=</span> <span class="mh">0x80000001</span><span class="p">,</span>
	<span class="n">I2400M_ACK_BARKER</span> <span class="o">=</span> <span class="mh">0xfeedbabe</span><span class="p">,</span>
	<span class="n">I2400M_D2H_MSG_BARKER</span> <span class="o">=</span> <span class="mh">0xbeefbabe</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * Hardware payload descriptor</span>
<span class="cm"> *</span>
<span class="cm"> * Bitfields encoded in a struct to enforce typing semantics.</span>
<span class="cm"> *</span>
<span class="cm"> * Look in rx.c and tx.c for a full description of the format.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">i2400m_pld</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">val</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cp">#define I2400M_PLD_SIZE_MASK 0x00003fff</span>
<span class="cp">#define I2400M_PLD_TYPE_SHIFT 16</span>
<span class="cp">#define I2400M_PLD_TYPE_MASK 0x000f0000</span>

<span class="cm">/*</span>
<span class="cm"> * Header for a TX message or RX message</span>
<span class="cm"> *</span>
<span class="cm"> * @barker: preamble</span>
<span class="cm"> * @size: used for management of the FIFO queue buffer; before</span>
<span class="cm"> *     sending, this is converted to be a real preamble. This</span>
<span class="cm"> *     indicates the real size of the TX message that starts at this</span>
<span class="cm"> *     point. If the highest bit is set, then this message is to be</span>
<span class="cm"> *     skipped.</span>
<span class="cm"> * @sequence: sequence number of this message</span>
<span class="cm"> * @offset: offset where the message itself starts -- see the comments</span>
<span class="cm"> *     in the file header about message header and payload descriptor</span>
<span class="cm"> *     alignment.</span>
<span class="cm"> * @num_pls: number of payloads in this message</span>
<span class="cm"> * @padding: amount of padding bytes at the end of the message to make</span>
<span class="cm"> *           it be of block-size aligned</span>
<span class="cm"> *</span>
<span class="cm"> * Look in rx.c and tx.c for a full description of the format.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">i2400m_msg_hdr</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">__le32</span> <span class="n">barker</span><span class="p">;</span>
		<span class="n">__u32</span> <span class="n">size</span><span class="p">;</span>	<span class="cm">/* same size type as barker!! */</span>
	<span class="p">};</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">__le32</span> <span class="n">sequence</span><span class="p">;</span>
		<span class="n">__u32</span> <span class="n">offset</span><span class="p">;</span>	<span class="cm">/* same size type as barker!! */</span>
	<span class="p">};</span>
	<span class="n">__le16</span> <span class="n">num_pls</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">rsv1</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">padding</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">rsv2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">i2400m_pld</span> <span class="n">pld</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>



<span class="cm">/*</span>
<span class="cm"> * L3/L4 control protocol</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="cm">/* Interface version */</span>
	<span class="n">I2400M_L3L4_VERSION</span>             <span class="o">=</span> <span class="mh">0x0100</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Message types */</span>
<span class="k">enum</span> <span class="n">i2400m_mt</span> <span class="p">{</span>
	<span class="n">I2400M_MT_RESERVED</span>              <span class="o">=</span> <span class="mh">0x0000</span><span class="p">,</span>
	<span class="n">I2400M_MT_INVALID</span>               <span class="o">=</span> <span class="mh">0xffff</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_MASK</span>		<span class="o">=</span> <span class="mh">0x8000</span><span class="p">,</span>

	<span class="n">I2400M_MT_GET_SCAN_RESULT</span>  	<span class="o">=</span> <span class="mh">0x4202</span><span class="p">,</span>
	<span class="n">I2400M_MT_SET_SCAN_PARAM</span>   	<span class="o">=</span> <span class="mh">0x4402</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_RF_CONTROL</span>   	<span class="o">=</span> <span class="mh">0x4602</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_SCAN</span>         	<span class="o">=</span> <span class="mh">0x4603</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_CONNECT</span>      	<span class="o">=</span> <span class="mh">0x4604</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_DISCONNECT</span>   	<span class="o">=</span> <span class="mh">0x4605</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_EXIT_IDLE</span>   	<span class="o">=</span> <span class="mh">0x4606</span><span class="p">,</span>
	<span class="n">I2400M_MT_GET_LM_VERSION</span>   	<span class="o">=</span> <span class="mh">0x5201</span><span class="p">,</span>
	<span class="n">I2400M_MT_GET_DEVICE_INFO</span>  	<span class="o">=</span> <span class="mh">0x5202</span><span class="p">,</span>
	<span class="n">I2400M_MT_GET_LINK_STATUS</span>  	<span class="o">=</span> <span class="mh">0x5203</span><span class="p">,</span>
	<span class="n">I2400M_MT_GET_STATISTICS</span>   	<span class="o">=</span> <span class="mh">0x5204</span><span class="p">,</span>
	<span class="n">I2400M_MT_GET_STATE</span>        	<span class="o">=</span> <span class="mh">0x5205</span><span class="p">,</span>
	<span class="n">I2400M_MT_GET_MEDIA_STATUS</span>	<span class="o">=</span> <span class="mh">0x5206</span><span class="p">,</span>
	<span class="n">I2400M_MT_SET_INIT_CONFIG</span>	<span class="o">=</span> <span class="mh">0x5404</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_INIT</span>	        <span class="o">=</span> <span class="mh">0x5601</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_TERMINATE</span>		<span class="o">=</span> <span class="mh">0x5602</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_MODE_OF_OP</span>	<span class="o">=</span> <span class="mh">0x5603</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_RESET_DEVICE</span>	<span class="o">=</span> <span class="mh">0x5604</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_MONITOR_CONTROL</span>   <span class="o">=</span> <span class="mh">0x5605</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_ENTER_POWERSAVE</span>   <span class="o">=</span> <span class="mh">0x5606</span><span class="p">,</span>
	<span class="n">I2400M_MT_GET_TLS_OPERATION_RESULT</span> <span class="o">=</span> <span class="mh">0x6201</span><span class="p">,</span>
	<span class="n">I2400M_MT_SET_EAP_SUCCESS</span>       <span class="o">=</span> <span class="mh">0x6402</span><span class="p">,</span>
	<span class="n">I2400M_MT_SET_EAP_FAIL</span>          <span class="o">=</span> <span class="mh">0x6403</span><span class="p">,</span>
	<span class="n">I2400M_MT_SET_EAP_KEY</span>          	<span class="o">=</span> <span class="mh">0x6404</span><span class="p">,</span>
	<span class="n">I2400M_MT_CMD_SEND_EAP_RESPONSE</span> <span class="o">=</span> <span class="mh">0x6602</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_SCAN_RESULT</span>    <span class="o">=</span> <span class="mh">0xc002</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_STATE</span>		<span class="o">=</span> <span class="mh">0xd002</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_POWERSAVE_READY</span> <span class="o">=</span> <span class="mh">0xd005</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_EAP_REQUEST</span>    <span class="o">=</span> <span class="mh">0xe002</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_EAP_RESTART</span>    <span class="o">=</span> <span class="mh">0xe003</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_ALT_ACCEPT</span>    	<span class="o">=</span> <span class="mh">0xe004</span><span class="p">,</span>
	<span class="n">I2400M_MT_REPORT_KEY_REQUEST</span> 	<span class="o">=</span> <span class="mh">0xe005</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * Message Ack Status codes</span>
<span class="cm"> *</span>
<span class="cm"> * When a message is replied-to, this status is reported.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">i2400m_ms</span> <span class="p">{</span>
	<span class="n">I2400M_MS_DONE_OK</span>                  <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">I2400M_MS_DONE_IN_PROGRESS</span>         <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">I2400M_MS_INVALID_OP</span>               <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">I2400M_MS_BAD_STATE</span>                <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">I2400M_MS_ILLEGAL_VALUE</span>            <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">I2400M_MS_MISSING_PARAMS</span>           <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">I2400M_MS_VERSION_ERROR</span>            <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">I2400M_MS_ACCESSIBILITY_ERROR</span>      <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">I2400M_MS_BUSY</span>                     <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">I2400M_MS_CORRUPTED_TLV</span>            <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">I2400M_MS_UNINITIALIZED</span>            <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">I2400M_MS_UNKNOWN_ERROR</span>            <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">I2400M_MS_PRODUCTION_ERROR</span>         <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">I2400M_MS_NO_RF</span>                    <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">I2400M_MS_NOT_READY_FOR_POWERSAVE</span>  <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">I2400M_MS_THERMAL_CRITICAL</span>         <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">I2400M_MS_MAX</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * i2400m_tlv - enumeration of the different types of TLVs</span>
<span class="cm"> *</span>
<span class="cm"> * TLVs stand for type-length-value and are the header for a payload</span>
<span class="cm"> * composed of almost anything. Each payload has a type assigned</span>
<span class="cm"> * and a length.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">i2400m_tlv</span> <span class="p">{</span>
	<span class="n">I2400M_TLV_L4_MESSAGE_VERSIONS</span> <span class="o">=</span> <span class="mi">129</span><span class="p">,</span>
	<span class="n">I2400M_TLV_SYSTEM_STATE</span> <span class="o">=</span> <span class="mi">141</span><span class="p">,</span>
	<span class="n">I2400M_TLV_MEDIA_STATUS</span> <span class="o">=</span> <span class="mi">161</span><span class="p">,</span>
	<span class="n">I2400M_TLV_RF_OPERATION</span> <span class="o">=</span> <span class="mi">162</span><span class="p">,</span>
	<span class="n">I2400M_TLV_RF_STATUS</span> <span class="o">=</span> <span class="mi">163</span><span class="p">,</span>
	<span class="n">I2400M_TLV_DEVICE_RESET_TYPE</span> <span class="o">=</span> <span class="mi">132</span><span class="p">,</span>
	<span class="n">I2400M_TLV_CONFIG_IDLE_PARAMETERS</span> <span class="o">=</span> <span class="mi">601</span><span class="p">,</span>
	<span class="n">I2400M_TLV_CONFIG_IDLE_TIMEOUT</span> <span class="o">=</span> <span class="mi">611</span><span class="p">,</span>
	<span class="n">I2400M_TLV_CONFIG_D2H_DATA_FORMAT</span> <span class="o">=</span> <span class="mi">614</span><span class="p">,</span>
	<span class="n">I2400M_TLV_CONFIG_DL_HOST_REORDER</span> <span class="o">=</span> <span class="mi">615</span><span class="p">,</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">length</span><span class="p">;</span>		<span class="cm">/* payload&#39;s */</span>
	<span class="n">__u8</span>   <span class="n">pl</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">struct</span> <span class="n">i2400m_l3l4_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">length</span><span class="p">;</span>		<span class="cm">/* payload&#39;s */</span>
	<span class="n">__le16</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">resv1</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">resv2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">pl</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/**</span>
<span class="cm"> * i2400m_system_state - different states of the device</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">i2400m_system_state</span> <span class="p">{</span>
	<span class="n">I2400M_SS_UNINITIALIZED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">I2400M_SS_INIT</span><span class="p">,</span>
	<span class="n">I2400M_SS_READY</span><span class="p">,</span>
	<span class="n">I2400M_SS_SCAN</span><span class="p">,</span>
	<span class="n">I2400M_SS_STANDBY</span><span class="p">,</span>
	<span class="n">I2400M_SS_CONNECTING</span><span class="p">,</span>
	<span class="n">I2400M_SS_WIMAX_CONNECTED</span><span class="p">,</span>
	<span class="n">I2400M_SS_DATA_PATH_CONNECTED</span><span class="p">,</span>
	<span class="n">I2400M_SS_IDLE</span><span class="p">,</span>
	<span class="n">I2400M_SS_DISCONNECTING</span><span class="p">,</span>
	<span class="n">I2400M_SS_OUT_OF_ZONE</span><span class="p">,</span>
	<span class="n">I2400M_SS_SLEEPACTIVE</span><span class="p">,</span>
	<span class="n">I2400M_SS_PRODUCTION</span><span class="p">,</span>
	<span class="n">I2400M_SS_CONFIG</span><span class="p">,</span>
	<span class="n">I2400M_SS_RF_OFF</span><span class="p">,</span>
	<span class="n">I2400M_SS_RF_SHUTDOWN</span><span class="p">,</span>
	<span class="n">I2400M_SS_DEVICE_DISCONNECT</span><span class="p">,</span>
	<span class="n">I2400M_SS_MAX</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * i2400m_tlv_system_state - report on the state of the system</span>
<span class="cm"> *</span>
<span class="cm"> * @state: see enum i2400m_system_state</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">i2400m_tlv_system_state</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">state</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">struct</span> <span class="n">i2400m_tlv_l4_message_versions</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">major</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">minor</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">branch</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">struct</span> <span class="n">i2400m_tlv_detailed_device_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">reserved1</span><span class="p">[</span><span class="mi">400</span><span class="p">];</span>
	<span class="n">__u8</span> <span class="n">mac_address</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__u8</span> <span class="n">reserved2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">enum</span> <span class="n">i2400m_rf_switch_status</span> <span class="p">{</span>
	<span class="n">I2400M_RF_SWITCH_ON</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">I2400M_RF_SWITCH_OFF</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">i2400m_tlv_rf_switches_status</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">sw_rf_switch</span><span class="p">;</span>	<span class="cm">/* 1 ON, 2 OFF */</span>
	<span class="n">__u8</span> <span class="n">hw_rf_switch</span><span class="p">;</span>	<span class="cm">/* 1 ON, 2 OFF */</span>
	<span class="n">__u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">enum</span> <span class="p">{</span>
	<span class="n">i2400m_rf_operation_on</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">i2400m_rf_operation_off</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">i2400m_tlv_rf_operation</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">status</span><span class="p">;</span>	<span class="cm">/* 1 ON, 2 OFF */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">enum</span> <span class="n">i2400m_tlv_reset_type</span> <span class="p">{</span>
	<span class="n">I2400M_RESET_TYPE_COLD</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">I2400M_RESET_TYPE_WARM</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">i2400m_tlv_device_reset_type</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">reset_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">struct</span> <span class="n">i2400m_tlv_config_idle_parameters</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">idle_timeout</span><span class="p">;</span>	<span class="cm">/* 100 to 300000 ms [5min], 100 increments</span>
<span class="cm">				 * 0 disabled */</span>
	<span class="n">__le32</span> <span class="n">idle_paging_interval</span><span class="p">;</span>	<span class="cm">/* frames */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="k">enum</span> <span class="n">i2400m_media_status</span> <span class="p">{</span>
	<span class="n">I2400M_MEDIA_STATUS_LINK_UP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">I2400M_MEDIA_STATUS_LINK_DOWN</span><span class="p">,</span>
	<span class="n">I2400M_MEDIA_STATUS_LINK_RENEW</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">i2400m_tlv_media_status</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">media_status</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/* New in v1.4 */</span>
<span class="k">struct</span> <span class="n">i2400m_tlv_config_idle_timeout</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">timeout</span><span class="p">;</span>	<span class="cm">/* 100 to 300000 ms [5min], 100 increments</span>
<span class="cm">			 * 0 disabled */</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* New in v1.4 -- for backward compat, will be removed */</span>
<span class="k">struct</span> <span class="n">i2400m_tlv_config_d2h_data_format</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">format</span><span class="p">;</span> 		<span class="cm">/* 0 old format, 1 enhanced */</span>
	<span class="n">__u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* New in v1.4 */</span>
<span class="k">struct</span> <span class="n">i2400m_tlv_config_dl_host_reorder</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">i2400m_tlv_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">reorder</span><span class="p">;</span> 		<span class="cm">/* 0 disabled, 1 enabled */</span>
	<span class="n">__u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cp">#endif </span><span class="cm">/* #ifndef __LINUX__WIMAX__I2400M_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
