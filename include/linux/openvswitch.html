<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › openvswitch.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>openvswitch.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2007-2011 Nicira Networks.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of version 2 of the GNU General Public</span>
<span class="cm"> * License as published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span>
<span class="cm"> * 02110-1301, USA</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_OPENVSWITCH_H</span>
<span class="cp">#define _LINUX_OPENVSWITCH_H 1</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/**</span>
<span class="cm"> * struct ovs_header - header for OVS Generic Netlink messages.</span>
<span class="cm"> * @dp_ifindex: ifindex of local port for datapath (0 to make a request not</span>
<span class="cm"> * specific to a datapath).</span>
<span class="cm"> *</span>
<span class="cm"> * Attributes following the header are specific to a particular OVS Generic</span>
<span class="cm"> * Netlink family, but all of the OVS families use this header.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">ovs_header</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">dp_ifindex</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Datapaths. */</span>

<span class="cp">#define OVS_DATAPATH_FAMILY  &quot;ovs_datapath&quot;</span>
<span class="cp">#define OVS_DATAPATH_MCGROUP &quot;ovs_datapath&quot;</span>
<span class="cp">#define OVS_DATAPATH_VERSION 0x1</span>

<span class="k">enum</span> <span class="n">ovs_datapath_cmd</span> <span class="p">{</span>
	<span class="n">OVS_DP_CMD_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_DP_CMD_NEW</span><span class="p">,</span>
	<span class="n">OVS_DP_CMD_DEL</span><span class="p">,</span>
	<span class="n">OVS_DP_CMD_GET</span><span class="p">,</span>
	<span class="n">OVS_DP_CMD_SET</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_datapath_attr - attributes for %OVS_DP_* commands.</span>
<span class="cm"> * @OVS_DP_ATTR_NAME: Name of the network device that serves as the &quot;local</span>
<span class="cm"> * port&quot;.  This is the name of the network device whose dp_ifindex is given in</span>
<span class="cm"> * the &amp;struct ovs_header.  Always present in notifications.  Required in</span>
<span class="cm"> * %OVS_DP_NEW requests.  May be used as an alternative to specifying</span>
<span class="cm"> * dp_ifindex in other requests (with a dp_ifindex of 0).</span>
<span class="cm"> * @OVS_DP_ATTR_UPCALL_PID: The Netlink socket in userspace that is initially</span>
<span class="cm"> * set on the datapath port (for OVS_ACTION_ATTR_MISS).  Only valid on</span>
<span class="cm"> * %OVS_DP_CMD_NEW requests. A value of zero indicates that upcalls should</span>
<span class="cm"> * not be sent.</span>
<span class="cm"> * @OVS_DP_ATTR_STATS: Statistics about packets that have passed through the</span>
<span class="cm"> * datapath.  Always present in notifications.</span>
<span class="cm"> *</span>
<span class="cm"> * These attributes follow the &amp;struct ovs_header within the Generic Netlink</span>
<span class="cm"> * payload for %OVS_DP_* commands.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ovs_datapath_attr</span> <span class="p">{</span>
	<span class="n">OVS_DP_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_DP_ATTR_NAME</span><span class="p">,</span>       <span class="cm">/* name of dp_ifindex netdev */</span>
	<span class="n">OVS_DP_ATTR_UPCALL_PID</span><span class="p">,</span> <span class="cm">/* Netlink PID to receive upcalls */</span>
	<span class="n">OVS_DP_ATTR_STATS</span><span class="p">,</span>      <span class="cm">/* struct ovs_dp_stats */</span>
	<span class="n">__OVS_DP_ATTR_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_DP_ATTR_MAX (__OVS_DP_ATTR_MAX - 1)</span>

<span class="k">struct</span> <span class="n">ovs_dp_stats</span> <span class="p">{</span>
	<span class="n">__u64</span> <span class="n">n_hit</span><span class="p">;</span>             <span class="cm">/* Number of flow table matches. */</span>
	<span class="n">__u64</span> <span class="n">n_missed</span><span class="p">;</span>          <span class="cm">/* Number of flow table misses. */</span>
	<span class="n">__u64</span> <span class="n">n_lost</span><span class="p">;</span>            <span class="cm">/* Number of misses not sent to userspace. */</span>
	<span class="n">__u64</span> <span class="n">n_flows</span><span class="p">;</span>           <span class="cm">/* Number of flows present */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_vport_stats</span> <span class="p">{</span>
	<span class="n">__u64</span>   <span class="n">rx_packets</span><span class="p">;</span>		<span class="cm">/* total packets received       */</span>
	<span class="n">__u64</span>   <span class="n">tx_packets</span><span class="p">;</span>		<span class="cm">/* total packets transmitted    */</span>
	<span class="n">__u64</span>   <span class="n">rx_bytes</span><span class="p">;</span>		<span class="cm">/* total bytes received         */</span>
	<span class="n">__u64</span>   <span class="n">tx_bytes</span><span class="p">;</span>		<span class="cm">/* total bytes transmitted      */</span>
	<span class="n">__u64</span>   <span class="n">rx_errors</span><span class="p">;</span>		<span class="cm">/* bad packets received         */</span>
	<span class="n">__u64</span>   <span class="n">tx_errors</span><span class="p">;</span>		<span class="cm">/* packet transmit problems     */</span>
	<span class="n">__u64</span>   <span class="n">rx_dropped</span><span class="p">;</span>		<span class="cm">/* no space in linux buffers    */</span>
	<span class="n">__u64</span>   <span class="n">tx_dropped</span><span class="p">;</span>		<span class="cm">/* no space available in linux  */</span>
<span class="p">};</span>

<span class="cm">/* Fixed logical ports. */</span>
<span class="cp">#define OVSP_LOCAL      ((__u16)0)</span>

<span class="cm">/* Packet transfer. */</span>

<span class="cp">#define OVS_PACKET_FAMILY &quot;ovs_packet&quot;</span>
<span class="cp">#define OVS_PACKET_VERSION 0x1</span>

<span class="k">enum</span> <span class="n">ovs_packet_cmd</span> <span class="p">{</span>
	<span class="n">OVS_PACKET_CMD_UNSPEC</span><span class="p">,</span>

	<span class="cm">/* Kernel-to-user notifications. */</span>
	<span class="n">OVS_PACKET_CMD_MISS</span><span class="p">,</span>    <span class="cm">/* Flow table miss. */</span>
	<span class="n">OVS_PACKET_CMD_ACTION</span><span class="p">,</span>  <span class="cm">/* OVS_ACTION_ATTR_USERSPACE action. */</span>

	<span class="cm">/* Userspace commands. */</span>
	<span class="n">OVS_PACKET_CMD_EXECUTE</span>  <span class="cm">/* Apply actions to a packet. */</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_packet_attr - attributes for %OVS_PACKET_* commands.</span>
<span class="cm"> * @OVS_PACKET_ATTR_PACKET: Present for all notifications.  Contains the entire</span>
<span class="cm"> * packet as received, from the start of the Ethernet header onward.  For</span>
<span class="cm"> * %OVS_PACKET_CMD_ACTION, %OVS_PACKET_ATTR_PACKET reflects changes made by</span>
<span class="cm"> * actions preceding %OVS_ACTION_ATTR_USERSPACE, but %OVS_PACKET_ATTR_KEY is</span>
<span class="cm"> * the flow key extracted from the packet as originally received.</span>
<span class="cm"> * @OVS_PACKET_ATTR_KEY: Present for all notifications.  Contains the flow key</span>
<span class="cm"> * extracted from the packet as nested %OVS_KEY_ATTR_* attributes.  This allows</span>
<span class="cm"> * userspace to adapt its flow setup strategy by comparing its notion of the</span>
<span class="cm"> * flow key against the kernel&#39;s.</span>
<span class="cm"> * @OVS_PACKET_ATTR_ACTIONS: Contains actions for the packet.  Used</span>
<span class="cm"> * for %OVS_PACKET_CMD_EXECUTE.  It has nested %OVS_ACTION_ATTR_* attributes.</span>
<span class="cm"> * @OVS_PACKET_ATTR_USERDATA: Present for an %OVS_PACKET_CMD_ACTION</span>
<span class="cm"> * notification if the %OVS_ACTION_ATTR_USERSPACE action specified an</span>
<span class="cm"> * %OVS_USERSPACE_ATTR_USERDATA attribute.</span>
<span class="cm"> *</span>
<span class="cm"> * These attributes follow the &amp;struct ovs_header within the Generic Netlink</span>
<span class="cm"> * payload for %OVS_PACKET_* commands.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ovs_packet_attr</span> <span class="p">{</span>
	<span class="n">OVS_PACKET_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_PACKET_ATTR_PACKET</span><span class="p">,</span>      <span class="cm">/* Packet data. */</span>
	<span class="n">OVS_PACKET_ATTR_KEY</span><span class="p">,</span>         <span class="cm">/* Nested OVS_KEY_ATTR_* attributes. */</span>
	<span class="n">OVS_PACKET_ATTR_ACTIONS</span><span class="p">,</span>     <span class="cm">/* Nested OVS_ACTION_ATTR_* attributes. */</span>
	<span class="n">OVS_PACKET_ATTR_USERDATA</span><span class="p">,</span>    <span class="cm">/* u64 OVS_ACTION_ATTR_USERSPACE arg. */</span>
	<span class="n">__OVS_PACKET_ATTR_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_PACKET_ATTR_MAX (__OVS_PACKET_ATTR_MAX - 1)</span>

<span class="cm">/* Virtual ports. */</span>

<span class="cp">#define OVS_VPORT_FAMILY  &quot;ovs_vport&quot;</span>
<span class="cp">#define OVS_VPORT_MCGROUP &quot;ovs_vport&quot;</span>
<span class="cp">#define OVS_VPORT_VERSION 0x1</span>

<span class="k">enum</span> <span class="n">ovs_vport_cmd</span> <span class="p">{</span>
	<span class="n">OVS_VPORT_CMD_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_VPORT_CMD_NEW</span><span class="p">,</span>
	<span class="n">OVS_VPORT_CMD_DEL</span><span class="p">,</span>
	<span class="n">OVS_VPORT_CMD_GET</span><span class="p">,</span>
	<span class="n">OVS_VPORT_CMD_SET</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ovs_vport_type</span> <span class="p">{</span>
	<span class="n">OVS_VPORT_TYPE_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_VPORT_TYPE_NETDEV</span><span class="p">,</span>   <span class="cm">/* network device */</span>
	<span class="n">OVS_VPORT_TYPE_INTERNAL</span><span class="p">,</span> <span class="cm">/* network device implemented by datapath */</span>
	<span class="n">__OVS_VPORT_TYPE_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_VPORT_TYPE_MAX (__OVS_VPORT_TYPE_MAX - 1)</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_vport_attr - attributes for %OVS_VPORT_* commands.</span>
<span class="cm"> * @OVS_VPORT_ATTR_PORT_NO: 32-bit port number within datapath.</span>
<span class="cm"> * @OVS_VPORT_ATTR_TYPE: 32-bit %OVS_VPORT_TYPE_* constant describing the type</span>
<span class="cm"> * of vport.</span>
<span class="cm"> * @OVS_VPORT_ATTR_NAME: Name of vport.  For a vport based on a network device</span>
<span class="cm"> * this is the name of the network device.  Maximum length %IFNAMSIZ-1 bytes</span>
<span class="cm"> * plus a null terminator.</span>
<span class="cm"> * @OVS_VPORT_ATTR_OPTIONS: Vport-specific configuration information.</span>
<span class="cm"> * @OVS_VPORT_ATTR_UPCALL_PID: The Netlink socket in userspace that</span>
<span class="cm"> * OVS_PACKET_CMD_MISS upcalls will be directed to for packets received on</span>
<span class="cm"> * this port.  A value of zero indicates that upcalls should not be sent.</span>
<span class="cm"> * @OVS_VPORT_ATTR_STATS: A &amp;struct ovs_vport_stats giving statistics for</span>
<span class="cm"> * packets sent or received through the vport.</span>
<span class="cm"> *</span>
<span class="cm"> * These attributes follow the &amp;struct ovs_header within the Generic Netlink</span>
<span class="cm"> * payload for %OVS_VPORT_* commands.</span>
<span class="cm"> *</span>
<span class="cm"> * For %OVS_VPORT_CMD_NEW requests, the %OVS_VPORT_ATTR_TYPE and</span>
<span class="cm"> * %OVS_VPORT_ATTR_NAME attributes are required.  %OVS_VPORT_ATTR_PORT_NO is</span>
<span class="cm"> * optional; if not specified a free port number is automatically selected.</span>
<span class="cm"> * Whether %OVS_VPORT_ATTR_OPTIONS is required or optional depends on the type</span>
<span class="cm"> * of vport.</span>
<span class="cm"> * and other attributes are ignored.</span>
<span class="cm"> *</span>
<span class="cm"> * For other requests, if %OVS_VPORT_ATTR_NAME is specified then it is used to</span>
<span class="cm"> * look up the vport to operate on; otherwise dp_idx from the &amp;struct</span>
<span class="cm"> * ovs_header plus %OVS_VPORT_ATTR_PORT_NO determine the vport.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ovs_vport_attr</span> <span class="p">{</span>
	<span class="n">OVS_VPORT_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_VPORT_ATTR_PORT_NO</span><span class="p">,</span>	<span class="cm">/* u32 port number within datapath */</span>
	<span class="n">OVS_VPORT_ATTR_TYPE</span><span class="p">,</span>	<span class="cm">/* u32 OVS_VPORT_TYPE_* constant. */</span>
	<span class="n">OVS_VPORT_ATTR_NAME</span><span class="p">,</span>	<span class="cm">/* string name, up to IFNAMSIZ bytes long */</span>
	<span class="n">OVS_VPORT_ATTR_OPTIONS</span><span class="p">,</span> <span class="cm">/* nested attributes, varies by vport type */</span>
	<span class="n">OVS_VPORT_ATTR_UPCALL_PID</span><span class="p">,</span> <span class="cm">/* u32 Netlink PID to receive upcalls */</span>
	<span class="n">OVS_VPORT_ATTR_STATS</span><span class="p">,</span>	<span class="cm">/* struct ovs_vport_stats */</span>
	<span class="n">__OVS_VPORT_ATTR_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_VPORT_ATTR_MAX (__OVS_VPORT_ATTR_MAX - 1)</span>

<span class="cm">/* Flows. */</span>

<span class="cp">#define OVS_FLOW_FAMILY  &quot;ovs_flow&quot;</span>
<span class="cp">#define OVS_FLOW_MCGROUP &quot;ovs_flow&quot;</span>
<span class="cp">#define OVS_FLOW_VERSION 0x1</span>

<span class="k">enum</span> <span class="n">ovs_flow_cmd</span> <span class="p">{</span>
	<span class="n">OVS_FLOW_CMD_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_FLOW_CMD_NEW</span><span class="p">,</span>
	<span class="n">OVS_FLOW_CMD_DEL</span><span class="p">,</span>
	<span class="n">OVS_FLOW_CMD_GET</span><span class="p">,</span>
	<span class="n">OVS_FLOW_CMD_SET</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_flow_stats</span> <span class="p">{</span>
	<span class="n">__u64</span> <span class="n">n_packets</span><span class="p">;</span>         <span class="cm">/* Number of matched packets. */</span>
	<span class="n">__u64</span> <span class="n">n_bytes</span><span class="p">;</span>           <span class="cm">/* Number of matched bytes. */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ovs_key_attr</span> <span class="p">{</span>
	<span class="n">OVS_KEY_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_KEY_ATTR_ENCAP</span><span class="p">,</span>	<span class="cm">/* Nested set of encapsulated attributes. */</span>
	<span class="n">OVS_KEY_ATTR_PRIORITY</span><span class="p">,</span>  <span class="cm">/* u32 skb-&gt;priority */</span>
	<span class="n">OVS_KEY_ATTR_IN_PORT</span><span class="p">,</span>   <span class="cm">/* u32 OVS dp port number */</span>
	<span class="n">OVS_KEY_ATTR_ETHERNET</span><span class="p">,</span>  <span class="cm">/* struct ovs_key_ethernet */</span>
	<span class="n">OVS_KEY_ATTR_VLAN</span><span class="p">,</span>	<span class="cm">/* be16 VLAN TCI */</span>
	<span class="n">OVS_KEY_ATTR_ETHERTYPE</span><span class="p">,</span>	<span class="cm">/* be16 Ethernet type */</span>
	<span class="n">OVS_KEY_ATTR_IPV4</span><span class="p">,</span>      <span class="cm">/* struct ovs_key_ipv4 */</span>
	<span class="n">OVS_KEY_ATTR_IPV6</span><span class="p">,</span>      <span class="cm">/* struct ovs_key_ipv6 */</span>
	<span class="n">OVS_KEY_ATTR_TCP</span><span class="p">,</span>       <span class="cm">/* struct ovs_key_tcp */</span>
	<span class="n">OVS_KEY_ATTR_UDP</span><span class="p">,</span>       <span class="cm">/* struct ovs_key_udp */</span>
	<span class="n">OVS_KEY_ATTR_ICMP</span><span class="p">,</span>      <span class="cm">/* struct ovs_key_icmp */</span>
	<span class="n">OVS_KEY_ATTR_ICMPV6</span><span class="p">,</span>    <span class="cm">/* struct ovs_key_icmpv6 */</span>
	<span class="n">OVS_KEY_ATTR_ARP</span><span class="p">,</span>       <span class="cm">/* struct ovs_key_arp */</span>
	<span class="n">OVS_KEY_ATTR_ND</span><span class="p">,</span>        <span class="cm">/* struct ovs_key_nd */</span>
	<span class="n">__OVS_KEY_ATTR_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_KEY_ATTR_MAX (__OVS_KEY_ATTR_MAX - 1)</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_frag_type - IPv4 and IPv6 fragment type</span>
<span class="cm"> * @OVS_FRAG_TYPE_NONE: Packet is not a fragment.</span>
<span class="cm"> * @OVS_FRAG_TYPE_FIRST: Packet is a fragment with offset 0.</span>
<span class="cm"> * @OVS_FRAG_TYPE_LATER: Packet is a fragment with nonzero offset.</span>
<span class="cm"> *</span>
<span class="cm"> * Used as the @ipv4_frag in &amp;struct ovs_key_ipv4 and as @ipv6_frag &amp;struct</span>
<span class="cm"> * ovs_key_ipv6.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ovs_frag_type</span> <span class="p">{</span>
	<span class="n">OVS_FRAG_TYPE_NONE</span><span class="p">,</span>
	<span class="n">OVS_FRAG_TYPE_FIRST</span><span class="p">,</span>
	<span class="n">OVS_FRAG_TYPE_LATER</span><span class="p">,</span>
	<span class="n">__OVS_FRAG_TYPE_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_FRAG_TYPE_MAX (__OVS_FRAG_TYPE_MAX - 1)</span>

<span class="k">struct</span> <span class="n">ovs_key_ethernet</span> <span class="p">{</span>
	<span class="n">__u8</span>	 <span class="n">eth_src</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__u8</span>	 <span class="n">eth_dst</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_ipv4</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">ipv4_src</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">ipv4_dst</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">ipv4_proto</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">ipv4_tos</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">ipv4_ttl</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">ipv4_frag</span><span class="p">;</span>	<span class="cm">/* One of OVS_FRAG_TYPE_*. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_ipv6</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">ipv6_src</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">__be32</span> <span class="n">ipv6_dst</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">__be32</span> <span class="n">ipv6_label</span><span class="p">;</span>	<span class="cm">/* 20-bits in least-significant bits. */</span>
	<span class="n">__u8</span>   <span class="n">ipv6_proto</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">ipv6_tclass</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">ipv6_hlimit</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">ipv6_frag</span><span class="p">;</span>	<span class="cm">/* One of OVS_FRAG_TYPE_*. */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_tcp</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">tcp_src</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">tcp_dst</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_udp</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">udp_src</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">udp_dst</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_icmp</span> <span class="p">{</span>
	<span class="n">__u8</span> <span class="n">icmp_type</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">icmp_code</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_icmpv6</span> <span class="p">{</span>
	<span class="n">__u8</span> <span class="n">icmpv6_type</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">icmpv6_code</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_arp</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">arp_sip</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">arp_tip</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">arp_op</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">arp_sha</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__u8</span>   <span class="n">arp_tha</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ovs_key_nd</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">nd_target</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">__u8</span>  <span class="n">nd_sll</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__u8</span>  <span class="n">nd_tll</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_flow_attr - attributes for %OVS_FLOW_* commands.</span>
<span class="cm"> * @OVS_FLOW_ATTR_KEY: Nested %OVS_KEY_ATTR_* attributes specifying the flow</span>
<span class="cm"> * key.  Always present in notifications.  Required for all requests (except</span>
<span class="cm"> * dumps).</span>
<span class="cm"> * @OVS_FLOW_ATTR_ACTIONS: Nested %OVS_ACTION_ATTR_* attributes specifying</span>
<span class="cm"> * the actions to take for packets that match the key.  Always present in</span>
<span class="cm"> * notifications.  Required for %OVS_FLOW_CMD_NEW requests, optional for</span>
<span class="cm"> * %OVS_FLOW_CMD_SET requests.</span>
<span class="cm"> * @OVS_FLOW_ATTR_STATS: &amp;struct ovs_flow_stats giving statistics for this</span>
<span class="cm"> * flow.  Present in notifications if the stats would be nonzero.  Ignored in</span>
<span class="cm"> * requests.</span>
<span class="cm"> * @OVS_FLOW_ATTR_TCP_FLAGS: An 8-bit value giving the OR&#39;d value of all of the</span>
<span class="cm"> * TCP flags seen on packets in this flow.  Only present in notifications for</span>
<span class="cm"> * TCP flows, and only if it would be nonzero.  Ignored in requests.</span>
<span class="cm"> * @OVS_FLOW_ATTR_USED: A 64-bit integer giving the time, in milliseconds on</span>
<span class="cm"> * the system monotonic clock, at which a packet was last processed for this</span>
<span class="cm"> * flow.  Only present in notifications if a packet has been processed for this</span>
<span class="cm"> * flow.  Ignored in requests.</span>
<span class="cm"> * @OVS_FLOW_ATTR_CLEAR: If present in a %OVS_FLOW_CMD_SET request, clears the</span>
<span class="cm"> * last-used time, accumulated TCP flags, and statistics for this flow.</span>
<span class="cm"> * Otherwise ignored in requests.  Never present in notifications.</span>
<span class="cm"> *</span>
<span class="cm"> * These attributes follow the &amp;struct ovs_header within the Generic Netlink</span>
<span class="cm"> * payload for %OVS_FLOW_* commands.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ovs_flow_attr</span> <span class="p">{</span>
	<span class="n">OVS_FLOW_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_FLOW_ATTR_KEY</span><span class="p">,</span>       <span class="cm">/* Sequence of OVS_KEY_ATTR_* attributes. */</span>
	<span class="n">OVS_FLOW_ATTR_ACTIONS</span><span class="p">,</span>   <span class="cm">/* Nested OVS_ACTION_ATTR_* attributes. */</span>
	<span class="n">OVS_FLOW_ATTR_STATS</span><span class="p">,</span>     <span class="cm">/* struct ovs_flow_stats. */</span>
	<span class="n">OVS_FLOW_ATTR_TCP_FLAGS</span><span class="p">,</span> <span class="cm">/* 8-bit OR&#39;d TCP flags. */</span>
	<span class="n">OVS_FLOW_ATTR_USED</span><span class="p">,</span>      <span class="cm">/* u64 msecs last used in monotonic time. */</span>
	<span class="n">OVS_FLOW_ATTR_CLEAR</span><span class="p">,</span>     <span class="cm">/* Flag to clear stats, tcp_flags, used. */</span>
	<span class="n">__OVS_FLOW_ATTR_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_FLOW_ATTR_MAX (__OVS_FLOW_ATTR_MAX - 1)</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_sample_attr - Attributes for %OVS_ACTION_ATTR_SAMPLE action.</span>
<span class="cm"> * @OVS_SAMPLE_ATTR_PROBABILITY: 32-bit fraction of packets to sample with</span>
<span class="cm"> * @OVS_ACTION_ATTR_SAMPLE.  A value of 0 samples no packets, a value of</span>
<span class="cm"> * %UINT32_MAX samples all packets and intermediate values sample intermediate</span>
<span class="cm"> * fractions of packets.</span>
<span class="cm"> * @OVS_SAMPLE_ATTR_ACTIONS: Set of actions to execute in sampling event.</span>
<span class="cm"> * Actions are passed as nested attributes.</span>
<span class="cm"> *</span>
<span class="cm"> * Executes the specified actions with the given probability on a per-packet</span>
<span class="cm"> * basis.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ovs_sample_attr</span> <span class="p">{</span>
	<span class="n">OVS_SAMPLE_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_SAMPLE_ATTR_PROBABILITY</span><span class="p">,</span> <span class="cm">/* u32 number */</span>
	<span class="n">OVS_SAMPLE_ATTR_ACTIONS</span><span class="p">,</span>     <span class="cm">/* Nested OVS_ACTION_ATTR_* attributes. */</span>
	<span class="n">__OVS_SAMPLE_ATTR_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define OVS_SAMPLE_ATTR_MAX (__OVS_SAMPLE_ATTR_MAX - 1)</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_userspace_attr - Attributes for %OVS_ACTION_ATTR_USERSPACE action.</span>
<span class="cm"> * @OVS_USERSPACE_ATTR_PID: u32 Netlink PID to which the %OVS_PACKET_CMD_ACTION</span>
<span class="cm"> * message should be sent.  Required.</span>
<span class="cm"> * @OVS_USERSPACE_ATTR_USERDATA: If present, its u64 argument is copied to the</span>
<span class="cm"> * %OVS_PACKET_CMD_ACTION message as %OVS_PACKET_ATTR_USERDATA,</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ovs_userspace_attr</span> <span class="p">{</span>
	<span class="n">OVS_USERSPACE_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_USERSPACE_ATTR_PID</span><span class="p">,</span>	      <span class="cm">/* u32 Netlink PID to receive upcalls. */</span>
	<span class="n">OVS_USERSPACE_ATTR_USERDATA</span><span class="p">,</span>  <span class="cm">/* u64 optional user-specified cookie. */</span>
	<span class="n">__OVS_USERSPACE_ATTR_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_USERSPACE_ATTR_MAX (__OVS_USERSPACE_ATTR_MAX - 1)</span>

<span class="cm">/**</span>
<span class="cm"> * struct ovs_action_push_vlan - %OVS_ACTION_ATTR_PUSH_VLAN action argument.</span>
<span class="cm"> * @vlan_tpid: Tag protocol identifier (TPID) to push.</span>
<span class="cm"> * @vlan_tci: Tag control identifier (TCI) to push.  The CFI bit must be set</span>
<span class="cm"> * (but it will not be set in the 802.1Q header that is pushed).</span>
<span class="cm"> *</span>
<span class="cm"> * The @vlan_tpid value is typically %ETH_P_8021Q.  The only acceptable TPID</span>
<span class="cm"> * values are those that the kernel module also parses as 802.1Q headers, to</span>
<span class="cm"> * prevent %OVS_ACTION_ATTR_PUSH_VLAN followed by %OVS_ACTION_ATTR_POP_VLAN</span>
<span class="cm"> * from having surprising results.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ovs_action_push_vlan</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">vlan_tpid</span><span class="p">;</span>	<span class="cm">/* 802.1Q TPID. */</span>
	<span class="n">__be16</span> <span class="n">vlan_tci</span><span class="p">;</span>	<span class="cm">/* 802.1Q TCI (VLAN ID and priority). */</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * enum ovs_action_attr - Action types.</span>
<span class="cm"> *</span>
<span class="cm"> * @OVS_ACTION_ATTR_OUTPUT: Output packet to port.</span>
<span class="cm"> * @OVS_ACTION_ATTR_USERSPACE: Send packet to userspace according to nested</span>
<span class="cm"> * %OVS_USERSPACE_ATTR_* attributes.</span>
<span class="cm"> * @OVS_ACTION_ATTR_SET: Replaces the contents of an existing header.  The</span>
<span class="cm"> * single nested %OVS_KEY_ATTR_* attribute specifies a header to modify and its</span>
<span class="cm"> * value.</span>
<span class="cm"> * @OVS_ACTION_ATTR_PUSH_VLAN: Push a new outermost 802.1Q header onto the</span>
<span class="cm"> * packet.</span>
<span class="cm"> * @OVS_ACTION_ATTR_POP_VLAN: Pop the outermost 802.1Q header off the packet.</span>
<span class="cm"> * @OVS_ACTION_ATTR_SAMPLE: Probabilitically executes actions, as specified in</span>
<span class="cm"> * the nested %OVS_SAMPLE_ATTR_* attributes.</span>
<span class="cm"> *</span>
<span class="cm"> * Only a single header can be set with a single %OVS_ACTION_ATTR_SET.  Not all</span>
<span class="cm"> * fields within a header are modifiable, e.g. the IPv4 protocol and fragment</span>
<span class="cm"> * type may not be changed.</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">ovs_action_attr</span> <span class="p">{</span>
	<span class="n">OVS_ACTION_ATTR_UNSPEC</span><span class="p">,</span>
	<span class="n">OVS_ACTION_ATTR_OUTPUT</span><span class="p">,</span>	      <span class="cm">/* u32 port number. */</span>
	<span class="n">OVS_ACTION_ATTR_USERSPACE</span><span class="p">,</span>    <span class="cm">/* Nested OVS_USERSPACE_ATTR_*. */</span>
	<span class="n">OVS_ACTION_ATTR_SET</span><span class="p">,</span>          <span class="cm">/* One nested OVS_KEY_ATTR_*. */</span>
	<span class="n">OVS_ACTION_ATTR_PUSH_VLAN</span><span class="p">,</span>    <span class="cm">/* struct ovs_action_push_vlan. */</span>
	<span class="n">OVS_ACTION_ATTR_POP_VLAN</span><span class="p">,</span>     <span class="cm">/* No argument. */</span>
	<span class="n">OVS_ACTION_ATTR_SAMPLE</span><span class="p">,</span>       <span class="cm">/* Nested OVS_SAMPLE_ATTR_*. */</span>
	<span class="n">__OVS_ACTION_ATTR_MAX</span>
<span class="p">};</span>

<span class="cp">#define OVS_ACTION_ATTR_MAX (__OVS_ACTION_ATTR_MAX - 1)</span>

<span class="cp">#endif </span><span class="cm">/* _LINUX_OPENVSWITCH_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
