<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › mtio.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>mtio.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* </span>
<span class="cm"> * linux/mtio.h header file for Linux. Written by H. Bergman</span>
<span class="cm"> *</span>
<span class="cm"> * Modified for special ioctls provided by zftape in September 1997</span>
<span class="cm"> * by C.-J. Heine.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_MTIO_H</span>
<span class="cp">#define _LINUX_MTIO_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/ioctl.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Structures and definitions for mag tape io control commands</span>
<span class="cm"> */</span>

<span class="cm">/* structure for MTIOCTOP - mag tape op command */</span>
<span class="k">struct</span>	<span class="n">mtop</span> <span class="p">{</span>
	<span class="kt">short</span>	<span class="n">mt_op</span><span class="p">;</span>		<span class="cm">/* operations defined below */</span>
	<span class="kt">int</span>	<span class="n">mt_count</span><span class="p">;</span>	<span class="cm">/* how many of them */</span>
<span class="p">};</span>

<span class="cm">/* Magnetic Tape operations [Not all operations supported by all drivers]: */</span>
<span class="cp">#define MTRESET 0	</span><span class="cm">/* +reset drive in case of problems */</span><span class="cp"></span>
<span class="cp">#define MTFSF	1	</span><span class="cm">/* forward space over FileMark,</span>
<span class="cm">			 * position at first record of next file </span>
<span class="cm">			 */</span><span class="cp"></span>
<span class="cp">#define MTBSF	2	</span><span class="cm">/* backward space FileMark (position before FM) */</span><span class="cp"></span>
<span class="cp">#define MTFSR	3	</span><span class="cm">/* forward space record */</span><span class="cp"></span>
<span class="cp">#define MTBSR	4	</span><span class="cm">/* backward space record */</span><span class="cp"></span>
<span class="cp">#define MTWEOF	5	</span><span class="cm">/* write an end-of-file record (mark) */</span><span class="cp"></span>
<span class="cp">#define MTREW	6	</span><span class="cm">/* rewind */</span><span class="cp"></span>
<span class="cp">#define MTOFFL	7	</span><span class="cm">/* rewind and put the drive offline (eject?) */</span><span class="cp"></span>
<span class="cp">#define MTNOP	8	</span><span class="cm">/* no op, set status only (read with MTIOCGET) */</span><span class="cp"></span>
<span class="cp">#define MTRETEN 9	</span><span class="cm">/* retension tape */</span><span class="cp"></span>
<span class="cp">#define MTBSFM	10	</span><span class="cm">/* +backward space FileMark, position at FM */</span><span class="cp"></span>
<span class="cp">#define MTFSFM  11	</span><span class="cm">/* +forward space FileMark, position at FM */</span><span class="cp"></span>
<span class="cp">#define MTEOM	12	</span><span class="cm">/* goto end of recorded media (for appending files).</span>
<span class="cm">			 * MTEOM positions after the last FM, ready for</span>
<span class="cm">			 * appending another file.</span>
<span class="cm">			 */</span><span class="cp"></span>
<span class="cp">#define MTERASE 13	</span><span class="cm">/* erase tape -- be careful! */</span><span class="cp"></span>

<span class="cp">#define MTRAS1  14	</span><span class="cm">/* run self test 1 (nondestructive) */</span><span class="cp"></span>
<span class="cp">#define MTRAS2	15	</span><span class="cm">/* run self test 2 (destructive) */</span><span class="cp"></span>
<span class="cp">#define MTRAS3  16	</span><span class="cm">/* reserved for self test 3 */</span><span class="cp"></span>

<span class="cp">#define MTSETBLK 20	</span><span class="cm">/* set block length (SCSI) */</span><span class="cp"></span>
<span class="cp">#define MTSETDENSITY 21	</span><span class="cm">/* set tape density (SCSI) */</span><span class="cp"></span>
<span class="cp">#define MTSEEK	22	</span><span class="cm">/* seek to block (Tandberg, etc.) */</span><span class="cp"></span>
<span class="cp">#define MTTELL	23	</span><span class="cm">/* tell block (Tandberg, etc.) */</span><span class="cp"></span>
<span class="cp">#define MTSETDRVBUFFER 24 </span><span class="cm">/* set the drive buffering according to SCSI-2 */</span><span class="cp"></span>
			<span class="cm">/* ordinary buffered operation with code 1 */</span>
<span class="cp">#define MTFSS	25	</span><span class="cm">/* space forward over setmarks */</span><span class="cp"></span>
<span class="cp">#define MTBSS	26	</span><span class="cm">/* space backward over setmarks */</span><span class="cp"></span>
<span class="cp">#define MTWSM	27	</span><span class="cm">/* write setmarks */</span><span class="cp"></span>

<span class="cp">#define MTLOCK  28	</span><span class="cm">/* lock the drive door */</span><span class="cp"></span>
<span class="cp">#define MTUNLOCK 29	</span><span class="cm">/* unlock the drive door */</span><span class="cp"></span>
<span class="cp">#define MTLOAD  30	</span><span class="cm">/* execute the SCSI load command */</span><span class="cp"></span>
<span class="cp">#define MTUNLOAD 31	</span><span class="cm">/* execute the SCSI unload command */</span><span class="cp"></span>
<span class="cp">#define MTCOMPRESSION 32</span><span class="cm">/* control compression with SCSI mode page 15 */</span><span class="cp"></span>
<span class="cp">#define MTSETPART 33	</span><span class="cm">/* Change the active tape partition */</span><span class="cp"></span>
<span class="cp">#define MTMKPART  34	</span><span class="cm">/* Format the tape with one or two partitions */</span><span class="cp"></span>
<span class="cp">#define MTWEOFI	35	</span><span class="cm">/* write an end-of-file record (mark) in immediate mode */</span><span class="cp"></span>

<span class="cm">/* structure for MTIOCGET - mag tape get status command */</span>

<span class="k">struct</span>	<span class="n">mtget</span> <span class="p">{</span>
	<span class="kt">long</span>	<span class="n">mt_type</span><span class="p">;</span>	<span class="cm">/* type of magtape device */</span>
	<span class="kt">long</span>	<span class="n">mt_resid</span><span class="p">;</span>	<span class="cm">/* residual count: (not sure)</span>
<span class="cm">				 *	number of bytes ignored, or</span>
<span class="cm">				 *	number of files not skipped, or</span>
<span class="cm">				 *	number of records not skipped.</span>
<span class="cm">				 */</span>
	<span class="cm">/* the following registers are device dependent */</span>
	<span class="kt">long</span>	<span class="n">mt_dsreg</span><span class="p">;</span>	<span class="cm">/* status register */</span>
	<span class="kt">long</span>	<span class="n">mt_gstat</span><span class="p">;</span>	<span class="cm">/* generic (device independent) status */</span>
	<span class="kt">long</span>	<span class="n">mt_erreg</span><span class="p">;</span>	<span class="cm">/* error register */</span>
	<span class="cm">/* The next two fields are not always used */</span>
	<span class="n">__kernel_daddr_t</span> <span class="n">mt_fileno</span><span class="p">;</span>	<span class="cm">/* number of current file on tape */</span>
	<span class="n">__kernel_daddr_t</span> <span class="n">mt_blkno</span><span class="p">;</span>	<span class="cm">/* current block number */</span>
<span class="p">};</span>



<span class="cm">/*</span>
<span class="cm"> * Constants for mt_type. Not all of these are supported,</span>
<span class="cm"> * and these are not all of the ones that are supported.</span>
<span class="cm"> */</span>
<span class="cp">#define MT_ISUNKNOWN		0x01</span>
<span class="cp">#define MT_ISQIC02		0x02	</span><span class="cm">/* Generic QIC-02 tape streamer */</span><span class="cp"></span>
<span class="cp">#define MT_ISWT5150		0x03	</span><span class="cm">/* Wangtek 5150EQ, QIC-150, QIC-02 */</span><span class="cp"></span>
<span class="cp">#define MT_ISARCHIVE_5945L2	0x04	</span><span class="cm">/* Archive 5945L-2, QIC-24, QIC-02? */</span><span class="cp"></span>
<span class="cp">#define MT_ISCMSJ500		0x05	</span><span class="cm">/* CMS Jumbo 500 (QIC-02?) */</span><span class="cp"></span>
<span class="cp">#define MT_ISTDC3610		0x06	</span><span class="cm">/* Tandberg 6310, QIC-24 */</span><span class="cp"></span>
<span class="cp">#define MT_ISARCHIVE_VP60I	0x07	</span><span class="cm">/* Archive VP60i, QIC-02 */</span><span class="cp"></span>
<span class="cp">#define MT_ISARCHIVE_2150L	0x08	</span><span class="cm">/* Archive Viper 2150L */</span><span class="cp"></span>
<span class="cp">#define MT_ISARCHIVE_2060L	0x09	</span><span class="cm">/* Archive Viper 2060L */</span><span class="cp"></span>
<span class="cp">#define MT_ISARCHIVESC499	0x0A	</span><span class="cm">/* Archive SC-499 QIC-36 controller */</span><span class="cp"></span>
<span class="cp">#define MT_ISQIC02_ALL_FEATURES	0x0F	</span><span class="cm">/* Generic QIC-02 with all features */</span><span class="cp"></span>
<span class="cp">#define MT_ISWT5099EEN24	0x11	</span><span class="cm">/* Wangtek 5099-een24, 60MB, QIC-24 */</span><span class="cp"></span>
<span class="cp">#define MT_ISTEAC_MT2ST		0x12	</span><span class="cm">/* Teac MT-2ST 155mb drive, Teac DC-1 card (Wangtek type) */</span><span class="cp"></span>
<span class="cp">#define MT_ISEVEREX_FT40A	0x32	</span><span class="cm">/* Everex FT40A (QIC-40) */</span><span class="cp"></span>
<span class="cp">#define MT_ISDDS1		0x51	</span><span class="cm">/* DDS device without partitions */</span><span class="cp"></span>
<span class="cp">#define MT_ISDDS2		0x52	</span><span class="cm">/* DDS device with partitions */</span><span class="cp"></span>
<span class="cp">#define MT_ISONSTREAM_SC        0x61   </span><span class="cm">/* OnStream SCSI tape drives (SC-x0)</span>
<span class="cm">					  and SCSI emulated (DI, DP, USB) */</span><span class="cp"></span>
<span class="cp">#define MT_ISSCSI1		0x71	</span><span class="cm">/* Generic ANSI SCSI-1 tape unit */</span><span class="cp"></span>
<span class="cp">#define MT_ISSCSI2		0x72	</span><span class="cm">/* Generic ANSI SCSI-2 tape unit */</span><span class="cp"></span>

<span class="cm">/* QIC-40/80/3010/3020 ftape supported drives.</span>
<span class="cm"> * 20bit vendor ID + 0x800000 (see ftape-vendors.h)</span>
<span class="cm"> */</span>
<span class="cp">#define MT_ISFTAPE_UNKNOWN	0x800000 </span><span class="cm">/* obsolete */</span><span class="cp"></span>
<span class="cp">#define MT_ISFTAPE_FLAG	0x800000</span>


<span class="cm">/* structure for MTIOCPOS - mag tape get position command */</span>

<span class="k">struct</span>	<span class="n">mtpos</span> <span class="p">{</span>
	<span class="kt">long</span> 	<span class="n">mt_blkno</span><span class="p">;</span>	<span class="cm">/* current block number */</span>
<span class="p">};</span>


<span class="cm">/* mag tape io control commands */</span>
<span class="cp">#define	MTIOCTOP	_IOW(&#39;m&#39;, 1, struct mtop)	</span><span class="cm">/* do a mag tape op */</span><span class="cp"></span>
<span class="cp">#define	MTIOCGET	_IOR(&#39;m&#39;, 2, struct mtget)	</span><span class="cm">/* get tape status */</span><span class="cp"></span>
<span class="cp">#define	MTIOCPOS	_IOR(&#39;m&#39;, 3, struct mtpos)	</span><span class="cm">/* get tape position */</span><span class="cp"></span>


<span class="cm">/* Generic Mag Tape (device independent) status macros for examining</span>
<span class="cm"> * mt_gstat -- HP-UX compatible.</span>
<span class="cm"> * There is room for more generic status bits here, but I don&#39;t</span>
<span class="cm"> * know which of them are reserved. At least three or so should</span>
<span class="cm"> * be added to make this really useful.</span>
<span class="cm"> */</span>
<span class="cp">#define GMT_EOF(x)              ((x) &amp; 0x80000000)</span>
<span class="cp">#define GMT_BOT(x)              ((x) &amp; 0x40000000)</span>
<span class="cp">#define GMT_EOT(x)              ((x) &amp; 0x20000000)</span>
<span class="cp">#define GMT_SM(x)               ((x) &amp; 0x10000000)  </span><span class="cm">/* DDS setmark */</span><span class="cp"></span>
<span class="cp">#define GMT_EOD(x)              ((x) &amp; 0x08000000)  </span><span class="cm">/* DDS EOD */</span><span class="cp"></span>
<span class="cp">#define GMT_WR_PROT(x)          ((x) &amp; 0x04000000)</span>
<span class="cm">/* #define GMT_ ? 		((x) &amp; 0x02000000) */</span>
<span class="cp">#define GMT_ONLINE(x)           ((x) &amp; 0x01000000)</span>
<span class="cp">#define GMT_D_6250(x)           ((x) &amp; 0x00800000)</span>
<span class="cp">#define GMT_D_1600(x)           ((x) &amp; 0x00400000)</span>
<span class="cp">#define GMT_D_800(x)            ((x) &amp; 0x00200000)</span>
<span class="cm">/* #define GMT_ ? 		((x) &amp; 0x00100000) */</span>
<span class="cm">/* #define GMT_ ? 		((x) &amp; 0x00080000) */</span>
<span class="cp">#define GMT_DR_OPEN(x)          ((x) &amp; 0x00040000)  </span><span class="cm">/* door open (no tape) */</span><span class="cp"></span>
<span class="cm">/* #define GMT_ ? 		((x) &amp; 0x00020000) */</span>
<span class="cp">#define GMT_IM_REP_EN(x)        ((x) &amp; 0x00010000)  </span><span class="cm">/* immediate report mode */</span><span class="cp"></span>
<span class="cp">#define GMT_CLN(x)              ((x) &amp; 0x00008000)  </span><span class="cm">/* cleaning requested */</span><span class="cp"></span>
<span class="cm">/* 15 generic status bits unused */</span>


<span class="cm">/* SCSI-tape specific definitions */</span>
<span class="cm">/* Bitfield shifts in the status  */</span>
<span class="cp">#define MT_ST_BLKSIZE_SHIFT	0</span>
<span class="cp">#define MT_ST_BLKSIZE_MASK	0xffffff</span>
<span class="cp">#define MT_ST_DENSITY_SHIFT	24</span>
<span class="cp">#define MT_ST_DENSITY_MASK	0xff000000</span>

<span class="cp">#define MT_ST_SOFTERR_SHIFT	0</span>
<span class="cp">#define MT_ST_SOFTERR_MASK	0xffff</span>

<span class="cm">/* Bitfields for the MTSETDRVBUFFER ioctl */</span>
<span class="cp">#define MT_ST_OPTIONS		0xf0000000</span>
<span class="cp">#define MT_ST_BOOLEANS		0x10000000</span>
<span class="cp">#define MT_ST_SETBOOLEANS	0x30000000</span>
<span class="cp">#define MT_ST_CLEARBOOLEANS	0x40000000</span>
<span class="cp">#define MT_ST_WRITE_THRESHOLD	0x20000000</span>
<span class="cp">#define MT_ST_DEF_BLKSIZE	0x50000000</span>
<span class="cp">#define MT_ST_DEF_OPTIONS	0x60000000</span>
<span class="cp">#define MT_ST_TIMEOUTS		0x70000000</span>
<span class="cp">#define MT_ST_SET_TIMEOUT	(MT_ST_TIMEOUTS | 0x000000)</span>
<span class="cp">#define MT_ST_SET_LONG_TIMEOUT	(MT_ST_TIMEOUTS | 0x100000)</span>
<span class="cp">#define MT_ST_SET_CLN		0x80000000</span>

<span class="cp">#define MT_ST_BUFFER_WRITES	0x1</span>
<span class="cp">#define MT_ST_ASYNC_WRITES	0x2</span>
<span class="cp">#define MT_ST_READ_AHEAD	0x4</span>
<span class="cp">#define MT_ST_DEBUGGING		0x8</span>
<span class="cp">#define MT_ST_TWO_FM		0x10</span>
<span class="cp">#define MT_ST_FAST_MTEOM	0x20</span>
<span class="cp">#define MT_ST_AUTO_LOCK		0x40</span>
<span class="cp">#define MT_ST_DEF_WRITES	0x80</span>
<span class="cp">#define MT_ST_CAN_BSR		0x100</span>
<span class="cp">#define MT_ST_NO_BLKLIMS	0x200</span>
<span class="cp">#define MT_ST_CAN_PARTITIONS    0x400</span>
<span class="cp">#define MT_ST_SCSI2LOGICAL      0x800</span>
<span class="cp">#define MT_ST_SYSV              0x1000</span>
<span class="cp">#define MT_ST_NOWAIT            0x2000</span>
<span class="cp">#define MT_ST_SILI		0x4000</span>
<span class="cp">#define MT_ST_NOWAIT_EOF	0x8000</span>

<span class="cm">/* The mode parameters to be controlled. Parameter chosen with bits 20-28 */</span>
<span class="cp">#define MT_ST_CLEAR_DEFAULT	0xfffff</span>
<span class="cp">#define MT_ST_DEF_DENSITY	(MT_ST_DEF_OPTIONS | 0x100000)</span>
<span class="cp">#define MT_ST_DEF_COMPRESSION	(MT_ST_DEF_OPTIONS | 0x200000)</span>
<span class="cp">#define MT_ST_DEF_DRVBUFFER	(MT_ST_DEF_OPTIONS | 0x300000)</span>

<span class="cm">/* The offset for the arguments for the special HP changer load command. */</span>
<span class="cp">#define MT_ST_HPLOADER_OFFSET 10000</span>

<span class="cp">#endif </span><span class="cm">/* _LINUX_MTIO_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
