<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › usb › cdc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>cdc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * USB Communications Device Class (CDC) definitions</span>
<span class="cm"> *</span>
<span class="cm"> * CDC says how to talk to lots of different types of network adapters,</span>
<span class="cm"> * notably ethernet adapters and various modems.  It&#39;s used mostly with</span>
<span class="cm"> * firmware based USB peripherals.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __LINUX_USB_CDC_H</span>
<span class="cp">#define __LINUX_USB_CDC_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cp">#define USB_CDC_SUBCLASS_ACM			0x02</span>
<span class="cp">#define USB_CDC_SUBCLASS_ETHERNET		0x06</span>
<span class="cp">#define USB_CDC_SUBCLASS_WHCM			0x08</span>
<span class="cp">#define USB_CDC_SUBCLASS_DMM			0x09</span>
<span class="cp">#define USB_CDC_SUBCLASS_MDLM			0x0a</span>
<span class="cp">#define USB_CDC_SUBCLASS_OBEX			0x0b</span>
<span class="cp">#define USB_CDC_SUBCLASS_EEM			0x0c</span>
<span class="cp">#define USB_CDC_SUBCLASS_NCM			0x0d</span>

<span class="cp">#define USB_CDC_PROTO_NONE			0</span>

<span class="cp">#define USB_CDC_ACM_PROTO_AT_V25TER		1</span>
<span class="cp">#define USB_CDC_ACM_PROTO_AT_PCCA101		2</span>
<span class="cp">#define USB_CDC_ACM_PROTO_AT_PCCA101_WAKE	3</span>
<span class="cp">#define USB_CDC_ACM_PROTO_AT_GSM		4</span>
<span class="cp">#define USB_CDC_ACM_PROTO_AT_3G			5</span>
<span class="cp">#define USB_CDC_ACM_PROTO_AT_CDMA		6</span>
<span class="cp">#define USB_CDC_ACM_PROTO_VENDOR		0xff</span>

<span class="cp">#define USB_CDC_PROTO_EEM			7</span>

<span class="cp">#define USB_CDC_NCM_PROTO_NTB			1</span>

<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Class-Specific descriptors ... there are a couple dozen of them</span>
<span class="cm"> */</span>

<span class="cp">#define USB_CDC_HEADER_TYPE		0x00	</span><span class="cm">/* header_desc */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_CALL_MANAGEMENT_TYPE	0x01	</span><span class="cm">/* call_mgmt_descriptor */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_ACM_TYPE		0x02	</span><span class="cm">/* acm_descriptor */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_UNION_TYPE		0x06	</span><span class="cm">/* union_desc */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_COUNTRY_TYPE		0x07</span>
<span class="cp">#define USB_CDC_NETWORK_TERMINAL_TYPE	0x0a	</span><span class="cm">/* network_terminal_desc */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_ETHERNET_TYPE		0x0f	</span><span class="cm">/* ether_desc */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_WHCM_TYPE		0x11</span>
<span class="cp">#define USB_CDC_MDLM_TYPE		0x12	</span><span class="cm">/* mdlm_desc */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_MDLM_DETAIL_TYPE	0x13	</span><span class="cm">/* mdlm_detail_desc */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_DMM_TYPE		0x14</span>
<span class="cp">#define USB_CDC_OBEX_TYPE		0x15</span>
<span class="cp">#define USB_CDC_NCM_TYPE		0x1a</span>

<span class="cm">/* &quot;Header Functional Descriptor&quot; from CDC spec  5.2.3.1 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_header_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__le16</span>	<span class="n">bcdCDC</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;Call Management Descriptor&quot; from CDC spec  5.2.3.2 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_call_mgmt_descriptor</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__u8</span>	<span class="n">bmCapabilities</span><span class="p">;</span>
<span class="cp">#define USB_CDC_CALL_MGMT_CAP_CALL_MGMT		0x01</span>
<span class="cp">#define USB_CDC_CALL_MGMT_CAP_DATA_INTF		0x02</span>

	<span class="n">__u8</span>	<span class="n">bDataInterface</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;Abstract Control Management Descriptor&quot; from CDC spec  5.2.3.3 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_acm_descriptor</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__u8</span>	<span class="n">bmCapabilities</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* capabilities from 5.2.3.3 */</span>

<span class="cp">#define USB_CDC_COMM_FEATURE	0x01</span>
<span class="cp">#define USB_CDC_CAP_LINE	0x02</span>
<span class="cp">#define USB_CDC_CAP_BRK		0x04</span>
<span class="cp">#define USB_CDC_CAP_NOTIFY	0x08</span>

<span class="cm">/* &quot;Union Functional Descriptor&quot; from CDC spec 5.2.3.8 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_union_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__u8</span>	<span class="n">bMasterInterface0</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bSlaveInterface0</span><span class="p">;</span>
	<span class="cm">/* ... and there could be other slave interfaces */</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;Country Selection Functional Descriptor&quot; from CDC spec 5.2.3.9 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_country_functional_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__u8</span>	<span class="n">iCountryCodeRelDate</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wCountyCode0</span><span class="p">;</span>
	<span class="cm">/* ... and there can be a lot of country codes */</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;Network Channel Terminal Functional Descriptor&quot; from CDC spec 5.2.3.11 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_network_terminal_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__u8</span>	<span class="n">bEntityId</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">iName</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bChannelIndex</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bPhysicalInterface</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;Ethernet Networking Functional Descriptor&quot; from CDC spec 5.2.3.16 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_ether_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__u8</span>	<span class="n">iMACAddress</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">bmEthernetStatistics</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wMaxSegmentSize</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNumberMCFilters</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bNumberPowerFilters</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;Telephone Control Model Functional Descriptor&quot; from CDC WMC spec 6.3..3 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_dmm_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bFunctionLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubtype</span><span class="p">;</span>
	<span class="n">__u16</span>	<span class="n">bcdVersion</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wMaxCommand</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;MDLM Functional Descriptor&quot; from CDC WMC spec 6.7.2.3 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_mdlm_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__le16</span>	<span class="n">bcdVersion</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bGUID</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;MDLM Detail Functional Descriptor&quot; from CDC WMC spec 6.7.2.4 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_mdlm_detail_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="cm">/* type is associated with mdlm_desc.bGUID */</span>
	<span class="n">__u8</span>	<span class="n">bGuidDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDetailData</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;OBEX Control Model Functional Descriptor&quot; */</span>
<span class="k">struct</span> <span class="n">usb_cdc_obex_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__le16</span>	<span class="n">bcdVersion</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* &quot;NCM Control Model Functional Descriptor&quot; */</span>
<span class="k">struct</span> <span class="n">usb_cdc_ncm_desc</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bLength</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bDescriptorSubType</span><span class="p">;</span>

	<span class="n">__le16</span>	<span class="n">bcdNcmVersion</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bmNetworkCapabilities</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>
<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Class-Specific Control Requests (6.2)</span>
<span class="cm"> *</span>
<span class="cm"> * section 3.6.2.1 table 4 has the ACM profile, for modems.</span>
<span class="cm"> * section 3.8.2 table 10 has the ethernet profile.</span>
<span class="cm"> *</span>
<span class="cm"> * Microsoft&#39;s RNDIS stack for Ethernet is a vendor-specific CDC ACM variant,</span>
<span class="cm"> * heavily dependent on the encapsulated (proprietary) command mechanism.</span>
<span class="cm"> */</span>

<span class="cp">#define USB_CDC_SEND_ENCAPSULATED_COMMAND	0x00</span>
<span class="cp">#define USB_CDC_GET_ENCAPSULATED_RESPONSE	0x01</span>
<span class="cp">#define USB_CDC_REQ_SET_LINE_CODING		0x20</span>
<span class="cp">#define USB_CDC_REQ_GET_LINE_CODING		0x21</span>
<span class="cp">#define USB_CDC_REQ_SET_CONTROL_LINE_STATE	0x22</span>
<span class="cp">#define USB_CDC_REQ_SEND_BREAK			0x23</span>
<span class="cp">#define USB_CDC_SET_ETHERNET_MULTICAST_FILTERS	0x40</span>
<span class="cp">#define USB_CDC_SET_ETHERNET_PM_PATTERN_FILTER	0x41</span>
<span class="cp">#define USB_CDC_GET_ETHERNET_PM_PATTERN_FILTER	0x42</span>
<span class="cp">#define USB_CDC_SET_ETHERNET_PACKET_FILTER	0x43</span>
<span class="cp">#define USB_CDC_GET_ETHERNET_STATISTIC		0x44</span>
<span class="cp">#define USB_CDC_GET_NTB_PARAMETERS		0x80</span>
<span class="cp">#define USB_CDC_GET_NET_ADDRESS			0x81</span>
<span class="cp">#define USB_CDC_SET_NET_ADDRESS			0x82</span>
<span class="cp">#define USB_CDC_GET_NTB_FORMAT			0x83</span>
<span class="cp">#define USB_CDC_SET_NTB_FORMAT			0x84</span>
<span class="cp">#define USB_CDC_GET_NTB_INPUT_SIZE		0x85</span>
<span class="cp">#define USB_CDC_SET_NTB_INPUT_SIZE		0x86</span>
<span class="cp">#define USB_CDC_GET_MAX_DATAGRAM_SIZE		0x87</span>
<span class="cp">#define USB_CDC_SET_MAX_DATAGRAM_SIZE		0x88</span>
<span class="cp">#define USB_CDC_GET_CRC_MODE			0x89</span>
<span class="cp">#define USB_CDC_SET_CRC_MODE			0x8a</span>

<span class="cm">/* Line Coding Structure from CDC spec 6.2.13 */</span>
<span class="k">struct</span> <span class="n">usb_cdc_line_coding</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">dwDTERate</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bCharFormat</span><span class="p">;</span>
<span class="cp">#define USB_CDC_1_STOP_BITS			0</span>
<span class="cp">#define USB_CDC_1_5_STOP_BITS			1</span>
<span class="cp">#define USB_CDC_2_STOP_BITS			2</span>

	<span class="n">__u8</span>	<span class="n">bParityType</span><span class="p">;</span>
<span class="cp">#define USB_CDC_NO_PARITY			0</span>
<span class="cp">#define USB_CDC_ODD_PARITY			1</span>
<span class="cp">#define USB_CDC_EVEN_PARITY			2</span>
<span class="cp">#define USB_CDC_MARK_PARITY			3</span>
<span class="cp">#define USB_CDC_SPACE_PARITY			4</span>

	<span class="n">__u8</span>	<span class="n">bDataBits</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* table 62; bits in multicast filter */</span>
<span class="cp">#define	USB_CDC_PACKET_TYPE_PROMISCUOUS		(1 &lt;&lt; 0)</span>
<span class="cp">#define	USB_CDC_PACKET_TYPE_ALL_MULTICAST	(1 &lt;&lt; 1) </span><span class="cm">/* no filter */</span><span class="cp"></span>
<span class="cp">#define	USB_CDC_PACKET_TYPE_DIRECTED		(1 &lt;&lt; 2)</span>
<span class="cp">#define	USB_CDC_PACKET_TYPE_BROADCAST		(1 &lt;&lt; 3)</span>
<span class="cp">#define	USB_CDC_PACKET_TYPE_MULTICAST		(1 &lt;&lt; 4) </span><span class="cm">/* filtered */</span><span class="cp"></span>


<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Class-Specific Notifications (6.3) sent by interrupt transfers</span>
<span class="cm"> *</span>
<span class="cm"> * section 3.8.2 table 11 of the CDC spec lists Ethernet notifications</span>
<span class="cm"> * section 3.6.2.1 table 5 specifies ACM notifications, accepted by RNDIS</span>
<span class="cm"> * RNDIS also defines its own bit-incompatible notifications</span>
<span class="cm"> */</span>

<span class="cp">#define USB_CDC_NOTIFY_NETWORK_CONNECTION	0x00</span>
<span class="cp">#define USB_CDC_NOTIFY_RESPONSE_AVAILABLE	0x01</span>
<span class="cp">#define USB_CDC_NOTIFY_SERIAL_STATE		0x20</span>
<span class="cp">#define USB_CDC_NOTIFY_SPEED_CHANGE		0x2a</span>

<span class="k">struct</span> <span class="n">usb_cdc_notification</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">bmRequestType</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">bNotificationType</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wValue</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wIndex</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wLength</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">usb_cdc_speed_change</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">DLBitRRate</span><span class="p">;</span>	<span class="cm">/* contains the downlink bit rate (IN pipe) */</span>
	<span class="n">__le32</span>	<span class="n">ULBitRate</span><span class="p">;</span>	<span class="cm">/* contains the uplink bit rate (OUT pipe) */</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Class Specific structures and constants</span>
<span class="cm"> *</span>
<span class="cm"> * CDC NCM NTB parameters structure, CDC NCM subclass 6.2.1</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">usb_cdc_ncm_ntb_parameters</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">wLength</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">bmNtbFormatsSupported</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">dwNtbInMaxSize</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNdpInDivisor</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNdpInPayloadRemainder</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNdpInAlignment</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wPadding1</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">dwNtbOutMaxSize</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNdpOutDivisor</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNdpOutPayloadRemainder</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNdpOutAlignment</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNtbOutMaxDatagrams</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * CDC NCM transfer headers, CDC NCM subclass 3.2</span>
<span class="cm"> */</span>

<span class="cp">#define USB_CDC_NCM_NTH16_SIGN		0x484D434E </span><span class="cm">/* NCMH */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_NCM_NTH32_SIGN		0x686D636E </span><span class="cm">/* ncmh */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">usb_cdc_ncm_nth16</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">dwSignature</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wHeaderLength</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wSequence</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wBlockLength</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNdpIndex</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">usb_cdc_ncm_nth32</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">dwSignature</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wHeaderLength</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wSequence</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">dwBlockLength</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">dwNdpIndex</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * CDC NCM datagram pointers, CDC NCM subclass 3.3</span>
<span class="cm"> */</span>

<span class="cp">#define USB_CDC_NCM_NDP16_CRC_SIGN	0x314D434E </span><span class="cm">/* NCM1 */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_NCM_NDP16_NOCRC_SIGN	0x304D434E </span><span class="cm">/* NCM0 */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_NCM_NDP32_CRC_SIGN	0x316D636E </span><span class="cm">/* ncm1 */</span><span class="cp"></span>
<span class="cp">#define USB_CDC_NCM_NDP32_NOCRC_SIGN	0x306D636E </span><span class="cm">/* ncm0 */</span><span class="cp"></span>

<span class="cm">/* 16-bit NCM Datagram Pointer Entry */</span>
<span class="k">struct</span> <span class="n">usb_cdc_ncm_dpe16</span> <span class="p">{</span>
	<span class="n">__le16</span>	<span class="n">wDatagramIndex</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wDatagramLength</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">__packed__</span><span class="p">));</span>

<span class="cm">/* 16-bit NCM Datagram Pointer Table */</span>
<span class="k">struct</span> <span class="n">usb_cdc_ncm_ndp16</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">dwSignature</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wLength</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNextNdpIndex</span><span class="p">;</span>
	<span class="k">struct</span>	<span class="n">usb_cdc_ncm_dpe16</span> <span class="n">dpe16</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* 32-bit NCM Datagram Pointer Entry */</span>
<span class="k">struct</span> <span class="n">usb_cdc_ncm_dpe32</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">dwDatagramIndex</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">dwDatagramLength</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">__packed__</span><span class="p">));</span>

<span class="cm">/* 32-bit NCM Datagram Pointer Table */</span>
<span class="k">struct</span> <span class="n">usb_cdc_ncm_ndp32</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">dwSignature</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wLength</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wReserved6</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">dwNextNdpIndex</span><span class="p">;</span>
	<span class="n">__le32</span>	<span class="n">dwReserved12</span><span class="p">;</span>
	<span class="k">struct</span>	<span class="n">usb_cdc_ncm_dpe32</span> <span class="n">dpe32</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* CDC NCM subclass 3.2.1 and 3.2.2 */</span>
<span class="cp">#define USB_CDC_NCM_NDP16_INDEX_MIN			0x000C</span>
<span class="cp">#define USB_CDC_NCM_NDP32_INDEX_MIN			0x0010</span>

<span class="cm">/* CDC NCM subclass 3.3.3 Datagram Formatting */</span>
<span class="cp">#define USB_CDC_NCM_DATAGRAM_FORMAT_CRC			0x30</span>
<span class="cp">#define USB_CDC_NCM_DATAGRAM_FORMAT_NOCRC		0X31</span>

<span class="cm">/* CDC NCM subclass 4.2 NCM Communications Interface Protocol Code */</span>
<span class="cp">#define USB_CDC_NCM_PROTO_CODE_NO_ENCAP_COMMANDS	0x00</span>
<span class="cp">#define USB_CDC_NCM_PROTO_CODE_EXTERN_PROTO		0xFE</span>

<span class="cm">/* CDC NCM subclass 5.2.1 NCM Functional Descriptor, bmNetworkCapabilities */</span>
<span class="cp">#define USB_CDC_NCM_NCAP_ETH_FILTER			(1 &lt;&lt; 0)</span>
<span class="cp">#define USB_CDC_NCM_NCAP_NET_ADDRESS			(1 &lt;&lt; 1)</span>
<span class="cp">#define USB_CDC_NCM_NCAP_ENCAP_COMMAND			(1 &lt;&lt; 2)</span>
<span class="cp">#define USB_CDC_NCM_NCAP_MAX_DATAGRAM_SIZE		(1 &lt;&lt; 3)</span>
<span class="cp">#define USB_CDC_NCM_NCAP_CRC_MODE			(1 &lt;&lt; 4)</span>
<span class="cp">#define	USB_CDC_NCM_NCAP_NTB_INPUT_SIZE			(1 &lt;&lt; 5)</span>

<span class="cm">/* CDC NCM subclass Table 6-3: NTB Parameter Structure */</span>
<span class="cp">#define USB_CDC_NCM_NTB16_SUPPORTED			(1 &lt;&lt; 0)</span>
<span class="cp">#define USB_CDC_NCM_NTB32_SUPPORTED			(1 &lt;&lt; 1)</span>

<span class="cm">/* CDC NCM subclass Table 6-3: NTB Parameter Structure */</span>
<span class="cp">#define USB_CDC_NCM_NDP_ALIGN_MIN_SIZE			0x04</span>
<span class="cp">#define USB_CDC_NCM_NTB_MAX_LENGTH			0x1C</span>

<span class="cm">/* CDC NCM subclass 6.2.5 SetNtbFormat */</span>
<span class="cp">#define USB_CDC_NCM_NTB16_FORMAT			0x00</span>
<span class="cp">#define USB_CDC_NCM_NTB32_FORMAT			0x01</span>

<span class="cm">/* CDC NCM subclass 6.2.7 SetNtbInputSize */</span>
<span class="cp">#define USB_CDC_NCM_NTB_MIN_IN_SIZE			2048</span>
<span class="cp">#define USB_CDC_NCM_NTB_MIN_OUT_SIZE			2048</span>

<span class="cm">/* NTB Input Size Structure */</span>
<span class="k">struct</span> <span class="n">usb_cdc_ncm_ndp_input_size</span> <span class="p">{</span>
	<span class="n">__le32</span>	<span class="n">dwNtbInMaxSize</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wNtbInMaxDatagrams</span><span class="p">;</span>
	<span class="n">__le16</span>	<span class="n">wReserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* CDC NCM subclass 6.2.11 SetCrcMode */</span>
<span class="cp">#define USB_CDC_NCM_CRC_NOT_APPENDED			0x00</span>
<span class="cp">#define USB_CDC_NCM_CRC_APPENDED			0x01</span>

<span class="cp">#endif </span><span class="cm">/* __LINUX_USB_CDC_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
