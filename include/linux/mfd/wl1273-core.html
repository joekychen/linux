<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › mfd › wl1273-core.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>wl1273-core.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * include/linux/mfd/wl1273-core.h</span>
<span class="cm"> *</span>
<span class="cm"> * Some definitions for the wl1273 radio receiver/transmitter chip.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2010 Nokia Corporation</span>
<span class="cm"> * Author: Matti J. Aaltonen &lt;matti.j.aaltonen@nokia.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License</span>
<span class="cm"> * version 2 as published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA</span>
<span class="cm"> * 02110-1301 USA</span>
<span class="cm"> */</span>

<span class="cp">#ifndef WL1273_CORE_H</span>
<span class="cp">#define WL1273_CORE_H</span>

<span class="cp">#include &lt;linux/i2c.h&gt;</span>
<span class="cp">#include &lt;linux/mfd/core.h&gt;</span>

<span class="cp">#define WL1273_FM_DRIVER_NAME	&quot;wl1273-fm&quot;</span>
<span class="cp">#define RX71_FM_I2C_ADDR	0x22</span>

<span class="cp">#define WL1273_STEREO_GET		0</span>
<span class="cp">#define WL1273_RSSI_LVL_GET		1</span>
<span class="cp">#define WL1273_IF_COUNT_GET		2</span>
<span class="cp">#define WL1273_FLAG_GET			3</span>
<span class="cp">#define WL1273_RDS_SYNC_GET		4</span>
<span class="cp">#define WL1273_RDS_DATA_GET		5</span>
<span class="cp">#define WL1273_FREQ_SET			10</span>
<span class="cp">#define WL1273_AF_FREQ_SET		11</span>
<span class="cp">#define WL1273_MOST_MODE_SET		12</span>
<span class="cp">#define WL1273_MOST_BLEND_SET		13</span>
<span class="cp">#define WL1273_DEMPH_MODE_SET		14</span>
<span class="cp">#define WL1273_SEARCH_LVL_SET		15</span>
<span class="cp">#define WL1273_BAND_SET			16</span>
<span class="cp">#define WL1273_MUTE_STATUS_SET		17</span>
<span class="cp">#define WL1273_RDS_PAUSE_LVL_SET	18</span>
<span class="cp">#define WL1273_RDS_PAUSE_DUR_SET	19</span>
<span class="cp">#define WL1273_RDS_MEM_SET		20</span>
<span class="cp">#define WL1273_RDS_BLK_B_SET		21</span>
<span class="cp">#define WL1273_RDS_MSK_B_SET		22</span>
<span class="cp">#define WL1273_RDS_PI_MASK_SET		23</span>
<span class="cp">#define WL1273_RDS_PI_SET		24</span>
<span class="cp">#define WL1273_RDS_SYSTEM_SET		25</span>
<span class="cp">#define WL1273_INT_MASK_SET		26</span>
<span class="cp">#define WL1273_SEARCH_DIR_SET		27</span>
<span class="cp">#define WL1273_VOLUME_SET		28</span>
<span class="cp">#define WL1273_AUDIO_ENABLE		29</span>
<span class="cp">#define WL1273_PCM_MODE_SET		30</span>
<span class="cp">#define WL1273_I2S_MODE_CONFIG_SET	31</span>
<span class="cp">#define WL1273_POWER_SET		32</span>
<span class="cp">#define WL1273_INTX_CONFIG_SET		33</span>
<span class="cp">#define WL1273_PULL_EN_SET		34</span>
<span class="cp">#define WL1273_HILO_SET			35</span>
<span class="cp">#define WL1273_SWITCH2FREF		36</span>
<span class="cp">#define WL1273_FREQ_DRIFT_REPORT	37</span>

<span class="cp">#define WL1273_PCE_GET			40</span>
<span class="cp">#define WL1273_FIRM_VER_GET		41</span>
<span class="cp">#define WL1273_ASIC_VER_GET		42</span>
<span class="cp">#define WL1273_ASIC_ID_GET		43</span>
<span class="cp">#define WL1273_MAN_ID_GET		44</span>
<span class="cp">#define WL1273_TUNER_MODE_SET		45</span>
<span class="cp">#define WL1273_STOP_SEARCH		46</span>
<span class="cp">#define WL1273_RDS_CNTRL_SET		47</span>

<span class="cp">#define WL1273_WRITE_HARDWARE_REG	100</span>
<span class="cp">#define WL1273_CODE_DOWNLOAD		101</span>
<span class="cp">#define WL1273_RESET			102</span>

<span class="cp">#define WL1273_FM_POWER_MODE		254</span>
<span class="cp">#define WL1273_FM_INTERRUPT		255</span>

<span class="cm">/* Transmitter API */</span>

<span class="cp">#define WL1273_CHANL_SET			55</span>
<span class="cp">#define WL1273_SCAN_SPACING_SET			56</span>
<span class="cp">#define WL1273_REF_SET				57</span>
<span class="cp">#define WL1273_POWER_ENB_SET			90</span>
<span class="cp">#define WL1273_POWER_ATT_SET			58</span>
<span class="cp">#define WL1273_POWER_LEV_SET			59</span>
<span class="cp">#define WL1273_AUDIO_DEV_SET			60</span>
<span class="cp">#define WL1273_PILOT_DEV_SET			61</span>
<span class="cp">#define WL1273_RDS_DEV_SET			62</span>
<span class="cp">#define WL1273_PUPD_SET				91</span>
<span class="cp">#define WL1273_AUDIO_IO_SET			63</span>
<span class="cp">#define WL1273_PREMPH_SET			64</span>
<span class="cp">#define WL1273_MONO_SET				66</span>
<span class="cp">#define WL1273_MUTE				92</span>
<span class="cp">#define WL1273_MPX_LMT_ENABLE			67</span>
<span class="cp">#define WL1273_PI_SET				93</span>
<span class="cp">#define WL1273_ECC_SET				69</span>
<span class="cp">#define WL1273_PTY				70</span>
<span class="cp">#define WL1273_AF				71</span>
<span class="cp">#define WL1273_DISPLAY_MODE			74</span>
<span class="cp">#define WL1273_RDS_REP_SET			77</span>
<span class="cp">#define WL1273_RDS_CONFIG_DATA_SET		98</span>
<span class="cp">#define WL1273_RDS_DATA_SET			99</span>
<span class="cp">#define WL1273_RDS_DATA_ENB			94</span>
<span class="cp">#define WL1273_TA_SET				78</span>
<span class="cp">#define WL1273_TP_SET				79</span>
<span class="cp">#define WL1273_DI_SET				80</span>
<span class="cp">#define WL1273_MS_SET				81</span>
<span class="cp">#define WL1273_PS_SCROLL_SPEED			82</span>
<span class="cp">#define WL1273_TX_AUDIO_LEVEL_TEST		96</span>
<span class="cp">#define WL1273_TX_AUDIO_LEVEL_TEST_THRESHOLD	73</span>
<span class="cp">#define WL1273_TX_AUDIO_INPUT_LEVEL_RANGE_SET	54</span>
<span class="cp">#define WL1273_RX_ANTENNA_SELECT		87</span>
<span class="cp">#define WL1273_I2C_DEV_ADDR_SET			86</span>
<span class="cp">#define WL1273_REF_ERR_CALIB_PARAM_SET		88</span>
<span class="cp">#define WL1273_REF_ERR_CALIB_PERIODICITY_SET	89</span>
<span class="cp">#define WL1273_SOC_INT_TRIGGER			52</span>
<span class="cp">#define WL1273_SOC_AUDIO_PATH_SET		83</span>
<span class="cp">#define WL1273_SOC_PCMI_OVERRIDE		84</span>
<span class="cp">#define WL1273_SOC_I2S_OVERRIDE			85</span>
<span class="cp">#define WL1273_RSSI_BLOCK_SCAN_FREQ_SET		95</span>
<span class="cp">#define WL1273_RSSI_BLOCK_SCAN_START		97</span>
<span class="cp">#define WL1273_RSSI_BLOCK_SCAN_DATA_GET		5</span>
<span class="cp">#define WL1273_READ_FMANT_TUNE_VALUE		104</span>

<span class="cp">#define WL1273_RDS_OFF		0</span>
<span class="cp">#define WL1273_RDS_ON		1</span>
<span class="cp">#define WL1273_RDS_RESET	2</span>

<span class="cp">#define WL1273_AUDIO_DIGITAL	0</span>
<span class="cp">#define WL1273_AUDIO_ANALOG	1</span>

<span class="cp">#define WL1273_MODE_RX		BIT(0)</span>
<span class="cp">#define WL1273_MODE_TX		BIT(1)</span>
<span class="cp">#define WL1273_MODE_OFF		BIT(2)</span>
<span class="cp">#define WL1273_MODE_SUSPENDED	BIT(3)</span>

<span class="cp">#define WL1273_RADIO_CHILD	BIT(0)</span>
<span class="cp">#define WL1273_CODEC_CHILD	BIT(1)</span>

<span class="cp">#define WL1273_RX_MONO		1</span>
<span class="cp">#define WL1273_RX_STEREO	0</span>
<span class="cp">#define WL1273_TX_MONO		0</span>
<span class="cp">#define WL1273_TX_STEREO	1</span>

<span class="cp">#define WL1273_MAX_VOLUME	0xffff</span>
<span class="cp">#define WL1273_DEFAULT_VOLUME	0x78b8</span>

<span class="cm">/* I2S protocol, left channel first, data width 16 bits */</span>
<span class="cp">#define WL1273_PCM_DEF_MODE		0x00</span>

<span class="cm">/* Rx */</span>
<span class="cp">#define WL1273_AUDIO_ENABLE_I2S		BIT(0)</span>
<span class="cp">#define WL1273_AUDIO_ENABLE_ANALOG	BIT(1)</span>

<span class="cm">/* Tx */</span>
<span class="cp">#define WL1273_AUDIO_IO_SET_ANALOG	0</span>
<span class="cp">#define WL1273_AUDIO_IO_SET_I2S		1</span>

<span class="cp">#define WL1273_PUPD_SET_OFF		0x00</span>
<span class="cp">#define WL1273_PUPD_SET_ON		0x01</span>
<span class="cp">#define WL1273_PUPD_SET_RETENTION	0x10</span>

<span class="cm">/* I2S mode */</span>
<span class="cp">#define WL1273_IS2_WIDTH_32	0x0</span>
<span class="cp">#define WL1273_IS2_WIDTH_40	0x1</span>
<span class="cp">#define WL1273_IS2_WIDTH_22_23	0x2</span>
<span class="cp">#define WL1273_IS2_WIDTH_23_22	0x3</span>
<span class="cp">#define WL1273_IS2_WIDTH_48	0x4</span>
<span class="cp">#define WL1273_IS2_WIDTH_50	0x5</span>
<span class="cp">#define WL1273_IS2_WIDTH_60	0x6</span>
<span class="cp">#define WL1273_IS2_WIDTH_64	0x7</span>
<span class="cp">#define WL1273_IS2_WIDTH_80	0x8</span>
<span class="cp">#define WL1273_IS2_WIDTH_96	0x9</span>
<span class="cp">#define WL1273_IS2_WIDTH_128	0xa</span>
<span class="cp">#define WL1273_IS2_WIDTH	0xf</span>

<span class="cp">#define WL1273_IS2_FORMAT_STD	(0x0 &lt;&lt; 4)</span>
<span class="cp">#define WL1273_IS2_FORMAT_LEFT	(0x1 &lt;&lt; 4)</span>
<span class="cp">#define WL1273_IS2_FORMAT_RIGHT	(0x2 &lt;&lt; 4)</span>
<span class="cp">#define WL1273_IS2_FORMAT_USER	(0x3 &lt;&lt; 4)</span>

<span class="cp">#define WL1273_IS2_MASTER	(0x0 &lt;&lt; 6)</span>
<span class="cp">#define WL1273_IS2_SLAVEW	(0x1 &lt;&lt; 6)</span>

<span class="cp">#define WL1273_IS2_TRI_AFTER_SENDING	(0x0 &lt;&lt; 7)</span>
<span class="cp">#define WL1273_IS2_TRI_ALWAYS_ACTIVE	(0x1 &lt;&lt; 7)</span>

<span class="cp">#define WL1273_IS2_SDOWS_RR	(0x0 &lt;&lt; 8)</span>
<span class="cp">#define WL1273_IS2_SDOWS_RF	(0x1 &lt;&lt; 8)</span>
<span class="cp">#define WL1273_IS2_SDOWS_FR	(0x2 &lt;&lt; 8)</span>
<span class="cp">#define WL1273_IS2_SDOWS_FF	(0x3 &lt;&lt; 8)</span>

<span class="cp">#define WL1273_IS2_TRI_OPT	(0x0 &lt;&lt; 10)</span>
<span class="cp">#define WL1273_IS2_TRI_ALWAYS	(0x1 &lt;&lt; 10)</span>

<span class="cp">#define WL1273_IS2_RATE_48K	(0x0 &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE_44_1K	(0x1 &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE_32K	(0x2 &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE_22_05K	(0x4 &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE_16K	(0x5 &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE_12K	(0x8 &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE_11_025	(0x9 &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE_8K	(0xa &lt;&lt; 12)</span>
<span class="cp">#define WL1273_IS2_RATE		(0xf &lt;&lt; 12)</span>

<span class="cp">#define WL1273_I2S_DEF_MODE	(WL1273_IS2_WIDTH_32 | \</span>
<span class="cp">				 WL1273_IS2_FORMAT_STD | \</span>
<span class="cp">				 WL1273_IS2_MASTER | \</span>
<span class="cp">				 WL1273_IS2_TRI_AFTER_SENDING | \</span>
<span class="cp">				 WL1273_IS2_SDOWS_RR | \</span>
<span class="cp">				 WL1273_IS2_TRI_OPT | \</span>
<span class="cp">				 WL1273_IS2_RATE_48K)</span>

<span class="cp">#define SCHAR_MIN (-128)</span>
<span class="cp">#define SCHAR_MAX 127</span>

<span class="cp">#define WL1273_FR_EVENT			BIT(0)</span>
<span class="cp">#define WL1273_BL_EVENT			BIT(1)</span>
<span class="cp">#define WL1273_RDS_EVENT		BIT(2)</span>
<span class="cp">#define WL1273_BBLK_EVENT		BIT(3)</span>
<span class="cp">#define WL1273_LSYNC_EVENT		BIT(4)</span>
<span class="cp">#define WL1273_LEV_EVENT		BIT(5)</span>
<span class="cp">#define WL1273_IFFR_EVENT		BIT(6)</span>
<span class="cp">#define WL1273_PI_EVENT			BIT(7)</span>
<span class="cp">#define WL1273_PD_EVENT			BIT(8)</span>
<span class="cp">#define WL1273_STIC_EVENT		BIT(9)</span>
<span class="cp">#define WL1273_MAL_EVENT		BIT(10)</span>
<span class="cp">#define WL1273_POW_ENB_EVENT		BIT(11)</span>
<span class="cp">#define WL1273_SCAN_OVER_EVENT		BIT(12)</span>
<span class="cp">#define WL1273_ERROR_EVENT		BIT(13)</span>

<span class="cp">#define TUNER_MODE_STOP_SEARCH		0</span>
<span class="cp">#define TUNER_MODE_PRESET		1</span>
<span class="cp">#define TUNER_MODE_AUTO_SEEK		2</span>
<span class="cp">#define TUNER_MODE_AF			3</span>
<span class="cp">#define TUNER_MODE_AUTO_SEEK_PI		4</span>
<span class="cp">#define TUNER_MODE_AUTO_SEEK_BULK	5</span>

<span class="cp">#define RDS_BLOCK_SIZE	3</span>

<span class="k">struct</span> <span class="n">wl1273_fm_platform_data</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">request_resources</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">client</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">free_resources</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">enable</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">disable</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">);</span>

	<span class="n">u8</span> <span class="n">forbidden_modes</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">children</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define WL1273_FM_CORE_CELLS	2</span>

<span class="cp">#define WL1273_BAND_OTHER	0</span>
<span class="cp">#define WL1273_BAND_JAPAN	1</span>

<span class="cp">#define WL1273_BAND_JAPAN_LOW	76000</span>
<span class="cp">#define WL1273_BAND_JAPAN_HIGH	90000</span>
<span class="cp">#define WL1273_BAND_OTHER_LOW	87500</span>
<span class="cp">#define WL1273_BAND_OTHER_HIGH	108000</span>

<span class="cp">#define WL1273_BAND_TX_LOW	76000</span>
<span class="cp">#define WL1273_BAND_TX_HIGH	108000</span>

<span class="k">struct</span> <span class="n">wl1273_core</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">mfd_cell</span> <span class="n">cells</span><span class="p">[</span><span class="n">WL1273_FM_CORE_CELLS</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">wl1273_fm_platform_data</span> <span class="o">*</span><span class="n">pdata</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i2s_mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">volume</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">audio_mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">channel_number</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">lock</span><span class="p">;</span> <span class="cm">/* for serializing fm radio operations */</span>

	<span class="k">struct</span> <span class="n">i2c_client</span> <span class="o">*</span><span class="n">client</span><span class="p">;</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">read</span><span class="p">)(</span><span class="k">struct</span> <span class="n">wl1273_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="n">u8</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">write</span><span class="p">)(</span><span class="k">struct</span> <span class="n">wl1273_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="n">u8</span><span class="p">,</span> <span class="n">u16</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">write_data</span><span class="p">)(</span><span class="k">struct</span> <span class="n">wl1273_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="p">,</span> <span class="n">u16</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">set_audio</span><span class="p">)(</span><span class="k">struct</span> <span class="n">wl1273_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">set_volume</span><span class="p">)(</span><span class="k">struct</span> <span class="n">wl1273_core</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#endif	</span><span class="cm">/* ifndef WL1273_CORE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
