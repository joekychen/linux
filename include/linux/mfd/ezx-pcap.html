<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › mfd › ezx-pcap.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>ezx-pcap.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright 2009 Daniel Ribeiro &lt;drwyrm@gmail.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * For further information, please see http://wiki.openezx.org/PCAP2</span>
<span class="cm"> */</span>

<span class="cp">#ifndef EZX_PCAP_H</span>
<span class="cp">#define EZX_PCAP_H</span>

<span class="k">struct</span> <span class="n">pcap_subdev</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">platform_data</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">pcap_platform_data</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">irq_base</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">config</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">);</span>	<span class="cm">/* board specific init */</span>
	<span class="kt">int</span> <span class="n">num_subdevs</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pcap_subdev</span> <span class="o">*</span><span class="n">subdevs</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">pcap_chip</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">ezx_pcap_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span><span class="p">,</span> <span class="n">u32</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ezx_pcap_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ezx_pcap_set_bits</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span><span class="p">,</span> <span class="n">u32</span><span class="p">,</span> <span class="n">u32</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pcap_to_irq</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">irq_to_pcap</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pcap_adc_async</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span><span class="p">,</span> <span class="n">u32</span><span class="p">,</span> <span class="n">u8</span><span class="p">[],</span> <span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pcap_adc_sync</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span><span class="p">,</span> <span class="n">u32</span><span class="p">,</span> <span class="n">u8</span><span class="p">[],</span> <span class="n">u16</span><span class="p">[]);</span>
<span class="kt">void</span> <span class="n">pcap_set_ts_bits</span><span class="p">(</span><span class="k">struct</span> <span class="n">pcap_chip</span> <span class="o">*</span><span class="p">,</span> <span class="n">u32</span><span class="p">);</span>

<span class="cp">#define PCAP_SECOND_PORT	1</span>
<span class="cp">#define PCAP_CS_AH		2</span>

<span class="cp">#define PCAP_REGISTER_WRITE_OP_BIT	0x80000000</span>
<span class="cp">#define PCAP_REGISTER_READ_OP_BIT	0x00000000</span>

<span class="cp">#define PCAP_REGISTER_VALUE_MASK	0x01ffffff</span>
<span class="cp">#define PCAP_REGISTER_ADDRESS_MASK	0x7c000000</span>
<span class="cp">#define PCAP_REGISTER_ADDRESS_SHIFT	26</span>
<span class="cp">#define PCAP_REGISTER_NUMBER		32</span>
<span class="cp">#define PCAP_CLEAR_INTERRUPT_REGISTER	0x01ffffff</span>
<span class="cp">#define PCAP_MASK_ALL_INTERRUPT		0x01ffffff</span>

<span class="cm">/* registers accessible by both pcap ports */</span>
<span class="cp">#define PCAP_REG_ISR		0x0	</span><span class="cm">/* Interrupt Status */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_MSR		0x1	</span><span class="cm">/* Interrupt Mask */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_PSTAT		0x2	</span><span class="cm">/* Processor Status */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_VREG2		0x6	</span><span class="cm">/* Regulator Bank 2 Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_AUXVREG	0x7	</span><span class="cm">/* Auxiliary Regulator Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_BATT		0x8	</span><span class="cm">/* Battery Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_ADC		0x9	</span><span class="cm">/* AD Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_ADR		0xa	</span><span class="cm">/* AD Result */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_CODEC		0xb	</span><span class="cm">/* Audio Codec Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_RX_AMPS	0xc	</span><span class="cm">/* RX Audio Amplifiers Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_ST_DAC		0xd	</span><span class="cm">/* Stereo DAC Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_BUSCTRL	0x14	</span><span class="cm">/* Connectivity Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_PERIPH		0x15	</span><span class="cm">/* Peripheral Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_LOWPWR		0x18	</span><span class="cm">/* Regulator Low Power Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_TX_AMPS	0x1a	</span><span class="cm">/* TX Audio Amplifiers Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_GP		0x1b	</span><span class="cm">/* General Purpose */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_TEST1		0x1c</span>
<span class="cp">#define PCAP_REG_TEST2		0x1d</span>
<span class="cp">#define PCAP_REG_VENDOR_TEST1	0x1e</span>
<span class="cp">#define PCAP_REG_VENDOR_TEST2	0x1f</span>

<span class="cm">/* registers accessible by pcap port 1 only (a1200, e2 &amp; e6) */</span>
<span class="cp">#define PCAP_REG_INT_SEL	0x3	</span><span class="cm">/* Interrupt Select */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_SWCTRL		0x4	</span><span class="cm">/* Switching Regulator Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_VREG1		0x5	</span><span class="cm">/* Regulator Bank 1 Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_RTC_TOD	0xe	</span><span class="cm">/* RTC Time of Day */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_RTC_TODA	0xf	</span><span class="cm">/* RTC Time of Day Alarm */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_RTC_DAY	0x10	</span><span class="cm">/* RTC Day */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_RTC_DAYA	0x11	</span><span class="cm">/* RTC Day Alarm */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_MTRTMR		0x12	</span><span class="cm">/* AD Monitor Timer */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_PWR		0x13	</span><span class="cm">/* Power Control */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_AUXVREG_MASK	0x16	</span><span class="cm">/* Auxiliary Regulator Mask */</span><span class="cp"></span>
<span class="cp">#define PCAP_REG_VENDOR_REV	0x17</span>
<span class="cp">#define PCAP_REG_PERIPH_MASK	0x19	</span><span class="cm">/* Peripheral Mask */</span><span class="cp"></span>

<span class="cm">/* PCAP2 Interrupts */</span>
<span class="cp">#define PCAP_NIRQS		23</span>
<span class="cp">#define PCAP_IRQ_ADCDONE	0	</span><span class="cm">/* ADC done port 1 */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_TS		1	</span><span class="cm">/* Touch Screen */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_1HZ		2	</span><span class="cm">/* 1HZ timer */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_WH		3	</span><span class="cm">/* ADC above high limit */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_WL		4	</span><span class="cm">/* ADC below low limit */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_TODA		5	</span><span class="cm">/* Time of day alarm */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_USB4V		6	</span><span class="cm">/* USB above 4V */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_ONOFF		7	</span><span class="cm">/* On/Off button */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_ONOFF2		8	</span><span class="cm">/* On/Off button 2 */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_USB1V		9	</span><span class="cm">/* USB above 1V */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_MOBPORT	10</span>
<span class="cp">#define PCAP_IRQ_MIC		11	</span><span class="cm">/* Mic attach/HS button */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_HS		12	</span><span class="cm">/* Headset attach */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_ST		13</span>
<span class="cp">#define PCAP_IRQ_PC		14	</span><span class="cm">/* Power Cut */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_WARM		15</span>
<span class="cp">#define PCAP_IRQ_EOL		16	</span><span class="cm">/* Battery End Of Life */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_CLK		17</span>
<span class="cp">#define PCAP_IRQ_SYSRST		18	</span><span class="cm">/* System Reset */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_DUMMY		19</span>
<span class="cp">#define PCAP_IRQ_ADCDONE2	20	</span><span class="cm">/* ADC done port 2 */</span><span class="cp"></span>
<span class="cp">#define PCAP_IRQ_SOFTRESET	21</span>
<span class="cp">#define PCAP_IRQ_MNEXB		22</span>

<span class="cm">/* voltage regulators */</span>
<span class="cp">#define V1		0</span>
<span class="cp">#define V2		1</span>
<span class="cp">#define V3		2</span>
<span class="cp">#define V4		3</span>
<span class="cp">#define V5		4</span>
<span class="cp">#define V6		5</span>
<span class="cp">#define V7		6</span>
<span class="cp">#define V8		7</span>
<span class="cp">#define V9		8</span>
<span class="cp">#define V10		9</span>
<span class="cp">#define VAUX1		10</span>
<span class="cp">#define VAUX2		11</span>
<span class="cp">#define VAUX3		12</span>
<span class="cp">#define VAUX4		13</span>
<span class="cp">#define VSIM		14</span>
<span class="cp">#define VSIM2		15</span>
<span class="cp">#define VVIB		16</span>
<span class="cp">#define SW1		17</span>
<span class="cp">#define SW2		18</span>
<span class="cp">#define SW3		19</span>
<span class="cp">#define SW1S		20</span>
<span class="cp">#define SW2S		21</span>

<span class="cp">#define PCAP_BATT_DAC_MASK		0x000000ff</span>
<span class="cp">#define PCAP_BATT_DAC_SHIFT		0</span>
<span class="cp">#define PCAP_BATT_B_FDBK		(1 &lt;&lt; 8)</span>
<span class="cp">#define PCAP_BATT_EXT_ISENSE		(1 &lt;&lt; 9)</span>
<span class="cp">#define PCAP_BATT_V_COIN_MASK		0x00003c00</span>
<span class="cp">#define PCAP_BATT_V_COIN_SHIFT		10</span>
<span class="cp">#define PCAP_BATT_I_COIN		(1 &lt;&lt; 14)</span>
<span class="cp">#define PCAP_BATT_COIN_CH_EN		(1 &lt;&lt; 15)</span>
<span class="cp">#define PCAP_BATT_EOL_SEL_MASK		0x000e0000</span>
<span class="cp">#define PCAP_BATT_EOL_SEL_SHIFT		17</span>
<span class="cp">#define PCAP_BATT_EOL_CMP_EN		(1 &lt;&lt; 20)</span>
<span class="cp">#define PCAP_BATT_BATT_DET_EN		(1 &lt;&lt; 21)</span>
<span class="cp">#define PCAP_BATT_THERMBIAS_CTRL	(1 &lt;&lt; 22)</span>

<span class="cp">#define PCAP_ADC_ADEN			(1 &lt;&lt; 0)</span>
<span class="cp">#define PCAP_ADC_RAND			(1 &lt;&lt; 1)</span>
<span class="cp">#define PCAP_ADC_AD_SEL1		(1 &lt;&lt; 2)</span>
<span class="cp">#define PCAP_ADC_AD_SEL2		(1 &lt;&lt; 3)</span>
<span class="cp">#define PCAP_ADC_ADA1_MASK		0x00000070</span>
<span class="cp">#define PCAP_ADC_ADA1_SHIFT		4</span>
<span class="cp">#define PCAP_ADC_ADA2_MASK		0x00000380</span>
<span class="cp">#define PCAP_ADC_ADA2_SHIFT		7</span>
<span class="cp">#define PCAP_ADC_ATO_MASK		0x00003c00</span>
<span class="cp">#define PCAP_ADC_ATO_SHIFT		10</span>
<span class="cp">#define PCAP_ADC_ATOX			(1 &lt;&lt; 14)</span>
<span class="cp">#define PCAP_ADC_MTR1			(1 &lt;&lt; 15)</span>
<span class="cp">#define PCAP_ADC_MTR2			(1 &lt;&lt; 16)</span>
<span class="cp">#define PCAP_ADC_TS_M_MASK		0x000e0000</span>
<span class="cp">#define PCAP_ADC_TS_M_SHIFT		17</span>
<span class="cp">#define PCAP_ADC_TS_REF_LOWPWR		(1 &lt;&lt; 20)</span>
<span class="cp">#define PCAP_ADC_TS_REFENB		(1 &lt;&lt; 21)</span>
<span class="cp">#define PCAP_ADC_BATT_I_POLARITY	(1 &lt;&lt; 22)</span>
<span class="cp">#define PCAP_ADC_BATT_I_ADC		(1 &lt;&lt; 23)</span>

<span class="cp">#define PCAP_ADC_BANK_0			0</span>
<span class="cp">#define PCAP_ADC_BANK_1			1</span>
<span class="cm">/* ADC bank 0 */</span>
<span class="cp">#define PCAP_ADC_CH_COIN		0</span>
<span class="cp">#define PCAP_ADC_CH_BATT		1</span>
<span class="cp">#define PCAP_ADC_CH_BPLUS		2</span>
<span class="cp">#define PCAP_ADC_CH_MOBPORTB		3</span>
<span class="cp">#define PCAP_ADC_CH_TEMPERATURE		4</span>
<span class="cp">#define PCAP_ADC_CH_CHARGER_ID		5</span>
<span class="cp">#define PCAP_ADC_CH_AD6			6</span>
<span class="cm">/* ADC bank 1 */</span>
<span class="cp">#define PCAP_ADC_CH_AD7			0</span>
<span class="cp">#define PCAP_ADC_CH_AD8			1</span>
<span class="cp">#define PCAP_ADC_CH_AD9			2</span>
<span class="cp">#define PCAP_ADC_CH_TS_X1		3</span>
<span class="cp">#define PCAP_ADC_CH_TS_X2		4</span>
<span class="cp">#define PCAP_ADC_CH_TS_Y1		5</span>
<span class="cp">#define PCAP_ADC_CH_TS_Y2		6</span>

<span class="cp">#define PCAP_ADC_T_NOW			0</span>
<span class="cp">#define PCAP_ADC_T_IN_BURST		1</span>
<span class="cp">#define PCAP_ADC_T_OUT_BURST		2</span>

<span class="cp">#define PCAP_ADC_ATO_IN_BURST		6</span>
<span class="cp">#define PCAP_ADC_ATO_OUT_BURST		0</span>

<span class="cp">#define PCAP_ADC_TS_M_XY		1</span>
<span class="cp">#define PCAP_ADC_TS_M_PRESSURE		2</span>
<span class="cp">#define PCAP_ADC_TS_M_PLATE_X		3</span>
<span class="cp">#define PCAP_ADC_TS_M_PLATE_Y		4</span>
<span class="cp">#define PCAP_ADC_TS_M_STANDBY		5</span>
<span class="cp">#define PCAP_ADC_TS_M_NONTS		6</span>

<span class="cp">#define PCAP_ADR_ADD1_MASK		0x000003ff</span>
<span class="cp">#define PCAP_ADR_ADD1_SHIFT		0</span>
<span class="cp">#define PCAP_ADR_ADD2_MASK		0x000ffc00</span>
<span class="cp">#define PCAP_ADR_ADD2_SHIFT		10</span>
<span class="cp">#define PCAP_ADR_ADINC1			(1 &lt;&lt; 20)</span>
<span class="cp">#define PCAP_ADR_ADINC2			(1 &lt;&lt; 21)</span>
<span class="cp">#define PCAP_ADR_ASC			(1 &lt;&lt; 22)</span>
<span class="cp">#define PCAP_ADR_ONESHOT		(1 &lt;&lt; 23)</span>

<span class="cp">#define PCAP_BUSCTRL_FSENB		(1 &lt;&lt; 0)</span>
<span class="cp">#define PCAP_BUSCTRL_USB_SUSPEND	(1 &lt;&lt; 1)</span>
<span class="cp">#define PCAP_BUSCTRL_USB_PU		(1 &lt;&lt; 2)</span>
<span class="cp">#define PCAP_BUSCTRL_USB_PD		(1 &lt;&lt; 3)</span>
<span class="cp">#define PCAP_BUSCTRL_VUSB_EN		(1 &lt;&lt; 4)</span>
<span class="cp">#define PCAP_BUSCTRL_USB_PS		(1 &lt;&lt; 5)</span>
<span class="cp">#define PCAP_BUSCTRL_VUSB_MSTR_EN	(1 &lt;&lt; 6)</span>
<span class="cp">#define PCAP_BUSCTRL_VBUS_PD_ENB	(1 &lt;&lt; 7)</span>
<span class="cp">#define PCAP_BUSCTRL_CURRLIM		(1 &lt;&lt; 8)</span>
<span class="cp">#define PCAP_BUSCTRL_RS232ENB		(1 &lt;&lt; 9)</span>
<span class="cp">#define PCAP_BUSCTRL_RS232_DIR		(1 &lt;&lt; 10)</span>
<span class="cp">#define PCAP_BUSCTRL_SE0_CONN		(1 &lt;&lt; 11)</span>
<span class="cp">#define PCAP_BUSCTRL_USB_PDM		(1 &lt;&lt; 12)</span>
<span class="cp">#define PCAP_BUSCTRL_BUS_PRI_ADJ	(1 &lt;&lt; 24)</span>

<span class="cm">/* leds */</span>
<span class="cp">#define PCAP_LED0		0</span>
<span class="cp">#define PCAP_LED1		1</span>
<span class="cp">#define PCAP_BL0		2</span>
<span class="cp">#define PCAP_BL1		3</span>
<span class="cp">#define PCAP_LED_3MA		0</span>
<span class="cp">#define PCAP_LED_4MA		1</span>
<span class="cp">#define PCAP_LED_5MA		2</span>
<span class="cp">#define PCAP_LED_9MA		3</span>
<span class="cp">#define PCAP_LED_T_MASK		0xf</span>
<span class="cp">#define PCAP_LED_C_MASK		0x3</span>
<span class="cp">#define PCAP_BL_MASK		0x1f</span>
<span class="cp">#define PCAP_BL0_SHIFT		0</span>
<span class="cp">#define PCAP_LED0_EN		(1 &lt;&lt; 5)</span>
<span class="cp">#define PCAP_LED1_EN		(1 &lt;&lt; 6)</span>
<span class="cp">#define PCAP_LED0_T_SHIFT	7</span>
<span class="cp">#define PCAP_LED1_T_SHIFT	11</span>
<span class="cp">#define PCAP_LED0_C_SHIFT	15</span>
<span class="cp">#define PCAP_LED1_C_SHIFT	17</span>
<span class="cp">#define PCAP_BL1_SHIFT		20</span>

<span class="cm">/* RTC */</span>
<span class="cp">#define PCAP_RTC_DAY_MASK	0x3fff</span>
<span class="cp">#define PCAP_RTC_TOD_MASK	0xffff</span>
<span class="cp">#define PCAP_RTC_PC_MASK	0x7</span>
<span class="cp">#define SEC_PER_DAY		86400</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
