<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › mfd › wm831x › core.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>core.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * include/linux/mfd/wm831x/core.h -- Core interface for WM831x</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright 2009 Wolfson Microelectronics PLC.</span>
<span class="cm"> *</span>
<span class="cm"> * Author: Mark Brown &lt;broonie@opensource.wolfsonmicro.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *  This program is free software; you can redistribute  it and/or modify it</span>
<span class="cm"> *  under  the terms of  the GNU General  Public License as published by the</span>
<span class="cm"> *  Free Software Foundation;  either version 2 of the  License, or (at your</span>
<span class="cm"> *  option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __MFD_WM831X_CORE_H__</span>
<span class="cp">#define __MFD_WM831X_CORE_H__</span>

<span class="cp">#include &lt;linux/completion.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>
<span class="cp">#include &lt;linux/irqdomain.h&gt;</span>
<span class="cp">#include &lt;linux/list.h&gt;</span>
<span class="cp">#include &lt;linux/regmap.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Register values.</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_RESET_ID                         0x00</span>
<span class="cp">#define WM831X_REVISION                         0x01</span>
<span class="cp">#define WM831X_PARENT_ID                        0x4000</span>
<span class="cp">#define WM831X_SYSVDD_CONTROL                   0x4001</span>
<span class="cp">#define WM831X_THERMAL_MONITORING               0x4002</span>
<span class="cp">#define WM831X_POWER_STATE                      0x4003</span>
<span class="cp">#define WM831X_WATCHDOG                         0x4004</span>
<span class="cp">#define WM831X_ON_PIN_CONTROL                   0x4005</span>
<span class="cp">#define WM831X_RESET_CONTROL                    0x4006</span>
<span class="cp">#define WM831X_CONTROL_INTERFACE                0x4007</span>
<span class="cp">#define WM831X_SECURITY_KEY                     0x4008</span>
<span class="cp">#define WM831X_SOFTWARE_SCRATCH                 0x4009</span>
<span class="cp">#define WM831X_OTP_CONTROL                      0x400A</span>
<span class="cp">#define WM831X_GPIO_LEVEL                       0x400C</span>
<span class="cp">#define WM831X_SYSTEM_STATUS                    0x400D</span>
<span class="cp">#define WM831X_ON_SOURCE                        0x400E</span>
<span class="cp">#define WM831X_OFF_SOURCE                       0x400F</span>
<span class="cp">#define WM831X_SYSTEM_INTERRUPTS                0x4010</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_1               0x4011</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_2               0x4012</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_3               0x4013</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_4               0x4014</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_5               0x4015</span>
<span class="cp">#define WM831X_IRQ_CONFIG                       0x4017</span>
<span class="cp">#define WM831X_SYSTEM_INTERRUPTS_MASK           0x4018</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_1_MASK          0x4019</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_2_MASK          0x401A</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_3_MASK          0x401B</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_4_MASK          0x401C</span>
<span class="cp">#define WM831X_INTERRUPT_STATUS_5_MASK          0x401D</span>
<span class="cp">#define WM831X_RTC_WRITE_COUNTER                0x4020</span>
<span class="cp">#define WM831X_RTC_TIME_1                       0x4021</span>
<span class="cp">#define WM831X_RTC_TIME_2                       0x4022</span>
<span class="cp">#define WM831X_RTC_ALARM_1                      0x4023</span>
<span class="cp">#define WM831X_RTC_ALARM_2                      0x4024</span>
<span class="cp">#define WM831X_RTC_CONTROL                      0x4025</span>
<span class="cp">#define WM831X_RTC_TRIM                         0x4026</span>
<span class="cp">#define WM831X_TOUCH_CONTROL_1                  0x4028</span>
<span class="cp">#define WM831X_TOUCH_CONTROL_2                  0x4029</span>
<span class="cp">#define WM831X_TOUCH_DATA_X                     0x402A</span>
<span class="cp">#define WM831X_TOUCH_DATA_Y                     0x402B</span>
<span class="cp">#define WM831X_TOUCH_DATA_Z                     0x402C</span>
<span class="cp">#define WM831X_AUXADC_DATA                      0x402D</span>
<span class="cp">#define WM831X_AUXADC_CONTROL                   0x402E</span>
<span class="cp">#define WM831X_AUXADC_SOURCE                    0x402F</span>
<span class="cp">#define WM831X_COMPARATOR_CONTROL               0x4030</span>
<span class="cp">#define WM831X_COMPARATOR_1                     0x4031</span>
<span class="cp">#define WM831X_COMPARATOR_2                     0x4032</span>
<span class="cp">#define WM831X_COMPARATOR_3                     0x4033</span>
<span class="cp">#define WM831X_COMPARATOR_4                     0x4034</span>
<span class="cp">#define WM831X_GPIO1_CONTROL                    0x4038</span>
<span class="cp">#define WM831X_GPIO2_CONTROL                    0x4039</span>
<span class="cp">#define WM831X_GPIO3_CONTROL                    0x403A</span>
<span class="cp">#define WM831X_GPIO4_CONTROL                    0x403B</span>
<span class="cp">#define WM831X_GPIO5_CONTROL                    0x403C</span>
<span class="cp">#define WM831X_GPIO6_CONTROL                    0x403D</span>
<span class="cp">#define WM831X_GPIO7_CONTROL                    0x403E</span>
<span class="cp">#define WM831X_GPIO8_CONTROL                    0x403F</span>
<span class="cp">#define WM831X_GPIO9_CONTROL                    0x4040</span>
<span class="cp">#define WM831X_GPIO10_CONTROL                   0x4041</span>
<span class="cp">#define WM831X_GPIO11_CONTROL                   0x4042</span>
<span class="cp">#define WM831X_GPIO12_CONTROL                   0x4043</span>
<span class="cp">#define WM831X_GPIO13_CONTROL                   0x4044</span>
<span class="cp">#define WM831X_GPIO14_CONTROL                   0x4045</span>
<span class="cp">#define WM831X_GPIO15_CONTROL                   0x4046</span>
<span class="cp">#define WM831X_GPIO16_CONTROL                   0x4047</span>
<span class="cp">#define WM831X_CHARGER_CONTROL_1                0x4048</span>
<span class="cp">#define WM831X_CHARGER_CONTROL_2                0x4049</span>
<span class="cp">#define WM831X_CHARGER_STATUS                   0x404A</span>
<span class="cp">#define WM831X_BACKUP_CHARGER_CONTROL           0x404B</span>
<span class="cp">#define WM831X_STATUS_LED_1                     0x404C</span>
<span class="cp">#define WM831X_STATUS_LED_2                     0x404D</span>
<span class="cp">#define WM831X_CURRENT_SINK_1                   0x404E</span>
<span class="cp">#define WM831X_CURRENT_SINK_2                   0x404F</span>
<span class="cp">#define WM831X_DCDC_ENABLE                      0x4050</span>
<span class="cp">#define WM831X_LDO_ENABLE                       0x4051</span>
<span class="cp">#define WM831X_DCDC_STATUS                      0x4052</span>
<span class="cp">#define WM831X_LDO_STATUS                       0x4053</span>
<span class="cp">#define WM831X_DCDC_UV_STATUS                   0x4054</span>
<span class="cp">#define WM831X_LDO_UV_STATUS                    0x4055</span>
<span class="cp">#define WM831X_DC1_CONTROL_1                    0x4056</span>
<span class="cp">#define WM831X_DC1_CONTROL_2                    0x4057</span>
<span class="cp">#define WM831X_DC1_ON_CONFIG                    0x4058</span>
<span class="cp">#define WM831X_DC1_SLEEP_CONTROL                0x4059</span>
<span class="cp">#define WM831X_DC1_DVS_CONTROL                  0x405A</span>
<span class="cp">#define WM831X_DC2_CONTROL_1                    0x405B</span>
<span class="cp">#define WM831X_DC2_CONTROL_2                    0x405C</span>
<span class="cp">#define WM831X_DC2_ON_CONFIG                    0x405D</span>
<span class="cp">#define WM831X_DC2_SLEEP_CONTROL                0x405E</span>
<span class="cp">#define WM831X_DC2_DVS_CONTROL                  0x405F</span>
<span class="cp">#define WM831X_DC3_CONTROL_1                    0x4060</span>
<span class="cp">#define WM831X_DC3_CONTROL_2                    0x4061</span>
<span class="cp">#define WM831X_DC3_ON_CONFIG                    0x4062</span>
<span class="cp">#define WM831X_DC3_SLEEP_CONTROL                0x4063</span>
<span class="cp">#define WM831X_DC4_CONTROL                      0x4064</span>
<span class="cp">#define WM831X_DC4_SLEEP_CONTROL                0x4065</span>
<span class="cp">#define WM832X_DC4_SLEEP_CONTROL                0x4067</span>
<span class="cp">#define WM831X_EPE1_CONTROL                     0x4066</span>
<span class="cp">#define WM831X_EPE2_CONTROL                     0x4067</span>
<span class="cp">#define WM831X_LDO1_CONTROL                     0x4068</span>
<span class="cp">#define WM831X_LDO1_ON_CONTROL                  0x4069</span>
<span class="cp">#define WM831X_LDO1_SLEEP_CONTROL               0x406A</span>
<span class="cp">#define WM831X_LDO2_CONTROL                     0x406B</span>
<span class="cp">#define WM831X_LDO2_ON_CONTROL                  0x406C</span>
<span class="cp">#define WM831X_LDO2_SLEEP_CONTROL               0x406D</span>
<span class="cp">#define WM831X_LDO3_CONTROL                     0x406E</span>
<span class="cp">#define WM831X_LDO3_ON_CONTROL                  0x406F</span>
<span class="cp">#define WM831X_LDO3_SLEEP_CONTROL               0x4070</span>
<span class="cp">#define WM831X_LDO4_CONTROL                     0x4071</span>
<span class="cp">#define WM831X_LDO4_ON_CONTROL                  0x4072</span>
<span class="cp">#define WM831X_LDO4_SLEEP_CONTROL               0x4073</span>
<span class="cp">#define WM831X_LDO5_CONTROL                     0x4074</span>
<span class="cp">#define WM831X_LDO5_ON_CONTROL                  0x4075</span>
<span class="cp">#define WM831X_LDO5_SLEEP_CONTROL               0x4076</span>
<span class="cp">#define WM831X_LDO6_CONTROL                     0x4077</span>
<span class="cp">#define WM831X_LDO6_ON_CONTROL                  0x4078</span>
<span class="cp">#define WM831X_LDO6_SLEEP_CONTROL               0x4079</span>
<span class="cp">#define WM831X_LDO7_CONTROL                     0x407A</span>
<span class="cp">#define WM831X_LDO7_ON_CONTROL                  0x407B</span>
<span class="cp">#define WM831X_LDO7_SLEEP_CONTROL               0x407C</span>
<span class="cp">#define WM831X_LDO8_CONTROL                     0x407D</span>
<span class="cp">#define WM831X_LDO8_ON_CONTROL                  0x407E</span>
<span class="cp">#define WM831X_LDO8_SLEEP_CONTROL               0x407F</span>
<span class="cp">#define WM831X_LDO9_CONTROL                     0x4080</span>
<span class="cp">#define WM831X_LDO9_ON_CONTROL                  0x4081</span>
<span class="cp">#define WM831X_LDO9_SLEEP_CONTROL               0x4082</span>
<span class="cp">#define WM831X_LDO10_CONTROL                    0x4083</span>
<span class="cp">#define WM831X_LDO10_ON_CONTROL                 0x4084</span>
<span class="cp">#define WM831X_LDO10_SLEEP_CONTROL              0x4085</span>
<span class="cp">#define WM831X_LDO11_ON_CONTROL                 0x4087</span>
<span class="cp">#define WM831X_LDO11_SLEEP_CONTROL              0x4088</span>
<span class="cp">#define WM831X_POWER_GOOD_SOURCE_1              0x408E</span>
<span class="cp">#define WM831X_POWER_GOOD_SOURCE_2              0x408F</span>
<span class="cp">#define WM831X_CLOCK_CONTROL_1                  0x4090</span>
<span class="cp">#define WM831X_CLOCK_CONTROL_2                  0x4091</span>
<span class="cp">#define WM831X_FLL_CONTROL_1                    0x4092</span>
<span class="cp">#define WM831X_FLL_CONTROL_2                    0x4093</span>
<span class="cp">#define WM831X_FLL_CONTROL_3                    0x4094</span>
<span class="cp">#define WM831X_FLL_CONTROL_4                    0x4095</span>
<span class="cp">#define WM831X_FLL_CONTROL_5                    0x4096</span>
<span class="cp">#define WM831X_UNIQUE_ID_1                      0x7800</span>
<span class="cp">#define WM831X_UNIQUE_ID_2                      0x7801</span>
<span class="cp">#define WM831X_UNIQUE_ID_3                      0x7802</span>
<span class="cp">#define WM831X_UNIQUE_ID_4                      0x7803</span>
<span class="cp">#define WM831X_UNIQUE_ID_5                      0x7804</span>
<span class="cp">#define WM831X_UNIQUE_ID_6                      0x7805</span>
<span class="cp">#define WM831X_UNIQUE_ID_7                      0x7806</span>
<span class="cp">#define WM831X_UNIQUE_ID_8                      0x7807</span>
<span class="cp">#define WM831X_FACTORY_OTP_ID                   0x7808</span>
<span class="cp">#define WM831X_FACTORY_OTP_1                    0x7809</span>
<span class="cp">#define WM831X_FACTORY_OTP_2                    0x780A</span>
<span class="cp">#define WM831X_FACTORY_OTP_3                    0x780B</span>
<span class="cp">#define WM831X_FACTORY_OTP_4                    0x780C</span>
<span class="cp">#define WM831X_FACTORY_OTP_5                    0x780D</span>
<span class="cp">#define WM831X_CUSTOMER_OTP_ID                  0x7810</span>
<span class="cp">#define WM831X_DC1_OTP_CONTROL                  0x7811</span>
<span class="cp">#define WM831X_DC2_OTP_CONTROL                  0x7812</span>
<span class="cp">#define WM831X_DC3_OTP_CONTROL                  0x7813</span>
<span class="cp">#define WM831X_LDO1_2_OTP_CONTROL               0x7814</span>
<span class="cp">#define WM831X_LDO3_4_OTP_CONTROL               0x7815</span>
<span class="cp">#define WM831X_LDO5_6_OTP_CONTROL               0x7816</span>
<span class="cp">#define WM831X_LDO7_8_OTP_CONTROL               0x7817</span>
<span class="cp">#define WM831X_LDO9_10_OTP_CONTROL              0x7818</span>
<span class="cp">#define WM831X_LDO11_EPE_CONTROL                0x7819</span>
<span class="cp">#define WM831X_GPIO1_OTP_CONTROL                0x781A</span>
<span class="cp">#define WM831X_GPIO2_OTP_CONTROL                0x781B</span>
<span class="cp">#define WM831X_GPIO3_OTP_CONTROL                0x781C</span>
<span class="cp">#define WM831X_GPIO4_OTP_CONTROL                0x781D</span>
<span class="cp">#define WM831X_GPIO5_OTP_CONTROL                0x781E</span>
<span class="cp">#define WM831X_GPIO6_OTP_CONTROL                0x781F</span>
<span class="cp">#define WM831X_DBE_CHECK_DATA                   0x7827</span>

<span class="cm">/*</span>
<span class="cm"> * R0 (0x00) - Reset ID</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_CHIP_ID_MASK                     0xFFFF  </span><span class="cm">/* CHIP_ID - [15:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CHIP_ID_SHIFT                         0  </span><span class="cm">/* CHIP_ID - [15:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CHIP_ID_WIDTH                        16  </span><span class="cm">/* CHIP_ID - [15:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R1 (0x01) - Revision</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_PARENT_REV_MASK                  0xFF00  </span><span class="cm">/* PARENT_REV - [15:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_PARENT_REV_SHIFT                      8  </span><span class="cm">/* PARENT_REV - [15:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_PARENT_REV_WIDTH                      8  </span><span class="cm">/* PARENT_REV - [15:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CHILD_REV_MASK                   0x00FF  </span><span class="cm">/* CHILD_REV - [7:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CHILD_REV_SHIFT                       0  </span><span class="cm">/* CHILD_REV - [7:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CHILD_REV_WIDTH                       8  </span><span class="cm">/* CHILD_REV - [7:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16384 (0x4000) - Parent ID</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_PARENT_ID_MASK                   0xFFFF  </span><span class="cm">/* PARENT_ID - [15:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_PARENT_ID_SHIFT                       0  </span><span class="cm">/* PARENT_ID - [15:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_PARENT_ID_WIDTH                      16  </span><span class="cm">/* PARENT_ID - [15:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16389 (0x4005) - ON Pin Control</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_ON_PIN_SECACT_MASK               0x0300  </span><span class="cm">/* ON_PIN_SECACT - [9:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_SECACT_SHIFT                   8  </span><span class="cm">/* ON_PIN_SECACT - [9:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_SECACT_WIDTH                   2  </span><span class="cm">/* ON_PIN_SECACT - [9:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_PRIMACT_MASK              0x0030  </span><span class="cm">/* ON_PIN_PRIMACT - [5:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_PRIMACT_SHIFT                  4  </span><span class="cm">/* ON_PIN_PRIMACT - [5:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_PRIMACT_WIDTH                  2  </span><span class="cm">/* ON_PIN_PRIMACT - [5:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_STS                       0x0008  </span><span class="cm">/* ON_PIN_STS */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_STS_MASK                  0x0008  </span><span class="cm">/* ON_PIN_STS */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_STS_SHIFT                      3  </span><span class="cm">/* ON_PIN_STS */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_STS_WIDTH                      1  </span><span class="cm">/* ON_PIN_STS */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_TO_MASK                   0x0003  </span><span class="cm">/* ON_PIN_TO - [1:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_TO_SHIFT                       0  </span><span class="cm">/* ON_PIN_TO - [1:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_ON_PIN_TO_WIDTH                       2  </span><span class="cm">/* ON_PIN_TO - [1:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16528 (0x4090) - Clock Control 1</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_CLKOUT_ENA                       0x8000  </span><span class="cm">/* CLKOUT_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_ENA_MASK                  0x8000  </span><span class="cm">/* CLKOUT_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_ENA_SHIFT                     15  </span><span class="cm">/* CLKOUT_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_ENA_WIDTH                      1  </span><span class="cm">/* CLKOUT_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_OD                        0x2000  </span><span class="cm">/* CLKOUT_OD */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_OD_MASK                   0x2000  </span><span class="cm">/* CLKOUT_OD */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_OD_SHIFT                      13  </span><span class="cm">/* CLKOUT_OD */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_OD_WIDTH                       1  </span><span class="cm">/* CLKOUT_OD */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SLOT_MASK                 0x0700  </span><span class="cm">/* CLKOUT_SLOT - [10:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SLOT_SHIFT                     8  </span><span class="cm">/* CLKOUT_SLOT - [10:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SLOT_WIDTH                     3  </span><span class="cm">/* CLKOUT_SLOT - [10:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SLPSLOT_MASK              0x0070  </span><span class="cm">/* CLKOUT_SLPSLOT - [6:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SLPSLOT_SHIFT                  4  </span><span class="cm">/* CLKOUT_SLPSLOT - [6:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SLPSLOT_WIDTH                  3  </span><span class="cm">/* CLKOUT_SLPSLOT - [6:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SRC                       0x0001  </span><span class="cm">/* CLKOUT_SRC */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SRC_MASK                  0x0001  </span><span class="cm">/* CLKOUT_SRC */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SRC_SHIFT                      0  </span><span class="cm">/* CLKOUT_SRC */</span><span class="cp"></span>
<span class="cp">#define WM831X_CLKOUT_SRC_WIDTH                      1  </span><span class="cm">/* CLKOUT_SRC */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16529 (0x4091) - Clock Control 2</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_XTAL_INH                         0x8000  </span><span class="cm">/* XTAL_INH */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_INH_MASK                    0x8000  </span><span class="cm">/* XTAL_INH */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_INH_SHIFT                       15  </span><span class="cm">/* XTAL_INH */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_INH_WIDTH                        1  </span><span class="cm">/* XTAL_INH */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_ENA                         0x2000  </span><span class="cm">/* XTAL_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_ENA_MASK                    0x2000  </span><span class="cm">/* XTAL_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_ENA_SHIFT                       13  </span><span class="cm">/* XTAL_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_ENA_WIDTH                        1  </span><span class="cm">/* XTAL_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_BKUPENA                     0x1000  </span><span class="cm">/* XTAL_BKUPENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_BKUPENA_MASK                0x1000  </span><span class="cm">/* XTAL_BKUPENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_BKUPENA_SHIFT                   12  </span><span class="cm">/* XTAL_BKUPENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_XTAL_BKUPENA_WIDTH                    1  </span><span class="cm">/* XTAL_BKUPENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_AUTO                         0x0080  </span><span class="cm">/* FLL_AUTO */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_AUTO_MASK                    0x0080  </span><span class="cm">/* FLL_AUTO */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_AUTO_SHIFT                        7  </span><span class="cm">/* FLL_AUTO */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_AUTO_WIDTH                        1  </span><span class="cm">/* FLL_AUTO */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_AUTO_FREQ_MASK               0x0007  </span><span class="cm">/* FLL_AUTO_FREQ - [2:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_AUTO_FREQ_SHIFT                   0  </span><span class="cm">/* FLL_AUTO_FREQ - [2:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_AUTO_FREQ_WIDTH                   3  </span><span class="cm">/* FLL_AUTO_FREQ - [2:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16530 (0x4092) - FLL Control 1</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_FLL_FRAC                         0x0004  </span><span class="cm">/* FLL_FRAC */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_FRAC_MASK                    0x0004  </span><span class="cm">/* FLL_FRAC */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_FRAC_SHIFT                        2  </span><span class="cm">/* FLL_FRAC */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_FRAC_WIDTH                        1  </span><span class="cm">/* FLL_FRAC */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_OSC_ENA                      0x0002  </span><span class="cm">/* FLL_OSC_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_OSC_ENA_MASK                 0x0002  </span><span class="cm">/* FLL_OSC_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_OSC_ENA_SHIFT                     1  </span><span class="cm">/* FLL_OSC_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_OSC_ENA_WIDTH                     1  </span><span class="cm">/* FLL_OSC_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_ENA                          0x0001  </span><span class="cm">/* FLL_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_ENA_MASK                     0x0001  </span><span class="cm">/* FLL_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_ENA_SHIFT                         0  </span><span class="cm">/* FLL_ENA */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_ENA_WIDTH                         1  </span><span class="cm">/* FLL_ENA */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16531 (0x4093) - FLL Control 2</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_FLL_OUTDIV_MASK                  0x3F00  </span><span class="cm">/* FLL_OUTDIV - [13:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_OUTDIV_SHIFT                      8  </span><span class="cm">/* FLL_OUTDIV - [13:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_OUTDIV_WIDTH                      6  </span><span class="cm">/* FLL_OUTDIV - [13:8] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CTRL_RATE_MASK               0x0070  </span><span class="cm">/* FLL_CTRL_RATE - [6:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CTRL_RATE_SHIFT                   4  </span><span class="cm">/* FLL_CTRL_RATE - [6:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CTRL_RATE_WIDTH                   3  </span><span class="cm">/* FLL_CTRL_RATE - [6:4] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_FRATIO_MASK                  0x0007  </span><span class="cm">/* FLL_FRATIO - [2:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_FRATIO_SHIFT                      0  </span><span class="cm">/* FLL_FRATIO - [2:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_FRATIO_WIDTH                      3  </span><span class="cm">/* FLL_FRATIO - [2:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16532 (0x4094) - FLL Control 3</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_FLL_K_MASK                       0xFFFF  </span><span class="cm">/* FLL_K - [15:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_K_SHIFT                           0  </span><span class="cm">/* FLL_K - [15:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_K_WIDTH                          16  </span><span class="cm">/* FLL_K - [15:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16533 (0x4095) - FLL Control 4</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_FLL_N_MASK                       0x7FE0  </span><span class="cm">/* FLL_N - [14:5] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_N_SHIFT                           5  </span><span class="cm">/* FLL_N - [14:5] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_N_WIDTH                          10  </span><span class="cm">/* FLL_N - [14:5] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_GAIN_MASK                    0x000F  </span><span class="cm">/* FLL_GAIN - [3:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_GAIN_SHIFT                        0  </span><span class="cm">/* FLL_GAIN - [3:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_GAIN_WIDTH                        4  </span><span class="cm">/* FLL_GAIN - [3:0] */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * R16534 (0x4096) - FLL Control 5</span>
<span class="cm"> */</span>
<span class="cp">#define WM831X_FLL_CLK_REF_DIV_MASK             0x0018  </span><span class="cm">/* FLL_CLK_REF_DIV - [4:3] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CLK_REF_DIV_SHIFT                 3  </span><span class="cm">/* FLL_CLK_REF_DIV - [4:3] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CLK_REF_DIV_WIDTH                 2  </span><span class="cm">/* FLL_CLK_REF_DIV - [4:3] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CLK_SRC_MASK                 0x0003  </span><span class="cm">/* FLL_CLK_SRC - [1:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CLK_SRC_SHIFT                     0  </span><span class="cm">/* FLL_CLK_SRC - [1:0] */</span><span class="cp"></span>
<span class="cp">#define WM831X_FLL_CLK_SRC_WIDTH                     2  </span><span class="cm">/* FLL_CLK_SRC - [1:0] */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">regulator_dev</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">irq_domain</span><span class="p">;</span>

<span class="cp">#define WM831X_NUM_IRQ_REGS 5</span>
<span class="cp">#define WM831X_NUM_GPIO_REGS 16</span>

<span class="k">enum</span> <span class="n">wm831x_parent</span> <span class="p">{</span>
	<span class="n">WM8310</span> <span class="o">=</span> <span class="mh">0x8310</span><span class="p">,</span>
	<span class="n">WM8311</span> <span class="o">=</span> <span class="mh">0x8311</span><span class="p">,</span>
	<span class="n">WM8312</span> <span class="o">=</span> <span class="mh">0x8312</span><span class="p">,</span>
	<span class="n">WM8320</span> <span class="o">=</span> <span class="mh">0x8320</span><span class="p">,</span>
	<span class="n">WM8321</span> <span class="o">=</span> <span class="mh">0x8321</span><span class="p">,</span>
	<span class="n">WM8325</span> <span class="o">=</span> <span class="mh">0x8325</span><span class="p">,</span>
	<span class="n">WM8326</span> <span class="o">=</span> <span class="mh">0x8326</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">wm831x</span><span class="p">;</span>
<span class="k">enum</span> <span class="n">wm831x_auxadc</span><span class="p">;</span>

<span class="k">typedef</span> <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">wm831x_auxadc_read_fn</span><span class="p">)(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span>
				     <span class="k">enum</span> <span class="n">wm831x_auxadc</span> <span class="n">input</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">wm831x</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">io_lock</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">regmap</span> <span class="o">*</span><span class="n">regmap</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">irq</span><span class="p">;</span>  <span class="cm">/* Our chip IRQ */</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">irq_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">irq_domain</span> <span class="o">*</span><span class="n">irq_domain</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">irq_masks_cur</span><span class="p">[</span><span class="n">WM831X_NUM_IRQ_REGS</span><span class="p">];</span>   <span class="cm">/* Currently active value */</span>
	<span class="kt">int</span> <span class="n">irq_masks_cache</span><span class="p">[</span><span class="n">WM831X_NUM_IRQ_REGS</span><span class="p">];</span> <span class="cm">/* Cached hardware value */</span>

	<span class="n">bool</span> <span class="n">soft_shutdown</span><span class="p">;</span>

	<span class="cm">/* Chip revision based flags */</span>
	<span class="kt">unsigned</span> <span class="n">has_gpio_ena</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>         <span class="cm">/* Has GPIO enable bit */</span>
	<span class="kt">unsigned</span> <span class="n">has_cs_sts</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>           <span class="cm">/* Has current sink status bit */</span>
	<span class="kt">unsigned</span> <span class="n">charger_irq_wake</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>     <span class="cm">/* Are charger IRQs a wake source? */</span>

	<span class="kt">int</span> <span class="n">num_gpio</span><span class="p">;</span>

	<span class="cm">/* Used by the interrupt controller code to post writes */</span>
	<span class="kt">int</span> <span class="n">gpio_update</span><span class="p">[</span><span class="n">WM831X_NUM_GPIO_REGS</span><span class="p">];</span>
	<span class="n">bool</span> <span class="n">gpio_level_high</span><span class="p">[</span><span class="n">WM831X_NUM_GPIO_REGS</span><span class="p">];</span>
	<span class="n">bool</span> <span class="n">gpio_level_low</span><span class="p">[</span><span class="n">WM831X_NUM_GPIO_REGS</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">auxadc_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">auxadc_pending</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">auxadc_active</span><span class="p">;</span>
	<span class="n">wm831x_auxadc_read_fn</span> <span class="n">auxadc_read</span><span class="p">;</span>

	<span class="cm">/* The WM831x has a security key blocking access to certain</span>
<span class="cm">	 * registers.  The mutex is taken by the accessors for locking</span>
<span class="cm">	 * and unlocking the security key, locked is used to fail</span>
<span class="cm">	 * writes if the lock is held.</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">key_lock</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">locked</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Device I/O API */</span>
<span class="kt">int</span> <span class="n">wm831x_reg_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">wm831x_reg_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">val</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">wm831x_reg_lock</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">wm831x_reg_unlock</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">wm831x_set_bits</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span>
		    <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">mask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">val</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">wm831x_bulk_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span>
		     <span class="kt">int</span> <span class="n">count</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="n">buf</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">wm831x_device_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">irq</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">wm831x_device_exit</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">wm831x_device_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">wm831x_device_shutdown</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">wm831x_irq_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">irq</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">wm831x_irq_exit</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">wm831x_auxadc_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">wm831x_irq</span><span class="p">(</span><span class="k">struct</span> <span class="n">wm831x</span> <span class="o">*</span><span class="n">wm831x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">irq</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">irq_create_mapping</span><span class="p">(</span><span class="n">wm831x</span><span class="o">-&gt;</span><span class="n">irq_domain</span><span class="p">,</span> <span class="n">irq</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">regmap_config</span> <span class="n">wm831x_regmap_config</span><span class="p">;</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
