<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › atmmpc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>atmmpc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _ATMMPC_H_</span>
<span class="cp">#define _ATMMPC_H_</span>

<span class="cp">#include &lt;linux/atmapi.h&gt;</span>
<span class="cp">#include &lt;linux/atmioc.h&gt;</span>
<span class="cp">#include &lt;linux/atm.h&gt;</span>
<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cp">#define ATMMPC_CTRL _IO(&#39;a&#39;, ATMIOC_MPOA)</span>
<span class="cp">#define ATMMPC_DATA _IO(&#39;a&#39;, ATMIOC_MPOA+1)</span>

<span class="cp">#define MPC_SOCKET_INGRESS 1</span>
<span class="cp">#define MPC_SOCKET_EGRESS  2</span>

<span class="k">struct</span> <span class="n">atmmpc_ioc</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">dev_num</span><span class="p">;</span>
        <span class="n">__be32</span> <span class="n">ipaddr</span><span class="p">;</span>              <span class="cm">/* the IP address of the shortcut    */</span>
        <span class="kt">int</span> <span class="n">type</span><span class="p">;</span>                     <span class="cm">/* ingress or egress                 */</span>
<span class="p">};</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">in_ctrl_info</span> <span class="p">{</span>
        <span class="n">__u8</span>   <span class="n">Last_NHRP_CIE_code</span><span class="p">;</span>
        <span class="n">__u8</span>   <span class="n">Last_Q2931_cause_value</span><span class="p">;</span>
        <span class="n">__u8</span>   <span class="n">eg_MPC_ATM_addr</span><span class="p">[</span><span class="n">ATM_ESA_LEN</span><span class="p">];</span>
        <span class="n">__be32</span>  <span class="n">tag</span><span class="p">;</span>
        <span class="n">__be32</span>  <span class="n">in_dst_ip</span><span class="p">;</span>      <span class="cm">/* IP address this ingress MPC sends packets to */</span>
        <span class="n">__u16</span>  <span class="n">holding_time</span><span class="p">;</span>
        <span class="n">__u32</span>  <span class="n">request_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">in_ctrl_info</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">eg_ctrl_info</span> <span class="p">{</span>
        <span class="n">__u8</span>   <span class="n">DLL_header</span><span class="p">[</span><span class="mi">256</span><span class="p">];</span>
        <span class="n">__u8</span>   <span class="n">DH_length</span><span class="p">;</span>
        <span class="n">__be32</span>  <span class="n">cache_id</span><span class="p">;</span>
        <span class="n">__be32</span>  <span class="n">tag</span><span class="p">;</span>
        <span class="n">__be32</span>  <span class="n">mps_ip</span><span class="p">;</span>
        <span class="n">__be32</span>  <span class="n">eg_dst_ip</span><span class="p">;</span>      <span class="cm">/* IP address to which ingress MPC sends packets */</span>
        <span class="n">__u8</span>   <span class="n">in_MPC_data_ATM_addr</span><span class="p">[</span><span class="n">ATM_ESA_LEN</span><span class="p">];</span>
        <span class="n">__u16</span>  <span class="n">holding_time</span><span class="p">;</span>
<span class="p">}</span> <span class="n">eg_ctrl_info</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">mpc_parameters</span> <span class="p">{</span>
        <span class="n">__u16</span> <span class="n">mpc_p1</span><span class="p">;</span>   <span class="cm">/* Shortcut-Setup Frame Count    */</span>
        <span class="n">__u16</span> <span class="n">mpc_p2</span><span class="p">;</span>   <span class="cm">/* Shortcut-Setup Frame Time     */</span>
        <span class="n">__u8</span> <span class="n">mpc_p3</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="cm">/* Flow-detection Protocols      */</span>
        <span class="n">__u16</span> <span class="n">mpc_p4</span><span class="p">;</span>   <span class="cm">/* MPC Initial Retry Time        */</span>
        <span class="n">__u16</span> <span class="n">mpc_p5</span><span class="p">;</span>   <span class="cm">/* MPC Retry Time Maximum        */</span>
        <span class="n">__u16</span> <span class="n">mpc_p6</span><span class="p">;</span>   <span class="cm">/* Hold Down Time                */</span>
<span class="p">}</span> <span class="p">;</span>

<span class="k">struct</span> <span class="n">k_message</span> <span class="p">{</span>
        <span class="n">__u16</span> <span class="n">type</span><span class="p">;</span>
        <span class="n">__be32</span> <span class="n">ip_mask</span><span class="p">;</span>
        <span class="n">__u8</span>  <span class="n">MPS_ctrl</span><span class="p">[</span><span class="n">ATM_ESA_LEN</span><span class="p">];</span>
        <span class="k">union</span> <span class="p">{</span>
                <span class="n">in_ctrl_info</span> <span class="n">in_info</span><span class="p">;</span>
                <span class="n">eg_ctrl_info</span> <span class="n">eg_info</span><span class="p">;</span>
                <span class="k">struct</span> <span class="n">mpc_parameters</span> <span class="n">params</span><span class="p">;</span>
        <span class="p">}</span> <span class="n">content</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">atm_qos</span> <span class="n">qos</span><span class="p">;</span>       
<span class="p">}</span> <span class="n">__ATM_API_ALIGN</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">llc_snap_hdr</span> <span class="p">{</span>
	<span class="cm">/* RFC 1483 LLC/SNAP encapsulation for routed IP PDUs */</span>
        <span class="n">__u8</span>  <span class="n">dsap</span><span class="p">;</span>    <span class="cm">/* Destination Service Access Point (0xAA)     */</span>
        <span class="n">__u8</span>  <span class="n">ssap</span><span class="p">;</span>    <span class="cm">/* Source Service Access Point      (0xAA)     */</span>
        <span class="n">__u8</span>  <span class="n">ui</span><span class="p">;</span>      <span class="cm">/* Unnumbered Information           (0x03)     */</span>
        <span class="n">__u8</span>  <span class="n">org</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>  <span class="cm">/* Organizational identification    (0x000000) */</span>
        <span class="n">__u8</span>  <span class="n">type</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="cm">/* Ether type (for IP)              (0x0800)   */</span>
<span class="p">};</span>

<span class="cm">/* TLVs this MPC recognizes */</span>
<span class="cp">#define TLV_MPOA_DEVICE_TYPE         0x00a03e2a  </span>

<span class="cm">/* MPOA device types in MPOA Device Type TLV */</span>
<span class="cp">#define NON_MPOA    0</span>
<span class="cp">#define MPS         1</span>
<span class="cp">#define MPC         2</span>
<span class="cp">#define MPS_AND_MPC 3</span>


<span class="cm">/* MPC parameter defaults */</span>

<span class="cp">#define MPC_P1 10  </span><span class="cm">/* Shortcut-Setup Frame Count  */</span><span class="cp"> </span>
<span class="cp">#define MPC_P2 1   </span><span class="cm">/* Shortcut-Setup Frame Time   */</span><span class="cp"></span>
<span class="cp">#define MPC_P3 0   </span><span class="cm">/* Flow-detection Protocols    */</span><span class="cp"></span>
<span class="cp">#define MPC_P4 5   </span><span class="cm">/* MPC Initial Retry Time      */</span><span class="cp"></span>
<span class="cp">#define MPC_P5 40  </span><span class="cm">/* MPC Retry Time Maximum      */</span><span class="cp"></span>
<span class="cp">#define MPC_P6 160 </span><span class="cm">/* Hold Down Time              */</span><span class="cp"></span>
<span class="cp">#define HOLDING_TIME_DEFAULT 1200 </span><span class="cm">/* same as MPS-p7 */</span><span class="cp"></span>

<span class="cm">/* MPC constants */</span>

<span class="cp">#define MPC_C1 2   </span><span class="cm">/* Retry Time Multiplier       */</span><span class="cp"></span>
<span class="cp">#define MPC_C2 60  </span><span class="cm">/* Initial Keep-Alive Lifetime */</span><span class="cp"></span>

<span class="cm">/* Message types - to MPOA daemon */</span>

<span class="cp">#define SND_MPOA_RES_RQST    201</span>
<span class="cp">#define SET_MPS_CTRL_ADDR    202</span>
<span class="cp">#define SND_MPOA_RES_RTRY    203 </span><span class="cm">/* Different type in a retry due to req id         */</span><span class="cp"></span>
<span class="cp">#define STOP_KEEP_ALIVE_SM   204</span>
<span class="cp">#define EGRESS_ENTRY_REMOVED 205</span>
<span class="cp">#define SND_EGRESS_PURGE     206</span>
<span class="cp">#define DIE                  207 </span><span class="cm">/* tell the daemon to exit()                       */</span><span class="cp"></span>
<span class="cp">#define DATA_PLANE_PURGE     208 </span><span class="cm">/* Data plane purge because of egress cache hit miss or dead MPS */</span><span class="cp"></span>
<span class="cp">#define OPEN_INGRESS_SVC     209</span>

<span class="cm">/* Message types - from MPOA daemon */</span>

<span class="cp">#define MPOA_TRIGGER_RCVD     101</span>
<span class="cp">#define MPOA_RES_REPLY_RCVD   102</span>
<span class="cp">#define INGRESS_PURGE_RCVD    103</span>
<span class="cp">#define EGRESS_PURGE_RCVD     104</span>
<span class="cp">#define MPS_DEATH             105</span>
<span class="cp">#define CACHE_IMPOS_RCVD      106</span>
<span class="cp">#define SET_MPC_CTRL_ADDR     107 </span><span class="cm">/* Our MPC&#39;s control ATM address   */</span><span class="cp"></span>
<span class="cp">#define SET_MPS_MAC_ADDR      108</span>
<span class="cp">#define CLEAN_UP_AND_EXIT     109</span>
<span class="cp">#define SET_MPC_PARAMS        110 </span><span class="cm">/* MPC configuration parameters    */</span><span class="cp"></span>

<span class="cm">/* Message types - bidirectional */</span>       

<span class="cp">#define RELOAD                301 </span><span class="cm">/* kill -HUP the daemon for reload */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _ATMMPC_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
