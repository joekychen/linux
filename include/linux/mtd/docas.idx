f | gpmi-nand.h | s | 2.9K | 62 | Huang Shijie | b32955@freescale.com | 1336969339 |  | mtd: gpmi: add device tree support to gpmi-nand  This patch just adds the DT support to gpmi-nand.  Signed-off-by: Huang Shijie <b32955@freescale.com> Signed-off-by: Huang Shijie <shijie8@gmail.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | fsmc.h | s | 4.5K | 153 | Stefan Roese | sr@denx.de | 1332806467 |  | mtd: Add device-tree support to fsmc_nand  This patch adds support to configure the FSMC NAND driver (used amongst others on SPEAr platforms) via device-tree instead of platform_data.  Signed-off-by: Stefan Roese <sr@denx.de> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | onenand.h | s | 8.0K | 210 | Kyungmin Park | kyungmin.park@samsung.com | 1315742533 |  | mtd: OneNAND: Detect the correct NOP when 4KiB pagesize  There are two different 4KiB pagesize chips KFM4G16Q4M series have NOP 4 with version ID 0x0131 But KFM4G16Q5M has NOP 1 with versoin ID 0x013e  Note that Q5M means that it has NOP 1.  Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com>
f | nand_bch.h | s | 1.7K | 58 | Ivan Djelic | ivan.djelic@parrot.com | 1299865748 |  | mtd: nand: add software BCH ECC support  This patch adds software BCH ECC support to mtd, in order to handle recent NAND device ecc requirements (4 bits or more).  It does so by adding a new ecc mode (NAND_ECC_SOFT_BCH) for use by board drivers, and a new Kconfig option to enable BCH support. It relies on the generic BCH library introduced in a previous patch.  When a board driver uses mode NAND_ECC_SOFT_BCH, it should also set fields chip->ecc.size and chip->ecc.bytes to select BCH ecc data size and required error correction capability. See nand_bch_init() documentation for details.  It has been tested on the following platforms using mtd-utils, UBI and UBIFS: x86 (with nandsim), arm926ejs.  Signed-off-by: Ivan Djelic <ivan.djelic@parrot.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | cfi_endian.h | s | 2.1K | 47 | Aaron Sierra | asierra@xes-inc.com | 1326132373 |  | mtd: cfi: Allow per-mapping CFI device endianness  This patch allows each CFI device map to use its own endianness. The globally defined CFI endianness (CONFIG_MTD_CFI_NOSWAP, CONFIG_MTD_CFI_BE_BYTE_SWAP or CONFIG_MTD_CFI_LE_BYTE_SWAP) becomes the default value which can be overridden by a driver for a particular device.  Signed-off-by: Aaron Sierra <asierra@xes-inc.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | inftl.h | s | 1.6K | 51 | Brian Norris | norris@broadcom.com | 1287959244 |  | mtd: inftl.h: fix spacing errors  Replaced some spaces with tabs to fit CodingStyle guidelines  Signed-off-by: Brian Norris <norris@broadcom.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | gen_probe.h | s | 1.3K | 32 | David Woodhouse | David.Woodhouse@intel.com | 1281297500 |  | mtd: Update copyright notices  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | pfow.h | s | 5.6K | 147 | Alexey Korolev | akorolev@infradead.org | 1231160158 |  | [MTD] LPDDR PFOW definition  LPDDR chips use PFOW window for sending commands, reading status and capabilites requesting. This pfow.h - contains definitions for PFOW window fileds, possible commands, error flags and some common macro function to avoid code duplications.  Signed-off-by: Alexey Korolev <akorolev@infradead.org> Acked-by: Jared Hulbert <jaredeh@gmail.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | nand.h | s | 22K | 616 | Shmulik Ladkani | shmulik.ladkani@gmail.com | 1336969480 |  | mtd: nand: remove 'sndcmd' parameter of 'read_oob/read_oob_raw'  As of [mtd: nand: remove autoincrement 'sndcmd' code], the NAND_CMD_READ0 command is issued unconditionally.  Thus, read_oob/read_oob_raw's 'sndcmd' argument is no longer needed, as well as their return code.  Remove the 'sndcmd' parameter, and set the return code to 0.  Signed-off-by: Shmulik Ladkani <shmulik.ladkani@gmail.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | onenand_regs.h | s | 7.1K | 200 | Adrian Hunter | adrian.hunter@nokia.com | 1297986285 |  | OMAP: OneNAND: fix 104MHz support  104MHz needs a latency of 8 clock cycles and the VHF flag must be set.  Also t_rdyo is specified as "not applicable" so pick a lower value, and force at least 1 clk between AVD High to OE Low.  Signed-off-by: Adrian Hunter <adrian.hunter@nokia.com> Signed-off-by: Tony Lindgren <tony@atomide.com>
f | nftl.h | s | 2.4K | 62 | David Woodhouse | David.Woodhouse@intel.com | 1281297500 |  | mtd: Update copyright notices  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | plat-ram.h | s | 795B | 28 | Adrian Bunk | bunk@kernel.org | 1212598217 |  | MTD/JFFS2: remove CVS keywords  Once upon a time, the MTD repository was using CVS.  This patch therefore removes all usages of the no longer updated CVS keywords from the MTD code.  This also includes code that printed them to the user.  Signed-off-by: Adrian Bunk <bunk@kernel.org> Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | map.h | s | 12K | 401 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | xip.h | s | 2.6K | 82 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | ftl.h | s | 2.5K | 67 | David Woodhouse | David.Woodhouse@intel.com | 1228918002 |  | [MTD] Remove strange u_int32_t types from FTL  Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | qinfo.h | s | 2.4K | 81 | Alexey Korolev | akorolev@infradead.org | 1231160154 |  | [MTD] LPDDR QINFO records definitions  There are declaraton of structures and macros definitions necessary for operations with QINFO in this patch.  Signed-off-by: Alexey Korolev <akorolev@infradead.org> Acked-by: Jared Hulbert <jaredeh@gmail.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | partitions.h | s | 2.6K | 72 | Dmitry Eremin-Solenikov | dbaryshkov@gmail.com | 1315742533 |  | mtd: remove put_partition_parser() from public header  There is no need to pollute public header with a definition private to mtdpart.c. Move it from mtd/partitions.h to mtdpart.c  Signed-off-by: Dmitry Eremin-Solenikov <dbaryshkov@gmail.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com>
f | blktrans.h | s | 2.8K | 81 | Alexander Stein | alexander.stein@systec-electronic.com | 1332803471 |  | mtd: mtdblock: call mtd_sync() only if opened for write  Because it is useless to call it if the device is opened in R/O mode, and also harmful: on CFI NOR flash it may block for long time waiting for erase operations to complete is another partition with a R/W file-system on this chip.  Artem Bityutskiy: write commit message, amend the patch to match the latest tree (we use mtd_sync(), not mtd->sync() nowadays).  Signed-off-by: Alexander Stein <alexander.stein@systec-electronic.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | ndfc.h | s | 2.2K | 59 | Thomas Gleixner | tglx@cruncher.tec.linutronix.de | 1148908009 |  | [MTD] NAND Fix platform structure and NDFC driver  The platform structure was lacking an oobinfo field. The NDFC driver had some remains from another tree.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | latch-addr-flash.h | s | 716B | 24 | David Griego | dgriego@mvista.com | 1299853367 |  | mtd: NOR flash driver for OMAP-L137/AM17x  OMAP-L137/AM17x has limited number of dedicated EMIFA address pins, enough to interface directly to an SDRAM. If a device such as an asynchronous flash needs to be attached to the EMIFA, then either GPIO pins or a chip select may be used to control the flash device's upper address lines.  This patch adds support for the NOR flash on the OMAP-L137/ AM17x user interface daughter board using the latch-addr-flash MTD mapping driver which allows flashes to be partially physically addressed. The upper address lines are set by a board specific code which is a separate patch.  Signed-off-by: David Griego <dgriego@mvista.com> Signed-off-by: Aleksey Makarov <amakarov@ru.mvista.com> Signed-off-by: Sergei Shtylyov <sshtylyov@ru.mvista.com> Signed-off-by: Savinay Dharmappa <savinay.dharmappa@ti.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | cfi.h | s | 14K | 492 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | bbm.h | s | 6.2K | 160 | Brian Norris | computersforpeace@gmail.com | 1332804422 |  | mtd: nand: write BBM to OOB even with flash-based BBT  Currently, the flash-based BBT implementation writes bad block data only to its flash-based table and not to the OOB marker area. Then, as new bad blocks are marked over time, the OOB markers become incomplete and the flash-based table becomes the only source of current bad block information. This becomes an obvious problem when, for example:   * bootloader cannot read the flash-based BBT format  * BBT is corrupted and the flash must be rescanned for bad    blocks; we want to remember bad blocks that were marked from Linux  So to keep the bad block markers in sync with the flash-based BBT, this patch changes the default so that we write bad block markers to the proper OOB area on each block in addition to flash-based BBT. Comments are updated, expanded, and/or relocated as necessary.  The new flash-based BBT procedure for marking bad blocks:  (1) erase the affected block, to allow OOB marker to be written cleanly  (2) update in-memory BBT  (3) write bad block marker to OOB area of affected block  (4) update flash-based BBT Note that we retain the first error encountered in (3) or (4), finish the procedures, and dump the error in the end.  This should handle power cuts gracefully enough. (1) and (2) are mostly harmless (note that (1) will not erase an already-recognized bad block). The OOB and BBT may be "out of sync" if we experience power loss bewteen (3) and (4), but we can reasonably expect that on next boot, subsequent I/O operations will discover that the block should be marked bad again, thus re-syncing the OOB and BBT.  Note that this is a change from the previous default flash-based BBT behavior. If your system cannot support writing bad block markers to OOB, use the new NAND_BBT_NO_OOB_BBM option (in combination with NAND_BBT_USE_FLASH and NAND_BBT_NO_OOB).  Signed-off-by: Brian Norris <computersforpeace@gmail.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | flashchip.h | s | 3.0K | 97 | David Woodhouse | David.Woodhouse@intel.com | 1281297500 |  | mtd: Update copyright notices  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | sharpsl.h | s | 541B | 18 | Dmitry Baryshkov | dbaryshkov@gmail.com | 1225303598 |  | [MTD] sharpsl-nand: use platform_data for model-specific values  Add platform_data which holds all model-specific values, like badblocks pattern, oobinfo, partitions.  Signed-off-by: Dmitry Baryshkov <dbaryshkov@gmail.com>
f | mtd.h | s | 13K | 356 | Mike Dunn | mikedunn@newsguy.com | 1336968699 |  | mtd: bitflip_threshold added to mtd_info and sysfs  An element 'bitflip_threshold' is added to struct mtd_info, and also exposed as a read/write variable in sysfs.  This will be used to determine whether or not mtd_read() returns -EUCLEAN or 0 (absent a hard error).  If the driver leaves it as zero, mtd will set it to a default value of ecc_strength.  This v2 adds the line that propagates bitflip_threshold from the master to the partitions - thanks Ivan¹.  ¹ http://lists.infradead.org/pipermail/linux-mtd/2012-April/040900.html  Signed-off-by: Mike Dunn <mikedunn@newsguy.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | spear_smi.h | s | 1.7K | 57 | Stefan Roese | sr@denx.de | 1332806481 |  | mtd: add device-tree support to spear_smi  This patch adds support to configure the SPEAr SMI driver via device-tree instead of platform_data.  Signed-off-by: Stefan Roese <sr@denx.de> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | ubi.h | s | 8.8K | 220 | Joel Reardon | joel@clambassador.com | 1337589281 |  | UBI: modify ubi_wl_flush function to clear work queue for a lnum  This patch modifies ubi_wl_flush to force the erasure of particular volume id / logical eraseblock number pairs. Previous functionality is preserved when passing UBI_ALL for both values. The locations where ubi_wl_flush were called are appropriately changed: ubi_leb_erase only flushes for the erased LEB, and ubi_create_volume forces only flushing for its volume id. External code can call this new feature via the new function ubi_flush() added to kapi.c, which simply passes through to ubi_wl_flush().  This was tested by disabling the call to do_work in ubi thread, which results in the work queue remaining unless explicitly called to remove. UBIFS was changed to call ubifs_leb_change 50 times for four different LEBs. Then the new function was called to clear the queue: passing wrong volume ids / lnum, correct ones, and finally UBI_ALL for both to ensure it was finally all cleard. The work queue was dumped each time and the selective removal of the particular LEB numbers was observed. Extra checks were enabled and ubifs's integck was also run. Finally, the drive was repeatedly filled and emptied to ensure that the queue was cleared normally.  Artem: amended the patch.  Signed-off-by: Joel Reardon <reardonj@inf.ethz.ch> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com>
f | concat.h | s | 1.1K | 28 | David Woodhouse | David.Woodhouse@intel.com | 1281297500 |  | mtd: Update copyright notices  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | nand_ecc.h | s | 1.1K | 35 | David Woodhouse | David.Woodhouse@intel.com | 1281297500 |  | mtd: Update copyright notices  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | doc2000.h | s | 6.0K | 176 | David Woodhouse | David.Woodhouse@intel.com | 1281297500 |  | mtd: Update copyright notices  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | mtdram.h | s | 212B | 6 | Andrea Gelmini | andrea.gelmini@gelma.net | 1273497090 |  | mtd: mtdram.h: checkpatch cleanup  include/linux/mtd/mtdram.h:6: ERROR: code indent should use tabs where possible  Signed-off-by: Andrea Gelmini <andrea.gelmini@gelma.net> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | pismo.h | s | 440B | 15 | Russell King - ARM Linux | linux@arm.linux.org.uk | 1263373493 |  | mtd: Really add ARM pismo support  (Commit 7cb777a3d71f9d1f7eb149c7a504d21f24219ae8 (mtd: add ARM pismo support) intended to add this, but seems only to have patched the Makefile without touching Kconfig or providing any code...)  The following patch adds support for PISMO modules found on ARM Ltd development platforms.  These are MTD modules, and can have a selection of SRAM, flash or DOC devices as described by an on-board I2C EEPROM.  We support SRAM and NOR flash devices only by registering appropriate conventional MTD platform devices as children of the 'pismo' device.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | sh_flctl.h | s | 5.8K | 153 | Bastian Hecht | hechtb@googlemail.com | 1332806014 |  | mtd: sh_flctl: Add power management with QoS request  Adds power management code with fine granularity. Every flash control command is enclosed by runtime_put()/get()s. To make sure that no overhead is generated by too frequent power state switches, a quality of service request is issued.  Signed-off-by: Bastian Hecht <hechtb@gmail.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | physmap.h | s | 1018B | 31 | Jonas Gorski | jonas.gorski@gmail.com | 1326132975 |  | mtd: maps: physmap: allow partition parsers for physmap_flash_data  Arch setup code might want to use their own partition parsers, but still use the generic physmap flash driver.  Signed-off-by: Jonas Gorski <jonas.gorski@gmail.com> Acked-by: Florian Fainelli <florian@openwrt.org> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | super.h | s | 835B | 22 | Al Viro | viro@zeniv.linux.org.uk | 1288340186 |  | convert get_sb_mtd() users to ->mount()  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | nand-gpio.h | s | 363B | 16 | Mike Rapoport | mike@compulab.co.il | 1224330522 |  | [MTD] [NAND] GPIO NAND flash driver  The patch adds support for NAND flashes connected to GPIOs.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk> Signed-off-by: Mike Rapoport <mike@compulab.co.il> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
