<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › bcma › bcma_driver_pci.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>bcma_driver_pci.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef LINUX_BCMA_DRIVER_PCI_H_</span>
<span class="cp">#define LINUX_BCMA_DRIVER_PCI_H_</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="k">struct</span> <span class="n">pci_dev</span><span class="p">;</span>

<span class="cm">/** PCI core registers. **/</span>
<span class="cp">#define BCMA_CORE_PCI_CTL			0x0000	</span><span class="cm">/* PCI Control */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_CTL_RST_OE		0x00000001 </span><span class="cm">/* PCI_RESET Output Enable */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_CTL_RST			0x00000002 </span><span class="cm">/* PCI_RESET driven out to pin */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_CTL_CLK_OE		0x00000004 </span><span class="cm">/* Clock gate Output Enable */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_CTL_CLK			0x00000008 </span><span class="cm">/* Gate for clock driven out to pin */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_ARBCTL			0x0010	</span><span class="cm">/* PCI Arbiter Control */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ARBCTL_INTERN		0x00000001 </span><span class="cm">/* Use internal arbiter */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ARBCTL_EXTERN		0x00000002 </span><span class="cm">/* Use external arbiter */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ARBCTL_PARKID		0x00000006 </span><span class="cm">/* Mask, selects which agent is parked on an idle bus */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_ARBCTL_PARKID_LAST	0x00000000 </span><span class="cm">/* Last requestor */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_ARBCTL_PARKID_4710	0x00000002 </span><span class="cm">/* 4710 */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_ARBCTL_PARKID_EXT0	0x00000004 </span><span class="cm">/* External requestor 0 */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_ARBCTL_PARKID_EXT1	0x00000006 </span><span class="cm">/* External requestor 1 */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_ISTAT			0x0020	</span><span class="cm">/* Interrupt status */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ISTAT_INTA		0x00000001 </span><span class="cm">/* PCI INTA# */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ISTAT_INTB		0x00000002 </span><span class="cm">/* PCI INTB# */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ISTAT_SERR		0x00000004 </span><span class="cm">/* PCI SERR# (write to clear) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ISTAT_PERR		0x00000008 </span><span class="cm">/* PCI PERR# (write to clear) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ISTAT_PME		0x00000010 </span><span class="cm">/* PCI PME# */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_IMASK			0x0024	</span><span class="cm">/* Interrupt mask */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_IMASK_INTA		0x00000001 </span><span class="cm">/* PCI INTA# */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_IMASK_INTB		0x00000002 </span><span class="cm">/* PCI INTB# */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_IMASK_SERR		0x00000004 </span><span class="cm">/* PCI SERR# */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_IMASK_PERR		0x00000008 </span><span class="cm">/* PCI PERR# */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_IMASK_PME		0x00000010 </span><span class="cm">/* PCI PME# */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_MBOX			0x0028	</span><span class="cm">/* Backplane to PCI Mailbox */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F0_0		0x00000100 </span><span class="cm">/* PCI function 0, INT 0 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F0_1		0x00000200 </span><span class="cm">/* PCI function 0, INT 1 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F1_0		0x00000400 </span><span class="cm">/* PCI function 1, INT 0 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F1_1		0x00000800 </span><span class="cm">/* PCI function 1, INT 1 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F2_0		0x00001000 </span><span class="cm">/* PCI function 2, INT 0 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F2_1		0x00002000 </span><span class="cm">/* PCI function 2, INT 1 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F3_0		0x00004000 </span><span class="cm">/* PCI function 3, INT 0 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MBOX_F3_1		0x00008000 </span><span class="cm">/* PCI function 3, INT 1 */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_BCAST_ADDR		0x0050	</span><span class="cm">/* Backplane Broadcast Address */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_BCAST_ADDR_MASK		0x000000FF</span>
<span class="cp">#define BCMA_CORE_PCI_BCAST_DATA		0x0054	</span><span class="cm">/* Backplane Broadcast Data */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_GPIO_IN			0x0060	</span><span class="cm">/* rev &gt;= 2 only */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_GPIO_OUT			0x0064	</span><span class="cm">/* rev &gt;= 2 only */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_GPIO_ENABLE		0x0068	</span><span class="cm">/* rev &gt;= 2 only */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_GPIO_CTL			0x006C	</span><span class="cm">/* rev &gt;= 2 only */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI0			0x0100	</span><span class="cm">/* Backplane to PCI translation 0 (sbtopci0) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SBTOPCI0_MASK		0xFC000000</span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI1			0x0104	</span><span class="cm">/* Backplane to PCI translation 1 (sbtopci1) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SBTOPCI1_MASK		0xFC000000</span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI2			0x0108	</span><span class="cm">/* Backplane to PCI translation 2 (sbtopci2) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SBTOPCI2_MASK		0xC0000000</span>
<span class="cp">#define BCMA_CORE_PCI_CONFIG_ADDR		0x0120	</span><span class="cm">/* pcie config space access */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CONFIG_DATA		0x0124	</span><span class="cm">/* pcie config space access */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_MDIO_CONTROL		0x0128	</span><span class="cm">/* controls the mdio access */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIOCTL_DIVISOR_MASK	0x7f	</span><span class="cm">/* clock to be used on MDIO */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIOCTL_DIVISOR_VAL	0x2</span>
<span class="cp">#define  BCMA_CORE_PCI_MDIOCTL_PREAM_EN		0x80	</span><span class="cm">/* Enable preamble sequnce */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIOCTL_ACCESS_DONE	0x100	</span><span class="cm">/* Tranaction complete */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_MDIO_DATA			0x012c	</span><span class="cm">/* Data to the mdio access */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_MASK		0x0000ffff </span><span class="cm">/* data 2 bytes */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_TA		0x00020000 </span><span class="cm">/* Turnaround */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_REGADDR_SHF_OLD	18	</span><span class="cm">/* Regaddr shift (rev &lt; 10) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_REGADDR_MASK_OLD	0x003c0000 </span><span class="cm">/* Regaddr Mask (rev &lt; 10) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEVADDR_SHF_OLD	22	</span><span class="cm">/* Physmedia devaddr shift (rev &lt; 10) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEVADDR_MASK_OLD	0x0fc00000 </span><span class="cm">/* Physmedia devaddr Mask (rev &lt; 10) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_REGADDR_SHF	18	</span><span class="cm">/* Regaddr shift */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_REGADDR_MASK	0x007c0000 </span><span class="cm">/* Regaddr Mask */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEVADDR_SHF	23	</span><span class="cm">/* Physmedia devaddr shift */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEVADDR_MASK	0x0f800000 </span><span class="cm">/* Physmedia devaddr Mask */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_WRITE		0x10000000 </span><span class="cm">/* write Transaction */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_READ		0x20000000 </span><span class="cm">/* Read Transaction */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_START		0x40000000 </span><span class="cm">/* start of Transaction */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEV_ADDR	0x0	</span><span class="cm">/* dev address for serdes */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_BLK_ADDR	0x1F	</span><span class="cm">/* blk address for serdes */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEV_PLL		0x1d	</span><span class="cm">/* SERDES PLL Dev */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEV_TX		0x1e	</span><span class="cm">/* SERDES TX Dev */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_MDIODATA_DEV_RX		0x1f	</span><span class="cm">/* SERDES RX Dev */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PCIEIND_ADDR		0x0130	</span><span class="cm">/* indirect access to the internal register */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PCIEIND_DATA		0x0134	</span><span class="cm">/* Data to/from the internal regsiter */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CLKREQENCTRL		0x0138	</span><span class="cm">/*  &gt;= rev 6, Clkreq rdma control */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PCICFG0			0x0400	</span><span class="cm">/* PCI config space 0 (rev &gt;= 8) */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PCICFG1			0x0500	</span><span class="cm">/* PCI config space 1 (rev &gt;= 8) */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PCICFG2			0x0600	</span><span class="cm">/* PCI config space 2 (rev &gt;= 8) */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PCICFG3			0x0700	</span><span class="cm">/* PCI config space 3 (rev &gt;= 8) */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SPROM(wordoffset)		(0x0800 + ((wordoffset) * 2)) </span><span class="cm">/* SPROM shadow area (72 bytes) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SPROM_PI_OFFSET		0	</span><span class="cm">/* first word */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_SPROM_PI_MASK		0xf000	</span><span class="cm">/* bit 15:12 */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_SPROM_PI_SHIFT		12	</span><span class="cm">/* bit 15:12 */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SPROM_MISC_CONFIG	5	</span><span class="cm">/* word 5 */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_SPROM_L23READY_EXIT_NOPERST	0x8000	</span><span class="cm">/* bit 15 */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_SPROM_CLKREQ_OFFSET_REV5	20	</span><span class="cm">/* word 20 for srom rev &lt;= 5 */</span><span class="cp"></span>
<span class="cp">#define   BCMA_CORE_PCI_SPROM_CLKREQ_ENB	0x0800	</span><span class="cm">/* bit 11 */</span><span class="cp"></span>

<span class="cm">/* SBtoPCIx */</span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_MEM		0x00000000</span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_IO		0x00000001</span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_CFG0		0x00000002</span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_CFG1		0x00000003</span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_PREF		0x00000004 </span><span class="cm">/* Prefetch enable */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_BURST		0x00000008 </span><span class="cm">/* Burst enable */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_MRM		0x00000020 </span><span class="cm">/* Memory Read Multiple */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SBTOPCI_RC		0x00000030 </span><span class="cm">/* Read Command mask (rev &gt;= 11) */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SBTOPCI_RC_READ		0x00000000 </span><span class="cm">/* Memory read */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SBTOPCI_RC_READL		0x00000010 </span><span class="cm">/* Memory read line */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SBTOPCI_RC_READM		0x00000020 </span><span class="cm">/* Memory read multiple */</span><span class="cp"></span>

<span class="cm">/* PCIE protocol PHY diagnostic registers */</span>
<span class="cp">#define BCMA_CORE_PCI_PLP_MODEREG		0x200	</span><span class="cm">/* Mode */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_STATUSREG		0x204	</span><span class="cm">/* Status */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_PLP_POLARITYINV_STAT	0x10	</span><span class="cm">/* Status reg PCIE_PLP_STATUSREG */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_LTSSMCTRLREG		0x208	</span><span class="cm">/* LTSSM control */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_LTLINKNUMREG		0x20c	</span><span class="cm">/* Link Training Link number */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_LTLANENUMREG		0x210	</span><span class="cm">/* Link Training Lane number */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_LTNFTSREG		0x214	</span><span class="cm">/* Link Training N_FTS */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_ATTNREG		0x218	</span><span class="cm">/* Attention */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_ATTNMASKREG		0x21C	</span><span class="cm">/* Attention Mask */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_RXERRCTR		0x220	</span><span class="cm">/* Rx Error */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_RXFRMERRCTR		0x224	</span><span class="cm">/* Rx Framing Error */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_RXERRTHRESHREG	0x228	</span><span class="cm">/* Rx Error threshold */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_TESTCTRLREG		0x22C	</span><span class="cm">/* Test Control reg */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_SERDESCTRLOVRDREG	0x230	</span><span class="cm">/* SERDES Control Override */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_TIMINGOVRDREG		0x234	</span><span class="cm">/* Timing param override */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_RXTXSMDIAGREG		0x238	</span><span class="cm">/* RXTX State Machine Diag */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLP_LTSSMDIAGREG		0x23C	</span><span class="cm">/* LTSSM State Machine Diag */</span><span class="cp"></span>

<span class="cm">/* PCIE protocol DLLP diagnostic registers */</span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_LCREG		0x100	</span><span class="cm">/* Link Control */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_LSREG		0x104	</span><span class="cm">/* Link Status */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_LAREG		0x108	</span><span class="cm">/* Link Attention */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_DLLP_LSREG_LINKUP	(1 &lt;&lt; 16)</span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_LAMASKREG		0x10C	</span><span class="cm">/* Link Attention Mask */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_NEXTTXSEQNUMREG	0x110	</span><span class="cm">/* Next Tx Seq Num */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_ACKEDTXSEQNUMREG	0x114	</span><span class="cm">/* Acked Tx Seq Num */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_PURGEDTXSEQNUMREG	0x118	</span><span class="cm">/* Purged Tx Seq Num */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_RXSEQNUMREG		0x11C	</span><span class="cm">/* Rx Sequence Number */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_LRREG		0x120	</span><span class="cm">/* Link Replay */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_LACKTOREG		0x124	</span><span class="cm">/* Link Ack Timeout */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_PMTHRESHREG		0x128	</span><span class="cm">/* Power Management Threshold */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_ASPMTIMER_EXTEND		0x01000000 </span><span class="cm">/* &gt; rev7: enable extend ASPM timer */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_RTRYWPREG		0x12C	</span><span class="cm">/* Retry buffer write ptr */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_RTRYRPREG		0x130	</span><span class="cm">/* Retry buffer Read ptr */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_RTRYPPREG		0x134	</span><span class="cm">/* Retry buffer Purged ptr */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_RTRRWREG		0x138	</span><span class="cm">/* Retry buffer Read/Write */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_ECTHRESHREG		0x13C	</span><span class="cm">/* Error Count Threshold */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_TLPERRCTRREG		0x140	</span><span class="cm">/* TLP Error Counter */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_ERRCTRREG		0x144	</span><span class="cm">/* Error Counter */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_NAKRXCTRREG		0x148	</span><span class="cm">/* NAK Received Counter */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_TESTREG		0x14C	</span><span class="cm">/* Test */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_PKTBIST		0x150	</span><span class="cm">/* Packet BIST */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_DLLP_PCIE11		0x154	</span><span class="cm">/* DLLP PCIE 1.1 reg */</span><span class="cp"></span>

<span class="cm">/* SERDES RX registers */</span>
<span class="cp">#define BCMA_CORE_PCI_SERDES_RX_CTRL		1	</span><span class="cm">/* Rx cntrl */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SERDES_RX_CTRL_FORCE	0x80	</span><span class="cm">/* rxpolarity_force */</span><span class="cp"></span>
<span class="cp">#define  BCMA_CORE_PCI_SERDES_RX_CTRL_POLARITY	0x40	</span><span class="cm">/* rxpolarity_value */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SERDES_RX_TIMER1		2	</span><span class="cm">/* Rx Timer1 */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SERDES_RX_CDR		6	</span><span class="cm">/* CDR */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_SERDES_RX_CDRBW		7	</span><span class="cm">/* CDR BW */</span><span class="cp"></span>

<span class="cm">/* SERDES PLL registers */</span>
<span class="cp">#define BCMA_CORE_PCI_SERDES_PLL_CTRL		1	</span><span class="cm">/* PLL control reg */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_PLL_CTRL_FREQDET_EN	0x4000	</span><span class="cm">/* bit 14 is FREQDET on */</span><span class="cp"></span>

<span class="cm">/* PCIcore specific boardflags */</span>
<span class="cp">#define BCMA_CORE_PCI_BFL_NOPCI			0x00000400 </span><span class="cm">/* Board leaves PCI floating */</span><span class="cp"></span>

<span class="cm">/* PCIE Config space accessing MACROS */</span>
<span class="cp">#define BCMA_CORE_PCI_CFG_BUS_SHIFT		24	</span><span class="cm">/* Bus shift */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CFG_SLOT_SHIFT		19	</span><span class="cm">/* Slot/Device shift */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CFG_FUN_SHIFT		16	</span><span class="cm">/* Function shift */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CFG_OFF_SHIFT		0	</span><span class="cm">/* Register shift */</span><span class="cp"></span>

<span class="cp">#define BCMA_CORE_PCI_CFG_BUS_MASK		0xff	</span><span class="cm">/* Bus mask */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CFG_SLOT_MASK		0x1f	</span><span class="cm">/* Slot/Device mask */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CFG_FUN_MASK		7	</span><span class="cm">/* Function mask */</span><span class="cp"></span>
<span class="cp">#define BCMA_CORE_PCI_CFG_OFF_MASK		0xfff	</span><span class="cm">/* Register mask */</span><span class="cp"></span>

<span class="cm">/* PCIE Root Capability Register bits (Host mode only) */</span>
<span class="cp">#define BCMA_CORE_PCI_RC_CRS_VISIBILITY		0x0001</span>

<span class="k">struct</span> <span class="n">bcma_drv_pci</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_BCMA_DRIVER_PCI_HOSTMODE</span>
<span class="k">struct</span> <span class="n">bcma_drv_pci_host</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bcma_drv_pci</span> <span class="o">*</span><span class="n">pdev</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">host_cfg_addr</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">cfgspace_lock</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">pci_controller</span> <span class="n">pci_controller</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_ops</span> <span class="n">pci_ops</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="n">mem_resource</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="n">io_resource</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="k">struct</span> <span class="n">bcma_drv_pci</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bcma_device</span> <span class="o">*</span><span class="n">core</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">setup_done</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hostmode</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_BCMA_DRIVER_PCI_HOSTMODE</span>
	<span class="k">struct</span> <span class="n">bcma_drv_pci_host</span> <span class="o">*</span><span class="n">host_controller</span><span class="p">;</span>
<span class="cp">#endif</span>
<span class="p">};</span>

<span class="cm">/* Register access */</span>
<span class="cp">#define pcicore_read16(pc, offset)		bcma_read16((pc)-&gt;core, offset)</span>
<span class="cp">#define pcicore_read32(pc, offset)		bcma_read32((pc)-&gt;core, offset)</span>
<span class="cp">#define pcicore_write16(pc, offset, val)	bcma_write16((pc)-&gt;core, offset, val)</span>
<span class="cp">#define pcicore_write32(pc, offset, val)	bcma_write32((pc)-&gt;core, offset, val)</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">__devinit</span> <span class="n">bcma_core_pci_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">bcma_drv_pci</span> <span class="o">*</span><span class="n">pc</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">bcma_core_pci_irq_ctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">bcma_drv_pci</span> <span class="o">*</span><span class="n">pc</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">bcma_device</span> <span class="o">*</span><span class="n">core</span><span class="p">,</span> <span class="n">bool</span> <span class="n">enable</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">bcma_core_pci_extend_L1timer</span><span class="p">(</span><span class="k">struct</span> <span class="n">bcma_drv_pci</span> <span class="o">*</span><span class="n">pc</span><span class="p">,</span> <span class="n">bool</span> <span class="n">extend</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">bcma_core_pci_pcibios_map_irq</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">bcma_core_pci_plat_dev_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* LINUX_BCMA_DRIVER_PCI_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
