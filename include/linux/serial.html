<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › serial.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>serial.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * include/linux/serial.h</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1992 by Theodore Ts&#39;o.</span>
<span class="cm"> * </span>
<span class="cm"> * Redistribution of this file is permitted under the terms of the GNU </span>
<span class="cm"> * Public License (GPL)</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_SERIAL_H</span>
<span class="cp">#define _LINUX_SERIAL_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#include &lt;asm/page.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Counters of the input lines (CTS, DSR, RI, CD) interrupts</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">async_icount</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">cts</span><span class="p">,</span> <span class="n">dsr</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">dcd</span><span class="p">,</span> <span class="n">tx</span><span class="p">,</span> <span class="n">rx</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">frame</span><span class="p">,</span> <span class="n">parity</span><span class="p">,</span> <span class="n">overrun</span><span class="p">,</span> <span class="n">brk</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">buf_overrun</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * The size of the serial xmit buffer is 1 page, or 4096 bytes</span>
<span class="cm"> */</span>
<span class="cp">#define SERIAL_XMIT_SIZE PAGE_SIZE</span>

<span class="cp">#endif</span>

<span class="k">struct</span> <span class="n">serial_struct</span> <span class="p">{</span>
	<span class="kt">int</span>	<span class="n">type</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">line</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">port</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">irq</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">xmit_fifo_size</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">custom_divisor</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">baud_base</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">close_delay</span><span class="p">;</span>
	<span class="kt">char</span>	<span class="n">io_type</span><span class="p">;</span>
	<span class="kt">char</span>	<span class="n">reserved_char</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="kt">int</span>	<span class="n">hub6</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">closing_wait</span><span class="p">;</span> <span class="cm">/* time to wait before closing */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">closing_wait2</span><span class="p">;</span> <span class="cm">/* no longer used... */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">iomem_base</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">iomem_reg_shift</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">port_high</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">iomap_base</span><span class="p">;</span>	<span class="cm">/* cookie passed into ioremap */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * For the close wait times, 0 means wait forever for serial port to</span>
<span class="cm"> * flush its output.  65535 means don&#39;t wait at all.</span>
<span class="cm"> */</span>
<span class="cp">#define ASYNC_CLOSING_WAIT_INF	0</span>
<span class="cp">#define ASYNC_CLOSING_WAIT_NONE	65535</span>

<span class="cm">/*</span>
<span class="cm"> * These are the supported serial types.</span>
<span class="cm"> */</span>
<span class="cp">#define PORT_UNKNOWN	0</span>
<span class="cp">#define PORT_8250	1</span>
<span class="cp">#define PORT_16450	2</span>
<span class="cp">#define PORT_16550	3</span>
<span class="cp">#define PORT_16550A	4</span>
<span class="cp">#define PORT_CIRRUS     5	</span><span class="cm">/* usurped by cyclades.c */</span><span class="cp"></span>
<span class="cp">#define PORT_16650	6</span>
<span class="cp">#define PORT_16650V2	7</span>
<span class="cp">#define PORT_16750	8</span>
<span class="cp">#define PORT_STARTECH	9	</span><span class="cm">/* usurped by cyclades.c */</span><span class="cp"></span>
<span class="cp">#define PORT_16C950	10	</span><span class="cm">/* Oxford Semiconductor */</span><span class="cp"></span>
<span class="cp">#define PORT_16654	11</span>
<span class="cp">#define PORT_16850	12</span>
<span class="cp">#define PORT_RSA	13	</span><span class="cm">/* RSA-DV II/S card */</span><span class="cp"></span>
<span class="cp">#define PORT_MAX	13</span>

<span class="cp">#define SERIAL_IO_PORT	0</span>
<span class="cp">#define SERIAL_IO_HUB6	1</span>
<span class="cp">#define SERIAL_IO_MEM	2</span>

<span class="k">struct</span> <span class="n">serial_uart_config</span> <span class="p">{</span>
	<span class="kt">char</span>	<span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">dfl_xmit_fifo_size</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define UART_CLEAR_FIFO		0x01</span>
<span class="cp">#define UART_USE_FIFO		0x02</span>
<span class="cp">#define UART_STARTECH		0x04</span>
<span class="cp">#define UART_NATSEMI		0x08</span>

<span class="cm">/*</span>
<span class="cm"> * Definitions for async_struct (and serial_struct) flags field</span>
<span class="cm"> *</span>
<span class="cm"> * Define ASYNCB_* for convenient use with {test,set,clear}_bit.</span>
<span class="cm"> */</span>
<span class="cp">#define ASYNCB_HUP_NOTIFY	 0 </span><span class="cm">/* Notify getty on hangups and closes</span>
<span class="cm">				    * on the callout port */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_FOURPORT		 1 </span><span class="cm">/* Set OU1, OUT2 per AST Fourport settings */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SAK		 2 </span><span class="cm">/* Secure Attention Key (Orange book) */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SPLIT_TERMIOS	 3 </span><span class="cm">/* Separate termios for dialin/callout */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SPD_HI		 4 </span><span class="cm">/* Use 56000 instead of 38400 bps */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SPD_VHI		 5 </span><span class="cm">/* Use 115200 instead of 38400 bps */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SKIP_TEST	 6 </span><span class="cm">/* Skip UART test during autoconfiguration */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_AUTO_IRQ		 7 </span><span class="cm">/* Do automatic IRQ during</span>
<span class="cm">				    * autoconfiguration */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SESSION_LOCKOUT	 8 </span><span class="cm">/* Lock out cua opens based on session */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_PGRP_LOCKOUT	 9 </span><span class="cm">/* Lock out cua opens based on pgrp */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_CALLOUT_NOHUP	10 </span><span class="cm">/* Don&#39;t do hangups for cua device */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_HARDPPS_CD	11 </span><span class="cm">/* Call hardpps when CD goes high  */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SPD_SHI		12 </span><span class="cm">/* Use 230400 instead of 38400 bps */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_LOW_LATENCY	13 </span><span class="cm">/* Request low latency behaviour */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_BUGGY_UART	14 </span><span class="cm">/* This is a buggy UART, skip some safety</span>
<span class="cm">				    * checks.  Note: can be dangerous! */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_AUTOPROBE	15 </span><span class="cm">/* Port was autoprobed by PCI or PNP code */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_LAST_USER	15</span>

<span class="cm">/* Internal flags used only by kernel */</span>
<span class="cp">#define ASYNCB_INITIALIZED	31 </span><span class="cm">/* Serial port was initialized */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SUSPENDED	30 </span><span class="cm">/* Serial port is suspended */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_NORMAL_ACTIVE	29 </span><span class="cm">/* Normal device is active */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_BOOT_AUTOCONF	28 </span><span class="cm">/* Autoconfigure port on bootup */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_CLOSING		27 </span><span class="cm">/* Serial port is closing */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_CTS_FLOW		26 </span><span class="cm">/* Do CTS flow control */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_CHECK_CD		25 </span><span class="cm">/* i.e., CLOCAL */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_SHARE_IRQ	24 </span><span class="cm">/* for multifunction cards, no longer used */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_CONS_FLOW	23 </span><span class="cm">/* flow control for console  */</span><span class="cp"></span>
<span class="cp">#define ASYNCB_FIRST_KERNEL	22</span>

<span class="cp">#define ASYNC_HUP_NOTIFY	(1U &lt;&lt; ASYNCB_HUP_NOTIFY)</span>
<span class="cp">#define ASYNC_SUSPENDED		(1U &lt;&lt; ASYNCB_SUSPENDED)</span>
<span class="cp">#define ASYNC_FOURPORT		(1U &lt;&lt; ASYNCB_FOURPORT)</span>
<span class="cp">#define ASYNC_SAK		(1U &lt;&lt; ASYNCB_SAK)</span>
<span class="cp">#define ASYNC_SPLIT_TERMIOS	(1U &lt;&lt; ASYNCB_SPLIT_TERMIOS)</span>
<span class="cp">#define ASYNC_SPD_HI		(1U &lt;&lt; ASYNCB_SPD_HI)</span>
<span class="cp">#define ASYNC_SPD_VHI		(1U &lt;&lt; ASYNCB_SPD_VHI)</span>
<span class="cp">#define ASYNC_SKIP_TEST		(1U &lt;&lt; ASYNCB_SKIP_TEST)</span>
<span class="cp">#define ASYNC_AUTO_IRQ		(1U &lt;&lt; ASYNCB_AUTO_IRQ)</span>
<span class="cp">#define ASYNC_SESSION_LOCKOUT	(1U &lt;&lt; ASYNCB_SESSION_LOCKOUT)</span>
<span class="cp">#define ASYNC_PGRP_LOCKOUT	(1U &lt;&lt; ASYNCB_PGRP_LOCKOUT)</span>
<span class="cp">#define ASYNC_CALLOUT_NOHUP	(1U &lt;&lt; ASYNCB_CALLOUT_NOHUP)</span>
<span class="cp">#define ASYNC_HARDPPS_CD	(1U &lt;&lt; ASYNCB_HARDPPS_CD)</span>
<span class="cp">#define ASYNC_SPD_SHI		(1U &lt;&lt; ASYNCB_SPD_SHI)</span>
<span class="cp">#define ASYNC_LOW_LATENCY	(1U &lt;&lt; ASYNCB_LOW_LATENCY)</span>
<span class="cp">#define ASYNC_BUGGY_UART	(1U &lt;&lt; ASYNCB_BUGGY_UART)</span>
<span class="cp">#define ASYNC_AUTOPROBE		(1U &lt;&lt; ASYNCB_AUTOPROBE)</span>

<span class="cp">#define ASYNC_FLAGS		((1U &lt;&lt; (ASYNCB_LAST_USER + 1)) - 1)</span>
<span class="cp">#define ASYNC_USR_MASK		(ASYNC_SPD_MASK|ASYNC_CALLOUT_NOHUP| \</span>
<span class="cp">		ASYNC_LOW_LATENCY)</span>
<span class="cp">#define ASYNC_SPD_CUST		(ASYNC_SPD_HI|ASYNC_SPD_VHI)</span>
<span class="cp">#define ASYNC_SPD_WARP		(ASYNC_SPD_HI|ASYNC_SPD_SHI)</span>
<span class="cp">#define ASYNC_SPD_MASK		(ASYNC_SPD_HI|ASYNC_SPD_VHI|ASYNC_SPD_SHI)</span>

<span class="cp">#define ASYNC_INITIALIZED	(1U &lt;&lt; ASYNCB_INITIALIZED)</span>
<span class="cp">#define ASYNC_NORMAL_ACTIVE	(1U &lt;&lt; ASYNCB_NORMAL_ACTIVE)</span>
<span class="cp">#define ASYNC_BOOT_AUTOCONF	(1U &lt;&lt; ASYNCB_BOOT_AUTOCONF)</span>
<span class="cp">#define ASYNC_CLOSING		(1U &lt;&lt; ASYNCB_CLOSING)</span>
<span class="cp">#define ASYNC_CTS_FLOW		(1U &lt;&lt; ASYNCB_CTS_FLOW)</span>
<span class="cp">#define ASYNC_CHECK_CD		(1U &lt;&lt; ASYNCB_CHECK_CD)</span>
<span class="cp">#define ASYNC_SHARE_IRQ		(1U &lt;&lt; ASYNCB_SHARE_IRQ)</span>
<span class="cp">#define ASYNC_CONS_FLOW		(1U &lt;&lt; ASYNCB_CONS_FLOW)</span>
<span class="cp">#define ASYNC_INTERNAL_FLAGS	(~((1U &lt;&lt; ASYNCB_FIRST_KERNEL) - 1))</span>

<span class="cm">/*</span>
<span class="cm"> * Multiport serial configuration structure --- external structure</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">serial_multiport_struct</span> <span class="p">{</span>
	<span class="kt">int</span>		<span class="n">irq</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">port1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">mask1</span><span class="p">,</span> <span class="n">match1</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">port2</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">mask2</span><span class="p">,</span> <span class="n">match2</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">port3</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">mask3</span><span class="p">,</span> <span class="n">match3</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">port4</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">mask4</span><span class="p">,</span> <span class="n">match4</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">port_monitor</span><span class="p">;</span>
	<span class="kt">int</span>	<span class="n">reserved</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Serial input interrupt line counters -- external structure</span>
<span class="cm"> * Four lines can interrupt: CTS, DSR, RI, DCD</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">serial_icounter_struct</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">cts</span><span class="p">,</span> <span class="n">dsr</span><span class="p">,</span> <span class="n">rng</span><span class="p">,</span> <span class="n">dcd</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rx</span><span class="p">,</span> <span class="n">tx</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">frame</span><span class="p">,</span> <span class="n">overrun</span><span class="p">,</span> <span class="n">parity</span><span class="p">,</span> <span class="n">brk</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">buf_overrun</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Serial interface for controlling RS485 settings on chips with suitable</span>
<span class="cm"> * support. Set with TIOCSRS485 and get with TIOCGRS485 if supported by your</span>
<span class="cm"> * platform. The set function returns the new state, with any unsupported bits</span>
<span class="cm"> * reverted appropriately.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">serial_rs485</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>			<span class="cm">/* RS485 feature flags */</span>
<span class="cp">#define SER_RS485_ENABLED		(1 &lt;&lt; 0)	</span><span class="cm">/* If enabled */</span><span class="cp"></span>
<span class="cp">#define SER_RS485_RTS_ON_SEND		(1 &lt;&lt; 1)	</span><span class="cm">/* Logical level for</span>
<span class="cm">							   RTS pin when</span>
<span class="cm">							   sending */</span><span class="cp"></span>
<span class="cp">#define SER_RS485_RTS_AFTER_SEND	(1 &lt;&lt; 2)	</span><span class="cm">/* Logical level for</span>
<span class="cm">							   RTS pin after sent*/</span><span class="cp"></span>
<span class="cp">#define SER_RS485_RX_DURING_TX		(1 &lt;&lt; 4)</span>
	<span class="n">__u32</span>	<span class="n">delay_rts_before_send</span><span class="p">;</span>	<span class="cm">/* Delay before send (milliseconds) */</span>
	<span class="n">__u32</span>	<span class="n">delay_rts_after_send</span><span class="p">;</span>	<span class="cm">/* Delay after send (milliseconds) */</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>		<span class="cm">/* Memory is cheap, new structs</span>
<span class="cm">					   are a royal PITA .. */</span>
<span class="p">};</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#include &lt;linux/compiler.h&gt;</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* _LINUX_SERIAL_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
