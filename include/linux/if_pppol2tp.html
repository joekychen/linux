<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › if_pppol2tp.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>if_pppol2tp.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/***************************************************************************</span>
<span class="cm"> * Linux PPP over L2TP (PPPoL2TP) Socket Implementation (RFC 2661)</span>
<span class="cm"> *</span>
<span class="cm"> * This file supplies definitions required by the PPP over L2TP driver</span>
<span class="cm"> * (l2tp_ppp.c).  All version information wrt this file is located in l2tp_ppp.c</span>
<span class="cm"> *</span>
<span class="cm"> * License:</span>
<span class="cm"> *		This program is free software; you can redistribute it and/or</span>
<span class="cm"> *		modify it under the terms of the GNU General Public License</span>
<span class="cm"> *		as published by the Free Software Foundation; either version</span>
<span class="cm"> *		2 of the License, or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __LINUX_IF_PPPOL2TP_H</span>
<span class="cp">#define __LINUX_IF_PPPOL2TP_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#include &lt;linux/in.h&gt;</span>
<span class="cp">#include &lt;linux/in6.h&gt;</span>
<span class="cp">#endif</span>

<span class="cm">/* Structure used to connect() the socket to a particular tunnel UDP</span>
<span class="cm"> * socket over IPv4.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pppol2tp_addr</span> <span class="p">{</span>
	<span class="n">__kernel_pid_t</span>	<span class="n">pid</span><span class="p">;</span>		<span class="cm">/* pid that owns the fd.</span>
<span class="cm">					 * 0 =&gt; current */</span>
	<span class="kt">int</span>	<span class="n">fd</span><span class="p">;</span>			<span class="cm">/* FD of UDP socket to use */</span>

	<span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">addr</span><span class="p">;</span>	<span class="cm">/* IP address and port to send to */</span>

	<span class="n">__u16</span> <span class="n">s_tunnel</span><span class="p">,</span> <span class="n">s_session</span><span class="p">;</span>	<span class="cm">/* For matching incoming packets */</span>
	<span class="n">__u16</span> <span class="n">d_tunnel</span><span class="p">,</span> <span class="n">d_session</span><span class="p">;</span>	<span class="cm">/* For sending outgoing packets */</span>
<span class="p">};</span>

<span class="cm">/* Structure used to connect() the socket to a particular tunnel UDP</span>
<span class="cm"> * socket over IPv6.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pppol2tpin6_addr</span> <span class="p">{</span>
	<span class="n">__kernel_pid_t</span>	<span class="n">pid</span><span class="p">;</span>		<span class="cm">/* pid that owns the fd.</span>
<span class="cm">					 * 0 =&gt; current */</span>
	<span class="kt">int</span>	<span class="n">fd</span><span class="p">;</span>			<span class="cm">/* FD of UDP socket to use */</span>

	<span class="n">__u16</span> <span class="n">s_tunnel</span><span class="p">,</span> <span class="n">s_session</span><span class="p">;</span>	<span class="cm">/* For matching incoming packets */</span>
	<span class="n">__u16</span> <span class="n">d_tunnel</span><span class="p">,</span> <span class="n">d_session</span><span class="p">;</span>	<span class="cm">/* For sending outgoing packets */</span>

	<span class="k">struct</span> <span class="n">sockaddr_in6</span> <span class="n">addr</span><span class="p">;</span>	<span class="cm">/* IP address and port to send to */</span>
<span class="p">};</span>

<span class="cm">/* The L2TPv3 protocol changes tunnel and session ids from 16 to 32</span>
<span class="cm"> * bits. So we need a different sockaddr structure.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pppol2tpv3_addr</span> <span class="p">{</span>
	<span class="n">__kernel_pid_t</span>	<span class="n">pid</span><span class="p">;</span>		<span class="cm">/* pid that owns the fd.</span>
<span class="cm">					 * 0 =&gt; current */</span>
	<span class="kt">int</span>	<span class="n">fd</span><span class="p">;</span>			<span class="cm">/* FD of UDP or IP socket to use */</span>

	<span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">addr</span><span class="p">;</span>	<span class="cm">/* IP address and port to send to */</span>

	<span class="n">__u32</span> <span class="n">s_tunnel</span><span class="p">,</span> <span class="n">s_session</span><span class="p">;</span>	<span class="cm">/* For matching incoming packets */</span>
	<span class="n">__u32</span> <span class="n">d_tunnel</span><span class="p">,</span> <span class="n">d_session</span><span class="p">;</span>	<span class="cm">/* For sending outgoing packets */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">pppol2tpv3in6_addr</span> <span class="p">{</span>
	<span class="n">__kernel_pid_t</span>	<span class="n">pid</span><span class="p">;</span>		<span class="cm">/* pid that owns the fd.</span>
<span class="cm">					 * 0 =&gt; current */</span>
	<span class="kt">int</span>	<span class="n">fd</span><span class="p">;</span>			<span class="cm">/* FD of UDP or IP socket to use */</span>

	<span class="n">__u32</span> <span class="n">s_tunnel</span><span class="p">,</span> <span class="n">s_session</span><span class="p">;</span>	<span class="cm">/* For matching incoming packets */</span>
	<span class="n">__u32</span> <span class="n">d_tunnel</span><span class="p">,</span> <span class="n">d_session</span><span class="p">;</span>	<span class="cm">/* For sending outgoing packets */</span>

	<span class="k">struct</span> <span class="n">sockaddr_in6</span> <span class="n">addr</span><span class="p">;</span>	<span class="cm">/* IP address and port to send to */</span>
<span class="p">};</span>

<span class="cm">/* Socket options:</span>
<span class="cm"> * DEBUG	- bitmask of debug message categories</span>
<span class="cm"> * SENDSEQ	- 0 =&gt; don&#39;t send packets with sequence numbers</span>
<span class="cm"> *		  1 =&gt; send packets with sequence numbers</span>
<span class="cm"> * RECVSEQ	- 0 =&gt; receive packet sequence numbers are optional</span>
<span class="cm"> *		  1 =&gt; drop receive packets without sequence numbers</span>
<span class="cm"> * LNSMODE	- 0 =&gt; act as LAC.</span>
<span class="cm"> *		  1 =&gt; act as LNS.</span>
<span class="cm"> * REORDERTO	- reorder timeout (in millisecs). If 0, don&#39;t try to reorder.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">PPPOL2TP_SO_DEBUG</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">PPPOL2TP_SO_RECVSEQ</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">PPPOL2TP_SO_SENDSEQ</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">PPPOL2TP_SO_LNSMODE</span>	<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">PPPOL2TP_SO_REORDERTO</span>	<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Debug message categories for the DEBUG socket option */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">PPPOL2TP_MSG_DEBUG</span>	<span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">),</span>	<span class="cm">/* verbose debug (if</span>
<span class="cm">						 * compiled in) */</span>
	<span class="n">PPPOL2TP_MSG_CONTROL</span>	<span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">),</span>	<span class="cm">/* userspace - kernel</span>
<span class="cm">						 * interface */</span>
	<span class="n">PPPOL2TP_MSG_SEQ</span>	<span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">),</span>	<span class="cm">/* sequence numbers */</span>
	<span class="n">PPPOL2TP_MSG_DATA</span>	<span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">),</span>	<span class="cm">/* data packets */</span>
<span class="p">};</span>



<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
