<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › pkt_sched.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>pkt_sched.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __LINUX_PKT_SCHED_H</span>
<span class="cp">#define __LINUX_PKT_SCHED_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/* Logical priority bands not depending on specific packet scheduler.</span>
<span class="cm">   Every scheduler will map them to real traffic classes, if it has</span>
<span class="cm">   no more precise mechanism to classify packets.</span>

<span class="cm">   These numbers have no special meaning, though their coincidence</span>
<span class="cm">   with obsolete IPv6 values is not occasional :-). New IPv6 drafts</span>
<span class="cm">   preferred full anarchy inspired by diffserv group.</span>

<span class="cm">   Note: TC_PRIO_BESTEFFORT does not mean that it is the most unhappy</span>
<span class="cm">   class, actually, as rule it will be handled with more care than</span>
<span class="cm">   filler or even bulk.</span>
<span class="cm"> */</span>

<span class="cp">#define TC_PRIO_BESTEFFORT		0</span>
<span class="cp">#define TC_PRIO_FILLER			1</span>
<span class="cp">#define TC_PRIO_BULK			2</span>
<span class="cp">#define TC_PRIO_INTERACTIVE_BULK	4</span>
<span class="cp">#define TC_PRIO_INTERACTIVE		6</span>
<span class="cp">#define TC_PRIO_CONTROL			7</span>

<span class="cp">#define TC_PRIO_MAX			15</span>

<span class="cm">/* Generic queue statistics, available for all the elements.</span>
<span class="cm">   Particular schedulers may have also their private records.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">tc_stats</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">bytes</span><span class="p">;</span>			<span class="cm">/* Number of enqueued bytes */</span>
	<span class="n">__u32</span>	<span class="n">packets</span><span class="p">;</span>		<span class="cm">/* Number of enqueued packets	*/</span>
	<span class="n">__u32</span>	<span class="n">drops</span><span class="p">;</span>			<span class="cm">/* Packets dropped because of lack of resources */</span>
	<span class="n">__u32</span>	<span class="n">overlimits</span><span class="p">;</span>		<span class="cm">/* Number of throttle events when this</span>
<span class="cm">					 * flow goes out of allocated bandwidth */</span>
	<span class="n">__u32</span>	<span class="n">bps</span><span class="p">;</span>			<span class="cm">/* Current flow byte rate */</span>
	<span class="n">__u32</span>	<span class="n">pps</span><span class="p">;</span>			<span class="cm">/* Current flow packet rate */</span>
	<span class="n">__u32</span>	<span class="n">qlen</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">backlog</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_estimator</span> <span class="p">{</span>
	<span class="kt">signed</span> <span class="kt">char</span>	<span class="n">interval</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">ewma_log</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* &quot;Handles&quot;</span>
<span class="cm">   ---------</span>

<span class="cm">    All the traffic control objects have 32bit identifiers, or &quot;handles&quot;.</span>

<span class="cm">    They can be considered as opaque numbers from user API viewpoint,</span>
<span class="cm">    but actually they always consist of two fields: major and</span>
<span class="cm">    minor numbers, which are interpreted by kernel specially,</span>
<span class="cm">    that may be used by applications, though not recommended.</span>

<span class="cm">    F.e. qdisc handles always have minor number equal to zero,</span>
<span class="cm">    classes (or flows) have major equal to parent qdisc major, and</span>
<span class="cm">    minor uniquely identifying class inside qdisc.</span>

<span class="cm">    Macros to manipulate handles:</span>
<span class="cm"> */</span>

<span class="cp">#define TC_H_MAJ_MASK (0xFFFF0000U)</span>
<span class="cp">#define TC_H_MIN_MASK (0x0000FFFFU)</span>
<span class="cp">#define TC_H_MAJ(h) ((h)&amp;TC_H_MAJ_MASK)</span>
<span class="cp">#define TC_H_MIN(h) ((h)&amp;TC_H_MIN_MASK)</span>
<span class="cp">#define TC_H_MAKE(maj,min) (((maj)&amp;TC_H_MAJ_MASK)|((min)&amp;TC_H_MIN_MASK))</span>

<span class="cp">#define TC_H_UNSPEC	(0U)</span>
<span class="cp">#define TC_H_ROOT	(0xFFFFFFFFU)</span>
<span class="cp">#define TC_H_INGRESS    (0xFFFFFFF1U)</span>

<span class="k">struct</span> <span class="n">tc_ratespec</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">cell_log</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">__reserved</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">overhead</span><span class="p">;</span>
	<span class="kt">short</span>		<span class="n">cell_align</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">mpu</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">rate</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define TC_RTAB_SIZE	1024</span>

<span class="k">struct</span> <span class="n">tc_sizespec</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">cell_log</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">size_log</span><span class="p">;</span>
	<span class="kt">short</span>		<span class="n">cell_align</span><span class="p">;</span>
	<span class="kt">int</span>		<span class="n">overhead</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">linklayer</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">mpu</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">mtu</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">tsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_STAB_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_STAB_BASE</span><span class="p">,</span>
	<span class="n">TCA_STAB_DATA</span><span class="p">,</span>
	<span class="n">__TCA_STAB_MAX</span>
<span class="p">};</span>

<span class="cp">#define TCA_STAB_MAX (__TCA_STAB_MAX - 1)</span>

<span class="cm">/* FIFO section */</span>

<span class="k">struct</span> <span class="n">tc_fifo_qopt</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">limit</span><span class="p">;</span>	<span class="cm">/* Queue length: bytes for bfifo, packets for pfifo */</span>
<span class="p">};</span>

<span class="cm">/* PRIO section */</span>

<span class="cp">#define TCQ_PRIO_BANDS	16</span>
<span class="cp">#define TCQ_MIN_PRIO_BANDS 2</span>

<span class="k">struct</span> <span class="n">tc_prio_qopt</span> <span class="p">{</span>
	<span class="kt">int</span>	<span class="n">bands</span><span class="p">;</span>			<span class="cm">/* Number of bands */</span>
	<span class="n">__u8</span>	<span class="n">priomap</span><span class="p">[</span><span class="n">TC_PRIO_MAX</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>	<span class="cm">/* Map: logical priority -&gt; PRIO band */</span>
<span class="p">};</span>

<span class="cm">/* MULTIQ section */</span>

<span class="k">struct</span> <span class="n">tc_multiq_qopt</span> <span class="p">{</span>
	<span class="n">__u16</span>	<span class="n">bands</span><span class="p">;</span>			<span class="cm">/* Number of bands */</span>
	<span class="n">__u16</span>	<span class="n">max_bands</span><span class="p">;</span>		<span class="cm">/* Maximum number of queues */</span>
<span class="p">};</span>

<span class="cm">/* PLUG section */</span>

<span class="cp">#define TCQ_PLUG_BUFFER                0</span>
<span class="cp">#define TCQ_PLUG_RELEASE_ONE           1</span>
<span class="cp">#define TCQ_PLUG_RELEASE_INDEFINITE    2</span>
<span class="cp">#define TCQ_PLUG_LIMIT                 3</span>

<span class="k">struct</span> <span class="n">tc_plug_qopt</span> <span class="p">{</span>
	<span class="cm">/* TCQ_PLUG_BUFFER: Inset a plug into the queue and</span>
<span class="cm">	 *  buffer any incoming packets</span>
<span class="cm">	 * TCQ_PLUG_RELEASE_ONE: Dequeue packets from queue head</span>
<span class="cm">	 *   to beginning of the next plug.</span>
<span class="cm">	 * TCQ_PLUG_RELEASE_INDEFINITE: Dequeue all packets from queue.</span>
<span class="cm">	 *   Stop buffering packets until the next TCQ_PLUG_BUFFER</span>
<span class="cm">	 *   command is received (just act as a pass-thru queue).</span>
<span class="cm">	 * TCQ_PLUG_LIMIT: Increase/decrease queue size</span>
<span class="cm">	 */</span>
	<span class="kt">int</span>             <span class="n">action</span><span class="p">;</span>
	<span class="n">__u32</span>           <span class="n">limit</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* TBF section */</span>

<span class="k">struct</span> <span class="n">tc_tbf_qopt</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">tc_ratespec</span> <span class="n">rate</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tc_ratespec</span> <span class="n">peakrate</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">limit</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">buffer</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">mtu</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_TBF_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_TBF_PARMS</span><span class="p">,</span>
	<span class="n">TCA_TBF_RTAB</span><span class="p">,</span>
	<span class="n">TCA_TBF_PTAB</span><span class="p">,</span>
	<span class="n">__TCA_TBF_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_TBF_MAX (__TCA_TBF_MAX - 1)</span>


<span class="cm">/* TEQL section */</span>

<span class="cm">/* TEQL does not require any parameters */</span>

<span class="cm">/* SFQ section */</span>

<span class="k">struct</span> <span class="n">tc_sfq_qopt</span> <span class="p">{</span>
	<span class="kt">unsigned</span>	<span class="n">quantum</span><span class="p">;</span>	<span class="cm">/* Bytes per round allocated to flow */</span>
	<span class="kt">int</span>		<span class="n">perturb_period</span><span class="p">;</span>	<span class="cm">/* Period of hash perturbation */</span>
	<span class="n">__u32</span>		<span class="n">limit</span><span class="p">;</span>		<span class="cm">/* Maximal packets in queue */</span>
	<span class="kt">unsigned</span>	<span class="n">divisor</span><span class="p">;</span>	<span class="cm">/* Hash divisor  */</span>
	<span class="kt">unsigned</span>	<span class="n">flows</span><span class="p">;</span>		<span class="cm">/* Maximal number of flows  */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_sfqred_stats</span> <span class="p">{</span>
	<span class="n">__u32</span>           <span class="n">prob_drop</span><span class="p">;</span>      <span class="cm">/* Early drops, below max threshold */</span>
	<span class="n">__u32</span>           <span class="n">forced_drop</span><span class="p">;</span>	<span class="cm">/* Early drops, after max threshold */</span>
	<span class="n">__u32</span>           <span class="n">prob_mark</span><span class="p">;</span>      <span class="cm">/* Marked packets, below max threshold */</span>
	<span class="n">__u32</span>           <span class="n">forced_mark</span><span class="p">;</span>    <span class="cm">/* Marked packets, after max threshold */</span>
	<span class="n">__u32</span>           <span class="n">prob_mark_head</span><span class="p">;</span> <span class="cm">/* Marked packets, below max threshold */</span>
	<span class="n">__u32</span>           <span class="n">forced_mark_head</span><span class="p">;</span><span class="cm">/* Marked packets, after max threshold */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_sfq_qopt_v1</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">tc_sfq_qopt</span> <span class="n">v0</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">depth</span><span class="p">;</span>		<span class="cm">/* max number of packets per flow */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">headdrop</span><span class="p">;</span>
<span class="cm">/* SFQRED parameters */</span>
	<span class="n">__u32</span>		<span class="n">limit</span><span class="p">;</span>		<span class="cm">/* HARD maximal flow queue length (bytes) */</span>
	<span class="n">__u32</span>		<span class="n">qth_min</span><span class="p">;</span>	<span class="cm">/* Min average length threshold (bytes) */</span>
	<span class="n">__u32</span>		<span class="n">qth_max</span><span class="p">;</span>	<span class="cm">/* Max average length threshold (bytes) */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Wlog</span><span class="p">;</span>		<span class="cm">/* log(W)		*/</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Plog</span><span class="p">;</span>		<span class="cm">/* log(P_max/(qth_max-qth_min))	*/</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Scell_log</span><span class="p">;</span>	<span class="cm">/* cell size for idle damping */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">max_P</span><span class="p">;</span>		<span class="cm">/* probability, high resolution */</span>
<span class="cm">/* SFQRED stats */</span>
	<span class="k">struct</span> <span class="n">tc_sfqred_stats</span> <span class="n">stats</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">tc_sfq_xstats</span> <span class="p">{</span>
	<span class="n">__s32</span>		<span class="n">allot</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* RED section */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_RED_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_RED_PARMS</span><span class="p">,</span>
	<span class="n">TCA_RED_STAB</span><span class="p">,</span>
	<span class="n">TCA_RED_MAX_P</span><span class="p">,</span>
	<span class="n">__TCA_RED_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_RED_MAX (__TCA_RED_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_red_qopt</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">limit</span><span class="p">;</span>		<span class="cm">/* HARD maximal queue length (bytes)	*/</span>
	<span class="n">__u32</span>		<span class="n">qth_min</span><span class="p">;</span>	<span class="cm">/* Min average length threshold (bytes) */</span>
	<span class="n">__u32</span>		<span class="n">qth_max</span><span class="p">;</span>	<span class="cm">/* Max average length threshold (bytes) */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Wlog</span><span class="p">;</span>		<span class="cm">/* log(W)		*/</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Plog</span><span class="p">;</span>		<span class="cm">/* log(P_max/(qth_max-qth_min))	*/</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Scell_log</span><span class="p">;</span>	<span class="cm">/* cell size for idle damping */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">flags</span><span class="p">;</span>
<span class="cp">#define TC_RED_ECN		1</span>
<span class="cp">#define TC_RED_HARDDROP		2</span>
<span class="cp">#define TC_RED_ADAPTATIVE	4</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_red_xstats</span> <span class="p">{</span>
	<span class="n">__u32</span>           <span class="n">early</span><span class="p">;</span>          <span class="cm">/* Early drops */</span>
	<span class="n">__u32</span>           <span class="n">pdrop</span><span class="p">;</span>          <span class="cm">/* Drops due to queue limits */</span>
	<span class="n">__u32</span>           <span class="n">other</span><span class="p">;</span>          <span class="cm">/* Drops due to drop() calls */</span>
	<span class="n">__u32</span>           <span class="n">marked</span><span class="p">;</span>         <span class="cm">/* Marked packets */</span>
<span class="p">};</span>

<span class="cm">/* GRED section */</span>

<span class="cp">#define MAX_DPs 16</span>

<span class="k">enum</span> <span class="p">{</span>
       <span class="n">TCA_GRED_UNSPEC</span><span class="p">,</span>
       <span class="n">TCA_GRED_PARMS</span><span class="p">,</span>
       <span class="n">TCA_GRED_STAB</span><span class="p">,</span>
       <span class="n">TCA_GRED_DPS</span><span class="p">,</span>
       <span class="n">TCA_GRED_MAX_P</span><span class="p">,</span>
	   <span class="n">__TCA_GRED_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_GRED_MAX (__TCA_GRED_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_gred_qopt</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">limit</span><span class="p">;</span>        <span class="cm">/* HARD maximal queue length (bytes)    */</span>
	<span class="n">__u32</span>		<span class="n">qth_min</span><span class="p">;</span>      <span class="cm">/* Min average length threshold (bytes) */</span>
	<span class="n">__u32</span>		<span class="n">qth_max</span><span class="p">;</span>      <span class="cm">/* Max average length threshold (bytes) */</span>
	<span class="n">__u32</span>		<span class="n">DP</span><span class="p">;</span>           <span class="cm">/* up to 2^32 DPs */</span>
	<span class="n">__u32</span>		<span class="n">backlog</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">qave</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">forced</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">early</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">other</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">pdrop</span><span class="p">;</span>
	<span class="n">__u8</span>		<span class="n">Wlog</span><span class="p">;</span>         <span class="cm">/* log(W)               */</span>
	<span class="n">__u8</span>		<span class="n">Plog</span><span class="p">;</span>         <span class="cm">/* log(P_max/(qth_max-qth_min)) */</span>
	<span class="n">__u8</span>		<span class="n">Scell_log</span><span class="p">;</span>    <span class="cm">/* cell size for idle damping */</span>
	<span class="n">__u8</span>		<span class="n">prio</span><span class="p">;</span>         <span class="cm">/* prio of this VQ */</span>
	<span class="n">__u32</span>		<span class="n">packets</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">bytesin</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* gred setup */</span>
<span class="k">struct</span> <span class="n">tc_gred_sopt</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">DPs</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">def_DP</span><span class="p">;</span>
	<span class="n">__u8</span>		<span class="n">grio</span><span class="p">;</span>
	<span class="n">__u8</span>		<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u16</span>		<span class="n">pad1</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* CHOKe section */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_CHOKE_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_CHOKE_PARMS</span><span class="p">,</span>
	<span class="n">TCA_CHOKE_STAB</span><span class="p">,</span>
	<span class="n">TCA_CHOKE_MAX_P</span><span class="p">,</span>
	<span class="n">__TCA_CHOKE_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_CHOKE_MAX (__TCA_CHOKE_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_choke_qopt</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">limit</span><span class="p">;</span>		<span class="cm">/* Hard queue length (packets)	*/</span>
	<span class="n">__u32</span>		<span class="n">qth_min</span><span class="p">;</span>	<span class="cm">/* Min average threshold (packets) */</span>
	<span class="n">__u32</span>		<span class="n">qth_max</span><span class="p">;</span>	<span class="cm">/* Max average threshold (packets) */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Wlog</span><span class="p">;</span>		<span class="cm">/* log(W)		*/</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Plog</span><span class="p">;</span>		<span class="cm">/* log(P_max/(qth_max-qth_min))	*/</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>   <span class="n">Scell_log</span><span class="p">;</span>	<span class="cm">/* cell size for idle damping */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">flags</span><span class="p">;</span>		<span class="cm">/* see RED flags */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_choke_xstats</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">early</span><span class="p">;</span>          <span class="cm">/* Early drops */</span>
	<span class="n">__u32</span>		<span class="n">pdrop</span><span class="p">;</span>          <span class="cm">/* Drops due to queue limits */</span>
	<span class="n">__u32</span>		<span class="n">other</span><span class="p">;</span>          <span class="cm">/* Drops due to drop() calls */</span>
	<span class="n">__u32</span>		<span class="n">marked</span><span class="p">;</span>         <span class="cm">/* Marked packets */</span>
	<span class="n">__u32</span>		<span class="n">matched</span><span class="p">;</span>	<span class="cm">/* Drops due to flow match */</span>
<span class="p">};</span>

<span class="cm">/* HTB section */</span>
<span class="cp">#define TC_HTB_NUMPRIO		8</span>
<span class="cp">#define TC_HTB_MAXDEPTH		8</span>
<span class="cp">#define TC_HTB_PROTOVER		3 </span><span class="cm">/* the same as HTB and TC&#39;s major */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">tc_htb_opt</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">tc_ratespec</span> 	<span class="n">rate</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tc_ratespec</span> 	<span class="n">ceil</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">buffer</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">cbuffer</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">quantum</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">level</span><span class="p">;</span>		<span class="cm">/* out only */</span>
	<span class="n">__u32</span>	<span class="n">prio</span><span class="p">;</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="n">tc_htb_glob</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">version</span><span class="p">;</span>		<span class="cm">/* to match HTB/TC */</span>
    	<span class="n">__u32</span> <span class="n">rate2quantum</span><span class="p">;</span>	<span class="cm">/* bps-&gt;quantum divisor */</span>
    	<span class="n">__u32</span> <span class="n">defcls</span><span class="p">;</span>		<span class="cm">/* default class number */</span>
	<span class="n">__u32</span> <span class="n">debug</span><span class="p">;</span>		<span class="cm">/* debug flags */</span>

	<span class="cm">/* stats */</span>
	<span class="n">__u32</span> <span class="n">direct_pkts</span><span class="p">;</span> <span class="cm">/* count of non shaped packets */</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_HTB_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_HTB_PARMS</span><span class="p">,</span>
	<span class="n">TCA_HTB_INIT</span><span class="p">,</span>
	<span class="n">TCA_HTB_CTAB</span><span class="p">,</span>
	<span class="n">TCA_HTB_RTAB</span><span class="p">,</span>
	<span class="n">__TCA_HTB_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_HTB_MAX (__TCA_HTB_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_htb_xstats</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">lends</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">borrows</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">giants</span><span class="p">;</span>	<span class="cm">/* too big packets (rate will not be accurate) */</span>
	<span class="n">__u32</span> <span class="n">tokens</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">ctokens</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* HFSC section */</span>

<span class="k">struct</span> <span class="n">tc_hfsc_qopt</span> <span class="p">{</span>
	<span class="n">__u16</span>	<span class="n">defcls</span><span class="p">;</span>		<span class="cm">/* default class */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_service_curve</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">m1</span><span class="p">;</span>		<span class="cm">/* slope of the first segment in bps */</span>
	<span class="n">__u32</span>	<span class="n">d</span><span class="p">;</span>		<span class="cm">/* x-projection of the first segment in us */</span>
	<span class="n">__u32</span>	<span class="n">m2</span><span class="p">;</span>		<span class="cm">/* slope of the second segment in bps */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_hfsc_stats</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">work</span><span class="p">;</span>		<span class="cm">/* total work done */</span>
	<span class="n">__u64</span>	<span class="n">rtwork</span><span class="p">;</span>		<span class="cm">/* work done by real-time criteria */</span>
	<span class="n">__u32</span>	<span class="n">period</span><span class="p">;</span>		<span class="cm">/* current period */</span>
	<span class="n">__u32</span>	<span class="n">level</span><span class="p">;</span>		<span class="cm">/* class level in hierarchy */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_HFSC_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_HFSC_RSC</span><span class="p">,</span>
	<span class="n">TCA_HFSC_FSC</span><span class="p">,</span>
	<span class="n">TCA_HFSC_USC</span><span class="p">,</span>
	<span class="n">__TCA_HFSC_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_HFSC_MAX (__TCA_HFSC_MAX - 1)</span>


<span class="cm">/* CBQ section */</span>

<span class="cp">#define TC_CBQ_MAXPRIO		8</span>
<span class="cp">#define TC_CBQ_MAXLEVEL		8</span>
<span class="cp">#define TC_CBQ_DEF_EWMA		5</span>

<span class="k">struct</span> <span class="n">tc_cbq_lssopt</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">change</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">flags</span><span class="p">;</span>
<span class="cp">#define TCF_CBQ_LSS_BOUNDED	1</span>
<span class="cp">#define TCF_CBQ_LSS_ISOLATED	2</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>  	<span class="n">ewma_log</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>  	<span class="n">level</span><span class="p">;</span>
<span class="cp">#define TCF_CBQ_LSS_FLAGS	1</span>
<span class="cp">#define TCF_CBQ_LSS_EWMA	2</span>
<span class="cp">#define TCF_CBQ_LSS_MAXIDLE	4</span>
<span class="cp">#define TCF_CBQ_LSS_MINIDLE	8</span>
<span class="cp">#define TCF_CBQ_LSS_OFFTIME	0x10</span>
<span class="cp">#define TCF_CBQ_LSS_AVPKT	0x20</span>
	<span class="n">__u32</span>		<span class="n">maxidle</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">minidle</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">offtime</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">avpkt</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_cbq_wrropt</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">priority</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">cpriority</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">__reserved</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">allot</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">weight</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_cbq_ovl</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">strategy</span><span class="p">;</span>
<span class="cp">#define	TC_CBQ_OVL_CLASSIC	0</span>
<span class="cp">#define	TC_CBQ_OVL_DELAY	1</span>
<span class="cp">#define	TC_CBQ_OVL_LOWPRIO	2</span>
<span class="cp">#define	TC_CBQ_OVL_DROP		3</span>
<span class="cp">#define	TC_CBQ_OVL_RCLASSIC	4</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">priority2</span><span class="p">;</span>
	<span class="n">__u16</span>		<span class="n">pad</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">penalty</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_cbq_police</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">police</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">__res1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">__res2</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_cbq_fopt</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">split</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">defmap</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">defchange</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_cbq_xstats</span> <span class="p">{</span>
	<span class="n">__u32</span>		<span class="n">borrows</span><span class="p">;</span>
	<span class="n">__u32</span>		<span class="n">overactions</span><span class="p">;</span>
	<span class="n">__s32</span>		<span class="n">avgidle</span><span class="p">;</span>
	<span class="n">__s32</span>		<span class="n">undertime</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_CBQ_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_CBQ_LSSOPT</span><span class="p">,</span>
	<span class="n">TCA_CBQ_WRROPT</span><span class="p">,</span>
	<span class="n">TCA_CBQ_FOPT</span><span class="p">,</span>
	<span class="n">TCA_CBQ_OVL_STRATEGY</span><span class="p">,</span>
	<span class="n">TCA_CBQ_RATE</span><span class="p">,</span>
	<span class="n">TCA_CBQ_RTAB</span><span class="p">,</span>
	<span class="n">TCA_CBQ_POLICE</span><span class="p">,</span>
	<span class="n">__TCA_CBQ_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_CBQ_MAX	(__TCA_CBQ_MAX - 1)</span>

<span class="cm">/* dsmark section */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_DSMARK_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_DSMARK_INDICES</span><span class="p">,</span>
	<span class="n">TCA_DSMARK_DEFAULT_INDEX</span><span class="p">,</span>
	<span class="n">TCA_DSMARK_SET_TC_INDEX</span><span class="p">,</span>
	<span class="n">TCA_DSMARK_MASK</span><span class="p">,</span>
	<span class="n">TCA_DSMARK_VALUE</span><span class="p">,</span>
	<span class="n">__TCA_DSMARK_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_DSMARK_MAX (__TCA_DSMARK_MAX - 1)</span>

<span class="cm">/* ATM  section */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_ATM_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_ATM_FD</span><span class="p">,</span>		<span class="cm">/* file/socket descriptor */</span>
	<span class="n">TCA_ATM_PTR</span><span class="p">,</span>		<span class="cm">/* pointer to descriptor - later */</span>
	<span class="n">TCA_ATM_HDR</span><span class="p">,</span>		<span class="cm">/* LL header */</span>
	<span class="n">TCA_ATM_EXCESS</span><span class="p">,</span>		<span class="cm">/* excess traffic class (0 for CLP)  */</span>
	<span class="n">TCA_ATM_ADDR</span><span class="p">,</span>		<span class="cm">/* PVC address (for output only) */</span>
	<span class="n">TCA_ATM_STATE</span><span class="p">,</span>		<span class="cm">/* VC state (ATM_VS_*; for output only) */</span>
	<span class="n">__TCA_ATM_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_ATM_MAX	(__TCA_ATM_MAX - 1)</span>

<span class="cm">/* Network emulator */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_NETEM_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_NETEM_CORR</span><span class="p">,</span>
	<span class="n">TCA_NETEM_DELAY_DIST</span><span class="p">,</span>
	<span class="n">TCA_NETEM_REORDER</span><span class="p">,</span>
	<span class="n">TCA_NETEM_CORRUPT</span><span class="p">,</span>
	<span class="n">TCA_NETEM_LOSS</span><span class="p">,</span>
	<span class="n">TCA_NETEM_RATE</span><span class="p">,</span>
	<span class="n">TCA_NETEM_ECN</span><span class="p">,</span>
	<span class="n">__TCA_NETEM_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_NETEM_MAX (__TCA_NETEM_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_netem_qopt</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">latency</span><span class="p">;</span>	<span class="cm">/* added delay (us) */</span>
	<span class="n">__u32</span>   <span class="n">limit</span><span class="p">;</span>		<span class="cm">/* fifo limit (packets) */</span>
	<span class="n">__u32</span>	<span class="n">loss</span><span class="p">;</span>		<span class="cm">/* random packet loss (0=none ~0=100%) */</span>
	<span class="n">__u32</span>	<span class="n">gap</span><span class="p">;</span>		<span class="cm">/* re-ordering gap (0 for none) */</span>
	<span class="n">__u32</span>   <span class="n">duplicate</span><span class="p">;</span>	<span class="cm">/* random packet dup  (0=none ~0=100%) */</span>
	<span class="n">__u32</span>	<span class="n">jitter</span><span class="p">;</span>		<span class="cm">/* random jitter in latency (us) */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_netem_corr</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">delay_corr</span><span class="p">;</span>	<span class="cm">/* delay correlation */</span>
	<span class="n">__u32</span>	<span class="n">loss_corr</span><span class="p">;</span>	<span class="cm">/* packet loss correlation */</span>
	<span class="n">__u32</span>	<span class="n">dup_corr</span><span class="p">;</span>	<span class="cm">/* duplicate correlation  */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_netem_reorder</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">probability</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">correlation</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_netem_corrupt</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">probability</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">correlation</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_netem_rate</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">rate</span><span class="p">;</span>	<span class="cm">/* byte/s */</span>
	<span class="n">__s32</span>	<span class="n">packet_overhead</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">cell_size</span><span class="p">;</span>
	<span class="n">__s32</span>	<span class="n">cell_overhead</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">NETEM_LOSS_UNSPEC</span><span class="p">,</span>
	<span class="n">NETEM_LOSS_GI</span><span class="p">,</span>		<span class="cm">/* General Intuitive - 4 state model */</span>
	<span class="n">NETEM_LOSS_GE</span><span class="p">,</span>		<span class="cm">/* Gilbert Elliot models */</span>
	<span class="n">__NETEM_LOSS_MAX</span>
<span class="p">};</span>
<span class="cp">#define NETEM_LOSS_MAX (__NETEM_LOSS_MAX - 1)</span>

<span class="cm">/* State transition probabilities for 4 state model */</span>
<span class="k">struct</span> <span class="n">tc_netem_gimodel</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">p13</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">p31</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">p32</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">p14</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">p23</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Gilbert-Elliot models */</span>
<span class="k">struct</span> <span class="n">tc_netem_gemodel</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">p</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">r</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">h</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">k1</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define NETEM_DIST_SCALE	8192</span>
<span class="cp">#define NETEM_DIST_MAX		16384</span>

<span class="cm">/* DRR */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_DRR_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_DRR_QUANTUM</span><span class="p">,</span>
	<span class="n">__TCA_DRR_MAX</span>
<span class="p">};</span>

<span class="cp">#define TCA_DRR_MAX	(__TCA_DRR_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_drr_stats</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">deficit</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* MQPRIO */</span>
<span class="cp">#define TC_QOPT_BITMASK 15</span>
<span class="cp">#define TC_QOPT_MAX_QUEUE 16</span>

<span class="k">struct</span> <span class="n">tc_mqprio_qopt</span> <span class="p">{</span>
	<span class="n">__u8</span>	<span class="n">num_tc</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">prio_tc_map</span><span class="p">[</span><span class="n">TC_QOPT_BITMASK</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">__u8</span>	<span class="n">hw</span><span class="p">;</span>
	<span class="n">__u16</span>	<span class="n">count</span><span class="p">[</span><span class="n">TC_QOPT_MAX_QUEUE</span><span class="p">];</span>
	<span class="n">__u16</span>	<span class="n">offset</span><span class="p">[</span><span class="n">TC_QOPT_MAX_QUEUE</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* SFB */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_SFB_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_SFB_PARMS</span><span class="p">,</span>
	<span class="n">__TCA_SFB_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define TCA_SFB_MAX (__TCA_SFB_MAX - 1)</span>

<span class="cm">/*</span>
<span class="cm"> * Note: increment, decrement are Q0.16 fixed-point values.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">tc_sfb_qopt</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">rehash_interval</span><span class="p">;</span>	<span class="cm">/* delay between hash move, in ms */</span>
	<span class="n">__u32</span> <span class="n">warmup_time</span><span class="p">;</span>	<span class="cm">/* double buffering warmup time in ms (warmup_time &lt; rehash_interval) */</span>
	<span class="n">__u32</span> <span class="n">max</span><span class="p">;</span>		<span class="cm">/* max len of qlen_min */</span>
	<span class="n">__u32</span> <span class="n">bin_size</span><span class="p">;</span>		<span class="cm">/* maximum queue length per bin */</span>
	<span class="n">__u32</span> <span class="n">increment</span><span class="p">;</span>	<span class="cm">/* probability increment, (d1 in Blue) */</span>
	<span class="n">__u32</span> <span class="n">decrement</span><span class="p">;</span>	<span class="cm">/* probability decrement, (d2 in Blue) */</span>
	<span class="n">__u32</span> <span class="n">limit</span><span class="p">;</span>		<span class="cm">/* max SFB queue length */</span>
	<span class="n">__u32</span> <span class="n">penalty_rate</span><span class="p">;</span>	<span class="cm">/* inelastic flows are rate limited to &#39;rate&#39; pps */</span>
	<span class="n">__u32</span> <span class="n">penalty_burst</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_sfb_xstats</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">earlydrop</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">penaltydrop</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">bucketdrop</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">queuedrop</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">childdrop</span><span class="p">;</span> <span class="cm">/* drops in child qdisc */</span>
	<span class="n">__u32</span> <span class="n">marked</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">maxqlen</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">maxprob</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">avgprob</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define SFB_MAX_PROB 0xFFFF</span>

<span class="cm">/* QFQ */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_QFQ_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_QFQ_WEIGHT</span><span class="p">,</span>
	<span class="n">TCA_QFQ_LMAX</span><span class="p">,</span>
	<span class="n">__TCA_QFQ_MAX</span>
<span class="p">};</span>

<span class="cp">#define TCA_QFQ_MAX	(__TCA_QFQ_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_qfq_stats</span> <span class="p">{</span>
	<span class="n">__u32</span> <span class="n">weight</span><span class="p">;</span>
	<span class="n">__u32</span> <span class="n">lmax</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* CODEL */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_CODEL_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_CODEL_TARGET</span><span class="p">,</span>
	<span class="n">TCA_CODEL_LIMIT</span><span class="p">,</span>
	<span class="n">TCA_CODEL_INTERVAL</span><span class="p">,</span>
	<span class="n">TCA_CODEL_ECN</span><span class="p">,</span>
	<span class="n">__TCA_CODEL_MAX</span>
<span class="p">};</span>

<span class="cp">#define TCA_CODEL_MAX	(__TCA_CODEL_MAX - 1)</span>

<span class="k">struct</span> <span class="n">tc_codel_xstats</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">maxpacket</span><span class="p">;</span> <span class="cm">/* largest packet we&#39;ve seen so far */</span>
	<span class="n">__u32</span>	<span class="n">count</span><span class="p">;</span>	   <span class="cm">/* how many drops we&#39;ve done since the last time we</span>
<span class="cm">			    * entered dropping state</span>
<span class="cm">			    */</span>
	<span class="n">__u32</span>	<span class="n">lastcount</span><span class="p">;</span> <span class="cm">/* count at entry to dropping state */</span>
	<span class="n">__u32</span>	<span class="n">ldelay</span><span class="p">;</span>    <span class="cm">/* in-queue delay seen by most recently dequeued packet */</span>
	<span class="n">__s32</span>	<span class="n">drop_next</span><span class="p">;</span> <span class="cm">/* time to drop next packet */</span>
	<span class="n">__u32</span>	<span class="n">drop_overlimit</span><span class="p">;</span> <span class="cm">/* number of time max qdisc packet limit was hit */</span>
	<span class="n">__u32</span>	<span class="n">ecn_mark</span><span class="p">;</span>  <span class="cm">/* number of packets we ECN marked instead of dropped */</span>
	<span class="n">__u32</span>	<span class="n">dropping</span><span class="p">;</span>  <span class="cm">/* are we in dropping state ? */</span>
<span class="p">};</span>

<span class="cm">/* FQ_CODEL */</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_FQ_CODEL_UNSPEC</span><span class="p">,</span>
	<span class="n">TCA_FQ_CODEL_TARGET</span><span class="p">,</span>
	<span class="n">TCA_FQ_CODEL_LIMIT</span><span class="p">,</span>
	<span class="n">TCA_FQ_CODEL_INTERVAL</span><span class="p">,</span>
	<span class="n">TCA_FQ_CODEL_ECN</span><span class="p">,</span>
	<span class="n">TCA_FQ_CODEL_FLOWS</span><span class="p">,</span>
	<span class="n">TCA_FQ_CODEL_QUANTUM</span><span class="p">,</span>
	<span class="n">__TCA_FQ_CODEL_MAX</span>
<span class="p">};</span>

<span class="cp">#define TCA_FQ_CODEL_MAX	(__TCA_FQ_CODEL_MAX - 1)</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">TCA_FQ_CODEL_XSTATS_QDISC</span><span class="p">,</span>
	<span class="n">TCA_FQ_CODEL_XSTATS_CLASS</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_fq_codel_qd_stats</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">maxpacket</span><span class="p">;</span>	<span class="cm">/* largest packet we&#39;ve seen so far */</span>
	<span class="n">__u32</span>	<span class="n">drop_overlimit</span><span class="p">;</span> <span class="cm">/* number of time max qdisc</span>
<span class="cm">				 * packet limit was hit</span>
<span class="cm">				 */</span>
	<span class="n">__u32</span>	<span class="n">ecn_mark</span><span class="p">;</span>	<span class="cm">/* number of packets we ECN marked</span>
<span class="cm">				 * instead of being dropped</span>
<span class="cm">				 */</span>
	<span class="n">__u32</span>	<span class="n">new_flow_count</span><span class="p">;</span> <span class="cm">/* number of time packets</span>
<span class="cm">				 * created a &#39;new flow&#39;</span>
<span class="cm">				 */</span>
	<span class="n">__u32</span>	<span class="n">new_flows_len</span><span class="p">;</span>	<span class="cm">/* count of flows in new list */</span>
	<span class="n">__u32</span>	<span class="n">old_flows_len</span><span class="p">;</span>	<span class="cm">/* count of flows in old list */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_fq_codel_cl_stats</span> <span class="p">{</span>
	<span class="n">__s32</span>	<span class="n">deficit</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">ldelay</span><span class="p">;</span>		<span class="cm">/* in-queue delay seen by most recently</span>
<span class="cm">				 * dequeued packet</span>
<span class="cm">				 */</span>
	<span class="n">__u32</span>	<span class="n">count</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">lastcount</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">dropping</span><span class="p">;</span>
	<span class="n">__s32</span>	<span class="n">drop_next</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">tc_fq_codel_xstats</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">type</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">tc_fq_codel_qd_stats</span> <span class="n">qdisc_stats</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">tc_fq_codel_cl_stats</span> <span class="n">class_stats</span><span class="p">;</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
