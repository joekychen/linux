<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › resource.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>resource.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _LINUX_RESOURCE_H</span>
<span class="cp">#define _LINUX_RESOURCE_H</span>

<span class="cp">#include &lt;linux/time.h&gt;</span>
<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Resource control/accounting header file for linux</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Definition of struct rusage taken from BSD 4.3 Reno</span>
<span class="cm"> * </span>
<span class="cm"> * We don&#39;t support all of these yet, but we might as well have them....</span>
<span class="cm"> * Otherwise, each time we add new items, programs which depend on this</span>
<span class="cm"> * structure will lose.  This reduces the chances of that happening.</span>
<span class="cm"> */</span>
<span class="cp">#define	RUSAGE_SELF	0</span>
<span class="cp">#define	RUSAGE_CHILDREN	(-1)</span>
<span class="cp">#define RUSAGE_BOTH	(-2)		</span><span class="cm">/* sys_wait4() uses this */</span><span class="cp"></span>
<span class="cp">#define	RUSAGE_THREAD	1		</span><span class="cm">/* only the calling thread */</span><span class="cp"></span>

<span class="k">struct</span>	<span class="n">rusage</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">timeval</span> <span class="n">ru_utime</span><span class="p">;</span>	<span class="cm">/* user time used */</span>
	<span class="k">struct</span> <span class="n">timeval</span> <span class="n">ru_stime</span><span class="p">;</span>	<span class="cm">/* system time used */</span>
	<span class="kt">long</span>	<span class="n">ru_maxrss</span><span class="p">;</span>		<span class="cm">/* maximum resident set size */</span>
	<span class="kt">long</span>	<span class="n">ru_ixrss</span><span class="p">;</span>		<span class="cm">/* integral shared memory size */</span>
	<span class="kt">long</span>	<span class="n">ru_idrss</span><span class="p">;</span>		<span class="cm">/* integral unshared data size */</span>
	<span class="kt">long</span>	<span class="n">ru_isrss</span><span class="p">;</span>		<span class="cm">/* integral unshared stack size */</span>
	<span class="kt">long</span>	<span class="n">ru_minflt</span><span class="p">;</span>		<span class="cm">/* page reclaims */</span>
	<span class="kt">long</span>	<span class="n">ru_majflt</span><span class="p">;</span>		<span class="cm">/* page faults */</span>
	<span class="kt">long</span>	<span class="n">ru_nswap</span><span class="p">;</span>		<span class="cm">/* swaps */</span>
	<span class="kt">long</span>	<span class="n">ru_inblock</span><span class="p">;</span>		<span class="cm">/* block input operations */</span>
	<span class="kt">long</span>	<span class="n">ru_oublock</span><span class="p">;</span>		<span class="cm">/* block output operations */</span>
	<span class="kt">long</span>	<span class="n">ru_msgsnd</span><span class="p">;</span>		<span class="cm">/* messages sent */</span>
	<span class="kt">long</span>	<span class="n">ru_msgrcv</span><span class="p">;</span>		<span class="cm">/* messages received */</span>
	<span class="kt">long</span>	<span class="n">ru_nsignals</span><span class="p">;</span>		<span class="cm">/* signals received */</span>
	<span class="kt">long</span>	<span class="n">ru_nvcsw</span><span class="p">;</span>		<span class="cm">/* voluntary context switches */</span>
	<span class="kt">long</span>	<span class="n">ru_nivcsw</span><span class="p">;</span>		<span class="cm">/* involuntary &quot; */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rlimit</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">rlim_cur</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">rlim_max</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define RLIM64_INFINITY		(~0ULL)</span>

<span class="k">struct</span> <span class="n">rlimit64</span> <span class="p">{</span>
	<span class="n">__u64</span> <span class="n">rlim_cur</span><span class="p">;</span>
	<span class="n">__u64</span> <span class="n">rlim_max</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define	PRIO_MIN	(-20)</span>
<span class="cp">#define	PRIO_MAX	20</span>

<span class="cp">#define	PRIO_PROCESS	0</span>
<span class="cp">#define	PRIO_PGRP	1</span>
<span class="cp">#define	PRIO_USER	2</span>

<span class="cm">/*</span>
<span class="cm"> * Limit the stack by to some sane default: root can always</span>
<span class="cm"> * increase this limit if needed..  8MB seems reasonable.</span>
<span class="cm"> */</span>
<span class="cp">#define _STK_LIM	(8*1024*1024)</span>

<span class="cm">/*</span>
<span class="cm"> * GPG2 wants 64kB of mlocked memory, to make sure pass phrases</span>
<span class="cm"> * and other sensitive information are never written to disk.</span>
<span class="cm"> */</span>
<span class="cp">#define MLOCK_LIMIT	((PAGE_SIZE &gt; 64*1024) ? PAGE_SIZE : 64*1024)</span>

<span class="cm">/*</span>
<span class="cm"> * Due to binary compatibility, the actual resource numbers</span>
<span class="cm"> * may be different for different linux versions..</span>
<span class="cm"> */</span>
<span class="cp">#include &lt;asm/resource.h&gt;</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="k">struct</span> <span class="n">task_struct</span><span class="p">;</span>

<span class="kt">int</span> <span class="n">getrusage</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">who</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rusage</span> <span class="n">__user</span> <span class="o">*</span><span class="n">ru</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">do_prlimit</span><span class="p">(</span><span class="k">struct</span> <span class="n">task_struct</span> <span class="o">*</span><span class="n">tsk</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">resource</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">rlimit</span> <span class="o">*</span><span class="n">new_rlim</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rlimit</span> <span class="o">*</span><span class="n">old_rlim</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
