<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › mdio.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>mdio.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * linux/mdio.h: definitions for MDIO (clause 45) transceivers</span>
<span class="cm"> * Copyright 2006-2009 Solarflare Communications Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License version 2 as published</span>
<span class="cm"> * by the Free Software Foundation, incorporated herein by reference.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __LINUX_MDIO_H__</span>
<span class="cp">#define __LINUX_MDIO_H__</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/mii.h&gt;</span>

<span class="cm">/* MDIO Manageable Devices (MMDs). */</span>
<span class="cp">#define MDIO_MMD_PMAPMD		1	</span><span class="cm">/* Physical Medium Attachment/</span>
<span class="cm">					 * Physical Medium Dependent */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_WIS		2	</span><span class="cm">/* WAN Interface Sublayer */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_PCS		3	</span><span class="cm">/* Physical Coding Sublayer */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_PHYXS		4	</span><span class="cm">/* PHY Extender Sublayer */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_DTEXS		5	</span><span class="cm">/* DTE Extender Sublayer */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_TC		6	</span><span class="cm">/* Transmission Convergence */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_AN		7	</span><span class="cm">/* Auto-Negotiation */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_C22EXT		29	</span><span class="cm">/* Clause 22 extension */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_VEND1		30	</span><span class="cm">/* Vendor specific 1 */</span><span class="cp"></span>
<span class="cp">#define MDIO_MMD_VEND2		31	</span><span class="cm">/* Vendor specific 2 */</span><span class="cp"></span>

<span class="cm">/* Generic MDIO registers. */</span>
<span class="cp">#define MDIO_CTRL1		MII_BMCR</span>
<span class="cp">#define MDIO_STAT1		MII_BMSR</span>
<span class="cp">#define MDIO_DEVID1		MII_PHYSID1</span>
<span class="cp">#define MDIO_DEVID2		MII_PHYSID2</span>
<span class="cp">#define MDIO_SPEED		4	</span><span class="cm">/* Speed ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_DEVS1		5	</span><span class="cm">/* Devices in package */</span><span class="cp"></span>
<span class="cp">#define MDIO_DEVS2		6</span>
<span class="cp">#define MDIO_CTRL2		7	</span><span class="cm">/* 10G control 2 */</span><span class="cp"></span>
<span class="cp">#define MDIO_STAT2		8	</span><span class="cm">/* 10G status 2 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_TXDIS		9	</span><span class="cm">/* 10G PMA/PMD transmit disable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_RXDET		10	</span><span class="cm">/* 10G PMA/PMD receive signal detect */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE	11	</span><span class="cm">/* 10G PMA/PMD extended ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PKGID1		14	</span><span class="cm">/* Package identifier */</span><span class="cp"></span>
<span class="cp">#define MDIO_PKGID2		15</span>
<span class="cp">#define MDIO_AN_ADVERTISE	16	</span><span class="cm">/* AN advertising (base page) */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_LPA		19	</span><span class="cm">/* AN LP abilities (base page) */</span><span class="cp"></span>
<span class="cp">#define MDIO_PHYXS_LNSTAT	24	</span><span class="cm">/* PHY XGXS lane state */</span><span class="cp"></span>

<span class="cm">/* Media-dependent registers. */</span>
<span class="cp">#define MDIO_PMA_10GBT_SWAPPOL	130	</span><span class="cm">/* 10GBASE-T pair swap &amp; polarity */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBT_TXPWR	131	</span><span class="cm">/* 10GBASE-T TX power control */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBT_SNR	133	</span><span class="cm">/* 10GBASE-T SNR margin, lane A.</span>
<span class="cm">					 * Lanes B-D are numbered 134-136. */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBR_FECABLE	170	</span><span class="cm">/* 10GBASE-R FEC ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_10GBX_STAT1	24	</span><span class="cm">/* 10GBASE-X PCS status 1 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_10GBRT_STAT1	32	</span><span class="cm">/* 10GBASE-R/-T PCS status 1 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_10GBRT_STAT2	33	</span><span class="cm">/* 10GBASE-R/-T PCS status 2 */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_CTRL	32	</span><span class="cm">/* 10GBASE-T auto-negotiation control */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_STAT	33	</span><span class="cm">/* 10GBASE-T auto-negotiation status */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_EEE_ADV		60	</span><span class="cm">/* EEE advertisement */</span><span class="cp"></span>

<span class="cm">/* LASI (Link Alarm Status Interrupt) registers, defined by XENPAK MSA. */</span>
<span class="cp">#define MDIO_PMA_LASI_RXCTRL	0x9000	</span><span class="cm">/* RX_ALARM control */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TXCTRL	0x9001	</span><span class="cm">/* TX_ALARM control */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_CTRL	0x9002	</span><span class="cm">/* LASI control */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_RXSTAT	0x9003	</span><span class="cm">/* RX_ALARM status */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TXSTAT	0x9004	</span><span class="cm">/* TX_ALARM status */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_STAT	0x9005	</span><span class="cm">/* LASI status */</span><span class="cp"></span>

<span class="cm">/* Control register 1. */</span>
<span class="cm">/* Enable extended speed selection */</span>
<span class="cp">#define MDIO_CTRL1_SPEEDSELEXT		(BMCR_SPEED1000 | BMCR_SPEED100)</span>
<span class="cm">/* All speed selection bits */</span>
<span class="cp">#define MDIO_CTRL1_SPEEDSEL		(MDIO_CTRL1_SPEEDSELEXT | 0x003c)</span>
<span class="cp">#define MDIO_CTRL1_FULLDPLX		BMCR_FULLDPLX</span>
<span class="cp">#define MDIO_CTRL1_LPOWER		BMCR_PDOWN</span>
<span class="cp">#define MDIO_CTRL1_RESET		BMCR_RESET</span>
<span class="cp">#define MDIO_PMA_CTRL1_LOOPBACK		0x0001</span>
<span class="cp">#define MDIO_PMA_CTRL1_SPEED1000	BMCR_SPEED1000</span>
<span class="cp">#define MDIO_PMA_CTRL1_SPEED100		BMCR_SPEED100</span>
<span class="cp">#define MDIO_PCS_CTRL1_LOOPBACK		BMCR_LOOPBACK</span>
<span class="cp">#define MDIO_PHYXS_CTRL1_LOOPBACK	BMCR_LOOPBACK</span>
<span class="cp">#define MDIO_AN_CTRL1_RESTART		BMCR_ANRESTART</span>
<span class="cp">#define MDIO_AN_CTRL1_ENABLE		BMCR_ANENABLE</span>
<span class="cp">#define MDIO_AN_CTRL1_XNP		0x2000	</span><span class="cm">/* Enable extended next page */</span><span class="cp"></span>

<span class="cm">/* 10 Gb/s */</span>
<span class="cp">#define MDIO_CTRL1_SPEED10G		(MDIO_CTRL1_SPEEDSELEXT | 0x00)</span>
<span class="cm">/* 10PASS-TS/2BASE-TL */</span>
<span class="cp">#define MDIO_CTRL1_SPEED10P2B		(MDIO_CTRL1_SPEEDSELEXT | 0x04)</span>

<span class="cm">/* Status register 1. */</span>
<span class="cp">#define MDIO_STAT1_LPOWERABLE		0x0002	</span><span class="cm">/* Low-power ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_STAT1_LSTATUS		BMSR_LSTATUS</span>
<span class="cp">#define MDIO_STAT1_FAULT		0x0080	</span><span class="cm">/* Fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_STAT1_LPABLE		0x0001	</span><span class="cm">/* Link partner AN ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_STAT1_ABLE		BMSR_ANEGCAPABLE</span>
<span class="cp">#define MDIO_AN_STAT1_RFAULT		BMSR_RFAULT</span>
<span class="cp">#define MDIO_AN_STAT1_COMPLETE		BMSR_ANEGCOMPLETE</span>
<span class="cp">#define MDIO_AN_STAT1_PAGE		0x0040	</span><span class="cm">/* Page received */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_STAT1_XNP		0x0080	</span><span class="cm">/* Extended next page status */</span><span class="cp"></span>

<span class="cm">/* Speed register. */</span>
<span class="cp">#define MDIO_SPEED_10G			0x0001	</span><span class="cm">/* 10G capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_SPEED_2B		0x0002	</span><span class="cm">/* 2BASE-TL capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_SPEED_10P		0x0004	</span><span class="cm">/* 10PASS-TS capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_SPEED_1000		0x0010	</span><span class="cm">/* 1000M capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_SPEED_100		0x0020	</span><span class="cm">/* 100M capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_SPEED_10		0x0040	</span><span class="cm">/* 10M capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_SPEED_10P2B		0x0002	</span><span class="cm">/* 10PASS-TS/2BASE-TL capable */</span><span class="cp"></span>

<span class="cm">/* Device present registers. */</span>
<span class="cp">#define MDIO_DEVS_PRESENT(devad)	(1 &lt;&lt; (devad))</span>
<span class="cp">#define MDIO_DEVS_PMAPMD		MDIO_DEVS_PRESENT(MDIO_MMD_PMAPMD)</span>
<span class="cp">#define MDIO_DEVS_WIS			MDIO_DEVS_PRESENT(MDIO_MMD_WIS)</span>
<span class="cp">#define MDIO_DEVS_PCS			MDIO_DEVS_PRESENT(MDIO_MMD_PCS)</span>
<span class="cp">#define MDIO_DEVS_PHYXS			MDIO_DEVS_PRESENT(MDIO_MMD_PHYXS)</span>
<span class="cp">#define MDIO_DEVS_DTEXS			MDIO_DEVS_PRESENT(MDIO_MMD_DTEXS)</span>
<span class="cp">#define MDIO_DEVS_TC			MDIO_DEVS_PRESENT(MDIO_MMD_TC)</span>
<span class="cp">#define MDIO_DEVS_AN			MDIO_DEVS_PRESENT(MDIO_MMD_AN)</span>
<span class="cp">#define MDIO_DEVS_C22EXT		MDIO_DEVS_PRESENT(MDIO_MMD_C22EXT)</span>

<span class="cm">/* Control register 2. */</span>
<span class="cp">#define MDIO_PMA_CTRL2_TYPE		0x000f	</span><span class="cm">/* PMA/PMD type selection */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBCX4		0x0000	</span><span class="cm">/* 10GBASE-CX4 type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBEW		0x0001	</span><span class="cm">/* 10GBASE-EW type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBLW		0x0002	</span><span class="cm">/* 10GBASE-LW type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBSW		0x0003	</span><span class="cm">/* 10GBASE-SW type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBLX4		0x0004	</span><span class="cm">/* 10GBASE-LX4 type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBER		0x0005	</span><span class="cm">/* 10GBASE-ER type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBLR		0x0006	</span><span class="cm">/* 10GBASE-LR type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBSR		0x0007	</span><span class="cm">/* 10GBASE-SR type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBLRM		0x0008	</span><span class="cm">/* 10GBASE-LRM type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBT		0x0009	</span><span class="cm">/* 10GBASE-T type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBKX4		0x000a	</span><span class="cm">/* 10GBASE-KX4 type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10GBKR		0x000b	</span><span class="cm">/* 10GBASE-KR type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_1000BT		0x000c	</span><span class="cm">/* 1000BASE-T type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_1000BKX		0x000d	</span><span class="cm">/* 1000BASE-KX type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_100BTX		0x000e	</span><span class="cm">/* 100BASE-TX type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_CTRL2_10BT		0x000f	</span><span class="cm">/* 10BASE-T type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_CTRL2_TYPE		0x0003	</span><span class="cm">/* PCS type selection */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_CTRL2_10GBR		0x0000	</span><span class="cm">/* 10GBASE-R type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_CTRL2_10GBX		0x0001	</span><span class="cm">/* 10GBASE-X type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_CTRL2_10GBW		0x0002	</span><span class="cm">/* 10GBASE-W type */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_CTRL2_10GBT		0x0003	</span><span class="cm">/* 10GBASE-T type */</span><span class="cp"></span>

<span class="cm">/* Status register 2. */</span>
<span class="cp">#define MDIO_STAT2_RXFAULT		0x0400	</span><span class="cm">/* Receive fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_STAT2_TXFAULT		0x0800	</span><span class="cm">/* Transmit fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_STAT2_DEVPRST		0xc000	</span><span class="cm">/* Device present */</span><span class="cp"></span>
<span class="cp">#define MDIO_STAT2_DEVPRST_VAL		0x8000	</span><span class="cm">/* Device present value */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_LBABLE		0x0001	</span><span class="cm">/* PMA loopback ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_10GBEW		0x0002	</span><span class="cm">/* 10GBASE-EW ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_10GBLW		0x0004	</span><span class="cm">/* 10GBASE-LW ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_10GBSW		0x0008	</span><span class="cm">/* 10GBASE-SW ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_10GBLX4		0x0010	</span><span class="cm">/* 10GBASE-LX4 ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_10GBER		0x0020	</span><span class="cm">/* 10GBASE-ER ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_10GBLR		0x0040	</span><span class="cm">/* 10GBASE-LR ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_10GBSR		0x0080	</span><span class="cm">/* 10GBASE-SR ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_STAT2_TXDISAB		0x0100	</span><span class="cm">/* PMD TX disable ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_EXTABLE		0x0200	</span><span class="cm">/* Extended abilities */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_RXFLTABLE	0x1000	</span><span class="cm">/* Receive fault ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_STAT2_TXFLTABLE	0x2000	</span><span class="cm">/* Transmit fault ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_STAT2_10GBR		0x0001	</span><span class="cm">/* 10GBASE-R capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_STAT2_10GBX		0x0002	</span><span class="cm">/* 10GBASE-X capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_STAT2_10GBW		0x0004	</span><span class="cm">/* 10GBASE-W capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_STAT2_RXFLTABLE	0x1000	</span><span class="cm">/* Receive fault ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PCS_STAT2_TXFLTABLE	0x2000	</span><span class="cm">/* Transmit fault ability */</span><span class="cp"></span>

<span class="cm">/* Transmit disable register. */</span>
<span class="cp">#define MDIO_PMD_TXDIS_GLOBAL		0x0001	</span><span class="cm">/* Global PMD TX disable */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_TXDIS_0		0x0002	</span><span class="cm">/* PMD TX disable 0 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_TXDIS_1		0x0004	</span><span class="cm">/* PMD TX disable 1 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_TXDIS_2		0x0008	</span><span class="cm">/* PMD TX disable 2 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_TXDIS_3		0x0010	</span><span class="cm">/* PMD TX disable 3 */</span><span class="cp"></span>

<span class="cm">/* Receive signal detect register. */</span>
<span class="cp">#define MDIO_PMD_RXDET_GLOBAL		0x0001	</span><span class="cm">/* Global PMD RX signal detect */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_RXDET_0		0x0002	</span><span class="cm">/* PMD RX signal detect 0 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_RXDET_1		0x0004	</span><span class="cm">/* PMD RX signal detect 1 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_RXDET_2		0x0008	</span><span class="cm">/* PMD RX signal detect 2 */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMD_RXDET_3		0x0010	</span><span class="cm">/* PMD RX signal detect 3 */</span><span class="cp"></span>

<span class="cm">/* Extended abilities register. */</span>
<span class="cp">#define MDIO_PMA_EXTABLE_10GCX4		0x0001	</span><span class="cm">/* 10GBASE-CX4 ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_10GBLRM	0x0002	</span><span class="cm">/* 10GBASE-LRM ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_10GBT		0x0004	</span><span class="cm">/* 10GBASE-T ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_10GBKX4	0x0008	</span><span class="cm">/* 10GBASE-KX4 ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_10GBKR		0x0010	</span><span class="cm">/* 10GBASE-KR ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_1000BT		0x0020	</span><span class="cm">/* 1000BASE-T ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_1000BKX	0x0040	</span><span class="cm">/* 1000BASE-KX ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_100BTX		0x0080	</span><span class="cm">/* 100BASE-TX ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_EXTABLE_10BT		0x0100	</span><span class="cm">/* 10BASE-T ability */</span><span class="cp"></span>

<span class="cm">/* PHY XGXS lane state register. */</span>
<span class="cp">#define MDIO_PHYXS_LNSTAT_SYNC0		0x0001</span>
<span class="cp">#define MDIO_PHYXS_LNSTAT_SYNC1		0x0002</span>
<span class="cp">#define MDIO_PHYXS_LNSTAT_SYNC2		0x0004</span>
<span class="cp">#define MDIO_PHYXS_LNSTAT_SYNC3		0x0008</span>
<span class="cp">#define MDIO_PHYXS_LNSTAT_ALIGN		0x1000</span>

<span class="cm">/* PMA 10GBASE-T pair swap &amp; polarity */</span>
<span class="cp">#define MDIO_PMA_10GBT_SWAPPOL_ABNX	0x0001	</span><span class="cm">/* Pair A/B uncrossed */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBT_SWAPPOL_CDNX	0x0002	</span><span class="cm">/* Pair C/D uncrossed */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBT_SWAPPOL_AREV	0x0100	</span><span class="cm">/* Pair A polarity reversed */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBT_SWAPPOL_BREV	0x0200	</span><span class="cm">/* Pair B polarity reversed */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBT_SWAPPOL_CREV	0x0400	</span><span class="cm">/* Pair C polarity reversed */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBT_SWAPPOL_DREV	0x0800	</span><span class="cm">/* Pair D polarity reversed */</span><span class="cp"></span>

<span class="cm">/* PMA 10GBASE-T TX power register. */</span>
<span class="cp">#define MDIO_PMA_10GBT_TXPWR_SHORT	0x0001	</span><span class="cm">/* Short-reach mode */</span><span class="cp"></span>

<span class="cm">/* PMA 10GBASE-T SNR registers. */</span>
<span class="cm">/* Value is SNR margin in dB, clamped to range [-127, 127], plus 0x8000. */</span>
<span class="cp">#define MDIO_PMA_10GBT_SNR_BIAS		0x8000</span>
<span class="cp">#define MDIO_PMA_10GBT_SNR_MAX		127</span>

<span class="cm">/* PMA 10GBASE-R FEC ability register. */</span>
<span class="cp">#define MDIO_PMA_10GBR_FECABLE_ABLE	0x0001	</span><span class="cm">/* FEC ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_10GBR_FECABLE_ERRABLE	0x0002	</span><span class="cm">/* FEC error indic. ability */</span><span class="cp"></span>

<span class="cm">/* PCS 10GBASE-R/-T status register 1. */</span>
<span class="cp">#define MDIO_PCS_10GBRT_STAT1_BLKLK	0x0001	</span><span class="cm">/* Block lock attained */</span><span class="cp"></span>

<span class="cm">/* PCS 10GBASE-R/-T status register 2. */</span>
<span class="cp">#define MDIO_PCS_10GBRT_STAT2_ERR	0x00ff</span>
<span class="cp">#define MDIO_PCS_10GBRT_STAT2_BER	0x3f00</span>

<span class="cm">/* AN 10GBASE-T control register. */</span>
<span class="cp">#define MDIO_AN_10GBT_CTRL_ADV10G	0x1000	</span><span class="cm">/* Advertise 10GBASE-T */</span><span class="cp"></span>

<span class="cm">/* AN 10GBASE-T status register. */</span>
<span class="cp">#define MDIO_AN_10GBT_STAT_LPTRR	0x0200	</span><span class="cm">/* LP training reset req. */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_STAT_LPLTABLE	0x0400	</span><span class="cm">/* LP loop timing ability */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_STAT_LP10G	0x0800	</span><span class="cm">/* LP is 10GBT capable */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_STAT_REMOK	0x1000	</span><span class="cm">/* Remote OK */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_STAT_LOCOK	0x2000	</span><span class="cm">/* Local OK */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_STAT_MS		0x4000	</span><span class="cm">/* Master/slave config */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_10GBT_STAT_MSFLT	0x8000	</span><span class="cm">/* Master/slave config fault */</span><span class="cp"></span>

<span class="cm">/* AN EEE Advertisement register. */</span>
<span class="cp">#define MDIO_AN_EEE_ADV_100TX		0x0002	</span><span class="cm">/* Advertise 100TX EEE cap */</span><span class="cp"></span>
<span class="cp">#define MDIO_AN_EEE_ADV_1000T		0x0004	</span><span class="cm">/* Advertise 1000T EEE cap */</span><span class="cp"></span>

<span class="cm">/* LASI RX_ALARM control/status registers. */</span>
<span class="cp">#define MDIO_PMA_LASI_RX_PHYXSLFLT	0x0001	</span><span class="cm">/* PHY XS RX local fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_RX_PCSLFLT	0x0008	</span><span class="cm">/* PCS RX local fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_RX_PMALFLT	0x0010	</span><span class="cm">/* PMA/PMD RX local fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_RX_OPTICPOWERFLT	0x0020	</span><span class="cm">/* RX optical power fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_RX_WISLFLT	0x0200	</span><span class="cm">/* WIS local fault */</span><span class="cp"></span>

<span class="cm">/* LASI TX_ALARM control/status registers. */</span>
<span class="cp">#define MDIO_PMA_LASI_TX_PHYXSLFLT	0x0001	</span><span class="cm">/* PHY XS TX local fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TX_PCSLFLT	0x0008	</span><span class="cm">/* PCS TX local fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TX_PMALFLT	0x0010	</span><span class="cm">/* PMA/PMD TX local fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TX_LASERPOWERFLT	0x0080	</span><span class="cm">/* Laser output power fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TX_LASERTEMPFLT	0x0100	</span><span class="cm">/* Laser temperature fault */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TX_LASERBICURRFLT	0x0200	</span><span class="cm">/* Laser bias current fault */</span><span class="cp"></span>

<span class="cm">/* LASI control/status registers. */</span>
<span class="cp">#define MDIO_PMA_LASI_LSALARM		0x0001	</span><span class="cm">/* LS_ALARM enable/status */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_TXALARM		0x0002	</span><span class="cm">/* TX_ALARM enable/status */</span><span class="cp"></span>
<span class="cp">#define MDIO_PMA_LASI_RXALARM		0x0004	</span><span class="cm">/* RX_ALARM enable/status */</span><span class="cp"></span>

<span class="cm">/* Mapping between MDIO PRTAD/DEVAD and mii_ioctl_data::phy_id */</span>

<span class="cp">#define MDIO_PHY_ID_C45			0x8000</span>
<span class="cp">#define MDIO_PHY_ID_PRTAD		0x03e0</span>
<span class="cp">#define MDIO_PHY_ID_DEVAD		0x001f</span>
<span class="cp">#define MDIO_PHY_ID_C45_MASK						\</span>
<span class="cp">	(MDIO_PHY_ID_C45 | MDIO_PHY_ID_PRTAD | MDIO_PHY_ID_DEVAD)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">__u16</span> <span class="nf">mdio_phy_id_c45</span><span class="p">(</span><span class="kt">int</span> <span class="n">prtad</span><span class="p">,</span> <span class="kt">int</span> <span class="n">devad</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">MDIO_PHY_ID_C45</span> <span class="o">|</span> <span class="p">(</span><span class="n">prtad</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">devad</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">mdio_phy_id_is_c45</span><span class="p">(</span><span class="kt">int</span> <span class="n">phy_id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">phy_id</span> <span class="o">&amp;</span> <span class="n">MDIO_PHY_ID_C45</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">phy_id</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">MDIO_PHY_ID_C45_MASK</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">__u16</span> <span class="nf">mdio_phy_id_prtad</span><span class="p">(</span><span class="kt">int</span> <span class="n">phy_id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">phy_id</span> <span class="o">&amp;</span> <span class="n">MDIO_PHY_ID_PRTAD</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">__u16</span> <span class="nf">mdio_phy_id_devad</span><span class="p">(</span><span class="kt">int</span> <span class="n">phy_id</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">phy_id</span> <span class="o">&amp;</span> <span class="n">MDIO_PHY_ID_DEVAD</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * struct mdio_if_info - Ethernet controller MDIO interface</span>
<span class="cm"> * @prtad: PRTAD of the PHY (%MDIO_PRTAD_NONE if not present/unknown)</span>
<span class="cm"> * @mmds: Mask of MMDs expected to be present in the PHY.  This must be</span>
<span class="cm"> *	non-zero unless @prtad = %MDIO_PRTAD_NONE.</span>
<span class="cm"> * @mode_support: MDIO modes supported.  If %MDIO_SUPPORTS_C22 is set then</span>
<span class="cm"> *	MII register access will be passed through with @devad =</span>
<span class="cm"> *	%MDIO_DEVAD_NONE.  If %MDIO_EMULATE_C22 is set then access to</span>
<span class="cm"> *	commonly used clause 22 registers will be translated into</span>
<span class="cm"> *	clause 45 registers.</span>
<span class="cm"> * @dev: Net device structure</span>
<span class="cm"> * @mdio_read: Register read function; returns value or negative error code</span>
<span class="cm"> * @mdio_write: Register write function; returns 0 or negative error code</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">prtad</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mmds</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">mode_support</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">mdio_read</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">prtad</span><span class="p">,</span> <span class="kt">int</span> <span class="n">devad</span><span class="p">,</span>
			 <span class="n">u16</span> <span class="n">addr</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">mdio_write</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">prtad</span><span class="p">,</span> <span class="kt">int</span> <span class="n">devad</span><span class="p">,</span>
			  <span class="n">u16</span> <span class="n">addr</span><span class="p">,</span> <span class="n">u16</span> <span class="n">val</span><span class="p">);</span>
<span class="p">};</span>

<span class="cp">#define MDIO_PRTAD_NONE			(-1)</span>
<span class="cp">#define MDIO_DEVAD_NONE			(-1)</span>
<span class="cp">#define MDIO_SUPPORTS_C22		1</span>
<span class="cp">#define MDIO_SUPPORTS_C45		2</span>
<span class="cp">#define MDIO_EMULATE_C22		4</span>

<span class="k">struct</span> <span class="n">ethtool_cmd</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">ethtool_pauseparam</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mdio45_probe</span><span class="p">(</span><span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">,</span> <span class="kt">int</span> <span class="n">prtad</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mdio_set_flag</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">,</span>
			 <span class="kt">int</span> <span class="n">prtad</span><span class="p">,</span> <span class="kt">int</span> <span class="n">devad</span><span class="p">,</span> <span class="n">u16</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mask</span><span class="p">,</span>
			 <span class="n">bool</span> <span class="n">sense</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mdio45_links_ok</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">,</span> <span class="n">u32</span> <span class="n">mmds</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mdio45_nway_restart</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">mdio45_ethtool_gset_npage</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">,</span>
				      <span class="k">struct</span> <span class="n">ethtool_cmd</span> <span class="o">*</span><span class="n">ecmd</span><span class="p">,</span>
				      <span class="n">u32</span> <span class="n">npage_adv</span><span class="p">,</span> <span class="n">u32</span> <span class="n">npage_lpa</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>
<span class="n">mdio45_ethtool_spauseparam_an</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">,</span>
			      <span class="k">const</span> <span class="k">struct</span> <span class="n">ethtool_pauseparam</span> <span class="o">*</span><span class="n">ecmd</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * mdio45_ethtool_gset - get settings for ETHTOOL_GSET</span>
<span class="cm"> * @mdio: MDIO interface</span>
<span class="cm"> * @ecmd: Ethtool request structure</span>
<span class="cm"> *</span>
<span class="cm"> * Since the CSRs for auto-negotiation using next pages are not fully</span>
<span class="cm"> * standardised, this function does not attempt to decode them.  Use</span>
<span class="cm"> * mdio45_ethtool_gset_npage() to specify advertisement bits from next</span>
<span class="cm"> * pages.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">mdio45_ethtool_gset</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">ethtool_cmd</span> <span class="o">*</span><span class="n">ecmd</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mdio45_ethtool_gset_npage</span><span class="p">(</span><span class="n">mdio</span><span class="p">,</span> <span class="n">ecmd</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">mdio_mii_ioctl</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_if_info</span> <span class="o">*</span><span class="n">mdio</span><span class="p">,</span>
			  <span class="k">struct</span> <span class="n">mii_ioctl_data</span> <span class="o">*</span><span class="n">mii_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* __LINUX_MDIO_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
