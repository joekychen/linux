<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › sctp.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>sctp.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* SCTP kernel reference Implementation</span>
<span class="cm"> * (C) Copyright IBM Corp. 2001, 2004</span>
<span class="cm"> * Copyright (c) 1999-2000 Cisco, Inc.</span>
<span class="cm"> * Copyright (c) 1999-2001 Motorola, Inc.</span>
<span class="cm"> * Copyright (c) 2001 Intel Corp.</span>
<span class="cm"> * Copyright (c) 2001 Nokia, Inc.</span>
<span class="cm"> * Copyright (c) 2001 La Monte H.P. Yarroll</span>
<span class="cm"> *</span>
<span class="cm"> * This file is part of the SCTP kernel reference Implementation</span>
<span class="cm"> *</span>
<span class="cm"> * Various protocol defined structures.</span>
<span class="cm"> *</span>
<span class="cm"> * This SCTP implementation is free software;</span>
<span class="cm"> * you can redistribute it and/or modify it under the terms of</span>
<span class="cm"> * the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2, or (at your option)</span>
<span class="cm"> * any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This SCTP implementation is distributed in the hope that it</span>
<span class="cm"> * will be useful, but WITHOUT ANY WARRANTY; without even the implied</span>
<span class="cm"> *                 ************************</span>
<span class="cm"> * warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="cm"> * See the GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with GNU CC; see the file COPYING.  If not, write to</span>
<span class="cm"> * the Free Software Foundation, 59 Temple Place - Suite 330,</span>
<span class="cm"> * Boston, MA 02111-1307, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * Please send any bug reports or fixes you make to the</span>
<span class="cm"> * email address(es):</span>
<span class="cm"> *    lksctp developers &lt;lksctp-developerst@lists.sourceforge.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Or submit a bug report through the following website:</span>
<span class="cm"> *    http://www.sf.net/projects/lksctp</span>
<span class="cm"> *</span>
<span class="cm"> * Written or modified by:</span>
<span class="cm"> *    La Monte H.P. Yarroll &lt;piggy@acm.org&gt;</span>
<span class="cm"> *    Karl Knutson &lt;karl@athena.chicago.il.us&gt;</span>
<span class="cm"> *    Jon Grimm &lt;jgrimm@us.ibm.com&gt;</span>
<span class="cm"> *    Xingang Guo &lt;xingang.guo@intel.com&gt;</span>
<span class="cm"> *    randall@sctp.chicago.il.us</span>
<span class="cm"> *    kmorneau@cisco.com</span>
<span class="cm"> *    qxie1@email.mot.com</span>
<span class="cm"> *    Sridhar Samudrala &lt;sri@us.ibm.com&gt;</span>
<span class="cm"> *    Kevin Gao &lt;kevin.gao@intel.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Any bugs reported given to us we will try to fix... any fixes shared will</span>
<span class="cm"> * be incorporated into the next SCTP release.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __LINUX_SCTP_H__</span>
<span class="cp">#define __LINUX_SCTP_H__</span>

<span class="cp">#include &lt;linux/in.h&gt;		</span><span class="cm">/* We need in_addr.  */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/in6.h&gt;		</span><span class="cm">/* We need in6_addr.  */</span><span class="cp"></span>


<span class="cm">/* Section 3.1.  SCTP Common Header Format */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctphdr</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">source</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">dest</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">vtag</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">checksum</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_sctphdr_t</span><span class="p">;</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#include &lt;linux/skbuff.h&gt;</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">sctphdr</span> <span class="o">*</span><span class="nf">sctp_hdr</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">sctphdr</span> <span class="o">*</span><span class="p">)</span><span class="n">skb_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cm">/* Section 3.2.  Chunk Field Descriptions. */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_chunkhdr</span> <span class="p">{</span>
	<span class="n">__u8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_chunkhdr_t</span><span class="p">;</span>


<span class="cm">/* Section 3.2.  Chunk Type Values.</span>
<span class="cm"> * [Chunk Type] identifies the type of information contained in the Chunk</span>
<span class="cm"> * Value field. It takes a value from 0 to 254. The value of 255 is</span>
<span class="cm"> * reserved for future use as an extension field.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_CID_DATA</span>			<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">SCTP_CID_INIT</span>			<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">SCTP_CID_INIT_ACK</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">SCTP_CID_SACK</span>			<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">SCTP_CID_HEARTBEAT</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
        <span class="n">SCTP_CID_HEARTBEAT_ACK</span>		<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">SCTP_CID_ABORT</span>			<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
        <span class="n">SCTP_CID_SHUTDOWN</span>		<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
        <span class="n">SCTP_CID_SHUTDOWN_ACK</span>		<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
        <span class="n">SCTP_CID_ERROR</span>			<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
        <span class="n">SCTP_CID_COOKIE_ECHO</span>		<span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">SCTP_CID_COOKIE_ACK</span>	        <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
        <span class="n">SCTP_CID_ECN_ECNE</span>		<span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
        <span class="n">SCTP_CID_ECN_CWR</span>		<span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
        <span class="n">SCTP_CID_SHUTDOWN_COMPLETE</span>	<span class="o">=</span> <span class="mi">14</span><span class="p">,</span>

	<span class="cm">/* AUTH Extension Section 4.1 */</span>
	<span class="n">SCTP_CID_AUTH</span>			<span class="o">=</span> <span class="mh">0x0F</span><span class="p">,</span>

	<span class="cm">/* PR-SCTP Sec 3.2 */</span>
	<span class="n">SCTP_CID_FWD_TSN</span>		<span class="o">=</span> <span class="mh">0xC0</span><span class="p">,</span>

	<span class="cm">/* Use hex, as defined in ADDIP sec. 3.1 */</span>
	<span class="n">SCTP_CID_ASCONF</span>			<span class="o">=</span> <span class="mh">0xC1</span><span class="p">,</span>
	<span class="n">SCTP_CID_ASCONF_ACK</span>		<span class="o">=</span> <span class="mh">0x80</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_cid_t</span><span class="p">;</span> <span class="cm">/* enum */</span>


<span class="cm">/* Section 3.2</span>
<span class="cm"> *  Chunk Types are encoded such that the highest-order two bits specify</span>
<span class="cm"> *  the action that must be taken if the processing endpoint does not</span>
<span class="cm"> *  recognize the Chunk Type.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_CID_ACTION_DISCARD</span>     <span class="o">=</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="n">SCTP_CID_ACTION_DISCARD_ERR</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="n">SCTP_CID_ACTION_SKIP</span>        <span class="o">=</span> <span class="mh">0x80</span><span class="p">,</span>
	<span class="n">SCTP_CID_ACTION_SKIP_ERR</span>    <span class="o">=</span> <span class="mh">0xc0</span><span class="p">,</span>
<span class="p">}</span> <span class="n">sctp_cid_action_t</span><span class="p">;</span>

<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_CID_ACTION_MASK</span> <span class="o">=</span> <span class="mh">0xc0</span><span class="p">,</span> <span class="p">};</span>

<span class="cm">/* This flag is used in Chunk Flags for ABORT and SHUTDOWN COMPLETE.</span>
<span class="cm"> *</span>
<span class="cm"> * 3.3.7 Abort Association (ABORT) (6):</span>
<span class="cm"> *    The T bit is set to 0 if the sender had a TCB that it destroyed.</span>
<span class="cm"> *    If the sender did not have a TCB it should set this bit to 1.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_CHUNK_FLAG_T</span> <span class="o">=</span> <span class="mh">0x01</span> <span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *  Set the T bit</span>
<span class="cm"> *</span>
<span class="cm"> *      0                   1                   2                   3</span>
<span class="cm"> *      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span>
<span class="cm"> *     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *     |   Type = 14   |Reserved     |T|      Length = 4               |</span>
<span class="cm"> *     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *</span>
<span class="cm"> * Chunk Flags: 8 bits</span>
<span class="cm"> *</span>
<span class="cm"> *   Reserved:  7 bits</span>
<span class="cm"> *     Set to 0 on transmit and ignored on receipt.</span>
<span class="cm"> *</span>
<span class="cm"> *   T bit:  1 bit</span>
<span class="cm"> *     The T bit is set to 0 if the sender had a TCB that it destroyed. If</span>
<span class="cm"> *     the sender did NOT have a TCB it should set this bit to 1.</span>
<span class="cm"> *</span>
<span class="cm"> * Note: Special rules apply to this chunk for verification, please</span>
<span class="cm"> * see Section 8.5.1 for details.</span>
<span class="cm"> */</span>

<span class="cp">#define sctp_test_T_bit(c)    ((c)-&gt;chunk_hdr-&gt;flags &amp; SCTP_CHUNK_FLAG_T)</span>

<span class="cm">/* RFC 2960</span>
<span class="cm"> * Section 3.2.1 Optional/Variable-length Parmaeter Format.</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_paramhdr</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_paramhdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>

	<span class="cm">/* RFC 2960 Section 3.3.5 */</span>
	<span class="n">SCTP_PARAM_HEARTBEAT_INFO</span>		<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="cm">/* RFC 2960 Section 3.3.2.1 */</span>
	<span class="n">SCTP_PARAM_IPV4_ADDRESS</span>			<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_IPV6_ADDRESS</span>			<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_STATE_COOKIE</span>			<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_UNRECOGNIZED_PARAMETERS</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_COOKIE_PRESERVATIVE</span>		<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_HOST_NAME_ADDRESS</span>		<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_SUPPORTED_ADDRESS_TYPES</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_ECN_CAPABLE</span>			<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x8000</span><span class="p">),</span>

	<span class="cm">/* AUTH Extension Section 3 */</span>
	<span class="n">SCTP_PARAM_RANDOM</span>			<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x8002</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_CHUNKS</span>			<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x8003</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_HMAC_ALGO</span>			<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x8004</span><span class="p">),</span>

	<span class="cm">/* Add-IP: Supported Extensions, Section 4.2 */</span>
	<span class="n">SCTP_PARAM_SUPPORTED_EXT</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x8008</span><span class="p">),</span>

	<span class="cm">/* PR-SCTP Sec 3.1 */</span>
	<span class="n">SCTP_PARAM_FWD_TSN_SUPPORT</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc000</span><span class="p">),</span>

	<span class="cm">/* Add-IP Extension. Section 3.2 */</span>
	<span class="n">SCTP_PARAM_ADD_IP</span>		<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc001</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_DEL_IP</span>		<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc002</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_ERR_CAUSE</span>		<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc003</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_SET_PRIMARY</span>		<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc004</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_SUCCESS_REPORT</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc005</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_ADAPTATION_LAYER_IND</span> <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc006</span><span class="p">),</span>

<span class="p">}</span> <span class="n">sctp_param_t</span><span class="p">;</span> <span class="cm">/* enum */</span>


<span class="cm">/* RFC 2960 Section 3.2.1</span>
<span class="cm"> *  The Parameter Types are encoded such that the highest-order two bits</span>
<span class="cm"> *  specify the action that must be taken if the processing endpoint does</span>
<span class="cm"> *  not recognize the Parameter Type.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_PARAM_ACTION_DISCARD</span>     <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_ACTION_DISCARD_ERR</span> <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x4000</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_ACTION_SKIP</span>        <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x8000</span><span class="p">),</span>
	<span class="n">SCTP_PARAM_ACTION_SKIP_ERR</span>    <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc000</span><span class="p">),</span>
<span class="p">}</span> <span class="n">sctp_param_action_t</span><span class="p">;</span>

<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_PARAM_ACTION_MASK</span> <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0xc000</span><span class="p">),</span> <span class="p">};</span>

<span class="cm">/* RFC 2960 Section 3.3.1 Payload Data (DATA) (0) */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_datahdr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">tsn</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">stream</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">ssn</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">ppid</span><span class="p">;</span>
	<span class="n">__u8</span>  <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_datahdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_data_chunk</span> <span class="p">{</span>
        <span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
        <span class="n">sctp_datahdr_t</span>  <span class="n">data_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_data_chunk_t</span><span class="p">;</span>

<span class="cm">/* DATA Chuck Specific Flags */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">SCTP_DATA_MIDDLE_FRAG</span>	<span class="o">=</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="n">SCTP_DATA_LAST_FRAG</span>	<span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">SCTP_DATA_FIRST_FRAG</span>	<span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">SCTP_DATA_NOT_FRAG</span>	<span class="o">=</span> <span class="mh">0x03</span><span class="p">,</span>
	<span class="n">SCTP_DATA_UNORDERED</span>	<span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
	<span class="n">SCTP_DATA_SACK_IMM</span>	<span class="o">=</span> <span class="mh">0x08</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="p">{</span> <span class="n">SCTP_DATA_FRAG_MASK</span> <span class="o">=</span> <span class="mh">0x03</span><span class="p">,</span> <span class="p">};</span>


<span class="cm">/* RFC 2960 Section 3.3.2 Initiation (INIT) (1)</span>
<span class="cm"> *</span>
<span class="cm"> *  This chunk is used to initiate a SCTP association between two</span>
<span class="cm"> *  endpoints.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_inithdr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">init_tag</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">a_rwnd</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">num_outbound_streams</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">num_inbound_streams</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">initial_tsn</span><span class="p">;</span>
	<span class="n">__u8</span>  <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_inithdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_init_chunk</span> <span class="p">{</span>
	<span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_inithdr_t</span> <span class="n">init_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_init_chunk_t</span><span class="p">;</span>


<span class="cm">/* Section 3.3.2.1. IPv4 Address Parameter (5) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_ipv4addr_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">in_addr</span>  <span class="n">addr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_ipv4addr_param_t</span><span class="p">;</span>

<span class="cm">/* Section 3.3.2.1. IPv6 Address Parameter (6) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_ipv6addr_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">in6_addr</span> <span class="n">addr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_ipv6addr_param_t</span><span class="p">;</span>

<span class="cm">/* Section 3.3.2.1 Cookie Preservative (9) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_cookie_preserve_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__be32</span>          <span class="n">lifespan_increment</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_cookie_preserve_param_t</span><span class="p">;</span>

<span class="cm">/* Section 3.3.2.1 Host Name Address (11) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_hostname_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="kt">uint8_t</span> <span class="n">hostname</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_hostname_param_t</span><span class="p">;</span>

<span class="cm">/* Section 3.3.2.1 Supported Address Types (12) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_supported_addrs_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">types</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_supported_addrs_param_t</span><span class="p">;</span>

<span class="cm">/* Appendix A. ECN Capable (32768) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_ecn_capable_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_ecn_capable_param_t</span><span class="p">;</span>

<span class="cm">/* ADDIP Section 3.2.6 Adaptation Layer Indication */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_adaptation_ind_param</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sctp_paramhdr</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">adaptation_ind</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_adaptation_ind_param_t</span><span class="p">;</span>

<span class="cm">/* ADDIP Section 4.2.7 Supported Extensions Parameter */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_supported_ext_param</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sctp_paramhdr</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_supported_ext_param_t</span><span class="p">;</span>

<span class="cm">/* AUTH Section 3.1 Random */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_random_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">random_val</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_random_param_t</span><span class="p">;</span>

<span class="cm">/* AUTH Section 3.2 Chunk List */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_chunks_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_chunks_param_t</span><span class="p">;</span>

<span class="cm">/* AUTH Section 3.3 HMAC Algorithm */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_hmac_algo_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">hmac_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_hmac_algo_param_t</span><span class="p">;</span>

<span class="cm">/* RFC 2960.  Section 3.3.3 Initiation Acknowledgement (INIT ACK) (2):</span>
<span class="cm"> *   The INIT ACK chunk is used to acknowledge the initiation of an SCTP</span>
<span class="cm"> *   association.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="n">sctp_init_chunk_t</span> <span class="n">sctp_initack_chunk_t</span><span class="p">;</span>

<span class="cm">/* Section 3.3.3.1 State Cookie (7) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_cookie_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">p</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">body</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_cookie_param_t</span><span class="p">;</span>

<span class="cm">/* Section 3.3.3.1 Unrecognized Parameters (8) */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_unrecognized_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">unrecognized</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_unrecognized_param_t</span><span class="p">;</span>



<span class="cm">/*</span>
<span class="cm"> * 3.3.4 Selective Acknowledgement (SACK) (3):</span>
<span class="cm"> *</span>
<span class="cm"> *  This chunk is sent to the peer endpoint to acknowledge received DATA</span>
<span class="cm"> *  chunks and to inform the peer endpoint of gaps in the received</span>
<span class="cm"> *  subsequences of DATA chunks as represented by their TSNs.</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_gap_ack_block</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">start</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">end</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_gap_ack_block_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="n">__be32</span> <span class="n">sctp_dup_tsn_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
	<span class="n">sctp_gap_ack_block_t</span>	<span class="n">gab</span><span class="p">;</span>
        <span class="n">sctp_dup_tsn_t</span>		<span class="n">dup</span><span class="p">;</span>
<span class="p">}</span> <span class="n">sctp_sack_variable_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_sackhdr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">cum_tsn_ack</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">a_rwnd</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">num_gap_ack_blocks</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">num_dup_tsns</span><span class="p">;</span>
	<span class="n">sctp_sack_variable_t</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_sackhdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_sack_chunk</span> <span class="p">{</span>
	<span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_sackhdr_t</span> <span class="n">sack_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_sack_chunk_t</span><span class="p">;</span>


<span class="cm">/* RFC 2960.  Section 3.3.5 Heartbeat Request (HEARTBEAT) (4):</span>
<span class="cm"> *</span>
<span class="cm"> *  An endpoint should send this chunk to its peer endpoint to probe the</span>
<span class="cm"> *  reachability of a particular destination transport address defined in</span>
<span class="cm"> *  the present association.</span>
<span class="cm"> */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_heartbeathdr</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span> <span class="n">info</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_heartbeathdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_heartbeat_chunk</span> <span class="p">{</span>
	<span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_heartbeathdr_t</span> <span class="n">hb_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_heartbeat_chunk_t</span><span class="p">;</span>


<span class="cm">/* For the abort and shutdown ACK we must carry the init tag in the</span>
<span class="cm"> * common header. Just the common header is all that is needed with a</span>
<span class="cm"> * chunk descriptor.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_abort_chunk</span> <span class="p">{</span>
        <span class="n">sctp_chunkhdr_t</span> <span class="n">uh</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_abort_chunk_t</span><span class="p">;</span>


<span class="cm">/* For the graceful shutdown we must carry the tag (in common header)</span>
<span class="cm"> * and the highest consecutive acking value.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_shutdownhdr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">cum_tsn_ack</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_shutdownhdr_t</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">sctp_shutdown_chunk_t</span> <span class="p">{</span>
        <span class="n">sctp_chunkhdr_t</span>    <span class="n">chunk_hdr</span><span class="p">;</span>
        <span class="n">sctp_shutdownhdr_t</span> <span class="n">shutdown_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* RFC 2960.  Section 3.3.10 Operation Error (ERROR) (9) */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_errhdr</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">cause</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">__u8</span>  <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_errhdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_operr_chunk</span> <span class="p">{</span>
        <span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_errhdr_t</span>   <span class="n">err_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_operr_chunk_t</span><span class="p">;</span>

<span class="cm">/* RFC 2960 3.3.10 - Operation Error</span>
<span class="cm"> *</span>
<span class="cm"> * Cause Code: 16 bits (unsigned integer)</span>
<span class="cm"> *</span>
<span class="cm"> *     Defines the type of error conditions being reported.</span>
<span class="cm"> *    Cause Code</span>
<span class="cm"> *     Value           Cause Code</span>
<span class="cm"> *     ---------      ----------------</span>
<span class="cm"> *      1              Invalid Stream Identifier</span>
<span class="cm"> *      2              Missing Mandatory Parameter</span>
<span class="cm"> *      3              Stale Cookie Error</span>
<span class="cm"> *      4              Out of Resource</span>
<span class="cm"> *      5              Unresolvable Address</span>
<span class="cm"> *      6              Unrecognized Chunk Type</span>
<span class="cm"> *      7              Invalid Mandatory Parameter</span>
<span class="cm"> *      8              Unrecognized Parameters</span>
<span class="cm"> *      9              No User Data</span>
<span class="cm"> *     10              Cookie Received While Shutting Down</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span>

	<span class="n">SCTP_ERROR_NO_ERROR</span>	   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x00</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_INV_STRM</span>	   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x01</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_MISS_PARAM</span> 	   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x02</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_STALE_COOKIE</span>	   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x03</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_NO_RESOURCE</span> 	   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x04</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_DNS_FAILED</span>      <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x05</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_UNKNOWN_CHUNK</span>   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x06</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_INV_PARAM</span>       <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x07</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_UNKNOWN_PARAM</span>   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x08</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_NO_DATA</span>         <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x09</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_COOKIE_IN_SHUTDOWN</span> <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x0a</span><span class="p">),</span>


	<span class="cm">/* SCTP Implementation Guide:</span>
<span class="cm">	 *  11  Restart of an association with new addresses</span>
<span class="cm">	 *  12  User Initiated Abort</span>
<span class="cm">	 *  13  Protocol Violation</span>
<span class="cm">	 */</span>

	<span class="n">SCTP_ERROR_RESTART</span>         <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x0b</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_USER_ABORT</span>      <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x0c</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_PROTO_VIOLATION</span> <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x0d</span><span class="p">),</span>

	<span class="cm">/* ADDIP Section 3.3  New Error Causes</span>
<span class="cm">	 *</span>
<span class="cm">	 * Four new Error Causes are added to the SCTP Operational Errors,</span>
<span class="cm">	 * primarily for use in the ASCONF-ACK chunk.</span>
<span class="cm">	 *</span>
<span class="cm">	 * Value          Cause Code</span>
<span class="cm">	 * ---------      ----------------</span>
<span class="cm">	 * 0x00A0          Request to Delete Last Remaining IP Address.</span>
<span class="cm">	 * 0x00A1          Operation Refused Due to Resource Shortage.</span>
<span class="cm">	 * 0x00A2          Request to Delete Source IP Address.</span>
<span class="cm">	 * 0x00A3          Association Aborted due to illegal ASCONF-ACK</span>
<span class="cm">	 * 0x00A4          Request refused - no authorization.</span>
<span class="cm">	 */</span>
	<span class="n">SCTP_ERROR_DEL_LAST_IP</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x00A0</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_RSRC_LOW</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x00A1</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_DEL_SRC_IP</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x00A2</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_ASCONF_ACK</span>   <span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x00A3</span><span class="p">),</span>
	<span class="n">SCTP_ERROR_REQ_REFUSED</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x00A4</span><span class="p">),</span>

	<span class="cm">/* AUTH Section 4.  New Error Cause</span>
<span class="cm">	 *</span>
<span class="cm">	 * This section defines a new error cause that will be sent if an AUTH</span>
<span class="cm">	 * chunk is received with an unsupported HMAC identifier.</span>
<span class="cm">	 * illustrates the new error cause.</span>
<span class="cm">	 *</span>
<span class="cm">	 * Cause Code      Error Cause Name</span>
<span class="cm">	 * --------------------------------------------------------------</span>
<span class="cm">	 * 0x0105          Unsupported HMAC Identifier</span>
<span class="cm">	 */</span>
	 <span class="n">SCTP_ERROR_UNSUP_HMAC</span>	<span class="o">=</span> <span class="n">cpu_to_be16</span><span class="p">(</span><span class="mh">0x0105</span><span class="p">)</span>
<span class="p">}</span> <span class="n">sctp_error_t</span><span class="p">;</span>



<span class="cm">/* RFC 2960.  Appendix A.  Explicit Congestion Notification.</span>
<span class="cm"> *   Explicit Congestion Notification Echo (ECNE) (12)</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_ecnehdr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">lowest_tsn</span><span class="p">;</span>
<span class="p">}</span> <span class="n">sctp_ecnehdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_ecne_chunk</span> <span class="p">{</span>
	<span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_ecnehdr_t</span> <span class="n">ence_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_ecne_chunk_t</span><span class="p">;</span>

<span class="cm">/* RFC 2960.  Appendix A.  Explicit Congestion Notification.</span>
<span class="cm"> *   Congestion Window Reduced (CWR) (13)</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_cwrhdr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">lowest_tsn</span><span class="p">;</span>
<span class="p">}</span> <span class="n">sctp_cwrhdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_cwr_chunk</span> <span class="p">{</span>
	<span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_cwrhdr_t</span> <span class="n">cwr_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_cwr_chunk_t</span><span class="p">;</span>

<span class="cm">/* PR-SCTP</span>
<span class="cm"> * 3.2 Forward Cumulative TSN Chunk Definition (FORWARD TSN)</span>
<span class="cm"> *</span>
<span class="cm"> * Forward Cumulative TSN chunk has the following format:</span>
<span class="cm"> *</span>
<span class="cm"> *        0                   1                   2                   3</span>
<span class="cm"> *        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span>
<span class="cm"> *      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *      |   Type = 192  |  Flags = 0x00 |        Length = Variable      |</span>
<span class="cm"> *      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *      |                      New Cumulative TSN                       |</span>
<span class="cm"> *      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *      |         Stream-1              |       Stream Sequence-1       |</span>
<span class="cm"> *      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *      \                                                               /</span>
<span class="cm"> *      /                                                               \</span>
<span class="cm"> *      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *      |         Stream-N              |       Stream Sequence-N       |</span>
<span class="cm"> *      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *</span>
<span class="cm"> *      Chunk Flags:</span>
<span class="cm"> *</span>
<span class="cm"> *        Set to all zeros on transmit and ignored on receipt.</span>
<span class="cm"> *</span>
<span class="cm"> *      New Cumulative TSN: 32 bit u_int</span>
<span class="cm"> *</span>
<span class="cm"> *       This indicates the new cumulative TSN to the data receiver. Upon</span>
<span class="cm"> *       the reception of this value, the data receiver MUST consider</span>
<span class="cm"> *       any missing TSNs earlier than or equal to this value as received</span>
<span class="cm"> *       and stop reporting them as gaps in any subsequent SACKs.</span>
<span class="cm"> *</span>
<span class="cm"> *      Stream-N: 16 bit u_int</span>
<span class="cm"> *</span>
<span class="cm"> *       This field holds a stream number that was skipped by this</span>
<span class="cm"> *       FWD-TSN.</span>
<span class="cm"> *</span>
<span class="cm"> *      Stream Sequence-N: 16 bit u_int</span>
<span class="cm"> *       This field holds the sequence number associated with the stream</span>
<span class="cm"> *       that was skipped. The stream sequence field holds the largest stream</span>
<span class="cm"> *       sequence number in this stream being skipped.  The receiver of</span>
<span class="cm"> *       the FWD-TSN&#39;s can use the Stream-N and Stream Sequence-N fields</span>
<span class="cm"> *       to enable delivery of any stranded TSN&#39;s that remain on the stream</span>
<span class="cm"> *       re-ordering queues. This field MUST NOT report TSN&#39;s corresponding</span>
<span class="cm"> *       to DATA chunk that are marked as unordered. For ordered DATA</span>
<span class="cm"> *       chunks this field MUST be filled in.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">sctp_fwdtsn_skip</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">stream</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">ssn</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">sctp_fwdtsn_hdr</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">new_cum_tsn</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sctp_fwdtsn_skip</span> <span class="n">skip</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">sctp_fwdtsn_chunk</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sctp_chunkhdr</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sctp_fwdtsn_hdr</span> <span class="n">fwdtsn_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>


<span class="cm">/* ADDIP</span>
<span class="cm"> * Section 3.1.1 Address Configuration Change Chunk (ASCONF)</span>
<span class="cm"> *</span>
<span class="cm"> * 	Serial Number: 32 bits (unsigned integer)</span>
<span class="cm"> *	This value represents a Serial Number for the ASCONF Chunk. The</span>
<span class="cm"> *	valid range of Serial Number is from 0 to 2^32-1.</span>
<span class="cm"> *	Serial Numbers wrap back to 0 after reaching 2^32 -1.</span>
<span class="cm"> *</span>
<span class="cm"> *	Address Parameter: 8 or 20 bytes (depending on type)</span>
<span class="cm"> *	The address is an address of the sender of the ASCONF chunk,</span>
<span class="cm"> *	the address MUST be considered part of the association by the</span>
<span class="cm"> *	peer endpoint. This field may be used by the receiver of the </span>
<span class="cm"> *	ASCONF to help in finding the association. This parameter MUST</span>
<span class="cm"> *	be present in every ASCONF message i.e. it is a mandatory TLV</span>
<span class="cm"> *	parameter.</span>
<span class="cm"> *</span>
<span class="cm"> *	ASCONF Parameter: TLV format</span>
<span class="cm"> *	Each Address configuration change is represented by a TLV</span>
<span class="cm"> *	parameter as defined in Section 3.2. One or more requests may</span>
<span class="cm"> *	be present in an ASCONF Chunk.</span>
<span class="cm"> *</span>
<span class="cm"> * Section 3.1.2 Address Configuration Acknowledgement Chunk (ASCONF-ACK)</span>
<span class="cm"> * </span>
<span class="cm"> *	Serial Number: 32 bits (unsigned integer)</span>
<span class="cm"> *	This value represents the Serial Number for the received ASCONF</span>
<span class="cm"> *	Chunk that is acknowledged by this chunk. This value is copied</span>
<span class="cm"> *	from the received ASCONF Chunk. </span>
<span class="cm"> *</span>
<span class="cm"> *	ASCONF Parameter Response: TLV format</span>
<span class="cm"> *	The ASCONF Parameter Response is used in the ASCONF-ACK to</span>
<span class="cm"> *	report status of ASCONF processing.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_addip_param</span> <span class="p">{</span>
	<span class="n">sctp_paramhdr_t</span>	<span class="n">param_hdr</span><span class="p">;</span>
	<span class="n">__be32</span>		<span class="n">crr_id</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_addip_param_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_addiphdr</span> <span class="p">{</span>
	<span class="n">__be32</span>	<span class="n">serial</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_addiphdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_addip_chunk</span> <span class="p">{</span>
	<span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_addiphdr_t</span> <span class="n">addip_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_addip_chunk_t</span><span class="p">;</span>

<span class="cm">/* AUTH</span>
<span class="cm"> * Section 4.1  Authentication Chunk (AUTH)</span>
<span class="cm"> *</span>
<span class="cm"> *   This chunk is used to hold the result of the HMAC calculation.</span>
<span class="cm"> *</span>
<span class="cm"> *    0                   1                   2                   3</span>
<span class="cm"> *    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span>
<span class="cm"> *   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *   | Type = 0x0F   |   Flags=0     |             Length            |</span>
<span class="cm"> *   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *   |     Shared Key Identifier     |   HMAC Identifier             |</span>
<span class="cm"> *   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *   |                                                               |</span>
<span class="cm"> *   \                             HMAC                              /</span>
<span class="cm"> *   /                                                               \</span>
<span class="cm"> *   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span>
<span class="cm"> *</span>
<span class="cm"> *   Type: 1 byte (unsigned integer)</span>
<span class="cm"> *   	This value MUST be set to 0x0F for  all AUTH-chunks.</span>
<span class="cm"> *</span>
<span class="cm"> *   Flags: 1 byte (unsigned integer)</span>
<span class="cm"> *	Set to zero on transmit and ignored on receipt.</span>
<span class="cm"> *</span>
<span class="cm"> *   Length: 2 bytes (unsigned integer)</span>
<span class="cm"> *   	This value holds the length of the HMAC in bytes plus 8.</span>
<span class="cm"> *</span>
<span class="cm"> *  Shared Key Identifier: 2 bytes (unsigned integer)</span>
<span class="cm"> *	This value describes which endpoint pair shared key is used.</span>
<span class="cm"> *</span>
<span class="cm"> *   HMAC Identifier: 2 bytes (unsigned integer)</span>
<span class="cm"> *   	This value describes which message digest is being used.  Table 2</span>
<span class="cm"> *	shows the currently defined values.</span>
<span class="cm"> *</span>
<span class="cm"> *    The following Table 2 shows the currently defined values for HMAC</span>
<span class="cm"> *       identifiers.</span>
<span class="cm"> *</span>
<span class="cm"> *	 +-----------------+--------------------------+</span>
<span class="cm"> *	 | HMAC Identifier | Message Digest Algorithm |</span>
<span class="cm"> *	 +-----------------+--------------------------+</span>
<span class="cm"> *	 | 0               | Reserved                 |</span>
<span class="cm"> *	 | 1               | SHA-1 defined in [8]     |</span>
<span class="cm"> *	 | 2               | Reserved                 |</span>
<span class="cm"> *	 | 3               | SHA-256 defined in [8]   |</span>
<span class="cm"> *	 +-----------------+--------------------------+</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> *   HMAC: n bytes (unsigned integer) This hold the result of the HMAC</span>
<span class="cm"> *      calculation.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_authhdr</span> <span class="p">{</span>
	<span class="n">__be16</span> <span class="n">shkey_id</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">hmac_id</span><span class="p">;</span>
	<span class="n">__u8</span>   <span class="n">hmac</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_authhdr_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sctp_auth_chunk</span> <span class="p">{</span>
	<span class="n">sctp_chunkhdr_t</span> <span class="n">chunk_hdr</span><span class="p">;</span>
	<span class="n">sctp_authhdr_t</span> <span class="n">auth_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span> <span class="n">sctp_auth_chunk_t</span><span class="p">;</span>

<span class="cp">#endif </span><span class="cm">/* __LINUX_SCTP_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
