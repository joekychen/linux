<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › i2c › twl.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>twl.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * twl4030.h - header for TWL4030 PM and audio CODEC device</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2005-2006 Texas Instruments, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Based on tlv320aic23.c:</span>
<span class="cm"> * Copyright (c) by Kai Svahn &lt;kai.svahn@nokia.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __TWL_H_</span>
<span class="cp">#define __TWL_H_</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/input/matrix_keypad.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Using the twl4030 core we address registers using a pair</span>
<span class="cm"> *	{ module id, relative register offset }</span>
<span class="cm"> * which that core then maps to the relevant</span>
<span class="cm"> *	{ i2c slave, absolute register address }</span>
<span class="cm"> *</span>
<span class="cm"> * The module IDs are meaningful only to the twl4030 core code,</span>
<span class="cm"> * which uses them as array indices to look up the first register</span>
<span class="cm"> * address each module uses within a given i2c slave.</span>
<span class="cm"> */</span>

<span class="cm">/* Slave 0 (i2c address 0x48) */</span>
<span class="cp">#define TWL4030_MODULE_USB		0x00</span>

<span class="cm">/* Slave 1 (i2c address 0x49) */</span>
<span class="cp">#define TWL4030_MODULE_AUDIO_VOICE	0x01</span>
<span class="cp">#define TWL4030_MODULE_GPIO		0x02</span>
<span class="cp">#define TWL4030_MODULE_INTBR		0x03</span>
<span class="cp">#define TWL4030_MODULE_PIH		0x04</span>
<span class="cp">#define TWL4030_MODULE_TEST		0x05</span>

<span class="cm">/* Slave 2 (i2c address 0x4a) */</span>
<span class="cp">#define TWL4030_MODULE_KEYPAD		0x06</span>
<span class="cp">#define TWL4030_MODULE_MADC		0x07</span>
<span class="cp">#define TWL4030_MODULE_INTERRUPTS	0x08</span>
<span class="cp">#define TWL4030_MODULE_LED		0x09</span>
<span class="cp">#define TWL4030_MODULE_MAIN_CHARGE	0x0A</span>
<span class="cp">#define TWL4030_MODULE_PRECHARGE	0x0B</span>
<span class="cp">#define TWL4030_MODULE_PWM0		0x0C</span>
<span class="cp">#define TWL4030_MODULE_PWM1		0x0D</span>
<span class="cp">#define TWL4030_MODULE_PWMA		0x0E</span>
<span class="cp">#define TWL4030_MODULE_PWMB		0x0F</span>

<span class="cp">#define TWL5031_MODULE_ACCESSORY	0x10</span>
<span class="cp">#define TWL5031_MODULE_INTERRUPTS	0x11</span>

<span class="cm">/* Slave 3 (i2c address 0x4b) */</span>
<span class="cp">#define TWL4030_MODULE_BACKUP		0x12</span>
<span class="cp">#define TWL4030_MODULE_INT		0x13</span>
<span class="cp">#define TWL4030_MODULE_PM_MASTER	0x14</span>
<span class="cp">#define TWL4030_MODULE_PM_RECEIVER	0x15</span>
<span class="cp">#define TWL4030_MODULE_RTC		0x16</span>
<span class="cp">#define TWL4030_MODULE_SECURED_REG	0x17</span>

<span class="cp">#define TWL_MODULE_USB		TWL4030_MODULE_USB</span>
<span class="cp">#define TWL_MODULE_AUDIO_VOICE	TWL4030_MODULE_AUDIO_VOICE</span>
<span class="cp">#define TWL_MODULE_PIH		TWL4030_MODULE_PIH</span>
<span class="cp">#define TWL_MODULE_MADC		TWL4030_MODULE_MADC</span>
<span class="cp">#define TWL_MODULE_MAIN_CHARGE	TWL4030_MODULE_MAIN_CHARGE</span>
<span class="cp">#define TWL_MODULE_PM_MASTER	TWL4030_MODULE_PM_MASTER</span>
<span class="cp">#define TWL_MODULE_PM_RECEIVER	TWL4030_MODULE_PM_RECEIVER</span>
<span class="cp">#define TWL_MODULE_RTC		TWL4030_MODULE_RTC</span>
<span class="cp">#define TWL_MODULE_PWM		TWL4030_MODULE_PWM0</span>

<span class="cp">#define TWL6030_MODULE_ID0	0x0D</span>
<span class="cp">#define TWL6030_MODULE_ID1	0x0E</span>
<span class="cp">#define TWL6030_MODULE_ID2	0x0F</span>

<span class="cp">#define GPIO_INTR_OFFSET	0</span>
<span class="cp">#define KEYPAD_INTR_OFFSET	1</span>
<span class="cp">#define BCI_INTR_OFFSET		2</span>
<span class="cp">#define MADC_INTR_OFFSET	3</span>
<span class="cp">#define USB_INTR_OFFSET		4</span>
<span class="cp">#define CHARGERFAULT_INTR_OFFSET 5</span>
<span class="cp">#define BCI_PRES_INTR_OFFSET	9</span>
<span class="cp">#define USB_PRES_INTR_OFFSET	10</span>
<span class="cp">#define RTC_INTR_OFFSET		11</span>

<span class="cm">/*</span>
<span class="cm"> * Offset from TWL6030_IRQ_BASE / pdata-&gt;irq_base</span>
<span class="cm"> */</span>
<span class="cp">#define PWR_INTR_OFFSET		0</span>
<span class="cp">#define HOTDIE_INTR_OFFSET	12</span>
<span class="cp">#define SMPSLDO_INTR_OFFSET	13</span>
<span class="cp">#define BATDETECT_INTR_OFFSET	14</span>
<span class="cp">#define SIMDETECT_INTR_OFFSET	15</span>
<span class="cp">#define MMCDETECT_INTR_OFFSET	16</span>
<span class="cp">#define GASGAUGE_INTR_OFFSET	17</span>
<span class="cp">#define USBOTG_INTR_OFFSET	4</span>
<span class="cp">#define CHARGER_INTR_OFFSET	2</span>
<span class="cp">#define RSV_INTR_OFFSET		0</span>

<span class="cm">/* INT register offsets */</span>
<span class="cp">#define REG_INT_STS_A			0x00</span>
<span class="cp">#define REG_INT_STS_B			0x01</span>
<span class="cp">#define REG_INT_STS_C			0x02</span>

<span class="cp">#define REG_INT_MSK_LINE_A		0x03</span>
<span class="cp">#define REG_INT_MSK_LINE_B		0x04</span>
<span class="cp">#define REG_INT_MSK_LINE_C		0x05</span>

<span class="cp">#define REG_INT_MSK_STS_A		0x06</span>
<span class="cp">#define REG_INT_MSK_STS_B		0x07</span>
<span class="cp">#define REG_INT_MSK_STS_C		0x08</span>

<span class="cm">/* MASK INT REG GROUP A */</span>
<span class="cp">#define TWL6030_PWR_INT_MASK 		0x07</span>
<span class="cp">#define TWL6030_RTC_INT_MASK 		0x18</span>
<span class="cp">#define TWL6030_HOTDIE_INT_MASK 	0x20</span>
<span class="cp">#define TWL6030_SMPSLDOA_INT_MASK	0xC0</span>

<span class="cm">/* MASK INT REG GROUP B */</span>
<span class="cp">#define TWL6030_SMPSLDOB_INT_MASK 	0x01</span>
<span class="cp">#define TWL6030_BATDETECT_INT_MASK 	0x02</span>
<span class="cp">#define TWL6030_SIMDETECT_INT_MASK 	0x04</span>
<span class="cp">#define TWL6030_MMCDETECT_INT_MASK 	0x08</span>
<span class="cp">#define TWL6030_GPADC_INT_MASK 		0x60</span>
<span class="cp">#define TWL6030_GASGAUGE_INT_MASK 	0x80</span>

<span class="cm">/* MASK INT REG GROUP C */</span>
<span class="cp">#define TWL6030_USBOTG_INT_MASK  	0x0F</span>
<span class="cp">#define TWL6030_CHARGER_CTRL_INT_MASK 	0x10</span>
<span class="cp">#define TWL6030_CHARGER_FAULT_INT_MASK 	0x60</span>

<span class="cp">#define TWL6030_MMCCTRL		0xEE</span>
<span class="cp">#define VMMC_AUTO_OFF			(0x1 &lt;&lt; 3)</span>
<span class="cp">#define SW_FC				(0x1 &lt;&lt; 2)</span>
<span class="cp">#define STS_MMC			0x1</span>

<span class="cp">#define TWL6030_CFG_INPUT_PUPD3	0xF2</span>
<span class="cp">#define MMC_PU				(0x1 &lt;&lt; 3)</span>
<span class="cp">#define MMC_PD				(0x1 &lt;&lt; 2)</span>

<span class="cp">#define TWL_SIL_TYPE(rev)		((rev) &amp; 0x00FFFFFF)</span>
<span class="cp">#define TWL_SIL_REV(rev)		((rev) &gt;&gt; 24)</span>
<span class="cp">#define TWL_SIL_5030			0x09002F</span>
<span class="cp">#define TWL5030_REV_1_0			0x00</span>
<span class="cp">#define TWL5030_REV_1_1			0x10</span>
<span class="cp">#define TWL5030_REV_1_2			0x30</span>

<span class="cp">#define TWL4030_CLASS_ID 		0x4030</span>
<span class="cp">#define TWL6030_CLASS_ID 		0x6030</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">twl_rev</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#define GET_TWL_REV (twl_rev())</span>
<span class="cp">#define TWL_CLASS_IS(class, id)			\</span>
<span class="cp">static inline int twl_class_is_ ##class(void)	\</span>
<span class="cp">{						\</span>
<span class="cp">	return ((id) == (GET_TWL_REV)) ? 1 : 0;	\</span>
<span class="cp">}</span>

<span class="n">TWL_CLASS_IS</span><span class="p">(</span><span class="mi">4030</span><span class="p">,</span> <span class="n">TWL4030_CLASS_ID</span><span class="p">)</span>
<span class="n">TWL_CLASS_IS</span><span class="p">(</span><span class="mi">6030</span><span class="p">,</span> <span class="n">TWL6030_CLASS_ID</span><span class="p">)</span>

<span class="cm">/*</span>
<span class="cm"> * Read and write single 8-bit registers</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">twl_i2c_write_u8</span><span class="p">(</span><span class="n">u8</span> <span class="n">mod_no</span><span class="p">,</span> <span class="n">u8</span> <span class="n">val</span><span class="p">,</span> <span class="n">u8</span> <span class="n">reg</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">twl_i2c_read_u8</span><span class="p">(</span><span class="n">u8</span> <span class="n">mod_no</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">val</span><span class="p">,</span> <span class="n">u8</span> <span class="n">reg</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Read and write several 8-bit registers at once.</span>
<span class="cm"> *</span>
<span class="cm"> * IMPORTANT:  For twl_i2c_write(), allocate num_bytes + 1</span>
<span class="cm"> * for the value, and populate your data starting at offset 1.</span>
<span class="cm"> */</span>
<span class="kt">int</span> <span class="n">twl_i2c_write</span><span class="p">(</span><span class="n">u8</span> <span class="n">mod_no</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="n">u8</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">num_bytes</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">twl_i2c_read</span><span class="p">(</span><span class="n">u8</span> <span class="n">mod_no</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="n">u8</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">num_bytes</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">twl_get_type</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">twl_get_version</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">twl6030_interrupt_unmask</span><span class="p">(</span><span class="n">u8</span> <span class="n">bit_mask</span><span class="p">,</span> <span class="n">u8</span> <span class="n">offset</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">twl6030_interrupt_mask</span><span class="p">(</span><span class="n">u8</span> <span class="n">bit_mask</span><span class="p">,</span> <span class="n">u8</span> <span class="n">offset</span><span class="p">);</span>

<span class="cm">/* Card detect Configuration for MMC1 Controller on OMAP4 */</span>
<span class="cp">#ifdef CONFIG_TWL4030_CORE</span>
<span class="kt">int</span> <span class="n">twl6030_mmc_card_detect_config</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">twl6030_mmc_card_detect_config</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">pr_debug</span><span class="p">(</span><span class="s">&quot;twl6030_mmc_card_detect_config not supported</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="cm">/* MMC1 Controller on OMAP4 uses Phoenix irq for Card detect */</span>
<span class="cp">#ifdef CONFIG_TWL4030_CORE</span>
<span class="kt">int</span> <span class="n">twl6030_mmc_card_detect</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">slot</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">twl6030_mmc_card_detect</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">slot</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">pr_debug</span><span class="p">(</span><span class="s">&quot;Call back twl6030_mmc_card_detect not supported</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="o">-</span><span class="n">EIO</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>
<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * NOTE:  at up to 1024 registers, this is a big chip.</span>
<span class="cm"> *</span>
<span class="cm"> * Avoid putting register declarations in this file, instead of into</span>
<span class="cm"> * a driver-private file, unless some of the registers in a block</span>
<span class="cm"> * need to be shared with other drivers.  One example is blocks that</span>
<span class="cm"> * have Secondary IRQ Handler (SIH) registers.</span>
<span class="cm"> */</span>

<span class="cp">#define TWL4030_SIH_CTRL_EXCLEN_MASK	BIT(0)</span>
<span class="cp">#define TWL4030_SIH_CTRL_PENDDIS_MASK	BIT(1)</span>
<span class="cp">#define TWL4030_SIH_CTRL_COR_MASK	BIT(2)</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * GPIO Block Register offsets (use TWL4030_MODULE_GPIO)</span>
<span class="cm"> */</span>

<span class="cp">#define REG_GPIODATAIN1			0x0</span>
<span class="cp">#define REG_GPIODATAIN2			0x1</span>
<span class="cp">#define REG_GPIODATAIN3			0x2</span>
<span class="cp">#define REG_GPIODATADIR1		0x3</span>
<span class="cp">#define REG_GPIODATADIR2		0x4</span>
<span class="cp">#define REG_GPIODATADIR3		0x5</span>
<span class="cp">#define REG_GPIODATAOUT1		0x6</span>
<span class="cp">#define REG_GPIODATAOUT2		0x7</span>
<span class="cp">#define REG_GPIODATAOUT3		0x8</span>
<span class="cp">#define REG_CLEARGPIODATAOUT1		0x9</span>
<span class="cp">#define REG_CLEARGPIODATAOUT2		0xA</span>
<span class="cp">#define REG_CLEARGPIODATAOUT3		0xB</span>
<span class="cp">#define REG_SETGPIODATAOUT1		0xC</span>
<span class="cp">#define REG_SETGPIODATAOUT2		0xD</span>
<span class="cp">#define REG_SETGPIODATAOUT3		0xE</span>
<span class="cp">#define REG_GPIO_DEBEN1			0xF</span>
<span class="cp">#define REG_GPIO_DEBEN2			0x10</span>
<span class="cp">#define REG_GPIO_DEBEN3			0x11</span>
<span class="cp">#define REG_GPIO_CTRL			0x12</span>
<span class="cp">#define REG_GPIOPUPDCTR1		0x13</span>
<span class="cp">#define REG_GPIOPUPDCTR2		0x14</span>
<span class="cp">#define REG_GPIOPUPDCTR3		0x15</span>
<span class="cp">#define REG_GPIOPUPDCTR4		0x16</span>
<span class="cp">#define REG_GPIOPUPDCTR5		0x17</span>
<span class="cp">#define REG_GPIO_ISR1A			0x19</span>
<span class="cp">#define REG_GPIO_ISR2A			0x1A</span>
<span class="cp">#define REG_GPIO_ISR3A			0x1B</span>
<span class="cp">#define REG_GPIO_IMR1A			0x1C</span>
<span class="cp">#define REG_GPIO_IMR2A			0x1D</span>
<span class="cp">#define REG_GPIO_IMR3A			0x1E</span>
<span class="cp">#define REG_GPIO_ISR1B			0x1F</span>
<span class="cp">#define REG_GPIO_ISR2B			0x20</span>
<span class="cp">#define REG_GPIO_ISR3B			0x21</span>
<span class="cp">#define REG_GPIO_IMR1B			0x22</span>
<span class="cp">#define REG_GPIO_IMR2B			0x23</span>
<span class="cp">#define REG_GPIO_IMR3B			0x24</span>
<span class="cp">#define REG_GPIO_EDR1			0x28</span>
<span class="cp">#define REG_GPIO_EDR2			0x29</span>
<span class="cp">#define REG_GPIO_EDR3			0x2A</span>
<span class="cp">#define REG_GPIO_EDR4			0x2B</span>
<span class="cp">#define REG_GPIO_EDR5			0x2C</span>
<span class="cp">#define REG_GPIO_SIH_CTRL		0x2D</span>

<span class="cm">/* Up to 18 signals are available as GPIOs, when their</span>
<span class="cm"> * pins are not assigned to another use (such as ULPI/USB).</span>
<span class="cm"> */</span>
<span class="cp">#define TWL4030_GPIO_MAX		18</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*Interface Bit Register (INTBR) offsets</span>
<span class="cm"> *(Use TWL_4030_MODULE_INTBR)</span>
<span class="cm"> */</span>

<span class="cp">#define REG_IDCODE_7_0			0x00</span>
<span class="cp">#define REG_IDCODE_15_8			0x01</span>
<span class="cp">#define REG_IDCODE_16_23		0x02</span>
<span class="cp">#define REG_IDCODE_31_24		0x03</span>
<span class="cp">#define REG_GPPUPDCTR1			0x0F</span>
<span class="cp">#define REG_UNLOCK_TEST_REG		0x12</span>

<span class="cm">/*I2C1 and I2C4(SR) SDA/SCL pull-up control bits */</span>

<span class="cp">#define I2C_SCL_CTRL_PU			BIT(0)</span>
<span class="cp">#define I2C_SDA_CTRL_PU			BIT(2)</span>
<span class="cp">#define SR_I2C_SCL_CTRL_PU		BIT(4)</span>
<span class="cp">#define SR_I2C_SDA_CTRL_PU		BIT(6)</span>

<span class="cp">#define TWL_EEPROM_R_UNLOCK		0x49</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Keypad register offsets (use TWL4030_MODULE_KEYPAD)</span>
<span class="cm"> * ... SIH/interrupt only</span>
<span class="cm"> */</span>

<span class="cp">#define TWL4030_KEYPAD_KEYP_ISR1	0x11</span>
<span class="cp">#define TWL4030_KEYPAD_KEYP_IMR1	0x12</span>
<span class="cp">#define TWL4030_KEYPAD_KEYP_ISR2	0x13</span>
<span class="cp">#define TWL4030_KEYPAD_KEYP_IMR2	0x14</span>
<span class="cp">#define TWL4030_KEYPAD_KEYP_SIR		0x15	</span><span class="cm">/* test register */</span><span class="cp"></span>
<span class="cp">#define TWL4030_KEYPAD_KEYP_EDR		0x16</span>
<span class="cp">#define TWL4030_KEYPAD_KEYP_SIH_CTRL	0x17</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Multichannel ADC register offsets (use TWL4030_MODULE_MADC)</span>
<span class="cm"> * ... SIH/interrupt only</span>
<span class="cm"> */</span>

<span class="cp">#define TWL4030_MADC_ISR1		0x61</span>
<span class="cp">#define TWL4030_MADC_IMR1		0x62</span>
<span class="cp">#define TWL4030_MADC_ISR2		0x63</span>
<span class="cp">#define TWL4030_MADC_IMR2		0x64</span>
<span class="cp">#define TWL4030_MADC_SIR		0x65	</span><span class="cm">/* test register */</span><span class="cp"></span>
<span class="cp">#define TWL4030_MADC_EDR		0x66</span>
<span class="cp">#define TWL4030_MADC_SIH_CTRL		0x67</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Battery charger register offsets (use TWL4030_MODULE_INTERRUPTS)</span>
<span class="cm"> */</span>

<span class="cp">#define TWL4030_INTERRUPTS_BCIISR1A	0x0</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIISR2A	0x1</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIIMR1A	0x2</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIIMR2A	0x3</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIISR1B	0x4</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIISR2B	0x5</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIIMR1B	0x6</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIIMR2B	0x7</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCISIR1	0x8	</span><span class="cm">/* test register */</span><span class="cp"></span>
<span class="cp">#define TWL4030_INTERRUPTS_BCISIR2	0x9	</span><span class="cm">/* test register */</span><span class="cp"></span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIEDR1	0xa</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIEDR2	0xb</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCIEDR3	0xc</span>
<span class="cp">#define TWL4030_INTERRUPTS_BCISIHCTRL	0xd</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Power Interrupt block register offsets (use TWL4030_MODULE_INT)</span>
<span class="cm"> */</span>

<span class="cp">#define TWL4030_INT_PWR_ISR1		0x0</span>
<span class="cp">#define TWL4030_INT_PWR_IMR1		0x1</span>
<span class="cp">#define TWL4030_INT_PWR_ISR2		0x2</span>
<span class="cp">#define TWL4030_INT_PWR_IMR2		0x3</span>
<span class="cp">#define TWL4030_INT_PWR_SIR		0x4	</span><span class="cm">/* test register */</span><span class="cp"></span>
<span class="cp">#define TWL4030_INT_PWR_EDR1		0x5</span>
<span class="cp">#define TWL4030_INT_PWR_EDR2		0x6</span>
<span class="cp">#define TWL4030_INT_PWR_SIH_CTRL	0x7</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Accessory Interrupts</span>
<span class="cm"> */</span>
<span class="cp">#define TWL5031_ACIIMR_LSB		0x05</span>
<span class="cp">#define TWL5031_ACIIMR_MSB		0x06</span>
<span class="cp">#define TWL5031_ACIIDR_LSB		0x07</span>
<span class="cp">#define TWL5031_ACIIDR_MSB		0x08</span>
<span class="cp">#define TWL5031_ACCISR1			0x0F</span>
<span class="cp">#define TWL5031_ACCIMR1			0x10</span>
<span class="cp">#define TWL5031_ACCISR2			0x11</span>
<span class="cp">#define TWL5031_ACCIMR2			0x12</span>
<span class="cp">#define TWL5031_ACCSIR			0x13</span>
<span class="cp">#define TWL5031_ACCEDR1			0x14</span>
<span class="cp">#define TWL5031_ACCSIHCTRL		0x15</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * Battery Charger Controller</span>
<span class="cm"> */</span>

<span class="cp">#define TWL5031_INTERRUPTS_BCIISR1	0x0</span>
<span class="cp">#define TWL5031_INTERRUPTS_BCIIMR1	0x1</span>
<span class="cp">#define TWL5031_INTERRUPTS_BCIISR2	0x2</span>
<span class="cp">#define TWL5031_INTERRUPTS_BCIIMR2	0x3</span>
<span class="cp">#define TWL5031_INTERRUPTS_BCISIR	0x4</span>
<span class="cp">#define TWL5031_INTERRUPTS_BCIEDR1	0x5</span>
<span class="cp">#define TWL5031_INTERRUPTS_BCIEDR2	0x6</span>
<span class="cp">#define TWL5031_INTERRUPTS_BCISIHCTRL	0x7</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/*</span>
<span class="cm"> * PM Master module register offsets (use TWL4030_MODULE_PM_MASTER)</span>
<span class="cm"> */</span>

<span class="cp">#define TWL4030_PM_MASTER_CFG_P1_TRANSITION	0x00</span>
<span class="cp">#define TWL4030_PM_MASTER_CFG_P2_TRANSITION	0x01</span>
<span class="cp">#define TWL4030_PM_MASTER_CFG_P3_TRANSITION	0x02</span>
<span class="cp">#define TWL4030_PM_MASTER_CFG_P123_TRANSITION	0x03</span>
<span class="cp">#define TWL4030_PM_MASTER_STS_BOOT		0x04</span>
<span class="cp">#define TWL4030_PM_MASTER_CFG_BOOT		0x05</span>
<span class="cp">#define TWL4030_PM_MASTER_SHUNDAN		0x06</span>
<span class="cp">#define TWL4030_PM_MASTER_BOOT_BCI		0x07</span>
<span class="cp">#define TWL4030_PM_MASTER_CFG_PWRANA1		0x08</span>
<span class="cp">#define TWL4030_PM_MASTER_CFG_PWRANA2		0x09</span>
<span class="cp">#define TWL4030_PM_MASTER_BACKUP_MISC_STS	0x0b</span>
<span class="cp">#define TWL4030_PM_MASTER_BACKUP_MISC_CFG	0x0c</span>
<span class="cp">#define TWL4030_PM_MASTER_BACKUP_MISC_TST	0x0d</span>
<span class="cp">#define TWL4030_PM_MASTER_PROTECT_KEY		0x0e</span>
<span class="cp">#define TWL4030_PM_MASTER_STS_HW_CONDITIONS	0x0f</span>
<span class="cp">#define TWL4030_PM_MASTER_P1_SW_EVENTS		0x10</span>
<span class="cp">#define TWL4030_PM_MASTER_P2_SW_EVENTS		0x11</span>
<span class="cp">#define TWL4030_PM_MASTER_P3_SW_EVENTS		0x12</span>
<span class="cp">#define TWL4030_PM_MASTER_STS_P123_STATE	0x13</span>
<span class="cp">#define TWL4030_PM_MASTER_PB_CFG		0x14</span>
<span class="cp">#define TWL4030_PM_MASTER_PB_WORD_MSB		0x15</span>
<span class="cp">#define TWL4030_PM_MASTER_PB_WORD_LSB		0x16</span>
<span class="cp">#define TWL4030_PM_MASTER_SEQ_ADD_W2P		0x1c</span>
<span class="cp">#define TWL4030_PM_MASTER_SEQ_ADD_P2A		0x1d</span>
<span class="cp">#define TWL4030_PM_MASTER_SEQ_ADD_A2W		0x1e</span>
<span class="cp">#define TWL4030_PM_MASTER_SEQ_ADD_A2S		0x1f</span>
<span class="cp">#define TWL4030_PM_MASTER_SEQ_ADD_S2A12		0x20</span>
<span class="cp">#define TWL4030_PM_MASTER_SEQ_ADD_S2A3		0x21</span>
<span class="cp">#define TWL4030_PM_MASTER_SEQ_ADD_WARM		0x22</span>
<span class="cp">#define TWL4030_PM_MASTER_MEMORY_ADDRESS	0x23</span>
<span class="cp">#define TWL4030_PM_MASTER_MEMORY_DATA		0x24</span>

<span class="cp">#define TWL4030_PM_MASTER_KEY_CFG1		0xc0</span>
<span class="cp">#define TWL4030_PM_MASTER_KEY_CFG2		0x0c</span>

<span class="cp">#define TWL4030_PM_MASTER_KEY_TST1		0xe0</span>
<span class="cp">#define TWL4030_PM_MASTER_KEY_TST2		0x0e</span>

<span class="cp">#define TWL4030_PM_MASTER_GLOBAL_TST		0xb6</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/* Power bus message definitions */</span>

<span class="cm">/* The TWL4030/5030 splits its power-management resources (the various</span>
<span class="cm"> * regulators, clock and reset lines) into 3 processor groups - P1, P2 and</span>
<span class="cm"> * P3. These groups can then be configured to transition between sleep, wait-on</span>
<span class="cm"> * and active states by sending messages to the power bus.  See Section 5.4.2</span>
<span class="cm"> * Power Resources of TWL4030 TRM</span>
<span class="cm"> */</span>

<span class="cm">/* Processor groups */</span>
<span class="cp">#define DEV_GRP_NULL		0x0</span>
<span class="cp">#define DEV_GRP_P1		0x1	</span><span class="cm">/* P1: all OMAP devices */</span><span class="cp"></span>
<span class="cp">#define DEV_GRP_P2		0x2	</span><span class="cm">/* P2: all Modem devices */</span><span class="cp"></span>
<span class="cp">#define DEV_GRP_P3		0x4	</span><span class="cm">/* P3: all peripheral devices */</span><span class="cp"></span>

<span class="cm">/* Resource groups */</span>
<span class="cp">#define RES_GRP_RES		0x0	</span><span class="cm">/* Reserved */</span><span class="cp"></span>
<span class="cp">#define RES_GRP_PP		0x1	</span><span class="cm">/* Power providers */</span><span class="cp"></span>
<span class="cp">#define RES_GRP_RC		0x2	</span><span class="cm">/* Reset and control */</span><span class="cp"></span>
<span class="cp">#define RES_GRP_PP_RC		0x3</span>
<span class="cp">#define RES_GRP_PR		0x4	</span><span class="cm">/* Power references */</span><span class="cp"></span>
<span class="cp">#define RES_GRP_PP_PR		0x5</span>
<span class="cp">#define RES_GRP_RC_PR		0x6</span>
<span class="cp">#define RES_GRP_ALL		0x7	</span><span class="cm">/* All resource groups */</span><span class="cp"></span>

<span class="cp">#define RES_TYPE2_R0		0x0</span>

<span class="cp">#define RES_TYPE_ALL		0x7</span>

<span class="cm">/* Resource states */</span>
<span class="cp">#define RES_STATE_WRST		0xF</span>
<span class="cp">#define RES_STATE_ACTIVE	0xE</span>
<span class="cp">#define RES_STATE_SLEEP		0x8</span>
<span class="cp">#define RES_STATE_OFF		0x0</span>

<span class="cm">/* Power resources */</span>

<span class="cm">/* Power providers */</span>
<span class="cp">#define RES_VAUX1               1</span>
<span class="cp">#define RES_VAUX2               2</span>
<span class="cp">#define RES_VAUX3               3</span>
<span class="cp">#define RES_VAUX4               4</span>
<span class="cp">#define RES_VMMC1               5</span>
<span class="cp">#define RES_VMMC2               6</span>
<span class="cp">#define RES_VPLL1               7</span>
<span class="cp">#define RES_VPLL2               8</span>
<span class="cp">#define RES_VSIM                9</span>
<span class="cp">#define RES_VDAC                10</span>
<span class="cp">#define RES_VINTANA1            11</span>
<span class="cp">#define RES_VINTANA2            12</span>
<span class="cp">#define RES_VINTDIG             13</span>
<span class="cp">#define RES_VIO                 14</span>
<span class="cp">#define RES_VDD1                15</span>
<span class="cp">#define RES_VDD2                16</span>
<span class="cp">#define RES_VUSB_1V5            17</span>
<span class="cp">#define RES_VUSB_1V8            18</span>
<span class="cp">#define RES_VUSB_3V1            19</span>
<span class="cp">#define RES_VUSBCP              20</span>
<span class="cp">#define RES_REGEN               21</span>
<span class="cm">/* Reset and control */</span>
<span class="cp">#define RES_NRES_PWRON          22</span>
<span class="cp">#define RES_CLKEN               23</span>
<span class="cp">#define RES_SYSEN               24</span>
<span class="cp">#define RES_HFCLKOUT            25</span>
<span class="cp">#define RES_32KCLKOUT           26</span>
<span class="cp">#define RES_RESET               27</span>
<span class="cm">/* Power Reference */</span>
<span class="cp">#define RES_MAIN_REF            28</span>

<span class="cp">#define TOTAL_RESOURCES		28</span>
<span class="cm">/*</span>
<span class="cm"> * Power Bus Message Format ... these can be sent individually by Linux,</span>
<span class="cm"> * but are usually part of downloaded scripts that are run when various</span>
<span class="cm"> * power events are triggered.</span>
<span class="cm"> *</span>
<span class="cm"> *  Broadcast Message (16 Bits):</span>
<span class="cm"> *    DEV_GRP[15:13] MT[12]  RES_GRP[11:9]  RES_TYPE2[8:7] RES_TYPE[6:4]</span>
<span class="cm"> *    RES_STATE[3:0]</span>
<span class="cm"> *</span>
<span class="cm"> *  Singular Message (16 Bits):</span>
<span class="cm"> *    DEV_GRP[15:13] MT[12]  RES_ID[11:4]  RES_STATE[3:0]</span>
<span class="cm"> */</span>

<span class="cp">#define MSG_BROADCAST(devgrp, grp, type, type2, state) \</span>
<span class="cp">	( (devgrp) &lt;&lt; 13 | 1 &lt;&lt; 12 | (grp) &lt;&lt; 9 | (type2) &lt;&lt; 7 \</span>
<span class="cp">	| (type) &lt;&lt; 4 | (state))</span>

<span class="cp">#define MSG_SINGULAR(devgrp, id, state) \</span>
<span class="cp">	((devgrp) &lt;&lt; 13 | 0 &lt;&lt; 12 | (id) &lt;&lt; 4 | (state))</span>

<span class="cp">#define MSG_BROADCAST_ALL(devgrp, state) \</span>
<span class="cp">	((devgrp) &lt;&lt; 5 | (state))</span>

<span class="cp">#define MSG_BROADCAST_REF MSG_BROADCAST_ALL</span>
<span class="cp">#define MSG_BROADCAST_PROV MSG_BROADCAST_ALL</span>
<span class="cp">#define MSG_BROADCAST__CLK_RST MSG_BROADCAST_ALL</span>
<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="k">struct</span> <span class="n">twl4030_clock_init_data</span> <span class="p">{</span>
	<span class="n">bool</span> <span class="n">ck32k_lowpwr_enable</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_bci_platform_data</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="o">*</span><span class="n">battery_tmp_tbl</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tblsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* TWL4030_GPIO_MAX (18) GPIOs, with interrupts */</span>
<span class="k">struct</span> <span class="n">twl4030_gpio_platform_data</span> <span class="p">{</span>
	<span class="kt">int</span>		<span class="n">gpio_base</span><span class="p">;</span>
	<span class="kt">unsigned</span>	<span class="n">irq_base</span><span class="p">,</span> <span class="n">irq_end</span><span class="p">;</span>

	<span class="cm">/* package the two LED signals as output-only GPIOs? */</span>
	<span class="n">bool</span>		<span class="n">use_leds</span><span class="p">;</span>

	<span class="cm">/* gpio-n should control VMMC(n+1) if BIT(n) in mmc_cd is set */</span>
	<span class="n">u8</span>		<span class="n">mmc_cd</span><span class="p">;</span>

	<span class="cm">/* if BIT(N) is set, or VMMC(n+1) is linked, debounce GPIO-N */</span>
	<span class="n">u32</span>		<span class="n">debounce</span><span class="p">;</span>

	<span class="cm">/* For gpio-N, bit (1 &lt;&lt; N) in &quot;pullups&quot; is set if that pullup</span>
<span class="cm">	 * should be enabled.  Else, if that bit is set in &quot;pulldowns&quot;,</span>
<span class="cm">	 * that pulldown is enabled.  Don&#39;t waste power by letting any</span>
<span class="cm">	 * digital inputs float...</span>
<span class="cm">	 */</span>
	<span class="n">u32</span>		<span class="n">pullups</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">pulldowns</span><span class="p">;</span>

	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">setup</span><span class="p">)(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				<span class="kt">unsigned</span> <span class="n">gpio</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">ngpio</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">teardown</span><span class="p">)(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				<span class="kt">unsigned</span> <span class="n">gpio</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="n">ngpio</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_madc_platform_data</span> <span class="p">{</span>
	<span class="kt">int</span>		<span class="n">irq_line</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Boards have unique mappings of {row, col} --&gt; keycode.</span>
<span class="cm"> * Column and row are 8 bits each, but range only from 0..7.</span>
<span class="cm"> * a PERSISTENT_KEY is &quot;always on&quot; and never reported.</span>
<span class="cm"> */</span>
<span class="cp">#define PERSISTENT_KEY(r, c)	KEY((r), (c), KEY_RESERVED)</span>

<span class="k">struct</span> <span class="n">twl4030_keypad_data</span> <span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">matrix_keymap_data</span> <span class="o">*</span><span class="n">keymap_data</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">rows</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">cols</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">rep</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">twl4030_usb_mode</span> <span class="p">{</span>
	<span class="n">T2_USB_MODE_ULPI</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">T2_USB_MODE_CEA2011_3PIN</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_usb_data</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">twl4030_usb_mode</span>	<span class="n">usb_mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>		<span class="n">features</span><span class="p">;</span>

	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">phy_init</span><span class="p">)(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">phy_exit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="cm">/* Power on/off the PHY */</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">phy_power</span><span class="p">)(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">iD</span><span class="p">,</span> <span class="kt">int</span> <span class="n">on</span><span class="p">);</span>
	<span class="cm">/* enable/disable  phy clocks */</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">phy_set_clock</span><span class="p">)(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">on</span><span class="p">);</span>
	<span class="cm">/* suspend/resume of phy */</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">phy_suspend</span><span class="p">)(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">suspend</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_ins</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">pmb_message</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">delay</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_script</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">twl4030_ins</span> <span class="o">*</span><span class="n">script</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">size</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
<span class="cp">#define TWL4030_WRST_SCRIPT	(1&lt;&lt;0)</span>
<span class="cp">#define TWL4030_WAKEUP12_SCRIPT	(1&lt;&lt;1)</span>
<span class="cp">#define TWL4030_WAKEUP3_SCRIPT	(1&lt;&lt;2)</span>
<span class="cp">#define TWL4030_SLEEP_SCRIPT	(1&lt;&lt;3)</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_resconfig</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">resource</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">devgroup</span><span class="p">;</span>	<span class="cm">/* Processor group that Power resource belongs to */</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span>	<span class="cm">/* Power resource addressed, 6 / broadcast message */</span>
	<span class="n">u8</span> <span class="n">type2</span><span class="p">;</span>	<span class="cm">/* Power resource addressed, 3 / broadcast message */</span>
	<span class="n">u8</span> <span class="n">remap_off</span><span class="p">;</span>	<span class="cm">/* off state remapping */</span>
	<span class="n">u8</span> <span class="n">remap_sleep</span><span class="p">;</span>	<span class="cm">/* sleep state remapping */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_power_data</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">twl4030_script</span> <span class="o">**</span><span class="n">scripts</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">num</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_resconfig</span> <span class="o">*</span><span class="n">resource_config</span><span class="p">;</span>
<span class="cp">#define TWL4030_RESCONFIG_UNDEF	((u8)-1)</span>
	<span class="n">bool</span> <span class="n">use_poweroff</span><span class="p">;</span>	<span class="cm">/* Board is wired for TWL poweroff */</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">twl4030_power_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">twl4030_power_data</span> <span class="o">*</span><span class="n">triton2_scripts</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">twl4030_remove_script</span><span class="p">(</span><span class="n">u8</span> <span class="n">flags</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">twl4030_power_off</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">twl4030_codec_data</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">digimic_delay</span><span class="p">;</span> <span class="cm">/* in ms */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ramp_delay_value</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">offset_cncl_path</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">check_defaults</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reset_registers</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hs_extmute</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_hs_extmute</span><span class="p">)(</span><span class="kt">int</span> <span class="n">mute</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_vibra_data</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">coexist</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_audio_data</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">audio_mclk</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_codec_data</span> <span class="o">*</span><span class="n">codec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_vibra_data</span> <span class="o">*</span><span class="n">vibra</span><span class="p">;</span>

	<span class="cm">/* twl6040 */</span>
	<span class="kt">int</span> <span class="n">audpwron_gpio</span><span class="p">;</span>	<span class="cm">/* audio power-on gpio */</span>
	<span class="kt">int</span> <span class="n">naudint_irq</span><span class="p">;</span>	<span class="cm">/* audio interrupt */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">irq_base</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl4030_platform_data</span> <span class="p">{</span>
	<span class="kt">unsigned</span>				<span class="n">irq_base</span><span class="p">,</span> <span class="n">irq_end</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_clock_init_data</span>		<span class="o">*</span><span class="n">clock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_bci_platform_data</span>	<span class="o">*</span><span class="n">bci</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_gpio_platform_data</span>	<span class="o">*</span><span class="n">gpio</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_madc_platform_data</span>	<span class="o">*</span><span class="n">madc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_keypad_data</span>		<span class="o">*</span><span class="n">keypad</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_usb_data</span>			<span class="o">*</span><span class="n">usb</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_power_data</span>		<span class="o">*</span><span class="n">power</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">twl4030_audio_data</span>		<span class="o">*</span><span class="n">audio</span><span class="p">;</span>

	<span class="cm">/* Common LDO regulators for TWL4030/TWL6030 */</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vdac</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vaux1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vaux2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vaux3</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vdd1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vdd2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vdd3</span><span class="p">;</span>
	<span class="cm">/* TWL4030 LDO regulators */</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vpll1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vpll2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vmmc1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vmmc2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vsim</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vaux4</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vio</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vintana1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vintana2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vintdig</span><span class="p">;</span>
	<span class="cm">/* TWL6030 LDO regulators */</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">vmmc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">vpp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">vusim</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">vana</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">vcxio</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">vusb</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">clk32kg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">v1v8</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>              <span class="o">*</span><span class="n">v2v1</span><span class="p">;</span>
	<span class="cm">/* TWL6025 LDO regulators */</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldo1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldo2</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldo3</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldo4</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldo5</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldo6</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldo7</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldoln</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">ldousb</span><span class="p">;</span>
	<span class="cm">/* TWL6025 DCDC regulators */</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">smps3</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">smps4</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">regulator_init_data</span>		<span class="o">*</span><span class="n">vio6025</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">twl_regulator_driver_data</span> <span class="p">{</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">set_voltage</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">target_uV</span><span class="p">);</span>
	<span class="kt">int</span>		<span class="p">(</span><span class="o">*</span><span class="n">get_voltage</span><span class="p">)(</span><span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>
	<span class="kt">void</span>		<span class="o">*</span><span class="n">data</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>	<span class="n">features</span><span class="p">;</span>
<span class="p">};</span>
<span class="cm">/* chip-specific feature flags, for twl_regulator_driver_data.features */</span>
<span class="cp">#define TWL4030_VAUX2		BIT(0)	</span><span class="cm">/* pre-5030 voltage ranges */</span><span class="cp"></span>
<span class="cp">#define TPS_SUBSET		BIT(1)	</span><span class="cm">/* tps659[23]0 have fewer LDOs */</span><span class="cp"></span>
<span class="cp">#define TWL5031			BIT(2)  </span><span class="cm">/* twl5031 has different registers */</span><span class="cp"></span>
<span class="cp">#define TWL6030_CLASS		BIT(3)	</span><span class="cm">/* TWL6030 class */</span><span class="cp"></span>
<span class="cp">#define TWL6025_SUBCLASS	BIT(4)  </span><span class="cm">/* TWL6025 has changed registers */</span><span class="cp"></span>
<span class="cp">#define TWL4030_ALLOW_UNSUPPORTED BIT(5) </span><span class="cm">/* Some voltages are possible</span>
<span class="cm">					  * but not officially supported.</span>
<span class="cm">					  * This flag is necessary to</span>
<span class="cm">					  * enable them.</span>
<span class="cm">					  */</span><span class="cp"></span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="kt">int</span> <span class="n">twl4030_sih_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">module</span><span class="p">,</span> <span class="kt">int</span> <span class="n">irq_base</span><span class="p">);</span>

<span class="cm">/* Offsets to Power Registers */</span>
<span class="cp">#define TWL4030_VDAC_DEV_GRP		0x3B</span>
<span class="cp">#define TWL4030_VDAC_DEDICATED		0x3E</span>
<span class="cp">#define TWL4030_VAUX1_DEV_GRP		0x17</span>
<span class="cp">#define TWL4030_VAUX1_DEDICATED		0x1A</span>
<span class="cp">#define TWL4030_VAUX2_DEV_GRP		0x1B</span>
<span class="cp">#define TWL4030_VAUX2_DEDICATED		0x1E</span>
<span class="cp">#define TWL4030_VAUX3_DEV_GRP		0x1F</span>
<span class="cp">#define TWL4030_VAUX3_DEDICATED		0x22</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">twl4030charger_usb_en</span><span class="p">(</span><span class="kt">int</span> <span class="n">enable</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>

<span class="cm">/*----------------------------------------------------------------------*/</span>

<span class="cm">/* Linux-specific regulator identifiers ... for now, we only support</span>
<span class="cm"> * the LDOs, and leave the three buck converters alone.  VDD1 and VDD2</span>
<span class="cm"> * need to tie into hardware based voltage scaling (cpufreq etc), while</span>
<span class="cm"> * VIO is generally fixed.</span>
<span class="cm"> */</span>

<span class="cm">/* TWL4030 SMPS/LDO&#39;s */</span>
<span class="cm">/* EXTERNAL dc-to-dc buck converters */</span>
<span class="cp">#define TWL4030_REG_VDD1	0</span>
<span class="cp">#define TWL4030_REG_VDD2	1</span>
<span class="cp">#define TWL4030_REG_VIO		2</span>

<span class="cm">/* EXTERNAL LDOs */</span>
<span class="cp">#define TWL4030_REG_VDAC	3</span>
<span class="cp">#define TWL4030_REG_VPLL1	4</span>
<span class="cp">#define TWL4030_REG_VPLL2	5	</span><span class="cm">/* not on all chips */</span><span class="cp"></span>
<span class="cp">#define TWL4030_REG_VMMC1	6</span>
<span class="cp">#define TWL4030_REG_VMMC2	7	</span><span class="cm">/* not on all chips */</span><span class="cp"></span>
<span class="cp">#define TWL4030_REG_VSIM	8	</span><span class="cm">/* not on all chips */</span><span class="cp"></span>
<span class="cp">#define TWL4030_REG_VAUX1	9	</span><span class="cm">/* not on all chips */</span><span class="cp"></span>
<span class="cp">#define TWL4030_REG_VAUX2_4030	10	</span><span class="cm">/* (twl4030-specific) */</span><span class="cp"></span>
<span class="cp">#define TWL4030_REG_VAUX2	11	</span><span class="cm">/* (twl5030 and newer) */</span><span class="cp"></span>
<span class="cp">#define TWL4030_REG_VAUX3	12	</span><span class="cm">/* not on all chips */</span><span class="cp"></span>
<span class="cp">#define TWL4030_REG_VAUX4	13	</span><span class="cm">/* not on all chips */</span><span class="cp"></span>

<span class="cm">/* INTERNAL LDOs */</span>
<span class="cp">#define TWL4030_REG_VINTANA1	14</span>
<span class="cp">#define TWL4030_REG_VINTANA2	15</span>
<span class="cp">#define TWL4030_REG_VINTDIG	16</span>
<span class="cp">#define TWL4030_REG_VUSB1V5	17</span>
<span class="cp">#define TWL4030_REG_VUSB1V8	18</span>
<span class="cp">#define TWL4030_REG_VUSB3V1	19</span>

<span class="cm">/* TWL6030 SMPS/LDO&#39;s */</span>
<span class="cm">/* EXTERNAL dc-to-dc buck convertor controllable via SR */</span>
<span class="cp">#define TWL6030_REG_VDD1	30</span>
<span class="cp">#define TWL6030_REG_VDD2	31</span>
<span class="cp">#define TWL6030_REG_VDD3	32</span>

<span class="cm">/* Non SR compliant dc-to-dc buck convertors */</span>
<span class="cp">#define TWL6030_REG_VMEM	33</span>
<span class="cp">#define TWL6030_REG_V2V1	34</span>
<span class="cp">#define TWL6030_REG_V1V29	35</span>
<span class="cp">#define TWL6030_REG_V1V8	36</span>

<span class="cm">/* EXTERNAL LDOs */</span>
<span class="cp">#define TWL6030_REG_VAUX1_6030	37</span>
<span class="cp">#define TWL6030_REG_VAUX2_6030	38</span>
<span class="cp">#define TWL6030_REG_VAUX3_6030	39</span>
<span class="cp">#define TWL6030_REG_VMMC	40</span>
<span class="cp">#define TWL6030_REG_VPP		41</span>
<span class="cp">#define TWL6030_REG_VUSIM	42</span>
<span class="cp">#define TWL6030_REG_VANA	43</span>
<span class="cp">#define TWL6030_REG_VCXIO	44</span>
<span class="cp">#define TWL6030_REG_VDAC	45</span>
<span class="cp">#define TWL6030_REG_VUSB	46</span>

<span class="cm">/* INTERNAL LDOs */</span>
<span class="cp">#define TWL6030_REG_VRTC	47</span>
<span class="cp">#define TWL6030_REG_CLK32KG	48</span>

<span class="cm">/* LDOs on 6025 have different names */</span>
<span class="cp">#define TWL6025_REG_LDO2	49</span>
<span class="cp">#define TWL6025_REG_LDO4	50</span>
<span class="cp">#define TWL6025_REG_LDO3	51</span>
<span class="cp">#define TWL6025_REG_LDO5	52</span>
<span class="cp">#define TWL6025_REG_LDO1	53</span>
<span class="cp">#define TWL6025_REG_LDO7	54</span>
<span class="cp">#define TWL6025_REG_LDO6	55</span>
<span class="cp">#define TWL6025_REG_LDOLN	56</span>
<span class="cp">#define TWL6025_REG_LDOUSB	57</span>

<span class="cm">/* 6025 DCDC supplies */</span>
<span class="cp">#define TWL6025_REG_SMPS3	58</span>
<span class="cp">#define TWL6025_REG_SMPS4	59</span>
<span class="cp">#define TWL6025_REG_VIO		60</span>


<span class="cp">#endif </span><span class="cm">/* End of __TWL4030_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
