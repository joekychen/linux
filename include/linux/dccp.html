<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › dccp.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>dccp.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _LINUX_DCCP_H</span>
<span class="cp">#define _LINUX_DCCP_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;asm/byteorder.h&gt;</span>

<span class="cm">/**</span>
<span class="cm"> * struct dccp_hdr - generic part of DCCP packet header</span>
<span class="cm"> *</span>
<span class="cm"> * @dccph_sport - Relevant port on the endpoint that sent this packet</span>
<span class="cm"> * @dccph_dport - Relevant port on the other endpoint</span>
<span class="cm"> * @dccph_doff - Data Offset from the start of the DCCP header, in 32-bit words</span>
<span class="cm"> * @dccph_ccval - Used by the HC-Sender CCID</span>
<span class="cm"> * @dccph_cscov - Parts of the packet that are covered by the Checksum field</span>
<span class="cm"> * @dccph_checksum - Internet checksum, depends on dccph_cscov</span>
<span class="cm"> * @dccph_x - 0 = 24 bit sequence number, 1 = 48</span>
<span class="cm"> * @dccph_type - packet type, see DCCP_PKT_ prefixed macros</span>
<span class="cm"> * @dccph_seq - sequence number high or low order 24 bits, depends on dccph_x</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="p">{</span>
	<span class="n">__be16</span>	<span class="n">dccph_sport</span><span class="p">,</span>
		<span class="n">dccph_dport</span><span class="p">;</span>
	<span class="n">__u8</span>	<span class="n">dccph_doff</span><span class="p">;</span>
<span class="cp">#if defined(__LITTLE_ENDIAN_BITFIELD)</span>
	<span class="n">__u8</span>	<span class="n">dccph_cscov</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span>
		<span class="nl">dccph_ccval:</span><span class="mi">4</span><span class="p">;</span>
<span class="cp">#elif defined(__BIG_ENDIAN_BITFIELD)</span>
	<span class="n">__u8</span>	<span class="n">dccph_ccval</span><span class="o">:</span><span class="mi">4</span><span class="p">,</span>
		<span class="nl">dccph_cscov:</span><span class="mi">4</span><span class="p">;</span>
<span class="cp">#else</span>
<span class="cp">#error  &quot;Adjust your &lt;asm/byteorder.h&gt; defines&quot;</span>
<span class="cp">#endif</span>
	<span class="n">__sum16</span>	<span class="n">dccph_checksum</span><span class="p">;</span>
<span class="cp">#if defined(__LITTLE_ENDIAN_BITFIELD)</span>
	<span class="n">__u8</span>	<span class="n">dccph_x</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>
		<span class="nl">dccph_type:</span><span class="mi">4</span><span class="p">,</span>
		<span class="nl">dccph_reserved:</span><span class="mi">3</span><span class="p">;</span>
<span class="cp">#elif defined(__BIG_ENDIAN_BITFIELD)</span>
	<span class="n">__u8</span>	<span class="n">dccph_reserved</span><span class="o">:</span><span class="mi">3</span><span class="p">,</span>
		<span class="nl">dccph_type:</span><span class="mi">4</span><span class="p">,</span>
		<span class="nl">dccph_x:</span><span class="mi">1</span><span class="p">;</span>
<span class="cp">#else</span>
<span class="cp">#error  &quot;Adjust your &lt;asm/byteorder.h&gt; defines&quot;</span>
<span class="cp">#endif</span>
	<span class="n">__u8</span>	<span class="n">dccph_seq2</span><span class="p">;</span>
	<span class="n">__be16</span>	<span class="n">dccph_seq</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct dccp_hdr_ext - the low bits of a 48 bit seq packet</span>
<span class="cm"> *</span>
<span class="cm"> * @dccph_seq_low - low 24 bits of a 48 bit seq packet</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_hdr_ext</span> <span class="p">{</span>
	<span class="n">__be32</span>	<span class="n">dccph_seq_low</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct dccp_hdr_request - Connection initiation request header</span>
<span class="cm"> *</span>
<span class="cm"> * @dccph_req_service - Service to which the client app wants to connect</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_hdr_request</span> <span class="p">{</span>
	<span class="n">__be32</span>	<span class="n">dccph_req_service</span><span class="p">;</span>
<span class="p">};</span>
<span class="cm">/**</span>
<span class="cm"> * struct dccp_hdr_ack_bits - acknowledgment bits common to most packets</span>
<span class="cm"> *</span>
<span class="cm"> * @dccph_resp_ack_nr_high - 48 bit ack number high order bits, contains GSR</span>
<span class="cm"> * @dccph_resp_ack_nr_low - 48 bit ack number low order bits, contains GSR</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_hdr_ack_bits</span> <span class="p">{</span>
	<span class="n">__be16</span>	<span class="n">dccph_reserved1</span><span class="p">;</span>
	<span class="n">__be16</span>	<span class="n">dccph_ack_nr_high</span><span class="p">;</span>
	<span class="n">__be32</span>	<span class="n">dccph_ack_nr_low</span><span class="p">;</span>
<span class="p">};</span>
<span class="cm">/**</span>
<span class="cm"> * struct dccp_hdr_response - Connection initiation response header</span>
<span class="cm"> *</span>
<span class="cm"> * @dccph_resp_ack - 48 bit Acknowledgment Number Subheader (5.3)</span>
<span class="cm"> * @dccph_resp_service - Echoes the Service Code on a received DCCP-Request</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_hdr_response</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">dccp_hdr_ack_bits</span>	<span class="n">dccph_resp_ack</span><span class="p">;</span>
	<span class="n">__be32</span>				<span class="n">dccph_resp_service</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct dccp_hdr_reset - Unconditionally shut down a connection</span>
<span class="cm"> *</span>
<span class="cm"> * @dccph_reset_ack - 48 bit Acknowledgment Number Subheader (5.6)</span>
<span class="cm"> * @dccph_reset_code - one of %dccp_reset_codes</span>
<span class="cm"> * @dccph_reset_data - the Data 1 ... Data 3 fields from 5.6</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_hdr_reset</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">dccp_hdr_ack_bits</span>	<span class="n">dccph_reset_ack</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccph_reset_code</span><span class="p">,</span>
					<span class="n">dccph_reset_data</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">dccp_pkt_type</span> <span class="p">{</span>
	<span class="n">DCCP_PKT_REQUEST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">DCCP_PKT_RESPONSE</span><span class="p">,</span>
	<span class="n">DCCP_PKT_DATA</span><span class="p">,</span>
	<span class="n">DCCP_PKT_ACK</span><span class="p">,</span>
	<span class="n">DCCP_PKT_DATAACK</span><span class="p">,</span>
	<span class="n">DCCP_PKT_CLOSEREQ</span><span class="p">,</span>
	<span class="n">DCCP_PKT_CLOSE</span><span class="p">,</span>
	<span class="n">DCCP_PKT_RESET</span><span class="p">,</span>
	<span class="n">DCCP_PKT_SYNC</span><span class="p">,</span>
	<span class="n">DCCP_PKT_SYNCACK</span><span class="p">,</span>
	<span class="n">DCCP_PKT_INVALID</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define DCCP_NR_PKT_TYPES DCCP_PKT_INVALID</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">dccp_packet_hdr_len</span><span class="p">(</span><span class="k">const</span> <span class="n">__u8</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_DATA</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_DATAACK</span>	<span class="o">||</span>
	    <span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_ACK</span>	<span class="o">||</span>
	    <span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_SYNC</span>	<span class="o">||</span>
	    <span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_SYNCACK</span>	<span class="o">||</span>
	    <span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_CLOSE</span>	<span class="o">||</span>
	    <span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_CLOSEREQ</span><span class="p">)</span>
		<span class="k">return</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_ack_bits</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_REQUEST</span><span class="p">)</span>
		<span class="k">return</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_request</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">DCCP_PKT_RESPONSE</span><span class="p">)</span>
		<span class="k">return</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_response</span><span class="p">);</span>
	<span class="k">return</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_reset</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">enum</span> <span class="n">dccp_reset_codes</span> <span class="p">{</span>
	<span class="n">DCCP_RESET_CODE_UNSPECIFIED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_CLOSED</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_ABORTED</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_NO_CONNECTION</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_PACKET_ERROR</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_OPTION_ERROR</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_MANDATORY_ERROR</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_CONNECTION_REFUSED</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_BAD_SERVICE_CODE</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_TOO_BUSY</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_BAD_INIT_COOKIE</span><span class="p">,</span>
	<span class="n">DCCP_RESET_CODE_AGGRESSION_PENALTY</span><span class="p">,</span>

	<span class="n">DCCP_MAX_RESET_CODES</span>		<span class="cm">/* Leave at the end!  */</span>
<span class="p">};</span>

<span class="cm">/* DCCP options */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">DCCPO_PADDING</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">DCCPO_MANDATORY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">DCCPO_MIN_RESERVED</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">DCCPO_MAX_RESERVED</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
	<span class="n">DCCPO_CHANGE_L</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">DCCPO_CONFIRM_L</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">DCCPO_CHANGE_R</span> <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">DCCPO_CONFIRM_R</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">DCCPO_NDP_COUNT</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">DCCPO_ACK_VECTOR_0</span> <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">DCCPO_ACK_VECTOR_1</span> <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>
	<span class="n">DCCPO_TIMESTAMP</span> <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>
	<span class="n">DCCPO_TIMESTAMP_ECHO</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">DCCPO_ELAPSED_TIME</span> <span class="o">=</span> <span class="mi">43</span><span class="p">,</span>
	<span class="n">DCCPO_MAX</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	<span class="n">DCCPO_MIN_RX_CCID_SPECIFIC</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>	<span class="cm">/* from sender to receiver */</span>
	<span class="n">DCCPO_MAX_RX_CCID_SPECIFIC</span> <span class="o">=</span> <span class="mi">191</span><span class="p">,</span>
	<span class="n">DCCPO_MIN_TX_CCID_SPECIFIC</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span>	<span class="cm">/* from receiver to sender */</span>
	<span class="n">DCCPO_MAX_TX_CCID_SPECIFIC</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span>
<span class="p">};</span>
<span class="cm">/* maximum size of a single TLV-encoded DCCP option (sans type/len bytes) */</span>
<span class="cp">#define DCCP_SINGLE_OPT_MAXLEN	253</span>

<span class="cm">/* DCCP CCIDS */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">DCCPC_CCID2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">DCCPC_CCID3</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* DCCP features (RFC 4340 section 6.4) */</span>
<span class="k">enum</span> <span class="n">dccp_feature_numbers</span> <span class="p">{</span>
	<span class="n">DCCPF_RESERVED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">DCCPF_CCID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">DCCPF_SHORT_SEQNOS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">DCCPF_SEQUENCE_WINDOW</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">DCCPF_ECN_INCAPABLE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">DCCPF_ACK_RATIO</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">DCCPF_SEND_ACK_VECTOR</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">DCCPF_SEND_NDP_COUNT</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">DCCPF_MIN_CSUM_COVER</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">DCCPF_DATA_CHECKSUM</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="cm">/* 10-127 reserved */</span>
	<span class="n">DCCPF_MIN_CCID_SPECIFIC</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span>
	<span class="n">DCCPF_SEND_LEV_RATE</span> <span class="o">=</span> <span class="mi">192</span><span class="p">,</span>	<span class="cm">/* RFC 4342, sec. 8.4 */</span>
	<span class="n">DCCPF_MAX_CCID_SPECIFIC</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* DCCP socket control message types for cmsg */</span>
<span class="k">enum</span> <span class="n">dccp_cmsg_type</span> <span class="p">{</span>
	<span class="n">DCCP_SCM_PRIORITY</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">DCCP_SCM_QPOLICY_MAX</span> <span class="o">=</span> <span class="mh">0xFFFF</span><span class="p">,</span>
	<span class="cm">/* ^-- Up to here reserved exclusively for qpolicy parameters */</span>
	<span class="n">DCCP_SCM_MAX</span>
<span class="p">};</span>

<span class="cm">/* DCCP priorities for outgoing/queued packets */</span>
<span class="k">enum</span> <span class="n">dccp_packet_dequeueing_policy</span> <span class="p">{</span>
	<span class="n">DCCPQ_POLICY_SIMPLE</span><span class="p">,</span>
	<span class="n">DCCPQ_POLICY_PRIO</span><span class="p">,</span>
	<span class="n">DCCPQ_POLICY_MAX</span>
<span class="p">};</span>

<span class="cm">/* DCCP socket options */</span>
<span class="cp">#define DCCP_SOCKOPT_PACKET_SIZE	1 </span><span class="cm">/* XXX deprecated, without effect */</span><span class="cp"></span>
<span class="cp">#define DCCP_SOCKOPT_SERVICE		2</span>
<span class="cp">#define DCCP_SOCKOPT_CHANGE_L		3</span>
<span class="cp">#define DCCP_SOCKOPT_CHANGE_R		4</span>
<span class="cp">#define DCCP_SOCKOPT_GET_CUR_MPS	5</span>
<span class="cp">#define DCCP_SOCKOPT_SERVER_TIMEWAIT	6</span>
<span class="cp">#define DCCP_SOCKOPT_SEND_CSCOV		10</span>
<span class="cp">#define DCCP_SOCKOPT_RECV_CSCOV		11</span>
<span class="cp">#define DCCP_SOCKOPT_AVAILABLE_CCIDS	12</span>
<span class="cp">#define DCCP_SOCKOPT_CCID		13</span>
<span class="cp">#define DCCP_SOCKOPT_TX_CCID		14</span>
<span class="cp">#define DCCP_SOCKOPT_RX_CCID		15</span>
<span class="cp">#define DCCP_SOCKOPT_QPOLICY_ID		16</span>
<span class="cp">#define DCCP_SOCKOPT_QPOLICY_TXQLEN	17</span>
<span class="cp">#define DCCP_SOCKOPT_CCID_RX_INFO	128</span>
<span class="cp">#define DCCP_SOCKOPT_CCID_TX_INFO	192</span>

<span class="cm">/* maximum number of services provided on the same listening port */</span>
<span class="cp">#define DCCP_SERVICE_LIST_MAX_LEN      32</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#include &lt;linux/in.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>
<span class="cp">#include &lt;linux/ktime.h&gt;</span>
<span class="cp">#include &lt;linux/list.h&gt;</span>
<span class="cp">#include &lt;linux/uio.h&gt;</span>
<span class="cp">#include &lt;linux/workqueue.h&gt;</span>

<span class="cp">#include &lt;net/inet_connection_sock.h&gt;</span>
<span class="cp">#include &lt;net/inet_sock.h&gt;</span>
<span class="cp">#include &lt;net/inet_timewait_sock.h&gt;</span>
<span class="cp">#include &lt;net/tcp_states.h&gt;</span>

<span class="k">enum</span> <span class="n">dccp_state</span> <span class="p">{</span>
	<span class="n">DCCP_OPEN</span>	     <span class="o">=</span> <span class="n">TCP_ESTABLISHED</span><span class="p">,</span>
	<span class="n">DCCP_REQUESTING</span>	     <span class="o">=</span> <span class="n">TCP_SYN_SENT</span><span class="p">,</span>
	<span class="n">DCCP_LISTEN</span>	     <span class="o">=</span> <span class="n">TCP_LISTEN</span><span class="p">,</span>
	<span class="n">DCCP_RESPOND</span>	     <span class="o">=</span> <span class="n">TCP_SYN_RECV</span><span class="p">,</span>
	<span class="cm">/*</span>
<span class="cm">	 * States involved in closing a DCCP connection:</span>
<span class="cm">	 * 1) ACTIVE_CLOSEREQ is entered by a server sending a CloseReq.</span>
<span class="cm">	 *</span>
<span class="cm">	 * 2) CLOSING can have three different meanings (RFC 4340, 8.3):</span>
<span class="cm">	 *  a. Client has performed active-close, has sent a Close to the server</span>
<span class="cm">	 *     from state OPEN or PARTOPEN, and is waiting for the final Reset</span>
<span class="cm">	 *     (in this case, SOCK_DONE == 1).</span>
<span class="cm">	 *  b. Client is asked to perform passive-close, by receiving a CloseReq</span>
<span class="cm">	 *     in (PART)OPEN state. It sends a Close and waits for final Reset</span>
<span class="cm">	 *     (in this case, SOCK_DONE == 0).</span>
<span class="cm">	 *  c. Server performs an active-close as in (a), keeps TIMEWAIT state.</span>
<span class="cm">	 *</span>
<span class="cm">	 * 3) The following intermediate states are employed to give passively</span>
<span class="cm">	 *    closing nodes a chance to process their unread data:</span>
<span class="cm">	 *    - PASSIVE_CLOSE    (from OPEN =&gt; CLOSED) and</span>
<span class="cm">	 *    - PASSIVE_CLOSEREQ (from (PART)OPEN to CLOSING; case (b) above).</span>
<span class="cm">	 */</span>
	<span class="n">DCCP_ACTIVE_CLOSEREQ</span> <span class="o">=</span> <span class="n">TCP_FIN_WAIT1</span><span class="p">,</span>
	<span class="n">DCCP_PASSIVE_CLOSE</span>   <span class="o">=</span> <span class="n">TCP_CLOSE_WAIT</span><span class="p">,</span>	<span class="cm">/* any node receiving a Close */</span>
	<span class="n">DCCP_CLOSING</span>	     <span class="o">=</span> <span class="n">TCP_CLOSING</span><span class="p">,</span>
	<span class="n">DCCP_TIME_WAIT</span>	     <span class="o">=</span> <span class="n">TCP_TIME_WAIT</span><span class="p">,</span>
	<span class="n">DCCP_CLOSED</span>	     <span class="o">=</span> <span class="n">TCP_CLOSE</span><span class="p">,</span>
	<span class="n">DCCP_PARTOPEN</span>	     <span class="o">=</span> <span class="n">TCP_MAX_STATES</span><span class="p">,</span>
	<span class="n">DCCP_PASSIVE_CLOSEREQ</span><span class="p">,</span>			<span class="cm">/* clients receiving CloseReq */</span>
	<span class="n">DCCP_MAX_STATES</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">DCCPF_OPEN</span>	      <span class="o">=</span> <span class="n">TCPF_ESTABLISHED</span><span class="p">,</span>
	<span class="n">DCCPF_REQUESTING</span>      <span class="o">=</span> <span class="n">TCPF_SYN_SENT</span><span class="p">,</span>
	<span class="n">DCCPF_LISTEN</span>	      <span class="o">=</span> <span class="n">TCPF_LISTEN</span><span class="p">,</span>
	<span class="n">DCCPF_RESPOND</span>	      <span class="o">=</span> <span class="n">TCPF_SYN_RECV</span><span class="p">,</span>
	<span class="n">DCCPF_ACTIVE_CLOSEREQ</span> <span class="o">=</span> <span class="n">TCPF_FIN_WAIT1</span><span class="p">,</span>
	<span class="n">DCCPF_CLOSING</span>	      <span class="o">=</span> <span class="n">TCPF_CLOSING</span><span class="p">,</span>
	<span class="n">DCCPF_TIME_WAIT</span>	      <span class="o">=</span> <span class="n">TCPF_TIME_WAIT</span><span class="p">,</span>
	<span class="n">DCCPF_CLOSED</span>	      <span class="o">=</span> <span class="n">TCPF_CLOSE</span><span class="p">,</span>
	<span class="n">DCCPF_PARTOPEN</span>	      <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">DCCP_PARTOPEN</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="nf">dccp_hdr</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="p">)</span><span class="n">skb_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="nf">dccp_zeroed_hdr</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="kt">int</span> <span class="n">headlen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">skb_push</span><span class="p">(</span><span class="n">skb</span><span class="p">,</span> <span class="n">headlen</span><span class="p">);</span>
	<span class="n">skb_reset_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">memset</span><span class="p">(</span><span class="n">skb_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">headlen</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_hdr_ext</span> <span class="o">*</span><span class="nf">dccp_hdrx</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="n">dh</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_ext</span> <span class="o">*</span><span class="p">)((</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">dh</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">dh</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">__dccp_basic_hdr_len</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="n">dh</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">dh</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">dh</span><span class="o">-&gt;</span><span class="n">dccph_x</span> <span class="o">?</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_ext</span><span class="p">)</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">dccp_basic_hdr_len</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="n">dh</span> <span class="o">=</span> <span class="n">dccp_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">__dccp_basic_hdr_len</span><span class="p">(</span><span class="n">dh</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">__u64</span> <span class="nf">dccp_hdr_seq</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="n">dh</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__u64</span> <span class="n">seq_nr</span> <span class="o">=</span>  <span class="n">ntohs</span><span class="p">(</span><span class="n">dh</span><span class="o">-&gt;</span><span class="n">dccph_seq</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">dh</span><span class="o">-&gt;</span><span class="n">dccph_x</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">seq_nr</span> <span class="o">=</span> <span class="p">(</span><span class="n">seq_nr</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">+</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">dccp_hdrx</span><span class="p">(</span><span class="n">dh</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">dccph_seq_low</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">seq_nr</span> <span class="o">+=</span> <span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="n">dh</span><span class="o">-&gt;</span><span class="n">dccph_seq2</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">seq_nr</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_hdr_request</span> <span class="o">*</span><span class="nf">dccp_hdr_request</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_request</span> <span class="o">*</span><span class="p">)(</span><span class="n">skb_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">)</span> <span class="o">+</span>
					   <span class="n">dccp_basic_hdr_len</span><span class="p">(</span><span class="n">skb</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_hdr_ack_bits</span> <span class="o">*</span><span class="nf">dccp_hdr_ack_bits</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_ack_bits</span> <span class="o">*</span><span class="p">)(</span><span class="n">skb_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">)</span> <span class="o">+</span>
					    <span class="n">dccp_basic_hdr_len</span><span class="p">(</span><span class="n">skb</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u64</span> <span class="nf">dccp_hdr_ack_seq</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">dccp_hdr_ack_bits</span> <span class="o">*</span><span class="n">dhack</span> <span class="o">=</span> <span class="n">dccp_hdr_ack_bits</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>
	<span class="k">return</span> <span class="p">((</span><span class="n">u64</span><span class="p">)</span><span class="n">ntohs</span><span class="p">(</span><span class="n">dhack</span><span class="o">-&gt;</span><span class="n">dccph_ack_nr_high</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">+</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">dhack</span><span class="o">-&gt;</span><span class="n">dccph_ack_nr_low</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_hdr_response</span> <span class="o">*</span><span class="nf">dccp_hdr_response</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_response</span> <span class="o">*</span><span class="p">)(</span><span class="n">skb_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">)</span> <span class="o">+</span>
					    <span class="n">dccp_basic_hdr_len</span><span class="p">(</span><span class="n">skb</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_hdr_reset</span> <span class="o">*</span><span class="nf">dccp_hdr_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_hdr_reset</span> <span class="o">*</span><span class="p">)(</span><span class="n">skb_transport_header</span><span class="p">(</span><span class="n">skb</span><span class="p">)</span> <span class="o">+</span>
					 <span class="n">dccp_basic_hdr_len</span><span class="p">(</span><span class="n">skb</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">__dccp_hdr_len</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">dccp_hdr</span> <span class="o">*</span><span class="n">dh</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__dccp_basic_hdr_len</span><span class="p">(</span><span class="n">dh</span><span class="p">)</span> <span class="o">+</span>
	       <span class="n">dccp_packet_hdr_len</span><span class="p">(</span><span class="n">dh</span><span class="o">-&gt;</span><span class="n">dccph_type</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">dccp_hdr_len</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">__dccp_hdr_len</span><span class="p">(</span><span class="n">dccp_hdr</span><span class="p">(</span><span class="n">skb</span><span class="p">));</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * struct dccp_request_sock  -  represent DCCP-specific connection request</span>
<span class="cm"> * @dreq_inet_rsk: structure inherited from</span>
<span class="cm"> * @dreq_iss: initial sequence number, sent on the first Response (RFC 4340, 7.1)</span>
<span class="cm"> * @dreq_gss: greatest sequence number sent (for retransmitted Responses)</span>
<span class="cm"> * @dreq_isr: initial sequence number received in the first Request</span>
<span class="cm"> * @dreq_gsr: greatest sequence number received (for retransmitted Request(s))</span>
<span class="cm"> * @dreq_service: service code present on the Request (there is just one)</span>
<span class="cm"> * @dreq_featneg: feature negotiation options for this connection</span>
<span class="cm"> * The following two fields are analogous to the ones in dccp_sock:</span>
<span class="cm"> * @dreq_timestamp_echo: last received timestamp to echo (13.1)</span>
<span class="cm"> * @dreq_timestamp_echo: the time of receiving the last @dreq_timestamp_echo</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_request_sock</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">inet_request_sock</span> <span class="n">dreq_inet_rsk</span><span class="p">;</span>
	<span class="n">__u64</span>			 <span class="n">dreq_iss</span><span class="p">;</span>
	<span class="n">__u64</span>			 <span class="n">dreq_gss</span><span class="p">;</span>
	<span class="n">__u64</span>			 <span class="n">dreq_isr</span><span class="p">;</span>
	<span class="n">__u64</span>			 <span class="n">dreq_gsr</span><span class="p">;</span>
	<span class="n">__be32</span>			 <span class="n">dreq_service</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>	 <span class="n">dreq_featneg</span><span class="p">;</span>
	<span class="n">__u32</span>			 <span class="n">dreq_timestamp_echo</span><span class="p">;</span>
	<span class="n">__u32</span>			 <span class="n">dreq_timestamp_time</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_request_sock</span> <span class="o">*</span><span class="nf">dccp_rsk</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">request_sock</span> <span class="o">*</span><span class="n">req</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_request_sock</span> <span class="o">*</span><span class="p">)</span><span class="n">req</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">inet_timewait_death_row</span> <span class="n">dccp_death_row</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">dccp_parse_options</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">dccp_request_sock</span> <span class="o">*</span><span class="n">dreq</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">dccp_options_received</span> <span class="p">{</span>
	<span class="n">u64</span>	<span class="n">dccpor_ndp</span><span class="o">:</span><span class="mi">48</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">dccpor_timestamp</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">dccpor_timestamp_echo</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">dccpor_elapsed_time</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ccid</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">dccp_role</span> <span class="p">{</span>
	<span class="n">DCCP_ROLE_UNDEFINED</span><span class="p">,</span>
	<span class="n">DCCP_ROLE_LISTEN</span><span class="p">,</span>
	<span class="n">DCCP_ROLE_CLIENT</span><span class="p">,</span>
	<span class="n">DCCP_ROLE_SERVER</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">dccp_service_list</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">dccpsl_nr</span><span class="p">;</span>
	<span class="n">__be32</span>	<span class="n">dccpsl_list</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define DCCP_SERVICE_INVALID_VALUE htonl((__u32)-1)</span>
<span class="cp">#define DCCP_SERVICE_CODE_IS_ABSENT		0</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">dccp_list_has_service</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">dccp_service_list</span> <span class="o">*</span><span class="n">sl</span><span class="p">,</span>
					<span class="k">const</span> <span class="n">__be32</span> <span class="n">service</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">likely</span><span class="p">(</span><span class="n">sl</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">i</span> <span class="o">=</span> <span class="n">sl</span><span class="o">-&gt;</span><span class="n">dccpsl_nr</span><span class="p">;</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">i</span><span class="o">--</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">sl</span><span class="o">-&gt;</span><span class="n">dccpsl_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">service</span><span class="p">)</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">dccp_ackvec</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * struct dccp_sock - DCCP socket state</span>
<span class="cm"> *</span>
<span class="cm"> * @dccps_swl - sequence number window low</span>
<span class="cm"> * @dccps_swh - sequence number window high</span>
<span class="cm"> * @dccps_awl - acknowledgement number window low</span>
<span class="cm"> * @dccps_awh - acknowledgement number window high</span>
<span class="cm"> * @dccps_iss - initial sequence number sent</span>
<span class="cm"> * @dccps_isr - initial sequence number received</span>
<span class="cm"> * @dccps_osr - first OPEN sequence number received</span>
<span class="cm"> * @dccps_gss - greatest sequence number sent</span>
<span class="cm"> * @dccps_gsr - greatest valid sequence number received</span>
<span class="cm"> * @dccps_gar - greatest valid ack number received on a non-Sync; initialized to %dccps_iss</span>
<span class="cm"> * @dccps_service - first (passive sock) or unique (active sock) service code</span>
<span class="cm"> * @dccps_service_list - second .. last service code on passive socket</span>
<span class="cm"> * @dccps_timestamp_echo - latest timestamp received on a TIMESTAMP option</span>
<span class="cm"> * @dccps_timestamp_time - time of receiving latest @dccps_timestamp_echo</span>
<span class="cm"> * @dccps_l_ack_ratio - feature-local Ack Ratio</span>
<span class="cm"> * @dccps_r_ack_ratio - feature-remote Ack Ratio</span>
<span class="cm"> * @dccps_l_seq_win - local Sequence Window (influences ack number validity)</span>
<span class="cm"> * @dccps_r_seq_win - remote Sequence Window (influences seq number validity)</span>
<span class="cm"> * @dccps_pcslen - sender   partial checksum coverage (via sockopt)</span>
<span class="cm"> * @dccps_pcrlen - receiver partial checksum coverage (via sockopt)</span>
<span class="cm"> * @dccps_send_ndp_count - local Send NDP Count feature (7.7.2)</span>
<span class="cm"> * @dccps_ndp_count - number of Non Data Packets since last data packet</span>
<span class="cm"> * @dccps_mss_cache - current value of MSS (path MTU minus header sizes)</span>
<span class="cm"> * @dccps_rate_last - timestamp for rate-limiting DCCP-Sync (RFC 4340, 7.5.4)</span>
<span class="cm"> * @dccps_featneg - tracks feature-negotiation state (mostly during handshake)</span>
<span class="cm"> * @dccps_hc_rx_ackvec - rx half connection ack vector</span>
<span class="cm"> * @dccps_hc_rx_ccid - CCID used for the receiver (or receiving half-connection)</span>
<span class="cm"> * @dccps_hc_tx_ccid - CCID used for the sender (or sending half-connection)</span>
<span class="cm"> * @dccps_options_received - parsed set of retrieved options</span>
<span class="cm"> * @dccps_qpolicy - TX dequeueing policy, one of %dccp_packet_dequeueing_policy</span>
<span class="cm"> * @dccps_tx_qlen - maximum length of the TX queue</span>
<span class="cm"> * @dccps_role - role of this sock, one of %dccp_role</span>
<span class="cm"> * @dccps_hc_rx_insert_options - receiver wants to add options when acking</span>
<span class="cm"> * @dccps_hc_tx_insert_options - sender wants to add options when sending</span>
<span class="cm"> * @dccps_server_timewait - server holds timewait state on close (RFC 4340, 8.3)</span>
<span class="cm"> * @dccps_sync_scheduled - flag which signals &quot;send out-of-band message soon&quot;</span>
<span class="cm"> * @dccps_xmitlet - tasklet scheduled by the TX CCID to dequeue data packets</span>
<span class="cm"> * @dccps_xmit_timer - used by the TX CCID to delay sending (rate-based pacing)</span>
<span class="cm"> * @dccps_syn_rtt - RTT sample from Request/Response exchange (in usecs)</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dccp_sock</span> <span class="p">{</span>
	<span class="cm">/* inet_connection_sock has to be the first member of dccp_sock */</span>
	<span class="k">struct</span> <span class="n">inet_connection_sock</span>	<span class="n">dccps_inet_connection</span><span class="p">;</span>
<span class="cp">#define dccps_syn_rtt			dccps_inet_connection.icsk_ack.lrcvtime</span>
	<span class="n">__u64</span>				<span class="n">dccps_swl</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_swh</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_awl</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_awh</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_iss</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_isr</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_osr</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_gss</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_gsr</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_gar</span><span class="p">;</span>
	<span class="n">__be32</span>				<span class="n">dccps_service</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">dccps_mss_cache</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dccp_service_list</span>	<span class="o">*</span><span class="n">dccps_service_list</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">dccps_timestamp_echo</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">dccps_timestamp_time</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">dccps_l_ack_ratio</span><span class="p">;</span>
	<span class="n">__u16</span>				<span class="n">dccps_r_ack_ratio</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_l_seq_win</span><span class="o">:</span><span class="mi">48</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_r_seq_win</span><span class="o">:</span><span class="mi">48</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_pcslen</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_pcrlen</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_send_ndp_count</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">__u64</span>				<span class="n">dccps_ndp_count</span><span class="o">:</span><span class="mi">48</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>			<span class="n">dccps_rate_last</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">dccps_featneg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dccp_ackvec</span>		<span class="o">*</span><span class="n">dccps_hc_rx_ackvec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ccid</span>			<span class="o">*</span><span class="n">dccps_hc_rx_ccid</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ccid</span>			<span class="o">*</span><span class="n">dccps_hc_tx_ccid</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dccp_options_received</span>	<span class="n">dccps_options_received</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_qpolicy</span><span class="p">;</span>
	<span class="n">__u32</span>				<span class="n">dccps_tx_qlen</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">dccp_role</span>			<span class="n">dccps_role</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_hc_rx_insert_options</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_hc_tx_insert_options</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_server_timewait</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">__u8</span>				<span class="n">dccps_sync_scheduled</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tasklet_struct</span>		<span class="n">dccps_xmitlet</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span>		<span class="n">dccps_xmit_timer</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">dccp_sock</span> <span class="o">*</span><span class="nf">dccp_sk</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">dccp_sock</span> <span class="o">*</span><span class="p">)</span><span class="n">sk</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">dccp_role</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">dccp_sk</span><span class="p">(</span><span class="n">sk</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">dccps_role</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">DCCP_ROLE_UNDEFINED</span>: <span class="k">return</span> <span class="s">&quot;undefined&quot;</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DCCP_ROLE_LISTEN</span>:	  <span class="k">return</span> <span class="s">&quot;listen&quot;</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DCCP_ROLE_SERVER</span>:	  <span class="k">return</span> <span class="s">&quot;server&quot;</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DCCP_ROLE_CLIENT</span>:	  <span class="k">return</span> <span class="s">&quot;client&quot;</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">dccp_syn_ack_timeout</span><span class="p">(</span><span class="k">struct</span> <span class="n">sock</span> <span class="o">*</span><span class="n">sk</span><span class="p">,</span> <span class="k">struct</span> <span class="n">request_sock</span> <span class="o">*</span><span class="n">req</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _LINUX_DCCP_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
