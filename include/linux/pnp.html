<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › pnp.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>pnp.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Linux Plug and Play Support</span>
<span class="cm"> * Copyright by Adam Belay &lt;ambx1@neo.rr.com&gt;</span>
<span class="cm"> * Copyright (C) 2008 Hewlett-Packard Development Company, L.P.</span>
<span class="cm"> *	Bjorn Helgaas &lt;bjorn.helgaas@hp.com&gt;</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_PNP_H</span>
<span class="cp">#define _LINUX_PNP_H</span>

<span class="cp">#include &lt;linux/device.h&gt;</span>
<span class="cp">#include &lt;linux/list.h&gt;</span>
<span class="cp">#include &lt;linux/errno.h&gt;</span>
<span class="cp">#include &lt;linux/mod_devicetable.h&gt;</span>

<span class="cp">#define PNP_NAME_LEN		50</span>

<span class="k">struct</span> <span class="n">pnp_protocol</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">pnp_dev</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * Resource Management</span>
<span class="cm"> */</span>
<span class="cp">#ifdef CONFIG_PNP</span>
<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">pnp_get_resource</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">type</span><span class="p">,</span>
				<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="nf">pnp_get_resource</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">type</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_resource_valid</span><span class="p">(</span><span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_resource_enabled</span><span class="p">(</span><span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">flags</span> <span class="o">&amp;</span> <span class="n">IORESOURCE_DISABLED</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_resource_len</span><span class="p">(</span><span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">res</span><span class="o">-&gt;</span><span class="n">start</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">end</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">resource_size</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_port_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_port_end</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">pnp_port_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">IORESOURCE_IO</span> <span class="o">|</span> <span class="n">IORESOURCE_AUTO</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_port_valid</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span> <span class="n">bar</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_port_len</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					   <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IO</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">pnp_resource_len</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_mem_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_mem_end</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">pnp_mem_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">IORESOURCE_MEM</span> <span class="o">|</span> <span class="n">IORESOURCE_AUTO</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_mem_valid</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span> <span class="n">bar</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_mem_len</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_MEM</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">pnp_resource_len</span><span class="p">(</span><span class="n">res</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_irq</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">pnp_irq_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">IORESOURCE_IRQ</span> <span class="o">|</span> <span class="n">IORESOURCE_AUTO</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_irq_valid</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_IRQ</span><span class="p">,</span> <span class="n">bar</span><span class="p">));</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="n">resource_size_t</span> <span class="nf">pnp_dma</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">pnp_dma_flags</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res</span> <span class="o">=</span> <span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span> <span class="n">bar</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">res</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">IORESOURCE_DMA</span> <span class="o">|</span> <span class="n">IORESOURCE_AUTO</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_dma_valid</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">bar</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">pnp_resource_valid</span><span class="p">(</span><span class="n">pnp_get_resource</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="n">IORESOURCE_DMA</span><span class="p">,</span> <span class="n">bar</span><span class="p">));</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * Device Management</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">pnp_card</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="n">dev</span><span class="p">;</span>		<span class="cm">/* Driver Model device interface */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">number</span><span class="p">;</span>		<span class="cm">/* used as an index, must be unique */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">global_list</span><span class="p">;</span>	<span class="cm">/* node in global list of cards */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">protocol_list</span><span class="p">;</span>	<span class="cm">/* node in protocol&#39;s list of cards */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">devices</span><span class="p">;</span>	<span class="cm">/* devices attached to the card */</span>

	<span class="k">struct</span> <span class="n">pnp_protocol</span> <span class="o">*</span><span class="n">protocol</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pnp_id</span> <span class="o">*</span><span class="n">id</span><span class="p">;</span>		<span class="cm">/* contains supported EISA IDs */</span>

	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">PNP_NAME_LEN</span><span class="p">];</span>	<span class="cm">/* contains a human-readable name */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pnpver</span><span class="p">;</span>		<span class="cm">/* Plug &amp; Play version */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">productver</span><span class="p">;</span>	<span class="cm">/* product version */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">serial</span><span class="p">;</span>		<span class="cm">/* serial number */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">checksum</span><span class="p">;</span>		<span class="cm">/* if zero - checksum passed */</span>
	<span class="k">struct</span> <span class="n">proc_dir_entry</span> <span class="o">*</span><span class="n">procdir</span><span class="p">;</span>	<span class="cm">/* directory entry in /proc/bus/isapnp */</span>
<span class="p">};</span>

<span class="cp">#define global_to_pnp_card(n) list_entry(n, struct pnp_card, global_list)</span>
<span class="cp">#define protocol_to_pnp_card(n) list_entry(n, struct pnp_card, protocol_list)</span>
<span class="cp">#define to_pnp_card(n) container_of(n, struct pnp_card, dev)</span>
<span class="cp">#define pnp_for_each_card(card) \</span>
<span class="cp">	for((card) = global_to_pnp_card(pnp_cards.next); \</span>
<span class="cp">	(card) != global_to_pnp_card(&amp;pnp_cards); \</span>
<span class="cp">	(card) = global_to_pnp_card((card)-&gt;global_list.next))</span>

<span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">pnp_card</span> <span class="o">*</span><span class="n">card</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pnp_card_driver</span> <span class="o">*</span><span class="n">driver</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">driver_data</span><span class="p">;</span>
	<span class="n">pm_message_t</span> <span class="n">pm_state</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">pnp_get_card_drvdata</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">pcard</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">pcard</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pnp_set_card_drvdata</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">pcard</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">pcard</span><span class="o">-&gt;</span><span class="n">driver_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">pnp_dev</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="n">dev</span><span class="p">;</span>		<span class="cm">/* Driver Model device interface */</span>
	<span class="n">u64</span> <span class="n">dma_mask</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">number</span><span class="p">;</span>		<span class="cm">/* used as an index, must be unique */</span>
	<span class="kt">int</span> <span class="n">status</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">global_list</span><span class="p">;</span>	<span class="cm">/* node in global list of devices */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">protocol_list</span><span class="p">;</span>	<span class="cm">/* node in list of device&#39;s protocol */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">card_list</span><span class="p">;</span>	<span class="cm">/* node in card&#39;s list of devices */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">rdev_list</span><span class="p">;</span>	<span class="cm">/* node in cards list of requested devices */</span>

	<span class="k">struct</span> <span class="n">pnp_protocol</span> <span class="o">*</span><span class="n">protocol</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pnp_card</span> <span class="o">*</span><span class="n">card</span><span class="p">;</span>	<span class="cm">/* card the device is attached to, none if NULL */</span>
	<span class="k">struct</span> <span class="n">pnp_driver</span> <span class="o">*</span><span class="n">driver</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">card_link</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">pnp_id</span> <span class="o">*</span><span class="n">id</span><span class="p">;</span>		<span class="cm">/* supported EISA IDs */</span>

	<span class="kt">int</span> <span class="n">active</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">capabilities</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">num_dependent_sets</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">resources</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">options</span><span class="p">;</span>

	<span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="n">PNP_NAME_LEN</span><span class="p">];</span>	<span class="cm">/* contains a human-readable name */</span>
	<span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>			<span class="cm">/* used by protocols */</span>
	<span class="k">struct</span> <span class="n">proc_dir_entry</span> <span class="o">*</span><span class="n">procent</span><span class="p">;</span>	<span class="cm">/* device entry in /proc/bus/isapnp */</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define global_to_pnp_dev(n) list_entry(n, struct pnp_dev, global_list)</span>
<span class="cp">#define card_to_pnp_dev(n) list_entry(n, struct pnp_dev, card_list)</span>
<span class="cp">#define protocol_to_pnp_dev(n) list_entry(n, struct pnp_dev, protocol_list)</span>
<span class="cp">#define	to_pnp_dev(n) container_of(n, struct pnp_dev, dev)</span>
<span class="cp">#define pnp_for_each_dev(dev) \</span>
<span class="cp">	for((dev) = global_to_pnp_dev(pnp_global.next); \</span>
<span class="cp">	(dev) != global_to_pnp_dev(&amp;pnp_global); \</span>
<span class="cp">	(dev) = global_to_pnp_dev((dev)-&gt;global_list.next))</span>
<span class="cp">#define card_for_each_dev(card,dev) \</span>
<span class="cp">	for((dev) = card_to_pnp_dev((card)-&gt;devices.next); \</span>
<span class="cp">	(dev) != card_to_pnp_dev(&amp;(card)-&gt;devices); \</span>
<span class="cp">	(dev) = card_to_pnp_dev((dev)-&gt;card_list.next))</span>
<span class="cp">#define pnp_dev_name(dev) (dev)-&gt;name</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">pnp_get_drvdata</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">dev_get_drvdata</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pnp_set_drvdata</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">dev_set_drvdata</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pdev</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">pnp_fixup</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="n">id</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">quirk_function</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>	<span class="cm">/* fixup function */</span>
<span class="p">};</span>

<span class="cm">/* config parameters */</span>
<span class="cp">#define PNP_CONFIG_NORMAL	0x0001</span>
<span class="cp">#define PNP_CONFIG_FORCE	0x0002	</span><span class="cm">/* disables validity checking */</span><span class="cp"></span>

<span class="cm">/* capabilities */</span>
<span class="cp">#define PNP_READ		0x0001</span>
<span class="cp">#define PNP_WRITE		0x0002</span>
<span class="cp">#define PNP_DISABLE		0x0004</span>
<span class="cp">#define PNP_CONFIGURABLE	0x0008</span>
<span class="cp">#define PNP_REMOVABLE		0x0010</span>

<span class="cp">#define pnp_can_read(dev)	(((dev)-&gt;protocol-&gt;get) &amp;&amp; \</span>
<span class="cp">				 ((dev)-&gt;capabilities &amp; PNP_READ))</span>
<span class="cp">#define pnp_can_write(dev)	(((dev)-&gt;protocol-&gt;set) &amp;&amp; \</span>
<span class="cp">				 ((dev)-&gt;capabilities &amp; PNP_WRITE))</span>
<span class="cp">#define pnp_can_disable(dev)	(((dev)-&gt;protocol-&gt;disable) &amp;&amp; \</span>
<span class="cp">				 ((dev)-&gt;capabilities &amp; PNP_DISABLE))</span>
<span class="cp">#define pnp_can_configure(dev)	((!(dev)-&gt;active) &amp;&amp; \</span>
<span class="cp">				 ((dev)-&gt;capabilities &amp; PNP_CONFIGURABLE))</span>

<span class="cp">#ifdef CONFIG_ISAPNP</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">pnp_protocol</span> <span class="n">isapnp_protocol</span><span class="p">;</span>
<span class="cp">#define pnp_device_is_isapnp(dev) ((dev)-&gt;protocol == (&amp;isapnp_protocol))</span>
<span class="cp">#else</span>
<span class="cp">#define pnp_device_is_isapnp(dev) 0</span>
<span class="cp">#endif</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">mutex</span> <span class="n">pnp_res_mutex</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_PNPBIOS</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">pnp_protocol</span> <span class="n">pnpbios_protocol</span><span class="p">;</span>
<span class="cp">#define pnp_device_is_pnpbios(dev) ((dev)-&gt;protocol == (&amp;pnpbios_protocol))</span>
<span class="cp">#else</span>
<span class="cp">#define pnp_device_is_pnpbios(dev) 0</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_PNPACPI</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">pnp_protocol</span> <span class="n">pnpacpi_protocol</span><span class="p">;</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">acpi_device</span> <span class="o">*</span><span class="nf">pnp_acpi_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">protocol</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">pnpacpi_protocol</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">dev</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#else</span>
<span class="cp">#define pnp_acpi_device(dev) 0</span>
<span class="cp">#endif</span>

<span class="cm">/* status */</span>
<span class="cp">#define PNP_READY		0x0000</span>
<span class="cp">#define PNP_ATTACHED		0x0001</span>
<span class="cp">#define PNP_BUSY		0x0002</span>
<span class="cp">#define PNP_FAULTY		0x0004</span>

<span class="cm">/* isapnp specific macros */</span>

<span class="cp">#define isapnp_card_number(dev)	((dev)-&gt;card ? (dev)-&gt;card-&gt;number : -1)</span>
<span class="cp">#define isapnp_csn_number(dev)  ((dev)-&gt;number)</span>

<span class="cm">/*</span>
<span class="cm"> * Driver Management</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">pnp_id</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="n">id</span><span class="p">[</span><span class="n">PNP_ID_LEN</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">pnp_id</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">pnp_driver</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">pnp_device_id</span> <span class="o">*</span><span class="n">id_table</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">probe</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">pnp_device_id</span> <span class="o">*</span><span class="n">dev_id</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">remove</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">shutdown</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">suspend</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">pm_message_t</span> <span class="n">state</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">resume</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">device_driver</span> <span class="n">driver</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define	to_pnp_driver(drv) container_of(drv, struct pnp_driver, driver)</span>

<span class="k">struct</span> <span class="n">pnp_card_driver</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">global_list</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">pnp_card_device_id</span> <span class="o">*</span><span class="n">id_table</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">probe</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">card</span><span class="p">,</span>
		      <span class="k">const</span> <span class="k">struct</span> <span class="n">pnp_card_device_id</span> <span class="o">*</span><span class="n">card_id</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">remove</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">card</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">suspend</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">card</span><span class="p">,</span> <span class="n">pm_message_t</span> <span class="n">state</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">resume</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">card</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">pnp_driver</span> <span class="n">link</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define	to_pnp_card_driver(drv) container_of(drv, struct pnp_card_driver, link)</span>

<span class="cm">/* pnp driver flags */</span>
<span class="cp">#define PNP_DRIVER_RES_DO_NOT_CHANGE	0x0001	</span><span class="cm">/* do not change the state of the device */</span><span class="cp"></span>
<span class="cp">#define PNP_DRIVER_RES_DISABLE		0x0003	</span><span class="cm">/* ensure the device is disabled */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Protocol Management</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">pnp_protocol</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">protocol_list</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>

	<span class="cm">/* resource control functions */</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">get</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">set</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">disable</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* protocol specific suspend/resume */</span>
	<span class="n">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">can_wakeup</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">suspend</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span> <span class="n">dev</span><span class="p">,</span> <span class="n">pm_message_t</span> <span class="n">state</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">resume</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span> <span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* used by pnp layer only (look but don&#39;t touch) */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">number</span><span class="p">;</span>	<span class="cm">/* protocol number */</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="n">dev</span><span class="p">;</span>	<span class="cm">/* link to driver model */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">cards</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">devices</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define to_pnp_protocol(n) list_entry(n, struct pnp_protocol, protocol_list)</span>
<span class="cp">#define protocol_for_each_card(protocol,card) \</span>
<span class="cp">	for((card) = protocol_to_pnp_card((protocol)-&gt;cards.next); \</span>
<span class="cp">	(card) != protocol_to_pnp_card(&amp;(protocol)-&gt;cards); \</span>
<span class="cp">	(card) = protocol_to_pnp_card((card)-&gt;protocol_list.next))</span>
<span class="cp">#define protocol_for_each_dev(protocol,dev) \</span>
<span class="cp">	for((dev) = protocol_to_pnp_dev((protocol)-&gt;devices.next); \</span>
<span class="cp">	(dev) != protocol_to_pnp_dev(&amp;(protocol)-&gt;devices); \</span>
<span class="cp">	(dev) = protocol_to_pnp_dev((dev)-&gt;protocol_list.next))</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">bus_type</span> <span class="n">pnp_bus_type</span><span class="p">;</span>

<span class="cp">#if defined(CONFIG_PNP)</span>

<span class="cm">/* device management */</span>
<span class="kt">int</span> <span class="n">pnp_device_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">pnp_dev</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">pnp_device_detach</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">pnp_dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="n">pnp_global</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">pnp_platform_devices</span><span class="p">;</span>

<span class="cm">/* multidevice card support */</span>
<span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">pnp_request_card_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">clink</span><span class="p">,</span>
					<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">from</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">pnp_release_card_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_register_card_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">pnp_unregister_card_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">list_head</span> <span class="n">pnp_cards</span><span class="p">;</span>

<span class="cm">/* resource management */</span>
<span class="kt">int</span> <span class="n">pnp_possible_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="n">resource_size_t</span> <span class="n">base</span><span class="p">,</span>
			<span class="n">resource_size_t</span> <span class="n">size</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_auto_config_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_start_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_stop_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_activate_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_disable_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_range_reserved</span><span class="p">(</span><span class="n">resource_size_t</span> <span class="n">start</span><span class="p">,</span> <span class="n">resource_size_t</span> <span class="n">end</span><span class="p">);</span>

<span class="cm">/* protocol helpers */</span>
<span class="kt">int</span> <span class="n">pnp_is_active</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">compare_pnp_id</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_id</span> <span class="o">*</span><span class="n">pos</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">pnp_register_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">pnp_unregister_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">);</span>

<span class="cp">#else</span>

<span class="cm">/* device management */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_device_attach</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">pnp_dev</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pnp_device_detach</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">pnp_dev</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

<span class="cp">#define pnp_platform_devices 0</span>

<span class="cm">/* multidevice card support */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="nf">pnp_request_card_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_link</span> <span class="o">*</span><span class="n">clink</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">from</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pnp_release_card_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_register_card_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pnp_unregister_card_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_card_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

<span class="cm">/* resource management */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_possible_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span>
				      <span class="n">resource_size_t</span> <span class="n">base</span><span class="p">,</span>
				      <span class="n">resource_size_t</span> <span class="n">size</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_auto_config_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_start_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_stop_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_activate_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_disable_dev</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_range_reserved</span><span class="p">(</span><span class="n">resource_size_t</span> <span class="n">start</span><span class="p">,</span> <span class="n">resource_size_t</span> <span class="n">end</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;}</span>

<span class="cm">/* protocol helpers */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_is_active</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">compare_pnp_id</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_id</span> <span class="o">*</span><span class="n">pos</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">pnp_register_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span> <span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">pnp_unregister_driver</span><span class="p">(</span><span class="k">struct</span> <span class="n">pnp_driver</span> <span class="o">*</span><span class="n">drv</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_PNP */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _LINUX_PNP_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
