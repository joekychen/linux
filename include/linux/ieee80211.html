<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › ieee80211.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>ieee80211.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * IEEE 802.11 defines</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2001-2002, SSH Communications Security Corp and Jouni Malinen</span>
<span class="cm"> * &lt;jkmaline@cc.hut.fi&gt;</span>
<span class="cm"> * Copyright (c) 2002-2003, Jouni Malinen &lt;jkmaline@cc.hut.fi&gt;</span>
<span class="cm"> * Copyright (c) 2005, Devicescape Software, Inc.</span>
<span class="cm"> * Copyright (c) 2006, Michael Wu &lt;flamingice@sourmilk.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef LINUX_IEEE80211_H</span>
<span class="cp">#define LINUX_IEEE80211_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;asm/byteorder.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * DS bit usage</span>
<span class="cm"> *</span>
<span class="cm"> * TA = transmitter address</span>
<span class="cm"> * RA = receiver address</span>
<span class="cm"> * DA = destination address</span>
<span class="cm"> * SA = source address</span>
<span class="cm"> *</span>
<span class="cm"> * ToDS    FromDS  A1(RA)  A2(TA)  A3      A4      Use</span>
<span class="cm"> * -----------------------------------------------------------------</span>
<span class="cm"> *  0       0       DA      SA      BSSID   -       IBSS/DLS</span>
<span class="cm"> *  0       1       DA      BSSID   SA      -       AP -&gt; STA</span>
<span class="cm"> *  1       0       BSSID   SA      DA      -       AP &lt;- STA</span>
<span class="cm"> *  1       1       RA      TA      DA      SA      unspecified (WDS)</span>
<span class="cm"> */</span>

<span class="cp">#define FCS_LEN 4</span>

<span class="cp">#define IEEE80211_FCTL_VERS		0x0003</span>
<span class="cp">#define IEEE80211_FCTL_FTYPE		0x000c</span>
<span class="cp">#define IEEE80211_FCTL_STYPE		0x00f0</span>
<span class="cp">#define IEEE80211_FCTL_TODS		0x0100</span>
<span class="cp">#define IEEE80211_FCTL_FROMDS		0x0200</span>
<span class="cp">#define IEEE80211_FCTL_MOREFRAGS	0x0400</span>
<span class="cp">#define IEEE80211_FCTL_RETRY		0x0800</span>
<span class="cp">#define IEEE80211_FCTL_PM		0x1000</span>
<span class="cp">#define IEEE80211_FCTL_MOREDATA		0x2000</span>
<span class="cp">#define IEEE80211_FCTL_PROTECTED	0x4000</span>
<span class="cp">#define IEEE80211_FCTL_ORDER		0x8000</span>

<span class="cp">#define IEEE80211_SCTL_FRAG		0x000F</span>
<span class="cp">#define IEEE80211_SCTL_SEQ		0xFFF0</span>

<span class="cp">#define IEEE80211_FTYPE_MGMT		0x0000</span>
<span class="cp">#define IEEE80211_FTYPE_CTL		0x0004</span>
<span class="cp">#define IEEE80211_FTYPE_DATA		0x0008</span>

<span class="cm">/* management */</span>
<span class="cp">#define IEEE80211_STYPE_ASSOC_REQ	0x0000</span>
<span class="cp">#define IEEE80211_STYPE_ASSOC_RESP	0x0010</span>
<span class="cp">#define IEEE80211_STYPE_REASSOC_REQ	0x0020</span>
<span class="cp">#define IEEE80211_STYPE_REASSOC_RESP	0x0030</span>
<span class="cp">#define IEEE80211_STYPE_PROBE_REQ	0x0040</span>
<span class="cp">#define IEEE80211_STYPE_PROBE_RESP	0x0050</span>
<span class="cp">#define IEEE80211_STYPE_BEACON		0x0080</span>
<span class="cp">#define IEEE80211_STYPE_ATIM		0x0090</span>
<span class="cp">#define IEEE80211_STYPE_DISASSOC	0x00A0</span>
<span class="cp">#define IEEE80211_STYPE_AUTH		0x00B0</span>
<span class="cp">#define IEEE80211_STYPE_DEAUTH		0x00C0</span>
<span class="cp">#define IEEE80211_STYPE_ACTION		0x00D0</span>

<span class="cm">/* control */</span>
<span class="cp">#define IEEE80211_STYPE_BACK_REQ	0x0080</span>
<span class="cp">#define IEEE80211_STYPE_BACK		0x0090</span>
<span class="cp">#define IEEE80211_STYPE_PSPOLL		0x00A0</span>
<span class="cp">#define IEEE80211_STYPE_RTS		0x00B0</span>
<span class="cp">#define IEEE80211_STYPE_CTS		0x00C0</span>
<span class="cp">#define IEEE80211_STYPE_ACK		0x00D0</span>
<span class="cp">#define IEEE80211_STYPE_CFEND		0x00E0</span>
<span class="cp">#define IEEE80211_STYPE_CFENDACK	0x00F0</span>

<span class="cm">/* data */</span>
<span class="cp">#define IEEE80211_STYPE_DATA			0x0000</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFACK		0x0010</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFPOLL		0x0020</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFACKPOLL		0x0030</span>
<span class="cp">#define IEEE80211_STYPE_NULLFUNC		0x0040</span>
<span class="cp">#define IEEE80211_STYPE_CFACK			0x0050</span>
<span class="cp">#define IEEE80211_STYPE_CFPOLL			0x0060</span>
<span class="cp">#define IEEE80211_STYPE_CFACKPOLL		0x0070</span>
<span class="cp">#define IEEE80211_STYPE_QOS_DATA		0x0080</span>
<span class="cp">#define IEEE80211_STYPE_QOS_DATA_CFACK		0x0090</span>
<span class="cp">#define IEEE80211_STYPE_QOS_DATA_CFPOLL		0x00A0</span>
<span class="cp">#define IEEE80211_STYPE_QOS_DATA_CFACKPOLL	0x00B0</span>
<span class="cp">#define IEEE80211_STYPE_QOS_NULLFUNC		0x00C0</span>
<span class="cp">#define IEEE80211_STYPE_QOS_CFACK		0x00D0</span>
<span class="cp">#define IEEE80211_STYPE_QOS_CFPOLL		0x00E0</span>
<span class="cp">#define IEEE80211_STYPE_QOS_CFACKPOLL		0x00F0</span>


<span class="cm">/* miscellaneous IEEE 802.11 constants */</span>
<span class="cp">#define IEEE80211_MAX_FRAG_THRESHOLD	2352</span>
<span class="cp">#define IEEE80211_MAX_RTS_THRESHOLD	2353</span>
<span class="cp">#define IEEE80211_MAX_AID		2007</span>
<span class="cp">#define IEEE80211_MAX_TIM_LEN		251</span>
<span class="cm">/* Maximum size for the MA-UNITDATA primitive, 802.11 standard section</span>
<span class="cm">   6.2.1.1.2.</span>

<span class="cm">   802.11e clarifies the figure in section 7.1.2. The frame body is</span>
<span class="cm">   up to 2304 octets long (maximum MSDU size) plus any crypt overhead. */</span>
<span class="cp">#define IEEE80211_MAX_DATA_LEN		2304</span>
<span class="cm">/* 30 byte 4 addr hdr, 2 byte QoS, 2304 byte MSDU, 12 byte crypt, 4 byte FCS */</span>
<span class="cp">#define IEEE80211_MAX_FRAME_LEN		2352</span>

<span class="cp">#define IEEE80211_MAX_SSID_LEN		32</span>

<span class="cp">#define IEEE80211_MAX_MESH_ID_LEN	32</span>

<span class="cp">#define IEEE80211_QOS_CTL_LEN		2</span>
<span class="cm">/* 1d tag mask */</span>
<span class="cp">#define IEEE80211_QOS_CTL_TAG1D_MASK		0x0007</span>
<span class="cm">/* TID mask */</span>
<span class="cp">#define IEEE80211_QOS_CTL_TID_MASK		0x000f</span>
<span class="cm">/* EOSP */</span>
<span class="cp">#define IEEE80211_QOS_CTL_EOSP			0x0010</span>
<span class="cm">/* ACK policy */</span>
<span class="cp">#define IEEE80211_QOS_CTL_ACK_POLICY_NORMAL	0x0000</span>
<span class="cp">#define IEEE80211_QOS_CTL_ACK_POLICY_NOACK	0x0020</span>
<span class="cp">#define IEEE80211_QOS_CTL_ACK_POLICY_NO_EXPL	0x0040</span>
<span class="cp">#define IEEE80211_QOS_CTL_ACK_POLICY_BLOCKACK	0x0060</span>
<span class="cp">#define IEEE80211_QOS_CTL_ACK_POLICY_MASK	0x0060</span>
<span class="cm">/* A-MSDU 802.11n */</span>
<span class="cp">#define IEEE80211_QOS_CTL_A_MSDU_PRESENT	0x0080</span>
<span class="cm">/* Mesh Control 802.11s */</span>
<span class="cp">#define IEEE80211_QOS_CTL_MESH_CONTROL_PRESENT  0x0100</span>

<span class="cm">/* U-APSD queue for WMM IEs sent by AP */</span>
<span class="cp">#define IEEE80211_WMM_IE_AP_QOSINFO_UAPSD	(1&lt;&lt;7)</span>
<span class="cp">#define IEEE80211_WMM_IE_AP_QOSINFO_PARAM_SET_CNT_MASK	0x0f</span>

<span class="cm">/* U-APSD queues for WMM IEs sent by STA */</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_AC_VO	(1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_AC_VI	(1&lt;&lt;1)</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_AC_BK	(1&lt;&lt;2)</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_AC_BE	(1&lt;&lt;3)</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_AC_MASK	0x0f</span>

<span class="cm">/* U-APSD max SP length for WMM IEs sent by STA */</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_SP_ALL	0x00</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_SP_2	0x01</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_SP_4	0x02</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_SP_6	0x03</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_SP_MASK	0x03</span>
<span class="cp">#define IEEE80211_WMM_IE_STA_QOSINFO_SP_SHIFT	5</span>

<span class="cp">#define IEEE80211_HT_CTL_LEN		4</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctrl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr4</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctrl</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_qos_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctrl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">qos_ctrl</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_tods - check if IEEE80211_FCTL_TODS is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_tods</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_TODS</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_fromds - check if IEEE80211_FCTL_FROMDS is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_fromds</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FROMDS</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_a4 - check if IEEE80211_FCTL_TODS and IEEE80211_FCTL_FROMDS are set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_a4</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__le16</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_TODS</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_FROMDS</span><span class="p">);</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">tmp</span><span class="p">)</span> <span class="o">==</span> <span class="n">tmp</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_morefrags - check if IEEE80211_FCTL_MOREFRAGS is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_morefrags</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_MOREFRAGS</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_retry - check if IEEE80211_FCTL_RETRY is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_retry</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_RETRY</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_pm - check if IEEE80211_FCTL_PM is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_pm</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_PM</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_moredata - check if IEEE80211_FCTL_MOREDATA is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_moredata</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_MOREDATA</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_protected - check if IEEE80211_FCTL_PROTECTED is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_protected</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_PROTECTED</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_has_order - check if IEEE80211_FCTL_ORDER is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_has_order</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_ORDER</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_mgmt - check if type is IEEE80211_FTYPE_MGMT</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_mgmt</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_ctl - check if type is IEEE80211_FTYPE_CTL</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_ctl</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_data - check if type is IEEE80211_FTYPE_DATA</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_data</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_DATA</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_data_qos - check if type is IEEE80211_FTYPE_DATA and IEEE80211_STYPE_QOS_DATA is set</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_data_qos</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * mask with QOS_DATA rather than IEEE80211_FCTL_STYPE as we just need</span>
<span class="cm">	 * to check the one bit</span>
<span class="cm">	 */</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_QOS_DATA</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_DATA</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_QOS_DATA</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_data_present - check if type is IEEE80211_FTYPE_DATA and has data</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_data_present</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * mask with 0x40 and test that that bit is clear to only return true</span>
<span class="cm">	 * for the data-containing substypes.</span>
<span class="cm">	 */</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="mh">0x40</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_DATA</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_assoc_req - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_ASSOC_REQ</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_assoc_req</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_ASSOC_REQ</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_assoc_resp - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_ASSOC_RESP</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_assoc_resp</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_ASSOC_RESP</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_reassoc_req - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_REASSOC_REQ</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_reassoc_req</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_REASSOC_REQ</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_reassoc_resp - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_REASSOC_RESP</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_reassoc_resp</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_REASSOC_RESP</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_probe_req - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_PROBE_REQ</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_probe_req</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_PROBE_REQ</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_probe_resp - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_PROBE_RESP</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_probe_resp</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_PROBE_RESP</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_beacon - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_BEACON</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_beacon</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_BEACON</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_atim - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_ATIM</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_atim</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_ATIM</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_disassoc - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_DISASSOC</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_disassoc</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_DISASSOC</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_auth - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_AUTH</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_auth</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_AUTH</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_deauth - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_DEAUTH</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_deauth</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_DEAUTH</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_action - check if IEEE80211_FTYPE_MGMT &amp;&amp; IEEE80211_STYPE_ACTION</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_action</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_MGMT</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_ACTION</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_back_req - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_BACK_REQ</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_back_req</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_BACK_REQ</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_back - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_BACK</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_back</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_BACK</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_pspoll - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_PSPOLL</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_pspoll</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_PSPOLL</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_rts - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_RTS</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_rts</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_RTS</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_cts - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_CTS</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_cts</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_CTS</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_ack - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_ACK</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_ack</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_ACK</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_cfend - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_CFEND</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_cfend</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_CFEND</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_cfendack - check if IEEE80211_FTYPE_CTL &amp;&amp; IEEE80211_STYPE_CFENDACK</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_cfendack</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_CTL</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_CFENDACK</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_nullfunc - check if frame is a regular (non-QoS) nullfunc frame</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_nullfunc</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_DATA</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_NULLFUNC</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_qos_nullfunc - check if frame is a QoS nullfunc frame</span>
<span class="cm"> * @fc: frame control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_qos_nullfunc</span><span class="p">(</span><span class="n">__le16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FCTL_FTYPE</span> <span class="o">|</span> <span class="n">IEEE80211_FCTL_STYPE</span><span class="p">))</span> <span class="o">==</span>
	       <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_FTYPE_DATA</span> <span class="o">|</span> <span class="n">IEEE80211_STYPE_QOS_NULLFUNC</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_first_frag - check if IEEE80211_SCTL_FRAG is not set</span>
<span class="cm"> * @seq_ctrl: frame sequence control bytes in little-endian byteorder</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_first_frag</span><span class="p">(</span><span class="n">__le16</span> <span class="n">seq_ctrl</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">seq_ctrl</span> <span class="o">&amp;</span> <span class="n">cpu_to_le16</span><span class="p">(</span><span class="n">IEEE80211_SCTL_FRAG</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">ieee80211s_hdr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ttl</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">seqnum</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">eaddr1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">eaddr2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* Mesh flags */</span>
<span class="cp">#define MESH_FLAGS_AE_A4 	0x1</span>
<span class="cp">#define MESH_FLAGS_AE_A5_A6	0x2</span>
<span class="cp">#define MESH_FLAGS_AE		0x3</span>
<span class="cp">#define MESH_FLAGS_PS_DEEP	0x4</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_quiet_ie</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;Quiet information element&quot;</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_quiet_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">count</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">period</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">offset</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_msrment_ie</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;Measurement Request/Report information element&quot;</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_msrment_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">token</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">request</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_channel_sw_ie</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;Channel Switch Announcement information element&quot;</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_channel_sw_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">mode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">new_ch_num</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">count</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_tim</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;Traffic Indication Map information element&quot;</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_tim_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">dtim_count</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dtim_period</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bitmap_ctrl</span><span class="p">;</span>
	<span class="cm">/* variable size: 1 - 251 bytes */</span>
	<span class="n">u8</span> <span class="n">virtual_map</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_meshconf_ie</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;Mesh Configuration information element&quot;</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_meshconf_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">meshconf_psel</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">meshconf_pmetric</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">meshconf_congest</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">meshconf_synch</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">meshconf_auth</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">meshconf_form</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">meshconf_cap</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_rann_ie</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;Root Announcement information element&quot;</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_rann_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">rann_flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rann_hopcount</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rann_ttl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rann_addr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__le32</span> <span class="n">rann_seq</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rann_interval</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rann_metric</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">enum</span> <span class="n">ieee80211_rann_flags</span> <span class="p">{</span>
	<span class="n">RANN_FLAG_IS_GATE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define WLAN_SA_QUERY_TR_ID_LEN 2</span>

<span class="k">struct</span> <span class="n">ieee80211_mgmt</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">da</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">sa</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctrl</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">auth_alg</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">auth_transaction</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">status_code</span><span class="p">;</span>
			<span class="cm">/* possibly followed by Challenge text */</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">auth</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">reason_code</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">deauth</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">capab_info</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">listen_interval</span><span class="p">;</span>
			<span class="cm">/* followed by SSID and Supported rates */</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">assoc_req</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">capab_info</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">status_code</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">aid</span><span class="p">;</span>
			<span class="cm">/* followed by Supported rates */</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">assoc_resp</span><span class="p">,</span> <span class="n">reassoc_resp</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">capab_info</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">listen_interval</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">current_ap</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
			<span class="cm">/* followed by SSID and Supported rates */</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">reassoc_req</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">reason_code</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">disassoc</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le64</span> <span class="n">timestamp</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">beacon_int</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">capab_info</span><span class="p">;</span>
			<span class="cm">/* followed by some of SSID, Supported rates,</span>
<span class="cm">			 * FH Params, DS Params, CF Params, IBSS Params, TIM */</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">beacon</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="cm">/* only variable items: SSID, Supported rates */</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">probe_req</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le64</span> <span class="n">timestamp</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">beacon_int</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">capab_info</span><span class="p">;</span>
			<span class="cm">/* followed by some of SSID, Supported rates,</span>
<span class="cm">			 * FH Params, DS Params, CF Params, IBSS Params */</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">probe_resp</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">category</span><span class="p">;</span>
			<span class="k">union</span> <span class="p">{</span>
				<span class="k">struct</span> <span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">status_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
				<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">wme_action</span><span class="p">;</span>
				<span class="k">struct</span><span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">element_id</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">length</span><span class="p">;</span>
					<span class="k">struct</span> <span class="n">ieee80211_channel_sw_ie</span> <span class="n">sw_elem</span><span class="p">;</span>
				<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">chan_switch</span><span class="p">;</span>
				<span class="k">struct</span><span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">element_id</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">length</span><span class="p">;</span>
					<span class="k">struct</span> <span class="n">ieee80211_msrment_ie</span> <span class="n">msr_elem</span><span class="p">;</span>
				<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">measurement</span><span class="p">;</span>
				<span class="k">struct</span><span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">capab</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">timeout</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">start_seq_num</span><span class="p">;</span>
				<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">addba_req</span><span class="p">;</span>
				<span class="k">struct</span><span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">capab</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">timeout</span><span class="p">;</span>
				<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">addba_resp</span><span class="p">;</span>
				<span class="k">struct</span><span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">params</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">reason_code</span><span class="p">;</span>
				<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">delba</span><span class="p">;</span>
				<span class="k">struct</span> <span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
				<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">self_prot</span><span class="p">;</span>
				<span class="k">struct</span><span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
				<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">mesh_action</span><span class="p">;</span>
				<span class="k">struct</span> <span class="p">{</span>
					<span class="n">u8</span> <span class="n">action</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">trans_id</span><span class="p">[</span><span class="n">WLAN_SA_QUERY_TR_ID_LEN</span><span class="p">];</span>
				<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">sa_query</span><span class="p">;</span>
				<span class="k">struct</span> <span class="p">{</span>
					<span class="n">u8</span> <span class="n">action</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">smps_control</span><span class="p">;</span>
				<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">ht_smps</span><span class="p">;</span>
				<span class="k">struct</span> <span class="p">{</span>
					<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
					<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
					<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
				<span class="p">}</span> <span class="n">__packed</span> <span class="n">tdls_discover_resp</span><span class="p">;</span>
			<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">action</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* Supported Rates value encodings in 802.11n-2009 7.3.2.2 */</span>
<span class="cp">#define BSS_MEMBERSHIP_SELECTOR_HT_PHY	127</span>

<span class="cm">/* mgmt header + 1 byte category code */</span>
<span class="cp">#define IEEE80211_MIN_ACTION_SIZE offsetof(struct ieee80211_mgmt, u.action.u)</span>


<span class="cm">/* Management MIC information element (IEEE 802.11w) */</span>
<span class="k">struct</span> <span class="n">ieee80211_mmie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">element_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">key_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">sequence_number</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">mic</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_vendor_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">element_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">oui</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">oui_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Control frames */</span>
<span class="k">struct</span> <span class="n">ieee80211_rts</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ra</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ta</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_cts</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ra</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_pspoll</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">aid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ta</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* TDLS */</span>

<span class="cm">/* Link-id information element */</span>
<span class="k">struct</span> <span class="n">ieee80211_tdls_lnkie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">ie_type</span><span class="p">;</span> <span class="cm">/* Link Identifier IE */</span>
	<span class="n">u8</span> <span class="n">ie_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">init_sta</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">resp_sta</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_tdls_data</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">da</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">sa</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__be16</span> <span class="n">ether_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">category</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">action_code</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__packed</span> <span class="n">setup_req</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">status_code</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
			<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__packed</span> <span class="n">setup_resp</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">status_code</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__packed</span> <span class="n">setup_cfm</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__le16</span> <span class="n">reason_code</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__packed</span> <span class="n">teardown</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">dialog_token</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">variable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">__packed</span> <span class="n">discover_req</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_bar - HT Block Ack Request</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;HT BlockAckReq&quot; as</span>
<span class="cm"> * described in 802.11n draft section 7.2.1.7.1</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_bar</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration</span><span class="p">;</span>
	<span class="n">__u8</span> <span class="n">ra</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__u8</span> <span class="n">ta</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">control</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">start_seq_num</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* 802.11 BAR control masks */</span>
<span class="cp">#define IEEE80211_BAR_CTRL_ACK_POLICY_NORMAL	0x0000</span>
<span class="cp">#define IEEE80211_BAR_CTRL_MULTI_TID		0x0002</span>
<span class="cp">#define IEEE80211_BAR_CTRL_CBMTID_COMPRESSED_BA	0x0004</span>
<span class="cp">#define IEEE80211_BAR_CTRL_TID_INFO_MASK	0xf000</span>
<span class="cp">#define IEEE80211_BAR_CTRL_TID_INFO_SHIFT	12</span>

<span class="cp">#define IEEE80211_HT_MCS_MASK_LEN		10</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_mcs_info - MCS information</span>
<span class="cm"> * @rx_mask: RX mask</span>
<span class="cm"> * @rx_highest: highest supported RX rate. If set represents</span>
<span class="cm"> *	the highest supported RX data rate in units of 1 Mbps.</span>
<span class="cm"> *	If this field is 0 this value should not be used to</span>
<span class="cm"> *	consider the highest RX data rate supported.</span>
<span class="cm"> * @tx_params: TX parameters</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_mcs_info</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">rx_mask</span><span class="p">[</span><span class="n">IEEE80211_HT_MCS_MASK_LEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">rx_highest</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tx_params</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* 802.11n HT capability MSC set */</span>
<span class="cp">#define IEEE80211_HT_MCS_RX_HIGHEST_MASK	0x3ff</span>
<span class="cp">#define IEEE80211_HT_MCS_TX_DEFINED		0x01</span>
<span class="cp">#define IEEE80211_HT_MCS_TX_RX_DIFF		0x02</span>
<span class="cm">/* value 0 == 1 stream etc */</span>
<span class="cp">#define IEEE80211_HT_MCS_TX_MAX_STREAMS_MASK	0x0C</span>
<span class="cp">#define IEEE80211_HT_MCS_TX_MAX_STREAMS_SHIFT	2</span>
<span class="cp">#define		IEEE80211_HT_MCS_TX_MAX_STREAMS	4</span>
<span class="cp">#define IEEE80211_HT_MCS_TX_UNEQUAL_MODULATION	0x10</span>

<span class="cm">/*</span>
<span class="cm"> * 802.11n D5.0 20.3.5 / 20.6 says:</span>
<span class="cm"> * - indices 0 to 7 and 32 are single spatial stream</span>
<span class="cm"> * - 8 to 31 are multiple spatial streams using equal modulation</span>
<span class="cm"> *   [8..15 for two streams, 16..23 for three and 24..31 for four]</span>
<span class="cm"> * - remainder are multiple spatial streams using unequal modulation</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE80211_HT_MCS_UNEQUAL_MODULATION_START 33</span>
<span class="cp">#define IEEE80211_HT_MCS_UNEQUAL_MODULATION_START_BYTE \</span>
<span class="cp">	(IEEE80211_HT_MCS_UNEQUAL_MODULATION_START / 8)</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_ht_cap - HT capabilities</span>
<span class="cm"> *</span>
<span class="cm"> * This structure is the &quot;HT capabilities element&quot; as</span>
<span class="cm"> * described in 802.11n D5.0 7.3.2.57</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_ht_cap</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">cap_info</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ampdu_params_info</span><span class="p">;</span>

	<span class="cm">/* 16 bytes MCS information */</span>
	<span class="k">struct</span> <span class="n">ieee80211_mcs_info</span> <span class="n">mcs</span><span class="p">;</span>

	<span class="n">__le16</span> <span class="n">extended_ht_cap_info</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_BF_cap_info</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">antenna_selection_info</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* 802.11n HT capabilities masks (for cap_info) */</span>
<span class="cp">#define IEEE80211_HT_CAP_LDPC_CODING		0x0001</span>
<span class="cp">#define IEEE80211_HT_CAP_SUP_WIDTH_20_40	0x0002</span>
<span class="cp">#define IEEE80211_HT_CAP_SM_PS			0x000C</span>
<span class="cp">#define		IEEE80211_HT_CAP_SM_PS_SHIFT	2</span>
<span class="cp">#define IEEE80211_HT_CAP_GRN_FLD		0x0010</span>
<span class="cp">#define IEEE80211_HT_CAP_SGI_20			0x0020</span>
<span class="cp">#define IEEE80211_HT_CAP_SGI_40			0x0040</span>
<span class="cp">#define IEEE80211_HT_CAP_TX_STBC		0x0080</span>
<span class="cp">#define IEEE80211_HT_CAP_RX_STBC		0x0300</span>
<span class="cp">#define		IEEE80211_HT_CAP_RX_STBC_SHIFT	8</span>
<span class="cp">#define IEEE80211_HT_CAP_DELAY_BA		0x0400</span>
<span class="cp">#define IEEE80211_HT_CAP_MAX_AMSDU		0x0800</span>
<span class="cp">#define IEEE80211_HT_CAP_DSSSCCK40		0x1000</span>
<span class="cp">#define IEEE80211_HT_CAP_RESERVED		0x2000</span>
<span class="cp">#define IEEE80211_HT_CAP_40MHZ_INTOLERANT	0x4000</span>
<span class="cp">#define IEEE80211_HT_CAP_LSIG_TXOP_PROT		0x8000</span>

<span class="cm">/* 802.11n HT extended capabilities masks (for extended_ht_cap_info) */</span>
<span class="cp">#define IEEE80211_HT_EXT_CAP_PCO		0x0001</span>
<span class="cp">#define IEEE80211_HT_EXT_CAP_PCO_TIME		0x0006</span>
<span class="cp">#define		IEEE80211_HT_EXT_CAP_PCO_TIME_SHIFT	1</span>
<span class="cp">#define IEEE80211_HT_EXT_CAP_MCS_FB		0x0300</span>
<span class="cp">#define		IEEE80211_HT_EXT_CAP_MCS_FB_SHIFT	8</span>
<span class="cp">#define IEEE80211_HT_EXT_CAP_HTC_SUP		0x0400</span>
<span class="cp">#define IEEE80211_HT_EXT_CAP_RD_RESPONDER	0x0800</span>

<span class="cm">/* 802.11n HT capability AMPDU settings (for ampdu_params_info) */</span>
<span class="cp">#define IEEE80211_HT_AMPDU_PARM_FACTOR		0x03</span>
<span class="cp">#define IEEE80211_HT_AMPDU_PARM_DENSITY		0x1C</span>
<span class="cp">#define		IEEE80211_HT_AMPDU_PARM_DENSITY_SHIFT	2</span>

<span class="cm">/*</span>
<span class="cm"> * Maximum length of AMPDU that the STA can receive.</span>
<span class="cm"> * Length = 2 ^ (13 + max_ampdu_length_exp) - 1 (octets)</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">ieee80211_max_ampdu_length_exp</span> <span class="p">{</span>
	<span class="n">IEEE80211_HT_MAX_AMPDU_8K</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">IEEE80211_HT_MAX_AMPDU_16K</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IEEE80211_HT_MAX_AMPDU_32K</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">IEEE80211_HT_MAX_AMPDU_64K</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>

<span class="cp">#define IEEE80211_HT_MAX_AMPDU_FACTOR 13</span>

<span class="cm">/* Minimum MPDU start spacing */</span>
<span class="k">enum</span> <span class="n">ieee80211_min_mpdu_spacing</span> <span class="p">{</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>	<span class="cm">/* No restriction */</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_0_25</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/* 1/4 usec */</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_0_5</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>	<span class="cm">/* 1/2 usec */</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_1</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>	<span class="cm">/* 1 usec */</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_2</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>	<span class="cm">/* 2 usec */</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_4</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>	<span class="cm">/* 4 usec */</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_8</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>	<span class="cm">/* 8 usec */</span>
	<span class="n">IEEE80211_HT_MPDU_DENSITY_16</span> <span class="o">=</span> <span class="mi">7</span>	<span class="cm">/* 16 usec */</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_ht_operation - HT operation IE</span>
<span class="cm"> *</span>
<span class="cm"> * This structure is the &quot;HT operation element&quot; as</span>
<span class="cm"> * described in 802.11n-2009 7.3.2.57</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_ht_operation</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">primary_chan</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ht_param</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">operation_mode</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">stbc_param</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">basic_set</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* for ht_param */</span>
<span class="cp">#define IEEE80211_HT_PARAM_CHA_SEC_OFFSET		0x03</span>
<span class="cp">#define		IEEE80211_HT_PARAM_CHA_SEC_NONE		0x00</span>
<span class="cp">#define		IEEE80211_HT_PARAM_CHA_SEC_ABOVE	0x01</span>
<span class="cp">#define		IEEE80211_HT_PARAM_CHA_SEC_BELOW	0x03</span>
<span class="cp">#define IEEE80211_HT_PARAM_CHAN_WIDTH_ANY		0x04</span>
<span class="cp">#define IEEE80211_HT_PARAM_RIFS_MODE			0x08</span>

<span class="cm">/* for operation_mode */</span>
<span class="cp">#define IEEE80211_HT_OP_MODE_PROTECTION			0x0003</span>
<span class="cp">#define		IEEE80211_HT_OP_MODE_PROTECTION_NONE		0</span>
<span class="cp">#define		IEEE80211_HT_OP_MODE_PROTECTION_NONMEMBER	1</span>
<span class="cp">#define		IEEE80211_HT_OP_MODE_PROTECTION_20MHZ		2</span>
<span class="cp">#define		IEEE80211_HT_OP_MODE_PROTECTION_NONHT_MIXED	3</span>
<span class="cp">#define IEEE80211_HT_OP_MODE_NON_GF_STA_PRSNT		0x0004</span>
<span class="cp">#define IEEE80211_HT_OP_MODE_NON_HT_STA_PRSNT		0x0010</span>

<span class="cm">/* for stbc_param */</span>
<span class="cp">#define IEEE80211_HT_STBC_PARAM_DUAL_BEACON		0x0040</span>
<span class="cp">#define IEEE80211_HT_STBC_PARAM_DUAL_CTS_PROT		0x0080</span>
<span class="cp">#define IEEE80211_HT_STBC_PARAM_STBC_BEACON		0x0100</span>
<span class="cp">#define IEEE80211_HT_STBC_PARAM_LSIG_TXOP_FULLPROT	0x0200</span>
<span class="cp">#define IEEE80211_HT_STBC_PARAM_PCO_ACTIVE		0x0400</span>
<span class="cp">#define IEEE80211_HT_STBC_PARAM_PCO_PHASE		0x0800</span>


<span class="cm">/* block-ack parameters */</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_POLICY_MASK 0x0002</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_TID_MASK 0x003C</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_BUF_SIZE_MASK 0xFFC0</span>
<span class="cp">#define IEEE80211_DELBA_PARAM_TID_MASK 0xF000</span>
<span class="cp">#define IEEE80211_DELBA_PARAM_INITIATOR_MASK 0x0800</span>

<span class="cm">/*</span>
<span class="cm"> * A-PMDU buffer sizes</span>
<span class="cm"> * According to IEEE802.11n spec size varies from 8K to 64K (in powers of 2)</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE80211_MIN_AMPDU_BUF 0x8</span>
<span class="cp">#define IEEE80211_MAX_AMPDU_BUF 0x40</span>


<span class="cm">/* Spatial Multiplexing Power Save Modes (for capability) */</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_STATIC	0</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_DYNAMIC	1</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_INVALID	2</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_DISABLED	3</span>

<span class="cm">/* for SM power control field lower two bits */</span>
<span class="cp">#define WLAN_HT_SMPS_CONTROL_DISABLED	0</span>
<span class="cp">#define WLAN_HT_SMPS_CONTROL_STATIC	1</span>
<span class="cp">#define WLAN_HT_SMPS_CONTROL_DYNAMIC	3</span>

<span class="cm">/* Authentication algorithms */</span>
<span class="cp">#define WLAN_AUTH_OPEN 0</span>
<span class="cp">#define WLAN_AUTH_SHARED_KEY 1</span>
<span class="cp">#define WLAN_AUTH_FT 2</span>
<span class="cp">#define WLAN_AUTH_SAE 3</span>
<span class="cp">#define WLAN_AUTH_LEAP 128</span>

<span class="cp">#define WLAN_AUTH_CHALLENGE_LEN 128</span>

<span class="cp">#define WLAN_CAPABILITY_ESS		(1&lt;&lt;0)</span>
<span class="cp">#define WLAN_CAPABILITY_IBSS		(1&lt;&lt;1)</span>

<span class="cm">/*</span>
<span class="cm"> * A mesh STA sets the ESS and IBSS capability bits to zero.</span>
<span class="cm"> * however, this holds true for p2p probe responses (in the p2p_find</span>
<span class="cm"> * phase) as well.</span>
<span class="cm"> */</span>
<span class="cp">#define WLAN_CAPABILITY_IS_STA_BSS(cap)	\</span>
<span class="cp">	(!((cap) &amp; (WLAN_CAPABILITY_ESS | WLAN_CAPABILITY_IBSS)))</span>

<span class="cp">#define WLAN_CAPABILITY_CF_POLLABLE	(1&lt;&lt;2)</span>
<span class="cp">#define WLAN_CAPABILITY_CF_POLL_REQUEST	(1&lt;&lt;3)</span>
<span class="cp">#define WLAN_CAPABILITY_PRIVACY		(1&lt;&lt;4)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_PREAMBLE	(1&lt;&lt;5)</span>
<span class="cp">#define WLAN_CAPABILITY_PBCC		(1&lt;&lt;6)</span>
<span class="cp">#define WLAN_CAPABILITY_CHANNEL_AGILITY	(1&lt;&lt;7)</span>

<span class="cm">/* 802.11h */</span>
<span class="cp">#define WLAN_CAPABILITY_SPECTRUM_MGMT	(1&lt;&lt;8)</span>
<span class="cp">#define WLAN_CAPABILITY_QOS		(1&lt;&lt;9)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_SLOT_TIME	(1&lt;&lt;10)</span>
<span class="cp">#define WLAN_CAPABILITY_DSSS_OFDM	(1&lt;&lt;13)</span>
<span class="cm">/* measurement */</span>
<span class="cp">#define IEEE80211_SPCT_MSR_RPRT_MODE_LATE	(1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_SPCT_MSR_RPRT_MODE_INCAPABLE	(1&lt;&lt;1)</span>
<span class="cp">#define IEEE80211_SPCT_MSR_RPRT_MODE_REFUSED	(1&lt;&lt;2)</span>

<span class="cp">#define IEEE80211_SPCT_MSR_RPRT_TYPE_BASIC	0</span>
<span class="cp">#define IEEE80211_SPCT_MSR_RPRT_TYPE_CCA	1</span>
<span class="cp">#define IEEE80211_SPCT_MSR_RPRT_TYPE_RPI	2</span>


<span class="cm">/* 802.11g ERP information element */</span>
<span class="cp">#define WLAN_ERP_NON_ERP_PRESENT (1&lt;&lt;0)</span>
<span class="cp">#define WLAN_ERP_USE_PROTECTION (1&lt;&lt;1)</span>
<span class="cp">#define WLAN_ERP_BARKER_PREAMBLE (1&lt;&lt;2)</span>

<span class="cm">/* WLAN_ERP_BARKER_PREAMBLE values */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">WLAN_ERP_PREAMBLE_SHORT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_ERP_PREAMBLE_LONG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Status codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_statuscode</span> <span class="p">{</span>
	<span class="n">WLAN_STATUS_SUCCESS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_UNSPECIFIED_FAILURE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_CAPS_UNSUPPORTED</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_REASSOC_NO_ASSOC</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_UNSPEC</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_NOT_SUPPORTED_AUTH_ALG</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_UNKNOWN_AUTH_TRANSACTION</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_CHALLENGE_FAIL</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_AUTH_TIMEOUT</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_AP_UNABLE_TO_HANDLE_NEW_STA</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_RATES</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="cm">/* 802.11b */</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOSHORTPREAMBLE</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOPBCC</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOAGILITY</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="cm">/* 802.11h */</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOSPECTRUM</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_REJECTED_BAD_POWER</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_REJECTED_BAD_SUPP_CHAN</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
	<span class="cm">/* 802.11g */</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOSHORTTIME</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NODSSSOFDM</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
	<span class="cm">/* 802.11w */</span>
	<span class="n">WLAN_STATUS_ASSOC_REJECTED_TEMPORARILY</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ROBUST_MGMT_FRAME_POLICY_VIOLATION</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
	<span class="cm">/* 802.11i */</span>
	<span class="n">WLAN_STATUS_INVALID_IE</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_GROUP_CIPHER</span> <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_PAIRWISE_CIPHER</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_AKMP</span> <span class="o">=</span> <span class="mi">43</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_UNSUPP_RSN_VERSION</span> <span class="o">=</span> <span class="mi">44</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_RSN_IE_CAP</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_CIPHER_SUITE_REJECTED</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span>
	<span class="cm">/* 802.11e */</span>
	<span class="n">WLAN_STATUS_UNSPECIFIED_QOS</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOBANDWIDTH</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_LOWACK</span> <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_UNSUPP_QOS</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_REQUEST_DECLINED</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_QOS_PARAM</span> <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_CHANGE_TSPEC</span> <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_WAIT_TS_DELAY</span> <span class="o">=</span> <span class="mi">47</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_NO_DIRECT_LINK</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_STA_NOT_PRESENT</span> <span class="o">=</span> <span class="mi">49</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_STA_NOT_QSTA</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
	<span class="cm">/* 802.11s */</span>
	<span class="n">WLAN_STATUS_ANTI_CLOG_REQUIRED</span> <span class="o">=</span> <span class="mi">76</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_FCG_NOT_SUPP</span> <span class="o">=</span> <span class="mi">78</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_STA_NO_TBTT</span> <span class="o">=</span> <span class="mi">78</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/* Reason codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_reasoncode</span> <span class="p">{</span>
	<span class="n">WLAN_REASON_UNSPECIFIED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_REASON_PREV_AUTH_NOT_VALID</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DEAUTH_LEAVING</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_DUE_TO_INACTIVITY</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_AP_BUSY</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">WLAN_REASON_CLASS2_FRAME_FROM_NONAUTH_STA</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">WLAN_REASON_CLASS3_FRAME_FROM_NONASSOC_STA</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_STA_HAS_LEFT</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">WLAN_REASON_STA_REQ_ASSOC_WITHOUT_AUTH</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="cm">/* 802.11h */</span>
	<span class="n">WLAN_REASON_DISASSOC_BAD_POWER</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_BAD_SUPP_CHAN</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="cm">/* 802.11i */</span>
	<span class="n">WLAN_REASON_INVALID_IE</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MIC_FAILURE</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">WLAN_REASON_4WAY_HANDSHAKE_TIMEOUT</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">WLAN_REASON_GROUP_KEY_HANDSHAKE_TIMEOUT</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">WLAN_REASON_IE_DIFFERENT</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_GROUP_CIPHER</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_PAIRWISE_CIPHER</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_AKMP</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">WLAN_REASON_UNSUPP_RSN_VERSION</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_RSN_IE_CAP</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">WLAN_REASON_IEEE8021X_FAILED</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">WLAN_REASON_CIPHER_SUITE_REJECTED</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
	<span class="cm">/* 802.11e */</span>
	<span class="n">WLAN_REASON_DISASSOC_UNSPECIFIED_QOS</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_QAP_NO_BANDWIDTH</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_LOW_ACK</span> <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_QAP_EXCEED_TXOP</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">WLAN_REASON_QSTA_LEAVE_QBSS</span> <span class="o">=</span> <span class="mi">36</span><span class="p">,</span>
	<span class="n">WLAN_REASON_QSTA_NOT_USE</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">WLAN_REASON_QSTA_REQUIRE_SETUP</span> <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">WLAN_REASON_QSTA_TIMEOUT</span> <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>
	<span class="n">WLAN_REASON_QSTA_CIPHER_NOT_SUPP</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	<span class="cm">/* 802.11s */</span>
	<span class="n">WLAN_REASON_MESH_PEER_CANCELED</span> <span class="o">=</span> <span class="mi">52</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_MAX_PEERS</span> <span class="o">=</span> <span class="mi">53</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_CONFIG</span> <span class="o">=</span> <span class="mi">54</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_CLOSE</span> <span class="o">=</span> <span class="mi">55</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_MAX_RETRIES</span> <span class="o">=</span> <span class="mi">56</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_CONFIRM_TIMEOUT</span> <span class="o">=</span> <span class="mi">57</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_INVALID_GTK</span> <span class="o">=</span> <span class="mi">58</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_INCONSISTENT_PARAM</span> <span class="o">=</span> <span class="mi">59</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_INVALID_SECURITY</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_PATH_ERROR</span> <span class="o">=</span> <span class="mi">61</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_PATH_NOFORWARD</span> <span class="o">=</span> <span class="mi">62</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_PATH_DEST_UNREACHABLE</span> <span class="o">=</span> <span class="mi">63</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MAC_EXISTS_IN_MBSS</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_CHAN_REGULATORY</span> <span class="o">=</span> <span class="mi">65</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MESH_CHAN</span> <span class="o">=</span> <span class="mi">66</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/* Information Element IDs */</span>
<span class="k">enum</span> <span class="n">ieee80211_eid</span> <span class="p">{</span>
	<span class="n">WLAN_EID_SSID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_EID_SUPP_RATES</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_EID_FH_PARAMS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_EID_DS_PARAMS</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_EID_CF_PARAMS</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WLAN_EID_TIM</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">WLAN_EID_IBSS_PARAMS</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">WLAN_EID_CHALLENGE</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>

	<span class="n">WLAN_EID_COUNTRY</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">WLAN_EID_HP_PARAMS</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">WLAN_EID_HP_TABLE</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">WLAN_EID_REQUEST</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>

	<span class="n">WLAN_EID_QBSS_LOAD</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">WLAN_EID_EDCA_PARAM_SET</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">WLAN_EID_TSPEC</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">WLAN_EID_TCLAS</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">WLAN_EID_SCHEDULE</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">WLAN_EID_TS_DELAY</span> <span class="o">=</span> <span class="mi">43</span><span class="p">,</span>
	<span class="n">WLAN_EID_TCLAS_PROCESSING</span> <span class="o">=</span> <span class="mi">44</span><span class="p">,</span>
	<span class="n">WLAN_EID_QOS_CAPA</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span>
	<span class="cm">/* 802.11z */</span>
	<span class="n">WLAN_EID_LINK_ID</span> <span class="o">=</span> <span class="mi">101</span><span class="p">,</span>
	<span class="cm">/* 802.11s */</span>
	<span class="n">WLAN_EID_MESH_CONFIG</span> <span class="o">=</span> <span class="mi">113</span><span class="p">,</span>
	<span class="n">WLAN_EID_MESH_ID</span> <span class="o">=</span> <span class="mi">114</span><span class="p">,</span>
	<span class="n">WLAN_EID_LINK_METRIC_REPORT</span> <span class="o">=</span> <span class="mi">115</span><span class="p">,</span>
	<span class="n">WLAN_EID_CONGESTION_NOTIFICATION</span> <span class="o">=</span> <span class="mi">116</span><span class="p">,</span>
	<span class="n">WLAN_EID_PEER_MGMT</span> <span class="o">=</span> <span class="mi">117</span><span class="p">,</span>
	<span class="n">WLAN_EID_CHAN_SWITCH_PARAM</span> <span class="o">=</span> <span class="mi">118</span><span class="p">,</span>
	<span class="n">WLAN_EID_MESH_AWAKE_WINDOW</span> <span class="o">=</span> <span class="mi">119</span><span class="p">,</span>
	<span class="n">WLAN_EID_BEACON_TIMING</span> <span class="o">=</span> <span class="mi">120</span><span class="p">,</span>
	<span class="n">WLAN_EID_MCCAOP_SETUP_REQ</span> <span class="o">=</span> <span class="mi">121</span><span class="p">,</span>
	<span class="n">WLAN_EID_MCCAOP_SETUP_RESP</span> <span class="o">=</span> <span class="mi">122</span><span class="p">,</span>
	<span class="n">WLAN_EID_MCCAOP_ADVERT</span> <span class="o">=</span> <span class="mi">123</span><span class="p">,</span>
	<span class="n">WLAN_EID_MCCAOP_TEARDOWN</span> <span class="o">=</span> <span class="mi">124</span><span class="p">,</span>
	<span class="n">WLAN_EID_GANN</span> <span class="o">=</span> <span class="mi">125</span><span class="p">,</span>
	<span class="n">WLAN_EID_RANN</span> <span class="o">=</span> <span class="mi">126</span><span class="p">,</span>
	<span class="n">WLAN_EID_PREQ</span> <span class="o">=</span> <span class="mi">130</span><span class="p">,</span>
	<span class="n">WLAN_EID_PREP</span> <span class="o">=</span> <span class="mi">131</span><span class="p">,</span>
	<span class="n">WLAN_EID_PERR</span> <span class="o">=</span> <span class="mi">132</span><span class="p">,</span>
	<span class="n">WLAN_EID_PXU</span> <span class="o">=</span> <span class="mi">137</span><span class="p">,</span>
	<span class="n">WLAN_EID_PXUC</span> <span class="o">=</span> <span class="mi">138</span><span class="p">,</span>
	<span class="n">WLAN_EID_AUTH_MESH_PEER_EXCH</span> <span class="o">=</span> <span class="mi">139</span><span class="p">,</span>
	<span class="n">WLAN_EID_MIC</span> <span class="o">=</span> <span class="mi">140</span><span class="p">,</span>

	<span class="n">WLAN_EID_PWR_CONSTRAINT</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">WLAN_EID_PWR_CAPABILITY</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">WLAN_EID_TPC_REQUEST</span> <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">WLAN_EID_TPC_REPORT</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">WLAN_EID_SUPPORTED_CHANNELS</span> <span class="o">=</span> <span class="mi">36</span><span class="p">,</span>
	<span class="n">WLAN_EID_CHANNEL_SWITCH</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">WLAN_EID_MEASURE_REQUEST</span> <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">WLAN_EID_MEASURE_REPORT</span> <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>
	<span class="n">WLAN_EID_QUIET</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
	<span class="n">WLAN_EID_IBSS_DFS</span> <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>

	<span class="n">WLAN_EID_ERP_INFO</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">WLAN_EID_EXT_SUPP_RATES</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>

	<span class="n">WLAN_EID_HT_CAPABILITY</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	<span class="n">WLAN_EID_HT_OPERATION</span> <span class="o">=</span> <span class="mi">61</span><span class="p">,</span>

	<span class="n">WLAN_EID_RSN</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
	<span class="n">WLAN_EID_MMIE</span> <span class="o">=</span> <span class="mi">76</span><span class="p">,</span>
	<span class="n">WLAN_EID_WPA</span> <span class="o">=</span> <span class="mi">221</span><span class="p">,</span>
	<span class="n">WLAN_EID_GENERIC</span> <span class="o">=</span> <span class="mi">221</span><span class="p">,</span>
	<span class="n">WLAN_EID_VENDOR_SPECIFIC</span> <span class="o">=</span> <span class="mi">221</span><span class="p">,</span>
	<span class="n">WLAN_EID_QOS_PARAMETER</span> <span class="o">=</span> <span class="mi">222</span><span class="p">,</span>

	<span class="n">WLAN_EID_AP_CHAN_REPORT</span> <span class="o">=</span> <span class="mi">51</span><span class="p">,</span>
	<span class="n">WLAN_EID_NEIGHBOR_REPORT</span> <span class="o">=</span> <span class="mi">52</span><span class="p">,</span>
	<span class="n">WLAN_EID_RCPI</span> <span class="o">=</span> <span class="mi">53</span><span class="p">,</span>
	<span class="n">WLAN_EID_BSS_AVG_ACCESS_DELAY</span> <span class="o">=</span> <span class="mi">63</span><span class="p">,</span>
	<span class="n">WLAN_EID_ANTENNA_INFO</span> <span class="o">=</span> <span class="mi">64</span><span class="p">,</span>
	<span class="n">WLAN_EID_RSNI</span> <span class="o">=</span> <span class="mi">65</span><span class="p">,</span>
	<span class="n">WLAN_EID_MEASUREMENT_PILOT_TX_INFO</span> <span class="o">=</span> <span class="mi">66</span><span class="p">,</span>
	<span class="n">WLAN_EID_BSS_AVAILABLE_CAPACITY</span> <span class="o">=</span> <span class="mi">67</span><span class="p">,</span>
	<span class="n">WLAN_EID_BSS_AC_ACCESS_DELAY</span> <span class="o">=</span> <span class="mi">68</span><span class="p">,</span>
	<span class="n">WLAN_EID_RRM_ENABLED_CAPABILITIES</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span>
	<span class="n">WLAN_EID_MULTIPLE_BSSID</span> <span class="o">=</span> <span class="mi">71</span><span class="p">,</span>
	<span class="n">WLAN_EID_BSS_COEX_2040</span> <span class="o">=</span> <span class="mi">72</span><span class="p">,</span>
	<span class="n">WLAN_EID_OVERLAP_BSS_SCAN_PARAM</span> <span class="o">=</span> <span class="mi">74</span><span class="p">,</span>
	<span class="n">WLAN_EID_EXT_CAPABILITY</span> <span class="o">=</span> <span class="mi">127</span><span class="p">,</span>

	<span class="n">WLAN_EID_MOBILITY_DOMAIN</span> <span class="o">=</span> <span class="mi">54</span><span class="p">,</span>
	<span class="n">WLAN_EID_FAST_BSS_TRANSITION</span> <span class="o">=</span> <span class="mi">55</span><span class="p">,</span>
	<span class="n">WLAN_EID_TIMEOUT_INTERVAL</span> <span class="o">=</span> <span class="mi">56</span><span class="p">,</span>
	<span class="n">WLAN_EID_RIC_DATA</span> <span class="o">=</span> <span class="mi">57</span><span class="p">,</span>
	<span class="n">WLAN_EID_RIC_DESCRIPTOR</span> <span class="o">=</span> <span class="mi">75</span><span class="p">,</span>

	<span class="n">WLAN_EID_DSE_REGISTERED_LOCATION</span> <span class="o">=</span> <span class="mi">58</span><span class="p">,</span>
	<span class="n">WLAN_EID_SUPPORTED_REGULATORY_CLASSES</span> <span class="o">=</span> <span class="mi">59</span><span class="p">,</span>
	<span class="n">WLAN_EID_EXT_CHANSWITCH_ANN</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Action category code */</span>
<span class="k">enum</span> <span class="n">ieee80211_category</span> <span class="p">{</span>
	<span class="n">WLAN_CATEGORY_SPECTRUM_MGMT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_QOS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_DLS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_BACK</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_PUBLIC</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_HT</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_SA_QUERY</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_PROTECTED_DUAL_OF_ACTION</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_TDLS</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_MESH_ACTION</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_MULTIHOP_ACTION</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_SELF_PROTECTED</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_WMM</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_VENDOR_SPECIFIC_PROTECTED</span> <span class="o">=</span> <span class="mi">126</span><span class="p">,</span>
	<span class="n">WLAN_CATEGORY_VENDOR_SPECIFIC</span> <span class="o">=</span> <span class="mi">127</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* SPECTRUM_MGMT action code */</span>
<span class="k">enum</span> <span class="n">ieee80211_spectrum_mgmt_actioncode</span> <span class="p">{</span>
	<span class="n">WLAN_ACTION_SPCT_MSR_REQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_ACTION_SPCT_MSR_RPRT</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_ACTION_SPCT_TPC_REQ</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_ACTION_SPCT_TPC_RPRT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_ACTION_SPCT_CHL_SWITCH</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* HT action codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_ht_actioncode</span> <span class="p">{</span>
	<span class="n">WLAN_HT_ACTION_NOTIFY_CHANWIDTH</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_HT_ACTION_SMPS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_HT_ACTION_PSMP</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_HT_ACTION_PCO_PHASE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_HT_ACTION_CSI</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WLAN_HT_ACTION_NONCOMPRESSED_BF</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">WLAN_HT_ACTION_COMPRESSED_BF</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">WLAN_HT_ACTION_ASEL_IDX_FEEDBACK</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Self Protected Action codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_self_protected_actioncode</span> <span class="p">{</span>
	<span class="n">WLAN_SP_RESERVED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_SP_MESH_PEERING_OPEN</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_SP_MESH_PEERING_CONFIRM</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_SP_MESH_PEERING_CLOSE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_SP_MGK_INFORM</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WLAN_SP_MGK_ACK</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Mesh action codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_mesh_actioncode</span> <span class="p">{</span>
	<span class="n">WLAN_MESH_ACTION_LINK_METRIC_REPORT</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_HWMP_PATH_SELECTION</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_GATE_ANNOUNCEMENT</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_CONGESTION_CONTROL_NOTIFICATION</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_MCCA_SETUP_REQUEST</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_MCCA_SETUP_REPLY</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_MCCA_ADVERTISEMENT_REQUEST</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_MCCA_ADVERTISEMENT</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_MCCA_TEARDOWN</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_TBTT_ADJUSTMENT_REQUEST</span><span class="p">,</span>
	<span class="n">WLAN_MESH_ACTION_TBTT_ADJUSTMENT_RESPONSE</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Security key length */</span>
<span class="k">enum</span> <span class="n">ieee80211_key_len</span> <span class="p">{</span>
	<span class="n">WLAN_KEY_LEN_WEP40</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">WLAN_KEY_LEN_WEP104</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">WLAN_KEY_LEN_CCMP</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">WLAN_KEY_LEN_TKIP</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">WLAN_KEY_LEN_AES_CMAC</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Public action codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_pub_actioncode</span> <span class="p">{</span>
	<span class="n">WLAN_PUB_ACTION_TDLS_DISCOVER_RES</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* TDLS action codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_tdls_actioncode</span> <span class="p">{</span>
	<span class="n">WLAN_TDLS_SETUP_REQUEST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_SETUP_RESPONSE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_SETUP_CONFIRM</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_TEARDOWN</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_PEER_TRAFFIC_INDICATION</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_CHANNEL_SWITCH_REQUEST</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_CHANNEL_SWITCH_RESPONSE</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_PEER_PSM_REQUEST</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_PEER_PSM_RESPONSE</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_PEER_TRAFFIC_RESPONSE</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">WLAN_TDLS_DISCOVERY_REQUEST</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * TDLS capabililites to be enabled in the 5th byte of the</span>
<span class="cm"> * @WLAN_EID_EXT_CAPABILITY information element</span>
<span class="cm"> */</span>
<span class="cp">#define WLAN_EXT_CAPA5_TDLS_ENABLED	BIT(5)</span>
<span class="cp">#define WLAN_EXT_CAPA5_TDLS_PROHIBITED	BIT(6)</span>

<span class="cm">/* TDLS specific payload type in the LLC/SNAP header */</span>
<span class="cp">#define WLAN_TDLS_SNAP_RFTYPE	0x2</span>

<span class="cm">/**</span>
<span class="cm"> * enum - mesh synchronization method identifier</span>
<span class="cm"> *</span>
<span class="cm"> * @IEEE80211_SYNC_METHOD_NEIGHBOR_OFFSET: the default synchronization method</span>
<span class="cm"> * @IEEE80211_SYNC_METHOD_VENDOR: a vendor specific synchronization method</span>
<span class="cm"> * that will be specified in a vendor specific information element</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">IEEE80211_SYNC_METHOD_NEIGHBOR_OFFSET</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IEEE80211_SYNC_METHOD_VENDOR</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * enum - mesh path selection protocol identifier</span>
<span class="cm"> *</span>
<span class="cm"> * @IEEE80211_PATH_PROTOCOL_HWMP: the default path selection protocol</span>
<span class="cm"> * @IEEE80211_PATH_PROTOCOL_VENDOR: a vendor specific protocol that will</span>
<span class="cm"> * be specified in a vendor specific information element</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">IEEE80211_PATH_PROTOCOL_HWMP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IEEE80211_PATH_PROTOCOL_VENDOR</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * enum - mesh path selection metric identifier</span>
<span class="cm"> *</span>
<span class="cm"> * @IEEE80211_PATH_METRIC_AIRTIME: the default path selection metric</span>
<span class="cm"> * @IEEE80211_PATH_METRIC_VENDOR: a vendor specific metric that will be</span>
<span class="cm"> * specified in a vendor specific information element</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">IEEE80211_PATH_METRIC_AIRTIME</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IEEE80211_PATH_METRIC_VENDOR</span> <span class="o">=</span> <span class="mi">255</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/*</span>
<span class="cm"> * IEEE 802.11-2007 7.3.2.9 Country information element</span>
<span class="cm"> *</span>
<span class="cm"> * Minimum length is 8 octets, ie len must be evenly</span>
<span class="cm"> * divisible by 2</span>
<span class="cm"> */</span>

<span class="cm">/* Although the spec says 8 I&#39;m seeing 6 in practice */</span>
<span class="cp">#define IEEE80211_COUNTRY_IE_MIN_LEN	6</span>

<span class="cm">/* The Country String field of the element shall be 3 octets in length */</span>
<span class="cp">#define IEEE80211_COUNTRY_STRING_LEN	3</span>

<span class="cm">/*</span>
<span class="cm"> * For regulatory extension stuff see IEEE 802.11-2007</span>
<span class="cm"> * Annex I (page 1141) and Annex J (page 1147). Also</span>
<span class="cm"> * review 7.3.2.9.</span>
<span class="cm"> *</span>
<span class="cm"> * When dot11RegulatoryClassesRequired is true and the</span>
<span class="cm"> * first_channel/reg_extension_id is &gt;= 201 then the IE</span>
<span class="cm"> * compromises of the &#39;ext&#39; struct represented below:</span>
<span class="cm"> *</span>
<span class="cm"> *  - Regulatory extension ID - when generating IE this just needs</span>
<span class="cm"> *    to be monotonically increasing for each triplet passed in</span>
<span class="cm"> *    the IE</span>
<span class="cm"> *  - Regulatory class - index into set of rules</span>
<span class="cm"> *  - Coverage class - index into air propagation time (Table 7-27),</span>
<span class="cm"> *    in microseconds, you can compute the air propagation time from</span>
<span class="cm"> *    the index by multiplying by 3, so index 10 yields a propagation</span>
<span class="cm"> *    of 10 us. Valid values are 0-31, values 32-255 are not defined</span>
<span class="cm"> *    yet. A value of 0 inicates air propagation of &lt;= 1 us.</span>
<span class="cm"> *</span>
<span class="cm"> *  See also Table I.2 for Emission limit sets and table</span>
<span class="cm"> *  I.3 for Behavior limit sets. Table J.1 indicates how to map</span>
<span class="cm"> *  a reg_class to an emission limit set and behavior limit set.</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE80211_COUNTRY_EXTENSION_ID 201</span>

<span class="cm">/*</span>
<span class="cm"> *  Channels numbers in the IE must be monotonically increasing</span>
<span class="cm"> *  if dot11RegulatoryClassesRequired is not true.</span>
<span class="cm"> *</span>
<span class="cm"> *  If dot11RegulatoryClassesRequired is true consecutive</span>
<span class="cm"> *  subband triplets following a regulatory triplet shall</span>
<span class="cm"> *  have monotonically increasing first_channel number fields.</span>
<span class="cm"> *</span>
<span class="cm"> *  Channel numbers shall not overlap.</span>
<span class="cm"> *</span>
<span class="cm"> *  Note that max_power is signed.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_country_ie_triplet</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">first_channel</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">num_channels</span><span class="p">;</span>
			<span class="n">s8</span> <span class="n">max_power</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">chans</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">reg_extension_id</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">reg_class</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">coverage_class</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">))</span> <span class="n">ext</span><span class="p">;</span>
	<span class="p">};</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">enum</span> <span class="n">ieee80211_timeout_interval_type</span> <span class="p">{</span>
	<span class="n">WLAN_TIMEOUT_REASSOC_DEADLINE</span> <span class="o">=</span> <span class="mi">1</span> <span class="cm">/* 802.11r */</span><span class="p">,</span>
	<span class="n">WLAN_TIMEOUT_KEY_LIFETIME</span> <span class="o">=</span> <span class="mi">2</span> <span class="cm">/* 802.11r */</span><span class="p">,</span>
	<span class="n">WLAN_TIMEOUT_ASSOC_COMEBACK</span> <span class="o">=</span> <span class="mi">3</span> <span class="cm">/* 802.11w */</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* BACK action code */</span>
<span class="k">enum</span> <span class="n">ieee80211_back_actioncode</span> <span class="p">{</span>
	<span class="n">WLAN_ACTION_ADDBA_REQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_ACTION_ADDBA_RESP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_ACTION_DELBA</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* BACK (block-ack) parties */</span>
<span class="k">enum</span> <span class="n">ieee80211_back_parties</span> <span class="p">{</span>
	<span class="n">WLAN_BACK_RECIPIENT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_BACK_INITIATOR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* SA Query action */</span>
<span class="k">enum</span> <span class="n">ieee80211_sa_query_action</span> <span class="p">{</span>
	<span class="n">WLAN_ACTION_SA_QUERY_REQUEST</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_ACTION_SA_QUERY_RESPONSE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>


<span class="cm">/* cipher suite selectors */</span>
<span class="cp">#define WLAN_CIPHER_SUITE_USE_GROUP	0x000FAC00</span>
<span class="cp">#define WLAN_CIPHER_SUITE_WEP40		0x000FAC01</span>
<span class="cp">#define WLAN_CIPHER_SUITE_TKIP		0x000FAC02</span>
<span class="cm">/* reserved: 				0x000FAC03 */</span>
<span class="cp">#define WLAN_CIPHER_SUITE_CCMP		0x000FAC04</span>
<span class="cp">#define WLAN_CIPHER_SUITE_WEP104	0x000FAC05</span>
<span class="cp">#define WLAN_CIPHER_SUITE_AES_CMAC	0x000FAC06</span>

<span class="cp">#define WLAN_CIPHER_SUITE_SMS4		0x00147201</span>

<span class="cm">/* AKM suite selectors */</span>
<span class="cp">#define WLAN_AKM_SUITE_8021X		0x000FAC01</span>
<span class="cp">#define WLAN_AKM_SUITE_PSK		0x000FAC02</span>
<span class="cp">#define WLAN_AKM_SUITE_SAE			0x000FAC08</span>
<span class="cp">#define WLAN_AKM_SUITE_FT_OVER_SAE	0x000FAC09</span>

<span class="cp">#define WLAN_MAX_KEY_LEN		32</span>

<span class="cp">#define WLAN_PMKID_LEN			16</span>

<span class="cp">#define WLAN_OUI_WFA			0x506f9a</span>
<span class="cp">#define WLAN_OUI_TYPE_WFA_P2P		9</span>

<span class="cm">/*</span>
<span class="cm"> * WMM/802.11e Tspec Element</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE80211_WMM_IE_TSPEC_TID_MASK		0x0F</span>
<span class="cp">#define IEEE80211_WMM_IE_TSPEC_TID_SHIFT	1</span>

<span class="k">enum</span> <span class="n">ieee80211_tspec_status_code</span> <span class="p">{</span>
	<span class="n">IEEE80211_TSPEC_STATUS_ADMISS_ACCEPTED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">IEEE80211_TSPEC_STATUS_ADDTS_INVAL_PARAMS</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_tspec_ie</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">element_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">oui</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">oui_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">oui_subtype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">tsinfo</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tsinfo_resvd</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">nominal_msdu</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">max_msdu</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">min_service_int</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">max_service_int</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">inactivity_int</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">suspension_int</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">service_start_time</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">min_data_rate</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">mean_data_rate</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">peak_data_rate</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">max_burst_size</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">delay_bound</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">min_phy_rate</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">sba</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">medium_time</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_get_qos_ctl - get pointer to qos control bytes</span>
<span class="cm"> * @hdr: the frame</span>
<span class="cm"> *</span>
<span class="cm"> * The qos ctrl bytes come after the frame_control, duration, seq_num</span>
<span class="cm"> * and 3 or 4 addresses of length ETH_ALEN.</span>
<span class="cm"> * 3 addr: 2 + 2 + 2 + 3*6 = 24</span>
<span class="cm"> * 4 addr: 2 + 2 + 2 + 4*6 = 30</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="o">*</span><span class="nf">ieee80211_get_qos_ctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_has_a4</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span> <span class="o">+</span> <span class="mi">30</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span> <span class="o">+</span> <span class="mi">24</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_get_SA - get pointer to SA</span>
<span class="cm"> * @hdr: the frame</span>
<span class="cm"> *</span>
<span class="cm"> * Given an 802.11 frame, this function returns the offset</span>
<span class="cm"> * to the source address (SA). It does not verify that the</span>
<span class="cm"> * header is long enough to contain the address, and the</span>
<span class="cm"> * header must be long enough to contain the frame control</span>
<span class="cm"> * field.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="o">*</span><span class="nf">ieee80211_get_SA</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_has_a4</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">hdr</span><span class="o">-&gt;</span><span class="n">addr4</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_has_fromds</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">hdr</span><span class="o">-&gt;</span><span class="n">addr3</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">hdr</span><span class="o">-&gt;</span><span class="n">addr2</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_get_DA - get pointer to DA</span>
<span class="cm"> * @hdr: the frame</span>
<span class="cm"> *</span>
<span class="cm"> * Given an 802.11 frame, this function returns the offset</span>
<span class="cm"> * to the destination address (DA). It does not verify that</span>
<span class="cm"> * the header is long enough to contain the address, and the</span>
<span class="cm"> * header must be long enough to contain the frame control</span>
<span class="cm"> * field.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="o">*</span><span class="nf">ieee80211_get_DA</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_has_tods</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">hdr</span><span class="o">-&gt;</span><span class="n">addr3</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="n">hdr</span><span class="o">-&gt;</span><span class="n">addr1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_robust_mgmt_frame - check if frame is a robust management frame</span>
<span class="cm"> * @hdr: the frame (buffer must include at least the first octet of payload)</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">ieee80211_is_robust_mgmt_frame</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_is_disassoc</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">)</span> <span class="o">||</span>
	    <span class="n">ieee80211_is_deauth</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span>
		<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_is_action</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">u8</span> <span class="o">*</span><span class="n">category</span><span class="p">;</span>

		<span class="cm">/*</span>
<span class="cm">		 * Action frames, excluding Public Action frames, are Robust</span>
<span class="cm">		 * Management Frames. However, if we are looking at a Protected</span>
<span class="cm">		 * frame, skip the check since the data may be encrypted and</span>
<span class="cm">		 * the frame has already been found to be a Robust Management</span>
<span class="cm">		 * Frame (by the other end).</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_has_protected</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span>
			<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
		<span class="n">category</span> <span class="o">=</span> <span class="p">((</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span> <span class="n">hdr</span><span class="p">)</span> <span class="o">+</span> <span class="mi">24</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">*</span><span class="n">category</span> <span class="o">!=</span> <span class="n">WLAN_CATEGORY_PUBLIC</span> <span class="o">&amp;&amp;</span>
			<span class="o">*</span><span class="n">category</span> <span class="o">!=</span> <span class="n">WLAN_CATEGORY_HT</span> <span class="o">&amp;&amp;</span>
			<span class="o">*</span><span class="n">category</span> <span class="o">!=</span> <span class="n">WLAN_CATEGORY_SELF_PROTECTED</span> <span class="o">&amp;&amp;</span>
			<span class="o">*</span><span class="n">category</span> <span class="o">!=</span> <span class="n">WLAN_CATEGORY_VENDOR_SPECIFIC</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_is_public_action - check if frame is a public action frame</span>
<span class="cm"> * @hdr: the frame</span>
<span class="cm"> * @len: length of the frame</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">ieee80211_is_public_action</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">,</span>
					      <span class="kt">size_t</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_mgmt</span> <span class="o">*</span><span class="n">mgmt</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;</span> <span class="n">IEEE80211_MIN_ACTION_SIZE</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ieee80211_is_action</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_control</span><span class="p">))</span>
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">mgmt</span><span class="o">-&gt;</span><span class="n">u</span><span class="p">.</span><span class="n">action</span><span class="p">.</span><span class="n">category</span> <span class="o">==</span> <span class="n">WLAN_CATEGORY_PUBLIC</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_fhss_chan_to_freq - get channel frequency</span>
<span class="cm"> * @channel: the FHSS channel</span>
<span class="cm"> *</span>
<span class="cm"> * Convert IEEE802.11 FHSS channel to frequency (MHz)</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 14.6</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_fhss_chan_to_freq</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">channel</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&lt;</span> <span class="mi">96</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">channel</span> <span class="o">+</span> <span class="mi">2400</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_freq_to_fhss_chan - get channel</span>
<span class="cm"> * @freq: the channels frequency</span>
<span class="cm"> *</span>
<span class="cm"> * Convert frequency (MHz) to IEEE802.11 FHSS channel</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 14.6</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_freq_to_fhss_chan</span><span class="p">(</span><span class="kt">int</span> <span class="n">freq</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">freq</span> <span class="o">&gt;</span> <span class="mi">2401</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="mi">2496</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">freq</span> <span class="o">-</span> <span class="mi">2400</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_dsss_chan_to_freq - get channel center frequency</span>
<span class="cm"> * @channel: the DSSS channel</span>
<span class="cm"> *</span>
<span class="cm"> * Convert IEEE802.11 DSSS channel to the center frequency (MHz).</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 15.6</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_dsss_chan_to_freq</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">channel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&lt;</span> <span class="mi">14</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">2407</span> <span class="o">+</span> <span class="p">(</span><span class="n">channel</span> <span class="o">*</span> <span class="mi">5</span><span class="p">);</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">==</span> <span class="mi">14</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">2484</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_freq_to_dsss_chan - get channel</span>
<span class="cm"> * @freq: the frequency</span>
<span class="cm"> *</span>
<span class="cm"> * Convert frequency (MHz) to IEEE802.11 DSSS channel</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 15.6</span>
<span class="cm"> *</span>
<span class="cm"> * This routine selects the channel with the closest center frequency.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_freq_to_dsss_chan</span><span class="p">(</span><span class="kt">int</span> <span class="n">freq</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">freq</span> <span class="o">&gt;=</span> <span class="mi">2410</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="mi">2475</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">freq</span> <span class="o">-</span> <span class="mi">2405</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">freq</span> <span class="o">&gt;=</span> <span class="mi">2482</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="mi">2487</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">14</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* Convert IEEE802.11 HR DSSS channel to frequency (MHz) and back</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 18.4.6.2</span>
<span class="cm"> *</span>
<span class="cm"> * The channels and frequencies are the same as those defined for DSSS</span>
<span class="cm"> */</span>
<span class="cp">#define ieee80211_hr_chan_to_freq(chan) ieee80211_dsss_chan_to_freq(chan)</span>
<span class="cp">#define ieee80211_freq_to_hr_chan(freq) ieee80211_freq_to_dsss_chan(freq)</span>

<span class="cm">/* Convert IEEE802.11 ERP channel to frequency (MHz) and back</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 19.4.2</span>
<span class="cm"> */</span>
<span class="cp">#define ieee80211_erp_chan_to_freq(chan) ieee80211_hr_chan_to_freq(chan)</span>
<span class="cp">#define ieee80211_freq_to_erp_chan(freq) ieee80211_freq_to_hr_chan(freq)</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_ofdm_chan_to_freq - get channel center frequency</span>
<span class="cm"> * @s_freq: starting frequency == (dotChannelStartingFactor/2) MHz</span>
<span class="cm"> * @channel: the OFDM channel</span>
<span class="cm"> *</span>
<span class="cm"> * Convert IEEE802.11 OFDM channel to center frequency (MHz)</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 17.3.8.3.2</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_ofdm_chan_to_freq</span><span class="p">(</span><span class="kt">int</span> <span class="n">s_freq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">channel</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&lt;=</span> <span class="mi">200</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">s_freq</span> <span class="o">&gt;=</span> <span class="mi">4000</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">s_freq</span> <span class="o">+</span> <span class="p">(</span><span class="n">channel</span> <span class="o">*</span> <span class="mi">5</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_freq_to_ofdm_channel - get channel</span>
<span class="cm"> * @s_freq: starting frequency == (dotChannelStartingFactor/2) MHz</span>
<span class="cm"> * @freq: the frequency</span>
<span class="cm"> *</span>
<span class="cm"> * Convert frequency (MHz) to IEEE802.11 OFDM channel</span>
<span class="cm"> * Ref IEEE 802.11-2007 section 17.3.8.3.2</span>
<span class="cm"> *</span>
<span class="cm"> * This routine selects the channel with the closest center frequency.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_freq_to_ofdm_chan</span><span class="p">(</span><span class="kt">int</span> <span class="n">s_freq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">freq</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">freq</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">s_freq</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">freq</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">s_freq</span> <span class="o">+</span> <span class="mi">1202</span><span class="p">))</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">s_freq</span> <span class="o">&gt;=</span> <span class="mi">4000</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">freq</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">s_freq</span><span class="p">)</span> <span class="o">/</span> <span class="mi">5</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_tu_to_usec - convert time units (TU) to microseconds</span>
<span class="cm"> * @tu: the TUs</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="nf">ieee80211_tu_to_usec</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tu</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">1024</span> <span class="o">*</span> <span class="n">tu</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ieee80211_check_tim - check if AID bit is set in TIM</span>
<span class="cm"> * @tim: the TIM IE</span>
<span class="cm"> * @tim_len: length of the TIM IE</span>
<span class="cm"> * @aid: the AID to look for</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">ieee80211_check_tim</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_tim_ie</span> <span class="o">*</span><span class="n">tim</span><span class="p">,</span>
				       <span class="n">u8</span> <span class="n">tim_len</span><span class="p">,</span> <span class="n">u16</span> <span class="n">aid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u8</span> <span class="n">mask</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">index</span><span class="p">,</span> <span class="n">indexn1</span><span class="p">,</span> <span class="n">indexn2</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">unlikely</span><span class="p">(</span><span class="o">!</span><span class="n">tim</span> <span class="o">||</span> <span class="n">tim_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">tim</span><span class="p">)))</span>
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

	<span class="n">aid</span> <span class="o">&amp;=</span> <span class="mh">0x3fff</span><span class="p">;</span>
	<span class="n">index</span> <span class="o">=</span> <span class="n">aid</span> <span class="o">/</span> <span class="mi">8</span><span class="p">;</span>
	<span class="n">mask</span>  <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">aid</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">);</span>

	<span class="n">indexn1</span> <span class="o">=</span> <span class="n">tim</span><span class="o">-&gt;</span><span class="n">bitmap_ctrl</span> <span class="o">&amp;</span> <span class="mh">0xfe</span><span class="p">;</span>
	<span class="n">indexn2</span> <span class="o">=</span> <span class="n">tim_len</span> <span class="o">+</span> <span class="n">indexn1</span> <span class="o">-</span> <span class="mi">4</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">indexn1</span> <span class="o">||</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="n">indexn2</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>

	<span class="n">index</span> <span class="o">-=</span> <span class="n">indexn1</span><span class="p">;</span>

	<span class="k">return</span> <span class="o">!!</span><span class="p">(</span><span class="n">tim</span><span class="o">-&gt;</span><span class="n">virtual_map</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">mask</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* LINUX_IEEE80211_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
