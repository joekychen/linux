<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › fuse.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>fuse.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">    FUSE: Filesystem in Userspace</span>
<span class="cm">    Copyright (C) 2001-2008  Miklos Szeredi &lt;miklos@szeredi.hu&gt;</span>

<span class="cm">    This program can be distributed under the terms of the GNU GPL.</span>
<span class="cm">    See the file COPYING.</span>
<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm"> * This file defines the kernel interface of FUSE</span>
<span class="cm"> *</span>
<span class="cm"> * Protocol changelog:</span>
<span class="cm"> *</span>
<span class="cm"> * 7.9:</span>
<span class="cm"> *  - new fuse_getattr_in input argument of GETATTR</span>
<span class="cm"> *  - add lk_flags in fuse_lk_in</span>
<span class="cm"> *  - add lock_owner field to fuse_setattr_in, fuse_read_in and fuse_write_in</span>
<span class="cm"> *  - add blksize field to fuse_attr</span>
<span class="cm"> *  - add file flags field to fuse_read_in and fuse_write_in</span>
<span class="cm"> *</span>
<span class="cm"> * 7.10</span>
<span class="cm"> *  - add nonseekable open flag</span>
<span class="cm"> *</span>
<span class="cm"> * 7.11</span>
<span class="cm"> *  - add IOCTL message</span>
<span class="cm"> *  - add unsolicited notification support</span>
<span class="cm"> *  - add POLL message and NOTIFY_POLL notification</span>
<span class="cm"> *</span>
<span class="cm"> * 7.12</span>
<span class="cm"> *  - add umask flag to input argument of open, mknod and mkdir</span>
<span class="cm"> *  - add notification messages for invalidation of inodes and</span>
<span class="cm"> *    directory entries</span>
<span class="cm"> *</span>
<span class="cm"> * 7.13</span>
<span class="cm"> *  - make max number of background requests and congestion threshold</span>
<span class="cm"> *    tunables</span>
<span class="cm"> *</span>
<span class="cm"> * 7.14</span>
<span class="cm"> *  - add splice support to fuse device</span>
<span class="cm"> *</span>
<span class="cm"> * 7.15</span>
<span class="cm"> *  - add store notify</span>
<span class="cm"> *  - add retrieve notify</span>
<span class="cm"> *</span>
<span class="cm"> * 7.16</span>
<span class="cm"> *  - add BATCH_FORGET request</span>
<span class="cm"> *  - FUSE_IOCTL_UNRESTRICTED shall now return with array of &#39;struct</span>
<span class="cm"> *    fuse_ioctl_iovec&#39; instead of ambiguous &#39;struct iovec&#39;</span>
<span class="cm"> *  - add FUSE_IOCTL_32BIT flag</span>
<span class="cm"> *</span>
<span class="cm"> * 7.17</span>
<span class="cm"> *  - add FUSE_FLOCK_LOCKS and FUSE_RELEASE_FLOCK_UNLOCK</span>
<span class="cm"> *</span>
<span class="cm"> * 7.18</span>
<span class="cm"> *  - add FUSE_IOCTL_DIR flag</span>
<span class="cm"> *  - add FUSE_NOTIFY_DELETE</span>
<span class="cm"> *</span>
<span class="cm"> * 7.19</span>
<span class="cm"> *  - add FUSE_FALLOCATE</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_FUSE_H</span>
<span class="cp">#define _LINUX_FUSE_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Version negotiation:</span>
<span class="cm"> *</span>
<span class="cm"> * Both the kernel and userspace send the version they support in the</span>
<span class="cm"> * INIT request and reply respectively.</span>
<span class="cm"> *</span>
<span class="cm"> * If the major versions match then both shall use the smallest</span>
<span class="cm"> * of the two minor versions for communication.</span>
<span class="cm"> *</span>
<span class="cm"> * If the kernel supports a larger major version, then userspace shall</span>
<span class="cm"> * reply with the major version it supports, ignore the rest of the</span>
<span class="cm"> * INIT message and expect a new INIT message from the kernel with a</span>
<span class="cm"> * matching major version.</span>
<span class="cm"> *</span>
<span class="cm"> * If the library supports a larger major version, then it shall fall</span>
<span class="cm"> * back to the major protocol version sent by the kernel for</span>
<span class="cm"> * communication and reply with that major version (and an arbitrary</span>
<span class="cm"> * supported minor version).</span>
<span class="cm"> */</span>

<span class="cm">/** Version number of this interface */</span>
<span class="cp">#define FUSE_KERNEL_VERSION 7</span>

<span class="cm">/** Minor version number of this interface */</span>
<span class="cp">#define FUSE_KERNEL_MINOR_VERSION 19</span>

<span class="cm">/** The node ID of the root inode */</span>
<span class="cp">#define FUSE_ROOT_ID 1</span>

<span class="cm">/* Make sure all structures are padded to 64bit boundary, so 32bit</span>
<span class="cm">   userspace works under 64bit kernels */</span>

<span class="k">struct</span> <span class="n">fuse_attr</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">ino</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">blocks</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">atime</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">ctime</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">atimensec</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">mtimensec</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">ctimensec</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">nlink</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">uid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">gid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">rdev</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">blksize</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_kstatfs</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">blocks</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">bfree</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">bavail</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">files</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">ffree</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">bsize</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">namelen</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">frsize</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">spare</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_file_lock</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">start</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">end</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">type</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">pid</span><span class="p">;</span> <span class="cm">/* tgid */</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Bitmasks for fuse_setattr_in.valid</span>
<span class="cm"> */</span>
<span class="cp">#define FATTR_MODE	(1 &lt;&lt; 0)</span>
<span class="cp">#define FATTR_UID	(1 &lt;&lt; 1)</span>
<span class="cp">#define FATTR_GID	(1 &lt;&lt; 2)</span>
<span class="cp">#define FATTR_SIZE	(1 &lt;&lt; 3)</span>
<span class="cp">#define FATTR_ATIME	(1 &lt;&lt; 4)</span>
<span class="cp">#define FATTR_MTIME	(1 &lt;&lt; 5)</span>
<span class="cp">#define FATTR_FH	(1 &lt;&lt; 6)</span>
<span class="cp">#define FATTR_ATIME_NOW	(1 &lt;&lt; 7)</span>
<span class="cp">#define FATTR_MTIME_NOW	(1 &lt;&lt; 8)</span>
<span class="cp">#define FATTR_LOCKOWNER	(1 &lt;&lt; 9)</span>

<span class="cm">/**</span>
<span class="cm"> * Flags returned by the OPEN request</span>
<span class="cm"> *</span>
<span class="cm"> * FOPEN_DIRECT_IO: bypass page cache for this open file</span>
<span class="cm"> * FOPEN_KEEP_CACHE: don&#39;t invalidate the data cache on open</span>
<span class="cm"> * FOPEN_NONSEEKABLE: the file is not seekable</span>
<span class="cm"> */</span>
<span class="cp">#define FOPEN_DIRECT_IO		(1 &lt;&lt; 0)</span>
<span class="cp">#define FOPEN_KEEP_CACHE	(1 &lt;&lt; 1)</span>
<span class="cp">#define FOPEN_NONSEEKABLE	(1 &lt;&lt; 2)</span>

<span class="cm">/**</span>
<span class="cm"> * INIT request/reply flags</span>
<span class="cm"> *</span>
<span class="cm"> * FUSE_POSIX_LOCKS: remote locking for POSIX file locks</span>
<span class="cm"> * FUSE_EXPORT_SUPPORT: filesystem handles lookups of &quot;.&quot; and &quot;..&quot;</span>
<span class="cm"> * FUSE_DONT_MASK: don&#39;t apply umask to file mode on create operations</span>
<span class="cm"> * FUSE_FLOCK_LOCKS: remote locking for BSD style file locks</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_ASYNC_READ		(1 &lt;&lt; 0)</span>
<span class="cp">#define FUSE_POSIX_LOCKS	(1 &lt;&lt; 1)</span>
<span class="cp">#define FUSE_FILE_OPS		(1 &lt;&lt; 2)</span>
<span class="cp">#define FUSE_ATOMIC_O_TRUNC	(1 &lt;&lt; 3)</span>
<span class="cp">#define FUSE_EXPORT_SUPPORT	(1 &lt;&lt; 4)</span>
<span class="cp">#define FUSE_BIG_WRITES		(1 &lt;&lt; 5)</span>
<span class="cp">#define FUSE_DONT_MASK		(1 &lt;&lt; 6)</span>
<span class="cp">#define FUSE_FLOCK_LOCKS	(1 &lt;&lt; 10)</span>

<span class="cm">/**</span>
<span class="cm"> * CUSE INIT request/reply flags</span>
<span class="cm"> *</span>
<span class="cm"> * CUSE_UNRESTRICTED_IOCTL:  use unrestricted ioctl</span>
<span class="cm"> */</span>
<span class="cp">#define CUSE_UNRESTRICTED_IOCTL	(1 &lt;&lt; 0)</span>

<span class="cm">/**</span>
<span class="cm"> * Release flags</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_RELEASE_FLUSH	(1 &lt;&lt; 0)</span>
<span class="cp">#define FUSE_RELEASE_FLOCK_UNLOCK	(1 &lt;&lt; 1)</span>

<span class="cm">/**</span>
<span class="cm"> * Getattr flags</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_GETATTR_FH		(1 &lt;&lt; 0)</span>

<span class="cm">/**</span>
<span class="cm"> * Lock flags</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_LK_FLOCK		(1 &lt;&lt; 0)</span>

<span class="cm">/**</span>
<span class="cm"> * WRITE flags</span>
<span class="cm"> *</span>
<span class="cm"> * FUSE_WRITE_CACHE: delayed write from page cache, file handle is guessed</span>
<span class="cm"> * FUSE_WRITE_LOCKOWNER: lock_owner field is valid</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_WRITE_CACHE	(1 &lt;&lt; 0)</span>
<span class="cp">#define FUSE_WRITE_LOCKOWNER	(1 &lt;&lt; 1)</span>

<span class="cm">/**</span>
<span class="cm"> * Read flags</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_READ_LOCKOWNER	(1 &lt;&lt; 1)</span>

<span class="cm">/**</span>
<span class="cm"> * Ioctl flags</span>
<span class="cm"> *</span>
<span class="cm"> * FUSE_IOCTL_COMPAT: 32bit compat ioctl on 64bit machine</span>
<span class="cm"> * FUSE_IOCTL_UNRESTRICTED: not restricted to well-formed ioctls, retry allowed</span>
<span class="cm"> * FUSE_IOCTL_RETRY: retry with new iovecs</span>
<span class="cm"> * FUSE_IOCTL_32BIT: 32bit ioctl</span>
<span class="cm"> * FUSE_IOCTL_DIR: is a directory</span>
<span class="cm"> *</span>
<span class="cm"> * FUSE_IOCTL_MAX_IOV: maximum of in_iovecs + out_iovecs</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_IOCTL_COMPAT	(1 &lt;&lt; 0)</span>
<span class="cp">#define FUSE_IOCTL_UNRESTRICTED	(1 &lt;&lt; 1)</span>
<span class="cp">#define FUSE_IOCTL_RETRY	(1 &lt;&lt; 2)</span>
<span class="cp">#define FUSE_IOCTL_32BIT	(1 &lt;&lt; 3)</span>
<span class="cp">#define FUSE_IOCTL_DIR		(1 &lt;&lt; 4)</span>

<span class="cp">#define FUSE_IOCTL_MAX_IOV	256</span>

<span class="cm">/**</span>
<span class="cm"> * Poll flags</span>
<span class="cm"> *</span>
<span class="cm"> * FUSE_POLL_SCHEDULE_NOTIFY: request poll notify</span>
<span class="cm"> */</span>
<span class="cp">#define FUSE_POLL_SCHEDULE_NOTIFY (1 &lt;&lt; 0)</span>

<span class="k">enum</span> <span class="n">fuse_opcode</span> <span class="p">{</span>
	<span class="n">FUSE_LOOKUP</span>	   <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">FUSE_FORGET</span>	   <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>  <span class="cm">/* no reply */</span>
	<span class="n">FUSE_GETATTR</span>	   <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">FUSE_SETATTR</span>	   <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">FUSE_READLINK</span>	   <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">FUSE_SYMLINK</span>	   <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">FUSE_MKNOD</span>	   <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">FUSE_MKDIR</span>	   <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">FUSE_UNLINK</span>	   <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">FUSE_RMDIR</span>	   <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">FUSE_RENAME</span>	   <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">FUSE_LINK</span>	   <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">FUSE_OPEN</span>	   <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">FUSE_READ</span>	   <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">FUSE_WRITE</span>	   <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">FUSE_STATFS</span>	   <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">FUSE_RELEASE</span>       <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">FUSE_FSYNC</span>         <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">FUSE_SETXATTR</span>      <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">FUSE_GETXATTR</span>      <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">FUSE_LISTXATTR</span>     <span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">FUSE_REMOVEXATTR</span>   <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
	<span class="n">FUSE_FLUSH</span>         <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
	<span class="n">FUSE_INIT</span>          <span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
	<span class="n">FUSE_OPENDIR</span>       <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
	<span class="n">FUSE_READDIR</span>       <span class="o">=</span> <span class="mi">28</span><span class="p">,</span>
	<span class="n">FUSE_RELEASEDIR</span>    <span class="o">=</span> <span class="mi">29</span><span class="p">,</span>
	<span class="n">FUSE_FSYNCDIR</span>      <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
	<span class="n">FUSE_GETLK</span>         <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
	<span class="n">FUSE_SETLK</span>         <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">FUSE_SETLKW</span>        <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">FUSE_ACCESS</span>        <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">FUSE_CREATE</span>        <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">FUSE_INTERRUPT</span>     <span class="o">=</span> <span class="mi">36</span><span class="p">,</span>
	<span class="n">FUSE_BMAP</span>          <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">FUSE_DESTROY</span>       <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">FUSE_IOCTL</span>         <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>
	<span class="n">FUSE_POLL</span>          <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
	<span class="n">FUSE_NOTIFY_REPLY</span>  <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>
	<span class="n">FUSE_BATCH_FORGET</span>  <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">FUSE_FALLOCATE</span>     <span class="o">=</span> <span class="mi">43</span><span class="p">,</span>

	<span class="cm">/* CUSE specific operations */</span>
	<span class="n">CUSE_INIT</span>          <span class="o">=</span> <span class="mi">4096</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">fuse_notify_code</span> <span class="p">{</span>
	<span class="n">FUSE_NOTIFY_POLL</span>   <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">FUSE_NOTIFY_INVAL_INODE</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">FUSE_NOTIFY_INVAL_ENTRY</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">FUSE_NOTIFY_STORE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">FUSE_NOTIFY_RETRIEVE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">FUSE_NOTIFY_DELETE</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">FUSE_NOTIFY_CODE_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* The read buffer is required to be at least 8k, but may be much larger */</span>
<span class="cp">#define FUSE_MIN_READ_BUFFER 8192</span>

<span class="cp">#define FUSE_COMPAT_ENTRY_OUT_SIZE 120</span>

<span class="k">struct</span> <span class="n">fuse_entry_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">nodeid</span><span class="p">;</span>		<span class="cm">/* Inode ID */</span>
	<span class="n">__u64</span>	<span class="n">generation</span><span class="p">;</span>	<span class="cm">/* Inode generation: nodeid:gen must</span>
<span class="cm">				   be unique for the fs&#39;s lifetime */</span>
	<span class="n">__u64</span>	<span class="n">entry_valid</span><span class="p">;</span>	<span class="cm">/* Cache timeout for the name */</span>
	<span class="n">__u64</span>	<span class="n">attr_valid</span><span class="p">;</span>	<span class="cm">/* Cache timeout for the attributes */</span>
	<span class="n">__u32</span>	<span class="n">entry_valid_nsec</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">attr_valid_nsec</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fuse_attr</span> <span class="n">attr</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_forget_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">nlookup</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_forget_one</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">nodeid</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">nlookup</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_batch_forget_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">count</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">dummy</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_getattr_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">getattr_flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">dummy</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define FUSE_COMPAT_ATTR_OUT_SIZE 96</span>

<span class="k">struct</span> <span class="n">fuse_attr_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">attr_valid</span><span class="p">;</span>	<span class="cm">/* Cache timeout for the attributes */</span>
	<span class="n">__u32</span>	<span class="n">attr_valid_nsec</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">dummy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fuse_attr</span> <span class="n">attr</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define FUSE_COMPAT_MKNOD_IN_SIZE 8</span>

<span class="k">struct</span> <span class="n">fuse_mknod_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">rdev</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">umask</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_mkdir_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">umask</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_rename_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">newdir</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_link_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">oldnodeid</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_setattr_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">valid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">lock_owner</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">atime</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">mtime</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">unused2</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">atimensec</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">mtimensec</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">unused3</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">unused4</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">uid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">gid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">unused5</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_open_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">unused</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_create_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">umask</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_open_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">open_flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_release_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">release_flags</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">lock_owner</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_flush_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">unused</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">lock_owner</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_read_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">read_flags</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">lock_owner</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define FUSE_COMPAT_WRITE_IN_SIZE 24</span>

<span class="k">struct</span> <span class="n">fuse_write_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">write_flags</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">lock_owner</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_write_out</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define FUSE_COMPAT_STATFS_SIZE 48</span>

<span class="k">struct</span> <span class="n">fuse_statfs_out</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">fuse_kstatfs</span> <span class="n">st</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_fsync_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">fsync_flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_setxattr_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_getxattr_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_getxattr_out</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_lk_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">owner</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">fuse_file_lock</span> <span class="n">lk</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">lk_flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_lk_out</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">fuse_file_lock</span> <span class="n">lk</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_access_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">mask</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_init_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">major</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">minor</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">max_readahead</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_init_out</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">major</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">minor</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">max_readahead</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u16</span>   <span class="n">max_background</span><span class="p">;</span>
	<span class="n">__u16</span>   <span class="n">congestion_threshold</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">max_write</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define CUSE_INIT_INFO_MAX 4096</span>

<span class="k">struct</span> <span class="n">cuse_init_in</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">major</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">minor</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">unused</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">cuse_init_out</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">major</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">minor</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">unused</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">max_read</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">max_write</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">dev_major</span><span class="p">;</span>		<span class="cm">/* chardev major */</span>
	<span class="n">__u32</span>	<span class="n">dev_minor</span><span class="p">;</span>		<span class="cm">/* chardev minor */</span>
	<span class="n">__u32</span>	<span class="n">spare</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_interrupt_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">unique</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_bmap_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">block</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">blocksize</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_bmap_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">block</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_ioctl_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">cmd</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">arg</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">in_size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">out_size</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_ioctl_iovec</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">base</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">len</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_ioctl_out</span> <span class="p">{</span>
	<span class="n">__s32</span>	<span class="n">result</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">in_iovs</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">out_iovs</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_poll_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">kh</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">flags</span><span class="p">;</span>
	<span class="n">__u32</span>   <span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_poll_out</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">revents</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_notify_poll_wakeup_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">kh</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_fallocate_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">fh</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">length</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">mode</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_in_header</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">len</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">opcode</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">unique</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">nodeid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">uid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">gid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">pid</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_out_header</span> <span class="p">{</span>
	<span class="n">__u32</span>	<span class="n">len</span><span class="p">;</span>
	<span class="n">__s32</span>	<span class="n">error</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">unique</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_dirent</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">ino</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">off</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">namelen</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">type</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">name</span><span class="p">[];</span>
<span class="p">};</span>

<span class="cp">#define FUSE_NAME_OFFSET offsetof(struct fuse_dirent, name)</span>
<span class="cp">#define FUSE_DIRENT_ALIGN(x) (((x) + sizeof(__u64) - 1) &amp; ~(sizeof(__u64) - 1))</span>
<span class="cp">#define FUSE_DIRENT_SIZE(d) \</span>
<span class="cp">	FUSE_DIRENT_ALIGN(FUSE_NAME_OFFSET + (d)-&gt;namelen)</span>

<span class="k">struct</span> <span class="n">fuse_notify_inval_inode_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">ino</span><span class="p">;</span>
	<span class="n">__s64</span>	<span class="n">off</span><span class="p">;</span>
	<span class="n">__s64</span>	<span class="n">len</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_notify_inval_entry_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">parent</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">namelen</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_notify_delete_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">parent</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">child</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">namelen</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_notify_store_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">nodeid</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">fuse_notify_retrieve_out</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">notify_unique</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">nodeid</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">padding</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Matches the size of fuse_write_in */</span>
<span class="k">struct</span> <span class="n">fuse_notify_retrieve_in</span> <span class="p">{</span>
	<span class="n">__u64</span>	<span class="n">dummy1</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">size</span><span class="p">;</span>
	<span class="n">__u32</span>	<span class="n">dummy2</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">dummy3</span><span class="p">;</span>
	<span class="n">__u64</span>	<span class="n">dummy4</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* _LINUX_FUSE_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
