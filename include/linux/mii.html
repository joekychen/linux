<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › mii.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>mii.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * linux/mii.h: definitions for MII-compatible transceivers</span>
<span class="cm"> * Originally drivers/net/sunhme.h.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1996, 1999, 2001 David S. Miller (davem@redhat.com)</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __LINUX_MII_H__</span>
<span class="cp">#define __LINUX_MII_H__</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/ethtool.h&gt;</span>

<span class="cm">/* Generic MII registers. */</span>
<span class="cp">#define MII_BMCR		0x00	</span><span class="cm">/* Basic mode control register */</span><span class="cp"></span>
<span class="cp">#define MII_BMSR		0x01	</span><span class="cm">/* Basic mode status register  */</span><span class="cp"></span>
<span class="cp">#define MII_PHYSID1		0x02	</span><span class="cm">/* PHYS ID 1                   */</span><span class="cp"></span>
<span class="cp">#define MII_PHYSID2		0x03	</span><span class="cm">/* PHYS ID 2                   */</span><span class="cp"></span>
<span class="cp">#define MII_ADVERTISE		0x04	</span><span class="cm">/* Advertisement control reg   */</span><span class="cp"></span>
<span class="cp">#define MII_LPA			0x05	</span><span class="cm">/* Link partner ability reg    */</span><span class="cp"></span>
<span class="cp">#define MII_EXPANSION		0x06	</span><span class="cm">/* Expansion register          */</span><span class="cp"></span>
<span class="cp">#define MII_CTRL1000		0x09	</span><span class="cm">/* 1000BASE-T control          */</span><span class="cp"></span>
<span class="cp">#define MII_STAT1000		0x0a	</span><span class="cm">/* 1000BASE-T status           */</span><span class="cp"></span>
<span class="cp">#define MII_ESTATUS		0x0f	</span><span class="cm">/* Extended Status             */</span><span class="cp"></span>
<span class="cp">#define MII_DCOUNTER		0x12	</span><span class="cm">/* Disconnect counter          */</span><span class="cp"></span>
<span class="cp">#define MII_FCSCOUNTER		0x13	</span><span class="cm">/* False carrier counter       */</span><span class="cp"></span>
<span class="cp">#define MII_NWAYTEST		0x14	</span><span class="cm">/* N-way auto-neg test reg     */</span><span class="cp"></span>
<span class="cp">#define MII_RERRCOUNTER		0x15	</span><span class="cm">/* Receive error counter       */</span><span class="cp"></span>
<span class="cp">#define MII_SREVISION		0x16	</span><span class="cm">/* Silicon revision            */</span><span class="cp"></span>
<span class="cp">#define MII_RESV1		0x17	</span><span class="cm">/* Reserved...                 */</span><span class="cp"></span>
<span class="cp">#define MII_LBRERROR		0x18	</span><span class="cm">/* Lpback, rx, bypass error    */</span><span class="cp"></span>
<span class="cp">#define MII_PHYADDR		0x19	</span><span class="cm">/* PHY address                 */</span><span class="cp"></span>
<span class="cp">#define MII_RESV2		0x1a	</span><span class="cm">/* Reserved...                 */</span><span class="cp"></span>
<span class="cp">#define MII_TPISTATUS		0x1b	</span><span class="cm">/* TPI status for 10mbps       */</span><span class="cp"></span>
<span class="cp">#define MII_NCONFIG		0x1c	</span><span class="cm">/* Network interface config    */</span><span class="cp"></span>

<span class="cm">/* Basic mode control register. */</span>
<span class="cp">#define BMCR_RESV		0x003f	</span><span class="cm">/* Unused...                   */</span><span class="cp"></span>
<span class="cp">#define BMCR_SPEED1000		0x0040	</span><span class="cm">/* MSB of Speed (1000)         */</span><span class="cp"></span>
<span class="cp">#define BMCR_CTST		0x0080	</span><span class="cm">/* Collision test              */</span><span class="cp"></span>
<span class="cp">#define BMCR_FULLDPLX		0x0100	</span><span class="cm">/* Full duplex                 */</span><span class="cp"></span>
<span class="cp">#define BMCR_ANRESTART		0x0200	</span><span class="cm">/* Auto negotiation restart    */</span><span class="cp"></span>
<span class="cp">#define BMCR_ISOLATE		0x0400	</span><span class="cm">/* Isolate data paths from MII */</span><span class="cp"></span>
<span class="cp">#define BMCR_PDOWN		0x0800	</span><span class="cm">/* Enable low power state      */</span><span class="cp"></span>
<span class="cp">#define BMCR_ANENABLE		0x1000	</span><span class="cm">/* Enable auto negotiation     */</span><span class="cp"></span>
<span class="cp">#define BMCR_SPEED100		0x2000	</span><span class="cm">/* Select 100Mbps              */</span><span class="cp"></span>
<span class="cp">#define BMCR_LOOPBACK		0x4000	</span><span class="cm">/* TXD loopback bits           */</span><span class="cp"></span>
<span class="cp">#define BMCR_RESET		0x8000	</span><span class="cm">/* Reset to default state      */</span><span class="cp"></span>

<span class="cm">/* Basic mode status register. */</span>
<span class="cp">#define BMSR_ERCAP		0x0001	</span><span class="cm">/* Ext-reg capability          */</span><span class="cp"></span>
<span class="cp">#define BMSR_JCD		0x0002	</span><span class="cm">/* Jabber detected             */</span><span class="cp"></span>
<span class="cp">#define BMSR_LSTATUS		0x0004	</span><span class="cm">/* Link status                 */</span><span class="cp"></span>
<span class="cp">#define BMSR_ANEGCAPABLE	0x0008	</span><span class="cm">/* Able to do auto-negotiation */</span><span class="cp"></span>
<span class="cp">#define BMSR_RFAULT		0x0010	</span><span class="cm">/* Remote fault detected       */</span><span class="cp"></span>
<span class="cp">#define BMSR_ANEGCOMPLETE	0x0020	</span><span class="cm">/* Auto-negotiation complete   */</span><span class="cp"></span>
<span class="cp">#define BMSR_RESV		0x00c0	</span><span class="cm">/* Unused...                   */</span><span class="cp"></span>
<span class="cp">#define BMSR_ESTATEN		0x0100	</span><span class="cm">/* Extended Status in R15      */</span><span class="cp"></span>
<span class="cp">#define BMSR_100HALF2		0x0200	</span><span class="cm">/* Can do 100BASE-T2 HDX       */</span><span class="cp"></span>
<span class="cp">#define BMSR_100FULL2		0x0400	</span><span class="cm">/* Can do 100BASE-T2 FDX       */</span><span class="cp"></span>
<span class="cp">#define BMSR_10HALF		0x0800	</span><span class="cm">/* Can do 10mbps, half-duplex  */</span><span class="cp"></span>
<span class="cp">#define BMSR_10FULL		0x1000	</span><span class="cm">/* Can do 10mbps, full-duplex  */</span><span class="cp"></span>
<span class="cp">#define BMSR_100HALF		0x2000	</span><span class="cm">/* Can do 100mbps, half-duplex */</span><span class="cp"></span>
<span class="cp">#define BMSR_100FULL		0x4000	</span><span class="cm">/* Can do 100mbps, full-duplex */</span><span class="cp"></span>
<span class="cp">#define BMSR_100BASE4		0x8000	</span><span class="cm">/* Can do 100mbps, 4k packets  */</span><span class="cp"></span>

<span class="cm">/* Advertisement control register. */</span>
<span class="cp">#define ADVERTISE_SLCT		0x001f	</span><span class="cm">/* Selector bits               */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_CSMA		0x0001	</span><span class="cm">/* Only selector supported     */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_10HALF	0x0020	</span><span class="cm">/* Try for 10mbps half-duplex  */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_1000XFULL	0x0020	</span><span class="cm">/* Try for 1000BASE-X full-duplex */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_10FULL	0x0040	</span><span class="cm">/* Try for 10mbps full-duplex  */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_1000XHALF	0x0040	</span><span class="cm">/* Try for 1000BASE-X half-duplex */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_100HALF	0x0080	</span><span class="cm">/* Try for 100mbps half-duplex */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_1000XPAUSE	0x0080	</span><span class="cm">/* Try for 1000BASE-X pause    */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_100FULL	0x0100	</span><span class="cm">/* Try for 100mbps full-duplex */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_1000XPSE_ASYM	0x0100	</span><span class="cm">/* Try for 1000BASE-X asym pause */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_100BASE4	0x0200	</span><span class="cm">/* Try for 100mbps 4k packets  */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_PAUSE_CAP	0x0400	</span><span class="cm">/* Try for pause               */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_PAUSE_ASYM	0x0800	</span><span class="cm">/* Try for asymetric pause     */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_RESV		0x1000	</span><span class="cm">/* Unused...                   */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_RFAULT	0x2000	</span><span class="cm">/* Say we can detect faults    */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_LPACK		0x4000	</span><span class="cm">/* Ack link partners response  */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_NPAGE		0x8000	</span><span class="cm">/* Next page bit               */</span><span class="cp"></span>

<span class="cp">#define ADVERTISE_FULL		(ADVERTISE_100FULL | ADVERTISE_10FULL | \</span>
<span class="cp">				  ADVERTISE_CSMA)</span>
<span class="cp">#define ADVERTISE_ALL		(ADVERTISE_10HALF | ADVERTISE_10FULL | \</span>
<span class="cp">				  ADVERTISE_100HALF | ADVERTISE_100FULL)</span>

<span class="cm">/* Link partner ability register. */</span>
<span class="cp">#define LPA_SLCT		0x001f	</span><span class="cm">/* Same as advertise selector  */</span><span class="cp"></span>
<span class="cp">#define LPA_10HALF		0x0020	</span><span class="cm">/* Can do 10mbps half-duplex   */</span><span class="cp"></span>
<span class="cp">#define LPA_1000XFULL		0x0020	</span><span class="cm">/* Can do 1000BASE-X full-duplex */</span><span class="cp"></span>
<span class="cp">#define LPA_10FULL		0x0040	</span><span class="cm">/* Can do 10mbps full-duplex   */</span><span class="cp"></span>
<span class="cp">#define LPA_1000XHALF		0x0040	</span><span class="cm">/* Can do 1000BASE-X half-duplex */</span><span class="cp"></span>
<span class="cp">#define LPA_100HALF		0x0080	</span><span class="cm">/* Can do 100mbps half-duplex  */</span><span class="cp"></span>
<span class="cp">#define LPA_1000XPAUSE		0x0080	</span><span class="cm">/* Can do 1000BASE-X pause     */</span><span class="cp"></span>
<span class="cp">#define LPA_100FULL		0x0100	</span><span class="cm">/* Can do 100mbps full-duplex  */</span><span class="cp"></span>
<span class="cp">#define LPA_1000XPAUSE_ASYM	0x0100	</span><span class="cm">/* Can do 1000BASE-X pause asym*/</span><span class="cp"></span>
<span class="cp">#define LPA_100BASE4		0x0200	</span><span class="cm">/* Can do 100mbps 4k packets   */</span><span class="cp"></span>
<span class="cp">#define LPA_PAUSE_CAP		0x0400	</span><span class="cm">/* Can pause                   */</span><span class="cp"></span>
<span class="cp">#define LPA_PAUSE_ASYM		0x0800	</span><span class="cm">/* Can pause asymetrically     */</span><span class="cp"></span>
<span class="cp">#define LPA_RESV		0x1000	</span><span class="cm">/* Unused...                   */</span><span class="cp"></span>
<span class="cp">#define LPA_RFAULT		0x2000	</span><span class="cm">/* Link partner faulted        */</span><span class="cp"></span>
<span class="cp">#define LPA_LPACK		0x4000	</span><span class="cm">/* Link partner acked us       */</span><span class="cp"></span>
<span class="cp">#define LPA_NPAGE		0x8000	</span><span class="cm">/* Next page bit               */</span><span class="cp"></span>

<span class="cp">#define LPA_DUPLEX		(LPA_10FULL | LPA_100FULL)</span>
<span class="cp">#define LPA_100			(LPA_100FULL | LPA_100HALF | LPA_100BASE4)</span>

<span class="cm">/* Expansion register for auto-negotiation. */</span>
<span class="cp">#define EXPANSION_NWAY		0x0001	</span><span class="cm">/* Can do N-way auto-nego      */</span><span class="cp"></span>
<span class="cp">#define EXPANSION_LCWP		0x0002	</span><span class="cm">/* Got new RX page code word   */</span><span class="cp"></span>
<span class="cp">#define EXPANSION_ENABLENPAGE	0x0004	</span><span class="cm">/* This enables npage words    */</span><span class="cp"></span>
<span class="cp">#define EXPANSION_NPCAPABLE	0x0008	</span><span class="cm">/* Link partner supports npage */</span><span class="cp"></span>
<span class="cp">#define EXPANSION_MFAULTS	0x0010	</span><span class="cm">/* Multiple faults detected    */</span><span class="cp"></span>
<span class="cp">#define EXPANSION_RESV		0xffe0	</span><span class="cm">/* Unused...                   */</span><span class="cp"></span>

<span class="cp">#define ESTATUS_1000_TFULL	0x2000	</span><span class="cm">/* Can do 1000BT Full          */</span><span class="cp"></span>
<span class="cp">#define ESTATUS_1000_THALF	0x1000	</span><span class="cm">/* Can do 1000BT Half          */</span><span class="cp"></span>

<span class="cm">/* N-way test register. */</span>
<span class="cp">#define NWAYTEST_RESV1		0x00ff	</span><span class="cm">/* Unused...                   */</span><span class="cp"></span>
<span class="cp">#define NWAYTEST_LOOPBACK	0x0100	</span><span class="cm">/* Enable loopback for N-way   */</span><span class="cp"></span>
<span class="cp">#define NWAYTEST_RESV2		0xfe00	</span><span class="cm">/* Unused...                   */</span><span class="cp"></span>

<span class="cm">/* 1000BASE-T Control register */</span>
<span class="cp">#define ADVERTISE_1000FULL	0x0200  </span><span class="cm">/* Advertise 1000BASE-T full duplex */</span><span class="cp"></span>
<span class="cp">#define ADVERTISE_1000HALF	0x0100  </span><span class="cm">/* Advertise 1000BASE-T half duplex */</span><span class="cp"></span>
<span class="cp">#define CTL1000_AS_MASTER	0x0800</span>
<span class="cp">#define CTL1000_ENABLE_MASTER	0x1000</span>

<span class="cm">/* 1000BASE-T Status register */</span>
<span class="cp">#define LPA_1000LOCALRXOK	0x2000	</span><span class="cm">/* Link partner local receiver status */</span><span class="cp"></span>
<span class="cp">#define LPA_1000REMRXOK		0x1000	</span><span class="cm">/* Link partner remote receiver status */</span><span class="cp"></span>
<span class="cp">#define LPA_1000FULL		0x0800	</span><span class="cm">/* Link partner 1000BASE-T full duplex */</span><span class="cp"></span>
<span class="cp">#define LPA_1000HALF		0x0400	</span><span class="cm">/* Link partner 1000BASE-T half duplex */</span><span class="cp"></span>

<span class="cm">/* Flow control flags */</span>
<span class="cp">#define FLOW_CTRL_TX		0x01</span>
<span class="cp">#define FLOW_CTRL_RX		0x02</span>

<span class="cm">/* This structure is used in all SIOCxMIIxxx ioctl calls */</span>
<span class="k">struct</span> <span class="n">mii_ioctl_data</span> <span class="p">{</span>
	<span class="n">__u16</span>		<span class="n">phy_id</span><span class="p">;</span>
	<span class="n">__u16</span>		<span class="n">reg_num</span><span class="p">;</span>
	<span class="n">__u16</span>		<span class="n">val_in</span><span class="p">;</span>
	<span class="n">__u16</span>		<span class="n">val_out</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="cp">#include &lt;linux/if.h&gt;</span>

<span class="k">struct</span> <span class="n">ethtool_cmd</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">mii_if_info</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">phy_id</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">advertising</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">phy_id_mask</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">reg_num_mask</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">full_duplex</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* is full duplex? */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">force_media</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* is autoneg. disabled? */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">supports_gmii</span> <span class="o">:</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* are GMII registers supported? */</span>

	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">mdio_read</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">phy_id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">location</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">mdio_write</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">phy_id</span><span class="p">,</span> <span class="kt">int</span> <span class="n">location</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">mii_link_ok</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mii_nway_restart</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mii_ethtool_gset</span><span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ethtool_cmd</span> <span class="o">*</span><span class="n">ecmd</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mii_ethtool_sset</span><span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ethtool_cmd</span> <span class="o">*</span><span class="n">ecmd</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">mii_check_gmii_support</span><span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">mii_check_link</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mii_check_media</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ok_to_print</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">init_media</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">generic_mii_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">mii_if_info</span> <span class="o">*</span><span class="n">mii_if</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">mii_ioctl_data</span> <span class="o">*</span><span class="n">mii_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span>
			     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">duplex_changed</span><span class="p">);</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">mii_ioctl_data</span> <span class="o">*</span><span class="nf">if_mii</span><span class="p">(</span><span class="k">struct</span> <span class="n">ifreq</span> <span class="o">*</span><span class="n">rq</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mii_ioctl_data</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">rq</span><span class="o">-&gt;</span><span class="n">ifr_ifru</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_nway_result</span>
<span class="cm"> * @negotiated: value of MII ANAR and&#39;d with ANLPAR</span>
<span class="cm"> *</span>
<span class="cm"> * Given a set of MII abilities, check each bit and returns the</span>
<span class="cm"> * currently supported media, in the priority order defined by</span>
<span class="cm"> * IEEE 802.3u.  We use LPA_xxx constants but note this is not the</span>
<span class="cm"> * value of LPA solely, as described above.</span>
<span class="cm"> *</span>
<span class="cm"> * The one exception to IEEE 802.3u is that 100baseT4 is placed</span>
<span class="cm"> * between 100T-full and 100T-half.  If your phy does not support</span>
<span class="cm"> * 100T4 this is fine.  If your phy places 100T4 elsewhere in the</span>
<span class="cm"> * priority order, you will need to roll your own function.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">mii_nway_result</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">negotiated</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ret</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">negotiated</span> <span class="o">&amp;</span> <span class="n">LPA_100FULL</span><span class="p">)</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">LPA_100FULL</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">negotiated</span> <span class="o">&amp;</span> <span class="n">LPA_100BASE4</span><span class="p">)</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">LPA_100BASE4</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">negotiated</span> <span class="o">&amp;</span> <span class="n">LPA_100HALF</span><span class="p">)</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">LPA_100HALF</span><span class="p">;</span>
	<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">negotiated</span> <span class="o">&amp;</span> <span class="n">LPA_10FULL</span><span class="p">)</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">LPA_10FULL</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">ret</span> <span class="o">=</span> <span class="n">LPA_10HALF</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_duplex</span>
<span class="cm"> * @duplex_lock: Non-zero if duplex is locked at full</span>
<span class="cm"> * @negotiated: value of MII ANAR and&#39;d with ANLPAR</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function for a common case.  Returns one</span>
<span class="cm"> * if the media is operating or locked at full duplex, and</span>
<span class="cm"> * returns zero otherwise.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">mii_duplex</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">duplex_lock</span><span class="p">,</span>
				       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">negotiated</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">duplex_lock</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">mii_nway_result</span><span class="p">(</span><span class="n">negotiated</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">LPA_DUPLEX</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ethtool_adv_to_mii_adv_t</span>
<span class="cm"> * @ethadv: the ethtool advertisement settings</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates ethtool advertisement</span>
<span class="cm"> * settings to phy autonegotiation advertisements for the</span>
<span class="cm"> * MII_ADVERTISE register.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">ethtool_adv_to_mii_adv_t</span><span class="p">(</span><span class="n">u32</span> <span class="n">ethadv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_10baseT_Half</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_10HALF</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_10baseT_Full</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_10FULL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_100baseT_Half</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_100HALF</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_100baseT_Full</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_100FULL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_Pause</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_PAUSE_CAP</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_Asym_Pause</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_PAUSE_ASYM</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_adv_to_ethtool_adv_t</span>
<span class="cm"> * @adv: value of the MII_ADVERTISE register</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates MII_ADVERTISE bits</span>
<span class="cm"> * to ethtool advertisement settings.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">mii_adv_to_ethtool_adv_t</span><span class="p">(</span><span class="n">u32</span> <span class="n">adv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_10HALF</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_10baseT_Half</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_10FULL</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_10baseT_Full</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_100HALF</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_100baseT_Half</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_100FULL</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_100baseT_Full</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_PAUSE_CAP</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_Pause</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_PAUSE_ASYM</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_Asym_Pause</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ethtool_adv_to_mii_ctrl1000_t</span>
<span class="cm"> * @ethadv: the ethtool advertisement settings</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates ethtool advertisement</span>
<span class="cm"> * settings to phy autonegotiation advertisements for the</span>
<span class="cm"> * MII_CTRL1000 register when in 1000T mode.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">ethtool_adv_to_mii_ctrl1000_t</span><span class="p">(</span><span class="n">u32</span> <span class="n">ethadv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_1000baseT_Half</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_1000HALF</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_1000baseT_Full</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_1000FULL</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_ctrl1000_to_ethtool_adv_t</span>
<span class="cm"> * @adv: value of the MII_CTRL1000 register</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates MII_CTRL1000</span>
<span class="cm"> * bits, when in 1000Base-T mode, to ethtool</span>
<span class="cm"> * advertisement settings.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">mii_ctrl1000_to_ethtool_adv_t</span><span class="p">(</span><span class="n">u32</span> <span class="n">adv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_1000HALF</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_1000baseT_Half</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_1000FULL</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_1000baseT_Full</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_lpa_to_ethtool_lpa_t</span>
<span class="cm"> * @adv: value of the MII_LPA register</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates MII_LPA</span>
<span class="cm"> * bits, when in 1000Base-T mode, to ethtool</span>
<span class="cm"> * LP advertisement settings.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">mii_lpa_to_ethtool_lpa_t</span><span class="p">(</span><span class="n">u32</span> <span class="n">lpa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lpa</span> <span class="o">&amp;</span> <span class="n">LPA_LPACK</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_Autoneg</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span> <span class="o">|</span> <span class="n">mii_adv_to_ethtool_adv_t</span><span class="p">(</span><span class="n">lpa</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_stat1000_to_ethtool_lpa_t</span>
<span class="cm"> * @adv: value of the MII_STAT1000 register</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates MII_STAT1000</span>
<span class="cm"> * bits, when in 1000Base-T mode, to ethtool</span>
<span class="cm"> * advertisement settings.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">mii_stat1000_to_ethtool_lpa_t</span><span class="p">(</span><span class="n">u32</span> <span class="n">lpa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lpa</span> <span class="o">&amp;</span> <span class="n">LPA_1000HALF</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_1000baseT_Half</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lpa</span> <span class="o">&amp;</span> <span class="n">LPA_1000FULL</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_1000baseT_Full</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ethtool_adv_to_mii_adv_x</span>
<span class="cm"> * @ethadv: the ethtool advertisement settings</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates ethtool advertisement</span>
<span class="cm"> * settings to phy autonegotiation advertisements for the</span>
<span class="cm"> * MII_CTRL1000 register when in 1000Base-X mode.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">ethtool_adv_to_mii_adv_x</span><span class="p">(</span><span class="n">u32</span> <span class="n">ethadv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_1000baseT_Half</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_1000XHALF</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_1000baseT_Full</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_1000XFULL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_Pause</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_1000XPAUSE</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ethadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_Asym_Pause</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISE_1000XPSE_ASYM</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_adv_to_ethtool_adv_x</span>
<span class="cm"> * @adv: value of the MII_CTRL1000 register</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates MII_CTRL1000</span>
<span class="cm"> * bits, when in 1000Base-X mode, to ethtool</span>
<span class="cm"> * advertisement settings.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">mii_adv_to_ethtool_adv_x</span><span class="p">(</span><span class="n">u32</span> <span class="n">adv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_1000XHALF</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_1000baseT_Half</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_1000XFULL</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_1000baseT_Full</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_1000XPAUSE</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_Pause</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_1000XPSE_ASYM</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_Asym_Pause</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_lpa_to_ethtool_lpa_x</span>
<span class="cm"> * @adv: value of the MII_LPA register</span>
<span class="cm"> *</span>
<span class="cm"> * A small helper function that translates MII_LPA</span>
<span class="cm"> * bits, when in 1000Base-X mode, to ethtool</span>
<span class="cm"> * LP advertisement settings.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">mii_lpa_to_ethtool_lpa_x</span><span class="p">(</span><span class="n">u32</span> <span class="n">lpa</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lpa</span> <span class="o">&amp;</span> <span class="n">LPA_LPACK</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">|=</span> <span class="n">ADVERTISED_Autoneg</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">result</span> <span class="o">|</span> <span class="n">mii_adv_to_ethtool_adv_x</span><span class="p">(</span><span class="n">lpa</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_advertise_flowctrl - get flow control advertisement flags</span>
<span class="cm"> * @cap: Flow control capabilities (FLOW_CTRL_RX, FLOW_CTRL_TX or both)</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u16</span> <span class="nf">mii_advertise_flowctrl</span><span class="p">(</span><span class="kt">int</span> <span class="n">cap</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u16</span> <span class="n">adv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">cap</span> <span class="o">&amp;</span> <span class="n">FLOW_CTRL_RX</span><span class="p">)</span>
		<span class="n">adv</span> <span class="o">=</span> <span class="n">ADVERTISE_PAUSE_CAP</span> <span class="o">|</span> <span class="n">ADVERTISE_PAUSE_ASYM</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cap</span> <span class="o">&amp;</span> <span class="n">FLOW_CTRL_TX</span><span class="p">)</span>
		<span class="n">adv</span> <span class="o">^=</span> <span class="n">ADVERTISE_PAUSE_ASYM</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">adv</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * mii_resolve_flowctrl_fdx</span>
<span class="cm"> * @lcladv: value of MII ADVERTISE register</span>
<span class="cm"> * @rmtadv: value of MII LPA register</span>
<span class="cm"> *</span>
<span class="cm"> * Resolve full duplex flow control as per IEEE 802.3-2005 table 28B-3</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="nf">mii_resolve_flowctrl_fdx</span><span class="p">(</span><span class="n">u16</span> <span class="n">lcladv</span><span class="p">,</span> <span class="n">u16</span> <span class="n">rmtadv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u8</span> <span class="n">cap</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">lcladv</span> <span class="o">&amp;</span> <span class="n">rmtadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_PAUSE_CAP</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">cap</span> <span class="o">=</span> <span class="n">FLOW_CTRL_TX</span> <span class="o">|</span> <span class="n">FLOW_CTRL_RX</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">lcladv</span> <span class="o">&amp;</span> <span class="n">rmtadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_PAUSE_ASYM</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">lcladv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_PAUSE_CAP</span><span class="p">)</span>
			<span class="n">cap</span> <span class="o">=</span> <span class="n">FLOW_CTRL_RX</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">rmtadv</span> <span class="o">&amp;</span> <span class="n">ADVERTISE_PAUSE_CAP</span><span class="p">)</span>
			<span class="n">cap</span> <span class="o">=</span> <span class="n">FLOW_CTRL_TX</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">cap</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* __LINUX_MII_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
