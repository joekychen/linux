<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › dlmconstants.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>dlmconstants.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm">*******************************************************************************</span>
<span class="cm">**</span>
<span class="cm">**  Copyright (C) Sistina Software, Inc.  1997-2003  All rights reserved.</span>
<span class="cm">**  Copyright (C) 2004-2007 Red Hat, Inc.  All rights reserved.</span>
<span class="cm">**</span>
<span class="cm">**  This copyrighted material is made available to anyone wishing to use,</span>
<span class="cm">**  modify, copy, or redistribute it subject to the terms and conditions</span>
<span class="cm">**  of the GNU General Public License v.2.</span>
<span class="cm">**</span>
<span class="cm">*******************************************************************************</span>
<span class="cm">******************************************************************************/</span>

<span class="cp">#ifndef __DLMCONSTANTS_DOT_H__</span>
<span class="cp">#define __DLMCONSTANTS_DOT_H__</span>

<span class="cm">/*</span>
<span class="cm"> * Constants used by DLM interface.</span>
<span class="cm"> */</span>

<span class="cp">#define DLM_LOCKSPACE_LEN       64</span>
<span class="cp">#define DLM_RESNAME_MAXLEN      64</span>


<span class="cm">/*</span>
<span class="cm"> * Lock Modes</span>
<span class="cm"> */</span>

<span class="cp">#define DLM_LOCK_IV		(-1)	</span><span class="cm">/* invalid */</span><span class="cp"></span>
<span class="cp">#define DLM_LOCK_NL		0	</span><span class="cm">/* null */</span><span class="cp"></span>
<span class="cp">#define DLM_LOCK_CR		1	</span><span class="cm">/* concurrent read */</span><span class="cp"></span>
<span class="cp">#define DLM_LOCK_CW		2	</span><span class="cm">/* concurrent write */</span><span class="cp"></span>
<span class="cp">#define DLM_LOCK_PR		3	</span><span class="cm">/* protected read */</span><span class="cp"></span>
<span class="cp">#define DLM_LOCK_PW		4	</span><span class="cm">/* protected write */</span><span class="cp"></span>
<span class="cp">#define DLM_LOCK_EX		5	</span><span class="cm">/* exclusive */</span><span class="cp"></span>


<span class="cm">/*</span>
<span class="cm"> * Flags to dlm_lock</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_NOQUEUE</span>
<span class="cm"> *</span>
<span class="cm"> * Do not queue the lock request on the wait queue if it cannot be granted</span>
<span class="cm"> * immediately.  If the lock cannot be granted because of this flag, DLM will</span>
<span class="cm"> * either return -EAGAIN from the dlm_lock call or will return 0 from</span>
<span class="cm"> * dlm_lock and -EAGAIN in the lock status block when the AST is executed.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_CANCEL</span>
<span class="cm"> *</span>
<span class="cm"> * Used to cancel a pending lock request or conversion.  A converting lock is</span>
<span class="cm"> * returned to its previously granted mode.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_CONVERT</span>
<span class="cm"> *</span>
<span class="cm"> * Indicates a lock conversion request.  For conversions the name and namelen</span>
<span class="cm"> * are ignored and the lock ID in the LKSB is used to identify the lock.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_VALBLK</span>
<span class="cm"> *</span>
<span class="cm"> * Requests DLM to return the current contents of the lock value block in the</span>
<span class="cm"> * lock status block.  When this flag is set in a lock conversion from PW or EX</span>
<span class="cm"> * modes, DLM assigns the value specified in the lock status block to the lock</span>
<span class="cm"> * value block of the lock resource.  The LVB is a DLM_LVB_LEN size array</span>
<span class="cm"> * containing application-specific information.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_QUECVT</span>
<span class="cm"> *</span>
<span class="cm"> * Force a conversion request to be queued, even if it is compatible with</span>
<span class="cm"> * the granted modes of other locks on the same resource.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_IVVALBLK</span>
<span class="cm"> *</span>
<span class="cm"> * Invalidate the lock value block.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_CONVDEADLK</span>
<span class="cm"> *</span>
<span class="cm"> * Allows the dlm to resolve conversion deadlocks internally by demoting the</span>
<span class="cm"> * granted mode of a converting lock to NL.  The DLM_SBF_DEMOTED flag is</span>
<span class="cm"> * returned for a conversion that&#39;s been effected by this.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_PERSISTENT</span>
<span class="cm"> *</span>
<span class="cm"> * Only relevant to locks originating in userspace.  A persistent lock will not</span>
<span class="cm"> * be removed if the process holding the lock exits.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_NODLCKWT</span>
<span class="cm"> *</span>
<span class="cm"> * Do not cancel the lock if it gets into conversion deadlock.</span>
<span class="cm"> * Exclude this lock from being monitored due to DLM_LSFL_TIMEWARN.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_NODLCKBLK</span>
<span class="cm"> *</span>
<span class="cm"> * net yet implemented</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_EXPEDITE</span>
<span class="cm"> *</span>
<span class="cm"> * Used only with new requests for NL mode locks.  Tells the lock manager</span>
<span class="cm"> * to grant the lock, ignoring other locks in convert and wait queues.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_NOQUEUEBAST</span>
<span class="cm"> *</span>
<span class="cm"> * Send blocking AST&#39;s before returning -EAGAIN to the caller.  It is only</span>
<span class="cm"> * used along with the NOQUEUE flag.  Blocking AST&#39;s are not sent for failed</span>
<span class="cm"> * NOQUEUE requests otherwise.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_HEADQUE</span>
<span class="cm"> *</span>
<span class="cm"> * Add a lock to the head of the convert or wait queue rather than the tail.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_NOORDER</span>
<span class="cm"> *</span>
<span class="cm"> * Disregard the standard grant order rules and grant a lock as soon as it</span>
<span class="cm"> * is compatible with other granted locks.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_ORPHAN</span>
<span class="cm"> *</span>
<span class="cm"> * not yet implemented</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_ALTPR</span>
<span class="cm"> *</span>
<span class="cm"> * If the requested mode cannot be granted immediately, try to grant the lock</span>
<span class="cm"> * in PR mode instead.  If this alternate mode is granted instead of the</span>
<span class="cm"> * requested mode, DLM_SBF_ALTMODE is returned in the lksb.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_ALTCW</span>
<span class="cm"> *</span>
<span class="cm"> * The same as ALTPR, but the alternate mode is CW.</span>
<span class="cm"> *</span>
<span class="cm"> * DLM_LKF_FORCEUNLOCK</span>
<span class="cm"> *</span>
<span class="cm"> * Unlock the lock even if it is converting or waiting or has sublocks.</span>
<span class="cm"> * Only really for use by the userland device.c code.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#define DLM_LKF_NOQUEUE		0x00000001</span>
<span class="cp">#define DLM_LKF_CANCEL		0x00000002</span>
<span class="cp">#define DLM_LKF_CONVERT		0x00000004</span>
<span class="cp">#define DLM_LKF_VALBLK		0x00000008</span>
<span class="cp">#define DLM_LKF_QUECVT		0x00000010</span>
<span class="cp">#define DLM_LKF_IVVALBLK	0x00000020</span>
<span class="cp">#define DLM_LKF_CONVDEADLK	0x00000040</span>
<span class="cp">#define DLM_LKF_PERSISTENT	0x00000080</span>
<span class="cp">#define DLM_LKF_NODLCKWT	0x00000100</span>
<span class="cp">#define DLM_LKF_NODLCKBLK	0x00000200</span>
<span class="cp">#define DLM_LKF_EXPEDITE	0x00000400</span>
<span class="cp">#define DLM_LKF_NOQUEUEBAST	0x00000800</span>
<span class="cp">#define DLM_LKF_HEADQUE		0x00001000</span>
<span class="cp">#define DLM_LKF_NOORDER		0x00002000</span>
<span class="cp">#define DLM_LKF_ORPHAN		0x00004000</span>
<span class="cp">#define DLM_LKF_ALTPR		0x00008000</span>
<span class="cp">#define DLM_LKF_ALTCW		0x00010000</span>
<span class="cp">#define DLM_LKF_FORCEUNLOCK	0x00020000</span>
<span class="cp">#define DLM_LKF_TIMEOUT		0x00040000</span>

<span class="cm">/*</span>
<span class="cm"> * Some return codes that are not in errno.h</span>
<span class="cm"> */</span>

<span class="cp">#define DLM_ECANCEL		0x10001</span>
<span class="cp">#define DLM_EUNLOCK		0x10002</span>

<span class="cp">#endif  </span><span class="cm">/* __DLMCONSTANTS_DOT_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
