<!DOCTYPE html>
<html><head><title>joekychen/linux » include › linux › atm.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>atm.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* atm.h - general ATM declarations */</span>
 
<span class="cm">/* Written 1995-2000 by Werner Almesberger, EPFL LRC/ICA */</span>
 

<span class="cm">/*</span>
<span class="cm"> * WARNING: User-space programs should not #include &lt;linux/atm.h&gt; directly.</span>
<span class="cm"> *          Instead, #include &lt;atm.h&gt;</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _LINUX_ATM_H</span>
<span class="cp">#define _LINUX_ATM_H</span>

<span class="cm">/*</span>
<span class="cm"> * BEGIN_xx and END_xx markers are used for automatic generation of</span>
<span class="cm"> * documentation. Do not change them.</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/compiler.h&gt;</span>
<span class="cp">#include &lt;linux/atmapi.h&gt;</span>
<span class="cp">#include &lt;linux/atmsap.h&gt;</span>
<span class="cp">#include &lt;linux/atmioc.h&gt;</span>
<span class="cp">#include &lt;linux/types.h&gt;</span>


<span class="cm">/* general ATM constants */</span>
<span class="cp">#define ATM_CELL_SIZE		    53	</span><span class="cm">/* ATM cell size incl. header */</span><span class="cp"></span>
<span class="cp">#define ATM_CELL_PAYLOAD	    48	</span><span class="cm">/* ATM payload size */</span><span class="cp"></span>
<span class="cp">#define ATM_AAL0_SDU		    52	</span><span class="cm">/* AAL0 SDU size */</span><span class="cp"></span>
<span class="cp">#define ATM_MAX_AAL34_PDU	 65535	</span><span class="cm">/* maximum AAL3/4 PDU payload */</span><span class="cp"></span>
<span class="cp">#define ATM_AAL5_TRAILER	     8	</span><span class="cm">/* AAL5 trailer size */</span><span class="cp"></span>
<span class="cp">#define ATM_MAX_AAL5_PDU	 65535	</span><span class="cm">/* maximum AAL5 PDU payload */</span><span class="cp"></span>
<span class="cp">#define ATM_MAX_CDV		  9999	</span><span class="cm">/* maximum (default) CDV */</span><span class="cp"></span>
<span class="cp">#define ATM_NOT_RSV_VCI		    32	</span><span class="cm">/* first non-reserved VCI value */</span><span class="cp"></span>

<span class="cp">#define ATM_MAX_VPI		   255	</span><span class="cm">/* maximum VPI at the UNI */</span><span class="cp"></span>
<span class="cp">#define ATM_MAX_VPI_NNI		  4096	</span><span class="cm">/* maximum VPI at the NNI */</span><span class="cp"></span>
<span class="cp">#define ATM_MAX_VCI		 65535	</span><span class="cm">/* maximum VCI */</span><span class="cp"></span>


<span class="cm">/* &quot;protcol&quot; values for the socket system call */</span>
<span class="cp">#define ATM_NO_AAL	0		</span><span class="cm">/* AAL not specified */</span><span class="cp"></span>
<span class="cp">#define ATM_AAL0	13		</span><span class="cm">/* &quot;raw&quot; ATM cells */</span><span class="cp"></span>
<span class="cp">#define ATM_AAL1	1		</span><span class="cm">/* AAL1 (CBR) */</span><span class="cp"></span>
<span class="cp">#define ATM_AAL2	2		</span><span class="cm">/* AAL2 (VBR) */</span><span class="cp"></span>
<span class="cp">#define ATM_AAL34	3		</span><span class="cm">/* AAL3/4 (data) */</span><span class="cp"></span>
<span class="cp">#define ATM_AAL5	5		</span><span class="cm">/* AAL5 (data) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * socket option name coding functions</span>
<span class="cm"> *</span>
<span class="cm"> * Note that __SO_ENCODE and __SO_LEVEL are somewhat a hack since the</span>
<span class="cm"> * &lt;&lt; 22 only reserves 9 bits for the level.  On some architectures</span>
<span class="cm"> * SOL_SOCKET is 0xFFFF, so that&#39;s a bit of a problem</span>
<span class="cm"> */</span>

<span class="cp">#define __SO_ENCODE(l,n,t)	((((l) &amp; 0x1FF) &lt;&lt; 22) | ((n) &lt;&lt; 16) | \</span>
<span class="cp">				sizeof(t))</span>
<span class="cp">#define __SO_LEVEL_MATCH(c,m)	(((c) &gt;&gt; 22) == ((m) &amp; 0x1FF))</span>
<span class="cp">#define __SO_NUMBER(c)		(((c) &gt;&gt; 16) &amp; 0x3f)</span>
<span class="cp">#define __SO_SIZE(c)		((c) &amp; 0x3fff)</span>

<span class="cm">/*</span>
<span class="cm"> * ATM layer</span>
<span class="cm"> */</span>

<span class="cp">#define SO_SETCLP	__SO_ENCODE(SOL_ATM,0,int)</span>
			    <span class="cm">/* set CLP bit value - TODO */</span>
<span class="cp">#define SO_CIRANGE	__SO_ENCODE(SOL_ATM,1,struct atm_cirange)</span>
			    <span class="cm">/* connection identifier range; socket must be</span>
<span class="cm">			       bound or connected */</span>
<span class="cp">#define SO_ATMQOS	__SO_ENCODE(SOL_ATM,2,struct atm_qos)</span>
			    <span class="cm">/* Quality of Service setting */</span>
<span class="cp">#define SO_ATMSAP	__SO_ENCODE(SOL_ATM,3,struct atm_sap)</span>
			    <span class="cm">/* Service Access Point */</span>
<span class="cp">#define SO_ATMPVC	__SO_ENCODE(SOL_ATM,4,struct sockaddr_atmpvc)</span>
			    <span class="cm">/* &quot;PVC&quot; address (also for SVCs); get only */</span>
<span class="cp">#define SO_MULTIPOINT	__SO_ENCODE(SOL_ATM, 5, int)</span>
			    <span class="cm">/* make this vc a p2mp */</span>


<span class="cm">/*</span>
<span class="cm"> * Note @@@: since the socket layers don&#39;t really distinguish the control and</span>
<span class="cm"> * the data plane but generally seems to be data plane-centric, any layer is</span>
<span class="cm"> * about equally wrong for the SAP. If you have a better idea about this,</span>
<span class="cm"> * please speak up ...</span>
<span class="cm"> */</span>


<span class="cm">/* ATM cell header (for AAL0) */</span>

<span class="cm">/* BEGIN_CH */</span>
<span class="cp">#define ATM_HDR_GFC_MASK	0xf0000000</span>
<span class="cp">#define ATM_HDR_GFC_SHIFT	28</span>
<span class="cp">#define ATM_HDR_VPI_MASK	0x0ff00000</span>
<span class="cp">#define ATM_HDR_VPI_SHIFT	20</span>
<span class="cp">#define ATM_HDR_VCI_MASK	0x000ffff0</span>
<span class="cp">#define ATM_HDR_VCI_SHIFT	4</span>
<span class="cp">#define ATM_HDR_PTI_MASK	0x0000000e</span>
<span class="cp">#define ATM_HDR_PTI_SHIFT	1</span>
<span class="cp">#define ATM_HDR_CLP		0x00000001</span>
<span class="cm">/* END_CH */</span>


<span class="cm">/* PTI codings */</span>

<span class="cm">/* BEGIN_PTI */</span>
<span class="cp">#define ATM_PTI_US0	0  </span><span class="cm">/* user data cell, congestion not exp, SDU-type 0 */</span><span class="cp"></span>
<span class="cp">#define ATM_PTI_US1	1  </span><span class="cm">/* user data cell, congestion not exp, SDU-type 1 */</span><span class="cp"></span>
<span class="cp">#define ATM_PTI_UCES0	2  </span><span class="cm">/* user data cell, cong. experienced, SDU-type 0 */</span><span class="cp"></span>
<span class="cp">#define ATM_PTI_UCES1	3  </span><span class="cm">/* user data cell, cong. experienced, SDU-type 1 */</span><span class="cp"></span>
<span class="cp">#define ATM_PTI_SEGF5	4  </span><span class="cm">/* segment OAM F5 flow related cell */</span><span class="cp"></span>
<span class="cp">#define ATM_PTI_E2EF5	5  </span><span class="cm">/* end-to-end OAM F5 flow related cell */</span><span class="cp"></span>
<span class="cp">#define ATM_PTI_RSV_RM	6  </span><span class="cm">/* reserved for traffic control/resource mgmt */</span><span class="cp"></span>
<span class="cp">#define ATM_PTI_RSV	7  </span><span class="cm">/* reserved */</span><span class="cp"></span>
<span class="cm">/* END_PTI */</span>


<span class="cm">/*</span>
<span class="cm"> * The following items should stay in linux/atm.h, which should be linked to</span>
<span class="cm"> * netatm/atm.h</span>
<span class="cm"> */</span>

<span class="cm">/* Traffic description */</span>

<span class="cp">#define ATM_NONE	0		</span><span class="cm">/* no traffic */</span><span class="cp"></span>
<span class="cp">#define ATM_UBR		1</span>
<span class="cp">#define ATM_CBR		2</span>
<span class="cp">#define ATM_VBR		3</span>
<span class="cp">#define ATM_ABR		4</span>
<span class="cp">#define ATM_ANYCLASS	5		</span><span class="cm">/* compatible with everything */</span><span class="cp"></span>

<span class="cp">#define ATM_MAX_PCR	-1		</span><span class="cm">/* maximum available PCR */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">atm_trafprm</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">traffic_class</span><span class="p">;</span>	<span class="cm">/* traffic class (ATM_UBR, ...) */</span>
	<span class="kt">int</span>		<span class="n">max_pcr</span><span class="p">;</span>	<span class="cm">/* maximum PCR in cells per second */</span>
	<span class="kt">int</span>		<span class="n">pcr</span><span class="p">;</span>		<span class="cm">/* desired PCR in cells per second */</span>
	<span class="kt">int</span>		<span class="n">min_pcr</span><span class="p">;</span>	<span class="cm">/* minimum PCR in cells per second */</span>
	<span class="kt">int</span>		<span class="n">max_cdv</span><span class="p">;</span>	<span class="cm">/* maximum CDV in microseconds */</span>
	<span class="kt">int</span>		<span class="n">max_sdu</span><span class="p">;</span>	<span class="cm">/* maximum SDU in bytes */</span>
        <span class="cm">/* extra params for ABR */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> 	<span class="n">icr</span><span class="p">;</span>         	<span class="cm">/* Initial Cell Rate (24-bit) */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">tbe</span><span class="p">;</span>		<span class="cm">/* Transient Buffer Exposure (24-bit) */</span> 
        <span class="kt">unsigned</span> <span class="kt">int</span> 	<span class="n">frtt</span> <span class="o">:</span> <span class="mi">24</span><span class="p">;</span>	<span class="cm">/* Fixed Round Trip Time (24-bit) */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> 	<span class="n">rif</span>  <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>       <span class="cm">/* Rate Increment Factor (4-bit) */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> 	<span class="n">rdf</span>  <span class="o">:</span> <span class="mi">4</span><span class="p">;</span>       <span class="cm">/* Rate Decrease Factor (4-bit) */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nrm_pres</span>  <span class="o">:</span><span class="mi">1</span><span class="p">;</span>      <span class="cm">/* nrm present bit */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">trm_pres</span>  <span class="o">:</span><span class="mi">1</span><span class="p">;</span>     	<span class="cm">/* rm present bit */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adtf_pres</span> <span class="o">:</span><span class="mi">1</span><span class="p">;</span>     	<span class="cm">/* adtf present bit */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cdf_pres</span>  <span class="o">:</span><span class="mi">1</span><span class="p">;</span>    	<span class="cm">/* cdf present bit*/</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nrm</span>       <span class="o">:</span><span class="mi">3</span><span class="p">;</span>     	<span class="cm">/* Max # of Cells for each forward RM cell (3-bit) */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">trm</span>       <span class="o">:</span><span class="mi">3</span><span class="p">;</span>    	<span class="cm">/* Time between forward RM cells (3-bit) */</span>    
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">adtf</span>      <span class="o">:</span><span class="mi">10</span><span class="p">;</span>     <span class="cm">/* ACR Decrease Time Factor (10-bit) */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cdf</span>       <span class="o">:</span><span class="mi">3</span><span class="p">;</span>      <span class="cm">/* Cutoff Decrease Factor (3-bit) */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">spare</span>     <span class="o">:</span><span class="mi">9</span><span class="p">;</span>      <span class="cm">/* spare bits */</span> 
<span class="p">};</span>

<span class="k">struct</span> <span class="n">atm_qos</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">atm_trafprm</span> <span class="n">txtp</span><span class="p">;</span>	<span class="cm">/* parameters in TX direction */</span>
	<span class="k">struct</span> <span class="n">atm_trafprm</span> <span class="n">rxtp</span> <span class="n">__ATM_API_ALIGN</span><span class="p">;</span>
					<span class="cm">/* parameters in RX direction */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">aal</span> <span class="n">__ATM_API_ALIGN</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* PVC addressing */</span>

<span class="cp">#define ATM_ITF_ANY	-1		</span><span class="cm">/* &quot;magic&quot; PVC address values */</span><span class="cp"></span>
<span class="cp">#define ATM_VPI_ANY	-1</span>
<span class="cp">#define ATM_VCI_ANY	-1</span>
<span class="cp">#define ATM_VPI_UNSPEC	-2</span>
<span class="cp">#define ATM_VCI_UNSPEC	-2</span>


<span class="k">struct</span> <span class="n">sockaddr_atmpvc</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> 	<span class="n">sap_family</span><span class="p">;</span>	<span class="cm">/* address family, AF_ATMPVC  */</span>
	<span class="k">struct</span> <span class="p">{</span>			<span class="cm">/* PVC address */</span>
		<span class="kt">short</span>	<span class="n">itf</span><span class="p">;</span>		<span class="cm">/* ATM interface */</span>
		<span class="kt">short</span>	<span class="n">vpi</span><span class="p">;</span>		<span class="cm">/* VPI (only 8 bits at UNI) */</span>
		<span class="kt">int</span>	<span class="n">vci</span><span class="p">;</span>		<span class="cm">/* VCI (only 16 bits at UNI) */</span>
	<span class="p">}</span> <span class="n">sap_addr</span> <span class="n">__ATM_API_ALIGN</span><span class="p">;</span>	<span class="cm">/* PVC address */</span>
<span class="p">};</span>

<span class="cm">/* SVC addressing */</span>

<span class="cp">#define	ATM_ESA_LEN	20		</span><span class="cm">/* ATM End System Address length */</span><span class="cp"></span>
<span class="cp">#define ATM_E164_LEN	12		</span><span class="cm">/* maximum E.164 number length */</span><span class="cp"></span>

<span class="cp">#define ATM_AFI_DCC	0x39		</span><span class="cm">/* DCC ATM Format */</span><span class="cp"></span>
<span class="cp">#define ATM_AFI_ICD	0x47		</span><span class="cm">/* ICD ATM Format */</span><span class="cp"></span>
<span class="cp">#define ATM_AFI_E164	0x45		</span><span class="cm">/* E.164 ATM Format */</span><span class="cp"></span>
<span class="cp">#define ATM_AFI_LOCAL	0x49		</span><span class="cm">/* Local ATM Format */</span><span class="cp"> </span>

<span class="cp">#define ATM_AFI_DCC_GROUP	0xBD	</span><span class="cm">/* DCC ATM Group Format */</span><span class="cp"></span>
<span class="cp">#define ATM_AFI_ICD_GROUP	0xC5	</span><span class="cm">/* ICD ATM Group Format */</span><span class="cp"></span>
<span class="cp">#define ATM_AFI_E164_GROUP	0xC3	</span><span class="cm">/* E.164 ATM Group Format */</span><span class="cp"></span>
<span class="cp">#define ATM_AFI_LOCAL_GROUP	0xC7	</span><span class="cm">/* Local ATM Group Format */</span><span class="cp"></span>

<span class="cp">#define ATM_LIJ_NONE	0		</span><span class="cm">/* no leaf-initiated join */</span><span class="cp"></span>
<span class="cp">#define ATM_LIJ		1		</span><span class="cm">/* request joining */</span><span class="cp"></span>
<span class="cp">#define ATM_LIJ_RPJ	2		</span><span class="cm">/* set to root-prompted join */</span><span class="cp"></span>
<span class="cp">#define ATM_LIJ_NJ	3		</span><span class="cm">/* set to network join */</span><span class="cp"></span>


<span class="k">struct</span> <span class="n">sockaddr_atmsvc</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">short</span> 	<span class="n">sas_family</span><span class="p">;</span>	<span class="cm">/* address family, AF_ATMSVC */</span>
    <span class="k">struct</span> <span class="p">{</span>				<span class="cm">/* SVC address */</span>
        <span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">prv</span><span class="p">[</span><span class="n">ATM_ESA_LEN</span><span class="p">];</span><span class="cm">/* private ATM address */</span>
        <span class="kt">char</span>		<span class="n">pub</span><span class="p">[</span><span class="n">ATM_E164_LEN</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> <span class="cm">/* public address (E.164) */</span>
    					<span class="cm">/* unused addresses must be bzero&#39;ed */</span>
	<span class="kt">char</span>		<span class="n">lij_type</span><span class="p">;</span>	<span class="cm">/* role in LIJ call; one of ATM_LIJ* */</span>
	<span class="n">__u32</span>	<span class="n">lij_id</span><span class="p">;</span>		<span class="cm">/* LIJ call identifier */</span>
    <span class="p">}</span> <span class="n">sas_addr</span> <span class="n">__ATM_API_ALIGN</span><span class="p">;</span>		<span class="cm">/* SVC address */</span>
<span class="p">};</span>


<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">int</span> <span class="nf">atmsvc_addr_in_use</span><span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr_atmsvc</span> <span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="o">*</span><span class="n">addr</span><span class="p">.</span><span class="n">sas_addr</span><span class="p">.</span><span class="n">prv</span> <span class="o">||</span> <span class="o">*</span><span class="n">addr</span><span class="p">.</span><span class="n">sas_addr</span><span class="p">.</span><span class="n">pub</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="n">__inline__</span> <span class="kt">int</span> <span class="nf">atmpvc_addr_in_use</span><span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr_atmpvc</span> <span class="n">addr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">addr</span><span class="p">.</span><span class="n">sap_addr</span><span class="p">.</span><span class="n">itf</span> <span class="o">||</span> <span class="n">addr</span><span class="p">.</span><span class="n">sap_addr</span><span class="p">.</span><span class="n">vpi</span> <span class="o">||</span> <span class="n">addr</span><span class="p">.</span><span class="n">sap_addr</span><span class="p">.</span><span class="n">vci</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * Some stuff for linux/sockios.h</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">atmif_sioc</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">number</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">length</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">arg</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#ifdef CONFIG_COMPAT</span>
<span class="cp">#include &lt;linux/compat.h&gt;</span>
<span class="k">struct</span> <span class="n">compat_atmif_sioc</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">number</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">compat_uptr_t</span> <span class="n">arg</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#endif</span>
<span class="cp">#endif</span>

<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">atm_backend_t</span><span class="p">;</span>
<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
