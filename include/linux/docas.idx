f | virtio_console.h | s | 3.0K | 70 | Rusty Russell | rusty@rustcorp.com.au | 1306719854 |  | virtio: add full three-clause BSD text to headers.  It's unclear to me if it's important, but it's obviously causing my technical colleages some headaches and I'd hate such imprecision to slow virtio adoption.  I've emailed this to all non-trivial contributors for approval, too.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Ryan Harper <ryanh@us.ibm.com> Acked-by: Anthony Liguori <aliguori@us.ibm.com> Acked-by: Eric Van Hensbergen <ericvh@gmail.com> Acked-by: john cooper <john.cooper@redhat.com> Acked-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Acked-by: Christian Borntraeger <borntraeger@de.ibm.com> Acked-by: Fernando Luis Vazquez Cao <fernando@oss.ntt.co.jp>
f | kvm_para.h | s | 808B | 31 | Alexander Graf | agraf@suse.de | 1324978001 |  | KVM: Fix whitespace in kvm_para.h  When syncing KVM headers with QEMU I (or whoever applies the diff) end up automatically fixing whitespaces. One of them is in kvm_para.h.  It's a lot more consistent for people who don't do the whitespace fixups automatically to already have fixed headers in Linux. So remove the sparse empty line at the end of kvm_para.h and everyone's happy.  Reported-by: Blue Swirl <blauwirbel@gmail.com> Signed-off-by: Alexander Graf <agraf@suse.de>
f | meye.h | s | 2.5K | 60 | Hans Verkuil | hverkuil@xs4all.nl | 1274154756 |  | V4L/DVB: meye: remove last V4L1 remnants from the code and add v4l2_device  Signed-off-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | bottom_half.h | s | 224B | 7 | Liming Wang | liming.wang@windriver.com | 1227872318 |  | softirq: remove useless function __local_bh_enable  Impact: remove unused code  __local_bh_enable has been replaced with _local_bh_enable. As comments says "it always nests inside local_bh_enable() sections" has not been valid now. Also there is no reason to use __local_bh_enable anywhere, so we can remove this useless function.  Signed-off-by: Liming Wang <liming.wang@windriver.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | clk-private.h | s | 5.3K | 179 | Sascha Hauer | s.hauer@pengutronix.de | 1336511605 |  | clk: add a fixed factor clock  Having fixed factors/dividers in hardware is a common pattern, so add a basic clock type doing this. It basically describes a fixed factor clock using a nominator and a denominator.  Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de> Reviewed-by: Viresh Kumar <viresh.kumar@st.com> Tested-by: Shawn Guo <shawn.guo@linaro.org> [mturquette@linaro.org: constify parent_names in static init macro] [mturquette@linaro.org: copy/paste bug from mux in static init macro] [mturquette@linaro.org: fix error handling in clk_register_fixed_factor] [mturquette@linaro.org: improve division accuracy; thanks to Saravana] Signed-off-by: Mike Turquette <mturquette@linaro.org>
f | ti_wilink_st.h | s | 14K | 403 | Mircea Gherzan | mgherzan@gmail.com | 1336598353 |  | ARM: OMAP: WiLink platform data for the PandaBoard  The "uim" deamon requires sysfs entries that are filled in using this platform data.  Signed-off-by: Mircea Gherzan <mgherzan@gmail.com> Signed-off-by: Tony Lindgren <tony@atomide.com>
f | s3c_adc_battery.h | s | 932B | 32 | Heiko St√ºbner | heiko@sntech.de | 1325816015 |  | s3c_adc_battery: Average over more than one adc sample  Some sources for adc battery information provide only inaccurate results where the read value differs from the real value with positive and negative offsets. For such sources it can be more accurate to collect two or more value sample and use the average of all collected values.  This patch adds pdata options volt_samples, current_samples and backup_volt_samples to specifiy the number of samples to collect, reads the specified number of samples and calculates the average of those. For unset sample-number-values a default of 1 is assumed.  Signed-off-by: Heiko Stuebner <heiko@sntech.de> Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>
f | percpu-defs.h | s | 5.7K | 143 | Ingo Molnar | mingo@elte.hu | 1288194805 |  | percpu: Remove the multi-page alignment facility  [DECLARE||DEFINE]_PER_CPU_MULTIPAGE_ALIGNED never really worked because the head percpu section was only page aligned. Now that the last user is gone (32-bit IRQ stacks), remove the generic percpu facility.  Cc: Brian Gerst <brgerst@gmail.com> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: Linus Torvalds <torvalds@linux-foundation.org> LKML-Reference: <1288158182-1753-1-git-send-email-brgerst@gmail.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | tracepoint.h | s | 12K | 356 | Ingo Molnar | mingo@elte.hu | 1330074359 |  | static keys: Introduce 'struct static_key', static_key_true()/false() and static_key_slow_[inc||dec]()  So here's a boot tested patch on top of Jason's series that does all the cleanups I talked about and turns jump labels into a more intuitive to use facility. It should also address the various misconceptions and confusions that surround jump labels.  Typical usage scenarios:          #include <linux/static_key.h>          struct static_key key = STATIC_KEY_INIT_TRUE;          if (static_key_false(&key))                 do unlikely code         else                 do likely code  Or:          if (static_key_true(&key))                 do likely code         else                 do unlikely code  The static key is modified via:          static_key_slow_inc(&key);         ...         static_key_slow_dec(&key);  The 'slow' prefix makes it abundantly clear that this is an expensive operation.  I've updated all in-kernel code to use this everywhere. Note that I (intentionally) have not pushed through the rename blindly through to the lowest levels: the actual jump-label patching arch facility should be named like that, so we want to decouple jump labels from the static-key facility a bit.  On non-jump-label enabled architectures static keys default to likely()/unlikely() branches.  Signed-off-by: Ingo Molnar <mingo@elte.hu> Acked-by: Jason Baron <jbaron@redhat.com> Acked-by: Steven Rostedt <rostedt@goodmis.org> Cc: a.p.zijlstra@chello.nl Cc: mathieu.desnoyers@efficios.com Cc: davem@davemloft.net Cc: ddaney.cavm@gmail.com Cc: Linus Torvalds <torvalds@linux-foundation.org> Link: http://lkml.kernel.org/r/20120222085809.GA26397@elte.hu Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | aio_abi.h | s | 3.0K | 95 | H. Peter Anvin | hpa@zytor.com | 1329770928 |  | aio: Use __kernel_ulong_t to define aio_context_t  Rather than using "unsigned long" which is ABI-dependent, use __kernel_ulong_t to define the externally visible type aio_context_t.  Note: the change in this form will cause unsigned long/unsigned int differences on existing ABIs.  If that is unacceptable we may have to define a new type.  Signed-off-by: H. Peter Anvin <hpa@zytor.com> Cc: Benjamin LaHaise <bcrl@kvack.org>
f | io.h | s | 2.1K | 61 | Kenji Kaneshige | kaneshige.kenji@jp.fujitsu.com | 1278700923 |  | x86, ioremap: Fix incorrect physical address handling in PAE mode  Current x86 ioremap() doesn't handle physical address higher than 32-bit properly in X86_32 PAE mode. When physical address higher than 32-bit is passed to ioremap(), higher 32-bits in physical address is cleared wrongly. Due to this bug, ioremap() can map wrong address to linear address space.  In my case, 64-bit MMIO region was assigned to a PCI device (ioat device) on my system. Because of the ioremap()'s bug, wrong physical address (instead of MMIO region) was mapped to linear address space. Because of this, loading ioatdma driver caused unexpected behavior (kernel panic, kernel hangup, ...).  Signed-off-by: Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com> LKML-Reference: <4C1AE680.7090408@jp.fujitsu.com> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>
f | isdn_divertif.h | s | 1.9K | 45 | David Howells | dhowells@redhat.com | 1323768405 |  | UAPI: Guard linux/isdn_divertif.h  Place reinclusion guards on linux/isdn_divertif.h otherwise the UAPI splitter script won't insert the #include to include the UAPI header from the kernel header.  Signed-off-by: David Howells <dhowells@redhat.com>
f | console_struct.h | s | 5.0K | 126 | Alan Cox | alan@linux.intel.com | 1281473262 |  | tty: Move the vt_tty field from the vc_data into the standard tty_port  This takes all the tty references through the expected interface points so we can refcount them.  Signed-off-by: Alan Cox <alan@linux.intel.com> Cc: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | rwlock.h | s | 4.3K | 108 | Luca Barbieri | luca@luca-barbieri.com | 1268439681 |  | locking: Make sparse work with inline spinlocks and rwlocks  Currently sparse does not work with inline spinlock and rwlock functions. The problem is that they do not use the __acquires/__releases out-of-line functions, but use inline functions with no sparse annotations.  This patch adds the appropriate annotations to make it work properly.  Signed-off-by: Luca Barbieri <luca@luca-barbieri.com> Cc: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | udp.h | s | 3.0K | 86 | Eric Dumazet | eric.dumazet@gmail.com | 1257915278 |  | udp: bind() optimisation  UDP bind() can be O(N^2) in some pathological cases.  Thanks to secondary hash tables, we can make it O(N)  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | udf_fs_i.h | s | 634B | 19 | Christoph Hellwig | hch@lst.de | 1208434943 |  | udf: move headers out include/linux/  There's really no reason to keep udf headers in include/linux as they're not used by anything but fs/udf/.  This patch merges most of include/linux/udf_fs_i.h into fs/udf/udf_i.h, include/linux/udf_fs_sb.h into fs/udf/udf_sb.h and include/linux/udf_fs.h into fs/udf/udfdecl.h.  The only thing remaining in include/linux/ is a stub of udf_fs_i.h defining the four user-visible udf ioctls.  It's also moved from unifdef-y to headers-y because it can be included unconditionally now.  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Jan Kara <jack@suse.cz>
f | slab.h | s | 11K | 334 | Xi Wang | xi.wang@gmail.com | 1338511766 |  | introduce SIZE_MAX  ULONG_MAX is often used to check for integer overflow when calculating allocation size.  While ULONG_MAX happens to work on most systems, there is no guarantee that `size_t' must be the same size as `long'.  This patch introduces SIZE_MAX, the maximum value of `size_t', to improve portability and readability for allocation size validation.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Acked-by: Alex Elder <elder@dreamhost.com> Cc: David Airlie <airlied@linux.ie> Cc: Pekka Enberg <penberg@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | alarmtimer.h | s | 2.1K | 67 | John Stultz | john.stultz@linaro.org | 1334958996 |  | alarmtimer: Provide accessor to alarmtimer rtc device  The Android alarm interface provides a settime call that sets both the alarmtimer RTC device and CLOCK_REALTIME to the same value.  Since there may be multiple rtc devices, provide a hook to access the one the alarmtimer infrastructure is using.  CC: Colin Cross <ccross@android.com> CC: Thomas Gleixner <tglx@linutronix.de> CC: Android Kernel Team <kernel-team@android.com> Signed-off-by: John Stultz <john.stultz@linaro.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | llc.h | s | 3.2K | 83 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | hash.h | s | 1.8K | 60 | Ian Campbell | ian.campbell@citrix.com | 1313611220 |  | mm: make HASHED_PAGE_VIRTUAL page_address' struct page argument const.  Followup to 33dd4e0ec911 "mm: make some struct page's const" which missed the HASHED_PAGE_VIRTUAL case.  Signed-off-by: Ian Campbell <ian.campbell@citrix.com> Cc: Andrea Arcangeli <aarcange@redhat.com> Cc: Rik van Riel <riel@redhat.com> Cc: Michel Lespinasse <walken@google.com> Cc: Mel Gorman <mel@csn.ul.ie> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | sunrpc |  | 30 items |  | J. Bruce Fields | bfields@redhat.com | 1338510598 |  | nfsd4: move rq_flavor into svc_cred  Move the rq_flavor into struct svc_cred, and use it in setclientid and exchange_id comparisons as well.  Signed-off-by: J. Bruce Fields <bfields@redhat.com>
f | mount.h | s | 2.3K | 65 | Al Viro | viro@zeniv.linux.org.uk | 1325649432 |  | vfs: move fsnotify junk to struct mount  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | vmalloc.h | s | 4.8K | 139 | Russell King | rmk+kernel@arm.linux.org.uk | 1323127679 |  | Merge branch 'vmalloc' of git://git.linaro.org/people/nico/linux into devel-stable
f | timerqueue.h | s | 1.1K | 41 | John Stultz | john.stultz@linaro.org | 1303851702 |  | timers: Add rb_init_node() to allow for stack allocated rb nodes  In cases where a timerqueue_node or some structure that utilizes a timerqueue_node is allocated on the stack, gcc would give warnings caused by the timerqueue_init()'s calling RB_CLEAR_NODE, which self-references the nodes uninitialized data.  The solution is to create an rb_init_node() function that zeros the rb_node structure out and then calls RB_CLEAR_NODE(), and then call the new init function from timerqueue_init().  CC: Thomas Gleixner <tglx@linutronix.de> Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: John Stultz <john.stultz@linaro.org>
f | if_link.h | s | 9.4K | 340 | John Fastabend | john.r.fastabend@intel.com | 1334509565 |  | macvlan: add FDB bridge ops and macvlan flags  This adds FDB bridge ops to the macvlan device passthru mode. Additionally a flags field was added and a NOPROMISC bit to allow users to use passthru mode without the driver calling dev_set_promiscuity(). The flags field is a u16 placed in a 4 byte hole (consuming 2 bytes) of the macvlan_dev struct.  We want to do this so that the macvlan driver or stack above the macvlan driver does not have to process every packet. For the use case where we know all the MAC addresses of the endstations above us this works well.  This patch is a result of Roopa Prabhu's work. Follow up patches are needed for VEPA and VEB macvlan modes.  v2: Change from distinct nopromisc mode to a flags field to     configure this. This avoids the tendency to add a new     mode every time we need some slightly different behavior. v3: fix error in dev_set_promiscuity and add change and get     link attributes for flags.  CC: Roopa Prabhu <roprabhu@cisco.com> CC: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: John Fastabend <john.r.fastabend@intel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | trace_seq.h | s | 2.4K | 88 | Al Viro | viro@zeniv.linux.org.uk | 1332293380 |  | constify path argument of trace_seq_path()  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | cciss_ioctl.h | s | 3.6K | 91 | dann frazier | dannf@hp.com | 1266842685 |  | cciss: Consolidate duplicate bits in cciss_cmd.h & cciss_ioctl.h  There are several duplicate definitions in cciss_cmd.h and cciss_ioctl.h. Consolidate these into the new cciss_defs.h file. This patch doesn't change the definitions exposed under include/linux, so userspace apps shouldn't be affected.  Acked-by: Stephen M. Cameron <scameron@beardog.cce.hp.com> Signed-off-by: dann frazier <dannf@hp.com> Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
f | tsacct_kern.h | s | 920B | 27 | Jay Lan | jlan@engr.sgi.com | 1159688369 |  | [PATCH] csa: convert CONFIG tag for extended accounting routines  There were a few accounting data/macros that are used in CSA but are #ifdef'ed inside CONFIG_BSD_PROCESS_ACCT.  This patch is to change those ifdef's from CONFIG_BSD_PROCESS_ACCT to CONFIG_TASK_XACCT.  A few defines are moved from kernel/acct.c and include/linux/acct.h to kernel/tsacct.c and include/linux/tsacct_kern.h.  Signed-off-by: Jay Lan <jlan@sgi.com> Cc: Shailabh Nagar <nagar@watson.ibm.com> Cc: Balbir Singh <balbir@in.ibm.com> Cc: Jes Sorensen <jes@sgi.com> Cc: Chris Sturtivant <csturtiv@sgi.com> Cc: Tony Ernst <tee@sgi.com> Cc: Guillaume Thouvenin <guillaume.thouvenin@bull.net> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | oprofile.h | s | 6.3K | 178 | Thomas Gleixner | tglx@linutronix.de | 1315905125 |  | locking, oprofile: Annotate oprofilefs lock as raw  The oprofilefs_lock can be taken in atomic context (in profiling interrupts) and therefore cannot cannot be preempted on -rt - annotate it.  In mainline this change documents the low level nature of the lock - otherwise there's no functional difference. Lockdep and Sparse checking will work as usual.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | of_pdt.h | s | 1.4K | 36 | Andres Salomon | dilinger@queued.net | 1286942288 |  | of/promtree: add package-to-path support to pdt  package-to-path is a PROM function which tells us the real (full) name of the node.  This provides a hook for that in the prom ops struct, and makes use of it in the pdt code when attempting to determine a node's name.  If the hook is available, try using it (falling back to looking at the "name" property if it fails).  Signed-off-by: Andres Salomon <dilinger@queued.net> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | parser.h | s | 923B | 27 | Steven Whitehouse | swhiteho@redhat.com | 1223917837 |  | vfs: Use const for kernel parser table  This is a much better version of a previous patch to make the parser tables constant. Rather than changing the typedef, we put the "const" in all the various places where its required, allowing the __initconst exception for nfsroot which was the cause of the previous trouble.  This was posted for review some time ago and I believe its been in -mm since then.  Signed-off-by: Steven Whitehouse <swhiteho@redhat.com> Cc: Alexander Viro <aviro@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | i2c-pxa.h | s | 399B | 14 | Russell King | rmk@dyn-67.arm.linux.org.uk | 1164889485 |  | [ARM] Remove EEPROM slave emulation from i2c-pxa driver.  The i2c-pxa driver should not contain EEPROM slave-mode emulation; this is something the platform should provide where required.  Remove it.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | sh_clk.h | s | 5.2K | 153 | Paul Mundt | lethal@linux-sh.org | 1334113550 |  | sh: clkfwk: Support variable size accesses for MSTP clocks.  The bulk of the MSTP users require 32-bit access, but this isn't the case for some of the SH-2A parts, so add in some basic infrastructure to let the CPU define its required access size in preparation.  Requested-by: Phil Edworthy <phil.edworthy@renesas.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | pci_regs.h | s | 36K | 687 | Anthony PERARD | anthony.perard@citrix.com | 1330027521 |  | PCI: Add PCI_EXP_TYPE_PCIE_BRIDGE value  Signed-off-by: Anthony PERARD <anthony.perard@citrix.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | isdn_ppp.h | s | 7.9K | 210 | David S. Miller | davem@davemloft.net | 1258352627 |  | Revert "isdn: isdn_ppp: Use SKB list facilities instead of home-grown implementation."  This reverts commit 38783e671399b5405f1fd177d602c400a9577ae6.  It causes kernel bugzilla #14594  Signed-off-by: David S. Miller <davem@davemloft.net>
f | bfs_fs.h | s | 1.8K | 65 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233339006 |  | headers_check fix: linux/bfs_fs.h  fix the following 'make headers_check' warning:    usr/include/linux/bfs_fs.h:24: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | pci.h | s | 57K | 1477 | Alan Stern | stern@rowland.harvard.edu | 1339618299 |  | USB: add NO_D3_DURING_SLEEP flag and revert 151b61284776be2  This patch (as1558) fixes a problem affecting several ASUS computers: The machine crashes or corrupts memory when going into suspend if the ehci-hcd driver is bound to any controllers.  Users have been forced to unbind or unload ehci-hcd before putting their systems to sleep.  After extensive testing, it was determined that the machines don't like going into suspend when any EHCI controllers are in the PCI D3 power state.  Presumably this is a firmware bug, but there's nothing we can do about it except to avoid putting the controllers in D3 during system sleep.  The patch adds a new flag to indicate whether the problem is present, and avoids changing the controller's power state if the flag is set. Runtime suspend is unaffected; this matters only for system suspend. However as a side effect, the controller will not respond to remote wakeup requests while the system is asleep.  Hence USB wakeup is not functional -- but of course, this is already true in the current state of affairs.  A similar patch has already been applied as commit 151b61284776be2d6f02d48c23c3625678960b97 (USB: EHCI: fix crash during suspend on ASUS computers).  The patch supersedes that one and reverts it.  There are two differences:  	The old patch added the flag at the USB level; this patch 	adds it at the PCI level.  	The old patch applied to all chipsets with the same vendor, 	subsystem vendor, and product IDs; this patch makes an 	exception for a known-good system (based on DMI information).  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Tested-by: D√¢niel Fraga <fragabr@gmail.com> Tested-by: Andrey Rahmatullin <wrar@wrar.name> Tested-by: Steven Rostedt <rostedt@goodmis.org> Cc: stable <stable@vger.kernel.org> Reviewed-by: Rafael J. Wysocki <rjw@sisk.pl> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | smc91x.h | s | 1.0K | 27 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | b1lli.h | s | 1.6K | 62 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | htcpld.h | s | 578B | 19 | Cory Maccarrone | darkstar6262@gmail.com | 1267996629 |  | mfd: Add HTCPLD driver  This change introduces a driver for the HTC PLD chip found on some smartphones, such as the HTC Wizard and HTC Herald. It works through the I2C bus and acts as a GPIO extender. Specifically:   * it can have several sub-devices, each with its own I2C    address  * Each sub-device provides 8 output and 8 input pins  * The chip attaches to one GPIO to signal when any of the    input GPIOs change -- at which point all chips must be    scanned for changes  This driver implements the GPIOs throught the kernel's GPIO and IRQ framework.  This allows any GPIO-servicing drivers to operate on htcpld pins, such as the gpio-keys and gpio-leds drivers.  Signed-off-by: Cory Maccarrone <darkstar6262@gmail.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | nfs3.h | s | 2.4K | 91 | Chuck Lever | chuck.lever@oracle.com | 1292521043 |  | NFS: Introduce new-style XDR decoding functions for NFSv2  We'd like to prevent local buffer overflows caused by malicious or broken servers.  New xdr_stream style decoders can do that.  For efficiency, we also eventually want to be able to pass xdr_streams from call_decode() to all XDR decoding functions, rather than building an xdr_stream in every XDR decoding function in the kernel.  Static helper functions are left without the "inline" directive.  This allows the compiler to choose automatically how to optimize these for size or speed.  Signed-off-by: Chuck Lever <chuck.lever@oracle.com> Tested-by: J. Bruce Fields <bfields@redhat.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | uuid.h | s | 2.1K | 60 | Tomas Winkler | tomas.winkler@intel.com | 1336597050 |  | uuid: add uuid.h to exported header list  uuid is used in mei.h interface  Signed-off-by: Tomas Winkler <tomas.winkler@intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | mutex-debug.h | s | 442B | 17 | Harvey Harrison | harvey.harrison@gmail.com | 1202948478 |  | include/linux: Remove all users of FASTCALL() macro  FASTCALL() is always expanded to empty, remove it.  [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | via_i2c.h | s | 1.5K | 34 | Jonathan Corbet | corbet@lwn.net | 1273615679 |  | viafb: move some include files to include/linux  These are the files which should be available to subdevices compiled outside of drivers/video/via.  Cc: ScottFang@viatech.com.cn Cc: JosephChan@via.com.tw Cc: Harald Welte <laforge@gnumonks.org> Acked-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Signed-off-by: Jonathan Corbet <corbet@lwn.net>
f | dnotify.h | s | 1008B | 37 | Alexey Dobriyan | adobriyan@gmail.com | 1280325541 |  | dnotify: move dir_notify_enable declaration  Move dir_notify_enable declaration to where it belongs -- dnotify.h .  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Eric Paris <eparis@redhat.com>
f | pfkeyv2.h | s | 9.9K | 333 | Tobias Brunner | tobias@strongswan.org | 1263725531 |  | crypto: gcm - Add RFC4543 wrapper for GCM  This patch adds the RFC4543 (GMAC) wrapper for GCM similar to the existing RFC4106 wrapper. The main differences between GCM and GMAC are the contents of the AAD and that the plaintext is empty for the latter.  Signed-off-by: Tobias Brunner <tobias@strongswan.org> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
d | hdlc |  | 2 items |  | Krzysztof Halasa | khc@pm.waw.pl | 1159306824 |  | [PATCH] Modularize generic HDLC  This patch enables building of individual WAN protocol support routines (parts of generic HDLC) as separate modules. All protocol-private definitions are moved from hdlc.h file to protocol drivers. User-space interface and interface between generic HDLC and underlying low-level HDLC drivers are unchanged.  Signed-off-by: Krzysztof Halasa <khc@pm.waw.pl> Signed-off-by: Jeff Garzik <jeff@garzik.org>
f | prio_tree.h | s | 3.2K | 100 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | bootmem.h | s | 5.2K | 149 | Johannes Weiner | hannes@cmpxchg.org | 1338333742 |  | mm: remove sparsemem allocation details from the bootmem allocator  alloc_bootmem_section() derives allocation area constraints from the specified sparsemem section.  This is a bit specific for a generic memory allocator like bootmem, though, so move it over to sparsemem.  As __alloc_bootmem_node_nopanic() already retries failed allocations with relaxed area constraints, the fallback code in sparsemem.c can be removed and the code becomes a bit more compact overall.  [akpm@linux-foundation.org: fix build] Signed-off-by: Johannes Weiner <hannes@cmpxchg.org> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: David S. Miller <davem@davemloft.net> Cc: Yinghai Lu <yinghai@kernel.org> Cc: Gavin Shan <shangw@linux.vnet.ibm.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | compat.h | s | 21K | 532 | Christopher Yeoh | cyeoh@au1.ibm.com | 1338511772 |  | aio/vfs: cleanup of rw_copy_check_uvector() and compat_rw_copy_check_uvector()  A cleanup of rw_copy_check_uvector and compat_rw_copy_check_uvector after changes made to support CMA in an earlier patch.  Rather than having an additional check_access parameter to these functions, the first paramater type is overloaded to allow the caller to specify CHECK_IOVEC_ONLY which means check that the contents of the iovec are valid, but do not check the memory that they point to.  This is used by process_vm_readv/writev where we need to validate that a iovec passed to the syscall is valid but do not want to check the memory that it points to at this point because it refers to an address space in another process.  Signed-off-by: Chris Yeoh <yeohc@au1.ibm.com> Reviewed-by: Oleg Nesterov <oleg@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | connector.h | s | 3.5K | 111 | K. Y. Srinivasan | kys@microsoft.com | 1328225447 |  | drivers: hv: kvp: Add/cleanup connector defines  The current KVP code carries some private connector related defines. Update connector.h to have all the KVP defines. As part of this patch get rid of some unused defines.  Signed-off-by: K. Y. Srinivasan <kys@microsoft.com> Signed-off-by: Haiyang Zhang <haiyangz@microsoft.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | pps_kernel.h | s | 3.0K | 94 | Alexander Gordeev | lasaine@lvk.cs.msu.su | 1294934601 |  | pps: capture MONOTONIC_RAW timestamps as well  MONOTONIC_RAW clock timestamps are ideally suited for frequency calculation and also fit well into the original NTP hardpps design.  Now phase and frequency can be adjusted separately: the former based on REALTIME clock and the latter based on MONOTONIC_RAW clock.  A new function getnstime_raw_and_real is added to timekeeping subsystem to capture both timestamps at the same time and atomically.  Signed-off-by: Alexander Gordeev <lasaine@lvk.cs.msu.su> Acked-by: John Stultz <johnstul@us.ibm.com> Cc: Rodolfo Giometti <giometti@enneenne.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | audit.h | s | 26K | 665 | Kees Cook | keescook@chromium.org | 1334366000 |  | seccomp: remove duplicated failure logging  This consolidates the seccomp filter error logging path and adds more details to the audit log.  Signed-off-by: Will Drewry <wad@chromium.org> Signed-off-by: Kees Cook <keescook@chromium.org> Acked-by: Eric Paris <eparis@redhat.com>  v18: make compat= permanent in the record v15: added a return code to the audit_seccomp path by wad@chromium.org      (suggested by eparis@redhat.com) v*: original by keescook@chromium.org Signed-off-by: James Morris <james.l.morris@oracle.com>
f | cordic.h | s | 1.8K | 44 | Michael Witten | mfwitten@gmail.com | 1319916022 |  | Docs: wording: Insert `the'  Signed-off-by: Michael Witten <mfwitten@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | kernelcapi.h | s | 5.1K | 131 | Jan Kiszka | jan.kiszka@web.de | 1266364881 |  | CAPI: Rework controller state notifier  Another step towards proper locking: Rework the callback provided to capidrv for controller state changes. This is so far attached to an application, which would require us to hold the corresponding lock across notification calls.  But there is no direct relation between a controller up/down event and an application, so let's decouple them and provide a notifier call chain for those events instead. This notifier chain is first of all used internally. Here we request the highest priority to unsure that housekeeping work is done before any other notifications. The chain is exported via [un]register_capictr_notifier to our only user, capidrv, to replace the racy and unfixable capi20_set_callback.  Signed-off-by: Jan Kiszka <jan.kiszka@web.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | rpmsg.h | s | 11K | 302 | Ohad Ben-Cohen | ohad@wizery.com | 1328734438 |  | rpmsg: add virtio-based remote processor messaging bus  Add a virtio-based inter-processor communication bus, which enables kernel drivers to communicate with entities, running on remote processors, over shared memory using a simple messaging protocol.  Every pair of AMP processors share two vrings, which are used to send and receive the messages over shared memory.  The header of every message sent on the rpmsg bus contains src and dst addresses, which make it possible to multiplex several rpmsg channels on the same vring.  Every rpmsg channel is a device on this bus. When a channel is added, and an appropriate rpmsg driver is found and probed, it is also assigned a local rpmsg address, which is then bound to the driver's callback.  When inbound messages carry the local address of a bound driver, its callback is invoked by the bus.  This patch provides a kernel interface only; user space interfaces will be later exposed by kernel users of this rpmsg bus.  Designed with Brian Swetland <swetland@google.com>.  Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com> Acked-by: Rusty Russell <rusty@rustcorp.com.au> (virtio_ids.h) Cc: Brian Swetland <swetland@google.com> Cc: Arnd Bergmann <arnd@arndb.de> Cc: Grant Likely <grant.likely@secretlab.ca> Cc: Tony Lindgren <tony@atomide.com> Cc: Russell King <linux@arm.linux.org.uk> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Greg KH <greg@kroah.com> Cc: Stephen Boyd <sboyd@codeaurora.org>
f | rose.h | s | 2.1K | 76 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | hiddev.h | s | 7.0K | 211 | Alan Stern | stern@rowland.harvard.edu | 1285329824 |  | HID: usbhid: remove unused hiddev_driver  Now that hiddev_driver isn't being used for anything, there's no reason to keep it around.  This patch (as1419) gets rid of it entirely.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | mv643xx_i2c.h | s | 545B | 17 | Jean Delvare | khali@linux-fr.org | 1201359841 |  | [I2C] i2c-mv64xxx: Don't set i2c_adapter.retries  I2C adapter drivers are supposed to handle retries on nack by themselves if they do, so there's no point in setting .retries if they don't.  As this retry mechanism is going away (at least in its current form), clean this up now so that we don't get build failures later.  Signed-off-by: Jean Delvare <khali@linux-fr.org> Acked-by: Mark A. Greer <mgreer@mvista.com>
f | times.h | s | 215B | 10 | Arnd Bergmann | arnd@arndb.de | 1238087654 |  | make exported headers use strict posix types  A number of standard posix types are used in exported headers, which is not allowed if __STRICT_KERNEL_NAMES is defined. In order to get rid of the non-__STRICT_KERNEL_NAMES part and to make sane headers the default, we have to change them all to safe types.  There are also still some leftovers in reiserfs_fs.h, elfcore.h and coda.h, but these files have not compiled in user space for a long time.  This leaves out the various integer types ({u_,u,}int{8,16,32,64}_t), which we take care of separately.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Cc: David Airlie <airlied@linux.ie> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Cc: netdev@vger.kernel.org Cc: linux-ppp@vger.kernel.org Cc: Jaroslav Kysela <perex@perex.cz> Cc: Takashi Iwai <tiwai@suse.de> Cc: David Woodhouse <dwmw2@infradead.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | jbd.h | s | 31K | 875 | Jan Kara | jack@suse.cz | 1337117677 |  | jbd: Write journal superblock with WRITE_FUA after checkpointing  If journal superblock is written only in disk's caches and other transaction starts reusing space of the transaction cleaned from the log, it can happen blocks of a new transaction reach the disk before journal superblock. When power failure happens in such case, subsequent journal replay would still try to replay the old transaction but some of it's blocks may be already overwritten by the new transaction. For this reason we must use WRITE_FUA when updating log tail and we must first write new log tail to disk and update in-memory information only after that.  Signed-off-by: Jan Kara <jack@suse.cz>
f | init_task.h | s | 5.7K | 195 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1338379345 |  | sched: Move nr_cpus_allowed out of 'struct sched_rt_entity'  Since nr_cpus_allowed is used outside of sched/rt.c and wants to be used outside of there more, move it to a more natural site.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Link: http://lkml.kernel.org/n/tip-kr61f02y9brwzkh6x53pdptm@git.kernel.org Signed-off-by: Ingo Molnar <mingo@kernel.org>
f | generic_acl.h | s | 351B | 9 | Christoph Hellwig | hch@lst.de | 1311618623 |  | fs: take the ACL checks to common code  Replace the ->check_acl method with a ->get_acl method that simply reads an ACL from disk after having a cache miss.  This means we can replace the ACL checking boilerplate code with a single implementation in namei.c.  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | zlib.h | s | 33K | 588 | Jim Keniston | jkenisto@linux.vnet.ibm.com | 1300841057 |  | zlib: slim down zlib_deflate() workspace when possible  Instead of always creating a huge (268K) deflate_workspace with the maximum compression parameters (windowBits=15, memLevel=8), allow the caller to obtain a smaller workspace by specifying smaller parameter values.  For example, when capturing oops and panic reports to a medium with limited capacity, such as NVRAM, compression may be the only way to capture the whole report.  In this case, a small workspace (24K works fine) is a win, whether you allocate the workspace when you need it (i.e., during an oops or panic) or at boot time.  I've verified that this patch works with all accepted values of windowBits (positive and negative), memLevel, and compression level.  Signed-off-by: Jim Keniston <jkenisto@us.ibm.com> Cc: Herbert Xu <herbert@gondor.apana.org.au> Cc: David Miller <davem@davemloft.net> Cc: Chris Mason <chris.mason@oracle.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | nfsd |  | 6 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1338513491 |  | Merge branch 'for-3.5-take-2' of git://linux-nfs.org/~bfields/linux  Pull nfsd update from Bruce Fields.  * 'for-3.5-take-2' of git://linux-nfs.org/~bfields/linux: (23 commits)   nfsd: trivial: use SEEK_SET instead of 0 in vfs_llseek   SUNRPC: split upcall function to extract reusable parts   nfsd: allocate id-to-name and name-to-id caches in per-net operations.   nfsd: make name-to-id cache allocated per network namespace context   nfsd: make id-to-name cache allocated per network namespace context   nfsd: pass network context to idmap init/exit functions   nfsd: allocate export and expkey caches in per-net operations.   nfsd: make expkey cache allocated per network namespace context   nfsd: make export cache allocated per network namespace context   nfsd: pass pointer to export cache down to stack wherever possible.   nfsd: pass network context to export caches init/shutdown routines   Lockd: pass network namespace to creation and destruction routines   NFSd: remove hard-coded dereferences to name-to-id and id-to-name caches   nfsd: pass pointer to expkey cache down to stack wherever possible.   nfsd: use hash table from cache detail in nfsd export seq ops   nfsd: pass svc_export_cache pointer as private data to "exports" seq file ops   nfsd: use exp_put() for svc_export_cache put   nfsd: use cache detail pointer from svc_export structure on cache put   nfsd: add link to owner cache detail to svc_export structure   nfsd: use passed cache_detail pointer expkey_parse()   ...
f | ext2_fs.h | s | 928B | 35 | Al Viro | viro@zeniv.linux.org.uk | 1333224196 |  | migrate ext2_fs.h guts to fs/ext2/ext2.h  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | netfilter_ipv4.h | s | 2.3K | 75 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, netfilter: Add missing #include <limits.h> for userland  Various headers use INT_MIN and INT_MAX, which are defined for userland in <limits.h>.  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Acked-by: Patrick McHardy <kaber@trash.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | gcd.h | s | 154B | 5 | Florian Fainelli | florian@openwrt.org | 1245355445 |  | lib: add lib/gcd.c  This patch adds lib/gcd.c which contains a greatest common divider implementation taken from sound/core/pcm_timer.c  Several usages of this new library function will be sent to subsystem maintainers.  [akpm@linux-foundation.org: use swap() (pointed out by Joe)] [akpm@linux-foundation.org: just add gcd.o to obj-y, remove Kconfig changes] Signed-off-by: Florian Fainelli <florian@openwrt.org> Cc: Sergei Shtylyov <sshtylyov@ru.mvista.com> Cc: Takashi Iwai <tiwai@suse.de> Cc: Simon Horman <horms@verge.net.au> Cc: Julius Volz <juliusv@google.com> Cc: David S. Miller <davem@davemloft.net> Cc: Patrick McHardy <kaber@trash.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dmar.h | s | 4.7K | 157 | Joerg Roedel | joerg.roedel@amd.com | 1336394100 |  | x86, iommu/vt-d: Clean up interfaces for interrupt remapping  Remove the Intel specific interfaces from dmar.h and remove asm/irq_remapping.h which is only used for io_apic.c anyway.  Signed-off-by: Joerg Roedel <joerg.roedel@amd.com> Acked-by: Yinghai Lu <yinghai@kernel.org> Cc: David Woodhouse <dwmw2@infradead.org> Cc: Alex Williamson <alex.williamson@redhat.com> Signed-off-by: Suresh Siddha <suresh.b.siddha@intel.com> Signed-off-by: Joerg Roedel <joerg.roedel@amd.com>
f | if_fddi.h | s | 6.1K | 184 | Changli Gao | xiaosuo@gmail.com | 1282536939 |  | header: fix broken headers for user space  __packed is only defined in kernel space, so we should use __attribute__((packed)) for the code shared between kernel and user space.  Two __attribute() annotations are replaced with __attribute__() too.  Signed-off-by: Changli Gao <xiaosuo@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | coda.h | s | 17K | 617 | Adrian Bunk | bunk@kernel.org | 1217008413 |  | coda: remove CODA_FS_OLD_API  While fixing CONFIG_ leakages to the userspace kernel headers I ran into CODA_FS_OLD_API.  After five years, are there still people using the old API left? Especially considering that you have to choose at compile time which API to support in the kernel (and distributions tend to offer the new API for some time).  Jan: "The old API can definitely go.  Around the time the new       interface went in there were some non-Coda userspace file system       implementations that took a while longer to convert to the new API,       but by now they all switched to the new interface or in some cases       to a FUSE-based solution."  Signed-off-by: Adrian Bunk <bunk@kernel.org> Acked-by: Jan Harkes <jaharkes@cs.cmu.edu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atm_he.h | s | 343B | 14 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | posix-clock.h | s | 5.3K | 130 | Justin P. Mattock | justinmattock@gmail.com | 1305015381 |  | treewide: fix a few typos in comments  - kenrel -> kernel - whetehr -> whether - ttt -> tt - sss -> ss  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | istallion.h | s | 3.5K | 113 | Alan Cox | alan@linux.intel.com | 1281473260 |  | istallion: use bit ops for the board flags  This lets us avoid problems with races on the flag changes  Signed-off-by: Alan Cox <alan@linux.intel.com> Cc: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | seq_file_net.h | s | 674B | 25 | Pavel Emelyanov | xemul@openvz.org | 1216379264 |  | proc: consolidate per-net single-release callers  They are symmetrical to single_open ones :)  Signed-off-by: Pavel Emelyanov <xemul@openvz.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ax25.h | s | 2.7K | 97 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | virtio.h | s | 3.4K | 90 | Amit Shah | amit.shah@redhat.com | 1333161590 |  | virtio: drop thaw PM operation  The thaw operation was used by the balloon driver, but after the last commit there's no reason to have separate thaw and restore callbacks.  Signed-off-by: Amit Shah <amit.shah@redhat.com>
f | cdev.h | s | 639B | 24 | Namhyung Kim | namhyung@gmail.com | 1294934597 |  | fs/char_dev.c: remove unused cdev_index()  Commit 66fa12c571d3 ("ieee1394: remove the old IEEE 1394 driver stack") eliminated the only user of cdev_index().  So it can be removed too.  Signed-off-by: Namhyung Kim <namhyung@gmail.com> Cc: Stefan Richter <stefanr@s5r6.in-berlin.de> Cc: Theodore Ts'o <tytso@mit.edu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | of_serial.h | s | 445B | 15 | Dan Williams | dan.j.williams@intel.com | 1334786873 |  | tegra, serial8250: add ->handle_break() uart_port op  The "KT" serial port has another use case for a "received break" quirk, so before adding another special case to the 8250 core take this opportunity to push such quirks out of the core and into a uart_port op.  Stephen says: "If the callback function is to no longer live in 8250.c itself,  arch/arm/mach-tegra/devices.c isn't logically a good place to put it,  and that file will be going away once we get rid of all the board files  and move solely to device tree."  ...so since 8250_pci.c houses all the quirks for pci serial devices this quirk is similarly housed in of_serial.c.  Once the open firmware conversion completes the infrastructure details (include/linux/of_serial.h, and the export) can all be removed to make this self contained to of_serial.c.  Cc: Nhan H Mai <nhan.h.mai@intel.com> Cc: Colin Cross <ccross@android.com> Cc: Olof Johansson <olof@lixom.net> [stephen: kill CONFIG_SERIAL_TEGRA in favor just using CONFIG_ARCH_TEGRA] Cc: Grant Likely <grant.likely@secretlab.ca> Acked-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Sudhakar Mamillapalli <sudhakar@fb.com> Reported-by: Alan Cox <alan@lxorguk.ukuu.org.uk> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dan Williams <dan.j.williams@intel.com> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Tested-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | zconf.h | s | 1.7K | 46 | Richard Purdie | rpurdie@rpsys.net | 1151013958 |  | [PATCH] zlib_inflate: Upgrade library code to a recent version  Upgrade the zlib_inflate implementation in the kernel from a patched version 1.1.3/4 to a patched 1.2.3.  The code in the kernel is about seven years old and I noticed that the external zlib library's inflate performance was significantly faster (~50%) than the code in the kernel on ARM (and faster again on x86_32).  For comparison the newer deflate code is 20% slower on ARM and 50% slower on x86_32 but gives an approx 1% compression ratio improvement.  I don't consider this to be an improvement for kernel use so have no plans to change the zlib_deflate code.  Various changes have been made to the zlib code in the kernel, the most significant being the extra functions/flush option used by ppp_deflate. This update reimplements the features PPP needs to ensure it continues to work.  This code has been tested on ARM under both JFFS2 (with zlib compression enabled) and ppp_deflate and on x86_32.  JFFS2 sees an approx.  10% real world file read speed improvement.  This patch also removes ZLIB_VERSION as it no longer has a correct value. We don't need version checks anyway as the kernel's module handling will take care of that for us.  This removal is also more in keeping with the zlib author's wishes (http://www.zlib.net/zlib_faq.html#faq24) and I've added something to the zlib.h header to note its a modified version.  Signed-off-by: Richard Purdie <rpurdie@rpsys.net> Acked-by: Joern Engel <joern@wh.fh-wedel.de> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | mmu_notifier.h | s | 12K | 338 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1306337959 |  | mm: convert anon_vma->lock to a mutex  Straightforward conversion of anon_vma->lock to a mutex.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Acked-by: Hugh Dickins <hughd@google.com> Reviewed-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: David Miller <davem@davemloft.net> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Jeff Dike <jdike@addtoit.com> Cc: Richard Weinberger <richard@nod.at> Cc: Tony Luck <tony.luck@intel.com> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Mel Gorman <mel@csn.ul.ie> Cc: Nick Piggin <npiggin@kernel.dk> Cc: Namhyung Kim <namhyung@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mISDNdsp.h | s | 1.2K | 33 | Karsten Keil | keil@b1-systems.de | 1243238130 |  | mISDN: Add XHFC support for embedded Speech-Design board to hfcmulti  New version without emulating arch specific stuff for the other architectures, the special IO and init functions for the 8xx microcontroller are in a separate include file.  Signed-off-by: Andreas Eversberg <andreas@eversberg.eu> Signed-off-by: Karsten Keil <keil@b1-systems.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | dns_resolver.h | s | 1.3K | 29 | Wang Lei | wang840925@gmail.com | 1281028671 |  | DNS: Separate out CIFS DNS Resolver code  Separate out the DNS resolver key type from the CIFS filesystem into its own module so that it can be made available for general use, including the AFS filesystem module.  This facility makes it possible for the kernel to upcall to userspace to have it issue DNS requests, package up the replies and present them to the kernel in a useful form.  The kernel is then able to cache the DNS replies as keys can be retained in keyrings.  Resolver keys are of type "dns_resolver" and have a case-insensitive description that is of the form "[<type>:]<domain_name>".  The optional <type> indicates the particular DNS lookup and packaging that's required.  The <domain_name> is the query to be made.  If <type> isn't given, a basic hostname to IP address lookup is made, and the result is stored in the key in the form of a printable string consisting of a comma-separated list of IPv4 and IPv6 addresses.  This key type is supported by userspace helpers driven from /sbin/request-key and configured through /etc/request-key.conf.  The cifs.upcall utility is invoked for UNC path server name to IP address resolution.  The CIFS functionality is encapsulated by the dns_resolve_unc_to_ip() function, which is used to resolve a UNC path to an IP address for CIFS filesystem.  This part remains in the CIFS module for now.  See the added Documentation/networking/dns_resolver.txt for more information.  Signed-off-by: Wang Lei <wang840925@gmail.com> Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <sfrench@us.ibm.com>
f | irq_cpustat.h | s | 910B | 24 | David Woodhouse | dwmw2@infradead.org | 1146052576 |  | Don't include linux/config.h from anywhere else in include/  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | drbd.h | s | 10.0K | 322 | Lars Ellenberg | lars.ellenberg@linbit.com | 1336644056 |  | drbd: grammar fix in log message  Signed-off-by: Philipp Reisner <philipp.reisner@linbit.com> Signed-off-by: Lars Ellenberg <lars.ellenberg@linbit.com>
f | i2c-pnx.h | s | 897B | 33 | Roland Stigge | stigge@antcom.de | 1335088787 |  | i2c: Add device tree support to i2c-pnx.c  This patch adds device tree support to the pnx-i2c driver by using platform resources for memory region and irq and removing dependency on mach includes.  The following platforms are affected:  * PNX * LPC31xx (WIP) * LPC32xx  The patch is based on a patch by Jon Smirl, working on lpc31xx integration  Signed-off-by: Roland Stigge <stigge@antcom.de> Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | if.h | s | 8.4K | 206 | Ben Greear | greearb@candelatech.com | 1330076255 |  | net: Add framework to allow sending packets with customized CRC.  This is useful for testing RX handling of frames with bad CRCs.  Requires driver support to actually put the packet on the wire properly.  Signed-off-by: Ben Greear <greearb@candelatech.com> Tested-by: Aaron Brown <aaron.f.brown@intel.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | i2c-gpio.h | s | 1.3K | 36 | Haavard Skinnemoen | hskinnemoen@atmel.com | 1178054794 |  | i2c: Bitbanging I2C bus driver using the GPIO API  This is a very simple bitbanging I2C bus driver utilizing the new arch-neutral GPIO API. Useful for chips that don't have a built-in I2C controller, additional I2C busses, or testing purposes.  To use, include something similar to the following in the board-specific setup code:    #include <linux/i2c-gpio.h>    static struct i2c_gpio_platform_data i2c_gpio_data = { 	.sda_pin	= GPIO_PIN_FOO, 	.scl_pin	= GPIO_PIN_BAR,   };   static struct platform_device i2c_gpio_device = { 	.name		= "i2c-gpio", 	.id		= 0, 	.dev		= { 		.platform_data	= &i2c_gpio_data, 	},   };  Register this platform_device, set up the I2C pins as GPIO if required and you're ready to go. This will use default values for udelay and timeout, and will work with GPIO hardware that does not support open drain mode, but allows sensing of the SDA and SCL lines even when they are being driven.  Signed-off-by: Haavard Skinnemoen <hskinnemoen@atmel.com> Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | devfreq.h | s | 8.6K | 227 | MyungJoo Ham | myungjoo.ham@samsung.com | 1332017494 |  | PM / devfreq: add relation of recommended frequency.  The semantics of "target frequency" given to devfreq driver from devfreq framework has always been interpretted as "at least" or GLB (greatest lower bound). However, the framework might want the device driver to limit its max frequency (LUB: least upper bound), especially if it is given by thermal framework (it's too hot).  Thus, the target fuction should have another parameter to express whether the framework wants GLB or LUB. And, the additional parameter, "u32 flags", does it.  With the update, devfreq_recommended_opp() is also updated.  Signed-off-by: MyungJoo Ham <myungjoo.ham@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Reviewed-by: Mike Turquette <mturquette@ti.com> Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | uio.h | s | 1.3K | 45 | Jiri Slaby | jirislaby@gmail.com | 1248919839 |  | uio: mark uio.h functions __KERNEL__ only  To avoid userspace build failures such as:  .../linux/uio.h:37: error: expected `=', `,', `;', `asm' or `__attribute__' before `iov_length' .../linux/uio.h:47: error: expected declaration specifiers or `...' before `size_t'  move uio functions inside a __KERNEL__ block.  Signed-off-by: Jiri Slaby <jirislaby@gmail.com> Acked-by: Sam Ravnborg <sam@ravnborg.org> Cc: Alexander Viro <viro@zeniv.linux.org.uk> Cc: Christoph Hellwig <hch@infradead.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atm_eni.h | s | 585B | 14 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | vhost.h | s | 4.5K | 107 | Michael S. Tsirkin | mst@redhat.com | 1263548609 |  | vhost_net: a kernel-level virtio server  What it is: vhost net is a character device that can be used to reduce the number of system calls involved in virtio networking. Existing virtio net code is used in the guest without modification.  There's similarity with vringfd, with some differences and reduced scope - uses eventfd for signalling - structures can be moved around in memory at any time (good for   migration, bug work-arounds in userspace) - write logging is supported (good for migration) - support memory table and not just an offset (needed for kvm)  common virtio related code has been put in a separate file vhost.c and can be made into a separate module if/when more backends appear.  I used Rusty's lguest.c as the source for developing this part : this supplied me with witty comments I wouldn't be able to write myself.  What it is not: vhost net is not a bus, and not a generic new system call. No assumptions are made on how guest performs hypercalls. Userspace hypervisors are supported as well as kvm.  How it works: Basically, we connect virtio frontend (configured by userspace) to a backend. The backend could be a network device, or a tap device.  Backend is also configured by userspace, including vlan/mac etc.  Status: This works for me, and I haven't see any crashes. Compared to userspace, people reported improved latency (as I save up to 4 system calls per packet), as well as better bandwidth and CPU utilization.  Features that I plan to look at in the future: - mergeable buffers - zero copy - scalability tuning: figure out the best threading model to use  Note on RCU usage (this is also documented in vhost.h, near private_pointer which is the value protected by this variant of RCU): what is happening is that the rcu_dereference() is being used in a workqueue item.  The role of rcu_read_lock() is taken on by the start of execution of the workqueue item, of rcu_read_unlock() by the end of execution of the workqueue item, and of synchronize_rcu() by flush_workqueue()/flush_work(). In the future we might need to apply some gcc attribute or sparse annotation to the function passed to INIT_WORK(). Paul's ack below is for this RCU usage.  (Includes fixes by Alan Cox <alan@linux.intel.com>, David L Stevens <dlstevens@us.ibm.com>, Chris Wright <chrisw@redhat.com>)  Acked-by: Rusty Russell <rusty@rustcorp.com.au> Acked-by: Arnd Bergmann <arnd@arndb.de> Acked-by: "Paul E. McKenney" <paulmck@linux.vnet.ibm.com> Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | edac.h | s | 20K | 551 | Mauro Carvalho Chehab | mchehab@redhat.com | 1338243230 |  | edac: Initialize the dimm label with the known information  While userspace doesn't fill the dimm labels, add there the dimm location, as described by the used memory model. This could eventually match what is described at the dmidecode, making easier for people to identify the memory.  For example, on an Intel motherboard where the DMI table is reliable, the first memory stick is described as:  Memory Device 	Array Handle: 0x0029 	Error Information Handle: Not Provided 	Total Width: 64 bits 	Data Width: 64 bits 	Size: 2048 MB 	Form Factor: DIMM 	Set: 1 	Locator: A1_DIMM0 	Bank Locator: A1_Node0_Channel0_Dimm0 	Type: <OUT OF SPEC> 	Type Detail: Synchronous 	Speed: 800 MHz 	Manufacturer: A1_Manufacturer0 	Serial Number: A1_SerNum0 	Asset Tag: A1_AssetTagNum0 	Part Number: A1_PartNum0  The memory named as "A1_DIMM0" is physically located at the first memory controller (node 0), at channel 0, dimm slot 0.  After this patch, the memory label will be filled with: 	/sys/devices/system/edac/mc/csrow0/ch0_dimm_label:mc#0channel#0slot#0  And (after the new EDAC API patches) as: 	/sys/devices/system/edac/mc/mc0/dimm0/dimm_label:mc#0channel#0slot#0  So, even if the memory label is not initialized on userspace, an useful information with the error location is filled there, expecially since several systems/motherboards are provided with enough info to map from channel/slot (or branch/channel/slot) into the DIMM label. So, letting the EDAC core fill it by default is a good thing.  It should noticed that, as the label filling happens at the edac_mc_alloc(), drivers can override it to better describe the memories (and some actually do it).  Cc: Aristeu Rozanski <arozansk@redhat.com> Cc: Doug Thompson <norsk5@yahoo.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | workqueue.h | s | 13K | 389 | Alan Stern | stern@rowland.harvard.edu | 1330681860 |  | Block: use a freezable workqueue for disk-event polling  This patch (as1519) fixes a bug in the block layer's disk-events polling.  The polling is done by a work routine queued on the system_nrt_wq workqueue.  Since that workqueue isn't freezable, the polling continues even in the middle of a system sleep transition.  Obviously, polling a suspended drive for media changes and such isn't a good thing to do; in the case of USB mass-storage devices it can lead to real problems requiring device resets and even re-enumeration.  The patch fixes things by creating a new system-wide, non-reentrant, freezable workqueue and using it for disk-events polling.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> CC: <stable@kernel.org> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: Rafael J. Wysocki <rjw@sisk.pl> Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | reiserfs_xattr.h | s | 464B | 18 | Al Viro | viro@zeniv.linux.org.uk | 1332293382 |  | take private bits of reiserfs_xattr.h to fs/reiserfs/xattr.h  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | kbd_kern.h | s | 4.2K | 125 | Alan Cox | alan@linux.intel.com | 1331232635 |  | vt:tackle kbd_table  Keyboard struct lifetime is easy, but the locking is not and is completely ignored by the existing code. Tackle this one head on  - Make the kbd_table private so we can run down all direct users - Hoick the relevant ioctl handlers into the keyboard layer - Lock them with the keyboard lock so they don't change mid keypress - Add helpers for things like console stop/start so we isolate the poking   around properly - Tweak the braille console so it still builds  There are a couple of FIXME locking cases left for ioctls that are so hideous they should be addressed in a later patch. After this patch the kbd_table is private and all the keyboard jiggery pokery is in one place.  This update fixes speakup and also a memory leak in the original.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | cpu.h | s | 6.5K | 181 | Anton Vorontsov | anton.vorontsov@linaro.org | 1338511769 |  | cpu: introduce clear_tasks_mm_cpumask() helper  Many architectures clear tasks' mm_cpumask like this:  	read_lock(&tasklist_lock); 	for_each_process(p) { 		if (p->mm) 			cpumask_clear_cpu(cpu, mm_cpumask(p->mm)); 	} 	read_unlock(&tasklist_lock);  Depending on the context, the code above may have several problems, such as:  1. Working with task->mm w/o getting mm or grabing the task lock is    dangerous as ->mm might disappear (exit_mm() assigns NULL under    task_lock(), so tasklist lock is not enough).  2. Checking for process->mm is not enough because process' main    thread may exit or detach its mm via use_mm(), but other threads    may still have a valid mm.  This patch implements a small helper function that does things correctly, i.e.:  1. We take the task's lock while whe handle its mm (we can't use    get_task_mm()/mmput() pair as mmput() might sleep);  2. To catch exited main thread case, we use find_lock_task_mm(),    which walks up all threads and returns an appropriate task    (with task lock held).  Also, Per Peter Zijlstra's idea, now we don't grab tasklist_lock in the new helper, instead we take the rcu read lock. We can do this because the function is called after the cpu is taken down and marked offline, so no new tasks will get this cpu set in their mm mask.  Signed-off-by: Anton Vorontsov <anton.vorontsov@linaro.org> Cc: Richard Weinberger <richard@nod.at> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Mike Frysinger <vapier@gentoo.org> Cc: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | tc_act |  | 9 items |  | Gr√©goire Baron | baronchon@n7mm.org | 1282293779 |  | net/sched: add ACT_CSUM action to update packets checksums  net/sched: add ACT_CSUM action to update packets checksums  ACT_CSUM can be called just after ACT_PEDIT in order to re-compute some altered checksums in IPv4 and IPv6 packets. The following checksums are supported by this patch:  - IPv4: IPv4 header, ICMP, IGMP, TCP, UDP & UDPLite  - IPv6: ICMPv6, TCP, UDP & UDPLite It's possible to request in the same action to update different kind of checksums, if the packets flow mix TCP, UDP and UDPLite, ...  An example of usage is done in the associated iproute2 patch.  Version 3 changes:  - remove useless goto instructions  - improve IPv6 hop options decoding  Version 2 changes:  - coding style correction  - remove useless arguments of some functions  - use stack in tcf_csum_dump()  - add tcf_csum_skb_nextlayer() to factor code  Signed-off-by: Gregoire Baron <baronchon@n7mm.org> Acked-by: jamal <hadi@cyberus.ca> Signed-off-by: David S. Miller <davem@davemloft.net>
f | screen_info.h | s | 2.7K | 70 | Matthew Garrett | mjg@redhat.com | 1258150991 |  | x86, setup: Store the boot cursor state  Add a field to store the boot cursor state and implement this for VGA on x86. This can then be used to set the default policy for the boot console.  Signed-off-by: Matthew Garrett <mjg@redhat.com> LKML-Reference: <1258142222-16092-1-git-send-email-mjg@redhat.com> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | crc-itu-t.h | s | 615B | 21 | Ivo van Doorn | IvDoorn@gmail.com | 1178814253 |  | CRC ITU-T V.41  This will add the CRC calculation according to the CRC ITU-T V.41 to the kernel lib/ folder.  This code has been derived from the rt2x00 driver, currently found only in the wireless-dev tree, but this library is generic and could be used by more drivers who currently use their own implementation.  Signed-off-by: Ivo van Doorn <IvDoorn@gmail.com>  Also useful for the new firewire stack.  Signed-off-by: Kristian Hoegsberg <krh@redhat.com> Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>
f | led-lm3530.h | s | 3.7K | 105 | Kim, Milo | Milo.Kim@ti.com | 1338333752 |  | include/linux/led-lm3530.h: comment correction about the range of brightness  max brightness is 127, so the range of brt_val should be from 0 to 127  Signed-off-by: Milo(Woogyom) Kim <milo.kim@ti.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Cc: Shreshtha Kumar SAHU <shreshthakumar.sahu@stericsson.com> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Bryan Wu <bryan.wu@canonical.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | uwb |  | 4 items |  | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103952 |  | include: convert various register fcns to macros to avoid include chaining  The original implementations reference THIS_MODULE in an inline. We could include <linux/export.h>, but it is better to avoid chaining.  Fortunately someone else already thought of this, and made a similar inline into a #define in <linux/device.h> for device_schedule_callback(), [see commit 523ded71de0] so follow that precedent here.  Also bubble up any __must_check that were used on the prev. wrapper inline functions up one to the real __register functions, to preserve any prev. sanity checks that were used in those instances.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | via-core.h | s | 7.3K | 211 | Paul Mundt | lethal@linux-sh.org | 1289358281 |  | Merge branch 'viafb-next' of git://github.com/schandinat/linux-2.6
f | rfkill-regulator.h | s | 1.4K | 43 | Antonio Ospite | ospite@studenti.unina.it | 1303241882 |  | rfkill: Regulator consumer driver for rfkill  Add a regulator consumer driver for rfkill to enable controlling radio transmitters connected to voltage regulators using the regulator framework.  A new "vrfkill" virtual supply is provided to use in platform code.  Signed-off-by: Guiming Zhuo <gmzhuo@gmail.com> Signed-off-by: Antonio Ospite <ospite@studenti.unina.it> Reviewed-by: Johannes Berg <johannes@sipsolutions.net> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | bio.h | s | 15K | 482 | Tejun Heo | tj@kernel.org | 1333310100 |  | Merge branch 'for-3.5' of ../cgroup into block/for-3.5/core-merged  cgroup/for-3.5 contains the following changes which blk-cgroup needs to proceed with the on-going cleanup.  * Dynamic addition and removal of cftypes to make config/stat file   handling modular for policies.  * cgroup removal update to not wait for css references to drain to fix   blkcg removal hang caused by cfq caching cfqgs.  Pull in cgroup/for-3.5 into block/for-3.5/core.  This causes the following conflicts in block/blk-cgroup.c.  * 761b3ef50e "cgroup: remove cgroup_subsys argument from callbacks"   conflicts with blkiocg_pre_destroy() addition and blkiocg_attach()   removal.  Resolved by removing @subsys from all subsys methods.  * 676f7c8f84 "cgroup: relocate cftype and cgroup_subsys definitions in   controllers" conflicts with ->pre_destroy() and ->attach() updates   and removal of modular config.  Resolved by dropping forward   declarations of the methods and applying updates to the relocated   blkio_subsys.  * 4baf6e3325 "cgroup: convert all non-memcg controllers to the new   cftype interface" builds upon the previous item.  Resolved by adding   ->base_cftypes to the relocated blkio_subsys.  Signed-off-by: Tejun Heo <tj@kernel.org>
f | compiler.h | s | 8.5K | 276 | Alexander Stein | alexander.stein@systec-electronic.com | 1330441374 |  | compiler.h: Fix typo  Signed-off-by: Alexander Stein <alexander.stein@systec-electronic.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | basic_mmio_gpio.h | s | 2.0K | 60 | Shawn Guo | shawn.guo@linaro.org | 1337451455 |  | gpio/generic: initialize basic_mmio_gpio shadow variables properly  It fixes the issue in gpio-generic that commit fb14921 (gpio/mxc: add missing initialization of basic_mmio_gpio shadow variables) manged to fix in gpio-mxc driver, so that other platform specific drivers do not suffer from the same problem over and over again.  Changes since v1: * Turn the last parameter of bgpio_init() "bool big_endian" into   "unsigned long flags" and give those really quirky hardwares a   chance to tell that reg_set and reg_dir are unreadable.  Signed-off-by: Shawn Guo <shawn.guo@linaro.org> [grant.likely: Fix big-endian usage to explicitly set BBGPIOF_BIG_ENDIAN] Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | pm_clock.h | s | 1.7K | 64 | Rafael J. Wysocki | rjw@sisk.pl | 1314279259 |  | PM: Move clock-related definitions and headers to separate file  Since the PM clock management code in drivers/base/power/clock_ops.c is used for both runtime PM and system suspend/hibernation, the definitions of data structures and headers related to it should not be located in include/linux/pm_rumtime.h.  Move them to a separate header file.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | iscsi_boot_sysfs.h | s | 3.7K | 120 | Al Viro | viro@zeniv.linux.org.uk | 1325649295 |  | switch ->is_visible() to returning umode_t  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | console.h | s | 5.9K | 161 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | delay.h | s | 1.4K | 44 | Patrick Pannuto | ppannuto@codeaurora.org | 1280912445 |  | timer: Added usleep_range timer  usleep_range is a finer precision implementations of msleep and is designed to be a drop-in replacement for udelay where a precise sleep / busy-wait is unnecessary.  Since an easy interface to hrtimers could lead to an undesired proliferation of interrupts, we provide only a "range" API, forcing the caller to think about an acceptable tolerance on both ends and hopefully avoiding introducing another interrupt.  INTRO  As discussed here ( http://lkml.org/lkml/2007/8/3/250 ), msleep(1) is not precise enough for many drivers (yes, sleep precision is an unfair notion, but consistently sleeping for ~an order of magnitude greater than requested is worth fixing). This patch adds a usleep API so that udelay does not have to be used. Obviously not every udelay can be replaced (those in atomic contexts or being used for simple bitbanging come to mind), but there are many, many examples of  mydriver_write(...) /* Wait for hardware to latch */ udelay(100)  in various drivers where a busy-wait loop is neither beneficial nor necessary, but msleep simply does not provide enough precision and people are using a busy-wait loop instead.  CONCERNS FROM THE RFC  Why is udelay a problem / necessary? Most callers of udelay are in device/ driver initialization code, which is serial...  	As I see it, there is only benefit to sleeping over a delay; the 	notion of "refactoring" areas that use udelay was presented, but 	I see usleep as the refactoring. Consider i2c, if the bus is busy, 	you need to wait a bit (say 100us) before trying again, your 	current options are:  		* udelay(100) 		* msleep(1) <-- As noted above, actually as high as ~20ms 				on some platforms, so not really an option 		* Manually set up an hrtimer to try again in 100us (which 		  is what usleep does anyway...)  	People choose the udelay route because it is EASY; we need to 	provide a better easy route.  	Device / driver / boot code is *currently* serial, but every few 	months someone makes noise about parallelizing boot, and IMHO, a 	little forward-thinking now is one less thing to worry about 	if/when that ever happens  udelay's could be preempted  	Sure, but if udelay plans on looping 1000 times, and it gets 	preempted on loop 200, whenever it's scheduled again, it is 	going to do the next 800 loops.  Is the interruptible case needed?  	Probably not, but I see usleep as a very logical parallel to msleep, 	so it made sense to include the "full" API. Processors are getting 	faster (albeit not as quickly as they are becoming more parallel), 	so if someone wanted to be interruptible for a few usecs, why not 	let them? If this is a contentious point, I'm happy to remove it.  OTHER THOUGHTS  I believe there is also value in exposing the usleep_range option; it gives the scheduler a lot more flexibility and allows the programmer to express his intent much more clearly; it's something I would hope future driver writers will take advantage of.  To get the results in the NUMBERS section below, I literally s/udelay/usleep the kernel tree; I had to go in and undo the changes to the USB drivers, but everything else booted successfully; I find that extremely telling in and of itself -- many people are using a delay API where a sleep will suit them just fine.  SOME ATTEMPTS AT NUMBERS  It turns out that calculating quantifiable benefit on this is challenging, so instead I will simply present the current state of things, and I hope this to be sufficient:  How many udelay calls are there in 2.6.35-rc5?  	udealy(ARG) >=	|| COUNT 	1000		|| 319 	500		|| 414 	100		|| 1146 	20		|| 1832  I am working on Android, so that is my focus for this. The following table is a modified usleep that simply printk's the amount of time requested to sleep; these tests were run on a kernel with udelay >= 20 --> usleep  "boot" is power-on to lock screen "power collapse" is when the power button is pushed and the device suspends "resume" is when the power button is pushed and the lock screen is displayed          (no touchscreen events or anything, just turning on the display) "use device" is from the unlock swipe to clicking around a bit; there is no 	sd card in this phone, so fail loading music, video, camera  	ACTION		|| TOTAL NUMBER OF USLEEP CALLS	|| NET TIME (us) 	boot		|| 22				|| 1250 	power-collapse	|| 9				|| 1200 	resume		|| 5				|| 500 	use device	|| 59				|| 7700  The most interesting category to me is the "use device" field; 7700us of busy-wait time that could be put towards better responsiveness, or at the least less power usage.  Signed-off-by: Patrick Pannuto <ppannuto@codeaurora.org> Cc: apw@canonical.com Cc: corbet@lwn.net Cc: arjan@linux.intel.com Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | kdev_t.h | s | 2.0K | 82 | Andrew Morton | akpm@linux-foundation.org | 1175746367 |  | [PATCH] remove protection of LANANA-reserved majors  Revert all this.  It can cause device-mapper to receive a different major from earlier kernels and it turns out that the Amanda backup program (via GNU tar, apparently) checks major numbers on files when performing incremental backups.  Which is a bit broken of Amanda (or tar), but this feature isn't important enough to justify the churn.  Cc: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mmzone.h | s | 37K | 1078 | Konstantin Khlebnikov | khlebnikov@openvz.org | 1338333746 |  | mm: add link from struct lruvec to struct zone  This is the first stage of struct mem_cgroup_zone removal.  Further patches replace struct mem_cgroup_zone with a pointer to struct lruvec.  If CONFIG_CGROUP_MEM_RES_CTLR=n lruvec_zone() is just container_of().  Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Cc: Mel Gorman <mel@csn.ul.ie> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Acked-by: Hugh Dickins <hughd@google.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | relay.h | s | 8.7K | 268 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | pstore.h | s | 1.9K | 60 | Kees Cook | keescook@chromium.org | 1321564409 |  | pstore: pass reason to backend write callback  This allows a backend to filter on the dmesg reason as well as the pstore reason. When ramoops is switched to pstore, this is needed since it has no interest in storing non-crash dmesg details.  Drop pstore_write() as it has no users, and handling the "reason" here has no obviously correct value.  Signed-off-by: Kees Cook <keescook@chromium.org> Signed-off-by: Tony Luck <tony.luck@intel.com>
f | parport_pc.h | s | 6.5K | 203 | Alan Cox | alan@lxorguk.ukuu.org.uk | 1239119046 |  | parport: Use the PCI IRQ if offered  PCI parallel port devices can IRQ share so we should stop them hogging the line and making a mess on modern PC systems.  We know the sharing side works as the PCMCIA driver has shared the parallel port IRQ for some time.  Signed-off-by: Alan Cox <alan@lxorguk.ukuu.org.uk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | rculist_bl.h | s | 4.3K | 118 | Nick Piggin | npiggin@kernel.dk | 1294972603 |  | fs: hlist UP debug fixup  Po-Yu Chuang <ratbert.chuang@gmail.com> noticed that hlist_bl_set_first could crash on a UP system when LIST_BL_LOCKMASK is 0, because  	LIST_BL_BUG_ON(!((unsigned long)h->first & LIST_BL_LOCKMASK));  always evaulates to true.  Fix the expression, and also avoid a dependency between bit spinlock implementation and list bl code (list code shouldn't know anything except that bit 0 is set when adding and removing elements). Eventually if a good use case comes up, we might use this list to store 1 or more arbitrary bits of data, so it really shouldn't be tied to locking either, but for now they are helpful for debugging.  Signed-off-by: Nick Piggin <npiggin@kernel.dk>
f | fadvise.h | s | 779B | 18 | Andrew Morton | akpm@osdl.org | 1143836334 |  | [PATCH] sys_sync_file_range()  Remove the recently-added LINUX_FADV_ASYNC_WRITE and LINUX_FADV_WRITE_WAIT fadvise() additions, do it in a new sys_sync_file_range() syscall instead. Reasons:  - It's more flexible.  Things which would require two or three syscalls with   fadvise() can be done in a single syscall.  - Using fadvise() in this manner is something not covered by POSIX.  The patch wires up the syscall for x86.  The sycall is implemented in the new fs/sync.c.  The intention is that we can move sys_fsync(), sys_fdatasync() and perhaps sys_sync() into there later.  Documentation for the syscall is in fs/sync.c.  A test app (sync_file_range.c) is in http://www.zip.com.au/~akpm/linux/patches/stuff/ext3-tools.tar.gz.  The available-to-GPL-modules do_sync_file_range() is for knfsd: "A COMMIT can say NFS_DATA_SYNC or NFS_FILE_SYNC.  I can skip the ->fsync call for NFS_DATA_SYNC which is hopefully the more common."  Note: the `async' writeout mode SYNC_FILE_RANGE_WRITE will turn synchronous if the queue is congested.  This is trivial to fix: add a new flag bit, set wbc->nonblocking.  But I'm not sure that we want to expose implementation details down to that level.  Note: it's notable that we can sync an fd which wasn't opened for writing. Same with fsync() and fdatasync()).  Note: the code takes some care to handle attempts to sync file contents outside the 16TB offset on 32-bit machines.  It makes such attempts appear to succeed, for best 32-bit/64-bit compatibility.  Perhaps it should make such requests fail...  Cc: Nick Piggin <nickpiggin@yahoo.com.au> Cc: Michael Kerrisk <mtk-manpages@gmx.net> Cc: Ulrich Drepper <drepper@redhat.com> Cc: Neil Brown <neilb@cse.unsw.edu.au> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | bsg-lib.h | s | 2.1K | 63 | Mike Christie | michaelc@cs.wisc.edu | 1312142709 |  | block: add bsg helper library  This moves the FC classes bsg code to the block layer and makes it a lib so that other classes like iscsi and SAS can use it.  It is helpful because working with the request queue, bios, creating scatterlists, etc are a pain that the LLD does not have to worry about with normal IOs and should not have to worry about for bsg requests.  Signed-off-by: Mike Christie <michaelc@cs.wisc.edu> Signed-off-by: Jens Axboe <jaxboe@fusionio.com>
f | uts.h | s | 349B | 15 | Josh Triplett | josh@joshtriplett.org | 1308193440 |  | uts: make default hostname configurable, rather than always using "(none)"  The "hostname" tool falls back to setting the hostname to "localhost" if /etc/hostname does not exist.  Distribution init scripts have the same fallback.  However, if userspace never calls sethostname, such as when booting with init=/bin/sh, or otherwise booting a minimal system without the usual init scripts, the default hostname of "(none)" remains, unhelpfully appearing in various places such as prompts ("root@(none):~#") and logs.  Furthermore, "(none)" doesn't typically resolve to anything useful.  Make the default hostname configurable.  This removes the need for the standard fallback, provides a useful default for systems that never call sethostname, and makes minimal systems that much more useful with less configuration.  Distributions could choose to use "localhost" here to avoid the fallback, while embedded systems may wish to use a specific target hostname.  Signed-off-by: Josh Triplett <josh@joshtriplett.org> Acked-by: Linus Torvalds <torvalds@linux-foundation.org> Acked-by: David Miller <davem@davemloft.net> Cc: Serge Hallyn <serue@us.ibm.com> Cc: Kel Modderman <kel@otaku42.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mpi.h | s | 4.7K | 120 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1328102594 |  | lib/mpi: replaced MPI_NULL with normal NULL  MPI_NULL is replaced with normal NULL.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Reviewed-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Signed-off-by: James Morris <jmorris@namei.org>
f | if_macvlan.h | s | 3.0K | 94 | John Fastabend | john.r.fastabend@intel.com | 1334509565 |  | macvlan: add FDB bridge ops and macvlan flags  This adds FDB bridge ops to the macvlan device passthru mode. Additionally a flags field was added and a NOPROMISC bit to allow users to use passthru mode without the driver calling dev_set_promiscuity(). The flags field is a u16 placed in a 4 byte hole (consuming 2 bytes) of the macvlan_dev struct.  We want to do this so that the macvlan driver or stack above the macvlan driver does not have to process every packet. For the use case where we know all the MAC addresses of the endstations above us this works well.  This patch is a result of Roopa Prabhu's work. Follow up patches are needed for VEPA and VEB macvlan modes.  v2: Change from distinct nopromisc mode to a flags field to     configure this. This avoids the tendency to add a new     mode every time we need some slightly different behavior. v3: fix error in dev_set_promiscuity and add change and get     link attributes for flags.  CC: Roopa Prabhu <roprabhu@cisco.com> CC: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: John Fastabend <john.r.fastabend@intel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mnt_namespace.h | s | 460B | 13 | Al Viro | viro@zeniv.linux.org.uk | 1325649433 |  | vfs: take /proc/*/mounts and friends to fs/proc_namespace.c  rationale: that stuff is far tighter bound to fs/namespace.c than to the guts of procfs proper.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | ultrasound.h | s | 4.4K | 96 | Thadeu Lima de Souza Cascardo | cascardo@holoscopio.com | 1244822505 |  | Trivial: fix typo s/balence/balance/  Signed-off-by: Thadeu Lima de Souza Cascardo <cascardo@holoscopio.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | proc_fs.h | s | 8.0K | 247 | Eric W. Biederman | ebiederm@xmission.com | 1337119168 |  | userns: Convert proc to use kuid/kgid where appropriate  Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | cfag12864b.h | s | 2.1K | 72 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | sfi_acpi.h | s | 3.4K | 72 | Feng Tang | feng.tang@intel.com | 1251503853 |  | SFI: add capability to parse ACPI tables  Extend SFI to access standard ACPI tables. (eg. the PCI MCFG) using sfi_acpi_table_parse().  Note that this is _not_ a hybrid ACPI + SFI mode. The platform boots in either ACPI mode or SFI mode.  SFI runs only with acpi_disabled=1, which can be set at build-time via CONFIG_ACPI=n, or at boot time by the failure to find ACPI platform support.  So this extension simply allows SFI-platforms to re-use existing standard table formats that happen to be defined to live in ACPI envelopes.  Signed-off-by: Feng Tang <feng.tang@intel.com> Signed-off-by: Len Brown <len.brown@intel.com>
f | ppp-ioctl.h | s | 5.3K | 109 | Paul Mackerras | paulus@samba.org | 1330911698 |  | ppp: Move ioctl definitions from if_ppp.h to new ppp-ioctl.h  This moves the definitions of the ioctls, constants and structures relating to the ppp_generic interface to userspace out from if_ppp.h to a new file, ppp-ioctl.h.  The new file has my copyright since I designed and implemented the ppp_generic interface in the late 1990s. None of the contents of this file comes from the original if_ppp.h published by Carnegie Mellon University.  Of the remainder of if_ppp.h, only the PPP_MTU definition was being used, and this replaces the uses of it with PPP_MRU (which is identical). Therefore, this replaces the entire file with the single line  #include <linux/ppp-ioctl.h>  which clearly doesn't contain any CMU code.  Thus I have removed the CMU copyright notice with its problematic advertising clause, and in fact since it's only one trivial line I have not added any other copyright notice.  Signed-off-by: Paul Mackerras <paulus@samba.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mempolicy.h | s | 9.7K | 318 | Andrew Morton | akpm@linux-foundation.org | 1338333740 |  | mm: do_migrate_pages(): rename arguments  s/from_nodes/from and s/to_nodes/to/.  The "_nodes" is redundant - it duplicates the argument's type.  Done in a fit of irritation over 80-col issues :(  Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: KOSAKI Motohiro <mkosaki@redhat.com> Cc: Larry Woodman <lwoodman@redhat.com> Cc: Mel Gorman <mel@csn.ul.ie> Cc: Rik van Riel <riel@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ksm.h | s | 4.0K | 122 | Andrea Arcangeli | aarcange@redhat.com | 1284083844 |  | mm: fix swapin race condition  The pte_same check is reliable only if the swap entry remains pinned (by the page lock on swapcache).  We've also to ensure the swapcache isn't removed before we take the lock as try_to_free_swap won't care about the page pin.  One of the possible impacts of this patch is that a KSM-shared page can point to the anon_vma of another process, which could exit before the page is freed.  This can leave a page with a pointer to a recycled anon_vma object, or worse, a pointer to something that is no longer an anon_vma.  [riel@redhat.com: changelog help] Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Acked-by: Hugh Dickins <hughd@google.com> Reviewed-by: Rik van Riel <riel@redhat.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | timeriomem-rng.h | s | 497B | 17 | Alexander Clouter | alex@digriz.org.uk | 1238129994 |  | hwrng: timeriomem - Use phys address rather than virt  There is no ioremap'ing or anything in timeriomem-rng.c as I foolishly used already remapped virtual addresses instead of passing the physical address to be polled.  This patch fixes this flaw and lets developers do the Right Thing(tm).  Signed-off-by: Alexander Clouter <alex@digriz.org.uk> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
f | mg_disk.h | s | 1.0K | 37 | unsik Kim | donari75@gmail.com | 1245134420 |  | mg_disk: seperate mg_disk.h again  eec9462088a26c046d4db3100796a340a50890b8 fold mg_disk.h into mg_disk.c, but mg_disk platform driver needs private data for operation. This also make mg_disk.c as machine independent. Seperate only needed structure and defines to mg_disk.h  Signed-off-by: unsik Kim <donari75@gmail.com> Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
f | genhd.h | s | 19K | 560 | Tejun Heo | tj@kernel.org | 1337062924 |  | block: fix buffer overflow when printing partition UUIDs  6d1d8050b4bc8 "block, partition: add partition_meta_info to hd_struct" added part_unpack_uuid() which assumes that the passed in buffer has enough space for sprintfing "%pU" - 37 characters including '\0'.  Unfortunately, b5af921ec0233 "init: add support for root devices specified by partition UUID" supplied 33 bytes buffer to the function leading to the following panic with stackprotector enabled.    Kernel panic - not syncing: stack-protector: Kernel stack corrupted in: ffffffff81b14c7e    [<ffffffff815e226b>] panic+0xba/0x1c6   [<ffffffff81b14c7e>] ? printk_all_partitions+0x259/0x26xb   [<ffffffff810566bb>] __stack_chk_fail+0x1b/0x20   [<ffffffff81b15c7e>] printk_all_paritions+0x259/0x26xb   [<ffffffff81aedfe0>] mount_block_root+0x1bc/0x27f   [<ffffffff81aee0fa>] mount_root+0x57/0x5b   [<ffffffff81aee23b>] prepare_namespace+0x13d/0x176   [<ffffffff8107eec0>] ? release_tgcred.isra.4+0x330/0x30   [<ffffffff81aedd60>] kernel_init+0x155/0x15a   [<ffffffff81087b97>] ? schedule_tail+0x27/0xb0   [<ffffffff815f4d24>] kernel_thread_helper+0x5/0x10   [<ffffffff81aedc0b>] ? start_kernel+0x3c5/0x3c5   [<ffffffff815f4d20>] ? gs_change+0x13/0x13  Increase the buffer size, remove the dangerous part_unpack_uuid() and use snprintf() directly from printk_all_partitions().  Signed-off-by: Tejun Heo <tj@kernel.org> Reported-by: Szymon Gruszczynski <sz.gruszczynski@googlemail.com> Cc: Will Drewry <wad@chromium.org> Cc: stable@vger.kernel.org Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | fec.h | s | 568B | 21 | Shawn Guo | shawn.guo@freescale.com | 1294616575 |  | net/fec: add mac field into platform data and consolidate fec_get_mac  Add mac field into fec_platform_data and consolidate function fec_get_mac to get mac address in following order.   1) module parameter via kernel command line fec.macaddr=0x00,0x04,...  2) from flash in case of CONFIG_M5272 or fec_platform_data mac     field for others, which typically have mac stored in fuse  3) fec mac address registers set by bootloader  Signed-off-by: Shawn Guo <shawn.guo@freescale.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | profile.h | s | 2.9K | 115 | Paul Mundt | lethal@linux-sh.org | 1224777301 |  | profiling: fix up CONFIG_PROC_FS=n build  In the case where procfs is disabled, create_proc_profile() does not exist. Stub it in with the others.  Signed-off-by: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_slip.h | s | 809B | 23 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | ide.h | s | 44K | 1272 | Linus Torvalds | torvalds@linux-foundation.org | 1332975501 |  | 
f | digsig.h | s | 1.3K | 52 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1329727596 |  | digsig: changed type of the timestamp  time_t was used in the signature and key packet headers, which is typedef of long and is different on 32 and 64 bit architectures. Signature and key format should be independent of architecture. Similar to GPG, I have changed the type to uint32_t.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: James Morris <jmorris@namei.org>
f | pipe_fs_i.h | s | 5.8K | 145 | Linus Torvalds | torvalds@linux-foundation.org | 1335730362 |  | pipes: add a "packetized pipe" mode for writing  The actual internal pipe implementation is already really about individual packets (called "pipe buffers"), and this simply exposes that as a special packetized mode.  When we are in the packetized mode (marked by O_DIRECT as suggested by Alan Cox), a write() on a pipe will not merge the new data with previous writes, so each write will get a pipe buffer of its own.  The pipe buffer is then marked with the PIPE_BUF_FLAG_PACKET flag, which in turn will tell the reader side to break the read at that boundary (and throw away any partial packet contents that do not fit in the read buffer).  End result: as long as you do writes less than PIPE_BUF in size (so that the pipe doesn't have to split them up), you can now treat the pipe as a packet interface, where each read() system call will read one packet at a time.  You can just use a sufficiently big read buffer (PIPE_BUF is sufficient, since bigger than that doesn't guarantee atomicity anyway), and the return value of the read() will naturally give you the size of the packet.  NOTE! We do not support zero-sized packets, and zero-sized reads and writes to a pipe continue to be no-ops.  Also note that big packets will currently be split at write time, but that the size at which that happens is not really specified (except that it's bigger than PIPE_BUF). Currently that limit is the system page size, but we might want to explicitly support bigger packets some day.  The main user for this is going to be the autofs packet interface, allowing us to stop having to care so deeply about exact packet sizes (which have had bugs with 32/64-bit compatibility modes).  But user space can create packetized pipes with "pipe2(fd, O_DIRECT)", which will fail with an EINVAL on kernels that do not support this interface.  Tested-by: Michael Tokarev <mjt@tls.msk.ru> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: David Miller <davem@davemloft.net> Cc: Ian Kent <raven@themaw.net> Cc: Thomas Meyer <thomas@m3y3r.de> Cc: stable@kernel.org  # needed for systemd/autofs interaction fix Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | timecompare.h | s | 4.9K | 117 | Patrick Ohly | patrick.ohly@intel.com | 1234766612 |  | timecompare: generic infrastructure to map between two time bases  Mapping from a struct timecounter to a time returned by functions like ktime_get_real() is implemented. This is sufficient to use this code in a network device driver which wants to support hardware time stamping and transformation of hardware time stamps to system time.  The interface could have been made more versatile by not depending on a time counter, but this wasn't done to avoid writing glue code elsewhere.  The method implemented here is the one used and analyzed under the name "assisted PTP" in the LCI PTP paper: http://www.linuxclustersinstitute.org/conferences/archive/2008/PDF/Ohly_92221.pdf  Acked-by: John Stultz <johnstul@us.ibm.com> Signed-off-by: Patrick Ohly <patrick.ohly@intel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | efi.h | s | 18K | 590 | Matthew Garrett | mjg@redhat.com | 1335825018 |  | efi: Add new variable attributes  More recent versions of the UEFI spec have added new attributes for variables. Add them.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | filter.h | s | 6.0K | 225 | Linus Torvalds | torvalds@linux-foundation.org | 1337657256 |  | Merge branch 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security  Pull security subsystem updates from James Morris:  "New notable features:    - The seccomp work from Will Drewry    - PR_{GET,SET}_NO_NEW_PRIVS from Andy Lutomirski    - Longer security labels for Smack from Casey Schaufler    - Additional ptrace restriction modes for Yama by Kees Cook"  Fix up trivial context conflicts in arch/x86/Kconfig and include/linux/filter.h  * 'next' of git://git.kernel.org/pub/scm/linux/kernel/git/jmorris/linux-security: (65 commits)   apparmor: fix long path failure due to disconnected path   apparmor: fix profile lookup for unconfined   ima: fix filename hint to reflect script interpreter name   KEYS: Don't check for NULL key pointer in key_validate()   Smack: allow for significantly longer Smack labels v4   gfp flags for security_inode_alloc()?   Smack: recursive tramsmute   Yama: replace capable() with ns_capable()   TOMOYO: Accept manager programs which do not start with / .   KEYS: Add invalidation support   KEYS: Do LRU discard in full keyrings   KEYS: Permit in-place link replacement in keyring list   KEYS: Perform RCU synchronisation on keys prior to key destruction   KEYS: Announce key type (un)registration   KEYS: Reorganise keys Makefile   KEYS: Move the key config into security/keys/Kconfig   KEYS: Use the compat keyctl() syscall wrapper on Sparc64 for Sparc32 compat   Yama: remove an unused variable   samples/seccomp: fix dependencies on arch macros   Yama: add additional ptrace scopes   ...
f | regset.h | s | 12K | 349 | Linus Torvalds | torvalds@linux-foundation.org | 1332608919 |  | 
f | hw_breakpoint.h | s | 4.3K | 128 | Avi Kivity | avi@redhat.com | 1309511198 |  | perf: Add context field to perf_event  The perf_event overflow handler does not receive any caller-derived argument, so many callers need to resort to looking up the perf_event in their local data structure.  This is ugly and doesn't scale if a single callback services many perf_events.  Fix by adding a context parameter to perf_event_create_kernel_counter() (and derived hardware breakpoints APIs) and storing it in the perf_event. The field can be accessed from the callback as event->overflow_handler_context. All callers are updated.  Signed-off-by: Avi Kivity <avi@redhat.com> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Link: http://lkml.kernel.org/r/1309362157-6596-2-git-send-email-avi@redhat.com Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | debug_locks.h | s | 1.5K | 60 | Linus Torvalds | torvalds@linux-foundation.org | 1332975501 |  | 
f | flex_array.h | s | 2.4K | 67 | Jesse Gross | jesse@nicira.com | 1306455153 |  | flex_array: avoid divisions when accessing elements  On most architectures division is an expensive operation and accessing an element currently requires four of them.  This performance penalty effectively precludes flex arrays from being used on any kind of fast path.  However, two of these divisions can be handled at creation time and the others can be replaced by a reciprocal divide, completely avoiding real divisions on access.  [eparis@redhat.com: rebase on top of changes to support 0 len elements] [eparis@redhat.com: initialize part_nr when array fits entirely in base] Signed-off-by: Jesse Gross <jesse@nicira.com> Signed-off-by: Eric Paris <eparis@redhat.com> Cc: Dave Hansen <dave@linux.vnet.ibm.com> Cc: David Rientjes <rientjes@google.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | iscsi_ibft.h | s | 1.3K | 41 | Peter Jones | pjones@redhat.com | 1273597343 |  | ibft: Update iBFT handling for v1.03 of the spec.  - Use struct acpi_table_ibft instead of struct ibft_table_header - Don't do reserve_ibft_region() on UEFI machines (section 1.4.3.1) - If ibft_addr isn't initialized when ibft_init() is called, check for   ACPI-based tables. - Fix compiler error when CONFIG_ACPI is not defined.  Signed-off-by: Konrad Rzeszutek Wilk <konrad@kernel.org> Signed-off-by: Peter Jones <pjones@redhat.com> Signed-off-by: Mike Christie <michaelc@cs.wisc.edu>
f | hysdn_if.h | s | 1.3K | 28 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | shm.h | s | 3.5K | 112 | Vasiliy Kulikov | segoon@openwall.com | 1312051459 |  | shm: handle separate PID namespaces case  shm_try_destroy_orphaned() and shm_try_destroy_current() didn't handle the case of separate PID namespaces, but a single IPC namespace.  If there are tasks with the same PID values using the same shmem object, the wrong destroy decision could be reached.  On shm segment creation store the pointer to the creator task in shmid_kernel->shm_creator field and zero it on task exit.  Then use the ->shm_creator insread of shm_cprid in both functions.  As shmid_kernel object is already locked at this stage, no additional locking is needed.  Signed-off-by: Vasiliy Kulikov <segoon@openwall.com> Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fscache.h | s | 21K | 623 | David Howells | dhowells@redhat.com | 1310070116 |  | FS-Cache: Add a helper to bulk uncache pages on an inode  Add an FS-Cache helper to bulk uncache pages on an inode.  This will only work for the circumstance where the pages in the cache correspond 1:1 with the pages attached to an inode's page cache.  This is required for CIFS and NFS: When disabling inode cookie, we were returning the cookie and setting cifsi->fscache to NULL but failed to invalidate any previously mapped pages.  This resulted in "Bad page state" errors and manifested in other kind of errors when running fsstress.  Fix it by uncaching mapped pages when we disable the inode cookie.  This patch should fix the following oops and "Bad page state" errors seen during fsstress testing.    ------------[ cut here ]------------   kernel BUG at fs/cachefiles/namei.c:201!   invalid opcode: 0000 [#1] SMP   Pid: 5, comm: kworker/u:0 Not tainted 2.6.38.7-30.fc15.x86_64 #1 Bochs Bochs   RIP: 0010: cachefiles_walk_to_object+0x436/0x745 [cachefiles]   RSP: 0018:ffff88002ce6dd00  EFLAGS: 00010282   RAX: ffff88002ef165f0 RBX: ffff88001811f500 RCX: 0000000000000000   RDX: 0000000000000000 RSI: 0000000000000100 RDI: 0000000000000282   RBP: ffff88002ce6dda0 R08: 0000000000000100 R09: ffffffff81b3a300   R10: 0000ffff00066c0a R11: 0000000000000003 R12: ffff88002ae54840   R13: ffff88002ae54840 R14: ffff880029c29c00 R15: ffff88001811f4b0   FS:  00007f394dd32720(0000) GS:ffff88002ef00000(0000) knlGS:0000000000000000   CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b   CR2: 00007fffcb62ddf8 CR3: 000000001825f000 CR4: 00000000000006e0   DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000   DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400   Process kworker/u:0 (pid: 5, threadinfo ffff88002ce6c000, task ffff88002ce55cc0)   Stack:    0000000000000246 ffff88002ce55cc0 ffff88002ce6dd58 ffff88001815dc00    ffff8800185246c0 ffff88001811f618 ffff880029c29d18 ffff88001811f380    ffff88002ce6dd50 ffffffff814757e4 ffff88002ce6dda0 ffffffff8106ac56   Call Trace:    cachefiles_lookup_object+0x78/0xd4 [cachefiles]    fscache_lookup_object+0x131/0x16d [fscache]    fscache_object_work_func+0x1bc/0x669 [fscache]    process_one_work+0x186/0x298    worker_thread+0xda/0x15d    kthread+0x84/0x8c    kernel_thread_helper+0x4/0x10   RIP  cachefiles_walk_to_object+0x436/0x745 [cachefiles]   ---[ end trace 1d481c9af1804caa ]---  I tested the uncaching by the following means:   (1) Create a big file on my NFS server (104857600 bytes).   (2) Read the file into the cache with md5sum on the NFS client.  Look in      /proc/fs/fscache/stats:  	Pages  : mrk=25601 unc=0   (3) Open the file for read/write ("bash 5<>/warthog/bigfile").  Look in proc      again:  	Pages  : mrk=25601 unc=25601  Reported-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: David Howells <dhowells@redhat.com> Reviewed-and-Tested-by: Suresh Jayaraman <sjayaraman@suse.de> cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | inetdevice.h | s | 7.6K | 219 | Neil Horman | nhorman@tuxdriver.com | 1331964020 |  | arp: allow arp processing to honor per interface arp_accept sysctl  I found recently that the arp_process function which handles all of our received arp frames, is using IPV4_DEVCONF_ALL macro to check the state of the arp_process flag.  This seems wrong, as it implies that either none or all of the network interfaces accept gratuitous arps.  This patch corrects that, allowing per-interface arp_accept configuration to deviate from the all setting.  Note this also brings us into line with the way the arp_filter setting is handled during arp_process execution.  Tested this myself on my home network, and confirmed it works as expected.  Signed-off-by: Neil Horman <nhorman@tuxdriver.com> CC: "David S. Miller" <davem@davemloft.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | tty_flip.h | s | 1.1K | 24 | Alan Cox | alan@linux.intel.com | 1267570511 |  | USB: tty: Add a function to insert a string of characters with the same flag  The USB drivers often want to insert a series of bytes all with the same flag set - provide a helper for this case.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | pid_namespace.h | s | 2.1K | 78 | Eric W. Biederman | ebiederm@xmission.com | 1337119168 |  | userns: Convert proc to use kuid/kgid where appropriate  Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | sh_timer.h | s | 224B | 10 | Magnus Damm | damm@opensource.se | 1288536039 |  | ARM: shmobile: remove sh_timer_config clk member  Now when the SH-Mobile ARM platforms have been converted to use device name it is possible to remove "clk" from struct sh_timer_config.  Signed-off-by: Magnus Damm <damm@opensource.se> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | kd.h | s | 6.2K | 153 | Arthur Taylor | art@ified.ca | 1297969960 |  | vt: Add virtual console keyboard mode OFF  virtual console: add keyboard mode OFF  Add a new mode for the virtual console keyboard OFF in which all input other than shift keys is ignored. Prevents vt input buffers from overflowing when a program opens but doesn't read from a tty, like X11 using evdev for input.  Signed-off-by: Arthur Taylor <art@ified.ca> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | dynamic_queue_limits.h | s | 3.4K | 80 | Tom Herbert | therbert@google.com | 1322588779 |  | dql: Dynamic queue limits  Implementation of dynamic queue limits (dql).  This is a libary which allows a queue limit to be dynamically managed.  The goal of dql is to set the queue limit, number of objects to the queue, to be minimized without allowing the queue to be starved.  dql would be used with a queue which has these properties:  1) Objects are queued up to some limit which can be expressed as a    count of objects. 2) Periodically a completion process executes which retires consumed    objects. 3) Starvation occurs when limit has been reached, all queued data has    actually been consumed but completion processing has not yet run,    so queuing new data is blocked. 4) Minimizing the amount of queued data is desirable.  A canonical example of such a queue would be a NIC HW transmit queue.  The queue limit is dynamic, it will increase or decrease over time depending on the workload.  The queue limit is recalculated each time completion processing is done.  Increases occur when the queue is starved and can exponentially increase over successive intervals. Decreases occur when more data is being maintained in the queue than needed to prevent starvation.  The number of extra objects, or "slack", is measured over successive intervals, and to avoid hysteresis the limit is only reduced by the miminum slack seen over a configurable time period.  dql API provides routines to manage the queue: - dql_init is called to intialize the dql structure - dql_reset is called to reset dynamic values - dql_queued called when objects are being enqueued - dql_avail returns availability in the queue - dql_completed is called when objects have be consumed in the queue  Configuration consists of: - max_limit, maximum limit - min_limit, minimum limit - slack_hold_time, time to measure instances of slack before reducing   queue limit  Signed-off-by: Tom Herbert <therbert@google.com> Acked-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | jhash.h | s | 4.3K | 149 | Jozsef Kadlecsik | kadlec@blackhole.kfki.hu | 1291954627 |  | The new jhash implementation  The current jhash.h implements the lookup2() hash function by Bob Jenkins. However, lookup2() is outdated as Bob wrote a new hash function called lookup3(). The patch replaces the lookup2() implementation of the 'jhash*' functions with that of lookup3().  You can read a longer comparison of the two and other hash functions at http://burtleburtle.net/bob/hash/doobs.html.  Signed-off-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu> Acked-by: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cyclades.h | s | 24K | 688 | Alan Cox | alan@linux.intel.com | 1253391211 |  | serial: move delta_msr_wait into the tty_port  This is used by various drivers not just serial and can be extracted as commonality  Signed-off-by: Alan Cox <alan@linux.intel.com>
f | qnx4_fs.h | s | 2.2K | 78 | Al Viro | viro@zeniv.linux.org.uk | 1244770572 |  | fs/qnx4: sanitize includes  fs-internal parts of qnx4_fs.h taken to fs/qnx4/qnx4.h, includes adjusted, qnx4_fs.h doesn't need unifdef anymore.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | lp.h | s | 6.1K | 164 | Matthias Kaehlcke | matthias.kaehlcke@gmail.com | 1202323261 |  | Parallel port: convert port_mutex to the mutex API  Parallel port: Convert port_mutex to the mutex API  [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: Matthias Kaehlcke <matthias.kaehlcke@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | hidraw.h | s | 2.4K | 77 | Jiri Kosina | jkosina@suse.cz | 1335775157 |  | HID: fix return value of hidraw_report_event() when !CONFIG_HIDRAW  Commit b6787242f327 ("HID: hidraw: add proper error handling to raw event reporting") forgot to update the static inline version of hidraw_report_event() for the case when CONFIG_HIDRAW is unset. Fix that up.  Reported-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | shrinker.h | s | 1.5K | 39 | Konstantin Khlebnikov | khlebnikov@openvz.org | 1323445827 |  | vmscan: use atomic-long for shrinker batching  Use atomic-long operations instead of looping around cmpxchg().  [akpm@linux-foundation.org: massage atomic.h inclusions] Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Cc: Dave Chinner <david@fromorbit.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_addrlabel.h | s | 658B | 26 | Eric Dumazet | eric.dumazet@gmail.com | 1257357058 |  | net: cleanup include/linux  This cleanup patch puts struct/union/enum opening braces, in first line to ease grep games.  struct something {  becomes :  struct something {  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | font.h | s | 1.2K | 47 | Antonino A. Daplas | adaplas@gmail.com | 1178648131 |  | fbcon: font setting should check limitation of driver  fbcon_set_font() will now check if the new font dimensions can be drawn by the driver (by checking pixmap.blit_x and blit_y).  Similarly, add 2 new parameters to get_default_font(), font_w and font_h, to further aid in the font selection process.  Signed-off-by: Antonino Daplas <adaplas@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dccp.h | s | 16K | 503 | Eric Dumazet | edumazet@google.com | 1334431466 |  | inet: makes syn_ack_timeout mandatory  There are two struct request_sock_ops providers, tcp and dccp.  inet_csk_reqsk_queue_prune() can avoid testing syn_ack_timeout being NULL if we make it non NULL like syn_ack_timeout  Signed-off-by: Eric Dumazet <edumazet@google.com> Cc: Gerrit Renker <gerrit@erg.abdn.ac.uk> Cc: dccp@vger.kernel.org Signed-off-by: David S. Miller <davem@davemloft.net>
f | seq_file.h | s | 4.6K | 139 | Linus Torvalds | torvalds@linux-foundation.org | 1332608919 |  | 
f | consolemap.h | s | 1.0K | 29 | David Woodhouse | dwmw2@infradead.org | 1212587772 |  | Make console charset translation optional  By turning off the new CONSOLE_TRANSLATIONS option and dropping the associated code and tables from the kernel, we can save about 7KiB.  Taken from linux-tiny project by Tim Bird and mangled further by dwmw2.  Signed-off-by: Tim Bird <tim.bird@am.sony.com> Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | un.h | s | 239B | 9 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
d | usb |  | 51 items |  | Alan Stern | stern@rowland.harvard.edu | 1339618299 |  | USB: add NO_D3_DURING_SLEEP flag and revert 151b61284776be2  This patch (as1558) fixes a problem affecting several ASUS computers: The machine crashes or corrupts memory when going into suspend if the ehci-hcd driver is bound to any controllers.  Users have been forced to unbind or unload ehci-hcd before putting their systems to sleep.  After extensive testing, it was determined that the machines don't like going into suspend when any EHCI controllers are in the PCI D3 power state.  Presumably this is a firmware bug, but there's nothing we can do about it except to avoid putting the controllers in D3 during system sleep.  The patch adds a new flag to indicate whether the problem is present, and avoids changing the controller's power state if the flag is set. Runtime suspend is unaffected; this matters only for system suspend. However as a side effect, the controller will not respond to remote wakeup requests while the system is asleep.  Hence USB wakeup is not functional -- but of course, this is already true in the current state of affairs.  A similar patch has already been applied as commit 151b61284776be2d6f02d48c23c3625678960b97 (USB: EHCI: fix crash during suspend on ASUS computers).  The patch supersedes that one and reverts it.  There are two differences:  	The old patch added the flag at the USB level; this patch 	adds it at the PCI level.  	The old patch applied to all chipsets with the same vendor, 	subsystem vendor, and product IDs; this patch makes an 	exception for a known-good system (based on DMI information).  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Tested-by: D√¢niel Fraga <fragabr@gmail.com> Tested-by: Andrey Rahmatullin <wrar@wrar.name> Tested-by: Steven Rostedt <rostedt@goodmis.org> Cc: stable <stable@vger.kernel.org> Reviewed-by: Rafael J. Wysocki <rjw@sisk.pl> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | irda.h | s | 7.3K | 214 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | transport_class.h | s | 2.5K | 83 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | memstick.h | s | 9.7K | 296 | Harvey Harrison | harvey.harrison@gmail.com | 1231548881 |  | memstick: annotate endianness of attribute structs  The code was shifting the endianness appropriately everywhere, annotate the structs to avoid the sparse warnings when assigning the endian types to the struct members, or passing them to be[16||32]_to_cpu:  drivers/memstick/core/mspro_block.c:331:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:333:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:335:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:337:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:341:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:347:4: warning: cast to restricted __be32 drivers/memstick/core/mspro_block.c:356:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:358:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:364:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:367:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:369:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:371:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:377:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:478:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:480:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:482:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:484:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:486:4: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:689:22:    expected unsigned int [unsigned] [assigned] data_address drivers/memstick/core/mspro_block.c:689:22:    got restricted __be32 [usertype] <noident> drivers/memstick/core/mspro_block.c:697:3: warning: cast to restricted __be32 drivers/memstick/core/mspro_block.c:960:17: warning: incorrect type in initializer (different base types) drivers/memstick/core/mspro_block.c:960:17:    expected unsigned short [unsigned] data_count drivers/memstick/core/mspro_block.c:960:17:    got restricted __be16 [usertype] <noident> drivers/memstick/core/mspro_block.c:993:6: warning: cast to restricted __be16 drivers/memstick/core/mspro_block.c:995:28: warning: cast to restricted __be16  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Cc: Alex Dubov <oakad@yahoo.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mdio-bitbang.h | s | 1.1K | 33 | Srinivas Kandagatla | srinivas.kandagatla@st.com | 1321394177 |  | mdio-gpio: Add reset functionality to mdio-gpio driver(v2).  This patch adds phy reset functionality to mdio-gpio driver. Now mdio_gpio_platform_data has new member as function pointer which can be filled at the bsp level for a callback from phy infrastructure. Also the mdio-bitbang driver fills-in the reset function of mii_bus structure.  Without this patch the bsp level code has to takecare of the reseting PHY's on the bus, which become bit hacky for every bsp and phy-infrastructure is ignored aswell.  Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@st.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | irqnr.h | s | 1.4K | 46 | Paul Mundt | lethal@linux-sh.org | 1288259919 |  | genirq: Fix up irq_node() for irq_data changes.  Now that the node ID is tracked in the irq_data structure, update the irq_node() definition accordingly. This fixes up irq_node() usage under GENERIC_HARDIRQS_NO_DEPRECATED && SMP.  Signed-off-by: Paul Mundt <lethal@linux-sh.org> LKML-Reference: <20101028023031.GB10365@linux-sh.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | leds-pca9532.h | s | 1.0K | 40 | Joachim Eastwood | manabian@gmail.com | 1306337990 |  | drivers/leds/leds-pca9532.c: add gpio capability  Allow unused leds on pca9532 to be used as gpio.  The board I am working on now has no less than 6 pca9532 chips.  One chips is used for only leds, one has 14 leds and 2 gpio and the rest of the chips are gpio only.  There is also one board in mainline which could use this capabilty; arch/arm/mach-iop32x/n2100.c  232         {       .type = PCA9532_TYPE_NONE }, /* power OFF gpio */  233         {       .type = PCA9532_TYPE_NONE }, /* reset gpio */  This patch defines a new pin type, PCA9532_TYPE_GPIO, and registers a gpiochip if any pin has this type set.  The gpio will registers all chip pins but will filter on gpio_request.  [randy.dunlap@oracle.com: fix build when GPIOLIB is not enabled] Signed-off-by: Joachim Eastwood <joachim.eastwood@jotron.com> Reviewed-by: Wolfram Sang <w.sang@pengutronix.de> Reviewed-by: H Hartley Sweeten <hsweeten@visionengravers.com> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Grant Likely <grant.likely@secretlab.ca> Signed-off-by: Randy Dunlap <randy.dunlap@oracle.com> Cc: Jan Weitzel <j.weitzel@phytec.de> Cc: Juergen Kilb <j.kilb@phytec.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | stddef.h | s | 382B | 18 | Lubos Lunak | l.lunak@suse.cz | 1334414869 |  | do not export kernel's NULL #define to userspace  GCC's NULL is actually __null, which allows detecting some questionable NULL usage and warn about it.  Moreover each platform/compiler should have its own stddef.h anyway (which is different from linux/stddef.h).  So there's no good reason to leak kernel's NULL to userspace and override what the compiler provides.  Signed-off-by: Lubo≈° Lu≈à√°k <l.lunak@suse.cz> Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | memblock.h | s | 8.0K | 213 | Tejun Heo | tj@kernel.org | 1323368529 |  | memblock: Reimplement memblock allocation using reverse free area iterator  Now that all early memory information is in memblock when enabled, we can implement reverse free area iterator and use it to implement NUMA aware allocator which is then wrapped for simpler variants instead of the confusing and inefficient mending of information in separate NUMA aware allocator.  Implement for_each_free_mem_range_reverse(), use it to reimplement memblock_find_in_range_node() which in turn is used by all allocators.  The visible allocator interface is inconsistent and can probably use some cleanup too.  Signed-off-by: Tejun Heo <tj@kernel.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Yinghai Lu <yinghai@kernel.org>
f | fsl-diu-fb.h | s | 3.8K | 142 | Timur Tabi | timur@freescale.com | 1317777012 |  | drivers/video: fsl-diu-fb: only DIU modes 0 and 1 are supported  The Freescale DIU video controller supports five video "modes", but only the first two are used by the driver.  The other three are special modes that don't make sense for a framebuffer driver.  Therefore, there's no point in keeping a global variable that indicates which mode we're supposed to use.  Signed-off-by: Timur Tabi <timur@freescale.com> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | tipc.h | s | 5.4K | 172 | Allan Stephens | Allan.Stephens@windriver.com | 1305057836 |  | tipc: Abort excessive send requests as early as possible  Adds checks to TIPC's socket send routines to promptly detect and abort attempts to send more than 66,000 bytes in a single TIPC message or more than 2**31-1 bytes in a single TIPC byte stream request. In addition, this ensures that the number of iovecs in a send request does not exceed the limits of a standard integer variable.  Signed-off-by: Allan Stephens <Allan.Stephens@windriver.com> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | kvm_types.h | s | 1.7K | 67 | Gleb Natapov | gleb@redhat.com | 1294824188 |  | KVM: Add memory slot versioning and use it to provide fast guest write interface  Keep track of memslots changes by keeping generation number in memslots structure. Provide kvm_write_guest_cached() function that skips gfn_to_hva() translation if memslots was not changed since previous invocation.  Acked-by: Rik van Riel <riel@redhat.com> Signed-off-by: Gleb Natapov <gleb@redhat.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | skbuff.h | s | 71K | 2280 | Eric Dumazet | edumazet@google.com | 1339799415 |  | net: remove skb_orphan_try()  Orphaning skb in dev_hard_start_xmit() makes bonding behavior unfriendly for applications sending big UDP bursts : Once packets pass the bonding device and come to real device, they might hit a full qdisc and be dropped. Without orphaning, the sender is automatically throttled because sk->sk_wmemalloc reaches sk->sk_sndbuf (assuming sk_sndbuf is not too big)  We could try to defer the orphaning adding another test in dev_hard_start_xmit(), but all this seems of little gain, now that BQL tends to make packets more likely to be parked in Qdisc queues instead of NIC TX ring, in cases where performance matters.  Reverts commits : fc6055a5ba31 net: Introduce skb_orphan_try() 87fd308cfc6b net: skb_tx_hash() fix relative to skb_orphan_try() and removes SKBTX_DRV_NEEDS_SK_REF flag  Reported-and-bisected-by: Jean-Michel Hautbois <jhautbois@gmail.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Tested-by: Oliver Hartkopp <socketcan@hartkopp.net> Acked-by: Oliver Hartkopp <socketcan@hartkopp.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | timer.h | s | 8.6K | 256 | Yong Zhang | yong.zhang@windriver.com | 1287751585 |  | timer: Make try_to_del_timer_sync() the same on SMP and UP  On UP try_to_del_timer_sync() is mapped to del_timer() which does not take the running timer callback into account, so it has different semantics.  Remove the SMP dependency of try_to_del_timer_sync() by using base->running_timer in the UP case as well.  [ tglx: Removed set_running_timer() inline and tweaked the changelog ]  Signed-off-by: Yong Zhang <yong.zhang0@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Peter Zijlstra <peterz@infradead.org> Acked-by: Oleg Nesterov <oleg@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | nls.h | s | 3.0K | 86 | Alan Stern | stern@rowland.harvard.edu | 1321642261 |  | NLS: improve UTF8 -> UTF16 string conversion routine  The utf8s_to_utf16s conversion routine needs to be improved.  Unlike its utf16s_to_utf8s sibling, it doesn't accept arguments specifying the maximum length of the output buffer or the endianness of its 16-bit output.  This patch (as1501) adds the two missing arguments, and adjusts the only two places in the kernel where the function is called.  A follow-on patch will add a third caller that does utilize the new capabilities.  The two conversion routines are still annoyingly inconsistent in the way they handle invalid byte combinations.  But that's a subject for a different patch.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> CC: Clemens Ladisch <clemens@ladisch.de> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | baycom.h | s | 820B | 30 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | of_device.h | s | 2.0K | 55 | Linus Torvalds | torvalds@linux-foundation.org | 1332610897 |  | 
f | irqdesc.h | s | 5.1K | 155 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103955 |  | irq: don't put module.h into irq.h for tracking irqgen modules.  Recent commit "irq: Track the  owner of irq descriptor" in commit ID b6873807a7143b7 placed module.h into linux/irq.h but we are trying to limit module.h inclusion to just C files that really need it, due to its size and number of children includes.  This targets just reversing that include.  Add in the basic "struct module" since that is all we really need to ensure things compile.  In theory, b687380 should have added the module.h include to the irqdesc.h header as well, but the implicit module.h everywhere presence masked this from showing up.  So give it the "struct module" as well.  As for the C files, irqdesc.c is only using THIS_MODULE, so it does not need module.h - give it export.h instead.  The C file irq/manage.c is now (as of b687380) using try_module_get and module_put and so it needs module.h (which it already has).  Also convert the irq_alloc_descs variants to macros, since all they really do is is call the __irq_alloc_descs primitive. This avoids including export.h and no debug info is lost.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | path.h | s | 400B | 15 | Al Viro | viro@zeniv.linux.org.uk | 1295203627 |  | sanitize vfsmount refcounting changes  Instead of splitting refcount between (per-cpu) mnt_count and (SMP-only) mnt_longrefs, make all references contribute to mnt_count again and keep track of how many are longterm ones.  Accounting rules for longterm count: 	* 1 for each fs_struct.root.mnt 	* 1 for each fs_struct.pwd.mnt 	* 1 for having non-NULL ->mnt_ns 	* decrement to 0 happens only under vfsmount lock exclusive  That allows nice common case for mntput() - since we can't drop the final reference until after mnt_longterm has reached 0 due to the rules above, mntput() can grab vfsmount lock shared and check mnt_longterm. If it turns out to be non-zero (which is the common case), we know that this is not the final mntput() and can just blindly decrement percpu mnt_count.  Otherwise we grab vfsmount lock exclusive and do usual decrement-and-check of percpu mnt_count.  For fs_struct.c we have mnt_make_longterm() and mnt_make_shortterm(); namespace.c uses the latter in places where we don't already hold vfsmount lock exclusive and opencodes a few remaining spots where we need to manipulate mnt_longterm.  Note that we mostly revert the code outside of fs/namespace.c back to what we used to have; in particular, normal code doesn't need to care about two kinds of references, etc.  And we get to keep the optimization Nick's variant had bought us...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | timb_gpio.h | s | 1.3K | 34 | Richard R√∂jfors | richard.rojfors@mocean-labs.com | 1260976800 |  | gpio: add GPIO driver for the Timberdale FPGA  A GPIO driver for the Timberdale FPGA found on the Intel Atom board Russellville.  The GPIO driver also has an IRQ-chip to support interrupts on the pins.  Signed-off-by: Richard R√∂jfors <richard.rojfors@mocean-labs.com> Cc: David Brownell <david-b@pacbell.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fuse.h | s | 11K | 574 | Anatol Pomozov | anatol.pomozov@gmail.com | 1335349505 |  | fuse: add FALLOCATE operation  fallocate filesystem operation preallocates media space for the given file. If fallocate returns success then any subsequent write to the given range never fails with 'not enough space' error.  Signed-off-by: Anatol Pomozov <anatol.pomozov@gmail.com> Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>
f | dcookies.h | s | 1.2K | 54 | Alexey Dobriyan | adobriyan@gmail.com | 1294678304 |  | headers: path.h redux  Remove path.h from sched.h and other files.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fips.h | s | 128B | 8 | Neil Horman | nhorman@tuxdriver.com | 1245325821 |  | random: Add optional continuous repetition test to entropy store based rngs  FIPS-140 requires that all random number generators implement continuous self tests in which each extracted block of data is compared against the last block for repetition.  The ansi_cprng implements such a test, but it would be nice if the hw rng's did the same thing.  Obviously its not something thats always needed, but it seems like it would be a nice feature to have on occasion. I've written the below patch which allows individual entropy stores to be flagged as desiring a continuous test to be run on them as is extracted.  By default this option is off, but is enabled in the event that fips mode is selected during bootup.  Signed-off-by: Neil Horman <nhorman@tuxdriver.com> Acked-by: Matt Mackall <mpm@selenic.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
f | timb_dma.h | s | 1.7K | 50 | Richard R√∂jfors | richard.rojfors@pelagicore.com | 1269562723 |  | dma: Add timb-dma  Adds the support for the DMA engine withing the timberdale FPGA.  The DMA channels are strict device to host, or host to device and can not be used for generic memcpy.  Signed-off-by: Richard R√∂jfors <richard.rojfors@pelagicore.com> Signed-off-by: Dan Williams <dan.j.williams@intel.com>
f | serial_core.h | s | 14K | 462 | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1334789851 |  | Merge 3.4-rc3 into tty-next  This allows us to pick up some changes needed for other serial patches.  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | swapops.h | s | 4.9K | 168 | Hugh Dickins | hughd@google.com | 1339822094 |  | swap: fix shmem swapping when more than 8 areas  Minchan Kim reports that when a system has many swap areas, and tmpfs swaps out to the ninth or more, shmem_getpage_gfp()'s attempts to read back the page cannot locate it, and the read fails with -ENOMEM.  Whoops.  Yes, I blindly followed read_swap_header()'s pte_to_swp_entry( swp_entry_to_pte()) technique for determining maximum usable swap offset, without stopping to realize that that actually depends upon the pte swap encoding shifting swap offset to the higher bits and truncating it there.  Whereas our radix_tree swap encoding leaves offset in the lower bits: it's swap "type" (that is, index of swap area) that was truncated.  Fix it by reducing the SWP_TYPE_SHIFT() in swapops.h, and removing the broken radix_to_swp_entry(swp_to_radix_entry()) from read_swap_header().  This does not reduce the usable size of a swap area any further, it leaves it as claimed when making the original commit: no change from 3.0 on x86_64, nor on i386 without PAE; but 3.0's 512GB is reduced to 128GB per swapfile on i386 with PAE.  It's not a change I would have risked five years ago, but with x86_64 supported for ten years, I believe it's appropriate now.  Hmm, and what if some architecture implements its swap pte with offset encoded below type? That would equally break the maximum usable swap offset check.  Happily, they all follow the same tradition of encoding offset above type, but I'll prepare a check on that for next.  Reported-and-Reviewed-and-Tested-by: Minchan Kim <minchan@kernel.org> Signed-off-by: Hugh Dickins <hughd@google.com> Cc: stable@vger.kernel.org [3.1, 3.2, 3.3, 3.4] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | rfkill.h | s | 11K | 323 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | via-gpio.h | s | 334B | 12 | Jonathan Corbet | corbet@lwn.net | 1273615679 |  | viafb: move some include files to include/linux  These are the files which should be available to subdevices compiled outside of drivers/video/via.  Cc: ScottFang@viatech.com.cn Cc: JosephChan@via.com.tw Cc: Harald Welte <laforge@gnumonks.org> Acked-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Signed-off-by: Jonathan Corbet <corbet@lwn.net>
f | irq_work.h | s | 460B | 18 | Huang Ying | ying.huang@intel.com | 1317725029 |  | irq_work: Use llist in the struct irq_work logic  Use llist in irq_work instead of the lock-less linked list implementation in irq_work to avoid the code duplication.  Signed-off-by: Huang Ying <ying.huang@intel.com> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Link: http://lkml.kernel.org/r/1315461646-1379-6-git-send-email-ying.huang@intel.com Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | dca.h | s | 2.6K | 69 | Maciej Sosnowski | maciej.sosnowski@intel.com | 1252602005 |  | dca: registering requesters in multiple dca domains  This patch enables DCA support on multiple-IOH/multiple-IIO architectures. It modifies dca module by replacing single dca_providers list with dca_domains list, each domain containing separate list of providers. This approach lets dca driver manage multiple domains, i.e. sets of providers and requesters mapped back to the same PCI root complex device. The driver takes care to register each requester to a provider from the same domain.  Signed-off-by: Dan Williams <dan.j.williams@intel.com> Signed-off-by: Maciej Sosnowski <maciej.sosnowski@intel.com>
f | mv643xx.h | s | 52K | 843 | Tzachi Perelstein | tzachi@marvell.com | 1201359839 |  | [I2C] Split mv643xx I2C platform support  The motivation for this change is to allow other chips, like the Marvell Orion ARM SoC family, to use the existing i2c-mv64xxx driver.  Signed-off-by: Tzachi Perelstein <tzachi@marvell.com> Acked-by: Nicolas Pitre <nico@marvell.com> Acked-by: Dale Farnsworth <dale@farnsworth.org> Acked-by: Mark A. Greer <mgreer@mvista.com> Acked-by: Jean Delvare <khali@linux-fr.org>
f | serial_pnx8xxx.h | s | 2.6K | 70 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | sem.h | s | 3.7K | 104 | Manfred Spraul | manfred@colorfullife.com | 1320275221 |  | include/linux/sem.h: make sysv_sem empty if SYSVIPC is disabled  For the sysvsem undo, each task struct contains a sysv_sem structure with a pointer to the undo information.  This pointer is only necessary if sysvipc is enabled - thus the pointer can be made conditional on CONFIG_SYSVIPC.  Signed-off-by: Manfred Spraul <manfred@colorfullife.com> Acked-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Mike Galbraith <efault@gmx.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | v4l2-subdev.h | s | 5.3K | 167 | Sakari Ailus | sakari.ailus@iki.fi | 1334080841 |  | [media] v4l: VIDIOC_SUBDEV_S_SELECTION and VIDIOC_SUBDEV_G_SELECTION IOCTLs  Add support for VIDIOC_SUBDEV_S_SELECTION and VIDIOC_SUBDEV_G_SELECTION IOCTLs. They replace functionality provided by VIDIOC_SUBDEV_S_CROP and VIDIOC_SUBDEV_G_CROP IOCTLs and also add new functionality (composing).  VIDIOC_SUBDEV_G_CROP and VIDIOC_SUBDEV_S_CROP continue to be supported.  Signed-off-by: Sakari Ailus <sakari.ailus@iki.fi> Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | w1-gpio.h | s | 661B | 22 | Daniel Mack | daniel@caiaq.de | 1245355438 |  | w1-gpio: add external pull-up enable callback  On embedded devices, sleep mode conditions can be tricky to handle, Especially when processors tend to pull-down the w1 bus during sleep.  Bus slaves (such as the ds2760) may interpret this as a reason for power-down conditions and entirely switch off the device.  This patch adds a callback function pointer to let users switch on and off the external pull-up resistor.  This lets the outside world know whether the processor is currently actively driving the bus or not.  When this callback is not provided, the code behaviour won't change.  Signed-off-by: Daniel Mack <daniel@caiaq.de> Acked-by: Ville Syrjala <syrjala@sci.fi> Acked-by: Evgeniy Polyakov <johnpol@2ka.mipt.ru> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | lp855x.h | s | 3.3K | 110 | Kim, Milo | Milo.Kim@ti.com | 1332547113 |  | backlight: new backlight driver for LP855x devices  THis driver supports TI LP8550/LP8551/LP8552/LP8553/LP8556 backlight devices.  The brightness can be controlled by the I2C or PWM input.  The lp855x driver provides both modes.  For the PWM control, pwm-specific functions can be defined in the platform data.  And some information can be read via the sysfs(lp855x device attributes).  For details, please refer to Documentation/backlight/lp855x-driver.txt.  [axel.lin@gmail.com: add missing mutex_unlock in lp855x_read_byte() error path] [axel.lin@gmail.com: check platform data in lp855x_probe()] [axel.lin@gmail.com: small cleanups] [dan.carpenter@oracle.com: silence a compiler warning] [axel.lin@gmail.com: use id->driver_data to differentiate lp855x chips] [akpm@linux-foundation.org: simplify boolean return expression] Signed-off-by: Milo(Woogyom) Kim <milo.kim@ti.com> Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: Richard Purdie <rpurdie@rpsys.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sh_intc.h | s | 3.4K | 126 | Paul Mundt | lethal@linux-sh.org | 1337681275 |  | sh: intc: Kill off special reservation interface.  At present reserving the IRLs in the IRQ bitmap in addition to the dropping of the legacy IRQ pre-allocation prevent IRL IRQs from being allocated for the x3proto board.  The only reason to permit reservations was to lock down possible hardware vectors prior to dynamic IRQ scanning, but this doesn't matter much given that the hardware controller configuration is sorted before we get around to doing any dynamic IRQ allocation anyways. Beyond that, all of the tables are __init annotated, so quite a bit more work would need to be done to support reconfiguring things like IRL controllers on the fly, much more than would ever make it worth the hassle.  Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | pci-dma.h | s | 415B | 9 | FUJITA Tomonori | fujita.tomonori@lab.ntt.co.jp | 1268437962 |  | dma-mapping.h: add the dma_unmap state API  Adds the following macros:  DECLARE_DMA_UNMAP_ADDR(ADDR_NAME) DECLARE_DMA_UNMAP_LEN(LEN_NAME) dma_unmap_addr(PTR, ADDR_NAME) dma_unmap_addr_set(PTR, ADDR_NAME, VAL) dma_unmap_len(PTR, LEN_NAME) dma_unmap_len_set(PTR, LEN_NAME, VAL)  The API corresponds to the pci_unmap state API.  We'll move to this new generic API from the PCI specific API in the long term.  As include/asm-generic/pci-dma-compat.h does, the pci_unmap API simply calls the new generic API for some time.  Signed-off-by: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp> Cc: James Bottomley <James.Bottomley@suse.de> Cc: David S. Miller <davem@davemloft.net> Cc: Jesse Barnes <jbarnes@virtuousgeek.org> Cc: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | rculist_nulls.h | s | 4.0K | 107 | Arnd Bergmann | arnd@arndb.de | 1282263480 |  | rculist: avoid __rcu annotations  This avoids warnings from missing __rcu annotations in the rculist implementation, making it possible to use the same lists in both RCU and non-RCU cases.  We can add rculist annotations later, together with lockdep support for rculist, which is missing as well, but that may involve changing all the users.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com> Cc: Pavel Emelyanov <xemul@openvz.org> Cc: Sukadev Bhattiprolu <sukadev@us.ibm.com> Reviewed-by: Josh Triplett <josh@joshtriplett.org>
f | init_ohci1394_dma.h | s | 157B | 4 | Bernhard Kaindl | bk@suse.de | 1201696451 |  | x86: early boot debugging via FireWire (ohci1394_dma=early)  This patch adds a new configuration option, which adds support for a new early_param which gets checked in arch/x86/kernel/setup_{32,64}.c:setup_arch() to decide wether OHCI-1394 FireWire controllers should be initialized and enabled for physical DMA access to allow remote debugging of early problems like issues ACPI or other subsystems which are executed very early.  If the config option is not enabled, no code is changed, and if the boot paramenter is not given, no new code is executed, and independent of that, all new code is freed after boot, so the config option can be even enabled in standard, non-debug kernels.  With specialized tools, it is then possible to get debugging information from machines which have no serial ports (notebooks) such as the printk buffer contents, or any data which can be referenced from global pointers, if it is stored below the 4GB limit and even memory dumps of of the physical RAM region below the 4GB limit can be taken without any cooperation from the CPU of the host, so the machine can be crashed early, it does not matter.  In the extreme, even kernel debuggers can be accessed in this way. I wrote a small kgdb module and an accompanying gdb stub for FireWire which allows to gdb to talk to kgdb using remote remory reads and writes over FireWire.  An version of the gdb stub fore FireWire is able to read all global data from a system which is running a a normal kernel without any kernel debugger, without any interruption or support of the system's CPU. That way, e.g. the task struct and so on can be read and even manipulated when the physical DMA access is granted.  A HOWTO is included in this patch, in Documentation/debugging-via-ohci1394.txt and I've put a copy online at ftp://ftp.suse.de/private/bk/firewire/docs/debugging-via-ohci1394.txt  It also has links to all the tools which are available to make use of it another copy of it is online at: ftp://ftp.suse.de/private/bk/firewire/kernel/ohci1394_dma_early-v2.diff  Signed-Off-By: Bernhard Kaindl <bk@suse.de> Tested-By: Thomas Renninger <trenn@suse.de> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | security.h | s | 109K | 2759 | Al Viro | viro@zeniv.linux.org.uk | 1338561421 |  | take security_mmap_file() outside of ->mmap_sem  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | blk_types.h | s | 6.7K | 176 | Tejun Heo | tj@kernel.org | 1331065644 |  | block: implement bio_associate_current()  IO scheduling and cgroup are tied to the issuing task via io_context and cgroup of %current.  Unfortunately, there are cases where IOs need to be routed via a different task which makes scheduling and cgroup limit enforcement applied completely incorrectly.  For example, all bios delayed by blk-throttle end up being issued by a delayed work item and get assigned the io_context of the worker task which happens to serve the work item and dumped to the default block cgroup.  This is double confusing as bios which aren't delayed end up in the correct cgroup and makes using blk-throttle and cfq propio together impossible.  Any code which punts IO issuing to another task is affected which is getting more and more common (e.g. btrfs).  As both io_context and cgroup are firmly tied to task including userland visible APIs to manipulate them, it makes a lot of sense to match up tasks to bios.  This patch implements bio_associate_current() which associates the specified bio with %current.  The bio will record the associated ioc and blkcg at that point and block layer will use the recorded ones regardless of which task actually ends up issuing the bio.  bio release puts the associated ioc and blkcg.  It grabs and remembers ioc and blkcg instead of the task itself because task may already be dead by the time the bio is issued making ioc and blkcg inaccessible and those are all block layer cares about.  elevator_set_req_fn() is updated such that the bio elvdata is being allocated for is available to the elevator.  This doesn't update block cgroup policies yet.  Further patches will implement the support.  -v2: #ifdef CONFIG_BLK_CGROUP added around bio->bi_ioc dereference in      rq_ioc() to fix build breakage.  Signed-off-by: Tejun Heo <tj@kernel.org> Cc: Vivek Goyal <vgoyal@redhat.com> Cc: Kent Overstreet <koverstreet@google.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | stacktrace.h | s | 1.0K | 29 | Masami Hiramatsu | masami.hiramatsu.pt@hitachi.com | 1308106131 |  | x86: Swap save_stack_trace_regs parameters  Swap the 1st and 2nd parameters of save_stack_trace_regs() as same as the parameters of save_stack_trace_tsk().  Signed-off-by: Masami Hiramatsu <masami.hiramatsu.pt@hitachi.com> Cc: yrl.pp-manager.tt@hitachi.com Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Namhyung Kim <namhyung@gmail.com> Link: http://lkml.kernel.org/r/20110608070921.17777.31103.stgit@fedora15 Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
f | if_bonding.h | s | 4.0K | 110 | Flavio Leitner | fleitner@redhat.com | 1286335618 |  | bonding: add retransmit membership reports tunable  Allow sysadmins to configure the number of multicast membership report sent on a link failure event.  Signed-off-by: Flavio Leitner <fleitner@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | res_counter.h | s | 5.8K | 197 | Glauber Costa | glommer@parallels.com | 1338333747 |  | rescounter: remove __must_check from res_counter_charge_nofail()  Since we will succeed with the allocation no matter what, there isn't a need to use __must_check with it.  It can very well be optional.  Signed-off-by: Glauber Costa <glommer@parallels.com> Signed-off-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Cc: Michal Hocko <mhocko@suse.cz> Cc: Johannes Weiner <hannes@cmpxchg.org> Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: Ying Han <yinghan@google.com> Reviewed-by: Tejun Heo <tj@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | spinlock_api_smp.h | s | 5.4K | 165 | Raghavendra K T | raghavendra.kt@linux.vnet.ibm.com | 1332505137 |  | locking/kconfig: Simplify INLINE_SPIN_UNLOCK usage  Get rid of INLINE_SPIN_UNLOCK entirely replacing it with UNINLINE_SPIN_UNLOCK instead of the reverse meaning.  Whoever wants to change the default spinlock inlining behavior and uninline the spinlocks for some weird reason, such as spinlock debugging, paravirt etc. can now all just select UNINLINE_SPIN_UNLOCK  Original discussion at: https://lkml.org/lkml/2012/3/21/357  Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Raghavendra K T <raghavendra.kt@linux.vnet.ibm.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Chris Metcalf <cmetcalf@tilera.com> Cc: Chris Zankel <chris@zankel.net> Cc: linux-mips@linux-mips.org Link: http://lkml.kernel.org/r/20120322095502.30866.75756.sendpatchset@codeblue [ tidied up the changelog a bit ] Signed-off-by: Ingo Molnar <mingo@kernel.org>
f | syslog.h | s | 1.9K | 47 | Kees Cook | kees.cook@canonical.com | 1265253641 |  | syslog: use defined constants instead of raw numbers  Right now the syslog "type" action are just raw numbers which makes the source difficult to follow.  This patch replaces the raw numbers with defined constants for some level of sanity.  Signed-off-by: Kees Cook <kees.cook@canonical.com> Acked-by: John Johansen <john.johansen@canonical.com> Acked-by: Serge Hallyn <serue@us.ibm.com> Signed-off-by: James Morris <jmorris@namei.org>
f | radeonfb.h | s | 297B | 9 | Jaswinder Singh Rajput | jaswinder@infradead.org | 1232066381 |  | include of <linux/types.h> is preferred over <asm/types.h>  Impact: fix 15 make headers_check warnings:  include of <linux/types.h> is preferred over <asm/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | of_fdt.h | s | 4.6K | 110 | Uwe Kleine-K√∂nig | u.kleine-koenig@pengutronix.de | 1325005033 |  | ARM/of: allow *machine_desc.dt_compat to be const  This allows dt_compat to point to a constant list of compatible strings.  Signed-off-by: Uwe Kleine-K√∂nig <u.kleine-koenig@pengutronix.de> Signed-off-by: Rob Herring <rob.herring@calxeda.com>
f | cramfs_fs.h | s | 2.9K | 83 | Alexander Shishkin | virtuoso@slind.org | 1294934602 |  | cramfs: hide function prototypes behind __KERNEL__ macro  Currently, 3 kernel function prototypes are present in a header file exported to userland. This patch fixes it.  Signed-off-by: Alexander Shishkin <virtuoso@slind.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | iso_fs.h | s | 6.3K | 145 | Jeff Garzik | jeff@garzik.org | 1159110799 |  | Move several *_SUPER_MAGIC symbols to include/linux/magic.h.  Signed-off-by: Jeff Garzik <jeff@garzik.org>
f | nfs2.h | s | 1.4K | 61 | Chuck Lever | chuck.lever@oracle.com | 1245286931 |  | NFS: Clean up MNT program definitions  Clean up:  Relocate MNT program procedure number definitions to the only file that uses them.  Relocate the version number definitions, which are shared, to nfs.h.  Remove duplicate program number definitions.  Signed-off-by: Chuck Lever <chuck.lever@oracle.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | clk-provider.h | s | 11K | 311 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337108559 |  | clk: Provide dummy clk_unregister()  While there's no actual implementation behind it having the call to use in drivers makes them feel neater from a driver author point of view. An actual implementation can wait for someone who needs to use the function in a real system.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> [mturquette@linaro.org: void return type instead of int -EINVAL] Signed-off-by: Mike Turquette <mturquette@linaro.org>
f | lcd.h | s | 3.9K | 108 | Inki Dae | inki.dae@samsung.com | 1338333749 |  | lcd: add callbacks for early fb event blank support  This patchset adds early fb blank feature that a callback of lcd panel driver is called prior to specific fb driver's one.  In the case of MIPI-DSI based video mode LCD Panel, for lcd power off, the power off commands should be transferred to lcd panel with display and mipi-dsi controller enabled because the commands is set to lcd panel at vsync porch period.  and in opposite case, the callback of fb driver should be called prior to lcd panel driver's one because of same issue.  Also if fb_blank mode is changed to FB_BLANK_POWERDOWN then display controller would be off(clock disable) but lcd panel would be still on.  at this time, you could see some issue like sparkling on lcd panel because video clock to be delivered to ldi module of lcd panel was disabled.  this issue could occurs for all lcd panels.  The callback order is as the following:  at fb_blank function of fbmem.c -> fb_notifier_call_chain(FB_EARLY_EVENT_BLANK)        -> lcd panel driver's early_set_power() -> info->fbops->fb_blank()        -> spcefic fb driver's fb_blank() -> fb_notifier_call_chain(FB_EVENT_BLANK)        -> lcd panel driver's set_power()    -> fb_notifier_call_chain(FB_R_EARLY_EVENT_BLANK) if info->fops->fb_blank() was failed.  fb_notifier_call_chain(FB_R_EARLY_EVENT_BLANK) would be called to revert the effects of previous FB_EARLY_EVENT_BLANK call.  and note that if early_set_power() of lcd_ops is NULL then early fb blank callback would be ignored.  This patch:  Add early_set_power and r_early_set_power callbacks.  early_set_power callback is called prior to fb_blank() of fbmem.c and r_early_set_power callback is called if fb_blank() was failed to revert the effects of the early_set_power call of lcd panel driver.  Signed-off-by: Inki Dae <inki.dae@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Cc: Lars-Peter Clausen <lars@metafoo.de> Cc: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Cc: Richard Purdie <rpurdie@rpsys.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | elfnote.h | s | 3.5K | 92 | Adrian Bunk | bunk@kernel.org | 1201558878 |  | remove __attribute_used__  Remove the deprecated __attribute_used__.  [Introduce __section in a few places to silence checkpatch /sam]  Signed-off-by: Adrian Bunk <bunk@kernel.org> Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | pageblock-flags.h | s | 2.2K | 58 | zeal | zealcook@gmail.com | 1288137125 |  | include/linux/pageblock-flags.h: fix set_pageblock_flags() macro definiton  The presently-unused macro was missing one parameter.  Signed-off-by: zeal <zealcook@gmail.com> Acked-by: Mel Gorman <mel@csn.ul.ie> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | eeprom_93cx6.h | s | 2.7K | 70 | Ben Dooks | ben@simtec.co.uk | 1322337579 |  | eeprom_93cx6: Add write support  Add support for writing data to EEPROM.  Signed-off-by: Ben Dooks <ben@simtec.co.uk> Cc: Wolfram Sang <w.sang@pengutronix.de> Cc: Jean Delvare <khali@linux-fr.org> Cc: Linux Kernel <linux-kernel@vger.kernel.org> Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | sock_diag.h | s | 1.1K | 36 | Shan Wei | davidshan@tencent.com | 1335401219 |  | net: sock_diag_handler structs can be const  read only, so change it to const.  Signed-off-by: Shan Wei <davidshan@tencent.com> Acked-by: Pavel Emelyanov <xemul@parallels.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | node.h | s | 2.2K | 76 | Kay Sievers | kay.sievers@vrfy.org | 1324507723 |  | convert 'memory' sysdev_class to a regular subsystem  This moves the 'memory sysdev_class' over to a regular 'memory' subsystem and converts the devices to regular devices. The sysdev drivers are implemented as subsystem interfaces now.  After all sysdev classes are ported to regular driver core entities, the sysdev implementation will be entirely removed from the kernel.  Signed-off-by: Kay Sievers <kay.sievers@vrfy.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | agpgart.h | s | 6.4K | 183 | Arnd Bergmann | arnd@arndb.de | 1238087654 |  | make exported headers use strict posix types  A number of standard posix types are used in exported headers, which is not allowed if __STRICT_KERNEL_NAMES is defined. In order to get rid of the non-__STRICT_KERNEL_NAMES part and to make sane headers the default, we have to change them all to safe types.  There are also still some leftovers in reiserfs_fs.h, elfcore.h and coda.h, but these files have not compiled in user space for a long time.  This leaves out the various integer types ({u_,u,}int{8,16,32,64}_t), which we take care of separately.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Cc: David Airlie <airlied@linux.ie> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Cc: netdev@vger.kernel.org Cc: linux-ppp@vger.kernel.org Cc: Jaroslav Kysela <perex@perex.cz> Cc: Takashi Iwai <tiwai@suse.de> Cc: David Woodhouse <dwmw2@infradead.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | rndis.h | s | 16K | 352 | Linus Walleij | linus.walleij@linaro.org | 1336850120 |  | usb/net: rndis: move bus message definition  This moves the bus message definition to land together with the other message types. This message is not used in the kernel but I'm keeping it anyway.  Signed-off-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | seccomp.h | s | 3.6K | 112 | Will Drewry | wad@chromium.org | 1334715890 |  | seccomp: ignore secure_computing return values  This change is inspired by   https://lkml.org/lkml/2012/4/16/14 which fixes the build warnings for arches that don't support CONFIG_HAVE_ARCH_SECCOMP_FILTER.  In particular, there is no requirement for the return value of secure_computing() to be checked unless the architecture supports seccomp filter.  Instead of silencing the warnings with (void) a new static inline is added to encode the expected behavior in a compiler and human friendly way.  v2: - cleans things up with a static inline     - removes sfr's signed-off-by since it is a different approach v1: - matches sfr's original change  Reported-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Will Drewry <wad@chromium.org> Acked-by: Kees Cook <keescook@chromium.org> Signed-off-by: James Morris <james.l.morris@oracle.com>
f | elf.h | s | 11K | 397 | David Howells | dhowells@redhat.com | 1323698076 |  | UAPI: elf_read_implies_exec() is a kernel-only feature - so hide from userspace  elf_read_implies_exec() is a kernel-only feature as the second parameter is a constant that isn't exported to userspace.  Not only that, but the arch-specific overrides are not exported either.  So hide the macro from userspace.  Similarly, struct file should not be predeclared in userspace.  Signed-off-by: David Howells <dhowells@redhat.com>
f | kmemcheck.h | s | 4.2K | 138 | Rusty Russell | rusty@rustcorp.com.au | 1295842511 |  | Remove MAYBE_BUILD_BUG_ON  Now BUILD_BUG_ON() can handle optimizable constants, we don't need MAYBE_BUILD_BUG_ON any more.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | radix-tree.h | s | 15K | 427 | Konstantin Khlebnikov | khlebnikov@openvz.org | 1338918400 |  | radix-tree: fix contiguous iterator  This patch fixes bug in macro radix_tree_for_each_contig().  If radix_tree_next_slot() sees NULL in next slot it returns NULL, but following radix_tree_next_chunk() switches iterating into next chunk. As result iterating becomes non-contiguous and breaks vfs "splice" and all its users.  Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Reported-and-bisected-by: Hans de Bruin <jmdebruin@xmsnet.nl> Reported-and-bisected-by: Ondrej Zary <linux@rainbow-software.org> Reported-bisected-and-tested-by: Toralf F√∂rster <toralf.foerster@gmx.de> Link: https://lkml.org/lkml/2012/6/5/64 Cc: stable <stable@vger.kernel.org> # 3.4.x Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | netlink.h | s | 8.7K | 222 | Pablo Neira Ayuso | pablo@netfilter.org | 1336501542 |  | netfilter: remove ip_queue support  This patch removes ip_queue support which was marked as obsolete years ago. The nfnetlink_queue modules provides more advanced user-space packet queueing mechanism.  This patch also removes capability code included in SELinux that refers to ip_queue. Otherwise, we break compilation.  Several warning has been sent regarding this to the mailing list in the past month without anyone rising the hand to stop this with some strong argument.  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | getcpu.h | s | 602B | 14 | Andi Kleen | ak@suse.de | 1159573675 |  | [PATCH] Define vsyscall cache as blob to make clearer that user space shouldn't use it  Signed-off-by: Andi Kleen <ak@suse.de>
f | if_x25.h | s | 817B | 22 | Andrew Hendry | andrew.hendry@gmail.com | 1271977956 |  | X25: Add if_x25.h and x25 to device identifiers  V2 Feedback from John Hughes. - Add header for userspace implementations such as xot/xoe to use - Use explicit values for interface stability - No changes to driver patches  V1 - Use identifiers instead of magic numbers for X25 layer 3 to device interface. - Also fixed checkpatch notes on updated code.  [ Add new user header to include/linux/Kbuild  -DaveM ]  Signed-off-by: Andrew Hendry <andrew.hendry@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | tcp.h | s | 15K | 451 | Paul Pluzhnikov | ppluzhnikov@google.com | 1339302438 |  | net: Make linux/tcp.h C++ friendly (trivial)  I originally sent this patch to <trivial@kernel.org>, but Jiri Kosina did not feel that this is fully appropriate for the trivial tree.  Using linux/tcp.h from C++ results in:  cat t.cc #include <linux/tcp.h> int main() { }  g++ -c t.cc  In file included from t.cc:1: /usr/include/linux/tcp.h:72: error: '__u32 __fswab32(__u32)' cannot appear in a constant-expression /usr/include/linux/tcp.h:72: error: a function call cannot appear in a constant-expression ...  Attached trivial patch fixes this problem.  Tested: - the t.cc above compiles with g++ and - the following program generates the same output before/after   the patch:  #include <linux/tcp.h> #include <stdio.h>  int main () { #define P(a) printf("%s: %08x\n", #a, (int)a)  P(TCP_FLAG_CWR);  P(TCP_FLAG_ECE);  P(TCP_FLAG_URG);  P(TCP_FLAG_ACK);  P(TCP_FLAG_PSH);  P(TCP_FLAG_RST);  P(TCP_FLAG_SYN);  P(TCP_FLAG_FIN);  P(TCP_RESERVED_BITS);  P(TCP_DATA_OFFSET); #undef P  return 0; }  Signed-off-by: Paul Pluzhnikov <ppluzhnikov@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | thermal.h | s | 5.0K | 146 | Jean Delvare | khali@linux-fr.org | 1327306525 |  | thermal: Rename generate_netlink_event  It doesn't seem right for the thermal subsystem to export a symbol named generate_netlink_event. This function is thermal-specific and its name should reflect that fact. Rename it to thermal_generate_netlink_event.  Signed-off-by: Jean Delvare <khali@linux-fr.org> Acked-by: Rafael J. Wysocki <rjw@sisk.pl> Acked-by: R.Durgadoss <durgadoss.r@intel.com> Signed-off-by: Len Brown <len.brown@intel.com>
f | keyctl.h | s | 2.9K | 55 | David Howells | dhowells@redhat.com | 1336730216 |  | KEYS: Add invalidation support  Add support for invalidating a key - which renders it immediately invisible to further searches and causes the garbage collector to immediately wake up, remove it from keyrings and then destroy it when it's no longer referenced.  It's better not to do this with keyctl_revoke() as that marks the key to start returning -EKEYREVOKED to searches when what is actually desired is to have the key refetched.  To invalidate a key the caller must be granted SEARCH permission by the key. This may be too strict.  It may be better to also permit invalidation if the caller has any of READ, WRITE or SETATTR permission.  The primary use for this is to evict keys that are cached in special keyrings, such as the DNS resolver or an ID mapper.  Signed-off-by: David Howells <dhowells@redhat.com>
f | virtio_rng.h | s | 265B | 7 | Christian Borntraeger | borntraeger@de.ibm.com | 1256191768 |  | virtio: let header files include virtio_ids.h  Rusty,  commit 3ca4f5ca73057a617f9444a91022d7127041970a     virtio: add virtio IDs file moved all device IDs into a single file. While the change itself is a very good one, it can break userspace applications. For example if a userspace tool wanted to get the ID of virtio_net it used to include virtio_net.h. This does no longer work, since virtio_net.h does not include virtio_ids.h. This patch moves all "#include <linux/virtio_ids.h>" from the C files into the header files, making the header files compatible with the old ones.  In addition, this patch exports virtio_ids.h to userspace.  CC: Fernando Luis Vazquez Cao <fernando@oss.ntt.co.jp> Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | serial.h | s | 7.0K | 201 | Paul Gortmaker | paul.gortmaker@windriver.com | 1337295734 |  | serial: delete the MCA specific 8250 support.  The support for CONFIG_MCA is being removed, since the 20 year old hardware simply isn't capable of meeting today's software demands on CPU and memory resources.  This commit removes the MCA specific 8250 UART code.  Cc: Alan Cox <alan@linux.intel.com> Cc: linux-serial@vger.kernel.org Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | resource.h | s | 2.3K | 72 | Jean Delvare | khali@linux-fr.org | 1289577330 |  | include/linux/resource.h needs types.h  Fix the following warning: usr/include/linux/resource.h:49: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jean Delvare <khali@linux-fr.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atalk.h | s | 5.1K | 178 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | smsc911x.h | s | 2.3K | 55 | Mathieu J. Poirier | mathieu.poirier@linaro.org | 1302739980 |  | net: allow shifted access in smsc911x V2  This is a revised patch that permits a shifted access to the LAN9221 registers.  More specifically:   It adds a shift parameter in the platform_data.  It introduces an ops in smsc911x_data.  A choice of access function to use at run-time.  Four new shifted access function.  Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org> Signed-off-by: Alessandro Rubini <rubini@gnudd.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | dynamic_debug.h | s | 3.5K | 107 | Jim Cromie | jim.cromie@gmail.com | 1335877086 |  | dynamic_debug: use printk(KERN_WARNING..) in stub function  drivers/infiniband/ulp/srp/ib_srp.c #defines pr_fmt() PFX fmt, but PFX is not #defined until after <linux/*> headers are included.  This results in a bad expansion of the pr_warn() in the stub function.  2084c2084 <   printk("<4>" PFX "dyndbg supported only in " "CONFIG_DYNAMIC_DEBUG builds\n")  Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | drbd_limits.h | s | 5.1K | 138 | Philipp Reisner | philipp.reisner@linbit.com | 1336569045 |  | drbd: Implemented the disk-timeout option  When the disk-timeout is active, and it expires for a single request, we consider the local disk as D_FAILED. Note: With this change, I made both timeout based state transitions HARD state transitions.  Signed-off-by: Philipp Reisner <philipp.reisner@linbit.com> Signed-off-by: Lars Ellenberg <lars.ellenberg@linbit.com>
f | vm_event_item.h | s | 1.7K | 59 | Ying Han | yinghan@google.com | 1335414393 |  | mm: fix up the vmscan stat in vmstat  The "pgsteal" stat is confusing because it counts both direct reclaim as well as background reclaim.  However, we have "kswapd_steal" which also counts background reclaim value.  This patch fixes it and also makes it match the existng "pgscan_" stats.  Test: pgsteal_kswapd_dma32 447623 pgsteal_kswapd_normal 42272677 pgsteal_kswapd_movable 0 pgsteal_direct_dma32 2801 pgsteal_direct_normal 44353270 pgsteal_direct_movable 0  Signed-off-by: Ying Han <yinghan@google.com> Reviewed-by: Rik van Riel <riel@redhat.com> Acked-by: Christoph Lameter <cl@linux.com> Cc: Johannes Weiner <hannes@cmpxchg.org> Cc: Michal Hocko <mhocko@suse.cz> Cc: Mel Gorman <mel@csn.ul.ie> Acked-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Hillf Danton <dhillf@gmail.com> Cc: Hugh Dickins <hughd@google.com> Cc: Dan Magenheimer <dan.magenheimer@oracle.com> Reviewed-by: Minchan Kim <minchan@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | netfilter_arp.h | s | 380B | 14 | David Woodhouse | dwmw2@infradead.org | 1146052576 |  | Don't include linux/config.h from anywhere else in include/  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | virtio_ids.h | s | 2.0K | 39 | Linus Torvalds | torvalds@linux-foundation.org | 1332891009 |  | 
f | dcbnl.h | s | 21K | 617 | Amir Vadai | amirv@mellanox.com | 1333616884 |  | net/dcb: Add an optional max rate attribute  Although not specified in 8021Qaz spec, it could be useful to enable drivers whose HW supports setting a rate limit for an ETS TC. This patch adds this optional attribute to DCB netlink. To use it, drivers should implement and register the callbacks ieee_setmaxrate and ieee_getmaxrate. The units are 64 bits long and specified in Kbps to enable usage over both slow and very fast networks.  Signed-off-by: Amir Vadai <amirv@mellanox.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | qnx6_fs.h | s | 3.2K | 119 | Kai Bankett | chaosman@ontika.net | 1332293378 |  | fs: initial qnx6fs addition  Adds support for qnx6fs readonly support to the linux kernel.  * Mount option   The option mmi_fs can be used to mount Harman Becker/Audi MMI 3G   HDD qnx6fs filesystems.  * Documentation   A high level filesystem stucture description can be found in the   Documentation/filesystems directory. (qnx6.txt)  * Additional features   - Active (stable) superblock selection   - Superblock checksum check (enforced)   - Supports mount of qnx6 filesystems with to host different endianess   - Automatic endianess detection   - Longfilename support (with non-enfocing crc check)   - All blocksizes (512, 1024, 2048 and 4096 supported)  Signed-off-by: Kai Bankett <chaosman@ontika.net> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | hippidevice.h | s | 1.3K | 36 | Stephen Hemminger | shemminger@vyatta.com | 1227241935 |  | hippi: convert driver to net_device_ops  Convert the HIPPI infrastructure for use with net_device_ops.  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | eventpoll.h | s | 3.2K | 96 | Arve Hj√∏nnev√•g | arve@android.com | 1336247441 |  | epoll: Add a flag, EPOLLWAKEUP, to prevent suspend while epoll events are ready  When an epoll_event, that has the EPOLLWAKEUP flag set, is ready, a wakeup_source will be active to prevent suspend. This can be used to handle wakeup events from a driver that support poll, e.g. input, if that driver wakes up the waitqueue passed to epoll before allowing suspend.  Signed-off-by: Arve Hj√∏nnev√•g <arve@android.com> Reviewed-by: NeilBrown <neilb@suse.de> Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | sh_eth.h | s | 469B | 21 | Yoshihiro Shimoda | yoshihiro.shimoda.uh@renesas.com | 1329430089 |  | net: sh_eth: change the condition of initialization  The SH7757 has 2 Fast Ethernet and 2 Gigabit Ethernet, and the first Gigabit channel needs the initialization. So, this patch adds the parameter of "needs_init", and if the sh_eth_plat_data is set it to 1, the driver will initialize the channel.  Signed-off-by: Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | nbd.h | s | 2.6K | 85 | Changli Gao | xiaosuo@gmail.com | 1282536939 |  | header: fix broken headers for user space  __packed is only defined in kernel space, so we should use __attribute__((packed)) for the code shared between kernel and user space.  Two __attribute() annotations are replaced with __attribute__() too.  Signed-off-by: Changli Gao <xiaosuo@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | joystick.h | s | 3.7K | 120 | Daniel Mack | daniel@caiaq.de | 1274421928 |  | Input: use ABS_CNT rather than (ABS_MAX + 1)  Signed-off-by: Daniel Mack <daniel@caiaq.de> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | serial_sci.h | s | 3.6K | 133 | Shimoda, Yoshihiro | yoshihiro.shimoda.uh@renesas.com | 1333960774 |  | serial: sh-sci: modify sci_break_ctl()  SCIF modules which have SCSPTR can output the break signal. Now that we have a way of determining port features/capabilities, add trivial break control via SCSPTR support. Tested on sh7757lcr.  Signed-off-by: Yoshihiro Shimoda <yoshihiro.shimoda.uh@renesas.com> Reviewed-by: Simon Horman <horms@verge.net.au> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | hugetlb_inline.h | s | 329B | 15 | KOSAKI Motohiro | kosaki.motohiro@jp.fujitsu.com | 1306426831 |  | mm: don't access vm_flags as 'int'  The type of vma->vm_flags is 'unsigned long'. Neither 'int' nor 'unsigned int'. This patch fixes such misuse.  Signed-off-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> [ Changed to use a typedef - we'll extend it to cover more cases   later, since there has been discussion about making it a 64-bit   type..                      - Linus ] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_tunnel.h | s | 1.8K | 71 | Paulius Zaleckas | paulius.zaleckas@gmail.com | 1269231542 |  | if_tunnel.h: add missing ams/byteorder.h include  When compiling userspace application which includes if_tunnel.h and uses GRE_* defines you will get undefined reference to __cpu_to_be16.  Fix this by adding missing #include <asm/byteorder.h>  Cc: stable@kernel.org Signed-off-by: Paulius Zaleckas <paulius.zaleckas@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | 8250_pci.h | s | 999B | 31 | Russell King | rmk+lkml@arm.linux.org.uk | 1230920377 |  | And here's a patch (to be applied on top of the last) which prevents  this happening again by making use of 'const'.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk> Signed-off-by: Alan Cox <alan@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_arp.h | s | 6.4K | 153 | stephen hemminger | shemminger@vyatta.com | 1337721191 |  | if: restore token ring ARP type to header  Recent removal of Token Ring breaks the build of iproute2.  Even though Token Ring support is gone from the kernel, it is worth keeping the the definition of the TR ARP type to avoid breaking userspace programs that use this file.  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | kernel-page-flags.h | s | 1.0K | 43 | Ulrich Drepper | drepper@akkadia.org | 1338333741 |  | kbuild: install kernel-page-flags.h  Programs using /proc/kpageflags need to know about the various flags.  The <linux/kernel-page-flags.h> provides them and the comments in the file indicate that it is supposed to be used by user-level code.  But the file is not installed.  Install the headers and mark the unstable flags as out-of-bounds.  The page-type tool is also adjusted to not duplicate the definitions  Signed-off-by: Ulrich Drepper <drepper@gmail.com> Acked-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Acked-by: Fengguang Wu <fengguang.wu@intel.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | major.h | s | 4.5K | 146 | Philipp Reisner | philipp.reisner@linbit.com | 1245206868 |  | drbd: add major number to major.h  Since we have had a LANANA major number for years, and it is documented in devices.txt, I think that this first patch can go upstream.  Signed-off-by: Philipp Reisner <philipp.reisner@linbit.com> Signed-off-by: Lars Ellenberg <lars.ellenberg@linbit.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | numa.h | s | 253B | 10 | Lee Schermerhorn | lee.schermerhorn@hp.com | 1260895992 |  | hugetlb: add generic definition of NUMA_NO_NODE  Move definition of NUMA_NO_NODE from ia64 and x86_64 arch specific headers to generic header 'linux/numa.h' for use in generic code.  NUMA_NO_NODE replaces bare '-1' where it's used in this series to indicate "no node id specified".  Ultimately, it can be used to replace the -1 elsewhere where it is used similarly.  Signed-off-by: Lee Schermerhorn <lee.schermerhorn@hp.com> Acked-by: David Rientjes <rientjes@google.com> Acked-by: Mel Gorman <mel@csn.ul.ie> Reviewed-by: Andi Kleen <andi@firstfloor.org> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Randy Dunlap <randy.dunlap@oracle.com> Cc: Nishanth Aravamudan <nacc@us.ibm.com> Cc: Adam Litke <agl@us.ibm.com> Cc: Andy Whitcroft <apw@canonical.com> Cc: Eric Whitney <eric.whitney@hp.com> Cc: Christoph Lameter <cl@linux-foundation.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | frontswap.h | s | 2.9K | 102 | Konrad Rzeszutek Wilk | konrad.wilk@oracle.com | 1337096048 |  | frontswap: s/put_page/store/g s/get_page/load  Sounds so much more natural.  Suggested-by: Andrea Arcangeli <aarcange@redhat.com> Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | cryptohash.h | s | 417B | 12 | Linus Torvalds | torvalds@linux-foundation.org | 1312693957 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net  * git://git.kernel.org/pub/scm/linux/kernel/git/davem/net:   net: Compute protocol sequence numbers and fragment IDs using MD5.   crypto: Move md5_transform to lib/md5.c
f | cgroup_subsys.h | s | 816B | 50 | Neil Horman | nhorman@tuxdriver.com | 1321993343 |  | net: add network priority cgroup infrastructure (v4)  This patch adds in the infrastructure code to create the network priority cgroup.  The cgroup, in addition to the standard processes file creates two control files:  1) prioidx - This is a read-only file that exports the index of this cgroup. This is a value that is both arbitrary and unique to a cgroup in this subsystem, and is used to index the per-device priority map  2) priomap - This is a writeable file.  On read it reports a table of 2-tuples <name:priority> where name is the name of a network interface and priority is indicates the priority assigned to frames egresessing on the named interface and originating from a pid in this cgroup  This cgroup allows for skb priority to be set prior to a root qdisc getting selected. This is benenficial for DCB enabled systems, in that it allows for any application to use dcb configured priorities so without application modification  Signed-off-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: John Fastabend <john.r.fastabend@intel.com> CC: Robert Love <robert.w.love@intel.com> CC: "David S. Miller" <davem@davemloft.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | dm-io.h | s | 1.9K | 69 | Mikulas Patocka | mpatocka@redhat.com | 1306670589 |  | dm io: use fixed initial mempool size  Replace the arbitrary calculation of an initial io struct mempool size with a constant.  The code calculated the number of reserved structures based on the request size and used a "magic" multiplication constant of 4.  This patch changes it to reserve a fixed number - itself still chosen quite arbitrarily. Further testing might show if there is a better number to choose.  Note that if there is no memory pressure, we can still allocate an arbitrary number of "struct io" structures.  One structure is enough to process the whole request.  Signed-off-by: Mikulas Patocka <mpatocka@redhat.com> Signed-off-by: Alasdair G Kergon <agk@redhat.com>
f | memory_hotplug.h | s | 6.9K | 211 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | pktcdvd.h | s | 8.0K | 253 | Akinobu Mita | akinobu.mita@gmail.com | 1266996608 |  | pktcdvd: use BIO list management functions  Now that the bio list management stuff is generic, convert pktcdvd to use bio lists instead of its own private bio list implementation.  Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Acked-by: Peter Osterlund <petero2@telia.com> Cc: Christoph Hellwig <hch@infradead.org> Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
f | icmpv6.h | s | 4.5K | 160 | David S. Miller | davem@davemloft.net | 1299971334 |  | ipv6: Convert to use flowi6 where applicable.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | sound.h | s | 1.8K | 41 | David Howells | dhowells@redhat.com | 1323768405 |  | UAPI: Guard linux/sound.h  Place reinclusion guards on linux/sound.h otherwise the UAPI splitter script won't insert a #include to make the kernel header include the UAPI header.  Signed-off-by: David Howells <dhowells@redhat.com>
f | dmaengine.h | s | 32K | 924 | Alexandre Bounine | alexandre.bounine@idt.com | 1338511771 |  | rapidio: add DMA engine support for RIO data transfers  Adds DMA Engine framework support into RapidIO subsystem.  Uses DMA Engine DMA_SLAVE interface to generate data transfers to/from remote RapidIO target devices.  Introduces RapidIO-specific wrapper for prep_slave_sg() interface with an extra parameter to pass target specific information.  Uses scatterlist to describe local data buffer.  Address flat data buffer on a remote side.  Signed-off-by: Alexandre Bounine <alexandre.bounine@idt.com> Cc: Dan Williams <dan.j.williams@intel.com> Acked-by: Vinod Koul <vinod.koul@linux.intel.com> Cc: Li Yang <leoli@freescale.com> Cc: Matt Porter <mporter@kernel.crashing.org> Cc: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | usb.h | s | 65K | 1538 | Sarah Sharp | sarah.a.sharp@linux.intel.com | 1337616003 |  | USB: Fix core compile with CONFIG_USB_SUSPEND=n  When CONFIG_PM=n, make sure that the usb_[unlocked_][en/dis]able_lpm declarations are visible in include/linux/usb.h, and exported from drivers/usb/core/hub.c.  Before this patch, if CONFIG_USB_SUSPEND was turned off, it would cause build errors:  drivers/usb/core/hub.c: In function 'usb_disable_lpm': drivers/usb/core/hub.c:3394:2: error: implicit declaration of function 'usb_enable_lpm' [-Werror=implicit-function-declaration] drivers/usb/core/hub.c: At top level: drivers/usb/core/hub.c:3424:6: warning: conflicting types for 'usb_enable_lpm' [enabled by default] drivers/usb/core/hub.c:3394:2: note: previous implicit declaration of 'usb_enable_lpm' was here drivers/usb/core/driver.c: In function 'usb_probe_interface': drivers/usb/core/driver.c:339:2: error: implicit declaration of function 'usb_unlocked_disable_lpm' [-Werror=implicit-function-declaration] drivers/usb/core/driver.c:364:3: error: implicit declaration of function 'usb_unlocked_enable_lpm' [-Werror=implicit-function-declaration] drivers/usb/core/message.c: In function 'usb_set_interface': drivers/usb/core/message.c:1314:2: error: implicit declaration of function 'usb_disable_lpm' [-Werror=implicit-function-declaration] drivers/usb/core/message.c:1323:3: error: implicit declaration of function 'usb_enable_lpm' [-Werror=implicit-function-declaration] drivers/usb/core/message.c:1368:2: error: implicit declaration of function 'usb_unlocked_enable_lpm' [-Werror=implicit-function-declaration]  Signed-off-by: Sarah Sharp <sarah.a.sharp@linux.intel.com> Reported-by: Stephen Rothwell <sfr@canb.auug.org.au> Reported-by: Chen Peter-B29397 <B29397@freescale.com>
f | xattr.h | s | 3.8K | 80 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1316028291 |  | evm: posix acls modify i_mode  The posix xattr acls are 'system' prefixed, which normally would not affect security.evm.  An interesting side affect of writing posix xattr acls is their modifying of the i_mode, which is included in security.evm.  This patch updates security.evm when posix xattr acls are written.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
f | wireless.h | s | 42K | 1034 | Gerrit Renker | gerrit@erg.abdn.ac.uk | 1286999121 |  | wext: fix alignment problem in serializing 'struct iw_point'  wext: fix alignment problem in serializing 'struct iw_point'  This fixes a typo in the definition of the serialized length of struct iw_point:  a) wireless.h is exported to userspace, the typo causes IW_EV_POINT_PK_LEN     to be 12 on 64-bit, and 8 on 32-bit systems (causing misalignment);  b) in compat-64 mode iwe_stream_add_point() memcpys overlap (see below).  The second case in  in compat-64 mode looks like (variable names are as in include/net/iw_handler.h:iwe_stream_add_point()):   point_len = IW_EV_COMPAT_POINT_LEN = 8  lcp_len   = IW_EV_COMPAT_LCP_LEN   = 4  2nd memcpy: IW_EV_POINT_PK_LEN - IW_EV_LCP_PK_LEN = 12 - 4 = 8   IW_EV_LCP_PK_LEN  <-------------->                *---> 'extra' data area  +-------+-------+-------+-------+---------------+------- ...-+  || len   || cmd   ||length || flags ||  (empty) -> extra      ... ||  +-------+-------+-------+-------+---------------+------- ...-+     2       2       2       2          4       lcp_len  <-------------->                <-!! OVERLAP !!>  <--1st memcpy--><------- 2nd memcpy ----------->                                  <---- 3rd memcpy ------- ... >  <--------- point_len ---------->  This case could cause overrun whenever iw_point.length < 4. The other two cases are -  * 32-bit systems: IW_EV_POINT_PK_LEN - IW_EV_LCP_PK_LEN =  8 - 4 = 4,    the second memcpy copies exactly the 4 required bytes;  * 64-bit systems: IW_EV_POINT_PK_LEN - IW_EV_LCP_PK_LEN = 12 - 4 = 8,    the second memcpy copies a superfluous (but non overlapping) 4 bytes.  The patch changes IW_EV_POINT_PK_LEN to be 8, so that in all 3 cases always only the requested iw_point.{length,flags} (both __u16) are copied, avoiding overrrun (compat-64) and superfluous copy (64-bit). In addition, the userspace header is sanitized (in agreement with version 30 of the wireless tools).  Many thanks to Johannes Berg for help and review with this patch.  Signed-off-by: Gerrit Renker <gerrit@erg.abdn.ac.uk> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | i8042.h | s | 1.8K | 62 | Feng Tang | feng.tang@intel.com | 1277886098 |  | Input: i8042 - mark stubs in i8042.h "static inline"  Otherwise we may run into following:  drivers/platform/built-in.o: In function `i8042_lock_chip': /home/test/ws2/projects/linux-2.6/include/linux/i8042.h:50: multiple definition of `i8042_lock_chip' drivers/input/serio/built-in.o:/home/test/ws2/projects/linux-2.6/include/linux/i8042.h:50: first defined here ... make[1]: *** [drivers/built-in.o] Error 1 make: *** [drivers] Error 2  Signed-off-by: Feng Tang <feng.tang@intel.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
d | wimax |  | 3 items |  | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | affs_hardblocks.h | s | 1.4K | 60 | David Woodhouse | dwmw2@infradead.org | 1146754164 |  | Include <linux/types.h> and use __uXX types in <linux/affs_hardblocks.h>  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | atmioc.h | s | 1.5K | 33 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | extcon.h | s | 10K | 289 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1336173929 |  | extcon: Add EXTCON_MECHANICAL cable type for physical presence  Some accessory detection mechanisms are able to detect that something is physically present in the socket separately to identifying what is present in the socket. This information can be useful to applications, for example allowing them to indicate that a potentially broken accessory is present, so provide a standard way to report it to userspace.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | ima.h | s | 984B | 36 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1311006578 |  | integrity: move ima inode integrity data management  Move the inode integrity data(iint) management up to the integrity directory in order to share the iint among the different integrity models.  Changelog: - don't define MAX_DIGEST_SIZE - rename several globally visible 'ima_' prefixed functions, structs,   locks, etc to 'integrity_' - replace '20' with SHA1_DIGEST_SIZE - reflect location change in appropriate Kconfig and Makefiles - remove unnecessary initialization of iint_initialized to 0 - rebased on current ima_iint.c - define integrity_iint_store/lock as static  There should be no other functional changes.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Acked-by: Serge Hallyn <serge.hallyn@ubuntu.com>
f | enclosure.h | s | 4.1K | 121 | James Bottomley | James.Bottomley@suse.de | 1260456854 |  | [SCSI] enclosure: fix oops while iterating enclosure_status array  Based on patch originally by Jeff Mahoney <jeffm@suse.com>   enclosure_status is expected to be a NULL terminated array of strings  but isn't actually NULL terminated. When writing an invalid value to  /sys/class/enclosure/.../.../status, it goes off the end of the array  and Oopses.   Fix by making the assumption true and adding NULL at the end.  Reported-by: Artur Wojcik <artur.wojcik@intel.com> Signed-off-by: James Bottomley <James.Bottomley@suse.de>
f | dqblk_v1.h | s | 342B | 13 | Jan Kara | jack@suse.cz | 1231173625 |  | quota: Unexport dqblk_v1.h and dqblk_v2.h  Unexport header files dqblk_v[12].h since except for quota format ID they don't contain information userspace should be interested in. Move ID definitions to quota.h.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Mark Fasheh <mfasheh@suse.com>
f | debugfs.h | s | 6.3K | 190 | Srivatsa Vaddagiri | vatsa@linux.vnet.ibm.com | 1334636316 |  | debugfs: Add support to print u32 array in debugfs  Move the code from Xen to debugfs to make the code common for other users as well.  Accked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Srivatsa Vaddagiri <vatsa@linux.vnet.ibm.com> Signed-off-by: Suzuki Poulose <suzuki@in.ibm.com> [v1: Fixed rebase issues] [v2: Fixed PPC compile issues] Signed-off-by: Raghavendra K T <raghavendra.kt@linux.vnet.ibm.com> Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | fsnotify_backend.h | s | 18K | 411 | Naohiro Aota | naota@elisp.net | 1338426293 |  | fsnotify: handle subfiles' perm events  Recently I'm working on fanotify and found the following strange behaviors.  I wrote a program to set fanotify_mark on "/tmp/block" and FAN_DENY all events notified.  fanotify_mask = FAN_ALL_EVENTS || FAN_ALL_PERM_EVENTS || FAN_EVENT_ON_CHILD: $ cd /tmp/block; cat foo cat: foo: Operation not permitted  Operation on the file is blocked as expected.  But,  fanotify_mask = FAN_ALL_PERM_EVENTS || FAN_EVENT_ON_CHILD: $ cd /tmp/block; cat foo aaa  It's not blocked anymore.  This is confusing behavior.  Also reading commit "fsnotify: call fsnotify_parent in perm events", it seems like fsnotify should handle subfiles' perm events as well as the other notify events.  With this patch, regardless of FAN_ALL_EVENTS set or not: $ cd /tmp/block; cat foo cat: foo: Operation not permitted  Operation on the file is now blocked properly.  FS_OPEN_PERM and FS_ACCESS_PERM are not listed on FS_EVENTS_POSS_ON_CHILD.  Due to fsnotify_inode_watches_children() check, if you only specify only these events as fsnotify_mask, you don't get subfiles' perm events notified.  This patch add the events to FS_EVENTS_POSS_ON_CHILD to get them notified even if only these events are specified to fsnotify_mask.  Signed-off-by: Naohiro Aota <naota@elisp.net> Cc: Eric Paris <eparis@redhat.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | snmp.h | s | 10K | 262 | Eric Dumazet | eric.dumazet@gmail.com | 1332190388 |  | tcp: reduce out_of_order memory use  With increasing receive window sizes, but speed of light not improved that much, out of order queue can contain a huge number of skbs, waiting to be moved to receive_queue when missing packets can fill the holes.  Some devices happen to use fat skbs (truesize of 4096 + sizeof(struct sk_buff)) to store regular (MTU <= 1500) frames. This makes highly probable sk_rmem_alloc hits sk_rcvbuf limit, which can be 4Mbytes in many cases.  When limit is hit, tcp stack calls tcp_collapse_ofo_queue(), a true latency killer and cpu cache blower.  Doing the coalescing attempt each time we add a frame in ofo queue permits to keep memory use tight and in many cases avoid the tcp_collapse() thing later.  Tested on various wireless setups (b43, ath9k, ...) known to use big skb truesize, this patch removed the "packets collapsed in receive queue due to low socket buffer" I had before.  This also reduced average memory used by tcp sockets.  With help from Neal Cardwell.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Neal Cardwell <ncardwell@google.com> Cc: Yuchung Cheng <ycheng@google.com> Cc: H.K. Jerry Chu <hkchu@google.com> Cc: Tom Herbert <therbert@google.com> Cc: Ilpo J√§rvinen <ilpo.jarvinen@helsinki.fi> Acked-by: Neal Cardwell <ncardwell@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | blkpg.h | s | 1.5K | 51 | David Woodhouse | dwmw2@infradead.org | 1146152816 |  | linux/blkpg.h needs <linux/compiler.h> for __user  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
d | rtc |  | 3 items |  | Wolfram Sang | w.sang@pengutronix.de | 1338333753 |  | rtc: ds1307: add trickle charger support  Some DS13XX devices have "trickle chargers".  Its configuration register is at different locations, the setup is the same, though.  Since the configuration is board specific, introduce a platform_data to this driver. Tested with a DS1339 on a custom board.  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de> Cc: Alessandro Zummo <alessandro.zummo@towertech.it> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | auto_fs.h | s | 2.5K | 73 | Arnd Bergmann | arnd@arndb.de | 1281305614 |  | autofs/autofs4: Move compat_ioctl handling into fs  Handling of autofs ioctl numbers does not need to be generic and can easily be done directly in autofs itself.  This also pushes the BKL into autofs and autofs4 ioctl methods.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Acked-by: H. Peter Anvin <hpa@zytor.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Ian Kent <raven@themaw.net> Cc: Autofs <autofs@linux.kernel.org> Cc: John Kacur <jkacur@redhat.com> Signed-off-by: Frederic Weisbecker <fweisbec@gmail.com>
f | nubus.h | s | 11K | 322 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233669831 |  | headers_check fix cleanup: linux/nubus.h  These are only for kernel internals as pointed by Arnd Bergmann:    struct nubus_board    struct nubus_dev  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | sonet.h | s | 2.5K | 58 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ipc_namespace.h | s | 5.1K | 150 | KOSAKI Motohiro | kosaki.motohiro@jp.fujitsu.com | 1338511771 |  | mqueue: separate mqueue default value from maximum value  Commit b231cca4381e ("message queues: increase range limits") changed mqueue default value when attr parameter is specified NULL from hard coded value to fs.mqueue.{msg,msgsize}_max sysctl value.  This made large side effect.  When user need to use two mqueue applications 1) using !NULL attr parameter and it require big message size and 2) using NULL attr parameter and only need small size message, app (1) require to raise fs.mqueue.msgsize_max and app (2) consume large memory size even though it doesn't need.  Doug Ledford propsed to switch back it to static hard coded value. However it also has a compatibility problem.  Some applications might started depend on the default value is tunable.  The solution is to separate default value from maximum value.  Signed-off-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Signed-off-by: Doug Ledford <dledford@redhat.com> Acked-by: Doug Ledford <dledford@redhat.com> Acked-by: Joe Korty <joe.korty@ccur.com> Cc: Amerigo Wang <amwang@redhat.com> Acked-by: Serge E. Hallyn <serue@us.ibm.com> Cc: Jiri Slaby <jslaby@suse.cz> Cc: Manfred Spraul <manfred@colorfullife.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | oom.h | s | 1.9K | 62 | David Rientjes | rientjes@google.com | 1338333744 |  | mm, oom: normalize oom scores to oom_score_adj scale only for userspace  The oom_score_adj scale ranges from -1000 to 1000 and represents the proportion of memory available to the process at allocation time.  This means an oom_score_adj value of 300, for example, will bias a process as though it was using an extra 30.0% of available memory and a value of -350 will discount 35.0% of available memory from its usage.  The oom killer badness heuristic also uses this scale to report the oom score for each eligible process in determining the "best" process to kill.  Thus, it can only differentiate each process's memory usage by 0.1% of system RAM.  On large systems, this can end up being a large amount of memory: 256MB on 256GB systems, for example.  This can be fixed by having the badness heuristic to use the actual memory usage in scoring threads and then normalizing it to the oom_score_adj scale for userspace.  This results in better comparison between eligible threads for kill and no change from the userspace perspective.  Suggested-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Tested-by: Dave Jones <davej@redhat.com> Signed-off-by: David Rientjes <rientjes@google.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | reboot.h | s | 2.4K | 66 | Amerigo Wang | amwang@redhat.com | 1311652634 |  | notifiers: sys: move reboot notifiers into reboot.h  It is not necessary to share the same notifier.h.  This patch already moves register_reboot_notifier() and unregister_reboot_notifier() from kernel/notifier.c to kernel/sys.c.  [amwang@redhat.com: make allyesconfig succeed on ppc64] Signed-off-by: WANG Cong <amwang@redhat.com> Cc: David Miller <davem@davemloft.net> Cc: "Rafael J. Wysocki" <rjw@sisk.pl> Cc: Greg KH <greg@kroah.com> Signed-off-by: WANG Cong <amwang@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | zorro_ids.h | s | 29K | 440 | Geert Uytterhoeven | geert@linux-m68k.org | 1321030554 |  | zorro: Rename Picasso IV Z2 "MEM" to "RAM" for consistency  Signed-off-by: Geert Uytterhoeven <geert@linux-m68k.org> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de>
f | hrtimer.h | s | 13K | 394 | Vitaliy Ivanov | vitalivanov@gmail.com | 1309215979 |  | Fix some kernel-doc warnings  Fix 'make htmldocs' warnings:    Warning(/include/linux/hrtimer.h:153): No description found for parameter 'clockid'   Warning(/include/linux/device.h:604): Excess struct/union/enum/typedef member 'of_match' description in 'device'   Warning(/include/net/sock.h:349): Excess struct/union/enum/typedef member 'sk_rmem_alloc' description in 'sock'  Signed-off-by: Vitaliy Ivanov <vitalivanov@gmail.com> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | hwspinlock.h | s | 10K | 287 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | compiler-gcc3.h | s | 631B | 19 | Borislav Petkov | borislav.petkov@amd.com | 1300841050 |  | include/linux/compiler-gcc*.h: unify macro definitions  Unify identical gcc3.x and gcc4.x macros.  Signed-off-by: Borislav Petkov <borislav.petkov@amd.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ds1286.h | s | 1.2K | 46 | Thomas Bogendoerfer | tsbogend@alpha.franken.de | 1224071211 |  | MIPS: IP22/28: Switch over to RTC class driver  This patchset removes some dead code and creates a platform device for the RTC class driver.  Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de> Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
d | regulator |  | 18 items |  | Laxman Dewangan | ldewangan@nvidia.com | 1337014984 |  | regulator: tps62360: support force PWM mode via regulator mode  Change the mechanism of enabling the force PWM mode through regulator set mode. This can be dynamically configured now. In the REGULATOR_MODE_FAST the force PWM is enabled and in REGULATOR_MODE_NORMAL the force PWM is disabled.  Signed-off-by: Laxman Dewangan <ldewangan@nvidia.com> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
f | gpio_keys.h | s | 952B | 27 | Laxman Dewangan | ldewangan@nvidia.com | 1332204978 |  | Input: gpio_keys - add support for interrupt only keys  Some of buttons, like power-on key or onkey, may only generate interrupts when pressed and not actually be mapped as gpio in the system. Allow setting gpio to invalid value and specify IRQ instead to support such keys. The debounce timer is used not to debounce but to ignore new IRQs coming while button is kept pressed.  Signed-off-by: Laxman Dewangan <ldewangan@nvidia.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | tboot.h | s | 4.0K | 131 | Tang Liang | liang.tang@oracle.com | 1331661993 |  | x86, acpi, tboot: Have a ACPI os prepare sleep instead of calling tboot_sleep.  The ACPI suspend path makes a call to tboot_sleep right before it writes the PM1A, PM1B values. We replace the direct call to tboot via an registration callback similar to __acpi_register_gsi.  CC: Len Brown <len.brown@intel.com> Acked-by: Joseph Cihula <joseph.cihula@intel.com> Acked-by: Rafael J. Wysocki <rjw@sisk.pl> [v1: Added __attribute__ ((unused))] [v2: Introduced a wrapper instead of changing tboot_sleep return values] [v3: Added return value AE_CTRL_SKIP for acpi_os_sleep_prepare] Signed-off-by: Tang Liang <liang.tang@oracle.com> [v1: Fix compile issues on IA64 and PPC64] [v2: Fix where __acpi_os_prepare_sleep==NULL and did not go in sleep properly] Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | cpu_rmap.h | s | 1.9K | 62 | Ben Hutchings | bhutchings@solarflare.com | 1295909516 |  | lib: cpu_rmap: CPU affinity reverse-mapping  When initiating I/O on a multiqueue and multi-IRQ device, we may want to select a queue for which the response will be handled on the same or a nearby CPU.  This requires a reverse-map of IRQ affinity.  Add library functions to support a generic reverse-mapping from CPUs to objects with affinity and the specific case where the objects are IRQs.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | watchdog.h | s | 6.6K | 162 | Hans de Goede | hdegoede@redhat.com | 1338357331 |  | watchdog: Add support for dynamically allocated watchdog_device structs  If a driver's watchdog_device struct is part of a dynamically allocated struct (which it often will be), merely locking the module is not enough, even with a drivers module locked, the driver can be unbound from the device, examples: 1) The root user can unbind it through sysfd 2) The i2c bus master driver being unloaded for an i2c watchdog  I will gladly admit that these are corner cases, but we still need to handle them correctly.  The fix for this consists of 2 parts: 1) Add ref / unref operations, so that the driver can refcount the struct    holding the watchdog_device struct and delay freeing it until any    open filehandles referring to it are closed 2) Most driver operations will do IO on the device and the driver should not    do any IO on the device after it has been unbound. Rather then letting each    driver deal with this internally, it is better to ensure at the watchdog    core level that no operations (other then unref) will get called after    the driver has called watchdog_unregister_device(). This actually is the    bulk of this patch.  Signed-off-by: Hans de Goede <hdegoede@redhat.com> Signed-off-by: Wim Van Sebroeck <wim@iguana.be>
f | quicklist.h | s | 2.1K | 76 | KOSAKI Motohiro | kosaki.motohiro@jp.fujitsu.com | 1220408498 |  | mm: show quicklist usage in /proc/meminfo  Quicklists can consume several GB of memory.  We should provide a means of monitoring this.  After this patch is applied, /proc/meminfo will output the following:  % cat /proc/meminfo  MemTotal:      7715392 kB MemFree:       5401600 kB Buffers:         80384 kB Cached:         300800 kB SwapCached:          0 kB Active:         235584 kB Inactive:       262656 kB SwapTotal:     2031488 kB SwapFree:      2031488 kB Dirty:            3520 kB Writeback:           0 kB AnonPages:      117696 kB Mapped:          38528 kB Slab:          1589952 kB SReclaimable:    23104 kB SUnreclaim:    1566848 kB PageTables:      14656 kB NFS_Unstable:        0 kB Bounce:              0 kB WritebackTmp:        0 kB CommitLimit:   5889152 kB Committed_AS:   393152 kB VmallocTotal: 17592177655808 kB VmallocUsed:     29056 kB VmallocChunk: 17592177626432 kB Quicklists:     130944 kB HugePages_Total:     0 HugePages_Free:      0 HugePages_Rsvd:      0 HugePages_Surp:      0 Hugepagesize:    262144 kB  Signed-off-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Christoph Lameter <cl@linux-foundation.org> Cc: Keiichiro Tokunaga <tokunaga.keiich@jp.fujitsu.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | blockgroup_lock.h | s | 1.1K | 51 | Pekka Enberg | penberg@cs.helsinki.fi | 1231104800 |  | fs: introduce bgl_lock_ptr()  As suggested by Andreas Dilger, introduce a bgl_lock_ptr() helper in <linux/blockgroup_lock.h> and add separate sb_bgl_lock() helpers to filesystem specific header files to break the hidden dependency to struct ext[234]_sb_info.  Also, while at it, convert the macros to static inlines to try make up for all the times I broke Andrew Morton's tree.  Acked-by: Andreas Dilger <adilger@sun.com> Signed-off-by: Pekka Enberg <penberg@cs.helsinki.fi> Cc: <linux-ext4@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | termios.h | s | 443B | 17 | Alan Cox | alan@redhat.com | 1223916700 |  | tty: Add termiox  We need a way to describe the various additional modes and flow control features that random weird hardware shows up and software such as wine wants to emulate as Windows supports them.  TCGETX/TCSETX and the termiox ioctl are a SYS5 extension that we might as well adopt. This patches adds the structures and the basic ioctl interfaces when the TCGETX etc defines are added for an architecture. Drivers wishing to use this stuff need to add new methods.  Signed-off-by: Alan Cox <alan@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_team.h | s | 6.5K | 230 | Jiri Pirko | jpirko@redhat.com | 1335039993 |  | team: allow to enable/disable ports  This patch changes content of hashlist (used to get port struct by computed index (0...en_port_count-1)). Now the hash list contains only enabled ports so userspace will be able to say what ports can be used for tx/rx. This becomes handy when userspace will need to disable ports which does not belong to active aggregator. By default, newly added port is enabled.  Signed-off-by: Jiri Pirko <jpirko@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | lguest.h | s | 2.2K | 63 | Rusty Russell | rusty@rustcorp.com.au | 1311311388 |  | lguest: use a special 1:1 linear pagetable mode until first switch.  The Host used to create some page tables for the Guest to use at the top of Guest memory; it would then tell the Guest where this was.  In particular, it created linear mappings for 0 and 0xC0000000 addresses because lguest used to switch to its real page tables quite late in boot.  However, since d50d8fe19 Linux initialized boot page tables in head_32.S even before the "are we lguest?" boot jump.  So, now we can simplify things: the Host pagetable code assumes 1:1 linear mapping until it first calls the LHCALL_NEW_PGTABLE hypercall, which we now do before we reach C code.  This also means that the Host doesn't need to know anything about the Guest's PAGE_OFFSET.  (Non-Linux guests might not even have such a thing).  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | atmclip.h | s | 513B | 12 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | arcfb.h | s | 150B | 5 | Jaya Kumar | jayalk@intworks.biz | 1119406061 |  | [PATCH] Framebuffer driver for Arc LCD board  Add support for the Arc monochrome LCD board.  The board uses KS108 controllers to drive individual 64x64 LCD matrices. The board can be paneled in a variety of setups such as 2x1=128x64, 4x4=256x256 and so on.  The board/host interface is through GPIO.  Signed-off-by: Jaya Kumar <jayalk@intworks.biz> Cc: "Antonino A. Daplas" <adaplas@pol.net> Cc: <linux-fbdev-devel@lists.sourceforge.net> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | sonypi.h | s | 6.2K | 155 | Mattia Dongili | malattia@linux.it | 1301306724 |  | sony-laptop: ignore hard switch rfkill events (SPIC)  There is not much use for these events in userspace and handling the events themselves seems to get in the way of the actual activation of the rf devices. The SNC device doesn't expose them already. https://bugzilla.kernel.org/show_bug.cgi?id=15303  Signed-off-by: Mattia Dongili <malattia@linux.it> Signed-off-by: Matthew Garrett <mjg@redhat.com>
f | crc16.h | s | 622B | 23 | Evgeniy Polyakov | johnpol@2ka.mipt.ru | 1126540088 |  | [PATCH] crc16: remove w1 specific comments.  Remove w1 comments from crc16.h and move specific constants into w1_ds2433.c where they are used.  Replace %d with %zd.  Signed-off-by: Evgeniy Polyakov <johnpol@2ka.mipt.ru> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | bch.h | s | 2.6K | 72 | Ivan Djelic | ivan.djelic@parrot.com | 1299853550 |  | lib: add shared BCH ECC library  This is a new software BCH encoding/decoding library, similar to the shared Reed-Solomon library.  Binary BCH (Bose-Chaudhuri-Hocquenghem) codes are widely used to correct errors in NAND flash devices requiring more than 1-bit ecc correction; they are generally better suited for NAND flash than RS codes because NAND bit errors do not occur in bursts. Latest SLC NAND devices typically require at least 4-bit ecc protection per 512 bytes block.  This library provides software encoding/decoding, but may also be used with ASIC/SoC hardware BCH engines to perform error correction. It is being currently used for this purpose on an OMAP3630 board (4bit/8bit HW BCH). It has also been used to decode raw dumps of NAND devices with on-die BCH ecc engines (e.g. Micron 4bit ecc SLC devices).  Latest NAND devices (including SLC) can exhibit high error rates (typically a dozen or more bitflips per hour during stress tests); in order to minimize the performance impact of error correction, this library implements recently developed algorithms for fast polynomial root finding (see bch.c header for details) instead of the traditional exhaustive Chien root search; a few performance figures are provided below:  Platform: arm926ejs @ 468 MHz, 32 KiB icache, 16 KiB dcache BCH ecc : 4-bit per 512 bytes  Encoding average throughput: 250 Mbits/s  Error correction time (compared with Chien search):          average   worst      average (Chien)  worst (Chien) ---------------------------------------------------------- 1 bit    8.5 ¬µs   11 ¬µs         200 ¬µs           383 ¬µs 2 bit    9.7 ¬µs   12.5 ¬µs       477 ¬µs           728 ¬µs 3 bit   18.1 ¬µs   20.6 ¬µs       758 ¬µs          1010 ¬µs 4 bit   19.5 ¬µs   23 ¬µs        1028 ¬µs          1280 ¬µs  In the above figures, "worst" is meant in terms of error pattern, not in terms of cache miss / page faults effects (not taken into account here).  The library has been extensively tested on the following platforms: x86, x86_64, arm926ejs, omap3630, qemu-ppc64, qemu-mips.  Signed-off-by: Ivan Djelic <ivan.djelic@parrot.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | sa11x0-dma.h | s | 572B | 21 | Russell King | rmk+kernel@arm.linux.org.uk | 1331119941 |  | DMA: sa11x0: add SA-11x0 DMA driver  Add support for the SA-11x0 DMA driver, which replaces the private API version in arch/arm/mach-sa1100/dma.c.  We model this as a set of virtual DMA channels, one for each request signal, and assign the virtual DMA channel to a physical DMA channel when there is work to be done.  This allows DMA users to claim their channels, and hold them while not in use, without affecting the availability of the physical channels.  Another advantage over this approach, compared to the private version, is that a channel can be reconfigured on the fly without having to release and re-request it - which for the IrDA driver, allows us to use DMA for SIR mode transmit without eating up three physical channels.  As IrDA is half-duplex, we actually only need one physical channel, and this architecture allows us to achieve that.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | cn_proc.h | s | 4.0K | 136 | Vladimir Zapolskiy | vzapolskiy@gmail.com | 1317231710 |  | connector: add comm change event report to proc connector  Add an event to monitor comm value changes of tasks.  Such an event becomes vital, if someone desires to control threads of a process in different manner.  A natural characteristic of threads is its comm value, and helpfully application developers have an opportunity to change it in runtime. Reporting about such events via proc connector allows to fine-grain monitoring and control potentials, for instance a process control daemon listening to proc connector and following comm value policies can place specific threads to assigned cgroup partitions.  It might be possible to achieve a pale partial one-shot likeness without this update, if an application changes comm value of a thread generator task beforehand, then a new thread is cloned, and after that proc connector listener gets the fork event and reads new thread's comm value from procfs stat file, but this change visibly simplifies and extends the matter.  Signed-off-by: Vladimir Zapolskiy <vzapolskiy@gmail.com> Acked-by: Evgeniy Polyakov <zbr@ioremap.net> Cc: David Miller <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ahci_platform.h | s | 893B | 28 | Brian Norris | computersforpeace@gmail.com | 1326068099 |  | ahci: platform support for suspend/resume  Add platform hooks for custom suspend() and resume() functions. The generic suspend/resume code in drivers/ata/ahci_platform.c is adapted from the PCI version in drivers/ata/ahci.c.  Signed-off-by: Brian Norris <computersforpeace@gmail.com> Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
f | kobject_ns.h | s | 1.8K | 51 | Al Viro | viro@zeniv.linux.org.uk | 1307915141 |  | Delay struct net freeing while there's a sysfs instance refering to it  	* new refcount in struct net, controlling actual freeing of the memory 	* new method in kobj_ns_type_operations (->drop_ns()) 	* ->current_ns() semantics change - it's supposed to be followed by corresponding ->drop_ns().  For struct net in case of CONFIG_NET_NS it bumps the new refcount; net_drop_ns() decrements it and calls net_free() if the last reference has been dropped.  Method renamed to ->grab_current_ns(). 	* old net_free() callers call net_drop_ns() instead. 	* sysfs_exit_ns() is gone, along with a large part of callchain leading to it; now that the references stored in ->ns[...] stay valid we do not need to hunt them down and replace them with NULL.  That fixes problems in sysfs_lookup() and sysfs_readdir(), along with getting rid of sb->s_instances abuse.  	Note that struct net *shutdown* logics has not changed - net_cleanup() is called exactly when it used to be called.  The only thing postponed by having a sysfs instance refering to that struct net is actual freeing of memory occupied by struct net.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | sysrq.h | s | 1.8K | 62 | Andy Whitcroft | apw@canonical.com | 1295890416 |  | Input: sysrq - ensure sysrq_enabled and __sysrq_enabled are consistent  Currently sysrq_enabled and __sysrq_enabled are initialised separately and inconsistently, leading to sysrq being actually enabled by reported as not enabled in sysfs.  The first change to the sysfs configurable synchronises these two:      static int __read_mostly sysrq_enabled = 1;     static int __sysrq_enabled;  Add a common define to carry the default for these preventing them becoming out of sync again.  Default this to 1 to mirror previous behaviour.  Signed-off-by: Andy Whitcroft <apw@canonical.com> Cc: stable@kernel.org Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
d | dvb |  | 9 items |  | Michael Krufky | mkrufky@linuxtv.org | 1337519168 |  | [media] DVB: remove "stats" property bits from ATSC-MH API property additions  Mauro is proposing a new API to handle statistics. This functionality will be returned after the statistics API is ready. Just remove them for now.  Signed-off-by: Michael Krufky <mkrufky@linuxtv.org> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
d | bcma |  | 6 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1337885669 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net  Pull more networking updates from David Miller:  "Ok, everything from here on out will be bug fixes."  1) One final sync of wireless and bluetooth stuff from John Linville.    These changes have all been in his tree for more than a week, and    therefore have had the necessary -next exposure.  John was just away    on a trip and didn't have a change to send the pull request until a    day or two ago.  2) Put back some defines in user exposed header file areas that were    removed during the tokenring purge.  From Stephen Hemminger and Paul    Gortmaker.  3) A bug fix for UDP hash table allocation got lost in the pile due to    one of those "you got it..  no I've got it.." situations.  :-)     From Tim Bird.  4) SKB coalescing in TCP needs to have stricter checks, otherwise we'll    try to coalesce overlapping frags and crash.  Fix from Eric Dumazet.  5) RCU routing table lookups can race with free_fib_info(), causing    crashes when we deref the device pointers in the route.  Fix by    releasing the net device in the RCU callback.  From Yanmin Zhang.  * git://git.kernel.org/pub/scm/linux/kernel/git/davem/net: (293 commits)   tcp: take care of overlaps in tcp_try_coalesce()   ipv4: fix the rcu race between free_fib_info and ip_route_output_slow   mm: add a low limit to alloc_large_system_hash   ipx: restore token ring define to include/linux/ipx.h   if: restore token ring ARP type to header   xen: do not disable netfront in dom0   phy/micrel: Fix ID of KSZ9021   mISDN: Add X-Tensions USB ISDN TA XC-525   gianfar:don't add FCB length to hard_header_len   Bluetooth: Report proper error number in disconnection   Bluetooth: Create flags for bt_sk()   Bluetooth: report the right security level in getsockopt   Bluetooth: Lock the L2CAP channel when sending   Bluetooth: Restore locking semantics when looking up L2CAP channels   Bluetooth: Fix a redundant and problematic incoming MTU check   Bluetooth: Add support for Foxconn/Hon Hai AR5BBU22 0489:E03C   Bluetooth: Fix EIR data generation for mgmt_device_found   Bluetooth: Fix Inquiry with RSSI event mask   Bluetooth: improve readability of l2cap_seq_list code   Bluetooth: Fix skb length calculation   ...
f | smp.h | s | 5.9K | 197 | Thomas Gleixner | tglx@linutronix.de | 1336473306 |  | smp: Implement kick_all_cpus_sync()  Will replace the misnomed cpu_idle_wait() function which is copied a gazillion times all over arch/*  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Link: http://lkml.kernel.org/r/20120507175652.049316594@linutronix.de
f | irqreturn.h | s | 432B | 16 | Sebastian Andrzej Siewior | sebastian@breakpoint.cc | 1307105595 |  | irq: Handle spurios irq detection for threaded irqs  The detection of spurios interrupts is currently limited to first level handler. In force-threaded mode we never notice if the threaded irq does not feel responsible. This patch catches the return value of the threaded handler and forwards it to the spurious detector. If the primary handler returns only IRQ_WAKE_THREAD then the spourious detector ignores it because it gets called again from the threaded handler.  [ tglx: Report the erroneous return value early and bail out ]  Signed-off-by: Sebastian Andrzej Siewior <sebastian@breakpoint.cc> Link: http://lkml.kernel.org/r/1306824972-27067-2-git-send-email-sebastian@breakpoint.cc Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
d | mlx4 |  | 7 items |  | Marcel Apfelbaum | marcela@dev.mellanox.co.il | 1338502696 |  | net/mlx4_core: Fix number of EQs used in ICM initialisation  In SRIOV mode, the number of EQs used when computing the total ICM size was incorrect.  To fix this, we do the following: 1. We add a new structure to mlx4_dev, mlx4_phys_caps, to contain physical HCA    capabilities.  The PPF uses the phys capabilities when it computes things    like ICM size.     The dev_caps structure will then contain the paravirtualized values, making    bookkeeping much easier in SRIOV mode. We add a structure rather than a    single parameter because there will be other fields in the phys_caps.     The first field we add to the mlx4_phys_caps structure is num_phys_eqs.  2. In INIT_HCA, when running in SRIOV mode, the "log_num_eqs" parameter    passed to the FW is the number of EQs per VF/PF; each function (PF or VF)    has this number of EQs available.     However, the total number of EQs which must be allowed for in the ICM is    (1 << log_num_eqs) * (#VFs + #PFs).  Rather than compute this quantity,    we allocate ICM space for 1024 EQs (which is the device maximum    number of EQs, and which is the value we place in the mlx4_phys_caps structure).     For INIT_HCA, however, we use the per-function number of EQs as described    above.  Signed-off-by: Marcel Apfelbaum <marcela@dev.mellanox.co.il> Signed-off-by: Jack Morgenstein <jackm@dev.mellanox.co.il> Reviewed-by: Or Gerlitz <ogerlitz@mellanox.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | printk.h | s | 9.4K | 294 | Kay Sievers | kay@vrfy.org | 1336435407 |  | kmsg: export printk records to the /dev/kmsg interface  Support for multiple concurrent readers of /dev/kmsg, with read(), seek(), poll() support. Output of message sequence numbers, to allow userspace log consumers to reliably reconnect and reconstruct their state at any given time. After open("/dev/kmsg"), read() always returns *all* buffered records. If only future messages should be read, SEEK_END can be used. In case records get overwritten while /dev/kmsg is held open, or records get faster overwritten than they are read, the next read() will return -EPIPE and the current reading position gets updated to the next available record. The passed sequence numbers allow the log consumer to calculate the amount of lost messages.    [root@mop ~]# cat /dev/kmsg   5,0,0;Linux version 3.4.0-rc1+ (kay@mop) (gcc version 4.7.0 20120315 ...   6,159,423091;ACPI: PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff])   7,160,424069;pci_root PNP0A03:00: host bridge window [io  0x0000-0x0cf7] (ignored)    SUBSYSTEM=acpi    DEVICE=+acpi:PNP0A03:00   6,339,5140900;NET: Registered protocol family 10   30,340,5690716;udevd[80]: starting version 181   6,341,6081421;FDC 0 is a S82078B   6,345,6154686;microcode: CPU0 sig=0x623, pf=0x0, revision=0x0   7,346,6156968;sr 1:0:0:0: Attached scsi CD-ROM sr0    SUBSYSTEM=scsi    DEVICE=+scsi:1:0:0:0   6,347,6289375;microcode: CPU1 sig=0x623, pf=0x0, revision=0x0  Cc: Karel Zak <kzak@redhat.com> Tested-by: William Douglas <william.douglas@intel.com> Signed-off-by: Kay Sievers <kay@vrfy.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | if_pppox.h | s | 6.8K | 205 | James Chapman | jchapman@katalix.com | 1335879055 |  | pppox: Replace __attribute__((packed)) in if_pppox.h  Checkpatch warns about the use of __attribute__((packed)). So use the recommended __packed syntax instead.  Signed-off-by: James Chapman <jchapman@katalix.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | selection.h | s | 1.3K | 33 | Nicolas Pitre | nico@fluxnic.net | 1287768006 |  | vcs: invoke the vt update callback when /dev/vcs* is written to  A notifier chain is called whenever the vt code modifies a terminal content, except for one case which is when the modification comes through writes to /dev/vcs* devices.  Let's add the missing notifier invocation at the end of vcs_write() for that case too.  Signed-off-by: Nicolas Pitre <nicolas.pitre@canonical.com> Cc: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | nfc.h | s | 5.2K | 155 | Samuel Ortiz | sameo@linux.intel.com | 1334257833 |  | NFC: Add a target lost netlink event  Some chips are capable of detecting when a tag is out of the field, so they could send a netlink event about it to userspace.  Signed-off-by: Samuel Ortiz <sameo@linux.intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | netfilter_ipv6.h | s | 2.5K | 78 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, netfilter: Add missing #include <limits.h> for userland  Various headers use INT_MIN and INT_MAX, which are defined for userland in <limits.h>.  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Acked-by: Patrick McHardy <kaber@trash.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | if_alg.h | s | 816B | 33 | Herbert Xu | herbert@gondor.apana.org.au | 1290160077 |  | crypto: af_alg - User-space interface for Crypto API  This patch creates the backbone of the user-space interface for the Crypto API, through a new socket family AF_ALG.  Each session corresponds to one or more connections obtained from that socket.  The number depends on the number of inputs/outputs of that particular type of operation.  For most types there will be a s ingle connection/file descriptor that is used for both input and output.  AEAD is one of the few that require two inputs.  Each algorithm type will provide its own implementation that plugs into af_alg.  They're keyed using a string such as "skcipher" or "hash".  IOW this patch only contains the boring bits that is required to hold everything together.  Thakns to Miloslav Trmac for reviewing this and contributing fixes and improvements.  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au> Acked-by: David S. Miller <davem@davemloft.net> Tested-by: Martin Willi <martin@strongswan.org>
f | leds_pwm.h | s | 355B | 18 | Luotao Fu | l.fu@pengutronix.de | 1239030386 |  | leds: simple driver for pwm driven LEDs  Add a simple driver for pwm driver LEDs.  pwm_id and period can be defined in board file.  It is developed for pxa, however it is probably generic enough to be used on other platforms with pwm.  Signed-off-by: Luotao Fu <l.fu@pengutronix.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Richard Purdie <rpurdie@linux.intel.com>
d | power |  | 9 items |  | Ramakrishna Pallala | ramakrishna.pallala@intel.com | 1336274891 |  | max17042_battery: Add support for max17047/50 chip  max17047 is improved version of max17042 chip. It has few HW bug fixes with minor changes in register set.  max17050 is same as max17047 chip except its silicon packging. So from driver's point of view there is no difference btw max1047 and max1050.  This patch adds the support to dynamically detect the chip type and adds steps to initialize the max17047 chip.  Signed-off-by: Ramakrishna Pallala <ramakrishna.pallala@intel.com> Signed-off-by: Anton Vorontsov <anton.vorontsov@linaro.org>
f | of_pci.h | s | 299B | 10 | John Crispin | blogic@openwrt.org | 1337607108 |  | OF: PCI: const usage needed by MIPS  On MIPS we want to call of_irq_map_pci from inside  arch/mips/include/asm/pci.h:extern int pcibios_map_irq( 				const struct pci_dev *dev, u8 slot, u8 pin); For this to work we need to change several functions to const usage.  Signed-off-by: John Crispin <blogic@openwrt.org> Cc: linux-pci@vger.kernel.org Cc: devicetree-discuss@lists.ozlabs.org Cc: linux-mips@linux-mips.org Acked-by: Bjorn Helgaas <bhelgaas@google.com> Acked-by: Grant Likely <grant.likely@secretlab.ca> Patchwork: https://patchwork.linux-mips.org/patch/3710/ Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | mbcache.h | s | 1.5K | 46 | Josh Hunt | johunt@akamai.com | 1294682648 |  | ext2: Resolve 'dereferencing pointer to incomplete type' when enabling EXT2_XATTR_DEBUG  When I enable EXT2_XATTR_DEBUG in fs/ext2/xattr.c I get a build error stating the following:    CC      fs/ext2/xattr.o fs/ext2/xattr.c: In function 'ext2_xattr_cache_insert': fs/ext2/xattr.c:841: error: dereferencing pointer to incomplete type fs/ext2/xattr.c:846: error: dereferencing pointer to incomplete type make[2]: *** [fs/ext2/xattr.o] Error 1 make[1]: *** [fs/ext2] Error 2 make: *** [fs] Error 2  These lines reference ext2_xattr_cache->c_entry_count which is defined in struct mb_cache. struct mb_cache is currently only defined in fs/mbcache.c. Moving struct mb_cache definition to include/linux/mbcache.h to resolve the issue.  Signed-off-by: Josh Hunt <johunt@akamai.com> Signed-off-by: Jan Kara <jack@suse.cz>
f | migrate_mode.h | s | 436B | 15 | Andrew Morton | akpm@linux-foundation.org | 1327336727 |  | mm: fix warnings regarding enum migrate_mode  sparc64 allmodconfig:  In file included from include/linux/compat.h:15,                  from /usr/src/25/arch/sparc/include/asm/siginfo.h:19,                  from include/linux/signal.h:5,                  from include/linux/sched.h:73,                  from arch/sparc/kernel/asm-offsets.c:13: include/linux/fs.h:618: warning: parameter has incomplete type  It seems that my sparc64 compiler (gcc-3.4.5) doesn't like the forward declaration of enums.  Fix this by moving the "enum migrate_mode" definition into its own header file.  Acked-by: Mel Gorman <mgorman@suse.de> Cc: Rik van Riel <riel@redhat.com> Cc: Andrea Arcangeli <aarcange@redhat.com> Cc: Minchan Kim <minchan.kim@gmail.com> Cc: Dave Jones <davej@redhat.com> Cc: Jan Kara <jack@suse.cz> Cc: Andy Isaacson <adi@hexapodia.org> Cc: Nai Xia <nai.xia@gmail.com> Cc: Johannes Weiner <jweiner@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | l2tp.h | s | 4.9K | 163 | Chris Elston | celston@katalix.com | 1335879055 |  | l2tp: introduce L2TPv3 IP encapsulation support for IPv6  L2TPv3 defines an IP encapsulation packet format where data is carried directly over IP (no UDP). The kernel already has support for L2TP IP encapsulation over IPv4 (l2tp_ip). This patch introduces support for L2TP IP encapsulation over IPv6.  The implementation is derived from ipv6/raw and ipv4/l2tp_ip.  Signed-off-by: Chris Elston <celston@katalix.com> Signed-off-by: James Chapman <jchapman@katalix.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cs5535.h | s | 6.3K | 193 | Daniel Drake | dsd@laptop.org | 1336395746 |  | x86/olpc/xo1/sci: Report RTC wakeup events  When the system is woken due to a RTC event, report the wakeup event on the relevant rtc device (if it can be found).  Signed-off-by: Daniel Drake <dsd@laptop.org> Cc: dilinger@queued.net Cc: pgf@laptop.org Link: http://lkml.kernel.org/r/20120418223402.D73249D401E@zog.reactivated.net Signed-off-by: Ingo Molnar <mingo@kernel.org>
f | posix_acl.h | s | 4.0K | 146 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | sdla.h | s | 8.8K | 295 | WANG Cong | xiyou.wangcong@gmail.com | 1311012363 |  | include/linux/sdla.h: remove the prototype of sdla()  `make headers_check` complains that  linux-2.6/usr/include/linux/sdla.h:116: userspace cannot reference function or variable defined in the kernel  this is due to that there is no such a kernel function,  void sdla(void *cfg_info, char *dev, struct frad_conf *conf, int quiet);  I don't know why we have it in a kernel header, so remove it.  Signed-off-by: WANG Cong <xiyou.wangcong@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mroute6.h | s | 7.1K | 226 | David Howells | dhowells@redhat.com | 1323788869 |  | UAPI: Split trivial #if defined(__KERNEL__) && X conditionals  Split trivial #if defined(__KERNEL__) && X conditionals to make automated disintegration easier.  Signed-off-by: David Howells <dhowells@redhat.com>
f | mxm-wmi.h | s | 1.1K | 30 | Dave Airlie | airlied@redhat.com | 1304905238 |  | mxm/wmi: add MXMX interface entry point.  The MXMX method appears to be a mutex of some sort.  Signed-off-by: Dave Airlie <airlied@redhat.com>
f | hpet.h | s | 3.2K | 106 | Suresh Siddha | suresh.b.siddha@intel.com | 1251408800 |  | intr-remap: generic support for remapping HPET MSIs  Generic support for remapping HPET MSI's by parsing the HPET timer block device scope in the ACPI DRHD tables. This is needed for platforms supporting interrupt-remapping and MSI capable HPET timer block.  Signed-off-by: Suresh Siddha <suresh.b.siddha@intel.com> Cc: David Woodhouse <dwmw2@infradead.org> Cc: Jesse Barnes <jbarnes@virtuousgeek.org> Cc: Venkatesh Pallipadi <venkatesh.pallipadi@intel.com> Cc: Jay Fenlason <fenlason@redhat.com> LKML-Reference: <20090804190729.477649000@intel.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | dqblk_qtree.h | s | 2.1K | 47 | Jan Kara | jack@suse.cz | 1231173621 |  | quota: Split off quota tree handling into a separate file  There is going to be a new version of quota format having 64-bit quota limits and a new quota format for OCFS2. They are both going to use the same tree structure as VFSv0 quota format. So split out tree handling into a separate file and make size of leaf blocks, amount of space usable in each block (needed for checksumming) and structures contained in them configurable so that the code can be shared.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Mark Fasheh <mfasheh@suse.com>
f | wait.h | s | 21K | 604 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | dm9000.h | s | 1.1K | 31 | Stefan Weil | weil@mail.berlios.de | 1265368954 |  | Fix spelling of 'platform' in comments and doc  Replace platfrom -> platform.  This is a frequent spelling bug.  Signed-off-by: Stefan Weil <weil@mail.berlios.de> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | matroxfb.h | s | 1.4K | 36 | Grazvydas Ignotas | notasas@gmail.com | 1274800029 |  | fbdev: move FBIO_WAITFORVSYNC to linux/fb.h  FBIO_WAITFORVSYNC is currently implemented by matroxfb, atyfb, intelfb and more.  All of them keep redefining the same FBIO_WAITFORVSYNC macro over and over again, so move it to linux/fb.h and clean up those duplicate defines.  Signed-off-by: Grazvydas Ignotas <notasas@gmail.com> Cc: Ville Syrjala <syrjala@sci.fi> Cc: Grant Likely <grant.likely@secretlab.ca> Cc: Maik Broemme <mbroemme@plusserver.de> Cc: Petr Vandrovec <vandrove@vc.cvut.cz> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Krzysztof Helt <krzysztof.h1@poczta.fm> Cc: "Hiremath, Vaibhav" <hvaibhav@ti.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ixjuser.h | s | 24K | 664 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | dma-mapping.h | s | 6.9K | 206 | Linus Torvalds | torvalds@linux-foundation.org | 1333584823 |  | Merge branch 'for-linus' of git://git.linaro.org/people/mszyprowski/linux-dma-mapping  Pull DMA mapping branch from Marek Szyprowski:  "Short summary for the whole series:    A few limitations have been identified in the current dma-mapping   design and its implementations for various architectures.  There exist   more than one function for allocating and freeing the buffers:   currently these 3 are used dma_{alloc, free}_coherent,   dma_{alloc,free}_writecombine, dma_{alloc,free}_noncoherent.    For most of the systems these calls are almost equivalent and can be   interchanged.  For others, especially the truly non-coherent ones   (like ARM), the difference can be easily noticed in overall driver   performance.  Sadly not all architectures provide implementations for   all of them, so the drivers might need to be adapted and cannot be   easily shared between different architectures.  The provided patches   unify all these functions and hide the differences under the already   existing dma attributes concept.  The thread with more references is   available here:      http://www.spinics.net/lists/linux-sh/msg09777.html    These patches are also a prerequisite for unifying DMA-mapping   implementation on ARM architecture with the common one provided by   dma_map_ops structure and extending it with IOMMU support.  More   information is available in the following thread:      http://thread.gmane.org/gmane.linux.kernel.cross-arch/12819    More works on dma-mapping framework are planned, especially in the   area of buffer sharing and managing the shared mappings (together with   the recently introduced dma_buf interface: commit d15bd7ee445d   "dma-buf: Introduce dma buffer sharing mechanism").    The patches in the current set introduce a new alloc/free methods   (with support for memory attributes) in dma_map_ops structure, which   will later replace dma_alloc_coherent and dma_alloc_writecombine   functions."  People finally started piping up with support for merging this, so I'm merging it as the last of the pending stuff from the merge window. Looks like pohmelfs is going to wait for 3.5 and more external support for merging.  * 'for-linus' of git://git.linaro.org/people/mszyprowski/linux-dma-mapping:   common: DMA-mapping: add NON-CONSISTENT attribute   common: DMA-mapping: add WRITE_COMBINE attribute   common: dma-mapping: introduce mmap method   common: dma-mapping: remove old alloc_coherent and free_coherent methods   Hexagon: adapt for dma_map_ops changes   Unicore32: adapt for dma_map_ops changes   Microblaze: adapt for dma_map_ops changes   SH: adapt for dma_map_ops changes   Alpha: adapt for dma_map_ops changes   SPARC: adapt for dma_map_ops changes   PowerPC: adapt for dma_map_ops changes   MIPS: adapt for dma_map_ops changes   X86 & IA64: adapt for dma_map_ops changes   common: dma-mapping: introduce generic alloc() and free() methods
f | of_platform.h | s | 3.8K | 99 | Grant Likely | grant.likely@secretlab.ca | 1330960149 |  | dt: fix twl4030 for non-dt compile on x86  twl4030 still doesn't build correctly for x86 allmodconfig.  This fix solves the missing symbol errors.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Benoit Cousson <b-cousson@ti.com>
f | gpio-pxa.h | s | 517B | 14 | Robert Jarzmik | robert.jarzmik@free.fr | 1335494805 |  | ARM: pxa: fix gpio wakeup setting  In 3.3, gpio wakeup setting was broken. The call enable_irq_wake() didn't set up the PXA gpio registers (PWER, ...) anymore.  Fix it at least for pxa27x. The driver doesn't seem to be used in pxa25x (weird ...), and the fix doesn't extend to pxa3xx and pxa95x (which don't have a gpio_set_wake() available).  Signed-off-by: Robert Jarzmik <robert.jarzmik@free.fr> Signed-off-by: Haojian Zhuang <haojian.zhuang@gmail.com>
f | rfkill-gpio.h | s | 1.6K | 41 | Sangwook Lee | sangwook.lee@linaro.org | 1317669559 |  | net:rfkill: add a gpio setup function into GPIO rfkill  Add a gpio setup function which gives a chance to set up platform specific configuration such as pin multiplexing, input/output direction at the runtime or booting time.  Signed-off-by: Sangwook Lee <sangwook.lee@linaro.org> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | kvm_host.h | s | 24K | 753 | Avi Kivity | avi@redhat.com | 1337195308 |  | KVM: MMU: Don't use RCU for lockless shadow walking  Using RCU for lockless shadow walking can increase the amount of memory in use by the system, since RCU grace periods are unpredictable.  We also have an unconditional write to a shared variable (reader_counter), which isn't good for scaling.  Replace that with a scheme similar to x86's get_user_pages_fast(): disable interrupts during lockless shadow walk to force the freer (kvm_mmu_commit_zap_page()) to wait for the TLB flush IPI to find the processor with interrupts enabled.  We also add a new vcpu->mode, READING_SHADOW_PAGE_TABLES, to prevent kvm_flush_remote_tlbs() from avoiding the IPI.  Signed-off-by: Avi Kivity <avi@redhat.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | svga.h | s | 3.7K | 98 | David Miller | davem@davemloft.net | 1300776442 |  | svga: Make svga_set_timings() take an iomem regbase pointer.  Signed-off-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | textsearch.h | s | 4.7K | 155 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103952 |  | include: replace linux/module.h with "struct module" wherever possible  The <linux/module.h> pretty much brings in the kitchen sink along with it, so it should be avoided wherever reasonably possible in terms of being included from other commonly used <linux/something.h> files, as it results in a measureable increase on compile times.  The worst culprit was probably device.h since it is used everywhere. This file also had an implicit dependency/usage of mutex.h which was masked by module.h, and is also fixed here at the same time.  There are over a dozen other headers that simply declare the struct instead of pulling in the whole file, so follow their lead and simply make it a few more.  Most of the implicit dependencies on module.h being present by these headers pulling it in have been now weeded out, so we can finally make this change with hopefully minimal breakage.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | kmalloc_sizes.h | s | 724B | 45 | Christoph Lameter | clameter@sgi.com | 1179404584 |  | Slab allocators: define common size limitations  Currently we have a maze of configuration variables that determine the maximum slab size.  Worst of all it seems to vary between SLAB and SLUB.  So define a common maximum size for kmalloc.  For conveniences sake we use the maximum size ever supported which is 32 MB.  We limit the maximum size to a lower limit if MAX_ORDER does not allow such large allocations.  For many architectures this patch will have the effect of adding large kmalloc sizes.  x86_64 adds 5 new kmalloc sizes.  So a small amount of memory will be needed for these caches (contemporary SLAB has dynamically sizeable node and cpu structure so the waste is less than in the past)  Most architectures will then be able to allocate object with sizes up to MAX_ORDER.  We have had repeated breakage (in fact whenever we doubled the number of supported processors) on IA64 because one or the other struct grew beyond what the slab allocators supported.  This will avoid future issues and f.e.  avoid fixes for 2k and 4k cpu support.  CONFIG_LARGE_ALLOCS is no longer necessary so drop it.  It fixes sparc64 with SLAB.  Signed-off-by: Christoph Lameter <clameter@sgi.com> Signed-off-by: "David S. Miller" <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | notifier.h | s | 7.6K | 182 | Amerigo Wang | amwang@redhat.com | 1311652635 |  | notifiers: vt: move vt notifiers into vt.h  It is not necessary to share the same notifier.h.  Signed-off-by: WANG Cong <amwang@redhat.com> Cc: David Miller <davem@davemloft.net> Cc: "Rafael J. Wysocki" <rjw@sisk.pl> Cc: Greg KH <greg@kroah.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | falloc.h | s | 663B | 22 | Josef Bacik | josef@redhat.com | 1294881403 |  | fs: add hole punching to fallocate  Hole punching has already been implemented by XFS and OCFS2, and has the potential to be implemented on both BTRFS and EXT4 so we need a generic way to get to this feature.  The simplest way in my mind is to add FALLOC_FL_PUNCH_HOLE to fallocate() since it already looks like the normal fallocate() operation. I've tested this patch with XFS and BTRFS to make sure XFS did what it's supposed to do and that BTRFS failed like it was supposed to.  Thank you,  Signed-off-by: Josef Bacik <josef@redhat.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | atmel_pdc.h | s | 1.5K | 32 | Ludovic Desroches | ludovic.desroches@atmel.com | 1319658206 |  | mmc: atmel-mci: use ATMEL_PDC_SCND_BUF_OFF instead of a literal value  Signed-off-by: Ludovic Desroches <ludovic.desroches@atmel.com> Signed-off-by: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | altera_jtaguart.h | s | 340B | 12 | Tobias Klauser | tklauser@distanz.ch | 1274459670 |  | serial: Add driver for the Altera JTAG UART  Add an UART driver for the JTAG UART component available as a SOPC (System on Programmable Chip) component for Altera FPGAs.  Signed-off-by: Tobias Klauser <tklauser@distanz.ch> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | hid.h | s | 27K | 814 | Jiri Kosina | jkosina@suse.cz | 1337679151 |  | Merge branch 'upstream' into for-linus  Conflicts: 	drivers/hid/hid-core.c
f | aio.h | s | 7.5K | 197 | Jeff Moyer | jmoyer@redhat.com | 1320275223 |  | aio: allocate kiocbs in batches  In testing aio on a fast storage device, I found that the context lock takes up a fair amount of cpu time in the I/O submission path.  The reason is that we take it for every I/O submitted (see __aio_get_req).  Since we know how many I/Os are passed to io_submit, we can preallocate the kiocbs in batches, reducing the number of times we take and release the lock.  In my testing, I was able to reduce the amount of time spent in _raw_spin_lock_irq by .56% (average of 3 runs).  The command I used to test this was:     aio-stress -O -o 2 -o 3 -r 8 -d 128 -b 32 -i 32 -s 16384 <dev>  I also tested the patch with various numbers of events passed to io_submit, and I ran the xfstests aio group of tests to ensure I didn't break anything.  Signed-off-by: Jeff Moyer <jmoyer@redhat.com> Cc: Daniel Ehrenberg <dehrenberg@google.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | slub_def.h | s | 9.1K | 281 | Linus Torvalds | torvalds@linux-foundation.org | 1332972266 |  | Merge branch 'slab/for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/penberg/linux  Pull SLAB changes from Pekka Enberg:  "There's the new kmalloc_array() API, minor fixes and performance   improvements, but quite honestly, nothing terribly exciting."  * 'slab/for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/penberg/linux:   mm: SLAB Out-of-memory diagnostics   slab: introduce kmalloc_array()   slub: per cpu partial statistics change   slub: include include for prefetch   slub: Do not hold slub_lock when calling sysfs_slab_add()   slub: prefetch next freelist pointer in slab_alloc()   slab, cleanup: remove unneeded return
f | mdio.h | s | 15K | 318 | David S. Miller | davem@davemloft.net | 1330805085 |  | mdio.h: Include linux/types.h  Fixes:  /home/davem/src/GIT/net-next/usr/include/linux/mdio.h:271: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: David S. Miller <davem@davemloft.net>
f | ieee80211.h | s | 52K | 1698 | Javier Cardona | javier@cozybit.com | 1334600369 |  | mac80211: Set the correct values for hwmp (1) and airtimeLinkMetric (1)  Per sections 8.4.2.100.2 and 8.4.2.100.3 of Std 802.11-2012  Reported-by: Shinichi Hotori <hotorinn@gmail.com> Signed-off-by: Javier Cardona <javier@cozybit.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | pkt_cls.h | s | 9.1K | 385 | Changli Gao | xiaosuo@gmail.com | 1282459214 |  | net_sched: cls_flow: add key rxhash  We can use rxhash to classify the traffic into flows. As rxhash maybe supplied by NIC or RPS, it is cheaper.  Signed-off-by: Changli Gao <xiaosuo@gmail.com> Acked-by: Jamal Hadi Salim <hadi@cyberus.ca> Signed-off-by: David S. Miller <davem@davemloft.net>
f | list_nulls.h | s | 3.1K | 98 | Pablo Neira Ayuso | pablo@netfilter.org | 1244888937 |  | list_nulls: add hlist_nulls_add_head and hlist_nulls_del  This patch adds the hlist_nulls_add_head() function which is based on hlist_nulls_add_head_rcu() but without the use of rcu_assign_pointer(). It also adds hlist_nulls_del which is exactly the same like hlist_nulls_del_rcu().  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org> Acked-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Patrick McHardy <kaber@trash.net>
f | crc8.h | s | 3.7K | 92 | Arend van Spriel | arend@broadcom.com | 1307127666 |  | lib: crc8: add new library module providing crc8 algorithm  The brcm80211 driver in staging tree uses a crc8 function. Based on feedback from John Linville to move this to lib directory, the linux source has been searched. Although there is currently only one other kernel driver using this algorithm (ie. drivers/ssb) we are providing this as a library function for others to use.  Cc: linux-kernel@vger.kernel.org Cc: linux-wireless@vger.kernel.org Cc: Dan Carpenter <error27@gmail.com> Cc: George Spelvin <linux@horizon.com> Cc: Randy Dunlap <rdunlap@xenotime.net> Reviewed-by: Henry Ptasinski <henryp@broadcom.com> Reviewed-by: Roland Vossen <rvossen@broadcom.com> Reviewed-by: "Franky (Zhenhui) Lin" <frankyl@broadcom.com> Signed-off-by: Arend van Spriel <arend@broadcom.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | libata.h | s | 58K | 1547 | Andy Whitcroft | apw@canonical.com | 1336419143 |  | libata: add a host flag to ignore detected ATA devices  Where devices are visible via more than one host we sometimes wish to indicate that cirtain devices should be ignored on a specific host.  Add a host flag indicating that this host wishes to ignore ATA specific devices.  Signed-off-by: Andy Whitcroft <apw@canonical.com> Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
f | ptp_clock_kernel.h | s | 4.1K | 127 | Richard Cochran | richardcochran@gmail.com | 1333531725 |  | ptp: Add a method for obtaining the device index.  This commit adds a method that MAC drivers may call in order to find out the device number of their associated PTP Hardware Clock.  Signed-off-by: Richard Cochran <richardcochran@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | posix-timers.h | s | 4.0K | 114 | John Stultz | john.stultz@linaro.org | 1313013326 |  | alarmtimers: Remove period from alarm structure  Now that periodic alarmtimers are managed by the handler function, remove the period value from the alarm structure and let the handlers manage the interval on their own.  CC: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: John Stultz <john.stultz@linaro.org>
f | eeprom_93xx46.h | s | 422B | 16 | Anatolij Gustschin | agust@denx.de | 1311652636 |  | misc/eeprom: add driver for microwire 93xx46 EEPROMs  Add EEPROM driver for 93xx46 chips.  It can also be used with spi_gpio driver to access 93xx46 EEPROMs connected over GPIO lines.  This driver supports read/write/erase access to the EEPROM chips over sysfs files.  [rdunlap@xenotime.net: fix printk format] Signed-off-by: Anatolij Gustschin <agust@denx.de> Cc: Jonathan Cameron <jic23@cam.ac.uk> Cc: Grant Likely <grant.likely@secretlab.ca> Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | agp_backend.h | s | 3.5K | 95 | Daniel Vetter | daniel.vetter@ffwll.ch | 1290543286 |  | agp: kill agp_rebind_memory  Its only user, intel-gtt.c is now gone.  Cc: Dave Airlie <airlied@gmail.com> Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch> Signed-off-by: Chris Wilson <chris@chris-wilson.co.uk>
f | of_i2c.h | s | 1.0K | 27 | Stephen Warren | swarren@nvidia.com | 1336825697 |  | of/i2c: implement of_find_i2c_adapter_by_node  This finds the struct i2c_adapter * for a given device tree node. Just like of_find_i2c_device_by_node.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | math64.h | s | 2.5K | 98 | Sasha Levin | levinsasha928@gmail.com | 1331844094 |  | math: Introduce div64_long  Add a div64_long macro which is used to devide a 64bit number by a long (which can be 4 bytes on 32bit systems and 8 bytes on 64bit systems).  Suggested-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Sasha Levin <levinsasha928@gmail.com> Cc: johnstul@us.ibm.com Link: http://lkml.kernel.org/r/1331829374-31543-1-git-send-email-levinsasha928@gmail.com Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | rslib.h | s | 3.0K | 100 | Segher Boessenkool | segher@kernel.crashing.org | 1178103393 |  | [RSLIB] Support non-canonical GF representations  For the CAF√â NAND controller, we need to support non-canonical representations of the Galois field. Allow the caller to provide its own function for generating the field, and CAF√â can use rslib instead of its own implementation.  Signed-off-by: Segher Boessenkool <segher@kernel.crashing.org> Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | sh_pfc.h | s | 5.7K | 161 | Magnus Damm | damm@opensource.se | 1326069237 |  | sh: pfc: Unlock register support  Add PFC support for a 32-bit unlock register. Needed to drive the r8a7779 PFC that comes with a funky PMMR register.  Signed-off-by: Magnus Damm <damm@opensource.se> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | stop_machine.h | s | 4.4K | 133 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | integrity.h | s | 898B | 33 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1316028292 |  | evm: permit mode bits to be updated  Before permitting 'security.evm' to be updated, 'security.evm' must exist and be valid.  In the case that there are no existing EVM protected xattrs, it is safe for posix acls to update the mode bits.  To differentiate between no 'security.evm' xattr and no xattrs used to calculate 'security.evm', this patch defines INTEGRITY_NOXATTR.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
f | page-isolation.h | s | 1.0K | 31 | Michal Nazarewicz | mina86@mina86.com | 1337605773 |  | mm: page_isolation: MIGRATE_CMA isolation functions added  This commit changes various functions that change pages and pageblocks migrate type between MIGRATE_ISOLATE and MIGRATE_MOVABLE in such a way as to allow to work with MIGRATE_CMA migrate type.  Signed-off-by: Michal Nazarewicz <mina86@mina86.com> Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com> Reviewed-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Tested-by: Rob Clark <rob.clark@linaro.org> Tested-by: Ohad Ben-Cohen <ohad@wizery.com> Tested-by: Benjamin Gaignard <benjamin.gaignard@linaro.org> Tested-by: Robert Nelson <robertcnelson@gmail.com> Tested-by: Barry Song <Baohua.Song@csr.com>
f | leds-lp5521.h | s | 2.1K | 65 | Kim, Milo | Milo.Kim@ti.com | 1332547114 |  | drivers/leds/leds-lp5521.c: support led pattern data  The lp5521 has autonomous operation mode without external control. Using lp5521_platform_data, various led patterns can be configurable. For supporting this feature, new functions and device attribute are added.  Structure of lp5521_led_pattern: 3 channels are supported - red, green and blue.  Pattern(s) of each channel and numbers of pattern(s) are defined in the pla= tform data.  Pattern data are hexa codes which include pattern commands such like set pwm, wait, ramp up/down, branch and so on.  Pattern mode functions:  * lp5521_clear_program_memory 	Before running new led pattern, program memory should be cleared.  * lp5521_write_program_memory 	Pattern data updated in the program memory via the i2c.  * lp5521_get_pattern 	Get pattern from predefined in the platform data.  * lp5521_run_led_pattern 	Stop current pattern or run new pattern. 	Transition time is required between different operation mode.  Device attribute - 'led_pattern': To load specific led pattern, new device attribute is added.  When the lp5521 driver is unloaded, stop current led pattern mode.  Documentation updated : description about how to define the led patterns and example.  [akpm@linux-foundation.org: checkpatch fixes] Signed-off-by: Milo(Woogyom) Kim <milo.kim@ti.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Cc: Arun MURTHY <arun.murthy@stericsson.com> Cc: Srinidhi Kasagar <srinidhi.kasagar@stericsson.com> Cc: Richard Purdie <rpurdie@rpsys.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | in.h | s | 9.5K | 277 | Erich E. Hoover | ehoover@mines.edu | 1328734365 |  | ipv4: Implement IP_UNICAST_IF socket option.  The IP_UNICAST_IF feature is needed by the Wine project.  This patch implements the feature by setting the outgoing interface in a similar fashion to that of IP_MULTICAST_IF.  A separate option is needed to handle this feature since the existing options do not provide all of the characteristics required by IP_UNICAST_IF, a summary is provided below.  SO_BINDTODEVICE: * SO_BINDTODEVICE requires administrative privileges, IP_UNICAST_IF does not.  From reading some old mailing list articles my understanding is that SO_BINDTODEVICE requires administrative privileges because it can override the administrator's routing settings. * The SO_BINDTODEVICE option restricts both outbound and inbound traffic, IP_UNICAST_IF only impacts outbound traffic.  IP_PKTINFO: * Since IP_PKTINFO and IP_UNICAST_IF are independent options, implementing IP_UNICAST_IF with IP_PKTINFO will likely break some applications. * Implementing IP_UNICAST_IF on top of IP_PKTINFO significantly complicates the Wine codebase and reduces the socket performance (doing this requires a lot of extra communication between the "server" and "user" layers).  bind(): * bind() does not work on broadcast packets, IP_UNICAST_IF is specifically intended to work with broadcast packets. * Like SO_BINDTODEVICE, bind() restricts both outbound and inbound traffic.  Signed-off-by: Erich E. Hoover <ehoover@mines.edu> Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | rio_regs.h | s | 14K | 263 | Alexandre Bounine | alexandre.bounine@idt.com | 1314314734 |  | rapidio: fix use of non-compatible registers  Replace/remove use of RIO v.1.2 registers/bits that are not forward-compatible with newer versions of RapidIO specification.  RapidIO specification v.1.3 removed Write Port CSR, Doorbell CSR, Mailbox CSR and Mailbox and Doorbell bits of the PEF CAR.  Use of removed (since RIO v.1.3) register bits affects users of currently available 1.3 and 2.x compliant devices who may use not so recent kernel versions.  Removing checks for unsupported bits makes corresponding routines compatible with all versions of RapidIO specification.  Therefore, backporting makes stable kernel versions compliant with RIO v.1.3 and later as well.  Signed-off-by: Alexandre Bounine <alexandre.bounine@idt.com> Cc: Kumar Gala <galak@kernel.crashing.org> Cc: Matt Porter <mporter@kernel.crashing.org> Cc: Li Yang <leoli@freescale.com> Cc: Thomas Moll <thomas.moll@sysgo.com> Cc: Chul Kim <chul.kim@idt.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | kcmp.h | s | 214B | 14 | Cyrill Gorcunov | gorcunov@openvz.org | 1338511772 |  | syscalls, x86: add __NR_kcmp syscall  While doing the checkpoint-restore in the user space one need to determine whether various kernel objects (like mm_struct-s of file_struct-s) are shared between tasks and restore this state.  The 2nd step can be solved by using appropriate CLONE_ flags and the unshare syscall, while there's currently no ways for solving the 1st one.  One of the ways for checking whether two tasks share e.g.  mm_struct is to provide some mm_struct ID of a task to its proc file, but showing such info considered to be not that good for security reasons.  Thus after some debates we end up in conclusion that using that named 'comparison' syscall might be the best candidate.  So here is it -- __NR_kcmp.  It takes up to 5 arguments - the pids of the two tasks (which characteristics should be compared), the comparison type and (in case of comparison of files) two file descriptors.  Lookups for pids are done in the caller's PID namespace only.  At moment only x86 is supported and tested.  [akpm@linux-foundation.org: fix up selftests, warnings] [akpm@linux-foundation.org: include errno.h] [akpm@linux-foundation.org: tweak comment text] Signed-off-by: Cyrill Gorcunov <gorcunov@openvz.org> Acked-by: "Eric W. Biederman" <ebiederm@xmission.com> Cc: Pavel Emelyanov <xemul@parallels.com> Cc: Andrey Vagin <avagin@openvz.org> Cc: KOSAKI Motohiro <kosaki.motohiro@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: H. Peter Anvin <hpa@zytor.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Glauber Costa <glommer@parallels.com> Cc: Andi Kleen <andi@firstfloor.org> Cc: Tejun Heo <tj@kernel.org> Cc: Matt Helsley <matthltc@us.ibm.com> Cc: Pekka Enberg <penberg@kernel.org> Cc: Eric Dumazet <eric.dumazet@gmail.com> Cc: Vasiliy Kulikov <segoon@openwall.com> Cc: Alexey Dobriyan <adobriyan@gmail.com> Cc: Valdis.Kletnieks@vt.edu Cc: Michal Marek <mmarek@suse.cz> Cc: Frederic Weisbecker <fweisbec@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cpuset.h | s | 5.6K | 190 | Linus Torvalds | torvalds@linux-foundation.org | 1333057565 |  | Merge branch 'sched-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  Pull scheduler fixes from Ingo Molnar.  * 'sched-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:   cpusets: Remove an unused variable   sched/rt: Improve pick_next_highest_task_rt()   sched: Fix select_fallback_rq() vs cpu_active/cpu_online   sched/x86/smp: Do not enable IRQs over calibrate_delay()   sched: Fix compiler warning about declared inline after use   MAINTAINERS: Update email address for SCHEDULER and PERF EVENTS
f | splice.h | s | 3.0K | 84 | Eric Dumazet | edumazet@google.com | 1339615002 |  | splice: fix racy pipe->buffers uses  Dave Jones reported a kernel BUG at mm/slub.c:3474! triggered by splice_shrink_spd() called from vmsplice_to_pipe()  commit 35f3d14dbbc5 (pipe: add support for shrinking and growing pipes) added capability to adjust pipe->buffers.  Problem is some paths don't hold pipe mutex and assume pipe->buffers doesn't change for their duration.  Fix this by adding nr_pages_max field in struct splice_pipe_desc, and use it in place of pipe->buffers where appropriate.  splice_shrink_spd() loses its struct pipe_inode_info argument.  Reported-by: Dave Jones <davej@redhat.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Cc: Jens Axboe <axboe@kernel.dk> Cc: Alexander Viro <viro@zeniv.linux.org.uk> Cc: Tom Herbert <therbert@google.com> Cc: stable <stable@vger.kernel.org> # 2.6.35 Tested-by: Dave Jones <davej@redhat.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | hwmon-sysfs.h | s | 2.0K | 49 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | i8k.h | s | 1.4K | 39 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | platform_device.h | s | 9.4K | 251 | Linus Torvalds | torvalds@linux-foundation.org | 1326057057 |  | Merge branch 'pm-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm  * 'pm-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/rafael/linux-pm: (76 commits)   PM / Hibernate: Implement compat_ioctl for /dev/snapshot   PM / Freezer: fix return value of freezable_schedule_timeout_killable()   PM / shmobile: Allow the A4R domain to be turned off at run time   PM / input / touchscreen: Make st1232 use device PM QoS constraints   PM / QoS: Introduce dev_pm_qos_add_ancestor_request()   PM / shmobile: Remove the stay_on flag from SH7372's PM domains   PM / shmobile: Don't include SH7372's INTCS in syscore suspend/resume   PM / shmobile: Add support for the sh7372 A4S power domain / sleep mode   PM: Drop generic_subsys_pm_ops   PM / Sleep: Remove forward-only callbacks from AMBA bus type   PM / Sleep: Remove forward-only callbacks from platform bus type   PM: Run the driver callback directly if the subsystem one is not there   PM / Sleep: Make pm_op() and pm_noirq_op() return callback pointers   PM/Devfreq: Add Exynos4-bus device DVFS driver for Exynos4210/4212/4412.   PM / Sleep: Merge internal functions in generic_ops.c   PM / Sleep: Simplify generic system suspend callbacks   PM / Hibernate: Remove deprecated hibernation snapshot ioctls   PM / Sleep: Fix freezer failures due to racy usermodehelper_is_disabled()   ARM: S3C64XX: Implement basic power domain support   PM / shmobile: Use common always on power domain governor   ...  Fix up trivial conflict in fs/xfs/xfs_buf.c due to removal of unused XBT_FORCE_SLEEP bit
f | tpm.h | s | 1.3K | 43 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1290981322 |  | key: add tpm_send command  Add internal kernel tpm_send() command used to seal/unseal keys.  Changelog: - replaced module_put in tpm_send() with new tpm_chip_put() wrapper   (suggested by David Howells) - Make tpm_send() cmd argument a 'void *' (suggested by David Howells)  Signed-off-by: David Safford <safford@watson.ibm.com> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Acked-by: David Howells <dhowells@redhat.com> Acked-by: Serge E. Hallyn <serge.hallyn@canonical.com> Signed-off-by: James Morris <jmorris@namei.org>
f | smc911x.h | s | 255B | 10 | Catalin Marinas | catalin.marinas@arm.com | 1224673238 |  | smc911x: Add IRQ polarity configuration  Platforms like ARM Ltd's RealView require the IRQ polarity bit to be set for the SMC9118 chip. This patch allows the dynamic configuration via the smc911x_platdata structure.  This patch also changes the smc91x_platdata structure name to the correct smc911x_platdata in the smc911x_drv_probe() function.  Signed-off-by: Catalin Marinas <catalin.marinas@arm.com> Signed-off-by: Jeff Garzik <jgarzik@redhat.com>
f | limits.h | s | 874B | 16 | Roland McGrath | roland@redhat.com | 1184692983 |  | Remove CHILD_MAX  The CHILD_MAX macro in limits.h should not be there.  It claims to be the limit on processes a user can own, but its value is wrong for that. There is no constant value, but a variable resource limit (RLIMIT_NPROC). Nothing in the kernel uses CHILD_MAX.  The proper thing to do according to POSIX is not to define CHILD_MAX at all. The sysconf (_SC_CHILD_MAX) implementation works by calling getrlimit.  Signed-off-by: Roland McGrath <roland@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | vgaarb.h | s | 9.0K | 227 | Matthew Garrett | mjg@redhat.com | 1336033855 |  | vgaarb: Provide dummy default device functions  Add some stub functions for the case where CONFIG_VGA_ARB is disabled.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | rtnetlink.h | s | 20K | 668 | John Fastabend | john.r.fastabend@intel.com | 1334509564 |  | net: add generic PF_BRIDGE:RTM_ FDB hooks  This adds two new flags NTF_MASTER and NTF_SELF that can now be used to specify where PF_BRIDGE netlink commands should be sent. NTF_MASTER sends the commands to the 'dev->master' device for parsing. Typically this will be the linux net/bridge, or open-vswitch devices. Also without any flags set the command will be handled by the master device as well so that current user space tools continue to work as expected.  The NTF_SELF flag will push the PF_BRIDGE commands to the device. In the basic example below the commands are then parsed and programmed in the embedded bridge.  Note if both NTF_SELF and NTF_MASTER bits are set then the command will be sent to both 'dev->master' and 'dev' this allows user space to easily keep the embedded bridge and software bridge in sync.  There is a slight complication in the case with both flags set when an error occurs. To resolve this the rtnl handler clears the NTF_ flag in the netlink ack to indicate which sets completed successfully. The add/del handlers will abort as soon as any error occurs.  To support this new net device ops were added to call into the device and the existing bridging code was refactored to use these. There should be no required changes in user space to support the current bridge behavior.  A basic setup with a SR-IOV enabled NIC looks like this,            veth0  veth2             ||      ||           ------------           ||  bridge0 ||   <---- software bridging           ------------                /                /   ethx.y      ethx     VF         PF      \         \          <---- propagate FDB entries to HW      \         \   --------------------   ||  Embedded Bridge ||    <---- hardware offloaded switching   --------------------  In this case the embedded bridge must be managed to allow 'veth0' to communicate with 'ethx.y' correctly. At present drivers managing the embedded bridge either send frames onto the network which then get dropped by the switch OR the embedded bridge will flood these frames. With this patch we have a mechanism to manage the embedded bridge correctly from user space. This example is specific to SR-IOV but replacing the VF with another PF or dropping this into the DSA framework generates similar management issues.  Examples session using the 'br'[1] tool to add, dump and then delete a mac address with a new "embedded" option and enabled ixgbe driver:  # br fdb add 22:35:19:ac:60:59 dev eth3 # br fdb port    mac addr                flags veth0   22:35:19:ac:60:58       static veth0   9a:5f:81:f7:f6:ec       local eth3    00:1b:21:55:23:59       local eth3    22:35:19:ac:60:59       static veth0   22:35:19:ac:60:57       static #br fdb add 22:35:19:ac:60:59 embedded dev eth3 #br fdb port    mac addr                flags veth0   22:35:19:ac:60:58       static veth0   9a:5f:81:f7:f6:ec       local eth3    00:1b:21:55:23:59       local eth3    22:35:19:ac:60:59       static veth0   22:35:19:ac:60:57       static eth3    22:35:19:ac:60:59       local embedded #br fdb del 22:35:19:ac:60:59 embedded dev eth3  I added a couple lines to 'br' to set the flags correctly is all. It is my opinion that the merit of this patch is now embedded and SW bridges can both be modeled correctly in user space using very nearly the same message passing.  [1] 'br' tool was published as an RFC here and will be renamed 'bridge'     http://patchwork.ozlabs.org/patch/117664/  Thanks to Jamal Hadi Salim, Stephen Hemminger and Ben Hutchings for valuable feedback, suggestions, and review.  v2: fixed api descriptions and error case with both NTF_SELF and     NTF_MASTER set plus updated patch description.  Signed-off-by: John Fastabend <john.r.fastabend@intel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | fault-inject.h | s | 1.7K | 55 | Akinobu Mita | akinobu.mita@gmail.com | 1312417520 |  | fault-injection: add ability to export fault_attr in arbitrary directory  init_fault_attr_dentries() is used to export fault_attr via debugfs. But it can only export it in debugfs root directory.  Per Forlin is working on mmc_fail_request which adds support to inject data errors after a completed host transfer in MMC subsystem.  The fault_attr for mmc_fail_request should be defined per mmc host and export it in debugfs directory per mmc host like /sys/kernel/debug/mmc0/mmc_fail_request.  init_fault_attr_dentries() doesn't help for mmc_fail_request.  So this introduces fault_create_debugfs_attr() which is able to create a directory in the arbitrary directory and replace init_fault_attr_dentries().  [akpm@linux-foundation.org: extraneous semicolon, per Randy] Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Tested-by: Per Forlin <per.forlin@linaro.org> Cc: Jens Axboe <axboe@kernel.dk> Cc: Christoph Lameter <cl@linux-foundation.org> Cc: Pekka Enberg <penberg@kernel.org> Cc: Matt Mackall <mpm@selenic.com> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | debugobjects.h | s | 3.6K | 99 | Christine Chan | cschan@codeaurora.org | 1322070562 |  | debugobjects: Extend to assert that an object is initialized  Calling del_timer_sync() on an uninitialized timer leads to a never ending loop in lock_timer_base() that spins checking for a non-NULL timer base. Add an assertion to debugobjects to catch usage of uninitialized objects so that we can initialize timers in the del_timer_sync() path before it calls lock_timer_base().  [ sboyd@codeaurora.org: Clarify commit message ]  Signed-off-by: Christine Chan <cschan@codeaurora.org> Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: John Stultz <john.stultz@linaro.org> Link: http://lkml.kernel.org/r/1320724108-20788-3-git-send-email-sboyd@codeaurora.org Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | c2port.h | s | 1.6K | 51 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | anon_inodes.h | s | 455B | 15 | Tomasz Stanislawski | t.stanislaws@samsung.com | 1311209263 |  | anonfd: fix missing declaration  The forward declaration of struct file_operations is added to avoid compilation warnings.  Signed-off-by: Tomasz Stanislawski <t.stanislaws@samsung.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | rwlock_types.h | s | 1.2K | 42 | Thomas Gleixner | tglx@linutronix.de | 1296127838 |  | locking: Remove deprecated lock initializers  Last users are gone. Remove the left overs.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | sys_soc.h | s | 952B | 31 | Lee Jones | lee.jones@linaro.org | 1328902945 |  | drivers/base: add bus for System-on-Chip devices  Traditionally, any System-on-Chip based platform creates a flat list of platform_devices directly under /sys/devices/platform.  In order to give these some better structure, this introduces a new bus type for soc_devices that are registered with the new soc_device_register() function.  All devices that are on the same chip should then be registered as child devices of the soc device.  The soc bus also exports a few standardised device attributes which allow user space to query the specific type of soc.  Signed-off-by: Lee Jones <lee.jones@linaro.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | types.h | s | 5.8K | 213 | Al Viro | viro@zeniv.linux.org.uk | 1338426290 |  | bury __kernel_nlink_t, make internal nlink_t consistent  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | namei.h | s | 3.0K | 89 | Andy Whitcroft | apw@canonical.com | 1320234822 |  | readlinkat: ensure we return ENOENT for the empty pathname for normal lookups  Since the commit below which added O_PATH support to the *at() calls, the error return for readlink/readlinkat for the empty pathname has switched from ENOENT to EINVAL:    commit 65cfc6722361570bfe255698d9cd4dccaf47570d   Author: Al Viro <viro@zeniv.linux.org.uk>   Date:   Sun Mar 13 15:56:26 2011 -0400      readlinkat(), fchownat() and fstatat() with empty relative pathnames  This is both unexpected for userspace and makes readlink/readlinkat inconsistant with all other interfaces; and inconsistant with our stated return for these pathnames.  As the readlinkat call does not have a flags parameter we cannot use the AT_EMPTY_PATH approach used in the other calls.  Therefore expose whether the original path is infact entry via a new user_path_at_empty() path lookup function.  Use this to determine whether to default to EINVAL or ENOENT for failures.  Addresses http://bugs.launchpad.net/bugs/817187  [akpm@linux-foundation.org: remove unused getname_flags()] Signed-off-by: Andy Whitcroft <apw@canonical.com> Cc: Christoph Hellwig <hch@lst.de> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: <stable@kernel.org> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Christoph Hellwig <hch@lst.de>
f | hil_mlc.h | s | 5.1K | 140 | Matthew Wilcox | matthew@wil.cx | 1208571774 |  | Convert asm/semaphore.h users to linux/semaphore.h  Signed-off-by: Matthew Wilcox <willy@linux.intel.com>
f | phonedev.h | s | 545B | 19 | Arjan van de Ven | arjan@linux.intel.com | 1171302526 |  | [PATCH] mark struct inode_operations const 3  Many struct inode_operations in the kernel can be "const".  Marking them const moves these to the .rodata section, which avoids false sharing with potential dirty data.  In addition it'll catch accidental writes at compile time to these shared resources.  Signed-off-by: Arjan van de Ven <arjan@linux.intel.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | compiler-gcc.h | s | 3.9K | 98 | Steven Rostedt | rostedt@goodmis.org | 1340027220 |  | ftrace: Make all inline tags also include notrace  Commit 5963e317b1e9d2a ("ftrace/x86: Do not change stacks in DEBUG when calling lockdep") prevented lockdep calls from the int3 breakpoint handler from reseting the stack if a function that was called was in the process of being converted for tracing and had a breakpoint on it. The idea is, before calling the lockdep code, do a load_idt() to the special IDT that kept the breakpoint stack from reseting. This worked well as a quick fix for this kernel release, until a certain config caused a lockup in the function tracer start up tests.  Investigating it, I found that the load_idt that was used to prevent the int3 from changing stacks was itself being traced!  Even though the config had CONFIG_OPTIMIZE_INLINING disabled, and all 'inline' tags were set to always inline, there were still cases that it did not inline! This was caused by CONFIG_PARAVIRT_GUEST, where it would add a pointer to the native_load_idt() which made that function to be traced.  Commit 45959ee7aa645815a ("ftrace: Do not function trace inlined functions") only touched the 'inline' tags when CONFIG_OPMITIZE_INLINING was enabled. PARAVIRT_GUEST shows that this was not enough and we need to also mark always_inline with notrace as well.  Reported-by: Fengguang Wu <wfg@linux.intel.com> Tested-by: Fengguang Wu <wfg@linux.intel.com> Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
f | dma-debug.h | s | 4.8K | 142 | FUJITA Tomonori | fujita.tomonori@lab.ntt.co.jp | 1239790957 |  | dma-debug: add dma_debug_resize_entries() to adjust the number of dma_debug_entries  We use a static value for the number of dma_debug_entries. It can be overwritten by a kernel command line option.  Some IOMMUs (e.g. GART) can't set an appropriate value by a kernel command line option because they can't know such value until they finish initializing up their hardware.  This patch adds dma_debug_resize_entries() enables IOMMUs to adjust the number of dma_debug_entries anytime.  Signed-off-by: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp> Acked-by: Joerg Roedel <joerg.roedel@amd.com> Cc: fujita.tomonori@lab.ntt.co.jp Cc: akpm@linux-foundation.org LKML-Reference: <20090415182234R.fujita.tomonori@lab.ntt.co.jp> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | inet.h | s | 2.6K | 54 | Chuck Lever | chuck.lever@oracle.com | 1215619768 |  | NFS: Add string length argument to nfs_parse_server_address  To make nfs_parse_server_address() more generally useful, allow it to accept input strings that are not terminated with '\0'.  Signed-off-by: Chuck Lever <chuck.lever@oracle.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | virtio_scsi.h | s | 3.2K | 98 | Paolo Bonzini | pbonzini@redhat.com | 1329666620 |  | [SCSI] virtio-scsi: SCSI driver for QEMU based virtual machines  The virtio-scsi HBA is the basis of an alternative storage stack for QEMU-based virtual machines (including KVM).  Compared to virtio-blk it is more scalable, because it supports many LUNs on a single PCI slot), more powerful (it more easily supports passthrough of host devices to the guest) and more easily extensible (new SCSI features implemented by QEMU should not require updating the driver in the guest).  Acked-by: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | acct.h | s | 5.8K | 192 | David Howells | dhowells@redhat.com | 1323788869 |  | UAPI: Fix AHZ multiple inclusion when __KERNEL__ is removed  Fix AHZ multiple inclusion when __KERNEL__ is removed as part of the separation of the userspace headers from the kernel headers.  Signed-off-by: David Howells <dhowells@redhat.com>
f | if_frad.h | s | 4.9K | 155 | Eric Dumazet | eric.dumazet@gmail.com | 1275560512 |  | net: use __packed annotation  cleanup patch.  Use new __packed annotation in net/ and include/ (except netfilter)  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mpage.h | s | 722B | 20 | Dmitri Vorobiev | dmitri.vorobiev@movial.com | 1238585934 |  | Remove two unneeded exports and make two symbols static in fs/mpage.c  Commit 29a814d2ee0e43c2980f33f91c1311ec06c0aa35 (vfs: add hooks for ext4's delayed allocation support) exported the following functions  mpage_bio_submit() __mpage_writepage()  for the benefit of ext4's delayed allocation support. Since commit a1d6cc563bfdf1bf2829d3e6ce4d8b774251796b (ext4: Rework the ext4_da_writepages() function), these functions are not used by the ext4 driver anymore. However, the now unnecessary exports still remain, and this patch removes those. Moreover, these two functions can become static again.  The issue was spotted by namespacecheck.  Signed-off-by: Dmitri Vorobiev <dmitri.vorobiev@movial.com> Reviewed-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | yam.h | s | 2.8K | 73 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | dma_remapping.h | s | 1.3K | 43 | Eugeni Dodonov | eugeni.dodonov@intel.com | 1324054197 |  | iommu: Export intel_iommu_enabled to signal when iommu is in use  In i915 driver, we do not enable either rc6 or semaphores on SNB when dmar is enabled. The new 'intel_iommu_enabled' variable signals when the iommu code is in operation.  Cc: Ted Phelps <phelps@gnusto.com> Cc: Peter <pab1612@gmail.com> Cc: Lukas Hejtmanek <xhejtman@fi.muni.cz> Cc: Andrew Lutomirski <luto@mit.edu> CC: Daniel Vetter <daniel.vetter@ffwll.ch> Cc: Eugeni Dodonov <eugeni.dodonov@intel.com> Signed-off-by: Keith Packard <keithp@keithp.com>
f | signalfd.h | s | 1.6K | 60 | Oleg Nesterov | oleg@redhat.com | 1330112570 |  | epoll: introduce POLLFREE to flush ->signalfd_wqh before kfree()  This patch is intentionally incomplete to simplify the review. It ignores ep_unregister_pollwait() which plays with the same wqh. See the next change.  epoll assumes that the EPOLL_CTL_ADD'ed file controls everything f_op->poll() needs. In particular it assumes that the wait queue can't go away until eventpoll_release(). This is not true in case of signalfd, the task which does EPOLL_CTL_ADD uses its ->sighand which is not connected to the file.  This patch adds the special event, POLLFREE, currently only for epoll. It expects that init_poll_funcptr()'ed hook should do the necessary cleanup. Perhaps it should be defined as EPOLLFREE in eventpoll.  __cleanup_sighand() is changed to do wake_up_poll(POLLFREE) if ->signalfd_wqh is not empty, we add the new signalfd_cleanup() helper.  ep_poll_callback(POLLFREE) simply does list_del_init(task_list). This make this poll entry inconsistent, but we don't care. If you share epoll fd which contains our sigfd with another process you should blame yourself. signalfd is "really special". I simply do not know how we can define the "right" semantics if it used with epoll.  The main problem is, epoll calls signalfd_poll() once to establish the connection with the wait queue, after that signalfd_poll(NULL) returns the different/inconsistent results depending on who does EPOLL_CTL_MOD/signalfd_read/etc. IOW: apart from sigmask, signalfd has nothing to do with the file, it works with the current thread.  In short: this patch is the hack which tries to fix the symptoms. It also assumes that nobody can take tasklist_lock under epoll locks, this seems to be true.  Note:  	- we do not have wake_up_all_poll() but wake_up_poll() 	  is fine, poll/epoll doesn't use WQ_FLAG_EXCLUSIVE.  	- signalfd_cleanup() uses POLLHUP along with POLLFREE, 	  we need a couple of simple changes in eventpoll.c to 	  make sure it can't be "lost".  Reported-by: Maxime Bizon <mbizon@freebox.fr> Cc: <stable@kernel.org> Signed-off-by: Oleg Nesterov <oleg@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | i2c-dev.h | s | 2.5K | 58 | Jean Delvare | khali@linux-fr.org | 1332791239 |  | i2c: Update the FSF address  Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | async.h | s | 973B | 23 | Cornelia Huck | cornelia.huck@de.ibm.com | 1234115771 |  | async: Rename _special -> _domain for clarity.  Rename the async_*_special() functions to async_*_domain(), which describes the purpose of these functions much better. [Broke up long lines to silence checkpatch]  Signed-off-by: Cornelia Huck <cornelia.huck@de.ibm.com> Signed-off-by: Arjan van de Ven <arjan@linux.intel.com>
f | drbd_nl.h | s | 4.9K | 142 | Philipp Reisner | philipp.reisner@linbit.com | 1336569045 |  | drbd: Implemented the disk-timeout option  When the disk-timeout is active, and it expires for a single request, we consider the local disk as D_FAILED. Note: With this change, I made both timeout based state transitions HARD state transitions.  Signed-off-by: Philipp Reisner <philipp.reisner@linbit.com> Signed-off-by: Lars Ellenberg <lars.ellenberg@linbit.com>
f | quotaops.h | s | 9.2K | 293 | Eric W. Biederman | ebiederm@xmission.com | 1336040974 |  | userns: Use uid_eq gid_eq helpers when comparing kuids and kgids in the vfs  Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | kdebug.h | s | 448B | 16 | Andrew Morton | akpm@linux-foundation.org | 1185921580 |  | kdebug.h: forward-declare struct struct notifier_block  alpha:  In file included from kernel/notifier.c:1: include/linux/kdebug.h:14: warning: 'struct notifier_block' declared inside parameter list include/linux/kdebug.h:14: warning: its scope is only this definition or declaration, which is probably not what you want include/linux/kdebug.h:15: warning: 'struct notifier_block' declared inside parameter list kernel/notifier.c:529: error: conflicting types for 'register_die_notifier' include/linux/kdebug.h:14: error: previous declaration of 'register_die_notifier' was here kernel/notifier.c:533: error: conflicting types for 'register_die_notifier' include/linux/kdebug.h:14: error: previous declaration of 'register_die_notifier' was here kernel/notifier.c:536: error: conflicting types for 'unregister_die_notifier' include/linux/kdebug.h:15: error: previous declaration of 'unregister_die_notifier' was here kernel/notifier.c:539: error: conflicting types for 'unregister_die_notifier' include/linux/kdebug.h:15: error: previous declaration of 'unregister_die_notifier' was here  Cc: Richard Henderson <rth@twiddle.net> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | typecheck.h | s | 585B | 21 | Andrew Morton | akpm@linux-foundation.org | 1217008406 |  | split the typecheck macros out of include/linux/kernel.h  Needed to fix up a recursive include snafu in locking-add-typecheck-on-irqsave-and-friends-for-correct-flags.patch  Cc: Steven Rostedt <rostedt@goodmis.org> Cc: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | kmsg_dump.h | s | 2.4K | 85 | Kay Sievers | kay@vrfy.org | 1340060121 |  | kmsg - kmsg_dump() fix CONFIG_PRINTK=n compilation  Signed-off-by: Kay Sievers <kay@vrfy.org> Cc: Stephen Rothwell <sfr@canb.auug.org.au> Reported-by: Randy Dunlap <rdunlap@xenotime.net> Reported-by: Fengguang Wu <wfg@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | xfrm.h | s | 10K | 435 | Steffen Klassert | steffen.klassert@secunet.com | 1300072948 |  | xfrm: Add basic infrastructure to support IPsec extended sequence numbers  This patch adds the struct xfrm_replay_state_esn which will be used to support IPsec extended sequence numbers and anti replay windows bigger than 32 packets. Also we add a function that returns the actual size of the xfrm_replay_state_esn, a xfrm netlink atribute and a xfrm state flag for the use of extended sequence numbers.  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com> Acked-by: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cm4000_cs.h | s | 1.8K | 52 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | oxu210hp.h | s | 158B | 6 | Rodolfo Giometti | giometti@linux.it | 1231351190 |  | usb host: Oxford OXU210HP HCD driver.  This driver implements the support for Oxford OXU210HP USB high-speed host, no peripheral nor OTG.  Signed-off-by: Rodolfo Giometti <giometti@linux.it> Cc: Kan Liu <kan.k.liu@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | net.h | s | 10K | 285 | Neil Horman | nhorman@tuxdriver.com | 1338345235 |  | net: add MODULE_ALIAS_NET_PF_PROTO_NAME  The MODULE_ALAIS_NET_PF macro set is missing a variant that allows for the appending of an arbitrary string to the net-pf-<x>-proto-<y> base.  while MODULE_ALIAS_NET_PF_PROTO_NAME_TYPE allows an appending of a numerical type, we need to be able to append a generic string to support generic netlink families that have neither a fix numberical protocol nor type number  Signed-off-by: Neil Horman <nhorman@tuxdriver.com> CC: Eric Dumazet <eric.dumazet@gmail.com> CC: David Miller <davem@davemloft.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | preempt.h | s | 4.1K | 122 | Thomas Gleixner | tglx@linutronix.de | 1330594084 |  | sched/rt: Document scheduler related skip-resched-check sites  Create a distinction between scheduler related preempt_enable_no_resched() calls and the nearly one hundred other places in the kernel that do not want to reschedule, for one reason or another.  This distinction matters for -rt, where the scheduler and the non-scheduler preempt models (and checks) are different. For upstream it's purely documentational.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Link: http://lkml.kernel.org/n/tip-gs88fvx2mdv5psnzxnv575ke@git.kernel.org Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | i82593.h | s | 5.6K | 211 | John W. Linville | linville@tuxdriver.com | 1258470992 |  | znet: fix build failure from i82593.h relocation  znet was including "wireless/i82593.h" (which is a bit wierd), and I missed that when I relocated i82593.h to drivers/staging/wavelan.  Since I don't have ISA turned-on in my normal .config, I didn't see the build failures -- mea culpa!  Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | som.h | s | 5.4K | 134 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | iocontext.h | s | 4.7K | 141 | Tejun Heo | tj@kernel.org | 1332244068 |  | block: remove ioc_*_changed()  After the previous patch to cfq, there's no ioc_get_changed() user left.  This patch yanks out ioc_{ioprio||cgroup||get}_changed() and all related stuff.  Signed-off-by: Tejun Heo <tj@kernel.org> Cc: Vivek Goyal <vgoyal@redhat.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | hdreg.h | s | 22K | 619 | Bartlomiej Zolnierkiewicz | bzolnier@gmail.com | 1238614946 |  | remove <linux/ata.h> include from <linux/hdreg.h>  All <linux/hdreg.h> users that need <linux/ata.h> have been fixed to include it directly.  Cc: Christoph Hellwig <hch@infradead.org> Signed-off-by: Bartlomiej Zolnierkiewicz <bzolnier@gmail.com>
f | maple.h | s | 2.7K | 91 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | atmsvc.h | s | 1.7K | 43 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | sfi.h | s | 5.7K | 165 | Feng Tang | feng.tang@intel.com | 1289310352 |  | x86/mrst: Add SFI platform device parsing code  SFI provides a series of tables. These describe the platform devices present including SPI and I¬≤C devices, as well as various sensors, keypads and other glue as well as interfaces provided via the SCU IPC mechanism (intel_scu_ipc.c)  This patch is a merge of the core elements and relevant fixes from the Intel development code by Feng, Alek, myself into a single coherent patch for upstream submission.  It provides the needed infrastructure to register I2C, SPI and platform devices described by the tables, as well as handlers for some of the hardware already supported in kernel. The 0.8 firmware also provides GPIO tables.  Devices are created at boot time or if they are SCU dependant at the point an SCU is discovered. The existing Linux device mechanisms will then handle the device binding. At an abstract level this is an SFI to Linux device translator.  Device/platform specific setup/glue is in this file. This is done so that the drivers for the generic I¬≤C and SPI bus devices remain cross platform as they should.  (Updated from RFC version to correct the emc1403 name used by the firmware  and a wrongly used #define)  Signed-off-by: Alek Du <alek.du@linux.intel.com> LKML-Reference: <20101109112158.20013.6158.stgit@localhost.localdomain> [Clean ups, removal of 0.7 support] Signed-off-by: Feng Tang <feng.tang@linux.intel.com> [Clean ups] Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | taskstats.h | s | 6.8K | 179 | Jeff Mahoney | jeffm@suse.com | 1293075814 |  | taskstats: pad taskstats netlink response for aligment issues on ia64  The taskstats structure is internally aligned on 8 byte boundaries but the layout of the aggregrate reply, with two NLA headers and the pid (each 4 bytes), actually force the entire structure to be unaligned.  This causes the kernel to issue unaligned access warnings on some architectures like ia64.  Unfortunately, some software out there doesn't properly unroll the NLA packet and assumes that the start of the taskstats structure will always be 20 bytes from the start of the netlink payload.  Aligning the start of the taskstats structure breaks this software, which we don't want.  So, for now the alignment only happens on architectures that require it and those users will have to update to fixed versions of those packages.  Space is reserved in the packet only when needed.  This ifdef should be removed in several years e.g.  2012 once we can be confident that fixed versions are installed on most systems.  We add the padding before the aggregate since the aggregate is already a defined type.  Commit 85893120 ("delayacct: align to 8 byte boundary on 64-bit systems") previously addressed the alignment issues by padding out the pid field. This was supposed to be a compatible change but the circumstances described above mean that it wasn't.  This patch backs out that change, since it was a hack, and introduces a new NULL attribute type to provide the padding.  Padding the response with 4 bytes avoids allocating an aligned taskstats structure and copying it back.  Since the structure weighs in at 328 bytes, it's too big to do it on the stack.  Signed-off-by: Jeff Mahoney <jeffm@suse.com> Reported-by: Brian Rogers <brian@xyzw.org> Cc: Jeff Mahoney <jeffm@suse.com> Cc: Guillaume Chazarain <guichaz@gmail.com> Cc: Balbir Singh <balbir@in.ibm.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | crc-t10dif.h | s | 140B | 5 | Martin K. Petersen | martin.petersen@oracle.com | 1215868952 |  | [SCSI] lib: Add support for the T10 (SCSI) Data Integrity Field CRC  The SCSI Block Protocol uses this 16-bit CRC to verify the integrity of each data sector.  crc_t10dif() is used by sd_dif.c when performing I/O to or from disks formatted with protection information.  Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com> Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>
f | sys.h | s | 921B | 26 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | page-flags.h | s | 14K | 432 | Linus Torvalds | torvalds@linux-foundation.org | 1332608919 |  | 
f | tfrc.h | s | 1.9K | 52 | Gerrit Renker | gerrit@erg.abdn.ac.uk | 1165876482 |  | [DCCP] ccid3: Finer-grained resolution of sending rates  This patch  * resolves a bug where packets smaller than 32/64 bytes resulted in sending rates of 0  * supports all sending rates from 1/64 bytes/second up to 4Gbyte/second  * simplifies the present overflow problems in calculations  Current sending rate X and the cached value X_recv of the receiver-estimated sending rate are both scaled by 64 (2^6) in order to  * cope with low sending rates (minimally 1 byte/second)  * allow upgrading to use a packets-per-second implementation of CCID 3  * avoid calculation errors due to integer arithmetic cut-off  The patch implements a revised strategy from http://www.mail-archive.com/dccp@vger.kernel.org/msg01040.html  The only difference with regard to that strategy is that t_ipi is already used in the calculation of the nofeedback timeout, which saves one division.  Signed-off-by: Gerrit Renker <gerrit@erg.abdn.ac.uk> Acked-by: Ian McDonald <ian.mcdonald@jandi.co.nz> Signed-off-by: Arnaldo Carvalho de Melo <acme@mandriva.com>
f | highuid.h | s | 3.1K | 76 | David Woodhouse | dwmw2@infradead.org | 1146052576 |  | Don't include linux/config.h from anywhere else in include/  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | netfilter_decnet.h | s | 1.9K | 67 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, netfilter: Add missing #include <limits.h> for userland  Various headers use INT_MIN and INT_MAX, which are defined for userland in <limits.h>.  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Acked-by: Patrick McHardy <kaber@trash.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | uprobes.h | s | 4.9K | 150 | Srikar Dronamraju | srikar@linux.vnet.ibm.com | 1334402748 |  | uprobes/core: Decrement uprobe count before the pages are unmapped  Uprobes has a callback (uprobe_munmap()) in the unmap path to maintain the uprobes count.  In the exit path this callback gets called in unlink_file_vma(). However by the time unlink_file_vma() is called, the pages would have been unmapped (in unmap_vmas()) and the task->rss_stat counts accounted (in zap_pte_range()).  If the exiting process has probepoints, uprobe_munmap() checks if the breakpoint instruction was around before decrementing the probe count.  This results in a file backed page being reread by uprobe_munmap() and hence it does not find the breakpoint.  This patch fixes this problem by moving the callback to unmap_single_vma(). Since unmap_single_vma() may not unmap the complete vma, add start and end parameters to uprobe_munmap().  This bug became apparent courtesy of commit c3f0327f8e9d ("mm: add rss counters consistency check").  Signed-off-by: Srikar Dronamraju <srikar@linux.vnet.ibm.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Ananth N Mavinakayanahalli <ananth@in.ibm.com> Cc: Jim Keniston <jkenisto@linux.vnet.ibm.com> Cc: Linux-mm <linux-mm@kvack.org> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Andi Kleen <andi@firstfloor.org> Cc: Christoph Hellwig <hch@infradead.org> Cc: Steven Rostedt <rostedt@goodmis.org> Cc: Arnaldo Carvalho de Melo <acme@infradead.org> Cc: Masami Hiramatsu <masami.hiramatsu.pt@hitachi.com> Cc: Anton Arapov <anton@redhat.com> Cc: Peter Zijlstra <peterz@infradead.org> Link: http://lkml.kernel.org/r/20120411103527.23245.9835.sendpatchset@srdronam.in.ibm.com Signed-off-by: Ingo Molnar <mingo@kernel.org>
d | hsi |  | 3 items |  | Carlos Chinea | carlos.chinea@nokia.com | 1335180212 |  | HSI: hsi: Rework hsi_event interface  Remove custom hack and make use of the notifier chain interfaces for delivering events from the ports to their associated clients. Clients that want to receive port events need to register their callbacks using hsi_register_port_event(). The callbacks can be called in interrupt context. Use hsi_unregestier_port_event() to undo the registration.  Signed-off-by: Carlos Chinea <carlos.chinea@nokia.com> Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | jbd_common.h | s | 1.8K | 59 | Darrick J. Wong | djwong@us.ibm.com | 1335738070 |  | ext4: create a new BH_Verified flag to avoid unnecessary metadata validation  Create a new BH_Verified flag to indicate that we've verified all the data in a buffer_head for correctness.  This allows us to bypass expensive verification steps when they are not necessary without missing them when they are.  Signed-off-by: Darrick J. Wong <djwong@us.ibm.com> Signed-off-by: "Theodore Ts'o" <tytso@mit.edu>
f | nvme.h | s | 9.2K | 399 | Matthew Wilcox | matthew.r.wilcox@intel.com | 1320438263 |  | NVMe: Update Identify Controller data structure  The driver was still using an old definition of Identify Controller which only came to light once we started using the 'number of namespaces' field properly.  Reported-by: Nisheeth Bhat <nisheeth.bhat@intel.com> Reported-by: Khosrow Panah <Khosrow.Panah@idt.com> Signed-off-by: Matthew Wilcox <matthew.r.wilcox@intel.com>
f | bitops.h | s | 4.8K | 175 | Akinobu Mita | akinobu.mita@gmail.com | 1332547114 |  | bitops: introduce for_each_clear_bit()  Introduce for_each_clear_bit() and for_each_clear_bit_from().  They are similar to for_each_set_bit() and list_for_each_set_bit_from(), but they iterate over all the cleared bits in a memory region.  Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Cc: Robert Richter <robert.richter@amd.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Ingo Molnar <mingo@redhat.com> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: David Woodhouse <dwmw2@infradead.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Stefano Panella <stefano.panella@csr.com> Cc: David Vrabel <david.vrabel@csr.com> Cc: Sergei Shtylyov <sshtylyov@mvista.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | decompress |  | 7 items |  | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | pcieport_if.h | s | 2.2K | 55 | Kenji Kaneshige | kaneshige.kenji@jp.fujitsu.com | 1259970979 |  | PCI: portdrv: remove unnecessary struct pcie_port_data  Remove 'port_type' field in struct pcie_port_data(), because we can get port type information from struct pci_dev. With this change, this patch also does followings:   - Remove struct pcie_port_data because it no longer has any field.  - Remove portdrv private definitions about port type (PCIE_RC_PORT,    PCIE_SW_UPSTREAM_PORT and PCIE_SW_DOWNSTREAM_PORT), and use generic    definitions instead.  Signed-off-by: Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cd1400.h | s | 6.9K | 247 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | rcupdate.h | s | 34K | 880 | Paul E. McKenney | paulmck@linux.vnet.ibm.com | 1336756461 |  | Merge branches 'barrier.2012.05.09a', 'fixes.2012.04.26a', 'inline.2012.05.02b' and 'srcu.2012.05.07b' into HEAD  barrier:  Reduce the amount of disturbance by rcu_barrier() to the rest of     	the system.  This branch also includes improvements to     	RCU_FAST_NO_HZ, which are included here due to conflicts. fixes:  Miscellaneous fixes. inline:  Remaining changes from an abortive attempt to inline     	preemptible RCU's __rcu_read_lock().  These are (1) making     	exit_rcu() avoid unnecessary work and (2) avoiding having     	preemptible RCU record a blocked thread when the scheduler     	declines to do a context switch. srcu:	Lai Jiangshan's algorithmic implementation of SRCU, including     	call_srcu().
f | fs.h | s | 90K | 2372 | Linus Torvalds | torvalds@linux-foundation.org | 1338760219 |  | vfs: move inode stat information closer together  The comment above it says "Stat data, not accessed from path walking", but in fact some of inode fields we use for the common stat data was way down at the end of the inode, causing unnecessary cache misses for the common stat operations.  The inode structure is pretty big, and this can change padding depending on field width, but at least on the common 64-bit configurations this doesn't change the size.  Some of our inode layout has historically been to tro to avoid unnecessary padding fields, but cache locality is at least as important for layout, if not more.  Noticed by looking at kernel profiles, and noticing that the "i_blkbits" access stood out like a sore thumb.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pagemap.h | s | 15K | 468 | Paul Gortmaker | paul.gortmaker@windriver.com | 1338333738 |  | pagemap.h: fix warning about possibly used before init var  Commit f56f821feb7b ("mm: extend prefault helpers to fault in more than PAGE_SIZE") added in the new functions: fault_in_multipages_writeable() and fault_in_multipages_readable().  However, we currently see:    include/linux/pagemap.h:492: warning: 'ret' may be used uninitialized in this function   include/linux/pagemap.h:492: note: 'ret' was declared here  Unlike a lot of gcc nags, this one appears somewhat legit.  i.e.  passing in an invalid negative value of "size" does make it look like all the conditionals in there would be bypassed and the uninitialized value would be returned.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Cc: Daniel Vetter <daniel.vetter@ffwll.ch> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | virtio_config.h | s | 7.3K | 177 | Chen Baozi | chenbaozi@gmail.com | 1337654776 |  | virtio: fix typo in comment  - Delete "@request_vqs" and "@free_vqs" comments, since   they are no longer in struct virtio_config_ops. - According to the macro below, "@val" should be "@v".  Signed-off-by: Chen Baozi <chenbaozi@gmail.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | kprobes.h | s | 12K | 390 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | if_ether.h | s | 6.6K | 132 | sjur.brandeland@stericsson.com | sjur.brandeland@stericsson.com | 1323127676 |  | if_ether.h: Add IEEE 802.1 Local Experimental Ethertype 1.  Add EthType 0x88b5. This Ethertype value is available for public use for prototype and vendor-specific protocol development,as defined in Amendment 802a to IEEE Std 802.  Signed-off-by: Sjur Br√¶ndeland <sjur.brandeland@stericsson.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | pda_power.h | s | 1.1K | 33 | Dima Zavin | dima@android.com | 1313773402 |  | pda_power: Add support for using otg transceiver events  If the platform data sets the use_otg_notifier flag, the driver will now register an otg notifier callback and listen to transceiver events for AC/USB plug-in events instead. This would normally be used by not specifying is_xx_online callbacks and not specifying any irqs so the state machine is completely driven from OTG xceiver events.  Signed-off-by: Dima Zavin <dima@android.com> Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>
f | edd.h | s | 5.5K | 182 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233339400 |  | headers_check fix: linux/edd.h  fix the following 'make headers_check' warning:    usr/include/linux/edd.h:70: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | lp8727.h | s | 1.3K | 59 | Kim, Milo | Milo.Kim@ti.com | 1332780059 |  | lp8727_charger: Correct typos on the comment  intergrated charger -> integrated charger     ^  Signed-off-by: Milo(Woogyom) Kim <milo.kim@ti.com> Signed-off-by: Anton Vorontsov <anton.vorontsov@linaro.org>
f | cper.h | s | 11K | 366 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | jz4740-adc.h | s | 984B | 26 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | sc26198.h | s | 12K | 458 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | mroute.h | s | 6.5K | 212 | David S. Miller | davem@davemloft.net | 1304536734 |  | ipv4: Pass explicit saddr/daddr args to ipmr_get_route().  This eliminates the need to use rt->rt_{src,dst}.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | igmp.h | s | 6.5K | 208 | David S. Miller | davem@davemloft.net | 1299803846 |  | ipv4: Remove redundant RCU locking in ip_check_mc().  All callers are under rcu_read_lock() protection already.  Rename to ip_check_mc_rcu() to make it even more clear.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | usb_usual.h | s | 3.3K | 88 | Alan Stern | stern@rowland.harvard.edu | 1307462742 |  | usb-storage: redo incorrect reads  Some USB mass-storage devices have bugs that cause them not to handle the first READ(10) command they receive correctly.  The Corsair Padlock v2 returns completely bogus data for its first read (possibly it returns the data in encrypted form even though the device is supposed to be unlocked).  The Feiya SD/SDHC card reader fails to complete the first READ(10) command after it is plugged in or after a new card is inserted, returning a status code that indicates it thinks the command was invalid, which prevents the kernel from retrying the read.  Since the first read of a new device or a new medium is for the partition sector, the kernel is unable to retrieve the device's partition table.  Users have to manually issue an "hdparm -z" or "blockdev --rereadpt" command before they can access the device.  This patch (as1470) works around the problem.  It adds a new quirk flag, US_FL_INVALID_READ10, indicating that the first READ(10) should always be retried immediately, as should any failing READ(10) commands (provided the preceding READ(10) command succeeded, to avoid getting stuck in a loop).  The patch also adds appropriate unusual_devs entries containing the new flag.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Tested-by: Sven Geggus <sven-usbst@geggus.net> Tested-by: Paul Hartman <paul.hartman+linux@gmail.com> CC: Matthew Dharm <mdharm-usb@one-eyed-alien.net> CC: <stable@kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | b1pcmcia.h | s | 666B | 18 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | evm.h | s | 2.5K | 88 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1316028291 |  | evm: posix acls modify i_mode  The posix xattr acls are 'system' prefixed, which normally would not affect security.evm.  An interesting side affect of writing posix xattr acls is their modifying of the i_mode, which is included in security.evm.  This patch updates security.evm when posix xattr acls are written.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com>
f | vmstat.h | s | 6.7K | 216 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | vermagic.h | s | 815B | 30 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103943 |  | vermagic: delete unused include of <linux/module.h>  This file consists of nothing other than things like:    #ifdef CONFIG_FOO   #define ....  There is no reason for it to require module.h  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | pmu.h | s | 7.1K | 179 | David Howells | dhowells@redhat.com | 1323768405 |  | UAPI: Guard linux/pmu.h  Place reinclusion guards on linux/pmu.h otherwise the UAPI splitter won't insert the #include to include the UAPI header from the kernel header.  Signed-off-by: David Howells <dhowells@redhat.com>
f | of.h | s | 12K | 367 | Dong Aisheng | dong.aisheng@linaro.org | 1335914080 |  | dt: add of_get_child_count helper function  Currently most code to get child count in kernel are almost same, add a helper to implement this function for dt to use.  Cc: Grant Likely <grant.likely@secretlab.ca> Acked-by: Rob Herring <rob.herring@calxeda.com> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | errno.h | s | 1.3K | 30 | Miklos Szeredi | mszeredi@suse.cz | 1338567121 |  | vfs: retry last component if opening stale dentry  NFS optimizes away d_revalidates for last component of open.  This means that open itself can find the dentry stale.  This patch allows the filesystem to return EOPENSTALE and the VFS will retry the lookup on just the last component if possible.  If the lookup was done using RCU mode, including the last component, then this is not possible since the parent dentry is lost.  In this case fall back to non-RCU lookup.  Currently this is not used since NFS will always leave RCU mode.  Signed-off-by: Miklos Szeredi <mszeredi@suse.cz> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | scx200_gpio.h | s | 2.3K | 70 | Al Viro | viro@ftp.linux.org.uk | 1192390911 |  | long vs. unsigned long - low-hanging fruits in drivers  deal with signedness of the stuff passed to set_bit() et.al.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | vfs.h | s | 77B | 4 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | dlm_device.h | s | 2.5K | 91 | David Teigland | teigland@redhat.com | 1219942155 |  | dlm: allow multiple lockspace creates  Add a count for lockspace create and release so that create can be called multiple times to use the lockspace from different places. Also add the new flag DLM_LSFL_NEWEXCL to create a lockspace with the previous behavior of returning -EEXIST if the lockspace already exists.  Signed-off-by: David Teigland <teigland@redhat.com>
f | ihex.h | s | 1.9K | 63 | Marc Zyngier | maz@misterjones.org | 1217698570 |  | Fix IHEX firmware generation/loading  Fix both the IHEX firmware generation (len field always null, and EOF marker a byte too short) and loading (struct ihex_binrec needs to be packed to reflect the on-disk structure).  Signed-off-by: Marc Zyngier <maz@misterjones.org> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | swapfile.h | s | 411B | 11 | Dan Magenheimer | dan.magenheimer@oracle.com | 1337096038 |  | mm: frontswap: core swap subsystem hooks and headers  This patch, 2of4, contains the changes to the core swap subsystem. This includes:  (1) makes available core swap data structures (swap_lock, swap_list and swap_info) that are needed by frontswap.c but we don't need to expose them to the dozens of files that include swap.h so we create a new swapfile.h just to extern-ify these and modify their declarations to non-static  (2) adds frontswap-related elements to swap_info_struct.  Frontswap_map points to vzalloc'ed one-bit-per-swap-page metadata that indicates whether the swap page is in frontswap or in the device and frontswap_pages counts how many pages are in frontswap.  (3) adds hooks in the swap subsystem and extends try_to_unuse so that frontswap_shrink can do a "partial swapoff".  Note that a failed frontswap_map allocation is safe... failure is noted by lack of "FS" in the subsequent printk.  ---  [v14: rebase to 3.4-rc2] [v10: no change] [v9: akpm@linux-foundation.org: mark some statics __read_mostly] [v9: akpm@linux-foundation.org: add clarifying comments] [v9: akpm@linux-foundation.org: no need to loop repeating try_to_unuse] [v9: error27@gmail.com: remove superfluous check for NULL] [v8: rebase to 3.0-rc4] [v8: kamezawa.hiroyu@jp.fujitsu.com: change counter to atomic_t to avoid races] [v8: kamezawa.hiroyu@jp.fujitsu.com: comment to clarify informational counters] [v7: rebase to 3.0-rc3] [v7: JBeulich@novell.com: add new swap struct elements only if config'd] [v6: rebase to 3.0-rc1] [v6: lliubbo@gmail.com: fix null pointer deref if vzalloc fails] [v6: konrad.wilk@oracl.com: various checks and code clarifications/comments] [v5: no change from v4] [v4: rebase to 2.6.39] Signed-off-by: Dan Magenheimer <dan.magenheimer@oracle.com> Reviewed-by: Kamezawa Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Acked-by: Jan Beulich <JBeulich@novell.com> Acked-by: Seth Jennings <sjenning@linux.vnet.ibm.com> Cc: Jeremy Fitzhardinge <jeremy@goop.org> Cc: Hugh Dickins <hughd@google.com> Cc: Johannes Weiner <hannes@cmpxchg.org> Cc: Nitin Gupta <ngupta@vflare.org> Cc: Matthew Wilcox <matthew@wil.cx> Cc: Chris Mason <chris.mason@oracle.com> Cc: Rik Riel <riel@redhat.com> Cc: Andrew Morton <akpm@linux-foundation.org> [v11: Rebased, fixed mm/swapfile.c context change] Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | sunserialcore.h | s | 978B | 27 | Paul Gortmaker | paul.gortmaker@windriver.com | 1328899475 |  | tty: sparc: rename drivers/tty/serial/suncore.h -> include/linux/sunserialcore.h  There are multiple users of this file from different source paths now, and rather than have ../ paths in include statements, just move the file to the linux header dir.  Suggested-by: David S. Miller <davem@davemloft.net> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | usbdevice_fs.h | s | 6.3K | 181 | Arnd Bergmann | arnd@arndb.de | 1260482137 |  | usbdevfs: move compat_ioctl handling to devio.c  Half the compat_ioctl handling is in devio.c, the other half is in fs/compat_ioctl.c. This moves everything into one place for consistency.  As a positive side-effect, push down the BKL into the ioctl methods.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Cc: Alan Stern <stern@rowland.harvard.edu> Cc: Oliver Neukum <oliver@neukum.org> Cc: Alon Bar-Lev <alon.barlev@gmail.com> Cc: David Vrabel <david.vrabel@csr.com> Cc: linux-usb@vger.kernel.org
f | rotary_encoder.h | s | 328B | 14 | Johan Hovold | jhovold@gmail.com | 1305214127 |  | Input: rotary-encoder - add support for half-period encoders  Add support for encoders that have two detents per input signal period.  Signed-off-by: Johan Hovold <jhovold@gmail.com> Acked-by: Daniel Mack <zonque@gmail.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | hdlc.h | s | 3.6K | 101 | Stephen Hemminger | shemminger@vyatta.com | 1251792811 |  | hdlc: convert to netdev_tx_t  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | textsearch_fsm.h | s | 1.1K | 43 | Thomas Graf | tgraf@suug.ch | 1119585556 |  | [LIB]: Naive finite state machine based textsearch  A finite state machine consists of n states (struct ts_fsm_token) representing the pattern as a finite automation. The data is read sequentially on a octet basis. Every state token specifies the number of recurrences and the type of value accepted which can be either a specific character or ctype based set of characters. The available type of recurrences include 1, (0||1), [0 n], and [1 n].  The algorithm differs between strict/non-strict mode specyfing whether the pattern has to start at the first octect. Strict mode is enabled by default and can be disabled by inserting TS_FSM_HEAD_IGNORE as the first token in the chain.  The runtime performance of the algorithm should be around O(n), however while in strict mode the average runtime can be better.  Signed-off-by: Thomas Graf <tgraf@suug.ch> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ptrace.h | s | 14K | 375 | Will Drewry | wad@chromium.org | 1334366001 |  | ptrace,seccomp: Add PTRACE_SECCOMP support  This change adds support for a new ptrace option, PTRACE_O_TRACESECCOMP, and a new return value for seccomp BPF programs, SECCOMP_RET_TRACE.  When a tracer specifies the PTRACE_O_TRACESECCOMP ptrace option, the tracer will be notified, via PTRACE_EVENT_SECCOMP, for any syscall that results in a BPF program returning SECCOMP_RET_TRACE.  The 16-bit SECCOMP_RET_DATA mask of the BPF program return value will be passed as the ptrace_message and may be retrieved using PTRACE_GETEVENTMSG.  If the subordinate process is not using seccomp filter, then no system call notifications will occur even if the option is specified.  If there is no tracer with PTRACE_O_TRACESECCOMP when SECCOMP_RET_TRACE is returned, the system call will not be executed and an -ENOSYS errno will be returned to userspace.  This change adds a dependency on the system call slow path.  Any future efforts to use the system call fast path for seccomp filter will need to address this restriction.  Signed-off-by: Will Drewry <wad@chromium.org> Acked-by: Eric Paris <eparis@redhat.com>  v18: - rebase      - comment fatal_signal check      - acked-by      - drop secure_computing_int comment v17: - ... v16: - update PT_TRACE_MASK to 0xbf4 so that STOP isn't clear on SETOPTIONS call (indan@nul.nu)        [note PT_TRACE_MASK disappears in linux-next] v15: - add audit support for non-zero return codes      - clean up style (indan@nul.nu) v14: - rebase/nochanges v13: - rebase on to 88ebdda6159ffc15699f204c33feb3e431bf9bdc        (Brings back a change to ptrace.c and the masks.) v12: - rebase to linux-next      - use ptrace_event and update arch/Kconfig to mention slow-path dependency      - drop all tracehook changes and inclusion (oleg@redhat.com) v11: - invert the logic to just make it a PTRACE_SYSCALL accelerator        (indan@nul.nu) v10: - moved to PTRACE_O_SECCOMP / PT_TRACE_SECCOMP v9:  - n/a v8:  - guarded PTRACE_SECCOMP use with an ifdef v7:  - introduced Signed-off-by: James Morris <james.l.morris@oracle.com>
f | i8253.h | s | 764B | 23 | Thomas Gleixner | tglx@linutronix.de | 1309509435 |  | i8253: Cleanup outb/inb magic  Remove the hysterical outb/inb_pit defines and use outb_p/inb_p in the code.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: Russell King <linux@arm.linux.org.uk> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: John Stultz <john.stultz@linaro.org> Link: http://lkml.kernel.org/r/20110609130622.348437125@linutronix.de
f | pci-aspm.h | s | 1.8K | 64 | Matthew Garrett | mjg@redhat.com | 1323109305 |  | PCI: Rework ASPM disable code  Right now we forcibly clear ASPM state on all devices if the BIOS indicates that the feature isn't supported. Based on the Microsoft presentation "PCI Express In Depth for Windows Vista and Beyond", I'm starting to think that this may be an error. The implication is that unless the platform grants full control via _OSC, Windows will not touch any PCIe features - including ASPM. In that case clearing ASPM state would be an error unless the platform has granted us that control.  This patch reworks the ASPM disabling code such that the actual clearing of state is triggered by a successful handoff of PCIe control to the OS. The general ASPM code undergoes some changes in order to ensure that the ability to clear the bits isn't overridden by ASPM having already been disabled. Further, this theoretically now allows for situations where only a subset of PCIe roots hand over control, leaving the others in the BIOS state.  It's difficult to know for sure that this is the right thing to do - there's zero public documentation on the interaction between all of these components. But enough vendors enable ASPM on platforms and then set this bit that it seems likely that they're expecting the OS to leave them alone.  Measured to save around 5W on an idle Thinkpad X220.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | crc7.h | s | 272B | 10 | Jan Nikitenko | jan.nikitenko@gmail.com | 1184692984 |  | CRC7 support  Add CRC7 routines, used for example in MMC over SPI communication. Kerneldoc updates  [akpm@linux-foundation.org: fix funny mix of const and non-const] Signed-off-by: Jan Nikitenko <jan.nikitenko@gmail.com> Signed-off-by: David Brownell <dbrownell@users.sourceforge.net> Cc: "Randy.Dunlap" <rdunlap@xenotime.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | apple_bl.h | s | 459B | 18 | H Hartley Sweeten | hartleys@visionengravers.com | 1338333749 |  | drivers/video/backlight/apple_bl.c: include header for exported symbol prototypes  Include the header to pickup the exported symbol prototype.  Quiets the sparse warning:    warning: symbol 'apple_bl_register' was not declared. Should it be static?   warning: symbol 'apple_bl_unregister' was not declared. Should it be static?  [akpm@linux-foundation.org: fix resulting build error] Signed-off-by: H Hartley Sweeten <hsweeten@visionengravers.com> Cc: Richard Purdie <rpurdie@rpsys.net> Signed-off-by: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fd.h | s | 11K | 326 | Johannes Stezenbach | js@sig21.net | 1310019498 |  | compat_ioctl: fix make headers_check regression  Fix headers_check error introduced by 390192b30057:  include/linux/fd.h:6: included file 'linux/compat.h' is not exported  Signed-off-by: Johannes Stezenbach <js@sig21.net> Signed-off-by: Jens Axboe <jaxboe@fusionio.com>
f | firewire-constants.h | s | 3.2K | 82 | Stefan Richter | stefanr@s5r6.in-berlin.de | 1271362716 |  | firewire: cdev: fix cut+paste mistake in disclaimer  This was supposed to be generic "authors or copyright holders"; I mistakenly picked up text from a wrong file.  Reported-by: Daniel K. <dk@uw.no> Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>
f | xz.h | s | 11K | 249 | Lasse Collin | lasse.collin@tukaani.org | 1294934604 |  | decompressors: add XZ decompressor module  In userspace, the .lzma format has become mostly a legacy file format that got superseded by the .xz format.  Similarly, LZMA Utils was superseded by XZ Utils.  These patches add support for XZ decompression into the kernel.  Most of the code is as is from XZ Embedded <http://tukaani.org/xz/embedded.html>. It was written for the Linux kernel but is usable in other projects too.  Advantages of XZ over the current LZMA code in the kernel:   - Nice API that can be used by other kernel modules; it's     not limited to kernel, initramfs, and initrd decompression.   - Integrity check support (CRC32)   - BCJ filters improve compression of executable code on     certain architectures. These together with LZMA2 can     produce a few percent smaller kernel or Squashfs images     than plain LZMA without making the decompression slower.  This patch: Add the main decompression code (xz_dec), testing module (xz_dec_test), wrapper script (xz_wrap.sh) for the xz command line tool, and documentation.  The xz_dec module is enough to have a usable XZ decompressor e.g.  for Squashfs.  Signed-off-by: Lasse Collin <lasse.collin@tukaani.org> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: Alain Knaff <alain@knaff.lu> Cc: Albin Tonnerre <albin.tonnerre@free-electrons.com> Cc: Phillip Lougher <phillip@lougher.demon.co.uk> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | jump_label.h | s | 6.2K | 188 | Jason Baron | jbaron@redhat.com | 1330455668 |  | static keys: Inline the static_key_enabled() function  In the jump label enabled case, calling static_key_enabled() results in a function call. The function returns the results of a compare, so it really doesn't need the overhead of a full function call. Let's make it 'static inline' for both the jump label enabled and disabled cases.  Signed-off-by: Jason Baron <jbaron@redhat.com> Cc: a.p.zijlstra@chello.nl Cc: rostedt@goodmis.org Cc: mathieu.desnoyers@polymtl.ca Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Link: http://lkml.kernel.org/r/201202281849.q1SIn1p2023270@int-mx10.intmail.prod.int.phx2.redhat.com Signed-off-by: Ingo Molnar <mingo@elte.hu>
d | netfilter_ipv4 |  | 12 items |  | Pablo Neira Ayuso | pablo@netfilter.org | 1336501542 |  | netfilter: remove ip_queue support  This patch removes ip_queue support which was marked as obsolete years ago. The nfnetlink_queue modules provides more advanced user-space packet queueing mechanism.  This patch also removes capability code included in SELinux that refers to ip_queue. Otherwise, we break compilation.  Several warning has been sent regarding this to the mailing list in the past month without anyone rising the hand to stop this with some strong argument.  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | if_hippi.h | s | 4.1K | 136 | Changli Gao | xiaosuo@gmail.com | 1282536939 |  | header: fix broken headers for user space  __packed is only defined in kernel space, so we should use __attribute__((packed)) for the code shared between kernel and user space.  Two __attribute() annotations are replaced with __attribute__() too.  Signed-off-by: Changli Gao <xiaosuo@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | synclink.h | s | 9.3K | 287 | Paul Fulghum | paulkf@microgate.com | 1288227794 |  | drivers/char/synclink_gt.c: add extended sync feature  Add support for extended byte synchronous mode feature of hardware.  Signed-off-by: Paul Fulghum <paulkf@microgate.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | input |  | 27 items |  | Dmitry Torokhov | dmitry.torokhov@gmail.com | 1336714783 |  | Input: matrix-keymap - wire up device tree support  When platform keymap is not supplied to matrix_keypad_build_keymap() and device tree support is enabled, try locating specified property and load keymap from it. If property name is not defined, try using "linux,keymap".  Based on earlier patch by Viresh Kumar <viresh.kumar@st.com>  Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | reciprocal_div.h | s | 846B | 27 | Eric Dumazet | dada1@cosmosbay.com | 1166029549 |  | [PATCH] SLAB: use a multiply instead of a divide in obj_to_index()  When some objects are allocated by one CPU but freed by another CPU we can consume lot of cycles doing divides in obj_to_index().  (Typical load on a dual processor machine where network interrupts are handled by one particular CPU (allocating skbufs), and the other CPU is running the application (consuming and freeing skbufs))  Here on one production server (dual-core AMD Opteron 285), I noticed this divide took 1.20 % of CPU_CLK_UNHALTED events in kernel.  But Opteron are quite modern cpus and the divide is much more expensive on oldest architectures :  On a 200 MHz sparcv9 machine, the division takes 64 cycles instead of 1 cycle for a multiply.  Doing some math, we can use a reciprocal multiplication instead of a divide.  If we want to compute V = (A / B)  (A and B being u32 quantities) we can instead use :  V = ((u64)A * RECIPROCAL(B)) >> 32 ;  where RECIPROCAL(B) is precalculated to ((1LL << 32) + (B - 1)) / B  Note :  I wrote pure C code for clarity. gcc output for i386 is not optimal but acceptable :  mull   0x14(%ebx) mov    %edx,%eax // part of the >> 32 xor     %edx,%edx // useless mov    %eax,(%esp) // could be avoided mov    %edx,0x4(%esp) // useless mov    (%esp),%ebx  [akpm@osdl.org: small cleanups] Signed-off-by: Eric Dumazet <dada1@cosmosbay.com> Cc: Christoph Lameter <clameter@sgi.com> Cc: David Miller <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | mmu_context.h | s | 158B | 6 | Michael S. Tsirkin | mst@redhat.com | 1253629062 |  | mm: move use_mm/unuse_mm from aio.c to mm/  Anyone who wants to do copy to/from user from a kernel thread, needs use_mm (like what fs/aio has).  Move that into mm/, to make reusing and exporting easier down the line, and make aio use it.  Next intended user, besides aio, will be vhost-net.  Acked-by: Andrea Arcangeli <aarcange@redhat.com> Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | nvram.h | s | 844B | 20 | Adrian Bunk | bunk@stusta.de | 1119741903 |  | [PATCH] drivers/char/nvram.c: possible cleanups  This patch contains the following possible cleanups: - make the needlessly global function __nvram_set_checksum static - #if 0 the unused global function nvram_set_checksum - remove the EXPORT_SYMBOL's for both functions  Signed-off-by: Adrian Bunk <bunk@stusta.de> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | netdevice.h | s | 85K | 2457 | Joe Perches | joe@perches.com | 1338410067 |  | netdevice: Update netif_dbg for CONFIG_DYNAMIC_DEBUG  Make netif_dbg use dynamic debugging whenever CONFIG_DYNAMIC_DEBUG is enabled.  commit b558c96ffa53 ("dynamic_debug: make dynamic-debug supersede DEBUG ccflag") missed updating the netif_dbg variant.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | clocksource.h | s | 10K | 314 | Yong Zhang | yong.zhang0@gmail.com | 1328150259 |  | clocksource: Get rid of clocksource_calc_mult_shift()  No one is using this, so encourage the use of clocksource_register_hz/khz(), and drop this helper.  Cc: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Yong Zhang <yong.zhang0@gmail.com> [jstultz: tweaked commit message] Signed-off-by: John Stultz <john.stultz@linaro.org>
d | unaligned |  | 10 items |  | Andrew Morton | akpm@linux-foundation.org | 1294934588 |  | include/linux/unaligned/packed_struct.h: use __packed  Cc: Will Newton <will.newton@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | comstats.h | s | 3.0K | 104 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
d | mmc |  | 21 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1340228517 |  | Merge branch 'akpm' (Andrew's patch-bomb)  * emailed from Andrew Morton <akpm@linux-foundation.org>: (21 patches)   mm/memblock: fix overlapping allocation when doubling reserved array   c/r: prctl: Move PR_GET_TID_ADDRESS to a proper place   pidns: find_new_reaper() can no longer switch to init_pid_ns.child_reaper   pidns: guarantee that the pidns init will be the last pidns process reaped   fault-inject: avoid call to random32() if fault injection is disabled   Viresh has moved   get_maintainer: Fix --help warning   mm/memory.c: fix kernel-doc warnings   mm: fix kernel-doc warnings   mm: correctly synchronize rss-counters at exit/exec   mm, thp: print useful information when mmap_sem is unlocked in zap_pmd_range   h8300: use the declarations provided by <asm/sections.h>   h8300: fix use of extinct _sbss and _ebss   xtensa: use the declarations provided by <asm/sections.h>   xtensa: use "test -e" instead of bashism "test -a"   xtensa: replace xtensa-specific _f{data,text} by _s{data,text}   memcg: fix use_hierarchy css_is_ancestor oops regression   mm, oom: fix and cleanup oom score calculations   nilfs2: ensure proper cache clearing for gc-inodes   thp: avoid atomic64_read in pmd_read_atomic for 32bit PAE   ...
f | sh_dma.h | s | 2.6K | 100 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1328115233 |  | dma: sh_dma: not all SH DMAC implementations support MEMCPY  Add a flag to allow platforms to specify, whether a DMAC instance supports the MEMCPY operation. To avoid regressions, preserve the current default.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Vinod Koul <vinod.koul@linux.intel.com>
d | netfilter_arp |  | 3 items |  | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, netfilter: Use kernel type names __u8, __u16, __u32  These types are guaranteed to be defined by <linux/types.h> for both userland and kernel, unlike u_intN_t.  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Acked-by: Patrick McHardy <kaber@trash.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ivtvfb.h | s | 1.1K | 27 | Grazvydas Ignotas | notasas@gmail.com | 1274800029 |  | fbdev: move FBIO_WAITFORVSYNC to linux/fb.h  FBIO_WAITFORVSYNC is currently implemented by matroxfb, atyfb, intelfb and more.  All of them keep redefining the same FBIO_WAITFORVSYNC macro over and over again, so move it to linux/fb.h and clean up those duplicate defines.  Signed-off-by: Grazvydas Ignotas <notasas@gmail.com> Cc: Ville Syrjala <syrjala@sci.fi> Cc: Grant Likely <grant.likely@secretlab.ca> Cc: Maik Broemme <mbroemme@plusserver.de> Cc: Petr Vandrovec <vandrove@vc.cvut.cz> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Krzysztof Helt <krzysztof.h1@poczta.fm> Cc: "Hiremath, Vaibhav" <hvaibhav@ti.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | leds.h | s | 6.2K | 184 | Shuah Khan | shuahkhan@gmail.com | 1338333751 |  | leds: add new field to led_classdev struct to save activation state  Add a new field to led_classdev to save activattion state after activate routine is successful.  This saved state is used in deactivate routine to do cleanup such as removing device files, and free memory allocated during activation.  Currently trigger_data not being null is used for this purpose.  Existing triggers will need changes to use this new field.  Signed-off-by: Shuah Khan <shuahkhan@gmail.com> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Bryan Wu <bryan.wu@canonical.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | caif |  | 3 items |  | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | f75375s.h | s | 541B | 18 | Riku Voipio | riku.voipio@iki.fi | 1194529366 |  | hwmon: (f75375s) Allow setting up fans with platform_data  Allow initializing fans on systems where BIOS does not do that by default.   - define f75375s_platform_data in new file f75375s.h  - if platform_data was provided, set fans accordingly in f75375_init()  - split set_pwm_enable() to a sysfs callback and directly usable    set_pwm_enable_direct()  Signed-off-by: Riku Voipio <riku.voipio@movial.fi> Signed-off-by: Mark M. Hoffman <mhoffman@lightlink.com>
f | static_key.h | s | 30B | 1 | Ingo Molnar | mingo@elte.hu | 1330074359 |  | static keys: Introduce 'struct static_key', static_key_true()/false() and static_key_slow_[inc||dec]()  So here's a boot tested patch on top of Jason's series that does all the cleanups I talked about and turns jump labels into a more intuitive to use facility. It should also address the various misconceptions and confusions that surround jump labels.  Typical usage scenarios:          #include <linux/static_key.h>          struct static_key key = STATIC_KEY_INIT_TRUE;          if (static_key_false(&key))                 do unlikely code         else                 do likely code  Or:          if (static_key_true(&key))                 do likely code         else                 do unlikely code  The static key is modified via:          static_key_slow_inc(&key);         ...         static_key_slow_dec(&key);  The 'slow' prefix makes it abundantly clear that this is an expensive operation.  I've updated all in-kernel code to use this everywhere. Note that I (intentionally) have not pushed through the rename blindly through to the lowest levels: the actual jump-label patching arch facility should be named like that, so we want to decouple jump labels from the static-key facility a bit.  On non-jump-label enabled architectures static keys default to likely()/unlikely() branches.  Signed-off-by: Ingo Molnar <mingo@elte.hu> Acked-by: Jason Baron <jbaron@redhat.com> Acked-by: Steven Rostedt <rostedt@goodmis.org> Cc: a.p.zijlstra@chello.nl Cc: mathieu.desnoyers@efficios.com Cc: davem@davemloft.net Cc: ddaney.cavm@gmail.com Cc: Linus Torvalds <torvalds@linux-foundation.org> Link: http://lkml.kernel.org/r/20120222085809.GA26397@elte.hu Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | etherdevice.h | s | 9.1K | 261 | stephen hemminger | shemminger@vyatta.com | 1337283395 |  | etherdevice: fix comments  Fix some minor problems in comments of etherdevice.h  * Warning is out dated, file hasn't moved or disappeared in many years and     is unlikely to do so soon.  * Capitalize Ethernet consistently since it is a proper name  * Fix descriptive comment of padding  * Spelling and grammar fix for alignment comment  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mc146818rtc.h | s | 4.2K | 102 | Bjorn Helgaas | bjorn.helgaas@hp.com | 1195094741 |  | rtc: fall back to requesting only the ports we actually use  Firmware like PNPBIOS or ACPI can report the address space consumed by the RTC.  The actual space consumed may be less than the size (RTC_IO_EXTENT) assumed by the RTC driver.  The PNP core doesn't request resources yet, but I'd like to make it do so. If/when it does, the RTC_IO_EXTENT request may fail, which prevents the RTC driver from loading.  Since we only use the RTC index and data registers at RTC_PORT(0) and RTC_PORT(1), we can fall back to requesting just enough space for those.  If the PNP core requests resources, this results in typical I/O port usage like this:      0070-0073 : 00:06		<-- PNP device 00:06 responds to 70-73       0070-0071 : rtc		<-- RTC driver uses only 70-71  instead of the current:      0070-0077 : rtc		<-- RTC_IO_EXTENT == 8  Signed-off-by: Bjorn Helgaas <bjorn.helgaas@hp.com> Cc: Alessandro Zummo <a.zummo@towertech.it> Cc: David Brownell <david-b@pacbell.net> Cc: Ralf Baechle <ralf@linux-mips.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | list_sort.h | s | 238B | 8 | Dave Chinner | david@fromorbit.com | 1263358920 |  | lib: Introduce generic list_sort function  There are two copies of list_sort() in the tree already, one in the DRM code, another in ubifs.  Now XFS needs this as well.  Create a generic list_sort() function from the ubifs version and convert existing users to it so we don't end up with yet another copy in the tree.  Signed-off-by: Dave Chinner <david@fromorbit.com> Acked-by: Dave Airlie <airlied@redhat.com> Acked-by: Artem Bityutskiy <dedekind@infradead.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | root_dev.h | s | 540B | 19 | Russell King | rmk@arm.linux.org.uk | 1152822095 |  | [PATCH] Fix broken kernel headers preventing ARM build  As a result of 894673ee6122a3ce1958e1fe096901ba5356a96b, the ARM architecture is more or less unbuildable - only one defconfig appears to build, with all others erroring out with:  	  CC      arch/arm/kernel/setup.o 	In file included from /home/rmk/git/linux-2.6-rmk/arch/arm/kernel/setup.c:22: 	/home/rmk/git/linux-2.6-rmk/include/linux/root_dev.h:7: warning: implicit declaration of function `MKDEV' 	...  Essentially, root_dev.h uses MKDEV and dev_t, but does not include any headers which provide either of these definitions.  The reason it worked previously is that linux/tty.h just happened to include the required headers for linux/root_dev.h.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
d | crush |  | 3 items |  | Sage Weil | sage@inktank.com | 1336430375 |  | crush: fix tree node weight lookup  Fix the node weight lookup for tree buckets by using a correct accessor.  Reflects ceph.git commit d287ade5bcbdca82a3aef145b92924cf1e856733.  Reviewed-by: Alex Elder <elder@inktank.com> Signed-off-by: Sage Weil <sage@inktank.com>
f | ftrace.h | s | 20K | 593 | Steven Rostedt | srostedt@redhat.com | 1337212827 |  | ftrace/x86: Have x86 ftrace use the ftrace_modify_all_code()  To remove duplicate code, have the ftrace arch_ftrace_update_code() use the generic ftrace_modify_all_code(). This requires that the default ftrace_replace_code() becomes a weak function so that an arch may override it.  Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
f | cache.h | s | 1.6K | 55 | Tim Abbott | tabbott@ksplice.com | 1267611958 |  | Rename .data.cacheline_aligned to .data..cacheline_aligned.  Signed-off-by: Tim Abbott <tabbott@ksplice.com> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Denys Vlasenko <vda.linux@googlemail.com> Signed-off-by: Michal Marek <mmarek@suse.cz>
f | via.h | s | 893B | 18 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | of_gpio.h | s | 4.3K | 135 | Grant Likely | grant.likely@secretlab.ca | 1337381316 |  | gpio: Adjust of_xlate API to support multiple GPIO chips  This patch changes the of_xlate API to make it possible for multiple gpio_chips to refer to the same device tree node.  This is useful for banked GPIO controllers that use multiple gpio_chips for a single device.  With this change the core code will try calling of_xlate on each gpio_chip that references the device_node and will return the gpio number for the first one to return 'true'.  Tested-by: Roland Stigge <stigge@antcom.de> Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | atmppp.h | s | 576B | 18 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | atm_idt77105.h | s | 892B | 21 | Jaswinder Singh Rajput | jaswinder@infradead.org | 1232066381 |  | include of <linux/types.h> is preferred over <asm/types.h>  Impact: fix 15 make headers_check warnings:  include of <linux/types.h> is preferred over <asm/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atm_nicstar.h | s | 1.2K | 42 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
d | pinctrl |  | 7 items |  | Olof Johansson | olof@lixom.net | 1336877854 |  | 
f | irqdomain.h | s | 7.2K | 167 | Paul Mundt | lethal@linux-sh.org | 1337452916 |  | irqdomain: Kill off duplicate definitions.  Presently irqdomain.h has duplicate definitions for irq_find_host() and irq_set_default_host(), presumably from merge damage. Kill off the duplicates.  Signed-off-by: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | dw_dmac.h | s | 3.1K | 90 | Viresh Kumar | viresh.kumar@st.com | 1329914739 |  | dmaengine/dw_dmac: Remove unused fields in struct dw_dma_slave  Signed-off-by: Viresh Kumar <viresh.kumar@st.com> Signed-off-by: Vinod Koul <vinod.koul@linux.intel.com>
f | atmel_serial.h | s | 5.9K | 117 | Guennadi Liakhovetski | lg@denx.de | 1202130999 |  | [ARM] 4660/3: at91: allow selecting UART for early kernel messages  Currently early kernel messages, i.e., those from uncompression, go to the debugging UART. And if it is enabled in the platform configuration, but not initialized by the bootloader, the machine hangs, waiting for UART status change. Besides, having those messages on another UART - typically the console UART - may be preferrable. This patch allows selecting the UART in kernel configuration.  Signed-off-by: Guennadi Liakhovetski <lg@denx.de> Acked-by: Andrew Victor <linux@maxim.org.za> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | acpi.h | s | 10K | 307 | Linus Torvalds | torvalds@linux-foundation.org | 1333151139 |  | Merge branch 'release' of git://git.kernel.org/pub/scm/linux/kernel/git/lenb/linux  Pull ACPI & Power Management changes from Len Brown:  - ACPI 5.0 after-ripples, ACPICA/Linux divergence cleanup  - cpuidle evolving, more ARM use  - thermal sub-system evolving, ditto  - assorted other PM bits  Fix up conflicts in various cpuidle implementations due to ARM cpuidle cleanups (ARM at91 self-refresh and cpu idle code rewritten into "standby" in asm conflicting with the consolidation of cpuidle time keeping), trivial SH include file context conflict and RCU tracing fixes in generic code.  * 'release' of git://git.kernel.org/pub/scm/linux/kernel/git/lenb/linux: (77 commits)   ACPI throttling: fix endian bug in acpi_read_throttling_status()   Disable MCP limit exceeded messages from Intel IPS driver   ACPI video: Don't start video device until its associated input device has been allocated   ACPI video: Harden video bus adding.   ACPI: Add support for exposing BGRT data   ACPI: export acpi_kobj   ACPI: Fix logic for removing mappings in 'acpi_unmap'   CPER failed to handle generic error records with multiple sections   ACPI: Clean redundant codes in scan.c   ACPI: Fix unprotected smp_processor_id() in acpi_processor_cst_has_changed()   ACPI: consistently use should_use_kmap()   PNPACPI: Fix device ref leaking in acpi_pnp_match   ACPI: Fix use-after-free in acpi_map_lsapic   ACPI: processor_driver: add missing kfree   ACPI, APEI: Fix incorrect APEI register bit width check and usage   Update documentation for parameter *notrigger* in einj.txt   ACPI, APEI, EINJ, new parameter to control trigger action   ACPI, APEI, EINJ, limit the range of einj_param   ACPI, APEI, Fix ERST header length check   cpuidle: power_usage should be declared signed integer   ...
f | soundcard.h | s | 45K | 1143 | David Howells | dhowells@redhat.com | 1323788869 |  | UAPI: Don't have a #elif clause in a __KERNEL__ guard in linux/soundcard.h  Don't have a #elif clause in a __KERNEL__ guard in linux/soundcard.h to make parsing easier.  Signed-off-by: David Howells <dhowells@redhat.com>
f | key-type.h | s | 3.9K | 103 | David Howells | dhowells@redhat.com | 1321482932 |  | KEYS: Give key types their own lockdep class for key->sem  Give keys their own lockdep class to differentiate them from each other in case a key of one type has to refer to a key of another type.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Mimi Zohar <zohar@us.ibm.com> Signed-off-by: James Morris <jmorris@namei.org>
f | circ_buf.h | s | 1.0K | 29 | David Howells | dhowells@redhat.com | 1269473482 |  | Document Linux's circular buffering capabilities  Document the circular buffering capabilities available in Linux.  Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com> Reviewed-by: Randy Dunlap <rdunlap@xenotime.net> Reviewed-by: Stefan Richter <stefanr@s5r6.in-berlin.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | nfs_xdr.h | s | 33K | 1264 | Trond Myklebust | Trond.Myklebust@netapp.com | 1338935927 |  | NFS: Fix a commit bug  The new commit code fails to copy the verifier into the wb_verf field of _all_ the nfs_page structures; it only copies it into the first entry. The consequence is that most requests end up failing to match in nfs_commit_release.  Fix is to copy the verifier into the req->wb_verf field in nfs_write_completion.  Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com> Cc: Fred Isaman <iisaman@netapp.com>
f | prctl.h | s | 5.0K | 125 | Cyrill Gorcunov | gorcunov@openvz.org | 1339105435 |  | c/r: prctl: add ability to get clear_tid_address  Zero is written at clear_tid_address when the process exits.  This functionality is used by pthread_join().  We already have sys_set_tid_address() to change this address for the current task but there is no way to obtain it from user space.  Without the ability to find this address and dump it we can't restore pthread'ed apps which call pthread_join() once they have been restored.  This patch introduces the PR_GET_TID_ADDRESS prctl option which allows the current process to obtain own clear_tid_address.  This feature is available iif CONFIG_CHECKPOINT_RESTORE is set.  [akpm@linux-foundation.org: fix prctl numbering] Signed-off-by: Andrew Vagin <avagin@openvz.org> Signed-off-by: Cyrill Gorcunov <gorcunov@openvz.org> Cc: Pedro Alves <palves@redhat.com> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Pavel Emelyanov <xemul@parallels.com> Cc: Tejun Heo <tj@kernel.org> Acked-by: Kees Cook <keescook@chromium.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | spinlock_types_up.h | s | 726B | 25 | Thomas Gleixner | tglx@linutronix.de | 1260831332 |  | locking: Convert raw_rwlock to arch_rwlock  Not strictly necessary for -rt as -rt does not have non sleeping rwlocks, but it's odd to not have a consistent naming convention.  No functional change.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Ingo Molnar <mingo@elte.hu> Cc: linux-arch@vger.kernel.org
f | elfcore-compat.h | s | 1.2K | 49 | Roland McGrath | roland@redhat.com | 1204301197 |  | elfcore-compat fix uid/gid types  I overlooked the difference between __kernel_uid_t and uid_t when defining struct compat_elf_prpsinfo.  The result is a regression in 32-bit core dumps on x86_64, where the NT_PRPSINFO note has the wrong size and layout. This patch fixes it.  Signed-off-by: Roland McGrath <roland@redhat.com> Acked-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | omap3isp.h | s | 20K | 584 | Sakari Ailus | sakari.ailus@iki.fi | 1314632331 |  | [media] omap3isp: ccdc: Use generic frame sync event instead of private HS_VS event  The ccdc block in the omap3isp produces events whenever it starts receiving a new frame. A private HS_VS event was used for this previously. Now, the generic V4L2_EVENT_FRAME_SYNC event is being used for the purpose.  This patch also provides the frame sequence number to user space.  Signed-off-by: Sakari Ailus <sakari.ailus@iki.fi> Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | padata.h | s | 6.4K | 179 | Steffen Klassert | steffen.klassert@secunet.com | 1331717156 |  | padata: Fix race on sequence number wrap  When padata_do_parallel() is called from multiple cpus for the same padata instance, we can get object reordering on sequence number wrap because testing for sequence number wrap and reseting the sequence number must happen atomically but is implemented with two atomic operations. This patch fixes this by converting the sequence number from atomic_t to an unsigned int and protect the access with a spin_lock. As a side effect, we get rid of the sequence number wrap handling because the seqence number wraps back to null now without the need to do anything.  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
f | kobj_map.h | s | 506B | 14 | Robert P. J. Day | rpjday@crashcourse.ca | 1268663379 |  | kobj: add comment and multiple inclusion protection  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | amigaffs.h | s | 2.9K | 126 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | apm_bios.h | s | 5.5K | 194 | Adam Jackson | ajax@redhat.com | 1197948496 |  | apm_event{,info}_t are userspace types  These types define the size of data read from /dev/apm_bios.  They should not be hidden behind #ifdef __KERNEL__.  This is killing my xserver compile, apm_event_t is used in the xserver source.  Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atmel-ssc.h | s | 9.1K | 279 | Hans-Christian Egtvedt | hcegtvedt@atmel.com | 1192635767 |  | Driver for the Atmel on-chip SSC on AT32AP and AT91  The Synchronous Serial Controller (SSC) on Atmel microprocessors are capable of tranceiving many frame based protocols, like I2S.  Tested on the AT32AP7000/ATSTK1000.  This driver is used in the ALSA sound driver for the AT73C213 external DAC on the ATSTK1000 development board for AVR32.  This sound driver will be submitted soon.  Hardware documentation can be found in the AT32AP7000 data sheet, which can be downloaded from http://www.atmel.com/dyn/products/datasheets.asp?family_id=682  [akpm@linux-foundation.org: init spinlock at compile time] Signed-off-by: Hans-Christian Egtvedt <hcegtvedt@atmel.com> Acked-by: Haavard Skinnemoen <hskinnemoen@atmel.com> Cc: David Brownell <david-b@pacbell.net> Cc: Andrew Victor <andrew@sanpeople.com> Cc: Patrice Vilchez <patrice.vilchez@rfo.atmel.com> Cc: Nicolas Ferre <nicolas.ferre@rfo.atmel.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | btree-type.h | s | 3.9K | 126 | Joern Engel | joern@logfs.org | 1258744419 |  | [LogFS] add new flash file system  This is a new flash file system. See Documentation/filesystems/logfs.txt  Signed-off-by: Joern Engel <joern@logfs.org>
f | utime.h | s | 152B | 8 | Arnd Bergmann | arnd@arndb.de | 1238087654 |  | make exported headers use strict posix types  A number of standard posix types are used in exported headers, which is not allowed if __STRICT_KERNEL_NAMES is defined. In order to get rid of the non-__STRICT_KERNEL_NAMES part and to make sane headers the default, we have to change them all to safe types.  There are also still some leftovers in reiserfs_fs.h, elfcore.h and coda.h, but these files have not compiled in user space for a long time.  This leaves out the various integer types ({u_,u,}int{8,16,32,64}_t), which we take care of separately.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Cc: David Airlie <airlied@linux.ie> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Cc: netdev@vger.kernel.org Cc: linux-ppp@vger.kernel.org Cc: Jaroslav Kysela <perex@perex.cz> Cc: Takashi Iwai <tiwai@suse.de> Cc: David Woodhouse <dwmw2@infradead.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | netdev_features.h | s | 5.8K | 131 | Ben Greear | greearb@candelatech.com | 1330076527 |  | net: Support RX-ALL feature flag.  This flag requests that network devices pass all received frames up the stack, even ones with errors such as invalid FCS (frame check sum).  This will allow sniffers to see bad packets and perhaps give the user some idea how to fix the problem.  Signed-off-by: Ben Greear <greearb@candelatech.com> Tested-by: Aaron Brown <aaron.f.brown@intel.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | tty_driver.h | s | 14K | 392 | Jiri Slaby | jslaby@suse.cz | 1331235531 |  | TTY: tty_driver, document tty->ops->shutdown limitation  Note that tty->ops->shutdown is called from whatever context the user drops the last tty reference from. E.g. if one takes a reference in an ISR, tty close happens on other CPU and the final tty put is from the ISR, tty->ops->shutdown will be called from that hard irq context.  We would have a problem in vt if we start using tty refcounting from other contexts than user there. It is because vt's shutdown uses mutexes. This is yet to be fixed.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Reported-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | buffer_head.h | s | 11K | 309 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | coff.h | s | 12K | 287 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
d | netfilter |  | 91 items |  | Hans Schillstrom | hans@schillstrom.com | 1339073581 |  | netfilter: xt_HMARK: fix endianness and provide consistent hashing  This patch addresses two issues:  a) Fix usage of u32 and __be32 that causes endianess warnings via sparse. b) Ensure consistent hashing in a cluster that is composed of big and    little endian systems. Thus, we obtain the same hash mark in an    heterogeneous cluster.  Reported-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Hans Schillstrom <hans@schillstrom.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | ath9k_platform.h | s | 1.2K | 31 | Gabor Juhos | juhosg@openwrt.org | 1308773397 |  | ath9k: add external_reset callback to ath9k_platfom_data for AR9330  The patch adds a callback to ath9k_platform_data. If the callback is provided by the platform code, then it can be used to hard reset the WMAC device.  The callback is required for doing a hard reset of the AR9330 chips to get them working again after a hang.  Signed-off-by: Gabor Juhos <juhosg@openwrt.org> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | i7300_idle.h | s | 1.9K | 69 | Len Brown | len.brown@intel.com | 1243558360 |  | i7300_idle: allow testing on i5000-series hardware w/o re-compile  Testing the i7300_idle driver on i5000-series hardware required an edit to i7300_idle.h to "#define SUPPORT_I5000 1" and a re-build of both i7300_idle and ioat_dma.  Replace that build-time scheme with a load-time module parameter: "7300_idle.forceload=1" to make it easier to test the driver on hardware that while not officially validated, works fine and is much more commonly available.  By default (no modparam) the driver will continue to load only on the i7300.  Note that ioat_dma runs a copy of i7300_idle's probe routine to know to reserve an IOAT channel for i7300_idle. This change makes ioat_dma do that always on the i5000, just like it does on the i7300.  Signed-off-by: Len Brown <len.brown@intel.com> Acked-by: Andrew Henroid <andrew.d.henroid@intel.com>
f | gigaset_dev.h | s | 1.3K | 30 | Tilman Schmidt | tilman@imap.cc | 1260333041 |  | gigaset: documentation amendments  Various additions and improvements to the Gigaset driver's README file, and added comments to its userspace visible include file.  Signed-off-by: Tilman Schmidt <tilman@imap.cc> Signed-off-by: David S. Miller <davem@davemloft.net>
f | kthread.h | s | 4.2K | 114 | Tejun Heo | tj@kernel.org | 1321907543 |  | freezer: implement and use kthread_freezable_should_stop()  Writeback and thinkpad_acpi have been using thaw_process() to prevent deadlock between the freezer and kthread_stop(); unfortunately, this is inherently racy - nothing prevents freezing from happening between thaw_process() and kthread_stop().  This patch implements kthread_freezable_should_stop() which enters refrigerator if necessary but is guaranteed to return if kthread_stop() is invoked.  Both thaw_process() users are converted to use the new function.  Note that this deadlock condition exists for many of freezable kthreads.  They need to be converted to use the new should_stop or freezable workqueue.  Tested with synthetic test case.  Signed-off-by: Tejun Heo <tj@kernel.org> Acked-by: Henrique de Moraes Holschuh <ibm-acpi@hmh.eng.br> Cc: Jens Axboe <axboe@kernel.dk> Cc: Oleg Nesterov <oleg@redhat.com>
f | uio_driver.h | s | 3.5K | 111 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103952 |  | include: replace linux/module.h with "struct module" wherever possible  The <linux/module.h> pretty much brings in the kitchen sink along with it, so it should be avoided wherever reasonably possible in terms of being included from other commonly used <linux/something.h> files, as it results in a measureable increase on compile times.  The worst culprit was probably device.h since it is used everywhere. This file also had an implicit dependency/usage of mutex.h which was masked by module.h, and is also fixed here at the same time.  There are over a dozen other headers that simply declare the struct instead of pulling in the whole file, so follow their lead and simply make it a few more.  Most of the implicit dependencies on module.h being present by these headers pulling it in have been now weeded out, so we can finally make this change with hopefully minimal breakage.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | async_tx.h | s | 6.8K | 186 | Dan Williams | dan.j.williams@intel.com | 1252456970 |  | dmaengine: add fence support  Some engines optimize operation by reading ahead in the descriptor chain such that descriptor2 may start execution before descriptor1 completes. If descriptor2 depends on the result from descriptor1 then a fence is required (on descriptor2) to disable this optimization.  The async_tx api could implicitly identify dependencies via the 'depend_tx' parameter, but that would constrain cases where the dependency chain only specifies a completion order rather than a data dependency.  So, provide an ASYNC_TX_FENCE to explicitly identify data dependencies.  Signed-off-by: Dan Williams <dan.j.williams@intel.com>
f | cb710.h | s | 5.7K | 182 | Sebastian Andrzej Siewior | sebastian@breakpoint.cc | 1249036126 |  | cb710: use SG_MITER_TO_SG/SG_MITER_FROM_SG  the code allready uses flush_kernel_dcache_page(). This patch updates the driver to the recent sg API changes which require that either SG_MITER_TO_SG or SG_MITER_FROM_SG is set. SG_MITER_TO_SG calls flush_kernel_dcache_page() in sg_mitter_stop()  Signed-off-by: Sebastian Andrzej Siewior <sebastian@breakpoint.cc> Acked-by: Micha≈Ç Miros≈Çaw <mirq-linux@rere.qmqm.pl> Signed-off-by: Pierre Ossman <pierre@ossman.eu>
f | rio.h | s | 15K | 412 | Alexandre Bounine | alexandre.bounine@idt.com | 1338511771 |  | rapidio: add DMA engine support for RIO data transfers  Adds DMA Engine framework support into RapidIO subsystem.  Uses DMA Engine DMA_SLAVE interface to generate data transfers to/from remote RapidIO target devices.  Introduces RapidIO-specific wrapper for prep_slave_sg() interface with an extra parameter to pass target specific information.  Uses scatterlist to describe local data buffer.  Address flat data buffer on a remote side.  Signed-off-by: Alexandre Bounine <alexandre.bounine@idt.com> Cc: Dan Williams <dan.j.williams@intel.com> Acked-by: Vinod Koul <vinod.koul@linux.intel.com> Cc: Li Yang <leoli@freescale.com> Cc: Matt Porter <mporter@kernel.crashing.org> Cc: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | inotify.h | s | 3.3K | 74 | Eric Paris | eparis@redhat.com | 1280326729 |  | inotify: force inotify and fsnotify use same bits  inotify uses bits called IN_* and fsnotify uses bits called FS_*.  These need to line up.  This patch adds build time checks to make sure noone can change these bits so they are not the same.  Signed-off-by: Eric Paris <eparis@redhat.com>
f | n_r3964.h | s | 5.1K | 185 | Justin P. Mattock | justinmattock@gmail.com | 1287392594 |  | Update broken web addresses in the kernel.  The patch below updates broken web addresses in the kernel  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Cc: Maciej W. Rozycki <macro@linux-mips.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Finn Thain <fthain@telegraphics.com.au> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Matt Turner <mattst88@gmail.com> Cc: Dimitry Torokhov <dmitry.torokhov@gmail.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Acked-by: Ben Pfaff <blp@cs.stanford.edu> Acked-by: Hans J. Koch <hjk@linutronix.de> Reviewed-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | tca6416_keypad.h | s | 847B | 30 | Sriramakrishnan Govindarajan | srk@ti.com | 1272955842 |  | Input: add keypad driver for keys interfaced to TCA6416  This patch implements a simple Keypad driver that functions as an I2C client. It handles key press events for keys connected to TCA6416 I2C based IO expander.  Signed-off-by: Sriramakrishnan <srk@ti.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | key.h | s | 9.8K | 282 | Oleg Nesterov | oleg@redhat.com | 1337825491 |  | keys: kill the dummy key_replace_session_keyring()  After the previouse change key_replace_session_keyring() becomes a nop. Remove the dummy definition in key.h and update the callers in arch/*/kernel/signal.c.  Signed-off-by: Oleg Nesterov <oleg@redhat.com> Acked-by: David Howells <dhowells@redhat.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Richard Kuo <rkuo@codeaurora.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Alexander Gordeev <agordeev@redhat.com> Cc: Chris Zankel <chris@zankel.net> Cc: David Smith <dsmith@redhat.com> Cc: "Frank Ch. Eigler" <fche@redhat.com> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Larry Woodman <lwoodman@redhat.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Tejun Heo <tj@kernel.org> Cc: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | clk.h | s | 8.9K | 280 | Arnd Bergmann | arnd@arndb.de | 1336749180 |  | Merge branch 'depends/rmk/clkdev' into next/clock  * depends/rmk/clkdev:   CLKDEV: provide helpers for common clock framework   ARM: 7392/1: CLKDEV: Optimize clk_find()   ARM: 7376/1: clkdev: Implement managed clk_get()
f | ip6_tunnel.h | s | 1.1K | 29 | Eric Dumazet | eric.dumazet@gmail.com | 1316544600 |  | ip6_tunnel: add optional fwmark inherit  Add IP6_TNL_F_USE_ORIG_FWMARK to ip6_tunnel, so that ip6_tnl_xmit2() makes a route lookup taking into account skb->fwmark and doesnt cache lookup result.  This permits more flexibility in policies and firewall setups.  To setup such a tunnel, "fwmark inherit" option should be added to "ip -f inet6 tunnel" command.  Reported-by: Anders Franzen <Anders.Franzen@ericsson.com> CC: Hans Schillstr√∂m <hans.schillstrom@ericsson.com> Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | elf-fdpic.h | s | 2.8K | 61 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233339479 |  | headers_check fix: linux/elf-fdpic.h  fix the following 'make headers_check' warning:    usr/include/linux/elf-fdpic.h:62: extern's make no sense in userspace  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | dm-ioctl.h | s | 9.7K | 294 | Alasdair G Kergon | agk@redhat.com | 1320092344 |  | dm table: add immutable feature  Introduce DM_TARGET_IMMUTABLE to indicate that the target type cannot be mixed with any other target type, and once loaded into a device, it cannot be replaced with a table containing a different type.  The thin provisioning pool device will use this.  Signed-off-by: Alasdair G Kergon <agk@redhat.com>
f | user.h | s | 22B | 1 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | scc.h | s | 7.1K | 196 | David Woodhouse | dwmw2@infradead.org | 1146052576 |  | Don't include linux/config.h from anywhere else in include/  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | lcm.h | s | 154B | 5 | Martin K. Petersen | martin.petersen@oracle.com | 1268653679 |  | block: Fix overrun in lcm() and move it to lib  lcm() was defined to take integer-sized arguments.  The supplied arguments are multiplied, however, causing us to overflow given sufficiently large input.  That in turn led to incorrect optimal I/O size reporting in some cases (RAID over RAID).  Switch lcm() over to unsigned long similar to gcd() and move the function from blk-settings.c to lib.  Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com> Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
f | io-mapping.h | s | 3.7K | 137 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | bfin_mac.h | s | 559B | 25 | Mike Frysinger | vapier@gentoo.org | 1294695074 |  | netdev: bfin_mac: let boards set vlan masks  Signed-off-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | i2c-pca-platform.h | s | 402B | 10 | Wolfram Sang | w.sang@pengutronix.de | 1238272485 |  | i2c-algo-pca: Rework waiting for a free bus  Waiting for a free bus now accepts the timeout value in jiffies and does proper checking using time_before.  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: Jean Delvare <khali@linux-fr.org>
d | extcon |  | 1 items |  | MyungJoo Ham | myungjoo.ham@samsung.com | 1334938922 |  | Extcon: support generic GPIO extcon driver  The generic GPIO extcon driver (an external connector device based on GPIO control) and imported from Android kernel.  switch: switch class and GPIO drivers. (splitted) Author: Mike Lockwood <lockwood@android.com>  switch: gpio: Don't call request_irq with interrupts disabled Author: Arve Hj√∏nnev√•g <arve@android.com>  switch_gpio: Add missing #include <linux/interrupt.h> Author: Mike Lockwood <lockwood@android.com>  Signed-off-by: MyungJoo Ham <myungjoo.ham@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Reviewed-by: Mark Brown <broonie@opensource.wolfsonmicro.com>  -- Changed from v7: - Style updates mentioned by Stephen Boyd and Mark Brown Changed from v5: - Splitted at v5 from the main extcon patch. - Added debounce time for irq handlers. - Use request_any_context_irq instead of request_irq - User needs to specify irq flags for GPIO interrupts (was fixed to IRQF_TRIGGER_LOW before) - Use module_platform_driver(). Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | atmdev.h | s | 16K | 425 | Linus Torvalds | torvalds@linux-foundation.org | 1332610897 |  | 
f | quota.h | s | 14K | 372 | Jan Kara | jack@suse.cz | 1326370149 |  | quota: Pass information that quota is stored in system file to userspace  Quota tools need to know whether quota is stored in a system file or in classical aquota.{user||group} files. So pass this information as a flag in GETINFO quotactl.  Signed-off-by: Jan Kara <jack@suse.cz>
f | nmi.h | s | 1.3K | 50 | Cong Wang | xiyou.wangcong@gmail.com | 1332547111 |  | nmi watchdog: do not use cpp symbol in Kconfig  ARCH_HAS_NMI_WATCHDOG is a macro defined by arch, but config HARDLOCKUP_DETECTOR depends on it.  This is wrong, ARCH_HAS_NMI_WATCHDOG has to be a Kconfig config, and arch's need it should select it explicitly.  Signed-off-by: WANG Cong <xiyou.wangcong@gmail.com> Acked-by: Don Zickus <dzickus@redhat.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Cc: David Howells <dhowells@redhat.com> Cc: David Miller <davem@davemloft.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | netrom.h | s | 744B | 29 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, ax25: Add missing #include to <linux/netrom.h>, <linux/rose.h>  These headers use the ax25_address type defined in <linux/ax25.h>.  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Acked-by: Ralf Baechle <ralf@linux-mips.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | memcontrol.h | s | 10K | 351 | Hugh Dickins | hughd@google.com | 1338333748 |  | mm/memcg: apply add/del_page to lruvec  Take lruvec further: pass it instead of zone to add_page_to_lru_list() and del_page_from_lru_list(); and pagevec_lru_move_fn() pass lruvec down to its target functions.  This cleanup eliminates a swathe of cruft in memcontrol.c, including mem_cgroup_lru_add_list(), mem_cgroup_lru_del_list() and mem_cgroup_lru_move_lists() - which never actually touched the lists.  In their place, mem_cgroup_page_lruvec() to decide the lruvec, previously a side-effect of add, and mem_cgroup_update_lru_size() to maintain the lru_size stats.  Whilst these are simplifications in their own right, the goal is to bring the evaluation of lruvec next to the spin_locking of the lrus, in preparation for a future patch.  Signed-off-by: Hugh Dickins <hughd@google.com> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Acked-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Acked-by: Michal Hocko <mhocko@suse.cz> Acked-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Cc: Johannes Weiner <hannes@cmpxchg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | phy.h | s | 16K | 465 | David Daney | david.daney@cavium.com | 1337144352 |  | netdev/phy: Make get_phy_id() static and quit EXPORTing it.  This function is only referenced from within phy_device.c, so there is no reason to export it.  In fact, we can make it static.  Signed-off-by: David Daney <david.daney@cavium.com> Acked-by: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>
d | tc_ematch |  | 5 items |  | Micha≈Ç Miros≈Çaw | mirq-linux@rere.qmqm.pl | 1310679959 |  | net: remove SK_ROUTE_CAPS from meta ematch  Remove it, as it indirectly exposes netdev features. It's not used in iproute2 (2.6.38) - is anything else using its interface?  Signed-off-by: Micha≈Ç Miros≈Çaw <mirq-linux@rere.qmqm.pl> Signed-off-by: David S. Miller <davem@davemloft.net>
f | acpi_pmtmr.h | s | 635B | 26 | Thomas Gleixner | tglx@linutronix.de | 1287170339 |  | x86: Remove stale pmtimer_64.c  This file is unused since the apic unification in 2.6.29, but nobody noticed.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | device_cgroup.h | s | 597B | 18 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103946 |  | device_cgroup.h: delete needless include <linux/module.h>  There is nothing modular in this file, and no reason to drag in all the extra headers that module.h brings with it, since it just slows down compiles.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | can.h | s | 3.2K | 94 | Marc Kleine-Budde | mkl@pengutronix.de | 1318893766 |  | can: remove references to berlios mailinglist  The BerliOS project, which currently hosts our mailinglist, will close with the end of the year. Now take the chance and remove all occurrences of the mailinglist address from the source files.  Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | pata_arasan_cf_data.h | s | 1.3K | 45 | Viresh Kumar | viresh.linux@gmail.com | 1340228376 |  | Viresh has moved  viresh.kumar@st.com email-id doesn't exist anymore as I have left the company.  Replace ST's id with viresh.linux@gmail.com.  It also updates .mailmap file to fix address for 'git shortlog'  Signed-off-by: Viresh Kumar <viresh.linux@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | elf-em.h | s | 1.8K | 50 | Mark Salter | msalter@redhat.com | 1317944839 |  | add ELF machine define for TI C6X DSPs  Signed-off-by: Mark Salter <msalter@redhat.com> Acked-by: Arnd Bergmann <arnd@arndb.de>
f | kconfig.h | s | 1.5K | 39 | Paul Gortmaker | paul.gortmaker@windriver.com | 1334280958 |  | kconfig: fix IS_ENABLED to not require all options to be defined  Using IS_ENABLED() within C (vs.  within CPP #if statements) in its current form requires us to actually define every possible bool/tristate Kconfig option twice (__enabled_* and __enabled_*_MODULE variants).  This results in a huge autoconf.h file, on the order of 16k lines for a x86_64 defconfig.  Fixing IS_ENABLED to be able to work on the smaller subset of just things that we really have defined is step one to fixing this.  Which means it has to not choke when fed non-enabled options, such as:    include/linux/netdevice.h:964:1: warning: "__enabled_CONFIG_FCOE_MODULE" is not defined [-Wundef]  The original prototype of how to implement a C and preprocessor compatible way of doing this came from the Google+ user "comex ." in response to Linus' crowdsourcing challenge for a possible improvement on his earlier C specific solution:  	#define config_enabled(x)       (__stringify(x)[0] == '1')  In this implementation, I've chosen variable names that hopefully make how it works more understandable.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | iommu-helper.h | s | 911B | 28 | Anton Blanchard | anton@samba.org | 1281411905 |  | iommu: inline iommu_num_pages  A profile of a network benchmark showed iommu_num_pages rather high up:       0.52%  iommu_num_pages  Looking at the profile, an integer divide is taking almost all of the time:        %          :      c000000000376ea4 <.iommu_num_pages>:     1.93 :      c000000000376ea4:       fb e1 ff f8     std     r31,-8(r1)     0.00 :      c000000000376ea8:       f8 21 ff c1     stdu    r1,-64(r1)     0.00 :      c000000000376eac:       7c 3f 0b 78     mr      r31,r1     3.86 :      c000000000376eb0:       38 84 ff ff     addi    r4,r4,-1     0.00 :      c000000000376eb4:       38 05 ff ff     addi    r0,r5,-1     0.00 :      c000000000376eb8:       7c 84 2a 14     add     r4,r4,r5    46.95 :      c000000000376ebc:       7c 00 18 38     and     r0,r0,r3    45.66 :      c000000000376ec0:       7c 84 02 14     add     r4,r4,r0     0.00 :      c000000000376ec4:       7c 64 2b 92     divdu   r3,r4,r5     0.00 :      c000000000376ec8:       38 3f 00 40     addi    r1,r31,64     0.00 :      c000000000376ecc:       eb e1 ff f8     ld      r31,-8(r1)     1.61 :      c000000000376ed0:       4e 80 00 20     blr  Since every caller of iommu_num_pages passes in a constant power of two we can inline this such that the divide is replaced by a shift. The entire function is only a few instructions once optimised, so it is a good candidate for inlining overall.  Signed-off-by: Anton Blanchard <anton@samba.org> Cc: Akinobu Mita <akinobu.mita@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | stackprotector.h | s | 285B | 13 | Ingo Molnar | mingo@elte.hu | 1211811332 |  | x86: fix the stackprotector canary of the boot CPU  Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | cgroupstats.h | s | 2.1K | 60 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233339281 |  | headers_check fix: linux/cgroupstats.h  fix the following 'make headers_check' warning:    usr/include/linux/cgroupstats.h:31: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
d | amba |  | 10 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1337963519 |  | Merge branch 'next' of git://git.infradead.org/users/vkoul/slave-dma  Pull slave-dmaengine updates from Vinod Koul:  "Nothing exciting this time, odd fixes in a bunch of drivers"  * 'next' of git://git.infradead.org/users/vkoul/slave-dma:   dmaengine: at_hdmac: take maxburst from slave configuration   dmaengine: at_hdmac: remove ATC_DEFAULT_CTRLA constant   dmaengine: at_hdmac: remove some at_dma_slave comments   dma: imx-sdma: make channel0 operations atomic   dmaengine: Fixup dmaengine_prep_slave_single() to be actually useful   dmaengine: Use dma_sg_len(sg) instead of sg->length   dmaengine: Use sg_dma_address instead of sg_phys   DMA: PL330: Remove duplicate header file inclusion   dma: imx-sdma: keep the callbacks invoked in the tasklet   dmaengine: dw_dma: add Device Tree probing capability   dmaengine: dw_dmac: Add clk_{un}prepare() support   dma/amba-pl08x: add support for the Nomadik variant   dma/amba-pl08x: check for terminal count status only
f | pm.h | s | 28K | 653 | Rafael J. Wysocki | rjw@sisk.pl | 1335900518 |  | PM / Runtime: Remove device fields related to suspend time, v2  After the previous changes in default_stop_ok() and default_power_down_ok() for PM domains, there are two fields in struct dev_pm_info that aren't necessary any more,  suspend_time and max_time_suspended_ns.  Remove those fields along with all of the code that accesses them, which simplifies the runtime PM framework quite a bit.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | hwmon.h | s | 836B | 25 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | m48t86.h | s | 465B | 15 | Andrew Morton | akpm@osdl.org | 1149535757 |  | [PATCH] m48t86: ia64 build fix  From: Andrew Morton <akpm@osdl.org>  drivers/rtc/rtc-m48t86.c: In function `m48t86_rtc_read_time': drivers/rtc/rtc-m48t86.c:51: error: structure has no member named `ia64_mv' drivers/rtc/rtc-m48t86.c:55: error: structure has no member named `ia64_mv' drivers/rtc/rtc-m48t86.c:56: error: structure has no member named `ia64_mv' drivers/rtc/rtc-m48t86.c:57: error: structure has no member named `ia64_mv' drivers/rtc/rtc-m48t86.c:58: error: structure has no member named `ia64_mv' drivers/rtc/rtc-m48t86.c:60: error: structure has no member named `ia64_mv'  readb() and writeb() are macros on ia64.  Cc: Alessandro Zummo <a.zummo@towertech.it> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | auto_fs4.h | s | 4.0K | 134 | Ian Kent | raven@themaw.net | 1295140065 |  | autofs4: Bump version  Increase the autofs module sub-version so we can tell what kernel implementation is being used from user space debug logging.  Signed-off-by: Ian Kent <raven@themaw.net> Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | dlm_plock.h | s | 1.1K | 44 | David Teigland | teigland@redhat.com | 1306165626 |  | dlm: make plock operation killable  Allow processes blocked on plock requests to be interrupted when they are killed.  This leaves the problem of cleaning up the lock state in userspace.  This has three parts:  1. Add a flag to unlock operations sent to userspace indicating the file is being closed.  Userspace will then look for and clear any waiting plock operations that were abandoned by an interrupted process.  2. Queue an unlock-close operation (like in 1) to clean up userspace from an interrupted plock request.  This is needed because the vfs will not send a cleanup-unlock if it sees no locks on the file, which it won't if the interrupted operation was the only one.  3. Do not use replies from userspace for unlock-close operations because they are unnecessary (they are just cleaning up for the process which did not make an unlock call).  This also simplifies the new unlock-close generated from point 2.  Signed-off-by: David Teigland <teigland@redhat.com>
f | mdio-gpio.h | s | 655B | 22 | Srinivas Kandagatla | srinivas.kandagatla@st.com | 1321394177 |  | mdio-gpio: Add reset functionality to mdio-gpio driver(v2).  This patch adds phy reset functionality to mdio-gpio driver. Now mdio_gpio_platform_data has new member as function pointer which can be filled at the bsp level for a callback from phy infrastructure. Also the mdio-bitbang driver fills-in the reset function of mii_bus structure.  Without this patch the bsp level code has to takecare of the reseting PHY's on the bus, which become bit hacky for every bsp and phy-infrastructure is ignored aswell.  Signed-off-by: Srinivas Kandagatla <srinivas.kandagatla@st.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cuda.h | s | 1.0K | 35 | David Howells | dhowells@redhat.com | 1323768405 |  | UAPI: Guard linux/cuda.h  Place reinclusion guards on linux/cuda.h otherwise the UAPI splitter script won't insert a #include to make the kernel header include the UAPI header.  Signed-off-by: David Howells <dhowells@redhat.com>
f | kref.h | s | 2.9K | 88 | James Bottomley | jbottomley@parallels.com | 1326843651 |  | Fix compile breakage with kref.h  This set of build failures just started appearing on parisc:    In file included from drivers/input/serio/serio_raw.c:12:   include/linux/kref.h: In function 'kref_get':   include/linux/kref.h:40: error: 'TAINT_WARN' undeclared (first use in this function)   include/linux/kref.h:40: error: (Each undeclared identifier is reported only once   include/linux/kref.h:40: error: for each function it appears in.)   include/linux/kref.h: In function 'kref_sub':   include/linux/kref.h:65: error: 'TAINT_WARN' undeclared (first use in this function)  It happens because TAINT_WARN is defined in kernel.h and this particular compile doesn't seem to include it (no idea why it's just manifesting .. probably some #include file untangling exposed it).  Fix by adding    #include <linux/kernel.h>  to linux/kref.h  Signed-off-by: James Bottomley <JBottomley@Parallels.com> Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ncp_mount.h | s | 2.1K | 58 | Al Viro | viro@zeniv.linux.org.uk | 1294880623 |  | move internal-only parts of ncpfs headers to fs/ncpfs  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | ipsec.h | s | 884B | 37 | Diego Beltrami | diego.beltrami@gmail.com | 1159947069 |  | [XFRM]: BEET mode  This patch introduces the BEET mode (Bound End-to-End Tunnel) with as specified by the ietf draft at the following link:  http://www.ietf.org/internet-drafts/draft-nikander-esp-beet-mode-06.txt  The patch provides only single family support (i.e. inner family = outer family).  Signed-off-by: Diego Beltrami <diego.beltrami@gmail.com> Signed-off-by: Miika Komu     <miika@iki.fi> Signed-off-by: Herbert Xu     <herbert@gondor.apana.org.au> Signed-off-by: Abhinav Pathak <abhinav.pathak@hiit.fi> Signed-off-by: Jeff Ahrenholz <ahrenholz@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | statfs.h | s | 1.3K | 39 | Christoph Hellwig | hch@lst.de | 1281386924 |  | add f_flags to struct statfs(64)  Add a flags field to help glibc implementing statvfs(3) efficiently.  We copy the flag values from glibc, and add a new ST_VALID flag to denote that f_flags is implemented.  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | tracehook.h | s | 7.3K | 185 | Oleg Nesterov | oleg@redhat.com | 1337825491 |  | keys: kill the dummy key_replace_session_keyring()  After the previouse change key_replace_session_keyring() becomes a nop. Remove the dummy definition in key.h and update the callers in arch/*/kernel/signal.c.  Signed-off-by: Oleg Nesterov <oleg@redhat.com> Acked-by: David Howells <dhowells@redhat.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Richard Kuo <rkuo@codeaurora.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Alexander Gordeev <agordeev@redhat.com> Cc: Chris Zankel <chris@zankel.net> Cc: David Smith <dsmith@redhat.com> Cc: "Frank Ch. Eigler" <fche@redhat.com> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Larry Woodman <lwoodman@redhat.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Tejun Heo <tj@kernel.org> Cc: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | elfcore.h | s | 5.0K | 155 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | msm_mdp.h | s | 2.1K | 68 | Dima Zavin | dima@android.com | 1299102195 |  | msm: mdp: Add support for RGBX 8888 image format.  Signed-off-by: Dima Zavin <dima@android.com> Signed-off-by: Carl Vanderlip <carlv@codeaurora.org> Signed-off-by: David Brown <davidb@codeaurora.org>
f | fsl_hypervisor.h | s | 7.7K | 218 | Timur Tabi | timur@freescale.com | 1310102487 |  | drivers/virt: introduce Freescale hypervisor management driver  Add the drivers/virt directory, which houses drivers that support virtualization environments, and add the Freescale hypervisor management driver.  The Freescale hypervisor management driver provides several services to drivers and applications related to the Freescale hypervisor:  1. An ioctl interface for querying and managing partitions  2. A file interface to reading incoming doorbells  3. An interrupt handler for shutting down the partition upon receiving the    shutdown doorbell from a manager partition  4. A kernel interface for receiving callbacks when a managed partition    shuts down.  Signed-off-by: Timur Tabi <timur@freescale.com> Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
f | trace_clock.h | s | 552B | 17 | Steven Rostedt | srostedt@redhat.com | 1316446558 |  | tracing: Add a counter clock for those that do not trust clocks  When debugging tight race conditions, it can be helpful to have a synchronized tracing method. Although in most cases the global clock provides this functionality, if timings is not the issue, it is more comforting to know that the order of events really happened in a precise order.  Instead of using a clock, add a "counter" that is simply an incrementing atomic 64bit counter that orders the events as they are perceived to happen.  The trace_clock_counter() is added from the attempt by Peter Zijlstra trying to convert the trace_clock_global() to it. I took Peter's counter code and made trace_clock_counter() instead, and added it to the choice of clocks. Just echo counter > /debug/tracing/trace_clock to activate it.  Requested-by: Thomas Gleixner <tglx@linutronix.de> Requested-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Reviewed-By: Valdis Kletnieks <valdis.kletnieks@vt.edu> Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
f | pwm.h | s | 592B | 24 | Mark Vels | mark.vels@team-embedded.nl | 1238419321 |  | trivial: PWM: fix of #endif comment  Signed-off-by: Mark Vels <mark.vels@team-embedded.nl> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | ioc4.h | s | 5.8K | 168 | Al Viro | viro@ftp.linux.org.uk | 1160519842 |  | [PATCH] fix misannotation in ioc4.h  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | i2c-xiic.h | s | 1.4K | 39 | Richard R√∂jfors | richard.rojfors@pelagicore.com | 1268590498 |  | Add the platform data include for the Xilinx XPS IIC Bus Interface  This file was missed in the original patch that went into Linus' tree.  Cc: "Ben Dooks (embedded platforms)" <ben-linux@fluff.org> Cc: linux-i2c@vger.kernel.org Signed-off-by: Richard R√∂jfors <richard.rojfors@pelagicore.com> Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | page_cgroup.h | s | 3.5K | 115 | KAMEZAWA Hiroyuki | kamezawa.hiroyu@jp.fujitsu.com | 1332377701 |  | memcg: remove PCG_FILE_MAPPED  With the new lock scheme for updating memcg's page stat, we don't need a flag PCG_FILE_MAPPED which was duplicated information of page_mapped().  [hughd@google.com: cosmetic fix] [hughd@google.com: add comment to MEM_CGROUP_CHARGE_TYPE_MAPPED case in __mem_cgroup_uncharge_common()] Signed-off-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Acked-by: Greg Thelen <gthelen@google.com> Acked-by: Johannes Weiner <hannes@cmpxchg.org> Cc: Michal Hocko <mhocko@suse.cz> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Ying Han <yinghan@google.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | tty.h | s | 23K | 601 | Linus Torvalds | torvalds@linux-foundation.org | 1338675703 |  | tty: Revert the tty locking series, it needs more work  This reverts the tty layer change to use per-tty locking, because it's not correct yet, and fixing it will require some more deep surgery.  The main revert is d29f3ef39be4 ("tty_lock: Localise the lock"), but there are several smaller commits that built upon it, they also get reverted here. The list of reverted commits is:    fde86d310886 - tty: add lockdep annotations   8f6576ad476b - tty: fix ldisc lock inversion trace   d3ca8b64b97e - pty: Fix lock inversion   b1d679afd766 - tty: drop the pty lock during hangup   abcefe5fc357 - tty/amiserial: Add missing argument for tty_unlock()   fd11b42e3598 - cris: fix missing tty arg in wait_event_interruptible_tty call   d29f3ef39be4 - tty_lock: Localise the lock  The revert had a trivial conflict in the 68360serial.c staging driver that got removed in the meantime.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | lzo.h | s | 1.3K | 38 | Nitin Gupta | nitingupta910@gmail.com | 1184601934 |  | LZO1X: fix lzo1x_worst_compress  This is a correction for a macro which gives worst case compressed data size by LZO1X.  This patch was provided by the LZO author (Markus Oberhumer).  Signed-off-by: Nitin Gupta <nitingupta910@gmail.com> Cc: "Markus F.X.J. Oberhumer" <markus@oberhumer.com> Cc: "Richard Purdie" <rpurdie@openedhand.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | i2c-mux-pinctrl.h | s | 1.4K | 38 | Stephen Warren | swarren@nvidia.com | 1338821383 |  | i2c: Add generic I2C multiplexer using pinctrl API  This is useful for SoCs whose I2C module's signals can be routed to different sets of pins at run-time, using the pinctrl API.                                   +-----+  +-----+                                  || dev ||  || dev ||     +------------------------+   +-----+  +-----+     || SoC                    ||      ||        ||     ||                   /----||------+--------+     ||   +---+   +------+     || child bus A, on first set of pins     ||   ||I2C||---||Pinmux||     ||     ||   +---+   +------+     || child bus B, on second set of pins     ||                   \----||------+--------+--------+     ||                        ||      ||        ||        ||     +------------------------+  +-----+  +-----+  +-----+                                 || dev ||  || dev ||  || dev ||                                 +-----+  +-----+  +-----+  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Rob Herring <rob.herring@calxeda.com> Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | hyperv.h | s | 27K | 902 | Linus Torvalds | torvalds@linux-foundation.org | 1337727733 |  | 
f | random.h | s | 2.4K | 83 | Linus Torvalds | torvalds@linux-foundation.org | 1319804947 |  | Merge branch 'x86-rdrand-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  * 'x86-rdrand-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:   x86, random: Verify RDRAND functionality and allow it to be disabled   x86, random: Architectural inlines to get random integers with RDRAND   random: Add support for architectural random hooks  Fix up trivial conflicts in drivers/char/random.c: the architectural random hooks touched "get_random_int()" that was simplified to use MD5 and not do the keyptr thing any more (see commit 6e5714eaf77d: "net: Compute protocol sequence numbers and fragment IDs using MD5").
f | plist.h | s | 7.4K | 235 | Dima Zavin | dima@android.com | 1310126573 |  | plist: Remove the need to supply locks to plist heads  This was legacy code brought over from the RT tree and is no longer necessary.  Signed-off-by: Dima Zavin <dima@android.com> Acked-by: Thomas Gleixner <tglx@linutronix.de> Cc: Daniel Walker <dwalker@codeaurora.org> Cc: Steven Rostedt <rostedt@goodmis.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Andi Kleen <andi@firstfloor.org> Cc: Lai Jiangshan <laijs@cn.fujitsu.com> Link: http://lkml.kernel.org/r/1310084879-10351-2-git-send-email-dima@android.com Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | start_kernel.h | s | 295B | 8 | Rusty Russell | rusty@rustcorp.com.au | 1165454048 |  | [PATCH] i386: cpu_detect extraction  Both lhype and Xen want to call the core of the x86 cpu detect code before calling start_kernel.  (extracted from larger patch)  AK: folded in start_kernel header patch  Signed-off-by: Jeremy Fitzhardinge <jeremy@xensource.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: Andi Kleen <ak@suse.de> Cc: Jeremy Fitzhardinge <jeremy@goop.org> Cc: Andi Kleen <ak@suse.de> Signed-off-by: Andrew Morton <akpm@osdl.org>
d | platform_data |  | 27 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1337807709 |  | 
f | hardirq.h | s | 5.7K | 177 | Paul E. McKenney | paul.mckenney@linaro.org | 1323628284 |  | rcu: Track idleness independent of idle tasks  Earlier versions of RCU used the scheduling-clock tick to detect idleness by checking for the idle task, but handled idleness differently for CONFIG_NO_HZ=y.  But there are now a number of uses of RCU read-side critical sections in the idle task, for example, for tracing.  A more fine-grained detection of idleness is therefore required.  This commit presses the old dyntick-idle code into full-time service, so that rcu_idle_enter(), previously known as rcu_enter_nohz(), is always invoked at the beginning of an idle loop iteration.  Similarly, rcu_idle_exit(), previously known as rcu_exit_nohz(), is always invoked at the end of an idle-loop iteration.  This allows the idle task to use RCU everywhere except between consecutive rcu_idle_enter() and rcu_idle_exit() calls, in turn allowing architecture maintainers to specify exactly where in the idle loop that RCU may be used.  Because some of the userspace upcall uses can result in what looks to RCU like half of an interrupt, it is not possible to expect that the irq_enter() and irq_exit() hooks will give exact counts.  This patch therefore expands the ->dynticks_nesting counter to 64 bits and uses two separate bitfields to count process/idle transitions and interrupt entry/exit transitions.  It is presumed that userspace upcalls do not happen in the idle loop or from usermode execution (though usermode might do a system call that results in an upcall). The counter is hard-reset on each process/idle transition, which avoids the interrupt entry/exit error from accumulating.  Overflow is avoided by the 64-bitness of the ->dyntick_nesting counter.  This commit also adds warnings if a non-idle task asks RCU to enter idle state (and these checks will need some adjustment before applying Frederic's OS-jitter patches (http://lkml.org/lkml/2011/10/7/246). In addition, validation of ->dynticks and ->dynticks_nesting is added.  Signed-off-by: Paul E. McKenney <paul.mckenney@linaro.org> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com> Reviewed-by: Josh Triplett <josh@joshtriplett.org>
f | ioc3.h | s | 3.1K | 83 | David Howells | dhowells@redhat.com | 1160057412 |  | IRQ: Maintain regs pointer globally rather than passing to IRQ handlers  Maintain a per-CPU global "struct pt_regs *" variable which can be used instead of passing regs around manually through all ~1800 interrupt handlers in the Linux kernel.  The regs pointer is used in few places, but it potentially costs both stack space and code to pass it around.  On the FRV arch, removing the regs parameter from all the genirq function results in a 20% speed up of the IRQ exit path (ie: from leaving timer_interrupt() to leaving do_IRQ()).  Where appropriate, an arch may override the generic storage facility and do something different with the variable.  On FRV, for instance, the address is maintained in GR28 at all times inside the kernel as part of general exception handling.  Having looked over the code, it appears that the parameter may be handed down through up to twenty or so layers of functions.  Consider a USB character device attached to a USB hub, attached to a USB controller that posts its interrupts through a cascaded auxiliary interrupt controller.  A character device driver may want to pass regs to the sysrq handler through the input layer which adds another few layers of parameter passing.  I've build this code with allyesconfig for x86_64 and i386.  I've runtested the main part of the code on FRV and i386, though I can't test most of the drivers. I've also done partial conversion for powerpc and MIPS - these at least compile with minimal configurations.  This will affect all archs.  Mostly the changes should be relatively easy. Take do_IRQ(), store the regs pointer at the beginning, saving the old one:  	struct pt_regs *old_regs = set_irq_regs(regs);  And put the old one back at the end:  	set_irq_regs(old_regs);  Don't pass regs through to generic_handle_irq() or __do_IRQ().  In timer_interrupt(), this sort of change will be necessary:  	-	update_process_times(user_mode(regs)); 	-	profile_tick(CPU_PROFILING, regs); 	+	update_process_times(user_mode(get_irq_regs())); 	+	profile_tick(CPU_PROFILING);  I'd like to move update_process_times()'s use of get_irq_regs() into itself, except that i386, alone of the archs, uses something other than user_mode().  Some notes on the interrupt handling in the drivers:   (*) input_dev() is now gone entirely.  The regs pointer is no longer stored in      the input_dev struct.   (*) finish_unlinks() in drivers/usb/host/ohci-q.c needs checking.  It does      something different depending on whether it's been supplied with a regs      pointer or not.   (*) Various IRQ handler function pointers have been moved to type      irq_handler_t.  Signed-Off-By: David Howells <dhowells@redhat.com> (cherry picked from 1b16e7ac850969f38b375e511e3fa2f474a33867 commit)
f | xilinxfb.h | s | 945B | 25 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | nfs_fs_sb.h | s | 7.7K | 214 | Trond Myklebust | Trond.Myklebust@netapp.com | 1340023516 |  | NFSv4.1: Fix umount when filelayout DS is also the MDS  Currently there is a 'chicken and egg' issue when the DS is also the mounted MDS. The nfs_match_client() reference from nfs4_set_ds_client bumps the cl_count, the nfs_client is not freed at umount, and nfs4_deviceid_purge_client is not called to dereference the MDS usage of a deviceid which holds a reference to the DS nfs_client.  The result is the umount program returns, but the nfs_client is not freed, and the cl_session hearbeat continues.  The MDS (and all other nfs mounts) lose their last nfs_client reference in nfs_free_server when the last nfs_server (fsid) is umounted. The file layout DS lose their last nfs_client reference in destroy_ds when the last deviceid referencing the data server is put and destroy_ds is called. This is triggered by a call to nfs4_deviceid_purge_client which removes references to a pNFS deviceid used by an MDS mount.  The fix is to track how many pnfs enabled filesystems are mounted from this server, and then to purge the device id cache once that count reaches zero.  Reported-by: Jorge Mora <Jorge.Mora@netapp.com> Reported-by: Andy Adamson <andros@netapp.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | moduleparam.h | s | 16K | 409 | Rusty Russell | rusty@rustcorp.com.au | 1339133293 |  | module_param: stop double-calling parameters.  Commit 026cee0086fe1df4cf74691cf273062cc769617d "params: <level>_initcall-like kernel parameters" set old-style module parameters to level 0.  And we call those level 0 calls where we used to, early in start_kernel().  We also loop through the initcall levels and call the levelled module_params before the corresponding initcall.  Unfortunately level 0 is early_init(), so we call the standard module_param calls twice.  (Turns out most things don't care, but at least ubi.mtd does).  Change the level to -1 for standard module_param calls.  Reported-by: Beno√Æt Th√©baudeau <benoit.thebaudeau@advansee.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Cc: stable@kernel.org
f | rio_drv.h | s | 13K | 395 | Alexandre Bounine | alexandre.bounine@idt.com | 1338511771 |  | rapidio: add DMA engine support for RIO data transfers  Adds DMA Engine framework support into RapidIO subsystem.  Uses DMA Engine DMA_SLAVE interface to generate data transfers to/from remote RapidIO target devices.  Introduces RapidIO-specific wrapper for prep_slave_sg() interface with an extra parameter to pass target specific information.  Uses scatterlist to describe local data buffer.  Address flat data buffer on a remote side.  Signed-off-by: Alexandre Bounine <alexandre.bounine@idt.com> Cc: Dan Williams <dan.j.williams@intel.com> Acked-by: Vinod Koul <vinod.koul@linux.intel.com> Cc: Li Yang <leoli@freescale.com> Cc: Matt Porter <mporter@kernel.crashing.org> Cc: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | slab_def.h | s | 5.0K | 183 | Steven Rostedt | rostedt@goodmis.org | 1326147573 |  | tracing/mm: Move include of trace/events/kmem.h out of header into slab.c  Including trace/events/*.h TRACE_EVENT() macro headers in other headers can cause strange side effects if another trace/event/*.h header includes that header.  Having trace/events/kmem.h inside slab_def.h caused a compile error in sparc64 when changes were done to some header files.  Moving the kmem.h trace header out of slab.h and into slab.c fixes the problem.  Note, both slub.c and slob.c already include the trace/events/kmem.h file. Only slab.c had it missing.  Link: http://lkml.kernel.org/r/20120105190405.1e3191fb5a43b2a0f1655e1f@canb.auug.org.au  Reported-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Steven Rostedt <rostedt@goodmis.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | freezer.h | s | 5.8K | 169 | Rafael J. Wysocki | rjw@sisk.pl | 1327865752 |  | PM / Hibernate: Fix s2disk regression related to freezing workqueues  Commit 2aede851ddf08666f68ffc17be446420e9d2a056    PM / Hibernate: Freeze kernel threads after preallocating memory  introduced a mechanism by which kernel threads were frozen after the preallocation of hibernate image memory to avoid problems with frozen kernel threads not responding to memory freeing requests. However, it overlooked the s2disk code path in which the SNAPSHOT_CREATE_IMAGE ioctl was run directly after SNAPSHOT_FREE, which caused freeze_workqueues_begin() to BUG(), because it saw that worqueues had been already frozen.  Although in principle this issue might be addressed by removing the relevant BUG_ON() from freeze_workqueues_begin(), that would reintroduce the very problem that commit 2aede851ddf08666f68ffc17be4 attempted to avoid into that particular code path.  For this reason, to fix the issue at hand, introduce thaw_kernel_threads() and make the SNAPSHOT_FREE ioctl execute it.  Special thanks to Srivatsa S. Bhat for detailed analysis of the problem.  Reported-and-tested-by: Jiri Slaby <jslaby@suse.cz> Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl> Acked-by: Srivatsa S. Bhat <srivatsa.bhat@linux.vnet.ibm.com> Cc: stable@kernel.org
f | pnp.h | s | 14K | 409 | Joe Perches | joe@perches.com | 1307710536 |  | treewide: Convert uses of struct resource to resource_size(ptr)  Several fixes as well where the +1 was missing.  Done via coccinelle scripts like:  @@ struct resource *ptr; @@  - ptr->end - ptr->start + 1 + resource_size(ptr)  and some grep and typing.  Mostly uncompiled, no cross-compilers.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | fs_enet_pd.h | s | 3.3K | 137 | Grant Likely | grant.likely@secretlab.ca | 1240826031 |  | net: Rework fs_enet driver to use of_mdio infrastructure  This patch simplifies the driver by making use of more common code.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Andy Fleming <afleming@freescale.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mdio-mux.h | s | 551B | 18 | David Daney | david.daney@cavium.com | 1336445889 |  | netdev/of/phy: Add MDIO bus multiplexer support.  This patch adds a somewhat generic framework for MDIO bus multiplexers.  It is modeled on the I2C multiplexer.  The multiplexer is needed if there are multiple PHYs with the same address connected to the same MDIO bus adepter, or if there is insufficient electrical drive capability for all the connected PHY devices.  Conceptually it could look something like this:                     ------------------                    || Control Signal ||                    --------+---------                            ||  ---------------   --------+------  || MDIO MASTER ||---|| Multiplexer ||  ---------------   --+-------+----                      ||       ||                      C       C                      h       h                      i       i                      l       l                      d       d                      ||       ||      ---------       A       B   ---------      ||       ||       ||       ||   ||       ||      || PHY@1 +-------+       +---+ PHY@1 ||      ||       ||       ||       ||   ||       ||      ---------       ||       ||   ---------      ---------       ||       ||   ---------      ||       ||       ||       ||   ||       ||      || PHY@2 +-------+       +---+ PHY@2 ||      ||       ||                   ||       ||      ---------                   ---------  This framework configures the bus topology from device tree data.  The mechanics of switching the multiplexer is left to device specific drivers.  The follow-on patch contains a multiplexer driven by GPIO lines.  Signed-off-by: David Daney <david.daney@cavium.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cpumask.h | s | 26K | 827 | Rusty Russell | rusty@rustcorp.com.au | 1332997711 |  | cpumask: remove old cpu_*_map.  These are obsolete: cpu_*_mask provides (const) pointers.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | libps2.h | s | 1.8K | 45 | Dmitry Torokhov | dmitry.torokhov@gmail.com | 1253255025 |  | Input: libps2 - additional locking for i8042 ports  The serio ports on i8042 are not completely isolated; while we provide enough locking to ensure proper serialization when accessing control and data registers AUX and KBD ports can still have an effect on each other on PS/2 protocol level. The most prominent effect is that issuing a command for the device connected to one port may cause abort of the command currently executing by the device connected to another port.  Since i8042 nor serio subsystem are not aware of the details of the PS/2 protocol (length of the commands and their replies and so on) the locking should be done on libps2 level by adding special handling when we see that we are dealing with serio port on i8042.  Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | nfs4_mount.h | s | 1.8K | 59 | Trond Myklebust | Trond.Myklebust@netapp.com | 1184125248 |  | NFS: Add the mount option "nosharecache"  Prior to David Howell's mount changes in 2.6.18, users who mounted different directories which happened to be from the same filesystem on the server would get different super blocks, and hence could choose different mount options. As long as there were no hard linked files that crossed from one subtree to another, this was quite safe. Post the changes, if the two directories are on the same filesystem (have the same 'fsid'), they will share the same super block, and hence the same mount options.  Add a flag to allow users to elect not to share the NFS super block with another mount point, even if the fsids are the same. This will allow users to set different mount options for the two different super blocks, as was previously possible. It is still up to the user to ensure that there are no cache coherency issues when doing this, however the default behaviour will be to share super blocks whenever two paths result in the same fsid.  Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | atmmpc.h | s | 4.1K | 103 | Arnd Bergmann | arnd@arndb.de | 1238087655 |  | make most exported headers use strict integer types  This takes care of all files that have only a small number of non-strict integer type uses.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Cc: Mauro Carvalho Chehab <mchehab@redhat.com> Cc: David Airlie <airlied@linux.ie> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Cc: netdev@vger.kernel.org Cc: linux-ppp@vger.kernel.org Cc: Jaroslav Kysela <perex@perex.cz> Cc: Takashi Iwai <tiwai@suse.de> Cc: David Woodhouse <dwmw2@infradead.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | bug.h | s | 3.2K | 88 | Konstantin Khlebnikov | khlebnikov@openvz.org | 1338333740 |  | bug: introduce BUILD_BUG_ON_INVALID() macro  Sometimes we want to check some expressions correctness at compile time. "(void)(e);" or "if (e);" can be dangerous if the expression has side-effects, and gcc sometimes generates a lot of code, even if the expression has no effect.  This patch introduces macro BUILD_BUG_ON_INVALID() for such checks, it forces a compilation error if expression is invalid without any extra code.  [Cast to "long" required because sizeof does not work for bit-fields.]  Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: Cong Wang <xiyou.wangcong@gmail.com> Cc: Hugh Dickins <hughd@google.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | kdb.h | s | 5.2K | 145 | Joe Perches | joe@perches.com | 1320107454 |  | treewide: use __printf not __attribute__((format(printf,...)))  Standardize the style for compiler based printf format verification. Standardized the location of __printf too.  Done via script and a little typing.  $ grep -rPl --include=*.[ch] -w "__attribute__" * || \   grep -vP "^(tools||scripts||include/linux/compiler-gcc.h)" || \   xargs perl -n -i -e 'local $/; while (<>) { s/\b__attribute__\s*\(\s*\(\s*format\s*\(\s*printf\s*,\s*(.+)\s*,\s*(.+)\s*\)\s*\)\s*\)/__printf($1, $2)/g ; print; }'  [akpm@linux-foundation.org: revert arch bits] Signed-off-by: Joe Perches <joe@perches.com> Cc: "Kirill A. Shutemov" <kirill@shutemov.name> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ivtv.h | s | 2.9K | 57 | Hans Verkuil | hans.verkuil@cisco.com | 1329234356 |  | [media] ivtv: add IVTV_IOC_PASSTHROUGH_MODE  With this private ioctl it is possible to use the ivtv decoder without requiring the dvb/video.h and dvb/audio.h headers.  Eventually support for those DVB APIs will be dropped from ivtv.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | nsc_gpio.h | s | 1.4K | 30 | Jim Cromie | jim.cromie@gmail.com | 1152939234 |  | [PATCH] gpio: drop vtable members .gpio_set_high .gpio_set_low gpio_set is enough  drops gpio_set_high, gpio_set_low from the nsc_gpio_ops vtable.  While we can't drop them from scx200_gpio (or can we?), we dont need them for new users of the exported vtable; gpio_set(1), gpio_set(0) work fine.  Signed-off-by: Jim Cromie <jim.cromie@gmail.com> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | stmmac.h | s | 3.8K | 98 | Giuseppe CAVALLARO | peppe.cavallaro@st.com | 1337035999 |  | stmmac: add mixed burst for DMA  In mixed burst (MB) mode, the AHB master always initiates the bursts with fixed-size when the DMA requests transfers of size less than or equal to 16 beats. This patch adds the MB support and the flag that can be passed from the platform to select it. MB mode can also give some benefits in terms of performances on some platforms.  v2: fixed Coding Style  Signed-off-by: Giuseppe Cavallaro <peppe.cavallaro@st.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ipmi.h | s | 26K | 652 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | inet_diag.h | s | 3.7K | 143 | Pavel Emelyanov | xemul@parallels.com | 1326315366 |  | inet_diag: Rename inet_diag_req_compat into inet_diag_req  Signed-off-by: Pavel Emelyanov <xemul@parallels.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ks8842.h | s | 1.2K | 34 | Richard R√∂jfors | richard.rojfors@pelagicore.com | 1280288899 |  | ks8842: Support DMA when accessed via timberdale  This patch adds support for RX and TX DMA via the DMA API, this is only supported when the KS8842 is accessed via timberdale.  There is no support for DMA on the generic bus interface it self, a state machine inside the FPGA is handling RX and TX transfers to/from buffers in the FPGA. The host CPU can do DMA to and from these buffers.  The FPGA has to handle the RX interrupts, so these must be enabled in the ks8842 but not in the FPGA. The driver must not disable the RX interrupt that would mean that the data transfers into the FPGA buffers would stop.  The host shall not enable TX interrupts since TX is handled by the FPGA, the host is notified by DMA callbacks when transfers are finished.  Which DMA channels to use are added as parameters in the platform data struct.  Signed-off-by: Richard R√∂jfors <richard.rojfors@pelagicore.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | suspend.h | s | 15K | 404 | Rafael J. Wysocki | rjw@sisk.pl | 1335900349 |  | PM / Sleep: Add "prevent autosleep time" statistics to wakeup sources  Android uses one wakelock statistics that is only necessary for opportunistic sleep.  Namely, the prevent_suspend_time field accumulates the total time the given wakelock has been locked while "automatic suspend" was enabled.  Add an analogous field, prevent_sleep_time, to wakeup sources and make it behave in a similar way.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl> Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | netfilter.h | s | 10K | 335 | Eric W. Biederman | ebiederm@xmission.com | 1334971350 |  | net: Delete all remaining instances of ctl_path  We don't use struct ctl_path anymore so delete the exported constants.  Signed-off-by: Eric W. Biederman <ebiederm@xmission.com> Acked-by: Pavel Emelyanov <xemul@parallels.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | i2o.h | s | 29K | 860 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | ipc.h | s | 2.4K | 85 | Al Viro | viro@zeniv.linux.org.uk | 1325649317 |  | switch kern_ipc_perm to umode_t  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | intel-iommu.h | s | 11K | 318 | Linus Torvalds | torvalds@linux-foundation.org | 1319638652 |  | Merge branch 'core-locking-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  * 'core-locking-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip: (27 commits)   rtmutex: Add missing rcu_read_unlock() in debug_rt_mutex_print_deadlock()   lockdep: Comment all warnings   lib: atomic64: Change the type of local lock to raw_spinlock_t   locking, lib/atomic64: Annotate atomic64_lock::lock as raw   locking, x86, iommu: Annotate qi->q_lock as raw   locking, x86, iommu: Annotate irq_2_ir_lock as raw   locking, x86, iommu: Annotate iommu->register_lock as raw   locking, dma, ipu: Annotate bank_lock as raw   locking, ARM: Annotate low level hw locks as raw   locking, drivers/dca: Annotate dca_lock as raw   locking, powerpc: Annotate uic->lock as raw   locking, x86: mce: Annotate cmci_discover_lock as raw   locking, ACPI: Annotate c3_lock as raw   locking, oprofile: Annotate oprofilefs lock as raw   locking, video: Annotate vga console lock as raw   locking, latencytop: Annotate latency_lock as raw   locking, timer_stats: Annotate table_lock as raw   locking, rwsem: Annotate inner lock as raw   locking, semaphores: Annotate inner lock as raw   locking, sched: Annotate thread_group_cputimer as raw   ...  Fix up conflicts in kernel/posix-cpu-timers.c manually: making cputimer->cputime a raw lock conflicted with the ABBA fix in commit bcd5cff7216f ("cputimer: Cure lock inversion").
f | parport.h | s | 20K | 488 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | phantom.h | s | 1.6K | 41 | Jaswinder Singh Rajput | jaswinder@infradead.org | 1232066381 |  | include of <linux/types.h> is preferred over <asm/types.h>  Impact: fix 15 make headers_check warnings:  include of <linux/types.h> is preferred over <asm/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pxa168_eth.h | s | 642B | 25 | Sachin Sanap | ssanap@marvell.com | 1282199442 |  | net: add Fast Ethernet driver for PXA168.  Signed-off-by: Sachin Sanap <ssanap@marvell.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | rcutiny.h | s | 3.4K | 131 | Paul E. McKenney | paul.mckenney@linaro.org | 1339040608 |  | rcu: Precompute RCU_FAST_NO_HZ timer offsets  When a CPU is entering dyntick-idle mode, tick_nohz_stop_sched_tick() calls rcu_needs_cpu() see if RCU needs that CPU, and, if not, computes the next wakeup time based on the timer wheels.  Only later, when actually entering the idle loop, rcu_prepare_for_idle() will be invoked.  In some cases, rcu_prepare_for_idle() will post timers to wake the CPU back up. But all for naught: The next wakeup time for the CPU has already been computed, and posting a timer afterwards does not force that wakeup time to be recomputed.  This means that rcu_prepare_for_idle()'s have no effect.  This is not a problem on a busy system because something else will wake up the CPU soon enough.  However, on lightly loaded systems, the CPU might stay asleep for a considerable length of time.  If that CPU has a callback that the rest of the system is waiting on, the system might run very slowly or (in theory) even hang.  This commit avoids this problem by having rcu_needs_cpu() give tick_nohz_stop_sched_tick() an estimate of when RCU will need the CPU to wake back up, which tick_nohz_stop_sched_tick() takes into account when programming the CPU's wakeup time.  An alternative approach is for rcu_prepare_for_idle() to use hrtimers instead of normal timers, but timers are much more efficient than are hrtimers for frequently and repeatedly posting and cancelling a given timer, which is exactly what RCU_FAST_NO_HZ does.  Reported-by: Pascal Chapperon <pascal.chapperon@wanadoo.fr> Reported-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Paul E. McKenney <paul.mckenney@linaro.org> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com> Tested-by: Heiko Carstens <heiko.carstens@de.ibm.com> Tested-by: Pascal Chapperon <pascal.chapperon@wanadoo.fr>
f | errqueue.h | s | 875B | 38 | Eric Dumazet | eric.dumazet@gmail.com | 1323645916 |  | net: use IS_ENABLED(CONFIG_IPV6)  Instead of testing defined(CONFIG_IPV6) |||| defined(CONFIG_IPV6_MODULE)  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | fs_struct.h | s | 1.2K | 46 | Nick Piggin | npiggin@kernel.dk | 1294383027 |  | fs: fs_struct use seqlock  Use a seqlock in the fs_struct to enable us to take an atomic copy of the complete cwd and root paths. Use this in the RCU lookup path to avoid a thread-shared spinlock in RCU lookup operations.  Multi-threaded apps may now perform path lookups with scalability matching multi-process apps. Operations such as stat(2) become very scalable for multi-threaded workload.  Signed-off-by: Nick Piggin <npiggin@kernel.dk>
d | netfilter_bridge |  | 19 items |  | Joerg Willmann | joe@clnt.de | 1329827346 |  | netfilter: ebtables: fix alignment problem in ppc  ebt_among extension of ebtables uses __alignof__(_xt_align) while the corresponding kernel module uses __alignof__(ebt_replace) to determine the alignment in EBT_ALIGN().  These are the results of these values on different platforms:  x86 x86_64 ppc __alignof__(_xt_align) 4 8 8 __alignof__(ebt_replace) 4 8 4  ebtables fails to add rules which use the among extension.  I'm using kernel 2.6.33 and ebtables 2.0.10-4  According to Bart De Schuymer, userspace alignment was changed to _xt_align to fix an alignment issue on a userspace32-kernel64 system (he thinks it was for an ARM device). So userspace must be right. The kernel alignment macro needs to change so it also uses _xt_align instead of ebt_replace. The userspace changes date back from June 29, 2009.  Signed-off-by: Joerg Willmann <joe@clnt.de> Signed-off by: Bart De Schuymer <bdschuym@pandora.be> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | Kbuild | g | 9.0K |  | maximilian attems | max@stro.at | 1338511770 |  | kexec: export kexec.h to user space  Add userspace definitions, guard all relevant kernel structures.  While at it document stuff and remove now useless userspace hint.  It is easy to add the relevant system call to respective libc's, but it seems pointless to have to duplicate the data structures.  This is based on the kexec-tools headers, with the exception of just using int on return (succes or failure) and using size_t instead of 'unsigned long int' for the number of segments argument of kexec_load().  Signed-off-by: maximilian attems <max@stro.at> Cc: Simon Horman <horms@verge.net.au> Cc: Vivek Goyal <vgoyal@redhat.com> Cc: Haren Myneni <hbabu@us.ibm.com> Cc: "Eric W. Biederman" <ebiederm@xmission.com> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | nsproxy.h | s | 2.2K | 76 | Al Viro | viro@zeniv.linux.org.uk | 1311140647 |  | make sure that nsproxy_cache is initialized early enough  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | dqblk_xfs.h | s | 6.7K | 151 | Christoph Hellwig | hch@lst.de | 1279720906 |  | quota: Clean up the namespace in dqblk_xfs.h  Almost all identifiers use the FS_* namespace, so rename the missing few XFS_* ones to FS_* as well.  Without this some people might get upset about having too many XFS names in generic code.  Acked-by: Steven Whitehouse <swhiteho@redhat.com> Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Jan Kara <jack@suse.cz>
f | cciss_defs.h | s | 3.1K | 112 | dann frazier | dannf@hp.com | 1266842685 |  | cciss: Consolidate duplicate bits in cciss_cmd.h & cciss_ioctl.h  There are several duplicate definitions in cciss_cmd.h and cciss_ioctl.h. Consolidate these into the new cciss_defs.h file. This patch doesn't change the definitions exposed under include/linux, so userspace apps shouldn't be affected.  Acked-by: Stephen M. Cameron <scameron@beardog.cce.hp.com> Signed-off-by: dann frazier <dannf@hp.com> Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
f | ata.h | s | 29K | 939 | Hannes Reinecke | hare@suse.de | 1300171352 |  | libata: Use 'bool' return value for ata_id_XXX  Most ata_id_XXX inlines are simple tests, so we should set the return value to 'bool' here.  Signed-off-by: Hannes Reinecke <hare@suse.de> Signed-off-by: Jeff Garzik <jgarzik@pobox.com>
f | virtio_9p.h | s | 2.0K | 40 | Rusty Russell | rusty@rustcorp.com.au | 1306719854 |  | virtio: add full three-clause BSD text to headers.  It's unclear to me if it's important, but it's obviously causing my technical colleages some headaches and I'd hate such imprecision to slow virtio adoption.  I've emailed this to all non-trivial contributors for approval, too.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Ryan Harper <ryanh@us.ibm.com> Acked-by: Anthony Liguori <aliguori@us.ibm.com> Acked-by: Eric Van Hensbergen <ericvh@gmail.com> Acked-by: john cooper <john.cooper@redhat.com> Acked-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Acked-by: Christian Borntraeger <borntraeger@de.ibm.com> Acked-by: Fernando Luis Vazquez Cao <fernando@oss.ntt.co.jp>
f | generic_serial.h | s | 1002B | 29 | Jiri Slaby | jslaby@suse.cz | 1333995290 |  | TTY: deprecate linux/generic_serial.h  Since nobody in the kernel includes that file, let us remove the structs visible to the kernel.  However since the userspace sees the file, it still may include that. hence deprecate the use of the header by an added cpp #warning.  We should remove the file completely after a couple of years.  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | i2o-dev.h | s | 11K | 365 | Paul Gortmaker | paul.gortmaker@windriver.com | 1337295973 |  | MCA: delete all remaining traces of microchannel bus support.  Hardware with MCA bus is limited to 386 and 486 class machines that are now 20+ years old and typically with less than 32MB of memory.  A quick search on the internet, and you see that even the MCA hobbyist/enthusiast community has lost interest in the early 2000 era and never really even moved ahead from the 2.4 kernels to the 2.6 series.  This deletes anything remaining related to CONFIG_MCA from core kernel code and from the x86 architecture.  There is no point in carrying this any further into the future.  One complication to watch for is inadvertently scooping up stuff relating to machine check, since there is overlap in the TLA name space (e.g. arch/x86/boot/mca.c).  Cc: Thomas Gleixner <tglx@linutronix.de> Cc: James Bottomley <JBottomley@Parallels.com> Cc: x86@kernel.org Acked-by: Ingo Molnar <mingo@elte.hu> Acked-by: H. Peter Anvin <hpa@zytor.com> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | pstore_ram.h | s | 2.5K | 83 | Anton Vorontsov | anton.vorontsov@linaro.org | 1339631560 |  | pstore/ram_core: Factor persistent_ram_zap() out of post_init()  A handy function that we will use outside of ram_core soon. But so far just factor it out and start using it in post_init().  Signed-off-by: Anton Vorontsov <anton.vorontsov@linaro.org> Acked-by: Kees Cook <keescook@chromium.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | bitmap.h | s | 10K | 278 | Len Brown | len.brown@intel.com | 1312385442 |  | Merge branch 'apei' into apei-release  Some trivial conflicts due to other various merges adding to the end of common lists sooner than this one.  	arch/ia64/Kconfig 	arch/powerpc/Kconfig 	arch/x86/Kconfig 	lib/Kconfig 	lib/Makefile  Signed-off-by: Len Brown <len.brown@intel.com>
f | blk-iopoll.h | s | 1.2K | 39 | Jens Axboe | jens.axboe@oracle.com | 1252672412 |  | block: make blk_iopoll_prep_sched() follow normal 0/1 return convention  Return 0 if we successfully marked this iopoll structure as ours for scheduling, instead of 1.  Signed-off-by: Jens Axboe <jens.axboe@oracle.com>
f | user-return-notifier.h | s | 1.1K | 34 | Avi Kivity | avi@redhat.com | 1259528584 |  | core: Fix user return notifier on fork()  fork() clones all thread_info flags, including TIF_USER_RETURN_NOTIFY; if the new task is first scheduled on a cpu which doesn't have user return notifiers set, this causes user return notifiers to trigger without any way of clearing itself.  This is easy to trigger with a forky workload on the host in parallel with kvm, resulting in a cpu in an endless loop on the verge of returning to userspace.  Fix by dropping the TIF_USER_RETURN_NOTIFY immediately after fork.  Signed-off-by: Avi Kivity <avi@redhat.com> LKML-Reference: <1259505288-16559-1-git-send-email-avi@redhat.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | kmod.h | s | 3.2K | 90 | Boaz Harrosh | bharrosh@panasas.com | 1338511768 |  | kmod: move call_usermodehelper_fns() to .c file and unexport all it's helpers  If we move call_usermodehelper_fns() to kmod.c file and EXPORT_SYMBOL it we can avoid exporting all it's helper functions: 	call_usermodehelper_setup 	call_usermodehelper_setfns 	call_usermodehelper_exec And make all of them static to kmod.c  Since the optimizer will see all these as a single call site it will inline them inside call_usermodehelper_fns().  So we loose the call to _fns but gain 3 calls to the helpers.  (Not that it matters)  Signed-off-by: Boaz Harrosh <bharrosh@panasas.com> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Cc: Ingo Molnar <mingo@elte.hu> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sysfs.h | s | 9.2K | 299 | Alan Stern | stern@rowland.harvard.edu | 1337023196 |  | sysfs: get rid of some lockdep false positives  This patch (as1554) fixes a lockdep false-positive report.  The problem arises because lockdep is unable to deal with the tree-structured locks created by the device core and sysfs.  This particular problem involves a sysfs attribute method that unregisters itself, not from the device it was called for, but from a descendant device.  Lockdep doesn't understand the distinction and reports a possible deadlock, even though the operation is safe.  This is the sort of thing that would normally be handled by using a nested lock annotation; unfortunately it's not feasible to do that here.  There's no sensible way to tell sysfs when attribute removal occurs in the context of a parent attribute method.  As a workaround, the patch adds a new flag to struct attribute telling sysfs not to inform lockdep when it acquires a readlock on a sysfs_dirent instance for the attribute.  The readlock is still acquired, but lockdep doesn't know about it and hence does not complain about impossible deadlock scenarios.  Also added are macros for static initialization of attribute structures with the ignore_lockdep flag set.  The three offending attributes in the USB subsystem are converted to use the new macros.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Acked-by: Tejun Heo <tj@kernel.org> CC: Eric W. Biederman <ebiederm@xmission.com> CC: Peter Zijlstra <peterz@infradead.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | micrel_phy.h | s | 424B | 12 | Nobuhiro Iwamatsu | nobuhiro.iwamatsu.yj@renesas.com | 1337714428 |  | phy/micrel: Fix ID of KSZ9021  Right ID of KSZ9021 is 0x00221610. Because lower 4bit is a revision number, it varies according to a chip.  Signed-off-by: Nobuhiro Iwamatsu <nobuhiro.iwamatsu.yj@renesas.com> Cc: David J. Choi <david.choi@micrel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | fiemap.h | s | 2.6K | 59 | Sunil Mushran | sunil.mushran@oracle.com | 1261112157 |  | fiemap: Add new extent flag FIEMAP_EXTENT_SHARED  Some filesystems may allow multiple files to point to a particular extent.  This patch adds flag FIEMAP_EXTENT_SHARED to denote extents that are shared with other inodes.  Signed-off-by: Sunil Mushran <sunil.mushran@oracle.com> Acked-by: Mark Fasheh <mfasheh@suse.com> Signed-off-by: Joel Becker <joel.becker@oracle.com>
f | rcutree.h | s | 3.3K | 81 | Paul E. McKenney | paul.mckenney@linaro.org | 1339040608 |  | rcu: Precompute RCU_FAST_NO_HZ timer offsets  When a CPU is entering dyntick-idle mode, tick_nohz_stop_sched_tick() calls rcu_needs_cpu() see if RCU needs that CPU, and, if not, computes the next wakeup time based on the timer wheels.  Only later, when actually entering the idle loop, rcu_prepare_for_idle() will be invoked.  In some cases, rcu_prepare_for_idle() will post timers to wake the CPU back up. But all for naught: The next wakeup time for the CPU has already been computed, and posting a timer afterwards does not force that wakeup time to be recomputed.  This means that rcu_prepare_for_idle()'s have no effect.  This is not a problem on a busy system because something else will wake up the CPU soon enough.  However, on lightly loaded systems, the CPU might stay asleep for a considerable length of time.  If that CPU has a callback that the rest of the system is waiting on, the system might run very slowly or (in theory) even hang.  This commit avoids this problem by having rcu_needs_cpu() give tick_nohz_stop_sched_tick() an estimate of when RCU will need the CPU to wake back up, which tick_nohz_stop_sched_tick() takes into account when programming the CPU's wakeup time.  An alternative approach is for rcu_prepare_for_idle() to use hrtimers instead of normal timers, but timers are much more efficient than are hrtimers for frequently and repeatedly posting and cancelling a given timer, which is exactly what RCU_FAST_NO_HZ does.  Reported-by: Pascal Chapperon <pascal.chapperon@wanadoo.fr> Reported-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Paul E. McKenney <paul.mckenney@linaro.org> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com> Tested-by: Heiko Carstens <heiko.carstens@de.ibm.com> Tested-by: Pascal Chapperon <pascal.chapperon@wanadoo.fr>
f | futex.h | s | 6.6K | 185 | Linus Torvalds | torvalds@linux-foundation.org | 1255029395 |  | Merge branch 'core-fixes-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/linux-2.6-tip  * 'core-fixes-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/linux-2.6-tip:   futex: fix requeue_pi key imbalance   futex: Fix typo in FUTEX_WAIT/WAKE_BITSET_PRIVATE definitions   rcu: Place root rcu_node structure in separate lockdep class   rcu: Make hot-unplugged CPU relinquish its own RCU callbacks   rcu: Move rcu_barrier() to rcutree   futex: Move exit_pi_state() call to release_mm()   futex: Nullify robust lists after cleanup   futex: Fix locking imbalance   panic: Fix panic message visibility by calling bust_spinlocks(0) before dying   rcu: Replace the rcu_barrier enum with pointer to call_rcu*() function   rcu: Clean up code based on review feedback from Josh Triplett, part 4   rcu: Clean up code based on review feedback from Josh Triplett, part 3   rcu: Fix rcu_lock_map build failure on CONFIG_PROVE_LOCKING=y   rcu: Clean up code to address Ingo's checkpatch feedback   rcu: Clean up code based on review feedback from Josh Triplett, part 2   rcu: Clean up code based on review feedback from Josh Triplett
f | fib_rules.h | s | 1.6K | 61 | Patrick McHardy | kaber@trash.net | 1259871276 |  | net 03/05: fib_rules: add oif classification  commit 68144d350f4f6c348659c825cde6a82b34c27a91 Author: Patrick McHardy <kaber@trash.net> Date:   Thu Dec 3 12:05:25 2009 +0100      net: fib_rules: add oif classification      Support routing table lookup based on the flow's oif. This is useful to     classify packets originating from sockets bound to interfaces differently.      The route cache already includes the oif and needs no changes.      Signed-off-by: Patrick McHardy <kaber@trash.net>  Signed-off-by: David S. Miller <davem@davemloft.net>
f | uvcvideo.h | s | 1.5K | 56 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1305894646 |  | [media] uvcvideo: Make the API public  Move the public API definitions to include/linux/uvcvideo.h and bump the version number to 1.1.0. Compatibility with the old API is kept, application can still be compiled against the private header and will not break.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | compaction.h | s | 3.2K | 87 | Linus Torvalds | torvalds@linux-foundation.org | 1338779157 |  | Revert "mm: compaction: handle incorrect MIGRATE_UNMOVABLE type pageblocks"  This reverts commit 5ceb9ce6fe9462a298bb2cd5c9f1ca6cb80a0199.  That commit seems to be the cause of the mm compation list corruption issues that Dave Jones reported.  The locking (or rather, absense there-of) is dubious, as is the use of the 'page' variable once it has been found to be outside the pageblock range.  So revert it for now, we can re-visit this for 3.6.  If we even need to: as Minchan Kim says, "The patch wasn't a bug fix and even test workload was very theoretical".  Reported-and-tested-by: Dave Jones <davej@redhat.com> Acked-by: Hugh Dickins <hughd@google.com> Acked-by: KOSAKI Motohiro <kosaki.motohiro@gmail.com> Acked-by: Minchan Kim <minchan@kernel.org> Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com> Cc: Kyungmin Park <kyungmin.park@samsung.com> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | lockdep.h | s | 16K | 489 | Peter Zijlstra | peterz@infradead.org | 1337094511 |  | lockdep: fix oops in processing workqueue  Under memory load, on x86_64, with lockdep enabled, the workqueue's process_one_work() has been seen to oops in __lock_acquire(), barfing on a 0xffffffff00000000 pointer in the lockdep_map's class_cache[].  Because it's permissible to free a work_struct from its callout function, the map used is an onstack copy of the map given in the work_struct: and that copy is made without any locking.  Surprisingly, gcc (4.5.1 in Hugh's case) uses "rep movsl" rather than "rep movsq" for that structure copy: which might race with a workqueue user's wait_on_work() doing lock_map_acquire() on the source of the copy, putting a pointer into the class_cache[], but only in time for the top half of that pointer to be copied to the destination map.  Boom when process_one_work() subsequently does lock_map_acquire() on its onstack copy of the lockdep_map.  Fix this, and a similar instance in call_timer_fn(), with a lockdep_copy_map() function which additionally NULLs the class_cache[].  Note: this oops was actually seen on 3.4-next, where flush_work() newly does the racing lock_map_acquire(); but Tejun points out that 3.4 and earlier are already vulnerable to the same through wait_on_work().  * Patch orginally from Peter.  Hugh modified it a bit and wrote the   description.  Signed-off-by: Peter Zijlstra <peterz@infradead.org> Reported-by: Hugh Dickins <hughd@google.com> LKML-Reference: <alpine.LSU.2.00.1205070951170.1544@eggly.anvils> Signed-off-by: Tejun Heo <tj@kernel.org>
f | tiocl.h | s | 1.6K | 34 | Rafael J. Wysocki | rjw@sisk.pl | 1143836336 |  | [PATCH] vt: add TIOCL_GETKMSGREDIRECT  Add TIOCL_GETKMSGREDIRECT needed by the userland suspend tool to get the current value of kmsg_redirect from the kernel so that it can save it and restore it after resume.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl> Acked-by: Pavel Machek <pavel@suse.cz> Cc: Michael Kerrisk <mtk-manpages@gmx.net> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | tc.h | s | 3.4K | 121 | Maciej W. Rozycki | macro@linux-mips.org | 1171038195 |  | [TC] MIPS: TURBOchannel update to the driver model  This is a set of changes to convert support for the TURBOchannel bus to the driver model.  It implements the usual set of calls similar to what other bus drivers have: tc_register_driver(), tc_unregister_driver(), etc.  All the platform-specific bits have been removed and headers from asm-mips/dec/ have been merged into linux/tc.h, which should be included by drivers.  Signed-off-by: Maciej W. Rozycki <macro@linux-mips.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | i2c-smbus.h | s | 1.7K | 45 | Jean Delvare | khali@linux-fr.org | 1332791239 |  | i2c: Update the FSF address  Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | msdos_fs.h | s | 5.9K | 148 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1338511767 |  | fat: introduce special inode for managing the FSINFO block  This is patchset makes fatfs stop using the VFS '->write_super()' method for writing out the FSINFO block.  The final goal is to get rid of the 'sync_supers()' kernel thread.  This kernel thread wakes up every 5 seconds (by default) and calls '->write_super()' for all mounted file-systems.  And the bad thing is that this is done even if all the superblocks are clean.  Moreover, some file-systems do not even need this end they do not register the '->write_super()' method at all (e.g., btrfs).  So 'sync_supers()' most often just generates useless wake-ups and wastes power.  I am trying to make all file-systems independent of '->write_super()' and plan to remove 'sync_supers()' and '->write_super' completely once there are no more users.  The '->write_supers()' method is mostly used by baroque file-systems like hfs, udf, etc.  Modern file-systems like btrfs and xfs do not use it. This justifies removing this stuff from VFS completely and make every FS self-manage own superblock.  Tested with xfstests.  This patch:  Preparation for further changes.  It introduces a special inode ('fsinfo_inode') in FAT file-system which we'll later use for managing the FSINFO block.  Note, this there is already one special inode ('fat_inode') which is used for managing the FAT tables.  Introduce new 'MSDOS_FSINFO_INO' constant for this special inode.  It is safe to do because FAT file-system does not store inode numbers on the media but generates them run-time.  I've also cleaned up the comment to existing 'MSDOS_ROOT_INO' constant, while on it.  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Cc: OGAWA Hirofumi <hirofumi@mail.parknet.co.jp> Cc: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atmapi.h | s | 889B | 21 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | hid-roccat.h | s | 688B | 21 | Stefan Achatz | erazor_de@users.sourceforge.net | 1296747448 |  | HID: roccat: Rename header roccat.h -> hid-roccat.h  It was desired that the header roccat.h should be named hid-roccat.h  Signed-off-by: Stefan Achatz <erazor_de@users.sourceforge.net> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | elevator.h | s | 6.9K | 172 | Tejun Heo | tj@kernel.org | 1331065644 |  | block: implement bio_associate_current()  IO scheduling and cgroup are tied to the issuing task via io_context and cgroup of %current.  Unfortunately, there are cases where IOs need to be routed via a different task which makes scheduling and cgroup limit enforcement applied completely incorrectly.  For example, all bios delayed by blk-throttle end up being issued by a delayed work item and get assigned the io_context of the worker task which happens to serve the work item and dumped to the default block cgroup.  This is double confusing as bios which aren't delayed end up in the correct cgroup and makes using blk-throttle and cfq propio together impossible.  Any code which punts IO issuing to another task is affected which is getting more and more common (e.g. btrfs).  As both io_context and cgroup are firmly tied to task including userland visible APIs to manipulate them, it makes a lot of sense to match up tasks to bios.  This patch implements bio_associate_current() which associates the specified bio with %current.  The bio will record the associated ioc and blkcg at that point and block layer will use the recorded ones regardless of which task actually ends up issuing the bio.  bio release puts the associated ioc and blkcg.  It grabs and remembers ioc and blkcg instead of the task itself because task may already be dead by the time the bio is issued making ioc and blkcg inaccessible and those are all block layer cares about.  elevator_set_req_fn() is updated such that the bio elvdata is being allocated for is available to the elevator.  This doesn't update block cgroup policies yet.  Further patches will implement the support.  -v2: #ifdef CONFIG_BLK_CGROUP added around bio->bi_ioc dereference in      rq_ioc() to fix build breakage.  Signed-off-by: Tejun Heo <tj@kernel.org> Cc: Vivek Goyal <vgoyal@redhat.com> Cc: Kent Overstreet <koverstreet@google.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | khugepaged.h | s | 1.9K | 60 | Andrea Arcangeli | aarcange@redhat.com | 1294968767 |  | thp: madvise(MADV_NOHUGEPAGE)  Add madvise MADV_NOHUGEPAGE to mark regions that are not important to be hugepage backed.  Return -EINVAL if the vma is not of an anonymous type, or the feature isn't built into the kernel.  Never silently return success.  Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_bridge.h | s | 2.5K | 96 | Florian Westphal | fw@strlen.de | 1294786551 |  | netfilter: ebtables: make broute table work again  broute table init hook sets up the "br_should_route_hook" pointer, which then gets called from br_input.  commit a386f99025f13b32502fe5dedf223c20d7283826 (bridge: add proper RCU annotation to should_route_hook) introduced a typedef, and then changed this to:  br_should_route_hook_t *rhook; [..] rhook = rcu_dereference(br_should_route_hook); if (*rhook(skb))  problem is that "br_should_route_hook" contains the address of the function, so calling *rhook() results in kernel panic.  Signed-off-by: Florian Westphal <fw@strlen.de> Acked-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | task_work.h | s | 748B | 26 | Oleg Nesterov | oleg@redhat.com | 1337825361 |  | task_work_add: generic process-context callbacks  Provide a simple mechanism that allows running code in the (nonatomic) context of the arbitrary task.  The caller does task_work_add(task, task_work) and this task executes task_work->func() either from do_notify_resume() or from do_exit().  The callback can rely on PF_EXITING to detect the latter case.  "struct task_work" can be embedded in another struct, still it has "void *data" to handle the most common/simple case.  This allows us to kill the ->replacement_session_keyring hack, and potentially this can have more users.  Performance-wise, this adds 2 "unlikely(!hlist_empty())" checks into tracehook_notify_resume() and do_exit().  But at the same time we can remove the "replacement_session_keyring != NULL" checks from arch/*/signal.c and exit_creds().  Note: task_work_add/task_work_run abuses ->pi_lock.  This is only because this lock is already used by lookup_pi_state() to synchronize with do_exit() setting PF_EXITING.  Fortunately the scope of this lock in task_work.c is really tiny, and the code is unlikely anyway.  Signed-off-by: Oleg Nesterov <oleg@redhat.com> Acked-by: David Howells <dhowells@redhat.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Richard Kuo <rkuo@codeaurora.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Alexander Gordeev <agordeev@redhat.com> Cc: Chris Zankel <chris@zankel.net> Cc: David Smith <dsmith@redhat.com> Cc: "Frank Ch. Eigler" <fche@redhat.com> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Larry Woodman <lwoodman@redhat.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Tejun Heo <tj@kernel.org> Cc: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | rculist.h | s | 17K | 483 | Michel Machado | michel@digirati.com.br | 1335326089 |  | rcu: Replace list_first_entry_rcu() with list_first_or_null_rcu()  The list_first_entry_rcu() macro is inherently unsafe because it cannot be applied to an empty list.  But because RCU readers do not exclude updaters, a list might become empty between the time that list_empty() claimed it was non-empty and the time that list_first_entry_rcu() is invoked.  Therefore, the list_empty() test cannot be separated from the list_first_entry_rcu() call.  This commit therefore combines these to macros to create a new list_first_or_null_rcu() macro that replaces the old (and unsafe) list_first_entry_rcu() macro.  This patch incorporates Paul's review comments on the previous version of this patch available here:  https://lkml.org/lkml/2012/4/2/536  This patch cannot break any upstream code because list_first_entry_rcu() is not being used anywhere in the kernel (tested with grep(1)), and any external code using it is probably broken as a result of using it.  Signed-off-by: Michel Machado <michel@digirati.com.br> CC: "Paul E. McKenney" <paulmck@linux.vnet.ibm.com> CC: Dipankar Sarma <dipankar@in.ibm.com> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
f | if_vlan.h | s | 10K | 350 | Linus Torvalds | torvalds@linux-foundation.org | 1332608919 |  | 
f | err.h | s | 1.3K | 52 | Uwe Kleine-K√∂nig | u.kleine-koenig@pengutronix.de | 1300841051 |  | include/linux/err.h: add a function to cast error-pointers to a return value  PTR_RET() can be used if you have an error-pointer and are only interested in the eventual error value, but not the pointer.  Yields the usual 0 for no error, -ESOMETHING otherwise.  Signed-off-by: Uwe Kleine-K√∂nig <u.kleine-koenig@pengutronix.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_ppp.h | s | 29B | 1 | Paul Mackerras | paulus@samba.org | 1330911698 |  | ppp: Move ioctl definitions from if_ppp.h to new ppp-ioctl.h  This moves the definitions of the ioctls, constants and structures relating to the ppp_generic interface to userspace out from if_ppp.h to a new file, ppp-ioctl.h.  The new file has my copyright since I designed and implemented the ppp_generic interface in the late 1990s. None of the contents of this file comes from the original if_ppp.h published by Carnegie Mellon University.  Of the remainder of if_ppp.h, only the PPP_MTU definition was being used, and this replaces the uses of it with PPP_MRU (which is identical). Therefore, this replaces the entire file with the single line  #include <linux/ppp-ioctl.h>  which clearly doesn't contain any CMU code.  Thus I have removed the CMU copyright notice with its problematic advertising clause, and in fact since it's only one trivial line I have not added any other copyright notice.  Signed-off-by: Paul Mackerras <paulus@samba.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | firewire.h | s | 12K | 391 | Linus Torvalds | torvalds@linux-foundation.org | 1337889467 |  | 
f | mmiotrace.h | s | 3.0K | 92 | Joe Perches | joe@perches.com | 1320107454 |  | treewide: use __printf not __attribute__((format(printf,...)))  Standardize the style for compiler based printf format verification. Standardized the location of __printf too.  Done via script and a little typing.  $ grep -rPl --include=*.[ch] -w "__attribute__" * || \   grep -vP "^(tools||scripts||include/linux/compiler-gcc.h)" || \   xargs perl -n -i -e 'local $/; while (<>) { s/\b__attribute__\s*\(\s*\(\s*format\s*\(\s*printf\s*,\s*(.+)\s*,\s*(.+)\s*\)\s*\)\s*\)/__printf($1, $2)/g ; print; }'  [akpm@linux-foundation.org: revert arch bits] Signed-off-by: Joe Perches <joe@perches.com> Cc: "Kirill A. Shutemov" <kirill@shutemov.name> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | amifd.h | s | 1.9K | 51 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | posix_types.h | s | 1.2K | 37 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | serio.h | s | 5.6K | 181 | Axel Lin | axel.lin@gmail.com | 1333556742 |  | Input: serio - add helper macro for serio_driver boilerplate  This patch introduces the module_serio_driver macro which is a convenience macro for serio driver modules similar to module_platform_driver. It is intended to be used by drivers which init/exit section does nothing but registers/unregisters the serio driver. By using this macro it is possible to eliminate a few lines of boilerplate code per serio driver.  Based on work done by Lars-Peter Clausen <lars@metafoo.de> for other buses (i2c and spi).  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | netpoll.h | s | 3.3K | 128 | Joe Perches | joe@perches.com | 1309748527 |  | netpoll: Remove unused EXPORT_SYMBOLs of netpoll_poll and netpoll_poll_dev  Unused symbols waste space.  Commit 0e34e93177fb "(netpoll: add generic support for bridge and bonding devices)" added the symbol more than a year ago with the promise of "future use".  Because it is so far unused, remove it for now. It can be easily readded if or when it actually needs to be used.  cc: WANG Cong <amwang@redhat.com> Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | i2c-algo-pcf.h | s | 1.9K | 39 | Jean Delvare | khali@linux-fr.org | 1332791239 |  | i2c: Update the FSF address  Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | if_ltalk.h | s | 209B | 9 | Christoph Hellwig | hch@lst.de | 1115328359 |  | [ATALK]: Add alloc_ltalkdev().  this matches the API used by other link layer like ethernet or token ring.  Signed-off-by: Christoph Hellwig <hch@lst.de> Acked-by: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | pxa2xx_ssp.h | s | 7.8K | 181 | Qiao Zhou | zhouqiao@marvell.com | 1339388775 |  | ASoC: fix pxa-ssp compiling issue under mach-mmp  pxa-ssp.c uses API like cpu_is_pxa3xx(), cpu_is_pxa2xx(), which is defined under arch-pxa architecture, and drivers under mach-mmp can't find it. so just use ssp->type to replace that API.  Signed-off-by: Qiao Zhou <zhouqiao@marvell.com> Acked-by: Haojian Zhuang <haojian.zhuang@gmail.com> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
f | device.h | s | 36K | 914 | Linus Torvalds | torvalds@linux-foundation.org | 1337962739 |  | Merge branch 'for-linus' of git://git.linaro.org/people/mszyprowski/linux-dma-mapping  Pull CMA and ARM DMA-mapping updates from Marek Szyprowski:  "These patches contain two major updates for DMA mapping subsystem   (mainly for ARM architecture).  First one is Contiguous Memory   Allocator (CMA) which makes it possible for device drivers to allocate   big contiguous chunks of memory after the system has booted.    The main difference from the similar frameworks is the fact that CMA   allows to transparently reuse the memory region reserved for the big   chunk allocation as a system memory, so no memory is wasted when no   big chunk is allocated.  Once the alloc request is issued, the   framework migrates system pages to create space for the required big   chunk of physically contiguous memory.    For more information one can refer to nice LWN articles:     - 'A reworked contiguous memory allocator': 		http://lwn.net/Articles/447405/     - 'CMA and ARM': 		http://lwn.net/Articles/450286/     - 'A deep dive into CMA': 		http://lwn.net/Articles/486301/     - and the following thread with the patches and links to all previous      versions: 		https://lkml.org/lkml/2012/4/3/204    The main client for this new framework is ARM DMA-mapping subsystem.    The second part provides a complete redesign in ARM DMA-mapping   subsystem.  The core implementation has been changed to use common   struct dma_map_ops based infrastructure with the recent updates for   new dma attributes merged in v3.4-rc2.  This allows to use more than   one implementation of dma-mapping calls and change/select them on the   struct device basis.  The first client of this new infractructure is   dmabounce implementation which has been completely cut out of the   core, common code.    The last patch of this redesign update introduces a new, experimental   implementation of dma-mapping calls on top of generic IOMMU framework.   This lets ARM sub-platform to transparently use IOMMU for DMA-mapping   calls if one provides required IOMMU hardware.    For more information please refer to the following thread: 		http://www.spinics.net/lists/arm-kernel/msg175729.html    The last patch merges changes from both updates and provides a   resolution for the conflicts which cannot be avoided when patches have   been applied on the same files (mainly arch/arm/mm/dma-mapping.c)."  Acked by Andrew Morton <akpm@linux-foundation.org>:  "Yup, this one please.  It's had much work, plenty of review and I   think even Russell is happy with it."  * 'for-linus' of git://git.linaro.org/people/mszyprowski/linux-dma-mapping: (28 commits)   ARM: dma-mapping: use PMD size for section unmap   cma: fix migration mode   ARM: integrate CMA with DMA-mapping subsystem   X86: integrate CMA with DMA-mapping subsystem   drivers: add Contiguous Memory Allocator   mm: trigger page reclaim in alloc_contig_range() to stabilise watermarks   mm: extract reclaim code from __alloc_pages_direct_reclaim()   mm: Serialize access to min_free_kbytes   mm: page_isolation: MIGRATE_CMA isolation functions added   mm: mmzone: MIGRATE_CMA migration type added   mm: page_alloc: change fallbacks array handling   mm: page_alloc: introduce alloc_contig_range()   mm: compaction: export some of the functions   mm: compaction: introduce isolate_freepages_range()   mm: compaction: introduce map_pages()   mm: compaction: introduce isolate_migratepages_range()   mm: page_alloc: remove trailing whitespace   ARM: dma-mapping: add support for IOMMU mapper   ARM: dma-mapping: use alloc, mmap, free from dma_ops   ARM: dma-mapping: remove redundant code and do the cleanup   ...  Conflicts: 	arch/x86/include/asm/dma-mapping.h
f | aer.h | s | 1.4K | 52 | Huang Ying | ying.huang@intel.com | 1311348337 |  | PCI: PCIe AER: add aer_recover_queue  In addition to native PCIe AER, now APEI (ACPI Platform Error Interface) GHES (Generic Hardware Error Source) can be used to report PCIe AER errors too.  To add support to APEI GHES PCIe AER recovery, aer_recover_queue is added to export the recovery function in native PCIe AER driver.  Recoverable PCIe AER errors are reported via NMI in APEI GHES.  Then APEI GHES uses irq_work to delay the error processing into an IRQ handler.  But PCIe AER recovery can be very time-consuming, so aer_recover_queue, which can be used in IRQ handler, delays the real recovery action into the process context, that is, work queue.  Signed-off-by: Huang Ying <ying.huang@intel.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | msi.h | s | 1.8K | 51 | Neil Horman | nhorman@tuxdriver.com | 1323109304 |  | PCI/sysfs: add per pci device msi[x] irq listing (v5)  This patch adds a per-pci-device subdirectory in sysfs called: /sys/bus/pci/devices/<device>/msi_irqs  This sub-directory exports the set of msi vectors allocated by a given pci device, by creating a numbered sub-directory for each vector beneath msi_irqs.  For each vector various attributes can be exported. Currently the only attribute is called mode, which tracks the operational mode of that vector (msi vs. msix)  Acked-by: Greg Kroah-Hartman <gregkh@suse.de> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | ftrace_event.h | s | 8.7K | 263 | Steven Rostedt | srostedt@redhat.com | 1336679743 |  | tracing: Do not enable function event with enable  With the adding of function tracing event to perf, it caused a side effect that produces the following warning when enabling all events in ftrace:   # echo 1 > /sys/kernel/debug/tracing/events/enable  [console] event trace: Could not enable event function  This is because when enabling all events via the debugfs system it ignores events that do not have a ->reg() function assigned. This was to skip over the ftrace internal events (as they are not TRACE_EVENTs). But as the ftrace function event now has a ->reg() function attached to it for use with perf, it is no longer ignored.  Worse yet, this ->reg() function is being called when it should not be. It returns an error and causes the above warning to be printed.  By adding a new event_call flag (TRACE_EVENT_FL_IGNORE_ENABLE) and have all ftrace internel event structures have it set, setting the events/enable will no longe try to incorrectly enable the function event and does not warn.  Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
f | atmel-mci.h | s | 1.2K | 35 | Ludovic Desroches | ludovic.desroches@atmel.com | 1319658205 |  | mmc: atmel-mci: change namespace  Homogenize namespace to atmci.  Signed-off-by: Ludovic Desroches <ludovic.desroches@atmel.com> Signed-off-by: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | vlynq.h | s | 3.9K | 136 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103952 |  | include: replace linux/module.h with "struct module" wherever possible  The <linux/module.h> pretty much brings in the kitchen sink along with it, so it should be avoided wherever reasonably possible in terms of being included from other commonly used <linux/something.h> files, as it results in a measureable increase on compile times.  The worst culprit was probably device.h since it is used everywhere. This file also had an implicit dependency/usage of mutex.h which was masked by module.h, and is also fixed here at the same time.  There are over a dozen other headers that simply declare the struct instead of pulling in the whole file, so follow their lead and simply make it a few more.  Most of the implicit dependencies on module.h being present by these headers pulling it in have been now weeded out, so we can finally make this change with hopefully minimal breakage.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | if_fc.h | s | 1.6K | 44 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233339792 |  | headers_check fix: linux/if_fc.h  fix the following 'make headers_check' warning:    usr/include/linux/if_fc.h:37: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | ioport.h | s | 8.8K | 197 | Wei Yang | weiyang@linux.vnet.ibm.com | 1336409937 |  | resources: add resource_overlaps()  Add resource_overlaps(), which returns true if two resources overlap at all.  Use this to replace the complicated check in coalesce_windows().  Signed-Off-By: Wei Yang <weiyang@linux.vnet.ibm.com> Signed-off-by: Bjorn Helgaas <bhelgaas@google.com>
f | mtio.h | s | 7.9K | 179 | Lee Duncan | lduncan@suse.com | 1332833194 |  | [SCSI] st: expand ability to write immediate filemarks  The st tape driver recently added the MTWEOFI ioctl, which writes a tape filemark (EOF), like the MTWEOF ioctl, except that MTWEOFI returns immediately. This makes certain applications, like backup software, run much more quickly on buffered tape drives.  Since legacy applications do not know about this new MTWEOFI ioctl, this patch adds a new ioctl option that tells the st driver to return immediately when writing an EOF (i.e. a filemark). This new flag is much like the existing flag that tells the st driver to perform writes (and certain other IOs) immediately, but this new flag only applies to writing EOFs.  This new feature is controlled via the MTSETDRVBUFFER ioctl, using the newly-defined MT_ST_NOWAIT_EOF flag.  Use of this new feature is displayed via the sysfs tape "options" attribute.  The st documentation was updated to mention this new flag, as well as the problems that can occur from using it.  Signed-off-by: Lee Duncan <lduncan@suse.com> Acked-by: Kai Makisara <kai.makisara@kolumbus.fi> Signed-off-by: James Bottomley <JBottomley@Parallels.com>
f | eisa.h | s | 2.9K | 86 | Greg Kroah-Hartman | gregkh@suse.de | 1245126626 |  | eisa: remove driver_data direct access of struct device  In the near future, the driver core is going to not allow direct access to the driver_data pointer in struct device.  Instead, the functions dev_get_drvdata() and dev_set_drvdata() should be used.  These functions have been around since the beginning, so are backwards compatible with all older kernel versions.   Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | z2_battery.h | s | 279B | 15 | Marek Vasut | marek.vasut@gmail.com | 1270571758 |  | Driver for Zipit Z2 battery chip  This patch adds driver for Zipit Z2 battery chip called AER915. No details are known about the chip. The chip is available through I2C bus at address 0x55 and it's register 0x02 contains battery voltage.  Signed-off-by: Marek Vasut <marek.vasut@gmail.com> Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>
f | cpuidle.h | s | 6.1K | 181 | Boris Ostrovsky | boris.ostrovsky@amd.com | 1333092210 |  | cpuidle: power_usage should be declared signed integer  power_usage is always assigned a negative value and should be declared a signed integer  Signed-off-by: Boris Ostrovsky <boris.ostrovsky@amd.com> Signed-off-by: Len Brown <len.brown@intel.com>
f | phonet.h | s | 4.7K | 171 | Dinesh Kumar Sharma | dinesh.sharma@stericsson.com | 1321645060 |  | Phonet: set the pipe handle using setsockopt  This provides flexibility to set the pipe handle using setsockopt. The pipe can be enabled (if disabled) later using ioctl.  Signed-off-by: Hemant Ramdasi <hemant.ramdasi@stericsson.com> Signed-off-by: Dinesh Kumar Sharma <dinesh.sharma@stericsson.com> Acked-by: R√©mi Denis-Courmont <remi.denis-courmont@nokia.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | fscache-cache.h | s | 17K | 443 | Joe Perches | joe@perches.com | 1320107454 |  | treewide: use __printf not __attribute__((format(printf,...)))  Standardize the style for compiler based printf format verification. Standardized the location of __printf too.  Done via script and a little typing.  $ grep -rPl --include=*.[ch] -w "__attribute__" * || \   grep -vP "^(tools||scripts||include/linux/compiler-gcc.h)" || \   xargs perl -n -i -e 'local $/; while (<>) { s/\b__attribute__\s*\(\s*\(\s*format\s*\(\s*printf\s*,\s*(.+)\s*,\s*(.+)\s*\)\s*\)\s*\)/__printf($1, $2)/g ; print; }'  [akpm@linux-foundation.org: revert arch bits] Signed-off-by: Joe Perches <joe@perches.com> Cc: "Kirill A. Shutemov" <kirill@shutemov.name> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mc6821.h | s | 1.1K | 45 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | i2c-omap.h | s | 1.3K | 33 | Kevin Hilman | khilman@ti.com | 1319877429 |  | I2C: OMAP: remove unused function pointers from pdata  Now that this driver is using runtime PM, there is no longer a need for the idle/enable/shutdown function pointers in pdata.  Signed-off-by: Kevin Hilman <khilman@ti.com>
f | spinlock_types.h | s | 2.0K | 70 | Thomas Gleixner | tglx@linutronix.de | 1296127838 |  | locking: Remove deprecated lock initializers  Last users are gone. Remove the left overs.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | semaphore.h | s | 1.4K | 39 | Thomas Gleixner | tglx@linutronix.de | 1315905117 |  | locking, semaphores: Annotate inner lock as raw  There is no reason to have the spin_lock protecting the semaphore preemptible on -rt. Annotate it as a raw_spinlock.  In mainline this change documents the low level nature of the lock - otherwise there's no functional difference. Lockdep and Sparse checking will work as usual.  ( On rt this also solves lockdep complaining about the   rt_mutex.wait_lock being not initialized. )  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | dm-dirty-log.h | s | 3.9K | 123 | Mikulas Patocka | mpatocka@redhat.com | 1260489121 |  | dm log: add flush callback fn  Introduce a callback pointer from the log to dm-raid1 layer.  Before some region is set as "in-sync", we need to flush hardware cache on all the disks. But the log module doesn't have access to the mirror_set structure. So it will use this callback.  So far the callback is unused, it will be used in further patches.  Signed-off-by: Mikulas Patocka <mpatocka@redhat.com> Signed-off-by: Alasdair G Kergon <agk@redhat.com>
f | cgroup.h | s | 19K | 566 | Tejun Heo | tj@kernel.org | 1334161008 |  | cgroup: remove cgroup_subsys->populate()  With memcg converted, cgroup_subsys->populate() doesn't have any user left.  Remove it.  Signed-off-by: Tejun Heo <tj@kernel.org> Acked-by: Li Zefan <lizefan@huawei.com>
f | atomic.h | s | 2.5K | 95 | Anton Blanchard | anton@samba.org | 1331100368 |  | atomic: Allow atomic_inc_not_zero to be overridden  We want to implement a ppc64 specific version of atomic_inc_not_zero so wrap it in an ifdef to allow it to be overridden.  Signed-off-by: Anton Blanchard <anton@samba.org> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | backlight.h | s | 4.1K | 114 | Matthew Garrett | mjg@redhat.com | 1300841039 |  | backlight: add backlight type  There may be multiple ways of controlling the backlight on a given machine.  Allow drivers to expose the type of interface they are providing, making it possible for userspace to make appropriate policy decisions.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Chris Wilson <chris@chris-wilson.co.uk> Cc: David Airlie <airlied@linux.ie> Cc: Alex Deucher <alexdeucher@gmail.com> Cc: Ben Skeggs <bskeggs@redhat.com> Cc: Zhang Rui <rui.zhang@intel.com> Cc: Len Brown <lenb@kernel.org> Cc: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ipmi_msgdefs.h | s | 4.4K | 107 | dann frazier | dannf@hp.com | 1240346508 |  | ipmi: add oem message handling  Enable userspace to receive messages that a BMC transmits using an OEM medium.  This is used by the HP iLO2.  Based on code originally written by Patrick Schoeller.  Signed-off-by: dann frazier <dannf@hp.com> Signed-off-by: Corey Minyard <cminyard@mvista.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | loop.h | s | 4.1K | 145 | Linus Torvalds | torvalds@linux-foundation.org | 1320452534 |  | Merge branch 'for-3.2/drivers' of git://git.kernel.dk/linux-block  * 'for-3.2/drivers' of git://git.kernel.dk/linux-block: (30 commits)   virtio-blk: use ida to allocate disk index   hpsa: add small delay when using PCI Power Management to reset for kump   cciss: add small delay when using PCI Power Management to reset for kump   xen/blkback: Fix two races in the handling of barrier requests.   xen/blkback: Check for proper operation.   xen/blkback: Fix the inhibition to map pages when discarding sector ranges.   xen/blkback: Report VBD_WSECT (wr_sect) properly.   xen/blkback: Support 'feature-barrier' aka old-style BARRIER requests.   xen-blkfront: plug device number leak in xlblk_init() error path   xen-blkfront: If no barrier or flush is supported, use invalid operation.   xen-blkback: use kzalloc() in favor of kmalloc()+memset()   xen-blkback: fixed indentation and comments   xen-blkfront: fix a deadlock while handling discard response   xen-blkfront: Handle discard requests.   xen-blkback: Implement discard requests ('feature-discard')   xen-blkfront: add BLKIF_OP_DISCARD and discard request struct   drivers/block/loop.c: remove unnecessary bdev argument from loop_clr_fd()   drivers/block/loop.c: emit uevent on auto release   drivers/block/cpqarray.c: use pci_dev->revision   loop: always allow userspace partitions and optionally support automatic scanning   ...  Fic up trivial header file includsion conflict in drivers/block/loop.c
f | linkage.h | s | 2.0K | 76 | Joe Perches | joe@perches.com | 1326427983 |  | include/linux/linkage.h: remove unused ATTRIB_NORET macro  The uses have been renamed so delete the unused macro.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | fsl_devices.h | s | 4.0K | 127 | Ramneek Mehresh | ramneek.mehresh@freescale.com | 1334782002 |  | fsl/usb: Add controller version based ULPI and UTMI phy support  Add support for ULPI and UTMI PHYs based on usb controller version info read from device-tree  Example of USB Controller versioning info: Version 1.2 and below : MPC8536, MPC8315, etc Version 1.6 : P1020, P1010, P2020, P5020, etc Version 2.2 : PSC9131, PSC9132, P3060, etc  No changes for non-DT users  Signed-off-by: Ramneek Mehresh <ramneek.mehresh@freescale.com> Acked-by: Li Yang <leoli@freescale.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | capi.h | s | 3.0K | 103 | Jaswinder Singh Rajput | jaswinder@infradead.org | 1232066381 |  | include of <linux/types.h> is preferred over <asm/types.h>  Impact: fix 15 make headers_check warnings:  include of <linux/types.h> is preferred over <asm/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | vga_switcheroo.h | s | 2.5K | 63 | Ozan √áaƒülayan | ozancag@gmail.com | 1340267536 |  | vga_switcheroo: Add include guard  Guard vga_switcheroo.h against multiple inclusion.  Signed-off-by: Ozan √áaƒülayan <ozancag@gmail.com> Signed-off-by: Dave Airlie <airlied@redhat.com>
f | capability.h | s | 17K | 427 | Linus Torvalds | torvalds@linux-foundation.org | 1337820159 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/ebiederm/user-namespace  Pull user namespace enhancements from Eric Biederman:  "This is a course correction for the user namespace, so that we can   reach an inexpensive, maintainable, and reasonably complete   implementation.    Highlights:    - Config guards make it impossible to enable the user namespace and      code that has not been converted to be user namespace safe.     - Use of the new kuid_t type ensures the if you somehow get past the      config guards the kernel will encounter type errors if you enable      user namespaces and attempt to compile in code whose permission      checks have not been updated to be user namespace safe.     - All uids from child user namespaces are mapped into the initial      user namespace before they are processed.  Removing the need to add      an additional check to see if the user namespace of the compared      uids remains the same.     - With the user namespaces compiled out the performance is as good or      better than it is today.     - For most operations absolutely nothing changes performance or      operationally with the user namespace enabled.     - The worst case performance I could come up with was timing 1      billion cache cold stat operations with the user namespace code      enabled.  This went from 156s to 164s on my laptop (or 156ns to      164ns per stat operation).     - (uid_t)-1 and (gid_t)-1 are reserved as an internal error value.      Most uid/gid setting system calls treat these value specially      anyway so attempting to use -1 as a uid would likely cause      entertaining failures in userspace.     - If setuid is called with a uid that can not be mapped setuid fails.      I have looked at sendmail, login, ssh and every other program I      could think of that would call setuid and they all check for and      handle the case where setuid fails.     - If stat or a similar system call is called from a context in which      we can not map a uid we lie and return overflowuid.  The LFS      experience suggests not lying and returning an error code might be      better, but the historical precedent with uids is different and I      can not think of anything that would break by lying about a uid we      can't map.     - Capabilities are localized to the current user namespace making it      safe to give the initial user in a user namespace all capabilities.    My git tree covers all of the modifications needed to convert the core   kernel and enough changes to make a system bootable to runlevel 1."  Fix up trivial conflicts due to nearby independent changes in fs/stat.c  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/ebiederm/user-namespace: (46 commits)   userns:  Silence silly gcc warning.   cred: use correct cred accessor with regards to rcu read lock   userns: Convert the move_pages, and migrate_pages permission checks to use uid_eq   userns: Convert cgroup permission checks to use uid_eq   userns: Convert tmpfs to use kuid and kgid where appropriate   userns: Convert sysfs to use kgid/kuid where appropriate   userns: Convert sysctl permission checks to use kuid and kgids.   userns: Convert proc to use kuid/kgid where appropriate   userns: Convert ext4 to user kuid/kgid where appropriate   userns: Convert ext3 to use kuid/kgid where appropriate   userns: Convert ext2 to use kuid/kgid where appropriate.   userns: Convert devpts to use kuid/kgid where appropriate   userns: Convert binary formats to use kuid/kgid where appropriate   userns: Add negative depends on entries to avoid building code that is userns unsafe   userns: signal remove unnecessary map_cred_ns   userns: Teach inode_capable to understand inodes whose uids map to other namespaces.   userns: Fail exec for suid and sgid binaries with ids outside our user namespace.   userns: Convert stat to return values mapped from kuids and kgids   userns: Convert user specfied uids and gids in chown into kuids and kgid   userns: Use uid_eq gid_eq helpers when comparing kuids and kgids in the vfs   ...
f | blktrace_api.h | s | 7.6K | 222 | Joe Perches | joe@perches.com | 1320107454 |  | treewide: use __printf not __attribute__((format(printf,...)))  Standardize the style for compiler based printf format verification. Standardized the location of __printf too.  Done via script and a little typing.  $ grep -rPl --include=*.[ch] -w "__attribute__" * || \   grep -vP "^(tools||scripts||include/linux/compiler-gcc.h)" || \   xargs perl -n -i -e 'local $/; while (<>) { s/\b__attribute__\s*\(\s*\(\s*format\s*\(\s*printf\s*,\s*(.+)\s*,\s*(.+)\s*\)\s*\)\s*\)/__printf($1, $2)/g ; print; }'  [akpm@linux-foundation.org: revert arch bits] Signed-off-by: Joe Perches <joe@perches.com> Cc: "Kirill A. Shutemov" <kirill@shutemov.name> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | minix_fs.h | s | 2.0K | 93 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233340235 |  | headers_check fix: linux/minix_fs.h  fix the following 'make headers_check' warning:    usr/include/linux/minix_fs.h:34: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | gameport.h | s | 6.1K | 189 | Axel Lin | axel.lin@gmail.com | 1333556744 |  | Input: gameport - add helper macro for gameport_driver boilerplate  This patch introduces the module_gameport_driver macro which is a convenience macro for gameport driver modules similar to module_platform_driver. It is intended to be used by drivers which init/exit section does nothing but registers/unregisters the gameport driver. By using this macro it is possible to eliminate a few lines of boilerplate code per gameport driver.  Based on work done by Lars-Peter Clausen <lars@metafoo.de> for other buses (i2c and spi).  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | backing-dev.h | s | 10K | 293 | Curt Wohlgemuth | curtw@google.com | 1319992416 |  | writeback: Add a 'reason' to wb_writeback_work  This creates a new 'reason' field in a wb_writeback_work structure, which unambiguously identifies who initiates writeback activity.  A 'wb_reason' enumeration has been added to writeback.h, to enumerate the possible reasons.  The 'writeback_work_class' and tracepoint event class and 'writeback_queue_io' tracepoints are updated to include the symbolic 'reason' in all trace events.  And the 'writeback_inodes_sbXXX' family of routines has had a wb_stats parameter added to them, so callers can specify why writeback is being started.  Acked-by: Jan Kara <jack@suse.cz> Signed-off-by: Curt Wohlgemuth <curtw@google.com> Signed-off-by: Wu Fengguang <fengguang.wu@intel.com>
f | com20020.h | s | 3.5K | 99 | David S. Miller | davem@davemloft.net | 1232778528 |  | com20020: Fix allyesconfig build failure.  Reported by Stephen Rothwell.  Due to missing 'extern' in the com20020_netdev_ops declaration, each file that includes linux/com20020.h gets another copy defined in it's resulting object file.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | pps-gpio.h | s | 1015B | 29 | James Nuss | jamesnuss@nanometrics.ca | 1320275222 |  | pps: new client driver using GPIO  This client driver allows you to use a GPIO pin as a source for PPS signals.  Platform data [1] are used to specify the GPIO pin number, label, assert event edge type, and whether clear events are captured.  This driver is based on the work by Ricardo Martins who submitted an initial implementation [2] of a PPS IRQ client driver to the linuxpps mailing-list on Dec 3 2010.  [1] include/linux/pps-gpio.h [2] http://ml.enneenne.com/pipermail/linuxpps/2010-December/004155.html  [akpm@linux-foundation.org: remove unneeded cast of void*] Signed-off-by: James Nuss <jamesnuss@nanometrics.ca> Cc: Ricardo Martins <rasm@fe.up.pt> Acked-by: Rodolfo Giometti <giometti@linux.it> Signed-off-by: Ricardo Martins <rasm@fe.up.pt> Cc: Alexander Gordeev <lasaine@lvk.cs.msu.su> Cc: Igor Plyatov <plyatov@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dma-buf.h | s | 9.2K | 253 | Sumit Semwal | sumit.semwal@ti.com | 1337930183 |  | dma-buf: minor documentation fixes.  Some minor inline documentation fixes for gaps resulting from new patches.  Signed-off-by: Sumit Semwal <sumit.semwal@ti.com> Signed-off-by: Sumit Semwal <sumit.semwal@linaro.org>
f | zorro.h | s | 6.5K | 179 | Joe Perches | joe@perches.com | 1307710536 |  | treewide: Convert uses of struct resource to resource_size(ptr)  Several fixes as well where the +1 was missing.  Done via coccinelle scripts like:  @@ struct resource *ptr; @@  - ptr->end - ptr->start + 1 + resource_size(ptr)  and some grep and typing.  Mostly uncompiled, no cross-compilers.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | i2c-algo-pca.h | s | 2.5K | 58 | Marco Aurelio da Costa | costa@gamic.com | 1238272484 |  | i2c-algo-pca: Add PCA9665 support  Add support for the PCA9665 I2C controller.  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | efs_vh.h | s | 1.5K | 44 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | i2c-algo-bit.h | s | 2.2K | 46 | Jean Delvare | khali@linux-fr.org | 1332791239 |  | i2c: Update the FSF address  Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | mutex.h | s | 5.4K | 158 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | memory.h | s | 4.5K | 138 | Kay Sievers | kay.sievers@vrfy.org | 1324507723 |  | convert 'memory' sysdev_class to a regular subsystem  This moves the 'memory sysdev_class' over to a regular 'memory' subsystem and converts the devices to regular devices. The sysdev drivers are implemented as subsystem interfaces now.  After all sysdev classes are ported to regular driver core entities, the sysdev implementation will be entirely removed from the kernel.  Signed-off-by: Kay Sievers <kay.sievers@vrfy.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | ncp_no.h | s | 651B | 17 | Harvey Harrison | harvey.harrison@gmail.com | 1234681115 |  | net: replace __constant_{endian} uses in net headers  Base versions handle constant folding now.  For headers exposed to userspace, we must only expose the __ prefixed versions.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | clksrc-dbx500-prcmu.h | s | 455B | 17 | Linus Walleij | linus.walleij@linaro.org | 1317627256 |  | clocksource: fixup ux500 build problems  Based on a patch from Arnd Bergmann this fixes up the build problem of assigning a non-existing global when the ux500 PRCMU timer is not linked in by passing its base address to the init function. We also add a missing <linux/errno.h> inclusion and staticize the dummy function.  Cc: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | proportions.h | s | 3.2K | 113 | Wu Fengguang | fengguang.wu@intel.com | 1328086426 |  | lib: proportion: lower PROP_MAX_SHIFT to 32 on 64-bit kernel  PROP_MAX_SHIFT should be set to <=32 on 64-bit box. This fixes two bugs in the below lines of bdi_dirty_limit():  	bdi_dirty *= numerator; 	do_div(bdi_dirty, denominator);  1) divide error: do_div() only uses the lower 32 bit of the denominator,    which may trimmed to be 0 when PROP_MAX_SHIFT > 32.  2) overflow: (bdi_dirty * numerator) could easily overflow if numerator    used up to 48 bits, leaving only 16 bits to bdi_dirty  Cc: <stable@kernel.org> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Reported-by: Ilya Tumaykin <librarian_rus@yahoo.com> Tested-by: Ilya Tumaykin <librarian_rus@yahoo.com> Signed-off-by: Wu Fengguang <fengguang.wu@intel.com>
f | u64_stats_sync.h | s | 4.2K | 131 | Jesper Juhl | jj@chaosbits.net | 1290982084 |  | Kill off a bunch of warning: ‚Äòinline‚Äô is not at beginning of declaration  These warnings are spewed during a build of a 'allnoconfig' kernel (especially the ones from u64_stats_sync.h show up a lot) when building with -Wextra (which I often do).. They are   a) annoying   b) easy to get rid of. This patch kills them off.  include/linux/u64_stats_sync.h:70:1: warning: ‚Äòinline‚Äô is not at beginning of declaration include/linux/u64_stats_sync.h:77:1: warning: ‚Äòinline‚Äô is not at beginning of declaration include/linux/u64_stats_sync.h:84:1: warning: ‚Äòinline‚Äô is not at beginning of declaration include/linux/u64_stats_sync.h:96:1: warning: ‚Äòinline‚Äô is not at beginning of declaration include/linux/u64_stats_sync.h:115:1: warning: ‚Äòinline‚Äô is not at beginning of declaration include/linux/u64_stats_sync.h:127:1: warning: ‚Äòinline‚Äô is not at beginning of declaration kernel/time.c:241:1: warning: ‚Äòinline‚Äô is not at beginning of declaration kernel/time.c:257:1: warning: ‚Äòinline‚Äô is not at beginning of declaration kernel/perf_event.c:4513:1: warning: ‚Äòinline‚Äô is not at beginning of declaration mm/page_alloc.c:4012:1: warning: ‚Äòinline‚Äô is not at beginning of declaration  Signed-off-by: Jesper Juhl <jj@chaosbits.net> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | fixp-arith.h | s | 2.2K | 71 | Antonio Ospite | ospite@studenti.unina.it | 1336999643 |  | [media] Input: move drivers/input/fixp-arith.h to include/linux  Move drivers/input/fixp-arith.h to include/linux so that the functions defined there can be used by other subsystems, for instance some video devices ISPs can control the output HUE value by setting registers for sin(HUE) and cos(HUE).  Signed-off-by: Antonio Ospite <ospite@studenti.unina.it> Acked-by: Dmitry Torokhov <dmitry.torokhov@gmail.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | pci-ats.h | s | 2.6K | 97 | Joerg Roedel | joerg.roedel@amd.com | 1320081837 |  | PCI: Fix compile errors with PCI_ATS and !PCI_IOV  The ats and sroiv members of 'struct pci_dev' are required for the ATS code already, even without IOV support compiled in. So depend on ATS here. This is fine with PCI_IOV too because it selects PCI_ATS. Also the prototypes for ATS need to be available for PCI_ATS.  Reported-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Joerg Roedel <joerg.roedel@amd.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | drbd_tag_magic.h | s | 2.8K | 74 | Joe Perches | joe@perches.com | 1316088177 |  | drbd: Use angle brackets for system includes  Use the normal include style.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | spinlock_up.h | s | 2.1K | 62 | Stephen Rothwell | sfr@canb.auug.org.au | 1305921067 |  | spinlock_up.h: include asm/processor.h in for cpu_relax  Commit e66eed651fd1 ("list: remove prefetching from regular list iterators") removed the include of prefetch.h from list.h and this was a path to including asm/processor.h.  We need to include it excplicitly now.  Fixes this build error on sparc32 (at least):    In file included from include/linux/seqlock.h:29,                    from include/linux/time.h:8,                    from include/linux/timex.h:56,                    from include/linux/sched.h:57,                    from arch/sparc/kernel/asm-offsets.c:13:   include/linux/spinlock.h: In function 'spin_unlock_wait':   include/linux/spinlock.h:360: error: implicit declaration of function 'cpu_relax  Signed-off-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | task_io_accounting.h | s | 1.1K | 41 | Francois Cami | francois.cami@free.fr | 1224181292 |  | Remove Andrew Morton's old email accounts  People can use the real name an an index into MAINTAINERS to find the current email address.  Signed-off-by: Francois Cami <francois.cami@free.fr> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | average.h | s | 653B | 23 | Bruno Randolf | br1@einfach.org | 1291669123 |  | lib: Improve EWMA efficiency by using bitshifts  Using bitshifts instead of division and multiplication should improve performance. That requires weight and factor to be powers of two, but i think this is something we can live with.  Thanks to Peter Zijlstra for the improved formula!  Signed-off-by: Bruno Randolf <br1@einfach.org>  --  v2:	use log2.h functions Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | altera_uart.h | s | 358B | 12 | Tobias Klauser | tklauser@distanz.ch | 1328807063 |  | tty: serial: altera_uart: remove early_altera_uart_setup  The function has no users inside the tree and the nios2 (out-of-mainline) port doesn't use it either (anymore).  Signed-off-by: Tobias Klauser <tklauser@distanz.ch> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | bma150.h | s | 1.6K | 41 | Eric Andersson | eric.andersson@unixphere.com | 1312878784 |  | Input: add driver for Bosch Sensortec's BMA150 accelerometer  Signed-off-by: Albert Zhang <xu.zhang@bosch-sensortec.com> Signed-off-by: Eric Andersson <eric.andersson@unixphere.com> Acked-by: Jonathan Cameron <jic23@cam.ac.uk> Reviewed-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | patchkey.h | s | 1.1K | 42 | David Howells | dhowells@redhat.com | 1323788869 |  | UAPI: Make linux/patchkey.h easier to parse  Make linux/patchkey.h easier to parse by making the #elif case associated with the __KERNEL__ guard a nested #if in a #else of the __KERNEL__ guard.  Signed-off-by: David Howells <dhowells@redhat.com>
f | dma-attrs.h | s | 1.8K | 68 | Marek Szyprowski | m.szyprowski@samsung.com | 1332945404 |  | common: DMA-mapping: add NON-CONSISTENT attribute  DMA_ATTR_NON_CONSISTENT lets the platform to choose to return either consistent or non-consistent memory as it sees fit.  By using this API, you are guaranteeing to the platform that you have all the correct and necessary sync points for this memory in the driver.  Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com> Acked-by: Kyungmin Park <kyungmin.park@samsung.com> Reviewed-by: Arnd Bergmann <arnd@arndb.de>
f | cleancache.h | s | 3.8K | 106 | Dan Magenheimer | dan.magenheimer@oracle.com | 1327352797 |  | mm: zcache/tmem/cleancache: s/flush/invalidate/  Complete the renaming from "flush" to "invalidate" across both tmem frontends (cleancache and frontswap) and both tmem backends (Xen and zcache), as required by akpm.  This change is completely cosmetic.  [v10: no change] [v9: akpm@linux-foundation.org: change "flush" to "invalidate", part 3] Signed-off-by: Dan Magenheimer <dan.magenheimer@oracle.com> Cc: Kamezawa Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Jan Beulich <JBeulich@novell.com> Acked-by: Seth Jennings <sjenning@linux.vnet.ibm.com> Cc: Jeremy Fitzhardinge <jeremy@goop.org> Cc: Hugh Dickins <hughd@google.com> Cc: Johannes Weiner <hannes@cmpxchg.org> Cc: Nitin Gupta <ngupta@vflare.org> Cc: Matthew Wilcox <matthew@wil.cx> Cc: Chris Mason <chris.mason@oracle.com> Cc: Rik Riel <riel@redhat.com> Cc: Andrew Morton <akpm@linux-foundation.org> [v11: Remove the frontswap part] Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | neighbour.h | s | 4.0K | 140 | John Fastabend | john.r.fastabend@intel.com | 1334509564 |  | net: add generic PF_BRIDGE:RTM_ FDB hooks  This adds two new flags NTF_MASTER and NTF_SELF that can now be used to specify where PF_BRIDGE netlink commands should be sent. NTF_MASTER sends the commands to the 'dev->master' device for parsing. Typically this will be the linux net/bridge, or open-vswitch devices. Also without any flags set the command will be handled by the master device as well so that current user space tools continue to work as expected.  The NTF_SELF flag will push the PF_BRIDGE commands to the device. In the basic example below the commands are then parsed and programmed in the embedded bridge.  Note if both NTF_SELF and NTF_MASTER bits are set then the command will be sent to both 'dev->master' and 'dev' this allows user space to easily keep the embedded bridge and software bridge in sync.  There is a slight complication in the case with both flags set when an error occurs. To resolve this the rtnl handler clears the NTF_ flag in the netlink ack to indicate which sets completed successfully. The add/del handlers will abort as soon as any error occurs.  To support this new net device ops were added to call into the device and the existing bridging code was refactored to use these. There should be no required changes in user space to support the current bridge behavior.  A basic setup with a SR-IOV enabled NIC looks like this,            veth0  veth2             ||      ||           ------------           ||  bridge0 ||   <---- software bridging           ------------                /                /   ethx.y      ethx     VF         PF      \         \          <---- propagate FDB entries to HW      \         \   --------------------   ||  Embedded Bridge ||    <---- hardware offloaded switching   --------------------  In this case the embedded bridge must be managed to allow 'veth0' to communicate with 'ethx.y' correctly. At present drivers managing the embedded bridge either send frames onto the network which then get dropped by the switch OR the embedded bridge will flood these frames. With this patch we have a mechanism to manage the embedded bridge correctly from user space. This example is specific to SR-IOV but replacing the VF with another PF or dropping this into the DSA framework generates similar management issues.  Examples session using the 'br'[1] tool to add, dump and then delete a mac address with a new "embedded" option and enabled ixgbe driver:  # br fdb add 22:35:19:ac:60:59 dev eth3 # br fdb port    mac addr                flags veth0   22:35:19:ac:60:58       static veth0   9a:5f:81:f7:f6:ec       local eth3    00:1b:21:55:23:59       local eth3    22:35:19:ac:60:59       static veth0   22:35:19:ac:60:57       static #br fdb add 22:35:19:ac:60:59 embedded dev eth3 #br fdb port    mac addr                flags veth0   22:35:19:ac:60:58       static veth0   9a:5f:81:f7:f6:ec       local eth3    00:1b:21:55:23:59       local eth3    22:35:19:ac:60:59       static veth0   22:35:19:ac:60:57       static eth3    22:35:19:ac:60:59       local embedded #br fdb del 22:35:19:ac:60:59 embedded dev eth3  I added a couple lines to 'br' to set the flags correctly is all. It is my opinion that the merit of this patch is now embedded and SW bridges can both be modeled correctly in user space using very nearly the same message passing.  [1] 'br' tool was published as an RFC here and will be renamed 'bridge'     http://patchwork.ozlabs.org/patch/117664/  Thanks to Jamal Hadi Salim, Stephen Hemminger and Ben Hutchings for valuable feedback, suggestions, and review.  v2: fixed api descriptions and error case with both NTF_SELF and     NTF_MASTER set plus updated patch description.  Signed-off-by: John Fastabend <john.r.fastabend@intel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | v4l2-dv-timings.h | s | 25K | 708 | Hans Verkuil | hans.verkuil@cisco.com | 1337513264 |  | [media] v4l2-dv-timings.h: definitions for CEA-861 and VESA DMT timings  This header contains the timings for the common CEA-861 and all VESA DMT formats for use with the V4L2 dv_timings API.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Reviewed-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | perf_event.h | s | 36K | 1195 | Arun Sharma | asharma@fb.com | 1338995280 |  | perf: Limit callchains to 127  Stack depth of 255 seems excessive, given that copy_from_user_nmi() could be slow.  Signed-off-by: Arun Sharma <asharma@fb.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: linux-kernel@vger.kernel.org Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Link: http://lkml.kernel.org/r/1334961696-19580-3-git-send-email-asharma@fb.com Signed-off-by: Ingo Molnar <mingo@kernel.org>
f | hugetlb.h | s | 9.0K | 268 | Chris Metcalf | cmetcalf@tilera.com | 1337964506 |  | mm: add new arch_make_huge_pte() method for tile support  The tile support for multiple-size huge pages requires tagging the hugetlb PTE with a "super" bit for PTEs that are multiples of the basic size of a pagetable span.  To set that bit properly we need to tweak the PTe in make_huge_pte() based on the vma.  This change provides the API for a subsequent tile-specific change to use.  Reviewed-by: Hillf Danton <dhillf@gmail.com> Signed-off-by: Chris Metcalf <cmetcalf@tilera.com>
f | miscdevice.h | s | 1.8K | 61 | stephen hemminger | shemminger@vyatta.com | 1326478343 |  | vhost-net: add module alias (v2.1)  By adding some module aliases, programs (or users) won't have to explicitly call modprobe. Vhost-net will always be available if built into the kernel. It does require assigning a permanent minor number for depmod to work.  Also:   - use C99 style initialization.   - add missing entry in documentation for loop-control  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Acked-By: Kay Sievers <kay.sievers@vrfy.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ftrace_irq.h | s | 298B | 10 | Steven Rostedt | srostedt@redhat.com | 1234055013 |  | ring-buffer: use generic version of in_nmi  Impact: clean up  Now that a generic in_nmi is available, this patch removes the special code in the ring_buffer and implements the in_nmi generic version instead.  With this change, I was also able to rename the "arch_ftrace_nmi_enter" back to "ftrace_nmi_enter" and remove the code from the ring buffer.  Signed-off-by: Steven Rostedt <srostedt@redhat.com>
f | journal-head.h | s | 2.7K | 90 | Jan Kara | jack@suse.cz | 1331693125 |  | jbd2: remove bh_state lock from checkpointing code  All accesses to checkpointing entries in journal_head are protected by j_list_lock. Thus __jbd2_journal_remove_checkpoint() doesn't really need bh_state lock.  Also the only part of journal head that the rest of checkpointing code needs to check is jh->b_transaction which is safe to read under j_list_lock.  So we can safely remove bh_state lock from all of checkpointing code which makes it considerably prettier.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: "Theodore Ts'o" <tytso@mit.edu>
f | rwsem-spinlock.h | s | 1.5K | 39 | Thomas Gleixner | tglx@linutronix.de | 1315905119 |  | locking, rwsem: Annotate inner lock as raw  There is no reason to allow the lock protecting rwsems (the ownerless variant) to be preemptible on -rt. Convert it to raw.  In mainline this change documents the low level nature of the lock - otherwise there's no functional difference. Lockdep and Sparse checking will work as usual.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | mempool.h | s | 2.3K | 62 | Sage Weil | sage@newdream.net | 1253629055 |  | mm: remove broken 'kzalloc' mempool  The kzalloc mempool zeros items when they are initially allocated, but does not rezero used items that are returned to the pool.  Consequently mempool_alloc()s may return non-zeroed memory.  Since there are/were only two in-tree users for mempool_create_kzalloc_pool(), and 'fixing' this in a way that will re-zero used (but not new) items before first use is non-trivial, just remove it.  Signed-off-by: Sage Weil <sage@newdream.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | serial_mfd.h | s | 1.3K | 39 | Feng Tang | feng.tang@intel.com | 1281473266 |  | hsu: driver for Medfield High Speed UART device  This is a PCI & UART driver, which suppors both PIO and DMA mode UART operation. It has 3 identical UART ports and one internal DMA controller.  Current FW will export 4 pci devices for hsu: 3 uart ports and 1 dma controller, each has one IRQ line. And we need to discuss the device model, one PCI device covering whole HSU should be a better model, but there is a problem of how to export the 4 IRQs info  Current driver set the highest baud rate to 2746800bps, which is easy to scale down to 115200/230400.... To suport higher baud rate, we need add special process, change DLAB/DLH/PS/DIV/MUL registers all together.  921600 is the highest baud rate that has been tested with Bluetooth modem connected to HSU port 0. Will test more when there is right BT firmware.  Current version contains several work around for A0's Silicon bugs  Signed-off-by: Feng Tang <feng.tang@intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | bit_spinlock.h | s | 2.3K | 92 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | atm_zatm.h | s | 1.6K | 39 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | linux_logo.h | s | 2.0K | 52 | Geert Uytterhoeven | Geert.Uytterhoeven@sonycom.com | 1245206877 |  | fbdev: move logo externs to header file  Now we have __initconst, we can finally move the external declarations for the various Linux logo structures to <linux/linux_logo.h>.  James' ack dates back to the previous submission (way to long ago), when the logos were still __initdata, which caused failures on some platforms with some toolchain versions.  Signed-off-by: Geert Uytterhoeven <Geert.Uytterhoeven@sonycom.com> Acked-by: James Simmons <jsimmons@infradead.org> Cc: Krzysztof Helt <krzysztof.h1@poczta.fm> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | isdnif.h | s | 21K | 487 | Eric Dumazet | eric.dumazet@gmail.com | 1275560512 |  | net: use __packed annotation  cleanup patch.  Use new __packed annotation in net/ and include/ (except netfilter)  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | jbd2.h | s | 40K | 1127 | Darrick J. Wong | djwong@us.ibm.com | 1338120762 |  | ext4/jbd2: add metadata checksumming to the list of supported features  Activate the metadata checksumming feature by adding it to ext4 and jbd2's lists of supported features.  Signed-off-by: Darrick J. Wong <djwong@us.ibm.com> Signed-off-by: "Theodore Ts'o" <tytso@mit.edu>
f | uwb.h | s | 25K | 746 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103951 |  | uwb.h: fix implicit use of asm/page.h for PAGE_SIZE  Once we clean up the implicit presence of module.h (and all its sub-includes), we'll see an implicit dependency on page.h for the PAGE_SIZE define.  So fix it in advance.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | dm-log-userspace.h | s | 14K | 389 | Jonathan E Brassow | jbrassow@redhat.com | 1320092484 |  | dm log userspace: add log device dependency  Allow userspace dm log implementations to register their log device so it is no longer missing from the list of device dependencies.  When device mapper targets use a device they normally call dm_get_device which includes it in the device list returned to userspace applications such as LVM through the DM_TABLE_DEPS ioctl.  Userspace log devices don't use dm_get_device as userspace opens them so they are missing from the list of dependencies.  This patch extends the DM_ULOG_CTR operation to allow userspace to respond with the name of the log device (if appropriate) to be registered via 'dm_get_device'.  DM_ULOG_REQUEST_VERSION is incremented.  This is backwards compatible.  If the kernel and userspace log server have both been updated, the new information will be passed down to the kernel and the device will be registered.  If the kernel is new, but the log server is old, the log server will not pass down any device information and the kernel will simply bypass the device registration as before.  If the kernel is old but the log server is new, the log server will see the old version number and not pass the device info.  Signed-off-by: Jonathan Brassow <jbrassow@redhat.com> Signed-off-by: Alasdair G Kergon <agk@redhat.com>
f | syscore_ops.h | s | 635B | 24 | Rafael J. Wysocki | rjw@sisk.pl | 1300146226 |  | PM / Core: Introduce struct syscore_ops for core subsystems PM  Some subsystems need to carry out suspend/resume and shutdown operations with one CPU on-line and interrupts disabled.  The only way to register such operations is to define a sysdev class and a sysdev specifically for this purpose which is cumbersome and inefficient.  Moreover, the arguments taken by sysdev suspend, resume and shutdown callbacks are practically never necessary.  For this reason, introduce a simpler interface allowing subsystems to register operations to be executed very late during system suspend and shutdown and very early during resume in the form of strcut syscore_ops objects.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl> Acked-by: Greg Kroah-Hartman <gregkh@suse.de>
f | binfmts.h | s | 4.4K | 120 | Al Viro | viro@zeniv.linux.org.uk | 1332293386 |  | __register_binfmt() made void  Just don't pass NULL to it - nobody does, anyway.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | irqflags.h | s | 4.7K | 135 | David Howells | dhowells@redhat.com | 1286456935 |  | Fix IRQ flag handling naming  Fix the IRQ flag handling naming.  In linux/irqflags.h under one configuration, it maps:  	local_irq_enable() -> raw_local_irq_enable() 	local_irq_disable() -> raw_local_irq_disable() 	local_irq_save() -> raw_local_irq_save() 	...  and under the other configuration, it maps:  	raw_local_irq_enable() -> local_irq_enable() 	raw_local_irq_disable() -> local_irq_disable() 	raw_local_irq_save() -> local_irq_save() 	...  This is quite confusing.  There should be one set of names expected of the arch, and this should be wrapped to give another set of names that are expected by users of this facility.  Change this to have the arch provide:  	flags = arch_local_save_flags() 	flags = arch_local_irq_save() 	arch_local_irq_restore(flags) 	arch_local_irq_disable() 	arch_local_irq_enable() 	arch_irqs_disabled_flags(flags) 	arch_irqs_disabled() 	arch_safe_halt()  Then linux/irqflags.h wraps these to provide:  	raw_local_save_flags(flags) 	raw_local_irq_save(flags) 	raw_local_irq_restore(flags) 	raw_local_irq_disable() 	raw_local_irq_enable() 	raw_irqs_disabled_flags(flags) 	raw_irqs_disabled() 	raw_safe_halt()  with type checking on the flags 'arguments', and then wraps those to provide:  	local_save_flags(flags) 	local_irq_save(flags) 	local_irq_restore(flags) 	local_irq_disable() 	local_irq_enable() 	irqs_disabled_flags(flags) 	irqs_disabled() 	safe_halt()  with tracing included if enabled.  The arch functions can now all be inline functions rather than some of them having to be macros.  Signed-off-by: David Howells <dhowells@redhat.com> [X86, FRV, MN10300] Signed-off-by: Chris Metcalf <cmetcalf@tilera.com> [Tile] Signed-off-by: Michal Simek <monstr@monstr.eu> [Microblaze] Tested-by: Catalin Marinas <catalin.marinas@arm.com> [ARM] Acked-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Haavard Skinnemoen <haavard.skinnemoen@atmel.com> [AVR] Acked-by: Tony Luck <tony.luck@intel.com> [IA-64] Acked-by: Hirokazu Takata <takata@linux-m32r.org> [M32R] Acked-by: Greg Ungerer <gerg@uclinux.org> [M68K/M68KNOMMU] Acked-by: Ralf Baechle <ralf@linux-mips.org> [MIPS] Acked-by: Kyle McMartin <kyle@mcmartin.ca> [PA-RISC] Acked-by: Paul Mackerras <paulus@samba.org> [PowerPC] Acked-by: Martin Schwidefsky <schwidefsky@de.ibm.com> [S390] Acked-by: Chen Liqin <liqin.chen@sunplusct.com> [Score] Acked-by: Matt Fleming <matt@console-pimps.org> [SH] Acked-by: David S. Miller <davem@davemloft.net> [Sparc] Acked-by: Chris Zankel <chris@zankel.net> [Xtensa] Reviewed-by: Richard Henderson <rth@twiddle.net> [Alpha] Reviewed-by: Yoshinori Sato <ysato@users.sourceforge.jp> [H8300] Cc: starvik@axis.com [CRIS] Cc: jesper.nilsson@axis.com [CRIS] Cc: linux-cris-kernel@axis.com
f | adb.h | s | 2.7K | 86 | Adrian Bunk | bunk@kernel.org | 1214875686 |  | drivers/macintosh: Various cleanups  This contains the following cleanups: - make the following needlessly global code static:   - adb.c: adb_controller   - adb.c: adb_init()   - adbhid.c: adb_to_linux_keycodes[]  (also make it const)   - via-pmu68k.c: backlight_level   - via-pmu68k.c: backlight_enabled - remove the following unused code:   - via-pmu68k.c: sleep_notifier_list  Signed-off-by: Adrian Bunk <bunk@kernel.org> Acked-by: Geert Uytterhoeven <geert@linux-m68k.org> Acked-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Paul Mackerras <paulus@samba.org>
f | cycx_drv.h | s | 2.1K | 60 | Adrian Bunk | bunk@stusta.de | 1126701414 |  | [PATCH] drivers/net/wan/: possible cleanups  This patch contains possible cleanups including the following: - make needlessly global code static - #if 0 the following unused global function:   - sdladrv.c: sdla_intde - remove the following unused global variable:   - lmc_media.c: lmc_t1_cables - remove the following unneeded EXPORT_SYMBOL's:   - cycx_drv.c: cycx_inten   - sdladrv.c: sdla_inten   - sdladrv.c: sdla_intde   - sdladrv.c: sdla_intack   - sdladrv.c: sdla_intr   - syncppp.c: sppp_input   - syncppp.c: sppp_change_mtu  Signed-off-by: Adrian Bunk <bunk@stusta.de> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Jeff Garzik <jgarzik@pobox.com>
f | kexec.h | s | 7.7K | 222 | maximilian attems | max@stro.at | 1338511770 |  | kexec: export kexec.h to user space  Add userspace definitions, guard all relevant kernel structures.  While at it document stuff and remove now useless userspace hint.  It is easy to add the relevant system call to respective libc's, but it seems pointless to have to duplicate the data structures.  This is based on the kexec-tools headers, with the exception of just using int on return (succes or failure) and using size_t instead of 'unsigned long int' for the number of segments argument of kexec_load().  Signed-off-by: maximilian attems <max@stro.at> Cc: Simon Horman <horms@verge.net.au> Cc: Vivek Goyal <vgoyal@redhat.com> Cc: Haren Myneni <hbabu@us.ibm.com> Cc: "Eric W. Biederman" <ebiederm@xmission.com> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atmlec.h | s | 2.3K | 82 | Paul Gortmaker | paul.gortmaker@windriver.com | 1337127275 |  | atm: remove the coupling to token ring support  The token ring support is going away, so decouple the atm support from it in advance.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | const.h | s | 596B | 20 | Jeremy Fitzhardinge | jeremy@goop.org | 1201696362 |  | x86: add _AT() macro to conditionally cast  # HG changeset patch # User Jeremy Fitzhardinge <jeremy@xensource.com> # Date 1199317452 28800 # Node ID f7e7db3facd9406545103164f9be8f9ba1a2b549 # Parent  4d9a413a0f4c1d98dbea704f0366457b5117045d x86: add _AT() macro to conditionally cast  Define _AT(type, value) to conditionally cast a value when compiling C code, but not when used in assembler.  Signed-off-by: Jeremy Fitzhardinge <jeremy.fitzhardinge@citrix.com>  Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | rxrpc.h | s | 2.3K | 61 | David Howells | dhowells@redhat.com | 1253007857 |  | RxRPC: Declare the security index constants symbolically  Declare the security index constants symbolically rather than just referring to them numerically.  Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | topology.h | s | 7.3K | 262 | Linus Torvalds | torvalds@linux-foundation.org | 1337736452 |  | Merge branch 'sched-core-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  Pull scheduler changes from Ingo Molnar:  "The biggest change is the cleanup/simplification of the load-balancer:   instead of the current practice of architectures twiddling scheduler   internal data structures and providing the scheduler domains in   colorfully inconsistent ways, we now have generic scheduler code in   kernel/sched/core.c:sched_init_numa() that looks at the architecture's   node_distance() parameters and (while not fully trusting it) deducts a   NUMA topology from it.    This inevitably changes balancing behavior - hopefully for the better.    There are various smaller optimizations, cleanups and fixlets as well"  * 'sched-core-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:   sched: Taint kernel with TAINT_WARN after sleep-in-atomic bug   sched: Remove stale power aware scheduling remnants and dysfunctional knobs   sched/debug: Fix printing large integers on 32-bit platforms   sched/fair: Improve the ->group_imb logic   sched/nohz: Fix rq->cpu_load[] calculations   sched/numa: Don't scale the imbalance   sched/fair: Revert sched-domain iteration breakage   sched/x86: Rewrite set_cpu_sibling_map()   sched/numa: Fix the new NUMA topology bits   sched/numa: Rewrite the CONFIG_NUMA sched domain support   sched/fair: Propagate 'struct lb_env' usage into find_busiest_group   sched/fair: Add some serialization to the sched_domain load-balance walk   sched/fair: Let minimally loaded cpu balance the group   sched: Change rq->nr_running to unsigned int   x86/numa: Check for nonsensical topologies on real hw as well   x86/numa: Hard partition cpu topology masks on node boundaries   x86/numa: Allow specifying node_distance() for numa=fake   x86/sched: Make mwait_usable() heed to "idle=" kernel parameters properly   sched: Update documentation and comments   sched_rt: Avoid unnecessary dequeue and enqueue of pushable tasks in set_cpus_allowed_rt()
f | of_address.h | s | 2.2K | 65 | Grant Likely | grant.likely@secretlab.ca | 1329397883 |  | of/address: add empty static inlines for !CONFIG_OF  As the title says, this patch adds empty implementations for the address translation functions so that they can be used when CONFIG_OF is disabled.  Signed-off-by: Grant Likely <grant.likely@secretlab.ca> Cc: Rob Herring <rob.herring@calxeda.com>
f | attribute_container.h | s | 2.5K | 64 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | tpm_command.h | s | 808B | 23 | Mimi Zohar | zohar@linux.vnet.ibm.com | 1290981325 |  | keys: add new trusted key-type  Define a new kernel key-type called 'trusted'.  Trusted keys are random number symmetric keys, generated and RSA-sealed by the TPM.  The TPM only unseals the keys, if the boot PCRs and other criteria match. Userspace can only ever see encrypted blobs.  Based on suggestions by Jason Gunthorpe, several new options have been added to support additional usages.  The new options are: migratable=  designates that the key may/may not ever be updated              (resealed under a new key, new pcrinfo or new auth.)  pcrlock=n    extends the designated PCR 'n' with a random value,              so that a key sealed to that PCR may not be unsealed              again until after a reboot.  keyhandle=   specifies the sealing/unsealing key handle.  keyauth=     specifies the sealing/unsealing key auth.  blobauth=    specifies the sealed data auth.  Implementation of a kernel reserved locality for trusted keys will be investigated for a possible future extension.  Changelog: - Updated and added examples to Documentation/keys-trusted-encrypted.txt - Moved generic TPM constants to include/linux/tpm_command.h   (David Howell's suggestion.) - trusted_defined.c: replaced kzalloc with kmalloc, added pcrlock failure   error handling, added const qualifiers where appropriate. - moved to late_initcall - updated from hash to shash (suggestion by David Howells) - reduced worst stack usage (tpm_seal) from 530 to 312 bytes - moved documentation to Documentation directory (suggestion by David Howells) - all the other code cleanups suggested by David Howells - Add pcrlock CAP_SYS_ADMIN dependency (based on comment by Jason Gunthorpe) - New options: migratable, pcrlock, keyhandle, keyauth, blobauth (based on   discussions with Jason Gunthorpe) - Free payload on failure to create key(reported/fixed by Roberto Sassu) - Updated Kconfig and other descriptions (based on Serge Hallyn's suggestion) - Replaced kzalloc() with kmalloc() (reported by Serge Hallyn)  Signed-off-by: David Safford <safford@watson.ibm.com> Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Signed-off-by: James Morris <jmorris@namei.org>
f | ring_buffer.h | s | 6.3K | 162 | Vaibhav Nagarnaik | vnagarnaik@google.com | 1335230271 |  | ring-buffer: Add per_cpu ring buffer control files  Add a debugfs entry under per_cpu/ folder for each cpu called buffer_size_kb to control the ring buffer size for each CPU independently.  If the global file buffer_size_kb is used to set size, the individual ring buffers will be adjusted to the given size. The buffer_size_kb will report the common size to maintain backward compatibility.  If the buffer_size_kb file under the per_cpu/ directory is used to change buffer size for a specific CPU, only the size of the respective ring buffer is updated. When tracing/buffer_size_kb is read, it reports 'X' to indicate that sizes of per_cpu ring buffers are not equivalent.  Link: http://lkml.kernel.org/r/1328212844-11889-1-git-send-email-vnagarnaik@google.com  Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: Michael Rubin <mrubin@google.com> Cc: David Sharp <dhsharp@google.com> Cc: Justin Teravest <teravest@google.com> Signed-off-by: Vaibhav Nagarnaik <vnagarnaik@google.com> Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
f | rio_ids.h | s | 1.2K | 38 | Alexandre Bounine | alexandre.bounine@idt.com | 1320275221 |  | RapidIO: add mport driver for Tsi721 bridge  Add RapidIO mport driver for IDT TSI721 PCI Express-to-SRIO bridge device.  The driver provides full set of callback functions defined for mport devices in RapidIO subsystem.  It also is compatible with current version of RIONET driver (Ethernet over RapidIO messaging services).  This patch is applicable to kernel versions starting from 2.6.39.  Signed-off-by: Alexandre Bounine <alexandre.bounine@idt.com> Signed-off-by: Chul Kim <chul.kim@idt.com> Cc: Kumar Gala <galak@kernel.crashing.org> Cc: Matt Porter <mporter@kernel.crashing.org> Cc: Li Yang <leoli@freescale.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | video_output.h | s | 1.9K | 57 | Len Brown | len.brown@intel.com | 1292050895 |  | ACPI: video: fix build for VIDEO_OUTPUT_CONTROL=n  drivers/built-in.o: In function `acpi_video_bus_put_devices': video.c:(.text+0x79663): undefined reference to `video_output_unregister' drivers/built-in.o: In function `acpi_video_bus_add': video.c:(.text+0x7b0b3): undefined reference to `video_output_register'  Signed-off-by: Len Brown <len.brown@intel.com>
f | qnxtypes.h | s | 561B | 22 | Anders Larsen | al@alarsen.net | 1231361060 |  | qnx: include <linux/types.h> for definitions of __[us]{8,16,32,64} types  On 2008-12-30 11:32:33, Sam Ravnborg wrote: > We have added a few additional validation checks of the userspace headers: ... > 3) We should include <linux/types.h> and not <asm/types.h> > 4) If we use a __[us]{8,16,32,64} type then we must include <linux/types.h>  Satisfy these requirements for the linux/qnx*.h headers.  Signed-off-by: Anders Larsen <al@alarsen.net> Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | idr.h | s | 4.7K | 131 | Rusty Russell | rusty@rustcorp.com.au | 1312417520 |  | ida: simplified functions for id allocation  The current hyper-optimized functions are overkill if you simply want to allocate an id for a device.  Create versions which use an internal lock.  In followup patches, numerous drivers are converted to use this interface.  Thanks to Tejun for feedback.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: Jonathan Cameron <jic23@cam.ac.uk> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | rbtree.h | s | 5.3K | 144 | John Stultz | john.stultz@linaro.org | 1303851702 |  | timers: Add rb_init_node() to allow for stack allocated rb nodes  In cases where a timerqueue_node or some structure that utilizes a timerqueue_node is allocated on the stack, gcc would give warnings caused by the timerqueue_init()'s calling RB_CLEAR_NODE, which self-references the nodes uninitialized data.  The solution is to create an rb_init_node() function that zeros the rb_node structure out and then calls RB_CLEAR_NODE(), and then call the new init function from timerqueue_init().  CC: Thomas Gleixner <tglx@linutronix.de> Acked-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: John Stultz <john.stultz@linaro.org>
f | pg.h | s | 2.2K | 47 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | stmp_device.h | s | 619B | 17 | Wolfram Sang | w.sang@pengutronix.de | 1334957228 |  | lib: add support for stmp-style devices  MX23/28 use IP cores which follow a register layout I have first seen on STMP3xxx SoCs. In this layout, every register actually has four u32:   1.) to store a value directly  2.) a SET register where every 1-bit sets the corresponding bit,      others are unaffected  3.) same with a CLR register  4.) same with a TOG (toggle) register  Also, the 2 MSBs in register 0 are always the same and can be used to reset the IP core.  All this is strictly speaking not mach-specific (but IP core specific) and, thus, doesn't need to be in mach-mxs/include. At least mx6 also uses IP cores following this stmp-style. So:  Introduce a stmp-style device, put the code and defines for that in a public place (lib/), and let drivers for stmp-style devices select that code. To avoid regressions and ease reviewing, the actual code is simply copied from mach-mxs. It definately wants updates, but those need a seperate patch series.  Voila, mach dependency gone, reusable code introduced. Note that I didn't remove the duplicated code from mach-mxs yet, first the drivers have to be converted.  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Dong Aisheng <dong.aisheng@linaro.org>
f | of_irq.h | s | 2.8K | 76 | Thomas Abraham | thomas.abraham@linaro.org | 1334702242 |  | of/irq: add empty irq_of_parse_and_map() for non-dt builds  Add a empty irq_of_parse_and_map() function that returns 0 for non-dt builds and avoid having #ifdef CONFIG_OF around all calls to irq_of_parse_and_map(). In addition to that, the irq_of_parse_and_map() function declaration is made available only if CONFIG_OF_IRQ is defined, which is the same config option that makes the irq_of_parse_and_map() function definition available. While at it, fix a typo as well.  Changes since v1: - Moved irq_of_parse_and_map() function declaration under CONFIG_OF_IRQ. - Fix a minor typo in comments.  Suggested-by: Grant Likely <grant.likely@secretlab.ca> Signed-off-by: Thomas Abraham <thomas.abraham@linaro.org> Acked-by: Rob Herring <rob.herring@calxeda.com> [grant.likely: fix bug causing SPARC to break] Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | pnfs_osd_xdr.h | s | 9.3K | 286 | Boaz Harrosh | bharrosh@panasas.com | 1310492429 |  | pnfs-obj: pnfs_osd_xdr: Remove dead code and cleanup  * Some leftovers from ancient times. * This file will only define common types and client API.   Remove server from comments  Signed-off-by: Boaz Harrosh <Boaz Harrosh bharrosh@panasas.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | kernel_stat.h | s | 3.1K | 109 | Glauber Costa | glommer@parallels.com | 1323158798 |  | sched/accounting: Change cpustat fields to an array  This patch changes fields in cpustat from a structure, to an u64 array. Math gets easier, and the code is more flexible.  Signed-off-by: Glauber Costa <glommer@parallels.com> Reviewed-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Paul Tuner <pjt@google.com> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Link: http://lkml.kernel.org/r/1322498719-2255-2-git-send-email-glommer@parallels.com Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | unistd.h | s | 157B | 7 | Arnd Bergmann | arnd@arndb.de | 1159801043 |  | [PATCH] remove remaining errno and __KERNEL_SYSCALLS__ references  The last in-kernel user of errno is gone, so we should remove the definition and everything referring to it.  This also removes the now-unused lib/execve.c file that was introduced earlier.  Also remove every trace of __KERNEL_SYSCALLS__ that still remained in the kernel.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Cc: Andi Kleen <ak@muc.de> Cc: Paul Mackerras <paulus@samba.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Richard Henderson <rth@twiddle.net> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Ian Molton <spyro@f2s.com> Cc: Mikael Starvik <starvik@axis.com> Cc: David Howells <dhowells@redhat.com> Cc: Yoshinori Sato <ysato@users.sourceforge.jp> Cc: Hirokazu Takata <takata.hirokazu@renesas.com> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Kyle McMartin <kyle@mcmartin.ca> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Kazumoto Kojima <kkojima@rr.iij4u.or.jp> Cc: Richard Curnow <rc@rc0.org.uk> Cc: William Lee Irwin III <wli@holomorphy.com> Cc: "David S. Miller" <davem@davemloft.net> Cc: Jeff Dike <jdike@addtoit.com> Cc: Paolo 'Blaisorblade' Giarrusso <blaisorblade@yahoo.it> Cc: Miles Bader <uclinux-v850@lsi.nec.co.jp> Cc: Chris Zankel <chris@zankel.net> Cc: "Luck, Tony" <tony.luck@intel.com> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Roman Zippel <zippel@linux-m68k.org> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | list.h | s | 20K | 648 | Linus Torvalds | torvalds@linux-foundation.org | 1305839729 |  | list: remove prefetching from regular list iterators  This is removes the use of software prefetching from the regular list iterators.  We don't want it.  If you do want to prefetch in some iterator of yours, go right ahead.  Just don't expect the iterator to do it, since normally the downsides are bigger than the upsides.  It also replaces <linux/prefetch.h> with <linux/const.h>, because the use of LIST_POISON ends up needing it.  <linux/poison.h> is sadly not self-contained, and including prefetch.h just happened to hide that.  Suggested by David Miller (networking has a lot of regular lists that are often empty or a single entry, and prefetching is not going to do anything but add useless instructions).  Acked-by: Ingo Molnar <mingo@elte.hu> Acked-by: David S. Miller <davem@davemloft.net> Cc: linux-arch@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | string.h | s | 4.1K | 132 | Akinobu Mita | akinobu.mita@gmail.com | 1320107447 |  | lib/string.c: introduce memchr_inv()  memchr_inv() is mainly used to check whether the whole buffer is filled with just a specified byte.  The function name and prototype are stolen from logfs and the implementation is from SLUB.  Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com> Acked-by: Christoph Lameter <cl@linux-foundation.org> Acked-by: Pekka Enberg <penberg@kernel.org> Cc: Matt Mackall <mpm@selenic.com> Acked-by: Joern Engel <joern@logfs.org> Cc: Marcin Slusarz <marcin.slusarz@gmail.com> Cc: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | wimax.h | s | 8.2K | 221 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | sysv_fs.h | s | 9.0K | 195 | Lubomir Rintel | lkundrak@v3.sk | 1281542362 |  | fs/sysv: v7: adjust sanity checks for some volumes  Newly mkfs-ed filesystems from Seventh Edition have last modification time set to zero, but are otherwise perfectly valid.  Also, tighten up other sanity checks to filter out most filesystems with  [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: Lubomir Rintel <lkundrak@v3.sk> Cc: Christoph Hellwig <hch@lst.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | nodemask.h | s | 15K | 440 | Michal Hocko | mhocko@suse.cz | 1311724183 |  | cpusets: randomize node rotor used in cpuset_mem_spread_node()  [ This patch has already been accepted as commit 0ac0c0d0f837 but later   reverted (commit 35926ff5fba8) because it itroduced arch specific   __node_random which was defined only for x86 code so it broke other   archs.  This is a followup without any arch specific code.  Other than   that there are no functional changes.]  Some workloads that create a large number of small files tend to assign too many pages to node 0 (multi-node systems).  Part of the reason is that the rotor (in cpuset_mem_spread_node()) used to assign nodes starts at node 0 for newly created tasks.  This patch changes the rotor to be initialized to a random node number of the cpuset.  [akpm@linux-foundation.org: fix layout] [Lee.Schermerhorn@hp.com: Define stub numa_random() for !NUMA configuration] [mhocko@suse.cz: Make it arch independent] [akpm@linux-foundation.org: fix CONFIG_NUMA=y, MAX_NUMNODES>1 build] Signed-off-by: Jack Steiner <steiner@sgi.com> Signed-off-by: Lee Schermerhorn <lee.schermerhorn@hp.com> Signed-off-by: Michal Hocko <mhocko@suse.cz> Reviewed-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Christoph Lameter <cl@linux-foundation.org> Cc: Pekka Enberg <penberg@cs.helsinki.fi> Cc: Paul Menage <menage@google.com> Cc: Jack Steiner <steiner@sgi.com> Cc: Robin Holt <holt@sgi.com> Cc: David Rientjes <rientjes@google.com> Cc: Christoph Lameter <cl@linux-foundation.org> Cc: David Rientjes <rientjes@google.com> Cc: Jack Steiner <steiner@sgi.com> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: Lee Schermerhorn <lee.schermerhorn@hp.com> Cc: Michal Hocko <mhocko@suse.cz> Cc: Paul Menage <menage@google.com> Cc: Pekka Enberg <penberg@cs.helsinki.fi> Cc: Robin Holt <holt@sgi.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | threads.h | s | 1.2K | 36 | Hedi Berriche | hedi@sgi.com | 1274976771 |  | pids: increase pid_max based on num_possible_cpus  On a system with a substantial number of processors, the early default pid_max of 32k will not be enough.  A system with 1664 CPU's, there are 25163 processes started before the login prompt.  It's estimated that with 2048 CPU's we will pass the 32k limit.  With 4096, we'll reach that limit very early during the boot cycle, and processes would stall waiting for an available pid.  This patch increases the early maximum number of pids available, and increases the minimum number of pids that can be set during runtime.  [akpm@linux-foundation.org: fix warnings] Signed-off-by: Hedi Berriche <hedi@sgi.com> Signed-off-by: Mike Travis <travis@sgi.com> Signed-off-by: Robin Holt <holt@sgi.com> Acked-by: Linus Torvalds <torvalds@linux-foundation.org> Cc: Ingo Molnar <mingo@elte.hu> Cc: Pavel Machek <pavel@ucw.cz> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: Greg KH <gregkh@suse.de> Cc: Rik van Riel <riel@redhat.com> Cc: John Stoffel <john@stoffel.org> Cc: Jack Steiner <steiner@sgi.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | max17040_battery.h | s | 474B | 16 | Minkyu Kang | mk7.kang@samsung.com | 1244494401 |  | Add MAX17040 Fuel Gauge driver  The MAX17040 is a I2C interfaced Fuel Gauge systems for lithium-ion batteries This patch adds support the MAX17040 Fuel Gauge  Signed-off-by: Minkyu Kang <mk7.kang@samsung.com> Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>
f | selinux_netlink.h | s | 1.1K | 43 | Arnd Bergmann | arnd@arndb.de | 1238087655 |  | make most exported headers use strict integer types  This takes care of all files that have only a small number of non-strict integer type uses.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Cc: Mauro Carvalho Chehab <mchehab@redhat.com> Cc: David Airlie <airlied@linux.ie> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Cc: netdev@vger.kernel.org Cc: linux-ppp@vger.kernel.org Cc: Jaroslav Kysela <perex@perex.cz> Cc: Takashi Iwai <tiwai@suse.de> Cc: David Woodhouse <dwmw2@infradead.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | ip_vs.h | s | 12K | 346 | Julian Anastasov | ja@ssi.bg | 1336498711 |  | ipvs: always update some of the flags bits in backup  	As the goal is to mirror the inactconns/activeconns counters in the backup server, make sure the cp->flags are updated even if cp is still not bound to dest. If cp->flags are not updated ip_vs_bind_dest will rely only on the initial flags when updating the counters. To avoid mistakes and complicated checks for protocol state rely only on the IP_VS_CONN_F_INACTIVE bit when updating the counters.  Signed-off-by: Julian Anastasov <ja@ssi.bg> Tested-by: Aleksey Chudov <aleksey.chudov@gmail.com> Signed-off-by: Simon Horman <horms@verge.net.au>
f | page-debug-flags.h | s | 967B | 27 | Stanislaw Gruszka | sgruszka@redhat.com | 1326241842 |  | mm: more intensive memory corruption debugging  With CONFIG_DEBUG_PAGEALLOC configured, the CPU will generate an exception on access (read,write) to an unallocated page, which permits us to catch code which corrupts memory.  However the kernel is trying to maximise memory usage, hence there are usually few free pages in the system and buggy code usually corrupts some crucial data.  This patch changes the buddy allocator to keep more free/protected pages and to interlace free/protected and allocated pages to increase the probability of catching corruption.  When the kernel is compiled with CONFIG_DEBUG_PAGEALLOC, debug_guardpage_minorder defines the minimum order used by the page allocator to grant a request.  The requested size will be returned with the remaining pages used as guard pages.  The default value of debug_guardpage_minorder is zero: no change from current behaviour.  [akpm@linux-foundation.org: tweak documentation, s/flg/flag/] Signed-off-by: Stanislaw Gruszka <sgruszka@redhat.com> Cc: Mel Gorman <mgorman@suse.de> Cc: Andrea Arcangeli <aarcange@redhat.com> Cc: "Rafael J. Wysocki" <rjw@sisk.pl> Cc: Christoph Lameter <cl@linux-foundation.org> Cc: Pekka Enberg <penberg@cs.helsinki.fi> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_strip.h | s | 700B | 23 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233339973 |  | headers_check fix: linux/if_strip.h  fix the following 'make headers_check' warning:    usr/include/linux/if_strip.h:22: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | leds-tca6507.h | s | 1.0K | 31 | NeilBrown | neilb@suse.de | 1326241849 |  | leds: add driver for TCA6507 LED controller  TI's TCA6507 is the LED driver in the GTA04 Openmoko motherboard.  The driver provides full support for brightness levels and hardware blinking.  This driver can drive each of 7 outputs as an LED or a GPIO output, and provides hardware-assist blinking.  [akpm@linux-foundation.org: fix __mod_i2c_device_table alias] [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: NeilBrown <neilb@suse.de> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | srcu.h | s | 9.4K | 241 | Lai Jiangshan | laijs@cn.fujitsu.com | 1335808105 |  | rcu: Implement per-domain single-threaded call_srcu() state machine  This commit implements an SRCU state machine in support of call_srcu(). The state machine is preemptible, light-weight, and single-threaded, minimizing synchronization overhead.  In particular, there is no longer any need for synchronize_srcu() to be guarded by a mutex.  Expedited processing is handled, at least in the absence of concurrent grace-period operations on that same srcu_struct structure, by having the synchronize_srcu_expedited() thread take on the role of the workqueue thread for one iteration.  There is a reasonable probability that a given SRCU callback will be invoked on the same CPU that registered it, however, there is no guarantee.  Concurrent SRCU grace-period primitives can cause callbacks to be executed elsewhere, even in absence of CPU-hotplug operations.  Callbacks execute in process context, but under the influence of local_bh_disable(), so it is illegal to sleep in an SRCU callback function.  Signed-off-by: Lai Jiangshan <laijs@cn.fujitsu.com> Acked-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
f | dma-direction.h | s | 299B | 13 | Alexey Dobriyan | adobriyan@gmail.com | 1308709040 |  | net: remove mm.h inclusion from netdevice.h  Remove linux/mm.h inclusion from netdevice.h -- it's unused (I've checked manually).  To prevent mm.h inclusion via other channels also extract "enum dma_data_direction" definition into separate header. This tiny piece is what gluing netdevice.h with mm.h via "netdevice.h => dmaengine.h => dma-mapping.h => scatterlist.h => mm.h". Removal of mm.h from scatterlist.h was tried and was found not feasible on most archs, so the link was cutoff earlier.  Hope people are OK with tiny include file.  Note, that mm_types.h is still dragged in, but it is a separate story.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mmtimer.h | s | 2.0K | 52 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | route.h | s | 2.3K | 60 | Eric Dumazet | eric.dumazet@gmail.com | 1257357058 |  | net: cleanup include/linux  This cleanup patch puts struct/union/enum opening braces, in first line to ease grep games.  struct something {  becomes :  struct something {  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
d | iio |  | 11 items |  | Lars-Peter Clausen | lars@metafoo.de | 1337027671 |  | iio: Add dev_to_iio_dev() helper function  This patch adds a helper function for retriving a iio_dev struct from a device struct. Currently we open-code this in two different ways. One is using dev_get_drvdata on the device and the other is using container_of. The new helper function uses the container_of solution as it creates slightly smaller code and also will eventually free up the drvdata pointer for usage by invidual drivers.  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Acked-by: Jonathan Cameron <jic23@kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | wanrouter.h | s | 20K | 481 | Justin P. Mattock | justinmattock@gmail.com | 1322834251 |  | treewide: Fix typos in various parts of the kernel, and fix some comments.  The below patch fixes some typos in various parts of the kernel, as well as fixes some comments. Please let me know if I missed anything, and I will try to get it changed and resent.  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Acked-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | hp_sdc.h | s | 14K | 263 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | stallion.h | s | 4.2K | 135 | Alan Cox | alan@redhat.com | 1216599157 |  | stallion: use tty_port  Switch the stallion driver to use the tty_port structure  Signed-off-by: Alan Cox <alan@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | isdn.h | s | 28K | 534 | Jiri Slaby | jslaby@suse.cz | 1333995415 |  | TTY: isdn, use xmit_buf from tty_port  Signed-off-by: Jiri Slaby <jslaby@suse.cz> Cc: Karsten Keil <isdn@linux-pingi.de> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | kmemleak.h | s | 3.0K | 96 | Catalin Marinas | catalin.marinas@arm.com | 1322842362 |  | kmemleak: Handle percpu memory allocation  This patch adds kmemleak callbacks from the percpu allocator, reducing a number of false positives caused by kmemleak not scanning such memory blocks. The percpu chunks are never reported as leaks because of current kmemleak limitations with the __percpu pointer not pointing directly to the actual chunks.  Reported-by: Huajun Li <huajun.li.lee@gmail.com> Acked-by: Christoph Lameter <cl@gentwo.org> Acked-by: Tejun Heo <tj@kernel.org> Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>
f | ds17287rtc.h | s | 2.6K | 58 | Robert P. J. Day | rpjday@mindspring.com | 1184601942 |  | Remove unnecessary includes of spinlock.h under include/linux  Remove the obviously unnecessary includes of <linux/spinlock.h> under the include/linux/ directory, and fix the couple errors that are introduced as a result of that.  Signed-off-by: Robert P. J. Day <rpjday@mindspring.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ds2782_battery.h | s | 119B | 6 | Yulia Vilensky | vilensky@compulab.co.il | 1272305022 |  | ds2782_battery: Add support for ds2786 battery gas gauge  Signed-off-by: Yulia Vilensky <vilensky@compulab.co.il> Signed-off-by: Mike Rapoport <mike@compulab.co.il> Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>
f | kallsyms.h | s | 3.4K | 103 | Stephen Boyd | sboyd@codeaurora.org | 1338333752 |  | vsprintf: fix %ps on non symbols when using kallsyms  Using %ps in a printk format will sometimes fail silently and print the empty string if the address passed in does not match a symbol that kallsyms knows about.  But using %pS will fall back to printing the full address if kallsyms can't find the symbol.  Make %ps act the same as %pS by falling back to printing the address.  While we're here also make %ps print the module that a symbol comes from so that it matches what %pS already does.  Take this simple function for example (in a module):  	static void test_printk(void) 	{ 		int test; 		pr_info("with pS: %pS\n", &test); 		pr_info("with ps: %ps\n", &test); 	}  Before this patch:   with pS: 0xdff7df44  with ps:  After this patch:   with pS: 0xdff7df44  with ps: 0xdff7df44  Signed-off-by: Stephen Boyd <sboyd@codeaurora.org> Cc: Ingo Molnar <mingo@elte.hu> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | serial_max3100.h | s | 1.4K | 47 | Alan Cox | alan@lxorguk.ukuu.org.uk | 1239226418 |  | tty: MAX3100  Thou shalt remember to use 'git add' or errors shall be visited on your downloads and there shall be wrath from on list and much gnashing of teeth.  Thou shalt remember to use git status or there shall be catcalls and much embarrasment shall come to pass.  Signed-off-by: Alan "I'm hiding" Cox <alan@lxorguk.ukuu.org.uk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | superhyway.h | s | 2.8K | 82 | Paul Mundt | lethal@linux-sh.org | 1131378808 |  | [PATCH] superhyway: multiple block support and VCR rework  This extends the API somewhat to allow for platform-specific VCR reading and writing.  Some platforms (like SH4-202) implement the VCR in a split VCRL and VCRH, but end up being in reverse order or have other quirks that need to be dealt with, so we add a set of superhyway_ops per-bus to accomodate this.  We also have to extend the per-device resources somewhat, as some devices now conveniently split control and data blocks.  So we allow a platform to register its set of SuperHyway devices via superhyway_add_devices() with the control block always ordered as the first resource (as this is the one that userspace cares about).  Signed-off-by: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | vt_buffer.h | s | 1.4K | 55 | David Woodhouse | dwmw2@infradead.org | 1146052576 |  | Don't include linux/config.h from anywhere else in include/  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | wl12xx.h | s | 2.2K | 68 | Felipe Balbi | balbi@ti.com | 1318338069 |  | wl12xx: move common init code from bus modules to main  Move all common parts from sdio.c and spi.c to main.c, since they now can be handled as part of the platform driver.  Signed-off-by: Felipe Balbi <balbi@ti.com> [forward-ported, cleaned-up and rephrased commit message] [added a bunch of fixes and a new pdata element] [moved some new code into main.c as well] Signed-off-by: Luciano Coelho <coelho@ti.com>
f | tipc_config.h | s | 14K | 334 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, tipc: Add missing #include to <linux/tipc_config.h> for userland  <linux/tipc_config.h> defines inline functions using ntohs() etc. For userland these are defined in <arpa/inet.h>.  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | btree.h | s | 6.8K | 217 | Joern Engel | joern@logfs.org | 1258744419 |  | [LogFS] add new flash file system  This is a new flash file system. See Documentation/filesystems/logfs.txt  Signed-off-by: Joern Engel <joern@logfs.org>
f | btree-128.h | s | 2.6K | 89 | Joern Engel | joern@logfs.org | 1258744419 |  | [LogFS] add new flash file system  This is a new flash file system. See Documentation/filesystems/logfs.txt  Signed-off-by: Joern Engel <joern@logfs.org>
f | pm_runtime.h | s | 7.3K | 208 | Rafael J. Wysocki | rjw@sisk.pl | 1335900518 |  | PM / Runtime: Remove device fields related to suspend time, v2  After the previous changes in default_stop_ok() and default_power_down_ok() for PM domains, there are two fields in struct dev_pm_info that aren't necessary any more,  suspend_time and max_time_suspended_ns.  Remove those fields along with all of the code that accesses them, which simplifies the runtime PM framework quite a bit.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | compiler-gcc4.h | s | 2.1K | 48 | David Daney | david.daney@cavium.com | 1326241842 |  | kernel.h: add BUILD_BUG() macro  We can place this in definitions that we expect the compiler to remove by dead code elimination.  If this assertion fails, we get a nice error message at build time.  The GCC function attribute error("message") was added in version 4.3, so we define a new macro __linktime_error(message) to expand to this for GCC-4.3 and later.  This will give us an error diagnostic from the compiler on the line that fails.  For other compilers __linktime_error(message) expands to nothing, and we have to be content with a link time error, but at least we will still get a build error.  BUILD_BUG() expands to the undefined function __build_bug_failed() and will fail at link time if the compiler ever emits code for it.  On GCC-4.3 and later, attribute((error())) is used so that the failure will be noted at compile time instead.  Signed-off-by: David Daney <david.daney@cavium.com> Acked-by: David Rientjes <rientjes@google.com> Cc: DM <dm.n9107@gmail.com> Cc: Ralf Baechle <ralf@linux-mips.org> Acked-by: David Howells <dhowells@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | hid-debug.h | s | 1.9K | 53 | Jiri Kosina | jkosina@suse.cz | 1246006114 |  | HID: fix debugfs build with !CONFIG_DEBUG_FS  Fix the debug function prototypes to be correct even in the !CONFIG_DEBUG_FS case.  Reported-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | prio_heap.h | s | 1.8K | 49 | Paul Menage | menage@google.com | 1192820021 |  | Fix cpusets update_cpumask  Cause writes to cpuset "cpus" file to update cpus_allowed for member tasks:  - collect batches of tasks under tasklist_lock and then call   set_cpus_allowed() on them outside the lock (since this can sleep).  - add a simple generic priority heap type to allow efficient collection   of batches of tasks to be processed without duplicating or missing any   tasks in subsequent batches.  - make "cpus" file update a no-op if the mask hasn't changed  - fix race between update_cpumask() and sched_setaffinity() by making   sched_setaffinity() post-check that it's not running on any cpus outside   cpuset_cpus_allowed().  [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: Paul Menage <menage@google.com> Cc: Paul Jackson <pj@sgi.com> Cc: David Rientjes <rientjes@google.com> Cc: Nick Piggin <nickpiggin@yahoo.com.au> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Balbir Singh <balbir@in.ibm.com> Cc: Cedric Le Goater <clg@fr.ibm.com> Cc: "Eric W. Biederman" <ebiederm@xmission.com> Cc: Serge Hallyn <serue@us.ibm.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sysctl.h | s | 31K | 1020 | Eric W. Biederman | ebiederm@xmission.com | 1327452030 |  | sysctl: Add register_sysctl for normal sysctl users  The plan is to convert all callers of register_sysctl_table and register_sysctl_paths to register_sysctl.  The interface to register_sysctl is enough nicer this should make the callers a bit more readable.  Additionally after the conversion the 230 lines of backwards compatibility can be removed.  Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | configfs.h | s | 8.6K | 230 | Al Viro | viro@zeniv.linux.org.uk | 1325649297 |  | configfs: convert to umode_t  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | lguest_launcher.h | s | 2.5K | 69 | Rusty Russell | rusty@rustcorp.com.au | 1248935625 |  | lguest: fix comment style  I don't really notice it (except to begrudge the extra vertical space), but Ingo does.  And he pointed out that one excuse of lguest is as a teaching tool, it should set a good example.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Cc: Ingo Molnar <mingo@redhat.com>
f | isa.h | s | 894B | 31 | Matthew Wilcox | matthew@wil.cx | 1190002438 |  | Fix non-ISA link error in drivers/scsi/advansys.c  When CONFIG_ISA is disabled, the isa_driver support will not be compiled in.  Define stubs so that we don't get link-time errors.  Signed-off-by: Matthew Wilcox <matthew@wil.cx> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | clockchips.h | s | 5.2K | 149 | Magnus Damm | magnus.damm@gmail.com | 1337903091 |  | clockevents: Make clockevents_config() a global symbol  Make clockevents_config() into a global symbol to allow it to be used by compiled-in clockevent drivers. This is needed by drivers that want to update the timer frequency after registration time.  Signed-off-by: Magnus Damm <damm@opensource.se> Tested-by: Simon Horman <horms@verge.net.au> Cc: arnd@arndb.de Cc: johnstul@us.ibm.com Cc: rjw@sisk.pl Cc: lethal@linux-sh.org Cc: gregkh@linuxfoundation.org Cc: olof@lixom.net Cc: Magnus Damm <magnus.damm@gmail.com> Link: http://lkml.kernel.org/r/20120509143934.27521.46553.sendpatchset@w520 Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | personality.h | s | 3.5K | 105 | Andi Kleen | ak@linux.intel.com | 1314292648 |  | Add a personality to report 2.6.x version numbers  I ran into a couple of programs which broke with the new Linux 3.0 version.  Some of those were binary only.  I tried to use LD_PRELOAD to work around it, but it was quite difficult and in one case impossible because of a mix of 32bit and 64bit executables.  For example, all kind of management software from HP doesnt work, unless we pretend to run a 2.6 kernel.    $ uname -a   Linux svivoipvnx001 3.0.0-08107-g97cd98f #1062 SMP Fri Aug 12 18:11:45 CEST 2011 i686 i686 i386 GNU/Linux    $ hpacucli ctrl all show    Error: No controllers detected.    $ rpm -qf /usr/sbin/hpacucli   hpacucli-8.75-12.0  Another notable case is that Python now reports "linux3" from sys.platform(); which in turn can break things that were checking sys.platform() == "linux2":    https://bugzilla.mozilla.org/show_bug.cgi?id=664564  It seems pretty clear to me though it's a bug in the apps that are using '==' instead of .startswith(), but this allows us to unbreak broken programs.  This patch adds a UNAME26 personality that makes the kernel report a 2.6.40+x version number instead.  The x is the x in 3.x.  I know this is somewhat ugly, but I didn't find a better workaround, and compatibility to existing programs is important.  Some programs also read /proc/sys/kernel/osrelease.  This can be worked around in user space with mount --bind (and a mount namespace)  To use:    wget ftp://ftp.kernel.org/pub/linux/kernel/people/ak/uname26/uname26.c   gcc -o uname26 uname26.c   ./uname26 program  Signed-off-by: Andi Kleen <ak@linux.intel.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ioctl.h | s | 100B | 4 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | initrd.h | s | 583B | 13 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | migrate.h | s | 2.2K | 54 | Konstantin Khlebnikov | khlebnikov@openvz.org | 1332377697 |  | mm: replace PAGE_MIGRATION with IS_ENABLED(CONFIG_MIGRATION)  Since commit 2a11c8ea20bf ("kconfig: Introduce IS_ENABLED(), IS_BUILTIN() and IS_MODULE()") there is a generic grep-friendly method for checking config options in C expressions.  Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cryptouser.h | s | 2.9K | 92 | Steffen Klassert | steffen.klassert@secunet.com | 1333021968 |  | crypto: user - Fix size of netlink dump message  The default netlink message size limit might be exceeded when dumping a lot of algorithms to userspace. As a result, not all of the instantiated algorithms dumped to userspace. So calculate an upper bound on the message size and call netlink_dump_start() with that value.  Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
f | tty_ldisc.h | s | 5.9K | 156 | Ivo Sieben | meltedpianoman@gmail.com | 1336674243 |  | tty: move global ldisc idle waitqueue to the individual ldisc  The global wait_queue that is used for line discipline idle handling is moved to a separate wait_queue for each line instance. This prevents unnecessary blocking on one line, because of idle handling on another line.  Signed-off-by: Ivo Sieben <meltedpianoman@gmail.com> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | map_to_7segment.h | s | 7.0K | 163 | Mike Frysinger | vapier@gentoo.org | 1230555571 |  | Input: map_to_7segment.h - convert to __inline__ for userspace  Use __inline__ rather than inline for map_to_seg7() since it is exported to userspace.  Signed-off-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | module.h | s | 17K | 533 | Steven Rostedt | rostedt@goodmis.org | 1332728452 |  | module: move __module_get and try_module_get() out of line.  With the preempt, tracepoint and everything, it's getting a bit chubby.  For an Ubuntu-based config:  Before: 	$ size -t `find * -name '*.ko'` || grep TOTAL 	56199906        3870760	1606616	61677282	3ad1ee2	(TOTALS) 	$ size vmlinux 	   text	   data	    bss	    dec	    hex	filename 	8509342	 850368	3358720	12718430	 c2115e	vmlinux  After: 	$ size -t `find * -name '*.ko'` || grep TOTAL 	56183760	3867892	1606616	61658268	3acd49c	(TOTALS) 	$ size vmlinux 	   text	   data	    bss	    dec	    hex	filename 	8501842	 849088	3358720	12709650	 c1ef12	vmlinux  Signed-off-by: Steven Rostedt <rostedt@goodmis.org> Acked-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> (made all out-of-line)
f | securebits.h | s | 2.3K | 44 | Serge E. Hallyn | serue@us.ibm.com | 1256851645 |  | define convenient securebits masks for prctl users (v2)  Hi James, would you mind taking the following into security-testing?  The securebits are used by passing them to prctl with the PR_{S,G}ET_SECUREBITS commands.  But the defines must be shifted to be used in prctl, which begs to be confused and misused by userspace.  So define some more convenient values for userspace to specify.  This way userspace does  	prctl(PR_SET_SECUREBITS, SECBIT_NOROOT);  instead of  	prctl(PR_SET_SECUREBITS, 1 << SECURE_NOROOT);  (Thanks to Michael for the idea)  This patch also adds include/linux/securebits to the installed headers. Then perhaps it can be included by glibc's sys/prctl.h.  Changelog: 	Oct 29: Stephen Rothwell points out that issecure can 		be under __KERNEL__. 	Oct 14: (Suggestions by Michael Kerrisk): 		1. spell out SETUID in SECBIT_NO_SETUID* 		2. SECBIT_X_LOCKED does not imply SECBIT_X 		3. add definitions for keepcaps         Oct 14: As suggested by Michael Kerrisk, don't 		use SB_* as that convention is already in 		use.  Use SECBIT_ prefix instead.  Signed-off-by: Serge E. Hallyn <serue@us.ibm.com> Acked-by: Andrew G. Morgan <morgan@kernel.org> Acked-by: Michael Kerrisk <mtk.manpages@gmail.com> Cc: Ulrich Drepper <drepper@redhat.com> Cc: James Morris <jmorris@namei.org> Signed-off-by: James Morris <jmorris@namei.org>
f | raw.h | s | 302B | 13 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | veth.h | s | 161B | 9 | Stephen Hemminger | shemminger@linux-foundation.org | 1198726595 |  | [VETH]: move veth.h to include/linux  Move veth.h from net/ to linux/ since it is a user api, and add it to user header processing Kbuild.  [ Use header-y as suggested by Sam Ravnborg.  -DaveM ]  Signed-off-by: Stephen Hemminger <shemminger@linux-foundation.org> Signed-off-by: David S. Miller <davem@davemloft.net>
d | mfd |  | 63 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1338317591 |  | 
f | dlm.h | s | 7.7K | 208 | David Teigland | teigland@redhat.com | 1335986127 |  | dlm: fixes for nodir mode  The "nodir" mode (statically assign master nodes instead of using the resource directory) has always been highly experimental, and never seriously used.  This commit fixes a number of problems, making nodir much more usable.  - Major change to recovery: recover all locks and restart   all in-progress operations after recovery.  In some   cases it's not possible to know which in-progess locks   to recover, so recover all.  (Most require recovery   in nodir mode anyway since rehashing changes most   master nodes.)  - Change the way nodir mode is enabled, from a command   line mount arg passed through gfs2, into a sysfs   file managed by dlm_controld, consistent with the   other config settings.  - Allow recovering MSTCPY locks on an rsb that has not   yet been turned into a master copy.  - Ignore RCOM_LOCK and RCOM_LOCK_REPLY recovery messages   from a previous, aborted recovery cycle.  Base this   on the local recovery status not being in the state   where any nodes should be sending LOCK messages for the   current recovery cycle.  - Hold rsb lock around dlm_purge_mstcpy_locks() because it   may run concurrently with dlm_recover_master_copy().  - Maintain highbast on process-copy lkb's (in addition to   the master as is usual), because the lkb can switch   back and forth between being a master and being a   process copy as the master node changes in recovery.  - When recovering MSTCPY locks, flag rsb's that have   non-empty convert or waiting queues for granting   at the end of recovery.  (Rename flag from LOCKS_PURGED   to RECOVER_GRANT and similar for the recovery function,   because it's not only resources with purged locks   that need grant a grant attempt.)  - Replace a couple of unnecessary assertion panics with   error messages.  Signed-off-by: David Teigland <teigland@redhat.com>
f | amd-iommu.h | s | 5.7K | 146 | Joerg Roedel | joerg.roedel@amd.com | 1330614888 |  | iommu/amd: Split amd_iommu_init function  The hardware-initializtion part of the AMD IOMMU driver is split out into a seperate function. This function can now be called either from amd_iommu_init() itself or any other place if the hardware needs to be ready earlier. This will be used to implement interrupt remapping for AMD.  Signed-off-by: Joerg Roedel <joerg.roedel@amd.com>
f | nfs_iostat.h | s | 4.1K | 127 | Andy Adamson | andros@netapp.com | 1329422127 |  | SUNRPC: add sending,pending queue and max slot to xprt stats  With static RPC slots, the xprt backlog queue stats were useful in showing when the transport (TCP) was starved by lack of RPC slots. The new dynamic RPC slot code, commit d9ba131d8f58c0d2ff5029e7002ab43f913b36f9, always provides an RPC slot and so only uses the xprt backlog queue when the tcp_max_slot_table_entries value has been hit or when an allocation error occurs. All requests are now placed on the xprt sending or pending queue which need to be monitored for debugging.  The max_slot stat shows the maximum number of dynamic RPC slots reached which is useful when debugging performance issues.  Add the new fields at the end of the mountstats xprt stanza so that mountstats outputs the previous correct values and ignores the new fields. Bump NFS_IOSTATS_VERS.  Signed-off-by: Andy Adamson <andros@netapp.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | magic.h | s | 2.6K | 61 | Muthu Kumar | muthu.lkml@gmail.com | 1332547111 |  | magic.h: move some FS magic numbers into magic.h  - Move open-coded filesystem magic numbers into magic.h  - Rearrange magic.h so that the filesystem-related constants are grouped   together.  Signed-off-by: Muthukumar R <muthur@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | firmware-map.h | s | 1.2K | 35 | Alexey Dobriyan | adobriyan@gmail.com | 1294678304 |  | headers: kobject.h redux  Remove kobject.h from files which don't need it, notably, sched.h and fs.h.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | romfs_fs.h | s | 1.1K | 46 | Mike Frysinger | vapier@gentoo.org | 1294934603 |  | romfs: have romfs_fs.h pull in necessary headers  This header uses things like __be32, so pull in linux/types.h.  Further, it uses BLOCK_SIZE, so pull in linux/fs.h.  Signed-off-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | openvswitch.h | s | 15K | 398 | Jesse Gross | jesse@nicira.com | 1322933717 |  | net: Add Open vSwitch kernel components.  Open vSwitch is a multilayer Ethernet switch targeted at virtualized environments.  In addition to supporting a variety of features expected in a traditional hardware switch, it enables fine-grained programmatic extension and flow-based control of the network. This control is useful in a wide variety of applications but is particularly important in multi-server virtualization deployments, which are often characterized by highly dynamic endpoints and the need to maintain logical abstractions for multiple tenants.  The Open vSwitch datapath provides an in-kernel fast path for packet forwarding.  It is complemented by a userspace daemon, ovs-vswitchd, which is able to accept configuration from a variety of sources and translate it into packet processing rules.  See http://openvswitch.org for more information and userspace utilities.  Signed-off-by: Jesse Gross <jesse@nicira.com>
f | pm_wakeup.h | s | 5.9K | 160 | Rafael J. Wysocki | rjw@sisk.pl | 1335900349 |  | PM / Sleep: Add "prevent autosleep time" statistics to wakeup sources  Android uses one wakelock statistics that is only necessary for opportunistic sleep.  Namely, the prevent_suspend_time field accumulates the total time the given wakelock has been locked while "automatic suspend" was enabled.  Add an analogous field, prevent_sleep_time, to wakeup sources and make it behave in a similar way.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl> Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | wm97xx.h | s | 10K | 289 | Wolfram Sang | w.sang@pengutronix.de | 1309833098 |  | Input: wm97xx - refactor channel selection in poll_sample()  The current implementation of poll_sample() has the problem that one of its arguments, the channel to be selected, differs from wm9713 to other variants. This parameter gets passed to the (currently unused) mach-specific functions pre_sample() and post_sample() which thus have to deal with codec-specific differences. Refactor the routine so that the argument to poll_sample() is generic for all codecs and do necessary conversions only in the codec-specific driver. The outcome even uses less code and removes the non-standard use of the PEN_DOWN bit to mark the AUX-channels.  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | virtio_mmio.h | s | 3.7K | 85 | Sasha Levin | levinsasha928@gmail.com | 1322102087 |  | virtio-mmio: Correct the name of the guest features selector  Guest features selector spelling mistake.  Cc: Pawel Moll <pawel.moll@arm.com> Cc: Rusty Russell <rusty@rustcorp.com.au> Cc: virtualization@lists.linux-foundation.org Signed-off-by: Sasha Levin <levinsasha928@gmail.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | lapb.h | s | 1.7K | 48 | stephen hemminger | shemminger@vyatta.com | 1316215220 |  | wan: make LAPB callbacks const  This is compile tested only. Suggested by dumpster diving in PAX.  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | virtio_ring.h | s | 6.4K | 163 | Rusty Russell | rusty@rustcorp.com.au | 1326345282 |  | virtio: harsher barriers for rpmsg.  We were cheating with our barriers; using the smp ones rather than the real device ones.  That was fine, until rpmsg came along, which is used to talk to a real device (a non-SMP CPU).  Unfortunately, just putting back the real barriers (reverting d57ed95d) causes a performance regression on virtio-pci.  In particular, Amos reports netbench's TCP_RR over virtio_net CPU utilization increased up to 35% while throughput went down by up to 14%.  By comparison, this branch is in the noise.  Reference: https://lkml.org/lkml/2011/12/11/22  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | if_addr.h | s | 1.4K | 52 | Eric Dumazet | eric.dumazet@gmail.com | 1257357058 |  | net: cleanup include/linux  This cleanup patch puts struct/union/enum opening braces, in first line to ease grep games.  struct something {  becomes :  struct something {  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | if_cablemodem.h | s | 910B | 20 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | pfn.h | s | 328B | 10 | Jeremy Fitzhardinge | jeremy@goop.org | 1221405866 |  | generic: make PFN_PHYS explicitly return phys_addr_t  PFN_PHYS, as its name suggests, turns a pfn into a physical address. However, it is a macro which just operates on its argument without modifying its type.  pfns are typed unsigned long, but an unsigned long may not be long enough to hold a physical address (32-bit systems with more than 32 bits of physcial address).  Make sure we cast to phys_addr_t to return a complete result.  Signed-off-by: Jeremy Fitzhardinge <jeremy.fitzhardinge@citrix.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
d | i2c |  | 29 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1337880869 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dtor/input  Pull input layer updates from Dmitry Torokhov:  - a bunch of new drivers (DA9052/53 touchscreenn controller, Synaptics    Navpoint, LM8333 keypads, Wacom I2C touhscreen);  - updates to existing touchpad drivers (ALPS, Sntelic);  - Wacom driver now supports Intuos5;  - device-tree bindings in numerous drivers;  - other cleanups and fixes.  Fix annoying conflict in drivers/input/tablet/wacom_wac.c that I think implies that the input layer device naming is broken, but let's see.  I brough it up with Dmitry.  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dtor/input: (57 commits)   Input: matrix-keymap - fix building keymaps   Input: spear-keyboard - document DT bindings   Input: spear-keyboard - add device tree bindings   Input: matrix-keymap - wire up device tree support   Input: matrix-keymap - uninline and prepare for device tree support   Input: adp5588 - add support for gpio names   Input: omap-keypad - dynamically handle register offsets   Input: synaptics - fix compile warning   MAINTAINERS: adjust input-related patterns   Input: ALPS - switch to using input_mt_report_finger_count   Input: ALPS - add semi-MT support for v4 protocol   Input: Add Synaptics NavPoint (PXA27x SSP/SPI) driver   Input: atmel_mxt_ts - dump each message on just 1 line   Input: atmel_mxt_ts - do not read extra (checksum) byte   Input: atmel_mxt_ts - verify object size in mxt_write_object   Input: atmel_mxt_ts - only allow root to update firmware   Input: atmel_mxt_ts - use CONFIG_PM_SLEEP   Input: sentelic - report device's production serial number   Input: tl6040-vibra - Device Tree support   Input: evdev - properly handle read/write with count 0   ...
f | dmapool.h | s | 923B | 26 | Tejun Heo | htejun@gmail.com | 1171060776 |  | devres: device resource management  Implement device resource management, in short, devres.  A device driver can allocate arbirary size of devres data which is associated with a release function.  On driver detach, release function is invoked on the devres data, then, devres data is freed.  devreses are typed by associated release functions.  Some devreses are better represented by single instance of the type while others need multiple instances sharing the same release function.  Both usages are supported.  devreses can be grouped using devres group such that a device driver can easily release acquired resources halfway through initialization or selectively release resources (e.g. resources for port 1 out of 4 ports).  This patch adds devres core including documentation and the following managed interfaces.  * alloc/free	: devm_kzalloc(), devm_kzfree() * IO region	: devm_request_region(), devm_release_region() * IRQ		: devm_request_irq(), devm_free_irq() * DMA		: dmam_alloc_coherent(), dmam_free_coherent(), 		  dmam_declare_coherent_memory(), dmam_pool_create(), 		  dmam_pool_destroy() * PCI		: pcim_enable_device(), pcim_pin_device(), pci_is_managed() * iomap		: devm_ioport_map(), devm_ioport_unmap(), devm_ioremap(), 		  devm_ioremap_nocache(), devm_iounmap(), pcim_iomap_table(), 		  pcim_iomap(), pcim_iounmap()  Signed-off-by: Tejun Heo <htejun@gmail.com> Signed-off-by: Jeff Garzik <jeff@garzik.org>
f | fs_uart_pd.h | s | 1.5K | 61 | Adrian Bunk | bunk@kernel.org | 1219518852 |  | removed unused #include <linux/version.h>'s  This patch lets the files using linux/version.h match the files that #include it.  Signed-off-by: Adrian Bunk <bunk@kernel.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | of_mtd.h | s | 454B | 16 | Jean-Christophe PLAGNIOL-VILLARD | plagnioj@jcrosoft.com | 1331825299 |  | of/mtd/nand: add generic bindings and helpers  - nand-ecc-mode : String, operation mode of the NAND ecc mode.   Supported values are: "none", "soft", "hw", "hw_syndrome", "hw_oob_first",   "soft_bch". - nand-bus-width : 8 or 16 bus width if not present 8 - nand-on-flash-bbt: boolean to enable on flash bbt option if not present false  Signed-off-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Stefan Roese <sr@denx.de>
f | serial_reg.h | s | 14K | 318 | S√∏ren Holm | sgh@sgh.dk | 1316731838 |  | serial: Support the EFR-register of XR1715x uarts.  The EFR (Enhenced-Features-Register) is located at a different offset than the other devices supporting UART_CAP_EFR. This change add a special setup quick to set UPF_EXAR_EFR on the port. UPF_EXAR_EFR is then used to the port type to PORT_XR17D15X since it is for sure a XR17D15X uart.  Signed-off-by: S√∏ren Holm <sgh@sgh.dk> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | fs_stack.h | s | 772B | 23 | Erez Zadok | ezk@cs.sunysb.edu | 1261065497 |  | VFS/fsstack: handle 32-bit smp + preempt + large files in fsstack_copy_inode_size  Copy the inode size and blocks from one inode to another correctly on 32-bit systems with CONFIG_SMP, CONFIG_PREEMPT, or CONFIG_LBDAF.  Use proper inode spinlocks only when i_size/i_blocks cannot fit in one 32-bit word.  Signed-off-by: Hugh Dickins <hugh.dickins@tiscali.co.uk> Signed-off-by: Erez Zadok <ezk@cs.sunysb.edu> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | cdk.h | s | 12K | 438 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | ptp_clock.h | s | 2.9K | 73 | Richard Cochran | richardcochran@gmail.com | 1306180860 |  | ptp: Added a brand new class driver for ptp clocks.  This patch adds an infrastructure for hardware clocks that implement IEEE 1588, the Precision Time Protocol (PTP). A class driver offers a registration method to particular hardware clock drivers. Each clock is presented as a standard POSIX clock.  The ancillary clock features are exposed in two different ways, via the sysfs and by a character device.  Signed-off-by: Richard Cochran <richard.cochran@omicron.at> Acked-by: Arnd Bergmann <arnd@arndb.de> Acked-by: David S. Miller <davem@davemloft.net> Signed-off-by: John Stultz <john.stultz@linaro.org>
d | ssb |  | 8 items |  | Hauke Mehrtens | hauke@hauke-m.de | 1337186722 |  | bcma/ssb: parse new attributes from sprom  These newly added attributes are used by brcmsmac. Now bcma should parse all attributes used by brcmsmac out of the sprom.  Signed-off-by: Hauke Mehrtens <hauke@hauke-m.de> Tested-by: Arend van Spriel <arend@broadcom.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | timerfd.h | s | 906B | 27 | Thomas Gleixner | tglx@linutronix.de | 1306151993 |  | timerfd: Manage cancelable timers in timerfd  Peter is concerned about the extra scan of CLOCK_REALTIME_COS in the timer interrupt. Yes, I did not think about it, because the solution was so elegant. I didn't like the extra list in timerfd when it was proposed some time ago, but with a rcu based list the list walk it's less horrible than the original global lock, which was held over the list iteration.  Requested-by: Peter Zijlstra <peterz@infradead.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Reviewed-by: Peter Zijlstra <peterz@infradead.org>
f | poll.h | s | 4.5K | 139 | Hans Verkuil | hans.verkuil@cisco.com | 1332547118 |  | poll: add poll_requested_events() and poll_does_not_wait() functions  In some cases the poll() implementation in a driver has to do different things depending on the events the caller wants to poll for.  An example is when a driver needs to start a DMA engine if the caller polls for POLLIN, but doesn't want to do that if POLLIN is not requested but instead only POLLOUT or POLLPRI is requested.  This is something that can happen in the video4linux subsystem among others.  Unfortunately, the current epoll/poll/select implementation doesn't provide that information reliably.  The poll_table_struct does have it: it has a key field with the event mask.  But once a poll() call matches one or more bits of that mask any following poll() calls are passed a NULL poll_table pointer.  Also, the eventpoll implementation always left the key field at ~0 instead of using the requested events mask.  This was changed in eventpoll.c so the key field now contains the actual events that should be polled for as set by the caller.  The solution to the NULL poll_table pointer is to set the qproc field to NULL in poll_table once poll() matches the events, not the poll_table pointer itself.  That way drivers can obtain the mask through a new poll_requested_events inline.  The poll_table_struct can still be NULL since some kernel code calls it internally (netfs_state_poll() in ./drivers/staging/pohmelfs/netfs.h).  In that case poll_requested_events() returns ~0 (i.e.  all events).  Very rarely drivers might want to know whether poll_wait will actually wait.  If another earlier file descriptor in the set already matched the events the caller wanted to wait for, then the kernel will return from the select() call without waiting.  This might be useful information in order to avoid doing expensive work.  A new helper function poll_does_not_wait() is added that drivers can use to detect this situation.  This is now used in sock_poll_wait() in include/net/sock.h.  This was the only place in the kernel that needed this information.  Drivers should no longer access any of the poll_table internals, but use the poll_requested_events() and poll_does_not_wait() access functions instead.  In order to enforce that the poll_table fields are now prepended with an underscore and a comment was added warning against using them directly.  This required a change in unix_dgram_poll() in unix/af_unix.c which used the key field to get the requested events.  It's been replaced by a call to poll_requested_events().  For qproc it was especially important to change its name since the behavior of that field changes with this patch since this function pointer can now be NULL when that wasn't possible in the past.  Any driver accessing the qproc or key fields directly will now fail to compile.  Some notes regarding the correctness of this patch: the driver's poll() function is called with a 'struct poll_table_struct *wait' argument.  This pointer may or may not be NULL, drivers can never rely on it being one or the other as that depends on whether or not an earlier file descriptor in the select()'s fdset matched the requested events.  There are only three things a driver can do with the wait argument:  1) obtain the key field:  	events = wait ? wait->key : ~0;     This will still work although it should be replaced with the new    poll_requested_events() function (which does exactly the same).    This will now even work better, since wait is no longer set to NULL    unnecessarily.  2) use the qproc callback. This could be deadly since qproc can now be    NULL. Renaming qproc should prevent this from happening. There are no    kernel drivers that actually access this callback directly, BTW.  3) test whether wait == NULL to determine whether poll would return without    waiting. This is no longer sufficient as the correct test is now    wait == NULL |||| wait->_qproc == NULL.     However, the worst that can happen here is a slight performance hit in    the case where wait != NULL and wait->_qproc == NULL. In that case the    driver will assume that poll_wait() will actually add the fd to the set    of waiting file descriptors. Of course, poll_wait() will not do that    since it tests for wait->_qproc. This will not break anything, though.     There is only one place in the whole kernel where this happens    (sock_poll_wait() in include/net/sock.h) and that code will be replaced    by a call to poll_does_not_wait() in the next patch.     Note that even if wait->_qproc != NULL drivers cannot rely on poll_wait()    actually waiting. The next file descriptor from the set might match the    event mask and thus any possible waits will never happen.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Reviewed-by: Jonathan Corbet <corbet@lwn.net> Reviewed-by: Al Viro <viro@zeniv.linux.org.uk> Cc: Davide Libenzi <davidel@xmailserver.org> Signed-off-by: Hans de Goede <hdegoede@redhat.com> Cc: Mauro Carvalho Chehab <mchehab@infradead.org> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | i2c-tegra.h | s | 738B | 22 | Colin Cross | ccross@android.com | 1298422406 |  | i2c: tegra: Add i2c support  Adds I2C bus driver for nVidia Tegra SoCs.  Tegra includes 4 I2C controllers, one of which is inside the Dynamic Voltage Controller and has a slightly different register map.  Signed-off-by: Colin Cross <ccross@android.com> Signed-off-by: Ben Dooks <ben-linux@fluff.org>
f | firewire-cdev.h | s | 42K | 990 | Clemens Ladisch | clemens@ladisch.de | 1332105339 |  | firewire: allow explicit flushing of iso packet completions  Extend the kernel and userspace APIs to allow reporting all currently completed isochronous packets, even if the next interrupt packet has not yet been reached.  This is required to determine the status of the packets at the end of a paused or stopped stream, and useful for more precise synchronization of audio streams.  Signed-off-by: Clemens Ladisch <clemens@ladisch.de> Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>
f | leds-lp3944.h | s | 1.1K | 43 | Antonio Ospite | ospite@studenti.unina.it | 1261050111 |  | leds: leds-lp3944.h - remove unneeded includes  These were needed in the first version of the driver because we used to expose workqueue and led class details in the header file, now we don't.  Signed-off-by: Antonio Ospite <ospite@studenti.unina.it> Signed-off-by: Richard Purdie <rpurdie@linux.intel.com>
f | hdlcdrv.h | s | 8.8K | 309 | Hannes Eder | hannes@hanneseder.net | 1234921060 |  | drivers/net/hamradio: fix sparse warnings: fix signedness  Fix this sparse warnings:   drivers/net/hamradio/hdlcdrv.c:274:34: warning: incorrect type in argument 2 (different signedness)   drivers/net/hamradio/hdlcdrv.c:279:47: warning: incorrect type in argument 2 (different signedness)   drivers/net/hamradio/hdlcdrv.c:288:39: warning: incorrect type in argument 2 (different signedness)   drivers/net/hamradio/hdlcdrv.c:300:47: warning: incorrect type in argument 2 (different signedness)  Signed-off-by: Hannes Eder <hannes@hanneseder.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | sirfsoc_dma.h | s | 123B | 4 | Rongjun Ying | Rongjun.Ying@csr.com | 1321599322 |  | dmaengine: add CSR SiRFprimaII DMAC driver  Cc: Jassi Brar <jaswinder.singh@linaro.org> Cc: Arnd Bergmann <arnd@arndb.de> Cc: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Rongjun Ying <rongjun.ying@csr.com> Signed-off-by: Barry Song <Baohua.Song@csr.com> [fixed direction enums and cyclic api based on changes  already merged] Signed-off-by: Vinod Koul <vinod.koul@linux.intel.com>
f | swap.h | s | 14K | 414 | Linus Torvalds | torvalds@linux-foundation.org | 1338838125 |  | 
f | pci-acpi.h | s | 1.2K | 39 | Rafael J. Wysocki | rjw@sisk.pl | 1295207786 |  | PCI / ACPI: Fix build of the AER driver for CONFIG_ACPI unset  After commit 415e12b23792 ("PCI/ACPI: Request _OSC control once for each root bridge (v3)") include/linux/pci-acpi.h is included by drivers/pci/pcie/aer/aerdrv.c and if CONFIG_ACPI is unset, the bogus and unnecessary alternative definition of acpi_find_root_bridge_handle() causes a build error to occur.  Remove the offending piece of garbage.  Reported-and-tested-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | keyboard.h | s | 12K | 431 | Alan Cox | alan@linux.intel.com | 1331232635 |  | vt:tackle kbd_table  Keyboard struct lifetime is easy, but the locking is not and is completely ignored by the existing code. Tackle this one head on  - Make the kbd_table private so we can run down all direct users - Hoick the relevant ioctl handlers into the keyboard layer - Lock them with the keyboard lock so they don't change mid keypress - Add helpers for things like console stop/start so we isolate the poking   around properly - Tweak the braille console so it still builds  There are a couple of FIXME locking cases left for ioctls that are so hideous they should be addressed in a later patch. After this patch the kbd_table is private and all the keyboard jiggery pokery is in one place.  This update fixes speakup and also a memory leak in the original.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | iova.h | s | 1.5K | 44 | David Woodhouse | David.Woodhouse@intel.com | 1247642222 |  | intel-iommu: Remove superfluous iova_alloc_lock from IOVA code  We only ever obtain this lock immediately before the iova_rbtree_lock, and release it immediately after the iova_rbtree_lock. So ditch it and just use iova_rbtree_lock.  [v2: Remove the lockdep bits this time too] Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | dcache.h | s | 12K | 355 | Linus Torvalds | torvalds@linux-foundation.org | 1336704875 |  | vfs: make it possible to access the dentry hash/len as one 64-bit entry  This allows comparing hash and len in one operation on 64-bit architectures.  Right now only __d_lookup_rcu() takes advantage of this, since that is the case we care most about.  The use of anonymous struct/unions hides the alternate 64-bit approach from most users, the exception being a few cases where we initialize a 'struct qstr' with a static initializer.  This makes the problematic cases use a new QSTR_INIT() helper function for that (but initializing just the name pointer with a "{ .name = xyzzy }" initializer remains valid, as does just copying another qstr structure).  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ncp_fs.h | s | 3.3K | 118 | Al Viro | viro@zeniv.linux.org.uk | 1294880623 |  | move internal-only parts of ncpfs headers to fs/ncpfs  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | uinput.h | s | 5.8K | 158 | Dan Carpenter | dan.carpenter@oracle.com | 1318479191 |  | Input: force feedback - potential integer wrap in input_ff_create()  The problem here is that max_effects can wrap on 32 bits systems. We'd allocate a smaller amount of data than sizeof(struct ff_device). The call to kcalloc() on the next line would fail but it would write the NULL return outside of the memory we just allocated causing data corruption.  The call path is that uinput_setup_device() get ->ff_effects_max from the user and sets the value in the ->private_data struct.  From there it is: -> uinput_ioctl_handler()    -> uinput_create_device()       -> input_ff_create(dev, udev->ff_effects_max);  I've also changed ff_effects_max so it's an unsigned int instead of a signed int as a cleanup.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | flat.h | s | 3.3K | 84 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | writeback.h | s | 6.2K | 168 | Jan Kara | jack@suse.cz | 1336283021 |  | writeback: Avoid iput() from flusher thread  Doing iput() from flusher thread (writeback_sb_inodes()) can create problems because iput() can do a lot of work - for example truncate the inode if it's the last iput on unlinked file. Some filesystems depend on flusher thread progressing (e.g. because they need to flush delay allocated blocks to reduce allocation uncertainty) and so flusher thread doing truncate creates interesting dependencies and possibilities for deadlocks.  We get rid of iput() in flusher thread by using the fact that I_SYNC inode flag effectively pins the inode in memory. So if we take care to either hold i_lock or have I_SYNC set, we can get away without taking inode reference in writeback_sb_inodes().  As a side effect of these changes, we also fix possible use-after-free in wb_writeback() because inode_wait_for_writeback() call could try to reacquire i_lock on the inode that was already free.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Fengguang Wu <fengguang.wu@intel.com>
f | percpu.h | s | 25K | 684 | Alex Shi | alex.shi@intel.com | 1337030132 |  | percpu: remove percpu_xxx() functions  Remove percpu_xxx serial functions, all of them were replaced by this_cpu_xxx or __this_cpu_xxx serial functions  Signed-off-by: Alex Shi <alex.shi@intel.com> Acked-by: Christoph Lameter <cl@gentwo.org> Acked-by: Tejun Heo <tj@kernel.org> Acked-by: "H. Peter Anvin" <hpa@zytor.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Tejun Heo <tj@kernel.org>
f | net_dropmon.h | s | 1.1K | 51 | Huang Weiyi | weiyi.huang@gmail.com | 1247454677 |  | dropmon: remove duplicated #include  Remove duplicated #include('s) in   include/linux/net_dropmon.h  Signed-off-by: Huang Weiyi <weiyi.huang@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | virtio_pci.h | s | 3.7K | 79 | Rusty Russell | rusty@rustcorp.com.au | 1306719854 |  | virtio: add full three-clause BSD text to headers.  It's unclear to me if it's important, but it's obviously causing my technical colleages some headaches and I'd hate such imprecision to slow virtio adoption.  I've emailed this to all non-trivial contributors for approval, too.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Ryan Harper <ryanh@us.ibm.com> Acked-by: Anthony Liguori <aliguori@us.ibm.com> Acked-by: Eric Van Hensbergen <ericvh@gmail.com> Acked-by: john cooper <john.cooper@redhat.com> Acked-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Acked-by: Christian Borntraeger <borntraeger@de.ibm.com> Acked-by: Fernando Luis Vazquez Cao <fernando@oss.ntt.co.jp>
f | fdtable.h | s | 3.0K | 106 | David Howells | dhowells@redhat.com | 1329676257 |  | Replace the fd_sets in struct fdtable with an array of unsigned longs  Replace the fd_sets in struct fdtable with an array of unsigned longs and then use the standard non-atomic bit operations rather than the FD_* macros.  This:   (1) Removes the abuses of struct fd_set:       (a) Since we don't want to allocate a full fd_set the vast majority of the      	 time, we actually, in effect, just allocate a just-big-enough array of      	 unsigned longs and cast it to an fd_set type - so why bother with the      	 fd_set at all?       (b) Some places outside of the core fdtable handling code (such as      	 SELinux) want to look inside the array of unsigned longs hidden inside      	 the fd_set struct for more efficient iteration over the entire set.   (2) Eliminates the use of FD_*() macros in the kernel completely.   (3) Permits the __FD_*() macros to be deleted entirely where not exposed to      userspace.  Signed-off-by: David Howells <dhowells@redhat.com> Link: http://lkml.kernel.org/r/20120216174954.23314.48147.stgit@warthog.procyon.org.uk Signed-off-by: H. Peter Anvin <hpa@zytor.com> Cc: Al Viro <viro@zeniv.linux.org.uk>
f | completion.h | s | 3.2K | 91 | NeilBrown | neilb@suse.de | 1294233350 |  | sched: Change wait_for_completion_*_timeout() to return a signed long  wait_for_completion_*_timeout() can return:     0: if the wait timed out  -ve: if the wait was interrupted  +ve: if the completion was completed.  As they currently return an 'unsigned long', the last two cases are not easily distinguished which can easily result in buggy code, as is the case for the recently added wait_for_completion_interruptible_timeout() call in net/sunrpc/cache.c  So change them both to return 'long'.  As MAX_SCHEDULE_TIMEOUT is LONG_MAX, a large +ve return value should never overflow.  Signed-off-by: NeilBrown <neilb@suse.de> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: J.  Bruce Fields <bfields@fieldses.org> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> LKML-Reference: <20110105125016.64ccab0e@notabene.brown> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | virtio_net.h | s | 7.1K | 155 | Jason Wang | jasowang@redhat.com | 1334474611 |  | virtio-net: send gratuitous packets when needed  As hypervior does not have the knowledge of guest network configuration, it's better to ask guest to send gratuitous packets when needed.  This patch implements VIRTIO_NET_F_GUEST_ANNOUNCE feature: hypervisor would notice the guest when it thinks it's time for guest to announce the link presnece. Guest tests VIRTIO_NET_S_ANNOUNCE bit during config change interrupt and woule send gratuitous packets through netif_notify_peers() and ack the notification through ctrl vq.  We need to make sure the atomicy of read and ack in guest otherwise we may ack more times than being notified. This is done through handling the whole config change interrupt in an non-reentrant workqueue.  Signed-off-by: Jason Wang <jasowang@redhat.com> Acked-by: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | coredump.h | s | 407B | 12 | Linus Torvalds | torvalds@linux-foundation.org | 1287091926 |  | Un-inline the core-dump helper functions  Tony Luck reports that the addition of the access_ok() check in commit 0eead9ab41da ("Don't dump task struct in a.out core-dumps") broke the ia64 compile due to missing the necessary header file includes.  Rather than add yet another include (<asm/unistd.h>) to make everything happy, just uninline the silly core dump helper functions and move the bodies to fs/exec.c where they make a lot more sense.  dump_seek() in particular was too big to be an inline function anyway, and none of them are in any way performance-critical.  And we really don't need to mess up our include file headers more than they already are.  Reported-and-tested-by: Tony Luck <tony.luck@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | i2c-mux.h | s | 1.6K | 42 | David Daney | david.daney@cavium.com | 1336825695 |  | i2c: Add a struct device * parameter to i2c_add_mux_adapter()  And adjust all callers.  The new device parameter is used in the next patch to initialize the mux's of_node so that its children may be automatically populated.  Signed-off-by: David Daney <david.daney@cavium.com> Tested-by: Lars-Peter Clausen <lars@metafoo.de> Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | ratelimit.h | s | 1.8K | 66 | Thomas Gleixner | tglx@linutronix.de | 1315905114 |  | locking, printk: Annotate logbuf_lock as raw  The logbuf_lock lock can be taken in atomic context and therefore cannot be preempted on -rt - annotate it.  In mainline this change documents the low level nature of the lock - otherwise there's no functional difference. Lockdep and Sparse checking will work as usual.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> [ merged and fixed it ] Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | compiler-intel.h | s | 746B | 22 | Robert P. J. Day | rpjday@mindspring.com | 1192635767 |  | Force erroneous inclusions of compiler-*.h files to be errors  Replace worthless comments with actual preprocessor errors when including the wrong versions of the compiler.h files.  [akpm@linux-foundation.org: make it work] Signed-off-by: Robert P. J. Day <rpjday@mindspring.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | gpio_mouse.h | s | 1.5K | 54 | Hans-Christian Egtvedt | hcegtvedt@norway.atmel.com | 1184042117 |  | Input: add gpio-mouse driver  Adds support for simulating a mouse using GPIO lines. The driver needs an appropriate platform device to be created by architecture code.  The driver has been tested on AT32AP7000 microprocessor using the ATSTK1000 development board.  Signed-off-by: Hans-Christian Egtvedt <hcegtvedt@atmel.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | user_namespace.h | s | 1.5K | 57 | Eric W. Biederman | ebiederm@xmission.com | 1336040919 |  | userns: Replace user_ns_map_uid and user_ns_map_gid with from_kuid and from_kgid  These function are no longer needed replace them with their more useful equivalents.  Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | ktime.h | s | 9.3K | 297 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | leds-bd2802.h | s | 642B | 22 | Kim Kyuwon | chammoru@gmail.com | 1239030386 |  | leds: add BD2802GU LED driver  ROHM BD2802GU is a RGB LED controller attached to i2c bus and specifically engineered for decoration purposes.  This RGB controller incorporates lighting patterns and illuminates.  This driver is designed to minimize power consumption, so when there is no emitting LED, it enters to reset state.  And because the BD2802GU has lots of features that can't be covered by the current LED framework, it provides Advanced Configuration Function(ADF) mode, so that user applications can set registers of BD2802GU directly.  Here are basic usage examples : ; to turn on LED (not blink) $ echo 1 > /sys/class/leds/led1_R/brightness ; to blink LED $ echo timer > /sys/class/leds/led1_R/trigger $ echo 1 > /sys/class/leds/led1_R/delay_on $ echo 1 > /sys/class/leds/led1_R/delay_off ; to turn off LED $ echo 0 > /sys/class/leds/led1_R/brightness  [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: Kim Kyuwon <chammoru@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Richard Purdie <rpurdie@linux.intel.com>
f | serial167.h | s | 4.1K | 145 | Jiri Slaby | jirislaby@gmail.com | 1202402554 |  | Char: serial167, remove bottomhalf  - Cy_EVENT_OPEN_WAKEUP is simple wake_up - Cy_EVENT_HANGUP is wake_up + tty_hangup, which schedules its own work - Cy_EVENT_WRITE_WAKEUP is tty_wakeup which may be called directly too  Signed-off-by: Jiri Slaby <jirislaby@gmail.com> Acked-by: Alan Cox <alan@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | huge_mm.h | s | 6.4K | 189 | Alex Shi | alex.shi@intel.com | 1338333741 |  | mm: move is_vma_temporary_stack() declaration to huge_mm.h  When transparent_hugepage_enabled() is used outside mm/, such as in arch/x86/xx/tlb.c:  +       if (!cpu_has_invlpg |||| vma->vm_flags & VM_HUGETLB +                       |||| transparent_hugepage_enabled(vma)) { +               flush_tlb_mm(vma->vm_mm);  is_vma_temporary_stack() isn't referenced in huge_mm.h, so it has compile errors:    arch/x86/mm/tlb.c: In function `flush_tlb_range':   arch/x86/mm/tlb.c:324:4: error: implicit declaration of function `is_vma_temporary_stack' [-Werror=implicit-function-declaration]  Since is_vma_temporay_stack() is just used in rmap.c and huge_memory.c, it is better to move it to huge_mm.h from rmap.h to avoid such errors.  Signed-off-by: Alex Shi <alex.shi@intel.com> Cc: Andrea Arcangeli <aarcange@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | syscalls.h | s | 37K | 800 | Cyrill Gorcunov | gorcunov@openvz.org | 1338511772 |  | syscalls, x86: add __NR_kcmp syscall  While doing the checkpoint-restore in the user space one need to determine whether various kernel objects (like mm_struct-s of file_struct-s) are shared between tasks and restore this state.  The 2nd step can be solved by using appropriate CLONE_ flags and the unshare syscall, while there's currently no ways for solving the 1st one.  One of the ways for checking whether two tasks share e.g.  mm_struct is to provide some mm_struct ID of a task to its proc file, but showing such info considered to be not that good for security reasons.  Thus after some debates we end up in conclusion that using that named 'comparison' syscall might be the best candidate.  So here is it -- __NR_kcmp.  It takes up to 5 arguments - the pids of the two tasks (which characteristics should be compared), the comparison type and (in case of comparison of files) two file descriptors.  Lookups for pids are done in the caller's PID namespace only.  At moment only x86 is supported and tested.  [akpm@linux-foundation.org: fix up selftests, warnings] [akpm@linux-foundation.org: include errno.h] [akpm@linux-foundation.org: tweak comment text] Signed-off-by: Cyrill Gorcunov <gorcunov@openvz.org> Acked-by: "Eric W. Biederman" <ebiederm@xmission.com> Cc: Pavel Emelyanov <xemul@parallels.com> Cc: Andrey Vagin <avagin@openvz.org> Cc: KOSAKI Motohiro <kosaki.motohiro@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: H. Peter Anvin <hpa@zytor.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Glauber Costa <glommer@parallels.com> Cc: Andi Kleen <andi@firstfloor.org> Cc: Tejun Heo <tj@kernel.org> Cc: Matt Helsley <matthltc@us.ibm.com> Cc: Pekka Enberg <penberg@kernel.org> Cc: Eric Dumazet <eric.dumazet@gmail.com> Cc: Vasiliy Kulikov <segoon@openwall.com> Cc: Alexey Dobriyan <adobriyan@gmail.com> Cc: Valdis.Kletnieks@vt.edu Cc: Michal Marek <mmarek@suse.cz> Cc: Frederic Weisbecker <fweisbec@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | media.h | s | 3.4K | 112 | Laurent Pinchart | laurent.pinchart@ideasonboard.com | 1300780436 |  | [media] media: Pick a free ioctls range  Pick an unused range of ioctls in Documentation/ioctl/ioctl-number.txt and use it for the MEDIA_IOC_* ioctls.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | mqueue.h | s | 2.0K | 44 | Alexey Dobriyan | adobriyan@gmail.com | 1164858022 |  | mqueue.h: don't include linux/types.h  This #include is not required.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Adrian Bunk <bunk@stusta.de>
f | nfs_fs.h | s | 18K | 569 | Andy Adamson | andros@netapp.com | 1337890548 |  | NFSv4.1 add nfs_inode book keeping for mdsthreshold  Keep track of the number of bytes read or written via buffered, direct, and mem-mapped i/o for use by mdsthreshold size_io hints.  Signed-off-by: Andy Adamson <andros@netapp.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | cpufreq.h | s | 12K | 327 | Linus Torvalds | torvalds@linux-foundation.org | 1332610897 |  | 
f | dn.h | s | 4.4K | 118 | Eric Dumazet | eric.dumazet@gmail.com | 1257357058 |  | net: cleanup include/linux  This cleanup patch puts struct/union/enum opening braces, in first line to ease grep games.  struct something {  becomes :  struct something {  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cramfs_fs_sb.h | s | 343B | 17 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | input.h | s | 48K | 1456 | Dmitry Torokhov | dmitry.torokhov@gmail.com | 1331319395 |  | Merge branch 'for-next' of github.com:rydberg/linux into next
f | rds.h | s | 7.7K | 256 | Andy Grover | andy.grover@oracle.com | 1283995015 |  | RDS: Remove dead struct from rds.h  flows are an obsolete date type.  Signed-off-by: Andy Grover <andy.grover@oracle.com>
f | moduleloader.h | s | 1.8K | 44 | Jonas Bonn | jonas@southpole.se | 1311510964 |  | modules: add default loader hook implementations  The module loader code allows architectures to hook into the code by providing a small number of entry points that each arch must implement. This patch provides __weakly linked generic implementations of these entry points for architectures that don't need to do anything special.  Signed-off-by: Jonas Bonn <jonas@southpole.se> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | toshiba.h | s | 1.3K | 35 | Alexander Shishkin | virtuoso@slind.org | 1294934588 |  | toshiba.h: hide a function prototypes behind __KERNEL__ macro  Currently, tosh_smm() prototype is present in a header file exported to userland.  This patch fixes it.  Signed-off-by: Alexander Shishkin <virtuoso@slind.org> Cc: Jonathan Buzzard <jonathan@buzzard.org.uk> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | nfs4.h | s | 19K | 611 | Trond Myklebust | Trond.Myklebust@netapp.com | 1338056250 |  | NFSv4.1: Add DESTROY_CLIENTID  Ensure that we destroy our lease on last unmount  Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | list_bl.h | s | 4.0K | 131 | Christoph Hellwig | hch@infradead.org | 1303780450 |  | add hlist_bl_lock/unlock helpers  Now that the whole dcache_hash_bucket crap is gone, go all the way and also remove the weird locking layering violations for locking the hash buckets.  Add hlist_bl_lock/unlock helpers to move the locking into the list abstraction instead of requiring each caller to open code it. After all allowing for the bit locks is the whole point of these helpers over the plain hlist variant.  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atmel_tc.h | s | 11K | 238 | Nicolas Ferre | nicolas.ferre@atmel.com | 1330605529 |  | ARM: at91/tc/clocksource: Add 32 bit variant to Timer Counter  Some SoC have a 32 bit variant of Timer Counter Blocks. We do not need the chaining of two 16 bit counters anymore for them.  The SoC nature is deduced from the device tree "compatible" string. For non-device-tree configurations, backward compatibility is maintained by using the default 16 bit counter configuration.  This patch addresses both the atmel_tclib and its user: tcb_clksrc clocksource.  Signed-off-by: Nicolas Ferre <nicolas.ferre@atmel.com> Acked-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Acked-by: Grant Likely <grant.likely@secretlab.ca>
f | if_plip.h | s | 596B | 21 | Eric Dumazet | eric.dumazet@gmail.com | 1257357058 |  | net: cleanup include/linux  This cleanup patch puts struct/union/enum opening braces, in first line to ease grep games.  struct something {  becomes :  struct something {  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | seqlock.h | s | 7.4K | 248 | Linus Torvalds | torvalds@linux-foundation.org | 1336169634 |  | seqlock: add 'raw_seqcount_begin()' function  The normal read_seqcount_begin() function will wait for any current writers to exit their critical region by looping until the sequence count is even.  That "wait for sequence count to stabilize" is the right thing to do if the read-locker will just retry the whole operation on contention: no point in doing a potentially expensive reader sequence if we know at the beginning that we'll just end up re-doing it all.  HOWEVER.  Some users don't actually retry the operation, but instead will abort and do the operation with proper locking.  So the sequence count case may be the optimistic quick case, but in the presense of writers you may want to do full locking in order to guarantee forward progress.  The prime example of this would be the RCU name lookup.  And in that case, you may well be better off without the "retry early", and are in a rush to instead get to the failure handling.  Thus this "raw" interface that just returns the sequence number without testing it - it just forces the low bit to zero so that read_seqcount_retry() will always fail such a "active concurrent writer" scenario.  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | taskstats_kern.h | s | 911B | 29 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | devpts_fs.h | s | 1.4K | 40 | Sukadev Bhattiprolu | sukadev@us.ibm.com | 1223916703 |  | Add an instance parameter devpts interfaces  Pass-in 'inode' or 'tty' parameter to devpts interfaces.  With multiple devpts instances, these parameters will be used in subsequent patches to identify the instance of devpts mounted. The parameters also help simplify devpts implementation.  Changelog[v3]: 	- minor changes due to merge with ttydev updates 	- rename parameters to emphasize they are ptmx or pts inodes 	- pass-in tty_struct * to devpts_pty_kill() (this will help 	  cleanup the get_node() call in a subsequent patch)  Signed-off-by: Sukadev Bhattiprolu <sukadev@us.ibm.com> Signed-off-by: Alan Cox <alan@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | log2.h | s | 5.3K | 193 | Linus Torvalds | torvalds@linux-foundation.org | 1323756415 |  | linux/log2.h: Fix rounddown_pow_of_two(1)  Exactly like roundup_pow_of_two(1), the rounddown version was buggy for the case of a compile-time constant '1' argument.  Probably because it originated from the same code, sharing history with the roundup version from before the bugfix (for that one, see commit 1a06a52ee1b0: "Fix roundup_pow_of_two(1)").  However, unlike the roundup version, the fix for rounddown is to just remove the broken special case entirely.  It's simply not needed - the generic code      1UL << ilog2(n)  does the right thing for the constant '1' argment too.  The only reason roundup needed that special case was because rounding up does so by subtracting one from the argument (and then adding one to the result) causing the obvious problems with "ilog2(0)".  But rounddown doesn't do any of that, since ilog2() naturally truncates (ie "rounds down") to the right rounded down value.  And without the ilog2(0) case, there's no reason for the special case that had the wrong value.  tl;dr: rounddown_pow_of_two(1) should be 1, not 0.  Acked-by: Dmitry Torokhov <dtor@vmware.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | gfs2_ondisk.h | s | 11K | 368 | Steven Whitehouse | swhiteho@redhat.com | 1330449021 |  | GFS2: FITRIM ioctl support  The FITRIM ioctl provides an alternative way to send discard requests to the underlying device. Using the discard mount option results in every freed block generating a discard request to the block device. This can be slow, since many block devices can only process discard requests of larger sizes, and also such operations can be time consuming.  Rather than using the discard mount option, FITRIM allows a sweep of the filesystem on an occasional basis, and also to optionally avoid sending down discard requests for smaller regions.  In GFS2 FITRIM will work at resource group granularity. There is a flag for each resource group which keeps track of which resource groups have been trimmed. This flag is reset whenever a deallocation occurs in the resource group, and set whenever a successful FITRIM of that resource group has taken place. This helps to reduce repeated discard requests for the same block ranges, again improving performance.  Signed-off-by: Steven Whitehouse <swhiteho@redhat.com>
f | if_packet.h | s | 6.6K | 235 | Ji≈ô√≠ ≈Ωupka | jzupka@redhat.com | 1317665028 |  | Repair wrong named definition aligned_u64  This repairs problem with compile library in userspace (libnl).  Signed-off-by: Ji≈ô√≠ ≈Ωupka <jzupka@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | gen_stats.h | s | 1.3K | 59 | Eric Dumazet | eric.dumazet@gmail.com | 1257357058 |  | net: cleanup include/linux  This cleanup patch puts struct/union/enum opening braces, in first line to ease grep games.  struct something {  becomes :  struct something {  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bitrev.h | s | 270B | 11 | Harvey Harrison | harvey.harrison@gmail.com | 1212776950 |  | lib: export bitrev16  Bluetooth will be able to use this.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Dave Young <hidave.darkstar@gmail.com> Cc: Akinobu Mita <akinobu.mita@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | isapnp.h | s | 3.9K | 103 | Rusty Russell | rusty@rustcorp.com.au | 1274256218 |  | isapnp: move definitions to mod_devicetable.h so file2alias can reach them.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | atm_suni.h | s | 253B | 7 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | atmel-pwm-bl.h | s | 1.5K | 40 | Hans-Christian Egtvedt | hans-christian.egtvedt@atmel.com | 1216921661 |  | fbdev: LCD backlight driver using Atmel PWM driver  This patch adds a platform driver using the ATMEL PWM driver to control a backlight which requires a PWM signal and optional GPIO signal for discrete on/off signal.  It has been tested on Favr-32 board from EarthLCD.  The driver is configurable by supplying a struct with the platform data.  See the include/linux/atmel-pwm-bl.h for details.  The board code for Favr-32 will be submitted to the AVR32 kernel list.  Signed-off-by: Hans-Christian Egtvedt <hans-christian.egtvedt@atmel.com> Cc: Krzysztof Helt <krzysztof.h1@poczta.fm> Cc: Haavard Skinnemoen <hskinnemoen@atmel.com> Cc: Richard Purdie <rpurdie@rpsys.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cycx_cfm.h | s | 2.9K | 91 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | pm_domain.h | s | 7.5K | 218 | Rafael J. Wysocki | rjw@sisk.pl | 1337366726 |  | PM / Domains: Make it possible to add devices to inactive domains  The generic PM domains core code currently requires domains to be in the "power on" state for adding devices to them, but this limitation turns out to be inconvenient in some situations, so remove it.  For this purpose, make __pm_genpd_add_device() set the device's need_restore flag if the domain is in the "power off" state, so that the device's "restore state" (usually .runtime_resume()) callback is executed when it is resumed after the domain has been turned on. If the domain is in the "power on" state, the device's need_restore flag will be cleared by __pm_genpd_add_device(), so that its "save state" (usually .runtime_suspend()) callback is executed when the domain is about to be turned off.  However, since that default behavior need not be always desirable, add a helper function pm_genpd_dev_need_restore() allowing a device's need_restore flag to be set/unset at any time.  Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | utsname.h | s | 2.1K | 91 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1320275222 |  | sysctl: add support for poll()  Adding support for poll() in sysctl fs allows userspace to receive notifications of changes in sysctl entries.  This adds a infrastructure to allow files in sysctl fs to be pollable and implements it for hostname and domainname.  [akpm@linux-foundation.org: s/declare/define/ for definitions] Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi> Cc: Greg KH <gregkh@suse.de> Cc: Kay Sievers <kay.sievers@vrfy.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: "Eric W. Biederman" <ebiederm@xmission.com> Cc: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sm501.h | s | 4.6K | 149 | Heiko Schocher | hs@denx.de | 1300781794 |  | video, sm501: add I/O functions for use on powerpc  - add read/write functions for using this driver   also on powerpc plattforms  Signed-off-by: Heiko Schocher <hs@denx.de> cc: linux-fbdev@vger.kernel.org cc: devicetree-discuss@ozlabs.org cc: Ben Dooks <ben@simtec.co.uk> cc: Vincent Sanders <vince@simtec.co.uk> cc: Samuel Ortiz <sameo@linux.intel.com> cc: linux-kernel@vger.kernel.org cc: Randy Dunlap <rdunlap@xenotime.net> cc: Paul Mundt <lethal@linux-sh.org> Acked-by: Samuel Ortiz <sameo@linux.intel.com> Signed-off-by: Paul Mundt <lethal@linux-sh.org>
f | amifdreg.h | s | 2.6K | 65 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | regmap.h | s | 11K | 324 | Graeme Gregory | gg@slimlogic.co.uk | 1337013605 |  | regmap: add support for non contiguous status to regmap-irq  In some chips the IRQ status registers are not contiguous in the register map but spaced at even spaces. This is an easy case to handle with minor changes. It is assume for this purpose that the stride for status is equal to the stride for mask/ack registers as well.  Signed-off-by: Graeme Gregory <gg@slimlogic.co.uk> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
f | jiffies.h | s | 11K | 277 | hank | pyu@redhat.com | 1316593731 |  | time: Change jiffies_to_clock_t() argument type to unsigned long  The parameter's origin type is long. On an i386 architecture, it can easily be larger than 0x80000000, causing this function to convert it to a sign-extended u64 type.  Change the type to unsigned long so we get the correct result.  Signed-off-by: hank <pyu@redhat.com> Cc: John Stultz <john.stultz@linaro.org> Cc: <stable@kernel.org> [ build fix ] Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | auxvec.h | s | 1.5K | 34 | Kees Cook | kees.cook@canonical.com | 1231432272 |  | ELF: implement AT_RANDOM for glibc PRNG seeding  While discussing[1] the need for glibc to have access to random bytes during program load, it seems that an earlier attempt to implement AT_RANDOM got stalled.  This implements a random 16 byte string, available to every ELF program via a new auxv AT_RANDOM vector.  [1] http://sourceware.org/ml/libc-alpha/2008-10/msg00006.html  Ulrich said:  glibc needs right after startup a bit of random data for internal protections (stack canary etc).  What is now in upstream glibc is that we always unconditionally open /dev/urandom, read some data, and use it.  For every process startup.  That's slow.  ...  The solution is to provide a limited amount of random data to the starting process in the aux vector.  I suggested 16 bytes and this is what the patch implements.  If we need only 16 bytes or less we use the data directly.  If we need more we'll use the 16 bytes to see a PRNG. This avoids the costly /dev/urandom use and it allows the kernel to use the most adequate source of random data for this purpose.  It might not be the same pool as that for /dev/urandom.  Concerns were expressed about the depletion of the randomness pool.  But this patch doesn't make the situation worse, it doesn't deplete entropy more than happens now.  Signed-off-by: Kees Cook <kees.cook@canonical.com> Cc: Jakub Jelinek <jakub@redhat.com> Cc: Andi Kleen <andi@firstfloor.org> Cc: Ulrich Drepper <drepper@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cyclomx.h | s | 2.5K | 71 | David Woodhouse | dwmw2@infradead.org | 1146052576 |  | Don't include linux/config.h from anywhere else in include/  Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | delayacct.h | s | 4.0K | 134 | Tejun Heo | tj@kernel.org | 1269954152 |  | include cleanup: Update gfp.h and slab.h includes to prepare for breaking implicit slab.h inclusion from percpu.h  percpu.h is included by sched.h and module.h and thus ends up being included when building most .c files.  percpu.h includes slab.h which in turn includes gfp.h making everything defined by the two files universally available and complicating inclusion dependencies.  percpu.h -> slab.h dependency is about to be removed.  Prepare for this change by updating users of gfp and slab facilities include those headers directly instead of assuming availability.  As this conversion needs to touch large number of source files, the following script is used as the basis of conversion.    http://userweb.kernel.org/~tj/misc/slabh-sweep.py  The script does the followings.  * Scan files for gfp and slab usages and update includes such that   only the necessary includes are there.  ie. if only gfp is used,   gfp.h, if slab is used, slab.h.  * When the script inserts a new include, it looks at the include   blocks and try to put the new include such that its order conforms   to its surrounding.  It's put in the include block which contains   core kernel includes, in the same order that the rest are ordered -   alphabetical, Christmas tree, rev-Xmas-tree or at the end if there   doesn't seem to be any matching order.  * If the script can't find a place to put a new include (mostly   because the file doesn't have fitting include block), it prints out   an error message indicating which .h file needs to be added to the   file.  The conversion was done in the following steps.  1. The initial automatic conversion of all .c files updated slightly    over 4000 files, deleting around 700 includes and adding ~480 gfp.h    and ~3000 slab.h inclusions.  The script emitted errors for ~400    files.  2. Each error was manually checked.  Some didn't need the inclusion,    some needed manual addition while adding it to implementation .h or    embedding .c file was more appropriate for others.  This step added    inclusions to around 150 files.  3. The script was run again and the output was compared to the edits    from #2 to make sure no file was left behind.  4. Several build tests were done and a couple of problems were fixed.    e.g. lib/decompress_*.c used malloc/free() wrappers around slab    APIs requiring slab.h to be added manually.  5. The script was run on all .h files but without automatically    editing them as sprinkling gfp.h and slab.h inclusions around .h    files could easily lead to inclusion dependency hell.  Most gfp.h    inclusion directives were ignored as stuff from gfp.h was usually    wildly available and often used in preprocessor macros.  Each    slab.h inclusion directive was examined and added manually as    necessary.  6. percpu.h was updated not to include slab.h.  7. Build test were done on the following configurations and failures    were fixed.  CONFIG_GCOV_KERNEL was turned off for all tests (as my    distributed build env didn't work with gcov compiles) and a few    more options had to be turned off depending on archs to make things    build (like ipr on powerpc/64 which failed due to missing writeq).     * x86 and x86_64 UP and SMP allmodconfig and a custom test config.    * powerpc and powerpc64 SMP allmodconfig    * sparc and sparc64 SMP allmodconfig    * ia64 SMP allmodconfig    * s390 SMP allmodconfig    * alpha SMP allmodconfig    * um on x86_64 SMP allmodconfig  8. percpu.h modifications were reverted so that it could be applied as    a separate patch and serve as bisection point.  Given the fact that I had only a couple of failures from tests on step 6, I'm fairly confident about the coverage of this conversion patch. If there is a breakage, it's likely to be something in one of the arch headers which should be easily discoverable easily on most builds of the specific arch.  Signed-off-by: Tejun Heo <tj@kernel.org> Guess-its-ok-by: Christoph Lameter <cl@linux-foundation.org> Cc: Ingo Molnar <mingo@redhat.com> Cc: Lee Schermerhorn <Lee.Schermerhorn@hp.com>
f | virtio_balloon.h | s | 2.7K | 53 | Rusty Russell | rusty@rustcorp.com.au | 1306719854 |  | virtio: add full three-clause BSD text to headers.  It's unclear to me if it's important, but it's obviously causing my technical colleages some headaches and I'd hate such imprecision to slow virtio adoption.  I've emailed this to all non-trivial contributors for approval, too.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Ryan Harper <ryanh@us.ibm.com> Acked-by: Anthony Liguori <aliguori@us.ibm.com> Acked-by: Eric Van Hensbergen <ericvh@gmail.com> Acked-by: john cooper <john.cooper@redhat.com> Acked-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Acked-by: Christian Borntraeger <borntraeger@de.ibm.com> Acked-by: Fernando Luis Vazquez Cao <fernando@oss.ntt.co.jp>
f | raid_class.h | s | 2.1K | 72 | Kashyap, Desai | kashyap.desai@lsi.com | 1265674781 |  | [SCSI] mpt2sas: Added raid transport support  Adding support for raid transport layer.  This will provide sysfs attributes containing raid level, state, and resync rate.  MPT2SAS module will select RAID_ATTRS.  Signed-off-by: Kashyap Desai <kashyap.desai@lsi.com> Reviewed-by: Eric Moore <eric.moore@lsi.com> Signed-off-by: James Bottomley <James.Bottomley@suse.de>
f | ac97_codec.h | s | 14K | 311 | Adrian Bunk | bunk@kernel.org | 1202323262 |  | scheduled OSS driver removal  This patch contains the scheduled removal of OSS drivers whose config options have been removed in 2.6.23.  Signed-off-by: Adrian Bunk <bunk@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | highmem.h | s | 7.1K | 231 | Linus Torvalds | torvalds@linux-foundation.org | 1332608919 |  | 
d | nfc |  | 1 items |  | Eric Lapuyade | eric.lapuyade@intel.com | 1337117430 |  | NFC: HCI based pn544 driver  This is an NFC driver for NXP pn544. Unlike pn544.c, this one is based on the NFC HCI and SHDLC kernel layers.  Signed-off-by: Eric Lapuyade <eric.lapuyade@intel.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | ppp_channel.h | s | 3.1K | 73 | stephen hemminger | shemminger@vyatta.com | 1280983997 |  | ppp: make channel_ops const  The PPP channel ops structure should be const. Cleanup the declarations to use standard C99 format.  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | smscphy.h | s | 1004B | 19 | Javier Martinez Canillas | javier@dowhile0.org | 1325640198 |  | net: phy: smsc: Move SMSC PHY constants to <linux/smscphy.h>  SMSC generation 4 LAN chips integrate an IEEE 802.3 ethernet physical layer. The ethernet driver for this family of devices needs to access the SMSC PHY registers and bit-fields.  So, this patch moves these constants to a place where it can be used for both the PHY and LAN drivers.  Signed-off-by: Javier Martinez Canillas <javier@dowhile0.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mm.h | s | 54K | 1407 | Linus Torvalds | torvalds@linux-foundation.org | 1338572075 |  | Merge branch 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/viro/vfs  Pull vfs changes from Al Viro.  "A lot of misc stuff.  The obvious groups:    * Miklos' atomic_open series; kills the damn abuse of      ->d_revalidate() by NFS, which was the major stumbling block for      all work in that area.    * ripping security_file_mmap() and dealing with deadlocks in the      area; sanitizing the neighborhood of vm_mmap()/vm_munmap() in      general.    * ->encode_fh() switched to saner API; insane fake dentry in      mm/cleancache.c gone.    * assorted annotations in fs (endianness, __user)    * parts of Artem's ->s_dirty work (jff2 and reiserfs parts)    * ->update_time() work from Josef.    * other bits and pieces all over the place.    Normally it would've been in two or three pull requests, but   signal.git stuff had eaten a lot of time during this cycle ;-/"  Fix up trivial conflicts in Documentation/filesystems/vfs.txt (the 'truncate_range' inode method was removed by the VM changes, the VFS update adds an 'update_time()' method), and in fs/btrfs/ulist.[ch] (due to sparse fix added twice, with other changes nearby).  * 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/viro/vfs: (95 commits)   nfs: don't open in ->d_revalidate   vfs: retry last component if opening stale dentry   vfs: nameidata_to_filp(): don't throw away file on error   vfs: nameidata_to_filp(): inline __dentry_open()   vfs: do_dentry_open(): don't put filp   vfs: split __dentry_open()   vfs: do_last() common post lookup   vfs: do_last(): add audit_inode before open   vfs: do_last(): only return EISDIR for O_CREAT   vfs: do_last(): check LOOKUP_DIRECTORY   vfs: do_last(): make ENOENT exit RCU safe   vfs: make follow_link check RCU safe   vfs: do_last(): use inode variable   vfs: do_last(): inline walk_component()   vfs: do_last(): make exit RCU safe   vfs: split do_lookup()   Btrfs: move over to use ->update_time   fs: introduce inode operation ->update_time   reiserfs: get rid of resierfs_sync_super   reiserfs: mark the superblock as dirty a bit later   ...
f | pci_hotplug.h | s | 7.0K | 188 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103952 |  | include: convert various register fcns to macros to avoid include chaining  The original implementations reference THIS_MODULE in an inline. We could include <linux/export.h>, but it is better to avoid chaining.  Fortunately someone else already thought of this, and made a similar inline into a #define in <linux/device.h> for device_schedule_callback(), [see commit 523ded71de0] so follow that precedent here.  Also bubble up any __must_check that were used on the prev. wrapper inline functions up one to the real __register functions, to preserve any prev. sanity checks that were used in those instances.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | htirq.h | s | 787B | 19 | Thomas Gleixner | tglx@linutronix.de | 1286895217 |  | ht: Convert to new irq_chip functions  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Reviewed-by: Ingo Molnar <mingo@elte.hu> Cc: Jesse Barnes <jbarnes@virtuousgeek.org>
f | kbuild.h | s | 309B | 10 | Christoph Lameter | clameter@sgi.com | 1209481589 |  | Add kbuild.h that contains common definitions for kbuild users  The same definitions are used for the bounds logic and the asm-offsets.h generation by kbuild.  Put them into include/linux/kbuild.h file.  Also add a new feature  	COMMENT("text")  which can be used to insert lines of ocmments into asm-offsets.h and bounds.h.  Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Christoph Lameter <clameter@sgi.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Jay Estabrook <jay.estabrook@hp.com> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: Richard Henderson <rth@twiddle.net> Cc: "Luck, Tony" <tony.luck@intel.com> Cc: Russell King <rmk@arm.linux.org.uk> Cc: Chris Zankel <chris@zankel.net> Cc: David S. Miller <davem@davemloft.net> Cc: Haavard Skinnemoen <hskinnemoen@atmel.com> Cc: Bryan Wu <bryan.wu@analog.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Cc: Yoshinori Sato <ysato@users.sourceforge.jp> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Roman Zippel <zippel@linux-m68k.org> Cc: Greg Ungerer <gerg@uclinux.org> Cc: David Howells <dhowells@redhat.com> Cc: Kyle McMartin <kyle@mcmartin.ca> Cc: Grant Grundler <grundler@parisc-linux.org> Cc: Matthew Wilcox <matthew@wil.cx> Cc: Paul Mackerras <paulus@samba.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Cc: Miles Bader <miles@gnu.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | marvell_phy.h | s | 713B | 18 | David Daney | ddaney@caviumnetworks.com | 1290443663 |  | phylib: Add support for Marvell 88E1149R devices.  The 88E1149R is 10/100/1000 quad-gigabit Ethernet PHY.  The .config_aneg function can be shared with 88E1118, but it needs its own .config_init.  Signed-off-by: David Daney <ddaney@caviumnetworks.com> Cc: Cyril Chemparathy <cyril@ti.com> Cc: Arnaud Patard <arnaud.patard@rtp-net.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | dm-region-hash.h | s | 3.1K | 82 | Mikulas Patocka | mpatocka@redhat.com | 1260489125 |  | dm raid1: remove bio_endio from dm_rh_mark_nosync  Move bio completion out of dm_rh_mark_nosync in preparation for the next patch.  Signed-off-by: Mikulas Patocka <mpatocka@redhat.com> Reviewed-by: Takahiro Yasui <tyasui@redhat.com> Tested-by: Takahiro Yasui <tyasui@redhat.com> Signed-off-by: Alasdair G Kergon <agk@redhat.com>
f | adfs_fs.h | s | 1.3K | 56 | Al Viro | viro@zeniv.linux.org.uk | 1245213396 |  | Cleanup of adfs headers  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | bsearch.h | s | 236B | 6 | Tim Abbott | tabbott@ksplice.com | 1305789927 |  | lib: Add generic binary search function to the kernel.  There a large number hand-coded binary searches in the kernel (run "git grep search || grep binary" to find many of them).  Since in my experience, hand-coding binary searches can be error-prone, it seems worth cleaning this up by providing a generic binary search function.  This generic binary search implementation comes from Ksplice.  It has the same basic API as the C library bsearch() function.  Ksplice uses it in half a dozen places with 4 different comparison functions, and I think our code is substantially cleaner because of this.  Signed-off-by: Tim Abbott <tabbott@ksplice.com> Extra-bikeshedding-by: Alan Jenkins <alan-jenkins@tuffmail.co.uk> Extra-bikeshedding-by: Andr√© Goddard Rosa <andre.goddard@gmail.com> Extra-bikeshedding-by: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: Alessio Igor Bogani <abogani@kernel.org> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | in6.h | s | 7.2K | 255 | Eldad Zack | eldad@fogrefinery.com | 1337284191 |  | ipv6: correct the ipv6 option name - Pad0 to Pad1  The padding destination or hop-by-hop option is called Pad1 and not Pad0.  See RFC2460 (4.2) or the IANA ipv6-parameters registry: http://www.iana.org/assignments/ipv6-parameters/ipv6-parameters.xml  Signed-off-by: Eldad Zack <eldad@fogrefinery.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | netfilter_bridge.h | s | 3.1K | 104 | Peter Huang (Peng) | peter.huangpeng@huawei.com | 1335240984 |  | set fake_rtable's dst to NULL to avoid kernel Oops  bridge: set fake_rtable's dst to NULL to avoid kernel Oops  when bridge is deleted before tap/vif device's delete, kernel may encounter an oops because of NULL reference to fake_rtable's dst. Set fake_rtable's dst to NULL before sending packets out can solve this problem.  v4 reformat, change br_drop_fake_rtable(skb) to {}  v3 enrich commit header  v2 introducing new flag DST_FAKE_RTABLE to dst_entry struct.  [ Use "do { } while (0)" for nop br_drop_fake_rtable()   implementation -DaveM ]  Acked-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Peter Huang <peter.huangpeng@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | latencytop.h | s | 1.0K | 39 | Peter Zijlstra | a.p.zijlstra@chello.nl | 1321528819 |  | sched: Make separate sched*.c translation units  Since once needs to do something at conferences and fixing compile warnings doesn't actually require much if any attention I decided to break up the sched.c #include "*.c" fest.  This further modularizes the scheduler code.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Link: http://lkml.kernel.org/n/tip-x0fcd3mnp8f9c99grcpewmhi@git.kernel.org Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | vme.h | s | 4.9K | 143 | Greg Kroah-Hartman | gregkh@linuxfoundation.org | 1335468898 |  | Staging: VME: move VME drivers out of staging  This moves the VME core, VME board drivers, and VME bridge drivers out of the drivers/staging/vme/ area to drivers/vme/.  The VME device drivers have not moved out yet due to some API questions they are still working through, that should happen soon, hopefully.  Cc: Martyn Welch <martyn.welch@ge.com> Cc: Manohar Vanga <manohar.vanga@cern.ch> Cc: Vincent Bossier <vincent.bossier@gmail.com> Cc: "Emilio G. Cota" <cota@braap.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | interrupt.h | s | 20K | 600 | Oleg Nesterov | oleg@redhat.com | 1337825472 |  | genirq: reimplement exit_irq_thread() hook via task_work_add()  exit_irq_thread() and task->irq_thread are needed to handle the unexpected (and unlikely) exit of irq-thread.  We can use task_work instead and make this all private to kernel/irq/manage.c, cleanup plus micro-optimization.  1. rename exit_irq_thread() to irq_thread_dtor(), make it    static, and move it up before irq_thread().  2. change irq_thread() to do task_work_add(irq_thread_dtor)    at the start and task_work_cancel() before return.     tracehook_notify_resume() can never play with kthreads,    only do_exit()->exit_task_work() can call the callback    and this is what we want.  3. remove task_struct->irq_thread and the special hook    in do_exit().  Signed-off-by: Oleg Nesterov <oleg@redhat.com> Reviewed-by: Thomas Gleixner <tglx@linutronix.de> Cc: David Howells <dhowells@redhat.com> Cc: Richard Kuo <rkuo@codeaurora.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Alexander Gordeev <agordeev@redhat.com> Cc: Chris Zankel <chris@zankel.net> Cc: David Smith <dsmith@redhat.com> Cc: "Frank Ch. Eigler" <fche@redhat.com> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Larry Woodman <lwoodman@redhat.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Tejun Heo <tj@kernel.org> Cc: Ingo Molnar <mingo@elte.hu> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
d | byteorder |  | 4 items |  | Sam Ravnborg | sam@ravnborg.org | 1281817611 |  | include: replace unifdef-y with header-y  unifdef-y and header-y has same semantic. So there is no need to have both.  Drop the unifdef-y variant and sort all lines again  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | hwmon-vid.h | s | 1.5K | 37 | Rudolf Marek | r.marek@sh.cvut.cz | 1136528186 |  | [PATCH] hwmon: add VRM/VID support for some VIA CPUs  This patch adds the VIA CENTAUR CPUs to detection table. Table was updated to treat future Intel x86 CPUs as VRD10. Stepping field was added, because some VIA CPUs have different VRM specs across stepping. I changed the vrm type to u8 because all drivers use u8 anyway.  Signed-off-by: Rudolf Marek <r.marek@sh.cvut.cz> Signed-off-by: Jean Delvare <khali@linux-fr.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | param.h | s | 78B | 4 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | leds-regulator.h | s | 1.3K | 41 | Antonio Ospite | ospite@studenti.unina.it | 1302685903 |  | include/linux/leds-regulator.h: fix syntax in example code  Fix struct field initializer syntax in some example code from a comment, this will make copying and pasting the code more straightforward.  Signed-off-by: Antonio Ospite <ospite@studenti.unina.it> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | vt.h | s | 3.6K | 89 | Amerigo Wang | amwang@redhat.com | 1311652635 |  | notifiers: vt: move vt notifiers into vt.h  It is not necessary to share the same notifier.h.  Signed-off-by: WANG Cong <amwang@redhat.com> Cc: David Miller <davem@davemloft.net> Cc: "Rafael J. Wysocki" <rjw@sisk.pl> Cc: Greg KH <greg@kroah.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bcd.h | s | 195B | 6 | Adrian Bunk | bunk@kernel.org | 1224517962 |  | include/linux/bcd.h: remove comments  - the macros are gone - there's no more code in this file,   LGPL + GPL = GPL,   and the code that was moved to lib/bcd.c is anyway trivial  Signed-off-by: Adrian Bunk <bunk@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pps.h | s | 4.1K | 108 | Alexander Gordeev | lasaine@lvk.cs.msu.su | 1294934601 |  | pps: add kernel consumer support  Add an optional feature of PPSAPI, kernel consumer support, which uses the added hardpps() function.  Signed-off-by: Alexander Gordeev <lasaine@lvk.cs.msu.su> Acked-by: Rodolfo Giometti <giometti@linux.it> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mii.h | s | 15K | 419 | Matt Carlson | mcarlson@broadcom.com | 1321907239 |  | net: Change mii to ethtool advertisement function names  This patch implements advice by Ben Hutchings to change the mii side of the function names to look more like the register whose values they convert.  New LPA translation functions have been added as well.  Signed-off-by: Matt Carlson <mcarlson@broadcom.com> Signed-off-by: Michael Chan <mchan@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | genetlink.h | s | 2.8K | 95 | Neil Horman | nhorman@tuxdriver.com | 1338345236 |  | genetlink: Build a generic netlink family module alias  Generic netlink searches for -type- formatted aliases when requesting a module to fulfill a protocol request (i.e. net-pf-16-proto-16-type-<x>, where x is a type value).  However generic netlink protocols have no well defined type numbers, they have string names.  Modify genl_ctrl_getfamily to request an alias in the format net-pf-16-proto-16-family-<x> instead, where x is a generic string, and add a macro that builds on the previously added MODULE_ALIAS_NET_PF_PROTO_NAME macro to allow modules to specifify those generic strings.  Note, l2tp previously hacked together an net-pf-16-proto-16-type-l2tp alias using the MODULE_ALIAS macro, with these updates we can convert that to use the PROTO_NAME macro.  Signed-off-by: Neil Horman <nhorman@tuxdriver.com> CC: Eric Dumazet <eric.dumazet@gmail.com> CC: James Chapman <jchapman@katalix.com> CC: David Miller <davem@davemloft.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | sungem_phy.h | s | 3.9K | 106 | David S. Miller | davem@davemloft.net | 1313479009 |  | net: Fix sungem_phy sharing.  Since sungem_phy is used by multiple, unrelated, drivers make it build as a real module under drivers/net.  depmod will pick up the symbol dependency and make sure sungem_phy.ko gets loaded any time sungem.ko or spider_net.ko is loaded.  Tested-by: Stephen Rothwell <sfr@canb.auug.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>
f | reiserfs_fs.h | s | 712B | 22 | Al Viro | viro@zeniv.linux.org.uk | 1332293383 |  | move private bits of reiserfs_fs.h to fs/reiserfs/reiserfs.h  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | crash_dump.h | s | 2.3K | 65 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | shmem_fs.h | s | 2.2K | 56 | Eric W. Biederman | ebiederm@xmission.com | 1337119169 |  | userns: Convert tmpfs to use kuid and kgid where appropriate  Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | dmi.h | s | 3.6K | 126 | Mike Waychison | mikew@google.com | 1298664034 |  | firmware: Add DMI entry types to the headers  In preparation for the upcoming commits, introduce the DMI entry types to the headers.  These type names are based on those specified in the DMTF SMBIOS specification version 2.7.1.  Signed-off-by: Mike Waychison <mikew@google.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | rtmutex.h | s | 3.0K | 93 | Dima Zavin | dima@android.com | 1310126573 |  | plist: Remove the need to supply locks to plist heads  This was legacy code brought over from the RT tree and is no longer necessary.  Signed-off-by: Dima Zavin <dima@android.com> Acked-by: Thomas Gleixner <tglx@linutronix.de> Cc: Daniel Walker <dwalker@codeaurora.org> Cc: Steven Rostedt <rostedt@goodmis.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Andi Kleen <andi@firstfloor.org> Cc: Lai Jiangshan <laijs@cn.fujitsu.com> Link: http://lkml.kernel.org/r/1310084879-10351-2-git-send-email-dima@android.com Signed-off-by: Ingo Molnar <mingo@elte.hu>
d | mtd |  | 36 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1338594942 |  | 
f | kvm.h | s | 26K | 851 | Christian Borntraeger | borntraeger@de.ibm.com | 1337299561 |  | KVM: s390: add capability indicating COW support  Currently qemu/kvm on s390 uses a guest mapping that does not allow the guest backing page table to be write-protected to support older systems. On those older systems a host write protection fault will be delivered to the guest.  Newer systems allow to write-protect the guest backing memory and let the fault be delivered to the host, thus allowing COW.  Use a capability bit to tell qemu if that is possible.  Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com> Acked-by: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
f | ptp_classify.h | s | 5.5K | 126 | Richard Cochran | richardcochran@gmail.com | 1317270723 |  | ptp: fix L2 event message recognition  The IEEE 1588 standard defines two kinds of messages, event and general messages. Event messages require time stamping, and general do not. When using UDP transport, two separate ports are used for the two message types.  The BPF designed to recognize event messages incorrectly classifies L2 general messages as event messages. This commit fixes the issue by extending the filter to check the message type field for L2 PTP packets. Event messages are be distinguished from general messages by testing the "general" bit.  Signed-off-by: Richard Cochran <richard.cochran@omicron.at> Cc: <stable@kernel.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | concap.h | s | 3.7K | 91 | Robert P. J. Day | rpjday@crashcourse.ca | 1209569394 |  | Remove "#ifdef __KERNEL__" checks from unexported headers  Remove the "#ifdef __KERNEL__" tests from unexported header files in linux/include whose entire contents are wrapped in that preprocessor test.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Cc: David Woodhouse <dwmw2@infradead.org> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | atm.h | s | 7.8K | 201 | David Woodhouse | David.Woodhouse@intel.com | 1228371158 |  | atm: 32-bit ioctl compatibility  We lack compat ioctl support through most of the ATM code. This patch deals with most of it, and I can now at least use BR2684 and PPPoATM with 32-bit userspace.  I haven't added a .compat_ioctl method to struct atm_ioctl, because AFAICT none of the current users need any conversion -- so we can just call the ->ioctl() method in every case. I looked at br2684, clip, lec, mpc, pppoatm and atmtcp.  In svc_compat_ioctl() the only mangling which is needed is to change COMPAT_ATM_ADDPARTY to ATM_ADDPARTY. Although it's defined as 	_IOW('a', ATMIOC_SPECIAL+4,struct atm_iobuf) it doesn't actually _take_ a struct atm_iobuf as an argument -- it takes a struct sockaddr_atmsvc, which _is_ the same between 32-bit and 64-bit code, so doesn't need conversion.  Almost all of vcc_ioctl() would have been identical, so I converted that into a core do_vcc_ioctl() function with an 'int compat' argument.  I've done the same with atm_dev_ioctl(), where there _are_ a few differences, but still it's relatively contained and there would otherwise have been a lot of duplication.  I haven't done any of the actual device-specific ioctls, although I've added a compat_ioctl method to struct atmdev_ops.  Signed-off-by: David Woodhouse <David.Woodhouse@intel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | dlmconstants.h | s | 4.9K | 151 | David Teigland | teigland@redhat.com | 1208794949 |  | dlm: common max length definitions  Add central definitions for max lockspace name length and max resource name length.  The lack of central definitions has resulted in scattered private definitions which we can now clean up, including an unused one in dlm_device.h.  Signed-off-by: David Teigland <teigland@redhat.com>
f | i2c-ocores.h | s | 653B | 18 | Richard R√∂jfors | richard.rojfors.ext@mocean-labs.com | 1244885968 |  | i2c-ocores: Can add I2C devices to the bus  There is sometimes a need for the ocores driver to add devices to the bus when installed.  i2c_register_board_info can not always be used, because the I2C devices  are not known at an early state, they could for instance be connected  on a I2C bus on a PCI device which has the Open Cores IP.  i2c_new_device can not be used in all cases either since the resulting bus nummer might be unknown.  The solution is the pass a list of I2C devices in the platform data to the Open Cores driver. This is useful for MFD drivers.  Signed-off-by: Richard R√∂jfors <richard.rojfors.ext@mocean-labs.com> Signed-off-by: Ben Dooks <ben-linux@fluff.org>
f | i2c-mux-gpio.h | s | 1.1K | 34 | Jean Delvare | khali@linux-fr.org | 1336825698 |  | i2c: Rename last mux driver to standard pattern  Update the MAINTAINERS entry and all other references accordingly.  Based on an original patch by Wolfram Sang.  Signed-off-by: Jean Delvare <khali@linux-fr.org> Acked-by: Peter Korsgaard <peter.korsgaard@barco.com>  [wsa: fixed merge conflict due to rework in i2c_add_mux_adapter()]  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | coda_psdev.h | s | 3.3K | 83 | Yoshihisa Abe | yoshiabe@cs.cmu.edu | 1288018960 |  | Coda: replace BKL with mutex  Replace the BKL with a mutex to protect the venus_comm structure which binds the mountpoint with the character device and holds the upcall queues.  Signed-off-by: Yoshihisa Abe <yoshiabe@cs.cmu.edu> Signed-off-by: Jan Harkes <jaharkes@cs.cmu.edu> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_arcnet.h | s | 3.6K | 111 | Eric Dumazet | eric.dumazet@gmail.com | 1257357058 |  | net: cleanup include/linux  This cleanup patch puts struct/union/enum opening braces, in first line to ease grep games.  struct something {  becomes :  struct something {  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mmdebug.h | s | 315B | 13 | Konstantin Khlebnikov | khlebnikov@openvz.org | 1338333740 |  | bug: completely remove code generated by disabled VM_BUG_ON()  Even if CONFIG_DEBUG_VM=n gcc genereates code for some VM_BUG_ON()  for example VM_BUG_ON(!PageCompound(page) |||| !PageHead(page)); in do_huge_pmd_wp_page() generates 114 bytes of code.  But they mostly disappears when I split this VM_BUG_ON into two:    -VM_BUG_ON(!PageCompound(page) |||| !PageHead(page));   +VM_BUG_ON(!PageCompound(page));   +VM_BUG_ON(!PageHead(page));  weird... but anyway after this patch code disappears completely.    add/remove: 0/0 grow/shrink: 7/97 up/down: 135/-1784 (-1649)  Signed-off-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: "H. Peter Anvin" <hpa@zytor.com> Cc: Cong Wang <xiyou.wangcong@gmail.com> Cc: Hugh Dickins <hughd@google.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | cycx_x25.h | s | 3.6K | 118 | Paulius Zaleckas | pauliusz@yahoo.com | 1202046173 |  | Spelling fixes: lenght->length  Signed-off-by: Paulius Zaleckas <pauliusz@yahoo.com> Signed-off-by: Adrian Bunk <bunk@kernel.org>
f | gpio.h | s | 4.6K | 187 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1337381315 |  | gpiolib: Implement devm_gpio_request_one()  Allow drivers to use the modern request and configure idiom together with devres.  As with plain gpio_request() and gpio_request_one() we can't implement the old school version in terms of _one() as this would force the explicit selection of a direction in gpio_request() which could break systems if we pick the wrong one.  Implementing devm_gpio_request_one() in terms of devm_gpio_request() would needlessly complicate things or lead to duplication from the unmanaged version depending on how it's done.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Grant Likely <grant.likely@secretlab.ca>
f | jffs2.h | s | 6.9K | 193 | Linus Torvalds | torvalds@linux-foundation.org | 1281466161 |  | Merge git://git.infradead.org/mtd-2.6  * git://git.infradead.org/mtd-2.6: (79 commits)   mtd: Remove obsolete <mtd/compatmac.h> include   mtd: Update copyright notices   jffs2: Update copyright notices   mtd-physmap: add support users can assign the probe type in board files   mtd: remove redwood map driver   mxc_nand: Add v3 (i.MX51) Support   mxc_nand: support 8bit ecc   mxc_nand: fix correct_data function   mxc_nand: add V1_V2 namespace to registers   mxc_nand: factor out a check_int function   mxc_nand: make some internally used functions overwriteable   mxc_nand: rework get_dev_status   mxc_nand: remove 0xe00 offset from registers   mtd: denali: Add multi connected NAND support   mtd: denali: Remove set_ecc_config function   mtd: denali: Remove unuseful code in get_xx_nand_para functions   mtd: denali: Remove device_info_tag structure   mtd: m25p80: add support for the Winbond W25Q32 SPI flash chip   mtd: m25p80: add support for the Intel/Numonyx {16,32,64}0S33B SPI flash chips   mtd: m25p80: add support for the EON EN25P{32, 64} SPI flash chips   ...  Fix up trivial conflicts in drivers/mtd/maps/{Kconfig,redwood.c} due to redwood driver removal.
f | ioprio.h | s | 2.0K | 66 | Tejun Heo | tj@kernel.org | 1332244067 |  | cfq: don't use icq_get_changed()  cfq caches the associated cfqq's for a given cic.  The cache needs to be flushed if the cic's ioprio or blkcg has changed.  It is currently done by requiring the changing action to set the respective ICQ_*_CHANGED bit in the icq and testing it from cfq_set_request(), which involves iterating through all the affected icqs.  All cfq wants to know is whether ioprio and/or blkcg have changed since the last flush and can be easily achieved by just remembering the current ioprio and blkcg ID in cic.  This patch adds cic->{ioprio||blkcg_id}, updates all ioprio users to use the remembered value instead, and updates cfq_set_request() path such that, instead of using icq_get_changed(), the current values are compared against the remembered ones and trigger appropriate flush action if not.  Condition tests are moved inside both _changed functions which are now named check_ioprio_changed() and check_blkcg_changed().  ioprio.h::task_ioprio*() can't be used anymore and replaced with open-coded IOPRIO_CLASS_NONE case in cfq_async_queue_prio().  Signed-off-by: Tejun Heo <tj@kernel.org> Cc: Vivek Goyal <vgoyal@redhat.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | efs_fs_sb.h | s | 2.1K | 53 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233339427 |  | headers_check fix: linux/efs_fs_sb.h  fix the following 'make headers_check' warning:    usr/include/linux/efs_fs_sb.h:49: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | pti.h | s | 1.5K | 38 | J Freyensee | james_p_freyensee@linux.intel.com | 1309559978 |  | PTI feature to allow user to name and mark masterchannel request.  This feature addition provides a new parameter in pti_request_masterchannel() to allow the user to provide their own name to mark the request when the trace is viewed in a PTI SW trace viewer (like MPTA).  If a name is not provided and NULL is provided, the 'current' process name is used. API function header documentation documents this.  Signed-off-by: Jeremy Rocher <rocher.jeremy@gmail.com> Signed-off-by: J Freyensee <james_p_freyensee@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | fsnotify.h | s | 8.3K | 283 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | scatterlist.h | s | 7.7K | 239 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | zutil.h | s | 2.7K | 82 | Richard Purdie | rpurdie@rpsys.net | 1151013958 |  | [PATCH] zlib_inflate: Upgrade library code to a recent version  Upgrade the zlib_inflate implementation in the kernel from a patched version 1.1.3/4 to a patched 1.2.3.  The code in the kernel is about seven years old and I noticed that the external zlib library's inflate performance was significantly faster (~50%) than the code in the kernel on ARM (and faster again on x86_32).  For comparison the newer deflate code is 20% slower on ARM and 50% slower on x86_32 but gives an approx 1% compression ratio improvement.  I don't consider this to be an improvement for kernel use so have no plans to change the zlib_deflate code.  Various changes have been made to the zlib code in the kernel, the most significant being the extra functions/flush option used by ppp_deflate. This update reimplements the features PPP needs to ensure it continues to work.  This code has been tested on ARM under both JFFS2 (with zlib compression enabled) and ppp_deflate and on x86_32.  JFFS2 sees an approx.  10% real world file read speed improvement.  This patch also removes ZLIB_VERSION as it no longer has a correct value. We don't need version checks anyway as the kernel's module handling will take care of that for us.  This removal is also more in keeping with the zlib author's wishes (http://www.zlib.net/zlib_faq.html#faq24) and I've added something to the zlib.h header to note its a modified version.  Signed-off-by: Richard Purdie <rpurdie@rpsys.net> Acked-by: Joern Engel <joern@wh.fh-wedel.de> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | gfp.h | s | 14K | 349 | Michal Nazarewicz | mina86@mina86.com | 1337605773 |  | mm: page_isolation: MIGRATE_CMA isolation functions added  This commit changes various functions that change pages and pageblocks migrate type between MIGRATE_ISOLATE and MIGRATE_MOVABLE in such a way as to allow to work with MIGRATE_CMA migrate type.  Signed-off-by: Michal Nazarewicz <mina86@mina86.com> Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com> Reviewed-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Tested-by: Rob Clark <rob.clark@linaro.org> Tested-by: Ohad Ben-Cohen <ohad@wizery.com> Tested-by: Benjamin Gaignard <benjamin.gaignard@linaro.org> Tested-by: Robert Nelson <robertcnelson@gmail.com> Tested-by: Barry Song <Baohua.Song@csr.com>
f | nfs.h | s | 5.2K | 159 | Stanislav Kinsbursky | skinsbursky@parallels.com | 1328052025 |  | SUNRPC: handle RPC client pipefs dentries by network namespace aware routines  v2: 1) "Over-put" of PipeFS mount point fixed. Fix is ugly, but allows to bisect the patch set. And it will be removed later in the series.  This patch makes RPC clients PipeFs dentries allocations in it's owner network namespace context. RPC client pipefs dentries creation logic has been changed: 1) Pipefs dentries creation by sb was moved to separated function, which will be used for handling PipeFS mount notification. 2) Initial value of RPC client PipeFS dir dentry is set no NULL now.  RPC client pipefs dentries cleanup logic has been changed: 1) Cleanup is done now in separated rpc_remove_pipedir() function, which takes care about pipefs superblock locking.  Also this patch removes slashes from cb_program.pipe_dir_name and from NFS_PIPE_DIRNAME to make rpc_d_lookup_sb() work. This doesn't affect vfs_path_lookup() results in nfs4blocklayout_init() since this slash is cutted off anyway in link_path_walk().  Signed-off-by: Stanislav Kinsbursky <skinsbursky@parallels.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | range.h | s | 612B | 21 | Yinghai Lu | yinghai@kernel.org | 1265852837 |  | x86/pci: Add cap_resource()  Prepare for 32bit pci root bus  -v2: hpa said we should compare with (resource_size_t)~0 -v3: according to Linus to use MAX_RESOURCE instead.      also need need to put related patches together -v4: according to Andrew, use min in cap_resource()  Signed-off-by: Yinghai Lu <yinghai@kernel.org> LKML-Reference: <1265793639-15071-8-git-send-email-yinghai@kernel.org> Acked-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | ipv6_route.h | s | 1.7K | 50 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233340152 |  | headers_check fix: linux/ipv6_route.h  fix the following 'make headers_check' warning:    usr/include/linux/ipv6_route.h:42: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | time.h | s | 9.0K | 270 | Richard Cochran | richardcochran@gmail.com | 1337642218 |  | time: remove obsolete declaration  The function, timekeeping_leap_insert, was removed in commit 6b43ae8a619d17c4935c3320d2ef9e92bdeed05d  Signed-off-by: Richard Cochran <richardcochran@gmail.com> Signed-off-by: John Stultz <john.stultz@linaro.org>
f | nfs_mount.h | s | 2.3K | 69 | Suresh Jayaraman | sjayaraman@suse.de | 1285246558 |  | nfs: introduce mount option '-olocal_lock' to make locks local  NFS clients since 2.6.12 support flock locks by emulating fcntl byte-range locks. Due to this, some windows applications which seem to use both flock (share mode lock mapped as flock by Samba) and fcntl locks sequentially on the same file, can't lock as they falsely assume the file is already locked. The problem was reported on a setup with windows clients accessing excel files on a Samba exported share which is originally a NFS mount from a NetApp filer.  Older NFS clients (< 2.6.12) did not see this problem as flock locks were considered local. To support legacy flock behavior, this patch adds a mount option "-olocal_lock=" which can take the following values:     'none'  		- Neither flock locks nor POSIX locks are local    'flock' 		- flock locks are local    'posix' 		- fcntl/POSIX locks are local    'all'		- Both flock locks and POSIX locks are local  Testing:     - This patch was tested by using -olocal_lock option with different values      and the NLM calls were noted from the network packet captured.       'none'  - NLM calls were seen during both flock() and fcntl(), flock lock    	       was granted, fcntl was denied      'flock' - no NLM calls for flock(), NLM call was seen for fcntl(),    	       granted      'posix' - NLM call was seen for flock() - granted, no NLM call for fcntl()      'all'   - no NLM calls were seen during both flock() and fcntl()     - No bugs were seen during NFSv4 locking/unlocking in general and NFSv4      reboot recovery.  Cc: Neil Brown <neilb@suse.de> Signed-off-by: Suresh Jayaraman <sjayaraman@suse.de> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | fddidevice.h | s | 1.1K | 31 | Stephen Hemminger | shemminger@vyatta.com | 1227241788 |  | fddi: convert to new network device ops  Similar to ethernet. Convert infrastructure and the one lone FDDI driver (for the one lone user of that hardware??). Compile tested only.  Signed-off-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | string_helpers.h | s | 380B | 12 | James Bottomley | James.Bottomley@HansenPartnership.com | 1223052374 |  | [SCSI] lib: add generic helper to print sizes rounded to the correct SI range  This patch adds the ability to print sizes in either units of 10^3 (SI) or 2^10 (Binary) units.  It rounds up to three significant figures and can be used for either memory or storage capacities.  Oh, and I'm fully aware that 64 bits is only 16EiB ... the Zetta and Yotta units are added for future proofing against the day we have 128 bit computers ...  [fujita.tomonori@lab.ntt.co.jp: fix missed unsigned long long cast] Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>
f | fb.h | s | 43K | 1042 | Linus Torvalds | torvalds@linux-foundation.org | 1338595071 |  | 
f | resume-trace.h | s | 700B | 24 | James Hogan | james@albanarts.com | 1287273470 |  | PM: Add sysfs attr for rechecking dev hash from PM trace  If the device which fails to resume is part of a loadable kernel module it won't be checked at startup against the magic number stored in the RTC.  Add a read-only sysfs attribute /sys/power/pm_trace_dev_match which contains a list of newline separated devices (usually just the one) which currently match the last magic number. This allows the device which is failing to resume to be found after the modules are loaded again.  Signed-off-by: James Hogan <james@albanarts.com> Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | auto_dev-ioctl.h | s | 5.1K | 178 | Ian Kent | raven@themaw.net | 1238601563 |  | autofs4: fix kernel includes  autofs_dev-ioctl.h is included by both the kernel module and user space tools and it includes two kernel header files.  Compiles work if the kernel headers are installed but fail otherwise.  Signed-off-by: Ian Kent <raven@themaw.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dirent.h | s | 177B | 10 | Adrian Bunk | bunk@kernel.org | 1217008414 |  | remove the in-kernel struct dirent{,64}  The kernel struct dirent{,64} were different from the ones in userspace.  Even worse, we exported the kernel ones to userspace.  But after the fat usages are fixed we can remove the conflicting kernel versions.  Reviewed-by: H. Peter Anvin <hpa@kernel.org> Signed-off-by: Adrian Bunk <bunk@kernel.org> Cc: OGAWA Hirofumi <hirofumi@mail.parknet.co.jp> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | nl80211.h | s | 115K | 2649 | Johannes Berg | johannes.berg@intel.com | 1337188095 |  | nl80211: prevent additions to old station flags API  We don't really want/need to maintain the old station flags API any more, so refuse changes to new (not yet defined) flags from the old flags API.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | opp.h | s | 2.8K | 98 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | swab.h | s | 6.6K | 271 | Harvey Harrison | harvey.harrison@gmail.com | 1231991810 |  | byteorder: make swab.h include asm/swab.h like a regular header  Add swab.h to kbuild.asm and remove the individual entries from each arch, mark as unifdef as some arches have some kernel-only bits inside.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sony-laptop.h | s | 1.2K | 27 | malattia@linux.it | malattia@linux.it | 1177812361 |  | sony-laptop: add a meye-usable include file for camera ops  Copy and rename (for easier co-existence) the MEYE-wise exported interface.  Signed-off-by: Mattia Dongili <malattia@linux.it> Signed-off-by: Len Brown <len.brown@intel.com>
f | nfs_page.h | s | 3.8K | 126 | Trond Myklebust | Trond.Myklebust@netapp.com | 1336591063 |  | NFS: Clean up - Rename nfs_unlock_request and nfs_unlock_request_dont_release  Function rename to ensure that the functionality of nfs_unlock_request() mirrors that of nfs_lock_request(). Then let nfs_unlock_and_release_request() do the work of what used to be called nfs_unlock_request()...  Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com> Cc: Fred Isaman <iisaman@netapp.com>
d | netfilter_ipv6 |  | 12 items |  | Hans Schillstrom | hans.schillstrom@ericsson.com | 1336560827 |  | netfilter: ip6_tables: add flags parameter to ipv6_find_hdr()  This patch adds the flags parameter to ipv6_find_hdr. This flags allows us to:  * know if this is a fragment. * stop at the AH header, so the information contained in that header   can be used for some specific packet handling.  This patch also adds the offset parameter for inspection of one inner IPv6 header that is contained in error messages.  Signed-off-by: Hans Schillstrom <hans.schillstrom@ericsson.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
f | pim.h | s | 518B | 21 | Harvey Harrison | harvey.harrison@gmail.com | 1234681115 |  | net: replace __constant_{endian} uses in net headers  Base versions handle constant folding now.  For headers exposed to userspace, we must only expose the __ prefixed versions.  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ppdev.h | s | 3.1K | 74 | Uwe Zeisberger | Uwe_Zeisberger@digi.com | 1159909286 |  | fix file specification in comments  Many files include the filename at the beginning, serveral used a wrong one.  Signed-off-by: Uwe Zeisberger <Uwe_Zeisberger@digi.com> Signed-off-by: Adrian Bunk <bunk@stusta.de>
f | mISDNif.h | s | 14K | 526 | Karsten Keil | kkeil@linux-pingi.de | 1337196226 |  | mISDN: Allow to set a minimum length for transparent data  If the FIFO of the card is small, many short messages are queued up to the upper layers and the userspace. This change allows the applications to set a minimum datalen they want from the drivers. Create a common control function to avoid code duplication in each driver.  Signed-off-by: Karsten Keil <kkeil@linux-pingi.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | fcntl.h | s | 2.6K | 65 | Al Viro | viro@zeniv.linux.org.uk | 1300144340 |  | New AT_... flag: AT_EMPTY_PATH  For name_to_handle_at(2) we'll want both ...at()-style syscall that would be usable for non-directory descriptors (with empty relative pathname).  Introduce new flag (AT_EMPTY_PATH) to deal with that and corresponding LOOKUP_EMPTY; teach user_path_at() and path_init() to deal with the latter.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | atmbr2684.h | s | 3.1K | 101 | Jaswinder Singh Rajput | jaswinderrajput@gmail.com | 1233338948 |  | headers_check fix: linux/atmbr2684.h  fix the following 'make headers_check' warning:    usr/include/linux/atmbr2684.h:88: found __[us]{8,16,32,64} type without #include <linux/types.h>  Signed-off-by: Jaswinder Singh Rajput <jaswinderrajput@gmail.com>
f | sort.h | s | 208B | 7 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | uidgid.h | s | 4.2K | 155 | Eric W. Biederman | ebiederm@xmission.com | 1335430899 |  | userns: Rework the user_namespace adding uid/gid mapping support  - Convert the old uid mapping functions into compatibility wrappers - Add a uid/gid mapping layer from user space uid and gids to kernel   internal uids and gids that is extent based for simplicty and speed.   * Working with number space after mapping uids/gids into their kernel     internal version adds only mapping complexity over what we have today,     leaving the kernel code easy to understand and test. - Add proc files /proc/self/uid_map /proc/self/gid_map   These files display the mapping and allow a mapping to be added   if a mapping does not exist. - Allow entering the user namespace without a uid or gid mapping.   Since we are starting with an existing user our uids and gids   still have global mappings so are still valid and useful they just don't   have local mappings.  The requirement for things to work are global uid   and gid so it is odd but perfectly fine not to have a local uid   and gid mapping.   Not requiring global uid and gid mappings greatly simplifies   the logic of setting up the uid and gid mappings by allowing   the mappings to be set after the namespace is created which makes the   slight weirdness worth it. - Make the mappings in the initial user namespace to the global   uid/gid space explicit.  Today it is an identity mapping   but in the future we may want to twist this for debugging, similar   to what we do with jiffies. - Document the memory ordering requirements of setting the uid and   gid mappings.  We only allow the mappings to be set once   and there are no pointers involved so the requirments are   trivial but a little atypical.  Performance:  In this scheme for the permission checks the performance is expected to stay the same as the actuall machine instructions should remain the same.  The worst case I could think of is ls -l on a large directory where all of the stat results need to be translated with from kuids and kgids to uids and gids.  So I benchmarked that case on my laptop with a dual core hyperthread Intel i5-2520M cpu with 3M of cpu cache.  My benchmark consisted of going to single user mode where nothing else was running. On an ext4 filesystem opening 1,000,000 files and looping through all of the files 1000 times and calling fstat on the individuals files.  This was to ensure I was benchmarking stat times where the inodes were in the kernels cache, but the inode values were not in the processors cache.  My results:  v3.4-rc1:         ~= 156ns (unmodified v3.4-rc1 with user namespace support disabled) v3.4-rc1-userns-: ~= 155ns (v3.4-rc1 with my user namespace patches and user namespace support disabled) v3.4-rc1-userns+: ~= 164ns (v3.4-rc1 with my user namespace patches and user namespace support enabled)  All of the configurations ran in roughly 120ns when I performed tests that ran in the cpu cache.  So in summary the performance impact is: 1ns improvement in the worst case with user namespace support compiled out. 8ns aka 5% slowdown in the worst case with user namespace support compiled in.  Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | irq.h | s | 22K | 641 | Randy Dunlap | rdunlap@xenotime.net | 1341097000 |  | linux/irq.h: fix kernel-doc warning  Fix kernel-doc warning.  This struct member was removed in commit 875682648b89 ("irq: Remove irq_chip->release()") so remove its associated kernel-doc entry also.    Warning(include/linux/irq.h:338): Excess struct/union/enum/typedef member 'release' description in 'irq_chip'  Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Cc: Richard Weinberger <richard@nod.at> Cc: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | file.h | s | 1.1K | 33 | Al Viro | viro@zeniv.linux.org.uk | 1332293372 |  | vfs: drop_file_write_access() made static  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | firmware.h | s | 1.7K | 55 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103952 |  | include: replace linux/module.h with "struct module" wherever possible  The <linux/module.h> pretty much brings in the kitchen sink along with it, so it should be avoided wherever reasonably possible in terms of being included from other commonly used <linux/something.h> files, as it results in a measureable increase on compile times.  The worst culprit was probably device.h since it is used everywhere. This file also had an implicit dependency/usage of mutex.h which was masked by module.h, and is also fixed here at the same time.  There are over a dozen other headers that simply declare the struct instead of pulling in the whole file, so follow their lead and simply make it a few more.  Most of the implicit dependencies on module.h being present by these headers pulling it in have been now weeded out, so we can finally make this change with hopefully minimal breakage.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | nfs_idmap.h | s | 3.2K | 86 | Bryan Schumaker | bjschuma@netapp.com | 1330979207 |  | NFS: Undo changes to idmap.h  When compiled without NFS v4 configured these function won't be defined and the compiler will yell.  Signed-off-by: Bryan Schumaker <bjschuma@netapp.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | bsg.h | s | 3.0K | 79 | Linus Torvalds | torvalds@linux-foundation.org | 1238272243 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-misc-2.6  * git://git.kernel.org/pub/scm/linux/kernel/git/jejb/scsi-misc-2.6: (119 commits)   [SCSI] scsi_dh_rdac: Retry for NOT_READY check condition   [SCSI] mpt2sas: make global symbols unique   [SCSI] sd: Make revalidate less chatty   [SCSI] sd: Try READ CAPACITY 16 first for SBC-2 devices   [SCSI] sd: Refactor sd_read_capacity()   [SCSI] mpt2sas v00.100.11.15   [SCSI] mpt2sas: add MPT2SAS_MINOR(221) to miscdevice.h   [SCSI] ch: Add scsi type modalias   [SCSI] 3w-9xxx: add power management support   [SCSI] bsg: add linux/types.h include to bsg.h   [SCSI] cxgb3i: fix function descriptions   [SCSI] libiscsi: fix possbile null ptr session command cleanup   [SCSI] iscsi class: remove host no argument from session creation callout   [SCSI] libiscsi: pass session failure a session struct   [SCSI] iscsi lib: remove qdepth param from iscsi host allocation   [SCSI] iscsi lib: have lib create work queue for transmitting IO   [SCSI] iscsi class: fix lock dep warning on logout   [SCSI] libiscsi: don't cap queue depth in iscsi modules   [SCSI] iscsi_tcp: replace scsi_debug/tcp_debug logging with iscsi conn logging   [SCSI] libiscsi_tcp: replace tcp_debug/scsi_debug logging with session/conn logging   ...
f | nfs_fs_i.h | s | 269B | 16 | Trond Myklebust | Trond.Myklebust@netapp.com | 1328052028 |  | NFS: Remove unnecessary includes from linux/nfs_fs_i.h  Also from linux/nfs_xdr.h.  Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | license.h | s | 374B | 12 | Sam Ravnborg | sam@mars.ravnborg.org | 1149882835 |  | kbuild: check license compatibility when building modules  Modules that uses GPL symbols can no longer be build with kbuild, the build will fail during the modpost step. When a GPL-incompatible module uses a EXPORT_SYMBOL_GPL_FUTURE symbol then warn during modpost so author are actually notified.  The actual license compatibility check is shared with the kernel to make sure it is in sync.  Patch originally from: Andreas Gruenbacher <agruen@suse.de> and Ram Pai <linuxram@us.ibm.com>  Signed-off-by: Sam Ravnborg <sam@ravnborg.org>
f | thread_info.h | s | 4.0K | 130 | Al Viro | viro@zeniv.linux.org.uk | 1338569930 |  | set_restore_sigmask() is never called without SIGPENDING (and never should be)  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | ethtool.h | s | 47K | 1183 | Manish chopra | manish.chopra@qlogic.com | 1337102013 |  | linux/ethtool: Added macro ETH_FW_DUMP_DISABLE  o flag field of ethtool_dump structure must be initialized by this macro value that is zero, if the firmware dump is disabled. by this we can get the firmware dump capability [enable/disable] via ethtool  Signed-off-by: Manish chopra <manish.chopra@qlogic.com> Reviewed-by: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | phy_fixed.h | s | 684B | 27 | Vitaly Bordug | vitb@kernel.crashing.org | 1201138438 |  | phy/fixed.c: rework to not duplicate PHY layer functionality  With that patch fixed.c now fully emulates MDIO bus, thus no need to duplicate PHY layer functionality. That, in turn, drastically simplifies the code, and drops down line count.  As an additional bonus, now there is no need to register MDIO bus for each PHY, all emulated PHYs placed on the platform fixed MDIO bus. There is also no more need to pre-allocate PHYs via .config option, this is all now handled dynamically.  Signed-off-by: Anton Vorontsov <avorontsov@ru.mvista.com> Signed-off-by: Vitaly Bordug <vitb@kernel.crashing.org> Acked-by: Jeff Garzik <jeff@garzik.org> Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
f | dma-contiguous.h | s | 3.1K | 92 | Marek Szyprowski | m.szyprowski@samsung.com | 1337605777 |  | drivers: add Contiguous Memory Allocator  The Contiguous Memory Allocator is a set of helper functions for DMA mapping framework that improves allocations of contiguous memory chunks.  CMA grabs memory on system boot, marks it with MIGRATE_CMA migrate type and gives back to the system. Kernel is allowed to allocate only movable pages within CMA's managed memory so that it can be used for example for page cache when DMA mapping do not use it. On dma_alloc_from_contiguous() request such pages are migrated out of CMA area to free required contiguous block and fulfill the request. This allows to allocate large contiguous chunks of memory at any time assuming that there is enough free memory available in the system.  This code is heavily based on earlier works by Michal Nazarewicz.  Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Signed-off-by: Michal Nazarewicz <mina86@mina86.com> Acked-by: Arnd Bergmann <arnd@arndb.de> Tested-by: Rob Clark <rob.clark@linaro.org> Tested-by: Ohad Ben-Cohen <ohad@wizery.com> Tested-by: Benjamin Gaignard <benjamin.gaignard@linaro.org> Tested-by: Robert Nelson <robertcnelson@gmail.com> Tested-by: Barry Song <Baohua.Song@csr.com>
f | timex.h | s | 9.9K | 233 | John Stultz | john.stultz@linaro.org | 1332470623 |  | ntp: Fix leap-second hrtimer livelock  Since commit 7dffa3c673fbcf835cd7be80bb4aec8ad3f51168 the ntp subsystem has used an hrtimer for triggering the leapsecond adjustment. However, this can cause a potential livelock.  Thomas diagnosed this as the following pattern: CPU 0                                                    CPU 1 do_adjtimex()   spin_lock_irq(&ntp_lock);     process_adjtimex_modes();				 timer_interrupt()       process_adj_status();                                do_timer()         ntp_start_leap_timer();                             write_lock(&xtime_lock);           hrtimer_start();                                  update_wall_time();              hrtimer_reprogram();                            ntp_tick_length()                tick_program_event()                            spin_lock(&ntp_lock);                  clockevents_program_event() 		   ktime_get()                      seq = req_seqbegin(xtime_lock);  This patch tries to avoid the problem by reverting back to not using an hrtimer to inject leapseconds, and instead we handle the leapsecond processing in the second_overflow() function.  The downside to this change is that on systems that support highres timers, the leap second processing will occur on a HZ tick boundary, (ie: ~1-10ms, depending on HZ)  after the leap second instead of possibly sooner (~34us in my tests w/ x86_64 lapic).  This patch applies on top of tip/timers/core.  CC: Sasha Levin <levinsasha928@gmail.com> CC: Thomas Gleixner <tglx@linutronix.de> Reported-by: Sasha Levin <levinsasha928@gmail.com> Diagnoised-by: Thomas Gleixner <tglx@linutronix.de> Tested-by: Sasha Levin <levinsasha928@gmail.com> Signed-off-by: John Stultz <john.stultz@linaro.org>
f | pwm_backlight.h | s | 598B | 19 | Dilan Lee | dilee@nvidia.com | 1314314734 |  | backlight: add a callback 'notify_after' for backlight control  We need a callback to do some things after pwm_enable, pwm_disable and pwm_config.  Signed-off-by: Dilan Lee <dilee@nvidia.com> Reviewed-by: Robert Morell <rmorell@nvidia.com> Reviewed-by: Arun Murthy <arun.murthy@stericsson.com> Cc: Richard Purdie <rpurdie@rpsys.net> Cc: Paul Mundt <lethal@linux-sh.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | if_phonet.h | s | 406B | 16 | Remi Denis-Courmont | remi.denis-courmont@nokia.com | 1222849819 |  | phonet: Protect if_phonet.h against multiple inclusions.  From: Remi Denis-Courmont <remi.denis-courmont@nokia.com>  Signed-off-by: David S. Miller <davem@davemloft.net>
f | ks0108.h | s | 1.6K | 40 | Miguel Ojeda | miguel.ojeda.sandonis@gmail.com | 1215193205 |  | Miguel Ojeda has moved  Signed-off-by: Miguel Ojeda <miguel.ojeda.sandonis@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | socket.h | s | 11K | 298 | Eric Dumazet | eric.dumazet@gmail.com | 1334508280 |  | net: cleanup unsigned to unsigned int  Use of "unsigned int" is preferred to bare "unsigned" in net tree.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
d | isdn |  | 5 items |  | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
f | tifm.h | s | 4.8K | 139 | Alex Dubov | oakad@yahoo.com | 1205197278 |  | tifm: fix the MemoryStick host fifo handling code  Additional input received from JMicron on MemoryStick host interfaces showed that some assumtions in fifo handling code were incorrect.  This patch also fixes data corruption used to occure during PIO transfers.  Signed-off-by: Alex Dubov <oakad@yahoo.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | stringify.h | s | 341B | 9 | Zhaolei | zhaolei@cn.fujitsu.com | 1239371332 |  | Make __stringify support variable argument macros too  For example:    __stringify(__entry->irq, __entry->ret)  will now convert it to:    "REC->irq, REC->ret"  It also still supports single arguments as the old macro did.  Signed-off-by: Zhao Lei <zhaolei@cn.fujitsu.com> Acked-by: Frederic Weisbecker <fweisbec@gmail.com> Cc: Steven Rostedt <rostedt@goodmis.org> LKML-Reference: <49DC6751.30308@cn.fujitsu.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | mm_inline.h | s | 2.7K | 92 | Hugh Dickins | hughd@google.com | 1338333748 |  | mm/memcg: apply add/del_page to lruvec  Take lruvec further: pass it instead of zone to add_page_to_lru_list() and del_page_from_lru_list(); and pagevec_lru_move_fn() pass lruvec down to its target functions.  This cleanup eliminates a swathe of cruft in memcontrol.c, including mem_cgroup_lru_add_list(), mem_cgroup_lru_del_list() and mem_cgroup_lru_move_lists() - which never actually touched the lists.  In their place, mem_cgroup_page_lruvec() to decide the lruvec, previously a side-effect of add, and mem_cgroup_update_lru_size() to maintain the lru_size stats.  Whilst these are simplifications in their own right, the goal is to bring the evaluation of lruvec next to the spin_locking of the lrus, in preparation for a future patch.  Signed-off-by: Hugh Dickins <hughd@google.com> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Acked-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Acked-by: Michal Hocko <mhocko@suse.cz> Acked-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Cc: Johannes Weiner <hannes@cmpxchg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | ppp-comp.h | s | 5.1K | 143 | Paul Mackerras | paulus@samba.org | 1330911698 |  | ppp: Change copyright notices from ANU to me  This changes the copyright notices on the PPP code that I developed in the late 1990s from being copyright The Australian National University to copyright Paul Mackerras.  I can do this as I have an acknowledgement in writing from the Head of the Computer Science Department at ANU (where I worked then) that ANU does not claim any intellectual property in this code.  While I'm at it, change the copyright notice from BSD-style to GNU GPL like the rest of the kernel.  Signed-off-by: Paul Mackerras <paulus@samba.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | sm501-regs.h | s | 11K | 319 | Vincent Sanders | vince@simtec.co.uk | 1260976804 |  | sm501: implement acceleration features  This patch provides the acceleration entry points for the SM501 framebuffer driver.  This patch provides the sync, copyarea and fillrect entry points, using the SM501's 2D acceleration engine to perform the operations in-chip rather than across the bus.  Signed-off-by: Ben Dooks <ben@simtec.co.uk> Signed-off-by: Simtec Linux Team <linux@simtec.co.uk> Signed-off-by: Vincent Sanders <vince@simtec.co.uk> Cc: Krzysztof Helt <krzysztof.h1@poczta.fm> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | export.h | s | 2.4K | 74 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320067211 |  | module.h: split out the EXPORT_SYMBOL into export.h  A lot of files pull in module.h when all they are really looking for is the basic EXPORT_SYMBOL functionality. The recent data from Ingo[1] shows that this is one of several instances that has a significant impact on compile times, and it should be targeted for factoring out (as done here).  Note that several commonly used header files in include/* directly include <linux/module.h> themselves (some 34 of them!) The most commonly used ones of these will have to be made independent of module.h before the full benefit of this change can be realized.  We also transition THIS_MODULE from module.h to export.h, since there are lots of files with subsystem structs that in turn will have a struct module *owner and only be doing:  	.owner = THIS_MODULE;  and absolutely nothing else modular. So, we also want to have the THIS_MODULE definition present in the lightweight header.  [1] https://lkml.org/lkml/2011/5/23/76  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | crypto.h | s | 32K | 1051 | Linus Torvalds | torvalds@linux-foundation.org | 1332608919 |  | 
f | ipmi_smi.h | s | 8.7K | 211 | Paul Gortmaker | paul.gortmaker@windriver.com | 1331908704 |  | device.h: audit and cleanup users in main include dir  The <linux/device.h> header includes a lot of stuff, and it in turn gets a lot of use just for the basic "struct device" which appears so often.  Clean up the users as follows:  1) For those headers only needing "struct device" as a pointer in fcn args, replace the include with exactly that.  2) For headers not really using anything from device.h, simply delete the include altogether.  3) For headers relying on getting device.h implicitly before being included themselves, now explicitly include device.h  4) For files in which doing #1 or #2 uncovers an implicit dependency on some other header, fix by explicitly adding the required header(s).  Any C files that were implicitly relying on device.h to be present have already been dealt with in advance.  Total removals from #1 and #2: 51.  Total additions coming from #3: 9.  Total other implicit dependencies from #4: 7.  As of 3.3-rc1, there were 110, so a net removal of 42 gives about a 38% reduction in device.h presence in include/*  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | rwsem.h | s | 3.5K | 108 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | input-polldev.h | s | 2.1K | 50 | Dmitry Torokhov | dmitry.torokhov@gmail.com | 1296537461 |  | Input: input-polldev - fix a couple of typos  Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | percpu_counter.h | s | 3.8K | 145 | Thomas Gleixner | tglx@linutronix.de | 1315905107 |  | locking, percpu_counter: Annotate ::lock as raw  The percpu_counter::lock can be taken in atomic context and therefore cannot be preempted on -rt - annotate it.  In mainline this change documents the low level nature of the lock - otherwise there's no functional difference. Lockdep and Sparse checking will work as usual.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | ucb1400.h | s | 4.3K | 144 | Dmitry Torokhov | dmitry.torokhov@gmail.com | 1325744395 |  | Input: ucb1400_ts - convert to threaded IRQ  Instead of manually create and handler kernel thread switch to threaded IRQ and let kernel IRQ core manage thread for us.  Acked-by: Marek Vasut <marek.vasut@gmail.com> Signed-off-by: Dmitry Torokhov <dtor@mail.ru>
f | kfifo.h | s | 25K | 776 | Stefani Seibold | stefani@seibold.net | 1288227798 |  | kfifo: fix kfifo_alloc() to return a signed int value  Add a new __kfifo_int_must_check_helper() helper function, which is needed for kfifo_alloc() to return the right signed integer value.  The origin __kfifo_must_check_helper() helper was renamed into __kfifo_uint_must_check_helper() to show the sign which is expected and returned.  (And revert the temporary disabling of __kfifo_must_check_helper())  Signed-off-by: Stefani Seibold <stefani@seibold.net> Acked-by: Randy Dunlap <randy.dunlap@oracle.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | kbd_diacr.h | s | 159B | 6 | Samuel Thibault | samuel.thibault@ens-lyon.org | 1192635772 |  | unicode diacritics support  There have been issues with non-latin1 diacritics and unicode. http://bugzilla.kernel.org/show_bug.cgi?id=7746  Git 759448f459234bfcf34b82471f0dba77a9aca498 `Kernel utf-8 handling' partly resolved it by adding conversion between diacritics and unicode. The patch below goes further by just turning diacritics into unicode, hence providing better future support. The kbd support can be fetched from http://bugzilla.kernel.org/attachment.cgi?id=12313  This was tested in all of latin1, latin9, latin2 and unicode with french and czech dead keys.  Turn the kernel accent_table into unicode, and extend ioctls KDGKBDIACR and KDSKBDIACR into their equivalents KDGKBDIACRUC and KDSKBDIACR.  New function int conv_uni_to_8bit(u32 uni) for converting unicode into 8bit _input_.  No, we don't want to store the translation, as it is potentially sparse and large.  Signed-off-by: Samuel Thibault <samuel.thibault@ens-lyon.org> Cc: Jan Engelhardt <jengelh@gmx.de> Cc: "Antonino A. Daplas" <adaplas@pol.net> Cc: David Woodhouse <dwmw2@infradead.org> Cc: Martin Schwidefsky <schwidefsky@de.ibm.com> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
d | ceph |  | 19 items |  | Linus Torvalds | torvalds@linux-foundation.org | 1338401839 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/sage/ceph-client  Pull ceph updates from Sage Weil:  "There are some updates and cleanups to the CRUSH placement code, a bug   fix with incremental maps, several cleanups and fixes from Josh Durgin   in the RBD block device code, a series of cleanups and bug fixes from   Alex Elder in the messenger code, and some miscellaneous bounds   checking and gfp cleanups/fixes."  Fix up trivial conflicts in net/ceph/{messenger.c,osdmap.c} due to the networking people preferring "unsigned int" over just "unsigned".  * git://git.kernel.org/pub/scm/linux/kernel/git/sage/ceph-client: (45 commits)   libceph: fix pg_temp updates   libceph: avoid unregistering osd request when not registered   ceph: add auth buf in prepare_write_connect()   ceph: rename prepare_connect_authorizer()   ceph: return pointer from prepare_connect_authorizer()   ceph: use info returned by get_authorizer   ceph: have get_authorizer methods return pointers   ceph: ensure auth ops are defined before use   ceph: messenger: reduce args to create_authorizer   ceph: define ceph_auth_handshake type   ceph: messenger: check return from get_authorizer   ceph: messenger: rework prepare_connect_authorizer()   ceph: messenger: check prepare_write_connect() result   ceph: don't set WRITE_PENDING too early   ceph: drop msgr argument from prepare_write_connect()   ceph: messenger: send banner in process_connect()   ceph: messenger: reset connection kvec caller   libceph: don't reset kvec in prepare_write_banner()   ceph: ignore preferred_osd field   ceph: fully initialize new layout   ...
f | tick.h | s | 4.5K | 127 | Frederic Weisbecker | fweisbec@gmail.com | 1323628317 |  | nohz: Remove tick_nohz_idle_enter_norcu() / tick_nohz_idle_exit_norcu()  Those two APIs were provided to optimize the calls of tick_nohz_idle_enter() and rcu_idle_enter() into a single irq disabled section. This way no interrupt happening in-between would needlessly process any RCU job.  Now we are talking about an optimization for which benefits have yet to be measured. Let's start simple and completely decouple idle rcu and dyntick idle logics to simplify.  Signed-off-by: Frederic Weisbecker <fweisbec@gmail.com> Cc: Ingo Molnar <mingo@redhat.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Peter Zijlstra <peterz@infradead.org> Reviewed-by: Josh Triplett <josh@joshtriplett.org> Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
f | dm-kcopyd.h | s | 2.0K | 54 | Mikulas Patocka | mpatocka@redhat.com | 1320092338 |  | dm kcopyd: add dm_kcopyd_zero to zero an area  This patch introduces dm_kcopyd_zero() to make it easy to use kcopyd to write zeros into the requested areas instead instead of copying.  It is implemented by passing a NULL copying source to dm_kcopyd_copy().  The forthcoming thin provisioning target uses this.  Signed-off-by: Mikulas Patocka <mpatocka@redhat.com> Signed-off-by: Alasdair G Kergon <agk@redhat.com>
f | if_eql.h | s | 1.8K | 67 | Eric Dumazet | eric.dumazet@gmail.com | 1332902726 |  | eql: dont rely on HZ=100  HZ is more likely to be 1000 these days.  timer handlers are run from softirq, no need to disable bh  skb priority 1 is TC_PRIO_FILLER  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | genalloc.h | s | 3.1K | 77 | Huang Ying | ying.huang@intel.com | 1312384557 |  | lib, Make gen_pool memory allocator lockless  This version of the gen_pool memory allocator supports lockless operation.  This makes it safe to use in NMI handlers and other special unblockable contexts that could otherwise deadlock on locks.  This is implemented by using atomic operations and retries on any conflicts. The disadvantage is that there may be livelocks in extreme cases.  For better scalability, one gen_pool allocator can be used for each CPU.  The lockless operation only works if there is enough memory available. If new memory is added to the pool a lock has to be still taken.  So any user relying on locklessness has to ensure that sufficient memory is preallocated.  The basic atomic operation of this allocator is cmpxchg on long.  On architectures that don't have NMI-safe cmpxchg implementation, the allocator can NOT be used in NMI handler.  So code uses the allocator in NMI handler should depend on CONFIG_ARCH_HAVE_NMI_SAFE_CMPXCHG.  Signed-off-by: Huang Ying <ying.huang@intel.com> Reviewed-by: Andi Kleen <ak@linux.intel.com> Reviewed-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Len Brown <len.brown@intel.com>
f | brcmphy.h | s | 1.1K | 28 | Dmitry Baryshkov | dbaryshkov@gmail.com | 1277440209 |  | broadcom: Add 5241 support  This patch adds the 5241 PHY ID to the broadcom module.  Signed-off-by: Dmitry Eremin-Solenikov <dbaryshkov@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mv643xx_eth.h | s | 1.8K | 68 | Andrew Lunn | andrew@lunn.ch | 1336520036 |  | ARM: Orion: Eth: Add clk/clkdev support.  The t_clk is moved from the shared part of the ethernet driver into the per port section. Each port can have its own gated clock, which it needs to enable/disable, as oppossed to there being one clock shared by all ports. In practice, only kirkwood supports this at the moment.  Signed-off-by: Andrew Lunn <andrew@lunn.ch> Tested-by: Jamie Lentin <jm@lentin.co.uk> Signed-off-by: Mike Turquette <mturquette@linaro.org>
f | crc32c.h | s | 254B | 7 | Herbert Xu | herbert@gondor.apana.org.au | 1230163303 |  | libcrc32c: Add crc32c_le macro  The bnx2x driver actually uses the crc32c_le name so this patch restores the crc32c_le symbol through a macro.  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
f | lglock.h | s | 2.3K | 62 | Andi Kleen | ak@linux.intel.com | 1338348521 |  | brlocks/lglocks: turn into functions  lglocks and brlocks are currently generated with some complicated macros in lglock.h.  But there's no reason to not just use common utility functions and put all the data into a common data structure.  Since there are at least two users it makes sense to share this code in a library.  This is also easier maintainable than a macro forest.  This will also make it later possible to dynamically allocate lglocks and also use them in modules (this would both still need some additional, but now straightforward, code)  [akpm@linux-foundation.org: checkpatch fixes] Signed-off-by: Andi Kleen <ak@linux.intel.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
d | raid |  | 5 items |  | Jim Kukunas | james.t.kukunas@linux.intel.com | 1337658858 |  | lib/raid6: Add SSSE3 optimized recovery functions  Add SSSE3 optimized recovery functions, as well as a system for selecting the most appropriate recovery functions to use.  Originally-by: H. Peter Anvin <hpa@zytor.com> Signed-off-by: Jim Kukunas <james.t.kukunas@linux.intel.com> Signed-off-by: NeilBrown <neilb@suse.de>
f | init.h | s | 11K | 296 | Rusty Russell | rusty@rustcorp.com.au | 1326409338 |  | module_param: make bool parameters really bool (core code)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | cpu_pm.h | s | 2.8K | 92 | Colin Cross | ccross@android.com | 1316759729 |  | cpu_pm: Add cpu power management notifiers  During some CPU power modes entered during idle, hotplug and suspend, peripherals located in the CPU power domain, such as the GIC, localtimers, and VFP, may be powered down.  Add a notifier chain that allows drivers for those peripherals to be notified before and after they may be reset.  Notified drivers can include VFP co-processor, interrupt controller and it's PM extensions, local CPU timers context save/restore which shouldn't be interrupted. Hence CPU PM event APIs  must be called with interrupts disabled.  Signed-off-by: Colin Cross <ccross@android.com> Signed-off-by: Santosh Shilimkar <santosh.shilimkar@ti.com> Reviewed-by: Kevin Hilman <khilman@ti.com> Tested-and-Acked-by: Shawn Guo <shawn.guo@linaro.org> Tested-by: Kevin Hilman <khilman@ti.com> Tested-by: Vishwanath BS <vishwanath.bs@ti.com>
f | ipx.h | s | 1.8K | 67 | Paul Gortmaker | paul.gortmaker@windriver.com | 1337795363 |  | ipx: restore token ring define to include/linux/ipx.h  Commit 211ed865108e24697b44bee5daac502ee6bdd4a4      "net: delete all instances of special processing for token ring"  removed the define for IPX_FRAME_TR_8022.  While it is unlikely, we can't be 100% sure that there aren't random userspace consumers of this value, so restore it.  The only instance I could find was in ncpfs-2.2.6, and it was safe as-is, since it used #ifdef IPX_FRAME_TR_8022 around the two use cases it had, but there may be other userspace packages without similar ifdefs.  Cc: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | crc32.h | s | 953B | 23 | Darrick J. Wong | djwong@us.ibm.com | 1332547118 |  | crc32: bolt on crc32c  Reuse the existing crc32 code to stamp out a crc32c implementation.  Signed-off-by: Darrick J. Wong <djwong@us.ibm.com> Cc: Herbert Xu <herbert@gondor.apana.org.au> Cc: Bob Pearson <rpearson@systemfabricworks.com> Cc: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | selinux.h | s | 910B | 30 | Eric Paris | eparis@redhat.com | 1287616368 |  | secmark: make secmark object handling generic  Right now secmark has lots of direct selinux calls.  Use all LSM calls and remove all SELinux specific knowledge.  The only SELinux specific knowledge we leave is the mode.  The only point is to make sure that other LSMs at least test this generic code before they assume it works.  (They may also have to make changes if they do not represent labels as strings)  Signed-off-by: Eric Paris <eparis@redhat.com> Acked-by: Paul Moore <paul.moore@hp.com> Acked-by: Patrick McHardy <kaber@trash.net> Signed-off-by: James Morris <jmorris@namei.org>
f | atm_tcp.h | s | 1.7K | 55 | Mike Frysinger | vapier@gentoo.org | 1210832649 |  | atm: Cleanup atm_tcp.h and atm.h for userspace.  The atm_tcp.h uses types from linux/atm.h, but does not include it. It should also use the standard __u## types from linux/types.h rather than the uint##_t types since the former can be found with the kernel already.  Same goes for linux/atm.h.  The linux/socket.h include there also gets dropped as atm.h does not actually use anything from socket.h.  Signed-off-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: David S. Miller <davem@davemloft.net>
d | lockd |  | 7 items |  | Stanislav Kinsbursky | skinsbursky@parallels.com | 1334181306 |  | Lockd: pass network namespace to creation and destruction routines  v2: dereference of most probably already released nlm_host removed in nlmclnt_done() and reclaimer().  These routines are called from locks reclaimer() kernel thread. This thread works in "init_net" network context and currently relays on persence on lockd thread and it's per-net resources. Thus lockd_up() and lockd_down() can't relay on current network context. So let's pass corrent one into them.  Signed-off-by: Stanislav Kinsbursky <skinsbursky@parallels.com> Signed-off-by: J. Bruce Fields <bfields@redhat.com>
f | sht15.h | s | 1.0K | 32 | Jerome Oufella | jerome.oufella@savoirfairelinux.com | 1305818376 |  | hwmon: (sht15) add support for CRC validation  The sht15 sensor allows validating exchanges to and from the device using a crc8 function. An utility function to reverse a byte has also been added.  Signed-off-by: Jerome Oufella <jerome.oufella@savoirfairelinux.com> Acked-by: Jonathan Cameron <jic23@cam.ac.uk> Signed-off-by: Guenter Roeck <guenter.roeck@ericsson.com>
f | stat.h | s | 1.7K | 65 | Eric W. Biederman | ebiederm@xmission.com | 1337116115 |  | userns: Convert stat to return values mapped from kuids and kgids  - Store uids and gids with kuid_t and kgid_t in struct kstat - Convert uid and gids to userspace usable values with   from_kuid and from_kgid  Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>
f | pch_dma.h | s | 999B | 32 | Yong Wang | yong.y.wang@linux.intel.com | 1280956325 |  | dmaengine: Driver for Topcliff PCH DMA controller  Topcliff PCH is the platform controller hub that is going to be used in Intel's upcoming general embedded platforms. This adds the driver for Topcliff PCH DMA controller. The DMA channels are strictly for device to host or host to device transfers and cannot be used for generic memcpy.  Signed-off-by: Yong Wang <yong.y.wang@intel.com> [kill GFP_ATOMIC, kill __raw_{read||write}l, locking fixlet] Signed-off-by: Dan Williams <dan.j.williams@intel.com>
f | pkt_sched.h | s | 16K | 611 | Eric Dumazet | edumazet@google.com | 1336852422 |  | fq_codel: Fair Queue Codel AQM  Fair Queue Codel packet scheduler  Principles :  - Packets are classified (internal classifier or external) on flows. - This is a Stochastic model (as we use a hash, several flows might                               be hashed on same slot) - Each flow has a CoDel managed queue. - Flows are linked onto two (Round Robin) lists,   so that new flows have priority on old ones.  - For a given flow, packets are not reordered (CoDel uses a FIFO) - head drops only. - ECN capability is on by default. - Very low memory footprint (64 bytes per flow)  tc qdisc ... fq_codel [ limit PACKETS ] [ flows number ]                       [ target TIME ] [ interval TIME ] [ noecn ]                       [ quantum BYTES ]  defaults : 1024 flows, 10240 packets limit, quantum : device MTU            target : 5ms (CoDel default)            interval : 100ms (CoDel default)  Impressive results on load :  class htb 1:1 root leaf 10: prio 0 quantum 1514 rate 200000Kbit ceil 200000Kbit burst 1475b/8 mpu 0b overhead 0b cburst 1475b/8 mpu 0b overhead 0b level 0  Sent 43304920109 bytes 33063109 pkt (dropped 0, overlimits 0 requeues 0)  rate 201691Kbit 28595pps backlog 0b 312p requeues 0  lended: 33063109 borrowed: 0 giants: 0  tokens: -912 ctokens: -912  class fq_codel 10:1735 parent 10:  (dropped 1292, overlimits 0 requeues 0)  backlog 15140b 10p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 7.1ms class fq_codel 10:4524 parent 10:  (dropped 1291, overlimits 0 requeues 0)  backlog 16654b 11p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 7.1ms class fq_codel 10:4e74 parent 10:  (dropped 1290, overlimits 0 requeues 0)  backlog 6056b 4p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 6.4ms dropping drop_next 92.0ms class fq_codel 10:628a parent 10:  (dropped 1289, overlimits 0 requeues 0)  backlog 7570b 5p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 5.4ms dropping drop_next 90.9ms class fq_codel 10:a4b3 parent 10:  (dropped 302, overlimits 0 requeues 0)  backlog 16654b 11p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 7.1ms class fq_codel 10:c3c2 parent 10:  (dropped 1284, overlimits 0 requeues 0)  backlog 13626b 9p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 5.9ms class fq_codel 10:d331 parent 10:  (dropped 299, overlimits 0 requeues 0)  backlog 15140b 10p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 7.0ms class fq_codel 10:d526 parent 10:  (dropped 12160, overlimits 0 requeues 0)  backlog 35870b 211p requeues 0   deficit 1508 count 12160 lastcount 1 ldelay 15.3ms dropping drop_next 247us class fq_codel 10:e2c6 parent 10:  (dropped 1288, overlimits 0 requeues 0)  backlog 15140b 10p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 7.1ms class fq_codel 10:eab5 parent 10:  (dropped 1285, overlimits 0 requeues 0)  backlog 16654b 11p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 5.9ms class fq_codel 10:f220 parent 10:  (dropped 1289, overlimits 0 requeues 0)  backlog 15140b 10p requeues 0   deficit 1514 count 1 lastcount 1 ldelay 7.1ms  qdisc htb 1: root refcnt 6 r2q 10 default 1 direct_packets_stat 0 ver 3.17  Sent 43331086547 bytes 33092812 pkt (dropped 0, overlimits 66063544 requeues 71)  rate 201697Kbit 28602pps backlog 0b 260p requeues 71 qdisc fq_codel 10: parent 1:1 limit 10240p flows 65536 target 5.0ms interval 100.0ms ecn  Sent 43331086547 bytes 33092812 pkt (dropped 949359, overlimits 0 requeues 0)  rate 201697Kbit 28602pps backlog 189352b 260p requeues 0   maxpacket 1514 drop_overlimit 0 new_flow_count 5582 ecn_mark 125593   new_flows_len 0 old_flows_len 11  PING 172.30.42.18 (172.30.42.18) 56(84) bytes of data. 64 bytes from 172.30.42.18: icmp_req=1 ttl=64 time=0.227 ms 64 bytes from 172.30.42.18: icmp_req=2 ttl=64 time=0.165 ms 64 bytes from 172.30.42.18: icmp_req=3 ttl=64 time=0.166 ms 64 bytes from 172.30.42.18: icmp_req=4 ttl=64 time=0.151 ms 64 bytes from 172.30.42.18: icmp_req=5 ttl=64 time=0.164 ms 64 bytes from 172.30.42.18: icmp_req=6 ttl=64 time=0.172 ms 64 bytes from 172.30.42.18: icmp_req=7 ttl=64 time=0.175 ms 64 bytes from 172.30.42.18: icmp_req=8 ttl=64 time=0.183 ms 64 bytes from 172.30.42.18: icmp_req=9 ttl=64 time=0.158 ms 64 bytes from 172.30.42.18: icmp_req=10 ttl=64 time=0.200 ms  10 packets transmitted, 10 received, 0% packet loss, time 8999ms rtt min/avg/max/mdev = 0.151/0.176/0.227/0.022 ms  Much better than SFQ because of priority given to new flows, and fast path dirtying less cache lines.  Signed-off-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | pm_qos.h | s | 5.0K | 138 | MyungJoo Ham | myungjoo.ham@samsung.com | 1332970284 |  | PM / QoS: add pm_qos_update_request_timeout() API  The new API, pm_qos_update_request_timeout() is to provide a timeout with pm_qos_update_request.  For example, pm_qos_update_request_timeout(req, 100, 1000), means that QoS request on req with value 100 will be active for 1000 microseconds. After 1000 microseconds, the QoS request thru req is reset. If there were another pm_qos_update_request(req, x) during the 1000 us, this new request with value x will override as this is another request on the same req handle. A new request on the same req handle will always override the previous request whether it is the conventional request or it is the new timeout request.  Signed-off-by: MyungJoo Ham <myungjoo.ham@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Acked-by: Mark Gross <markgross@thegnar.org> Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
f | clkdev.h | s | 1.0K | 37 | Russell King | rmk+kernel@arm.linux.org.uk | 1335947432 |  | CLKDEV: provide helpers for common clock framework  The common clock framework allocates clocks dynamically.  Provide a set of helpers to streamline the clkdev registration of the clock lookups to avoid repetitive code sequences.  Reviewed-by: Viresh Kumar <viresh.kumar@st.com> Tested-by: Shawn Guo <shawn.guo@linaro.org> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | chio.h | s | 5.2K | 150 | Andr√© Goddard Rosa | andre.goddard@gmail.com | 1259937595 |  | tree-wide: fix assorted typos all over the place  That is "success", "unknown", "through", "performance", "[re||un]mapping" , "access", "default", "reasonable", "[con]currently", "temperature" , "channel", "[un]used", "application", "example","hierarchy", "therefore" , "[over||under]flow", "contiguous", "threshold", "enough" and others.  Signed-off-by: Andr√© Goddard Rosa <andre.goddard@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | power_supply.h | s | 7.6K | 244 | Anton Vorontsov | cbouatmailru@gmail.com | 1336191352 |  | power_supply: Make the core a boolean instead of a tristate  On Mon, Apr 02, 2012 at 01:53:23PM +1000, Benjamin Herrenschmidt wrote: > > drivers/built-in.o: In function `.nouveau_pm_trigger': > > (.text+0xa56e8): undefined reference to `.power_supply_is_system_supplied' > > > > nouveau probably needs to depends on CONFIG_POWER_SUPPLY to force a module > > build with the latter is =m > > Ok, not that trivial... > > The problem is more like POWER_SUPPLY should be a bool, not a tristate. > > If you think about it: you don't want things like nouveau to depend on a > random subsystem like that, people will never get it. In fact, > POWER_SUPPLY provides empty inline stubs when not enabled, so that's > really designed to not have depends... > > However that -cannot- work if POWER_SUPPLY is modular and the drivers > who use it are not. > > The only fixes here that make sense I can think of > that don't also involve Kconfig horrors are: > >  - Ugly: in power_supply.h, use the extern variant if > >       defined(CONFIG_POWER_SUPPLY) |||| >        (defined(CONFIG_POWER_SUPPLY_MODULE) && defined(MODULE)) > > IE. use the stub if power supply is a module and what is being built is > built-in. Of course that's not only ugly, it somewhat sucks from a user > perspective as the subsystem now exists but can't be used by some > drivers... > >  - Better: Just make the bloody thing a bool :-) The power supply > framework itself is small enough, just make it a boolean option and > avoid the problem entirely. The actual power supply sub drivers can > remain modular of course.  Suggested-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> Signed-off-by: Anton Vorontsov <cbouatmailru@gmail.com>
f | mod_devicetable.h | s | 15K | 500 | Henrik Rydberg | rydberg@euromail.se | 1335869694 |  | HID: Allow bus wildcard matching  Most HID drivers do not need to know what bus driver is in use. A generic group driver can drive any hid device, and the device list should not need to be duplicated for each new bus.  This patch adds wildcard matching to the HID bus, simplifying device list handling for group drivers.  Signed-off-by: Henrik Rydberg <rydberg@euromail.se> Acked-by: Benjamin Tissoires <benjamin.tissoires@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | klist.h | s | 1.8K | 53 | David Miller | davem@davemloft.net | 1297644864 |  | klist: Fix object alignment on 64-bit.  Commit c0e69a5bbc6f ("klist.c: bit 0 in pointer can't be used as flag") intended to make sure that all klist objects were at least pointer size aligned, but used the constant "4" which only works on 32-bit.  Use "sizeof(void *)" which is correct in all cases.  Signed-off-by: David S. Miller <davem@davemloft.net> Acked-by: Jesper Nilsson <jesper.nilsson@axis.com> Cc: stable <stable@kernel.org> Cc: Greg Kroah-Hartman <gregkh@suse.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | hil.h | s | 18K | 429 | Daniel Mack | daniel@caiaq.de | 1265710436 |  | tree-wide: Assorted spelling fixes  In particular, several occurances of funny versions of 'success', 'unknown', 'therefore', 'acknowledge', 'argument', 'achieve', 'address', 'beginning', 'desirable', 'separate' and 'necessary' are fixed.  Signed-off-by: Daniel Mack <daniel@caiaq.de> Cc: Joe Perches <joe@perches.com> Cc: Junio C Hamano <gitster@pobox.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
d | can |  | 9 items |  | Marc Kleine-Budde | mkl@pengutronix.de | 1328228485 |  | can: dev: let can_get_echo_skb() return dlc of CAN frame  can_get_echo_skb() is usually called in the TX complete handler. The stats->tx_packets and stats->tx_bytes should be updated there, too. This patch simplifies to figure out the size of the sent CAN frame.  Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>
f | pid.h | s | 5.8K | 176 | Sisir Koppaka | sisir.koppaka@gmail.com | 1306455157 |  | pid: fix typo in function description  finds is misspelt as finr. No functional change.  Signed-off-by: Sisir Koppaka <sisir.koppaka@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | isicom.h | s | 1.5K | 57 | Alan Cox | alan@linux.intel.com | 1260573487 |  | tty: isicom: sort out the board init logic  Split this into two flags - INIT meaning the board is set up and ACTIVE meaning the board has ports open. Remove the broken HUPCL casing and push the counts somewhere sensible.  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | msg.h | s | 3.6K | 95 | Nadia Derbey | Nadia.Derbey@bull.net | 1212776952 |  | ipc: restore MSGPOOL original value  When posting:  	[PATCH 1/8] Scaling msgmni to the amount of lowmem  (see http://article.gmane.org/gmane.linux.kernel/637849/) I changed the MSGPOOL value to make it fit what is said in the man pages (i.e.  a size in bytes).  But Michael Kerrisk rightly complained that this change could affect the ABI.  So I'm posting this patch to make MSGPOOL expressed back in Kbytes. Michael, on his side, has fixed the man page.  Signed-off-by: Nadia Derbey <Nadia.Derbey@bull.net> Cc: Pierre Peiffer <peifferp@gmail.com> Cc: Manfred Spraul <manfred@colorfullife.com> Acked-by: Michael Kerrisk <mtk.manpages@googlemail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | nl802154.h | s | 3.6K | 122 | alex.bluesman.smirnov@gmail.com | alex.bluesman.smirnov@gmail.com | 1337195828 |  | mac802154: monitor device support  Support for monitor device intended to capture all the network activity. This interface could be used by networks sniffers and is already supported by WireShark. That's a good test point to check that basic MAC support works.  Signed-off-by: Alexander Smirnov <alex.bluesman.smirnov@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | remoteproc.h | s | 16K | 452 | Ohad Ben-Cohen | ohad@wizery.com | 1331054077 |  | remoteproc: remove the hardcoded vring alignment  Remove the hardcoded vring alignment of 4096 bytes, and instead utilize tha vring alignment as specified in the resource table.  This is needed for remote processors that have rigid memory requirement, and which have found the alignment of 4096 bytes to be excessively big.  Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com> Cc: Brian Swetland <swetland@google.com> Cc: Iliyan Malchev <malchev@google.com> Cc: Arnd Bergmann <arnd@arndb.de> Cc: Grant Likely <grant.likely@secretlab.ca> Cc: Rusty Russell <rusty@rustcorp.com.au> Cc: Mark Grosen <mgrosen@ti.com> Cc: John Williams <john.williams@petalogix.com> Cc: Michal Simek <monstr@monstr.eu> Cc: Loic PALLARDY <loic.pallardy@stericsson.com> Cc: Ludovic BARRE <ludovic.barre@stericsson.com> Cc: Omar Ramirez Luna <omar.luna@linaro.org> Cc: Guzman Lugo Fernando <fernando.lugo@ti.com> Cc: Anna Suman <s-anna@ti.com> Cc: Clark Rob <rob@ti.com> Cc: Stephen Boyd <sboyd@codeaurora.org> Cc: Saravana Kannan <skannan@codeaurora.org> Cc: David Brown <davidb@codeaurora.org> Cc: Kieran Bingham <kieranbingham@gmail.com> Cc: Tony Lindgren <tony@atomide.com>
f | posix_acl_xattr.h | s | 1.4K | 44 | Christoph Hellwig | hch@lst.de | 1119545133 |  | [PATCH] remove <linux/xattr_acl.h>  This file duplicates <linux/posix_acl_xattr.h>, using slightly different names.  Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | mei.h | s | 4.0K | 104 | Tomas Winkler | tomas.winkler@intel.com | 1336597086 |  | mei: export mei.h for the user space  The header exports API for application layer  1. move under include/linux and add to  the export list 2. update include path n the sources 3. update TODO  Signed-off-by: Tomas Winkler <tomas.winkler@intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | omapfb.h | s | 5.9K | 200 | Tomi Valkeinen | tomi.valkeinen@ti.com | 1329982763 |  | OMAP1: pass LCD config with omapfb_set_lcd_config()  LCD config for old omapfb driver is passed with OMAP_TAG_LCD from board files or from the bootloader. In an effort to remove OMAP_TAG_LCD, this patch adds omapfb_set_lcd_config() function that the board files can call to set the LCD config.  This has the drawback that configuration can no longer come from the bootloader. Of the boards supported by the kernel, this should only affect N770 which depends on the data from the bootloader. This patch adds an LCD config for N770 to its board files, but that is most probably broken. Fixing this would need information about the HW setup in N770 boards.  Signed-off-by: Tomi Valkeinen <tomi.valkeinen@ti.com> Acked-by: Tony Lindgren <tony@atomide.com>
f | exportfs.h | s | 6.5K | 177 | Al Viro | viro@zeniv.linux.org.uk | 1338348513 |  | ->encode_fh() API change  pass inode + parent's inode or NULL instead of dentry + bool saying whether we want the parent or not.  NOTE: that needs ceph fix folded in.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | nilfs2_fs.h | s | 22K | 764 | Paul Gortmaker | paul.gortmaker@windriver.com | 1330901674 |  | BUG: headers with BUG/BUG_ON etc. need linux/bug.h  If a header file is making use of BUG, BUG_ON, BUILD_BUG_ON, or any other BUG variant in a static inline (i.e. not in a #define) then that header really should be including <linux/bug.h> and not just expecting it to be implicitly present.  We can make this change risk-free, since if the files using these headers didn't have exposure to linux/bug.h already, they would have been causing compile failures/warnings.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | lis3lv02d.h | s | 5.0K | 123 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1320107452 |  | lis3lv02d: make regulator API usage unconditional  The regulator API contains a range of features for stubbing itself out when not in use and for transparently restricting the actual effect of regulator API calls where they can't be supported on a particular system so that drivers don't need to individually implement this.  Simplify the driver slightly by making use of this idiom.  The only in tree user is ecovec24 which does not use the regulator API.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Cc: √âric Piel <eric.piel@tremplin-utc.net> Cc: Ilkka Koskinen <ilkka.koskinen@nokia.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | inet_lro.h | s | 4.3K | 142 | Jiri Pirko | jpirko@redhat.com | 1311281274 |  | lro: do vlan cleanup  - remove useless vlan parameters and pointers  Signed-off-by: Jiri Pirko <jpirko@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | poison.h | s | 2.5K | 70 | Tejun Heo | tj@kernel.org | 1323368527 |  | memblock: Kill sentinel entries at the end of static region arrays  memblock no longer depends on having one more entry at the end during addition making the sentinel entries at the end of region arrays not too useful.  Remove the sentinels.  This eases further updates.  Signed-off-by: Tejun Heo <tj@kernel.org> Cc: Benjamin Herrenschmidt <benh@kernel.crashing.org> Cc: Yinghai Lu <yinghai@kernel.org>
f | ecryptfs.h | s | 4.1K | 104 | Roberto Sassu | roberto.sassu@polito.it | 1309180262 |  | eCryptfs: export global eCryptfs definitions to include/linux/ecryptfs.h  Some eCryptfs specific definitions, such as the current version and the authentication token structure, are moved to the new include file 'include/linux/ecryptfs.h', in order to be available for all kernel subsystems.  Signed-off-by: Roberto Sassu <roberto.sassu@polito.it> Acked-by: Gianluca Ramunno <ramunno@polito.it> Acked-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com> Acked-by: David Howells <dhowells@redhat.com> Signed-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com>
f | if_infiniband.h | s | 1.1K | 26 | Justin P. Mattock | justinmattock@gmail.com | 1287392594 |  | Update broken web addresses in the kernel.  The patch below updates broken web addresses in the kernel  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Cc: Maciej W. Rozycki <macro@linux-mips.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Finn Thain <fthain@telegraphics.com.au> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Matt Turner <mattst88@gmail.com> Cc: Dimitry Torokhov <dmitry.torokhov@gmail.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Acked-by: Ben Pfaff <blp@cs.stanford.edu> Acked-by: Hans J. Koch <hjk@linutronix.de> Reviewed-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | dio.h | s | 10K | 246 | Joe Perches | joe@perches.com | 1307710536 |  | treewide: Convert uses of struct resource to resource_size(ptr)  Several fixes as well where the +1 was missing.  Done via coccinelle scripts like:  @@ struct resource *ptr; @@  - ptr->end - ptr->start + 1 + resource_size(ptr)  and some grep and typing.  Mostly uncompiled, no cross-compilers.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | dqblk_v2.h | s | 367B | 12 | Jan Kara | jack@suse.cz | 1231173625 |  | quota: Unexport dqblk_v1.h and dqblk_v2.h  Unexport header files dqblk_v[12].h since except for quota format ID they don't contain information userspace should be interested in. Move ID definitions to quota.h.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Mark Fasheh <mfasheh@suse.com>
f | telephony.h | s | 8.8K | 236 | Alan Cox | alan@lxorguk.ukuu.org.uk | 1226424623 |  | telephony: trivial: fix up email address  Signed-off-by: Alan Cox <alan@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | icmp.h | s | 3.0K | 90 | Arnaldo Carvalho de Melo | acme@redhat.com | 1177565131 |  | [SK_BUFF]: Introduce skb_transport_header(skb)  For the places where we need a pointer to the transport header, it is still legal to touch skb->h.raw directly if just adding to, subtracting from or setting it to another layer header.  Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
d | spi |  | 32 items |  | Qiao Zhou | zhouqiao@marvell.com | 1339388750 |  | ARM: MMP: add pxa910-ssp into ssp_id_table  add pxa910-ssp into ssp_id_table, and fix pxa-ssp compiling issue under mach-mmp architect.  Signed-off-by: Qiao Zhou <zhouqiao@marvell.com> Acked-by: Haojian Zhuang <haojian.zhuang@gmail.com> Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com>
f | gsmmux.h | s | 905B | 30 | Russ Gorby | russ.gorby@intel.com | 1309559685 |  | tty: n_gsm: Add raw-ip support  This patch adds the ability to open a network data connection over a mux virtual tty channel. This is for modems that support data connections with raw IP frames instead of PPP. On high speed data connections this eliminates a significant amount of PPP overhead. To use this interface, the application must first tell the modem to open a network connection on a virtual tty. Once that has been accomplished, the app will issue an IOCTL on that virtual tty to create the network interface. The IOCTL will return the index of the interface created.  The two IOCTL commands are:      ioctl( fd, GSMIOC_ENABLE_NET );      ioctl( fd, GSMIOC_DISABLE_NET );  Signed-off-by: Russ Gorby <russ.gorby@intel.com> Acked-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | x25.h | s | 3.4K | 132 | Ben Hutchings | ben@decadent.org.uk | 1314374570 |  | headers, net: Use __kernel_sa_family_t in more definitions shared with userland  Complete the work started with commit 6602a4baf4d1a73cc4685a39ef859e1c5ddf654c ('net: Make userland include of netlink.h more sane').  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
f | apm-emulation.h | s | 1.5K | 53 | Ralf Baechle | ralf@linux-mips.org | 1171040937 |  | [APM] Add shared version of APM emulation  Currently ARM and MIPS both have nearly identical copies of the APM emulation code in their arch code.  Add yet another copy of it to drivers char and make it selectable through SYS_SUPPORTS_APM_EMULATION.  Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | serial_8250.h | s | 3.2K | 87 | Linus Torvalds | torvalds@linux-foundation.org | 1337818326 |  | Merge branch 'delete-mca' of git://git.kernel.org/pub/scm/linux/kernel/git/paulg/linux  Pull the MCA deletion branch from Paul Gortmaker:  "It was good that we could support MCA machines back in the day, but   realistically, nobody is using them anymore.  They were mostly limited   to 386-sx 16MHz CPU and some 486 class machines and never more than   64MB of RAM.  Even the enthusiast hobbyist community seems to have   dried up close to ten years ago, based on what you can find searching   various websites dedicated to the relatively short lived hardware.    So lets remove the support relating to CONFIG_MCA.  There is no point   carrying this forward, wasting cycles doing routine maintenance on it;   wasting allyesconfig build time on validating it, wasting I/O on git   grep'ping over it, and so on."  Let's see if anybody screams.  It generally has compiled, and James Bottomley pointed out that there was a MCA extension from NCR that allowed for up to 4GB of memory and PPro-class machines.  So in *theory* there may be users out there.  But even James (technically listed as a maintainer) doesn't actually have a system, and while Alan Cox claims to have a machine in his cellar that he offered to anybody who wants to take it off his hands, he didn't argue for keeping MCA support either.  So we could bring it back.  But somebody had better speak up and talk about how they have actually been using said MCA hardware with modern kernels for us to do that.  And David already took the patch to delete all the networking driver code (commit a5e371f61ad3: "drivers/net: delete all code/drivers depending on CONFIG_MCA").  * 'delete-mca' of git://git.kernel.org/pub/scm/linux/kernel/git/paulg/linux:   MCA: delete all remaining traces of microchannel bus support.   scsi: delete the MCA specific drivers and driver code   serial: delete the MCA specific 8250 support.   arm: remove ability to select CONFIG_MCA
f | mm_types.h | s | 11K | 358 | Pravin B Shelar | pshelar@nicira.com | 1340228375 |  | mm: fix slab->page _count corruption when using slub  On arches that do not support this_cpu_cmpxchg_double() slab_lock is used to do atomic cmpxchg() on double word which contains page->_count.  The page count can be changed from get_page() or put_page() without taking slab_lock.  That corrupts page counter.  Fix it by moving page->_count out of cmpxchg_double data.  So that slub does no change it while updating slub meta-data in struct page.  [akpm@linux-foundation.org: use standard comment layout, tweak comment text] Reported-by: Amey Bhide <abhide@nicira.com> Signed-off-by: Pravin B Shelar <pshelar@nicira.com> Acked-by: Christoph Lameter <cl@linux.com> Cc: Pekka Enberg <penberg@cs.helsinki.fi> Cc: Andrea Arcangeli <aarcange@redhat.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | sysinfo.h | s | 986B | 21 | H. Peter Anvin | hpa@zytor.com | 1329770927 |  | sysinfo: Use explicit types in <linux/sysinfo.h>  Change <linux/sysinfo.h> to use explicitly sized types.  Replace long/unsigned long with __kernel_[u]long_t so that a non-legacy 32-bit ABI running on a 64-bit kernel can export those as 64-bit types.  Originally-by: H. J. Lu <hjl.tools@gmail.com> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | suspend_ioctls.h | s | 1.3K | 30 | Arnd Bergmann | arnd@arndb.de | 1238087654 |  | make exported headers use strict posix types  A number of standard posix types are used in exported headers, which is not allowed if __STRICT_KERNEL_NAMES is defined. In order to get rid of the non-__STRICT_KERNEL_NAMES part and to make sane headers the default, we have to change them all to safe types.  There are also still some leftovers in reiserfs_fs.h, elfcore.h and coda.h, but these files have not compiled in user space for a long time.  This leaves out the various integer types ({u_,u,}int{8,16,32,64}_t), which we take care of separately.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Cc: David Airlie <airlied@linux.ie> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Cc: netdev@vger.kernel.org Cc: linux-ppp@vger.kernel.org Cc: Jaroslav Kysela <perex@perex.cz> Cc: Takashi Iwai <tiwai@suse.de> Cc: David Woodhouse <dwmw2@infradead.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | i2c.h | s | 23K | 540 | Mark Brown | broonie@opensource.wolfsonmicro.com | 1338368134 |  | i2c: Split I2C_M_NOSTART support out of I2C_FUNC_PROTOCOL_MANGLING  Since there are uses for I2C_M_NOSTART which are much more sensible and standard than most of the protocol mangling functionality (the main one being gather writes to devices where something like a register address needs to be inserted before a block of data) create a new I2C_FUNC_NOSTART for this feature and update all the users to use it.  Also strengthen the disrecommendation of the protocol mangling while we're at it.  In the case of regmap-i2c we remove the requirement for mangling as I2C_M_NOSTART is the only mangling feature which is being used.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | vt_kern.h | s | 6.1K | 171 | Alan Cox | alan@linux.intel.com | 1335309254 |  | vt: push the tty_lock down into the map handling  When we do this it becomes clear the lock we should be holding is the vc lock, and in fact many of our other helpers are properly invoked this way.  We don't at this point guarantee not to race the keyboard code but the results of that appear harmless and that was true before we started as well.  We now have no users of tty_lock in the console driver...  Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
f | arcdevice.h | s | 12K | 289 | Alexey Dobriyan | adobriyan@gmail.com | 1307426111 |  | net: remove interrupt.h inclusion from netdevice.h  * remove interrupt.g inclusion from netdevice.h -- not needed * fixup fallout, add interrupt.h and hardirq.h back where needed.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | dtlk.h | s | 3.5K | 77 | Anirban Sinha | asinha@zeugmasystems.com | 1252975302 |  | cleanup console_print()  console_print() is an old legacy interface mostly unused in the entire kernel tree. It's best to clean up its existing use and let developers use their own implementation of it as they feel fit.  Signed-off-by: Anirban Sinha <asinha@zeugmasystems.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pci_ids.h | s | 112K | 2650 | Seth Heasley | seth.heasley@intel.com | 1336571821 |  | pci_ids: Add Intel Centerton Legacy Block DeviceID  This patch adds the Integrated Legacy Block DeviceID for the Centerton CPU.  It will be used in the GPIO and Multifunction Devices driver.  Signed-off-by: Seth Heasley <seth.heasley@intel.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
f | if_pppol2tp.h | s | 3.2K | 88 | Benjamin LaHaise | bcrl@kvack.org | 1335666111 |  | net/l2tp: add support for L2TP over IPv6 UDP  Now that encap_rcv() works on IPv6 UDP sockets, wire L2TP up to IPv6. Support has been tested with and without hardware offloading.  This version fixes the L2TP over localhost issue with incorrect checksums being reported.  Signed-off-by: Benjamin LaHaise <bcrl@kvack.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | spinlock_api_up.h | s | 3.2K | 71 | Thomas Gleixner | tglx@linutronix.de | 1260831333 |  | locking: Cleanup the name space completely  Make the name space hierarchy of locking functions consistent:      raw_spin* -> _raw_spin* -> __raw_spin*  No functional change.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: Ingo Molnar <mingo@elte.hu>
f | prefetch.h | s | 1.5K | 49 | Lucas De Marchi | lucas.demarchi@profusion.mobi | 1301581583 |  | Fix common misspellings  Fixes generated by 'codespell' and manually reviewed.  Signed-off-by: Lucas De Marchi <lucas.demarchi@profusion.mobi>
d | fsl |  | 1 items |  | Shawn Guo | shawn.guo@linaro.org | 1336800737 |  | dma: mxs-dma: make platform_device_id more generic  Rewrite mxs_dma_is_apbh and mxs_dma_is_apbx in order to support other SoCs like imx6q and reform the platform_device_id for the better further dt support.  Cc: Dan Williams <dan.j.williams@intel.com> Cc: Sascha Hauer <s.hauer@pengutronix.de> Cc: Huang Shijie <b32955@freescale.com> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Marek Vasut <marex@denx.de> Acked-by: Vinod Koul <vinod.koul@intel.com>
f | acpi_io.h | s | 458B | 13 | Myron Stowe | mstowe@redhat.com | 1326792920 |  | ACPI: Export interfaces for ioremapping/iounmapping ACPI registers  Export remapping and unmapping interfaces - acpi_os_map_generic_address() and acpi_os_unmap_generic_address() - for ACPI generic registers that are backed by memory mapped I/O (MMIO).  The acpi_os_map_generic_address() and acpi_os_unmap_generic_address() declarations may more properly belong in include/acpi/acpiosxf.h next to acpi_os_read_memory() but I believe that would require the ACPI CA making them an official part of the ACPI CA - OS interface.  ACPI Generic Address Structure (GAS) reference (ACPI's fixed/generic hardware registers use the GAS format):   ACPI Specification, Revision 4.0, Section 5.2.3.1, "Generic Address   Structure"  Signed-off-by: Myron Stowe <myron.stowe@redhat.com> Acked-by: Rafael J. Wysocki <rjw@sisk.pl> Signed-off-by: Len Brown <len.brown@intel.com>
f | uaccess.h | s | 3.4K | 100 | Steven Rostedt | srostedt@redhat.com | 1306367783 |  | maccess,probe_kernel: Make write/read src const void *  The functions probe_kernel_write() and probe_kernel_read() do not modify the src pointer. Allow const pointers to be passed in without the need of a typecast.  Acked-by: Mike Frysinger <vapier@gentoo.org> Acked-by: Heiko Carstens <heiko.carstens@de.ibm.com> Acked-by: Martin Schwidefsky <schwidefsky@de.ibm.com> Signed-off-by: Steven Rostedt <rostedt@goodmis.org> Link: http://lkml.kernel.org/r/1305824936.1465.4.camel@gandalf.stny.rr.com
f | fcdevice.h | s | 995B | 29 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | blkdev.h | s | 40K | 1217 | Asias He | asias@redhat.com | 1339742783 |  | block: Drop dead function blk_abort_queue()  This function was only used by btrfs code in btrfs_abort_devices() (seems in a wrong way).  It was removed in commit d07eb9117050c9ed3f78296ebcc06128b52693be, So, Let's remove the dead code to avoid any confusion.  Changes in v2: update commit log, btrfs_abort_devices() was removed already.  Cc: Jens Axboe <axboe@kernel.dk> Cc: linux-kernel@vger.kernel.org Cc: Chris Mason <chris.mason@oracle.com> Cc: linux-btrfs@vger.kernel.org Cc: David Sterba <dave@jikos.cz> Signed-off-by: Asias He <asias@redhat.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>
f | videodev2.h | s | 97K | 2378 | Hans Verkuil | hverkuil@xs4all.nl | 1339440441 |  | [media] Fix regression in ioctl numbering  Yuck. The VIDIOC_(TRY_)DECODER_CMD ioctls already had ioctl numbers 96 and 97, and after merging the timings API I forgot to continue numbering from 98. So now we have two ioctls with number 96 and two with 97.  With the new table-driver ioctl handling in v4l2-ioctl.c it is essential that each ioctl has its own unique number, so let's fix this quickly for 3.5.  Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | device-mapper.h | s | 13K | 428 | Alasdair G Kergon | agk@redhat.com | 1320092344 |  | dm table: add immutable feature  Introduce DM_TARGET_IMMUTABLE to indicate that the target type cannot be mixed with any other target type, and once loaded into a device, it cannot be replaced with a table containing a different type.  The thin provisioning pool device will use this.  Signed-off-by: Alasdair G Kergon <agk@redhat.com>
f | rmap.h | s | 7.6K | 222 | Alex Shi | alex.shi@intel.com | 1338333741 |  | mm: move is_vma_temporary_stack() declaration to huge_mm.h  When transparent_hugepage_enabled() is used outside mm/, such as in arch/x86/xx/tlb.c:  +       if (!cpu_has_invlpg |||| vma->vm_flags & VM_HUGETLB +                       |||| transparent_hugepage_enabled(vma)) { +               flush_tlb_mm(vma->vm_mm);  is_vma_temporary_stack() isn't referenced in huge_mm.h, so it has compile errors:    arch/x86/mm/tlb.c: In function `flush_tlb_range':   arch/x86/mm/tlb.c:324:4: error: implicit declaration of function `is_vma_temporary_stack' [-Werror=implicit-function-declaration]  Since is_vma_temporay_stack() is just used in rmap.c and huge_memory.c, it is better to move it to huge_mm.h from rmap.h to avoid such errors.  Signed-off-by: Alex Shi <alex.shi@intel.com> Cc: Andrea Arcangeli <aarcange@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | kernel.h | s | 21K | 618 | Xi Wang | xi.wang@gmail.com | 1338511766 |  | introduce SIZE_MAX  ULONG_MAX is often used to check for integer overflow when calculating allocation size.  While ULONG_MAX happens to work on most systems, there is no guarantee that `size_t' must be the same size as `long'.  This patch introduces SIZE_MAX, the maximum value of `size_t', to improve portability and readability for allocation size validation.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Acked-by: Alex Elder <elder@dreamhost.com> Cc: David Airlie <airlied@linux.ie> Cc: Pekka Enberg <penberg@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | net_tstamp.h | s | 3.3K | 99 | Richard Cochran | richard.cochran@omicron.at | 1319058035 |  | net: validate HWTSTAMP ioctl parameters  This patch adds a sanity check on the values provided by user space for the hardware time stamping configuration. If the values lie outside of the absolute limits, then the ioctl request will be denied.  Signed-off-by: Richard Cochran <richard.cochran@omicron.at> Signed-off-by: David S. Miller <davem@davemloft.net>
f | intel_pmic_gpio.h | s | 372B | 13 | Alek Du | alek.du@intel.com | 1280843349 |  | gpio: Add PMIC GPIO block support  Moorestown has PMIC chip which contains GPIO blocks. The PMIC chip is connected to Langwell by SPI interface. So this GPIO driver will be regarded as SPI GPIO expander though the actual GPIO access is through IPC and SRAM. The SPI master contoller will probe this device driver by parsing SPIB table.  Cleaned up for new IPC, GPE removed and some printk and other tidying by Alan Cox. Fixes for points noted by Matthew Garrett  Signed-off-by: Alek Du <alek.du@intel.com> Signed-off-by: Alan Cox <alan@linux.intel.com> Signed-off-by: Matthew Garrett <mjg@redhat.com>
f | crc-ccitt.h | s | 330B | 10 | Robert P. J. Day | rpjday@crashcourse.ca | 1209569394 |  | Remove "#ifdef __KERNEL__" checks from unexported headers  Remove the "#ifdef __KERNEL__" tests from unexported header files in linux/include whose entire contents are wrapped in that preprocessor test.  Signed-off-by: Robert P. J. Day <rpjday@crashcourse.ca> Cc: David Woodhouse <dwmw2@infradead.org> Cc: Sam Ravnborg <sam@ravnborg.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | swiotlb.h | s | 3.3K | 88 | Konrad Rzeszutek Wilk | konrad.wilk@oracle.com | 1323167883 |  | swiotlb: Expose swiotlb_nr_tlb function to modules  As a mechanism to detect whether SWIOTLB is enabled or not. We also fix the spelling - it was swioltb instead of swiotlb.  CC: FUJITA Tomonori <fujita.tomonori@lab.ntt.co.jp> [v1: Ripped out swiotlb_enabled] Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | virtio_blk.h | s | 4.4K | 107 | Rusty Russell | rusty@rustcorp.com.au | 1306719854 |  | virtio: add full three-clause BSD text to headers.  It's unclear to me if it's important, but it's obviously causing my technical colleages some headaches and I'd hate such imprecision to slow virtio adoption.  I've emailed this to all non-trivial contributors for approval, too.  Signed-off-by: Rusty Russell <rusty@rustcorp.com.au> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: Ryan Harper <ryanh@us.ibm.com> Acked-by: Anthony Liguori <aliguori@us.ibm.com> Acked-by: Eric Van Hensbergen <ericvh@gmail.com> Acked-by: john cooper <john.cooper@redhat.com> Acked-by: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Acked-by: Christian Borntraeger <borntraeger@de.ibm.com> Acked-by: Fernando Luis Vazquez Cao <fernando@oss.ntt.co.jp>
f | gpio-fan.h | s | 802B | 31 | Simon Guinot | sguinot@lacie.com | 1288041097 |  | hwmon: add generic GPIO fan driver  This patch adds hwmon support for fans connected to GPIO lines.  Platform specific information such as GPIO pinout and speed conversion array (rpm from/to GPIO value) are passed to the driver via platform_data.  Signed-off-by: Simon Guinot <sguinot@lacie.com> Signed-off-by: Guenter Roeck <guenter.roeck@ericsson.com>
f | scx200.h | s | 1.8K | 37 | Jim Cromie | jim.cromie@gmail.com | 1159973714 |  | [PATCH] scx200_hrt: fix precedence bug manifesting as 27x clock in 1 MHz mode  Fix paren-placement / precedence bug breaking initialization for 1 MHz clock mode.  Also fix comment spelling error, and fence-post (off-by-one) error on symbol used in request_region.  Addresses http://bugzilla.kernel.org/show_bug.cgi?id=7242  Thanks alexander.krause@erazor-zone.de, dzpost@dedekind.net, for the reports and patch test, and phelps@mantara.com for the independent patch and verification.  Signed-off-by:  Jim Cromie <jim.cromie@gmail.com> Cc: <alexander.krause@erazor-zone.de> Cc: <dzpost@dedekind.net> Cc: <phelps@mantara.com> Acked-by: John Stultz <johnstul@us.ibm.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
f | sched.h | s | 82K | 2388 | Linus Torvalds | torvalds@linux-foundation.org | 1339192769 |  | Merge branch 'sched-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip  Pull scheduler fixes from Ingo Molnar.  * 'sched-urgent-for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/tip/tip:   sched: Fix the relax_domain_level boot parameter   sched: Validate assumptions in sched_init_numa()   sched: Always initialize cpu-power   sched: Fix domain iteration   sched/rt: Fix lockdep annotation within find_lock_lowest_rq()   sched/numa: Load balance between remote nodes   sched/x86: Calculate booted cores after construction of sibling_mask
f | signal.h | s | 11K | 338 | Al Viro | viro@zeniv.linux.org.uk | 1338569932 |  | new helper: signal_delivered()  Does block_sigmask() + tracehook_signal_handler();  called when sigframe has been successfully built.  All architectures converted to it; block_sigmask() itself is gone now (merged into this one).  I'm still not too happy with the signature, but that's a separate story (IMO we need a structure that would contain signal number + siginfo + k_sigaction, so that get_signal_to_deliver() would fill one, signal_delivered(), handle_signal() and probably setup...frame() - take one).  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | v4l2-mediabus.h | s | 4.0K | 105 | Sylwester Nawrocki | s.nawrocki@samsung.com | 1305901729 |  | [media] v4l: Add V4L2_MBUS_FMT_JPEG_1X8 media bus format  Add V4L2_MBUS_FMT_JPEG_1X8 format and the corresponding Docbook documentation.  Signed-off-by: Sylwester Nawrocki <s.nawrocki@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
f | eventfd.h | s | 2.1K | 66 | Sha Zhengju | handai.szj@taobao.com | 1338511772 |  | eventfd: change int to __u64 in eventfd_signal()  eventfd_ctx->count is an __u64 counter which is allowed to reach ULLONG_MAX.  eventfd_write() adds a __u64 value to "count", but the kernel side eventfd_signal() only adds an int value to it.  Make them consistent.  [akpm@linux-foundation.org: update interface documentation] Signed-off-by: Sha Zhengju <handai.szj@taobao.com> Cc: Davide Libenzi <davidel@xmailserver.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mISDNhw.h | s | 5.8K | 187 | Karsten Keil | kkeil@linux-pingi.de | 1337196276 |  | mISDN: Implement MISDN_CTRL_RX_OFF for more drivers  MISDN_CTRL_RX_OFF is a meachanism to discard RX data in the driver if the data is not needed by the application. It can be used when playing mesages, but not recording or with unidirectional protocols.  Signed-off-by: Karsten Keil <kkeil@linux-pingi.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | kobject.h | s | 7.1K | 199 | Kay Sievers | kay.sievers@vrfy.org | 1324509234 |  | kobject: remove kset_find_obj_hinted()  Now that there are no in-kernel users of this function, remove it as it is no longer needed.  Signed-off-by: Kay Sievers <kay.sievers@vrfy.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | fdreg.h | s | 5.2K | 119 | Justin P. Mattock | justinmattock@gmail.com | 1287392594 |  | Update broken web addresses in the kernel.  The patch below updates broken web addresses in the kernel  Signed-off-by: Justin P. Mattock <justinmattock@gmail.com> Cc: Maciej W. Rozycki <macro@linux-mips.org> Cc: Geert Uytterhoeven <geert@linux-m68k.org> Cc: Finn Thain <fthain@telegraphics.com.au> Cc: Randy Dunlap <rdunlap@xenotime.net> Cc: Matt Turner <mattst88@gmail.com> Cc: Dimitry Torokhov <dmitry.torokhov@gmail.com> Cc: Mike Frysinger <vapier.adi@gmail.com> Acked-by: Ben Pfaff <blp@cs.stanford.edu> Acked-by: Hans J. Koch <hjk@linutronix.de> Reviewed-by: Finn Thain <fthain@telegraphics.com.au> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | nwpserial.h | s | 551B | 16 | Benjamin Krill | ben@codiert.org | 1231392318 |  | serial: Add driver for the Cell Network Processor serial port NWP device  Add support for the nwp serial device which is connected to a DCR bus. It uses the of_serial device driver to determine necessary properties from the device tree.  The supported device is added as serial port number 85.  NWP stands for network processor and it is part of the QPACE - Quantum Chromodynamics Parallel Computing on the Cell Broadband Engine project. The implementation is a lightweight uart implementation with the focus to consume as little resources as possible and it is connected to a DCR bus.  Signed-off-by: Benjamin Krill <ben@codiert.org> Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>
f | ncp.h | s | 5.0K | 179 | Changli Gao | xiaosuo@gmail.com | 1282536939 |  | header: fix broken headers for user space  __packed is only defined in kernel space, so we should use __attribute__((packed)) for the code shared between kernel and user space.  Two __attribute() annotations are replaced with __attribute__() too.  Signed-off-by: Changli Gao <xiaosuo@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ramfs.h | s | 880B | 20 | Al Viro | viro@zeniv.linux.org.uk | 1325649307 |  | pohmelfs: propagate umode_t  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
f | dlm_netlink.h | s | 1.0K | 47 | Arnd Bergmann | arnd@arndb.de | 1238087655 |  | make most exported headers use strict integer types  This takes care of all files that have only a small number of non-strict integer type uses.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Cc: Mauro Carvalho Chehab <mchehab@redhat.com> Cc: David Airlie <airlied@linux.ie> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Cc: netdev@vger.kernel.org Cc: linux-ppp@vger.kernel.org Cc: Jaroslav Kysela <perex@perex.cz> Cc: Takashi Iwai <tiwai@suse.de> Cc: David Woodhouse <dwmw2@infradead.org> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Signed-off-by: Ingo Molnar <mingo@elte.hu>
f | ip.h | s | 3.8K | 129 | Arnaldo Carvalho de Melo | acme@redhat.com | 1177565131 |  | [SK_BUFF]: Introduce skb_transport_header(skb)  For the places where we need a pointer to the transport header, it is still legal to touch skb->h.raw directly if just adding to, subtracting from or setting it to another layer header.  Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | mman.h | s | 2.2K | 78 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | mbus.h | s | 1.1K | 43 | Andrew Lunn | andrew@lunn.ch | 1323820015 |  | ARM: Orion: Get address map from plat-orion instead of via platform_data  Use an getter function in plat-orion/addr-map.c to get the address map structure, rather than pass it to drivers in the platform_data structures. When the drivers are built for none orion platforms, a dummy function is provided instead which returns NULL.  Signed-off-by: Andrew Lunn <andrew@lunn.ch> Tested-by: Michael Walle <michael@walle.cc> Acked-by: Nicolas Pitre <nico@linaro.org> Signed-off-by: Nicolas Pitre <nico@fluxnic.net>
f | atmel_pwm.h | s | 2.7K | 60 | David Brownell | david-b@pacbell.net | 1202491358 |  | Basic PWM driver for AVR32 and AT91  PWM device setup, and a simple PWM driver exposing a programming interface giving access to each channel's full capabilities.  Note that this doesn't support starting several channels in synch.  [hskinnemoen@atmel.com: allocate platform device dynamically] [hskinnemoen@atmel.com: Kconfig fix] Signed-off-by: David Brownell <dbrownell@users.sourceforge.net> Signed-off-by: Haavard Skinnemoen <hskinnemoen@atmel.com> Cc: Andrew Victor <linux@maxim.org.za> Cc: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | bpqether.h | s | 952B | 33 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | cred.h | s | 11K | 353 | Oleg Nesterov | oleg@redhat.com | 1338511768 |  | cred: remove task_is_dead() from __task_cred() validation  Commit 8f92054e7ca1 ("CRED: Fix __task_cred()'s lockdep check and banner comment"):      add the following validation condition:          task->exit_state >= 0      to permit the access if the target task is dead and therefore     unable to change its own credentials.  OK, but afaics currently this can only help wait_task_zombie() which calls __task_cred() without rcu lock.  Remove this validation and change wait_task_zombie() to use task_uid() instead.  This means we do rcu_read_lock() only to shut up the lockdep, but we already do the same in, say, wait_task_stopped().  task_is_dead() should die, task->exit_state != 0 means that this task has passed exit_notify(), only do_wait-like code paths should use this.  Unfortunately, we can't kill task_is_dead() right now, it has already acquired buggy users in drivers/staging.  The fix already exists.  Signed-off-by: Oleg Nesterov <oleg@redhat.com> Reviewed-by: "Eric W. Biederman" <ebiederm@xmission.com> Acked-by: David Howells <dhowells@redhat.com> Cc: Jiri Olsa <jolsa@redhat.com> Cc: Paul E. McKenney <paulmck@linux.vnet.ibm.com> Cc: James Morris <jmorris@namei.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | rtc.h | s | 9.5K | 242 | Alexander Stein | alexander.stein@systec-electronic.com | 1338333753 |  | rtc: add ioctl to get/clear battery low voltage status  Currently there is no generic way to get the RTC battery status within an application.  So add an ioctl to read the status bit.  The idea is that the bit is set once a low voltage is detected.  It stays there until it is reset using the RTC_VL_CLR ioctl.  Signed-off-by: Alexander Stein <alexander.stein@systec-electronic.com> Cc: Alessandro Zummo <a.zummo@towertech.it> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | rational.h | s | 600B | 16 | Oskar Schirmer | oskar@scara.com | 1337260717 |  | lib: Change mail address of Oskar Schirmer  That old mail address doesnt exist any more. This changes all occurences to my new address.  Signed-off-by: Oskar Schirmer <oskar@scara.com> Cc: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | rtc-v3020.h | s | 1.0K | 35 | Bill Pemberton | wfp5p@virginia.edu | 1273565387 |  | rtc-v3020: make bitfield unsigned  Fix sparse warning:  include/linux/rtc-v3020.h:18:23: error: dubious one-bit signed bitfield  Signed-off-by: Bill Pemberton <wfp5p@virginia.edu> CC: p_gortmaker@yahoo.com Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | unix_diag.h | s | 1.0K | 44 | Pavel Emelyanov | xemul@parallels.com | 1325281562 |  | unix_diag: Fixup RQLEN extension report  While it's not too late fix the recently added RQLEN diag extension to report rqlen and wqlen in the same way as TCP does.  I.e. for listening sockets the ack backlog length (which is the input queue length for socket) in rqlen and the max ack backlog length in wqlen, and what the CINQ/OUTQ ioctls do for established.  Signed-off-by: Pavel Emelyanov <xemul@parallels.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | of_net.h | s | 340B | 13 | Shawn Guo | shawn.guo@linaro.org | 1311730256 |  | dt/net: add helper function of_get_phy_mode  It adds the helper function of_get_phy_mode getting phy interface from device tree.  Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Cc: Grant Likely <grant.likely@secretlab.ca> Acked-by: Grant Likely <grant.likely@secretlab.ca> Acked-by: David Miller <davem@davemloft.net>
f | ctype.h | s | 1.6K | 53 | Andy Shevchenko | andriy.shevchenko@linux.intel.com | 1311652636 |  | lib: make _tolower() public  This function is required by *printf and kstrto* functions that are located in the different modules.  This patch makes _tolower() public. However, it's good idea to not use the helper outside of mentioned functions.  [akpm@linux-foundation.org: coding-style fixes] Signed-off-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com> Acked-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | slob_def.h | s | 924B | 30 | Christoph Lameter | cl@linux.com | 1308242420 |  | slab, slub, slob: Unify alignment definition  Every slab has its on alignment definition in include/linux/sl?b_def.h. Extract those and define a common set in include/linux/slab.h.  SLOB: As notes sometimes we need double word alignment on 32 bit. This gives all structures allocated by SLOB a unsigned long long alignment like the others do.  SLAB: If ARCH_SLAB_MINALIGN is not set SLAB would set ARCH_SLAB_MINALIGN to zero meaning no alignment at all. Give it the default unsigned long long alignment.  Signed-off-by: Christoph Lameter <cl@linux.com> Signed-off-by: Pekka Enberg <penberg@kernel.org>
f | davinci_emac.h | s | 1.1K | 43 | Sriram | srk@ti.com | 1300847105 |  | net: davinci_emac:Fix translation logic for buffer descriptor  With recent changes to the driver(switch to new cpdma layer), the support for buffer descriptor address translation logic is broken. This affects platforms where the physical address of the descriptors as seen by the DMA engine is different from the physical address.  Original Patch adding translation logic support: Commit: ad021ae8862209864dc8ebd3b7d3a55ce84b9ea2  Signed-off-by: Sriramakrishnan A G <srk@ti.com> Tested-By: Sekhar Nori <nsekhar@ti.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | if_tun.h | s | 3.4K | 97 | Michael S. Tsirkin | mst@redhat.com | 1272879193 |  | tun: add ioctl to modify vnet header size  virtio added mergeable buffers mode where 2 bytes of extra info is put after vnet header but before actual data (tun does not need this data). In hindsight, it would have been better to add the new info *before* the packet: as it is, users need a lot of tricky code to skip the extra 2 bytes in the middle of the iovec, and in fact applications seem to get it wrong, and only work with specific iovec layout.  The fact we might need to split iovec also means we might in theory overflow iovec max size.  This patch adds a simpler way for applications to handle this, and future proofs the interface against further extensions, by making the size of the virtio net header configurable from userspace. As a result, tun driver will simply skip the extra 2 bytes on both input and output.  Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Acked-by: David S. Miller <davem@davemloft.net>
f | a.out.h | s | 7.3K | 240 | David Woodhouse | dwmw2@infradead.org | 1213636858 |  | Remove #ifdef CONFIG_ARCH_SUPPORTS_AOUT from <linux/a.out.h>  This file is only included where it makes sense now, so there's no need for the CONFIG_ARCH_SUPPORTS_AOUT conditional -- and that conditional is bad, because we want to export <linux/a.out.h> to userspace.  Signed-off-by: David Woodhouse <dwmw2@infradead.org> Acked-by: Peter Korsgaard <jacmet@sunsite.dk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | in_route.h | s | 873B | 24 | Thomas Graf | tgraf@suug.ch | 1212536161 |  | route: Mark unused route cache flags as such.  Also removes an obsolete check for the unused flag RTCF_MASQ.  Signed-off-by: Thomas Graf <tgraf@suug.ch> Signed-off-by: David S. Miller <davem@davemloft.net>
f | kgdb.h | s | 10K | 276 | Jason Wessel | jason.wessel@windriver.com | 1333060885 |  | x86,kgdb: Fix DEBUG_RODATA limitation using text_poke()  There has long been a limitation using software breakpoints with a kernel compiled with CONFIG_DEBUG_RODATA going back to 2.6.26. For this particular patch, it will apply cleanly and has been tested all the way back to 2.6.36.  The kprobes code uses the text_poke() function which accommodates writing a breakpoint into a read-only page.  The x86 kgdb code can solve the problem similarly by overriding the default breakpoint set/remove routines and using text_poke() directly.  The x86 kgdb code will first attempt to use the traditional probe_kernel_write(), and next try using a the text_poke() function. The break point install method is tracked such that the correct break point removal routine will get called later on.  Cc: x86@kernel.org Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Ingo Molnar <mingo@redhat.com> Cc: H. Peter Anvin <hpa@zytor.com> Cc: stable@vger.kernel.org # >= 2.6.36 Inspried-by: Masami Hiramatsu <masami.hiramatsu.pt@hitachi.com> Signed-off-by: Jason Wessel <jason.wessel@windriver.com>
f | fanotify.h | s | 3.5K | 96 | Alexey Zaytsev | alexey.zaytsev@gmail.com | 1292439393 |  | fanotify: split version into version and metadata_len  To implement per event type optional headers we are interested in knowing how long the metadata structure is.  This patch slits the __u32 version field into a __u8 version and a __u16 metadata_len field (with __u8 left over).  This should allow for backwards compat ABI.  Signed-off-by: Alexey Zaytsev <alexey.zaytsev@gmail.com> [rewrote descrtion and changed object sizes and ordering - eparis] Signed-off-by: Eric Paris <eparis@redhat.com>
f | ata_platform.h | s | 842B | 29 | Andrew Lunn | andrew@lunn.ch | 1323820016 |  | ARM: Orion: Remove address map info from all platform data structures  Signed-off-by: Andrew Lunn <andrew@lunn.ch> Tested-by: Michael Walle <michael@walle.cc> Acked-by: Nicolas Pitre <nico@linaro.org> Signed-off-by: Nicolas Pitre <nico@fluxnic.net>
f | atmsap.h | s | 4.8K | 129 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | iommu.h | s | 6.3K | 178 | Ohad Ben-Cohen | ohad@wizery.com | 1337702888 |  | iommu/core: pass a user-provided token to fault handlers  Sometimes a single IOMMU user may have to deal with several different IOMMU devices (e.g. remoteproc).  When an IOMMU fault happens, such users have to regain their context in order to deal with the fault.  Users can't use the private fields of neither the iommu_domain nor the IOMMU device, because those are already used by the IOMMU core and low level driver (respectively).  This patch just simply allows users to pass a private token (most notably their own context pointer) to iommu_set_fault_handler(), and then makes sure it is provided back to the users whenever an IOMMU fault happens.  The patch also adopts remoteproc to the new fault handling interface, but the real functionality using this (recovery of remote processors) will only be added later in a subsequent patch set.  Cc: Fernando Guzman Lugo <fernando.lugo@ti.com> Signed-off-by: Ohad Ben-Cohen <ohad@wizery.com> Signed-off-by: Joerg Roedel <joerg.roedel@amd.com>
f | cnt32_to_63.h | s | 3.6K | 101 | David Howells | dhowells@redhat.com | 1332955803 |  | Remove all #inclusions of asm/system.h  Remove all #inclusions of asm/system.h preparatory to splitting and killing it.  Performed with the following command:  perl -p -i -e 's!^#\s*include\s*<asm/system[.]h>.*\n!!' `grep -Irl '^#\s*include\s*<asm/system[.]h>' *`  Signed-off-by: David Howells <dhowells@redhat.com>
f | hw_random.h | s | 1.6K | 42 | Sasha Levin | levinsasha928@gmail.com | 1306325712 |  | hwrng: fix spelling mistake in header comment  Cc: Herbert Xu <herbert@gondor.apana.org.au> Cc: Matt Mackall <mpm@selenic.com> Signed-off-by: Sasha Levin <levinsasha928@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | nfsacl.h | s | 1.5K | 48 | Chuck Lever | chuck.lever@oracle.com | 1295987087 |  | NFS: nfsacl_{encode,decode} should return signed integer  Clean up.  The nfsacl_encode() and nfsacl_decode() functions return negative errno values, and each call site verifies that the returned value is not negative.  Change the synopsis of both of these functions to reflect this usage.  Document the synopsis and return values.  Reported-by: Trond Myklebust <trond.myklebust@netapp.com> Signed-off-by: Chuck Lever <chuck.lever@oracle.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
f | lsm_audit.h | s | 2.2K | 91 | Eric Paris | eparis@redhat.com | 1333988584 |  | LSM: do not initialize common_audit_data to 0  It isn't needed.  If you don't set the type of the data associated with that type it is a pretty obvious programming bug.  So why waste the cycles?  Signed-off-by: Eric Paris <eparis@redhat.com>
f | cdrom.h | s | 35K | 1092 | Linus Torvalds | torvalds@linux-foundation.org | 1332610897 |  | 
f | rwlock_api_smp.h | s | 7.7K | 238 | Thomas Gleixner | tglx@linutronix.de | 1260831333 |  | locking: Cleanup the name space completely  Make the name space hierarchy of locking functions consistent:      raw_spin* -> _raw_spin* -> __raw_spin*  No functional change.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: Peter Zijlstra <peterz@infradead.org> Acked-by: Ingo Molnar <mingo@elte.hu>
f | sockios.h | s | 5.8K | 121 | Mario Schuknecht | m.schuknecht@dresearch.de | 1299708489 |  | tcp: ioctl type SIOCOUTQNSD returns amount of data not sent  In contrast to SIOCOUTQ which returns the amount of data sent but not yet acknowledged plus data not yet sent this patch only returns the data not sent.  For various methods of live streaming bitrate control it may be helpful to know how much data are in the tcp outqueue are not sent yet.  Signed-off-by: Mario Schuknecht <m.schuknecht@dresearch.de> Signed-off-by: Steffen Sledz <sledz@dresearch.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | intel_mid_dma.h | s | 2.4K | 69 | Koul, Vinod | vinod.koul@intel.com | 1286489024 |  | intel_mid_dma: change the slave interface  In 2.6.36 kernel, dma slave control command was introduced, this patch changes the intel-mid-dma driver to this new kernel slave interface  Signed-off-by: Vinod Koul <vinod.koul@intel.com> Signed-off-by: Dan Williams <dan.j.williams@intel.com>
f | sctp.h | s | 22K | 617 | Eric Dumazet | eric.dumazet@gmail.com | 1275560512 |  | net: use __packed annotation  cleanup patch.  Use new __packed annotation in net/ and include/ (except netfilter)  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | of_mdio.h | s | 837B | 22 | David Daney | david.daney@cavium.com | 1336445889 |  | netdev/of/phy: New function: of_mdio_find_bus().  Add of_mdio_find_bus() which allows an mii_bus to be located given its associated the device tree node.  This is needed by the follow-on patch to add a driver for MDIO bus multiplexers.  The of_mdiobus_register() function is modified so that the device tree node is recorded in the mii_bus.  Then we can find it again by iterating over all mdio_bus_class devices.  Because the OF device tree has now become an integral part of the kernel, this can live in mdio_bus.c (which contains the needed mdio_bus_class structure) instead of of_mdio.c.  Signed-off-by: David Daney <david.daney@cavium.com> Cc: Grant Likely <grant.likely@secretlab.ca> Cc: "David S. Miller" <davem@davemloft.net> Signed-off-by: David S. Miller <davem@davemloft.net>
f | ppp_defs.h | s | 5.0K | 132 | Paul Mackerras | paulus@samba.org | 1330911698 |  | ppp: Change copyright notices from ANU to me  This changes the copyright notices on the PPP code that I developed in the late 1990s from being copyright The Australian National University to copyright Paul Mackerras.  I can do this as I have an acknowledgement in writing from the Head of the Computer Science Department at ANU (where I worked then) that ANU does not claim any intellectual property in this code.  While I'm at it, change the copyright notice from BSD-style to GNU GPL like the rest of the kernel.  Signed-off-by: Paul Mackerras <paulus@samba.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | spinlock.h | s | 10K | 333 | Linus Torvalds | torvalds@linux-foundation.org | 1332975501 |  | 
f | ipv6.h | s | 11K | 462 | Jiri Benc | jbenc@redhat.com | 1329112001 |  | net: implement IP_RECVTOS for IP_PKTOPTIONS  Currently, it is not easily possible to get TOS/DSCP value of packets from an incoming TCP stream. The mechanism is there, IP_PKTOPTIONS getsockopt with IP_RECVTOS set, the same way as incoming TTL can be queried. This is not actually implemented for TOS, though.  This patch adds this functionality, both for IPv4 (IP_PKTOPTIONS) and IPv6 (IPV6_2292PKTOPTIONS). For IPv4, like in the IP_RECVTTL case, the value of the TOS field is stored from the other party's ACK.  This is needed for proxies which require DSCP transparency. One such example is at http://zph.bratcheda.org/.  Signed-off-by: Jiri Benc <jbenc@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | llist.h | s | 6.2K | 170 | David Howells | dhowells@redhat.com | 1332955803 |  | Add #includes needed to permit the removal of asm/system.h  asm/system.h is a cause of circular dependency problems because it contains commonly used primitive stuff like barrier definitions and uncommonly used stuff like switch_to() that might require MMU definitions.  asm/system.h has been disintegrated by this point on all arches into the following common segments:   (1) asm/barrier.h       Moved memory barrier definitions here.   (2) asm/cmpxchg.h       Moved xchg() and cmpxchg() here.  #included in asm/atomic.h.   (3) asm/bug.h       Moved die() and similar here.   (4) asm/exec.h       Moved arch_align_stack() here.   (5) asm/elf.h       Moved AT_VECTOR_SIZE_ARCH here.   (6) asm/switch_to.h       Moved switch_to() here.  Signed-off-by: David Howells <dhowells@redhat.com>
f | atmarp.h | s | 1.2K | 29 | David S. Miller | davem@sunset.davemloft.net | 1170979269 |  | [ATM]: atmarp.h needs to always include linux/types.h  To provide the __be* types, even for userspace includes.  Reported by Andrew Walrond.  Signed-off-by: David S. Miller <davem@davemloft.net>
f | pagevec.h | s | 2.2K | 81 | Hugh Dickins | hughd@google.com | 1326427990 |  | mm: fewer underscores in ____pagevec_lru_add  What's so special about ____pagevec_lru_add() that it needs four leading underscores?  Nothing, it just helped to distinguish from __pagevec_lru_add() in 2.6.28 development.  Cut two leading underscores.  Signed-off-by: Hugh Dickins <hughd@google.com> Reviewed-by: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | dw_apb_timer.h | s | 1.8K | 48 | Jamie Iles | jamie@jamieiles.com | 1317758898 |  | dw_apb_timer: constify clocksource name  The clocksource name should be const for correctness.  Cc: John Stultz <johnstul@us.ibm.com> Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: John Stultz <john.stultz@linaro.org>
f | leds-lp5523.h | s | 1.3K | 42 | Samu Onkalo | samu.p.onkalo@nokia.com | 1294934585 |  | leds: leds-lp5523: modify the way of setting led device name  Currently all leds channels begins with string lp5523.  Patch adds a possibility to provide name via platform data.  This makes it possible to have several chips without overlapping sysfs names.  Signed-off-by: Samu Onkalo <samu.p.onkalo@nokia.com> Cc: Arun Murthy <arun.murthy@stericsson.com> Cc: Ilkka Koskinen <ilkka.koskinen@nokia.com> Cc: Richard Purdie <rpurdie@rpsys.net> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | lru_cache.h | s | 11K | 240 | Lars Ellenberg | lars.ellenberg@linbit.com | 1306224097 |  | lru_cache.h: fix comments referring to ts_ instead of lc_  For some time we contemplated calling the "struct lru_cache" a "struct tracked_set", and some comments kept the ts_ prefix.  Fix those to match the member field names.  Signed-off-by: Philipp Reisner <philipp.reisner@linbit.com> Signed-off-by: Lars Ellenberg <lars.ellenberg@linbit.com>
f | task_io_accounting_ops.h | s | 2.5K | 94 | Andrea Righi | righi.andrea@gmail.com | 1217200348 |  | task IO accounting: move all IO statistics in struct task_io_accounting  Simplify the code of include/linux/task_io_accounting.h.  It is also more reasonable to have all the task i/o-related statistics in a single struct (task_io_accounting).  Signed-off-by: Andrea Righi <righi.andrea@gmail.com> Signed-off-by: Oleg Nesterov <oleg@tv-sign.ru> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
