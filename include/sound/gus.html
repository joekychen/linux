<!DOCTYPE html>
<html><head><title>joekychen/linux » include › sound › gus.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>gus.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __SOUND_GUS_H</span>
<span class="cp">#define __SOUND_GUS_H</span>

<span class="cm">/*</span>
<span class="cm"> *  Global structures used for GUS part of ALSA driver</span>
<span class="cm"> *  Copyright (c) by Jaroslav Kysela &lt;perex@perex.cz&gt;</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *   it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *   the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *   (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is distributed in the hope that it will be useful,</span>
<span class="cm"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *   GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *   You should have received a copy of the GNU General Public License</span>
<span class="cm"> *   along with this program; if not, write to the Free Software</span>
<span class="cm"> *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &quot;pcm.h&quot;</span>
<span class="cp">#include &quot;rawmidi.h&quot;</span>
<span class="cp">#include &quot;timer.h&quot;</span>
<span class="cp">#include &quot;seq_midi_emul.h&quot;</span>
<span class="cp">#include &quot;seq_device.h&quot;</span>
<span class="cp">#include &lt;asm/io.h&gt;</span>

<span class="cm">/* IO ports */</span>

<span class="cp">#define GUSP(gus, x)			((gus)-&gt;gf1.port + SNDRV_g_u_s_##x)</span>

<span class="cp">#define SNDRV_g_u_s_MIDICTRL		(0x320-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_MIDISTAT		(0x320-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_MIDIDATA		(0x321-0x220)</span>

<span class="cp">#define SNDRV_g_u_s_GF1PAGE		(0x322-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_GF1REGSEL		(0x323-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_GF1DATALOW		(0x324-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_GF1DATAHIGH		(0x325-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_IRQSTAT		(0x226-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_TIMERCNTRL		(0x228-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_TIMERDATA		(0x229-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_DRAM		(0x327-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_MIXCNTRLREG		(0x220-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_IRQDMACNTRLREG	(0x22b-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_REGCNTRLS		(0x22f-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_BOARDVERSION	(0x726-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_MIXCNTRLPORT	(0x726-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_IVER		(0x325-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_MIXDATAPORT		(0x326-0x220)</span>
<span class="cp">#define SNDRV_g_u_s_MAXCNTRLPORT	(0x326-0x220)</span>

<span class="cm">/* GF1 registers */</span>

<span class="cm">/* global registers */</span>
<span class="cp">#define SNDRV_GF1_GB_ACTIVE_VOICES		0x0e</span>
<span class="cp">#define SNDRV_GF1_GB_VOICES_IRQ			0x0f</span>
<span class="cp">#define SNDRV_GF1_GB_GLOBAL_MODE		0x19</span>
<span class="cp">#define SNDRV_GF1_GW_LFO_BASE			0x1a</span>
<span class="cp">#define SNDRV_GF1_GB_VOICES_IRQ_READ		0x1f</span>
<span class="cp">#define SNDRV_GF1_GB_DRAM_DMA_CONTROL		0x41</span>
<span class="cp">#define SNDRV_GF1_GW_DRAM_DMA_LOW		0x42</span>
<span class="cp">#define SNDRV_GF1_GW_DRAM_IO_LOW		0x43</span>
<span class="cp">#define SNDRV_GF1_GB_DRAM_IO_HIGH		0x44</span>
<span class="cp">#define SNDRV_GF1_GB_SOUND_BLASTER_CONTROL	0x45</span>
<span class="cp">#define SNDRV_GF1_GB_ADLIB_TIMER_1		0x46</span>
<span class="cp">#define SNDRV_GF1_GB_ADLIB_TIMER_2		0x47</span>
<span class="cp">#define SNDRV_GF1_GB_RECORD_RATE		0x48</span>
<span class="cp">#define SNDRV_GF1_GB_REC_DMA_CONTROL		0x49</span>
<span class="cp">#define SNDRV_GF1_GB_JOYSTICK_DAC_LEVEL		0x4b</span>
<span class="cp">#define SNDRV_GF1_GB_RESET			0x4c</span>
<span class="cp">#define SNDRV_GF1_GB_DRAM_DMA_HIGH		0x50</span>
<span class="cp">#define SNDRV_GF1_GW_DRAM_IO16			0x51</span>
<span class="cp">#define SNDRV_GF1_GW_MEMORY_CONFIG		0x52</span>
<span class="cp">#define SNDRV_GF1_GB_MEMORY_CONTROL		0x53</span>
<span class="cp">#define SNDRV_GF1_GW_FIFO_RECORD_BASE_ADDR	0x54</span>
<span class="cp">#define SNDRV_GF1_GW_FIFO_PLAY_BASE_ADDR	0x55</span>
<span class="cp">#define SNDRV_GF1_GW_FIFO_SIZE			0x56</span>
<span class="cp">#define SNDRV_GF1_GW_INTERLEAVE			0x57</span>
<span class="cp">#define SNDRV_GF1_GB_COMPATIBILITY		0x59</span>
<span class="cp">#define SNDRV_GF1_GB_DECODE_CONTROL		0x5a</span>
<span class="cp">#define SNDRV_GF1_GB_VERSION_NUMBER		0x5b</span>
<span class="cp">#define SNDRV_GF1_GB_MPU401_CONTROL_A		0x5c</span>
<span class="cp">#define SNDRV_GF1_GB_MPU401_CONTROL_B		0x5d</span>
<span class="cp">#define SNDRV_GF1_GB_EMULATION_IRQ		0x60</span>
<span class="cm">/* voice specific registers */</span>
<span class="cp">#define SNDRV_GF1_VB_ADDRESS_CONTROL		0x00</span>
<span class="cp">#define SNDRV_GF1_VW_FREQUENCY			0x01</span>
<span class="cp">#define SNDRV_GF1_VW_START_HIGH			0x02</span>
<span class="cp">#define SNDRV_GF1_VW_START_LOW			0x03</span>
<span class="cp">#define SNDRV_GF1_VA_START			SNDRV_GF1_VW_START_HIGH</span>
<span class="cp">#define SNDRV_GF1_VW_END_HIGH			0x04</span>
<span class="cp">#define SNDRV_GF1_VW_END_LOW			0x05</span>
<span class="cp">#define SNDRV_GF1_VA_END			SNDRV_GF1_VW_END_HIGH</span>
<span class="cp">#define SNDRV_GF1_VB_VOLUME_RATE		0x06</span>
<span class="cp">#define SNDRV_GF1_VB_VOLUME_START		0x07</span>
<span class="cp">#define SNDRV_GF1_VB_VOLUME_END			0x08</span>
<span class="cp">#define SNDRV_GF1_VW_VOLUME			0x09</span>
<span class="cp">#define SNDRV_GF1_VW_CURRENT_HIGH		0x0a</span>
<span class="cp">#define SNDRV_GF1_VW_CURRENT_LOW		0x0b</span>
<span class="cp">#define SNDRV_GF1_VA_CURRENT			SNDRV_GF1_VW_CURRENT_HIGH</span>
<span class="cp">#define SNDRV_GF1_VB_PAN			0x0c</span>
<span class="cp">#define SNDRV_GF1_VW_OFFSET_RIGHT		0x0c</span>
<span class="cp">#define SNDRV_GF1_VB_VOLUME_CONTROL		0x0d</span>
<span class="cp">#define SNDRV_GF1_VB_UPPER_ADDRESS		0x10</span>
<span class="cp">#define SNDRV_GF1_VW_EFFECT_HIGH		0x11</span>
<span class="cp">#define SNDRV_GF1_VW_EFFECT_LOW			0x12</span>
<span class="cp">#define SNDRV_GF1_VA_EFFECT			SNDRV_GF1_VW_EFFECT_HIGH</span>
<span class="cp">#define SNDRV_GF1_VW_OFFSET_LEFT		0x13</span>
<span class="cp">#define SNDRV_GF1_VB_ACCUMULATOR		0x14</span>
<span class="cp">#define SNDRV_GF1_VB_MODE			0x15</span>
<span class="cp">#define SNDRV_GF1_VW_EFFECT_VOLUME		0x16</span>
<span class="cp">#define SNDRV_GF1_VB_FREQUENCY_LFO		0x17</span>
<span class="cp">#define SNDRV_GF1_VB_VOLUME_LFO			0x18</span>
<span class="cp">#define SNDRV_GF1_VW_OFFSET_RIGHT_FINAL		0x1b</span>
<span class="cp">#define SNDRV_GF1_VW_OFFSET_LEFT_FINAL		0x1c</span>
<span class="cp">#define SNDRV_GF1_VW_EFFECT_VOLUME_FINAL	0x1d</span>

<span class="cm">/* ICS registers */</span>

<span class="cp">#define SNDRV_ICS_MIC_DEV		0</span>
<span class="cp">#define SNDRV_ICS_LINE_DEV		1</span>
<span class="cp">#define SNDRV_ICS_CD_DEV		2</span>
<span class="cp">#define SNDRV_ICS_GF1_DEV		3</span>
<span class="cp">#define SNDRV_ICS_NONE_DEV		4</span>
<span class="cp">#define SNDRV_ICS_MASTER_DEV		5</span>

<span class="cm">/* LFO */</span>

<span class="cp">#define SNDRV_LFO_TREMOLO		0</span>
<span class="cp">#define SNDRV_LFO_VIBRATO		1</span>

<span class="cm">/* misc */</span>

<span class="cp">#define SNDRV_GF1_DMA_UNSIGNED	0x80</span>
<span class="cp">#define SNDRV_GF1_DMA_16BIT	0x40</span>
<span class="cp">#define SNDRV_GF1_DMA_IRQ	0x20</span>
<span class="cp">#define SNDRV_GF1_DMA_WIDTH16	0x04</span>
<span class="cp">#define SNDRV_GF1_DMA_READ	0x02	</span><span class="cm">/* read from GUS&#39;s DRAM */</span><span class="cp"></span>
<span class="cp">#define SNDRV_GF1_DMA_ENABLE	0x01</span>

<span class="cm">/* ramp ranges */</span>

<span class="cp">#define SNDRV_GF1_ATTEN(x)	(snd_gf1_atten_table[x])</span>
<span class="cp">#define SNDRV_GF1_MIN_VOLUME	1800</span>
<span class="cp">#define SNDRV_GF1_MAX_VOLUME	4095</span>
<span class="cp">#define SNDRV_GF1_MIN_OFFSET	(SNDRV_GF1_MIN_VOLUME&gt;&gt;4)</span>
<span class="cp">#define SNDRV_GF1_MAX_OFFSET	255</span>
<span class="cp">#define SNDRV_GF1_MAX_TDEPTH	90</span>

<span class="cm">/* defines for memory manager */</span>

<span class="cp">#define SNDRV_GF1_MEM_BLOCK_16BIT	0x0001</span>

<span class="cp">#define SNDRV_GF1_MEM_OWNER_DRIVER	0x0001</span>
<span class="cp">#define SNDRV_GF1_MEM_OWNER_WAVE_SIMPLE	0x0002</span>
<span class="cp">#define SNDRV_GF1_MEM_OWNER_WAVE_GF1	0x0003</span>
<span class="cp">#define SNDRV_GF1_MEM_OWNER_WAVE_IWFFFF	0x0004</span>

<span class="cm">/* constants for interrupt handlers */</span>

<span class="cp">#define SNDRV_GF1_HANDLER_MIDI_OUT	0x00010000</span>
<span class="cp">#define SNDRV_GF1_HANDLER_MIDI_IN	0x00020000</span>
<span class="cp">#define SNDRV_GF1_HANDLER_TIMER1	0x00040000</span>
<span class="cp">#define SNDRV_GF1_HANDLER_TIMER2	0x00080000</span>
<span class="cp">#define SNDRV_GF1_HANDLER_VOICE		0x00100000</span>
<span class="cp">#define SNDRV_GF1_HANDLER_DMA_WRITE	0x00200000</span>
<span class="cp">#define SNDRV_GF1_HANDLER_DMA_READ	0x00400000</span>
<span class="cp">#define SNDRV_GF1_HANDLER_ALL		(0xffff0000&amp;~SNDRV_GF1_HANDLER_VOICE)</span>

<span class="cm">/* constants for DMA flags */</span>

<span class="cp">#define SNDRV_GF1_DMA_TRIGGER		1</span>

<span class="cm">/* --- */</span>

<span class="k">struct</span> <span class="n">snd_gus_card</span><span class="p">;</span>

<span class="cm">/* GF1 specific structure */</span>

<span class="k">struct</span> <span class="n">snd_gf1_bank_info</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">address</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_gf1_mem_block</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">flags</span><span class="p">;</span>	<span class="cm">/* flags - SNDRV_GF1_MEM_BLOCK_XXXX */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">owner</span><span class="p">;</span>	<span class="cm">/* owner - SNDRV_GF1_MEM_OWNER_XXXX */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">share</span><span class="p">;</span>	<span class="cm">/* share count */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">share_id</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span> <span class="cm">/* share ID */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ptr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_mem_block</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_mem_block</span> <span class="o">*</span><span class="n">prev</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_gf1_mem</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_gf1_bank_info</span> <span class="n">banks_8</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">snd_gf1_bank_info</span> <span class="n">banks_16</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">snd_gf1_mem_block</span> <span class="o">*</span><span class="n">first</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_mem_block</span> <span class="o">*</span><span class="n">last</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">memory_mutex</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_gf1_dma_block</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span>		<span class="cm">/* buffer in computer&#39;s RAM */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">buf_addr</span><span class="p">;</span>	<span class="cm">/* buffer address */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">;</span>	<span class="cm">/* address in onboard memory */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">count</span><span class="p">;</span>	<span class="cm">/* count in bytes */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">;</span>	<span class="cm">/* DMA command (format) */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">ack</span><span class="p">)(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">);</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_dma_block</span> <span class="o">*</span><span class="n">next</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_gus_port</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_midi_channel_set</span> <span class="o">*</span> <span class="n">chset</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>		<span class="cm">/* operation mode */</span>
	<span class="kt">int</span> <span class="n">client</span><span class="p">;</span>		<span class="cm">/* sequencer client number */</span>
	<span class="kt">int</span> <span class="n">port</span><span class="p">;</span>		<span class="cm">/* sequencer port number */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">midi_has_voices</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_gus_voice</span><span class="p">;</span>

<span class="cp">#define SNDRV_GF1_VOICE_TYPE_PCM	0</span>
<span class="cp">#define SNDRV_GF1_VOICE_TYPE_SYNTH 	1</span>
<span class="cp">#define SNDRV_GF1_VOICE_TYPE_MIDI	2</span>

<span class="cp">#define SNDRV_GF1_VFLG_RUNNING		(1&lt;&lt;0)</span>
<span class="cp">#define SNDRV_GF1_VFLG_EFFECT_TIMER1	(1&lt;&lt;1)</span>
<span class="cp">#define SNDRV_GF1_VFLG_PAN		(1&lt;&lt;2)</span>

<span class="k">enum</span> <span class="n">snd_gus_volume_state</span> <span class="p">{</span>
	<span class="n">VENV_BEFORE</span><span class="p">,</span>
	<span class="n">VENV_ATTACK</span><span class="p">,</span>
	<span class="n">VENV_SUSTAIN</span><span class="p">,</span>
	<span class="n">VENV_RELEASE</span><span class="p">,</span>
	<span class="n">VENV_DONE</span><span class="p">,</span>
	<span class="n">VENV_VOLUME</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">number</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">use</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
	    <span class="nl">pcm:</span> <span class="mi">1</span><span class="p">,</span>
	    <span class="nl">synth:</span><span class="mi">1</span><span class="p">,</span>
	    <span class="nl">midi:</span> <span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">client</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">port</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">index</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pad</span><span class="p">;</span>
	
<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_wave</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_volume</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">handler_wave</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="o">*</span> <span class="n">voice</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">handler_volume</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="o">*</span> <span class="n">voice</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">handler_effect</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="o">*</span> <span class="n">voice</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">volume_change</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

	<span class="k">struct</span> <span class="n">snd_gus_sample_ops</span> <span class="o">*</span><span class="n">sample_ops</span><span class="p">;</span>

	<span class="cm">/* running status / registers */</span>

	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">fc_register</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">fc_lfo</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">gf1_volume</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">control</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">gf1_pan</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">effect_accumulator</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">volume_control</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">venv_value_next</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">snd_gus_volume_state</span> <span class="n">venv_state</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">snd_gus_volume_state</span> <span class="n">venv_state_prev</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">vlo</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">vro</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">gf1_effect_volume</span><span class="p">;</span>
	
	<span class="cm">/* --- */</span>

	<span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">private_free</span><span class="p">)(</span><span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="o">*</span><span class="n">voice</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_gf1</span> <span class="p">{</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">enh_mode</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>	<span class="cm">/* enhanced mode (GFA1) */</span>
		     <span class="nl">hw_lfo:</span><span class="mi">1</span><span class="p">,</span>		<span class="cm">/* use hardware LFO */</span>
		     <span class="nl">sw_lfo:</span><span class="mi">1</span><span class="p">,</span>		<span class="cm">/* use software LFO */</span>
		     <span class="nl">effect:</span><span class="mi">1</span><span class="p">;</span>		<span class="cm">/* use effect voices */</span>

	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">port</span><span class="p">;</span>		<span class="cm">/* port of GF1 chip */</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res_port1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res_port2</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">irq</span><span class="p">;</span>			<span class="cm">/* IRQ number */</span>
	<span class="kt">int</span> <span class="n">dma1</span><span class="p">;</span>			<span class="cm">/* DMA1 number */</span>
	<span class="kt">int</span> <span class="n">dma2</span><span class="p">;</span>			<span class="cm">/* DMA2 number */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">memory</span><span class="p">;</span>		<span class="cm">/* GUS&#39;s DRAM size in bytes */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rom_memory</span><span class="p">;</span>	<span class="cm">/* GUS&#39;s ROM size in bytes */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rom_present</span><span class="p">;</span>	<span class="cm">/* bitmask */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rom_banks</span><span class="p">;</span>		<span class="cm">/* GUS&#39;s ROM banks */</span>

	<span class="k">struct</span> <span class="n">snd_gf1_mem</span> <span class="n">mem_alloc</span><span class="p">;</span>

	<span class="cm">/* registers */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_page</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_regsel</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_data8</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_data16</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_irqstat</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_dram</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_timerctrl</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg_timerdata</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ics_regs</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">2</span><span class="p">];</span>
	<span class="cm">/* --------- */</span>

	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">active_voices</span><span class="p">;</span>	<span class="cm">/* active voices */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">active_voice</span><span class="p">;</span>	<span class="cm">/* selected voice (GF1PAGE register) */</span>

	<span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="n">voices</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>	<span class="cm">/* GF1 voices */</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">default_voice_address</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">playback_freq</span><span class="p">;</span>	<span class="cm">/* GF1 playback (mixing) frequency */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">mode</span><span class="p">;</span>		<span class="cm">/* see to SNDRV_GF1_MODE_XXXX */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">volume_ramp</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">smooth_pan</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">full_range_pan</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pad0</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">lfos</span><span class="p">;</span>

	<span class="cm">/* interrupt handlers */</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">interrupt_handler_midi_out</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">interrupt_handler_midi_in</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">interrupt_handler_timer1</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">interrupt_handler_timer2</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">interrupt_handler_dma_write</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">interrupt_handler_dma_read</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_midi_out</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_midi_in</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_timer1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_timer2</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_dma_write</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_dma_read</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">interrupt_stat_voice_lost</span><span class="p">;</span>
<span class="cp">#endif</span>

	<span class="cm">/* synthesizer */</span>

	<span class="kt">int</span> <span class="n">seq_client</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gus_port</span> <span class="n">seq_ports</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

	<span class="cm">/* timer */</span>

	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">timer_enabled</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_timer</span> <span class="o">*</span><span class="n">timer1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_timer</span> <span class="o">*</span><span class="n">timer2</span><span class="p">;</span>

	<span class="cm">/* midi */</span>

	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">uart_cmd</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">uart_framing</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">uart_overrun</span><span class="p">;</span>

	<span class="cm">/* dma operations */</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dma_flags</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dma_shared</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_dma_block</span> <span class="o">*</span><span class="n">dma_data_pcm</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_dma_block</span> <span class="o">*</span><span class="n">dma_data_pcm_last</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_dma_block</span> <span class="o">*</span><span class="n">dma_data_synth</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_gf1_dma_block</span> <span class="o">*</span><span class="n">dma_data_synth_last</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">dma_ack</span><span class="p">)(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">);</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">dma_private_data</span><span class="p">;</span>

	<span class="cm">/* pcm */</span>
	<span class="kt">int</span> <span class="n">pcm_channels</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">pcm_alloc_voices</span><span class="p">;</span>
        <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pcm_volume_level_left</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pcm_volume_level_right</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pcm_volume_level_left1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pcm_volume_level_right1</span><span class="p">;</span>
                                
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pcm_rcntrl_reg</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pad_end</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* main structure for GUS card */</span>

<span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span>
	 <span class="nl">initialized:</span> <span class="mi">1</span><span class="p">,</span>		<span class="cm">/* resources were initialized */</span>
	 <span class="nl">equal_irq:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* GF1 and CODEC shares IRQ (GUS MAX only) */</span>
	 <span class="nl">equal_dma:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* if dma channels are equal (not valid for daughter board) */</span>
	 <span class="nl">ics_flag:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* have we ICS mixer chip */</span>
	 <span class="nl">ics_flipped:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* ICS mixer have flipped some channels? */</span>
	 <span class="nl">codec_flag:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* have we CODEC chip? */</span>
	 <span class="nl">max_flag:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* have we GUS MAX card? */</span>
	 <span class="nl">max_ctrl_flag:</span><span class="mi">1</span><span class="p">,</span>		<span class="cm">/* have we original GUS MAX card? */</span>
	 <span class="nl">daughter_flag:</span><span class="mi">1</span><span class="p">,</span>		<span class="cm">/* have we daughter board? */</span>
	 <span class="nl">interwave:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* hey - we have InterWave card */</span>
	 <span class="nl">ess_flag:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* ESS chip found... GUS Extreme */</span>
	 <span class="nl">ace_flag:</span><span class="mi">1</span><span class="p">,</span>			<span class="cm">/* GUS ACE detected */</span>
	 <span class="nl">uart_enable:</span><span class="mi">1</span><span class="p">;</span>			<span class="cm">/* enable MIDI UART */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">revision</span><span class="p">;</span>	<span class="cm">/* revision of chip */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">max_cntrl_val</span><span class="p">;</span>	<span class="cm">/* GUS MAX control value */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">mix_cntrl_reg</span><span class="p">;</span>	<span class="cm">/* mixer control register */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">joystick_dac</span><span class="p">;</span>	<span class="cm">/* joystick DAC level */</span>
	<span class="kt">int</span> <span class="n">timer_dev</span><span class="p">;</span>			<span class="cm">/* timer device */</span>

	<span class="k">struct</span> <span class="n">snd_gf1</span> <span class="n">gf1</span><span class="p">;</span>	<span class="cm">/* gf1 specific variables */</span>
	<span class="k">struct</span> <span class="n">snd_pcm</span> <span class="o">*</span><span class="n">pcm</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">pcm_cap_substream</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">c_dma_size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">c_period_size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">c_pos</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">snd_rawmidi</span> <span class="o">*</span><span class="n">midi_uart</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_rawmidi_substream</span> <span class="o">*</span><span class="n">midi_substream_output</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_rawmidi_substream</span> <span class="o">*</span><span class="n">midi_substream_input</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">reg_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">voice_alloc</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">active_voice_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">event_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">dma_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">pcm_volume_level_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">uart_cmd_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">dma_mutex</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">register_mutex</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* I/O functions for GF1/InterWave chip - gus_io.c */</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">snd_gf1_select_voice</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">flags</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">active_voice_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">voice</span> <span class="o">!=</span> <span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">active_voice</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">active_voice</span> <span class="o">=</span> <span class="n">voice</span><span class="p">;</span>
		<span class="n">outb</span><span class="p">(</span><span class="n">voice</span><span class="p">,</span> <span class="n">GUSP</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">GF1PAGE</span><span class="p">));</span>
	<span class="p">}</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">active_voice_lock</span><span class="p">,</span> <span class="n">flags</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">snd_gf1_uart_cmd</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">gus</span><span class="o">-&gt;</span><span class="n">gf1</span><span class="p">.</span><span class="n">uart_cmd</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">GUSP</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">MIDICTRL</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">snd_gf1_uart_stat</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">inb</span><span class="p">(</span><span class="n">GUSP</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">MIDISTAT</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">snd_gf1_uart_put</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">GUSP</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">MIDIDATA</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">snd_gf1_uart_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">inb</span><span class="p">(</span><span class="n">GUSP</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">MIDIDATA</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_delay</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_ctrl_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_write8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">snd_gf1_look8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">snd_gf1_read8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">snd_gf1_look8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_write16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">snd_gf1_look16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="nf">snd_gf1_read16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">snd_gf1_look16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_adlib_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_dram_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_poke</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">snd_gf1_peek</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_write_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">short</span> <span class="n">w_16bit</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">snd_gf1_read_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">short</span> <span class="n">w_16bit</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_i_ctrl_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_i_write8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">snd_gf1_i_look8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_i_write16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">data</span><span class="p">);</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">snd_gf1_i_read8</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">snd_gf1_i_look8</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">snd_gf1_i_look16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="nf">snd_gf1_i_read16</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">snd_gf1_i_look16</span><span class="p">(</span><span class="n">gus</span><span class="p">,</span> <span class="n">reg</span> <span class="o">|</span> <span class="mh">0x80</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_select_active_voices</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="cm">/* gus_lfo.c */</span>

<span class="k">struct</span> <span class="n">_SND_IW_LFO_PROGRAM</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">freq_and_control</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">depth_final</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">depth_inc</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">twave</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">depth</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#if 0</span><span class="c"></span>
<span class="c">extern irqreturn_t snd_gf1_lfo_effect_interrupt(struct snd_gus_card * gus, snd_gf1_voice_t * voice);</span>
<span class="cp">#endif</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_done</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_program</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lfo_type</span><span class="p">,</span> <span class="k">struct</span> <span class="n">_SND_IW_LFO_PROGRAM</span> <span class="o">*</span><span class="n">program</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lfo_type</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lfo_type</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_change_freq</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lfo_type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">freq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_change_depth</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lfo_type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">depth</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lfo_type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">freq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">current_depth</span><span class="p">,</span> <span class="kt">int</span> <span class="n">depth</span><span class="p">,</span> <span class="kt">int</span> <span class="n">sweep</span><span class="p">,</span> <span class="kt">int</span> <span class="n">shape</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_lfo_shutdown</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">voice</span><span class="p">,</span> <span class="kt">int</span> <span class="n">lfo_type</span><span class="p">);</span>
<span class="cp">#if 0</span><span class="c"></span>
<span class="c">extern void snd_gf1_lfo_command(struct snd_gus_card * gus, int voice, unsigned char *command);</span>
<span class="cp">#endif</span>

<span class="cm">/* gus_mem.c */</span>

<span class="kt">void</span> <span class="n">snd_gf1_mem_lock</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gf1_mem</span> <span class="o">*</span> <span class="n">alloc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">xup</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_mem_xfree</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gf1_mem</span> <span class="o">*</span> <span class="n">alloc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_gf1_mem_block</span> <span class="o">*</span> <span class="n">block</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">snd_gf1_mem_block</span> <span class="o">*</span><span class="n">snd_gf1_mem_alloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gf1_mem</span> <span class="o">*</span> <span class="n">alloc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">owner</span><span class="p">,</span>
				       <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">w_16</span><span class="p">,</span>
				       <span class="kt">int</span> <span class="n">align</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">share_id</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_mem_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gf1_mem</span> <span class="o">*</span> <span class="n">alloc</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">address</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_mem_free_owner</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gf1_mem</span> <span class="o">*</span> <span class="n">alloc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">owner</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_mem_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_mem_done</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="cm">/* gus_mem_proc.c */</span>

<span class="kt">int</span> <span class="n">snd_gf1_mem_proc_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="cm">/* gus_dma.c */</span>

<span class="kt">int</span> <span class="n">snd_gf1_dma_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_dma_done</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_dma_transfer_block</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">snd_gf1_dma_block</span> <span class="o">*</span> <span class="n">block</span><span class="p">,</span>
			       <span class="kt">int</span> <span class="n">atomic</span><span class="p">,</span>
			       <span class="kt">int</span> <span class="n">synth</span><span class="p">);</span>

<span class="cm">/* gus_volume.c */</span>

<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">snd_gf1_lvol_to_gvol_raw</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">vol</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">snd_gf1_translate_freq</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">freq2</span><span class="p">);</span>

<span class="cm">/* gus_reset.c */</span>

<span class="kt">void</span> <span class="n">snd_gf1_set_default_handlers</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">what</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_gf1_smart_stop_voice</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">voice</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_gf1_stop_voice</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">voice</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_gf1_stop_voices</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">v_min</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">v_max</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="o">*</span><span class="n">snd_gf1_alloc_voice</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">type</span><span class="p">,</span> <span class="kt">int</span> <span class="n">client</span><span class="p">,</span> <span class="kt">int</span> <span class="n">port</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_gf1_free_voice</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_gus_voice</span> <span class="o">*</span><span class="n">voice</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gf1_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="cm">/* gus_mixer.c */</span>

<span class="kt">int</span> <span class="n">snd_gf1_new_mixer</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="cm">/* gus_pcm.c */</span>

<span class="kt">int</span> <span class="n">snd_gf1_pcm_new</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pcm_dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">control_index</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_pcm</span> <span class="o">**</span> <span class="n">rpcm</span><span class="p">);</span>

<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_gf1_print_voice_registers</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="cm">/* gus.c */</span>

<span class="kt">int</span> <span class="n">snd_gus_use_inc</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_gus_use_dec</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gus_create</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">,</span>
		   <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">port</span><span class="p">,</span>
		   <span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma2</span><span class="p">,</span>
		   <span class="kt">int</span> <span class="n">timer_dev</span><span class="p">,</span>
		   <span class="kt">int</span> <span class="n">voices</span><span class="p">,</span>
		   <span class="kt">int</span> <span class="n">pcm_channels</span><span class="p">,</span>
		   <span class="kt">int</span> <span class="n">effect</span><span class="p">,</span>
		   <span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">**</span> <span class="n">rgus</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gus_initialize</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">);</span>

<span class="cm">/* gus_irq.c */</span>

<span class="n">irqreturn_t</span> <span class="n">snd_gus_interrupt</span><span class="p">(</span><span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dev_id</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_SND_DEBUG</span>
<span class="kt">void</span> <span class="n">snd_gus_irq_profile_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span><span class="n">gus</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="cm">/* gus_uart.c */</span>

<span class="kt">int</span> <span class="n">snd_gf1_rawmidi_new</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span> <span class="n">gus</span><span class="p">,</span> <span class="kt">int</span> <span class="n">device</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_rawmidi</span> <span class="o">**</span><span class="n">rrawmidi</span><span class="p">);</span>

<span class="cm">/* gus_dram.c */</span>
<span class="kt">int</span> <span class="n">snd_gus_dram_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span><span class="n">gus</span><span class="p">,</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span>
		       <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_gus_dram_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_gus_card</span> <span class="o">*</span><span class="n">gus</span><span class="p">,</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">addr</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rom</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __SOUND_GUS_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
