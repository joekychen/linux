<!DOCTYPE html>
<html><head><title>joekychen/linux » include › sound › ac97_codec.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>ac97_codec.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __SOUND_AC97_CODEC_H</span>
<span class="cp">#define __SOUND_AC97_CODEC_H</span>

<span class="cm">/*</span>
<span class="cm"> *  Copyright (c) by Jaroslav Kysela &lt;perex@perex.cz&gt;</span>
<span class="cm"> *  Universal interface for Audio Codec &#39;97</span>
<span class="cm"> *</span>
<span class="cm"> *  For more details look to AC &#39;97 component specification revision 2.1</span>
<span class="cm"> *  by Intel Corporation (http://developer.intel.com).</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *   it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *   the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *   (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is distributed in the hope that it will be useful,</span>
<span class="cm"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *   GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *   You should have received a copy of the GNU General Public License</span>
<span class="cm"> *   along with this program; if not, write to the Free Software</span>
<span class="cm"> *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/bitops.h&gt;</span>
<span class="cp">#include &lt;linux/device.h&gt;</span>
<span class="cp">#include &lt;linux/workqueue.h&gt;</span>
<span class="cp">#include &quot;pcm.h&quot;</span>
<span class="cp">#include &quot;control.h&quot;</span>
<span class="cp">#include &quot;info.h&quot;</span>

<span class="cm">/* maximum number of devices on the AC97 bus */</span>
<span class="cp">#define	AC97_BUS_MAX_DEVICES	4</span>

<span class="cm">/*</span>
<span class="cm"> *  AC&#39;97 codec registers</span>
<span class="cm"> */</span>

<span class="cp">#define AC97_RESET		0x00	</span><span class="cm">/* Reset */</span><span class="cp"></span>
<span class="cp">#define AC97_MASTER		0x02	</span><span class="cm">/* Master Volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HEADPHONE		0x04	</span><span class="cm">/* Headphone Volume (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_MASTER_MONO	0x06	</span><span class="cm">/* Master Volume Mono (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_MASTER_TONE	0x08	</span><span class="cm">/* Master Tone (Bass &amp; Treble) (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_PC_BEEP		0x0a	</span><span class="cm">/* PC Beep Volume (optinal) */</span><span class="cp"></span>
<span class="cp">#define AC97_PHONE		0x0c	</span><span class="cm">/* Phone Volume (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_MIC		0x0e	</span><span class="cm">/* MIC Volume */</span><span class="cp"></span>
<span class="cp">#define AC97_LINE		0x10	</span><span class="cm">/* Line In Volume */</span><span class="cp"></span>
<span class="cp">#define AC97_CD			0x12	</span><span class="cm">/* CD Volume */</span><span class="cp"></span>
<span class="cp">#define AC97_VIDEO		0x14	</span><span class="cm">/* Video Volume (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_AUX		0x16	</span><span class="cm">/* AUX Volume (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_PCM		0x18	</span><span class="cm">/* PCM Volume */</span><span class="cp"></span>
<span class="cp">#define AC97_REC_SEL		0x1a	</span><span class="cm">/* Record Select */</span><span class="cp"></span>
<span class="cp">#define AC97_REC_GAIN		0x1c	</span><span class="cm">/* Record Gain */</span><span class="cp"></span>
<span class="cp">#define AC97_REC_GAIN_MIC	0x1e	</span><span class="cm">/* Record Gain MIC (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_GENERAL_PURPOSE	0x20	</span><span class="cm">/* General Purpose (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_3D_CONTROL		0x22	</span><span class="cm">/* 3D Control (optional) */</span><span class="cp"></span>
<span class="cp">#define AC97_INT_PAGING		0x24	</span><span class="cm">/* Audio Interrupt &amp; Paging (AC&#39;97 2.3) */</span><span class="cp"></span>
<span class="cp">#define AC97_POWERDOWN		0x26	</span><span class="cm">/* Powerdown control / status */</span><span class="cp"></span>
<span class="cm">/* range 0x28-0x3a - AUDIO AC&#39;97 2.0 extensions */</span>
<span class="cp">#define AC97_EXTENDED_ID	0x28	</span><span class="cm">/* Extended Audio ID */</span><span class="cp"></span>
<span class="cp">#define AC97_EXTENDED_STATUS	0x2a	</span><span class="cm">/* Extended Audio Status and Control */</span><span class="cp"></span>
<span class="cp">#define AC97_PCM_FRONT_DAC_RATE 0x2c	</span><span class="cm">/* PCM Front DAC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_PCM_SURR_DAC_RATE	0x2e	</span><span class="cm">/* PCM Surround DAC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_PCM_LFE_DAC_RATE	0x30	</span><span class="cm">/* PCM LFE DAC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_PCM_LR_ADC_RATE	0x32	</span><span class="cm">/* PCM LR ADC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_PCM_MIC_ADC_RATE	0x34	</span><span class="cm">/* PCM MIC ADC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_CENTER_LFE_MASTER	0x36	</span><span class="cm">/* Center + LFE Master Volume */</span><span class="cp"></span>
<span class="cp">#define AC97_SURROUND_MASTER	0x38	</span><span class="cm">/* Surround (Rear) Master Volume */</span><span class="cp"></span>
<span class="cp">#define AC97_SPDIF		0x3a	</span><span class="cm">/* S/PDIF control */</span><span class="cp"></span>
<span class="cm">/* range 0x3c-0x58 - MODEM */</span>
<span class="cp">#define AC97_EXTENDED_MID	0x3c	</span><span class="cm">/* Extended Modem ID */</span><span class="cp"></span>
<span class="cp">#define AC97_EXTENDED_MSTATUS	0x3e	</span><span class="cm">/* Extended Modem Status and Control */</span><span class="cp"></span>
<span class="cp">#define AC97_LINE1_RATE		0x40	</span><span class="cm">/* Line1 DAC/ADC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_LINE2_RATE		0x42	</span><span class="cm">/* Line2 DAC/ADC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_HANDSET_RATE	0x44	</span><span class="cm">/* Handset DAC/ADC Rate */</span><span class="cp"></span>
<span class="cp">#define AC97_LINE1_LEVEL	0x46	</span><span class="cm">/* Line1 DAC/ADC Level */</span><span class="cp"></span>
<span class="cp">#define AC97_LINE2_LEVEL	0x48	</span><span class="cm">/* Line2 DAC/ADC Level */</span><span class="cp"></span>
<span class="cp">#define AC97_HANDSET_LEVEL	0x4a	</span><span class="cm">/* Handset DAC/ADC Level */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_CFG		0x4c	</span><span class="cm">/* GPIO Configuration */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_POLARITY	0x4e	</span><span class="cm">/* GPIO Pin Polarity/Type, 0=low, 1=high active */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_STICKY	0x50	</span><span class="cm">/* GPIO Pin Sticky, 0=not, 1=sticky */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_WAKEUP	0x52	</span><span class="cm">/* GPIO Pin Wakeup, 0=no int, 1=yes int */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_STATUS	0x54	</span><span class="cm">/* GPIO Pin Status, slot 12 */</span><span class="cp"></span>
<span class="cp">#define AC97_MISC_AFE		0x56	</span><span class="cm">/* Miscellaneous Modem AFE Status and Control */</span><span class="cp"></span>
<span class="cm">/* range 0x5a-0x7b - Vendor Specific */</span>
<span class="cp">#define AC97_VENDOR_ID1		0x7c	</span><span class="cm">/* Vendor ID1 */</span><span class="cp"></span>
<span class="cp">#define AC97_VENDOR_ID2		0x7e	</span><span class="cm">/* Vendor ID2 / revision */</span><span class="cp"></span>
<span class="cm">/* range 0x60-0x6f (page 1) - extended codec registers */</span>
<span class="cp">#define AC97_CODEC_CLASS_REV	0x60	</span><span class="cm">/* Codec Class/Revision */</span><span class="cp"></span>
<span class="cp">#define AC97_PCI_SVID		0x62	</span><span class="cm">/* PCI Subsystem Vendor ID */</span><span class="cp"></span>
<span class="cp">#define AC97_PCI_SID		0x64	</span><span class="cm">/* PCI Subsystem ID */</span><span class="cp"></span>
<span class="cp">#define AC97_FUNC_SELECT	0x66	</span><span class="cm">/* Function Select */</span><span class="cp"></span>
<span class="cp">#define AC97_FUNC_INFO		0x68	</span><span class="cm">/* Function Information */</span><span class="cp"></span>
<span class="cp">#define AC97_SENSE_INFO		0x6a	</span><span class="cm">/* Sense Details */</span><span class="cp"></span>

<span class="cm">/* volume controls */</span>
<span class="cp">#define AC97_MUTE_MASK_MONO	0x8000</span>
<span class="cp">#define AC97_MUTE_MASK_STEREO	0x8080</span>

<span class="cm">/* slot allocation */</span>
<span class="cp">#define AC97_SLOT_TAG		0</span>
<span class="cp">#define AC97_SLOT_CMD_ADDR	1</span>
<span class="cp">#define AC97_SLOT_CMD_DATA	2</span>
<span class="cp">#define AC97_SLOT_PCM_LEFT	3</span>
<span class="cp">#define AC97_SLOT_PCM_RIGHT	4</span>
<span class="cp">#define AC97_SLOT_MODEM_LINE1	5</span>
<span class="cp">#define AC97_SLOT_PCM_CENTER	6</span>
<span class="cp">#define AC97_SLOT_MIC		6	</span><span class="cm">/* input */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_SPDIF_LEFT1	6</span>
<span class="cp">#define AC97_SLOT_PCM_SLEFT	7	</span><span class="cm">/* surround left */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_PCM_LEFT_0	7	</span><span class="cm">/* double rate operation */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_SPDIF_LEFT	7</span>
<span class="cp">#define AC97_SLOT_PCM_SRIGHT	8	</span><span class="cm">/* surround right */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_PCM_RIGHT_0	8	</span><span class="cm">/* double rate operation */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_SPDIF_RIGHT	8</span>
<span class="cp">#define AC97_SLOT_LFE		9</span>
<span class="cp">#define AC97_SLOT_SPDIF_RIGHT1	9</span>
<span class="cp">#define AC97_SLOT_MODEM_LINE2	10</span>
<span class="cp">#define AC97_SLOT_PCM_LEFT_1	10	</span><span class="cm">/* double rate operation */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_SPDIF_LEFT2	10</span>
<span class="cp">#define AC97_SLOT_HANDSET	11	</span><span class="cm">/* output */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_PCM_RIGHT_1	11	</span><span class="cm">/* double rate operation */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_SPDIF_RIGHT2	11</span>
<span class="cp">#define AC97_SLOT_MODEM_GPIO	12	</span><span class="cm">/* modem GPIO */</span><span class="cp"></span>
<span class="cp">#define AC97_SLOT_PCM_CENTER_1	12	</span><span class="cm">/* double rate operation */</span><span class="cp"></span>

<span class="cm">/* basic capabilities (reset register) */</span>
<span class="cp">#define AC97_BC_DEDICATED_MIC	0x0001	</span><span class="cm">/* Dedicated Mic PCM In Channel */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_RESERVED1	0x0002	</span><span class="cm">/* Reserved (was Modem Line Codec support) */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_BASS_TREBLE	0x0004	</span><span class="cm">/* Bass &amp; Treble Control */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_SIM_STEREO	0x0008	</span><span class="cm">/* Simulated stereo */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_HEADPHONE	0x0010	</span><span class="cm">/* Headphone Out Support */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_LOUDNESS	0x0020	</span><span class="cm">/* Loudness (bass boost) Support */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_16BIT_DAC	0x0000	</span><span class="cm">/* 16-bit DAC resolution */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_18BIT_DAC	0x0040	</span><span class="cm">/* 18-bit DAC resolution */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_20BIT_DAC	0x0080	</span><span class="cm">/* 20-bit DAC resolution */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_DAC_MASK	0x00c0</span>
<span class="cp">#define AC97_BC_16BIT_ADC	0x0000	</span><span class="cm">/* 16-bit ADC resolution */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_18BIT_ADC	0x0100	</span><span class="cm">/* 18-bit ADC resolution */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_20BIT_ADC	0x0200	</span><span class="cm">/* 20-bit ADC resolution */</span><span class="cp"></span>
<span class="cp">#define AC97_BC_ADC_MASK	0x0300</span>
<span class="cp">#define AC97_BC_3D_TECH_ID_MASK	0x7c00	</span><span class="cm">/* Per-vendor ID of 3D enhancement */</span><span class="cp"></span>

<span class="cm">/* general purpose */</span>
<span class="cp">#define AC97_GP_DRSS_MASK	0x0c00	</span><span class="cm">/* double rate slot select */</span><span class="cp"></span>
<span class="cp">#define AC97_GP_DRSS_1011	0x0000	</span><span class="cm">/* LR(C) 10+11(+12) */</span><span class="cp"></span>
<span class="cp">#define AC97_GP_DRSS_78		0x0400	</span><span class="cm">/* LR 7+8 */</span><span class="cp"></span>

<span class="cm">/* powerdown bits */</span>
<span class="cp">#define AC97_PD_ADC_STATUS	0x0001	</span><span class="cm">/* ADC status (RO) */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_DAC_STATUS	0x0002	</span><span class="cm">/* DAC status (RO) */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_MIXER_STATUS	0x0004	</span><span class="cm">/* Analog mixer status (RO) */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_VREF_STATUS	0x0008	</span><span class="cm">/* Vref status (RO) */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_PR0		0x0100	</span><span class="cm">/* Power down PCM ADCs and input MUX */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_PR1		0x0200	</span><span class="cm">/* Power down PCM front DAC */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_PR2		0x0400	</span><span class="cm">/* Power down Mixer (Vref still on) */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_PR3		0x0800	</span><span class="cm">/* Power down Mixer (Vref off) */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_PR4		0x1000	</span><span class="cm">/* Power down AC-Link */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_PR5		0x2000	</span><span class="cm">/* Disable internal clock usage */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_PR6		0x4000	</span><span class="cm">/* Headphone amplifier */</span><span class="cp"></span>
<span class="cp">#define AC97_PD_EAPD		0x8000	</span><span class="cm">/* External Amplifer Power Down (EAPD) */</span><span class="cp"></span>

<span class="cm">/* extended audio ID bit defines */</span>
<span class="cp">#define AC97_EI_VRA		0x0001	</span><span class="cm">/* Variable bit rate supported */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_DRA		0x0002	</span><span class="cm">/* Double rate supported */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_SPDIF		0x0004	</span><span class="cm">/* S/PDIF out supported */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_VRM		0x0008	</span><span class="cm">/* Variable bit rate supported for MIC */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_DACS_SLOT_MASK	0x0030	</span><span class="cm">/* DACs slot assignment */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_DACS_SLOT_SHIFT	4</span>
<span class="cp">#define AC97_EI_CDAC		0x0040	</span><span class="cm">/* PCM Center DAC available */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_SDAC		0x0080	</span><span class="cm">/* PCM Surround DACs available */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_LDAC		0x0100	</span><span class="cm">/* PCM LFE DAC available */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_AMAP		0x0200	</span><span class="cm">/* indicates optional slot/DAC mapping based on codec ID */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_REV_MASK	0x0c00	</span><span class="cm">/* AC&#39;97 revision mask */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_REV_22		0x0400	</span><span class="cm">/* AC&#39;97 revision 2.2 */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_REV_23		0x0800	</span><span class="cm">/* AC&#39;97 revision 2.3 */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_REV_SHIFT	10</span>
<span class="cp">#define AC97_EI_ADDR_MASK	0xc000	</span><span class="cm">/* physical codec ID (address) */</span><span class="cp"></span>
<span class="cp">#define AC97_EI_ADDR_SHIFT	14</span>

<span class="cm">/* extended audio status and control bit defines */</span>
<span class="cp">#define AC97_EA_VRA		0x0001	</span><span class="cm">/* Variable bit rate enable bit */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_DRA		0x0002	</span><span class="cm">/* Double-rate audio enable bit */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SPDIF		0x0004	</span><span class="cm">/* S/PDIF out enable bit */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_VRM		0x0008	</span><span class="cm">/* Variable bit rate for MIC enable bit */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SPSA_SLOT_MASK	0x0030	</span><span class="cm">/* Mask for slot assignment bits */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SPSA_SLOT_SHIFT 4</span>
<span class="cp">#define AC97_EA_SPSA_3_4	0x0000	</span><span class="cm">/* Slot assigned to 3 &amp; 4 */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SPSA_7_8	0x0010	</span><span class="cm">/* Slot assigned to 7 &amp; 8 */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SPSA_6_9	0x0020	</span><span class="cm">/* Slot assigned to 6 &amp; 9 */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SPSA_10_11	0x0030	</span><span class="cm">/* Slot assigned to 10 &amp; 11 */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_CDAC		0x0040	</span><span class="cm">/* PCM Center DAC is ready (Read only) */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SDAC		0x0080	</span><span class="cm">/* PCM Surround DACs are ready (Read only) */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_LDAC		0x0100	</span><span class="cm">/* PCM LFE DAC is ready (Read only) */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_MDAC		0x0200	</span><span class="cm">/* MIC ADC is ready (Read only) */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_SPCV		0x0400	</span><span class="cm">/* S/PDIF configuration valid (Read only) */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_PRI		0x0800	</span><span class="cm">/* Turns the PCM Center DAC off */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_PRJ		0x1000	</span><span class="cm">/* Turns the PCM Surround DACs off */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_PRK		0x2000	</span><span class="cm">/* Turns the PCM LFE DAC off */</span><span class="cp"></span>
<span class="cp">#define AC97_EA_PRL		0x4000	</span><span class="cm">/* Turns the MIC ADC off */</span><span class="cp"></span>

<span class="cm">/* S/PDIF control bit defines */</span>
<span class="cp">#define AC97_SC_PRO		0x0001	</span><span class="cm">/* Professional status */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_NAUDIO		0x0002	</span><span class="cm">/* Non audio stream */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_COPY		0x0004	</span><span class="cm">/* Copyright status */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_PRE		0x0008	</span><span class="cm">/* Preemphasis status */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_CC_MASK		0x07f0	</span><span class="cm">/* Category Code mask */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_CC_SHIFT	4</span>
<span class="cp">#define AC97_SC_L		0x0800	</span><span class="cm">/* Generation Level status */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_SPSR_MASK	0x3000	</span><span class="cm">/* S/PDIF Sample Rate bits */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_SPSR_SHIFT	12</span>
<span class="cp">#define AC97_SC_SPSR_44K	0x0000	</span><span class="cm">/* Use 44.1kHz Sample rate */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_SPSR_48K	0x2000	</span><span class="cm">/* Use 48kHz Sample rate */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_SPSR_32K	0x3000	</span><span class="cm">/* Use 32kHz Sample rate */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_DRS		0x4000	</span><span class="cm">/* Double Rate S/PDIF */</span><span class="cp"></span>
<span class="cp">#define AC97_SC_V		0x8000	</span><span class="cm">/* Validity status */</span><span class="cp"></span>

<span class="cm">/* Interrupt and Paging bit defines (AC&#39;97 2.3) */</span>
<span class="cp">#define AC97_PAGE_MASK		0x000f	</span><span class="cm">/* Page Selector */</span><span class="cp"></span>
<span class="cp">#define AC97_PAGE_VENDOR	0	</span><span class="cm">/* Vendor-specific registers */</span><span class="cp"></span>
<span class="cp">#define AC97_PAGE_1		1	</span><span class="cm">/* Extended Codec Registers page 1 */</span><span class="cp"></span>
<span class="cp">#define AC97_INT_ENABLE		0x0800	</span><span class="cm">/* Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define AC97_INT_SENSE		0x1000	</span><span class="cm">/* Sense Cycle */</span><span class="cp"></span>
<span class="cp">#define AC97_INT_CAUSE_SENSE	0x2000	</span><span class="cm">/* Sense Cycle Completed (RO) */</span><span class="cp"></span>
<span class="cp">#define AC97_INT_CAUSE_GPIO	0x4000	</span><span class="cm">/* GPIO bits changed (RO) */</span><span class="cp"></span>
<span class="cp">#define AC97_INT_STATUS		0x8000	</span><span class="cm">/* Interrupt Status */</span><span class="cp"></span>

<span class="cm">/* extended modem ID bit defines */</span>
<span class="cp">#define AC97_MEI_LINE1		0x0001	</span><span class="cm">/* Line1 present */</span><span class="cp"></span>
<span class="cp">#define AC97_MEI_LINE2		0x0002	</span><span class="cm">/* Line2 present */</span><span class="cp"></span>
<span class="cp">#define AC97_MEI_HANDSET	0x0004	</span><span class="cm">/* Handset present */</span><span class="cp"></span>
<span class="cp">#define AC97_MEI_CID1		0x0008	</span><span class="cm">/* caller ID decode for Line1 is supported */</span><span class="cp"></span>
<span class="cp">#define AC97_MEI_CID2		0x0010	</span><span class="cm">/* caller ID decode for Line2 is supported */</span><span class="cp"></span>
<span class="cp">#define AC97_MEI_ADDR_MASK	0xc000	</span><span class="cm">/* physical codec ID (address) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEI_ADDR_SHIFT	14</span>

<span class="cm">/* extended modem status and control bit defines */</span>
<span class="cp">#define AC97_MEA_GPIO		0x0001	</span><span class="cm">/* GPIO is ready (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_MREF		0x0002	</span><span class="cm">/* Vref is up to nominal level (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_ADC1		0x0004	</span><span class="cm">/* ADC1 operational (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_DAC1		0x0008	</span><span class="cm">/* DAC1 operational (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_ADC2		0x0010	</span><span class="cm">/* ADC2 operational (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_DAC2		0x0020	</span><span class="cm">/* DAC2 operational (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_HADC		0x0040	</span><span class="cm">/* HADC operational (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_HDAC		0x0080	</span><span class="cm">/* HDAC operational (ro) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRA		0x0100	</span><span class="cm">/* GPIO power down (high) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRB		0x0200	</span><span class="cm">/* reserved */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRC		0x0400	</span><span class="cm">/* ADC1 power down (high) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRD		0x0800	</span><span class="cm">/* DAC1 power down (high) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRE		0x1000	</span><span class="cm">/* ADC2 power down (high) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRF		0x2000	</span><span class="cm">/* DAC2 power down (high) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRG		0x4000	</span><span class="cm">/* HADC power down (high) */</span><span class="cp"></span>
<span class="cp">#define AC97_MEA_PRH		0x8000	</span><span class="cm">/* HDAC power down (high) */</span><span class="cp"></span>

<span class="cm">/* modem gpio status defines */</span>
<span class="cp">#define AC97_GPIO_LINE1_OH      0x0001  </span><span class="cm">/* Off Hook Line1 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE1_RI      0x0002  </span><span class="cm">/* Ring Detect Line1 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE1_CID     0x0004  </span><span class="cm">/* Caller ID path enable Line1 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE1_LCS     0x0008  </span><span class="cm">/* Loop Current Sense Line1 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE1_PULSE   0x0010  </span><span class="cm">/* Opt./ Pulse Dial Line1 (out) */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE1_HL1R    0x0020  </span><span class="cm">/* Opt./ Handset to Line1 relay control (out) */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE1_HOHD    0x0040  </span><span class="cm">/* Opt./ Handset off hook detect Line1 (in) */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE12_AC     0x0080  </span><span class="cm">/* Opt./ Int.bit 1 / Line1/2 AC (out) */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE12_DC     0x0100  </span><span class="cm">/* Opt./ Int.bit 2 / Line1/2 DC (out) */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE12_RS     0x0200  </span><span class="cm">/* Opt./ Int.bit 3 / Line1/2 RS (out) */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE2_OH      0x0400  </span><span class="cm">/* Off Hook Line2 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE2_RI      0x0800  </span><span class="cm">/* Ring Detect Line2 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE2_CID     0x1000  </span><span class="cm">/* Caller ID path enable Line2 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE2_LCS     0x2000  </span><span class="cm">/* Loop Current Sense Line2 */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE2_PULSE   0x4000  </span><span class="cm">/* Opt./ Pulse Dial Line2 (out) */</span><span class="cp"></span>
<span class="cp">#define AC97_GPIO_LINE2_HL1R    0x8000  </span><span class="cm">/* Opt./ Handset to Line2 relay control (out) */</span><span class="cp"></span>

<span class="cm">/* specific - SigmaTel */</span>
<span class="cp">#define AC97_SIGMATEL_OUTSEL	0x64	</span><span class="cm">/* Output Select, STAC9758 */</span><span class="cp"></span>
<span class="cp">#define AC97_SIGMATEL_INSEL	0x66	</span><span class="cm">/* Input Select, STAC9758 */</span><span class="cp"></span>
<span class="cp">#define AC97_SIGMATEL_IOMISC	0x68	</span><span class="cm">/* STAC9758 */</span><span class="cp"></span>
<span class="cp">#define AC97_SIGMATEL_ANALOG	0x6c	</span><span class="cm">/* Analog Special */</span><span class="cp"></span>
<span class="cp">#define AC97_SIGMATEL_DAC2INVERT 0x6e</span>
<span class="cp">#define AC97_SIGMATEL_BIAS1	0x70</span>
<span class="cp">#define AC97_SIGMATEL_BIAS2	0x72</span>
<span class="cp">#define AC97_SIGMATEL_VARIOUS	0x72	</span><span class="cm">/* STAC9758 */</span><span class="cp"></span>
<span class="cp">#define AC97_SIGMATEL_MULTICHN	0x74	</span><span class="cm">/* Multi-Channel programming */</span><span class="cp"></span>
<span class="cp">#define AC97_SIGMATEL_CIC1	0x76</span>
<span class="cp">#define AC97_SIGMATEL_CIC2	0x78</span>

<span class="cm">/* specific - Analog Devices */</span>
<span class="cp">#define AC97_AD_TEST		0x5a	</span><span class="cm">/* test register */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_TEST2		0x5c	</span><span class="cm">/* undocumented test register 2 */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_HPFD_SHIFT	12	</span><span class="cm">/* High Pass Filter Disable */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_CODEC_CFG	0x70	</span><span class="cm">/* codec configuration */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_JACK_SPDIF	0x72	</span><span class="cm">/* Jack Sense &amp; S/PDIF */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_SERIAL_CFG	0x74	</span><span class="cm">/* Serial Configuration */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_MISC		0x76	</span><span class="cm">/* Misc Control Bits */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_VREFD_SHIFT	2	</span><span class="cm">/* V_REFOUT Disable (AD1888) */</span><span class="cp"></span>

<span class="cm">/* specific - Cirrus Logic */</span>
<span class="cp">#define AC97_CSR_ACMODE		0x5e	</span><span class="cm">/* AC Mode Register */</span><span class="cp"></span>
<span class="cp">#define AC97_CSR_MISC_CRYSTAL	0x60	</span><span class="cm">/* Misc Crystal Control */</span><span class="cp"></span>
<span class="cp">#define AC97_CSR_SPDIF		0x68	</span><span class="cm">/* S/PDIF Register */</span><span class="cp"></span>
<span class="cp">#define AC97_CSR_SERIAL		0x6a	</span><span class="cm">/* Serial Port Control */</span><span class="cp"></span>
<span class="cp">#define AC97_CSR_SPECF_ADDR	0x6c	</span><span class="cm">/* Special Feature Address */</span><span class="cp"></span>
<span class="cp">#define AC97_CSR_SPECF_DATA	0x6e	</span><span class="cm">/* Special Feature Data */</span><span class="cp"></span>
<span class="cp">#define AC97_CSR_BDI_STATUS	0x7a	</span><span class="cm">/* BDI Status */</span><span class="cp"></span>

<span class="cm">/* specific - Conexant */</span>
<span class="cp">#define AC97_CXR_AUDIO_MISC	0x5c</span>
<span class="cp">#define AC97_CXR_SPDIFEN	(1&lt;&lt;3)</span>
<span class="cp">#define AC97_CXR_COPYRGT	(1&lt;&lt;2)</span>
<span class="cp">#define AC97_CXR_SPDIF_MASK	(3&lt;&lt;0)</span>
<span class="cp">#define AC97_CXR_SPDIF_PCM	0x0</span>
<span class="cp">#define AC97_CXR_SPDIF_AC3	0x2</span>

<span class="cm">/* specific - ALC */</span>
<span class="cp">#define AC97_ALC650_SPDIF_INPUT_STATUS1	0x60</span>
<span class="cm">/* S/PDIF input status 1 bit defines */</span>
<span class="cp">#define AC97_ALC650_PRO             0x0001  </span><span class="cm">/* Professional status */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_NAUDIO          0x0002  </span><span class="cm">/* Non audio stream */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_COPY            0x0004  </span><span class="cm">/* Copyright status */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_PRE             0x0038  </span><span class="cm">/* Preemphasis status */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_PRE_SHIFT       3</span>
<span class="cp">#define AC97_ALC650_MODE            0x00C0  </span><span class="cm">/* Preemphasis status */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_MODE_SHIFT      6</span>
<span class="cp">#define AC97_ALC650_CC_MASK         0x7f00  </span><span class="cm">/* Category Code mask */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_CC_SHIFT        8</span>
<span class="cp">#define AC97_ALC650_L               0x8000  </span><span class="cm">/* Generation Level status */</span><span class="cp"></span>

<span class="cp">#define AC97_ALC650_SPDIF_INPUT_STATUS2	0x62</span>
<span class="cm">/* S/PDIF input status 2 bit defines */</span>
<span class="cp">#define AC97_ALC650_SOUCE_MASK      0x000f  </span><span class="cm">/* Source number */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_CHANNEL_MASK    0x00f0  </span><span class="cm">/* Channel number */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_CHANNEL_SHIFT   4 </span>
<span class="cp">#define AC97_ALC650_SPSR_MASK       0x0f00  </span><span class="cm">/* S/PDIF Sample Rate bits */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_SPSR_SHIFT      8</span>
<span class="cp">#define AC97_ALC650_SPSR_44K        0x0000  </span><span class="cm">/* Use 44.1kHz Sample rate */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_SPSR_48K        0x0200  </span><span class="cm">/* Use 48kHz Sample rate */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_SPSR_32K        0x0300  </span><span class="cm">/* Use 32kHz Sample rate */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_CLOCK_ACCURACY  0x3000  </span><span class="cm">/* Clock accuracy */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_CLOCK_SHIFT     12</span>
<span class="cp">#define AC97_ALC650_CLOCK_LOCK      0x4000  </span><span class="cm">/* Clock locked status */</span><span class="cp"></span>
<span class="cp">#define AC97_ALC650_V               0x8000  </span><span class="cm">/* Validity status */</span><span class="cp"></span>

<span class="cp">#define AC97_ALC650_SURR_DAC_VOL	0x64</span>
<span class="cp">#define AC97_ALC650_LFE_DAC_VOL		0x66</span>
<span class="cp">#define AC97_ALC650_UNKNOWN1		0x68</span>
<span class="cp">#define AC97_ALC650_MULTICH		0x6a</span>
<span class="cp">#define AC97_ALC650_UNKNOWN2		0x6c</span>
<span class="cp">#define AC97_ALC650_REVISION		0x6e</span>
<span class="cp">#define AC97_ALC650_UNKNOWN3		0x70</span>
<span class="cp">#define AC97_ALC650_UNKNOWN4		0x72</span>
<span class="cp">#define AC97_ALC650_MISC		0x74</span>
<span class="cp">#define AC97_ALC650_GPIO_SETUP		0x76</span>
<span class="cp">#define AC97_ALC650_GPIO_STATUS		0x78</span>
<span class="cp">#define AC97_ALC650_CLOCK		0x7a</span>

<span class="cm">/* specific - Yamaha YMF7x3 */</span>
<span class="cp">#define AC97_YMF7X3_DIT_CTRL	0x66	</span><span class="cm">/* DIT Control (YMF743) / 2 (YMF753) */</span><span class="cp"></span>
<span class="cp">#define AC97_YMF7X3_3D_MODE_SEL	0x68	</span><span class="cm">/* 3D Mode Select */</span><span class="cp"></span>

<span class="cm">/* specific - C-Media */</span>
<span class="cp">#define AC97_CM9738_VENDOR_CTRL	0x5a</span>
<span class="cp">#define AC97_CM9739_MULTI_CHAN	0x64</span>
<span class="cp">#define AC97_CM9739_SPDIF_IN_STATUS	0x68 </span><span class="cm">/* 32bit */</span><span class="cp"></span>
<span class="cp">#define AC97_CM9739_SPDIF_CTRL	0x6c</span>

<span class="cm">/* specific - wolfson */</span>
<span class="cp">#define AC97_WM97XX_FMIXER_VOL  0x72</span>
<span class="cp">#define AC97_WM9704_RMIXER_VOL  0x74</span>
<span class="cp">#define AC97_WM9704_TEST        0x5a</span>
<span class="cp">#define AC97_WM9704_RPCM_VOL    0x70</span>
<span class="cp">#define AC97_WM9711_OUT3VOL     0x16</span>


<span class="cm">/* ac97-&gt;scaps */</span>
<span class="cp">#define AC97_SCAP_AUDIO		(1&lt;&lt;0)	</span><span class="cm">/* audio codec 97 */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_MODEM		(1&lt;&lt;1)	</span><span class="cm">/* modem codec 97 */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_SURROUND_DAC	(1&lt;&lt;2)	</span><span class="cm">/* surround L&amp;R DACs are present */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_CENTER_LFE_DAC (1&lt;&lt;3)	</span><span class="cm">/* center and LFE DACs are present */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_SKIP_AUDIO	(1&lt;&lt;4)	</span><span class="cm">/* skip audio part of codec */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_SKIP_MODEM	(1&lt;&lt;5)	</span><span class="cm">/* skip modem part of codec */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_INDEP_SDIN	(1&lt;&lt;6)	</span><span class="cm">/* independent SDIN */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_INV_EAPD	(1&lt;&lt;7)	</span><span class="cm">/* inverted EAPD */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_DETECT_BY_VENDOR (1&lt;&lt;8) </span><span class="cm">/* use vendor registers for read tests */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_NO_SPDIF	(1&lt;&lt;9)	</span><span class="cm">/* don&#39;t build SPDIF controls */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_EAPD_LED	(1&lt;&lt;10)	</span><span class="cm">/* EAPD as mute LED */</span><span class="cp"></span>
<span class="cp">#define AC97_SCAP_POWER_SAVE	(1&lt;&lt;11)	</span><span class="cm">/* capable for aggressive power-saving */</span><span class="cp"></span>

<span class="cm">/* ac97-&gt;flags */</span>
<span class="cp">#define AC97_HAS_PC_BEEP	(1&lt;&lt;0)	</span><span class="cm">/* force PC Speaker usage */</span><span class="cp"></span>
<span class="cp">#define AC97_AD_MULTI		(1&lt;&lt;1)	</span><span class="cm">/* Analog Devices - multi codecs */</span><span class="cp"></span>
<span class="cp">#define AC97_CS_SPDIF		(1&lt;&lt;2)	</span><span class="cm">/* Cirrus Logic uses funky SPDIF */</span><span class="cp"></span>
<span class="cp">#define AC97_CX_SPDIF		(1&lt;&lt;3)	</span><span class="cm">/* Conexant&#39;s spdif interface */</span><span class="cp"></span>
<span class="cp">#define AC97_STEREO_MUTES	(1&lt;&lt;4)	</span><span class="cm">/* has stereo mute bits */</span><span class="cp"></span>
<span class="cp">#define AC97_DOUBLE_RATE	(1&lt;&lt;5)	</span><span class="cm">/* supports double rate playback */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_MASTER_VOL	(1&lt;&lt;6)	</span><span class="cm">/* no Master volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_PCM_VOL	(1&lt;&lt;7)	</span><span class="cm">/* no PCM volume */</span><span class="cp"></span>
<span class="cp">#define AC97_DEFAULT_POWER_OFF	(1&lt;&lt;8)	</span><span class="cm">/* no RESET write */</span><span class="cp"></span>
<span class="cp">#define AC97_MODEM_PATCH	(1&lt;&lt;9)	</span><span class="cm">/* modem patch */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_REC_GAIN	(1&lt;&lt;10) </span><span class="cm">/* no Record gain */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_PHONE	(1&lt;&lt;11) </span><span class="cm">/* no PHONE volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_PC_BEEP	(1&lt;&lt;12) </span><span class="cm">/* no PC Beep volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_VIDEO	(1&lt;&lt;13) </span><span class="cm">/* no Video volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_CD		(1&lt;&lt;14) </span><span class="cm">/* no CD volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_MIC	(1&lt;&lt;15) </span><span class="cm">/* no MIC volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_TONE	(1&lt;&lt;16) </span><span class="cm">/* no Tone volume */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_STD_PCM	(1&lt;&lt;17)	</span><span class="cm">/* no standard AC97 PCM volume and mute */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_NO_AUX		(1&lt;&lt;18) </span><span class="cm">/* no standard AC97 AUX volume and mute */</span><span class="cp"></span>
<span class="cp">#define AC97_HAS_8CH		(1&lt;&lt;19) </span><span class="cm">/* supports 8-channel output */</span><span class="cp"></span>

<span class="cm">/* rates indexes */</span>
<span class="cp">#define AC97_RATES_FRONT_DAC	0</span>
<span class="cp">#define AC97_RATES_SURR_DAC	1</span>
<span class="cp">#define AC97_RATES_LFE_DAC	2</span>
<span class="cp">#define AC97_RATES_ADC		3</span>
<span class="cp">#define AC97_RATES_MIC_ADC	4</span>
<span class="cp">#define AC97_RATES_SPDIF	5</span>

<span class="cm">/*</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">snd_ac97</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">snd_ac97_build_ops</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">build_3d</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">build_specific</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">build_spdif</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">build_post_spdif</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_PM</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">suspend</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">resume</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
<span class="cp">#endif</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">update_jacks</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>	<span class="cm">/* for jack-sharing */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_ac97_bus_ops</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">reset</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">warm_reset</span><span class="p">)(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">write</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">val</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="p">(</span><span class="o">*</span><span class="n">read</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">wait</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_ac97_bus</span> <span class="p">{</span>
	<span class="cm">/* -- lowlevel (hardware) driver specific -- */</span>
	<span class="k">struct</span> <span class="n">snd_ac97_bus_ops</span> <span class="o">*</span><span class="n">ops</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">private_free</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97_bus</span> <span class="o">*</span><span class="n">bus</span><span class="p">);</span>
	<span class="cm">/* --- */</span>
	<span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">num</span><span class="p">;</span>	<span class="cm">/* bus number */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">no_vra</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="cm">/* bridge doesn&#39;t support VRA */</span>
		       <span class="nl">dra:</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/* bridge supports double rate */</span>
		       <span class="nl">isdin:</span> <span class="mi">1</span><span class="p">;</span><span class="cm">/* independent SDIN */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">clock</span><span class="p">;</span>	<span class="cm">/* AC&#39;97 base clock (usually 48000Hz) */</span>
	<span class="n">spinlock_t</span> <span class="n">bus_lock</span><span class="p">;</span>	<span class="cm">/* used mainly for slot allocation */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">used_slots</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span> <span class="cm">/* actually used PCM slots */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pcms_count</span><span class="p">;</span> <span class="cm">/* count of PCMs */</span>
	<span class="k">struct</span> <span class="n">ac97_pcm</span> <span class="o">*</span><span class="n">pcms</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">codec</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">snd_info_entry</span> <span class="o">*</span><span class="n">proc</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* static resolution table */</span>
<span class="k">struct</span> <span class="n">snd_ac97_res_table</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">;</span>	<span class="cm">/* register */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">bits</span><span class="p">;</span>	<span class="cm">/* resolution bitmask */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_ac97_template</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">private_free</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">;</span>	<span class="cm">/* assigned PCI device - used for quirks */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">num</span><span class="p">;</span>	<span class="cm">/* number of codec: 0 = primary, 1 = secondary */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">addr</span><span class="p">;</span>	<span class="cm">/* physical address of codec [0-3] */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">scaps</span><span class="p">;</span>	<span class="cm">/* driver capabilities */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">snd_ac97_res_table</span> <span class="o">*</span><span class="n">res_table</span><span class="p">;</span>	<span class="cm">/* static resolution */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">snd_ac97</span> <span class="p">{</span>
	<span class="cm">/* -- lowlevel (hardware) driver specific -- */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">snd_ac97_build_ops</span> <span class="o">*</span><span class="n">build_ops</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">;</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">private_free</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
	<span class="cm">/* --- */</span>
	<span class="k">struct</span> <span class="n">snd_ac97_bus</span> <span class="o">*</span><span class="n">bus</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span><span class="p">;</span>	<span class="cm">/* assigned PCI device - used for quirks */</span>
	<span class="k">struct</span> <span class="n">snd_info_entry</span> <span class="o">*</span><span class="n">proc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_info_entry</span> <span class="o">*</span><span class="n">proc_regs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">subsystem_vendor</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">subsystem_device</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">reg_mutex</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">page_mutex</span><span class="p">;</span>	<span class="cm">/* mutex for AD18xx multi-codecs and paging (2.3) */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">num</span><span class="p">;</span>	<span class="cm">/* number of codec: 0 = primary, 1 = secondary */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">addr</span><span class="p">;</span>	<span class="cm">/* physical address of codec [0-3] */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">id</span><span class="p">;</span>	<span class="cm">/* identification of codec */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">caps</span><span class="p">;</span>	<span class="cm">/* capabilities (register 0) */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ext_id</span><span class="p">;</span>	<span class="cm">/* extended feature identification (register 28) */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">ext_mid</span><span class="p">;</span>	<span class="cm">/* extended modem ID (register 3C) */</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">snd_ac97_res_table</span> <span class="o">*</span><span class="n">res_table</span><span class="p">;</span>	<span class="cm">/* static resolution */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">scaps</span><span class="p">;</span>	<span class="cm">/* driver capabilities */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>	<span class="cm">/* specific code */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rates</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>	<span class="cm">/* see AC97_RATES_* defines */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">spdif_status</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">regs</span><span class="p">[</span><span class="mh">0x80</span><span class="p">];</span> <span class="cm">/* register cache */</span>
	<span class="n">DECLARE_BITMAP</span><span class="p">(</span><span class="n">reg_accessed</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">);</span> <span class="cm">/* bit flags */</span>
	<span class="k">union</span> <span class="p">{</span>			<span class="cm">/* vendor specific code */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">unchained</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>	<span class="c1">// 0 = C34, 1 = C79, 2 = C69</span>
			<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">chained</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>	<span class="c1">// 0 = C34, 1 = C79, 2 = C69</span>
			<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">id</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>		<span class="c1">// codec IDs (lower 16-bit word)</span>
			<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pcmreg</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>	<span class="c1">// PCM registers</span>
			<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">codec_cfg</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>	<span class="c1">// CODEC_CFG bits</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">swap_mic_linein</span><span class="p">;</span>	<span class="c1">// AD1986/AD1986A only</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">lo_as_master</span><span class="p">;</span>	<span class="cm">/* LO as master */</span>
		<span class="p">}</span> <span class="n">ad18xx</span><span class="p">;</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">dev_flags</span><span class="p">;</span>		<span class="cm">/* device specific */</span>
	<span class="p">}</span> <span class="n">spec</span><span class="p">;</span>
	<span class="cm">/* jack-sharing info */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">indep_surround</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">channel_mode</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_SND_AC97_POWER_SAVE</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">power_up</span><span class="p">;</span>	<span class="cm">/* power states */</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">power_work</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="n">dev</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define to_ac97_t(d) container_of(d, struct snd_ac97, dev)</span>

<span class="cm">/* conditions */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ac97_is_audio</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span> <span class="n">ac97</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">ac97</span><span class="o">-&gt;</span><span class="n">scaps</span> <span class="o">&amp;</span> <span class="n">AC97_SCAP_AUDIO</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ac97_is_modem</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span> <span class="n">ac97</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">ac97</span><span class="o">-&gt;</span><span class="n">scaps</span> <span class="o">&amp;</span> <span class="n">AC97_SCAP_MODEM</span><span class="p">);</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ac97_is_rev22</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span> <span class="n">ac97</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">ac97</span><span class="o">-&gt;</span><span class="n">ext_id</span> <span class="o">&amp;</span> <span class="n">AC97_EI_REV_MASK</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">AC97_EI_REV_22</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ac97_can_amap</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span> <span class="n">ac97</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">ac97</span><span class="o">-&gt;</span><span class="n">ext_id</span> <span class="o">&amp;</span> <span class="n">AC97_EI_AMAP</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ac97_can_spdif</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span> <span class="n">ac97</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">ac97</span><span class="o">-&gt;</span><span class="n">ext_id</span> <span class="o">&amp;</span> <span class="n">AC97_EI_SPDIF</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* functions */</span>
<span class="cm">/* create new AC97 bus */</span>
<span class="kt">int</span> <span class="n">snd_ac97_bus</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">,</span> <span class="kt">int</span> <span class="n">num</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ac97_bus_ops</span> <span class="o">*</span><span class="n">ops</span><span class="p">,</span>
		 <span class="kt">void</span> <span class="o">*</span><span class="n">private_data</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ac97_bus</span> <span class="o">**</span><span class="n">rbus</span><span class="p">);</span>
<span class="cm">/* create mixer controls */</span>
<span class="kt">int</span> <span class="n">snd_ac97_mixer</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97_bus</span> <span class="o">*</span><span class="n">bus</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_ac97_template</span> <span class="o">*</span><span class="n">template</span><span class="p">,</span>
		   <span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">**</span><span class="n">rac97</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">snd_ac97_get_short_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">snd_ac97_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">snd_ac97_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_ac97_write_cache</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_ac97_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">value</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_ac97_update_bits</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">mask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">value</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_SND_AC97_POWER_SAVE</span>
<span class="kt">int</span> <span class="n">snd_ac97_update_power</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">int</span> <span class="n">powerup</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">snd_ac97_update_power</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span>
					<span class="kt">int</span> <span class="n">powerup</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_PM</span>
<span class="kt">void</span> <span class="n">snd_ac97_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_ac97_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="cm">/* quirk types */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">AC97_TUNE_DEFAULT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>	<span class="cm">/* use default from quirk list (not valid in list) */</span>
	<span class="n">AC97_TUNE_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>	<span class="cm">/* nothing extra to do */</span>
	<span class="n">AC97_TUNE_HP_ONLY</span><span class="p">,</span>	<span class="cm">/* headphone (true line-out) control as master only */</span>
	<span class="n">AC97_TUNE_SWAP_HP</span><span class="p">,</span>	<span class="cm">/* swap headphone and master controls */</span>
	<span class="n">AC97_TUNE_SWAP_SURROUND</span><span class="p">,</span> <span class="cm">/* swap master and surround controls */</span>
	<span class="n">AC97_TUNE_AD_SHARING</span><span class="p">,</span>	<span class="cm">/* for AD1985, turn on OMS bit and use headphone */</span>
	<span class="n">AC97_TUNE_ALC_JACK</span><span class="p">,</span>	<span class="cm">/* for Realtek, enable JACK detection */</span>
	<span class="n">AC97_TUNE_INV_EAPD</span><span class="p">,</span>	<span class="cm">/* inverted EAPD implementation */</span>
	<span class="n">AC97_TUNE_MUTE_LED</span><span class="p">,</span>	<span class="cm">/* EAPD bit works as mute LED */</span>
	<span class="n">AC97_TUNE_HP_MUTE_LED</span><span class="p">,</span>  <span class="cm">/* EAPD bit works as mute LED, use headphone control as master */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ac97_quirk</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">subvendor</span><span class="p">;</span> <span class="cm">/* PCI subsystem vendor id */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">subdevice</span><span class="p">;</span> <span class="cm">/* PCI subsystem device id */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">mask</span><span class="p">;</span>	<span class="cm">/* device id bit mask, 0 = accept all */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">codec_id</span><span class="p">;</span>	<span class="cm">/* codec id (if any), 0 = accept all */</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>	<span class="cm">/* name shown as info */</span>
	<span class="kt">int</span> <span class="n">type</span><span class="p">;</span>		<span class="cm">/* quirk type above */</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">snd_ac97_tune_hardware</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ac97_quirk</span> <span class="o">*</span><span class="n">quirk</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">override</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_ac97_set_rate</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * PCM allocation</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">ac97_pcm_cfg</span> <span class="p">{</span>
	<span class="n">AC97_PCM_CFG_FRONT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">AC97_PCM_CFG_REAR</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>		<span class="cm">/* alias surround */</span>
	<span class="n">AC97_PCM_CFG_LFE</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>		<span class="cm">/* center + lfe */</span>
	<span class="n">AC97_PCM_CFG_40</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>		<span class="cm">/* front + rear */</span>
	<span class="n">AC97_PCM_CFG_51</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>		<span class="cm">/* front + rear + center/lfe */</span>
	<span class="n">AC97_PCM_CFG_SPDIF</span> <span class="o">=</span> <span class="mi">20</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ac97_pcm</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">snd_ac97_bus</span> <span class="o">*</span><span class="n">bus</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">stream</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>	   	   <span class="cm">/* stream type: 1 = capture */</span>
		     <span class="nl">exclusive:</span> <span class="mi">1</span><span class="p">,</span>	   <span class="cm">/* exclusive mode, don&#39;t override with other pcms */</span>
		     <span class="nl">copy_flag:</span> <span class="mi">1</span><span class="p">,</span>	   <span class="cm">/* lowlevel driver must fill all entries */</span>
		     <span class="nl">spdif:</span> <span class="mi">1</span><span class="p">;</span>		   <span class="cm">/* spdif pcm */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">aslots</span><span class="p">;</span>		   <span class="cm">/* active slots */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cur_dbl</span><span class="p">;</span>		   <span class="cm">/* current double-rate state */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rates</span><span class="p">;</span>		   <span class="cm">/* available rates */</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">slots</span><span class="p">;</span>	   <span class="cm">/* driver input: requested AC97 slot numbers */</span>
		<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">rslots</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>  <span class="cm">/* allocated slots per codecs */</span>
		<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">rate_table</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
		<span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">codec</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	   <span class="cm">/* allocated codecs */</span>
	<span class="p">}</span> <span class="n">r</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>				   <span class="cm">/* 0 = standard rates, 1 = double rates */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">private_value</span><span class="p">;</span>	   <span class="cm">/* used by the hardware driver */</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">snd_ac97_pcm_assign</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97_bus</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span>
			<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">pcms_count</span><span class="p">,</span>
			<span class="k">const</span> <span class="k">struct</span> <span class="n">ac97_pcm</span> <span class="o">*</span><span class="n">pcms</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_ac97_pcm_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">ac97_pcm</span> <span class="o">*</span><span class="n">pcm</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">,</span>
		      <span class="k">enum</span> <span class="n">ac97_pcm_cfg</span> <span class="n">cfg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">slots</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_ac97_pcm_close</span><span class="p">(</span><span class="k">struct</span> <span class="n">ac97_pcm</span> <span class="o">*</span><span class="n">pcm</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_ac97_pcm_double_rate_rules</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_pcm_runtime</span> <span class="o">*</span><span class="n">runtime</span><span class="p">);</span>

<span class="cm">/* ad hoc AC97 device driver access */</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">bus_type</span> <span class="n">ac97_bus_type</span><span class="p">;</span>

<span class="cm">/* AC97 platform_data adding function */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">snd_ac97_dev_add_pdata</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_ac97</span> <span class="o">*</span><span class="n">ac97</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ac97</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">.</span><span class="n">platform_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* __SOUND_AC97_CODEC_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
