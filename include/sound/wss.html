<!DOCTYPE html>
<html><head><title>joekychen/linux » include › sound › wss.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>wss.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __SOUND_WSS_H</span>
<span class="cp">#define __SOUND_WSS_H</span>

<span class="cm">/*</span>
<span class="cm"> *  Copyright (c) by Jaroslav Kysela &lt;perex@perex.cz&gt;</span>
<span class="cm"> *  Definitions for CS4231 &amp; InterWave chips &amp; compatible chips</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> *   it under the terms of the GNU General Public License as published by</span>
<span class="cm"> *   the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> *   (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> *   This program is distributed in the hope that it will be useful,</span>
<span class="cm"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> *   GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> *   You should have received a copy of the GNU General Public License</span>
<span class="cm"> *   along with this program; if not, write to the Free Software</span>
<span class="cm"> *   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307 USA</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &quot;control.h&quot;</span>
<span class="cp">#include &quot;pcm.h&quot;</span>
<span class="cp">#include &quot;timer.h&quot;</span>

<span class="cp">#include &quot;cs4231-regs.h&quot;</span>

<span class="cm">/* defines for codec.mode */</span>

<span class="cp">#define WSS_MODE_NONE	0x0000</span>
<span class="cp">#define WSS_MODE_PLAY	0x0001</span>
<span class="cp">#define WSS_MODE_RECORD	0x0002</span>
<span class="cp">#define WSS_MODE_TIMER	0x0004</span>
<span class="cp">#define WSS_MODE_OPEN	(WSS_MODE_PLAY|WSS_MODE_RECORD|WSS_MODE_TIMER)</span>

<span class="cm">/* defines for codec.hardware */</span>

<span class="cp">#define WSS_HW_DETECT        0x0000	</span><span class="cm">/* let CS4231 driver detect chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_DETECT3	0x0001	</span><span class="cm">/* allow mode 3 */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_TYPE_MASK	0xff00	</span><span class="cm">/* type mask */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4231_MASK   0x0100	</span><span class="cm">/* CS4231 serie */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4231        0x0100	</span><span class="cm">/* CS4231 chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4231A       0x0101	</span><span class="cm">/* CS4231A chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_AD1845	0x0102	</span><span class="cm">/* AD1845 chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4232_MASK   0x0200	</span><span class="cm">/* CS4232 serie (has control ports) */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4232        0x0200	</span><span class="cm">/* CS4232 */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4232A       0x0201	</span><span class="cm">/* CS4232A */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4236	0x0202	</span><span class="cm">/* CS4236 */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4236B_MASK	0x0400	</span><span class="cm">/* CS4236B serie (has extended control regs) */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4235	0x0400	</span><span class="cm">/* CS4235 - Crystal Clear (tm) stereo enhancement */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4236B       0x0401	</span><span class="cm">/* CS4236B */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4237B       0x0402	</span><span class="cm">/* CS4237B - SRS 3D */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4238B	0x0403	</span><span class="cm">/* CS4238B - QSOUND 3D */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4239	0x0404	</span><span class="cm">/* CS4239 - Crystal Clear (tm) stereo enhancement */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_AD1848_MASK	0x0800	</span><span class="cm">/* AD1848 serie (half duplex) */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_AD1847		0x0801	</span><span class="cm">/* AD1847 chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_AD1848		0x0802	</span><span class="cm">/* AD1848 chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CS4248		0x0803	</span><span class="cm">/* CS4248 chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_CMI8330		0x0804	</span><span class="cm">/* CMI8330 chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_THINKPAD		0x0805	</span><span class="cm">/* Thinkpad 360/750/755 */</span><span class="cp"></span>
<span class="cm">/* compatible, but clones */</span>
<span class="cp">#define WSS_HW_INTERWAVE     0x1000	</span><span class="cm">/* InterWave chip */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_OPL3SA2       0x1101	</span><span class="cm">/* OPL3-SA2 chip, similar to cs4231 */</span><span class="cp"></span>
<span class="cp">#define WSS_HW_OPTI93X 	0x1102	</span><span class="cm">/* Opti 930/931/933 */</span><span class="cp"></span>

<span class="cm">/* defines for codec.hwshare */</span>
<span class="cp">#define WSS_HWSHARE_IRQ	(1&lt;&lt;0)</span>
<span class="cp">#define WSS_HWSHARE_DMA1	(1&lt;&lt;1)</span>
<span class="cp">#define WSS_HWSHARE_DMA2	(1&lt;&lt;2)</span>

<span class="cm">/* IBM Thinkpad specific stuff */</span>
<span class="cp">#define AD1848_THINKPAD_CTL_PORT1		0x15e8</span>
<span class="cp">#define AD1848_THINKPAD_CTL_PORT2		0x15e9</span>
<span class="cp">#define AD1848_THINKPAD_CS4248_ENABLE_BIT	0x02</span>

<span class="k">struct</span> <span class="n">snd_wss</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">port</span><span class="p">;</span>		<span class="cm">/* base i/o port */</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res_port</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cport</span><span class="p">;</span>		<span class="cm">/* control base i/o port (CS4236) */</span>
	<span class="k">struct</span> <span class="n">resource</span> <span class="o">*</span><span class="n">res_cport</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">irq</span><span class="p">;</span>			<span class="cm">/* IRQ line */</span>
	<span class="kt">int</span> <span class="n">dma1</span><span class="p">;</span>			<span class="cm">/* playback DMA */</span>
	<span class="kt">int</span> <span class="n">dma2</span><span class="p">;</span>			<span class="cm">/* record DMA */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">version</span><span class="p">;</span>		<span class="cm">/* version of CODEC chip */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">mode</span><span class="p">;</span>		<span class="cm">/* see to WSS_MODE_XXXX */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hardware</span><span class="p">;</span>	<span class="cm">/* see to WSS_HW_XXXX */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hwshare</span><span class="p">;</span>		<span class="cm">/* shared resources */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">single_dma</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span>	<span class="cm">/* forced single DMA mode (GUS 16-bit */</span>
					<span class="cm">/* daughter board) or dma1 == dma2 */</span>
		       <span class="nl">ebus_flag:</span><span class="mi">1</span><span class="p">,</span>	<span class="cm">/* SPARC: EBUS present */</span>
		       <span class="nl">thinkpad_flag:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Thinkpad CS4248 needs extra help */</span>

	<span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_pcm</span> <span class="o">*</span><span class="n">pcm</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">playback_substream</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_pcm_substream</span> <span class="o">*</span><span class="n">capture_substream</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">snd_timer</span> <span class="o">*</span><span class="n">timer</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">image</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>	<span class="cm">/* registers image */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">eimage</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>	<span class="cm">/* extended registers image */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">cimage</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* control registers image */</span>
	<span class="kt">int</span> <span class="n">mce_bit</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">calibrate_mute</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">sw_3d_bit</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">p_dma_size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">c_dma_size</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">reg_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">mce_mutex</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">open_mutex</span><span class="p">;</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">rate_constraint</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_pcm_runtime</span> <span class="o">*</span><span class="n">runtime</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_playback_format</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				     <span class="k">struct</span> <span class="n">snd_pcm_hw_params</span> <span class="o">*</span><span class="n">hw_params</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">pdfr</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_capture_format</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
				    <span class="k">struct</span> <span class="n">snd_pcm_hw_params</span> <span class="o">*</span><span class="n">hw_params</span><span class="p">,</span>
				    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">cdfr</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">trigger</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">what</span><span class="p">,</span> <span class="kt">int</span> <span class="n">start</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_PM</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">suspend</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">resume</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="cp">#endif</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">dma_private_data</span><span class="p">;</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">claim_dma</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
			  <span class="kt">void</span> <span class="o">*</span><span class="n">dma_private_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">release_dma</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
			    <span class="kt">void</span> <span class="o">*</span><span class="n">dma_private_data</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* exported functions */</span>

<span class="kt">void</span> <span class="n">snd_wss_out</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">val</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">snd_wss_in</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_cs4236_ext_out</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span>
			<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">val</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">snd_cs4236_ext_in</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_wss_mce_up</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">snd_wss_mce_down</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">snd_wss_overrange</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>

<span class="n">irqreturn_t</span> <span class="n">snd_wss_interrupt</span><span class="p">(</span><span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dev_id</span><span class="p">);</span>

<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">snd_wss_chip_id</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">snd_wss_create</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">port</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cport</span><span class="p">,</span>
		      <span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma2</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hardware</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hwshare</span><span class="p">,</span>
		      <span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">**</span><span class="n">rchip</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_wss_pcm</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">device</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_pcm</span> <span class="o">**</span><span class="n">rpcm</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_wss_timer</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">device</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_timer</span> <span class="o">**</span><span class="n">rtimer</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_wss_mixer</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>

<span class="k">const</span> <span class="k">struct</span> <span class="n">snd_pcm_ops</span> <span class="o">*</span><span class="n">snd_wss_get_pcm_ops</span><span class="p">(</span><span class="kt">int</span> <span class="n">direction</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">snd_cs4236_create</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">port</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">cport</span><span class="p">,</span>
		      <span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dma2</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hardware</span><span class="p">,</span>
		      <span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">hwshare</span><span class="p">,</span>
		      <span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">**</span><span class="n">rchip</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_cs4236_pcm</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">device</span><span class="p">,</span> <span class="k">struct</span> <span class="n">snd_pcm</span> <span class="o">**</span><span class="n">rpcm</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_cs4236_mixer</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_wss</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  mixer library</span>
<span class="cm"> */</span>

<span class="cp">#define WSS_SINGLE(xname, xindex, reg, shift, mask, invert) \</span>
<span class="cp">{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">  .name = xname, \</span>
<span class="cp">  .index = xindex, \</span>
<span class="cp">  .info = snd_wss_info_single, \</span>
<span class="cp">  .get = snd_wss_get_single, \</span>
<span class="cp">  .put = snd_wss_put_single, \</span>
<span class="cp">  .private_value = reg | (shift &lt;&lt; 8) | (mask &lt;&lt; 16) | (invert &lt;&lt; 24) }</span>

<span class="kt">int</span> <span class="n">snd_wss_info_single</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_wss_get_single</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_wss_put_single</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">);</span>

<span class="cp">#define WSS_DOUBLE(xname, xindex, left_reg, right_reg, shift_left, shift_right, mask, invert) \</span>
<span class="cp">{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">  .name = xname, \</span>
<span class="cp">  .index = xindex, \</span>
<span class="cp">  .info = snd_wss_info_double, \</span>
<span class="cp">  .get = snd_wss_get_double, \</span>
<span class="cp">  .put = snd_wss_put_double, \</span>
<span class="cp">  .private_value = left_reg | (right_reg &lt;&lt; 8) | (shift_left &lt;&lt; 16) | \</span>
<span class="cp">		   (shift_right &lt;&lt; 19) | (mask &lt;&lt; 24) | (invert &lt;&lt; 22) }</span>

<span class="cp">#define WSS_SINGLE_TLV(xname, xindex, reg, shift, mask, invert, xtlv) \</span>
<span class="cp">{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">  .access = SNDRV_CTL_ELEM_ACCESS_READWRITE | SNDRV_CTL_ELEM_ACCESS_TLV_READ, \</span>
<span class="cp">  .name = xname, \</span>
<span class="cp">  .index = xindex, \</span>
<span class="cp">  .info = snd_wss_info_single, \</span>
<span class="cp">  .get = snd_wss_get_single, \</span>
<span class="cp">  .put = snd_wss_put_single, \</span>
<span class="cp">  .private_value = reg | (shift &lt;&lt; 8) | (mask &lt;&lt; 16) | (invert &lt;&lt; 24), \</span>
<span class="cp">  .tlv = { .p = (xtlv) } }</span>

<span class="cp">#define WSS_DOUBLE_TLV(xname, xindex, left_reg, right_reg, \</span>
<span class="cp">			shift_left, shift_right, mask, invert, xtlv) \</span>
<span class="cp">{ .iface = SNDRV_CTL_ELEM_IFACE_MIXER, \</span>
<span class="cp">  .access = SNDRV_CTL_ELEM_ACCESS_READWRITE | SNDRV_CTL_ELEM_ACCESS_TLV_READ, \</span>
<span class="cp">  .name = xname, \</span>
<span class="cp">  .index = xindex, \</span>
<span class="cp">  .info = snd_wss_info_double, \</span>
<span class="cp">  .get = snd_wss_get_double, \</span>
<span class="cp">  .put = snd_wss_put_double, \</span>
<span class="cp">  .private_value = left_reg | (right_reg &lt;&lt; 8) | (shift_left &lt;&lt; 16) | \</span>
<span class="cp">		   (shift_right &lt;&lt; 19) | (mask &lt;&lt; 24) | (invert &lt;&lt; 22), \</span>
<span class="cp">  .tlv = { .p = (xtlv) } }</span>


<span class="kt">int</span> <span class="n">snd_wss_info_double</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_info</span> <span class="o">*</span><span class="n">uinfo</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_wss_get_double</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">snd_wss_put_double</span><span class="p">(</span><span class="k">struct</span> <span class="n">snd_kcontrol</span> <span class="o">*</span><span class="n">kcontrol</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">snd_ctl_elem_value</span> <span class="o">*</span><span class="n">ucontrol</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __SOUND_WSS_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
