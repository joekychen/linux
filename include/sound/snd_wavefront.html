<!DOCTYPE html>
<html><head><title>joekychen/linux » include › sound › snd_wavefront.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>snd_wavefront.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __SOUND_SND_WAVEFRONT_H__</span>
<span class="cp">#define __SOUND_SND_WAVEFRONT_H__</span>

<span class="cp">#include &quot;mpu401.h&quot;</span>
<span class="cp">#include &quot;hwdep.h&quot;</span>
<span class="cp">#include &quot;rawmidi.h&quot;</span>
<span class="cp">#include &quot;wavefront.h&quot;  </span><span class="cm">/* generic OSS/ALSA/user-level wavefront header */</span><span class="cp"></span>

<span class="cm">/* MIDI interface */</span>

<span class="k">struct</span> <span class="n">_snd_wavefront_midi</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">_snd_wavefront_card</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">_snd_wavefront</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_snd_wavefront_midi</span> <span class="n">snd_wavefront_midi_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_snd_wavefront_card</span> <span class="n">snd_wavefront_card_t</span><span class="p">;</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_snd_wavefront</span> <span class="n">snd_wavefront_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span> <span class="n">internal_mpu</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">external_mpu</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">}</span> <span class="n">snd_wavefront_mpu_id</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">_snd_wavefront_midi</span> <span class="p">{</span>
        <span class="kt">unsigned</span> <span class="kt">long</span>            <span class="n">base</span><span class="p">;</span>        <span class="cm">/* I/O port address */</span>
	<span class="kt">char</span>                     <span class="n">isvirtual</span><span class="p">;</span>   <span class="cm">/* doing virtual MIDI stuff ? */</span>
	<span class="kt">char</span>			 <span class="n">istimer</span><span class="p">;</span>     <span class="cm">/* timer is used */</span>
        <span class="n">snd_wavefront_mpu_id</span>     <span class="n">output_mpu</span><span class="p">;</span>  <span class="cm">/* most-recently-used */</span>
        <span class="n">snd_wavefront_mpu_id</span>     <span class="n">input_mpu</span><span class="p">;</span>   <span class="cm">/* most-recently-used */</span>
        <span class="kt">unsigned</span> <span class="kt">int</span>             <span class="n">mode</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>     <span class="cm">/* MPU401_MODE_XXX */</span>
	<span class="k">struct</span> <span class="n">snd_rawmidi_substream</span>	 <span class="o">*</span><span class="n">substream_output</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">snd_rawmidi_substream</span>	 <span class="o">*</span><span class="n">substream_input</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">timer_list</span>	 <span class="n">timer</span><span class="p">;</span>
        <span class="n">spinlock_t</span>               <span class="n">open</span><span class="p">;</span>
        <span class="n">spinlock_t</span>               <span class="k">virtual</span><span class="p">;</span>     <span class="cm">/* protects isvirtual */</span>
<span class="p">};</span>

<span class="cp">#define	OUTPUT_READY	0x40</span>
<span class="cp">#define	INPUT_AVAIL	0x80</span>
<span class="cp">#define	MPU_ACK		0xFE</span>
<span class="cp">#define	UART_MODE_ON	0x3F</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">snd_rawmidi_ops</span> <span class="n">snd_wavefront_midi_output</span><span class="p">;</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">snd_rawmidi_ops</span> <span class="n">snd_wavefront_midi_input</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">void</span>   <span class="n">snd_wavefront_midi_enable_virtual</span> <span class="p">(</span><span class="n">snd_wavefront_card_t</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>   <span class="n">snd_wavefront_midi_disable_virtual</span> <span class="p">(</span><span class="n">snd_wavefront_card_t</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span>   <span class="n">snd_wavefront_midi_interrupt</span> <span class="p">(</span><span class="n">snd_wavefront_card_t</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>    <span class="n">snd_wavefront_midi_start</span> <span class="p">(</span><span class="n">snd_wavefront_card_t</span> <span class="o">*</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">_snd_wavefront</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>    <span class="n">irq</span><span class="p">;</span>   <span class="cm">/* &quot;you were one, one of the few ...&quot; */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span>    <span class="n">base</span><span class="p">;</span>  <span class="cm">/* low i/o port address */</span>
	<span class="k">struct</span> <span class="n">resource</span>	 <span class="o">*</span><span class="n">res_base</span><span class="p">;</span> <span class="cm">/* i/o port resource allocation */</span>

<span class="cp">#define mpu_data_port    base </span>
<span class="cp">#define mpu_command_port base + 1 </span><span class="cm">/* write semantics */</span><span class="cp"></span>
<span class="cp">#define mpu_status_port  base + 1 </span><span class="cm">/* read semantics */</span><span class="cp"></span>
<span class="cp">#define data_port        base + 2 </span>
<span class="cp">#define status_port      base + 3 </span><span class="cm">/* read semantics */</span><span class="cp"></span>
<span class="cp">#define control_port     base + 3 </span><span class="cm">/* write semantics  */</span><span class="cp"></span>
<span class="cp">#define block_port       base + 4 </span><span class="cm">/* 16 bit, writeonly */</span><span class="cp"></span>
<span class="cp">#define last_block_port  base + 6 </span><span class="cm">/* 16 bit, writeonly */</span><span class="cp"></span>

	<span class="cm">/* FX ports. These are mapped through the ICS2115 to the YS225.</span>
<span class="cm">	   The ICS2115 takes care of flipping the relevant pins on the</span>
<span class="cm">	   YS225 so that access to each of these ports does the right</span>
<span class="cm">	   thing. Note: these are NOT documented by Turtle Beach.</span>
<span class="cm">	*/</span>

<span class="cp">#define fx_status       base + 8 </span>
<span class="cp">#define fx_op           base + 8 </span>
<span class="cp">#define fx_lcr          base + 9 </span>
<span class="cp">#define fx_dsp_addr     base + 0xa</span>
<span class="cp">#define fx_dsp_page     base + 0xb </span>
<span class="cp">#define fx_dsp_lsb      base + 0xc </span>
<span class="cp">#define fx_dsp_msb      base + 0xd </span>
<span class="cp">#define fx_mod_addr     base + 0xe</span>
<span class="cp">#define fx_mod_data     base + 0xf </span>

	<span class="k">volatile</span> <span class="kt">int</span> <span class="n">irq_ok</span><span class="p">;</span>               <span class="cm">/* set by interrupt handler */</span>
        <span class="k">volatile</span> <span class="kt">int</span> <span class="n">irq_cnt</span><span class="p">;</span>              <span class="cm">/* ditto */</span>
	<span class="kt">char</span> <span class="n">debug</span><span class="p">;</span>                        <span class="cm">/* debugging flags */</span>
	<span class="kt">int</span> <span class="n">freemem</span><span class="p">;</span>                       <span class="cm">/* installed RAM, in bytes */</span> 

	<span class="kt">char</span> <span class="n">fw_version</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>                <span class="cm">/* major = [0], minor = [1] */</span>
	<span class="kt">char</span> <span class="n">hw_version</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>                <span class="cm">/* major = [0], minor = [1] */</span>
	<span class="kt">char</span> <span class="n">israw</span><span class="p">;</span>                        <span class="cm">/* needs Motorola microcode */</span>
	<span class="kt">char</span> <span class="n">has_fx</span><span class="p">;</span>                       <span class="cm">/* has FX processor (Tropez+) */</span>
	<span class="kt">char</span> <span class="n">fx_initialized</span><span class="p">;</span>               <span class="cm">/* FX&#39;s register pages initialized */</span>
	<span class="kt">char</span> <span class="n">prog_status</span><span class="p">[</span><span class="n">WF_MAX_PROGRAM</span><span class="p">];</span>  <span class="cm">/* WF_SLOT_* */</span>
	<span class="kt">char</span> <span class="n">patch_status</span><span class="p">[</span><span class="n">WF_MAX_PATCH</span><span class="p">];</span>   <span class="cm">/* WF_SLOT_* */</span>
	<span class="kt">char</span> <span class="n">sample_status</span><span class="p">[</span><span class="n">WF_MAX_SAMPLE</span><span class="p">];</span> <span class="cm">/* WF_ST_* | WF_SLOT_* */</span>
	<span class="kt">int</span> <span class="n">samples_used</span><span class="p">;</span>                  <span class="cm">/* how many */</span>
	<span class="kt">char</span> <span class="n">interrupts_are_midi</span><span class="p">;</span>          <span class="cm">/* h/w MPU interrupts enabled ? */</span>
	<span class="kt">char</span> <span class="n">rom_samples_rdonly</span><span class="p">;</span>           <span class="cm">/* can we write on ROM samples */</span>
	<span class="n">spinlock_t</span> <span class="n">irq_lock</span><span class="p">;</span>
	<span class="n">wait_queue_head_t</span> <span class="n">interrupt_sleeper</span><span class="p">;</span> 
	<span class="n">snd_wavefront_midi_t</span> <span class="n">midi</span><span class="p">;</span>         <span class="cm">/* ICS2115 MIDI interface */</span>
	<span class="k">struct</span> <span class="n">snd_card</span> <span class="o">*</span><span class="n">card</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">_snd_wavefront_card</span> <span class="p">{</span>
	<span class="n">snd_wavefront_t</span> <span class="n">wavefront</span><span class="p">;</span>
<span class="cp">#ifdef CONFIG_PNP</span>
	<span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">wss</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">ctrl</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">mpu</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">synth</span><span class="p">;</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_PNP */</span><span class="cp"></span>
<span class="p">};</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">snd_wavefront_internal_interrupt</span> <span class="p">(</span><span class="n">snd_wavefront_card_t</span> <span class="o">*</span><span class="n">card</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="nf">snd_wavefront_detect_irq</span> <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_check_irq</span> <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">irq</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_restart</span> <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_start</span> <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_detect</span> <span class="p">(</span><span class="n">snd_wavefront_card_t</span> <span class="o">*</span><span class="n">card</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="nf">snd_wavefront_config_midi</span> <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span> <span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_cmd</span> <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span>
			       <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">snd_wavefront_synth_ioctl</span>   <span class="p">(</span><span class="k">struct</span> <span class="n">snd_hwdep</span> <span class="o">*</span><span class="p">,</span> 
					<span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="p">,</span>
					<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span> 
					<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_synth_open</span>    <span class="p">(</span><span class="k">struct</span> <span class="n">snd_hwdep</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_synth_release</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_hwdep</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/* FX processor - see also yss225.[ch] */</span>

<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_fx_start</span>  <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_fx_detect</span> <span class="p">(</span><span class="n">snd_wavefront_t</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span>  <span class="n">snd_wavefront_fx_ioctl</span>  <span class="p">(</span><span class="k">struct</span> <span class="n">snd_hwdep</span> <span class="o">*</span><span class="p">,</span> 
				     <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="p">,</span>
				     <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span> 
				     <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">snd_wavefront_fx_open</span>    <span class="p">(</span><span class="k">struct</span> <span class="n">snd_hwdep</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">snd_wavefront_fx_release</span> <span class="p">(</span><span class="k">struct</span> <span class="n">snd_hwdep</span> <span class="o">*</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/* prefix in all snd_printk() delivered messages */</span>

<span class="cp">#define LOGNAME &quot;WaveFront: &quot;</span>

<span class="cp">#endif  </span><span class="cm">/* __SOUND_SND_WAVEFRONT_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
