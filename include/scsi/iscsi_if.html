<!DOCTYPE html>
<html><head><title>joekychen/linux » include › scsi › iscsi_if.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>iscsi_if.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * iSCSI User/Kernel Shares (Defines, Constants, Protocol definitions, etc)</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2005 Dmitry Yusupov</span>
<span class="cm"> * Copyright (C) 2005 Alex Aizman</span>
<span class="cm"> * maintained by open-iscsi@googlegroups.com</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published</span>
<span class="cm"> * by the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * See the file COPYING included with this distribution for more details.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef ISCSI_IF_H</span>
<span class="cp">#define ISCSI_IF_H</span>

<span class="cp">#include &lt;scsi/iscsi_proto.h&gt;</span>
<span class="cp">#include &lt;linux/in.h&gt;</span>
<span class="cp">#include &lt;linux/in6.h&gt;</span>

<span class="cp">#define ISCSI_NL_GRP_ISCSID	1</span>
<span class="cp">#define ISCSI_NL_GRP_UIP	2</span>

<span class="cp">#define UEVENT_BASE			10</span>
<span class="cp">#define KEVENT_BASE			100</span>
<span class="cp">#define ISCSI_ERR_BASE			1000</span>

<span class="k">enum</span> <span class="n">iscsi_uevent_e</span> <span class="p">{</span>
	<span class="n">ISCSI_UEVENT_UNKNOWN</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

	<span class="cm">/* down events */</span>
	<span class="n">ISCSI_UEVENT_CREATE_SESSION</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_DESTROY_SESSION</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_CREATE_CONN</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_DESTROY_CONN</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_BIND_CONN</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_SET_PARAM</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_START_CONN</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_STOP_CONN</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_SEND_PDU</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_GET_STATS</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_GET_PARAM</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span>

	<span class="n">ISCSI_UEVENT_TRANSPORT_EP_CONNECT</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_TRANSPORT_EP_POLL</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_TRANSPORT_EP_DISCONNECT</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">14</span><span class="p">,</span>

	<span class="n">ISCSI_UEVENT_TGT_DSCVR</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_SET_HOST_PARAM</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_UNBIND_SESSION</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_CREATE_BOUND_SESSION</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_TRANSPORT_EP_CONNECT_THROUGH_HOST</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">19</span><span class="p">,</span>

	<span class="n">ISCSI_UEVENT_PATH_UPDATE</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_SET_IFACE_PARAMS</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_PING</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_GET_CHAP</span>		<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">ISCSI_UEVENT_DELETE_CHAP</span>	<span class="o">=</span> <span class="n">UEVENT_BASE</span> <span class="o">+</span> <span class="mi">24</span><span class="p">,</span>

	<span class="cm">/* up events */</span>
	<span class="n">ISCSI_KEVENT_RECV_PDU</span>		<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_CONN_ERROR</span>		<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_IF_ERROR</span>		<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_DESTROY_SESSION</span>	<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_UNBIND_SESSION</span>	<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_CREATE_SESSION</span>	<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span>

	<span class="n">ISCSI_KEVENT_PATH_REQ</span>		<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_IF_DOWN</span>		<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_CONN_LOGIN_STATE</span>   <span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_HOST_EVENT</span>		<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">ISCSI_KEVENT_PING_COMP</span>		<span class="o">=</span> <span class="n">KEVENT_BASE</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">iscsi_tgt_dscvr</span> <span class="p">{</span>
	<span class="n">ISCSI_TGT_DSCVR_SEND_TARGETS</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ISCSI_TGT_DSCVR_ISNS</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ISCSI_TGT_DSCVR_SLP</span>		<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">iscsi_host_event_code</span> <span class="p">{</span>
	<span class="n">ISCSI_EVENT_LINKUP</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ISCSI_EVENT_LINKDOWN</span><span class="p">,</span>
	<span class="cm">/* must always be last */</span>
	<span class="n">ISCSI_EVENT_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">iscsi_uevent</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">type</span><span class="p">;</span> <span class="cm">/* k/u events type */</span>
	<span class="kt">uint32_t</span> <span class="n">iferror</span><span class="p">;</span> <span class="cm">/* carries interface or resource errors */</span>
	<span class="kt">uint64_t</span> <span class="n">transport_handle</span><span class="p">;</span>

	<span class="k">union</span> <span class="p">{</span>
		<span class="cm">/* messages u -&gt; k */</span>
		<span class="k">struct</span> <span class="n">msg_create_session</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">initial_cmdsn</span><span class="p">;</span>
			<span class="kt">uint16_t</span>	<span class="n">cmds_max</span><span class="p">;</span>
			<span class="kt">uint16_t</span>	<span class="n">queue_depth</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">c_session</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_create_bound_session</span> <span class="p">{</span>
			<span class="kt">uint64_t</span>	<span class="n">ep_handle</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">initial_cmdsn</span><span class="p">;</span>
			<span class="kt">uint16_t</span>	<span class="n">cmds_max</span><span class="p">;</span>
			<span class="kt">uint16_t</span>	<span class="n">queue_depth</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">c_bound_session</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_destroy_session</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">d_session</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_create_conn</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">c_conn</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_bind_conn</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
			<span class="kt">uint64_t</span>	<span class="n">transport_eph</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">is_leading</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">b_conn</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_destroy_conn</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">d_conn</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_send_pdu</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">hdr_size</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">data_size</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">send_pdu</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_set_param</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">param</span><span class="p">;</span> <span class="cm">/* enum iscsi_param */</span>
			<span class="kt">uint32_t</span>	<span class="n">len</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">set_param</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_start_conn</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">start_conn</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_stop_conn</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
			<span class="kt">uint64_t</span>	<span class="n">conn_handle</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">flag</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">stop_conn</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_get_stats</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">get_stats</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_transport_connect</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">non_blocking</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">ep_connect</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_transport_connect_through_host</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">non_blocking</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">ep_connect_through_host</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_transport_poll</span> <span class="p">{</span>
			<span class="kt">uint64_t</span>	<span class="n">ep_handle</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">timeout_ms</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">ep_poll</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_transport_disconnect</span> <span class="p">{</span>
			<span class="kt">uint64_t</span>	<span class="n">ep_handle</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">ep_disconnect</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_tgt_dscvr</span> <span class="p">{</span>
			<span class="k">enum</span> <span class="n">iscsi_tgt_dscvr</span>	<span class="n">type</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
			<span class="cm">/*</span>
<span class="cm"> 			 * enable = 1 to establish a new connection</span>
<span class="cm">			 * with the server. enable = 0 to disconnect</span>
<span class="cm">			 * from the server. Used primarily to switch</span>
<span class="cm">			 * from one iSNS server to another.</span>
<span class="cm">			 */</span>
			<span class="kt">uint32_t</span>	<span class="n">enable</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">tgt_dscvr</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_set_host_param</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">param</span><span class="p">;</span> <span class="cm">/* enum iscsi_host_param */</span>
			<span class="kt">uint32_t</span>	<span class="n">len</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">set_host_param</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_set_path</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">set_path</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_set_iface_params</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">count</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">set_iface_params</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_iscsi_ping</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>        <span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>        <span class="n">iface_num</span><span class="p">;</span>
			<span class="kt">uint32_t</span>        <span class="n">iface_type</span><span class="p">;</span>
			<span class="kt">uint32_t</span>        <span class="n">payload_size</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">pid</span><span class="p">;</span>	<span class="cm">/* unique ping id associated</span>
<span class="cm">						   with each ping request */</span>
		<span class="p">}</span> <span class="n">iscsi_ping</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_get_chap</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">num_entries</span><span class="p">;</span> <span class="cm">/* number of CHAP entries</span>
<span class="cm">						      * on request, number of</span>
<span class="cm">						      * valid CHAP entries on</span>
<span class="cm">						      * response */</span>
			<span class="kt">uint16_t</span>	<span class="n">chap_tbl_idx</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">get_chap</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_delete_chap</span> <span class="p">{</span>
		       <span class="kt">uint32_t</span>        <span class="n">host_no</span><span class="p">;</span>
		       <span class="kt">uint16_t</span>        <span class="n">chap_tbl_idx</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">delete_chap</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="cm">/* messages k -&gt; u */</span>
		<span class="kt">int</span>			<span class="n">retcode</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_create_session_ret</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">c_session_ret</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_create_conn_ret</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">c_conn_ret</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_unbind_session</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">unbind_session</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_recv_req</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
			<span class="kt">uint64_t</span>	<span class="n">recv_handle</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">recv_req</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_conn_login</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>        <span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>        <span class="n">cid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>        <span class="n">state</span><span class="p">;</span> <span class="cm">/* enum iscsi_conn_state */</span>
		<span class="p">}</span> <span class="n">conn_login</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_conn_error</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">cid</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">error</span><span class="p">;</span> <span class="cm">/* enum iscsi_err */</span>
		<span class="p">}</span> <span class="n">connerror</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_session_destroyed</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">sid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">d_session</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_transport_connect_ret</span> <span class="p">{</span>
			<span class="kt">uint64_t</span>	<span class="n">handle</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">ep_connect_ret</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_req_path</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">req_path</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_notify_if_down</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">notify_if_down</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_host_event</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>	<span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>	<span class="n">data_size</span><span class="p">;</span>
			<span class="k">enum</span> <span class="n">iscsi_host_event_code</span> <span class="n">code</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">host_event</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">msg_ping_comp</span> <span class="p">{</span>
			<span class="kt">uint32_t</span>        <span class="n">host_no</span><span class="p">;</span>
			<span class="kt">uint32_t</span>        <span class="n">status</span><span class="p">;</span> <span class="cm">/* enum</span>
<span class="cm">						 * iscsi_ping_status_code */</span>
			<span class="kt">uint32_t</span>	<span class="n">pid</span><span class="p">;</span>	<span class="cm">/* unique ping id associated</span>
<span class="cm">						   with each ping request */</span>
			<span class="kt">uint32_t</span>        <span class="n">data_size</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">ping_comp</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">aligned</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">))));</span>

<span class="k">enum</span> <span class="n">iscsi_param_type</span> <span class="p">{</span>
	<span class="n">ISCSI_PARAM</span><span class="p">,</span>		<span class="cm">/* iscsi_param (session, conn, target, LU) */</span>
	<span class="n">ISCSI_HOST_PARAM</span><span class="p">,</span>	<span class="cm">/* iscsi_host_param */</span>
	<span class="n">ISCSI_NET_PARAM</span><span class="p">,</span>	<span class="cm">/* iscsi_net_param */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">iscsi_iface_param_info</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">iface_num</span><span class="p">;</span>	<span class="cm">/* iface number, 0 - n */</span>
	<span class="kt">uint32_t</span> <span class="n">len</span><span class="p">;</span>		<span class="cm">/* Actual length of the param */</span>
	<span class="kt">uint16_t</span> <span class="n">param</span><span class="p">;</span>		<span class="cm">/* iscsi param value */</span>
	<span class="kt">uint8_t</span> <span class="n">iface_type</span><span class="p">;</span>	<span class="cm">/* IPv4 or IPv6 */</span>
	<span class="kt">uint8_t</span> <span class="n">param_type</span><span class="p">;</span>	<span class="cm">/* iscsi_param_type */</span>
	<span class="kt">uint8_t</span> <span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>	<span class="cm">/* length sized value follows */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * To keep the struct iscsi_uevent size the same for userspace code</span>
<span class="cm"> * compatibility, the main structure for ISCSI_UEVENT_PATH_UPDATE and</span>
<span class="cm"> * ISCSI_KEVENT_PATH_REQ is defined separately and comes after the</span>
<span class="cm"> * struct iscsi_uevent in the NETLINK_ISCSI message.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">iscsi_path</span> <span class="p">{</span>
	<span class="kt">uint64_t</span>	<span class="n">handle</span><span class="p">;</span>
	<span class="kt">uint8_t</span>		<span class="n">mac_addr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="kt">uint8_t</span>		<span class="n">mac_addr_old</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="kt">uint32_t</span>	<span class="n">ip_addr_len</span><span class="p">;</span>	<span class="cm">/* 4 or 16 */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">in_addr</span>	<span class="n">v4_addr</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">in6_addr</span>	<span class="n">v6_addr</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">src</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">in_addr</span>	<span class="n">v4_addr</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">in6_addr</span>	<span class="n">v6_addr</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">dst</span><span class="p">;</span>
	<span class="kt">uint16_t</span>	<span class="n">vlan_id</span><span class="p">;</span>
	<span class="kt">uint16_t</span>	<span class="n">pmtu</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">aligned</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">))));</span>

<span class="cm">/* iscsi iface enabled/disabled setting */</span>
<span class="cp">#define ISCSI_IFACE_DISABLE	0x01</span>
<span class="cp">#define ISCSI_IFACE_ENABLE	0x02</span>

<span class="cm">/* ipv4 bootproto */</span>
<span class="cp">#define ISCSI_BOOTPROTO_STATIC		0x01</span>
<span class="cp">#define ISCSI_BOOTPROTO_DHCP		0x02</span>

<span class="cm">/* ipv6 addr autoconfig type */</span>
<span class="cp">#define ISCSI_IPV6_AUTOCFG_DISABLE		0x01</span>
<span class="cp">#define ISCSI_IPV6_AUTOCFG_ND_ENABLE		0x02</span>
<span class="cp">#define ISCSI_IPV6_AUTOCFG_DHCPV6_ENABLE	0x03</span>

<span class="cm">/* ipv6 link local addr type */</span>
<span class="cp">#define ISCSI_IPV6_LINKLOCAL_AUTOCFG_ENABLE	0x01</span>
<span class="cp">#define ISCSI_IPV6_LINKLOCAL_AUTOCFG_DISABLE	0x02</span>

<span class="cm">/* ipv6 router addr type */</span>
<span class="cp">#define ISCSI_IPV6_ROUTER_AUTOCFG_ENABLE	0x01</span>
<span class="cp">#define ISCSI_IPV6_ROUTER_AUTOCFG_DISABLE	0x02</span>

<span class="cp">#define ISCSI_IFACE_TYPE_IPV4		0x01</span>
<span class="cp">#define ISCSI_IFACE_TYPE_IPV6		0x02</span>

<span class="cp">#define ISCSI_MAX_VLAN_ID		4095</span>
<span class="cp">#define ISCSI_MAX_VLAN_PRIORITY		7</span>

<span class="cm">/* iscsi vlan enable/disabled setting */</span>
<span class="cp">#define ISCSI_VLAN_DISABLE	0x01</span>
<span class="cp">#define ISCSI_VLAN_ENABLE	0x02</span>

<span class="cm">/* iSCSI network params */</span>
<span class="k">enum</span> <span class="n">iscsi_net_param</span> <span class="p">{</span>
	<span class="n">ISCSI_NET_PARAM_IPV4_ADDR</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV4_SUBNET</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV4_GW</span>			<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV4_BOOTPROTO</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_MAC</span>			<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV6_LINKLOCAL</span>		<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV6_ADDR</span>		<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV6_ROUTER</span>		<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV6_ADDR_AUTOCFG</span>	<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV6_LINKLOCAL_AUTOCFG</span>	<span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IPV6_ROUTER_AUTOCFG</span>	<span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IFACE_ENABLE</span>		<span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_VLAN_ID</span>			<span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_VLAN_PRIORITY</span>		<span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_VLAN_ENABLED</span>		<span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_VLAN_TAG</span>		<span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IFACE_TYPE</span>		<span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_IFACE_NAME</span>		<span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_MTU</span>			<span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">ISCSI_NET_PARAM_PORT</span>			<span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">iscsi_conn_state</span> <span class="p">{</span>
	<span class="n">ISCSI_CONN_STATE_FREE</span><span class="p">,</span>
	<span class="n">ISCSI_CONN_STATE_XPT_WAIT</span><span class="p">,</span>
	<span class="n">ISCSI_CONN_STATE_IN_LOGIN</span><span class="p">,</span>
	<span class="n">ISCSI_CONN_STATE_LOGGED_IN</span><span class="p">,</span>
	<span class="n">ISCSI_CONN_STATE_IN_LOGOUT</span><span class="p">,</span>
	<span class="n">ISCSI_CONN_STATE_LOGOUT_REQUESTED</span><span class="p">,</span>
	<span class="n">ISCSI_CONN_STATE_CLEANUP_WAIT</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Common error codes</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">iscsi_err</span> <span class="p">{</span>
	<span class="n">ISCSI_OK</span>			<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

	<span class="n">ISCSI_ERR_DATASN</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_DATA_OFFSET</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_MAX_CMDSN</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_EXP_CMDSN</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_BAD_OPCODE</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_DATALEN</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_AHSLEN</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_PROTO</span>			<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_LUN</span>			<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_BAD_ITT</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_CONN_FAILED</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_R2TSN</span>			<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_SESSION_FAILED</span>	<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_HDR_DGST</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_DATA_DGST</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_PARAM_NOT_FOUND</span>	<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_NO_SCSI_CMD</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_INVALID_HOST</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_XMIT_FAILED</span>		<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_TCP_CONN_CLOSE</span>	<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">ISCSI_ERR_SCSI_EH_SESSION_RST</span>	<span class="o">=</span> <span class="n">ISCSI_ERR_BASE</span> <span class="o">+</span> <span class="mi">21</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * iSCSI Parameters (RFC3720)</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">iscsi_param</span> <span class="p">{</span>
	<span class="cm">/* passed in using netlink set param */</span>
	<span class="n">ISCSI_PARAM_MAX_RECV_DLENGTH</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_MAX_XMIT_DLENGTH</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_HDRDGST_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_DATADGST_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_INITIAL_R2T_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_MAX_R2T</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_IMM_DATA_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_FIRST_BURST</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_MAX_BURST</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_PDU_INORDER_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_DATASEQ_INORDER_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_ERL</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_IFMARKER_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_OFMARKER_EN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_EXP_STATSN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_TARGET_NAME</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_TPGT</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_PERSISTENT_ADDRESS</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_PERSISTENT_PORT</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_SESS_RECOVERY_TMO</span><span class="p">,</span>

	<span class="cm">/* passed in through bind conn using transport_fd */</span>
	<span class="n">ISCSI_PARAM_CONN_PORT</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_CONN_ADDRESS</span><span class="p">,</span>

	<span class="n">ISCSI_PARAM_USERNAME</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_USERNAME_IN</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_PASSWORD</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_PASSWORD_IN</span><span class="p">,</span>

	<span class="n">ISCSI_PARAM_FAST_ABORT</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_ABORT_TMO</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_LU_RESET_TMO</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_HOST_RESET_TMO</span><span class="p">,</span>

	<span class="n">ISCSI_PARAM_PING_TMO</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_RECV_TMO</span><span class="p">,</span>

	<span class="n">ISCSI_PARAM_IFACE_NAME</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_ISID</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_INITIATOR_NAME</span><span class="p">,</span>

	<span class="n">ISCSI_PARAM_TGT_RESET_TMO</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_TARGET_ALIAS</span><span class="p">,</span>

	<span class="n">ISCSI_PARAM_CHAP_IN_IDX</span><span class="p">,</span>
	<span class="n">ISCSI_PARAM_CHAP_OUT_IDX</span><span class="p">,</span>
	<span class="cm">/* must always be last */</span>
	<span class="n">ISCSI_PARAM_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* iSCSI HBA params */</span>
<span class="k">enum</span> <span class="n">iscsi_host_param</span> <span class="p">{</span>
	<span class="n">ISCSI_HOST_PARAM_HWADDRESS</span><span class="p">,</span>
	<span class="n">ISCSI_HOST_PARAM_INITIATOR_NAME</span><span class="p">,</span>
	<span class="n">ISCSI_HOST_PARAM_NETDEV_NAME</span><span class="p">,</span>
	<span class="n">ISCSI_HOST_PARAM_IPADDRESS</span><span class="p">,</span>
	<span class="n">ISCSI_HOST_PARAM_PORT_STATE</span><span class="p">,</span>
	<span class="n">ISCSI_HOST_PARAM_PORT_SPEED</span><span class="p">,</span>
	<span class="n">ISCSI_HOST_PARAM_MAX</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* iSCSI port Speed */</span>
<span class="k">enum</span> <span class="n">iscsi_port_speed</span> <span class="p">{</span>
	<span class="n">ISCSI_PORT_SPEED_UNKNOWN</span>	<span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">ISCSI_PORT_SPEED_10MBPS</span>		<span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">ISCSI_PORT_SPEED_100MBPS</span>	<span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">ISCSI_PORT_SPEED_1GBPS</span>		<span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">ISCSI_PORT_SPEED_10GBPS</span>		<span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* iSCSI port state */</span>
<span class="k">enum</span> <span class="n">iscsi_port_state</span> <span class="p">{</span>
	<span class="n">ISCSI_PORT_STATE_DOWN</span>		<span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">ISCSI_PORT_STATE_UP</span>		<span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* iSCSI PING status/error code */</span>
<span class="k">enum</span> <span class="n">iscsi_ping_status_code</span> <span class="p">{</span>
	<span class="n">ISCSI_PING_SUCCESS</span>			<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">ISCSI_PING_FW_DISABLED</span>			<span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">ISCSI_PING_IPADDR_INVALID</span>		<span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">ISCSI_PING_LINKLOCAL_IPV6_ADDR_INVALID</span>	<span class="o">=</span> <span class="mh">0x3</span><span class="p">,</span>
	<span class="n">ISCSI_PING_TIMEOUT</span>			<span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">ISCSI_PING_INVALID_DEST_ADDR</span>		<span class="o">=</span> <span class="mh">0x5</span><span class="p">,</span>
	<span class="n">ISCSI_PING_OVERSIZE_PACKET</span>		<span class="o">=</span> <span class="mh">0x6</span><span class="p">,</span>
	<span class="n">ISCSI_PING_ICMP_ERROR</span>			<span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">ISCSI_PING_MAX_REQ_EXCEEDED</span>		<span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">ISCSI_PING_NO_ARP_RECEIVED</span>		<span class="o">=</span> <span class="mh">0x9</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define iscsi_ptr(_handle) ((void*)(unsigned long)_handle)</span>
<span class="cp">#define iscsi_handle(_ptr) ((uint64_t)(unsigned long)_ptr)</span>

<span class="cm">/*</span>
<span class="cm"> * These flags presents iSCSI Data-Path capabilities.</span>
<span class="cm"> */</span>
<span class="cp">#define CAP_RECOVERY_L0		0x1</span>
<span class="cp">#define CAP_RECOVERY_L1		0x2</span>
<span class="cp">#define CAP_RECOVERY_L2		0x4</span>
<span class="cp">#define CAP_MULTI_R2T		0x8</span>
<span class="cp">#define CAP_HDRDGST		0x10</span>
<span class="cp">#define CAP_DATADGST		0x20</span>
<span class="cp">#define CAP_MULTI_CONN		0x40</span>
<span class="cp">#define CAP_TEXT_NEGO		0x80</span>
<span class="cp">#define CAP_MARKERS		0x100</span>
<span class="cp">#define CAP_FW_DB		0x200</span>
<span class="cp">#define CAP_SENDTARGETS_OFFLOAD	0x400	</span><span class="cm">/* offload discovery process */</span><span class="cp"></span>
<span class="cp">#define CAP_DATA_PATH_OFFLOAD	0x800	</span><span class="cm">/* offload entire IO path */</span><span class="cp"></span>
<span class="cp">#define CAP_DIGEST_OFFLOAD	0x1000	</span><span class="cm">/* offload hdr and data digests */</span><span class="cp"></span>
<span class="cp">#define CAP_PADDING_OFFLOAD	0x2000	</span><span class="cm">/* offload padding insertion, removal,</span>
<span class="cm">					 and verification */</span><span class="cp"></span>
<span class="cp">#define CAP_LOGIN_OFFLOAD	0x4000  </span><span class="cm">/* offload session login */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * These flags describes reason of stop_conn() call</span>
<span class="cm"> */</span>
<span class="cp">#define STOP_CONN_TERM		0x1</span>
<span class="cp">#define STOP_CONN_SUSPEND	0x2</span>
<span class="cp">#define STOP_CONN_RECOVER	0x3</span>

<span class="cp">#define ISCSI_STATS_CUSTOM_MAX		32</span>
<span class="cp">#define ISCSI_STATS_CUSTOM_DESC_MAX	64</span>
<span class="k">struct</span> <span class="n">iscsi_stats_custom</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="n">desc</span><span class="p">[</span><span class="n">ISCSI_STATS_CUSTOM_DESC_MAX</span><span class="p">];</span>
	<span class="kt">uint64_t</span> <span class="n">value</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * struct iscsi_stats - iSCSI Statistics (iSCSI MIB)</span>
<span class="cm"> *</span>
<span class="cm"> * Note: this structure contains counters collected on per-connection basis.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">iscsi_stats</span> <span class="p">{</span>
	<span class="cm">/* octets */</span>
	<span class="kt">uint64_t</span> <span class="n">txdata_octets</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">rxdata_octets</span><span class="p">;</span>

	<span class="cm">/* xmit pdus */</span>
	<span class="kt">uint32_t</span> <span class="n">noptx_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">scsicmd_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">tmfcmd_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">login_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">text_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">dataout_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">logout_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">snack_pdus</span><span class="p">;</span>

	<span class="cm">/* recv pdus */</span>
	<span class="kt">uint32_t</span> <span class="n">noprx_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">scsirsp_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">tmfrsp_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">textrsp_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">datain_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">logoutrsp_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">r2t_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">async_pdus</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">rjt_pdus</span><span class="p">;</span>

	<span class="cm">/* errors */</span>
	<span class="kt">uint32_t</span> <span class="n">digest_err</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">timeout_err</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * iSCSI Custom Statistics support, i.e. Transport could</span>
<span class="cm">	 * extend existing MIB statistics with its own specific statistics</span>
<span class="cm">	 * up to ISCSI_STATS_CUSTOM_MAX</span>
<span class="cm">	 */</span>
	<span class="kt">uint32_t</span> <span class="n">custom_length</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">iscsi_stats_custom</span> <span class="n">custom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="n">__attribute__</span> <span class="p">((</span><span class="n">aligned</span> <span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">))));</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">chap_type_e</span> <span class="p">{</span>
	<span class="n">CHAP_TYPE_OUT</span><span class="p">,</span>
	<span class="n">CHAP_TYPE_IN</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define ISCSI_CHAP_AUTH_NAME_MAX_LEN	256</span>
<span class="cp">#define ISCSI_CHAP_AUTH_SECRET_MAX_LEN	256</span>
<span class="k">struct</span> <span class="n">iscsi_chap_rec</span> <span class="p">{</span>
	<span class="kt">uint16_t</span> <span class="n">chap_tbl_idx</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">chap_type_e</span> <span class="n">chap_type</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">username</span><span class="p">[</span><span class="n">ISCSI_CHAP_AUTH_NAME_MAX_LEN</span><span class="p">];</span>
	<span class="kt">uint8_t</span> <span class="n">password</span><span class="p">[</span><span class="n">ISCSI_CHAP_AUTH_SECRET_MAX_LEN</span><span class="p">];</span>
	<span class="kt">uint8_t</span> <span class="n">password_length</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
