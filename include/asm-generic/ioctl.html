<!DOCTYPE html>
<html><head><title>joekychen/linux » include › asm-generic › ioctl.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>ioctl.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _ASM_GENERIC_IOCTL_H</span>
<span class="cp">#define _ASM_GENERIC_IOCTL_H</span>

<span class="cm">/* ioctl command encoding: 32 bits total, command in lower 16 bits,</span>
<span class="cm"> * size of the parameter structure in the lower 14 bits of the</span>
<span class="cm"> * upper 16 bits.</span>
<span class="cm"> * Encoding the size of the parameter structure in the ioctl request</span>
<span class="cm"> * is useful for catching programs compiled with old versions</span>
<span class="cm"> * and to avoid overwriting user space outside the user buffer area.</span>
<span class="cm"> * The highest 2 bits are reserved for indicating the ``access mode&#39;&#39;.</span>
<span class="cm"> * NOTE: This limits the max parameter size to 16kB -1 !</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * The following is for compatibility across the various Linux</span>
<span class="cm"> * platforms.  The generic ioctl numbering scheme doesn&#39;t really enforce</span>
<span class="cm"> * a type field.  De facto, however, the top 8 bits of the lower 16</span>
<span class="cm"> * bits are indeed used as a type field, so we might just as well make</span>
<span class="cm"> * this explicit here.  Please be sure to use the decoding macros</span>
<span class="cm"> * below from now on.</span>
<span class="cm"> */</span>
<span class="cp">#define _IOC_NRBITS	8</span>
<span class="cp">#define _IOC_TYPEBITS	8</span>

<span class="cm">/*</span>
<span class="cm"> * Let any architecture override either of the following before</span>
<span class="cm"> * including this file.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _IOC_SIZEBITS</span>
<span class="cp"># define _IOC_SIZEBITS	14</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef _IOC_DIRBITS</span>
<span class="cp"># define _IOC_DIRBITS	2</span>
<span class="cp">#endif</span>

<span class="cp">#define _IOC_NRMASK	((1 &lt;&lt; _IOC_NRBITS)-1)</span>
<span class="cp">#define _IOC_TYPEMASK	((1 &lt;&lt; _IOC_TYPEBITS)-1)</span>
<span class="cp">#define _IOC_SIZEMASK	((1 &lt;&lt; _IOC_SIZEBITS)-1)</span>
<span class="cp">#define _IOC_DIRMASK	((1 &lt;&lt; _IOC_DIRBITS)-1)</span>

<span class="cp">#define _IOC_NRSHIFT	0</span>
<span class="cp">#define _IOC_TYPESHIFT	(_IOC_NRSHIFT+_IOC_NRBITS)</span>
<span class="cp">#define _IOC_SIZESHIFT	(_IOC_TYPESHIFT+_IOC_TYPEBITS)</span>
<span class="cp">#define _IOC_DIRSHIFT	(_IOC_SIZESHIFT+_IOC_SIZEBITS)</span>

<span class="cm">/*</span>
<span class="cm"> * Direction bits, which any architecture can choose to override</span>
<span class="cm"> * before including this file.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _IOC_NONE</span>
<span class="cp"># define _IOC_NONE	0U</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef _IOC_WRITE</span>
<span class="cp"># define _IOC_WRITE	1U</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef _IOC_READ</span>
<span class="cp"># define _IOC_READ	2U</span>
<span class="cp">#endif</span>

<span class="cp">#define _IOC(dir,type,nr,size) \</span>
<span class="cp">	(((dir)  &lt;&lt; _IOC_DIRSHIFT) | \</span>
<span class="cp">	 ((type) &lt;&lt; _IOC_TYPESHIFT) | \</span>
<span class="cp">	 ((nr)   &lt;&lt; _IOC_NRSHIFT) | \</span>
<span class="cp">	 ((size) &lt;&lt; _IOC_SIZESHIFT))</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cm">/* provoke compile error for invalid uses of size argument */</span>
<span class="k">extern</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">__invalid_size_argument_for_IOC</span><span class="p">;</span>
<span class="cp">#define _IOC_TYPECHECK(t) \</span>
<span class="cp">	((sizeof(t) == sizeof(t[1]) &amp;&amp; \</span>
<span class="cp">	  sizeof(t) &lt; (1 &lt;&lt; _IOC_SIZEBITS)) ? \</span>
<span class="cp">	  sizeof(t) : __invalid_size_argument_for_IOC)</span>
<span class="cp">#else</span>
<span class="cp">#define _IOC_TYPECHECK(t) (sizeof(t))</span>
<span class="cp">#endif</span>

<span class="cm">/* used to create numbers */</span>
<span class="cp">#define _IO(type,nr)		_IOC(_IOC_NONE,(type),(nr),0)</span>
<span class="cp">#define _IOR(type,nr,size)	_IOC(_IOC_READ,(type),(nr),(_IOC_TYPECHECK(size)))</span>
<span class="cp">#define _IOW(type,nr,size)	_IOC(_IOC_WRITE,(type),(nr),(_IOC_TYPECHECK(size)))</span>
<span class="cp">#define _IOWR(type,nr,size)	_IOC(_IOC_READ|_IOC_WRITE,(type),(nr),(_IOC_TYPECHECK(size)))</span>
<span class="cp">#define _IOR_BAD(type,nr,size)	_IOC(_IOC_READ,(type),(nr),sizeof(size))</span>
<span class="cp">#define _IOW_BAD(type,nr,size)	_IOC(_IOC_WRITE,(type),(nr),sizeof(size))</span>
<span class="cp">#define _IOWR_BAD(type,nr,size)	_IOC(_IOC_READ|_IOC_WRITE,(type),(nr),sizeof(size))</span>

<span class="cm">/* used to decode ioctl numbers.. */</span>
<span class="cp">#define _IOC_DIR(nr)		(((nr) &gt;&gt; _IOC_DIRSHIFT) &amp; _IOC_DIRMASK)</span>
<span class="cp">#define _IOC_TYPE(nr)		(((nr) &gt;&gt; _IOC_TYPESHIFT) &amp; _IOC_TYPEMASK)</span>
<span class="cp">#define _IOC_NR(nr)		(((nr) &gt;&gt; _IOC_NRSHIFT) &amp; _IOC_NRMASK)</span>
<span class="cp">#define _IOC_SIZE(nr)		(((nr) &gt;&gt; _IOC_SIZESHIFT) &amp; _IOC_SIZEMASK)</span>

<span class="cm">/* ...and for the drivers/sound files... */</span>

<span class="cp">#define IOC_IN		(_IOC_WRITE &lt;&lt; _IOC_DIRSHIFT)</span>
<span class="cp">#define IOC_OUT		(_IOC_READ &lt;&lt; _IOC_DIRSHIFT)</span>
<span class="cp">#define IOC_INOUT	((_IOC_WRITE|_IOC_READ) &lt;&lt; _IOC_DIRSHIFT)</span>
<span class="cp">#define IOCSIZE_MASK	(_IOC_SIZEMASK &lt;&lt; _IOC_SIZESHIFT)</span>
<span class="cp">#define IOCSIZE_SHIFT	(_IOC_SIZESHIFT)</span>

<span class="cp">#endif </span><span class="cm">/* _ASM_GENERIC_IOCTL_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
