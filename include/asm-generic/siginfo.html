<!DOCTYPE html>
<html><head><title>joekychen/linux » include › asm-generic › siginfo.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../index.html"></a><h1>siginfo.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef _ASM_GENERIC_SIGINFO_H</span>
<span class="cp">#define _ASM_GENERIC_SIGINFO_H</span>

<span class="cp">#include &lt;linux/compiler.h&gt;</span>
<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="n">sigval</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">sival_int</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">sival_ptr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">sigval_t</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * This is the size (including padding) of the part of the</span>
<span class="cm"> * struct siginfo that is before the union.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __ARCH_SI_PREAMBLE_SIZE</span>
<span class="cp">#define __ARCH_SI_PREAMBLE_SIZE	(3 * sizeof(int))</span>
<span class="cp">#endif</span>

<span class="cp">#define SI_MAX_SIZE	128</span>
<span class="cp">#ifndef SI_PAD_SIZE</span>
<span class="cp">#define SI_PAD_SIZE	((SI_MAX_SIZE - __ARCH_SI_PREAMBLE_SIZE) / sizeof(int))</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef __ARCH_SI_UID_T</span>
<span class="cp">#define __ARCH_SI_UID_T	__kernel_uid32_t</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * The default &quot;si_band&quot; type is &quot;long&quot;, as specified by POSIX.</span>
<span class="cm"> * However, some architectures want to override this to &quot;int&quot;</span>
<span class="cm"> * for historical compatibility reasons, so we allow that.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __ARCH_SI_BAND_T</span>
<span class="cp">#define __ARCH_SI_BAND_T long</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef __ARCH_SI_CLOCK_T</span>
<span class="cp">#define __ARCH_SI_CLOCK_T __kernel_clock_t</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef __ARCH_SI_ATTRIBUTES</span>
<span class="cp">#define __ARCH_SI_ATTRIBUTES</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef HAVE_ARCH_SIGINFO_T</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">siginfo</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">si_signo</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">si_errno</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">si_code</span><span class="p">;</span>

	<span class="k">union</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">_pad</span><span class="p">[</span><span class="n">SI_PAD_SIZE</span><span class="p">];</span>

		<span class="cm">/* kill() */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__kernel_pid_t</span> <span class="n">_pid</span><span class="p">;</span>	<span class="cm">/* sender&#39;s pid */</span>
			<span class="n">__ARCH_SI_UID_T</span> <span class="n">_uid</span><span class="p">;</span>	<span class="cm">/* sender&#39;s uid */</span>
		<span class="p">}</span> <span class="n">_kill</span><span class="p">;</span>

		<span class="cm">/* POSIX.1b timers */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__kernel_timer_t</span> <span class="n">_tid</span><span class="p">;</span>	<span class="cm">/* timer id */</span>
			<span class="kt">int</span> <span class="n">_overrun</span><span class="p">;</span>		<span class="cm">/* overrun count */</span>
			<span class="kt">char</span> <span class="n">_pad</span><span class="p">[</span><span class="k">sizeof</span><span class="p">(</span> <span class="n">__ARCH_SI_UID_T</span><span class="p">)</span> <span class="o">-</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)];</span>
			<span class="n">sigval_t</span> <span class="n">_sigval</span><span class="p">;</span>	<span class="cm">/* same as below */</span>
			<span class="kt">int</span> <span class="n">_sys_private</span><span class="p">;</span>       <span class="cm">/* not to be passed to user */</span>
		<span class="p">}</span> <span class="n">_timer</span><span class="p">;</span>

		<span class="cm">/* POSIX.1b signals */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__kernel_pid_t</span> <span class="n">_pid</span><span class="p">;</span>	<span class="cm">/* sender&#39;s pid */</span>
			<span class="n">__ARCH_SI_UID_T</span> <span class="n">_uid</span><span class="p">;</span>	<span class="cm">/* sender&#39;s uid */</span>
			<span class="n">sigval_t</span> <span class="n">_sigval</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">_rt</span><span class="p">;</span>

		<span class="cm">/* SIGCHLD */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__kernel_pid_t</span> <span class="n">_pid</span><span class="p">;</span>	<span class="cm">/* which child */</span>
			<span class="n">__ARCH_SI_UID_T</span> <span class="n">_uid</span><span class="p">;</span>	<span class="cm">/* sender&#39;s uid */</span>
			<span class="kt">int</span> <span class="n">_status</span><span class="p">;</span>		<span class="cm">/* exit code */</span>
			<span class="n">__ARCH_SI_CLOCK_T</span> <span class="n">_utime</span><span class="p">;</span>
			<span class="n">__ARCH_SI_CLOCK_T</span> <span class="n">_stime</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">_sigchld</span><span class="p">;</span>

		<span class="cm">/* SIGILL, SIGFPE, SIGSEGV, SIGBUS */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">_addr</span><span class="p">;</span> <span class="cm">/* faulting insn/memory ref. */</span>
<span class="cp">#ifdef __ARCH_SI_TRAPNO</span>
			<span class="kt">int</span> <span class="n">_trapno</span><span class="p">;</span>	<span class="cm">/* TRAP # which caused the signal */</span>
<span class="cp">#endif</span>
			<span class="kt">short</span> <span class="n">_addr_lsb</span><span class="p">;</span> <span class="cm">/* LSB of the reported address */</span>
		<span class="p">}</span> <span class="n">_sigfault</span><span class="p">;</span>

		<span class="cm">/* SIGPOLL */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">__ARCH_SI_BAND_T</span> <span class="n">_band</span><span class="p">;</span>	<span class="cm">/* POLL_IN, POLL_OUT, POLL_MSG */</span>
			<span class="kt">int</span> <span class="n">_fd</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">_sigpoll</span><span class="p">;</span>

		<span class="cm">/* SIGSYS */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">_call_addr</span><span class="p">;</span> <span class="cm">/* calling user insn */</span>
			<span class="kt">int</span> <span class="n">_syscall</span><span class="p">;</span>	<span class="cm">/* triggering system call number */</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">_arch</span><span class="p">;</span>	<span class="cm">/* AUDIT_ARCH_* of syscall */</span>
		<span class="p">}</span> <span class="n">_sigsys</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">_sifields</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__ARCH_SI_ATTRIBUTES</span> <span class="n">siginfo_t</span><span class="p">;</span>

<span class="cm">/* If the arch shares siginfo, then it has SIGSYS. */</span>
<span class="cp">#define __ARCH_SIGSYS</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * How these fields are to be accessed.</span>
<span class="cm"> */</span>
<span class="cp">#define si_pid		_sifields._kill._pid</span>
<span class="cp">#define si_uid		_sifields._kill._uid</span>
<span class="cp">#define si_tid		_sifields._timer._tid</span>
<span class="cp">#define si_overrun	_sifields._timer._overrun</span>
<span class="cp">#define si_sys_private  _sifields._timer._sys_private</span>
<span class="cp">#define si_status	_sifields._sigchld._status</span>
<span class="cp">#define si_utime	_sifields._sigchld._utime</span>
<span class="cp">#define si_stime	_sifields._sigchld._stime</span>
<span class="cp">#define si_value	_sifields._rt._sigval</span>
<span class="cp">#define si_int		_sifields._rt._sigval.sival_int</span>
<span class="cp">#define si_ptr		_sifields._rt._sigval.sival_ptr</span>
<span class="cp">#define si_addr		_sifields._sigfault._addr</span>
<span class="cp">#ifdef __ARCH_SI_TRAPNO</span>
<span class="cp">#define si_trapno	_sifields._sigfault._trapno</span>
<span class="cp">#endif</span>
<span class="cp">#define si_addr_lsb	_sifields._sigfault._addr_lsb</span>
<span class="cp">#define si_band		_sifields._sigpoll._band</span>
<span class="cp">#define si_fd		_sifields._sigpoll._fd</span>
<span class="cp">#ifdef __ARCH_SIGSYS</span>
<span class="cp">#define si_call_addr	_sifields._sigsys._call_addr</span>
<span class="cp">#define si_syscall	_sifields._sigsys._syscall</span>
<span class="cp">#define si_arch		_sifields._sigsys._arch</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef __KERNEL__</span>
<span class="cp">#define __SI_MASK	0xffff0000u</span>
<span class="cp">#define __SI_KILL	(0 &lt;&lt; 16)</span>
<span class="cp">#define __SI_TIMER	(1 &lt;&lt; 16)</span>
<span class="cp">#define __SI_POLL	(2 &lt;&lt; 16)</span>
<span class="cp">#define __SI_FAULT	(3 &lt;&lt; 16)</span>
<span class="cp">#define __SI_CHLD	(4 &lt;&lt; 16)</span>
<span class="cp">#define __SI_RT		(5 &lt;&lt; 16)</span>
<span class="cp">#define __SI_MESGQ	(6 &lt;&lt; 16)</span>
<span class="cp">#define __SI_SYS	(7 &lt;&lt; 16)</span>
<span class="cp">#define __SI_CODE(T,N)	((T) | ((N) &amp; 0xffff))</span>
<span class="cp">#else</span>
<span class="cp">#define __SI_KILL	0</span>
<span class="cp">#define __SI_TIMER	0</span>
<span class="cp">#define __SI_POLL	0</span>
<span class="cp">#define __SI_FAULT	0</span>
<span class="cp">#define __SI_CHLD	0</span>
<span class="cp">#define __SI_RT		0</span>
<span class="cp">#define __SI_MESGQ	0</span>
<span class="cp">#define __SI_SYS	0</span>
<span class="cp">#define __SI_CODE(T,N)	(N)</span>
<span class="cp">#endif</span>

<span class="cm">/*</span>
<span class="cm"> * si_code values</span>
<span class="cm"> * Digital reserves positive values for kernel-generated signals.</span>
<span class="cm"> */</span>
<span class="cp">#define SI_USER		0		</span><span class="cm">/* sent by kill, sigsend, raise */</span><span class="cp"></span>
<span class="cp">#define SI_KERNEL	0x80		</span><span class="cm">/* sent by the kernel from somewhere */</span><span class="cp"></span>
<span class="cp">#define SI_QUEUE	-1		</span><span class="cm">/* sent by sigqueue */</span><span class="cp"></span>
<span class="cp">#define SI_TIMER __SI_CODE(__SI_TIMER,-2) </span><span class="cm">/* sent by timer expiration */</span><span class="cp"></span>
<span class="cp">#define SI_MESGQ __SI_CODE(__SI_MESGQ,-3) </span><span class="cm">/* sent by real time mesq state change */</span><span class="cp"></span>
<span class="cp">#define SI_ASYNCIO	-4		</span><span class="cm">/* sent by AIO completion */</span><span class="cp"></span>
<span class="cp">#define SI_SIGIO	-5		</span><span class="cm">/* sent by queued SIGIO */</span><span class="cp"></span>
<span class="cp">#define SI_TKILL	-6		</span><span class="cm">/* sent by tkill system call */</span><span class="cp"></span>
<span class="cp">#define SI_DETHREAD	-7		</span><span class="cm">/* sent by execve() killing subsidiary threads */</span><span class="cp"></span>

<span class="cp">#define SI_FROMUSER(siptr)	((siptr)-&gt;si_code &lt;= 0)</span>
<span class="cp">#define SI_FROMKERNEL(siptr)	((siptr)-&gt;si_code &gt; 0)</span>

<span class="cm">/*</span>
<span class="cm"> * SIGILL si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define ILL_ILLOPC	(__SI_FAULT|1)	</span><span class="cm">/* illegal opcode */</span><span class="cp"></span>
<span class="cp">#define ILL_ILLOPN	(__SI_FAULT|2)	</span><span class="cm">/* illegal operand */</span><span class="cp"></span>
<span class="cp">#define ILL_ILLADR	(__SI_FAULT|3)	</span><span class="cm">/* illegal addressing mode */</span><span class="cp"></span>
<span class="cp">#define ILL_ILLTRP	(__SI_FAULT|4)	</span><span class="cm">/* illegal trap */</span><span class="cp"></span>
<span class="cp">#define ILL_PRVOPC	(__SI_FAULT|5)	</span><span class="cm">/* privileged opcode */</span><span class="cp"></span>
<span class="cp">#define ILL_PRVREG	(__SI_FAULT|6)	</span><span class="cm">/* privileged register */</span><span class="cp"></span>
<span class="cp">#define ILL_COPROC	(__SI_FAULT|7)	</span><span class="cm">/* coprocessor error */</span><span class="cp"></span>
<span class="cp">#define ILL_BADSTK	(__SI_FAULT|8)	</span><span class="cm">/* internal stack error */</span><span class="cp"></span>
<span class="cp">#define NSIGILL		8</span>

<span class="cm">/*</span>
<span class="cm"> * SIGFPE si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define FPE_INTDIV	(__SI_FAULT|1)	</span><span class="cm">/* integer divide by zero */</span><span class="cp"></span>
<span class="cp">#define FPE_INTOVF	(__SI_FAULT|2)	</span><span class="cm">/* integer overflow */</span><span class="cp"></span>
<span class="cp">#define FPE_FLTDIV	(__SI_FAULT|3)	</span><span class="cm">/* floating point divide by zero */</span><span class="cp"></span>
<span class="cp">#define FPE_FLTOVF	(__SI_FAULT|4)	</span><span class="cm">/* floating point overflow */</span><span class="cp"></span>
<span class="cp">#define FPE_FLTUND	(__SI_FAULT|5)	</span><span class="cm">/* floating point underflow */</span><span class="cp"></span>
<span class="cp">#define FPE_FLTRES	(__SI_FAULT|6)	</span><span class="cm">/* floating point inexact result */</span><span class="cp"></span>
<span class="cp">#define FPE_FLTINV	(__SI_FAULT|7)	</span><span class="cm">/* floating point invalid operation */</span><span class="cp"></span>
<span class="cp">#define FPE_FLTSUB	(__SI_FAULT|8)	</span><span class="cm">/* subscript out of range */</span><span class="cp"></span>
<span class="cp">#define NSIGFPE		8</span>

<span class="cm">/*</span>
<span class="cm"> * SIGSEGV si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define SEGV_MAPERR	(__SI_FAULT|1)	</span><span class="cm">/* address not mapped to object */</span><span class="cp"></span>
<span class="cp">#define SEGV_ACCERR	(__SI_FAULT|2)	</span><span class="cm">/* invalid permissions for mapped object */</span><span class="cp"></span>
<span class="cp">#define NSIGSEGV	2</span>

<span class="cm">/*</span>
<span class="cm"> * SIGBUS si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define BUS_ADRALN	(__SI_FAULT|1)	</span><span class="cm">/* invalid address alignment */</span><span class="cp"></span>
<span class="cp">#define BUS_ADRERR	(__SI_FAULT|2)	</span><span class="cm">/* non-existent physical address */</span><span class="cp"></span>
<span class="cp">#define BUS_OBJERR	(__SI_FAULT|3)	</span><span class="cm">/* object specific hardware error */</span><span class="cp"></span>
<span class="cm">/* hardware memory error consumed on a machine check: action required */</span>
<span class="cp">#define BUS_MCEERR_AR	(__SI_FAULT|4)</span>
<span class="cm">/* hardware memory error detected in process but not consumed: action optional*/</span>
<span class="cp">#define BUS_MCEERR_AO	(__SI_FAULT|5)</span>
<span class="cp">#define NSIGBUS		5</span>

<span class="cm">/*</span>
<span class="cm"> * SIGTRAP si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define TRAP_BRKPT	(__SI_FAULT|1)	</span><span class="cm">/* process breakpoint */</span><span class="cp"></span>
<span class="cp">#define TRAP_TRACE	(__SI_FAULT|2)	</span><span class="cm">/* process trace trap */</span><span class="cp"></span>
<span class="cp">#define TRAP_BRANCH     (__SI_FAULT|3)  </span><span class="cm">/* process taken branch trap */</span><span class="cp"></span>
<span class="cp">#define TRAP_HWBKPT     (__SI_FAULT|4)  </span><span class="cm">/* hardware breakpoint/watchpoint */</span><span class="cp"></span>
<span class="cp">#define NSIGTRAP	4</span>

<span class="cm">/*</span>
<span class="cm"> * SIGCHLD si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define CLD_EXITED	(__SI_CHLD|1)	</span><span class="cm">/* child has exited */</span><span class="cp"></span>
<span class="cp">#define CLD_KILLED	(__SI_CHLD|2)	</span><span class="cm">/* child was killed */</span><span class="cp"></span>
<span class="cp">#define CLD_DUMPED	(__SI_CHLD|3)	</span><span class="cm">/* child terminated abnormally */</span><span class="cp"></span>
<span class="cp">#define CLD_TRAPPED	(__SI_CHLD|4)	</span><span class="cm">/* traced child has trapped */</span><span class="cp"></span>
<span class="cp">#define CLD_STOPPED	(__SI_CHLD|5)	</span><span class="cm">/* child has stopped */</span><span class="cp"></span>
<span class="cp">#define CLD_CONTINUED	(__SI_CHLD|6)	</span><span class="cm">/* stopped child has continued */</span><span class="cp"></span>
<span class="cp">#define NSIGCHLD	6</span>

<span class="cm">/*</span>
<span class="cm"> * SIGPOLL si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define POLL_IN		(__SI_POLL|1)	</span><span class="cm">/* data input available */</span><span class="cp"></span>
<span class="cp">#define POLL_OUT	(__SI_POLL|2)	</span><span class="cm">/* output buffers available */</span><span class="cp"></span>
<span class="cp">#define POLL_MSG	(__SI_POLL|3)	</span><span class="cm">/* input message available */</span><span class="cp"></span>
<span class="cp">#define POLL_ERR	(__SI_POLL|4)	</span><span class="cm">/* i/o error */</span><span class="cp"></span>
<span class="cp">#define POLL_PRI	(__SI_POLL|5)	</span><span class="cm">/* high priority input available */</span><span class="cp"></span>
<span class="cp">#define POLL_HUP	(__SI_POLL|6)	</span><span class="cm">/* device disconnected */</span><span class="cp"></span>
<span class="cp">#define NSIGPOLL	6</span>

<span class="cm">/*</span>
<span class="cm"> * SIGSYS si_codes</span>
<span class="cm"> */</span>
<span class="cp">#define SYS_SECCOMP		(__SI_SYS|1)	</span><span class="cm">/* seccomp triggered */</span><span class="cp"></span>
<span class="cp">#define NSIGSYS	1</span>

<span class="cm">/*</span>
<span class="cm"> * sigevent definitions</span>
<span class="cm"> * </span>
<span class="cm"> * It seems likely that SIGEV_THREAD will have to be handled from </span>
<span class="cm"> * userspace, libpthread transmuting it to SIGEV_SIGNAL, which the</span>
<span class="cm"> * thread manager then catches and does the appropriate nonsense.</span>
<span class="cm"> * However, everything is written out here so as to not get lost.</span>
<span class="cm"> */</span>
<span class="cp">#define SIGEV_SIGNAL	0	</span><span class="cm">/* notify via signal */</span><span class="cp"></span>
<span class="cp">#define SIGEV_NONE	1	</span><span class="cm">/* other notification: meaningless */</span><span class="cp"></span>
<span class="cp">#define SIGEV_THREAD	2	</span><span class="cm">/* deliver via thread creation */</span><span class="cp"></span>
<span class="cp">#define SIGEV_THREAD_ID 4	</span><span class="cm">/* deliver to thread */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * This works because the alignment is ok on all current architectures</span>
<span class="cm"> * but we leave open this being overridden in the future</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __ARCH_SIGEV_PREAMBLE_SIZE</span>
<span class="cp">#define __ARCH_SIGEV_PREAMBLE_SIZE	(sizeof(int) * 2 + sizeof(sigval_t))</span>
<span class="cp">#endif</span>

<span class="cp">#define SIGEV_MAX_SIZE	64</span>
<span class="cp">#define SIGEV_PAD_SIZE	((SIGEV_MAX_SIZE - __ARCH_SIGEV_PREAMBLE_SIZE) \</span>
<span class="cp">		/ sizeof(int))</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">sigevent</span> <span class="p">{</span>
	<span class="n">sigval_t</span> <span class="n">sigev_value</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">sigev_signo</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">sigev_notify</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="kt">int</span> <span class="n">_pad</span><span class="p">[</span><span class="n">SIGEV_PAD_SIZE</span><span class="p">];</span>
		 <span class="kt">int</span> <span class="n">_tid</span><span class="p">;</span>

		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">_function</span><span class="p">)(</span><span class="n">sigval_t</span><span class="p">);</span>
			<span class="kt">void</span> <span class="o">*</span><span class="n">_attribute</span><span class="p">;</span>	<span class="cm">/* really pthread_attr_t */</span>
		<span class="p">}</span> <span class="n">_sigev_thread</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">_sigev_un</span><span class="p">;</span>
<span class="p">}</span> <span class="n">sigevent_t</span><span class="p">;</span>

<span class="cp">#define sigev_notify_function	_sigev_un._sigev_thread._function</span>
<span class="cp">#define sigev_notify_attributes	_sigev_un._sigev_thread._attribute</span>
<span class="cp">#define sigev_notify_thread_id	 _sigev_un._tid</span>

<span class="cp">#ifdef __KERNEL__</span>

<span class="k">struct</span> <span class="n">siginfo</span><span class="p">;</span>
<span class="kt">void</span> <span class="n">do_schedule_next_timer</span><span class="p">(</span><span class="k">struct</span> <span class="n">siginfo</span> <span class="o">*</span><span class="n">info</span><span class="p">);</span>

<span class="cp">#ifndef HAVE_ARCH_COPY_SIGINFO</span>

<span class="cp">#include &lt;linux/string.h&gt;</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">copy_siginfo</span><span class="p">(</span><span class="k">struct</span> <span class="n">siginfo</span> <span class="o">*</span><span class="n">to</span><span class="p">,</span> <span class="k">struct</span> <span class="n">siginfo</span> <span class="o">*</span><span class="n">from</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">from</span><span class="o">-&gt;</span><span class="n">si_code</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">to</span><span class="p">));</span>
	<span class="k">else</span>
		<span class="cm">/* _sigchld is currently the largest know union member */</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">from</span><span class="p">,</span> <span class="n">__ARCH_SI_PREAMBLE_SIZE</span> <span class="o">+</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">from</span><span class="o">-&gt;</span><span class="n">_sifields</span><span class="p">.</span><span class="n">_sigchld</span><span class="p">));</span>
<span class="p">}</span>

<span class="cp">#endif</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">copy_siginfo_to_user</span><span class="p">(</span><span class="k">struct</span> <span class="n">siginfo</span> <span class="n">__user</span> <span class="o">*</span><span class="n">to</span><span class="p">,</span> <span class="k">struct</span> <span class="n">siginfo</span> <span class="o">*</span><span class="n">from</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __KERNEL__ */</span><span class="cp"></span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:2}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../javascript/docco.min.js"></script>
</html>
