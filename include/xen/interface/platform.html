<!DOCTYPE html>
<html><head><title>joekychen/linux » include › xen › interface › platform.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>platform.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm"> * platform.h</span>
<span class="cm"> *</span>
<span class="cm"> * Hardware platform operations. Intended for use by domain-0 kernel.</span>
<span class="cm"> *</span>
<span class="cm"> * Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="cm"> * of this software and associated documentation files (the &quot;Software&quot;), to</span>
<span class="cm"> * deal in the Software without restriction, including without limitation the</span>
<span class="cm"> * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span>
<span class="cm"> * sell copies of the Software, and to permit persons to whom the Software is</span>
<span class="cm"> * furnished to do so, subject to the following conditions:</span>
<span class="cm"> *</span>
<span class="cm"> * The above copyright notice and this permission notice shall be included in</span>
<span class="cm"> * all copies or substantial portions of the Software.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="cm"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="cm"> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="cm"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span>
<span class="cm"> * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER</span>
<span class="cm"> * DEALINGS IN THE SOFTWARE.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2002-2006, K Fraser</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __XEN_PUBLIC_PLATFORM_H__</span>
<span class="cp">#define __XEN_PUBLIC_PLATFORM_H__</span>

<span class="cp">#include &quot;xen.h&quot;</span>

<span class="cp">#define XENPF_INTERFACE_VERSION 0x03000001</span>

<span class="cm">/*</span>
<span class="cm"> * Set clock such that it would read &lt;secs,nsecs&gt; after 00:00:00 UTC,</span>
<span class="cm"> * 1 January, 1970 if the current system time was &lt;system_time&gt;.</span>
<span class="cm"> */</span>
<span class="cp">#define XENPF_settime             17</span>
<span class="k">struct</span> <span class="n">xenpf_settime</span> <span class="p">{</span>
	<span class="cm">/* IN variables. */</span>
	<span class="kt">uint32_t</span> <span class="n">secs</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">nsecs</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">system_time</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_settime_t</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Request memory range (@mfn, @mfn+@nr_mfns-1) to have type @type.</span>
<span class="cm"> * On x86, @type is an architecture-defined MTRR memory type.</span>
<span class="cm"> * On success, returns the MTRR that was used (@reg) and a handle that can</span>
<span class="cm"> * be passed to XENPF_DEL_MEMTYPE to accurately tear down the new setting.</span>
<span class="cm"> * (x86-specific).</span>
<span class="cm"> */</span>
<span class="cp">#define XENPF_add_memtype         31</span>
<span class="k">struct</span> <span class="n">xenpf_add_memtype</span> <span class="p">{</span>
	<span class="cm">/* IN variables. */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mfn</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">nr_mfns</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">type</span><span class="p">;</span>
	<span class="cm">/* OUT variables. */</span>
	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">reg</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_add_memtype_t</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tear down an existing memory-range type. If @handle is remembered then it</span>
<span class="cm"> * should be passed in to accurately tear down the correct setting (in case</span>
<span class="cm"> * of overlapping memory regions with differing types). If it is not known</span>
<span class="cm"> * then @handle should be set to zero. In all cases @reg must be set.</span>
<span class="cm"> * (x86-specific).</span>
<span class="cm"> */</span>
<span class="cp">#define XENPF_del_memtype         32</span>
<span class="k">struct</span> <span class="n">xenpf_del_memtype</span> <span class="p">{</span>
	<span class="cm">/* IN variables. */</span>
	<span class="kt">uint32_t</span> <span class="n">handle</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">reg</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_del_memtype_t</span><span class="p">);</span>

<span class="cm">/* Read current type of an MTRR (x86-specific). */</span>
<span class="cp">#define XENPF_read_memtype        33</span>
<span class="k">struct</span> <span class="n">xenpf_read_memtype</span> <span class="p">{</span>
	<span class="cm">/* IN variables. */</span>
	<span class="kt">uint32_t</span> <span class="n">reg</span><span class="p">;</span>
	<span class="cm">/* OUT variables. */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mfn</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">nr_mfns</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">type</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_read_memtype_t</span><span class="p">);</span>

<span class="cp">#define XENPF_microcode_update    35</span>
<span class="k">struct</span> <span class="n">xenpf_microcode_update</span> <span class="p">{</span>
	<span class="cm">/* IN variables. */</span>
	<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">data</span><span class="p">;</span>          <span class="cm">/* Pointer to microcode data */</span>
	<span class="kt">uint32_t</span> <span class="n">length</span><span class="p">;</span>                  <span class="cm">/* Length of microcode data. */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_microcode_update_t</span><span class="p">);</span>

<span class="cp">#define XENPF_platform_quirk      39</span>
<span class="cp">#define QUIRK_NOIRQBALANCING      1 </span><span class="cm">/* Do not restrict IO-APIC RTE targets */</span><span class="cp"></span>
<span class="cp">#define QUIRK_IOAPIC_BAD_REGSEL   2 </span><span class="cm">/* IO-APIC REGSEL forgets its value    */</span><span class="cp"></span>
<span class="cp">#define QUIRK_IOAPIC_GOOD_REGSEL  3 </span><span class="cm">/* IO-APIC REGSEL behaves properly     */</span><span class="cp"></span>
<span class="k">struct</span> <span class="n">xenpf_platform_quirk</span> <span class="p">{</span>
	<span class="cm">/* IN variables. */</span>
	<span class="kt">uint32_t</span> <span class="n">quirk_id</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_platform_quirk_t</span><span class="p">);</span>

<span class="cp">#define XENPF_firmware_info       50</span>
<span class="cp">#define XEN_FW_DISK_INFO          1 </span><span class="cm">/* from int 13 AH=08/41/48 */</span><span class="cp"></span>
<span class="cp">#define XEN_FW_DISK_MBR_SIGNATURE 2 </span><span class="cm">/* from MBR offset 0x1b8 */</span><span class="cp"></span>
<span class="cp">#define XEN_FW_VBEDDC_INFO        3 </span><span class="cm">/* from int 10 AX=4f15 */</span><span class="cp"></span>
<span class="k">struct</span> <span class="n">xenpf_firmware_info</span> <span class="p">{</span>
	<span class="cm">/* IN variables. */</span>
	<span class="kt">uint32_t</span> <span class="n">type</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">index</span><span class="p">;</span>
	<span class="cm">/* OUT variables. */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="cm">/* Int13, Fn48: Check Extensions Present. */</span>
			<span class="kt">uint8_t</span> <span class="n">device</span><span class="p">;</span>                   <span class="cm">/* %dl: bios device number */</span>
			<span class="kt">uint8_t</span> <span class="n">version</span><span class="p">;</span>                  <span class="cm">/* %ah: major version      */</span>
			<span class="kt">uint16_t</span> <span class="n">interface_support</span><span class="p">;</span>       <span class="cm">/* %cx: support bitmap     */</span>
			<span class="cm">/* Int13, Fn08: Legacy Get Device Parameters. */</span>
			<span class="kt">uint16_t</span> <span class="n">legacy_max_cylinder</span><span class="p">;</span>     <span class="cm">/* %cl[7:6]:%ch: max cyl # */</span>
			<span class="kt">uint8_t</span> <span class="n">legacy_max_head</span><span class="p">;</span>          <span class="cm">/* %dh: max head #         */</span>
			<span class="kt">uint8_t</span> <span class="n">legacy_sectors_per_track</span><span class="p">;</span> <span class="cm">/* %cl[5:0]: max sector #  */</span>
			<span class="cm">/* Int13, Fn41: Get Device Parameters (as filled into %ds:%esi). */</span>
			<span class="cm">/* NB. First uint16_t of buffer must be set to buffer size.      */</span>
			<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">edd_params</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">disk_info</span><span class="p">;</span> <span class="cm">/* XEN_FW_DISK_INFO */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">uint8_t</span> <span class="n">device</span><span class="p">;</span>                   <span class="cm">/* bios device number  */</span>
			<span class="kt">uint32_t</span> <span class="n">mbr_signature</span><span class="p">;</span>           <span class="cm">/* offset 0x1b8 in mbr */</span>
		<span class="p">}</span> <span class="n">disk_mbr_signature</span><span class="p">;</span> <span class="cm">/* XEN_FW_DISK_MBR_SIGNATURE */</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="cm">/* Int10, AX=4F15: Get EDID info. */</span>
			<span class="kt">uint8_t</span> <span class="n">capabilities</span><span class="p">;</span>
			<span class="kt">uint8_t</span> <span class="n">edid_transfer_time</span><span class="p">;</span>
			<span class="cm">/* must refer to 128-byte buffer */</span>
			<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="n">uchar</span><span class="p">)</span> <span class="n">edid</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">vbeddc_info</span><span class="p">;</span> <span class="cm">/* XEN_FW_VBEDDC_INFO */</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_firmware_info_t</span><span class="p">);</span>

<span class="cp">#define XENPF_enter_acpi_sleep    51</span>
<span class="k">struct</span> <span class="n">xenpf_enter_acpi_sleep</span> <span class="p">{</span>
	<span class="cm">/* IN variables */</span>
	<span class="kt">uint16_t</span> <span class="n">pm1a_cnt_val</span><span class="p">;</span>      <span class="cm">/* PM1a control value. */</span>
	<span class="kt">uint16_t</span> <span class="n">pm1b_cnt_val</span><span class="p">;</span>      <span class="cm">/* PM1b control value. */</span>
	<span class="kt">uint32_t</span> <span class="n">sleep_state</span><span class="p">;</span>       <span class="cm">/* Which state to enter (Sn). */</span>
	<span class="kt">uint32_t</span> <span class="n">flags</span><span class="p">;</span>             <span class="cm">/* Must be zero. */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_enter_acpi_sleep_t</span><span class="p">);</span>

<span class="cp">#define XENPF_change_freq         52</span>
<span class="k">struct</span> <span class="n">xenpf_change_freq</span> <span class="p">{</span>
	<span class="cm">/* IN variables */</span>
	<span class="kt">uint32_t</span> <span class="n">flags</span><span class="p">;</span> <span class="cm">/* Must be zero. */</span>
	<span class="kt">uint32_t</span> <span class="n">cpu</span><span class="p">;</span>   <span class="cm">/* Physical cpu. */</span>
	<span class="kt">uint64_t</span> <span class="n">freq</span><span class="p">;</span>  <span class="cm">/* New frequency (Hz). */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_change_freq_t</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Get idle times (nanoseconds since boot) for physical CPUs specified in the</span>
<span class="cm"> * @cpumap_bitmap with range [0..@cpumap_nr_cpus-1]. The @idletime array is</span>
<span class="cm"> * indexed by CPU number; only entries with the corresponding @cpumap_bitmap</span>
<span class="cm"> * bit set are written to. On return, @cpumap_bitmap is modified so that any</span>
<span class="cm"> * non-existent CPUs are cleared. Such CPUs have their @idletime array entry</span>
<span class="cm"> * cleared.</span>
<span class="cm"> */</span>
<span class="cp">#define XENPF_getidletime         53</span>
<span class="k">struct</span> <span class="n">xenpf_getidletime</span> <span class="p">{</span>
	<span class="cm">/* IN/OUT variables */</span>
	<span class="cm">/* IN: CPUs to interrogate; OUT: subset of IN which are present */</span>
	<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="n">uchar</span><span class="p">)</span> <span class="n">cpumap_bitmap</span><span class="p">;</span>
	<span class="cm">/* IN variables */</span>
	<span class="cm">/* Size of cpumap bitmap. */</span>
	<span class="kt">uint32_t</span> <span class="n">cpumap_nr_cpus</span><span class="p">;</span>
	<span class="cm">/* Must be indexable for every cpu in cpumap_bitmap. */</span>
	<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="kt">uint64_t</span><span class="p">)</span> <span class="n">idletime</span><span class="p">;</span>
	<span class="cm">/* OUT variables */</span>
	<span class="cm">/* System time when the idletime snapshots were taken. */</span>
	<span class="kt">uint64_t</span> <span class="n">now</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_getidletime_t</span><span class="p">);</span>

<span class="cp">#define XENPF_set_processor_pminfo      54</span>

<span class="cm">/* ability bits */</span>
<span class="cp">#define XEN_PROCESSOR_PM_CX	1</span>
<span class="cp">#define XEN_PROCESSOR_PM_PX	2</span>
<span class="cp">#define XEN_PROCESSOR_PM_TX	4</span>

<span class="cm">/* cmd type */</span>
<span class="cp">#define XEN_PM_CX   0</span>
<span class="cp">#define XEN_PM_PX   1</span>
<span class="cp">#define XEN_PM_TX   2</span>
<span class="cp">#define XEN_PM_PDC  3</span>
<span class="cm">/* Px sub info type */</span>
<span class="cp">#define XEN_PX_PCT   1</span>
<span class="cp">#define XEN_PX_PSS   2</span>
<span class="cp">#define XEN_PX_PPC   4</span>
<span class="cp">#define XEN_PX_PSD   8</span>

<span class="k">struct</span> <span class="n">xen_power_register</span> <span class="p">{</span>
	<span class="kt">uint32_t</span>     <span class="n">space_id</span><span class="p">;</span>
	<span class="kt">uint32_t</span>     <span class="n">bit_width</span><span class="p">;</span>
	<span class="kt">uint32_t</span>     <span class="n">bit_offset</span><span class="p">;</span>
	<span class="kt">uint32_t</span>     <span class="n">access_size</span><span class="p">;</span>
	<span class="kt">uint64_t</span>     <span class="n">address</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xen_processor_csd</span> <span class="p">{</span>
	<span class="kt">uint32_t</span>    <span class="n">domain</span><span class="p">;</span>      <span class="cm">/* domain number of one dependent group */</span>
	<span class="kt">uint32_t</span>    <span class="n">coord_type</span><span class="p">;</span>  <span class="cm">/* coordination type */</span>
	<span class="kt">uint32_t</span>    <span class="n">num</span><span class="p">;</span>         <span class="cm">/* number of processors in same domain */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xen_processor_csd</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">xen_processor_cx</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">xen_power_register</span>  <span class="n">reg</span><span class="p">;</span> <span class="cm">/* GAS for Cx trigger register */</span>
	<span class="kt">uint8_t</span>     <span class="n">type</span><span class="p">;</span>     <span class="cm">/* cstate value, c0: 0, c1: 1, ... */</span>
	<span class="kt">uint32_t</span>    <span class="n">latency</span><span class="p">;</span>  <span class="cm">/* worst latency (ms) to enter/exit this cstate */</span>
	<span class="kt">uint32_t</span>    <span class="n">power</span><span class="p">;</span>    <span class="cm">/* average power consumption(mW) */</span>
	<span class="kt">uint32_t</span>    <span class="n">dpcnt</span><span class="p">;</span>    <span class="cm">/* number of dependency entries */</span>
	<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="n">xen_processor_csd</span><span class="p">)</span> <span class="n">dp</span><span class="p">;</span> <span class="cm">/* NULL if no dependency */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xen_processor_cx</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">xen_processor_flags</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">bm_control</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">bm_check</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">has_cst</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">power_setup_done</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">bm_rld_set</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xen_processor_power</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">count</span><span class="p">;</span>  <span class="cm">/* number of C state entries in array below */</span>
	<span class="k">struct</span> <span class="n">xen_processor_flags</span> <span class="n">flags</span><span class="p">;</span>  <span class="cm">/* global flags of this processor */</span>
	<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="n">xen_processor_cx</span><span class="p">)</span> <span class="n">states</span><span class="p">;</span> <span class="cm">/* supported c states */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xen_pct_register</span> <span class="p">{</span>
	<span class="kt">uint8_t</span>  <span class="n">descriptor</span><span class="p">;</span>
	<span class="kt">uint16_t</span> <span class="n">length</span><span class="p">;</span>
	<span class="kt">uint8_t</span>  <span class="n">space_id</span><span class="p">;</span>
	<span class="kt">uint8_t</span>  <span class="n">bit_width</span><span class="p">;</span>
	<span class="kt">uint8_t</span>  <span class="n">bit_offset</span><span class="p">;</span>
	<span class="kt">uint8_t</span>  <span class="n">reserved</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">address</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xen_processor_px</span> <span class="p">{</span>
	<span class="kt">uint64_t</span> <span class="n">core_frequency</span><span class="p">;</span> <span class="cm">/* megahertz */</span>
	<span class="kt">uint64_t</span> <span class="n">power</span><span class="p">;</span>      <span class="cm">/* milliWatts */</span>
	<span class="kt">uint64_t</span> <span class="n">transition_latency</span><span class="p">;</span> <span class="cm">/* microseconds */</span>
	<span class="kt">uint64_t</span> <span class="n">bus_master_latency</span><span class="p">;</span> <span class="cm">/* microseconds */</span>
	<span class="kt">uint64_t</span> <span class="n">control</span><span class="p">;</span>        <span class="cm">/* control value */</span>
	<span class="kt">uint64_t</span> <span class="n">status</span><span class="p">;</span>     <span class="cm">/* success indicator */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xen_processor_px</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">xen_psd_package</span> <span class="p">{</span>
	<span class="kt">uint64_t</span> <span class="n">num_entries</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">revision</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">domain</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">coord_type</span><span class="p">;</span>
	<span class="kt">uint64_t</span> <span class="n">num_processors</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">xen_processor_performance</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">flags</span><span class="p">;</span>     <span class="cm">/* flag for Px sub info type */</span>
	<span class="kt">uint32_t</span> <span class="n">platform_limit</span><span class="p">;</span>  <span class="cm">/* Platform limitation on freq usage */</span>
	<span class="k">struct</span> <span class="n">xen_pct_register</span> <span class="n">control_register</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xen_pct_register</span> <span class="n">status_register</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">state_count</span><span class="p">;</span>     <span class="cm">/* total available performance states */</span>
	<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="n">xen_processor_px</span><span class="p">)</span> <span class="n">states</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">xen_psd_package</span> <span class="n">domain_info</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">shared_type</span><span class="p">;</span>     <span class="cm">/* coordination type of this processor */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xen_processor_performance</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">xenpf_set_processor_pminfo</span> <span class="p">{</span>
	<span class="cm">/* IN variables */</span>
	<span class="kt">uint32_t</span> <span class="n">id</span><span class="p">;</span>    <span class="cm">/* ACPI CPU ID */</span>
	<span class="kt">uint32_t</span> <span class="n">type</span><span class="p">;</span>  <span class="cm">/* {XEN_PM_CX, XEN_PM_PX} */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">xen_processor_power</span>          <span class="n">power</span><span class="p">;</span><span class="cm">/* Cx: _CST/_CSD */</span>
		<span class="k">struct</span> <span class="n">xen_processor_performance</span>    <span class="n">perf</span><span class="p">;</span> <span class="cm">/* Px: _PPC/_PCT/_PSS/_PSD */</span>
		<span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="kt">uint32_t</span><span class="p">)</span>              <span class="n">pdc</span><span class="p">;</span>
	<span class="p">};</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_set_processor_pminfo</span><span class="p">);</span>

<span class="cp">#define XENPF_get_cpuinfo 55</span>
<span class="k">struct</span> <span class="n">xenpf_pcpuinfo</span> <span class="p">{</span>
	<span class="cm">/* IN */</span>
	<span class="kt">uint32_t</span> <span class="n">xen_cpuid</span><span class="p">;</span>
	<span class="cm">/* OUT */</span>
	<span class="cm">/* The maxium cpu_id that is present */</span>
	<span class="kt">uint32_t</span> <span class="n">max_present</span><span class="p">;</span>
<span class="cp">#define XEN_PCPU_FLAGS_ONLINE   1</span>
	<span class="cm">/* Correponding xen_cpuid is not present*/</span>
<span class="cp">#define XEN_PCPU_FLAGS_INVALID  2</span>
	<span class="kt">uint32_t</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">apic_id</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">acpi_id</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xenpf_pcpuinfo</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">xen_platform_op</span> <span class="p">{</span>
	<span class="kt">uint32_t</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="kt">uint32_t</span> <span class="n">interface_version</span><span class="p">;</span> <span class="cm">/* XENPF_INTERFACE_VERSION */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">xenpf_settime</span>           <span class="n">settime</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_add_memtype</span>       <span class="n">add_memtype</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_del_memtype</span>       <span class="n">del_memtype</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_read_memtype</span>      <span class="n">read_memtype</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_microcode_update</span>  <span class="n">microcode</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_platform_quirk</span>    <span class="n">platform_quirk</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_firmware_info</span>     <span class="n">firmware_info</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_enter_acpi_sleep</span>  <span class="n">enter_acpi_sleep</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_change_freq</span>       <span class="n">change_freq</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_getidletime</span>       <span class="n">getidletime</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_set_processor_pminfo</span> <span class="n">set_pminfo</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">xenpf_pcpuinfo</span>          <span class="n">pcpu_info</span><span class="p">;</span>
		<span class="kt">uint8_t</span>                        <span class="n">pad</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">xen_platform_op_t</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __XEN_PUBLIC_PLATFORM_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
