<!DOCTYPE html>
<html><head><title>joekychen/linux » include › xen › interface › sched.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>sched.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm"> * sched.h</span>
<span class="cm"> *</span>
<span class="cm"> * Scheduler state interactions</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2005, Keir Fraser &lt;keir@xensource.com&gt;</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __XEN_PUBLIC_SCHED_H__</span>
<span class="cp">#define __XEN_PUBLIC_SCHED_H__</span>

<span class="cp">#include &quot;event_channel.h&quot;</span>

<span class="cm">/*</span>
<span class="cm"> * The prototype for this hypercall is:</span>
<span class="cm"> *  long sched_op_new(int cmd, void *arg)</span>
<span class="cm"> * @cmd == SCHEDOP_??? (scheduler operation).</span>
<span class="cm"> * @arg == Operation-specific extra argument(s), as described below.</span>
<span class="cm"> *</span>
<span class="cm"> * **NOTE**:</span>
<span class="cm"> * Versions of Xen prior to 3.0.2 provide only the following legacy version</span>
<span class="cm"> * of this hypercall, supporting only the commands yield, block and shutdown:</span>
<span class="cm"> *  long sched_op(int cmd, unsigned long arg)</span>
<span class="cm"> * @cmd == SCHEDOP_??? (scheduler operation).</span>
<span class="cm"> * @arg == 0               (SCHEDOP_yield and SCHEDOP_block)</span>
<span class="cm"> *      == SHUTDOWN_* code (SCHEDOP_shutdown)</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Voluntarily yield the CPU.</span>
<span class="cm"> * @arg == NULL.</span>
<span class="cm"> */</span>
<span class="cp">#define SCHEDOP_yield       0</span>

<span class="cm">/*</span>
<span class="cm"> * Block execution of this VCPU until an event is received for processing.</span>
<span class="cm"> * If called with event upcalls masked, this operation will atomically</span>
<span class="cm"> * reenable event delivery and check for pending events before blocking the</span>
<span class="cm"> * VCPU. This avoids a &quot;wakeup waiting&quot; race.</span>
<span class="cm"> * @arg == NULL.</span>
<span class="cm"> */</span>
<span class="cp">#define SCHEDOP_block       1</span>

<span class="cm">/*</span>
<span class="cm"> * Halt execution of this domain (all VCPUs) and notify the system controller.</span>
<span class="cm"> * @arg == pointer to sched_shutdown structure.</span>
<span class="cm"> */</span>
<span class="cp">#define SCHEDOP_shutdown    2</span>
<span class="k">struct</span> <span class="n">sched_shutdown</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reason</span><span class="p">;</span> <span class="cm">/* SHUTDOWN_* */</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">sched_shutdown</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Poll a set of event-channel ports. Return when one or more are pending. An</span>
<span class="cm"> * optional timeout may be specified.</span>
<span class="cm"> * @arg == pointer to sched_poll structure.</span>
<span class="cm"> */</span>
<span class="cp">#define SCHEDOP_poll        3</span>
<span class="k">struct</span> <span class="n">sched_poll</span> <span class="p">{</span>
    <span class="n">GUEST_HANDLE</span><span class="p">(</span><span class="n">evtchn_port_t</span><span class="p">)</span> <span class="n">ports</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nr_ports</span><span class="p">;</span>
    <span class="kt">uint64_t</span> <span class="n">timeout</span><span class="p">;</span>
<span class="p">};</span>
<span class="n">DEFINE_GUEST_HANDLE_STRUCT</span><span class="p">(</span><span class="n">sched_poll</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Declare a shutdown for another domain. The main use of this function is</span>
<span class="cm"> * in interpreting shutdown requests and reasons for fully-virtualized</span>
<span class="cm"> * domains.  A para-virtualized domain may use SCHEDOP_shutdown directly.</span>
<span class="cm"> * @arg == pointer to sched_remote_shutdown structure.</span>
<span class="cm"> */</span>
<span class="cp">#define SCHEDOP_remote_shutdown        4</span>
<span class="k">struct</span> <span class="n">sched_remote_shutdown</span> <span class="p">{</span>
    <span class="n">domid_t</span> <span class="n">domain_id</span><span class="p">;</span>         <span class="cm">/* Remote domain ID */</span>
    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reason</span><span class="p">;</span>       <span class="cm">/* SHUTDOWN_xxx reason */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Latch a shutdown code, so that when the domain later shuts down it</span>
<span class="cm"> * reports this code to the control tools.</span>
<span class="cm"> * @arg == as for SCHEDOP_shutdown.</span>
<span class="cm"> */</span>
<span class="cp">#define SCHEDOP_shutdown_code 5</span>

<span class="cm">/*</span>
<span class="cm"> * Setup, poke and destroy a domain watchdog timer.</span>
<span class="cm"> * @arg == pointer to sched_watchdog structure.</span>
<span class="cm"> * With id == 0, setup a domain watchdog timer to cause domain shutdown</span>
<span class="cm"> *               after timeout, returns watchdog id.</span>
<span class="cm"> * With id != 0 and timeout == 0, destroy domain watchdog timer.</span>
<span class="cm"> * With id != 0 and timeout != 0, poke watchdog timer and set new timeout.</span>
<span class="cm"> */</span>
<span class="cp">#define SCHEDOP_watchdog    6</span>
<span class="k">struct</span> <span class="n">sched_watchdog</span> <span class="p">{</span>
    <span class="kt">uint32_t</span> <span class="n">id</span><span class="p">;</span>                <span class="cm">/* watchdog ID */</span>
    <span class="kt">uint32_t</span> <span class="n">timeout</span><span class="p">;</span>           <span class="cm">/* timeout */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Reason codes for SCHEDOP_shutdown. These may be interpreted by control</span>
<span class="cm"> * software to determine the appropriate action. For the most part, Xen does</span>
<span class="cm"> * not care about the shutdown code.</span>
<span class="cm"> */</span>
<span class="cp">#define SHUTDOWN_poweroff   0  </span><span class="cm">/* Domain exited normally. Clean up and kill. */</span><span class="cp"></span>
<span class="cp">#define SHUTDOWN_reboot     1  </span><span class="cm">/* Clean up, kill, and then restart.          */</span><span class="cp"></span>
<span class="cp">#define SHUTDOWN_suspend    2  </span><span class="cm">/* Clean up, save suspend info, kill.         */</span><span class="cp"></span>
<span class="cp">#define SHUTDOWN_crash      3  </span><span class="cm">/* Tell controller we&#39;ve crashed.             */</span><span class="cp"></span>
<span class="cp">#define SHUTDOWN_watchdog   4  </span><span class="cm">/* Restart because watchdog time expired.     */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* __XEN_PUBLIC_SCHED_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
