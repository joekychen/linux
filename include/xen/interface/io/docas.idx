f | xs_wire.h | s | 2.1K | 83 | Linus Torvalds | torvalds@linux-foundation.org | 1326218999 |  | Merge branch 'stable/for-linus-3.3' of git://git.kernel.org/pub/scm/linux/kernel/git/konrad/xen  * 'stable/for-linus-3.3' of git://git.kernel.org/pub/scm/linux/kernel/git/konrad/xen: (37 commits)   xen/pciback: Expand the warning message to include domain id.   xen/pciback: Fix "device has been assigned to X domain!" warning   xen/pciback: Move the PCI_DEV_FLAGS_ASSIGNED ops to the "[un||]bind"   xen/xenbus: don't reimplement kvasprintf via a fixed size buffer   xenbus: maximum buffer size is XENSTORE_PAYLOAD_MAX   xen/xenbus: Reject replies with payload > XENSTORE_PAYLOAD_MAX.   Xen: consolidate and simplify struct xenbus_driver instantiation   xen-gntalloc: introduce missing kfree   xen/xenbus: Fix compile error - missing header for xen_initial_domain()   xen/netback: Enable netback on HVM guests   xen/grant-table: Support mappings required by blkback   xenbus: Use grant-table wrapper functions   xenbus: Support HVM backends   xen/xenbus-frontend: Fix compile error with randconfig   xen/xenbus-frontend: Make error message more clear   xen/privcmd: Remove unused support for arch specific privcmp mmap   xen: Add xenbus_backend device   xen: Add xenbus device driver   xen: Add privcmd device driver   xen/gntalloc: fix reference counts on multi-page mappings   ...
f | netif.h | s | 5.0K | 132 | Ian Campbell | Ian.Campbell@citrix.com | 1300243083 |  | xen network backend driver  netback is the host side counterpart to the frontend driver in drivers/net/xen-netfront.c. The PV protocol is also implemented by frontend drivers in other OSes too, such as the BSDs and even Windows.  The patch is based on the driver from the xen.git pvops kernel tree but has been put through the checkpatch.pl wringer plus several manual cleanup passes and review iterations. The driver has been moved from drivers/xen/netback to drivers/net/xen-netback.  One major change from xen.git is that the guest transmit path (i.e. what looks like receive to netback) has been significantly reworked to remove the dependency on the out of tree PageForeign page flag (a core kernel patch which enables a per page destructor callback on the final put_page). This page flag was used in order to implement a grant map based transmit path (where guest pages are mapped directly into SKB frags). Instead this version of netback uses grant copy operations into regular memory belonging to the backend domain. Reinstating the grant map functionality is something which I would like to revisit in the future.  Note that this driver depends on 2e820f58f7ad "xen/irq: implement bind_interdomain_evtchn_to_irqhandler for backend drivers" which is in linux next via the "xen-two" tree and is intended for the 2.6.39 merge window:         git://git.kernel.org/pub/scm/linux/kernel/git/konrad/xen.git stable/backends this branch has only that single commit since 2.6.38-rc2 and is safe for cross merging into the net branch.  Signed-off-by: Ian Campbell <ian.campbell@citrix.com> Reviewed-by: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | pciif.h | s | 3.5K | 99 | Ryan Wilson | hap9@epoch.ncsc.mil | 1287413377 |  | xen-pcifront: Xen PCI frontend driver.  This is a port of the 2.6.18 Xen PCI front driver with fixes to make it build under 2.6.34 and later (for the full list of changes: git://git.kernel.org/pub/scm/linux/kernel/git/konrad/xen.git historic/xen-pcifront-0.1). It also includes the fixes to make it work properly.  [v2: Updated Kconfig, removed crud, added Reviewed-by] [v3: Added 'static', fixed grant table leak, redid Kconfig] [v4: Added one more 'static' and removed comments]  Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Reviewed-by: Stefano Stabellini <stefano.stabellini@eu.citrix.com> Reviewed-by: Jan Beulich <JBeulich@novell.com>
f | console.h | s | 548B | 18 | Jeremy Fitzhardinge | jeremy@xensource.com | 1184773662 |  | xen: Add Xen interface header files  Add Xen interface header files. These are taken fairly directly from the Xen tree, but somewhat rearranged to suit the kernel's conventions.  Define macros and inline functions for doing hypercalls into the hypervisor.  Signed-off-by: Jeremy Fitzhardinge <jeremy@xensource.com> Signed-off-by: Ian Pratt <ian.pratt@xensource.com> Signed-off-by: Christian Limpach <Christian.Limpach@cl.cam.ac.uk> Signed-off-by: Chris Wright <chrisw@sous-sol.org>
f | blkif.h | s | 8.1K | 178 | Konrad Rzeszutek Wilk | konrad.wilk@oracle.com | 1321640881 |  | xen/blk[front||back]: Enhance discard support with secure erasing support.  Part of the blkdev_issue_discard(xx) operation is that it can also issue a secure discard operation that will permanantly remove the sectors in question. We advertise that we can support that via the 'discard-secure' attribute and on the request, if the 'secure' bit is set, we will attempt to pass in REQ_DISCARD || REQ_SECURE.  CC: Li Dongyang <lidongyang@novell.com> [v1: Used 'flag' instead of 'secure:1' bit] [v2: Use 'reserved' uint8_t instead of adding a new value] [v3: Check for nseg when mapping instead of operation] Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
f | fbif.h | s | 4.5K | 122 | Markus Armbruster | armbru@redhat.com | 1211875896 |  | xen pvfb: Dynamic mode support (screen resizing)  The pvfb backend indicates dynamic mode support by creating node feature_resize with a non-zero value in its xenstore directory. xen-fbfront sends a resize notification event on mode change.  Fully backwards compatible both ways.  Framebuffer size and initial resolution can be controlled through kernel parameter xen_fbfront.video.  The backend enforces a separate size limit, which it advertises in node videoram in its xenstore directory.  xen-kbdfront gets the maximum screen resolution from nodes width and height in the backend's xenstore directory instead of hardcoding it.  Additional goodie: support for larger framebuffers (512M on a 64-bit system with 4K pages).  Changing the number of bits per pixels dynamically is not supported, yet.  Ported from http://xenbits.xensource.com/linux-2.6.18-xen.hg?rev/92f7b3144f41 http://xenbits.xensource.com/linux-2.6.18-xen.hg?rev/bfc040135633  Signed-off-by: Pat Campbell <plc@novell.com> Signed-off-by: Markus Armbruster <armbru@redhat.com> Signed-off-by: Jeremy Fitzhardinge <jeremy.fitzhardinge@citrix.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | xenbus.h | s | 1.3K | 44 | Yosuke Iwamatsu | y-iwamatsu@ab.jp.nec.com | 1287413375 |  | xenbus: Xen paravirtualised PCI hotplug support.  The Xen PCI front driver adds two new states that are utilizez for PCI hotplug support. This is a patch pulled from the linux-2.6-xen-sparse tree.  Signed-off-by: Noboru Iwamatsu <n_iwamatsu@jp.fujitsu.com> Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Signed-off-by: Jeremy Fitzhardinge <jeremy.fitzhardinge@citrix.com> Signed-off-by: Yosuke Iwamatsu <y-iwamatsu@ab.jp.nec.com>
f | ring.h | s | 9.6K | 238 | Jeremy Fitzhardinge | jeremy@goop.org | 1292445268 |  | xen: Provide a variant of __RING_SIZE() that is an integer constant expression  Without this, gcc 4.5 won't compile xen-netfront and xen-blkfront, where this is being used to specify array sizes.  Signed-off-by: Jan Beulich <jbeulich@novell.com> Signed-off-by: Jeremy Fitzhardinge <jeremy.fitzhardinge@citrix.com> Cc: Jens Axboe <axboe@kernel.dk> Cc: David Miller <davem@davemloft.net> Cc: Stable Kernel <stable@kernel.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | kbdif.h | s | 3.6K | 98 | Markus Armbruster | armbru@redhat.com | 1211875896 |  | xen pvfb: Pointer z-axis (mouse wheel) support  Add z-axis motion to pointer events.  Backward compatible, because there's space for the z-axis in union xenkbd_in_event, and old backends zero it.  Derived from http://xenbits.xensource.com/linux-2.6.18-xen.hg?rev/57dfe0098000 http://xenbits.xensource.com/linux-2.6.18-xen.hg?rev/1edfea26a2a9 http://xenbits.xensource.com/linux-2.6.18-xen.hg?rev/c3ff0b26f664  Signed-off-by: Pat Campbell <plc@novell.com> Signed-off-by: Markus Armbruster <armbru@redhat.com> Signed-off-by: Jeremy Fitzhardinge <jeremy.fitzhardinge@citrix.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
f | protocols.h | s | 637B | 18 | Markus Armbruster | armbru@redhat.com | 1209074252 |  | xen: Make xen-blkfront write its protocol ABI to xenstore  Frontends are expected to write their protocol ABI to xenstore.  Since the protocol ABI defaults to the backend's native ABI, things work fine without that as long as the frontend's native ABI is identical to the backend's native ABI.  This is not the case for xen-blkfront running 32-on-64, because its ABI differs between 32 and 64 bit, and thus needs this fix.  Based on http://xenbits.xensource.com/xen-unstable.hg?rev/c545932a18f3 and http://xenbits.xensource.com/xen-unstable.hg?rev/ffe52263b430 by Gerd Hoffmann <kraxel@suse.de>  Signed-off-by: Markus Armbruster <armbru@redhat.com> Signed-off-by: Jeremy Fitzhardinge <Jeremy.Fitzhardinge@citrix.com> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
