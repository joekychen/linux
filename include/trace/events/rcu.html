<!DOCTYPE html>
<html><head><title>joekychen/linux » include › trace › events › rcu.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>rcu.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#undef TRACE_SYSTEM</span>
<span class="cp">#define TRACE_SYSTEM rcu</span>

<span class="cp">#if !defined(_TRACE_RCU_H) || defined(TRACE_HEADER_MULTI_READ)</span>
<span class="cp">#define _TRACE_RCU_H</span>

<span class="cp">#include &lt;linux/tracepoint.h&gt;</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for start/end markers used for utilization calculations.</span>
<span class="cm"> * By convention, the string is of the following forms:</span>
<span class="cm"> *</span>
<span class="cm"> * &quot;Start &lt;activity&gt;&quot; -- Mark the start of the specified activity,</span>
<span class="cm"> *			 such as &quot;context switch&quot;.  Nesting is permitted.</span>
<span class="cm"> * &quot;End &lt;activity&gt;&quot; -- Mark the end of the specified activity.</span>
<span class="cm"> *</span>
<span class="cm"> * An &quot;@&quot; character within &quot;&lt;activity&gt;&quot; is a comment character: Data</span>
<span class="cm"> * reduction scripts will ignore the &quot;@&quot; and the remainder of the line.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_utilization</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">s</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">s</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#ifdef CONFIG_RCU_TRACE</span>

<span class="cp">#if defined(CONFIG_TREE_RCU) || defined(CONFIG_TREE_PREEMPT_RCU)</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for grace-period events: starting and ending a grace</span>
<span class="cm"> * period (&quot;start&quot; and &quot;end&quot;, respectively), a CPU noting the start</span>
<span class="cm"> * of a new grace period or the end of an old grace period (&quot;cpustart&quot;</span>
<span class="cm"> * and &quot;cpuend&quot;, respectively), a CPU passing through a quiescent</span>
<span class="cm"> * state (&quot;cpuqs&quot;), a CPU coming online or going offline (&quot;cpuonl&quot;</span>
<span class="cm"> * and &quot;cpuofl&quot;, respectively), and a CPU being kicked for being too</span>
<span class="cm"> * long in dyntick-idle mode (&quot;kick&quot;).</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_grace_period</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gpnum</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">gpevent</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">,</span> <span class="n">gpevent</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">gpevent</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span> <span class="o">=</span> <span class="n">gpnum</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpevent</span> <span class="o">=</span> <span class="n">gpevent</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s %lu %s&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpevent</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for grace-period-initialization events.  These are</span>
<span class="cm"> * distinguished by the type of RCU, the new grace-period number, the</span>
<span class="cm"> * rcu_node structure level, the starting and ending CPU covered by the</span>
<span class="cm"> * rcu_node structure, and the mask of CPUs that will be waited for.</span>
<span class="cm"> * All but the type of RCU are extracted from the rcu_node structure.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_grace_period_init</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gpnum</span><span class="p">,</span> <span class="n">u8</span> <span class="n">level</span><span class="p">,</span>
		 <span class="kt">int</span> <span class="n">grplo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">grphi</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">qsmask</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">grplo</span><span class="p">,</span> <span class="n">grphi</span><span class="p">,</span> <span class="n">qsmask</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u8</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grplo</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grphi</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">qsmask</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span> <span class="o">=</span> <span class="n">gpnum</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grplo</span> <span class="o">=</span> <span class="n">grplo</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grphi</span> <span class="o">=</span> <span class="n">grphi</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qsmask</span> <span class="o">=</span> <span class="n">qsmask</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s %lu %u %d %d %lx&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">level</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grplo</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grphi</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qsmask</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for tasks blocking within preemptible-RCU read-side</span>
<span class="cm"> * critical sections.  Track the type of RCU (which one day might</span>
<span class="cm"> * include SRCU), the grace-period number that the task is blocking</span>
<span class="cm"> * (the current or the next), and the task&#39;s PID.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_preempt_task</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pid</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gpnum</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span> <span class="o">=</span> <span class="n">gpnum</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s %lu %d&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pid</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for tasks that blocked within a given preemptible-RCU</span>
<span class="cm"> * read-side critical section exiting that critical section.  Track the</span>
<span class="cm"> * type of RCU (which one day might include SRCU) and the task&#39;s PID.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_unlock_preempted_task</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gpnum</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pid</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">,</span> <span class="n">pid</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span> <span class="o">=</span> <span class="n">gpnum</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s %lu %d&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">pid</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for quiescent-state-reporting events.  These are</span>
<span class="cm"> * distinguished by the type of RCU, the grace-period number, the</span>
<span class="cm"> * mask of quiescent lower-level entities, the rcu_node structure level,</span>
<span class="cm"> * the starting and ending CPU covered by the rcu_node structure, and</span>
<span class="cm"> * whether there are any blocked tasks blocking the current grace period.</span>
<span class="cm"> * All but the type of RCU are extracted from the rcu_node structure.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_quiescent_state_report</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gpnum</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">mask</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">qsmask</span><span class="p">,</span>
		 <span class="n">u8</span> <span class="n">level</span><span class="p">,</span> <span class="kt">int</span> <span class="n">grplo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">grphi</span><span class="p">,</span> <span class="kt">int</span> <span class="n">gp_tasks</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">qsmask</span><span class="p">,</span> <span class="n">level</span><span class="p">,</span> <span class="n">grplo</span><span class="p">,</span> <span class="n">grphi</span><span class="p">,</span> <span class="n">gp_tasks</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">qsmask</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u8</span><span class="p">,</span> <span class="n">level</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grplo</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">grphi</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">u8</span><span class="p">,</span> <span class="n">gp_tasks</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span> <span class="o">=</span> <span class="n">gpnum</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qsmask</span> <span class="o">=</span> <span class="n">qsmask</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grplo</span> <span class="o">=</span> <span class="n">grplo</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grphi</span> <span class="o">=</span> <span class="n">grphi</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gp_tasks</span> <span class="o">=</span> <span class="n">gp_tasks</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s %lu %lx&gt;%lx %u %d %d %u&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">mask</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qsmask</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">level</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grplo</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">grphi</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gp_tasks</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for quiescent states detected by force_quiescent_state().</span>
<span class="cm"> * These trace events include the type of RCU, the grace-period number</span>
<span class="cm"> * that was blocked by the CPU, the CPU itself, and the type of quiescent</span>
<span class="cm"> * state, which can be &quot;dti&quot; for dyntick-idle mode, &quot;ofl&quot; for CPU offline,</span>
<span class="cm"> * or &quot;kick&quot; when kicking a CPU that has been in dyntick-idle mode for</span>
<span class="cm"> * too long.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_fqs</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">gpnum</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cpu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">qsevent</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">,</span> <span class="n">cpu</span><span class="p">,</span> <span class="n">qsevent</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">gpnum</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">cpu</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">qsevent</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span> <span class="o">=</span> <span class="n">gpnum</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cpu</span> <span class="o">=</span> <span class="n">cpu</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qsevent</span> <span class="o">=</span> <span class="n">qsevent</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s %lu %d %s&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">gpnum</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cpu</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qsevent</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* #if defined(CONFIG_TREE_RCU) || defined(CONFIG_TREE_PREEMPT_RCU) */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for dyntick-idle entry/exit events.  These take a string</span>
<span class="cm"> * as argument: &quot;Start&quot; for entering dyntick-idle mode, &quot;End&quot; for</span>
<span class="cm"> * leaving it, &quot;--=&quot; for events moving towards idle, and &quot;++=&quot; for events</span>
<span class="cm"> * moving away from idle.  &quot;Error on entry: not idle task&quot; and &quot;Error on</span>
<span class="cm"> * exit: not idle task&quot; indicate that a non-idle task is erroneously</span>
<span class="cm"> * toying with the idle loop.</span>
<span class="cm"> *</span>
<span class="cm"> * These events also take a pair of numbers, which indicate the nesting</span>
<span class="cm"> * depth before and after the event of interest.  Note that task-related</span>
<span class="cm"> * events use the upper bits of each number, while interrupt-related</span>
<span class="cm"> * events use the lower bits.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_dyntick</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">polarity</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">oldnesting</span><span class="p">,</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">newnesting</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">polarity</span><span class="p">,</span> <span class="n">oldnesting</span><span class="p">,</span> <span class="n">newnesting</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">polarity</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">oldnesting</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span><span class="p">,</span> <span class="n">newnesting</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">polarity</span> <span class="o">=</span> <span class="n">polarity</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">oldnesting</span> <span class="o">=</span> <span class="n">oldnesting</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">newnesting</span> <span class="o">=</span> <span class="n">newnesting</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s %llx %llx&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">polarity</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">oldnesting</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">newnesting</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for RCU preparation for idle, the goal being to get RCU</span>
<span class="cm"> * processing done so that the current CPU can shut off its scheduling</span>
<span class="cm"> * clock and enter dyntick-idle mode.  One way to accomplish this is</span>
<span class="cm"> * to drain all RCU callbacks from this CPU, and the other is to have</span>
<span class="cm"> * done everything RCU requires for the current grace period.  In this</span>
<span class="cm"> * latter case, the CPU will be awakened at the end of the current grace</span>
<span class="cm"> * period in order to process the remainder of its callbacks.</span>
<span class="cm"> *</span>
<span class="cm"> * These tracepoints take a string as argument:</span>
<span class="cm"> *</span>
<span class="cm"> *	&quot;No callbacks&quot;: Nothing to do, no callbacks on this CPU.</span>
<span class="cm"> *	&quot;In holdoff&quot;: Nothing to do, holding off after unsuccessful attempt.</span>
<span class="cm"> *	&quot;Begin holdoff&quot;: Attempt failed, don&#39;t retry until next jiffy.</span>
<span class="cm"> *	&quot;Dyntick with callbacks&quot;: Entering dyntick-idle despite callbacks.</span>
<span class="cm"> *	&quot;Dyntick with lazy callbacks&quot;: Entering dyntick-idle w/lazy callbacks.</span>
<span class="cm"> *	&quot;More callbacks&quot;: Still more callbacks, try again to clear them out.</span>
<span class="cm"> *	&quot;Callbacks drained&quot;: All callbacks processed, off to dyntick idle!</span>
<span class="cm"> *	&quot;Timer&quot;: Timer fired to cause CPU to continue processing callbacks.</span>
<span class="cm"> *	&quot;Demigrate&quot;: Timer fired on wrong CPU, woke up correct CPU.</span>
<span class="cm"> *	&quot;Cleanup after idle&quot;: Idle exited, timer canceled.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_prep_idle</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">reason</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">reason</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">reason</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">reason</span> <span class="o">=</span> <span class="n">reason</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s&quot;</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">reason</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for the registration of a single RCU callback function.</span>
<span class="cm"> * The first argument is the type of RCU, the second argument is</span>
<span class="cm"> * a pointer to the RCU callback itself, the third element is the</span>
<span class="cm"> * number of lazy callbacks queued, and the fourth element is the</span>
<span class="cm"> * total number of callbacks queued.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_callback</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rcu_head</span> <span class="o">*</span><span class="n">rhp</span><span class="p">,</span> <span class="kt">long</span> <span class="n">qlen_lazy</span><span class="p">,</span>
		 <span class="kt">long</span> <span class="n">qlen</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">rhp</span><span class="p">,</span> <span class="n">qlen_lazy</span><span class="p">,</span> <span class="n">qlen</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">rhp</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span><span class="p">,</span> <span class="n">qlen_lazy</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span><span class="p">,</span> <span class="n">qlen</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span> <span class="o">=</span> <span class="n">rhp</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">func</span> <span class="o">=</span> <span class="n">rhp</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen_lazy</span> <span class="o">=</span> <span class="n">qlen_lazy</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen</span> <span class="o">=</span> <span class="n">qlen</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s rhp=%p func=%pf %ld/%ld&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen_lazy</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for the registration of a single RCU callback of the special</span>
<span class="cm"> * kfree() form.  The first argument is the RCU type, the second argument</span>
<span class="cm"> * is a pointer to the RCU callback, the third argument is the offset</span>
<span class="cm"> * of the callback within the enclosing RCU-protected data structure,</span>
<span class="cm"> * the fourth argument is the number of lazy callbacks queued, and the</span>
<span class="cm"> * fifth argument is the total number of callbacks queued.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_kfree_callback</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rcu_head</span> <span class="o">*</span><span class="n">rhp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">offset</span><span class="p">,</span>
		 <span class="kt">long</span> <span class="n">qlen_lazy</span><span class="p">,</span> <span class="kt">long</span> <span class="n">qlen</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">rhp</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">qlen_lazy</span><span class="p">,</span> <span class="n">qlen</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">rhp</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span><span class="p">,</span> <span class="n">qlen_lazy</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span><span class="p">,</span> <span class="n">qlen</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span> <span class="o">=</span> <span class="n">rhp</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">=</span> <span class="n">offset</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen_lazy</span> <span class="o">=</span> <span class="n">qlen_lazy</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen</span> <span class="o">=</span> <span class="n">qlen</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s rhp=%p func=%ld %ld/%ld&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen_lazy</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for marking the beginning rcu_do_batch, performed to start</span>
<span class="cm"> * RCU callback invocation.  The first argument is the RCU flavor,</span>
<span class="cm"> * the second is the number of lazy callbacks queued, the third is</span>
<span class="cm"> * the total number of callbacks queued, and the fourth argument is</span>
<span class="cm"> * the current RCU-callback batch limit.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_batch_start</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">long</span> <span class="n">qlen_lazy</span><span class="p">,</span> <span class="kt">long</span> <span class="n">qlen</span><span class="p">,</span> <span class="kt">int</span> <span class="n">blimit</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">qlen_lazy</span><span class="p">,</span> <span class="n">qlen</span><span class="p">,</span> <span class="n">blimit</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span><span class="p">,</span> <span class="n">qlen_lazy</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">long</span><span class="p">,</span> <span class="n">qlen</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">blimit</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen_lazy</span> <span class="o">=</span> <span class="n">qlen_lazy</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen</span> <span class="o">=</span> <span class="n">qlen</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blimit</span> <span class="o">=</span> <span class="n">blimit</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s CBs=%ld/%ld bl=%d&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen_lazy</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">qlen</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">blimit</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for the invocation of a single RCU callback function.</span>
<span class="cm"> * The first argument is the type of RCU, and the second argument is</span>
<span class="cm"> * a pointer to the RCU callback itself.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_invoke_callback</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rcu_head</span> <span class="o">*</span><span class="n">rhp</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">rhp</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">rhp</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span> <span class="o">=</span> <span class="n">rhp</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">func</span> <span class="o">=</span> <span class="n">rhp</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s rhp=%p func=%pf&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for the invocation of a single RCU callback of the special</span>
<span class="cm"> * kfree() form.  The first argument is the RCU flavor, the second</span>
<span class="cm"> * argument is a pointer to the RCU callback, and the third argument</span>
<span class="cm"> * is the offset of the callback within the enclosing RCU-protected</span>
<span class="cm"> * data structure.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_invoke_kfree_callback</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rcu_head</span> <span class="o">*</span><span class="n">rhp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">offset</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">rhp</span><span class="p">,</span> <span class="n">offset</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">rhp</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span> <span class="o">=</span> <span class="n">rhp</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span>	<span class="o">=</span> <span class="n">offset</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s rhp=%p func=%ld&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for exiting rcu_do_batch after RCU callbacks have been</span>
<span class="cm"> * invoked.  The first argument is the name of the RCU flavor,</span>
<span class="cm"> * the second argument is number of callbacks actually invoked,</span>
<span class="cm"> * the third argument (cb) is whether or not any of the callbacks that</span>
<span class="cm"> * were ready to invoke at the beginning of this batch are still</span>
<span class="cm"> * queued, the fourth argument (nr) is the return value of need_resched(),</span>
<span class="cm"> * the fifth argument (iit) is 1 if the current task is the idle task,</span>
<span class="cm"> * and the sixth argument (risk) is the return value from</span>
<span class="cm"> * rcu_is_callbacks_kthread().</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_batch_end</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcuname</span><span class="p">,</span> <span class="kt">int</span> <span class="n">callbacks_invoked</span><span class="p">,</span>
		 <span class="n">bool</span> <span class="n">cb</span><span class="p">,</span> <span class="n">bool</span> <span class="n">nr</span><span class="p">,</span> <span class="n">bool</span> <span class="n">iit</span><span class="p">,</span> <span class="n">bool</span> <span class="n">risk</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">callbacks_invoked</span><span class="p">,</span> <span class="n">cb</span><span class="p">,</span> <span class="n">nr</span><span class="p">,</span> <span class="n">iit</span><span class="p">,</span> <span class="n">risk</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcuname</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="n">callbacks_invoked</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">bool</span><span class="p">,</span> <span class="n">cb</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">bool</span><span class="p">,</span> <span class="n">nr</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">bool</span><span class="p">,</span> <span class="n">iit</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="n">bool</span><span class="p">,</span> <span class="n">risk</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span> <span class="o">=</span> <span class="n">rcuname</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">callbacks_invoked</span> <span class="o">=</span> <span class="n">callbacks_invoked</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cb</span> <span class="o">=</span> <span class="n">cb</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nr</span> <span class="o">=</span> <span class="n">nr</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">iit</span> <span class="o">=</span> <span class="n">iit</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">risk</span> <span class="o">=</span> <span class="n">risk</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s CBs-invoked=%d idle=%c%c%c%c&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcuname</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">callbacks_invoked</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">cb</span> <span class="o">?</span> <span class="sc">&#39;C&#39;</span> <span class="o">:</span> <span class="sc">&#39;.&#39;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">nr</span> <span class="o">?</span> <span class="sc">&#39;S&#39;</span> <span class="o">:</span> <span class="sc">&#39;.&#39;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">iit</span> <span class="o">?</span> <span class="sc">&#39;I&#39;</span> <span class="o">:</span> <span class="sc">&#39;.&#39;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">risk</span> <span class="o">?</span> <span class="sc">&#39;R&#39;</span> <span class="o">:</span> <span class="sc">&#39;.&#39;</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Tracepoint for rcutorture readers.  The first argument is the name</span>
<span class="cm"> * of the RCU flavor from rcutorture&#39;s viewpoint and the second argument</span>
<span class="cm"> * is the callback address.</span>
<span class="cm"> */</span>
<span class="n">TRACE_EVENT</span><span class="p">(</span><span class="n">rcu_torture_read</span><span class="p">,</span>

	<span class="n">TP_PROTO</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">rcutorturename</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rcu_head</span> <span class="o">*</span><span class="n">rhp</span><span class="p">),</span>

	<span class="n">TP_ARGS</span><span class="p">(</span><span class="n">rcutorturename</span><span class="p">,</span> <span class="n">rhp</span><span class="p">),</span>

	<span class="n">TP_STRUCT__entry</span><span class="p">(</span>
		<span class="n">__field</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="n">rcutorturename</span><span class="p">)</span>
		<span class="n">__field</span><span class="p">(</span><span class="k">struct</span> <span class="n">rcu_head</span> <span class="o">*</span><span class="p">,</span> <span class="n">rhp</span><span class="p">)</span>
	<span class="p">),</span>

	<span class="n">TP_fast_assign</span><span class="p">(</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcutorturename</span> <span class="o">=</span> <span class="n">rcutorturename</span><span class="p">;</span>
		<span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span> <span class="o">=</span> <span class="n">rhp</span><span class="p">;</span>
	<span class="p">),</span>

	<span class="n">TP_printk</span><span class="p">(</span><span class="s">&quot;%s torture read %p&quot;</span><span class="p">,</span>
		  <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rcutorturename</span><span class="p">,</span> <span class="n">__entry</span><span class="o">-&gt;</span><span class="n">rhp</span><span class="p">)</span>
<span class="p">);</span>

<span class="cp">#else </span><span class="cm">/* #ifdef CONFIG_RCU_TRACE */</span><span class="cp"></span>

<span class="cp">#define trace_rcu_grace_period(rcuname, gpnum, gpevent) do { } while (0)</span>
<span class="cp">#define trace_rcu_grace_period_init(rcuname, gpnum, level, grplo, grphi, \</span>
<span class="cp">				    qsmask) do { } while (0)</span>
<span class="cp">#define trace_rcu_preempt_task(rcuname, pid, gpnum) do { } while (0)</span>
<span class="cp">#define trace_rcu_unlock_preempted_task(rcuname, gpnum, pid) do { } while (0)</span>
<span class="cp">#define trace_rcu_quiescent_state_report(rcuname, gpnum, mask, qsmask, level, \</span>
<span class="cp">					 grplo, grphi, gp_tasks) do { } \</span>
<span class="cp">	while (0)</span>
<span class="cp">#define trace_rcu_fqs(rcuname, gpnum, cpu, qsevent) do { } while (0)</span>
<span class="cp">#define trace_rcu_dyntick(polarity, oldnesting, newnesting) do { } while (0)</span>
<span class="cp">#define trace_rcu_prep_idle(reason) do { } while (0)</span>
<span class="cp">#define trace_rcu_callback(rcuname, rhp, qlen_lazy, qlen) do { } while (0)</span>
<span class="cp">#define trace_rcu_kfree_callback(rcuname, rhp, offset, qlen_lazy, qlen) \</span>
<span class="cp">	do { } while (0)</span>
<span class="cp">#define trace_rcu_batch_start(rcuname, qlen_lazy, qlen, blimit) \</span>
<span class="cp">	do { } while (0)</span>
<span class="cp">#define trace_rcu_invoke_callback(rcuname, rhp) do { } while (0)</span>
<span class="cp">#define trace_rcu_invoke_kfree_callback(rcuname, rhp, offset) do { } while (0)</span>
<span class="cp">#define trace_rcu_batch_end(rcuname, callbacks_invoked, cb, nr, iit, risk) \</span>
<span class="cp">	do { } while (0)</span>
<span class="cp">#define trace_rcu_torture_read(rcutorturename, rhp) do { } while (0)</span>

<span class="cp">#endif </span><span class="cm">/* #else #ifdef CONFIG_RCU_TRACE */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _TRACE_RCU_H */</span><span class="cp"></span>

<span class="cm">/* This part must be outside protection */</span>
<span class="cp">#include &lt;trace/define_trace.h&gt;</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
