f | mpi-bit.c | s | 4.6K | 186 | Jesper Juhl | jj@chaosbits.net | 1334715268 |  | mpi: Avoid using freed pointer in mpi_lshift_limbs()  At the start of the function we assign 'a->d' to 'ap'. Then we use the RESIZE_IF_NEEDED macro on 'a' - this may free 'a->d' and replace it with newly allocaetd storage. In that case, we'll be operating on freed memory further down in the function when we index into 'ap[]'. Since we don't actually need 'ap' until after the use of the RESIZE_IF_NEEDED macro we can just delay the assignment to it until after we've potentially resized, thus avoiding the issue.  While I was there anyway I also changed the integer variable 'n' to be const. It might as well be since we only assign to it once and use it as a constant, and then the compiler will tell us if we ever assign to it in the future.  Signed-off-by: Jesper Juhl <jj@chaosbits.net> Acked-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: James Morris <james.l.morris@oracle.com>
f | Makefile | g | 537B |  | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpih-div.c | s | 14K | 477 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1328102619 |  | lib/mpi: added comment on divide by 0 case  Comment explains that existing clients do not call this function with dsize == 0, which means that 1/0 should not happen.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Reviewed-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Signed-off-by: James Morris <jmorris@namei.org>
f | mpi-cmp.c | s | 1.6K | 62 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpi-scan.c | s | 3.3K | 127 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpi-add.c | s | 5.7K | 213 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpih-cmp.c | s | 2.0K | 52 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpih-mul.c | s | 14K | 469 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpi-div.c | s | 8.4K | 289 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1328102619 |  | lib/mpi: added missing NULL check  Added missing NULL check after mpi_alloc_limb_space().  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Reviewed-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Signed-off-by: James Morris <jmorris@namei.org>
f | mpi-inv.c | s | 4.2K | 179 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpi-inline.h | s | 3.3K | 107 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831926 |  | crypto: GnuPG based MPI lib - header files (part 2)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | generic_mpih-mul1.c | s | 1.9K | 51 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpi-mpow.c | s | 3.0K | 126 | Dan Carpenter | dan.carpenter@oracle.com | 1323263363 |  | mpi/mpi-mpow: NULL dereference on allocation failure  We can't call mpi_free() on the elements if the first kzalloc() fails.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Signed-off-by: James Morris <jmorris@namei.org>
f | generic_mpi-asm-defs.h | s | 210B | 4 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpi-gcd.c | s | 1.5K | 52 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | generic_mpih-add1.c | s | 2.0K | 55 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpiutil.c | s | 3.8K | 179 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1328102619 |  | lib/mpi: check for possible zero length  Buggy client might pass zero nlimbs which is meaningless. Added check for zero length.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Reviewed-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Signed-off-by: James Morris <jmorris@namei.org>
f | mpi-mul.c | s | 4.5K | 174 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | generic_mpih-mul2.c | s | 1.9K | 54 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | generic_mpih-mul3.c | s | 1.9K | 54 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | longlong.h | s | 42K | 1455 | David Miller | davem@davemloft.net | 1328139265 |  | lib: Fix 32-bit sparc udiv_qrnnd() definition in mpilib's longlong.h  This copy of longlong.h is extremely dated and results in compile errors on sparc32 when MPILIB is enabled, copy over the more uptodate implementation from arch/sparc/math/sfp-util_32.h  Reported-by: Al Viro <viro@ZenIV.linux.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net> Signed-off-by: James Morris <jmorris@namei.org>
f | mpi-internal.h | s | 7.9K | 227 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831926 |  | crypto: GnuPG based MPI lib - header files (part 2)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | generic_mpih-rshift.c | s | 2.1K | 58 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | generic_mpih-sub1.c | s | 2.0K | 54 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpicoder.c | s | 6.6K | 259 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1328102594 |  | lib/mpi: removed unused functions  do_encode_md() and mpi_get_keyid() are not parts of mpi library. They were used early versions of gnupg and in digsig project, but they are not used neither here nor there anymore.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Reviewed-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Signed-off-by: James Morris <jmorris@namei.org>
f | mpi-pow.c | s | 8.3K | 293 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1328102594 |  | lib/mpi: return error code on dividing by zero  Definitely better to return error code than to divide by zero.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com> Reviewed-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Signed-off-by: James Morris <jmorris@namei.org>
f | generic_mpih-lshift.c | s | 2.1K | 58 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320831922 |  | crypto: GnuPG based MPI lib - source files (part 1)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
f | mpi-inline.c | s | 1.1K | 28 | Dmitry Kasatkin | dmitry.kasatkin@intel.com | 1320832046 |  | crypto: GnuPG based MPI lib - additional sources (part 4)  Adds the multi-precision-integer maths library which was originally taken from GnuPG and ported to the kernel by (among others) David Howells. This version is taken from Fedora kernel 2.6.32-71.14.1.el6. The difference is that checkpatch reported errors and warnings have been fixed.  This library is used to implemenet RSA digital signature verification used in IMA/EVM integrity protection subsystem.  Due to patch size limitation, the patch is divided into 4 parts.  This code is unnecessary for RSA digital signature verification, but for completeness it is included here and can be compiled, if CONFIG_MPILIB_EXTRA is enabled.  Signed-off-by: Dmitry Kasatkin <dmitry.kasatkin@intel.com>
