<!DOCTYPE html>
<html><head><title>joekychen/linux » lib › crc-t10dif.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../index.html"></a><h1>crc-t10dif.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * T10 Data Integrity Field CRC16 calculation</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2007 Oracle Corporation.  All rights reserved.</span>
<span class="cm"> * Written by Martin K. Petersen &lt;martin.petersen@oracle.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This source code is licensed under the GNU General Public License,</span>
<span class="cm"> * Version 2. See the file COPYING for more details.</span>
<span class="cm"> */</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/crc-t10dif.h&gt;</span>

<span class="cm">/* Table generated using the following polynomium:</span>
<span class="cm"> * x^16 + x^15 + x^11 + x^9 + x^8 + x^7 + x^5 + x^4 + x^2 + x + 1</span>
<span class="cm"> * gt: 0x8bb7</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="k">const</span> <span class="n">__u16</span> <span class="n">t10_dif_crc_table</span><span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="mh">0x0000</span><span class="p">,</span> <span class="mh">0x8BB7</span><span class="p">,</span> <span class="mh">0x9CD9</span><span class="p">,</span> <span class="mh">0x176E</span><span class="p">,</span> <span class="mh">0xB205</span><span class="p">,</span> <span class="mh">0x39B2</span><span class="p">,</span> <span class="mh">0x2EDC</span><span class="p">,</span> <span class="mh">0xA56B</span><span class="p">,</span>
	<span class="mh">0xEFBD</span><span class="p">,</span> <span class="mh">0x640A</span><span class="p">,</span> <span class="mh">0x7364</span><span class="p">,</span> <span class="mh">0xF8D3</span><span class="p">,</span> <span class="mh">0x5DB8</span><span class="p">,</span> <span class="mh">0xD60F</span><span class="p">,</span> <span class="mh">0xC161</span><span class="p">,</span> <span class="mh">0x4AD6</span><span class="p">,</span>
	<span class="mh">0x54CD</span><span class="p">,</span> <span class="mh">0xDF7A</span><span class="p">,</span> <span class="mh">0xC814</span><span class="p">,</span> <span class="mh">0x43A3</span><span class="p">,</span> <span class="mh">0xE6C8</span><span class="p">,</span> <span class="mh">0x6D7F</span><span class="p">,</span> <span class="mh">0x7A11</span><span class="p">,</span> <span class="mh">0xF1A6</span><span class="p">,</span>
	<span class="mh">0xBB70</span><span class="p">,</span> <span class="mh">0x30C7</span><span class="p">,</span> <span class="mh">0x27A9</span><span class="p">,</span> <span class="mh">0xAC1E</span><span class="p">,</span> <span class="mh">0x0975</span><span class="p">,</span> <span class="mh">0x82C2</span><span class="p">,</span> <span class="mh">0x95AC</span><span class="p">,</span> <span class="mh">0x1E1B</span><span class="p">,</span>
	<span class="mh">0xA99A</span><span class="p">,</span> <span class="mh">0x222D</span><span class="p">,</span> <span class="mh">0x3543</span><span class="p">,</span> <span class="mh">0xBEF4</span><span class="p">,</span> <span class="mh">0x1B9F</span><span class="p">,</span> <span class="mh">0x9028</span><span class="p">,</span> <span class="mh">0x8746</span><span class="p">,</span> <span class="mh">0x0CF1</span><span class="p">,</span>
	<span class="mh">0x4627</span><span class="p">,</span> <span class="mh">0xCD90</span><span class="p">,</span> <span class="mh">0xDAFE</span><span class="p">,</span> <span class="mh">0x5149</span><span class="p">,</span> <span class="mh">0xF422</span><span class="p">,</span> <span class="mh">0x7F95</span><span class="p">,</span> <span class="mh">0x68FB</span><span class="p">,</span> <span class="mh">0xE34C</span><span class="p">,</span>
	<span class="mh">0xFD57</span><span class="p">,</span> <span class="mh">0x76E0</span><span class="p">,</span> <span class="mh">0x618E</span><span class="p">,</span> <span class="mh">0xEA39</span><span class="p">,</span> <span class="mh">0x4F52</span><span class="p">,</span> <span class="mh">0xC4E5</span><span class="p">,</span> <span class="mh">0xD38B</span><span class="p">,</span> <span class="mh">0x583C</span><span class="p">,</span>
	<span class="mh">0x12EA</span><span class="p">,</span> <span class="mh">0x995D</span><span class="p">,</span> <span class="mh">0x8E33</span><span class="p">,</span> <span class="mh">0x0584</span><span class="p">,</span> <span class="mh">0xA0EF</span><span class="p">,</span> <span class="mh">0x2B58</span><span class="p">,</span> <span class="mh">0x3C36</span><span class="p">,</span> <span class="mh">0xB781</span><span class="p">,</span>
	<span class="mh">0xD883</span><span class="p">,</span> <span class="mh">0x5334</span><span class="p">,</span> <span class="mh">0x445A</span><span class="p">,</span> <span class="mh">0xCFED</span><span class="p">,</span> <span class="mh">0x6A86</span><span class="p">,</span> <span class="mh">0xE131</span><span class="p">,</span> <span class="mh">0xF65F</span><span class="p">,</span> <span class="mh">0x7DE8</span><span class="p">,</span>
	<span class="mh">0x373E</span><span class="p">,</span> <span class="mh">0xBC89</span><span class="p">,</span> <span class="mh">0xABE7</span><span class="p">,</span> <span class="mh">0x2050</span><span class="p">,</span> <span class="mh">0x853B</span><span class="p">,</span> <span class="mh">0x0E8C</span><span class="p">,</span> <span class="mh">0x19E2</span><span class="p">,</span> <span class="mh">0x9255</span><span class="p">,</span>
	<span class="mh">0x8C4E</span><span class="p">,</span> <span class="mh">0x07F9</span><span class="p">,</span> <span class="mh">0x1097</span><span class="p">,</span> <span class="mh">0x9B20</span><span class="p">,</span> <span class="mh">0x3E4B</span><span class="p">,</span> <span class="mh">0xB5FC</span><span class="p">,</span> <span class="mh">0xA292</span><span class="p">,</span> <span class="mh">0x2925</span><span class="p">,</span>
	<span class="mh">0x63F3</span><span class="p">,</span> <span class="mh">0xE844</span><span class="p">,</span> <span class="mh">0xFF2A</span><span class="p">,</span> <span class="mh">0x749D</span><span class="p">,</span> <span class="mh">0xD1F6</span><span class="p">,</span> <span class="mh">0x5A41</span><span class="p">,</span> <span class="mh">0x4D2F</span><span class="p">,</span> <span class="mh">0xC698</span><span class="p">,</span>
	<span class="mh">0x7119</span><span class="p">,</span> <span class="mh">0xFAAE</span><span class="p">,</span> <span class="mh">0xEDC0</span><span class="p">,</span> <span class="mh">0x6677</span><span class="p">,</span> <span class="mh">0xC31C</span><span class="p">,</span> <span class="mh">0x48AB</span><span class="p">,</span> <span class="mh">0x5FC5</span><span class="p">,</span> <span class="mh">0xD472</span><span class="p">,</span>
	<span class="mh">0x9EA4</span><span class="p">,</span> <span class="mh">0x1513</span><span class="p">,</span> <span class="mh">0x027D</span><span class="p">,</span> <span class="mh">0x89CA</span><span class="p">,</span> <span class="mh">0x2CA1</span><span class="p">,</span> <span class="mh">0xA716</span><span class="p">,</span> <span class="mh">0xB078</span><span class="p">,</span> <span class="mh">0x3BCF</span><span class="p">,</span>
	<span class="mh">0x25D4</span><span class="p">,</span> <span class="mh">0xAE63</span><span class="p">,</span> <span class="mh">0xB90D</span><span class="p">,</span> <span class="mh">0x32BA</span><span class="p">,</span> <span class="mh">0x97D1</span><span class="p">,</span> <span class="mh">0x1C66</span><span class="p">,</span> <span class="mh">0x0B08</span><span class="p">,</span> <span class="mh">0x80BF</span><span class="p">,</span>
	<span class="mh">0xCA69</span><span class="p">,</span> <span class="mh">0x41DE</span><span class="p">,</span> <span class="mh">0x56B0</span><span class="p">,</span> <span class="mh">0xDD07</span><span class="p">,</span> <span class="mh">0x786C</span><span class="p">,</span> <span class="mh">0xF3DB</span><span class="p">,</span> <span class="mh">0xE4B5</span><span class="p">,</span> <span class="mh">0x6F02</span><span class="p">,</span>
	<span class="mh">0x3AB1</span><span class="p">,</span> <span class="mh">0xB106</span><span class="p">,</span> <span class="mh">0xA668</span><span class="p">,</span> <span class="mh">0x2DDF</span><span class="p">,</span> <span class="mh">0x88B4</span><span class="p">,</span> <span class="mh">0x0303</span><span class="p">,</span> <span class="mh">0x146D</span><span class="p">,</span> <span class="mh">0x9FDA</span><span class="p">,</span>
	<span class="mh">0xD50C</span><span class="p">,</span> <span class="mh">0x5EBB</span><span class="p">,</span> <span class="mh">0x49D5</span><span class="p">,</span> <span class="mh">0xC262</span><span class="p">,</span> <span class="mh">0x6709</span><span class="p">,</span> <span class="mh">0xECBE</span><span class="p">,</span> <span class="mh">0xFBD0</span><span class="p">,</span> <span class="mh">0x7067</span><span class="p">,</span>
	<span class="mh">0x6E7C</span><span class="p">,</span> <span class="mh">0xE5CB</span><span class="p">,</span> <span class="mh">0xF2A5</span><span class="p">,</span> <span class="mh">0x7912</span><span class="p">,</span> <span class="mh">0xDC79</span><span class="p">,</span> <span class="mh">0x57CE</span><span class="p">,</span> <span class="mh">0x40A0</span><span class="p">,</span> <span class="mh">0xCB17</span><span class="p">,</span>
	<span class="mh">0x81C1</span><span class="p">,</span> <span class="mh">0x0A76</span><span class="p">,</span> <span class="mh">0x1D18</span><span class="p">,</span> <span class="mh">0x96AF</span><span class="p">,</span> <span class="mh">0x33C4</span><span class="p">,</span> <span class="mh">0xB873</span><span class="p">,</span> <span class="mh">0xAF1D</span><span class="p">,</span> <span class="mh">0x24AA</span><span class="p">,</span>
	<span class="mh">0x932B</span><span class="p">,</span> <span class="mh">0x189C</span><span class="p">,</span> <span class="mh">0x0FF2</span><span class="p">,</span> <span class="mh">0x8445</span><span class="p">,</span> <span class="mh">0x212E</span><span class="p">,</span> <span class="mh">0xAA99</span><span class="p">,</span> <span class="mh">0xBDF7</span><span class="p">,</span> <span class="mh">0x3640</span><span class="p">,</span>
	<span class="mh">0x7C96</span><span class="p">,</span> <span class="mh">0xF721</span><span class="p">,</span> <span class="mh">0xE04F</span><span class="p">,</span> <span class="mh">0x6BF8</span><span class="p">,</span> <span class="mh">0xCE93</span><span class="p">,</span> <span class="mh">0x4524</span><span class="p">,</span> <span class="mh">0x524A</span><span class="p">,</span> <span class="mh">0xD9FD</span><span class="p">,</span>
	<span class="mh">0xC7E6</span><span class="p">,</span> <span class="mh">0x4C51</span><span class="p">,</span> <span class="mh">0x5B3F</span><span class="p">,</span> <span class="mh">0xD088</span><span class="p">,</span> <span class="mh">0x75E3</span><span class="p">,</span> <span class="mh">0xFE54</span><span class="p">,</span> <span class="mh">0xE93A</span><span class="p">,</span> <span class="mh">0x628D</span><span class="p">,</span>
	<span class="mh">0x285B</span><span class="p">,</span> <span class="mh">0xA3EC</span><span class="p">,</span> <span class="mh">0xB482</span><span class="p">,</span> <span class="mh">0x3F35</span><span class="p">,</span> <span class="mh">0x9A5E</span><span class="p">,</span> <span class="mh">0x11E9</span><span class="p">,</span> <span class="mh">0x0687</span><span class="p">,</span> <span class="mh">0x8D30</span><span class="p">,</span>
	<span class="mh">0xE232</span><span class="p">,</span> <span class="mh">0x6985</span><span class="p">,</span> <span class="mh">0x7EEB</span><span class="p">,</span> <span class="mh">0xF55C</span><span class="p">,</span> <span class="mh">0x5037</span><span class="p">,</span> <span class="mh">0xDB80</span><span class="p">,</span> <span class="mh">0xCCEE</span><span class="p">,</span> <span class="mh">0x4759</span><span class="p">,</span>
	<span class="mh">0x0D8F</span><span class="p">,</span> <span class="mh">0x8638</span><span class="p">,</span> <span class="mh">0x9156</span><span class="p">,</span> <span class="mh">0x1AE1</span><span class="p">,</span> <span class="mh">0xBF8A</span><span class="p">,</span> <span class="mh">0x343D</span><span class="p">,</span> <span class="mh">0x2353</span><span class="p">,</span> <span class="mh">0xA8E4</span><span class="p">,</span>
	<span class="mh">0xB6FF</span><span class="p">,</span> <span class="mh">0x3D48</span><span class="p">,</span> <span class="mh">0x2A26</span><span class="p">,</span> <span class="mh">0xA191</span><span class="p">,</span> <span class="mh">0x04FA</span><span class="p">,</span> <span class="mh">0x8F4D</span><span class="p">,</span> <span class="mh">0x9823</span><span class="p">,</span> <span class="mh">0x1394</span><span class="p">,</span>
	<span class="mh">0x5942</span><span class="p">,</span> <span class="mh">0xD2F5</span><span class="p">,</span> <span class="mh">0xC59B</span><span class="p">,</span> <span class="mh">0x4E2C</span><span class="p">,</span> <span class="mh">0xEB47</span><span class="p">,</span> <span class="mh">0x60F0</span><span class="p">,</span> <span class="mh">0x779E</span><span class="p">,</span> <span class="mh">0xFC29</span><span class="p">,</span>
	<span class="mh">0x4BA8</span><span class="p">,</span> <span class="mh">0xC01F</span><span class="p">,</span> <span class="mh">0xD771</span><span class="p">,</span> <span class="mh">0x5CC6</span><span class="p">,</span> <span class="mh">0xF9AD</span><span class="p">,</span> <span class="mh">0x721A</span><span class="p">,</span> <span class="mh">0x6574</span><span class="p">,</span> <span class="mh">0xEEC3</span><span class="p">,</span>
	<span class="mh">0xA415</span><span class="p">,</span> <span class="mh">0x2FA2</span><span class="p">,</span> <span class="mh">0x38CC</span><span class="p">,</span> <span class="mh">0xB37B</span><span class="p">,</span> <span class="mh">0x1610</span><span class="p">,</span> <span class="mh">0x9DA7</span><span class="p">,</span> <span class="mh">0x8AC9</span><span class="p">,</span> <span class="mh">0x017E</span><span class="p">,</span>
	<span class="mh">0x1F65</span><span class="p">,</span> <span class="mh">0x94D2</span><span class="p">,</span> <span class="mh">0x83BC</span><span class="p">,</span> <span class="mh">0x080B</span><span class="p">,</span> <span class="mh">0xAD60</span><span class="p">,</span> <span class="mh">0x26D7</span><span class="p">,</span> <span class="mh">0x31B9</span><span class="p">,</span> <span class="mh">0xBA0E</span><span class="p">,</span>
	<span class="mh">0xF0D8</span><span class="p">,</span> <span class="mh">0x7B6F</span><span class="p">,</span> <span class="mh">0x6C01</span><span class="p">,</span> <span class="mh">0xE7B6</span><span class="p">,</span> <span class="mh">0x42DD</span><span class="p">,</span> <span class="mh">0xC96A</span><span class="p">,</span> <span class="mh">0xDE04</span><span class="p">,</span> <span class="mh">0x55B3</span>
<span class="p">};</span>

<span class="n">__u16</span> <span class="nf">crc_t10dif</span><span class="p">(</span><span class="k">const</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">__u16</span> <span class="n">crc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span> <span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span> <span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="n">crc</span> <span class="o">=</span> <span class="p">(</span><span class="n">crc</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">^</span> <span class="n">t10_dif_crc_table</span><span class="p">[((</span><span class="n">crc</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">^</span> <span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">];</span>

	<span class="k">return</span> <span class="n">crc</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">EXPORT_SYMBOL</span><span class="p">(</span><span class="n">crc_t10dif</span><span class="p">);</span>

<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;T10 DIF CRC calculation&quot;</span><span class="p">);</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:1}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../javascript/docco.min.js"></script>
</html>
