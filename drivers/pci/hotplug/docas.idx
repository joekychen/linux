f | pciehp.h | s | 6.3K | 170 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | pci_hotplug_core.c | s | 13K | 483 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | Makefile | g | 1.9K |  | Matthew Garrett | mjg@redhat.com | 1257353234 |  | PCI hotplug: acpiphp should be linked after vendor drivers  As a followup to 71a082efc9fdc12068a3cee6cebb1330b00ebeee, it's conceivable that some vendors may expose PCI hotplug functionality through both vendor mechanisms and ACPI. The native mechanism will generally be a superset of any functionality provided via ACPI, so the acpiphp driver should always be initialised after any others. Change the link order such that acpiphp will not be initialised until any other statically linked drivers have had an opportunity to claim the hardware.  Signed-off-by: Matthew Garrett <mjg@redhat.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpci_hotplug_pci.c | s | 7.6K | 314 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | pciehp_ctrl.c | s | 14K | 547 | Kenji Kaneshige | kaneshige.kenji@jp.fujitsu.com | 1323109307 |  | PCI: pciehp: Handle push button event asynchronously  Use non-ordered workqueue for attention button events.  Attention button events on each slot can be handled asynchronously. So we should use non-ordered workqueue. This patch also removes ordered workqueue in pciehp as a result.  Signed-off-by: Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | pciehp_pci.c | s | 4.1K | 143 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | shpchp_ctrl.c | s | 18K | 625 | Tejun Heo | tj@kernel.org | 1287383582 |  | shpchp: update workqueue usage  * Rename shpchp_wq to shpchp_ordered_wq and add non-ordered shpchp_wq   which is used instead of the system workqueue.  This is to remove   the use of flush_scheduled_work() which is deprecated and scheduled   for removal.  * With cmwq in place, there's no point in creating workqueues lazily.   Create both shpchp_wq and shpchp_ordered_wq upfront.  * Include workqueue.h from shpchp.h.  Signed-off-by: Tejun Heo <tj@kernel.org> Acked-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | ibmphp_res.c | s | 58K | 1967 | H. Peter Anvin | hpa@zytor.com | 1265852709 |  | ibmphp: Rename add_range() to add_bus_range() to avoid conflict  Rename add_range() to add_bus_range() to avoid conflict with the naming of the generic range manipulation functions.  LKML-Reference: <1265793639-15071-4-git-send-email-yinghai@kernel.org> Cc: Yinghai Lu <yinghai@kernel.org> Cc: Jesse Barnes <jbarnes@virtuousgeek.org> Cc: Greg Kroah-Hartman <gregkh@suse.de> Signed-off-by: H. Peter Anvin <hpa@zytor.com>
f | rpadlpar_core.c | s | 10K | 394 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | pcihp_slot.c | s | 5.6K | 166 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103882 |  | pci: Fix files needing export.h for EXPORT_SYMBOL/THIS_MODULE  They were implicitly getting it from device.h --> module.h but we want to clean that up.  So add the minimal header for these macros.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | sgi_hotplug.c | s | 18K | 606 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpqphp_nvram.h | s | 1.5K | 47 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | ibmphp_core.c | s | 34K | 1197 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | pciehp_hpc.c | s | 25K | 882 | Yinghai Lu | yinghai@kernel.org | 1329237902 |  | PCI: pciehp: Disable/enable link during slot power off/on  On a system with a repeater on the system board to support gen2 hotplug, we found that when an ExpressModule is removed from some slots, /var/log/messages will be full of "card present/not present" warnings.  It turns out the root complex is continually trying to train the link to the repeater because the repeater has not been reset.  This patch will disable the link at removal time to allow the repeater to be reset properly.  This also prevents a potential AER message at removal time.  Also, when testing hotplug on a system under development, we found if we boot the system without an EM installed, and later hot-add an EM, it does not work with Linux, but another OS is ok.  The root cause is that BIOS left link disabled when slot was empty at boot time, and other OS is modifying the link disable bit in link ctrl during power on/off.  So we should do the same thing to disable/enable link during power off/on.  -v2: check link DLLA bit instead of 100ms waiting.      Separate link disable/enable functions to another patch.  Signed-off-by: Yinghai Lu <yinghai.lu@oracle.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpqphp_pci.c | s | 38K | 1274 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | rpadlpar_sysfs.c | s | 2.8K | 104 | Alex Chiang | achiang@hp.com | 1213133823 |  | PCI: introduce pci_slot  Currently, /sys/bus/pci/slots/ only exposes hotplug attributes when a hotplug driver is loaded, but PCI slots have attributes such as address, speed, width, etc.  that are not related to hotplug at all.  Introduce pci_slot as the primary data structure and kobject model. Hotplug attributes described in hotplug_slot become a secondary structure associated with the pci_slot.  This patch only creates the infrastructure that allows the separation of PCI slot attributes and hotplug attributes.  In this patch, the PCI hotplug core remains the only user of this infrastructure, and thus, /sys/bus/pci/slots/ will still only become populated when a hotplug driver is loaded.  A later patch in this series will add a second user of this new infrastructure and demonstrate splitting the task of exposing pci_slot attributes from hotplug_slot attributes.    - Make pci_slot the primary sysfs entity. hotplug_slot becomes a     subsidiary structure.     o pci_create_slot() creates and registers a slot with the PCI core     o pci_slot_add_hotplug() gives it hotplug capability    - Change the prototype of pci_hp_register() to take the bus and     slot number (on parent bus) as parameters.    - Remove all the ->get_address methods since this functionality is     now handled by pci_slot directly.  [achiang@hp.com: rpaphp-correctly-pci_hp_register-for-empty-pci-slots] Tested-by: Badari Pulavarty <pbadari@us.ibm.com> Acked-by: Benjamin Herrenschmidt <benh@kernel.crashing.org> [akpm@linux-foundation.org: build fix] [akpm@linux-foundation.org: make headers_check happy] [akpm@linux-foundation.org: nuther build fix] [akpm@linux-foundation.org: fix typo in #include] Signed-off-by: Alex Chiang <achiang@hp.com> Signed-off-by: Matthew Wilcox <matthew@wil.cx> Cc: Greg KH <greg@kroah.com> Cc: Kristen Carlson Accardi <kristen.c.accardi@intel.com> Cc: Len Brown <lenb@kernel.org> Acked-by: Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | acpiphp_core.c | s | 10K | 322 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | acpiphp.h | s | 6.0K | 176 | Alexey Dobriyan | adobriyan@gmail.com | 1294678304 |  | headers: kobject.h redux  Remove kobject.h from files which don't need it, notably, sched.h and fs.h.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pcihp_skeleton.c | s | 8.7K | 296 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | rpadlpar.h | s | 683B | 21 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | ibmphp_ebda.c | s | 34K | 1031 | Julia Lawall | Julia.Lawall@lip6.fr | 1329237887 |  | PCI: drivers/pci/hotplug/ibmphp_ebda.c: add missing iounmap  Add missing iounmap in error handling code, in a case where the function already preforms iounmap on some other execution path.  A simplified version of the semantic match that finds this problem is as follows: (http://coccinelle.lip6.fr/)  // <smpl> @@ expression e; statement S,S1; int ret; @@ e = \(ioremap\||ioremap_nocache\)(...) ... when != iounmap(e) if (<+...e...+>) S ... when any     when != iounmap(e) *if (...)    { ... when != iounmap(e)      return ...; } ... when any iounmap(e); // </smpl>  Signed-off-by: Julia Lawall <Julia.Lawall@lip6.fr> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpqphp_nvram.c | s | 13K | 510 | Alex Chiang | achiang@hp.com | 1244747048 |  | PCI Hotplug: cpqphp: fix comment style  Fix up comments from C++ to C-style, wrapping if necessary, etc.  Signed-off-by: Alex Chiang <achiang@hp.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpqphp_ctrl.c | s | 76K | 2425 | Matthew Wilcox | matthew@wil.cx | 1266884117 |  | PCI: Make current and maximum bus speeds part of the PCI core  Move the max_bus_speed and cur_bus_speed into the pci_bus.  Expose the values through the PCI slot driver instead of the hotplug slot driver. Update all the hotplug drivers to use the pci_bus instead of their own data structures.  Signed-off-by: Matthew Wilcox <willy@linux.intel.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | ibmphp.h | s | 23K | 639 | Alex Chiang | achiang@hp.com | 1224718961 |  | PCI: ibmphp: stop managing hotplug_slot->name  We no longer need to manage our version of hotplug_slot->name since the PCI and hotplug core manage it on our behalf.  Now, we simply advise the PCI core of the name that we would like, and let the core take care of the rest.  Additionally, slightly rearrange the members of struct slot so they are naturally aligned to eliminate holes.  Cc: jbarnes@virtuousgeek.org Cc: kristen.c.accardi@intel.com Acked-by: Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com> Signed-off-by: Alex Chiang <achiang@hp.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpcihp_generic.c | s | 6.4K | 205 | Danny Kukawka | danny.kukawka@bisect.de | 1329237903 |  | PCI hotplug: cpcihp: fix debug module parameter to be bool  Fix debug variable from module parameter to be really bool to fix 'warning: return from incompatible pointer type'.  Acked-by: Scott Murray <scott@spiteful.org> Signed-off-by: Danny Kukawka <danny.kukawka@bisect.de> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | ibmphp_hpc.c | s | 32K | 1006 | Thomas Gleixner | tglx@linutronix.de | 1287173388 |  | PCI hotplug: ibmphp-hpc: semaphore cleanup  Get rid of init_MUTEX[_LOCKED]() and use sema_init() instead.  Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpcihp_zt5550.c | s | 8.4K | 278 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | cpci_hotplug.h | s | 3.1K | 92 | Alex Chiang | achiang@hp.com | 1224718959 |  | PCI: cpci_hotplug: stop managing hotplug_slot->name  We no longer need to manage our version of hotplug_slot->name since the PCI and hotplug core manage it on our behalf.  Now, we simply advise the PCI core of the name that we would like, and let the core take care of the rest.  Cc: kristen.c.accardi@intel.com Cc: scottm@somanetworks.com Acked-by: Kenji Kaneshige <kaneshige.kenji@jp.fujitsu.com> Signed-off-by: Alex Chiang <achiang@hp.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpqphp_core.c | s | 35K | 1214 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | cpqphp_sysfs.c | s | 5.7K | 214 | Arnd Bergmann | arnd@arndb.de | 1286283664 |  | drivers: autoconvert trivial BKL users to private mutex  All these files use the big kernel lock in a trivial way to serialize their private file operations, typically resulting from an earlier semi-automatic pushdown from VFS.  None of these drivers appears to want to lock against other code, and they all use the BKL as the top-level lock in their file operations, meaning that there is no lock-order inversion problem.  Consequently, we can remove the BKL completely, replacing it with a per-file mutex in every case. Using a scripted approach means we can avoid typos.  These drivers do not seem to be under active maintainance from my brief investigation. Apologies to those maintainers that I have missed.  file=$1 name=$2 if grep -q lock_kernel ${file} ; then     if grep -q 'include.*linux.mutex.h' ${file} ; then             sed -i '/include.*<linux\/smp_lock.h>/d' ${file}     else             sed -i 's/include.*<linux\/smp_lock.h>.*$/include <linux\/mutex.h>/g' ${file}     fi     sed -i ${file} \         -e "/^#include.*linux.mutex.h/,$ {                 1,/^\(static\||int\||long\)/ {                      /^\(static\||int\||long\)/istatic DEFINE_MUTEX(${name}_mutex);  } }"  \     -e "s/\(un\)*lock_kernel\>[ ]*()/mutex_\1lock(\&${name}_mutex)/g" \     -e '/[      ]*cycle_kernel_lock();/d' else     sed -i -e '/include.*\<smp_lock.h\>/d' ${file}  \                 -e '/cycle_kernel_lock()/d' fi  Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | shpchp.h | s | 11K | 307 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | cpcihp_zt5550.h | s | 2.7K | 72 | Linus Torvalds | torvalds@ppc970.osdl.org | 1113690036 |  | Linux-2.6.12-rc2  Initial git repository build. I'm not bothering with the full history, even though we have it. We can create a separate "historical" git archive of that later if we want to, and in the meantime it's about 3.2GB when imported into git - space that would just make the early git days unnecessarily complicated, when we don't have a lot of good infrastructure for it.  Let it rip!
f | shpchp_core.c | s | 10K | 324 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | shpchp_pci.c | s | 3.6K | 122 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | shpchp_sysfs.c | s | 3.1K | 87 | Joe Perches | joe@perches.com | 1307710536 |  | treewide: Convert uses of struct resource to resource_size(ptr)  Several fixes as well where the +1 was missing.  Done via coccinelle scripts like:  @@ struct resource *ptr; @@  - ptr->end - ptr->start + 1 + resource_size(ptr)  and some grep and typing.  Mostly uncompiled, no cross-compilers.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | cpci_hotplug_core.c | s | 16K | 634 | Arun Sharma | asharma@fb.com | 1311724187 |  | atomic: use <linux/atomic.h>  This allows us to move duplicated code in <asm/atomic.h> (atomic_inc_not_zero() for now) to <linux/atomic.h>  Signed-off-by: Arun Sharma <asharma@fb.com> Reviewed-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: David Miller <davem@davemloft.net> Cc: Eric Dumazet <eric.dumazet@gmail.com> Acked-by: Mike Frysinger <vapier@gentoo.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pciehp_core.c | s | 9.5K | 304 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | acpiphp_ibm.c | s | 14K | 441 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | Kconfig | g | 4.8K |  | Alex Chiang | achiang@hp.com | 1245358644 |  | PCI: drivers/pci/slot.c should depend on CONFIG_SYSFS  There is no way to interact with a physical PCI slot without sysfs, so encode the dependency and prevent this build error:  	drivers/pci/slot.c: In function 'pci_hp_create_module_link': 	drivers/pci/slot.c:327: error: 'module_kset' undeclared  This patch _should_ make pci-sysfs.o depend on CONFIG_SYSFS too, but we cannot (yet) because the PCI core merrily assumes the existence of sysfs:  	drivers/built-in.o: In function `pci_bus_add_device': 	drivers/pci/bus.c:89: undefined reference to `pci_create_sysfs_dev_files' 	drivers/built-in.o: In function `pci_stop_dev': 	drivers/pci/remove.c:24: undefined reference to `pci_remove_sysfs_dev_files'  So do the minimal bit for now and figure out how to untangle it later.  Reported-by: Randy Dunlap <randy.dunlap@oracle.com> Acked-by: Randy Dunlap <randy.dunlap@oracle.com> Reported-by: Stephen Rothwell <sfr@canb.auug.org.au> Fix-suggested-by: Matthew Wilcox <matthew@wil.cx> Signed-off-by: Alex Chiang <achiang@hp.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | ibmphp_pci.c | s | 56K | 1540 | Harvey Harrison | harvey.harrison@gmail.com | 1208753229 |  | PCI: replace remaining __FUNCTION__ occurrences  __FUNCTION__ is gcc-specific, use __func__  Signed-off-by: Harvey Harrison <harvey.harrison@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | pciehp_acpi.c | s | 4.1K | 128 | Paul Gortmaker | paul.gortmaker@windriver.com | 1320103883 |  | pci: add module.h to files implicitly relying on its presence.  These were getting module.h implicitly from device.h but we want to clean that up, so we fix it here to avoid things like:  pci/slot.c: In function ‘pci_hp_create_module_link’: pci/slot.c:383: error: ‘module_kset’ undeclared (first use in this function)  Similarly, rpadlpar_core.c is modular, so add module.h to its includes.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
f | fakephp.c | s | 3.7K | 133 | Yinghai Lu | yinghai@kernel.org | 1330373538 |  | PCI: Rename pci_remove_bus_device to pci_stop_and_remove_bus_device  The old pci_remove_bus_device actually did stop and remove.  Make the name reflect that to reduce confusion.  This patch is done by sed scripts and changes back some incorrect __pci_remove_bus_device changes.  Suggested-by: Jesse Barnes <jbarnes@virtuousgeek.org> Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | rpaphp.h | s | 3.0K | 87 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | rpaphp_pci.c | s | 3.6K | 117 | Kristen Carlson Accardi | kristen.c.accardi@intel.com | 1224525267 |  | PCI hotplug: rpaphp: make debug var unique  Change debug variable name to one more unique to this driver.  Signed-off-by: Kristen Carlson Accardi <kristen.c.accardi@intel.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | acpiphp_glue.c | s | 37K | 1316 | Yinghai Lu | yinghai@kernel.org | 1330373836 |  | PCI: make acpihp use __pci_remove_bus_device instead  pci_stop_bus_device gets called before in the same loop.  Signed-off-by: Yinghai Lu <yinghai@kernel.org> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | acpi_pcihp.c | s | 13K | 433 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | rpaphp_core.c | s | 10K | 375 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | shpchp_hpc.c | s | 28K | 959 | Bjorn Helgaas | bhelgaas@google.com | 1321292594 |  | PCI hotplug: shpchp: don't blindly claim non-AMD 0x7450 device IDs  Previously we claimed device ID 0x7450, regardless of the vendor, which is clearly wrong.  Now we'll claim that device ID only for AMD.  I suspect this was just a typo in the original code, but it's possible this change will break shpchp on non-7450 AMD bridges.  If so, we'll have to fix them as we find them.  Reference: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=638863 Reported-by: Ralf Jung <ralfjung-e@gmx.de> Cc: Joerg Roedel <joerg.roedel@amd.com> Signed-off-by: Bjorn Helgaas <bhelgaas@google.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | cpqphp.h | s | 21K | 632 | Matthew Wilcox | matthew@wil.cx | 1266884117 |  | PCI: Make current and maximum bus speeds part of the PCI core  Move the max_bus_speed and cur_bus_speed into the pci_bus.  Expose the values through the PCI slot driver instead of the hotplug slot driver. Update all the hotplug drivers to use the pci_bus instead of their own data structures.  Signed-off-by: Matthew Wilcox <willy@linux.intel.com> Signed-off-by: Jesse Barnes <jbarnes@virtuousgeek.org>
f | rpaphp_slot.c | s | 3.9K | 128 | Alexey Dobriyan | adobriyan@gmail.com | 1294678304 |  | headers: kobject.h redux  Remove kobject.h from files which don't need it, notably, sched.h and fs.h.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
