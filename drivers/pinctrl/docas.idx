f | Makefile | g | 1.2K |  | Linus Torvalds | torvalds@linux-foundation.org | 1337704782 |  | 
f | pinmux.h | s | 2.8K | 91 | Stephen Warren | swarren@nvidia.com | 1334749992 |  | pinctrl: ifdef CONFIG_DEBUG_FS cleanup  Only provide prototypes for pin{mux,conf}.c debugfs-related functions when both CONFIG_PIN* /and/ CONFIG_DEBUG_FS are enabled, otherwise provide static inlines.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-tegra20.c | s | 77K | 2647 | Stephen Warren | swarren@nvidia.com | 1334766400 |  | pinctrl: tegra: refactor probe handling  Rather than having a single tegra-pinctrl driver that determines whether it's running on Tegra20 or Tegra30, instead have separate drivers for each that call into utility functions to implement the majority of the driver. This change is based on review feedback of the SPEAr pinctrl driver, which had originally copied to Tegra driver structure.  This requires that the two drivers have unique names. Update a couple spots in arch/arm/mach-tegra for the name change.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-imx28.c | s | 11K | 410 | Shawn Guo | shawn.guo@linaro.org | 1335914307 |  | pinctrl: add pinctrl-mxs support  Add pinctrl support for Freescale MXS SoCs, i.MX23 and i.MX28. The driver supports device tree probe only.  Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-pxa3xx.c | s | 6.1K | 206 | Dong Aisheng | dong.aisheng@linaro.org | 1337068790 |  | pinctrl: pinctrl-pxa3xx: remove empty pinmux disable function  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinconf.h | s | 2.8K | 92 | Viresh Kumar | viresh.kumar@st.com | 1334749992 |  | pinctrl: pinconf: fix compilation error if PINCONF is not selected  When we compile pinctrl layer for platforms without CONFIG_PINCONF, we get following compilation errors:  drivers/built-in.o: In function `pinctrl_show': linux-2.6/drivers/pinctrl/core.c:1116: undefined reference to `pinconf_show_setting' drivers/built-in.o: In function `pinctrl_maps_show': linux-2.6/drivers/pinctrl/core.c:1071: undefined reference to `pinconf_show_map' drivers/built-in.o: In function `pinctrl_init_device_debugfs': linux-2.6/drivers/pinctrl/core.c:1224: undefined reference to `pinconf_init_device_debugfs' make[1]: *** [.tmp_vmlinux1] Error 1  This patch fixes this.  Signed-off-by: Viresh Kumar <viresh.kumar@st.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinmux.c | s | 16K | 563 | Dong Aisheng | dong.aisheng@linaro.org | 1337067890 |  | pinctrl: make pinmux disable function optional  Some SoCs may not have pinmux disable function in HW.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-imx53.c | s | 128K | 1638 | Dong Aisheng | dong.aisheng@linaro.org | 1337540418 |  | pinctrl: pinctrl-imx: add imx53 pinctrl driver  ChangeLog v1->v2: * change PIN_FUNC_ID base in binding doc to 0 from 1.  Acked-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-mxs.c | s | 12K | 447 | Fabio Estevam | fabio.estevam@freescale.com | 1339955084 |  | pinctrl: mxs: Use kfree to fix build error  commit 0bf7481 (pinctrl: pinctrl-mxs: Take care of frees if the kzalloc fails) introduced the following build error:  drivers/pinctrl/pinctrl-mxs.c:140:3: error: implicit declaration of function 'free'  Use kfree function instead.  Signed-off-by: Fabio Estevam <fabio.estevam@freescale.com> Acked-by: Devendra Naga <devendra.aaru@gmail.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-tegra.h | s | 5.2K | 140 | Stephen Warren | swarren@nvidia.com | 1334766400 |  | pinctrl: tegra: refactor probe handling  Rather than having a single tegra-pinctrl driver that determines whether it's running on Tegra20 or Tegra30, instead have separate drivers for each that call into utility functions to implement the majority of the driver. This change is based on review feedback of the SPEAr pinctrl driver, which had originally copied to Tegra driver structure.  This requires that the two drivers have unique names. Update a couple spots in arch/arm/mach-tegra for the name change.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-pxa168.c | s | 32K | 630 | Haojian Zhuang | haojian.zhuang@marvell.com | 1328121755 |  | pinctrl: enable pinmux for mmp series  Support PXA168/PXA910/MMP2 pinmux. Now only support function switch.  Signed-off-by: Haojian Zhuang <haojian.zhuang@marvell.com> [Rebase and fix some whitespace issues] Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-pxa3xx.h | s | 3.8K | 250 | Haojian Zhuang | haojian.zhuang@marvell.com | 1328121755 |  | pinctrl: enable pinmux for mmp series  Support PXA168/PXA910/MMP2 pinmux. Now only support function switch.  Signed-off-by: Haojian Zhuang <haojian.zhuang@marvell.com> [Rebase and fix some whitespace issues] Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinconf.c | s | 14K | 497 | Dong Aisheng | dong.aisheng@linaro.org | 1337067798 |  | pinctrl: a minor error checking improvement for pinconf  Also checking invalid num_configs when validate the pinconf map.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-coh901.c | s | 25K | 872 | Uwe Kleine-König | u.kleine-koenig@pengutronix.de | 1334749990 |  | pinctrl: mark const init data with __initconst instead of __initdata  As long as there is no other non-const variable marked __initdata in the same compilation unit it doesn't hurt. If there were one however compilation would fail with  	error: $variablename causes a section type conflict  because a section containing const variables is marked read only and so cannot contain non-const variables.  Signed-off-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Cc: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-imx51.c | s | 88K | 1311 | Dong Aisheng | dong.aisheng@linaro.org | 1337540441 |  | pinctrl: pinctrl-imx: add imx51 pinctrl driver  ChangeLog v1->v2: * change PIN_FUNC_ID base in binding doc to 0 from 1.  Acked-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-imx6q.c | s | 182K | 2320 | Dong Aisheng | dong.aisheng@linaro.org | 1335914080 |  | pinctrl: pinctrl-imx: add imx6q pinctrl driver  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Acked-by: Shawn Guo <shawn.guo@linaro.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-nomadik-db8500.c | s | 36K | 839 | Linus Walleij | linus.walleij@linaro.org | 1336727656 |  | pinctrl/nomadik: implement pin multiplexing  Implements basic pinmux for the Nomadik pin controller.  The plan is to split the existing singular pin config interface nmk_config_pin(), nmk_config_pins(), that will configure muxing and other settings at the same time, into two interfaces by splitting the code in pinmux and pinctrl and eventually deleting the old interface and its helper functions when all users are gone.  nmk_gpio_set_mode() and nmk_gpio_get_mode() are two older interfaces for just configuring muxing/altfunctions that will also be replaced in the end.  We take some extra care to handle the glitch-avoidance here, but it is simpler now since there is only one altsetting per pingroup so we know immediately if we need to avoid altfunc C glitches for a certain group.  As part of the makeover implement the .request() and .free() calls on the GPIO chips and have them call back into the pinctrl layer to reserve GPIOs.  ChangeLog v1->v2: - Rebased on pinctrl-mergebase-20120418 so we get the latest   driver infrastructure where function count is done by a fixed   value and we can drop a few range checks since this is now   handled by the core. - Include a GPIO muxing hunk erroneously part of the pin config   patch.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-nomadik.h | s | 2.2K | 66 | Linus Walleij | linus.walleij@linaro.org | 1336727656 |  | pinctrl/nomadik: implement pin multiplexing  Implements basic pinmux for the Nomadik pin controller.  The plan is to split the existing singular pin config interface nmk_config_pin(), nmk_config_pins(), that will configure muxing and other settings at the same time, into two interfaces by splitting the code in pinmux and pinctrl and eventually deleting the old interface and its helper functions when all users are gone.  nmk_gpio_set_mode() and nmk_gpio_get_mode() are two older interfaces for just configuring muxing/altfunctions that will also be replaced in the end.  We take some extra care to handle the glitch-avoidance here, but it is simpler now since there is only one altsetting per pingroup so we know immediately if we need to avoid altfunc C glitches for a certain group.  As part of the makeover implement the .request() and .free() calls on the GPIO chips and have them call back into the pinctrl layer to reserve GPIOs.  ChangeLog v1->v2: - Rebased on pinctrl-mergebase-20120418 so we get the latest   driver infrastructure where function count is done by a fixed   value and we can drop a few range checks since this is now   handled by the core. - Include a GPIO muxing hunk erroneously part of the pin config   patch.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-sirf.c | s | 31K | 1038 | Barry Song | Baohua.Song@csr.com | 1338796372 |  | pinctrl: sirf: mark of_device_id match table as __devinitconst  Signed-off-by: Barry Song <Baohua.Song@csr.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-mmp2.c | s | 38K | 701 | Haojian Zhuang | haojian.zhuang@marvell.com | 1328121755 |  | pinctrl: enable pinmux for mmp series  Support PXA168/PXA910/MMP2 pinmux. Now only support function switch.  Signed-off-by: Haojian Zhuang <haojian.zhuang@marvell.com> [Rebase and fix some whitespace issues] Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-tegra.c | s | 18K | 651 | Stephen Warren | swarren@nvidia.com | 1335388907 |  | pinctrl: tegra: error reporting cleanup  Print an explicit error message in various failure cases to allow easier diagnosis.  WARN_ON() some internal failures that users/clients shouldn't be able to trigger.  Signed-off-by: Stephen Warren <swarren@nvidia.com>
f | core.h | s | 5.2K | 153 | Dong Aisheng | dong.aisheng@linaro.org | 1334749993 |  | pinctrl: show pin name for pingroups in sysfs  Pin name is more useful to users.  After change, when cat pingroups in sysfs, it becomes: root@freescale /sys/kernel/debug/pinctrl/20e0000.iomuxc$ cat pingroups registered pin groups: group: uart4grp-1 pin 219 (MX6Q_PAD_KEY_ROW0) pin 218 (MX6Q_PAD_KEY_COL0)  group: usdhc4grp-1 pin 305 (MX6Q_PAD_SD4_CMD) pin 306 (MX6Q_PAD_SD4_CLK) pin 315 (MX6Q_PAD_SD4_DAT0) pin 316 (MX6Q_PAD_SD4_DAT1) pin 317 (MX6Q_PAD_SD4_DAT2) pin 318 (MX6Q_PAD_SD4_DAT3) pin 319 (MX6Q_PAD_SD4_DAT4) pin 320 (MX6Q_PAD_SD4_DAT5) pin 321 (MX6Q_PAD_SD4_DAT6) pin 322 (MX6Q_PAD_SD4_DAT7)  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-imx.h | s | 2.8K | 95 | Dong Aisheng | dong.aisheng@linaro.org | 1335914080 |  | pinctrl: pinctrl-imx: add imx pinctrl core driver  The driver has mux and config support while the gpio is still not supported. For select input setting, the driver will handle it internally and do not need user to take care of it.  The pinctrl-imx core driver will parse the dts file and dynamically create the pinmux functions and groups.  Each IMX SoC pinctrl driver should register pins with a pin register map including mux register and config register and select input map to core for proper operations.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Acked-by: Shawn Guo <shawn.guo@linaro.org> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-imx23.c | s | 7.8K | 294 | Shawn Guo | shawn.guo@linaro.org | 1335914307 |  | pinctrl: add pinctrl-mxs support  Add pinctrl support for Freescale MXS SoCs, i.MX23 and i.MX28. The driver supports device tree probe only.  Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
d | spear |  | 11 items |  | Viresh Kumar | viresh.linux@gmail.com | 1340228376 |  | Viresh has moved  viresh.kumar@st.com email-id doesn't exist anymore as I have left the company.  Replace ST's id with viresh.linux@gmail.com.  It also updates .mailmap file to fix address for 'git shortlog'  Signed-off-by: Viresh Kumar <viresh.linux@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | pinctrl-u300.c | s | 38K | 1141 | Viresh Kumar | viresh.kumar@st.com | 1334749990 |  | pinctrl: replace list_*() with get_*_count()  Most of the SoC drivers implement list_groups() and list_functions() routines for pinctrl and pinmux. These routines continue returning zero until the selector argument is greater than total count of available groups or functions.  This patch replaces these list_*() routines with get_*_count() routines, which returns the number of available selection for SoC driver. pinctrl layer will use this value to check the range it can choose.  This patch fixes all user drivers for this change. There are other routines in user drivers, which have checks to check validity of selector passed to them. It is also no more required and hence removed.  Documentation updated as well.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Viresh Kumar <viresh.kumar@st.com> [Folded in fix and fixed a minor merge artifact manually] Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-tegra30.c | s | 109K | 3368 | Stephen Warren | swarren@nvidia.com | 1334766400 |  | pinctrl: tegra: refactor probe handling  Rather than having a single tegra-pinctrl driver that determines whether it's running on Tegra20 or Tegra30, instead have separate drivers for each that call into utility functions to implement the majority of the driver. This change is based on review feedback of the SPEAr pinctrl driver, which had originally copied to Tegra driver structure.  This requires that the two drivers have unique names. Update a couple spots in arch/arm/mach-tegra for the name change.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org>
f | devicetree.h | s | 983B | 29 | Stephen Warren | swarren@wwwdotorg.org | 1334749990 |  | pinctrl: core device tree mapping table parsing support  During pinctrl_get(), if the client device has a device tree node, look for the common pinctrl properties there. If found, parse the referenced device tree nodes, with the help of the pinctrl drivers, and generate mapping table entries from them.  During pinctrl_put(), free any results of device tree parsing.  Acked-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-nomadik.c | s | 45K | 1495 | Linus Walleij | linus.walleij@linaro.org | 1339955084 |  | pinctrl/nomadik: document Alt-C glitch  This documentation comment existed in an earlier patch set for GPIO consolidation, so I'm saving it for maintainability of the code.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | devicetree.c | s | 6.5K | 215 | Linus Walleij | linus.walleij@linaro.org | 1334749991 |  | pinctrl: implement pinctrl deferred probing  If drivers try to obtain pinctrl handles for a pin controller that has not yet registered to the subsystem, we need to be able to back out and retry with deferred probing. So let's return -EPROBE_DEFER whenever this location fails. Also downgrade the errors to info, maybe we will even set them to debug once the deferred probing is commonplace.  Cc: Arnd Bergmann <arnd@arndb.de> Reviewed-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinconf-generic.c | s | 3.5K | 105 | Linus Walleij | linus.walleij@linaro.org | 1331588942 |  | pinctrl: introduce generic pin config  This is a split-off from the earlier patch set which adds generic pin configuration for the pin controllers that want it. Since we may have a system with mixed generic and custom pin controllers, we pass a boolean in the pin controller ops vtable to indicate if it is generic.  ChangeLog v1->v5: - Follow parent patch versioning number system. - Document the semantic meaning of return values from pin config   get functions, so we can iterate over pins and check their   properties from debugfs as part of the generic config code. - Use proper cast functions in the generic debugfs pin config   file. - Expand generic config to optionally cover groups too. ChangeLog v5->v6: - Update to match underlying changes. ChangeLog v6->v7: - Drop DRIVE_OFF parameter, use bias high impedance for this - Delete argument for drive modes push-pull, od and os. These   are now just state transitions. - Delete slew rate rising/falling due to discussions on on   proper semantics - Drop config wakeup, struct irq_chip does this for now, add   back if need be. - Set PIN_CONFIG_END to 0x7fff making room for custom config   parameters from 0x8000 and up. - Prefix accessor functions with pinconf_
f | pinctrl-coh901.h | s | 198B | 5 | Linus Walleij | linus.walleij@linaro.org | 1331588943 |  | pinctrl: support pinconfig on the U300  This adds pin configuration support for the U300 driver pair, we can now read out the biasing and drive mode in debugfs and configure it using the new configuration API.  ChangeLog v1->v2: - Migrate to pin config and generic pin config changes. ChangeLog v2->v3: - Adjust to generic pin config changes in v7 patch set.  Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | Kconfig | g | 2.5K |  | Linus Torvalds | torvalds@linux-foundation.org | 1337704782 |  | 
f | core.c | s | 36K | 1267 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1338796372 |  | pinctrl: fix a minor harmless typo  The way the for_each_maps() macro is currently used, using "i" instead of "_i_" works and is harmless. Still, this is a bug, that can trigger any time, if the code around that macro changes. Better fix it now.  Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-pxa910.c | s | 50K | 984 | Haojian Zhuang | haojian.zhuang@marvell.com | 1328121755 |  | pinctrl: enable pinmux for mmp series  Support PXA168/PXA910/MMP2 pinmux. Now only support function switch.  Signed-off-by: Haojian Zhuang <haojian.zhuang@marvell.com> [Rebase and fix some whitespace issues] Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-mxs.h | s | 2.0K | 78 | Shawn Guo | shawn.guo@linaro.org | 1335914307 |  | pinctrl: add pinctrl-mxs support  Add pinctrl support for Freescale MXS SoCs, i.MX23 and i.MX28. The driver supports device tree probe only.  Signed-off-by: Shawn Guo <shawn.guo@linaro.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
f | pinctrl-imx.c | s | 15K | 512 | Dong Aisheng | dong.aisheng@linaro.org | 1339500933 |  | pinctrl: pinctrl-imx: fix incorrect debug message of maps  After create config map, the new_map pointer becomes point to PIN_MAP_TYPE_CONFIGS_PIN map rather than PIN_MAP_TYPE_MUX_GROUP map any more. Thus using new_map pointer to display the MUX_GROUP info is not correct. Using map pointer instead to show the correct MUX_GROUP map info. Original the debug message is: imx6q-pinctrl 20e0000.iomuxc: maps: function Yp group MX6Q_PAD_SD3_CMD num 12 After fix it is: imx6q-pinctrl 20e0000.iomuxc: maps: function usdhc3 group usdhc3grp-1 num 11  Reported-by: Richard Zhao <richard.zhao@freescale.com> Signed-off-by: Dong Aisheng <dong.aisheng@linaro.org> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>
