<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › message › fusion › lsi › mpi_targ.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>mpi_targ.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> *  Copyright (c) 2000-2008 LSI Corporation.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> *           Name:  mpi_targ.h</span>
<span class="cm"> *          Title:  MPI Target mode messages and structures</span>
<span class="cm"> *  Creation Date:  June 22, 2000</span>
<span class="cm"> *</span>
<span class="cm"> *    mpi_targ.h Version:  01.05.06</span>
<span class="cm"> *</span>
<span class="cm"> *  Version History</span>
<span class="cm"> *  ---------------</span>
<span class="cm"> *</span>
<span class="cm"> *  Date      Version   Description</span>
<span class="cm"> *  --------  --------  ------------------------------------------------------</span>
<span class="cm"> *  05-08-00  00.10.01  Original release for 0.10 spec dated 4/26/2000.</span>
<span class="cm"> *  06-06-00  01.00.01  Update version number for 1.0 release.</span>
<span class="cm"> *  06-22-00  01.00.02  Added _MSG_TARGET_CMD_BUFFER_POST_REPLY structure.</span>
<span class="cm"> *                      Corrected DECSRIPTOR typo to DESCRIPTOR.</span>
<span class="cm"> *  11-02-00  01.01.01  Original release for post 1.0 work</span>
<span class="cm"> *                      Modified target mode to use IoIndex instead of</span>
<span class="cm"> *                      HostIndex and IocIndex. Added Alias.</span>
<span class="cm"> *  01-09-01  01.01.02  Added defines for TARGET_ASSIST_FLAGS_REPOST_CMD_BUFFER</span>
<span class="cm"> *                      and TARGET_STATUS_SEND_FLAGS_REPOST_CMD_BUFFER.</span>
<span class="cm"> *  02-20-01  01.01.03  Started using MPI_POINTER.</span>
<span class="cm"> *                      Added structures for MPI_TARGET_SCSI_SPI_CMD_BUFFER and</span>
<span class="cm"> *                      MPI_TARGET_FCP_CMD_BUFFER.</span>
<span class="cm"> *  03-27-01  01.01.04  Added structure offset comments.</span>
<span class="cm"> *  08-08-01  01.02.01  Original release for v1.2 work.</span>
<span class="cm"> *  09-28-01  01.02.02  Added structure for MPI_TARGET_SCSI_SPI_STATUS_IU.</span>
<span class="cm"> *                      Added PriorityReason field to some replies and</span>
<span class="cm"> *                      defined more PriorityReason codes.</span>
<span class="cm"> *                      Added some defines for to support previous version</span>
<span class="cm"> *                      of MPI.</span>
<span class="cm"> *  10-04-01  01.02.03  Added PriorityReason to MSG_TARGET_ERROR_REPLY.</span>
<span class="cm"> *  11-01-01  01.02.04  Added define for TARGET_STATUS_SEND_FLAGS_HIGH_PRIORITY.</span>
<span class="cm"> *  03-14-02  01.02.05  Modified MPI_TARGET_FCP_RSP_BUFFER to get the proper</span>
<span class="cm"> *                      byte ordering.</span>
<span class="cm"> *  05-31-02  01.02.06  Modified TARGET_MODE_REPLY_ALIAS_MASK to only include</span>
<span class="cm"> *                      one bit.</span>
<span class="cm"> *                      Added AliasIndex field to MPI_TARGET_FCP_CMD_BUFFER.</span>
<span class="cm"> *  09-16-02  01.02.07  Added flags for confirmed completion.</span>
<span class="cm"> *                      Added PRIORITY_REASON_TARGET_BUSY.</span>
<span class="cm"> *  11-15-02  01.02.08  Added AliasID field to MPI_TARGET_SCSI_SPI_CMD_BUFFER.</span>
<span class="cm"> *  04-01-03  01.02.09  Added OptionalOxid field to MPI_TARGET_FCP_CMD_BUFFER.</span>
<span class="cm"> *  05-11-04  01.03.01  Original release for MPI v1.3.</span>
<span class="cm"> *  08-19-04  01.05.01  Added new request message structures for</span>
<span class="cm"> *                      MSG_TARGET_CMD_BUF_POST_BASE_REQUEST,</span>
<span class="cm"> *                      MSG_TARGET_CMD_BUF_POST_LIST_REQUEST, and</span>
<span class="cm"> *                      MSG_TARGET_ASSIST_EXT_REQUEST.</span>
<span class="cm"> *                      Added new structures for SAS SSP Command buffer, SSP</span>
<span class="cm"> *                      Task buffer, and SSP Status IU.</span>
<span class="cm"> *  10-05-04  01.05.02  MSG_TARGET_CMD_BUFFER_POST_BASE_LIST_REPLY added.</span>
<span class="cm"> *  02-22-05  01.05.03  Changed a comment.</span>
<span class="cm"> *  03-11-05  01.05.04  Removed TargetAssistExtended Request.</span>
<span class="cm"> *  06-24-05  01.05.05  Added TargetAssistExtended structures and defines.</span>
<span class="cm"> *  03-27-06  01.05.06  Added a comment.</span>
<span class="cm"> *  --------------------------------------------------------------------------</span>
<span class="cm"> */</span>

<span class="cp">#ifndef MPI_TARG_H</span>
<span class="cp">#define MPI_TARG_H</span>


<span class="cm">/******************************************************************************</span>
<span class="cm">*</span>
<span class="cm">*        S C S I    T a r g e t    M e s s a g e s</span>
<span class="cm">*</span>
<span class="cm">*******************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_CMD_BUFFER_DESCRIPTOR</span>
<span class="p">{</span>
    <span class="n">U16</span>                     <span class="n">IoIndex</span><span class="p">;</span>                    <span class="cm">/* 00h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 02h */</span>
    <span class="k">union</span>                                               <span class="cm">/* 04h */</span>
    <span class="p">{</span>
        <span class="n">U32</span>                 <span class="n">PhysicalAddress32</span><span class="p">;</span>
        <span class="n">U64</span>                 <span class="n">PhysicalAddress64</span><span class="p">;</span>
    <span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">}</span> <span class="n">CMD_BUFFER_DESCRIPTOR</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_CMD_BUFFER_DESCRIPTOR</span><span class="p">,</span>
  <span class="n">CmdBufferDescriptor_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pCmdBufferDescriptor_t</span><span class="p">;</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Command Buffer Post Request                                       */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_CMD_BUFFER_POST_REQUEST</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">BufferPostFlags</span><span class="p">;</span>            <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">BufferCount</span><span class="p">;</span>                <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">ChainOffset</span><span class="p">;</span>                <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U8</span>                      <span class="n">BufferLength</span><span class="p">;</span>               <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 05h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">CMD_BUFFER_DESCRIPTOR</span>   <span class="n">Buffer</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>                  <span class="cm">/* 0Ch */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_CMD_BUFFER_POST_REQUEST</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_CMD_BUFFER_POST_REQUEST</span><span class="p">,</span>
  <span class="n">TargetCmdBufferPostRequest_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetCmdBufferPostRequest_t</span><span class="p">;</span>

<span class="cp">#define CMD_BUFFER_POST_FLAGS_PORT_MASK         (0x01)</span>
<span class="cp">#define CMD_BUFFER_POST_FLAGS_ADDR_MODE_MASK    (0x80)</span>
<span class="cp">#define CMD_BUFFER_POST_FLAGS_ADDR_MODE_32      (0)</span>
<span class="cp">#define CMD_BUFFER_POST_FLAGS_ADDR_MODE_64      (1)</span>
<span class="cp">#define CMD_BUFFER_POST_FLAGS_64_BIT_ADDR       (0x80)</span>

<span class="cp">#define CMD_BUFFER_POST_IO_INDEX_MASK           (0x00003FFF)</span>
<span class="cp">#define CMD_BUFFER_POST_IO_INDEX_MASK_0100      (0x000003FF) </span><span class="cm">/* obsolete */</span><span class="cp"></span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_CMD_BUFFER_POST_REPLY</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">BufferPostFlags</span><span class="p">;</span>            <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">BufferCount</span><span class="p">;</span>                <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">MsgLength</span><span class="p">;</span>                  <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U8</span>                      <span class="n">BufferLength</span><span class="p">;</span>               <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 05h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U16</span>                     <span class="n">IOCStatus</span><span class="p">;</span>                  <span class="cm">/* 0Eh */</span>
    <span class="n">U32</span>                     <span class="n">IOCLogInfo</span><span class="p">;</span>                 <span class="cm">/* 10h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_CMD_BUFFER_POST_REPLY</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_CMD_BUFFER_POST_REPLY</span><span class="p">,</span>
  <span class="n">TargetCmdBufferPostReply_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetCmdBufferPostReply_t</span><span class="p">;</span>

<span class="cm">/* the following structure is obsolete as of MPI v1.2 */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_PRIORITY_CMD_RECEIVED_REPLY</span>
<span class="p">{</span>
    <span class="n">U16</span>                     <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">MsgLength</span><span class="p">;</span>                  <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U8</span>                      <span class="n">PriorityReason</span><span class="p">;</span>             <span class="cm">/* 0Ch */</span>
    <span class="n">U8</span>                      <span class="n">Reserved3</span><span class="p">;</span>                  <span class="cm">/* 0Dh */</span>
    <span class="n">U16</span>                     <span class="n">IOCStatus</span><span class="p">;</span>                  <span class="cm">/* 0Eh */</span>
    <span class="n">U32</span>                     <span class="n">IOCLogInfo</span><span class="p">;</span>                 <span class="cm">/* 10h */</span>
    <span class="n">U32</span>                     <span class="n">ReplyWord</span><span class="p">;</span>                  <span class="cm">/* 14h */</span>
<span class="p">}</span> <span class="n">MSG_PRIORITY_CMD_RECEIVED_REPLY</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_PRIORITY_CMD_RECEIVED_REPLY</span><span class="p">,</span>
  <span class="n">PriorityCommandReceivedReply_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pPriorityCommandReceivedReply_t</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_CMD_BUFFER_POST_ERROR_REPLY</span>
<span class="p">{</span>
    <span class="n">U16</span>                     <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">MsgLength</span><span class="p">;</span>                  <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U8</span>                      <span class="n">PriorityReason</span><span class="p">;</span>             <span class="cm">/* 0Ch */</span>
    <span class="n">U8</span>                      <span class="n">Reserved3</span><span class="p">;</span>                  <span class="cm">/* 0Dh */</span>
    <span class="n">U16</span>                     <span class="n">IOCStatus</span><span class="p">;</span>                  <span class="cm">/* 0Eh */</span>
    <span class="n">U32</span>                     <span class="n">IOCLogInfo</span><span class="p">;</span>                 <span class="cm">/* 10h */</span>
    <span class="n">U32</span>                     <span class="n">ReplyWord</span><span class="p">;</span>                  <span class="cm">/* 14h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_CMD_BUFFER_POST_ERROR_REPLY</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_CMD_BUFFER_POST_ERROR_REPLY</span><span class="p">,</span>
  <span class="n">TargetCmdBufferPostErrorReply_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetCmdBufferPostErrorReply_t</span><span class="p">;</span>

<span class="cp">#define PRIORITY_REASON_NO_DISCONNECT           (0x00)</span>
<span class="cp">#define PRIORITY_REASON_SCSI_TASK_MANAGEMENT    (0x01)</span>
<span class="cp">#define PRIORITY_REASON_CMD_PARITY_ERR          (0x02)</span>
<span class="cp">#define PRIORITY_REASON_MSG_OUT_PARITY_ERR      (0x03)</span>
<span class="cp">#define PRIORITY_REASON_LQ_CRC_ERR              (0x04)</span>
<span class="cp">#define PRIORITY_REASON_CMD_CRC_ERR             (0x05)</span>
<span class="cp">#define PRIORITY_REASON_PROTOCOL_ERR            (0x06)</span>
<span class="cp">#define PRIORITY_REASON_DATA_OUT_PARITY_ERR     (0x07)</span>
<span class="cp">#define PRIORITY_REASON_DATA_OUT_CRC_ERR        (0x08)</span>
<span class="cp">#define PRIORITY_REASON_TARGET_BUSY             (0x09)</span>
<span class="cp">#define PRIORITY_REASON_UNKNOWN                 (0xFF)</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Command Buffer Post Base Request                                  */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_CMD_BUF_POST_BASE_REQUEST</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">BufferPostFlags</span><span class="p">;</span>            <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">PortNumber</span><span class="p">;</span>                 <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">ChainOffset</span><span class="p">;</span>                <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">TotalCmdBuffers</span><span class="p">;</span>            <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U32</span>                     <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U16</span>                     <span class="n">CmdBufferLength</span><span class="p">;</span>            <span class="cm">/* 10h */</span>
    <span class="n">U16</span>                     <span class="n">NextCmdBufferOffset</span><span class="p">;</span>        <span class="cm">/* 12h */</span>
    <span class="n">U32</span>                     <span class="n">BaseAddressLow</span><span class="p">;</span>             <span class="cm">/* 14h */</span>
    <span class="n">U32</span>                     <span class="n">BaseAddressHigh</span><span class="p">;</span>            <span class="cm">/* 18h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_CMD_BUF_POST_BASE_REQUEST</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">PTR__MSG_TARGET_CMD_BUF_POST_BASE_REQUEST</span><span class="p">,</span>
  <span class="n">TargetCmdBufferPostBaseRequest_t</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">pTargetCmdBufferPostBaseRequest_t</span><span class="p">;</span>

<span class="cp">#define CMD_BUFFER_POST_BASE_FLAGS_AUTO_POST_ALL    (0x01)</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_CMD_BUFFER_POST_BASE_LIST_REPLY</span>
<span class="p">{</span>
    <span class="n">U16</span>                     <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">MsgLength</span><span class="p">;</span>                  <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved3</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U16</span>                     <span class="n">IOCStatus</span><span class="p">;</span>                  <span class="cm">/* 0Eh */</span>
    <span class="n">U32</span>                     <span class="n">IOCLogInfo</span><span class="p">;</span>                 <span class="cm">/* 10h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_CMD_BUFFER_POST_BASE_LIST_REPLY</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_CMD_BUFFER_POST_BASE_LIST_REPLY</span><span class="p">,</span>
  <span class="n">TargetCmdBufferPostBaseListReply_t</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">pTargetCmdBufferPostBaseListReply_t</span><span class="p">;</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Command Buffer Post List Request                                  */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_CMD_BUF_POST_LIST_REQUEST</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">PortNumber</span><span class="p">;</span>                 <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">ChainOffset</span><span class="p">;</span>                <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">CmdBufferCount</span><span class="p">;</span>             <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U32</span>                     <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U16</span>                     <span class="n">IoIndex</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>                 <span class="cm">/* 10h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_CMD_BUF_POST_LIST_REQUEST</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_CMD_BUF_POST_LIST_REQUEST</span><span class="p">,</span>
  <span class="n">TargetCmdBufferPostListRequest_t</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">pTargetCmdBufferPostListRequest_t</span><span class="p">;</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Command Buffer Formats (with 16 byte CDB)                                */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MPI_TARGET_FCP_CMD_BUFFER</span>
<span class="p">{</span>
    <span class="n">U8</span>      <span class="n">FcpLun</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                                  <span class="cm">/* 00h */</span>
    <span class="n">U8</span>      <span class="n">FcpCntl</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>                                 <span class="cm">/* 08h */</span>
    <span class="n">U8</span>      <span class="n">FcpCdb</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>                                 <span class="cm">/* 0Ch */</span>
    <span class="n">U32</span>     <span class="n">FcpDl</span><span class="p">;</span>                                      <span class="cm">/* 1Ch */</span>
    <span class="n">U8</span>      <span class="n">AliasIndex</span><span class="p">;</span>                                 <span class="cm">/* 20h */</span>
    <span class="n">U8</span>      <span class="n">Reserved1</span><span class="p">;</span>                                  <span class="cm">/* 21h */</span>
    <span class="n">U16</span>     <span class="n">OptionalOxid</span><span class="p">;</span>                               <span class="cm">/* 22h */</span>
<span class="p">}</span> <span class="n">MPI_TARGET_FCP_CMD_BUFFER</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MPI_TARGET_FCP_CMD_BUFFER</span><span class="p">,</span>
  <span class="n">MpiTargetFcpCmdBuffer</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pMpiTargetFcpCmdBuffer</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MPI_TARGET_SCSI_SPI_CMD_BUFFER</span>
<span class="p">{</span>
    <span class="cm">/* SPI L_Q information unit */</span>
    <span class="n">U8</span>      <span class="n">L_QType</span><span class="p">;</span>                                    <span class="cm">/* 00h */</span>
    <span class="n">U8</span>      <span class="n">Reserved</span><span class="p">;</span>                                   <span class="cm">/* 01h */</span>
    <span class="n">U16</span>     <span class="n">Tag</span><span class="p">;</span>                                        <span class="cm">/* 02h */</span>
    <span class="n">U8</span>      <span class="n">LogicalUnitNumber</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                       <span class="cm">/* 04h */</span>
    <span class="n">U32</span>     <span class="n">DataLength</span><span class="p">;</span>                                 <span class="cm">/* 0Ch */</span>
    <span class="cm">/* SPI command information unit */</span>
    <span class="n">U8</span>      <span class="n">ReservedFirstByteOfCommandIU</span><span class="p">;</span>               <span class="cm">/* 10h */</span>
    <span class="n">U8</span>      <span class="n">TaskAttribute</span><span class="p">;</span>                              <span class="cm">/* 11h */</span>
    <span class="n">U8</span>      <span class="n">TaskManagementFlags</span><span class="p">;</span>                        <span class="cm">/* 12h */</span>
    <span class="n">U8</span>      <span class="n">AdditionalCDBLength</span><span class="p">;</span>                        <span class="cm">/* 13h */</span>
    <span class="n">U8</span>      <span class="n">CDB</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>                                    <span class="cm">/* 14h */</span>
    <span class="cm">/* Alias ID */</span>
    <span class="n">U8</span>      <span class="n">AliasID</span><span class="p">;</span>                                    <span class="cm">/* 24h */</span>
    <span class="n">U8</span>      <span class="n">Reserved1</span><span class="p">;</span>                                  <span class="cm">/* 25h */</span>
    <span class="n">U16</span>     <span class="n">Reserved2</span><span class="p">;</span>                                  <span class="cm">/* 26h */</span>
<span class="p">}</span> <span class="n">MPI_TARGET_SCSI_SPI_CMD_BUFFER</span><span class="p">,</span>
  <span class="n">MPI_POINTER</span> <span class="n">PTR_MPI_TARGET_SCSI_SPI_CMD_BUFFER</span><span class="p">,</span>
  <span class="n">MpiTargetScsiSpiCmdBuffer</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pMpiTargetScsiSpiCmdBuffer</span><span class="p">;</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MPI_TARGET_SSP_CMD_BUFFER</span>
<span class="p">{</span>
    <span class="n">U8</span>      <span class="n">FrameType</span><span class="p">;</span>                                  <span class="cm">/* 00h */</span>
    <span class="n">U8</span>      <span class="n">Reserved1</span><span class="p">;</span>                                  <span class="cm">/* 01h */</span>
    <span class="n">U16</span>     <span class="n">Reserved2</span><span class="p">;</span>                                  <span class="cm">/* 02h */</span>
    <span class="n">U16</span>     <span class="n">InitiatorTag</span><span class="p">;</span>                               <span class="cm">/* 04h */</span>
    <span class="n">U16</span>     <span class="n">DevHandle</span><span class="p">;</span>                                  <span class="cm">/* 06h */</span>
    <span class="cm">/* COMMAND information unit starts here */</span>
    <span class="n">U8</span>      <span class="n">LogicalUnitNumber</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                       <span class="cm">/* 08h */</span>
    <span class="n">U8</span>      <span class="n">Reserved3</span><span class="p">;</span>                                  <span class="cm">/* 10h */</span>
    <span class="n">U8</span>      <span class="n">TaskAttribute</span><span class="p">;</span> <span class="cm">/* lower 3 bits */</span>           <span class="cm">/* 11h */</span>
    <span class="n">U8</span>      <span class="n">Reserved4</span><span class="p">;</span>                                  <span class="cm">/* 12h */</span>
    <span class="n">U8</span>      <span class="n">AdditionalCDBLength</span><span class="p">;</span> <span class="cm">/* upper 5 bits */</span>     <span class="cm">/* 13h */</span>
    <span class="n">U8</span>      <span class="n">CDB</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>                                    <span class="cm">/* 14h */</span>
    <span class="cm">/* Additional CDB bytes extend past the CDB field */</span>
<span class="p">}</span> <span class="n">MPI_TARGET_SSP_CMD_BUFFER</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MPI_TARGET_SSP_CMD_BUFFER</span><span class="p">,</span>
  <span class="n">MpiTargetSspCmdBuffer</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pMpiTargetSspCmdBuffer</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MPI_TARGET_SSP_TASK_BUFFER</span>
<span class="p">{</span>
    <span class="n">U8</span>      <span class="n">FrameType</span><span class="p">;</span>                                  <span class="cm">/* 00h */</span>
    <span class="n">U8</span>      <span class="n">Reserved1</span><span class="p">;</span>                                  <span class="cm">/* 01h */</span>
    <span class="n">U16</span>     <span class="n">Reserved2</span><span class="p">;</span>                                  <span class="cm">/* 02h */</span>
    <span class="n">U16</span>     <span class="n">InitiatorTag</span><span class="p">;</span>                               <span class="cm">/* 04h */</span>
    <span class="n">U16</span>     <span class="n">DevHandle</span><span class="p">;</span>                                  <span class="cm">/* 06h */</span>
    <span class="cm">/* TASK information unit starts here */</span>
    <span class="n">U8</span>      <span class="n">LogicalUnitNumber</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                       <span class="cm">/* 08h */</span>
    <span class="n">U8</span>      <span class="n">Reserved3</span><span class="p">;</span>                                  <span class="cm">/* 10h */</span>
    <span class="n">U8</span>      <span class="n">Reserved4</span><span class="p">;</span>                                  <span class="cm">/* 11h */</span>
    <span class="n">U8</span>      <span class="n">TaskManagementFunction</span><span class="p">;</span>                     <span class="cm">/* 12h */</span>
    <span class="n">U8</span>      <span class="n">Reserved5</span><span class="p">;</span>                                  <span class="cm">/* 13h */</span>
    <span class="n">U16</span>     <span class="n">ManagedTaskTag</span><span class="p">;</span>                             <span class="cm">/* 14h */</span>
    <span class="n">U16</span>     <span class="n">Reserved6</span><span class="p">;</span>                                  <span class="cm">/* 16h */</span>
    <span class="n">U32</span>     <span class="n">Reserved7</span><span class="p">;</span>                                  <span class="cm">/* 18h */</span>
    <span class="n">U32</span>     <span class="n">Reserved8</span><span class="p">;</span>                                  <span class="cm">/* 1Ch */</span>
    <span class="n">U32</span>     <span class="n">Reserved9</span><span class="p">;</span>                                  <span class="cm">/* 20h */</span>
<span class="p">}</span> <span class="n">MPI_TARGET_SSP_TASK_BUFFER</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MPI_TARGET_SSP_TASK_BUFFER</span><span class="p">,</span>
  <span class="n">MpiTargetSspTaskBuffer</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pMpiTargetSspTaskBuffer</span><span class="p">;</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Assist Request                                                    */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_ASSIST_REQUEST</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">StatusCode</span><span class="p">;</span>                 <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">TargetAssistFlags</span><span class="p">;</span>          <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">ChainOffset</span><span class="p">;</span>                <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">QueueTag</span><span class="p">;</span>                   <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U32</span>                     <span class="n">ReplyWord</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U8</span>                      <span class="n">LUN</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                     <span class="cm">/* 10h */</span>
    <span class="n">U32</span>                     <span class="n">RelativeOffset</span><span class="p">;</span>             <span class="cm">/* 18h */</span>
    <span class="n">U32</span>                     <span class="n">DataLength</span><span class="p">;</span>                 <span class="cm">/* 1Ch */</span>
    <span class="n">SGE_IO_UNION</span>            <span class="n">SGL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>                     <span class="cm">/* 20h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_ASSIST_REQUEST</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_ASSIST_REQUEST</span><span class="p">,</span>
  <span class="n">TargetAssistRequest_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetAssistRequest_t</span><span class="p">;</span>

<span class="cp">#define TARGET_ASSIST_FLAGS_DATA_DIRECTION          (0x01)</span>
<span class="cp">#define TARGET_ASSIST_FLAGS_AUTO_STATUS             (0x02)</span>
<span class="cp">#define TARGET_ASSIST_FLAGS_HIGH_PRIORITY           (0x04)</span>
<span class="cp">#define TARGET_ASSIST_FLAGS_CONFIRMED               (0x08)</span>
<span class="cp">#define TARGET_ASSIST_FLAGS_REPOST_CMD_BUFFER       (0x80)</span>

<span class="cm">/* Standard Target Mode Reply message */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_ERROR_REPLY</span>
<span class="p">{</span>
    <span class="n">U16</span>                     <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">MsgLength</span><span class="p">;</span>                  <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U8</span>                      <span class="n">PriorityReason</span><span class="p">;</span>             <span class="cm">/* 0Ch */</span>
    <span class="n">U8</span>                      <span class="n">Reserved3</span><span class="p">;</span>                  <span class="cm">/* 0Dh */</span>
    <span class="n">U16</span>                     <span class="n">IOCStatus</span><span class="p">;</span>                  <span class="cm">/* 0Eh */</span>
    <span class="n">U32</span>                     <span class="n">IOCLogInfo</span><span class="p">;</span>                 <span class="cm">/* 10h */</span>
    <span class="n">U32</span>                     <span class="n">ReplyWord</span><span class="p">;</span>                  <span class="cm">/* 14h */</span>
    <span class="n">U32</span>                     <span class="n">TransferCount</span><span class="p">;</span>              <span class="cm">/* 18h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_ERROR_REPLY</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_ERROR_REPLY</span><span class="p">,</span>
  <span class="n">TargetErrorReply_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetErrorReply_t</span><span class="p">;</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Assist Extended Request                                           */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_ASSIST_EXT_REQUEST</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">StatusCode</span><span class="p">;</span>                     <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">TargetAssistFlags</span><span class="p">;</span>              <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">ChainOffset</span><span class="p">;</span>                    <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                       <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">QueueTag</span><span class="p">;</span>                       <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved1</span><span class="p">;</span>                      <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                       <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                     <span class="cm">/* 08h */</span>
    <span class="n">U32</span>                     <span class="n">ReplyWord</span><span class="p">;</span>                      <span class="cm">/* 0Ch */</span>
    <span class="n">U8</span>                      <span class="n">LUN</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                         <span class="cm">/* 10h */</span>
    <span class="n">U32</span>                     <span class="n">RelativeOffset</span><span class="p">;</span>                 <span class="cm">/* 18h */</span>
    <span class="n">U32</span>                     <span class="n">Reserved2</span><span class="p">;</span>                      <span class="cm">/* 1Ch */</span>
    <span class="n">U32</span>                     <span class="n">Reserved3</span><span class="p">;</span>                      <span class="cm">/* 20h */</span>
    <span class="n">U32</span>                     <span class="n">PrimaryReferenceTag</span><span class="p">;</span>            <span class="cm">/* 24h */</span>
    <span class="n">U16</span>                     <span class="n">PrimaryApplicationTag</span><span class="p">;</span>          <span class="cm">/* 28h */</span>
    <span class="n">U16</span>                     <span class="n">PrimaryApplicationTagMask</span><span class="p">;</span>      <span class="cm">/* 2Ah */</span>
    <span class="n">U32</span>                     <span class="n">Reserved4</span><span class="p">;</span>                      <span class="cm">/* 2Ch */</span>
    <span class="n">U32</span>                     <span class="n">DataLength</span><span class="p">;</span>                     <span class="cm">/* 30h */</span>
    <span class="n">U32</span>                     <span class="n">BidirectionalDataLength</span><span class="p">;</span>        <span class="cm">/* 34h */</span>
    <span class="n">U32</span>                     <span class="n">SecondaryReferenceTag</span><span class="p">;</span>          <span class="cm">/* 38h */</span>
    <span class="n">U16</span>                     <span class="n">SecondaryApplicationTag</span><span class="p">;</span>        <span class="cm">/* 3Ch */</span>
    <span class="n">U16</span>                     <span class="n">Reserved5</span><span class="p">;</span>                      <span class="cm">/* 3Eh */</span>
    <span class="n">U16</span>                     <span class="n">EEDPFlags</span><span class="p">;</span>                      <span class="cm">/* 40h */</span>
    <span class="n">U16</span>                     <span class="n">ApplicationTagTranslationMask</span><span class="p">;</span>  <span class="cm">/* 42h */</span>
    <span class="n">U32</span>                     <span class="n">EEDPBlockSize</span><span class="p">;</span>                  <span class="cm">/* 44h */</span>
    <span class="n">U8</span>                      <span class="n">SGLOffset0</span><span class="p">;</span>                     <span class="cm">/* 48h */</span>
    <span class="n">U8</span>                      <span class="n">SGLOffset1</span><span class="p">;</span>                     <span class="cm">/* 49h */</span>
    <span class="n">U8</span>                      <span class="n">SGLOffset2</span><span class="p">;</span>                     <span class="cm">/* 4Ah */</span>
    <span class="n">U8</span>                      <span class="n">SGLOffset3</span><span class="p">;</span>                     <span class="cm">/* 4Bh */</span>
    <span class="n">U32</span>                     <span class="n">Reserved6</span><span class="p">;</span>                      <span class="cm">/* 4Ch */</span>
    <span class="n">SGE_IO_UNION</span>            <span class="n">SGL</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>                         <span class="cm">/* 50h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_ASSIST_EXT_REQUEST</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_ASSIST_EXT_REQUEST</span><span class="p">,</span>
  <span class="n">TargetAssistExtRequest_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetAssistExtRequest_t</span><span class="p">;</span>

<span class="cm">/* see the defines after MSG_TARGET_ASSIST_REQUEST for TargetAssistFlags */</span>

<span class="cm">/* defines for the MsgFlags field */</span>
<span class="cp">#define TARGET_ASSIST_EXT_MSGFLAGS_BIDIRECTIONAL        (0x20)</span>
<span class="cp">#define TARGET_ASSIST_EXT_MSGFLAGS_MULTICAST            (0x10)</span>
<span class="cp">#define TARGET_ASSIST_EXT_MSGFLAGS_SGL_OFFSET_CHAINS    (0x08)</span>

<span class="cm">/* defines for the EEDPFlags field */</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_MASK_OP          (0x0007)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_NOOP_OP          (0x0000)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_CHK_OP           (0x0001)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_STRIP_OP         (0x0002)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_CHKRM_OP         (0x0003)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_INSERT_OP        (0x0004)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_REPLACE_OP       (0x0006)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_CHKREGEN_OP      (0x0007)</span>

<span class="cp">#define TARGET_ASSIST_EXT_EEDP_PASS_REF_TAG     (0x0008)</span>

<span class="cp">#define TARGET_ASSIST_EXT_EEDP_T10_CHK_MASK     (0x0700)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_T10_CHK_GUARD    (0x0100)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_T10_CHK_APPTAG   (0x0200)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_T10_CHK_REFTAG   (0x0400)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_T10_CHK_SHIFT    (8)</span>

<span class="cp">#define TARGET_ASSIST_EXT_EEDP_INC_SEC_APPTAG   (0x1000)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_INC_PRI_APPTAG   (0x2000)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_INC_SEC_REFTAG   (0x4000)</span>
<span class="cp">#define TARGET_ASSIST_EXT_EEDP_INC_PRI_REFTAG   (0x8000)</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Status Send Request                                               */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_STATUS_SEND_REQUEST</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">StatusCode</span><span class="p">;</span>                 <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">StatusFlags</span><span class="p">;</span>                <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">ChainOffset</span><span class="p">;</span>                <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">QueueTag</span><span class="p">;</span>                   <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U32</span>                     <span class="n">ReplyWord</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U8</span>                      <span class="n">LUN</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                     <span class="cm">/* 10h */</span>
    <span class="n">SGE_SIMPLE_UNION</span>        <span class="n">StatusDataSGE</span><span class="p">;</span>              <span class="cm">/* 18h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_STATUS_SEND_REQUEST</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_STATUS_SEND_REQUEST</span><span class="p">,</span>
  <span class="n">TargetStatusSendRequest_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetStatusSendRequest_t</span><span class="p">;</span>

<span class="cp">#define TARGET_STATUS_SEND_FLAGS_AUTO_GOOD_STATUS   (0x01)</span>
<span class="cp">#define TARGET_STATUS_SEND_FLAGS_HIGH_PRIORITY      (0x04)</span>
<span class="cp">#define TARGET_STATUS_SEND_FLAGS_CONFIRMED          (0x08)</span>
<span class="cp">#define TARGET_STATUS_SEND_FLAGS_REPOST_CMD_BUFFER  (0x80)</span>

<span class="cm">/*</span>
<span class="cm"> * NOTE: FCP_RSP data is big-endian. When used on a little-endian system, this</span>
<span class="cm"> * structure properly orders the bytes.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MPI_TARGET_FCP_RSP_BUFFER</span>
<span class="p">{</span>
    <span class="n">U8</span>      <span class="n">Reserved0</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                               <span class="cm">/* 00h */</span>
    <span class="n">U8</span>      <span class="n">Reserved1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>                               <span class="cm">/* 08h */</span>
    <span class="n">U8</span>      <span class="n">FcpFlags</span><span class="p">;</span>                                   <span class="cm">/* 0Ah */</span>
    <span class="n">U8</span>      <span class="n">FcpStatus</span><span class="p">;</span>                                  <span class="cm">/* 0Bh */</span>
    <span class="n">U32</span>     <span class="n">FcpResid</span><span class="p">;</span>                                   <span class="cm">/* 0Ch */</span>
    <span class="n">U32</span>     <span class="n">FcpSenseLength</span><span class="p">;</span>                             <span class="cm">/* 10h */</span>
    <span class="n">U32</span>     <span class="n">FcpResponseLength</span><span class="p">;</span>                          <span class="cm">/* 14h */</span>
    <span class="n">U8</span>      <span class="n">FcpResponseData</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>                         <span class="cm">/* 18h */</span>
    <span class="n">U8</span>      <span class="n">FcpSenseData</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="cm">/* Pad to 64 bytes */</span>     <span class="cm">/* 20h */</span>
<span class="p">}</span> <span class="n">MPI_TARGET_FCP_RSP_BUFFER</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MPI_TARGET_FCP_RSP_BUFFER</span><span class="p">,</span>
  <span class="n">MpiTargetFcpRspBuffer</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pMpiTargetFcpRspBuffer</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * NOTE: The SPI status IU is big-endian. When used on a little-endian system,</span>
<span class="cm"> * this structure properly orders the bytes.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MPI_TARGET_SCSI_SPI_STATUS_IU</span>
<span class="p">{</span>
    <span class="n">U8</span>      <span class="n">Reserved0</span><span class="p">;</span>                                  <span class="cm">/* 00h */</span>
    <span class="n">U8</span>      <span class="n">Reserved1</span><span class="p">;</span>                                  <span class="cm">/* 01h */</span>
    <span class="n">U8</span>      <span class="n">Valid</span><span class="p">;</span>                                      <span class="cm">/* 02h */</span>
    <span class="n">U8</span>      <span class="n">Status</span><span class="p">;</span>                                     <span class="cm">/* 03h */</span>
    <span class="n">U32</span>     <span class="n">SenseDataListLength</span><span class="p">;</span>                        <span class="cm">/* 04h */</span>
    <span class="n">U32</span>     <span class="n">PktFailuresListLength</span><span class="p">;</span>                      <span class="cm">/* 08h */</span>
    <span class="n">U8</span>      <span class="n">SenseData</span><span class="p">[</span><span class="mi">52</span><span class="p">];</span> <span class="cm">/* Pad the IU to 64 bytes */</span> <span class="cm">/* 0Ch */</span>
<span class="p">}</span> <span class="n">MPI_TARGET_SCSI_SPI_STATUS_IU</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MPI_TARGET_SCSI_SPI_STATUS_IU</span><span class="p">,</span>
  <span class="n">TargetScsiSpiStatusIU_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetScsiSpiStatusIU_t</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * NOTE: The SSP status IU is big-endian. When used on a little-endian system,</span>
<span class="cm"> * this structure properly orders the bytes.</span>
<span class="cm"> */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MPI_TARGET_SSP_RSP_IU</span>
<span class="p">{</span>
    <span class="n">U32</span>     <span class="n">Reserved0</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span> <span class="cm">/* reserved for SSP header */</span> <span class="cm">/* 00h */</span>
    <span class="cm">/* start of RESPONSE information unit */</span>
    <span class="n">U32</span>     <span class="n">Reserved1</span><span class="p">;</span>                                  <span class="cm">/* 18h */</span>
    <span class="n">U32</span>     <span class="n">Reserved2</span><span class="p">;</span>                                  <span class="cm">/* 1Ch */</span>
    <span class="n">U16</span>     <span class="n">Reserved3</span><span class="p">;</span>                                  <span class="cm">/* 20h */</span>
    <span class="n">U8</span>      <span class="n">DataPres</span><span class="p">;</span> <span class="cm">/* lower 2 bits */</span>                <span class="cm">/* 22h */</span>
    <span class="n">U8</span>      <span class="n">Status</span><span class="p">;</span>                                     <span class="cm">/* 23h */</span>
    <span class="n">U32</span>     <span class="n">Reserved4</span><span class="p">;</span>                                  <span class="cm">/* 24h */</span>
    <span class="n">U32</span>     <span class="n">SenseDataLength</span><span class="p">;</span>                            <span class="cm">/* 28h */</span>
    <span class="n">U32</span>     <span class="n">ResponseDataLength</span><span class="p">;</span>                         <span class="cm">/* 2Ch */</span>
    <span class="n">U8</span>      <span class="n">ResponseSenseData</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>                       <span class="cm">/* 30h */</span>
<span class="p">}</span> <span class="n">MPI_TARGET_SSP_RSP_IU</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MPI_TARGET_SSP_RSP_IU</span><span class="p">,</span>
  <span class="n">MpiTargetSspRspIu_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pMpiTargetSspRspIu_t</span><span class="p">;</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Mode Abort Request                                                */</span>
<span class="cm">/****************************************************************************/</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_MODE_ABORT_REQUEST</span>
<span class="p">{</span>
    <span class="n">U8</span>                      <span class="n">AbortType</span><span class="p">;</span>                  <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 01h */</span>
    <span class="n">U8</span>                      <span class="n">ChainOffset</span><span class="p">;</span>                <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U32</span>                     <span class="n">ReplyWord</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U32</span>                     <span class="n">MsgContextToAbort</span><span class="p">;</span>          <span class="cm">/* 10h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_MODE_ABORT</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_MODE_ABORT</span><span class="p">,</span>
  <span class="n">TargetModeAbort_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetModeAbort_t</span><span class="p">;</span>

<span class="cp">#define TARGET_MODE_ABORT_TYPE_ALL_CMD_BUFFERS      (0x00)</span>
<span class="cp">#define TARGET_MODE_ABORT_TYPE_ALL_IO               (0x01)</span>
<span class="cp">#define TARGET_MODE_ABORT_TYPE_EXACT_IO             (0x02)</span>
<span class="cp">#define TARGET_MODE_ABORT_TYPE_EXACT_IO_REQUEST     (0x03)</span>

<span class="cm">/* Target Mode Abort Reply */</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_MSG_TARGET_MODE_ABORT_REPLY</span>
<span class="p">{</span>
    <span class="n">U16</span>                     <span class="n">Reserved</span><span class="p">;</span>                   <span class="cm">/* 00h */</span>
    <span class="n">U8</span>                      <span class="n">MsgLength</span><span class="p">;</span>                  <span class="cm">/* 02h */</span>
    <span class="n">U8</span>                      <span class="n">Function</span><span class="p">;</span>                   <span class="cm">/* 03h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved1</span><span class="p">;</span>                  <span class="cm">/* 04h */</span>
    <span class="n">U8</span>                      <span class="n">Reserved2</span><span class="p">;</span>                  <span class="cm">/* 06h */</span>
    <span class="n">U8</span>                      <span class="n">MsgFlags</span><span class="p">;</span>                   <span class="cm">/* 07h */</span>
    <span class="n">U32</span>                     <span class="n">MsgContext</span><span class="p">;</span>                 <span class="cm">/* 08h */</span>
    <span class="n">U16</span>                     <span class="n">Reserved3</span><span class="p">;</span>                  <span class="cm">/* 0Ch */</span>
    <span class="n">U16</span>                     <span class="n">IOCStatus</span><span class="p">;</span>                  <span class="cm">/* 0Eh */</span>
    <span class="n">U32</span>                     <span class="n">IOCLogInfo</span><span class="p">;</span>                 <span class="cm">/* 10h */</span>
    <span class="n">U32</span>                     <span class="n">AbortCount</span><span class="p">;</span>                 <span class="cm">/* 14h */</span>
<span class="p">}</span> <span class="n">MSG_TARGET_MODE_ABORT_REPLY</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">PTR_MSG_TARGET_MODE_ABORT_REPLY</span><span class="p">,</span>
  <span class="n">TargetModeAbortReply_t</span><span class="p">,</span> <span class="n">MPI_POINTER</span> <span class="n">pTargetModeAbortReply_t</span><span class="p">;</span>


<span class="cm">/****************************************************************************/</span>
<span class="cm">/* Target Mode Context Reply                                                */</span>
<span class="cm">/****************************************************************************/</span>

<span class="cp">#define TARGET_MODE_REPLY_IO_INDEX_MASK         (0x00003FFF)</span>
<span class="cp">#define TARGET_MODE_REPLY_IO_INDEX_SHIFT        (0)</span>
<span class="cp">#define TARGET_MODE_REPLY_INITIATOR_INDEX_MASK  (0x03FFC000)</span>
<span class="cp">#define TARGET_MODE_REPLY_INITIATOR_INDEX_SHIFT (14)</span>
<span class="cp">#define TARGET_MODE_REPLY_ALIAS_MASK            (0x04000000)</span>
<span class="cp">#define TARGET_MODE_REPLY_ALIAS_SHIFT           (26)</span>
<span class="cp">#define TARGET_MODE_REPLY_PORT_MASK             (0x10000000)</span>
<span class="cp">#define TARGET_MODE_REPLY_PORT_SHIFT            (28)</span>


<span class="cp">#define GET_IO_INDEX(x)     (((x) &amp; TARGET_MODE_REPLY_IO_INDEX_MASK)           \</span>
<span class="cp">                                    &gt;&gt; TARGET_MODE_REPLY_IO_INDEX_SHIFT)</span>

<span class="cp">#define SET_IO_INDEX(t, i)                                                     \</span>
<span class="cp">            ((t) = ((t) &amp; ~TARGET_MODE_REPLY_IO_INDEX_MASK) |                  \</span>
<span class="cp">                              (((i) &lt;&lt; TARGET_MODE_REPLY_IO_INDEX_SHIFT) &amp;     \</span>
<span class="cp">                                             TARGET_MODE_REPLY_IO_INDEX_MASK))</span>

<span class="cp">#define GET_INITIATOR_INDEX(x) (((x) &amp; TARGET_MODE_REPLY_INITIATOR_INDEX_MASK) \</span>
<span class="cp">                                   &gt;&gt; TARGET_MODE_REPLY_INITIATOR_INDEX_SHIFT)</span>

<span class="cp">#define SET_INITIATOR_INDEX(t, ii)                                             \</span>
<span class="cp">        ((t) = ((t) &amp; ~TARGET_MODE_REPLY_INITIATOR_INDEX_MASK) |               \</span>
<span class="cp">                        (((ii) &lt;&lt; TARGET_MODE_REPLY_INITIATOR_INDEX_SHIFT) &amp;   \</span>
<span class="cp">                                      TARGET_MODE_REPLY_INITIATOR_INDEX_MASK))</span>

<span class="cp">#define GET_ALIAS(x) (((x) &amp; TARGET_MODE_REPLY_ALIAS_MASK)                     \</span>
<span class="cp">                                               &gt;&gt; TARGET_MODE_REPLY_ALIAS_SHIFT)</span>

<span class="cp">#define SET_ALIAS(t, a)  ((t) = ((t) &amp; ~TARGET_MODE_REPLY_ALIAS_MASK) |        \</span>
<span class="cp">                                    (((a) &lt;&lt; TARGET_MODE_REPLY_ALIAS_SHIFT) &amp;  \</span>
<span class="cp">                                                 TARGET_MODE_REPLY_ALIAS_MASK))</span>

<span class="cp">#define GET_PORT(x) (((x) &amp; TARGET_MODE_REPLY_PORT_MASK)                       \</span>
<span class="cp">                                               &gt;&gt; TARGET_MODE_REPLY_PORT_SHIFT)</span>

<span class="cp">#define SET_PORT(t, p)  ((t) = ((t) &amp; ~TARGET_MODE_REPLY_PORT_MASK) |          \</span>
<span class="cp">                                    (((p) &lt;&lt; TARGET_MODE_REPLY_PORT_SHIFT) &amp;   \</span>
<span class="cp">                                                  TARGET_MODE_REPLY_PORT_MASK))</span>

<span class="cm">/* the following obsolete values are for MPI v1.0 support */</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_MASK_HOST_INDEX       (0x000003FF)</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_SHIFT_HOST_INDEX      (0)</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_MASK_IOC_INDEX        (0x001FF800)</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_SHIFT_IOC_INDEX       (11)</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_PORT_MASK             (0x00400000)</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_PORT_SHIFT            (22)</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_MASK_INITIATOR_INDEX  (0x1F800000)</span>
<span class="cp">#define TARGET_MODE_REPLY_0100_SHIFT_INITIATOR_INDEX (23)</span>

<span class="cp">#define GET_HOST_INDEX_0100(x) (((x) &amp; TARGET_MODE_REPLY_0100_MASK_HOST_INDEX) \</span>
<span class="cp">                                  &gt;&gt; TARGET_MODE_REPLY_0100_SHIFT_HOST_INDEX)</span>

<span class="cp">#define SET_HOST_INDEX_0100(t, hi)                                             \</span>
<span class="cp">            ((t) = ((t) &amp; ~TARGET_MODE_REPLY_0100_MASK_HOST_INDEX) |           \</span>
<span class="cp">                         (((hi) &lt;&lt; TARGET_MODE_REPLY_0100_SHIFT_HOST_INDEX) &amp;  \</span>
<span class="cp">                                      TARGET_MODE_REPLY_0100_MASK_HOST_INDEX))</span>

<span class="cp">#define GET_IOC_INDEX_0100(x)   (((x) &amp; TARGET_MODE_REPLY_0100_MASK_IOC_INDEX) \</span>
<span class="cp">                                  &gt;&gt; TARGET_MODE_REPLY_0100_SHIFT_IOC_INDEX)</span>

<span class="cp">#define SET_IOC_INDEX_0100(t, ii)                                              \</span>
<span class="cp">            ((t) = ((t) &amp; ~TARGET_MODE_REPLY_0100_MASK_IOC_INDEX) |            \</span>
<span class="cp">                        (((ii) &lt;&lt; TARGET_MODE_REPLY_0100_SHIFT_IOC_INDEX) &amp;    \</span>
<span class="cp">                                     TARGET_MODE_REPLY_0100_MASK_IOC_INDEX))</span>

<span class="cp">#define GET_INITIATOR_INDEX_0100(x)                                            \</span>
<span class="cp">            (((x) &amp; TARGET_MODE_REPLY_0100_MASK_INITIATOR_INDEX)               \</span>
<span class="cp">                              &gt;&gt; TARGET_MODE_REPLY_0100_SHIFT_INITIATOR_INDEX)</span>

<span class="cp">#define SET_INITIATOR_INDEX_0100(t, ii)                                        \</span>
<span class="cp">        ((t) = ((t) &amp; ~TARGET_MODE_REPLY_0100_MASK_INITIATOR_INDEX) |          \</span>
<span class="cp">                   (((ii) &lt;&lt; TARGET_MODE_REPLY_0100_SHIFT_INITIATOR_INDEX) &amp;   \</span>
<span class="cp">                                TARGET_MODE_REPLY_0100_MASK_INITIATOR_INDEX))</span>


<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
