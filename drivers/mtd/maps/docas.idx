f | uclinux.c | s | 2.9K | 92 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332804001 |  | mtd: add leading underscore to all mtd functions  This patch renames all MTD functions by adding a "_" prefix:  mtd->erase -> mtd->_erase mtd->read_oob -> mtd->_read_oob ...  The reason is that we are re-working the MTD API and from now on it is an error to use MTD function pointers directly - we have a corresponding API call for every pointer. By adding a leading "_" we achieve the following:  1. Make sure we convert every direct pointer users 2. A leading "_" suggests that this interface is internal and it becomes    less likely that people will use them directly 3. Make sure all the out-of-tree modules stop compiling and the owners    spot the big API change and amend them.  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | amd76xrom.c | s | 9.2K | 305 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | scx200_docflash.c | s | 5.4K | 183 | Jamie Iles | jamie@jamieiles.com | 1306286524 |  | mtd: scx200_docflash: convert to mtd_device_register()  Convert to mtd_device_register() and remove the CONFIG_MTD_PARTITIONS preprocessor conditionals as partitioning is always available.  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | mbx860.c | s | 2.4K | 82 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | intel_vr_nor.c | s | 6.9K | 221 | Axel Lin | axel.lin@gmail.com | 1336967239 |  | mtd: use module_pci_driver  This patch converts the drivers in drivers/mtd/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | scb2_flash.c | s | 7.2K | 209 | Axel Lin | axel.lin@gmail.com | 1336967239 |  | mtd: use module_pci_driver  This patch converts the drivers in drivers/mtd/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | Makefile | g | 2.2K |  | Jonas Gorski | jonas.gorski@gmail.com | 1326132999 |  | mtd: maps: remove the now unused bcm963xx-flash  bcm963xx-flash does nothing meaningful anymore.  Signed-off-by: Jonas Gorski <jonas.gorski@gmail.com> Acked-by: Florian Fainelli <florian@openwrt.org> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | pci.c | s | 8.4K | 302 | Axel Lin | axel.lin@gmail.com | 1336967239 |  | mtd: use module_pci_driver  This patch converts the drivers in drivers/mtd/* to use module_pci_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | ixp2000.c | s | 6.0K | 207 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | impa7.c | s | 2.9K | 106 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | solutionengine.c | s | 3.0K | 102 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | tsunami_flash.c | s | 2.4K | 94 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | ixp4xx.c | s | 6.4K | 235 | Marc Kleine-Budde | mkl@blackshift.org | 1332804813 |  | mtd: ixp4xx: oops in ixp4xx_flash_probe  In commit "c797533 mtd: abstract last MTD partition parser argument" the third argument of "mtd_device_parse_register()" changed from start address of the MTD device to a pointer to a struct.  The "ixp4xx_flash_probe()" function was not converted properly, causing an oops during boot.  This patch fixes the problem by filling the needed information into a "struct mtd_part_parser_data" and passing it to "mtd_device_parse_register()".  Signed-off-by: Marc Kleine-Budde <mkl@blackshift.org> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Cc: stable@kernel.org [3.2+] Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | latch-addr-flash.c | s | 5.4K | 179 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | cfi_flagadm.c | s | 3.9K | 114 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | dbox2-flash.c | s | 2.7K | 104 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | sa1100-flash.c | s | 6.4K | 249 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | sun_uflash.c | s | 3.6K | 126 | Axel Lin | axel.lin@gmail.com | 1326132755 |  | mtd: convert drivers/mtd/* to use module_platform_driver()  This patch converts the drivers in drivers/mtd/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked by: Haojian Zhuang <haojian.zhuang@gmail.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@linux.intel.com>  Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | netsc520.c | s | 4.1K | 123 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | rpxlite.c | s | 1.3K | 53 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | esb2rom.c | s | 12K | 394 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | ck804xrom.c | s | 10K | 332 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | sbc_gxx.c | s | 6.2K | 186 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | autcpu12-nvram.c | s | 3.1K | 108 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | plat-ram.c | s | 6.3K | 217 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | h720x-flash.c | s | 2.7K | 101 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | ichxrom.c | s | 9.7K | 339 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | map_funcs.c | s | 1.1K | 34 | Adrian Bunk | bunk@kernel.org | 1212598217 |  | MTD/JFFS2: remove CVS keywords  Once upon a time, the MTD repository was using CVS.  This patch therefore removes all usages of the no longer updated CVS keywords from the MTD code.  This also includes code that printed them to the user.  Signed-off-by: Adrian Bunk <bunk@kernel.org> Signed-off-by: David Woodhouse <dwmw2@infradead.org>
f | pcmciamtd.c | s | 19K | 607 | Linus Torvalds | torvalds@linux-foundation.org | 1333153916 |  | 
f | vmu-flash.c | s | 19K | 713 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332804739 |  | mtd: move zero length verification to MTD API functions  In many places in drivers we verify for the zero length, but this is very inconsistent across drivers. This is obviously the right thing to do, though. This patch moves the check to the MTD API functions instead and removes a lot of duplication.  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Reviewed-by: Shmulik Ladkani <shmulik.ladkani@gmail.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | physmap_of.c | s | 8.4K | 299 | Axel Lin | axel.lin@gmail.com | 1326132755 |  | mtd: convert drivers/mtd/* to use module_platform_driver()  This patch converts the drivers in drivers/mtd/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked by: Haojian Zhuang <haojian.zhuang@gmail.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@linux.intel.com>  Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | nettel.c | s | 11K | 383 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | physmap.c | s | 6.8K | 239 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | dc21285.c | s | 5.4K | 200 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | sc520cdp.c | s | 8.9K | 260 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | ts5500_flash.c | s | 2.8K | 100 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | pxa2xx-flash.c | s | 3.6K | 121 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | l440gx.c | s | 4.0K | 134 | Paul Parsons | lost.distance@yahoo.com | 1332805969 |  | mtd: maps: l440gx: Add reference counter to set_vpp()  This patch is part of a set which fixes unnecessary flash erase and write errors resulting from the MTD CFI driver turning off vpp while an erase is in progress. This patch allows l440gx_set_vpp() calls to be nested by adding a reference counter.  Signed-off-by: Paul Parsons <lost.distance@yahoo.com> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | pmcmsp-flash.c | s | 6.1K | 192 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | pismo.c | s | 6.1K | 241 | Marc Zyngier | Marc.Zyngier@arm.com | 1305926854 |  | ARM: 6910/1: MTD: physmap: let set_vpp() pass a platform_device instead of a map_info  The set_vpp() method provided by physmap passes a map_info back to the platform code, which has little relevance as far as the platform is concerned (this parameter is completely unused).  Instead, pass the platform_device, which can be used in the pismo driver to retrieve some important information in a nicer way, instead of the hack that was in place.  The empty set_vpp function in board-at572d940hf_ek.c is left untouched, as the board/SoC is scheduled for removal.  Cc: Andrew Victor <linux@maxim.org.za> Cc: Nicolas Ferre <nicolas.ferre@atmel.com> Acked-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Cc: Philipp Zabel <philipp.zabel@gmail.com> Cc: Eric Miao <eric.y.miao@gmail.com> Cc: Ben Dooks <ben-linux@fluff.org> Acked-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Acked-by: David Woodhouse <dwmw2@infradead.org> Signed-off-by: Marc Zyngier <marc.zyngier@arm.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | bfin-async-flash.c | s | 5.0K | 154 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | rbtx4939-flash.c | s | 3.3K | 119 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | Kconfig | g | 17K |  | Randy Dunlap | rdunlap@xenotime.net | 1336967536 |  | mtd: fix scb2_flash build when PCI is not enabled  scb2_flash.c is a PCI driver, but its build fails when CONFIG_PCI is not enabled, so make it depend on PCI.  drivers/mtd/maps/scb2_flash.c:237:1: warning: data definition has no type or storage class drivers/mtd/maps/scb2_flash.c:237:1: warning: type defaults to 'int' in declaration of 'module_pci_driver' drivers/mtd/maps/scb2_flash.c:237:1: warning: parameter names (without types) in function declaration  Signed-off-by: Randy Dunlap <rdunlap@xenotime.net> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | dmv182.c | s | 3.7K | 123 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | lantiq-flash.c | s | 5.6K | 191 | John Crispin | blogic@openwrt.org | 1337607115 |  | MTD: MIPS: lantiq: verify that the NOR interface is available on falcon soc  When running on a FALC-ON SoC, we need to check the bootstrap options to see if NOR is available.  Signed-off-by: John Crispin <blogic@openwrt.org> Acked-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Cc: linux-mtd@lists.infradead.org Cc: linux-mips@linux-mips.org Patchwork: https://patchwork.linux-mips.org/patch/3815/ Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | tqm8xxl.c | s | 6.4K | 216 | Jamie Iles | jamie@jamieiles.com | 1306286577 |  | mtd: tqm8xll: convert to mtd_device_register()  Convert to mtd_device_register() and remove the CONFIG_MTD_PARTITIONS preprocessor conditionals as partitioning is always available.  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | vmax301.c | s | 5.2K | 169 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | fortunet.c | s | 6.8K | 253 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | gpio-addr-flash.c | s | 8.1K | 250 | Artem Bityutskiy | artem.bityutskiy@linux.intel.com | 1332806000 |  | mtd: do not use plain 0 as NULL  The first 3 arguments of 'mtd_device_parse_register()' are pointers, but many callers pass '0' instead of 'NULL'. Fix this globally. Thanks to coccinelle for making it easy to do with the following semantic patch:   @@  expression mtd, types, parser_data, parts, nr_parts;  @@  (  -mtd_device_parse_register(mtd, 0, parser_data, parts, nr_parts)  +mtd_device_parse_register(mtd, NULL, parser_data, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, 0, parts, nr_parts)  +mtd_device_parse_register(mtd, types, NULL, parts, nr_parts)  ||  -mtd_device_parse_register(mtd, types, parser_data, 0, nr_parts)  +mtd_device_parse_register(mtd, types, parser_data, NULL, nr_parts)  )  Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | wr_sbc82xx_flash.c | s | 3.9K | 143 | Uwe Kleine-König | u.kleine-koenig@pengutronix.de | 1336967232 |  | mtd: mark const init data with __initconst instead of __initdata  As long as there is no other non-const variable marked __initdata in the same compilation unit it doesn't hurt. If there were one however compilation would fail with  	error: $variablename causes a section type conflict  because a section containing const variables is marked read only and so cannot contain non-const variables.  Signed-off-by: Uwe Kleine-König <u.kleine-koenig@pengutronix.de> Signed-off-by: Artem Bityutskiy <artem.bityutskiy@linux.intel.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | octagon-5066.c | s | 6.3K | 213 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | cdb89712.c | s | 5.8K | 219 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
f | dilnetpc.c | s | 13K | 418 | Jamie Iles | jamie@jamieiles.com | 1306286700 |  | mtd: convert remaining users to mtd_device_register()  The older add_mtd_device()/add_mtd_partitions() and their removal counterparts will soon be gone.  Replace uses with mtd_device_register() and mtd_device_unregister().  Signed-off-by: Jamie Iles <jamie@jamieiles.com> Signed-off-by: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Signed-off-by: David Woodhouse <David.Woodhouse@intel.com>
