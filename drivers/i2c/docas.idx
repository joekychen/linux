f | i2c-mux.c | s | 5.0K | 159 | David Daney | david.daney@cavium.com | 1336825696 |  | i2c/of: Automatically populate i2c mux busses from device tree data.  For 'normal' i2c bus drivers, we can call of_i2c_register_devices() and have the device tree framework automatically populate the bus with the devices specified in the device tree.  This patch adds a common code to the i2c mux framework to have the mux sub-busses be populated by the of_i2c_register_devices() too.  If the mux device has an of_node, we populate the sub-bus' of_node so that the subsequent call to of_i2c_register_devices() will find the corresponding devices.  It seemed better to put this logic in i2c_add_mux_adapter() rather than the individual mux drivers, as they will all probably want to do the same thing.  Signed-off-by: David Daney <david.daney@cavium.com> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Tested-by: Lars-Peter Clausen <lars@metafoo.de>  [wsa: removed superfluous ret-variable and fixed a typo in a comment] Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | i2c-core.c | s | 58K | 1866 | Stephen Warren | swarren@nvidia.com | 1336825696 |  | i2c: implement i2c_verify_adapter  This converts a struct device * to a struct i2c_adapter * while verifying that the device really is an I2C adapter. Just like i2c_verify_client.  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Jean Delvare <khali@linux-fr.org> Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | Makefile | g | 358B |  | Jean Delvare | khali@linux-fr.org | 1300629053 |  | i2c: Deprecate i2c_driver.attach_adapter and .detach_adapter  The last legitimate user of i2c_driver.attach_adapter and .detach_adapter is gone, so we can finally deprecate these callbacks. The last few drivers which still use these will have to be updated to make use of standard I2C device instantiation ways instead.  Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | i2c-smbus.c | s | 7.1K | 226 | Jean Delvare | khali@linux-fr.org | 1332791239 |  | i2c: Update the FSF address  Signed-off-by: Jean Delvare <khali@linux-fr.org>
d | busses |  | 79 items |  | Mark Brown | broonie@opensource.wolfsonmicro.com | 1338368134 |  | i2c: Split I2C_M_NOSTART support out of I2C_FUNC_PROTOCOL_MANGLING  Since there are uses for I2C_M_NOSTART which are much more sensible and standard than most of the protocol mangling functionality (the main one being gather writes to devices where something like a register address needs to be inserted before a block of data) create a new I2C_FUNC_NOSTART for this feature and update all the users to use it.  Also strengthen the disrecommendation of the protocol mangling while we're at it.  In the case of regmap-i2c we remove the requirement for mangling as I2C_M_NOSTART is the only mangling feature which is being used.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | i2c-dev.c | s | 18K | 568 | Jean Delvare | khali@linux-fr.org | 1338368134 |  | i2c-dev: Add support for I2C_M_RECV_LEN  As the bus driver side implementation of I2C_M_RECV_LEN is heavily tied to SMBus, we can't support received length over 32 bytes, but let's at least support that.  In practice, the caller will have to setup a buffer large enough to cover the case where received length byte has value 32, so minimum 32 + 1 = 33 bytes, possibly more if there is a fixed number of bytes added for the specific slave (for example a checksum.)  Signed-off-by: Jean Delvare <khali@linux-fr.org> Tested-by: Douglas Gilbert <dgilbert@interlog.com>
d | algos |  | 6 items |  | Mark Brown | broonie@opensource.wolfsonmicro.com | 1338368134 |  | i2c: Split I2C_M_NOSTART support out of I2C_FUNC_PROTOCOL_MANGLING  Since there are uses for I2C_M_NOSTART which are much more sensible and standard than most of the protocol mangling functionality (the main one being gather writes to devices where something like a register address needs to be inserted before a block of data) create a new I2C_FUNC_NOSTART for this feature and update all the users to use it.  Also strengthen the disrecommendation of the protocol mangling while we're at it.  In the case of regmap-i2c we remove the requirement for mangling as I2C_M_NOSTART is the only mangling feature which is being used.  Signed-off-by: Mark Brown <broonie@opensource.wolfsonmicro.com> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | i2c-core.h | s | 1.1K | 30 | Jean Delvare | khali@linux-fr.org | 1332791239 |  | i2c: Update the FSF address  Signed-off-by: Jean Delvare <khali@linux-fr.org>
d | muxes |  | 6 items |  | Stephen Warren | swarren@nvidia.com | 1338821383 |  | i2c: Add generic I2C multiplexer using pinctrl API  This is useful for SoCs whose I2C module's signals can be routed to different sets of pins at run-time, using the pinctrl API.                                   +-----+  +-----+                                  || dev ||  || dev ||     +------------------------+   +-----+  +-----+     || SoC                    ||      ||        ||     ||                   /----||------+--------+     ||   +---+   +------+     || child bus A, on first set of pins     ||   ||I2C||---||Pinmux||     ||     ||   +---+   +------+     || child bus B, on second set of pins     ||                   \----||------+--------+--------+     ||                        ||      ||        ||        ||     +------------------------+  +-----+  +-----+  +-----+                                 || dev ||  || dev ||  || dev ||                                 +-----+  +-----+  +-----+  Signed-off-by: Stephen Warren <swarren@nvidia.com> Acked-by: Linus Walleij <linus.walleij@linaro.org> Acked-by: Rob Herring <rob.herring@calxeda.com> Signed-off-by: Wolfram Sang <w.sang@pengutronix.de>
f | i2c-boardinfo.c | s | 3.0K | 79 | Jean Delvare | khali@linux-fr.org | 1332791239 |  | i2c: Update the FSF address  Signed-off-by: Jean Delvare <khali@linux-fr.org>
f | Kconfig | g | 3.5K |  | Wolfram Sang | w.sang@pengutronix.de | 1336825696 |  | i2c: muxes are not EXPERIMENTAL anymore  We got multiple patches to add mux support to device tree, so people are using it happily already and build up on it. I also used it in a project without encountering problems. 20 months of EXPERIMENTAL should do for this.  Signed-off-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Peter Korsgaard <jacmet@sunsite.dk> Acked-by: Guenter Roeck <guenter.roeck@ericsson.com> Acked-by: Jean Delvare <khali@linux-fr.org> Acked-by: Stephen Warren <swarren@wwwdotorg.org> Acked-by: Michael Lawnick <ml.lawnick@gmx.de> Cc: Lars-Peter Clausen <lars@metafoo.de> Cc: David Daney <ddaney.cavm@gmail.com>
