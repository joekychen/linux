<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › i2c › busses › i2c-iop3xx.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>i2c-iop3xx.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* ------------------------------------------------------------------------- */</span>
<span class="cm">/* i2c-iop3xx.h algorithm driver definitions private to i2c-iop3xx.c         */</span>
<span class="cm">/* ------------------------------------------------------------------------- */</span>
<span class="cm">/*   Copyright (C) 2003 Peter Milne, D-TACQ Solutions Ltd</span>
<span class="cm"> *                      &lt;Peter dot Milne at D hyphen TACQ dot com&gt;</span>

<span class="cm">    This program is free software; you can redistribute it and/or modify</span>
<span class="cm">    it under the terms of the GNU General Public License as published by</span>
<span class="cm">    the Free Software Foundation, version 2.</span>

<span class="cm">    This program is distributed in the hope that it will be useful,</span>
<span class="cm">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm">    GNU General Public License for more details.</span>

<span class="cm">    You should have received a copy of the GNU General Public License</span>
<span class="cm">    along with this program; if not, write to the Free Software</span>
<span class="cm">    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.                */</span>
<span class="cm">/* ------------------------------------------------------------------------- */</span>


<span class="cp">#ifndef I2C_IOP3XX_H</span>
<span class="cp">#define I2C_IOP3XX_H 1</span>

<span class="cm">/*</span>
<span class="cm"> * iop321 hardware bit definitions</span>
<span class="cm"> */</span>
<span class="cp">#define IOP3XX_ICR_FAST_MODE	0x8000	</span><span class="cm">/* 1=400kBps, 0=100kBps */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_UNIT_RESET	0x4000	</span><span class="cm">/* 1=RESET */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_SAD_IE	0x2000	</span><span class="cm">/* 1=Slave Detect Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_ALD_IE	0x1000	</span><span class="cm">/* 1=Arb Loss Detect Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_SSD_IE	0x0800	</span><span class="cm">/* 1=Slave STOP Detect Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_BERR_IE	0x0400	</span><span class="cm">/* 1=Bus Error Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_RXFULL_IE	0x0200	</span><span class="cm">/* 1=Receive Full Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_TXEMPTY_IE	0x0100	</span><span class="cm">/* 1=Transmit Empty Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_GCD		0x0080	</span><span class="cm">/* 1=General Call Disable */</span><span class="cp"></span>
<span class="cm">/*</span>
<span class="cm"> * IOP3XX_ICR_GCD: 1 disables response as slave. &quot;This bit must be set</span>
<span class="cm"> * when sending a master mode general call message from the I2C unit&quot;</span>
<span class="cm"> */</span>
<span class="cp">#define IOP3XX_ICR_UE		0x0040	</span><span class="cm">/* 1=Unit Enable */</span><span class="cp"></span>
<span class="cm">/*</span>
<span class="cm"> * &quot;NOTE: To avoid I2C bus integrity problems, </span>
<span class="cm"> * the user needs to ensure that the GPIO Output Data Register - </span>
<span class="cm"> * GPOD bits associated with an I2C port are cleared prior to setting </span>
<span class="cm"> * the enable bit for that I2C serial port. </span>
<span class="cm"> * The user prepares to enable I2C port 0 and </span>
<span class="cm"> * I2C port 1 by clearing GPOD bits 7:6 and GPOD bits 5:4, respectively.</span>
<span class="cm"> */</span>
<span class="cp">#define IOP3XX_ICR_SCLEN	0x0020	</span><span class="cm">/* 1=SCL enable for master mode */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_MABORT	0x0010	</span><span class="cm">/* 1=Send a STOP with no data </span>
<span class="cm">					 * NB TBYTE must be clear */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_TBYTE	0x0008	</span><span class="cm">/* 1=Send/Receive a byte. i2c clears */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_NACK		0x0004	</span><span class="cm">/* 1=reply with NACK */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_MSTOP	0x0002	</span><span class="cm">/* 1=send a STOP after next data byte */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ICR_MSTART	0x0001	</span><span class="cm">/* 1=initiate a START */</span><span class="cp"></span>


<span class="cp">#define IOP3XX_ISR_BERRD	0x0400	</span><span class="cm">/* 1=BUS ERROR Detected */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_SAD		0x0200	</span><span class="cm">/* 1=Slave ADdress Detected */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_GCAD		0x0100	</span><span class="cm">/* 1=General Call Address Detected */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_RXFULL	0x0080	</span><span class="cm">/* 1=Receive Full */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_TXEMPTY	0x0040	</span><span class="cm">/* 1=Transmit Empty */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_ALD		0x0020	</span><span class="cm">/* 1=Arbitration Loss Detected */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_SSD		0x0010	</span><span class="cm">/* 1=Slave STOP Detected */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_BBUSY	0x0008	</span><span class="cm">/* 1=Bus BUSY */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_UNITBUSY	0x0004	</span><span class="cm">/* 1=Unit Busy */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_NACK		0x0002	</span><span class="cm">/* 1=Unit Rx or Tx a NACK */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_ISR_RXREAD	0x0001	</span><span class="cm">/* 1=READ 0=WRITE (R/W bit of slave addr */</span><span class="cp"></span>

<span class="cp">#define IOP3XX_ISR_CLEARBITS	0x07f0</span>

<span class="cp">#define IOP3XX_ISAR_SAMASK	0x007f</span>

<span class="cp">#define IOP3XX_IDBR_MASK	0x00ff</span>

<span class="cp">#define IOP3XX_IBMR_SCL		0x0002</span>
<span class="cp">#define IOP3XX_IBMR_SDA		0x0001</span>

<span class="cp">#define IOP3XX_GPOD_I2C0	0x00c0	</span><span class="cm">/* clear these bits to enable ch0 */</span><span class="cp"></span>
<span class="cp">#define IOP3XX_GPOD_I2C1	0x0030	</span><span class="cm">/* clear these bits to enable ch1 */</span><span class="cp"></span>

<span class="cp">#define MYSAR			0	</span><span class="cm">/* default slave address */</span><span class="cp"></span>

<span class="cp">#define I2C_ERR			321</span>
<span class="cp">#define I2C_ERR_BERR		(I2C_ERR+0)</span>
<span class="cp">#define I2C_ERR_ALD		(I2C_ERR+1)</span>


<span class="cp">#define	CR_OFFSET		0</span>
<span class="cp">#define	SR_OFFSET		0x4</span>
<span class="cp">#define	SAR_OFFSET		0x8</span>
<span class="cp">#define	DBR_OFFSET		0xc</span>
<span class="cp">#define	CCR_OFFSET		0x10</span>
<span class="cp">#define	BMR_OFFSET		0x14</span>

<span class="cp">#define	IOP3XX_I2C_IO_SIZE	0x18</span>

<span class="k">struct</span> <span class="n">i2c_algo_iop3xx_data</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">ioaddr</span><span class="p">;</span>
	<span class="n">wait_queue_head_t</span> <span class="n">waitq</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">SR_enabled</span><span class="p">,</span> <span class="n">SR_received</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">id</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* I2C_IOP3XX_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
