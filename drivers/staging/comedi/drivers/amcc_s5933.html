<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › comedi › drivers › amcc_s5933.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>amcc_s5933.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">    comedi/drivers/amcc_s5933.h</span>

<span class="cm">    Stuff for AMCC S5933 PCI Controller</span>

<span class="cm">    Author: Michal Dobes &lt;dobes@tesnet.cz&gt;</span>

<span class="cm">    Inspirated from general-purpose AMCC S5933 PCI Matchmaker driver</span>
<span class="cm">    made by Andrea Cisternino  &lt;acister@pcape1.pi.infn.it&gt;</span>
<span class="cm">    and as result of espionage from MITE code made by David A. Schleef.</span>
<span class="cm">    Thanks to AMCC for their on-line documentation and bus master DMA</span>
<span class="cm">    example.</span>
<span class="cm">*/</span>

<span class="cp">#ifndef _AMCC_S5933_H_</span>
<span class="cp">#define _AMCC_S5933_H_</span>

<span class="cm">/****************************************************************************/</span>
<span class="cm">/* AMCC Operation Register Offsets - PCI                                    */</span>
<span class="cm">/****************************************************************************/</span>

<span class="cp">#define AMCC_OP_REG_OMB1         0x00</span>
<span class="cp">#define AMCC_OP_REG_OMB2         0x04</span>
<span class="cp">#define AMCC_OP_REG_OMB3         0x08</span>
<span class="cp">#define AMCC_OP_REG_OMB4         0x0c</span>
<span class="cp">#define AMCC_OP_REG_IMB1         0x10</span>
<span class="cp">#define AMCC_OP_REG_IMB2         0x14</span>
<span class="cp">#define AMCC_OP_REG_IMB3         0x18</span>
<span class="cp">#define AMCC_OP_REG_IMB4         0x1c</span>
<span class="cp">#define AMCC_OP_REG_FIFO         0x20</span>
<span class="cp">#define AMCC_OP_REG_MWAR         0x24</span>
<span class="cp">#define AMCC_OP_REG_MWTC         0x28</span>
<span class="cp">#define AMCC_OP_REG_MRAR         0x2c</span>
<span class="cp">#define AMCC_OP_REG_MRTC         0x30</span>
<span class="cp">#define AMCC_OP_REG_MBEF         0x34</span>
<span class="cp">#define AMCC_OP_REG_INTCSR       0x38</span>
<span class="cp">#define  AMCC_OP_REG_INTCSR_SRC  (AMCC_OP_REG_INTCSR + 2)	</span><span class="cm">/* INT source */</span><span class="cp"></span>
<span class="cp">#define  AMCC_OP_REG_INTCSR_FEC  (AMCC_OP_REG_INTCSR + 3)	</span><span class="cm">/* FIFO ctrl */</span><span class="cp"></span>
<span class="cp">#define AMCC_OP_REG_MCSR         0x3c</span>
<span class="cp">#define  AMCC_OP_REG_MCSR_NVDATA (AMCC_OP_REG_MCSR + 2)	</span><span class="cm">/* Data in byte 2 */</span><span class="cp"></span>
<span class="cp">#define  AMCC_OP_REG_MCSR_NVCMD  (AMCC_OP_REG_MCSR + 3)	</span><span class="cm">/* Command in byte 3 */</span><span class="cp"></span>

<span class="cp">#define AMCC_FIFO_DEPTH_DWORD	8</span>
<span class="cp">#define AMCC_FIFO_DEPTH_BYTES	(8 * sizeof (u32))</span>

<span class="cm">/****************************************************************************/</span>
<span class="cm">/* AMCC - PCI Interrupt Control/Status Register                            */</span>
<span class="cm">/****************************************************************************/</span>
<span class="cp">#define INTCSR_OUTBOX_BYTE(x)	((x) &amp; 0x3)</span>
<span class="cp">#define INTCSR_OUTBOX_SELECT(x)	(((x) &amp; 0x3) &lt;&lt; 2)</span>
<span class="cp">#define INTCSR_OUTBOX_EMPTY_INT	0x10	</span><span class="cm">/*  enable outbox empty interrupt */</span><span class="cp"></span>
<span class="cp">#define INTCSR_INBOX_BYTE(x)	(((x) &amp; 0x3) &lt;&lt; 8)</span>
<span class="cp">#define INTCSR_INBOX_SELECT(x)	(((x) &amp; 0x3) &lt;&lt; 10)</span>
<span class="cp">#define INTCSR_INBOX_FULL_INT	0x1000	</span><span class="cm">/*  enable inbox full interrupt */</span><span class="cp"></span>
<span class="cp">#define INTCSR_INBOX_INTR_STATUS	0x20000	</span><span class="cm">/*  read, or write clear inbox full interrupt */</span><span class="cp"></span>
<span class="cp">#define INTCSR_INTR_ASSERTED	0x800000	</span><span class="cm">/*  read only, interrupt asserted */</span><span class="cp"></span>

<span class="cm">/****************************************************************************/</span>
<span class="cm">/* AMCC - PCI non-volatile ram command register (byte 3 of master control/status register) */</span>
<span class="cm">/****************************************************************************/</span>
<span class="cp">#define MCSR_NV_LOAD_LOW_ADDR	0x0</span>
<span class="cp">#define MCSR_NV_LOAD_HIGH_ADDR	0x20</span>
<span class="cp">#define MCSR_NV_WRITE	0x40</span>
<span class="cp">#define MCSR_NV_READ	0x60</span>
<span class="cp">#define MCSR_NV_MASK	0x60</span>
<span class="cp">#define MCSR_NV_ENABLE	0x80</span>
<span class="cp">#define MCSR_NV_BUSY	MCSR_NV_ENABLE</span>

<span class="cm">/****************************************************************************/</span>
<span class="cm">/* AMCC Operation Registers Size - PCI                                      */</span>
<span class="cm">/****************************************************************************/</span>

<span class="cp">#define AMCC_OP_REG_SIZE	 64	</span><span class="cm">/* in bytes */</span><span class="cp"></span>

<span class="cm">/****************************************************************************/</span>
<span class="cm">/* AMCC Operation Register Offsets - Add-on                                 */</span>
<span class="cm">/****************************************************************************/</span>

<span class="cp">#define AMCC_OP_REG_AIMB1         0x00</span>
<span class="cp">#define AMCC_OP_REG_AIMB2         0x04</span>
<span class="cp">#define AMCC_OP_REG_AIMB3         0x08</span>
<span class="cp">#define AMCC_OP_REG_AIMB4         0x0c</span>
<span class="cp">#define AMCC_OP_REG_AOMB1         0x10</span>
<span class="cp">#define AMCC_OP_REG_AOMB2         0x14</span>
<span class="cp">#define AMCC_OP_REG_AOMB3         0x18</span>
<span class="cp">#define AMCC_OP_REG_AOMB4         0x1c</span>
<span class="cp">#define AMCC_OP_REG_AFIFO         0x20</span>
<span class="cp">#define AMCC_OP_REG_AMWAR         0x24</span>
<span class="cp">#define AMCC_OP_REG_APTA          0x28</span>
<span class="cp">#define AMCC_OP_REG_APTD          0x2c</span>
<span class="cp">#define AMCC_OP_REG_AMRAR         0x30</span>
<span class="cp">#define AMCC_OP_REG_AMBEF         0x34</span>
<span class="cp">#define AMCC_OP_REG_AINT          0x38</span>
<span class="cp">#define AMCC_OP_REG_AGCSTS        0x3c</span>
<span class="cp">#define AMCC_OP_REG_AMWTC         0x58</span>
<span class="cp">#define AMCC_OP_REG_AMRTC         0x5c</span>

<span class="cm">/****************************************************************************/</span>
<span class="cm">/* AMCC - Add-on General Control/Status Register                            */</span>
<span class="cm">/****************************************************************************/</span>

<span class="cp">#define AGCSTS_CONTROL_MASK	0xfffff000</span>
<span class="cp">#define  AGCSTS_NV_ACC_MASK	0xe0000000</span>
<span class="cp">#define  AGCSTS_RESET_MASK	0x0e000000</span>
<span class="cp">#define  AGCSTS_NV_DA_MASK	0x00ff0000</span>
<span class="cp">#define  AGCSTS_BIST_MASK	0x0000f000</span>
<span class="cp">#define AGCSTS_STATUS_MASK	0x000000ff</span>
<span class="cp">#define  AGCSTS_TCZERO_MASK	0x000000c0</span>
<span class="cp">#define  AGCSTS_FIFO_ST_MASK	0x0000003f</span>

<span class="cp">#define AGCSTS_RESET_MBFLAGS	0x08000000</span>
<span class="cp">#define AGCSTS_RESET_P2A_FIFO	0x04000000</span>
<span class="cp">#define AGCSTS_RESET_A2P_FIFO	0x02000000</span>
<span class="cp">#define AGCSTS_RESET_FIFOS	(AGCSTS_RESET_A2P_FIFO | AGCSTS_RESET_P2A_FIFO)</span>

<span class="cp">#define AGCSTS_A2P_TCOUNT	0x00000080</span>
<span class="cp">#define AGCSTS_P2A_TCOUNT	0x00000040</span>

<span class="cp">#define AGCSTS_FS_P2A_EMPTY	0x00000020</span>
<span class="cp">#define AGCSTS_FS_P2A_HALF	0x00000010</span>
<span class="cp">#define AGCSTS_FS_P2A_FULL	0x00000008</span>

<span class="cp">#define AGCSTS_FS_A2P_EMPTY	0x00000004</span>
<span class="cp">#define AGCSTS_FS_A2P_HALF	0x00000002</span>
<span class="cp">#define AGCSTS_FS_A2P_FULL	0x00000001</span>

<span class="cm">/****************************************************************************/</span>
<span class="cm">/* AMCC - Add-on Interrupt Control/Status Register                            */</span>
<span class="cm">/****************************************************************************/</span>

<span class="cp">#define AINT_INT_MASK		0x00ff0000</span>
<span class="cp">#define AINT_SEL_MASK		0x0000ffff</span>
<span class="cp">#define  AINT_IS_ENSEL_MASK	0x00001f1f</span>

<span class="cp">#define AINT_INT_ASSERTED	0x00800000</span>
<span class="cp">#define AINT_BM_ERROR		0x00200000</span>
<span class="cp">#define AINT_BIST_INT		0x00100000</span>

<span class="cp">#define AINT_RT_COMPLETE	0x00080000</span>
<span class="cp">#define AINT_WT_COMPLETE	0x00040000</span>

<span class="cp">#define AINT_OUT_MB_INT		0x00020000</span>
<span class="cp">#define AINT_IN_MB_INT		0x00010000</span>

<span class="cp">#define AINT_READ_COMPL		0x00008000</span>
<span class="cp">#define AINT_WRITE_COMPL	0x00004000</span>

<span class="cp">#define AINT_OMB_ENABLE 	0x00001000</span>
<span class="cp">#define AINT_OMB_SELECT 	0x00000c00</span>
<span class="cp">#define AINT_OMB_BYTE		0x00000300</span>

<span class="cp">#define AINT_IMB_ENABLE 	0x00000010</span>
<span class="cp">#define AINT_IMB_SELECT 	0x0000000c</span>
<span class="cp">#define AINT_IMB_BYTE		0x00000003</span>

<span class="cm">/* these are bits from various different registers, needs cleanup XXX */</span>
<span class="cm">/* Enable Bus Mastering */</span>
<span class="cp">#define EN_A2P_TRANSFERS	0x00000400</span>
<span class="cm">/* FIFO Flag Reset */</span>
<span class="cp">#define RESET_A2P_FLAGS		0x04000000L</span>
<span class="cm">/* FIFO Relative Priority */</span>
<span class="cp">#define A2P_HI_PRIORITY		0x00000100L</span>
<span class="cm">/* Identify Interrupt Sources */</span>
<span class="cp">#define ANY_S593X_INT		0x00800000L</span>
<span class="cp">#define READ_TC_INT		0x00080000L</span>
<span class="cp">#define WRITE_TC_INT		0x00040000L</span>
<span class="cp">#define IN_MB_INT		0x00020000L</span>
<span class="cp">#define MASTER_ABORT_INT	0x00100000L</span>
<span class="cp">#define TARGET_ABORT_INT	0x00200000L</span>
<span class="cp">#define BUS_MASTER_INT		0x00200000L</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
