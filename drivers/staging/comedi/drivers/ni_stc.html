<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › comedi › drivers › ni_stc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>ni_stc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm">    module/ni_stc.h</span>
<span class="cm">    Register descriptions for NI DAQ-STC chip</span>

<span class="cm">    COMEDI - Linux Control and Measurement Device Interface</span>
<span class="cm">    Copyright (C) 1998-9 David A. Schleef &lt;ds@schleef.org&gt;</span>

<span class="cm">    This program is free software; you can redistribute it and/or modify</span>
<span class="cm">    it under the terms of the GNU General Public License as published by</span>
<span class="cm">    the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm">    (at your option) any later version.</span>

<span class="cm">    This program is distributed in the hope that it will be useful,</span>
<span class="cm">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm">    GNU General Public License for more details.</span>

<span class="cm">    You should have received a copy of the GNU General Public License</span>
<span class="cm">    along with this program; if not, write to the Free Software</span>
<span class="cm">    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.</span>

<span class="cm">*/</span>

<span class="cm">/*</span>
<span class="cm">	References:</span>
<span class="cm">	    DAQ-STC Technical Reference Manual</span>
<span class="cm">*/</span>

<span class="cp">#ifndef _COMEDI_NI_STC_H</span>
<span class="cp">#define _COMEDI_NI_STC_H</span>

<span class="cp">#include &quot;ni_tio.h&quot;</span>

<span class="cp">#define _bit15		0x8000</span>
<span class="cp">#define _bit14		0x4000</span>
<span class="cp">#define _bit13		0x2000</span>
<span class="cp">#define _bit12		0x1000</span>
<span class="cp">#define _bit11		0x0800</span>
<span class="cp">#define _bit10		0x0400</span>
<span class="cp">#define _bit9		0x0200</span>
<span class="cp">#define _bit8		0x0100</span>
<span class="cp">#define _bit7		0x0080</span>
<span class="cp">#define _bit6		0x0040</span>
<span class="cp">#define _bit5		0x0020</span>
<span class="cp">#define _bit4		0x0010</span>
<span class="cp">#define _bit3		0x0008</span>
<span class="cp">#define _bit2		0x0004</span>
<span class="cp">#define _bit1		0x0002</span>
<span class="cp">#define _bit0		0x0001</span>

<span class="cp">#define NUM_PFI_OUTPUT_SELECT_REGS 6</span>

<span class="cm">/* Registers in the National Instruments DAQ-STC chip */</span>

<span class="cp">#define Interrupt_A_Ack_Register	2</span>
<span class="cp">#define G0_Gate_Interrupt_Ack			_bit15</span>
<span class="cp">#define G0_TC_Interrupt_Ack			_bit14</span>
<span class="cp">#define AI_Error_Interrupt_Ack			_bit13</span>
<span class="cp">#define AI_STOP_Interrupt_Ack			_bit12</span>
<span class="cp">#define AI_START_Interrupt_Ack			_bit11</span>
<span class="cp">#define AI_START2_Interrupt_Ack			_bit10</span>
<span class="cp">#define AI_START1_Interrupt_Ack			_bit9</span>
<span class="cp">#define AI_SC_TC_Interrupt_Ack			_bit8</span>
<span class="cp">#define AI_SC_TC_Error_Confirm			_bit7</span>
<span class="cp">#define G0_TC_Error_Confirm			_bit6</span>
<span class="cp">#define G0_Gate_Error_Confirm			_bit5</span>

<span class="cp">#define AI_Status_1_Register		2</span>
<span class="cp">#define Interrupt_A_St				0x8000</span>
<span class="cp">#define AI_FIFO_Full_St				0x4000</span>
<span class="cp">#define AI_FIFO_Half_Full_St			0x2000</span>
<span class="cp">#define AI_FIFO_Empty_St			0x1000</span>
<span class="cp">#define AI_Overrun_St				0x0800</span>
<span class="cp">#define AI_Overflow_St				0x0400</span>
<span class="cp">#define AI_SC_TC_Error_St			0x0200</span>
<span class="cp">#define AI_START2_St				0x0100</span>
<span class="cp">#define AI_START1_St				0x0080</span>
<span class="cp">#define AI_SC_TC_St				0x0040</span>
<span class="cp">#define AI_START_St				0x0020</span>
<span class="cp">#define AI_STOP_St				0x0010</span>
<span class="cp">#define G0_TC_St				0x0008</span>
<span class="cp">#define G0_Gate_Interrupt_St			0x0004</span>
<span class="cp">#define AI_FIFO_Request_St			0x0002</span>
<span class="cp">#define Pass_Thru_0_Interrupt_St		0x0001</span>

<span class="cp">#define AI_Status_2_Register		5</span>

<span class="cp">#define Interrupt_B_Ack_Register	3</span>
<span class="k">enum</span> <span class="n">Interrupt_B_Ack_Bits</span> <span class="p">{</span>
	<span class="n">G1_Gate_Error_Confirm</span> <span class="o">=</span> <span class="n">_bit1</span><span class="p">,</span>
	<span class="n">G1_TC_Error_Confirm</span> <span class="o">=</span> <span class="n">_bit2</span><span class="p">,</span>
	<span class="n">AO_BC_TC_Trigger_Error_Confirm</span> <span class="o">=</span> <span class="n">_bit3</span><span class="p">,</span>
	<span class="n">AO_BC_TC_Error_Confirm</span> <span class="o">=</span> <span class="n">_bit4</span><span class="p">,</span>
	<span class="n">AO_UI2_TC_Error_Confrim</span> <span class="o">=</span> <span class="n">_bit5</span><span class="p">,</span>
	<span class="n">AO_UI2_TC_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit6</span><span class="p">,</span>
	<span class="n">AO_UC_TC_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit7</span><span class="p">,</span>
	<span class="n">AO_BC_TC_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit8</span><span class="p">,</span>
	<span class="n">AO_START1_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit9</span><span class="p">,</span>
	<span class="n">AO_UPDATE_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit10</span><span class="p">,</span>
	<span class="n">AO_START_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit11</span><span class="p">,</span>
	<span class="n">AO_STOP_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit12</span><span class="p">,</span>
	<span class="n">AO_Error_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit13</span><span class="p">,</span>
	<span class="n">G1_TC_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit14</span><span class="p">,</span>
	<span class="n">G1_Gate_Interrupt_Ack</span> <span class="o">=</span> <span class="n">_bit15</span>
<span class="p">};</span>

<span class="cp">#define AO_Status_1_Register		3</span>
<span class="cp">#define Interrupt_B_St				_bit15</span>
<span class="cp">#define AO_FIFO_Full_St				_bit14</span>
<span class="cp">#define AO_FIFO_Half_Full_St			_bit13</span>
<span class="cp">#define AO_FIFO_Empty_St			_bit12</span>
<span class="cp">#define AO_BC_TC_Error_St			_bit11</span>
<span class="cp">#define AO_START_St				_bit10</span>
<span class="cp">#define AO_Overrun_St				_bit9</span>
<span class="cp">#define AO_START1_St				_bit8</span>
<span class="cp">#define AO_BC_TC_St				_bit7</span>
<span class="cp">#define AO_UC_TC_St				_bit6</span>
<span class="cp">#define AO_UPDATE_St				_bit5</span>
<span class="cp">#define AO_UI2_TC_St				_bit4</span>
<span class="cp">#define G1_TC_St				_bit3</span>
<span class="cp">#define G1_Gate_Interrupt_St			_bit2</span>
<span class="cp">#define AO_FIFO_Request_St			_bit1</span>
<span class="cp">#define Pass_Thru_1_Interrupt_St		_bit0</span>

<span class="cp">#define AI_Command_2_Register		4</span>
<span class="cp">#define AI_End_On_SC_TC				_bit15</span>
<span class="cp">#define AI_End_On_End_Of_Scan			_bit14</span>
<span class="cp">#define AI_START1_Disable			_bit11</span>
<span class="cp">#define AI_SC_Save_Trace			_bit10</span>
<span class="cp">#define AI_SI_Switch_Load_On_SC_TC		_bit9</span>
<span class="cp">#define AI_SI_Switch_Load_On_STOP		_bit8</span>
<span class="cp">#define AI_SI_Switch_Load_On_TC			_bit7</span>
<span class="cp">#define AI_SC_Switch_Load_On_TC			_bit4</span>
<span class="cp">#define AI_STOP_Pulse				_bit3</span>
<span class="cp">#define AI_START_Pulse				_bit2</span>
<span class="cp">#define AI_START2_Pulse				_bit1</span>
<span class="cp">#define AI_START1_Pulse				_bit0</span>

<span class="cp">#define AO_Command_2_Register		5</span>
<span class="cp">#define AO_End_On_BC_TC(x)			(((x) &amp; 0x3) &lt;&lt; 14)</span>
<span class="cp">#define AO_Start_Stop_Gate_Enable		_bit13</span>
<span class="cp">#define AO_UC_Save_Trace			_bit12</span>
<span class="cp">#define AO_BC_Gate_Enable			_bit11</span>
<span class="cp">#define AO_BC_Save_Trace			_bit10</span>
<span class="cp">#define AO_UI_Switch_Load_On_BC_TC		_bit9</span>
<span class="cp">#define AO_UI_Switch_Load_On_Stop		_bit8</span>
<span class="cp">#define AO_UI_Switch_Load_On_TC			_bit7</span>
<span class="cp">#define AO_UC_Switch_Load_On_BC_TC		_bit6</span>
<span class="cp">#define AO_UC_Switch_Load_On_TC			_bit5</span>
<span class="cp">#define AO_BC_Switch_Load_On_TC			_bit4</span>
<span class="cp">#define AO_Mute_B				_bit3</span>
<span class="cp">#define AO_Mute_A				_bit2</span>
<span class="cp">#define AO_UPDATE2_Pulse			_bit1</span>
<span class="cp">#define AO_START1_Pulse				_bit0</span>

<span class="cp">#define AO_Status_2_Register		6</span>

<span class="cp">#define DIO_Parallel_Input_Register	7</span>

<span class="cp">#define AI_Command_1_Register		8</span>
<span class="cp">#define AI_Analog_Trigger_Reset			_bit14</span>
<span class="cp">#define AI_Disarm				_bit13</span>
<span class="cp">#define AI_SI2_Arm				_bit12</span>
<span class="cp">#define AI_SI2_Load				_bit11</span>
<span class="cp">#define AI_SI_Arm				_bit10</span>
<span class="cp">#define AI_SI_Load				_bit9</span>
<span class="cp">#define AI_DIV_Arm				_bit8</span>
<span class="cp">#define AI_DIV_Load				_bit7</span>
<span class="cp">#define AI_SC_Arm				_bit6</span>
<span class="cp">#define AI_SC_Load				_bit5</span>
<span class="cp">#define AI_SCAN_IN_PROG_Pulse			_bit4</span>
<span class="cp">#define AI_EXTMUX_CLK_Pulse			_bit3</span>
<span class="cp">#define AI_LOCALMUX_CLK_Pulse			_bit2</span>
<span class="cp">#define AI_SC_TC_Pulse			 	_bit1</span>
<span class="cp">#define AI_CONVERT_Pulse			_bit0</span>

<span class="cp">#define AO_Command_1_Register		9</span>
<span class="cp">#define AO_Analog_Trigger_Reset			_bit15</span>
<span class="cp">#define AO_START_Pulse				_bit14</span>
<span class="cp">#define AO_Disarm				_bit13</span>
<span class="cp">#define AO_UI2_Arm_Disarm			_bit12</span>
<span class="cp">#define AO_UI2_Load				_bit11</span>
<span class="cp">#define AO_UI_Arm				_bit10</span>
<span class="cp">#define AO_UI_Load				_bit9</span>
<span class="cp">#define AO_UC_Arm				_bit8</span>
<span class="cp">#define AO_UC_Load				_bit7</span>
<span class="cp">#define AO_BC_Arm				_bit6</span>
<span class="cp">#define AO_BC_Load				_bit5</span>
<span class="cp">#define AO_DAC1_Update_Mode			_bit4</span>
<span class="cp">#define AO_LDAC1_Source_Select			_bit3</span>
<span class="cp">#define AO_DAC0_Update_Mode			_bit2</span>
<span class="cp">#define AO_LDAC0_Source_Select			_bit1</span>
<span class="cp">#define AO_UPDATE_Pulse				_bit0</span>

<span class="cp">#define DIO_Output_Register		10</span>
<span class="cp">#define DIO_Parallel_Data_Out(a)                ((a)&amp;0xff)</span>
<span class="cp">#define DIO_Parallel_Data_Mask                  0xff</span>
<span class="cp">#define DIO_SDOUT                               _bit0</span>
<span class="cp">#define DIO_SDIN                                _bit4</span>
<span class="cp">#define DIO_Serial_Data_Out(a)                  (((a)&amp;0xff)&lt;&lt;8)</span>
<span class="cp">#define DIO_Serial_Data_Mask                    0xff00</span>

<span class="cp">#define DIO_Control_Register		11</span>
<span class="cp">#define DIO_Software_Serial_Control             _bit11</span>
<span class="cp">#define DIO_HW_Serial_Timebase                  _bit10</span>
<span class="cp">#define DIO_HW_Serial_Enable                    _bit9</span>
<span class="cp">#define DIO_HW_Serial_Start                     _bit8</span>
<span class="cp">#define DIO_Pins_Dir(a)                         ((a)&amp;0xff)</span>
<span class="cp">#define DIO_Pins_Dir_Mask                       0xff</span>

<span class="cp">#define AI_Mode_1_Register		12</span>
<span class="cp">#define AI_CONVERT_Source_Select(a)		(((a) &amp; 0x1f) &lt;&lt; 11)</span>
<span class="cp">#define AI_SI_Source_select(a)			(((a) &amp; 0x1f) &lt;&lt; 6)</span>
<span class="cp">#define AI_CONVERT_Source_Polarity		_bit5</span>
<span class="cp">#define AI_SI_Source_Polarity		_bit4</span>
<span class="cp">#define AI_Start_Stop				_bit3</span>
<span class="cp">#define AI_Mode_1_Reserved			_bit2</span>
<span class="cp">#define AI_Continuous				_bit1</span>
<span class="cp">#define AI_Trigger_Once				_bit0</span>

<span class="cp">#define AI_Mode_2_Register		13</span>
<span class="cp">#define AI_SC_Gate_Enable			_bit15</span>
<span class="cp">#define AI_Start_Stop_Gate_Enable		_bit14</span>
<span class="cp">#define AI_Pre_Trigger				_bit13</span>
<span class="cp">#define AI_External_MUX_Present			_bit12</span>
<span class="cp">#define AI_SI2_Initial_Load_Source		_bit9</span>
<span class="cp">#define AI_SI2_Reload_Mode			_bit8</span>
<span class="cp">#define AI_SI_Initial_Load_Source		_bit7</span>
<span class="cp">#define AI_SI_Reload_Mode(a)			(((a) &amp; 0x7)&lt;&lt;4)</span>
<span class="cp">#define AI_SI_Write_Switch			_bit3</span>
<span class="cp">#define AI_SC_Initial_Load_Source		_bit2</span>
<span class="cp">#define AI_SC_Reload_Mode			_bit1</span>
<span class="cp">#define AI_SC_Write_Switch			_bit0</span>

<span class="cp">#define AI_SI_Load_A_Registers		14</span>
<span class="cp">#define AI_SI_Load_B_Registers		16</span>
<span class="cp">#define AI_SC_Load_A_Registers		18</span>
<span class="cp">#define AI_SC_Load_B_Registers		20</span>
<span class="cp">#define AI_SI_Save_Registers		64</span>
<span class="cp">#define AI_SC_Save_Registers		66</span>

<span class="cp">#define AI_SI2_Load_A_Register		23</span>
<span class="cp">#define AI_SI2_Load_B_Register		25</span>

<span class="cp">#define Joint_Status_1_Register         27</span>
<span class="cp">#define DIO_Serial_IO_In_Progress_St            _bit12</span>

<span class="cp">#define DIO_Serial_Input_Register       28</span>
<span class="cp">#define Joint_Status_2_Register         29</span>
<span class="k">enum</span> <span class="n">Joint_Status_2_Bits</span> <span class="p">{</span>
	<span class="n">AO_TMRDACWRs_In_Progress_St</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define AO_Mode_1_Register		38</span>
<span class="cp">#define AO_UPDATE_Source_Select(x)		(((x)&amp;0x1f)&lt;&lt;11)</span>
<span class="cp">#define AO_UI_Source_Select(x)			(((x)&amp;0x1f)&lt;&lt;6)</span>
<span class="cp">#define AO_Multiple_Channels			_bit5</span>
<span class="cp">#define AO_UPDATE_Source_Polarity		_bit4</span>
<span class="cp">#define AO_UI_Source_Polarity			_bit3</span>
<span class="cp">#define AO_UC_Switch_Load_Every_TC		_bit2</span>
<span class="cp">#define AO_Continuous				_bit1</span>
<span class="cp">#define AO_Trigger_Once				_bit0</span>

<span class="cp">#define AO_Mode_2_Register		39</span>
<span class="cp">#define AO_FIFO_Mode_Mask (0x3 &lt;&lt; 14)</span>
<span class="k">enum</span> <span class="n">AO_FIFO_Mode_Bits</span> <span class="p">{</span>
	<span class="n">AO_FIFO_Mode_HF_to_F</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">),</span>
	<span class="n">AO_FIFO_Mode_F</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">),</span>
	<span class="n">AO_FIFO_Mode_HF</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">),</span>
	<span class="n">AO_FIFO_Mode_E</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">),</span>
<span class="p">};</span>
<span class="cp">#define AO_FIFO_Retransmit_Enable		_bit13</span>
<span class="cp">#define AO_START1_Disable			_bit12</span>
<span class="cp">#define AO_UC_Initial_Load_Source		_bit11</span>
<span class="cp">#define AO_UC_Write_Switch			_bit10</span>
<span class="cp">#define AO_UI2_Initial_Load_Source		_bit9</span>
<span class="cp">#define AO_UI2_Reload_Mode			_bit8</span>
<span class="cp">#define AO_UI_Initial_Load_Source		_bit7</span>
<span class="cp">#define AO_UI_Reload_Mode(x)			(((x) &amp; 0x7) &lt;&lt; 4)</span>
<span class="cp">#define AO_UI_Write_Switch			_bit3</span>
<span class="cp">#define AO_BC_Initial_Load_Source		_bit2</span>
<span class="cp">#define AO_BC_Reload_Mode			_bit1</span>
<span class="cp">#define AO_BC_Write_Switch			_bit0</span>

<span class="cp">#define AO_UI_Load_A_Register		40</span>
<span class="cp">#define AO_UI_Load_A_Register_High	40</span>
<span class="cp">#define AO_UI_Load_A_Register_Low	41</span>
<span class="cp">#define AO_UI_Load_B_Register		42</span>
<span class="cp">#define AO_UI_Save_Registers		16</span>
<span class="cp">#define AO_BC_Load_A_Register		44</span>
<span class="cp">#define AO_BC_Load_A_Register_High	44</span>
<span class="cp">#define AO_BC_Load_A_Register_Low	45</span>
<span class="cp">#define AO_BC_Load_B_Register		46</span>
<span class="cp">#define AO_BC_Load_B_Register_High	46</span>
<span class="cp">#define AO_BC_Load_B_Register_Low	47</span>
<span class="cp">#define AO_BC_Save_Registers		18</span>
<span class="cp">#define AO_UC_Load_A_Register		48</span>
<span class="cp">#define AO_UC_Load_A_Register_High	48</span>
<span class="cp">#define AO_UC_Load_A_Register_Low	49</span>
<span class="cp">#define AO_UC_Load_B_Register		50</span>
<span class="cp">#define AO_UC_Save_Registers		20</span>

<span class="cp">#define Clock_and_FOUT_Register		56</span>
<span class="k">enum</span> <span class="n">Clock_and_FOUT_bits</span> <span class="p">{</span>
	<span class="n">FOUT_Enable</span> <span class="o">=</span> <span class="n">_bit15</span><span class="p">,</span>
	<span class="n">FOUT_Timebase_Select</span> <span class="o">=</span> <span class="n">_bit14</span><span class="p">,</span>
	<span class="n">DIO_Serial_Out_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit13</span><span class="p">,</span>
	<span class="n">Slow_Internal_Time_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit12</span><span class="p">,</span>
	<span class="n">Slow_Internal_Timebase</span> <span class="o">=</span> <span class="n">_bit11</span><span class="p">,</span>
	<span class="n">G_Source_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit10</span><span class="p">,</span>
	<span class="n">Clock_To_Board_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit9</span><span class="p">,</span>
	<span class="n">Clock_To_Board</span> <span class="o">=</span> <span class="n">_bit8</span><span class="p">,</span>
	<span class="n">AI_Output_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit7</span><span class="p">,</span>
	<span class="n">AI_Source_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit6</span><span class="p">,</span>
	<span class="n">AO_Output_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit5</span><span class="p">,</span>
	<span class="n">AO_Source_Divide_By_2</span> <span class="o">=</span> <span class="n">_bit4</span><span class="p">,</span>
	<span class="n">FOUT_Divider_mask</span> <span class="o">=</span> <span class="mh">0xf</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">FOUT_Divider</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">divider</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">divider</span> <span class="o">&amp;</span> <span class="n">FOUT_Divider_mask</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define IO_Bidirection_Pin_Register	57</span>
<span class="cp">#define	RTSI_Trig_Direction_Register	58</span>
<span class="k">enum</span> <span class="n">RTSI_Trig_Direction_Bits</span> <span class="p">{</span>
	<span class="n">Drive_RTSI_Clock_Bit</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">Use_RTSI_Clock_Bit</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">RTSI_Output_Bit</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">,</span> <span class="kt">int</span> <span class="n">is_mseries</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="n">max_channel</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">base_bit_shift</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">is_mseries</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">base_bit_shift</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
		<span class="n">max_channel</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">base_bit_shift</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
		<span class="n">max_channel</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&gt;</span> <span class="n">max_channel</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%s: bug, invalid RTSI_channel=%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">channel</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">base_bit_shift</span> <span class="o">+</span> <span class="n">channel</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#define Interrupt_Control_Register	59</span>
<span class="cp">#define Interrupt_B_Enable			_bit15</span>
<span class="cp">#define Interrupt_B_Output_Select(x)		((x)&lt;&lt;12)</span>
<span class="cp">#define Interrupt_A_Enable			_bit11</span>
<span class="cp">#define Interrupt_A_Output_Select(x)		((x)&lt;&lt;8)</span>
<span class="cp">#define Pass_Thru_0_Interrupt_Polarity		_bit3</span>
<span class="cp">#define Pass_Thru_1_Interrupt_Polarity		_bit2</span>
<span class="cp">#define Interrupt_Output_On_3_Pins		_bit1</span>
<span class="cp">#define Interrupt_Output_Polarity		_bit0</span>

<span class="cp">#define AI_Output_Control_Register	60</span>
<span class="cp">#define AI_START_Output_Select			_bit10</span>
<span class="cp">#define AI_SCAN_IN_PROG_Output_Select(x)	(((x) &amp; 0x3) &lt;&lt; 8)</span>
<span class="cp">#define AI_EXTMUX_CLK_Output_Select(x)		(((x) &amp; 0x3) &lt;&lt; 6)</span>
<span class="cp">#define AI_LOCALMUX_CLK_Output_Select(x)	((x)&lt;&lt;4)</span>
<span class="cp">#define AI_SC_TC_Output_Select(x)		((x)&lt;&lt;2)</span>
<span class="k">enum</span> <span class="n">ai_convert_output_selection</span> <span class="p">{</span>
	<span class="n">AI_CONVERT_Output_High_Z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">AI_CONVERT_Output_Ground</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">AI_CONVERT_Output_Enable_Low</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">AI_CONVERT_Output_Enable_High</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="nf">AI_CONVERT_Output_Select</span><span class="p">(</span><span class="k">enum</span> <span class="n">ai_convert_output_selection</span>
					 <span class="n">selection</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">selection</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define AI_START_STOP_Select_Register	62</span>
<span class="cp">#define AI_START_Polarity			_bit15</span>
<span class="cp">#define AI_STOP_Polarity			_bit14</span>
<span class="cp">#define AI_STOP_Sync				_bit13</span>
<span class="cp">#define AI_STOP_Edge				_bit12</span>
<span class="cp">#define AI_STOP_Select(a)			(((a) &amp; 0x1f)&lt;&lt;7)</span>
<span class="cp">#define AI_START_Sync				_bit6</span>
<span class="cp">#define AI_START_Edge				_bit5</span>
<span class="cp">#define AI_START_Select(a)			((a) &amp; 0x1f)</span>

<span class="cp">#define AI_Trigger_Select_Register	63</span>
<span class="cp">#define AI_START1_Polarity			_bit15</span>
<span class="cp">#define AI_START2_Polarity			_bit14</span>
<span class="cp">#define AI_START2_Sync				_bit13</span>
<span class="cp">#define AI_START2_Edge				_bit12</span>
<span class="cp">#define AI_START2_Select(a)			(((a) &amp; 0x1f) &lt;&lt; 7)</span>
<span class="cp">#define AI_START1_Sync				_bit6</span>
<span class="cp">#define AI_START1_Edge				_bit5</span>
<span class="cp">#define AI_START1_Select(a)			((a) &amp; 0x1f)</span>

<span class="cp">#define AI_DIV_Load_A_Register	64</span>

<span class="cp">#define AO_Start_Select_Register	66</span>
<span class="cp">#define AO_UI2_Software_Gate			_bit15</span>
<span class="cp">#define AO_UI2_External_Gate_Polarity		_bit14</span>
<span class="cp">#define AO_START_Polarity			_bit13</span>
<span class="cp">#define AO_AOFREQ_Enable			_bit12</span>
<span class="cp">#define AO_UI2_External_Gate_Select(a)		(((a) &amp; 0x1f) &lt;&lt; 7)</span>
<span class="cp">#define AO_START_Sync				_bit6</span>
<span class="cp">#define AO_START_Edge				_bit5</span>
<span class="cp">#define AO_START_Select(a)			((a) &amp; 0x1f)</span>

<span class="cp">#define AO_Trigger_Select_Register	67</span>
<span class="cp">#define AO_UI2_External_Gate_Enable		_bit15</span>
<span class="cp">#define AO_Delayed_START1			_bit14</span>
<span class="cp">#define AO_START1_Polarity			_bit13</span>
<span class="cp">#define AO_UI2_Source_Polarity			_bit12</span>
<span class="cp">#define AO_UI2_Source_Select(x)			(((x)&amp;0x1f)&lt;&lt;7)</span>
<span class="cp">#define AO_START1_Sync				_bit6</span>
<span class="cp">#define AO_START1_Edge				_bit5</span>
<span class="cp">#define AO_START1_Select(x)			(((x)&amp;0x1f)&lt;&lt;0)</span>

<span class="cp">#define AO_Mode_3_Register		70</span>
<span class="cp">#define AO_UI2_Switch_Load_Next_TC		_bit13</span>
<span class="cp">#define AO_UC_Switch_Load_Every_BC_TC		_bit12</span>
<span class="cp">#define AO_Trigger_Length			_bit11</span>
<span class="cp">#define AO_Stop_On_Overrun_Error		_bit5</span>
<span class="cp">#define AO_Stop_On_BC_TC_Trigger_Error		_bit4</span>
<span class="cp">#define AO_Stop_On_BC_TC_Error			_bit3</span>
<span class="cp">#define AO_Not_An_UPDATE			_bit2</span>
<span class="cp">#define AO_Software_Gate			_bit1</span>
<span class="cp">#define AO_Last_Gate_Disable		_bit0	</span><span class="cm">/* M Series only */</span><span class="cp"></span>

<span class="cp">#define Joint_Reset_Register		72</span>
<span class="cp">#define Software_Reset			_bit11</span>
<span class="cp">#define AO_Configuration_End			_bit9</span>
<span class="cp">#define AI_Configuration_End			_bit8</span>
<span class="cp">#define AO_Configuration_Start			_bit5</span>
<span class="cp">#define AI_Configuration_Start			_bit4</span>
<span class="cp">#define G1_Reset				_bit3</span>
<span class="cp">#define G0_Reset				_bit2</span>
<span class="cp">#define AO_Reset				_bit1</span>
<span class="cp">#define AI_Reset				_bit0</span>

<span class="cp">#define Interrupt_A_Enable_Register	73</span>
<span class="cp">#define Pass_Thru_0_Interrupt_Enable		_bit9</span>
<span class="cp">#define G0_Gate_Interrupt_Enable		_bit8</span>
<span class="cp">#define AI_FIFO_Interrupt_Enable		_bit7</span>
<span class="cp">#define G0_TC_Interrupt_Enable			_bit6</span>
<span class="cp">#define AI_Error_Interrupt_Enable		_bit5</span>
<span class="cp">#define AI_STOP_Interrupt_Enable		_bit4</span>
<span class="cp">#define AI_START_Interrupt_Enable		_bit3</span>
<span class="cp">#define AI_START2_Interrupt_Enable		_bit2</span>
<span class="cp">#define AI_START1_Interrupt_Enable		_bit1</span>
<span class="cp">#define AI_SC_TC_Interrupt_Enable		_bit0</span>

<span class="cp">#define Interrupt_B_Enable_Register	75</span>
<span class="cp">#define Pass_Thru_1_Interrupt_Enable		_bit11</span>
<span class="cp">#define G1_Gate_Interrupt_Enable		_bit10</span>
<span class="cp">#define G1_TC_Interrupt_Enable			_bit9</span>
<span class="cp">#define AO_FIFO_Interrupt_Enable		_bit8</span>
<span class="cp">#define AO_UI2_TC_Interrupt_Enable		_bit7</span>
<span class="cp">#define AO_UC_TC_Interrupt_Enable		_bit6</span>
<span class="cp">#define AO_Error_Interrupt_Enable		_bit5</span>
<span class="cp">#define AO_STOP_Interrupt_Enable		_bit4</span>
<span class="cp">#define AO_START_Interrupt_Enable		_bit3</span>
<span class="cp">#define AO_UPDATE_Interrupt_Enable		_bit2</span>
<span class="cp">#define AO_START1_Interrupt_Enable		_bit1</span>
<span class="cp">#define AO_BC_TC_Interrupt_Enable		_bit0</span>

<span class="cp">#define Second_IRQ_A_Enable_Register	74</span>
<span class="k">enum</span> <span class="n">Second_IRQ_A_Enable_Bits</span> <span class="p">{</span>
	<span class="n">AI_SC_TC_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit0</span><span class="p">,</span>
	<span class="n">AI_START1_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit1</span><span class="p">,</span>
	<span class="n">AI_START2_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit2</span><span class="p">,</span>
	<span class="n">AI_START_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit3</span><span class="p">,</span>
	<span class="n">AI_STOP_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit4</span><span class="p">,</span>
	<span class="n">AI_Error_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit5</span><span class="p">,</span>
	<span class="n">G0_TC_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit6</span><span class="p">,</span>
	<span class="n">AI_FIFO_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit7</span><span class="p">,</span>
	<span class="n">G0_Gate_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit8</span><span class="p">,</span>
	<span class="n">Pass_Thru_0_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit9</span>
<span class="p">};</span>

<span class="cp">#define Second_IRQ_B_Enable_Register	76</span>
<span class="k">enum</span> <span class="n">Second_IRQ_B_Enable_Bits</span> <span class="p">{</span>
	<span class="n">AO_BC_TC_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit0</span><span class="p">,</span>
	<span class="n">AO_START1_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit1</span><span class="p">,</span>
	<span class="n">AO_UPDATE_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit2</span><span class="p">,</span>
	<span class="n">AO_START_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit3</span><span class="p">,</span>
	<span class="n">AO_STOP_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit4</span><span class="p">,</span>
	<span class="n">AO_Error_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit5</span><span class="p">,</span>
	<span class="n">AO_UC_TC_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit6</span><span class="p">,</span>
	<span class="n">AO_UI2_TC_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit7</span><span class="p">,</span>
	<span class="n">AO_FIFO_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit8</span><span class="p">,</span>
	<span class="n">G1_TC_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit9</span><span class="p">,</span>
	<span class="n">G1_Gate_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit10</span><span class="p">,</span>
	<span class="n">Pass_Thru_1_Second_Irq_Enable</span> <span class="o">=</span> <span class="n">_bit11</span>
<span class="p">};</span>

<span class="cp">#define AI_Personal_Register		77</span>
<span class="cp">#define AI_SHIFTIN_Pulse_Width			_bit15</span>
<span class="cp">#define AI_EOC_Polarity				_bit14</span>
<span class="cp">#define AI_SOC_Polarity				_bit13</span>
<span class="cp">#define AI_SHIFTIN_Polarity			_bit12</span>
<span class="cp">#define AI_CONVERT_Pulse_Timebase		_bit11</span>
<span class="cp">#define AI_CONVERT_Pulse_Width			_bit10</span>
<span class="cp">#define AI_CONVERT_Original_Pulse		_bit9</span>
<span class="cp">#define AI_FIFO_Flags_Polarity			_bit8</span>
<span class="cp">#define AI_Overrun_Mode				_bit7</span>
<span class="cp">#define AI_EXTMUX_CLK_Pulse_Width		_bit6</span>
<span class="cp">#define AI_LOCALMUX_CLK_Pulse_Width		_bit5</span>
<span class="cp">#define AI_AIFREQ_Polarity			_bit4</span>

<span class="cp">#define AO_Personal_Register		78</span>
<span class="k">enum</span> <span class="n">AO_Personal_Bits</span> <span class="p">{</span>
	<span class="n">AO_Interval_Buffer_Mode</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">AO_BC_Source_Select</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">AO_UPDATE_Pulse_Width</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">AO_UPDATE_Pulse_Timebase</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">AO_UPDATE_Original_Pulse</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">AO_DMA_PIO_Control</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">,</span>	<span class="cm">/* M Series: reserved */</span>
	<span class="n">AO_AOFREQ_Polarity</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">9</span><span class="p">,</span>	<span class="cm">/* M Series: reserved */</span>
	<span class="n">AO_FIFO_Enable</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">AO_FIFO_Flags_Polarity</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">11</span><span class="p">,</span>	<span class="cm">/* M Series: reserved */</span>
	<span class="n">AO_TMRDACWR_Pulse_Width</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">AO_Fast_CPU</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>	<span class="cm">/* M Series: reserved */</span>
	<span class="n">AO_Number_Of_DAC_Packages</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">14</span><span class="p">,</span>	<span class="cm">/*  1 for &quot;single&quot; mode, 0 for &quot;dual&quot; */</span>
	<span class="n">AO_Multiple_DACS_Per_Package</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">15</span>	<span class="cm">/*  m-series only */</span>
<span class="p">};</span>
<span class="cp">#define	RTSI_Trig_A_Output_Register	79</span>
<span class="cp">#define	RTSI_Trig_B_Output_Register	80</span>
<span class="k">enum</span> <span class="n">RTSI_Trig_B_Output_Bits</span> <span class="p">{</span>
	<span class="n">RTSI_Sub_Selection_1_Bit</span> <span class="o">=</span> <span class="mh">0x8000</span>	<span class="cm">/*  not for m-series */</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">RTSI_Trig_Output_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">rtsi_channel</span><span class="p">,</span>
					     <span class="kt">unsigned</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">source</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">rtsi_channel</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">RTSI_Trig_Output_Mask</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">rtsi_channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mh">0xf</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">rtsi_channel</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* inverse to RTSI_Trig_Output_Bits() */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">RTSI_Trig_Output_Source</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">rtsi_channel</span><span class="p">,</span>
					       <span class="kt">unsigned</span> <span class="n">bits</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">bits</span> <span class="o">&gt;&gt;</span> <span class="p">((</span><span class="n">rtsi_channel</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define	RTSI_Board_Register		81</span>
<span class="cp">#define Write_Strobe_0_Register		82</span>
<span class="cp">#define Write_Strobe_1_Register		83</span>
<span class="cp">#define Write_Strobe_2_Register		84</span>
<span class="cp">#define Write_Strobe_3_Register		85</span>

<span class="cp">#define AO_Output_Control_Register	86</span>
<span class="cp">#define AO_External_Gate_Enable			_bit15</span>
<span class="cp">#define AO_External_Gate_Select(x)		(((x)&amp;0x1f)&lt;&lt;10)</span>
<span class="cp">#define AO_Number_Of_Channels(x)		(((x)&amp;0xf)&lt;&lt;6)</span>
<span class="cp">#define AO_UPDATE2_Output_Select(x)		(((x)&amp;0x3)&lt;&lt;4)</span>
<span class="cp">#define AO_External_Gate_Polarity		_bit3</span>
<span class="cp">#define AO_UPDATE2_Output_Toggle		_bit2</span>
<span class="k">enum</span> <span class="n">ao_update_output_selection</span> <span class="p">{</span>
	<span class="n">AO_Update_Output_High_Z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">AO_Update_Output_Ground</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">AO_Update_Output_Enable_Low</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">AO_Update_Output_Enable_High</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="nf">AO_UPDATE_Output_Select</span><span class="p">(</span><span class="k">enum</span> <span class="n">ao_update_output_selection</span>
					<span class="n">selection</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">selection</span> <span class="o">&amp;</span> <span class="mh">0x3</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define AI_Mode_3_Register		87</span>
<span class="cp">#define AI_Trigger_Length			_bit15</span>
<span class="cp">#define AI_Delay_START				_bit14</span>
<span class="cp">#define AI_Software_Gate			_bit13</span>
<span class="cp">#define AI_SI_Special_Trigger_Delay		_bit12</span>
<span class="cp">#define AI_SI2_Source_Select			_bit11</span>
<span class="cp">#define AI_Delayed_START2			_bit10</span>
<span class="cp">#define AI_Delayed_START1			_bit9</span>
<span class="cp">#define AI_External_Gate_Mode			_bit8</span>
<span class="cp">#define AI_FIFO_Mode_HF_to_E			(3&lt;&lt;6)</span>
<span class="cp">#define AI_FIFO_Mode_F				(2&lt;&lt;6)</span>
<span class="cp">#define AI_FIFO_Mode_HF				(1&lt;&lt;6)</span>
<span class="cp">#define AI_FIFO_Mode_NE				(0&lt;&lt;6)</span>
<span class="cp">#define AI_External_Gate_Polarity		_bit5</span>
<span class="cp">#define AI_External_Gate_Select(a)		((a) &amp; 0x1f)</span>

<span class="cp">#define G_Autoincrement_Register(a)	(68+(a))</span>
<span class="cp">#define G_Command_Register(a)		(6+(a))</span>
<span class="cp">#define G_HW_Save_Register(a)		(8+(a)*2)</span>
<span class="cp">#define G_HW_Save_Register_High(a)	(8+(a)*2)</span>
<span class="cp">#define G_HW_Save_Register_Low(a)	(9+(a)*2)</span>
<span class="cp">#define G_Input_Select_Register(a)	(36+(a))</span>
<span class="cp">#define G_Load_A_Register(a)		(28+(a)*4)</span>
<span class="cp">#define G_Load_A_Register_High(a)	(28+(a)*4)</span>
<span class="cp">#define G_Load_A_Register_Low(a)	(29+(a)*4)</span>
<span class="cp">#define G_Load_B_Register(a)		(30+(a)*4)</span>
<span class="cp">#define G_Load_B_Register_High(a)	(30+(a)*4)</span>
<span class="cp">#define G_Load_B_Register_Low(a)	(31+(a)*4)</span>
<span class="cp">#define G_Mode_Register(a)		(26+(a))</span>
<span class="cp">#define G_Save_Register(a)		(12+(a)*2)</span>
<span class="cp">#define G_Save_Register_High(a)		(12+(a)*2)</span>
<span class="cp">#define G_Save_Register_Low(a)		(13+(a)*2)</span>
<span class="cp">#define G_Status_Register		4</span>
<span class="cp">#define Analog_Trigger_Etc_Register	61</span>

<span class="cm">/* command register */</span>
<span class="cp">#define G_Disarm_Copy			_bit15	</span><span class="cm">/* strobe */</span><span class="cp"></span>
<span class="cp">#define G_Save_Trace_Copy		_bit14</span>
<span class="cp">#define G_Arm_Copy			_bit13	</span><span class="cm">/* strobe */</span><span class="cp"></span>
<span class="cp">#define G_Bank_Switch_Start		_bit10	</span><span class="cm">/* strobe */</span><span class="cp"></span>
<span class="cp">#define G_Little_Big_Endian		_bit9</span>
<span class="cp">#define G_Synchronized_Gate		_bit8</span>
<span class="cp">#define G_Write_Switch			_bit7</span>
<span class="cp">#define G_Up_Down(a)			(((a)&amp;0x03)&lt;&lt;5)</span>
<span class="cp">#define G_Disarm			_bit4	</span><span class="cm">/* strobe */</span><span class="cp"></span>
<span class="cp">#define G_Analog_Trigger_Reset		_bit3	</span><span class="cm">/* strobe */</span><span class="cp"></span>
<span class="cp">#define G_Save_Trace			_bit1</span>
<span class="cp">#define G_Arm				_bit0	</span><span class="cm">/* strobe */</span><span class="cp"></span>

<span class="cm">/*channel agnostic names for the command register #defines */</span>
<span class="cp">#define G_Bank_Switch_Enable		_bit12</span>
<span class="cp">#define G_Bank_Switch_Mode		_bit11</span>
<span class="cp">#define G_Load				_bit2	</span><span class="cm">/* strobe */</span><span class="cp"></span>

<span class="cm">/* input select register */</span>
<span class="cp">#define G_Gate_Select(a)		(((a)&amp;0x1f)&lt;&lt;7)</span>
<span class="cp">#define G_Source_Select(a)		(((a)&amp;0x1f)&lt;&lt;2)</span>
<span class="cp">#define G_Write_Acknowledges_Irq	_bit1</span>
<span class="cp">#define G_Read_Acknowledges_Irq		_bit0</span>

<span class="cm">/* same input select register, but with channel agnostic names */</span>
<span class="cp">#define G_Source_Polarity		_bit15</span>
<span class="cp">#define G_Output_Polarity		_bit14</span>
<span class="cp">#define G_OR_Gate			_bit13</span>
<span class="cp">#define G_Gate_Select_Load_Source	_bit12</span>

<span class="cm">/* mode register */</span>
<span class="cp">#define G_Loading_On_TC			_bit12</span>
<span class="cp">#define G_Output_Mode(a)		(((a)&amp;0x03)&lt;&lt;8)</span>
<span class="cp">#define G_Trigger_Mode_For_Edge_Gate(a)	(((a)&amp;0x03)&lt;&lt;3)</span>
<span class="cp">#define G_Gating_Mode(a)		(((a)&amp;0x03)&lt;&lt;0)</span>

<span class="cm">/* same input mode register, but with channel agnostic names */</span>
<span class="cp">#define G_Load_Source_Select		_bit7</span>
<span class="cp">#define G_Reload_Source_Switching	_bit15</span>
<span class="cp">#define G_Loading_On_Gate		_bit14</span>
<span class="cp">#define G_Gate_Polarity 		_bit13</span>

<span class="cp">#define G_Counting_Once(a)		(((a)&amp;0x03)&lt;&lt;10)</span>
<span class="cp">#define G_Stop_Mode(a)			(((a)&amp;0x03)&lt;&lt;5)</span>
<span class="cp">#define G_Gate_On_Both_Edges		_bit2</span>

<span class="cm">/* G_Status_Register */</span>
<span class="cp">#define G1_Gate_Error_St		_bit15</span>
<span class="cp">#define G0_Gate_Error_St		_bit14</span>
<span class="cp">#define G1_TC_Error_St			_bit13</span>
<span class="cp">#define G0_TC_Error_St			_bit12</span>
<span class="cp">#define G1_No_Load_Between_Gates_St	_bit11</span>
<span class="cp">#define G0_No_Load_Between_Gates_St	_bit10</span>
<span class="cp">#define G1_Armed_St			_bit9</span>
<span class="cp">#define G0_Armed_St			_bit8</span>
<span class="cp">#define G1_Stale_Data_St		_bit7</span>
<span class="cp">#define G0_Stale_Data_St		_bit6</span>
<span class="cp">#define G1_Next_Load_Source_St		_bit5</span>
<span class="cp">#define G0_Next_Load_Source_St		_bit4</span>
<span class="cp">#define G1_Counting_St			_bit3</span>
<span class="cp">#define G0_Counting_St			_bit2</span>
<span class="cp">#define G1_Save_St			_bit1</span>
<span class="cp">#define G0_Save_St			_bit0</span>

<span class="cm">/* general purpose counter timer */</span>
<span class="cp">#define G_Autoincrement(a)              ((a)&lt;&lt;0)</span>

<span class="cm">/*Analog_Trigger_Etc_Register*/</span>
<span class="cp">#define Analog_Trigger_Mode(x) ((x) &amp; 0x7)</span>
<span class="cp">#define Analog_Trigger_Enable _bit3</span>
<span class="cp">#define Analog_Trigger_Drive _bit4</span>
<span class="cp">#define GPFO_1_Output_Select		_bit7</span>
<span class="cp">#define GPFO_0_Output_Select(a)		((a)&lt;&lt;11)</span>
<span class="cp">#define GPFO_0_Output_Enable		_bit14</span>
<span class="cp">#define GPFO_1_Output_Enable		_bit15</span>

<span class="cm">/* Additional windowed registers unique to E series */</span>

<span class="cm">/* 16 bit registers shadowed from DAQ-STC */</span>
<span class="cp">#define Window_Address			0x00</span>
<span class="cp">#define Window_Data			0x02</span>

<span class="cp">#define Configuration_Memory_Clear	82</span>
<span class="cp">#define ADC_FIFO_Clear			83</span>
<span class="cp">#define DAC_FIFO_Clear			84</span>

<span class="cm">/* i/o port offsets */</span>

<span class="cm">/* 8 bit registers */</span>
<span class="cp">#define XXX_Status			0x01</span>
<span class="k">enum</span> <span class="n">XXX_Status_Bits</span> <span class="p">{</span>
	<span class="n">PROMOUT</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">AI_FIFO_LOWER_NOT_EMPTY</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define Serial_Command			0x0d</span>
<span class="cp">#define Misc_Command			0x0f</span>
<span class="cp">#define Port_A				0x19</span>
<span class="cp">#define Port_B				0x1b</span>
<span class="cp">#define Port_C				0x1d</span>
<span class="cp">#define Configuration			0x1f</span>
<span class="cp">#define Strobes				0x01</span>
<span class="cp">#define Channel_A_Mode			0x03</span>
<span class="cp">#define Channel_B_Mode			0x05</span>
<span class="cp">#define Channel_C_Mode			0x07</span>
<span class="cp">#define AI_AO_Select			0x09</span>
<span class="k">enum</span> <span class="n">AI_AO_Select_Bits</span> <span class="p">{</span>
	<span class="n">AI_DMA_Select_Shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">AI_DMA_Select_Mask</span> <span class="o">=</span> <span class="mh">0xf</span><span class="p">,</span>
	<span class="n">AO_DMA_Select_Shift</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">AO_DMA_Select_Mask</span> <span class="o">=</span> <span class="mh">0xf</span> <span class="o">&lt;&lt;</span> <span class="n">AO_DMA_Select_Shift</span>
<span class="p">};</span>
<span class="cp">#define G0_G1_Select			0x0b</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">ni_stc_dma_channel_select_bitfield</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">channel</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span>
		<span class="k">return</span> <span class="mh">0x3</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
		<span class="k">return</span> <span class="mh">0x5</span><span class="p">;</span>
	<span class="n">BUG</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">GPCT_DMA_Select_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">gpct_index</span><span class="p">,</span>
					    <span class="kt">unsigned</span> <span class="n">mite_channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BUG_ON</span><span class="p">(</span><span class="n">gpct_index</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ni_stc_dma_channel_select_bitfield</span><span class="p">(</span><span class="n">mite_channel</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span>
								    <span class="n">gpct_index</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">GPCT_DMA_Select_Mask</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">gpct_index</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BUG_ON</span><span class="p">(</span><span class="n">gpct_index</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">return</span> <span class="mh">0xf</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">gpct_index</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* 16 bit registers */</span>

<span class="cp">#define Configuration_Memory_Low	0x10</span>
<span class="k">enum</span> <span class="n">Configuration_Memory_Low_Bits</span> <span class="p">{</span>
	<span class="n">AI_DITHER</span> <span class="o">=</span> <span class="mh">0x200</span><span class="p">,</span>
	<span class="n">AI_LAST_CHANNEL</span> <span class="o">=</span> <span class="mh">0x8000</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define Configuration_Memory_High	0x12</span>
<span class="k">enum</span> <span class="n">Configuration_Memory_High_Bits</span> <span class="p">{</span>
	<span class="n">AI_AC_COUPLE</span> <span class="o">=</span> <span class="mh">0x800</span><span class="p">,</span>
	<span class="n">AI_DIFFERENTIAL</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
	<span class="n">AI_COMMON</span> <span class="o">=</span> <span class="mh">0x2000</span><span class="p">,</span>
	<span class="n">AI_GROUND</span> <span class="o">=</span> <span class="mh">0x3000</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">AI_CONFIG_CHANNEL</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">channel</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define ADC_FIFO_Data_Register		0x1c</span>

<span class="cp">#define AO_Configuration		0x16</span>
<span class="cp">#define AO_Bipolar		_bit0</span>
<span class="cp">#define AO_Deglitch		_bit1</span>
<span class="cp">#define AO_Ext_Ref		_bit2</span>
<span class="cp">#define AO_Ground_Ref		_bit3</span>
<span class="cp">#define AO_Channel(x)		((x) &lt;&lt; 8)</span>

<span class="cp">#define DAC_FIFO_Data			0x1e</span>
<span class="cp">#define DAC0_Direct_Data		0x18</span>
<span class="cp">#define DAC1_Direct_Data		0x1a</span>

<span class="cm">/* 611x registers (these boards differ from the e-series) */</span>

<span class="cp">#define Magic_611x			0x19	</span><span class="cm">/* w8 (new) */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_Select_611x	0x1a	</span><span class="cm">/* w16 (new) */</span><span class="cp"></span>
<span class="cp">#define ADC_FIFO_Data_611x		0x1c	</span><span class="cm">/* r32 (incompatible) */</span><span class="cp"></span>
<span class="cp">#define AI_FIFO_Offset_Load_611x	0x05	</span><span class="cm">/* r8 (new) */</span><span class="cp"></span>
<span class="cp">#define DAC_FIFO_Data_611x		0x14	</span><span class="cm">/* w32 (incompatible) */</span><span class="cp"></span>
<span class="cp">#define Cal_Gain_Select_611x		0x05	</span><span class="cm">/* w8 (new) */</span><span class="cp"></span>

<span class="cp">#define AO_Window_Address_611x		0x18</span>
<span class="cp">#define AO_Window_Data_611x		0x1e</span>

<span class="cm">/* 6143 registers */</span>
<span class="cp">#define Magic_6143			0x19	</span><span class="cm">/* w8 */</span><span class="cp"></span>
<span class="cp">#define G0G1_DMA_Select_6143		0x0B	</span><span class="cm">/* w8 */</span><span class="cp"></span>
<span class="cp">#define PipelineDelay_6143		0x1f	</span><span class="cm">/* w8 */</span><span class="cp"></span>
<span class="cp">#define EOC_Set_6143			0x1D	</span><span class="cm">/* w8 */</span><span class="cp"></span>
<span class="cp">#define AIDMA_Select_6143		0x09	</span><span class="cm">/* w8 */</span><span class="cp"></span>
<span class="cp">#define AIFIFO_Data_6143		0x8C	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define AIFIFO_Flag_6143		0x84	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define AIFIFO_Control_6143		0x88	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define AIFIFO_Status_6143		0x88	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define AIFIFO_DMAThreshold_6143	0x90	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define AIFIFO_Words_Available_6143	0x94	</span><span class="cm">/* w32 */</span><span class="cp"></span>

<span class="cp">#define Calibration_Channel_6143	0x42	</span><span class="cm">/* w16 */</span><span class="cp"></span>
<span class="cp">#define Calibration_LowTime_6143	0x20	</span><span class="cm">/* w16 */</span><span class="cp"></span>
<span class="cp">#define Calibration_HighTime_6143	0x22	</span><span class="cm">/* w16 */</span><span class="cp"></span>
<span class="cp">#define Relay_Counter_Load_Val__6143	0x4C	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define Signature_6143			0x50	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define Release_Date_6143		0x54	</span><span class="cm">/* w32 */</span><span class="cp"></span>
<span class="cp">#define Release_Oldest_Date_6143	0x58	</span><span class="cm">/* w32 */</span><span class="cp"></span>

<span class="cp">#define Calibration_Channel_6143_RelayOn	0x8000	</span><span class="cm">/* Calibration relay switch On */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_6143_RelayOff	0x4000	</span><span class="cm">/* Calibration relay switch Off */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_Gnd_Gnd	0x00	</span><span class="cm">/* Offset Calibration */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_2v5_Gnd	0x02	</span><span class="cm">/* 2.5V Reference */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_Pwm_Gnd	0x05	</span><span class="cm">/* +/- 5V Self Cal */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_2v5_Pwm	0x0a	</span><span class="cm">/* PWM Calibration */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_Pwm_Pwm	0x0d	</span><span class="cm">/* CMRR */</span><span class="cp"></span>
<span class="cp">#define Calibration_Channel_Gnd_Pwm	0x0e	</span><span class="cm">/* PWM Calibration */</span><span class="cp"></span>

<span class="cm">/* 671x, 611x registers */</span>

<span class="cm">/* 671xi, 611x windowed ao registers */</span>
<span class="k">enum</span> <span class="n">windowed_regs_67xx_61xx</span> <span class="p">{</span>
	<span class="n">AO_Immediate_671x</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">,</span>	<span class="cm">/* W 16 */</span>
	<span class="n">AO_Timed_611x</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>	<span class="cm">/* W 16 */</span>
	<span class="n">AO_FIFO_Offset_Load_611x</span> <span class="o">=</span> <span class="mh">0x13</span><span class="p">,</span>	<span class="cm">/* W32 */</span>
	<span class="n">AO_Later_Single_Point_Updates</span> <span class="o">=</span> <span class="mh">0x14</span><span class="p">,</span>	<span class="cm">/* W 16 */</span>
	<span class="n">AO_Waveform_Generation_611x</span> <span class="o">=</span> <span class="mh">0x15</span><span class="p">,</span>	<span class="cm">/* W 16 */</span>
	<span class="n">AO_Misc_611x</span> <span class="o">=</span> <span class="mh">0x16</span><span class="p">,</span>	<span class="cm">/* W 16 */</span>
	<span class="n">AO_Calibration_Channel_Select_67xx</span> <span class="o">=</span> <span class="mh">0x17</span><span class="p">,</span>	<span class="cm">/* W 16 */</span>
	<span class="n">AO_Configuration_2_67xx</span> <span class="o">=</span> <span class="mh">0x18</span><span class="p">,</span>	<span class="cm">/* W 16 */</span>
	<span class="n">CAL_ADC_Command_67xx</span> <span class="o">=</span> <span class="mh">0x19</span><span class="p">,</span>	<span class="cm">/* W 8 */</span>
	<span class="n">CAL_ADC_Status_67xx</span> <span class="o">=</span> <span class="mh">0x1a</span><span class="p">,</span>	<span class="cm">/* R 8 */</span>
	<span class="n">CAL_ADC_Data_67xx</span> <span class="o">=</span> <span class="mh">0x1b</span><span class="p">,</span>	<span class="cm">/* R 16 */</span>
	<span class="n">CAL_ADC_Config_Data_High_Word_67xx</span> <span class="o">=</span> <span class="mh">0x1c</span><span class="p">,</span>	<span class="cm">/* RW 16 */</span>
	<span class="n">CAL_ADC_Config_Data_Low_Word_67xx</span> <span class="o">=</span> <span class="mh">0x1d</span><span class="p">,</span>	<span class="cm">/* RW 16 */</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">DACx_Direct_Data_671x</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">channel</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">AO_Misc_611x_Bits</span> <span class="p">{</span>
	<span class="n">CLEAR_WG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="n">cs5529_configuration_bits</span> <span class="p">{</span>
	<span class="n">CSCFG_CAL_CONTROL_MASK</span> <span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">CSCFG_SELF_CAL_OFFSET</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">CSCFG_SELF_CAL_GAIN</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">CSCFG_SELF_CAL_OFFSET_GAIN</span> <span class="o">=</span> <span class="mh">0x3</span><span class="p">,</span>
	<span class="n">CSCFG_SYSTEM_CAL_OFFSET</span> <span class="o">=</span> <span class="mh">0x5</span><span class="p">,</span>
	<span class="n">CSCFG_SYSTEM_CAL_GAIN</span> <span class="o">=</span> <span class="mh">0x6</span><span class="p">,</span>
	<span class="n">CSCFG_DONE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">CSCFG_POWER_SAVE_SELECT</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">CSCFG_PORT_MODE</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">CSCFG_RESET_VALID</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">CSCFG_RESET</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">CSCFG_UNIPOLAR</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_2180_CYCLES</span> <span class="o">=</span> <span class="mh">0x0</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_1092_CYCLES</span> <span class="o">=</span> <span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_532_CYCLES</span> <span class="o">=</span> <span class="mh">0x2</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_388_CYCLES</span> <span class="o">=</span> <span class="mh">0x3</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_324_CYCLES</span> <span class="o">=</span> <span class="mh">0x4</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_17444_CYCLES</span> <span class="o">=</span> <span class="mh">0x5</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_8724_CYCLES</span> <span class="o">=</span> <span class="mh">0x6</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_4364_CYCLES</span> <span class="o">=</span> <span class="mh">0x7</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_WORD_RATE_MASK</span> <span class="o">=</span> <span class="mh">0x7</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">CSCFG_LOW_POWER</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">CS5529_CONFIG_DOUT</span><span class="p">(</span><span class="kt">int</span> <span class="n">output</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">18</span> <span class="o">+</span> <span class="n">output</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">CS5529_CONFIG_AOUT</span><span class="p">(</span><span class="kt">int</span> <span class="n">output</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">22</span> <span class="o">+</span> <span class="n">output</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">cs5529_command_bits</span> <span class="p">{</span>
	<span class="n">CSCMD_POWER_SAVE</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">CSCMD_REGISTER_SELECT_MASK</span> <span class="o">=</span> <span class="mh">0xe</span><span class="p">,</span>
	<span class="n">CSCMD_OFFSET_REGISTER</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">CSCMD_GAIN_REGISTER</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">CSCMD_CONFIG_REGISTER</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">CSCMD_READ</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">CSCMD_CONTINUOUS_CONVERSIONS</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>
	<span class="n">CSCMD_SINGLE_CONVERSION</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="n">CSCMD_COMMAND</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="n">cs5529_status_bits</span> <span class="p">{</span>
	<span class="n">CSS_ADC_BUSY</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">CSS_OSC_DETECT</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>	<span class="cm">/* indicates adc error */</span>
	<span class="n">CSS_OVERRANGE</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define SerDacLd(x)			(0x08&lt;&lt;(x))</span>

<span class="cm">/*</span>
<span class="cm">	This is stuff unique to the NI E series drivers,</span>
<span class="cm">	but I thought I&#39;d put it here anyway.</span>
<span class="cm">*/</span>

<span class="k">enum</span> <span class="p">{</span> <span class="n">ai_gain_16</span> <span class="o">=</span>
	    <span class="mi">0</span><span class="p">,</span> <span class="n">ai_gain_8</span><span class="p">,</span> <span class="n">ai_gain_14</span><span class="p">,</span> <span class="n">ai_gain_4</span><span class="p">,</span> <span class="n">ai_gain_611x</span><span class="p">,</span> <span class="n">ai_gain_622x</span><span class="p">,</span>
	<span class="n">ai_gain_628x</span><span class="p">,</span> <span class="n">ai_gain_6143</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="n">caldac_enum</span> <span class="p">{</span> <span class="n">caldac_none</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">mb88341</span><span class="p">,</span> <span class="n">dac8800</span><span class="p">,</span> <span class="n">dac8043</span><span class="p">,</span> <span class="n">ad8522</span><span class="p">,</span>
	<span class="n">ad8804</span><span class="p">,</span> <span class="n">ad8842</span><span class="p">,</span> <span class="n">ad8804_debug</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="n">ni_reg_type</span> <span class="p">{</span>
	<span class="n">ni_reg_normal</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">ni_reg_611x</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">ni_reg_6711</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">ni_reg_6713</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">ni_reg_67xx_mask</span> <span class="o">=</span> <span class="mh">0x6</span><span class="p">,</span>
	<span class="n">ni_reg_6xxx_mask</span> <span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">ni_reg_622x</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">ni_reg_625x</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">ni_reg_628x</span> <span class="o">=</span> <span class="mh">0x18</span><span class="p">,</span>
	<span class="n">ni_reg_m_series_mask</span> <span class="o">=</span> <span class="mh">0x18</span><span class="p">,</span>
	<span class="n">ni_reg_6143</span> <span class="o">=</span> <span class="mh">0x20</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">comedi_lrange</span> <span class="n">range_ni_E_ao_ext</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">m_series_register_offsets</span> <span class="p">{</span>
	<span class="n">M_Offset_CDIO_DMA_Select</span> <span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_SCXI_Status</span> <span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AI_AO_Select</span> <span class="o">=</span> <span class="mh">0x9</span><span class="p">,</span>	<span class="cm">/*  write, same offset as e-series */</span>
	<span class="n">M_Offset_SCXI_Serial_Data_In</span> <span class="o">=</span> <span class="mh">0x9</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_G0_G1_Select</span> <span class="o">=</span> <span class="mh">0xb</span><span class="p">,</span>	<span class="cm">/*  write, same offset as e-series */</span>
	<span class="n">M_Offset_Misc_Command</span> <span class="o">=</span> <span class="mh">0xf</span><span class="p">,</span>
	<span class="n">M_Offset_SCXI_Serial_Data_Out</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">,</span>
	<span class="n">M_Offset_SCXI_Control</span> <span class="o">=</span> <span class="mh">0x13</span><span class="p">,</span>
	<span class="n">M_Offset_SCXI_Output_Enable</span> <span class="o">=</span> <span class="mh">0x15</span><span class="p">,</span>
	<span class="n">M_Offset_AI_FIFO_Data</span> <span class="o">=</span> <span class="mh">0x1c</span><span class="p">,</span>
	<span class="n">M_Offset_Static_Digital_Output</span> <span class="o">=</span> <span class="mh">0x24</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_Static_Digital_Input</span> <span class="o">=</span> <span class="mh">0x24</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_DIO_Direction</span> <span class="o">=</span> <span class="mh">0x28</span><span class="p">,</span>
	<span class="n">M_Offset_Cal_PWM</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Config_FIFO_Data</span> <span class="o">=</span> <span class="mh">0x5e</span><span class="p">,</span>
	<span class="n">M_Offset_Interrupt_C_Enable</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_Interrupt_C_Status</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_Analog_Trigger_Control</span> <span class="o">=</span> <span class="mh">0x8c</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Serial_Interrupt_Enable</span> <span class="o">=</span> <span class="mh">0xa0</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Serial_Interrupt_Ack</span> <span class="o">=</span> <span class="mh">0xa1</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AO_Serial_Interrupt_Status</span> <span class="o">=</span> <span class="mh">0xa1</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AO_Calibration</span> <span class="o">=</span> <span class="mh">0xa3</span><span class="p">,</span>
	<span class="n">M_Offset_AO_FIFO_Data</span> <span class="o">=</span> <span class="mh">0xa4</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_Filter</span> <span class="o">=</span> <span class="mh">0xb0</span><span class="p">,</span>
	<span class="n">M_Offset_RTSI_Filter</span> <span class="o">=</span> <span class="mh">0xb4</span><span class="p">,</span>
	<span class="n">M_Offset_SCXI_Legacy_Compatibility</span> <span class="o">=</span> <span class="mh">0xbc</span><span class="p">,</span>
	<span class="n">M_Offset_Interrupt_A_Ack</span> <span class="o">=</span> <span class="mh">0x104</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AI_Status_1</span> <span class="o">=</span> <span class="mh">0x104</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_Interrupt_B_Ack</span> <span class="o">=</span> <span class="mh">0x106</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AO_Status_1</span> <span class="o">=</span> <span class="mh">0x106</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AI_Command_2</span> <span class="o">=</span> <span class="mh">0x108</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_G01_Status</span> <span class="o">=</span> <span class="mh">0x108</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AO_Command_2</span> <span class="o">=</span> <span class="mh">0x10a</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Status_2</span> <span class="o">=</span> <span class="mh">0x10c</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_G0_Command</span> <span class="o">=</span> <span class="mh">0x10c</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_G1_Command</span> <span class="o">=</span> <span class="mh">0x10e</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_G0_HW_Save</span> <span class="o">=</span> <span class="mh">0x110</span><span class="p">,</span>
	<span class="n">M_Offset_G0_HW_Save_High</span> <span class="o">=</span> <span class="mh">0x110</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Command_1</span> <span class="o">=</span> <span class="mh">0x110</span><span class="p">,</span>
	<span class="n">M_Offset_G0_HW_Save_Low</span> <span class="o">=</span> <span class="mh">0x112</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Command_1</span> <span class="o">=</span> <span class="mh">0x112</span><span class="p">,</span>
	<span class="n">M_Offset_G1_HW_Save</span> <span class="o">=</span> <span class="mh">0x114</span><span class="p">,</span>
	<span class="n">M_Offset_G1_HW_Save_High</span> <span class="o">=</span> <span class="mh">0x114</span><span class="p">,</span>
	<span class="n">M_Offset_G1_HW_Save_Low</span> <span class="o">=</span> <span class="mh">0x116</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Mode_1</span> <span class="o">=</span> <span class="mh">0x118</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Save</span> <span class="o">=</span> <span class="mh">0x118</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Save_High</span> <span class="o">=</span> <span class="mh">0x118</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Mode_2</span> <span class="o">=</span> <span class="mh">0x11a</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Save_Low</span> <span class="o">=</span> <span class="mh">0x11a</span><span class="p">,</span>
	<span class="n">M_Offset_AI_SI_Load_A</span> <span class="o">=</span> <span class="mh">0x11c</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Save</span> <span class="o">=</span> <span class="mh">0x11c</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Save_High</span> <span class="o">=</span> <span class="mh">0x11c</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Save_Low</span> <span class="o">=</span> <span class="mh">0x11e</span><span class="p">,</span>
	<span class="n">M_Offset_AI_SI_Load_B</span> <span class="o">=</span> <span class="mh">0x120</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AO_UI_Save</span> <span class="o">=</span> <span class="mh">0x120</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AI_SC_Load_A</span> <span class="o">=</span> <span class="mh">0x124</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AO_BC_Save</span> <span class="o">=</span> <span class="mh">0x124</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AI_SC_Load_B</span> <span class="o">=</span> <span class="mh">0x128</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AO_UC_Save</span> <span class="o">=</span> <span class="mh">0x128</span><span class="p">,</span>	<span class="cm">/* read */</span>
	<span class="n">M_Offset_AI_SI2_Load_A</span> <span class="o">=</span> <span class="mh">0x12c</span><span class="p">,</span>
	<span class="n">M_Offset_AI_SI2_Load_B</span> <span class="o">=</span> <span class="mh">0x130</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Mode</span> <span class="o">=</span> <span class="mh">0x134</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Mode</span> <span class="o">=</span> <span class="mh">0x136</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_Joint_Status_1</span> <span class="o">=</span> <span class="mh">0x136</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_G0_Load_A</span> <span class="o">=</span> <span class="mh">0x138</span><span class="p">,</span>
	<span class="n">M_Offset_Joint_Status_2</span> <span class="o">=</span> <span class="mh">0x13a</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Load_B</span> <span class="o">=</span> <span class="mh">0x13c</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Load_A</span> <span class="o">=</span> <span class="mh">0x140</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Load_B</span> <span class="o">=</span> <span class="mh">0x144</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Input_Select</span> <span class="o">=</span> <span class="mh">0x148</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Input_Select</span> <span class="o">=</span> <span class="mh">0x14a</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Mode_1</span> <span class="o">=</span> <span class="mh">0x14c</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Mode_2</span> <span class="o">=</span> <span class="mh">0x14e</span><span class="p">,</span>
	<span class="n">M_Offset_AO_UI_Load_A</span> <span class="o">=</span> <span class="mh">0x150</span><span class="p">,</span>
	<span class="n">M_Offset_AO_UI_Load_B</span> <span class="o">=</span> <span class="mh">0x154</span><span class="p">,</span>
	<span class="n">M_Offset_AO_BC_Load_A</span> <span class="o">=</span> <span class="mh">0x158</span><span class="p">,</span>
	<span class="n">M_Offset_AO_BC_Load_B</span> <span class="o">=</span> <span class="mh">0x15c</span><span class="p">,</span>
	<span class="n">M_Offset_AO_UC_Load_A</span> <span class="o">=</span> <span class="mh">0x160</span><span class="p">,</span>
	<span class="n">M_Offset_AO_UC_Load_B</span> <span class="o">=</span> <span class="mh">0x164</span><span class="p">,</span>
	<span class="n">M_Offset_Clock_and_FOUT</span> <span class="o">=</span> <span class="mh">0x170</span><span class="p">,</span>
	<span class="n">M_Offset_IO_Bidirection_Pin</span> <span class="o">=</span> <span class="mh">0x172</span><span class="p">,</span>
	<span class="n">M_Offset_RTSI_Trig_Direction</span> <span class="o">=</span> <span class="mh">0x174</span><span class="p">,</span>
	<span class="n">M_Offset_Interrupt_Control</span> <span class="o">=</span> <span class="mh">0x176</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Output_Control</span> <span class="o">=</span> <span class="mh">0x178</span><span class="p">,</span>
	<span class="n">M_Offset_Analog_Trigger_Etc</span> <span class="o">=</span> <span class="mh">0x17a</span><span class="p">,</span>
	<span class="n">M_Offset_AI_START_STOP_Select</span> <span class="o">=</span> <span class="mh">0x17c</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Trigger_Select</span> <span class="o">=</span> <span class="mh">0x17e</span><span class="p">,</span>
	<span class="n">M_Offset_AI_SI_Save</span> <span class="o">=</span> <span class="mh">0x180</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AI_DIV_Load_A</span> <span class="o">=</span> <span class="mh">0x180</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AI_SC_Save</span> <span class="o">=</span> <span class="mh">0x184</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_AO_Start_Select</span> <span class="o">=</span> <span class="mh">0x184</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_AO_Trigger_Select</span> <span class="o">=</span> <span class="mh">0x186</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Mode_3</span> <span class="o">=</span> <span class="mh">0x18c</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Autoincrement</span> <span class="o">=</span> <span class="mh">0x188</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Autoincrement</span> <span class="o">=</span> <span class="mh">0x18a</span><span class="p">,</span>
	<span class="n">M_Offset_Joint_Reset</span> <span class="o">=</span> <span class="mh">0x190</span><span class="p">,</span>
	<span class="n">M_Offset_Interrupt_A_Enable</span> <span class="o">=</span> <span class="mh">0x192</span><span class="p">,</span>
	<span class="n">M_Offset_Interrupt_B_Enable</span> <span class="o">=</span> <span class="mh">0x196</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Personal</span> <span class="o">=</span> <span class="mh">0x19a</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Personal</span> <span class="o">=</span> <span class="mh">0x19c</span><span class="p">,</span>
	<span class="n">M_Offset_RTSI_Trig_A_Output</span> <span class="o">=</span> <span class="mh">0x19e</span><span class="p">,</span>
	<span class="n">M_Offset_RTSI_Trig_B_Output</span> <span class="o">=</span> <span class="mh">0x1a0</span><span class="p">,</span>
	<span class="n">M_Offset_RTSI_Shared_MUX</span> <span class="o">=</span> <span class="mh">0x1a2</span><span class="p">,</span>
	<span class="n">M_Offset_AO_Output_Control</span> <span class="o">=</span> <span class="mh">0x1ac</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Mode_3</span> <span class="o">=</span> <span class="mh">0x1ae</span><span class="p">,</span>
	<span class="n">M_Offset_Configuration_Memory_Clear</span> <span class="o">=</span> <span class="mh">0x1a4</span><span class="p">,</span>
	<span class="n">M_Offset_AI_FIFO_Clear</span> <span class="o">=</span> <span class="mh">0x1a6</span><span class="p">,</span>
	<span class="n">M_Offset_AO_FIFO_Clear</span> <span class="o">=</span> <span class="mh">0x1a8</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Counting_Mode</span> <span class="o">=</span> <span class="mh">0x1b0</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Counting_Mode</span> <span class="o">=</span> <span class="mh">0x1b2</span><span class="p">,</span>
	<span class="n">M_Offset_G0_Second_Gate</span> <span class="o">=</span> <span class="mh">0x1b4</span><span class="p">,</span>
	<span class="n">M_Offset_G1_Second_Gate</span> <span class="o">=</span> <span class="mh">0x1b6</span><span class="p">,</span>
	<span class="n">M_Offset_G0_DMA_Config</span> <span class="o">=</span> <span class="mh">0x1b8</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_G0_DMA_Status</span> <span class="o">=</span> <span class="mh">0x1b8</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_G1_DMA_Config</span> <span class="o">=</span> <span class="mh">0x1ba</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_G1_DMA_Status</span> <span class="o">=</span> <span class="mh">0x1ba</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_G0_MSeries_ABZ</span> <span class="o">=</span> <span class="mh">0x1c0</span><span class="p">,</span>
	<span class="n">M_Offset_G1_MSeries_ABZ</span> <span class="o">=</span> <span class="mh">0x1c2</span><span class="p">,</span>
	<span class="n">M_Offset_Clock_and_Fout2</span> <span class="o">=</span> <span class="mh">0x1c4</span><span class="p">,</span>
	<span class="n">M_Offset_PLL_Control</span> <span class="o">=</span> <span class="mh">0x1c6</span><span class="p">,</span>
	<span class="n">M_Offset_PLL_Status</span> <span class="o">=</span> <span class="mh">0x1c8</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_Output_Select_1</span> <span class="o">=</span> <span class="mh">0x1d0</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_Output_Select_2</span> <span class="o">=</span> <span class="mh">0x1d2</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_Output_Select_3</span> <span class="o">=</span> <span class="mh">0x1d4</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_Output_Select_4</span> <span class="o">=</span> <span class="mh">0x1d6</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_Output_Select_5</span> <span class="o">=</span> <span class="mh">0x1d8</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_Output_Select_6</span> <span class="o">=</span> <span class="mh">0x1da</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_DI</span> <span class="o">=</span> <span class="mh">0x1dc</span><span class="p">,</span>
	<span class="n">M_Offset_PFI_DO</span> <span class="o">=</span> <span class="mh">0x1de</span><span class="p">,</span>
	<span class="n">M_Offset_AI_Config_FIFO_Bypass</span> <span class="o">=</span> <span class="mh">0x218</span><span class="p">,</span>
	<span class="n">M_Offset_SCXI_DIO_Enable</span> <span class="o">=</span> <span class="mh">0x21c</span><span class="p">,</span>
	<span class="n">M_Offset_CDI_FIFO_Data</span> <span class="o">=</span> <span class="mh">0x220</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_CDO_FIFO_Data</span> <span class="o">=</span> <span class="mh">0x220</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_CDIO_Status</span> <span class="o">=</span> <span class="mh">0x224</span><span class="p">,</span>	<span class="cm">/*  read */</span>
	<span class="n">M_Offset_CDIO_Command</span> <span class="o">=</span> <span class="mh">0x224</span><span class="p">,</span>	<span class="cm">/*  write */</span>
	<span class="n">M_Offset_CDI_Mode</span> <span class="o">=</span> <span class="mh">0x228</span><span class="p">,</span>
	<span class="n">M_Offset_CDO_Mode</span> <span class="o">=</span> <span class="mh">0x22c</span><span class="p">,</span>
	<span class="n">M_Offset_CDI_Mask_Enable</span> <span class="o">=</span> <span class="mh">0x230</span><span class="p">,</span>
	<span class="n">M_Offset_CDO_Mask_Enable</span> <span class="o">=</span> <span class="mh">0x234</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">M_Offset_AO_Waveform_Order</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mh">0xc2</span> <span class="o">+</span> <span class="mh">0x4</span> <span class="o">*</span> <span class="n">channel</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">M_Offset_AO_Config_Bank</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mh">0xc3</span> <span class="o">+</span> <span class="mh">0x4</span> <span class="o">*</span> <span class="n">channel</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">M_Offset_DAC_Direct_Data</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mh">0xc0</span> <span class="o">+</span> <span class="mh">0x4</span> <span class="o">*</span> <span class="n">channel</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">M_Offset_Gen_PWM</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mh">0x44</span> <span class="o">+</span> <span class="mh">0x2</span> <span class="o">*</span> <span class="n">channel</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">M_Offset_Static_AI_Control</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">offset</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x64</span><span class="p">,</span>
		<span class="mh">0x261</span><span class="p">,</span>
		<span class="mh">0x262</span><span class="p">,</span>
		<span class="mh">0x263</span><span class="p">,</span>
	<span class="p">};</span>
	<span class="k">if</span> <span class="p">(((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%s: invalid channel=%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">offset</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">M_Offset_AO_Reference_Attenuation</span><span class="p">(</span><span class="kt">int</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">offset</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
		<span class="mh">0x264</span><span class="p">,</span>
		<span class="mh">0x265</span><span class="p">,</span>
		<span class="mh">0x266</span><span class="p">,</span>
		<span class="mh">0x267</span>
	<span class="p">};</span>
	<span class="k">if</span> <span class="p">(((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">channel</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">offset</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%s: invalid channel=%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">channel</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">offset</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">offset</span><span class="p">[</span><span class="n">channel</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">M_Offset_PFI_Output_Select</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">NUM_PFI_OUTPUT_SELECT_REGS</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%s: invalid pfi output select register=%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
		       <span class="n">__func__</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">M_Offset_PFI_Output_Select_1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">M_Offset_PFI_Output_Select_1</span> <span class="o">+</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">MSeries_AI_Config_FIFO_Data_Bits</span> <span class="p">{</span>
	<span class="n">MSeries_AI_Config_Channel_Type_Mask</span> <span class="o">=</span> <span class="mh">0x7</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Channel_Type_Calibration_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Channel_Type_Differential_Bits</span> <span class="o">=</span> <span class="mh">0x1</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Channel_Type_Common_Ref_Bits</span> <span class="o">=</span> <span class="mh">0x2</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Channel_Type_Ground_Ref_Bits</span> <span class="o">=</span> <span class="mh">0x3</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Channel_Type_Aux_Bits</span> <span class="o">=</span> <span class="mh">0x5</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Channel_Type_Ghost_Bits</span> <span class="o">=</span> <span class="mh">0x7</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Polarity_Bit</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>	<span class="cm">/*  0 for 2&#39;s complement encoding */</span>
	<span class="n">MSeries_AI_Config_Dither_Bit</span> <span class="o">=</span> <span class="mh">0x2000</span><span class="p">,</span>
	<span class="n">MSeries_AI_Config_Last_Channel_Bit</span> <span class="o">=</span> <span class="mh">0x4000</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_AI_Config_Channel_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">channel</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_AI_Config_Bank_Bits</span><span class="p">(</span><span class="k">enum</span> <span class="n">ni_reg_type</span> <span class="n">reg_type</span><span class="p">,</span>
						   <span class="kt">unsigned</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="n">bits</span> <span class="o">=</span> <span class="n">channel</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">reg_type</span> <span class="o">==</span> <span class="n">ni_reg_622x</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">channel</span> <span class="o">&amp;</span> <span class="mh">0x40</span><span class="p">)</span>
			<span class="n">bits</span> <span class="o">|=</span> <span class="mh">0x400</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">bits</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_AI_Config_Gain_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">range</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">range</span> <span class="o">&amp;</span> <span class="mh">0x7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">9</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">MSeries_Clock_and_Fout2_Bits</span> <span class="p">{</span>
	<span class="n">MSeries_PLL_In_Source_Select_RTSI0_Bits</span> <span class="o">=</span> <span class="mh">0xb</span><span class="p">,</span>
	<span class="n">MSeries_PLL_In_Source_Select_Star_Trigger_Bits</span> <span class="o">=</span> <span class="mh">0x14</span><span class="p">,</span>
	<span class="n">MSeries_PLL_In_Source_Select_RTSI7_Bits</span> <span class="o">=</span> <span class="mh">0x1b</span><span class="p">,</span>
	<span class="n">MSeries_PLL_In_Source_Select_PXI_Clock10</span> <span class="o">=</span> <span class="mh">0x1d</span><span class="p">,</span>
	<span class="n">MSeries_PLL_In_Source_Select_Mask</span> <span class="o">=</span> <span class="mh">0x1f</span><span class="p">,</span>
	<span class="n">MSeries_Timebase1_Select_Bit</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>	<span class="cm">/*  use PLL for timebase 1 */</span>
	<span class="n">MSeries_Timebase3_Select_Bit</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span>	<span class="cm">/*  use PLL for timebase 3 */</span>
	<span class="cm">/* use 10MHz instead of 20MHz for RTSI clock frequency.  Appears</span>
<span class="cm">	   to have no effect, at least on pxi-6281, which always uses</span>
<span class="cm">	   20MHz rtsi clock frequency */</span>
	<span class="n">MSeries_RTSI_10MHz_Bit</span> <span class="o">=</span> <span class="mh">0x80</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PLL_In_Source_Select_RTSI_Bits</span><span class="p">(</span><span class="kt">unsigned</span>
							      <span class="n">RTSI_channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">RTSI_channel</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%s: bug, invalid RTSI_channel=%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span>
		       <span class="n">RTSI_channel</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">RTSI_channel</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">MSeries_PLL_In_Source_Select_RTSI7_Bits</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="n">MSeries_PLL_In_Source_Select_RTSI0_Bits</span> <span class="o">+</span> <span class="n">RTSI_channel</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">MSeries_PLL_Control_Bits</span> <span class="p">{</span>
	<span class="n">MSeries_PLL_Enable_Bit</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
	<span class="n">MSeries_PLL_VCO_Mode_200_325MHz_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">MSeries_PLL_VCO_Mode_175_225MHz_Bits</span> <span class="o">=</span> <span class="mh">0x2000</span><span class="p">,</span>
	<span class="n">MSeries_PLL_VCO_Mode_100_225MHz_Bits</span> <span class="o">=</span> <span class="mh">0x4000</span><span class="p">,</span>
	<span class="n">MSeries_PLL_VCO_Mode_75_150MHz_Bits</span> <span class="o">=</span> <span class="mh">0x6000</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PLL_Divisor_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">divisor</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="n">max_divisor</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">divisor</span> <span class="o">&gt;</span> <span class="n">max_divisor</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%s: bug, invalid divisor=%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">divisor</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">&amp;</span> <span class="mh">0xf</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PLL_Multiplier_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">multiplier</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="k">const</span> <span class="kt">unsigned</span> <span class="n">max_multiplier</span> <span class="o">=</span> <span class="mh">0x100</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">multiplier</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="n">multiplier</span> <span class="o">&gt;</span> <span class="n">max_multiplier</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;%s: bug, invalid multiplier=%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span>
		       <span class="n">multiplier</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">multiplier</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">MSeries_PLL_Status</span> <span class="p">{</span>
	<span class="n">MSeries_PLL_Locked_Bit</span> <span class="o">=</span> <span class="mh">0x1</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">MSeries_AI_Config_FIFO_Bypass_Bits</span> <span class="p">{</span>
	<span class="n">MSeries_AI_Bypass_Channel_Mask</span> <span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">MSeries_AI_Bypass_Bank_Mask</span> <span class="o">=</span> <span class="mh">0x78</span><span class="p">,</span>
	<span class="n">MSeries_AI_Bypass_Cal_Sel_Pos_Mask</span> <span class="o">=</span> <span class="mh">0x380</span><span class="p">,</span>
	<span class="n">MSeries_AI_Bypass_Cal_Sel_Neg_Mask</span> <span class="o">=</span> <span class="mh">0x1c00</span><span class="p">,</span>
	<span class="n">MSeries_AI_Bypass_Mode_Mux_Mask</span> <span class="o">=</span> <span class="mh">0x6000</span><span class="p">,</span>
	<span class="n">MSeries_AO_Bypass_AO_Cal_Sel_Mask</span> <span class="o">=</span> <span class="mh">0x38000</span><span class="p">,</span>
	<span class="n">MSeries_AI_Bypass_Gain_Mask</span> <span class="o">=</span> <span class="mh">0x1c0000</span><span class="p">,</span>
	<span class="n">MSeries_AI_Bypass_Dither_Bit</span> <span class="o">=</span> <span class="mh">0x200000</span><span class="p">,</span>
	<span class="n">MSeries_AI_Bypass_Polarity_Bit</span> <span class="o">=</span> <span class="mh">0x400000</span><span class="p">,</span>	<span class="cm">/*  0 for 2&#39;s complement encoding */</span>
	<span class="n">MSeries_AI_Bypass_Config_FIFO_Bit</span> <span class="o">=</span> <span class="mh">0x80000000</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_AI_Bypass_Cal_Sel_Pos_Bits</span><span class="p">(</span><span class="kt">int</span>
							  <span class="n">calibration_source</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">calibration_source</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">MSeries_AI_Bypass_Cal_Sel_Pos_Mask</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_AI_Bypass_Cal_Sel_Neg_Bits</span><span class="p">(</span><span class="kt">int</span>
							  <span class="n">calibration_source</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">calibration_source</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">MSeries_AI_Bypass_Cal_Sel_Pos_Mask</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_AI_Bypass_Gain_Bits</span><span class="p">(</span><span class="kt">int</span> <span class="n">gain</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">gain</span> <span class="o">&lt;&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">MSeries_AI_Bypass_Gain_Mask</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">MSeries_AO_Config_Bank_Bits</span> <span class="p">{</span>
	<span class="n">MSeries_AO_DAC_Offset_Select_Mask</span> <span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">MSeries_AO_DAC_Offset_0V_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">MSeries_AO_DAC_Offset_5V_Bits</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">MSeries_AO_DAC_Reference_Mask</span> <span class="o">=</span> <span class="mh">0x38</span><span class="p">,</span>
	<span class="n">MSeries_AO_DAC_Reference_10V_Internal_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">MSeries_AO_DAC_Reference_5V_Internal_Bits</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">MSeries_AO_Update_Timed_Bit</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="n">MSeries_AO_Bipolar_Bit</span> <span class="o">=</span> <span class="mh">0x80</span>	<span class="cm">/*  turns on 2&#39;s complement encoding */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">MSeries_AO_Reference_Attenuation_Bits</span> <span class="p">{</span>
	<span class="n">MSeries_Attenuate_x5_Bit</span> <span class="o">=</span> <span class="mh">0x1</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_Cal_PWM_High_Time_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">count</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">count</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffff0000</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_Cal_PWM_Low_Time_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">count</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">count</span> <span class="o">&amp;</span> <span class="mh">0xffff</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PFI_Output_Select_Mask</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mh">0x1f</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">channel</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PFI_Output_Select_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">,</span>
						      <span class="kt">unsigned</span> <span class="n">source</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">source</span> <span class="o">&amp;</span> <span class="mh">0x1f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">((</span><span class="n">channel</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* inverse to MSeries_PFI_Output_Select_Bits */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PFI_Output_Select_Source</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">,</span>
							<span class="kt">unsigned</span> <span class="n">bits</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">bits</span> <span class="o">&gt;&gt;</span> <span class="p">((</span><span class="n">channel</span> <span class="o">%</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0x1f</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">MSeries_Gi_DMA_Config_Bits</span> <span class="p">{</span>
	<span class="n">Gi_DMA_BankSW_Error_Bit</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">Gi_DMA_Reset_Bit</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">Gi_DMA_Int_Enable_Bit</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">Gi_DMA_Write_Bit</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">Gi_DMA_Enable_Bit</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PFI_Filter_Select_Mask</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mh">0x3</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">channel</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="nf">MSeries_PFI_Filter_Select_Bits</span><span class="p">(</span><span class="kt">unsigned</span> <span class="n">channel</span><span class="p">,</span>
						      <span class="kt">unsigned</span> <span class="n">filter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">filter</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">channel</span> <span class="o">*</span>
			   <span class="mi">2</span><span class="p">))</span> <span class="o">&amp;</span> <span class="n">MSeries_PFI_Filter_Select_Mask</span><span class="p">(</span><span class="n">channel</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">enum</span> <span class="n">CDIO_DMA_Select_Bits</span> <span class="p">{</span>
	<span class="n">CDI_DMA_Select_Shift</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">CDI_DMA_Select_Mask</span> <span class="o">=</span> <span class="mh">0xf</span><span class="p">,</span>
	<span class="n">CDO_DMA_Select_Shift</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">CDO_DMA_Select_Mask</span> <span class="o">=</span> <span class="mh">0xf</span> <span class="o">&lt;&lt;</span> <span class="n">CDO_DMA_Select_Shift</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">CDIO_Status_Bits</span> <span class="p">{</span>
	<span class="n">CDO_FIFO_Empty_Bit</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">CDO_FIFO_Full_Bit</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">CDO_FIFO_Request_Bit</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">CDO_Overrun_Bit</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">CDO_Underflow_Bit</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">CDI_FIFO_Empty_Bit</span> <span class="o">=</span> <span class="mh">0x10000</span><span class="p">,</span>
	<span class="n">CDI_FIFO_Full_Bit</span> <span class="o">=</span> <span class="mh">0x20000</span><span class="p">,</span>
	<span class="n">CDI_FIFO_Request_Bit</span> <span class="o">=</span> <span class="mh">0x40000</span><span class="p">,</span>
	<span class="n">CDI_Overrun_Bit</span> <span class="o">=</span> <span class="mh">0x80000</span><span class="p">,</span>
	<span class="n">CDI_Overflow_Bit</span> <span class="o">=</span> <span class="mh">0x100000</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">CDIO_Command_Bits</span> <span class="p">{</span>
	<span class="n">CDO_Disarm_Bit</span> <span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">CDO_Arm_Bit</span> <span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">CDI_Disarm_Bit</span> <span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">CDI_Arm_Bit</span> <span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">CDO_Reset_Bit</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">CDI_Reset_Bit</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>
	<span class="n">CDO_Error_Interrupt_Enable_Set_Bit</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">,</span>
	<span class="n">CDO_Error_Interrupt_Enable_Clear_Bit</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">,</span>
	<span class="n">CDI_Error_Interrupt_Enable_Set_Bit</span> <span class="o">=</span> <span class="mh">0x100</span><span class="p">,</span>
	<span class="n">CDI_Error_Interrupt_Enable_Clear_Bit</span> <span class="o">=</span> <span class="mh">0x200</span><span class="p">,</span>
	<span class="n">CDO_FIFO_Request_Interrupt_Enable_Set_Bit</span> <span class="o">=</span> <span class="mh">0x400</span><span class="p">,</span>
	<span class="n">CDO_FIFO_Request_Interrupt_Enable_Clear_Bit</span> <span class="o">=</span> <span class="mh">0x800</span><span class="p">,</span>
	<span class="n">CDI_FIFO_Request_Interrupt_Enable_Set_Bit</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
	<span class="n">CDI_FIFO_Request_Interrupt_Enable_Clear_Bit</span> <span class="o">=</span> <span class="mh">0x2000</span><span class="p">,</span>
	<span class="n">CDO_Error_Interrupt_Confirm_Bit</span> <span class="o">=</span> <span class="mh">0x4000</span><span class="p">,</span>
	<span class="n">CDI_Error_Interrupt_Confirm_Bit</span> <span class="o">=</span> <span class="mh">0x8000</span><span class="p">,</span>
	<span class="n">CDO_Empty_FIFO_Interrupt_Enable_Set_Bit</span> <span class="o">=</span> <span class="mh">0x10000</span><span class="p">,</span>
	<span class="n">CDO_Empty_FIFO_Interrupt_Enable_Clear_Bit</span> <span class="o">=</span> <span class="mh">0x20000</span><span class="p">,</span>
	<span class="n">CDO_SW_Update_Bit</span> <span class="o">=</span> <span class="mh">0x80000</span><span class="p">,</span>
	<span class="n">CDI_SW_Update_Bit</span> <span class="o">=</span> <span class="mh">0x100000</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">CDI_Mode_Bits</span> <span class="p">{</span>
	<span class="n">CDI_Sample_Source_Select_Mask</span> <span class="o">=</span> <span class="mh">0x3f</span><span class="p">,</span>
	<span class="n">CDI_Halt_On_Error_Bit</span> <span class="o">=</span> <span class="mh">0x200</span><span class="p">,</span>
	<span class="n">CDI_Polarity_Bit</span> <span class="o">=</span> <span class="mh">0x400</span><span class="p">,</span>	<span class="cm">/*  sample clock on falling edge */</span>
	<span class="n">CDI_FIFO_Mode_Bit</span> <span class="o">=</span> <span class="mh">0x800</span><span class="p">,</span>	<span class="cm">/*  set for half full mode, clear for not empty mode */</span>
	<span class="n">CDI_Data_Lane_Mask</span> <span class="o">=</span> <span class="mh">0x3000</span><span class="p">,</span>	<span class="cm">/*  data lanes specify which dio channels map to byte or word accesses to the dio fifos */</span>
	<span class="n">CDI_Data_Lane_0_15_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">CDI_Data_Lane_16_31_Bits</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
	<span class="n">CDI_Data_Lane_0_7_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">CDI_Data_Lane_8_15_Bits</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
	<span class="n">CDI_Data_Lane_16_23_Bits</span> <span class="o">=</span> <span class="mh">0x2000</span><span class="p">,</span>
	<span class="n">CDI_Data_Lane_24_31_Bits</span> <span class="o">=</span> <span class="mh">0x3000</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">CDO_Mode_Bits</span> <span class="p">{</span>
	<span class="n">CDO_Sample_Source_Select_Mask</span> <span class="o">=</span> <span class="mh">0x3f</span><span class="p">,</span>
	<span class="n">CDO_Retransmit_Bit</span> <span class="o">=</span> <span class="mh">0x100</span><span class="p">,</span>
	<span class="n">CDO_Halt_On_Error_Bit</span> <span class="o">=</span> <span class="mh">0x200</span><span class="p">,</span>
	<span class="n">CDO_Polarity_Bit</span> <span class="o">=</span> <span class="mh">0x400</span><span class="p">,</span>	<span class="cm">/*  sample clock on falling edge */</span>
	<span class="n">CDO_FIFO_Mode_Bit</span> <span class="o">=</span> <span class="mh">0x800</span><span class="p">,</span>	<span class="cm">/*  set for half full mode, clear for not full mode */</span>
	<span class="n">CDO_Data_Lane_Mask</span> <span class="o">=</span> <span class="mh">0x3000</span><span class="p">,</span>	<span class="cm">/*  data lanes specify which dio channels map to byte or word accesses to the dio fifos */</span>
	<span class="n">CDO_Data_Lane_0_15_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">CDO_Data_Lane_16_31_Bits</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
	<span class="n">CDO_Data_Lane_0_7_Bits</span> <span class="o">=</span> <span class="mh">0x0</span><span class="p">,</span>
	<span class="n">CDO_Data_Lane_8_15_Bits</span> <span class="o">=</span> <span class="mh">0x1000</span><span class="p">,</span>
	<span class="n">CDO_Data_Lane_16_23_Bits</span> <span class="o">=</span> <span class="mh">0x2000</span><span class="p">,</span>
	<span class="n">CDO_Data_Lane_24_31_Bits</span> <span class="o">=</span> <span class="mh">0x3000</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">Interrupt_C_Enable_Bits</span> <span class="p">{</span>
	<span class="n">Interrupt_Group_C_Enable_Bit</span> <span class="o">=</span> <span class="mh">0x1</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">Interrupt_C_Status_Bits</span> <span class="p">{</span>
	<span class="n">Interrupt_Group_C_Status_Bit</span> <span class="o">=</span> <span class="mh">0x1</span>
<span class="p">};</span>

<span class="cp">#define M_SERIES_EEPROM_SIZE 1024</span>

<span class="k">struct</span> <span class="n">ni_board_struct</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">device_id</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">isapnp_id</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">n_adchan</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">adbits</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">ai_fifo_depth</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">alwaysdither</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">gainlkup</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ai_speed</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">n_aochan</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">aobits</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ao_fifo_depth</span><span class="p">;</span>
	<span class="k">const</span> <span class="k">struct</span> <span class="n">comedi_lrange</span> <span class="o">*</span><span class="n">ao_range_table</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="n">ao_speed</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="n">num_p0_dio_channels</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">reg_type</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ao_unipolar</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">has_8255</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">has_analog_trig</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">enum</span> <span class="n">caldac_enum</span> <span class="n">caldac</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define n_ni_boards  (sizeof(ni_boards)/sizeof(struct ni_board_struct))</span>

<span class="cp">#define boardtype (*(struct ni_board_struct *)dev-&gt;board_ptr)</span>

<span class="cp">#define MAX_N_AO_CHAN 8</span>
<span class="cp">#define NUM_GPCT 2</span>

<span class="cp">#define NI_PRIVATE_COMMON					\</span>
<span class="cp">	uint16_t (*stc_readw)(struct comedi_device *dev, int register);	\</span>
<span class="cp">	uint32_t (*stc_readl)(struct comedi_device *dev, int register);	\</span>
<span class="cp">	void (*stc_writew)(struct comedi_device *dev, uint16_t value, int register);	\</span>
<span class="cp">	void (*stc_writel)(struct comedi_device *dev, uint32_t value, int register);	\</span>
<span class="cp">	\</span>
<span class="cp">	unsigned short dio_output;				\</span>
<span class="cp">	unsigned short dio_control;				\</span>
<span class="cp">	int ao0p, ao1p;						\</span>
<span class="cp">	int lastchan;						\</span>
<span class="cp">	int last_do;						\</span>
<span class="cp">	int rt_irq;						\</span>
<span class="cp">	int irqmask;						\</span>
<span class="cp">	int aimode;						\</span>
<span class="cp">	int ai_continuous;					\</span>
<span class="cp">	int blocksize;						\</span>
<span class="cp">	int n_left;						\</span>
<span class="cp">	unsigned int ai_calib_source;				\</span>
<span class="cp">	unsigned int ai_calib_source_enabled;			\</span>
<span class="cp">	spinlock_t window_lock; \</span>
<span class="cp">	spinlock_t soft_reg_copy_lock; \</span>
<span class="cp">	spinlock_t mite_channel_lock; \</span>
<span class="cp">								\</span>
<span class="cp">	int changain_state;					\</span>
<span class="cp">	unsigned int changain_spec;				\</span>
<span class="cp">								\</span>
<span class="cp">	unsigned int caldac_maxdata_list[MAX_N_CALDACS];	\</span>
<span class="cp">	unsigned short ao[MAX_N_AO_CHAN];					\</span>
<span class="cp">	unsigned short caldacs[MAX_N_CALDACS];				\</span>
<span class="cp">								\</span>
<span class="cp">	unsigned short ai_cmd2;	\</span>
<span class="cp">								\</span>
<span class="cp">	unsigned short ao_conf[MAX_N_AO_CHAN];				\</span>
<span class="cp">	unsigned short ao_mode1;				\</span>
<span class="cp">	unsigned short ao_mode2;				\</span>
<span class="cp">	unsigned short ao_mode3;				\</span>
<span class="cp">	unsigned short ao_cmd1;					\</span>
<span class="cp">	unsigned short ao_cmd2;					\</span>
<span class="cp">	unsigned short ao_cmd3;					\</span>
<span class="cp">	unsigned short ao_trigger_select;			\</span>
<span class="cp">								\</span>
<span class="cp">	struct ni_gpct_device *counter_dev;	\</span>
<span class="cp">	unsigned short an_trig_etc_reg;				\</span>
<span class="cp">								\</span>
<span class="cp">	unsigned ai_offset[512];				\</span>
<span class="cp">								\</span>
<span class="cp">	unsigned long serial_interval_ns;                       \</span>
<span class="cp">	unsigned char serial_hw_mode;                           \</span>
<span class="cp">	unsigned short clock_and_fout;				\</span>
<span class="cp">	unsigned short clock_and_fout2;				\</span>
<span class="cp">								\</span>
<span class="cp">	unsigned short int_a_enable_reg;			\</span>
<span class="cp">	unsigned short int_b_enable_reg;			\</span>
<span class="cp">	unsigned short io_bidirection_pin_reg;			\</span>
<span class="cp">	unsigned short rtsi_trig_direction_reg;			\</span>
<span class="cp">	unsigned short rtsi_trig_a_output_reg; \</span>
<span class="cp">	unsigned short rtsi_trig_b_output_reg; \</span>
<span class="cp">	unsigned short pfi_output_select_reg[NUM_PFI_OUTPUT_SELECT_REGS]; \</span>
<span class="cp">	unsigned short ai_ao_select_reg; \</span>
<span class="cp">	unsigned short g0_g1_select_reg; \</span>
<span class="cp">	unsigned short cdio_dma_select_reg; \</span>
<span class="cp">	\</span>
<span class="cp">	unsigned clock_ns; \</span>
<span class="cp">	unsigned clock_source; \</span>
<span class="cp">	\</span>
<span class="cp">	unsigned short atrig_mode;				\</span>
<span class="cp">	unsigned short atrig_high;				\</span>
<span class="cp">	unsigned short atrig_low;				\</span>
<span class="cp">	\</span>
<span class="cp">	unsigned short pwm_up_count;	\</span>
<span class="cp">	unsigned short pwm_down_count;	\</span>
<span class="cp">	\</span>
<span class="cp">	short ai_fifo_buffer[0x2000];				\</span>
<span class="cp">	uint8_t eeprom_buffer[M_SERIES_EEPROM_SIZE]; \</span>
<span class="cp">	uint32_t serial_number; \</span>
<span class="cp">	\</span>
<span class="cp">	struct mite_struct *mite; \</span>
<span class="cp">	struct mite_channel *ai_mite_chan; \</span>
<span class="cp">	struct mite_channel *ao_mite_chan;\</span>
<span class="cp">	struct mite_channel *cdo_mite_chan;\</span>
<span class="cp">	struct mite_dma_descriptor_ring *ai_mite_ring; \</span>
<span class="cp">	struct mite_dma_descriptor_ring *ao_mite_ring; \</span>
<span class="cp">	struct mite_dma_descriptor_ring *cdo_mite_ring; \</span>
<span class="cp">	struct mite_dma_descriptor_ring *gpct_mite_ring[NUM_GPCT];</span>

<span class="cp">#endif </span><span class="cm">/* _COMEDI_NI_STC_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
