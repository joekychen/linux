<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › bcm › CmHost.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>CmHost.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/************************************************************</span>
<span class="cm"> * CMHOST.C</span>
<span class="cm"> * This file contains the routines for handling Connection</span>
<span class="cm"> * Management.</span>
<span class="cm"> ************************************************************/</span>

<span class="cm">/* #define CONN_MSG */</span>
<span class="cp">#include &quot;headers.h&quot;</span>

<span class="k">enum</span> <span class="n">E_CLASSIFIER_ACTION</span> <span class="p">{</span>
	<span class="n">eInvalidClassifierAction</span><span class="p">,</span>
	<span class="n">eAddClassifier</span><span class="p">,</span>
	<span class="n">eReplaceClassifier</span><span class="p">,</span>
	<span class="n">eDeleteClassifier</span>
<span class="p">};</span>

<span class="k">static</span> <span class="n">ULONG</span> <span class="n">GetNextTargetBufferLocation</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">B_UINT16</span> <span class="n">tid</span><span class="p">);</span>

<span class="cm">/************************************************************</span>
<span class="cm"> * Function - SearchSfid</span>
<span class="cm"> *</span>
<span class="cm"> * Description - This routinue would search QOS queues having</span>
<span class="cm"> *  specified SFID as input parameter.</span>
<span class="cm"> *</span>
<span class="cm"> * Parameters -	Adapter: Pointer to the Adapter structure</span>
<span class="cm"> *  uiSfid : Given SFID for matching</span>
<span class="cm"> *</span>
<span class="cm"> * Returns - Queue index for this SFID(If matched)</span>
<span class="cm"> *  Else Invalid Queue Index(If Not matched)</span>
<span class="cm"> ************************************************************/</span>
<span class="kt">int</span> <span class="nf">SearchSfid</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uiSfid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">NO_OF_QUEUES</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ulSFID</span> <span class="o">==</span> <span class="n">uiSfid</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">NO_OF_QUEUES</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************</span>
<span class="cm"> * Function -SearchFreeSfid</span>
<span class="cm"> *</span>
<span class="cm"> * Description - This routinue would search Free available SFID.</span>
<span class="cm"> *</span>
<span class="cm"> * Parameter - Adapter: Pointer to the Adapter structure</span>
<span class="cm"> *</span>
<span class="cm"> * Returns - Queue index for the free SFID</span>
<span class="cm"> *  Else returns Invalid Index.</span>
<span class="cm"> ****************************************************************/</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">SearchFreeSfid</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">NO_OF_QUEUES</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ulSFID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">NO_OF_QUEUES</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Function: SearchClsid</span>
<span class="cm"> * Description:	This routinue would search Classifier  having specified ClassifierID as input parameter</span>
<span class="cm"> * Input parameters: PMINI_ADAPTER Adapter - Adapter Context</span>
<span class="cm"> *  unsigned int uiSfid   - The SF in which the classifier is to searched</span>
<span class="cm"> *  B_UINT16  uiClassifierID - The classifier ID to be searched</span>
<span class="cm"> * Return: int :Classifier table index of matching entry</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">SearchClsid</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">ULONG</span> <span class="n">ulSFID</span><span class="p">,</span> <span class="n">B_UINT16</span>  <span class="n">uiClassifierID</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">bUsed</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
			<span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">uiClassifierRuleIndex</span> <span class="o">==</span> <span class="n">uiClassifierID</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
			<span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ulSFID</span> <span class="o">==</span> <span class="n">ulSFID</span><span class="p">))</span>
			<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">MAX_CLASSIFIERS</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * @ingroup ctrl_pkt_functions</span>
<span class="cm"> * This routinue would search Free available Classifier entry in classifier table.</span>
<span class="cm"> * @return free Classifier Entry index in classifier table for specified SF</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">SearchFreeClsid</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span> <span class="cm">/**Adapter Context*/</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">bUsed</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">i</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">MAX_CLASSIFIERS</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">VOID</span> <span class="nf">deleteSFBySfid</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* deleting all the packet held in the SF */</span>
	<span class="n">flush_queue</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>

	<span class="cm">/* Deleting the all classifiers for this SF */</span>
	<span class="n">DeleteAllClassifiersForSF</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>

	<span class="cm">/* Resetting only MIBS related entries in the SF */</span>
	<span class="n">memset</span><span class="p">((</span><span class="n">PVOID</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">S_MIBS_SERVICEFLOW_TABLE</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">VOID</span>
<span class="nf">CopyIpAddrToClassifier</span><span class="p">(</span><span class="n">S_CLASSIFIER_RULE</span> <span class="o">*</span><span class="n">pstClassifierEntry</span><span class="p">,</span>
		<span class="n">B_UINT8</span> <span class="n">u8IpAddressLen</span><span class="p">,</span> <span class="n">B_UINT8</span> <span class="o">*</span><span class="n">pu8IpAddressMaskSrc</span><span class="p">,</span>
		<span class="n">BOOLEAN</span> <span class="n">bIpVersion6</span><span class="p">,</span> <span class="n">E_IPADDR_CONTEXT</span> <span class="n">eIpAddrContext</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">UINT</span> <span class="n">nSizeOfIPAddressInBytes</span> <span class="o">=</span> <span class="n">IP_LENGTH_OF_ADDRESS</span><span class="p">;</span>
	<span class="n">UCHAR</span> <span class="o">*</span><span class="n">ptrClassifierIpAddress</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">UCHAR</span> <span class="o">*</span><span class="n">ptrClassifierIpMask</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span> <span class="o">=</span> <span class="n">GET_BCM_ADAPTER</span><span class="p">(</span><span class="n">gblpnetdev</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">bIpVersion6</span><span class="p">)</span>
		<span class="n">nSizeOfIPAddressInBytes</span> <span class="o">=</span> <span class="n">IPV6_ADDRESS_SIZEINBYTES</span><span class="p">;</span>

	<span class="cm">/* Destination Ip Address */</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Ip Address Range Length:0x%X &quot;</span><span class="p">,</span> <span class="n">u8IpAddressLen</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">bIpVersion6</span> <span class="o">?</span> <span class="p">(</span><span class="n">IPV6_ADDRESS_SIZEINBYTES</span> <span class="o">*</span> <span class="n">MAX_IP_RANGE_LENGTH</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">:</span>
			<span class="p">(</span><span class="n">TOTAL_MASKED_ADDRESS_IN_BYTES</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">u8IpAddressLen</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/*</span>
<span class="cm">		 * checking both the mask and address togethor in Classification.</span>
<span class="cm">		 * So length will be : TotalLengthInBytes/nSizeOfIPAddressInBytes * 2</span>
<span class="cm">		 * (nSizeOfIPAddressInBytes for address and nSizeOfIPAddressInBytes for mask)</span>
<span class="cm">		 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eDestIpAddress</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucIPDestinationAddressLength</span> <span class="o">=</span> <span class="n">u8IpAddressLen</span><span class="o">/</span><span class="p">(</span><span class="n">nSizeOfIPAddressInBytes</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">bIpVersion6</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">ptrClassifierIpAddress</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ucIpv6Address</span><span class="p">;</span>
				<span class="n">ptrClassifierIpMask</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ucIpv6Mask</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">ptrClassifierIpAddress</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ucIpv4Address</span><span class="p">;</span>
				<span class="n">ptrClassifierIpMask</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ucIpv4Mask</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eSrcIpAddress</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucIPSourceAddressLength</span> <span class="o">=</span> <span class="n">u8IpAddressLen</span><span class="o">/</span><span class="p">(</span><span class="n">nSizeOfIPAddressInBytes</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">bIpVersion6</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">ptrClassifierIpAddress</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ucIpv6Address</span><span class="p">;</span>
				<span class="n">ptrClassifierIpMask</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ucIpv6Mask</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">ptrClassifierIpAddress</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ucIpv4Address</span><span class="p">;</span>
				<span class="n">ptrClassifierIpMask</span> <span class="o">=</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ucIpv4Mask</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Address Length:0x%X</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucIPDestinationAddressLength</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">((</span><span class="n">u8IpAddressLen</span> <span class="o">&gt;=</span> <span class="n">nSizeOfIPAddressInBytes</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_IP_RANGE_LENGTH</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">memcpy</span><span class="p">(</span><span class="n">ptrClassifierIpAddress</span> <span class="o">+</span>
				<span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">nSizeOfIPAddressInBytes</span><span class="p">),</span>
				<span class="p">(</span><span class="n">pu8IpAddressMaskSrc</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">nSizeOfIPAddressInBytes</span><span class="o">*</span><span class="mi">2</span><span class="p">)),</span>
				<span class="n">nSizeOfIPAddressInBytes</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bIpVersion6</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eSrcIpAddress</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv4Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv4Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
					<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Src Ip Address:0x%luX &quot;</span><span class="p">,</span>
							<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv4Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eDestIpAddress</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv4Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv4Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
					<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Dest Ip Address:0x%luX &quot;</span><span class="p">,</span>
							<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv4Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="n">u8IpAddressLen</span> <span class="o">-=</span> <span class="n">nSizeOfIPAddressInBytes</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">u8IpAddressLen</span> <span class="o">&gt;=</span> <span class="n">nSizeOfIPAddressInBytes</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">memcpy</span><span class="p">(</span><span class="n">ptrClassifierIpMask</span> <span class="o">+</span>
					<span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">nSizeOfIPAddressInBytes</span><span class="p">),</span>
					<span class="p">(</span><span class="n">pu8IpAddressMaskSrc</span><span class="o">+</span><span class="n">nSizeOfIPAddressInBytes</span> <span class="o">+</span>
						<span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">nSizeOfIPAddressInBytes</span><span class="o">*</span><span class="mi">2</span><span class="p">)),</span>
					<span class="n">nSizeOfIPAddressInBytes</span><span class="p">);</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bIpVersion6</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eSrcIpAddress</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv4Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
							<span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv4Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
						<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Src Ip Mask Address:0x%luX &quot;</span><span class="p">,</span>
								<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv4Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eDestIpAddress</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv4Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
							<span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv4Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
						<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Dest Ip Mask Address:0x%luX &quot;</span><span class="p">,</span>
								<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv4Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="n">u8IpAddressLen</span> <span class="o">-=</span> <span class="n">nSizeOfIPAddressInBytes</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">u8IpAddressLen</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">bDestIpValid</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

			<span class="n">i</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">bIpVersion6</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* Restore EndianNess of Struct */</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_IP_RANGE_LENGTH</span> <span class="o">*</span> <span class="mi">4</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eSrcIpAddress</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv6Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv6Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
					<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv6Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stSrcIpAddress</span><span class="p">.</span><span class="n">ulIpv6Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">eIpAddrContext</span> <span class="o">==</span> <span class="n">eDestIpAddress</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv6Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv6Addr</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
					<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv6Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">stDestIpAddress</span><span class="p">.</span><span class="n">ulIpv6Mask</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">ClearTargetDSXBuffer</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">B_UINT16</span> <span class="n">TID</span><span class="p">,</span> <span class="n">BOOLEAN</span> <span class="n">bFreeAll</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">valid</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">((</span><span class="n">bFreeAll</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">tid</span> <span class="o">==</span> <span class="n">TID</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;ClearTargetDSXBuffer: found tid %d buffer cleared %lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
					<span class="n">TID</span><span class="p">,</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ulTargetDsxBuffer</span><span class="p">);</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">valid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">tid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulFreeTargetBufferCnt</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * @ingroup ctrl_pkt_functions</span>
<span class="cm"> * copy classifier rule into the specified SF index</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">VOID</span> <span class="nf">CopyClassifierRuleToSF</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">stConvergenceSLTypes</span>  <span class="o">*</span><span class="n">psfCSType</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">nClassifierIndex</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">S_CLASSIFIER_RULE</span> <span class="o">*</span><span class="n">pstClassifierEntry</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="cm">/* VOID *pvPhsContext = NULL; */</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="cm">/* UCHAR ucProtocolLength=0; */</span>
	<span class="cm">/* ULONG ulPhsStatus; */</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span>
		<span class="n">nClassifierIndex</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">MAX_CLASSIFIERS</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Storing Classifier Rule Index : %X&quot;</span><span class="p">,</span>
			<span class="n">ntohs</span><span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16PacketClassificationRuleIndex</span><span class="p">));</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">nClassifierIndex</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">pstClassifierEntry</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">nClassifierIndex</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pstClassifierEntry</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Store if Ipv6 */</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">bIpv6Protocol</span> <span class="o">=</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucIpVersion</span> <span class="o">==</span> <span class="n">IPV6</span><span class="p">)</span> <span class="o">?</span> <span class="n">TRUE</span> <span class="o">:</span> <span class="n">FALSE</span><span class="p">;</span>

		<span class="cm">/* Destinaiton Port */</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucDestPortRangeLength</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRangeLength</span> <span class="o">/</span> <span class="mi">4</span><span class="p">;</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Destination Port Range Length:0x%X &quot;</span><span class="p">,</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucDestPortRangeLength</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRangeLength</span> <span class="o">&lt;=</span> <span class="n">MAX_PORT_RANGE</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucDestPortRangeLength</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usDestPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">PUSHORT</span><span class="p">)(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="o">+</span><span class="n">i</span><span class="p">));</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usDestPortRangeHi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
					<span class="o">*</span><span class="p">((</span><span class="n">PUSHORT</span><span class="p">)(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">));</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usDestPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usDestPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Destination Port Range Lo:0x%X &quot;</span><span class="p">,</span>
						<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usDestPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usDestPortRangeHi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usDestPortRangeHi</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucDestPortRangeLength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="cm">/* Source Port */</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Source Port Range Length:0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRangeLength</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRangeLength</span> <span class="o">&lt;=</span> <span class="n">MAX_PORT_RANGE</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucSrcPortRangeLength</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRangeLength</span><span class="o">/</span><span class="mi">4</span><span class="p">;</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucSrcPortRangeLength</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usSrcPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
					<span class="o">*</span><span class="p">((</span><span class="n">PUSHORT</span><span class="p">)(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span>
							<span class="n">u8ProtocolSourcePortRange</span><span class="o">+</span><span class="n">i</span><span class="p">));</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usSrcPortRangeHi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
					<span class="o">*</span><span class="p">((</span><span class="n">PUSHORT</span><span class="p">)(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span>
							<span class="n">u8ProtocolSourcePortRange</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">i</span><span class="p">));</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usSrcPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span>
					<span class="n">ntohs</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usSrcPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Source Port Range Lo:0x%X &quot;</span><span class="p">,</span>
						<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usSrcPortRangeLo</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usSrcPortRangeHi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usSrcPortRangeHi</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="cm">/* Destination Ip Address and Mask */</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Ip Destination Parameters : &quot;</span><span class="p">);</span>
		<span class="n">CopyIpAddrToClassifier</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddressLength</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddress</span><span class="p">,</span>
				<span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucIpVersion</span> <span class="o">==</span> <span class="n">IPV6</span><span class="p">)</span> <span class="o">?</span>
			<span class="n">TRUE</span> <span class="o">:</span> <span class="n">FALSE</span><span class="p">,</span> <span class="n">eDestIpAddress</span><span class="p">);</span>

		<span class="cm">/* Source Ip Address and Mask */</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Ip Source Parameters : &quot;</span><span class="p">);</span>

		<span class="n">CopyIpAddrToClassifier</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddressLength</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddress</span><span class="p">,</span>
				<span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucIpVersion</span> <span class="o">==</span> <span class="n">IPV6</span><span class="p">)</span> <span class="o">?</span> <span class="n">TRUE</span> <span class="o">:</span> <span class="n">FALSE</span><span class="p">,</span>
				<span class="n">eSrcIpAddress</span><span class="p">);</span>

		<span class="cm">/* TOS */</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;TOS Length:0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfServiceLength</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfServiceLength</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucIPTypeOfServiceLength</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfServiceLength</span><span class="p">;</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucTosLow</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucTosHigh</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucTosMask</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">bTOSValid</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Protocol</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* we didn&#39;t get protocol field filled in by the BS */</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucProtocolLength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucProtocolLength</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="cm">/* 1 valid protocol */</span>
		<span class="p">}</span>

		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucProtocol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Protocol</span><span class="p">;</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">u8ClassifierRulePriority</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ClassifierRulePriority</span><span class="p">;</span>

		<span class="cm">/* store the classifier rule ID and set this classifier entry as valid */</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucDirection</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucDirection</span><span class="p">;</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">uiClassifierRuleIndex</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usVCID_Value</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span><span class="p">;</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ulSFID</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ulSFID</span><span class="p">;</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Search Index %d Dir: %d, Index: %d, Vcid: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
				<span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucDirection</span><span class="p">,</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">uiClassifierRuleIndex</span><span class="p">,</span>
				<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usVCID_Value</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8AssociatedPHSI</span><span class="p">)</span>
			<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">u8AssociatedPHSI</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8AssociatedPHSI</span><span class="p">;</span>

		<span class="cm">/* Copy ETH CS Parameters */</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucEthCSSrcMACLen</span> <span class="o">=</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddressLength</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">au8EThCSSrcMAC</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">,</span> <span class="n">MAC_ADDRESS_SIZE</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">au8EThCSSrcMACMask</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span> <span class="o">+</span> <span class="n">MAC_ADDRESS_SIZE</span><span class="p">,</span> <span class="n">MAC_ADDRESS_SIZE</span><span class="p">);</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucEthCSDestMACLen</span> <span class="o">=</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddressLength</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">au8EThCSDestMAC</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">,</span> <span class="n">MAC_ADDRESS_SIZE</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">au8EThCSDestMACMask</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span> <span class="o">+</span> <span class="n">MAC_ADDRESS_SIZE</span><span class="p">,</span> <span class="n">MAC_ADDRESS_SIZE</span><span class="p">);</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">ucEtherTypeLen</span> <span class="o">=</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthertypeLength</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">au8EthCSEtherType</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">,</span> <span class="n">NUM_ETHERTYPE_BYTES</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usUserPriority</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16UserPriority</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usVLANID</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16VLANID</span><span class="p">);</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">usValidityBitMap</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16ValidityBitMap</span><span class="p">);</span>

		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">bUsed</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * @ingroup ctrl_pkt_functions</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">VOID</span> <span class="nf">DeleteClassifierRuleFromSF</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">nClassifierIndex</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">S_CLASSIFIER_RULE</span> <span class="o">*</span><span class="n">pstClassifierEntry</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">B_UINT16</span> <span class="n">u16PacketClassificationRuleIndex</span><span class="p">;</span>
	<span class="n">USHORT</span> <span class="n">usVCID</span><span class="p">;</span>
	<span class="cm">/* VOID *pvPhsContext = NULL; */</span>
	<span class="cm">/*ULONG ulPhsStatus; */</span>

	<span class="n">usVCID</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">nClassifierIndex</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">usVCID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">u16PacketClassificationRuleIndex</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">nClassifierIndex</span><span class="p">].</span><span class="n">uiClassifierRuleIndex</span><span class="p">;</span>
	<span class="n">pstClassifierEntry</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">nClassifierIndex</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pstClassifierEntry</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">bUsed</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
		<span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">uiClassifierRuleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">pstClassifierEntry</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">S_CLASSIFIER_RULE</span><span class="p">));</span>

		<span class="cm">/* Delete the PHS Rule for this classifier */</span>
		<span class="n">PhsDeleteClassifierRule</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stBCMPhsContext</span><span class="p">,</span> <span class="n">usVCID</span><span class="p">,</span> <span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * @ingroup ctrl_pkt_functions</span>
<span class="cm"> */</span>
<span class="n">VOID</span> <span class="nf">DeleteAllClassifiersForSF</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">S_CLASSIFIER_RULE</span> <span class="o">*</span><span class="n">pstClassifierEntry</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="cm">/* B_UINT16  u16PacketClassificationRuleIndex; */</span>
	<span class="n">USHORT</span> <span class="n">ulVCID</span><span class="p">;</span>
	<span class="cm">/* VOID *pvPhsContext = NULL; */</span>
	<span class="cm">/* ULONG ulPhsStatus; */</span>

	<span class="n">ulVCID</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ulVCID</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">==</span> <span class="n">ulVCID</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pstClassifierEntry</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pstClassifierEntry</span><span class="o">-&gt;</span><span class="n">bUsed</span><span class="p">)</span>
				<span class="n">DeleteClassifierRuleFromSF</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* Delete All Phs Rules Associated with this SF */</span>
	<span class="n">PhsDeleteSFRules</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stBCMPhsContext</span><span class="p">,</span> <span class="n">ulVCID</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * This routinue  copies the Connection Management</span>
<span class="cm"> * related data into the Adapter structure.</span>
<span class="cm"> * @ingroup ctrl_pkt_functions</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="n">VOID</span> <span class="nf">CopyToAdapter</span><span class="p">(</span><span class="k">register</span> <span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="cm">/* &lt;Pointer to the Adapter structure */</span>
			<span class="k">register</span> <span class="n">pstServiceFlowParamSI</span> <span class="n">psfLocalSet</span><span class="p">,</span> <span class="cm">/* &lt;Pointer to the ServiceFlowParamSI structure */</span>
			<span class="k">register</span> <span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="cm">/* &lt;Index of Queue, to which this data belongs */</span>
			<span class="k">register</span> <span class="n">UCHAR</span> <span class="n">ucDsxType</span><span class="p">,</span>
			<span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="n">pstAddIndication</span><span class="p">)</span> <span class="p">{</span>

	<span class="cm">/* UCHAR ucProtocolLength = 0; */</span>
	<span class="n">ULONG</span> <span class="n">ulSFID</span><span class="p">;</span>
	<span class="n">UINT</span> <span class="n">nClassifierIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">E_CLASSIFIER_ACTION</span> <span class="n">eClassifierAction</span> <span class="o">=</span> <span class="n">eInvalidClassifierAction</span><span class="p">;</span>
	<span class="n">B_UINT16</span> <span class="n">u16PacketClassificationRuleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="n">stConvergenceSLTypes</span> <span class="o">*</span><span class="n">psfCSType</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">S_PHS_RULE</span> <span class="n">sPhsRule</span><span class="p">;</span>
	<span class="n">USHORT</span> <span class="n">uVCID</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span><span class="p">;</span>
	<span class="n">UINT</span> <span class="n">UGIValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bValid</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Search Rule Index = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;%s: SFID= %x &quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32SFID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Updating Queue %d&quot;</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>

	<span class="n">ulSFID</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32SFID</span><span class="p">);</span>
	<span class="cm">/* Store IP Version used */</span>
	<span class="cm">/* Get The Version Of IP used (IPv6 or IPv4) from CSSpecification field of SF */</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bEthCSSupport</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* Enable IP/ETh CS Support As Required */</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;CopyToAdapter : u8CSSpecification : %X</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8CSSpecification</span><span class="p">);</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8CSSpecification</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">eCSPacketIPV4</span>:
	<span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span> <span class="o">=</span> <span class="n">IPV4_CS</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="n">eCSPacketIPV6</span>:
	<span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span> <span class="o">=</span> <span class="n">IPV6_CS</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="n">eCS802_3PacketEthernet</span>:
	<span class="k">case</span> <span class="n">eCS802_1QPacketVLAN</span>:
	<span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bEthCSSupport</span> <span class="o">=</span> <span class="n">ETH_CS_802_3</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="n">eCSPacketIPV4Over802_1QVLAN</span>:
	<span class="k">case</span> <span class="n">eCSPacketIPV4Over802_3Ethernet</span>:
	<span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span> <span class="o">=</span> <span class="n">IPV4_CS</span><span class="p">;</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bEthCSSupport</span> <span class="o">=</span> <span class="n">ETH_CS_802_3</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="n">eCSPacketIPV6Over802_1QVLAN</span>:
	<span class="k">case</span> <span class="n">eCSPacketIPV6Over802_3Ethernet</span>:
	<span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span> <span class="o">=</span> <span class="n">IPV6_CS</span><span class="p">;</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bEthCSSupport</span> <span class="o">=</span> <span class="n">ETH_CS_802_3</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="nl">default:</span>
	<span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Error in value of CS Classification.. setting default to IP CS</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span> <span class="o">=</span> <span class="n">IPV4_CS</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;CopyToAdapter : Queue No : %X ETH CS Support :  %X  , IP CS Support : %X</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
			<span class="n">uiSearchRuleIndex</span><span class="p">,</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bEthCSSupport</span><span class="p">,</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span><span class="p">);</span>

	<span class="cm">/* Store IP Version used */</span>
	<span class="cm">/* Get The Version Of IP used (IPv6 or IPv4) from CSSpecification field of SF */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bIPCSSupport</span> <span class="o">==</span> <span class="n">IPV6_CS</span><span class="p">)</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucIpVersion</span> <span class="o">=</span> <span class="n">IPV6</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucIpVersion</span> <span class="o">=</span> <span class="n">IPV4</span><span class="p">;</span>

	<span class="cm">/* To ensure that the ETH CS code doesn&#39;t gets executed if the BS doesn&#39;t supports ETH CS */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">bETHCSEnabled</span><span class="p">)</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bEthCSSupport</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8ServiceClassNameLength</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8ServiceClassNameLength</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">)</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucServiceClassName</span><span class="p">,</span>	<span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8ServiceClassName</span><span class="p">,</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8ServiceClassNameLength</span><span class="p">);</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">u8QueueType</span> <span class="o">=</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8ServiceFlowSchedulingType</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">u8QueueType</span> <span class="o">==</span> <span class="n">BE</span> <span class="o">&amp;&amp;</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucDirection</span><span class="p">)</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">usBestEffortQueueIndex</span> <span class="o">=</span> <span class="n">uiSearchRuleIndex</span><span class="p">;</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ulSFID</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32SFID</span><span class="p">);</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">u8TrafficPriority</span> <span class="o">=</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8TrafficPriority</span><span class="p">;</span>

	<span class="cm">/* copy all the classifier in the Service Flow param  structure */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8TotalClassifiers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Classifier index =%d&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>
		<span class="n">psfCSType</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">cConvergenceSLTypes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Classifier index =%d&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ClassifierRulePriority</span><span class="p">)</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bClassifierPriority</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ClassifierRulePriority</span><span class="p">)</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bClassifierPriority</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">ucDsxType</span> <span class="o">==</span> <span class="n">DSA_ACK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">eClassifierAction</span> <span class="o">=</span> <span class="n">eAddClassifier</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ucDsxType</span> <span class="o">==</span> <span class="n">DSC_ACK</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">u8ClassfierDSCAction</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="mi">0</span>: <span class="cm">/* DSC Add Classifier */</span>
			<span class="p">{</span>
				<span class="n">eClassifierAction</span> <span class="o">=</span> <span class="n">eAddClassifier</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">1</span>: <span class="cm">/* DSC Replace Classifier */</span>
			<span class="p">{</span>
				<span class="n">eClassifierAction</span> <span class="o">=</span> <span class="n">eReplaceClassifier</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">2</span>: <span class="cm">/* DSC Delete Classifier */</span>
			<span class="p">{</span>
				<span class="n">eClassifierAction</span> <span class="o">=</span> <span class="n">eDeleteClassifier</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
			<span class="p">{</span>
				<span class="n">eClassifierAction</span> <span class="o">=</span> <span class="n">eInvalidClassifierAction</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="n">u16PacketClassificationRuleIndex</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>

		<span class="k">switch</span> <span class="p">(</span><span class="n">eClassifierAction</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">eAddClassifier</span>:
		<span class="p">{</span>
			<span class="cm">/* Get a Free Classifier Index From Classifier table for this SF to add the Classifier */</span>
			<span class="cm">/* Contained in this message */</span>
			<span class="n">nClassifierIndex</span> <span class="o">=</span> <span class="n">SearchClsid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">,</span> <span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">nClassifierIndex</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">nClassifierIndex</span> <span class="o">=</span> <span class="n">SearchFreeClsid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">nClassifierIndex</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">)</span> <span class="p">{</span>
					<span class="cm">/* Failed To get a free Entry */</span>
					<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Error Failed To get a free Classifier Entry&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="cm">/* Copy the Classifier Rule for this service flow into our Classifier table maintained per SF. */</span>
				<span class="n">CopyClassifierRuleToSF</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">psfCSType</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">nClassifierIndex</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="cm">/* This Classifier Already Exists and it is invalid to Add Classifier with existing PCRI */</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>
						<span class="s">&quot;CopyToAdapter: Error The Specified Classifier Already Exists and attempted To Add Classifier with Same PCRI : 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
						<span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">eReplaceClassifier</span>:
		<span class="p">{</span>
			<span class="cm">/* Get the Classifier Index From Classifier table for this SF and replace existing  Classifier */</span>
			<span class="cm">/* with the new classifier Contained in this message */</span>
			<span class="n">nClassifierIndex</span> <span class="o">=</span> <span class="n">SearchClsid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">,</span> <span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">nClassifierIndex</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">)</span> <span class="p">{</span>
				<span class="cm">/* Failed To search the classifier */</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Error Search for Classifier To be replaced failed&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="cm">/* Copy the Classifier Rule for this service flow into our Classifier table maintained per SF. */</span>
			<span class="n">CopyClassifierRuleToSF</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">psfCSType</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">nClassifierIndex</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">eDeleteClassifier</span>:
		<span class="p">{</span>
			<span class="cm">/* Get the Classifier Index From Classifier table for this SF and replace existing  Classifier */</span>
			<span class="cm">/* with the new classifier Contained in this message */</span>
			<span class="n">nClassifierIndex</span> <span class="o">=</span> <span class="n">SearchClsid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">,</span> <span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">nClassifierIndex</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">)</span>	<span class="p">{</span>
				<span class="cm">/* Failed To search the classifier */</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Error Search for Classifier To be deleted failed&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="cm">/* Delete This classifier */</span>
			<span class="n">DeleteClassifierRuleFromSF</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">nClassifierIndex</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
		<span class="p">{</span>
			<span class="cm">/* Invalid Action for classifier */</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="cm">/* Repeat parsing Classification Entries to process PHS Rules */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8TotalClassifiers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">psfCSType</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">cConvergenceSLTypes</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;psfCSType-&gt;u8PhsDSCAction : 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">u8PhsDSCAction</span><span class="p">);</span>

		<span class="k">switch</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">u8PhsDSCAction</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">eDeleteAllPHSRules</span>:
		<span class="p">{</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Deleting All PHS Rules For VCID: 0x%X</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">uVCID</span><span class="p">);</span>

			<span class="cm">/* Delete All the PHS rules for this Service flow */</span>
			<span class="n">PhsDeleteSFRules</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stBCMPhsContext</span><span class="p">,</span> <span class="n">uVCID</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">case</span> <span class="n">eDeletePHSRule</span>:
		<span class="p">{</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;PHS DSC Action = Delete PHS Rule</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">)</span>
				<span class="n">PhsDeletePHSRule</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stBCMPhsContext</span><span class="p">,</span> <span class="n">uVCID</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8AssociatedPHSI</span><span class="p">);</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="nl">default:</span>
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ucDsxType</span> <span class="o">==</span> <span class="n">DSC_ACK</span><span class="p">)</span> <span class="p">{</span>
				<span class="cm">/* BCM_DEBUG_PRINT(CONN_MSG,(&quot;Invalid PHS DSC Action For DSC\n&quot;,psfCSType-&gt;cPhsRule.u8PHSI)); */</span>
				<span class="k">break</span><span class="p">;</span> <span class="cm">/* FOr DSC ACK Case PHS DSC Action must be in valid set */</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="cm">/* Proceed To Add PHS rule for DSA_ACK case even if PHS DSC action is unspecified */</span>
		<span class="cm">/* No Break Here . Intentionally! */</span>

		<span class="k">case</span> <span class="n">eAddPHSRule</span>:
		<span class="k">case</span> <span class="n">eSetPHSRule</span>:
		<span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">)</span>	<span class="p">{</span>
				<span class="cm">/* Apply This PHS Rule to all classifiers whose Associated PHSI Match */</span>
				<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">uiClassifierIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Direction</span> <span class="o">==</span> <span class="n">UPLINK_DIR</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">for</span> <span class="p">(</span><span class="n">uiClassifierIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiClassifierIndex</span> <span class="o">&lt;</span> <span class="n">MAX_CLASSIFIERS</span><span class="p">;</span> <span class="n">uiClassifierIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">((</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">bUsed</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
							<span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">ulSFID</span> <span class="o">==</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ulSFID</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
							<span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">u8AssociatedPHSI</span> <span class="o">==</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>
									<span class="s">&quot;Adding PHS Rule For Classifier: 0x%x cPhsRule.u8PHSI: 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
									<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">uiClassifierRuleIndex</span><span class="p">,</span>
									<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">);</span>
							<span class="cm">/* Update The PHS Rule for this classifier as Associated PHSI id defined */</span>

							<span class="cm">/* Copy the PHS Rule */</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSFLength</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSFLength</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSMLength</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSMLength</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSS</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSS</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSV</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSV</span><span class="p">;</span>
							<span class="n">memcpy</span><span class="p">(</span><span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSF</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSF</span><span class="p">,</span> <span class="n">MAX_PHS_LENGTHS</span><span class="p">);</span>
							<span class="n">memcpy</span><span class="p">(</span><span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSM</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSM</span><span class="p">,</span> <span class="n">MAX_PHS_LENGTHS</span><span class="p">);</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8RefCnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">bUnclassifiedPHSRule</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">PHSModifiedBytes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">PHSModifiedNumPackets</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
							<span class="n">sPhsRule</span><span class="p">.</span><span class="n">PHSErrorNumPackets</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

							<span class="cm">/* bPHSRuleAssociated = TRUE; */</span>
							<span class="cm">/* Store The PHS Rule for this classifier */</span>

							<span class="n">PhsUpdateClassifierRule</span><span class="p">(</span>
								<span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stBCMPhsContext</span><span class="p">,</span>
								<span class="n">uVCID</span><span class="p">,</span>
								<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">uiClassifierRuleIndex</span><span class="p">,</span>
								<span class="o">&amp;</span><span class="n">sPhsRule</span><span class="p">,</span>
								<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">u8AssociatedPHSI</span><span class="p">);</span>

							<span class="cm">/* Update PHS Rule For the Classifier */</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">u32PHSRuleID</span> <span class="o">=</span> <span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">;</span>
								<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astClassifierTable</span><span class="p">[</span><span class="n">uiClassifierIndex</span><span class="p">].</span><span class="n">sPhsRule</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sPhsRule</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">S_PHS_RULE</span><span class="p">));</span>
							<span class="p">}</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="cm">/* Error PHS Rule specified in signaling could not be applied to any classifier */</span>

					<span class="cm">/* Copy the PHS Rule */</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSFLength</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSFLength</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSMLength</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSMLength</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSS</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSS</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSV</span> <span class="o">=</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSV</span><span class="p">;</span>
					<span class="n">memcpy</span><span class="p">(</span><span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSF</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSF</span><span class="p">,</span> <span class="n">MAX_PHS_LENGTHS</span><span class="p">);</span>
					<span class="n">memcpy</span><span class="p">(</span><span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSM</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cPhsRule</span><span class="p">.</span><span class="n">u8PHSM</span><span class="p">,</span> <span class="n">MAX_PHS_LENGTHS</span><span class="p">);</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8RefCnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">bUnclassifiedPHSRule</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">PHSModifiedBytes</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">PHSModifiedNumPackets</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">sPhsRule</span><span class="p">.</span><span class="n">PHSErrorNumPackets</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="cm">/* Store The PHS Rule for this classifier */</span>

					<span class="cm">/*</span>
<span class="cm">					 * Passing the argument u8PHSI instead of clsid. Because for DL with no classifier rule,</span>
<span class="cm">					 * clsid will be zero hence we can&#39;t have multiple PHS rules for the same SF.</span>
<span class="cm">					 * To support multiple PHS rule, passing u8PHSI.</span>
<span class="cm">					 */</span>
					<span class="n">PhsUpdateClassifierRule</span><span class="p">(</span>
						<span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stBCMPhsContext</span><span class="p">,</span>
						<span class="n">uVCID</span><span class="p">,</span>
						<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">,</span>
						<span class="o">&amp;</span><span class="n">sPhsRule</span><span class="p">,</span>
						<span class="n">sPhsRule</span><span class="p">.</span><span class="n">u8PHSI</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32MaxSustainedTrafficRate</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* No Rate Limit . Set Max Sustained Traffic Rate to Maximum */</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxAllowedRate</span> <span class="o">=</span> <span class="n">WIMAX_MAX_ALLOWED_RATE</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">ntohl</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32MaxSustainedTrafficRate</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">WIMAX_MAX_ALLOWED_RATE</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Too large Allowed Rate specified. Limiting to Wi Max  Allowed rate */</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxAllowedRate</span> <span class="o">=</span> <span class="n">WIMAX_MAX_ALLOWED_RATE</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxAllowedRate</span> <span class="o">=</span>  <span class="n">ntohl</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32MaxSustainedTrafficRate</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxLatency</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32MaximumLatency</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxLatency</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="cm">/* 0 should be treated as infinite */</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxLatency</span> <span class="o">=</span> <span class="n">MAX_LATENCY_ALLOWED</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">u8QueueType</span> <span class="o">==</span> <span class="n">ERTPS</span> <span class="o">||</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">u8QueueType</span> <span class="o">==</span> <span class="n">UGS</span><span class="p">))</span>
		<span class="n">UGIValue</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u16UnsolicitedGrantInterval</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">UGIValue</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">UGIValue</span> <span class="o">=</span> <span class="n">DEFAULT_UG_INTERVAL</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * For UGI based connections...</span>
<span class="cm">	 * DEFAULT_UGI_FACTOR*UGIInterval worth of data is the max token count at host...</span>
<span class="cm">	 * The extra amount of token is to ensure that a large amount of jitter won&#39;t have loss in throughput...</span>
<span class="cm">	 * In case of non-UGI based connection, 200 frames worth of data is the max token count at host...</span>
<span class="cm">	 */</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxBucketSize</span> <span class="o">=</span>
		<span class="p">(</span><span class="n">DEFAULT_UGI_FACTOR</span><span class="o">*</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxAllowedRate</span><span class="o">*</span><span class="n">UGIValue</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxBucketSize</span> <span class="o">&lt;</span> <span class="n">WIMAX_MAX_MTU</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">UINT</span> <span class="n">UGIFactor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="cm">/* Special Handling to ensure the biggest size of packet can go out from host to FW as follows:</span>
<span class="cm">		 * 1. Any packet from Host to FW can go out in different packet size.</span>
<span class="cm">		 * 2. So in case the Bucket count is smaller than MTU, the packets of size (Size &gt; TokenCount), will get dropped.</span>
<span class="cm">		 * 3. We can allow packets of MaxSize from Host-&gt;FW that can go out from FW in multiple SDUs by fragmentation at Wimax Layer</span>
<span class="cm">		 */</span>
		<span class="n">UGIFactor</span> <span class="o">=</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxLatency</span><span class="o">/</span><span class="n">UGIValue</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">UGIFactor</span> <span class="o">&gt;</span> <span class="n">DEFAULT_UGI_FACTOR</span><span class="p">)</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxBucketSize</span> <span class="o">=</span>
				<span class="p">(</span><span class="n">UGIFactor</span><span class="o">*</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxAllowedRate</span><span class="o">*</span><span class="n">UGIValue</span><span class="p">)</span><span class="o">/</span><span class="mi">1000</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxBucketSize</span> <span class="o">&gt;</span> <span class="n">WIMAX_MAX_MTU</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxBucketSize</span> <span class="o">=</span> <span class="n">WIMAX_MAX_MTU</span><span class="o">*</span><span class="mi">8</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;LAT: %d, UGI: %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxLatency</span><span class="p">,</span> <span class="n">UGIValue</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;uiMaxAllowedRate: 0x%x, u32MaxSustainedTrafficRate: 0x%x ,uiMaxBucketSize: 0x%x&quot;</span><span class="p">,</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxAllowedRate</span><span class="p">,</span>
			<span class="n">ntohl</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32MaxSustainedTrafficRate</span><span class="p">),</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiMaxBucketSize</span><span class="p">);</span>

	<span class="cm">/* copy the extended SF Parameters to Support MIBS */</span>
	<span class="n">CopyMIBSExtendedSFParameters</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">psfLocalSet</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>

	<span class="cm">/* store header suppression enabled flag per SF */</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bHeaderSuppressionEnabled</span> <span class="o">=</span>
		<span class="o">!</span><span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u8RequesttransmissionPolicy</span> <span class="o">&amp;</span>
			<span class="n">MASK_DISABLE_HEADER_SUPPRESSION</span><span class="p">);</span>

	<span class="n">kfree</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">pstSFIndication</span><span class="p">);</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">pstSFIndication</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="p">;</span>

	<span class="cm">/* Re Sort the SF list in PackInfo according to Traffic Priority */</span>
	<span class="n">SortPackInfo</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>

	<span class="cm">/* Re Sort the Classifier Rules table and re - arrange</span>
<span class="cm">	 * according to Classifier Rule Priority</span>
<span class="cm">	 */</span>
	<span class="n">SortClassifiers</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="n">DumpPhsRules</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stBCMPhsContext</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;%s &lt;=====&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/***********************************************************************</span>
<span class="cm"> * Function - DumpCmControlPacket</span>
<span class="cm"> *</span>
<span class="cm"> * Description - This routinue Dumps the Contents of the AddIndication</span>
<span class="cm"> *  Structure in the Connection Management Control Packet</span>
<span class="cm"> *</span>
<span class="cm"> * Parameter - pvBuffer: Pointer to the buffer containing the</span>
<span class="cm"> *  AddIndication data.</span>
<span class="cm"> *</span>
<span class="cm"> * Returns - None</span>
<span class="cm"> *************************************************************************/</span>
<span class="k">static</span> <span class="n">VOID</span> <span class="nf">DumpCmControlPacket</span><span class="p">(</span><span class="n">PVOID</span> <span class="n">pvBuffer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">uiLoopIndex</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">nIndex</span><span class="p">;</span>
	<span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="n">pstAddIndication</span><span class="p">;</span>
	<span class="n">UINT</span> <span class="n">nCurClassifierCnt</span><span class="p">;</span>
	<span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span> <span class="o">=</span> <span class="n">GET_BCM_ADAPTER</span><span class="p">(</span><span class="n">gblpnetdev</span><span class="p">);</span>

	<span class="n">pstAddIndication</span> <span class="o">=</span> <span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="n">pvBuffer</span><span class="p">;</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;======&gt;&quot;</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8Type: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8Direction: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16TID: 0x%X&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16CID: 0x%X&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16CID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16VCID: 0x%X&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; AuthorizedSet---&gt;&quot;</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32SFID: 0x%X&quot;</span><span class="p">,</span> <span class="n">htonl</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u32SFID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16CID: 0x%X&quot;</span><span class="p">,</span> <span class="n">htons</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16CID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceClassNameLength: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceClassNameLength</span><span class="p">);</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceClassName: 0x%X ,0x%X , 0x%X, 0x%X, 0x%X, 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8MBSService: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8MBSService</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8QosParamSet: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8QosParamSet</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8TrafficPriority: 0x%X, %p&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TrafficPriority</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TrafficPriority</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MaxSustainedTrafficRate: 0x%X 0x%p&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u32MaxSustainedTrafficRate</span><span class="p">,</span>
			<span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u32MaxSustainedTrafficRate</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MaxTrafficBurst: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u32MaxTrafficBurst</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MinReservedTrafficRate	: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u32MinReservedTrafficRate</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificQoSParamLength: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8VendorSpecificQoSParamLength</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificQoSParam: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8VendorSpecificQoSParam</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceFlowSchedulingType: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ServiceFlowSchedulingType</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32ToleratedJitter: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u32ToleratedJitter</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MaximumLatency: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u32MaximumLatency</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8FixedLengthVSVariableLengthSDUIndicator: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8FixedLengthVSVariableLengthSDUIndicator</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8SDUSize: 0x%X&quot;</span><span class="p">,</span>	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8SDUSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16TargetSAID: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16TargetSAID</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ARQEnable: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ARQEnable</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQWindowSize: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16ARQWindowSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQRetryTxTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16ARQRetryTxTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQRetryRxTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16ARQRetryRxTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQBlockLifeTime: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16ARQBlockLifeTime</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQSyncLossTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16ARQSyncLossTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ARQDeliverInOrder: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8ARQDeliverInOrder</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQRxPurgeTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16ARQRxPurgeTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQBlockSize: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16ARQBlockSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8CSSpecification: 0x%X&quot;</span><span class="p">,</span>	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8CSSpecification</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8TypeOfDataDeliveryService: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TypeOfDataDeliveryService</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16SDUInterArrivalTime: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16SDUInterArrivalTime</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16TimeBase: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16TimeBase</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8PagingPreference: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8PagingPreference</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16UnsolicitedPollingInterval: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16UnsolicitedPollingInterval</span><span class="p">);</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;sfAuthorizedSet.u8HARQChannelMapping %x  %x %x &quot;</span><span class="p">,</span>
			<span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8HARQChannelMapping</span><span class="p">,</span>
			<span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8HARQChannelMapping</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
			<span class="o">*</span><span class="p">(</span><span class="n">USHORT</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8HARQChannelMapping</span><span class="p">[</span><span class="mi">8</span><span class="p">]);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8TrafficIndicationPreference: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TrafficIndicationPreference</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; Total Classifiers Received: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span><span class="p">);</span>

	<span class="n">nCurClassifierCnt</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nCurClassifierCnt</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">)</span>
		<span class="n">nCurClassifierCnt</span> <span class="o">=</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>  <span class="s">&quot;pstAddIndication-&gt;sfAuthorizedSet.bValid %d&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>  <span class="s">&quot;pstAddIndication-&gt;sfAuthorizedSet.u16MacOverhead %x&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u16MacOverhead</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">)</span>
		<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">nIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nIndex</span> <span class="o">&lt;</span> <span class="n">nCurClassifierCnt</span><span class="p">;</span> <span class="n">nIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stConvergenceSLTypes</span> <span class="o">*</span><span class="n">psfCSType</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">psfCSType</span> <span class="o">=</span>  <span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">cConvergenceSLTypes</span><span class="p">[</span><span class="n">nIndex</span><span class="p">];</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;psfCSType = %p&quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;CCPacketClassificationRuleSI====&gt;&quot;</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ClassifierRulePriority: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ClassifierRulePriority</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>  <span class="s">&quot;u8IPTypeOfServiceLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfServiceLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPTypeOfService[3]: 0x%X ,0x%X ,0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8Protocol: 0x%02X &quot;</span><span class="p">,</span>
					<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Protocol</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPMaskedSourceAddressLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddressLength</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPMaskedSourceAddress[32]: 0x%02X &quot;</span><span class="p">,</span>
					<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddress</span><span class="p">[</span><span class="n">uiLoopIndex</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPDestinationAddressLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddressLength</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPDestinationAddress[32]: 0x%02X &quot;</span><span class="p">,</span>
					<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddress</span><span class="p">[</span><span class="n">uiLoopIndex</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolSourcePortRangeLength:0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRangeLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolSourcePortRange[4]: 0x%02X ,0x%02X ,0x%02X ,0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolDestPortRangeLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRangeLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolDestPortRange[4]: 0x%02X ,0x%02X ,0x%02X ,0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetDestMacAddressLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddressLength</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetDestMacAddress[6]: 0x %02X %02X %02X %02X %02X %02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetSourceMACAddressLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddressLength</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetSourceMACAddress[6]: 0x %02X %02X %02X %02X %02X %02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthertypeLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthertypeLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8Ethertype[3]: 0x%02X ,0x%02X ,0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16UserPriority: 0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16UserPriority</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16VLANID: 0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16VLANID</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8AssociatedPHSI: 0x%02X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8AssociatedPHSI</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16PacketClassificationRuleIndex: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificClassifierParamLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8VendorSpecificClassifierParamLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificClassifierParam[1]: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8VendorSpecificClassifierParam</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="cp">#ifdef VERSION_D5</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPv6FlowLableLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLableLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPv6FlowLable[6]: 0x %02X %02X %02X %02X %02X %02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
<span class="cp">#endif</span>
	<span class="p">}</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;bValid: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AdmittedSet---&gt;&quot;</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32SFID: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u32SFID</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16CID: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16CID</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceClassNameLength: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceClassNameLength</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceClassName: 0x %02X %02X %02X %02X %02X %02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8MBSService: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8MBSService</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8QosParamSet: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8QosParamSet</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8TrafficPriority: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8TrafficPriority</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MaxTrafficBurst: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u32MaxTrafficBurst</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MinReservedTrafficRate: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u32MinReservedTrafficRate</span><span class="p">);</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificQoSParamLength: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8VendorSpecificQoSParamLength</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificQoSParam: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8VendorSpecificQoSParam</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceFlowSchedulingType: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ServiceFlowSchedulingType</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32ToleratedJitter: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u32ToleratedJitter</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MaximumLatency: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u32MaximumLatency</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8FixedLengthVSVariableLengthSDUIndicator: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8FixedLengthVSVariableLengthSDUIndicator</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8SDUSize: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8SDUSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16TargetSAID: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16TargetSAID</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ARQEnable: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ARQEnable</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQWindowSize: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16ARQWindowSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQRetryTxTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16ARQRetryTxTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQRetryRxTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16ARQRetryRxTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQBlockLifeTime: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16ARQBlockLifeTime</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQSyncLossTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16ARQSyncLossTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ARQDeliverInOrder: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8ARQDeliverInOrder</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQRxPurgeTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16ARQRxPurgeTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16ARQBlockSize: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16ARQBlockSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8CSSpecification: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8CSSpecification</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8TypeOfDataDeliveryService: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8TypeOfDataDeliveryService</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16SDUInterArrivalTime: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16SDUInterArrivalTime</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16TimeBase: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u16TimeBase</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8PagingPreference: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8PagingPreference</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8TrafficIndicationPreference: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8TrafficIndicationPreference</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; Total Classifiers Received: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span><span class="p">);</span>

	<span class="n">nCurClassifierCnt</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nCurClassifierCnt</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">)</span>
		<span class="n">nCurClassifierCnt</span> <span class="o">=</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">nIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nIndex</span> <span class="o">&lt;</span> <span class="n">nCurClassifierCnt</span><span class="p">;</span> <span class="n">nIndex</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stConvergenceSLTypes</span> <span class="o">*</span><span class="n">psfCSType</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

		<span class="n">psfCSType</span> <span class="o">=</span>  <span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">cConvergenceSLTypes</span><span class="p">[</span><span class="n">nIndex</span><span class="p">];</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; CCPacketClassificationRuleSI====&gt;&quot;</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ClassifierRulePriority: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ClassifierRulePriority</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPTypeOfServiceLength: 0x%02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfServiceLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPTypeOfService[3]: 0x%02X %02X %02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8Protocol: 0x%02X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Protocol</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPMaskedSourceAddressLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddressLength</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPMaskedSourceAddress[32]: 0x%02X &quot;</span><span class="p">,</span>
					<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddress</span><span class="p">[</span><span class="n">uiLoopIndex</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPDestinationAddressLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddressLength</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPDestinationAddress[32]: 0x%02X &quot;</span><span class="p">,</span>
					<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddress</span><span class="p">[</span><span class="n">uiLoopIndex</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolSourcePortRangeLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRangeLength</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolSourcePortRange[4]: 0x %02X %02X %02X %02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolDestPortRangeLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRangeLength</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ProtocolDestPortRange[4]: 0x %02X %02X %02X %02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetDestMacAddressLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddressLength</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetDestMacAddress[6]: 0x %02X %02X %02X %02X %02X %02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetSourceMACAddressLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddressLength</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetSourceMACAddress[6]: 0x %02X %02X %02X %02X %02X %02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthertypeLength: 0x%02X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthertypeLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8Ethertype[3]: 0x%02X %02X %02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16UserPriority: 0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16UserPriority</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16VLANID: 0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16VLANID</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8AssociatedPHSI: 0x%02X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8AssociatedPHSI</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16PacketClassificationRuleIndex: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificClassifierParamLength: 0x%02X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8VendorSpecificClassifierParamLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificClassifierParam[1]: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8VendorSpecificClassifierParam</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="cp">#ifdef VERSION_D5</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPv6FlowLableLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLableLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPv6FlowLable[6]: 0x %02X %02X %02X %02X %02X %02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
<span class="cp">#endif</span>
	<span class="p">}</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;bValid: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; ActiveSet---&gt;&quot;</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32SFID: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u32SFID</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u16CID: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16CID</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceClassNameLength: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceClassNameLength</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceClassName: 0x %02X %02X %02X %02X %02X %02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceClassName</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8MBSService: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8MBSService</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8QosParamSet: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8QosParamSet</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8TrafficPriority: 0x%02X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8TrafficPriority</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MaxTrafficBurst: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u32MaxTrafficBurst</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MinReservedTrafficRate: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u32MinReservedTrafficRate</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificQoSParamLength: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8VendorSpecificQoSParamLength</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8VendorSpecificQoSParam: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8VendorSpecificQoSParam</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8ServiceFlowSchedulingType: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ServiceFlowSchedulingType</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32ToleratedJitter: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u32ToleratedJitter</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32MaximumLatency: 0x%X&quot;</span><span class="p">,</span>	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u32MaximumLatency</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8FixedLengthVSVariableLengthSDUIndicator: 0x%02X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8FixedLengthVSVariableLengthSDUIndicator</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8SDUSize: 0x%X&quot;</span><span class="p">,</span>	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8SDUSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16TargetSAID: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16TargetSAID</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8ARQEnable: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ARQEnable</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16ARQWindowSize: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16ARQWindowSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16ARQRetryTxTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16ARQRetryTxTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16ARQRetryRxTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16ARQRetryRxTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16ARQBlockLifeTime: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16ARQBlockLifeTime</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16ARQSyncLossTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16ARQSyncLossTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8ARQDeliverInOrder: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8ARQDeliverInOrder</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16ARQRxPurgeTimeOut: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16ARQRxPurgeTimeOut</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16ARQBlockSize: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16ARQBlockSize</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8CSSpecification: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8CSSpecification</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8TypeOfDataDeliveryService: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8TypeOfDataDeliveryService</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16SDUInterArrivalTime: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16SDUInterArrivalTime</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16TimeBase: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u16TimeBase</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8PagingPreference: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8PagingPreference</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8TrafficIndicationPreference: 0x%X&quot;</span><span class="p">,</span>
			<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8TrafficIndicationPreference</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; Total Classifiers Received: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span><span class="p">);</span>

	<span class="n">nCurClassifierCnt</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">nCurClassifierCnt</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">)</span>
		<span class="n">nCurClassifierCnt</span> <span class="o">=</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">nIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">nIndex</span> <span class="o">&lt;</span> <span class="n">nCurClassifierCnt</span><span class="p">;</span> <span class="n">nIndex</span><span class="o">++</span><span class="p">)</span>	<span class="p">{</span>
		<span class="n">stConvergenceSLTypes</span> <span class="o">*</span><span class="n">psfCSType</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

		<span class="n">psfCSType</span> <span class="o">=</span>  <span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">cConvergenceSLTypes</span><span class="p">[</span><span class="n">nIndex</span><span class="p">];</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; CCPacketClassificationRuleSI====&gt;&quot;</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8ClassifierRulePriority: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ClassifierRulePriority</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8IPTypeOfServiceLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfServiceLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8IPTypeOfService[3]: 0x%X ,0x%X ,0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPTypeOfService</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8Protocol: 0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Protocol</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPMaskedSourceAddressLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddressLength</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPMaskedSourceAddress[32]: 0x%X &quot;</span><span class="p">,</span>
					<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPMaskedSourceAddress</span><span class="p">[</span><span class="n">uiLoopIndex</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8IPDestinationAddressLength: 0x%02X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddressLength</span><span class="p">);</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">uiLoopIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">uiLoopIndex</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="n">uiLoopIndex</span><span class="o">++</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8IPDestinationAddress[32]:0x%X &quot;</span><span class="p">,</span>
					<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPDestinationAddress</span><span class="p">[</span><span class="n">uiLoopIndex</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8ProtocolSourcePortRangeLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRangeLength</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8ProtocolSourcePortRange[4]: 0x%X ,0x%X ,0x%X ,0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolSourcePortRange</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8ProtocolDestPortRangeLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRangeLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8ProtocolDestPortRange[4]: 0x%X ,0x%X ,0x%X ,0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8ProtocolDestPortRange</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8EthernetDestMacAddressLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddressLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8EthernetDestMacAddress[6]: 0x%X ,0x%X ,0x%X ,0x%X ,0x%X ,0x%X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddress</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8EthernetSourceMACAddressLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetDestMacAddressLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u8EthernetSourceMACAddress[6]: 0x%X ,0x%X ,0x%X ,0x%X ,0x%X ,0x%X&quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthernetSourceMACAddress</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8EthertypeLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8EthertypeLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8Ethertype[3]: 0x%X ,0x%X ,0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8Ethertype</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16UserPriority: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16UserPriority</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16VLANID: 0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16VLANID</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8AssociatedPHSI: 0x%X &quot;</span><span class="p">,</span> <span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8AssociatedPHSI</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u16PacketClassificationRuleIndex:0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u16PacketClassificationRuleIndex</span><span class="p">);</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8VendorSpecificClassifierParamLength:0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8VendorSpecificClassifierParamLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8VendorSpecificClassifierParam[1]:0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8VendorSpecificClassifierParam</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="cp">#ifdef VERSION_D5</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8IPv6FlowLableLength: 0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLableLength</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; u8IPv6FlowLable[6]: 0x%X ,0x%X ,0x%X ,0x%X ,0x%X ,0x%X &quot;</span><span class="p">,</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span>
				<span class="n">psfCSType</span><span class="o">-&gt;</span><span class="n">cCPacketClassificationRule</span><span class="p">.</span><span class="n">u8IPv6FlowLable</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
<span class="cp">#endif</span>
	<span class="p">}</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">DUMP_CONTROL</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; bValid: 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">ULONG</span> <span class="nf">RestoreSFParam</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">ULONG</span> <span class="n">ulAddrSFParamSet</span><span class="p">,</span> <span class="n">PUCHAR</span> <span class="n">pucDestBuffer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">UINT</span>  <span class="n">nBytesToRead</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stServiceFlowParamSI</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ulAddrSFParamSet</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">pucDestBuffer</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Got Param address as 0!!&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ulAddrSFParamSet</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">ulAddrSFParamSet</span><span class="p">);</span>

	<span class="cm">/* Read out the SF Param Set At the indicated Location */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">rdm</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulAddrSFParamSet</span><span class="p">,</span> <span class="p">(</span><span class="n">PUCHAR</span><span class="p">)</span><span class="n">pucDestBuffer</span><span class="p">,</span> <span class="n">nBytesToRead</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">STATUS_FAILURE</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">ULONG</span> <span class="nf">StoreSFParam</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">PUCHAR</span> <span class="n">pucSrcBuffer</span><span class="p">,</span> <span class="n">ULONG</span> <span class="n">ulAddrSFParamSet</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">UINT</span> <span class="n">nBytesToWrite</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stServiceFlowParamSI</span><span class="p">);</span>
	<span class="kt">int</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ulAddrSFParamSet</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nb">NULL</span> <span class="o">==</span> <span class="n">pucSrcBuffer</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">ret</span> <span class="o">=</span> <span class="n">wrm</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulAddrSFParamSet</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">pucSrcBuffer</span><span class="p">,</span> <span class="n">nBytesToWrite</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;%s:%d WRM failed&quot;</span><span class="p">,</span> <span class="n">__func__</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ULONG</span> <span class="nf">StoreCmControlResponseMessage</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">PVOID</span> <span class="n">pvBuffer</span><span class="p">,</span> <span class="n">UINT</span> <span class="o">*</span><span class="n">puBufferLength</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="n">pstAddIndicationAlt</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">stLocalSFAddIndication</span> <span class="o">*</span><span class="n">pstAddIndication</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">stLocalSFDeleteRequest</span> <span class="o">*</span><span class="n">pstDeletionRequest</span><span class="p">;</span>
	<span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span><span class="p">;</span>
	<span class="n">ULONG</span> <span class="n">ulSFID</span><span class="p">;</span>

	<span class="n">pstAddIndicationAlt</span> <span class="o">=</span> <span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="p">)(</span><span class="n">pvBuffer</span><span class="p">);</span>

	<span class="cm">/*</span>
<span class="cm">	 * In case of DSD Req By MS, we should immediately delete this SF so that</span>
<span class="cm">	 * we can stop the further classifying the pkt for this SF.</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">==</span> <span class="n">DSD_REQ</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pstDeletionRequest</span> <span class="o">=</span> <span class="p">(</span><span class="n">stLocalSFDeleteRequest</span> <span class="o">*</span><span class="p">)</span><span class="n">pvBuffer</span><span class="p">;</span>

		<span class="n">ulSFID</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstDeletionRequest</span><span class="o">-&gt;</span><span class="n">u32SFID</span><span class="p">);</span>
		<span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="n">SearchSfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">uiSearchRuleIndex</span> <span class="o">&lt;</span> <span class="n">NO_OF_QUEUES</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">deleteSFBySfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">u32TotalDSD</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">==</span> <span class="n">DSD_RSP</span><span class="p">)</span> <span class="o">||</span>
		<span class="p">(</span><span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">==</span> <span class="n">DSD_ACK</span><span class="p">))</span> <span class="p">{</span>
		<span class="cm">/* No Special handling send the message as it is */</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/* For DSA_REQ, only up to &quot;psfAuthorizedSet&quot; parameter should be accessed by driver! */</span>

	<span class="n">pstAddIndication</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">pstAddIndication</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* AUTHORIZED SET */</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span> <span class="o">=</span> <span class="p">(</span><span class="n">stServiceFlowParamSI</span> <span class="o">*</span><span class="p">)</span>
			<span class="n">GetNextTargetBufferLocation</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">StoreSFParam</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">PUCHAR</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">,</span>
				<span class="p">(</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* this can&#39;t possibly be right */</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span> <span class="o">=</span> <span class="p">(</span><span class="n">stServiceFlowParamSI</span> <span class="o">*</span><span class="p">)</span><span class="n">ntohl</span><span class="p">((</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">==</span> <span class="n">DSA_REQ</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">stLocalSFAddRequest</span> <span class="n">AddRequest</span><span class="p">;</span>

		<span class="n">AddRequest</span><span class="p">.</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Type</span><span class="p">;</span>
		<span class="n">AddRequest</span><span class="p">.</span><span class="n">eConnectionDir</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">;</span>
		<span class="n">AddRequest</span><span class="p">.</span><span class="n">u16TID</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">;</span>
		<span class="n">AddRequest</span><span class="p">.</span><span class="n">u16CID</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16CID</span><span class="p">;</span>
		<span class="n">AddRequest</span><span class="p">.</span><span class="n">u16VCID</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">;</span>
		<span class="n">AddRequest</span><span class="p">.</span><span class="n">psfParameterSet</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span><span class="p">;</span>
		<span class="p">(</span><span class="o">*</span><span class="n">puBufferLength</span><span class="p">)</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddRequest</span><span class="p">);</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">pvBuffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">AddRequest</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddRequest</span><span class="p">));</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* Since it&#39;s not DSA_REQ, we can access all field in pstAddIndicationAlt */</span>
	<span class="cm">/* We need to extract the structure from the buffer and pack it differently */</span>

	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Type</span><span class="p">;</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">eConnectionDir</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">;</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16TID</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">;</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16CID</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16CID</span><span class="p">;</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">;</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8CC</span> <span class="o">=</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u8CC</span><span class="p">;</span>

	<span class="cm">/* ADMITTED SET */</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAdmittedSet</span> <span class="o">=</span> <span class="p">(</span><span class="n">stServiceFlowParamSI</span> <span class="o">*</span><span class="p">)</span>
		<span class="n">GetNextTargetBufferLocation</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAdmittedSet</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">StoreSFParam</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">PUCHAR</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">,</span> <span class="p">(</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAdmittedSet</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAdmittedSet</span> <span class="o">=</span> <span class="p">(</span><span class="n">stServiceFlowParamSI</span> <span class="o">*</span><span class="p">)</span><span class="n">ntohl</span><span class="p">((</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAdmittedSet</span><span class="p">);</span>

	<span class="cm">/* ACTIVE SET */</span>
	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfActiveSet</span> <span class="o">=</span> <span class="p">(</span><span class="n">stServiceFlowParamSI</span> <span class="o">*</span><span class="p">)</span>
		<span class="n">GetNextTargetBufferLocation</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfActiveSet</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">StoreSFParam</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">PUCHAR</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndicationAlt</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">,</span> <span class="p">(</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfActiveSet</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfActiveSet</span> <span class="o">=</span> <span class="p">(</span><span class="n">stServiceFlowParamSI</span> <span class="o">*</span><span class="p">)</span><span class="n">ntohl</span><span class="p">((</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfActiveSet</span><span class="p">);</span>

	<span class="p">(</span><span class="o">*</span><span class="n">puBufferLength</span><span class="p">)</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddIndication</span><span class="p">);</span>
	<span class="o">*</span><span class="p">(</span><span class="n">stLocalSFAddIndication</span> <span class="o">*</span><span class="p">)</span><span class="n">pvBuffer</span> <span class="o">=</span> <span class="o">*</span><span class="n">pstAddIndication</span><span class="p">;</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">stLocalSFAddIndicationAlt</span>
<span class="o">*</span><span class="nf">RestoreCmControlResponseMessage</span><span class="p">(</span><span class="k">register</span> <span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="k">register</span> <span class="n">PVOID</span> <span class="n">pvBuffer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ULONG</span> <span class="n">ulStatus</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">stLocalSFAddIndication</span> <span class="o">*</span><span class="n">pstAddIndication</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="n">pstAddIndicationDest</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="n">pstAddIndication</span> <span class="o">=</span> <span class="p">(</span><span class="n">stLocalSFAddIndication</span> <span class="o">*</span><span class="p">)(</span><span class="n">pvBuffer</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;=====&gt;&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">==</span> <span class="n">DSD_REQ</span><span class="p">)</span> <span class="o">||</span>
		<span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">==</span> <span class="n">DSD_RSP</span><span class="p">)</span> <span class="o">||</span>
		<span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">==</span> <span class="n">DSD_ACK</span><span class="p">))</span>
		<span class="k">return</span> <span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="n">pvBuffer</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Inside RestoreCmControlResponseMessage &quot;</span><span class="p">);</span>
	<span class="cm">/*</span>
<span class="cm">	 * Need to Allocate memory to contain the SUPER Large structures</span>
<span class="cm">	 * Our driver can&#39;t create these structures on Stack :(</span>
<span class="cm">	 */</span>
	<span class="n">pstAddIndicationDest</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndicationDest</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">pstAddIndicationDest</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span><span class="p">));</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Failed to allocate memory for SF Add Indication Structure &quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-u8Type : 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-u8Direction : 0x%X&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">eConnectionDir</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-u8TID : 0x%X&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-u8CID : 0x%X&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16CID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-u16VCID : 0x%X&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-autorized set loc : %p&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-admitted set loc : %p&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAdmittedSet</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;AddIndication-Active set loc : %p&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfActiveSet</span><span class="p">);</span>

	<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span><span class="p">;</span>
	<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">u8Direction</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">eConnectionDir</span><span class="p">;</span>
	<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">u16TID</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">;</span>
	<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">u16CID</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16CID</span><span class="p">;</span>
	<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">u16VCID</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">;</span>
	<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">u8CC</span> <span class="o">=</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8CC</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>  <span class="s">&quot;Restoring Active Set &quot;</span><span class="p">);</span>
	<span class="n">ulStatus</span> <span class="o">=</span> <span class="n">RestoreSFParam</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfActiveSet</span><span class="p">,</span> <span class="p">(</span><span class="n">PUCHAR</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ulStatus</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">failed_restore_sf_param</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">)</span>
		<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span> <span class="o">=</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>  <span class="s">&quot;Restoring Admitted Set &quot;</span><span class="p">);</span>
	<span class="n">ulStatus</span> <span class="o">=</span> <span class="n">RestoreSFParam</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAdmittedSet</span><span class="p">,</span> <span class="p">(</span><span class="n">PUCHAR</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ulStatus</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">failed_restore_sf_param</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">)</span>
		<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span> <span class="o">=</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>  <span class="s">&quot;Restoring Authorized Set &quot;</span><span class="p">);</span>
	<span class="n">ulStatus</span> <span class="o">=</span> <span class="n">RestoreSFParam</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">ULONG</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">psfAuthorizedSet</span><span class="p">,</span> <span class="p">(</span><span class="n">PUCHAR</span><span class="p">)</span><span class="o">&amp;</span><span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ulStatus</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">failed_restore_sf_param</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span> <span class="o">&gt;</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">)</span>
		<span class="n">pstAddIndicationDest</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">u8TotalClassifiers</span> <span class="o">=</span> <span class="n">MAX_CLASSIFIERS_IN_SF</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Dumping the whole raw packet&quot;</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;============================================================&quot;</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; pstAddIndicationDest-&gt;sfActiveSet size  %zx %p&quot;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">pstAddIndicationDest</span><span class="p">),</span> <span class="n">pstAddIndicationDest</span><span class="p">);</span>
	<span class="cm">/* BCM_DEBUG_PRINT_BUFFER(Adapter,DBG_TYPE_OTHERS, CONN_MSG, DBG_LVL_ALL, (unsigned char *)pstAddIndicationDest, sizeof(*pstAddIndicationDest)); */</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;============================================================&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">pstAddIndicationDest</span><span class="p">;</span>
<span class="nl">failed_restore_sf_param:</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndicationDest</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;&lt;=====&quot;</span><span class="p">);</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ULONG</span> <span class="nf">SetUpTargetDsxBuffers</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ULONG</span> <span class="n">ulTargetDsxBuffersBase</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ULONG</span> <span class="n">ulCntTargetBuffers</span><span class="p">;</span>
	<span class="n">ULONG</span> <span class="n">i</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">Status</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Adapter</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Adapter was NULL!!!&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">ulTargetDsxBuffer</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Size of Each DSX Buffer(Also size of ServiceFlowParamSI): %zx &quot;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stServiceFlowParamSI</span><span class="p">));</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Reading DSX buffer From Target location %x &quot;</span><span class="p">,</span> <span class="n">DSX_MESSAGE_EXCHANGE_BUFFER</span><span class="p">);</span>

	<span class="n">Status</span> <span class="o">=</span> <span class="n">rdmalt</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DSX_MESSAGE_EXCHANGE_BUFFER</span><span class="p">,</span> <span class="p">(</span><span class="n">PUINT</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ulTargetDsxBuffersBase</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">UINT</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Status</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;RDM failed!!&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Base Address Of DSX  Target Buffer : 0x%lx&quot;</span><span class="p">,</span> <span class="n">ulTargetDsxBuffersBase</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span>  <span class="s">&quot;Tgt Buffer is Now %lx :&quot;</span><span class="p">,</span> <span class="n">ulTargetDsxBuffersBase</span><span class="p">);</span>
	<span class="n">ulCntTargetBuffers</span> <span class="o">=</span> <span class="n">DSX_MESSAGE_EXCHANGE_BUFFER_SIZE</span> <span class="o">/</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stServiceFlowParamSI</span><span class="p">);</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span> <span class="o">=</span>
		<span class="n">ulCntTargetBuffers</span> <span class="o">&gt;</span> <span class="n">MAX_TARGET_DSX_BUFFERS</span> <span class="o">?</span>
		<span class="n">MAX_TARGET_DSX_BUFFERS</span> <span class="o">:</span> <span class="n">ulCntTargetBuffers</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; Total Target DSX Buffer setup %lx &quot;</span><span class="p">,</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ulTargetDsxBuffer</span> <span class="o">=</span> <span class="n">ulTargetDsxBuffersBase</span><span class="p">;</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">valid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">tid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">ulTargetDsxBuffersBase</span> <span class="o">+=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stServiceFlowParamSI</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;  Target DSX Buffer %lx setup at 0x%lx&quot;</span><span class="p">,</span>
				<span class="n">i</span><span class="p">,</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ulTargetDsxBuffer</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulCurrentTargetBuffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulFreeTargetBufferCnt</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">ULONG</span> <span class="nf">GetNextTargetBufferLocation</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">B_UINT16</span> <span class="n">tid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ULONG</span> <span class="n">ulTargetDSXBufferAddress</span><span class="p">;</span>
	<span class="n">ULONG</span> <span class="n">ulTargetDsxBufferIndexToUse</span><span class="p">,</span> <span class="n">ulMaxTry</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulFreeTargetBufferCnt</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">ClearTargetDSXBuffer</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">tid</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">ulTargetDsxBufferIndexToUse</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulCurrentTargetBuffer</span><span class="p">;</span>
	<span class="n">ulMaxTry</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">((</span><span class="n">ulMaxTry</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">ulTargetDsxBufferIndexToUse</span><span class="p">].</span><span class="n">valid</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">ulTargetDsxBufferIndexToUse</span> <span class="o">=</span> <span class="p">(</span><span class="n">ulTargetDsxBufferIndexToUse</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span><span class="p">;</span>
		<span class="n">ulMaxTry</span><span class="o">--</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ulMaxTry</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s"> GetNextTargetBufferLocation : Error No Free Target DSX Buffers FreeCnt : %lx &quot;</span><span class="p">,</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulFreeTargetBufferCnt</span><span class="p">);</span>
		<span class="n">ClearTargetDSXBuffer</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">tid</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">ulTargetDSXBufferAddress</span> <span class="o">=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">ulTargetDsxBufferIndexToUse</span><span class="p">].</span><span class="n">ulTargetDsxBuffer</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">ulTargetDsxBufferIndexToUse</span><span class="p">].</span><span class="n">valid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">astTargetDsxBuffer</span><span class="p">[</span><span class="n">ulTargetDsxBufferIndexToUse</span><span class="p">].</span><span class="n">tid</span> <span class="o">=</span> <span class="n">tid</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulFreeTargetBufferCnt</span><span class="o">--</span><span class="p">;</span>
	<span class="n">ulTargetDsxBufferIndexToUse</span> <span class="o">=</span> <span class="p">(</span><span class="n">ulTargetDsxBufferIndexToUse</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulTotalTargetBuffersAvailable</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ulCurrentTargetBuffer</span> <span class="o">=</span> <span class="n">ulTargetDsxBufferIndexToUse</span><span class="p">;</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;GetNextTargetBufferLocation :Returning address %lx tid %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ulTargetDSXBufferAddress</span><span class="p">,</span> <span class="n">tid</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ulTargetDSXBufferAddress</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">AllocAdapterDsxBuffer</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * Need to Allocate memory to contain the SUPER Large structures</span>
<span class="cm">	 * Our driver can&#39;t create these structures on Stack</span>
<span class="cm">	 */</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span><span class="p">)</span><span class="o">+</span><span class="n">LEADER_SIZE</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">FreeAdapterDsxBuffer</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * @ingroup ctrl_pkt_functions</span>
<span class="cm"> * This routinue would process the Control responses</span>
<span class="cm"> * for the Connection Management.</span>
<span class="cm"> * @return - Queue index for the free SFID else returns Invalid Index.</span>
<span class="cm"> */</span>
<span class="n">BOOLEAN</span> <span class="nf">CmControlResponseMessage</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span>  <span class="cm">/* &lt;Pointer to the Adapter structure */</span>
				<span class="n">PVOID</span> <span class="n">pvBuffer</span> <span class="cm">/* Starting Address of the Buffer, that contains the AddIndication Data */</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">stServiceFlowParamSI</span> <span class="o">*</span><span class="n">psfLocalSet</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="n">pstAddIndication</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="n">pstChangeIndication</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">PLEADER</span> <span class="n">pLeader</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * Otherwise the message contains a target address from where we need to</span>
<span class="cm">	 * read out the rest of the service flow param structure</span>
<span class="cm">	 */</span>
	<span class="n">pstAddIndication</span> <span class="o">=</span> <span class="n">RestoreCmControlResponseMessage</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pvBuffer</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ClearTargetDSXBuffer</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">((</span><span class="n">stLocalSFAddIndication</span> <span class="o">*</span><span class="p">)</span><span class="n">pvBuffer</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Error in restoring Service Flow param structure from DSx message&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">DumpCmControlPacket</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;====&gt;&quot;</span><span class="p">);</span>
	<span class="n">pLeader</span> <span class="o">=</span> <span class="p">(</span><span class="n">PLEADER</span><span class="p">)</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">;</span>

	<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">Status</span> <span class="o">=</span> <span class="n">CM_CONTROL_NEWDSX_MULTICLASSIFIER_REQ</span><span class="p">;</span>
	<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">Vcid</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">ClearTargetDSXBuffer</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">,</span> <span class="n">FALSE</span><span class="p">);</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;### TID RECEIVED %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16TID</span><span class="p">);</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">DSA_REQ</span>:
	<span class="p">{</span>
		<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Sending DSA Response....</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;SENDING DSA RESPONSE TO MAC %d&quot;</span><span class="p">,</span> <span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span><span class="p">);</span>
		<span class="o">*</span><span class="p">((</span><span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span>
			<span class="o">=</span> <span class="o">*</span><span class="n">pstAddIndication</span><span class="p">;</span>
		<span class="p">((</span><span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">DSA_RSP</span><span class="p">;</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot; VCID = %x&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">));</span>
		<span class="n">CopyBufferToControlPacket</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">PVOID</span><span class="p">)</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">);</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DSA_RSP</span>:
	<span class="p">{</span>
		<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;SENDING DSA ACK TO MAC %d&quot;</span><span class="p">,</span>
				<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span><span class="p">);</span>
		<span class="o">*</span><span class="p">((</span><span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span>
			<span class="o">=</span> <span class="o">*</span><span class="n">pstAddIndication</span><span class="p">;</span>
		<span class="p">((</span><span class="n">stLocalSFAddIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">DSA_ACK</span><span class="p">;</span>

	<span class="p">}</span> <span class="cm">/* no break here..we should go down. */</span>
	<span class="k">case</span> <span class="n">DSA_ACK</span>:
	<span class="p">{</span>
		<span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;VCID:0x%X&quot;</span><span class="p">,</span>
				<span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">));</span>
		<span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="n">SearchFreeSfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;uiSearchRuleIndex:0x%X &quot;</span><span class="p">,</span>
				<span class="n">uiSearchRuleIndex</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Direction:0x%X &quot;</span><span class="p">,</span>
				<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">uiSearchRuleIndex</span> <span class="o">&lt;</span> <span class="n">NO_OF_QUEUES</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucDirection</span> <span class="o">=</span>
				<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">;</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;bValid:0x%X &quot;</span><span class="p">,</span>
					<span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">TRUE</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActiveSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">TRUE</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bAuthorizedSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">TRUE</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bAdmittedSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">FALSE</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActivateRequestSent</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">)</span>
					<span class="n">psfLocalSet</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">;</span>
				<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">)</span>
					<span class="n">psfLocalSet</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">psfLocalSet</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">psfLocalSet</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;No set is valid</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bValid</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">bValid</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8CC</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;DSA ACK&quot;</span><span class="p">);</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">);</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usCID</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u16CID</span><span class="p">);</span>

				<span class="k">if</span> <span class="p">(</span><span class="n">UPLINK_DIR</span> <span class="o">==</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">)</span>
					<span class="n">atomic_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">uiPerSFTxResourceCount</span><span class="p">,</span> <span class="n">DEFAULT_PERSFCOUNT</span><span class="p">);</span>

				<span class="n">CopyToAdapter</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">psfLocalSet</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">DSA_ACK</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="p">);</span>
				<span class="cm">/* don&#39;t free pstAddIndication */</span>

				<span class="cm">/* Inside CopyToAdapter, Sorting of all the SFs take place.</span>
<span class="cm">				 * Hence any access to the newly added SF through uiSearchRuleIndex is invalid.</span>
<span class="cm">				 * SHOULD BE STRICTLY AVOIDED.</span>
<span class="cm">				 */</span>
				<span class="cm">/* *(PULONG)(((PUCHAR)pvBuffer)+1)=psfLocalSet-&gt;u32SFID; */</span>
				<span class="n">memcpy</span><span class="p">((((</span><span class="n">PUCHAR</span><span class="p">)</span><span class="n">pvBuffer</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="o">&amp;</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32SFID</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>

				<span class="k">if</span> <span class="p">(</span><span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">TRUE</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">UPLINK_DIR</span> <span class="o">==</span> <span class="n">pstAddIndication</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">LinkUpStatus</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">netif_carrier_on</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>
							<span class="n">netif_start_queue</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>
							<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">LinkUpStatus</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">netif_msg_link</span><span class="p">(</span><span class="n">Adapter</span><span class="p">))</span>
								<span class="n">pr_info</span><span class="p">(</span><span class="n">PFX</span> <span class="s">&quot;%s: link up</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
							<span class="n">atomic_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">TxPktAvail</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
							<span class="n">wake_up</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">tx_packet_wait_queue</span><span class="p">);</span>
							<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">liTimeSinceLastNetEntry</span> <span class="o">=</span> <span class="n">get_seconds</span><span class="p">();</span>
						<span class="p">}</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bValid</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;DSA ACK did not get valid SFID&quot;</span><span class="p">);</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DSC_REQ</span>:
	<span class="p">{</span>
		<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFChangeIndicationAlt</span><span class="p">);</span>
		<span class="n">pstChangeIndication</span> <span class="o">=</span> <span class="p">(</span><span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="p">;</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;SENDING DSC RESPONSE TO MAC %d&quot;</span><span class="p">,</span> <span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span><span class="p">);</span>

		<span class="o">*</span><span class="p">((</span><span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span> <span class="o">=</span> <span class="o">*</span><span class="n">pstChangeIndication</span><span class="p">;</span>
		<span class="p">((</span><span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">DSC_RSP</span><span class="p">;</span>

		<span class="n">CopyBufferToControlPacket</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">PVOID</span><span class="p">)</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">);</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DSC_RSP</span>:
	<span class="p">{</span>
		<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFChangeIndicationAlt</span><span class="p">);</span>
		<span class="n">pstChangeIndication</span> <span class="o">=</span> <span class="p">(</span><span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="p">;</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;SENDING DSC ACK TO MAC %d&quot;</span><span class="p">,</span> <span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span><span class="p">);</span>
		<span class="o">*</span><span class="p">((</span><span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span> <span class="o">=</span> <span class="o">*</span><span class="n">pstChangeIndication</span><span class="p">;</span>
		<span class="p">((</span><span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">DSC_ACK</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="n">DSC_ACK</span>:
	<span class="p">{</span>
		<span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

		<span class="n">pstChangeIndication</span> <span class="o">=</span> <span class="p">(</span><span class="n">stLocalSFChangeIndicationAlt</span> <span class="o">*</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="p">;</span>
		<span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="n">SearchSfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">u32SFID</span><span class="p">));</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">uiSearchRuleIndex</span> <span class="o">&gt;</span> <span class="n">NO_OF_QUEUES</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;SF doesn&#39;t exist for which DSC_ACK is received&quot;</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">((</span><span class="n">uiSearchRuleIndex</span> <span class="o">&lt;</span> <span class="n">NO_OF_QUEUES</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">ucDirection</span> <span class="o">=</span> <span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">u8Direction</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">TRUE</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActiveSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">TRUE</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bAuthorizedSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">TRUE</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bAdmittedSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">.</span><span class="n">bValid</span> <span class="o">==</span> <span class="n">FALSE</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActivateRequestSent</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">)</span>
					<span class="n">psfLocalSet</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfAdmittedSet</span><span class="p">;</span>
				<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">.</span><span class="n">bValid</span><span class="p">)</span>
					<span class="n">psfLocalSet</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfAuthorizedSet</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">psfLocalSet</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">sfActiveSet</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">psfLocalSet</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;No set is valid</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bValid</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">bValid</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">u8CC</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">);</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;CC field is %d bvalid = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
						<span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">u8CC</span><span class="p">,</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">bValid</span><span class="p">);</span>
				<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;VCID= %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">u16VCID</span><span class="p">));</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usCID</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">u16CID</span><span class="p">);</span>
				<span class="n">CopyToAdapter</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">psfLocalSet</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">,</span> <span class="n">DSC_ACK</span><span class="p">,</span> <span class="n">pstAddIndication</span><span class="p">);</span>

				<span class="o">*</span><span class="p">(</span><span class="n">PULONG</span><span class="p">)(((</span><span class="n">PUCHAR</span><span class="p">)</span><span class="n">pvBuffer</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">psfLocalSet</span><span class="o">-&gt;</span><span class="n">u32SFID</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">pstChangeIndication</span><span class="o">-&gt;</span><span class="n">u8CC</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">deleteSFBySfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>
				<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;DSC ACK did not get valid SFID&quot;</span><span class="p">);</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DSD_REQ</span>:
	<span class="p">{</span>
		<span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span><span class="p">;</span>
		<span class="n">ULONG</span> <span class="n">ulSFID</span><span class="p">;</span>

		<span class="n">pLeader</span><span class="o">-&gt;</span><span class="n">PLength</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFDeleteIndication</span><span class="p">);</span>
		<span class="o">*</span><span class="p">((</span><span class="n">stLocalSFDeleteIndication</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">stLocalSFDeleteIndication</span> <span class="o">*</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="p">);</span>

		<span class="n">ulSFID</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(((</span><span class="n">stLocalSFDeleteIndication</span> <span class="o">*</span><span class="p">)</span><span class="n">pstAddIndication</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">u32SFID</span><span class="p">);</span>
		<span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="n">SearchSfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;DSD - Removing connection %x&quot;</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">uiSearchRuleIndex</span> <span class="o">&lt;</span> <span class="n">NO_OF_QUEUES</span><span class="p">)</span> <span class="p">{</span>
			<span class="cm">/* Delete All Classifiers Associated with this SFID */</span>
			<span class="n">deleteSFBySfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">u32TotalDSD</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;SENDING DSD RESPONSE TO MAC&quot;</span><span class="p">);</span>
		<span class="p">((</span><span class="n">stLocalSFDeleteIndication</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">[</span><span class="n">LEADER_SIZE</span><span class="p">]))</span><span class="o">-&gt;</span><span class="n">u8Type</span> <span class="o">=</span> <span class="n">DSD_RSP</span><span class="p">;</span>
		<span class="n">CopyBufferToControlPacket</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">PVOID</span><span class="p">)</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">caDsxReqResp</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">case</span> <span class="n">DSD_RSP</span>:
	<span class="p">{</span>
		<span class="cm">/* Do nothing as SF has already got Deleted */</span>
	<span class="p">}</span>
	<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">DSD_ACK</span>:
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;DSD ACK Rcd, let App handle it</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">pstAddIndication</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">FALSE</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">TRUE</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">get_dsx_sf_data_to_application</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">UINT</span> <span class="n">uiSFId</span><span class="p">,</span> <span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">user_buffer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">status</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_packet_info</span> <span class="o">*</span><span class="n">psSfInfo</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;status =%d&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">);</span>
	<span class="n">status</span> <span class="o">=</span> <span class="n">SearchSfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSFId</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">&gt;=</span> <span class="n">NO_OF_QUEUES</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;SFID %d not present in queue !!!&quot;</span><span class="p">,</span> <span class="n">uiSFId</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;status =%d&quot;</span><span class="p">,</span> <span class="n">status</span><span class="p">);</span>
	<span class="n">psSfInfo</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">status</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">psSfInfo</span><span class="o">-&gt;</span><span class="n">pstSFIndication</span> <span class="o">&amp;&amp;</span> <span class="n">copy_to_user</span><span class="p">(</span><span class="n">user_buffer</span><span class="p">,</span>
							<span class="n">psSfInfo</span><span class="o">-&gt;</span><span class="n">pstSFIndication</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">stLocalSFAddIndicationAlt</span><span class="p">)))</span> <span class="p">{</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_PRINTK</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;copy to user failed SFID %d, present in queue !!!&quot;</span><span class="p">,</span> <span class="n">uiSFId</span><span class="p">);</span>
		<span class="n">status</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">VOID</span> <span class="nf">OverrideServiceFlowParams</span><span class="p">(</span><span class="n">PMINI_ADAPTER</span> <span class="n">Adapter</span><span class="p">,</span> <span class="n">PUINT</span> <span class="n">puiBuffer</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">B_UINT32</span> <span class="n">u32NumofSFsinMsg</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">puiBuffer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
	<span class="n">stIM_SFHostNotify</span> <span class="o">*</span><span class="n">pHostInfo</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">UINT</span> <span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ULONG</span> <span class="n">ulSFID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">puiBuffer</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;u32NumofSFsinMsg: 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">u32NumofSFsinMsg</span><span class="p">);</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">u32NumofSFsinMsg</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">u32NumofSFsinMsg</span> <span class="o">&lt;</span> <span class="n">NO_OF_QUEUES</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">u32NumofSFsinMsg</span><span class="o">--</span><span class="p">;</span>
		<span class="n">pHostInfo</span> <span class="o">=</span> <span class="p">(</span><span class="n">stIM_SFHostNotify</span> <span class="o">*</span><span class="p">)</span><span class="n">puiBuffer</span><span class="p">;</span>
		<span class="n">puiBuffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">PUINT</span><span class="p">)(</span><span class="n">pHostInfo</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

		<span class="n">ulSFID</span> <span class="o">=</span> <span class="n">ntohl</span><span class="p">(</span><span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">SFID</span><span class="p">);</span>
		<span class="n">uiSearchRuleIndex</span> <span class="o">=</span> <span class="n">SearchSfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">);</span>
		<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;SFID: 0x%lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">uiSearchRuleIndex</span> <span class="o">&gt;=</span> <span class="n">NO_OF_QUEUES</span> <span class="o">||</span> <span class="n">uiSearchRuleIndex</span> <span class="o">==</span> <span class="n">HiPriority</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;The SFID &lt;%lx&gt; doesn&#39;t exist in host entry or is Invalid</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ulSFID</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">RetainSF</span> <span class="o">==</span> <span class="n">FALSE</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;Going to Delete SF&quot;</span><span class="p">);</span>
			<span class="n">deleteSFBySfid</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">uiSearchRuleIndex</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usVCID_Value</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">VCID</span><span class="p">);</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">usCID</span> <span class="o">=</span> <span class="n">ntohs</span><span class="p">(</span><span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">newCID</span><span class="p">);</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">;</span>

			<span class="n">BCM_DEBUG_PRINT</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">DBG_TYPE_OTHERS</span><span class="p">,</span> <span class="n">CONN_MSG</span><span class="p">,</span> <span class="n">DBG_LVL_ALL</span><span class="p">,</span> <span class="s">&quot;pHostInfo-&gt;QoSParamSet: 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">QoSParamSet</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">QoSParamSet</span> <span class="o">&amp;</span> <span class="mh">0x1</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bAuthorizedSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">QoSParamSet</span> <span class="o">&amp;</span> <span class="mh">0x2</span><span class="p">)</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bAdmittedSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pHostInfo</span><span class="o">-&gt;</span><span class="n">QoSParamSet</span> <span class="o">&amp;</span> <span class="mh">0x4</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActiveSet</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
				<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">PackInfo</span><span class="p">[</span><span class="n">uiSearchRuleIndex</span><span class="p">].</span><span class="n">bActive</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
