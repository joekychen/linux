<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › rtl8712 › wifi.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>wifi.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright(c) 2007 - 2010 Realtek Corporation. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of version 2 of the GNU General Public License as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="cm"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for</span>
<span class="cm"> * more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along with</span>
<span class="cm"> * this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm"> * 51 Franklin Street, Fifth Floor, Boston, MA 02110, USA</span>
<span class="cm"> *</span>
<span class="cm"> * Modifications for inclusion into the Linux staging tree are</span>
<span class="cm"> * Copyright(c) 2010 Larry Finger. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Contact information:</span>
<span class="cm"> * WLAN FAE &lt;wlanfae@realtek.com&gt;</span>
<span class="cm"> * Larry Finger &lt;Larry.Finger@lwfinger.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> ******************************************************************************/</span>
<span class="cp">#ifndef _WIFI_H_</span>
<span class="cp">#define _WIFI_H_</span>

<span class="cp">#include &lt;linux/compiler.h&gt;</span>

<span class="cp">#ifdef BIT</span>
<span class="cp">#undef BIT</span>
<span class="cp">#endif</span>
<span class="cp">#define BIT(x)	(1 &lt;&lt; (x))</span>

<span class="cp">#define WLAN_ETHHDR_LEN		14</span>
<span class="cp">#define WLAN_ETHADDR_LEN	6</span>
<span class="cp">#define WLAN_IEEE_OUI_LEN	3</span>
<span class="cp">#define WLAN_ADDR_LEN		6</span>
<span class="cp">#define WLAN_CRC_LEN		4</span>
<span class="cp">#define WLAN_BSSID_LEN		6</span>
<span class="cp">#define WLAN_BSS_TS_LEN		8</span>
<span class="cp">#define WLAN_HDR_A3_LEN		24</span>
<span class="cp">#define WLAN_HDR_A4_LEN		30</span>
<span class="cp">#define WLAN_HDR_A3_QOS_LEN	26</span>
<span class="cp">#define WLAN_HDR_A4_QOS_LEN	32</span>
<span class="cp">#define WLAN_SSID_MAXLEN	32</span>
<span class="cp">#define WLAN_DATA_MAXLEN	2312</span>

<span class="cp">#define WLAN_A3_PN_OFFSET	24</span>
<span class="cp">#define WLAN_A4_PN_OFFSET	30</span>

<span class="cp">#define WLAN_MIN_ETHFRM_LEN	60</span>
<span class="cp">#define WLAN_MAX_ETHFRM_LEN	1514</span>
<span class="cp">#define WLAN_ETHHDR_LEN		14</span>

<span class="cp">#define P80211CAPTURE_VERSION	0x80211001</span>

<span class="k">enum</span> <span class="n">WIFI_FRAME_TYPE</span> <span class="p">{</span>
	<span class="n">WIFI_MGT_TYPE</span>  <span class="o">=</span>	<span class="p">(</span><span class="mi">0</span><span class="p">),</span>
	<span class="n">WIFI_CTRL_TYPE</span> <span class="o">=</span>	<span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span>
	<span class="n">WIFI_DATA_TYPE</span> <span class="o">=</span>	<span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span>
	<span class="n">WIFI_QOS_DATA_TYPE</span>	<span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">|</span><span class="n">BIT</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span>	<span class="cm">/*!&lt; QoS Data */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">WIFI_FRAME_SUBTYPE</span> <span class="p">{</span>
	<span class="cm">/* below is for mgt frame */</span>
	<span class="n">WIFI_ASSOCREQ</span>       <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_ASSOCRSP</span>       <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_REASSOCREQ</span>     <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_REASSOCRSP</span>     <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_PROBEREQ</span>       <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_PROBERSP</span>       <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_BEACON</span>         <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_ATIM</span>           <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_DISASSOC</span>       <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_AUTH</span>           <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_DEAUTH</span>         <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_ACTION</span>         <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_MGT_TYPE</span><span class="p">),</span>
	<span class="cm">/* below is for control frame */</span>
	<span class="n">WIFI_PSPOLL</span>         <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_CTRL_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_RTS</span>            <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_CTRL_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_CTS</span>            <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_CTRL_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_ACK</span>            <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_CTRL_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_CFEND</span>          <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_CTRL_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_CFEND_CFACK</span> <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_CTRL_TYPE</span><span class="p">),</span>
	<span class="cm">/* below is for data frame */</span>
	<span class="n">WIFI_DATA</span>           <span class="o">=</span> <span class="p">(</span><span class="mi">0</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_DATA_CFACK</span>     <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_DATA_CFPOLL</span>    <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_DATA_CFACKPOLL</span> <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_DATA_NULL</span>      <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_CF_ACK</span>         <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_CF_POLL</span>        <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
	<span class="n">WIFI_CF_ACKPOLL</span>     <span class="o">=</span> <span class="p">(</span><span class="n">BIT</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">WIFI_DATA_TYPE</span><span class="p">),</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">WIFI_REASON_CODE</span>	<span class="p">{</span>
	<span class="n">_RSON_RESERVED_</span>			<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">_RSON_UNSPECIFIED_</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">_RSON_AUTH_NO_LONGER_VALID_</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">_RSON_DEAUTH_STA_LEAVING_</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">_RSON_INACTIVITY_</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">_RSON_UNABLE_HANDLE_</span>		<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">_RSON_CLS2_</span>			<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">_RSON_CLS3_</span>			<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">_RSON_DISAOC_STA_LEAVING_</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">_RSON_ASOC_NOT_AUTH_</span>		<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="cm">/* WPA reason */</span>
	<span class="n">_RSON_INVALID_IE_</span>		<span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">_RSON_MIC_FAILURE_</span>		<span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">_RSON_4WAY_HNDSHK_TIMEOUT_</span>	<span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">_RSON_GROUP_KEY_UPDATE_TIMEOUT_</span>	<span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">_RSON_DIFF_IE_</span>			<span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">_RSON_MLTCST_CIPHER_NOT_VALID_</span>	<span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">_RSON_UNICST_CIPHER_NOT_VALID_</span>	<span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">_RSON_AKMP_NOT_VALID_</span>		<span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">_RSON_UNSUPPORT_RSNE_VER_</span>	<span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">_RSON_INVALID_RSNE_CAP_</span>		<span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">_RSON_IEEE_802DOT1X_AUTH_FAIL_</span>	<span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="cm">/* below are Realtek definitions */</span>
	<span class="n">_RSON_PMK_NOT_AVAILABLE_</span>	<span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">WIFI_STATUS_CODE</span> <span class="p">{</span>
	<span class="n">_STATS_SUCCESSFUL_</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">_STATS_FAILURE_</span>			<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">_STATS_CAP_FAIL_</span>		<span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">_STATS_NO_ASOC_</span>			<span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">_STATS_OTHER_</span>			<span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">_STATS_NO_SUPP_ALG_</span>		<span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">_STATS_OUT_OF_AUTH_SEQ_</span>		<span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">_STATS_CHALLENGE_FAIL_</span>		<span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">_STATS_AUTH_TIMEOUT_</span>		<span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">_STATS_UNABLE_HANDLE_STA_</span>	<span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">_STATS_RATE_FAIL_</span>		<span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">WIFI_REG_DOMAIN</span> <span class="p">{</span>
	<span class="n">DOMAIN_FCC</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">DOMAIN_IC</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">DOMAIN_ETSI</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">DOMAIN_SPAIN</span>	<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">DOMAIN_FRANCE</span>	<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">DOMAIN_MKK</span>	<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">DOMAIN_ISRAEL</span>	<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">DOMAIN_MKK1</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">DOMAIN_MKK2</span>	<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">DOMAIN_MKK3</span>	<span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">DOMAIN_MAX</span>
<span class="p">};</span>

<span class="cp">#define _TO_DS_		BIT(8)</span>
<span class="cp">#define _FROM_DS_	BIT(9)</span>
<span class="cp">#define _MORE_FRAG_	BIT(10)</span>
<span class="cp">#define _RETRY_		BIT(11)</span>
<span class="cp">#define _PWRMGT_	BIT(12)</span>
<span class="cp">#define _MORE_DATA_	BIT(13)</span>
<span class="cp">#define _PRIVACY_	BIT(14)</span>
<span class="cp">#define _ORDER_		BIT(15)</span>

<span class="cp">#define SetToDs(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_TO_DS_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetToDs(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">			le16_to_cpu(_TO_DS_)) != 0)</span>

<span class="cp">#define ClearToDs(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= (~cpu_to_le16(_TO_DS_)); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetFrDs(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_FROM_DS_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetFrDs(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">			le16_to_cpu(_FROM_DS_)) != 0)</span>

<span class="cp">#define ClearFrDs(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= (~cpu_to_le16(_FROM_DS_)); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define get_tofr_ds(pframe)	((GetToDs(pframe) &lt;&lt; 1) | GetFrDs(pframe))</span>


<span class="cp">#define SetMFrag(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_MORE_FRAG_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetMFrag(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">			le16_to_cpu(_MORE_FRAG_)) != 0)</span>

<span class="cp">#define ClearMFrag(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= (~cpu_to_le16(_MORE_FRAG_)); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetRetry(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_RETRY_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetRetry(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">			le16_to_cpu(_RETRY_)) != 0)</span>

<span class="cp">#define ClearRetry(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= (~cpu_to_le16(_RETRY_)); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetPwrMgt(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_PWRMGT_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetPwrMgt(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">			le16_to_cpu(_PWRMGT_)) != 0)</span>

<span class="cp">#define ClearPwrMgt(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= (~cpu_to_le16(_PWRMGT_)); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetMData(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_MORE_DATA_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetMData(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">			le16_to_cpu(_MORE_DATA_)) != 0)</span>

<span class="cp">#define ClearMData(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= (~cpu_to_le16(_MORE_DATA_)); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetPrivacy(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_PRIVACY_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetPrivacy(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">				le16_to_cpu(_PRIVACY_)) != 0)</span>

<span class="cp">#define ClearPrivacy(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= (~cpu_to_le16(_PRIVACY_)); \</span>
<span class="cp">	} while (0)</span>


<span class="cp">#define GetOrder(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">			le16_to_cpu(_ORDER_)) != 0)</span>

<span class="cp">#define GetFrameType(pbuf)	(le16_to_cpu(*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">				(BIT(3) | BIT(2)))</span>

<span class="cp">#define SetFrameType(pbuf, type)	\</span>
<span class="cp">	do {	\</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= __constant_cpu_to_le16(~(BIT(3) | \</span>
<span class="cp">		BIT(2))); \</span>
<span class="cp">		*(unsigned short *)(pbuf) |= __constant_cpu_to_le16(type); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetFrameSubType(pbuf)	(cpu_to_le16(*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">				(BIT(7) | BIT(6) | BIT(5) | BIT(4) | BIT(3) | \</span>
<span class="cp">				BIT(2)))</span>

<span class="cp">#define SetFrameSubType(pbuf, type) \</span>
<span class="cp">	do {    \</span>
<span class="cp">		*(unsigned short *)(pbuf) &amp;= cpu_to_le16(~(BIT(7) | BIT(6) | \</span>
<span class="cp">		BIT(5) | BIT(4) | BIT(3) | BIT(2))); \</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(type); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetSequence(pbuf)	(cpu_to_le16(*(unsigned short *)\</span>
<span class="cp">				((addr_t)(pbuf) + 22)) &gt;&gt; 4)</span>

<span class="cp">#define GetFragNum(pbuf)	(cpu_to_le16(*(unsigned short *)((addr_t)\</span>
<span class="cp">				(pbuf) + 22)) &amp; 0x0f)</span>

<span class="cp">#define GetTupleCache(pbuf)	(cpu_to_le16(*(unsigned short *)\</span>
<span class="cp">				((addr_t)(pbuf) + 22)))</span>

<span class="cp">#define SetFragNum(pbuf, num) \</span>
<span class="cp">	do {    \</span>
<span class="cp">		*(unsigned short *)((addr_t)(pbuf) + 22) = \</span>
<span class="cp">			((*(unsigned short *)((addr_t)(pbuf) + 22)) &amp; \</span>
<span class="cp">			le16_to_cpu(~(0x000f))) | \</span>
<span class="cp">			cpu_to_le16(0x0f &amp; (num));     \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetSeqNum(pbuf, num) \</span>
<span class="cp">	do {    \</span>
<span class="cp">		*(unsigned short *)((addr_t)(pbuf) + 22) = \</span>
<span class="cp">			((*(unsigned short *)((addr_t)(pbuf) + 22)) &amp; \</span>
<span class="cp">			le16_to_cpu((unsigned short)0x000f)) | \</span>
<span class="cp">			le16_to_cpu((unsigned short)(0xfff0 &amp; (num &lt;&lt; 4))); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetDuration(pbuf, dur) \</span>
<span class="cp">	do {    \</span>
<span class="cp">		*(unsigned short *)((addr_t)(pbuf) + 2) |= \</span>
<span class="cp">			cpu_to_le16(0xffff &amp; (dur)); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SetPriority(pbuf, tid)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(tid &amp; 0xf); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetPriority(pbuf)	((le16_to_cpu(*(unsigned short *)(pbuf))) &amp; 0xf)</span>

<span class="cp">#define SetAckpolicy(pbuf, ack)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16((ack &amp; 3) &lt;&lt; 5); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetAckpolicy(pbuf) (((le16_to_cpu(*(unsigned short *)pbuf)) &gt;&gt; 5) &amp; 0x3)</span>

<span class="cp">#define GetAMsdu(pbuf) (((le16_to_cpu(*(unsigned short *)pbuf)) &gt;&gt; 7) &amp; 0x1)</span>

<span class="cp">#define SetAMsdu(pbuf, amsdu)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16((amsdu &amp; 1) &lt;&lt; 7); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetAid(pbuf)	(cpu_to_le16(*(unsigned short *)((addr_t)(pbuf) + 2)) \</span>
<span class="cp">			&amp; 0x3fff)</span>

<span class="cp">#define GetTid(pbuf)	(cpu_to_le16(*(unsigned short *)((addr_t)(pbuf) + \</span>
<span class="cp">			(((GetToDs(pbuf) &lt;&lt; 1)|GetFrDs(pbuf)) == 3 ? \</span>
<span class="cp">			30 : 24))) &amp; 0x000f)</span>

<span class="cp">#define GetAddr1Ptr(pbuf)	((unsigned char *)((addr_t)(pbuf) + 4))</span>

<span class="cp">#define GetAddr2Ptr(pbuf)	((unsigned char *)((addr_t)(pbuf) + 10))</span>

<span class="cp">#define GetAddr3Ptr(pbuf)	((unsigned char *)((addr_t)(pbuf) + 16))</span>

<span class="cp">#define GetAddr4Ptr(pbuf)	((unsigned char *)((addr_t)(pbuf) + 24))</span>



<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">IS_MCAST</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">da</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">((</span><span class="o">*</span><span class="n">da</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">get_da</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pframe</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">da</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">to_fr_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">GetToDs</span><span class="p">(</span><span class="n">pframe</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">GetFrDs</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">to_fr_ds</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x00</span>:	<span class="cm">/* ToDs=0, FromDs=0 */</span>
		<span class="n">da</span> <span class="o">=</span> <span class="n">GetAddr1Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x01</span>:	<span class="cm">/* ToDs=0, FromDs=1 */</span>
		<span class="n">da</span> <span class="o">=</span> <span class="n">GetAddr1Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x02</span>:	<span class="cm">/* ToDs=1, FromDs=0 */</span>
		<span class="n">da</span> <span class="o">=</span> <span class="n">GetAddr3Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>	<span class="cm">/* ToDs=1, FromDs=1 */</span>
		<span class="n">da</span> <span class="o">=</span> <span class="n">GetAddr3Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">da</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">get_sa</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pframe</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">sa</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">to_fr_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">GetToDs</span><span class="p">(</span><span class="n">pframe</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">GetFrDs</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">to_fr_ds</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x00</span>:	<span class="cm">/* ToDs=0, FromDs=0 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="n">GetAddr2Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x01</span>:	<span class="cm">/* ToDs=0, FromDs=1 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="n">GetAddr3Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x02</span>:	<span class="cm">/* ToDs=1, FromDs=0 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="n">GetAddr2Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>	<span class="cm">/* ToDs=1, FromDs=1 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="n">GetAddr4Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">sa</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">get_hdr_bssid</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pframe</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="o">*</span><span class="n">sa</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>	<span class="n">to_fr_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">GetToDs</span><span class="p">(</span><span class="n">pframe</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">GetFrDs</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">to_fr_ds</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mh">0x00</span>:	<span class="cm">/* ToDs=0, FromDs=0 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="n">GetAddr3Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x01</span>:	<span class="cm">/* ToDs=0, FromDs=1 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="n">GetAddr2Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mh">0x02</span>:	<span class="cm">/* ToDs=1, FromDs=0 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="n">GetAddr1Ptr</span><span class="p">(</span><span class="n">pframe</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>	<span class="cm">/* ToDs=1, FromDs=1 */</span>
		<span class="n">sa</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">sa</span><span class="p">;</span>
<span class="p">}</span>



<span class="cm">/*-----------------------------------------------------------------------------</span>
<span class="cm">			Below is for the security related definition</span>
<span class="cm">------------------------------------------------------------------------------*/</span>
<span class="cp">#define _RESERVED_FRAME_TYPE_	0</span>
<span class="cp">#define _SKB_FRAME_TYPE_	2</span>
<span class="cp">#define _PRE_ALLOCMEM_		1</span>
<span class="cp">#define _PRE_ALLOCHDR_		3</span>
<span class="cp">#define _PRE_ALLOCLLCHDR_	4</span>
<span class="cp">#define _PRE_ALLOCICVHDR_	5</span>
<span class="cp">#define _PRE_ALLOCMICHDR_	6</span>

<span class="cp">#define _SIFSTIME_		((priv-&gt;pmib-&gt;BssType.net_work_type &amp; \</span>
<span class="cp">				WIRELESS_11A) ? 16 : 10)</span>
<span class="cp">#define _ACKCTSLNG_		14	</span><span class="cm">/*14 bytes long, including crclng */</span><span class="cp"></span>
<span class="cp">#define _CRCLNG_		4</span>

<span class="cp">#define _ASOCREQ_IE_OFFSET_	4	</span><span class="cm">/* excluding wlan_hdr */</span><span class="cp"></span>
<span class="cp">#define	_ASOCRSP_IE_OFFSET_	6</span>
<span class="cp">#define _REASOCREQ_IE_OFFSET_	10</span>
<span class="cp">#define _REASOCRSP_IE_OFFSET_	6</span>
<span class="cp">#define _PROBEREQ_IE_OFFSET_	0</span>
<span class="cp">#define	_PROBERSP_IE_OFFSET_	12</span>
<span class="cp">#define _AUTH_IE_OFFSET_	6</span>
<span class="cp">#define _DEAUTH_IE_OFFSET_	0</span>
<span class="cp">#define _BEACON_IE_OFFSET_	12</span>

<span class="cp">#define _FIXED_IE_LENGTH_	_BEACON_IE_OFFSET_</span>

<span class="cp">#define _SSID_IE_		0</span>
<span class="cp">#define _SUPPORTEDRATES_IE_	1</span>
<span class="cp">#define _DSSET_IE_		3</span>
<span class="cp">#define _TIM_IE_		5</span>
<span class="cp">#define _IBSS_PARA_IE_		6</span>
<span class="cp">#define _CHLGETXT_IE_		16</span>
<span class="cp">#define _RSN_IE_2_		48`</span>
<span class="cp">#define _SSN_IE_1_		221</span>
<span class="cp">#define _ERPINFO_IE_		42</span>
<span class="cp">#define _EXT_SUPPORTEDRATES_IE_	50</span>

<span class="cp">#define _HT_CAPABILITY_IE_	45</span>
<span class="cp">#define _HT_EXTRA_INFO_IE_	61</span>
<span class="cp">#define _HT_ADD_INFO_IE_	61 </span><span class="cm">/* _HT_EXTRA_INFO_IE_ */</span><span class="cp"></span>

<span class="cp">#define _VENDOR_SPECIFIC_IE_	221</span>

<span class="cp">#define	_RESERVED47_		47</span>


<span class="cm">/* ---------------------------------------------------------------------------</span>
<span class="cm">					Below is the fixed elements...</span>
<span class="cm">-----------------------------------------------------------------------------*/</span>
<span class="cp">#define _AUTH_ALGM_NUM_			2</span>
<span class="cp">#define _AUTH_SEQ_NUM_			2</span>
<span class="cp">#define _BEACON_ITERVAL_		2</span>
<span class="cp">#define _CAPABILITY_			2</span>
<span class="cp">#define _CURRENT_APADDR_		6</span>
<span class="cp">#define _LISTEN_INTERVAL_		2</span>
<span class="cp">#define _RSON_CODE_				2</span>
<span class="cp">#define _ASOC_ID_				2</span>
<span class="cp">#define _STATUS_CODE_			2</span>
<span class="cp">#define _TIMESTAMP_				8</span>

<span class="cp">#define AUTH_ODD_TO				0</span>
<span class="cp">#define AUTH_EVEN_TO			1</span>

<span class="cp">#define WLAN_ETHCONV_ENCAP		1</span>
<span class="cp">#define WLAN_ETHCONV_RFC1042	2</span>
<span class="cp">#define WLAN_ETHCONV_8021h		3</span>

<span class="cp">#define cap_ESS BIT(0)</span>
<span class="cp">#define cap_IBSS BIT(1)</span>
<span class="cp">#define cap_CFPollable BIT(2)</span>
<span class="cp">#define cap_CFRequest BIT(3)</span>
<span class="cp">#define cap_Privacy BIT(4)</span>
<span class="cp">#define cap_ShortPremble BIT(5)</span>

<span class="cm">/*-----------------------------------------------------------------------------</span>
<span class="cm">				Below is the definition for 802.11i / 802.1x</span>
<span class="cm">------------------------------------------------------------------------------*/</span>
<span class="cp">#define _IEEE8021X_MGT_			1	</span><span class="cm">/*WPA */</span><span class="cp"></span>
<span class="cp">#define _IEEE8021X_PSK_			2	</span><span class="cm">/* WPA with pre-shared key */</span><span class="cp"></span>

<span class="cm">/*-----------------------------------------------------------------------------</span>
<span class="cm">				Below is the definition for WMM</span>
<span class="cm">------------------------------------------------------------------------------*/</span>
<span class="cp">#define _WMM_IE_Length_				7  </span><span class="cm">/* for WMM STA */</span><span class="cp"></span>
<span class="cp">#define _WMM_Para_Element_Length_		24</span>


<span class="cm">/*-----------------------------------------------------------------------------</span>
<span class="cm">				Below is the definition for 802.11n</span>
<span class="cm">------------------------------------------------------------------------------*/</span>

<span class="cm">/* block-ack parameters */</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_POLICY_MASK 0x0002</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_TID_MASK 0x003C</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_BUF_SIZE_MASK 0xFFA0</span>
<span class="cp">#define IEEE80211_DELBA_PARAM_TID_MASK 0xF000</span>
<span class="cp">#define IEEE80211_DELBA_PARAM_INITIATOR_MASK 0x0800</span>

<span class="cp">#define SetOrderBit(pbuf)	\</span>
<span class="cp">	do	{	\</span>
<span class="cp">		*(unsigned short *)(pbuf) |= cpu_to_le16(_ORDER_); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define GetOrderBit(pbuf)	(((*(unsigned short *)(pbuf)) &amp; \</span>
<span class="cp">				le16_to_cpu(_ORDER_)) != 0)</span>


<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_bar - HT Block Ack Request</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;HT BlockAckReq&quot; as</span>
<span class="cm"> * described in 802.11n draft section 7.2.1.7.1</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_bar</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">frame_control</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">duration</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ra</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ta</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">control</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">start_seq_num</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* 802.11 BAR control masks */</span>
<span class="cp">#define IEEE80211_BAR_CTRL_ACK_POLICY_NORMAL     0x0000</span>
<span class="cp">#define IEEE80211_BAR_CTRL_CBMTID_COMPRESSED_BA  0x0004</span>


 <span class="cm">/**</span>
<span class="cm"> * struct ieee80211_ht_cap - HT capabilities</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;HT capabilities element&quot; as</span>
<span class="cm"> * described in 802.11n draft section 7.3.2.52</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">ieee80211_ht_cap</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">cap_info</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">ampdu_params_info</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">supp_mcs_set</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">extended_ht_cap_info</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>		<span class="n">tx_BF_cap_info</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	       <span class="n">antenna_selection_info</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * struct ieee80211_ht_cap - HT additional information</span>
<span class="cm"> *</span>
<span class="cm"> * This structure refers to &quot;HT information element&quot; as</span>
<span class="cm"> * described in 802.11n draft section 7.3.2.53</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ieee80211_ht_addt_info</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>	<span class="n">control_chan</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>		<span class="n">ht_param</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">operation_mode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span>	<span class="n">stbc_param</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>		<span class="n">basic_set</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* 802.11n HT capabilities masks */</span>
<span class="cp">#define IEEE80211_HT_CAP_SUP_WIDTH		0x0002</span>
<span class="cp">#define IEEE80211_HT_CAP_SM_PS			0x000C</span>
<span class="cp">#define IEEE80211_HT_CAP_GRN_FLD		0x0010</span>
<span class="cp">#define IEEE80211_HT_CAP_SGI_20			0x0020</span>
<span class="cp">#define IEEE80211_HT_CAP_SGI_40			0x0040</span>
<span class="cp">#define IEEE80211_HT_CAP_TX_STBC			0x0080</span>
<span class="cp">#define IEEE80211_HT_CAP_DELAY_BA		0x0400</span>
<span class="cp">#define IEEE80211_HT_CAP_MAX_AMSDU		0x0800</span>
<span class="cp">#define IEEE80211_HT_CAP_DSSSCCK40		0x1000</span>
<span class="cm">/* 802.11n HT capability AMPDU settings */</span>
<span class="cp">#define IEEE80211_HT_CAP_AMPDU_FACTOR		0x03</span>
<span class="cp">#define IEEE80211_HT_CAP_AMPDU_DENSITY		0x1C</span>
<span class="cm">/* 802.11n HT capability MSC set */</span>
<span class="cp">#define IEEE80211_SUPP_MCS_SET_UEQM		4</span>
<span class="cp">#define IEEE80211_HT_CAP_MAX_STREAMS		4</span>
<span class="cp">#define IEEE80211_SUPP_MCS_SET_LEN		10</span>
<span class="cm">/* maximum streams the spec allows */</span>
<span class="cp">#define IEEE80211_HT_CAP_MCS_TX_DEFINED		0x01</span>
<span class="cp">#define IEEE80211_HT_CAP_MCS_TX_RX_DIFF		0x02</span>
<span class="cp">#define IEEE80211_HT_CAP_MCS_TX_STREAMS		0x0C</span>
<span class="cp">#define IEEE80211_HT_CAP_MCS_TX_UEQM		0x10</span>
<span class="cm">/* 802.11n HT IE masks */</span>
<span class="cp">#define IEEE80211_HT_IE_CHA_SEC_OFFSET		0x03</span>
<span class="cp">#define IEEE80211_HT_IE_CHA_SEC_NONE		0x00</span>
<span class="cp">#define IEEE80211_HT_IE_CHA_SEC_ABOVE		0x01</span>
<span class="cp">#define IEEE80211_HT_IE_CHA_SEC_BELOW		0x03</span>
<span class="cp">#define IEEE80211_HT_IE_CHA_WIDTH		0x04</span>
<span class="cp">#define IEEE80211_HT_IE_HT_PROTECTION		0x0003</span>
<span class="cp">#define IEEE80211_HT_IE_NON_GF_STA_PRSNT	0x0004</span>
<span class="cp">#define IEEE80211_HT_IE_NON_HT_STA_PRSNT	0x0010</span>

<span class="cm">/* block-ack parameters */</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_POLICY_MASK 0x0002</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_TID_MASK 0x003C</span>
<span class="cp">#define IEEE80211_ADDBA_PARAM_BUF_SIZE_MASK 0xFFA0</span>
<span class="cp">#define IEEE80211_DELBA_PARAM_TID_MASK 0xF000</span>
<span class="cp">#define IEEE80211_DELBA_PARAM_INITIATOR_MASK 0x0800</span>

<span class="cm">/*</span>
<span class="cm"> * A-PMDU buffer sizes</span>
<span class="cm"> * According to IEEE802.11n spec size varies from 8K to 64K (in powers of 2)</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE80211_MIN_AMPDU_BUF 0x8</span>
<span class="cp">#define IEEE80211_MAX_AMPDU_BUF 0x40</span>


<span class="cm">/* Spatial Multiplexing Power Save Modes */</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_STATIC		0</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_DYNAMIC	1</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_INVALID	2</span>
<span class="cp">#define WLAN_HT_CAP_SM_PS_DISABLED	3</span>

<span class="cp">#endif </span><span class="cm">/* _WIFI_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
