<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › rtl8712 › rtl871x_mp_ioctl.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>rtl871x_mp_ioctl.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm"> * rtl871x_mp_ioctl.c</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright(c) 2007 - 2010 Realtek Corporation. All rights reserved.</span>
<span class="cm"> * Linux device driver for RTL8192SU</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of version 2 of the GNU General Public License as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="cm"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for</span>
<span class="cm"> * more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along with</span>
<span class="cm"> * this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm"> * 51 Franklin Street, Fifth Floor, Boston, MA 02110, USA</span>
<span class="cm"> *</span>
<span class="cm"> * Modifications for inclusion into the Linux staging tree are</span>
<span class="cm"> * Copyright(c) 2010 Larry Finger. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Contact information:</span>
<span class="cm"> * WLAN FAE &lt;wlanfae@realtek.com&gt;</span>
<span class="cm"> * Larry Finger &lt;Larry.Finger@lwfinger.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> ******************************************************************************/</span>

<span class="cp">#include &quot;osdep_service.h&quot;</span>
<span class="cp">#include &quot;drv_types.h&quot;</span>
<span class="cp">#include &quot;mlme_osdep.h&quot;</span>
<span class="cp">#include &quot;rtl871x_mp.h&quot;</span>
<span class="cp">#include &quot;rtl871x_mp_ioctl.h&quot;</span>

<span class="n">uint</span> <span class="nf">oid_null_function</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_wireless_mode_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">==</span> <span class="n">SET_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&gt;=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u8</span><span class="p">))</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">registrypriv</span><span class="p">.</span><span class="n">wireless_mode</span> <span class="o">=</span>
					<span class="o">*</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">==</span> <span class="n">QUERY_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&gt;=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u8</span><span class="p">))</span> <span class="p">{</span>
			<span class="o">*</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
					 <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">registrypriv</span><span class="p">.</span><span class="n">wireless_mode</span><span class="p">;</span>
			<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span>
					<span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_write_bb_reg_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">bb_reg_param</span> <span class="o">*</span><span class="n">pbbreg</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">bb_reg_param</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pbbreg</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">bb_reg_param</span> <span class="o">*</span><span class="p">)(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFF</span><span class="p">;</span> <span class="cm">/*0ffset :0x800~0xfff*/</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">offset</span> <span class="o">&lt;</span> <span class="n">BB_REG_BASE_ADDR</span><span class="p">)</span>
		<span class="n">offset</span> <span class="o">|=</span> <span class="n">BB_REG_BASE_ADDR</span><span class="p">;</span>
	<span class="n">value</span> <span class="o">=</span> <span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
	<span class="n">r8712_bb_reg_write</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_read_bb_reg_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">bb_reg_param</span> <span class="o">*</span><span class="n">pbbreg</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">bb_reg_param</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pbbreg</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">bb_reg_param</span> <span class="o">*</span><span class="p">)(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFF</span><span class="p">;</span> <span class="cm">/*0ffset :0x800~0xfff*/</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">offset</span> <span class="o">&lt;</span> <span class="n">BB_REG_BASE_ADDR</span><span class="p">)</span>
		<span class="n">offset</span> <span class="o">|=</span> <span class="n">BB_REG_BASE_ADDR</span><span class="p">;</span>
	<span class="n">value</span> <span class="o">=</span> <span class="n">r8712_bb_reg_read</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">offset</span><span class="p">);</span>
	<span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_write_rf_reg_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">rf_reg_param</span> <span class="o">*</span><span class="n">pbbreg</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">path</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">rf_reg_param</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pbbreg</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">rf_reg_param</span> <span class="o">*</span><span class="p">)(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">path</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">path</span> <span class="o">&gt;</span> <span class="n">RF_PATH_B</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">;</span>
	<span class="n">value</span> <span class="o">=</span> <span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
	<span class="n">r8712_rf_reg_write</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_read_rf_reg_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rf_reg_param</span> <span class="o">*</span><span class="n">pbbreg</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">path</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">value</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">rf_reg_param</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pbbreg</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">rf_reg_param</span> <span class="o">*</span><span class="p">)(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">path</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">path</span> <span class="o">&gt;</span> <span class="n">RF_PATH_B</span><span class="p">)</span> <span class="cm">/* 1T2R  path_a /path_b */</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">;</span>
	<span class="n">value</span> <span class="o">=</span> <span class="n">r8712_rf_reg_read</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">offset</span><span class="p">);</span>
	<span class="n">pbbreg</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*This function initializes the DUT to the MP test mode*/</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">mp_start_test</span><span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">padapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">mp_priv</span> <span class="o">*</span><span class="n">pmppriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mlme_priv</span> <span class="o">*</span><span class="n">pmlmepriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">mlmepriv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wlan_network</span> <span class="o">*</span><span class="n">tgt_network</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">cur_network</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ndis_wlan_bssid_ex</span> <span class="n">bssid</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sta_info</span> <span class="o">*</span><span class="n">psta</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">length</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">irqL</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_SUCCESS</span><span class="p">;</span>

	<span class="cm">/* 3 1. initialize a new struct ndis_wlan_bssid_ex */</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">bssid</span><span class="p">.</span><span class="n">MacAddress</span><span class="p">,</span> <span class="n">pmppriv</span><span class="o">-&gt;</span><span class="n">network_macaddr</span><span class="p">,</span> <span class="n">ETH_ALEN</span><span class="p">);</span>
	<span class="n">bssid</span><span class="p">.</span><span class="n">Ssid</span><span class="p">.</span><span class="n">SsidLength</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">bssid</span><span class="p">.</span><span class="n">Ssid</span><span class="p">.</span><span class="n">Ssid</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="s">&quot;mp_pseudo_adhoc&quot;</span><span class="p">,</span>
		<span class="n">bssid</span><span class="p">.</span><span class="n">Ssid</span><span class="p">.</span><span class="n">SsidLength</span><span class="p">);</span>
	<span class="n">bssid</span><span class="p">.</span><span class="n">InfrastructureMode</span> <span class="o">=</span> <span class="n">Ndis802_11IBSS</span><span class="p">;</span>
	<span class="n">bssid</span><span class="p">.</span><span class="n">NetworkTypeInUse</span> <span class="o">=</span> <span class="n">Ndis802_11DS</span><span class="p">;</span>
	<span class="n">bssid</span><span class="p">.</span><span class="n">IELength</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">length</span> <span class="o">=</span> <span class="n">r8712_get_ndis_wlan_bssid_ex_sz</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bssid</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/*round up to multiple of 4 bytes.*/</span>
		<span class="n">bssid</span><span class="p">.</span><span class="n">Length</span> <span class="o">=</span> <span class="p">((</span><span class="n">length</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="n">bssid</span><span class="p">.</span><span class="n">Length</span> <span class="o">=</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">,</span> <span class="n">irqL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">check_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">WIFI_MP_STATE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">end_of_mp_start_test</span><span class="p">;</span>
	<span class="cm">/*init mp_start_test status*/</span>
	<span class="n">pmppriv</span><span class="o">-&gt;</span><span class="n">prev_fw_state</span> <span class="o">=</span> <span class="n">get_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">);</span>
	<span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">fw_state</span> <span class="o">=</span> <span class="n">WIFI_MP_STATE</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pmppriv</span><span class="o">-&gt;</span><span class="n">mode</span> <span class="o">==</span> <span class="n">_LOOPBOOK_MODE_</span><span class="p">)</span>
		<span class="n">set_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">WIFI_MP_LPBK_STATE</span><span class="p">);</span> <span class="cm">/*append txdesc*/</span>
	<span class="n">set_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">_FW_UNDER_LINKING</span><span class="p">);</span>
	<span class="cm">/* 3 2. create a new psta for mp driver */</span>
	<span class="cm">/* clear psta in the cur_network, if any */</span>
	<span class="n">psta</span> <span class="o">=</span> <span class="n">r8712_get_stainfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">,</span>
				 <span class="n">tgt_network</span><span class="o">-&gt;</span><span class="n">network</span><span class="p">.</span><span class="n">MacAddress</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">psta</span><span class="p">)</span>
		<span class="n">r8712_free_stainfo</span><span class="p">(</span><span class="n">padapter</span><span class="p">,</span> <span class="n">psta</span><span class="p">);</span>
	<span class="n">psta</span> <span class="o">=</span> <span class="n">r8712_alloc_stainfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">,</span> <span class="n">bssid</span><span class="p">.</span><span class="n">MacAddress</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">psta</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">res</span> <span class="o">=</span> <span class="n">_FAIL</span><span class="p">;</span>
		<span class="k">goto</span> <span class="n">end_of_mp_start_test</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/* 3 3. join psudo AdHoc */</span>
	<span class="n">tgt_network</span><span class="o">-&gt;</span><span class="n">join_res</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">tgt_network</span><span class="o">-&gt;</span><span class="n">aid</span> <span class="o">=</span> <span class="n">psta</span><span class="o">-&gt;</span><span class="n">aid</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tgt_network</span><span class="o">-&gt;</span><span class="n">network</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">bssid</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
	<span class="n">_clr_fwstate_</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">_FW_UNDER_LINKING</span><span class="p">);</span>
	<span class="n">r8712_os_indicate_connect</span><span class="p">(</span><span class="n">padapter</span><span class="p">);</span>
	<span class="cm">/* Set to LINKED STATE for MP TRX Testing */</span>
	<span class="n">set_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">_FW_LINKED</span><span class="p">);</span>
<span class="nl">end_of_mp_start_test:</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">,</span> <span class="n">irqL</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*This function change the DUT from the MP test mode into normal mode */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">mp_stop_test</span><span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">padapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">mp_priv</span> <span class="o">*</span><span class="n">pmppriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mlme_priv</span> <span class="o">*</span><span class="n">pmlmepriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">mlmepriv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wlan_network</span> <span class="o">*</span><span class="n">tgt_network</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">cur_network</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sta_info</span> <span class="o">*</span><span class="n">psta</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">irqL</span><span class="p">;</span>

	<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">,</span> <span class="n">irqL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">check_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">WIFI_MP_STATE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">end_of_mp_stop_test</span><span class="p">;</span>
	<span class="cm">/* 3 1. disconnect psudo AdHoc */</span>
	<span class="n">r8712_os_indicate_disconnect</span><span class="p">(</span><span class="n">padapter</span><span class="p">);</span>
	<span class="cm">/* 3 2. clear psta used in mp test mode. */</span>
	<span class="n">psta</span> <span class="o">=</span> <span class="n">r8712_get_stainfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">,</span>
				 <span class="n">tgt_network</span><span class="o">-&gt;</span><span class="n">network</span><span class="p">.</span><span class="n">MacAddress</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">psta</span><span class="p">)</span>
		<span class="n">r8712_free_stainfo</span><span class="p">(</span><span class="n">padapter</span><span class="p">,</span> <span class="n">psta</span><span class="p">);</span>
	<span class="cm">/* 3 3. return to normal state (default:station mode) */</span>
	<span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">fw_state</span> <span class="o">=</span> <span class="n">pmppriv</span><span class="o">-&gt;</span><span class="n">prev_fw_state</span><span class="p">;</span> <span class="cm">/* WIFI_STATION_STATE;*/</span>
	<span class="cm">/*flush the cur_network*/</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">tgt_network</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">wlan_network</span><span class="p">));</span>
<span class="nl">end_of_mp_stop_test:</span>
	<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmlmepriv</span><span class="o">-&gt;</span><span class="n">lock</span><span class="p">,</span> <span class="n">irqL</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">mp_start_joinbss</span><span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">padapter</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ndis_802_11_ssid</span> <span class="o">*</span><span class="n">pssid</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">mp_priv</span> <span class="o">*</span><span class="n">pmppriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mlme_priv</span> <span class="o">*</span><span class="n">pmlmepriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">padapter</span><span class="o">-&gt;</span><span class="n">mlmepriv</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">res</span> <span class="o">=</span> <span class="n">_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">check_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">WIFI_MP_STATE</span><span class="p">)</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">_FAIL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">check_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">_FW_LINKED</span><span class="p">)</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">_FAIL</span><span class="p">;</span>
	<span class="n">_clr_fwstate_</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">_FW_LINKED</span><span class="p">);</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">r8712_setassocsta_cmd</span><span class="p">(</span><span class="n">padapter</span><span class="p">,</span> <span class="n">pmppriv</span><span class="o">-&gt;</span><span class="n">network_macaddr</span><span class="p">);</span>
	<span class="n">set_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">_FW_UNDER_LINKING</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_data_rate_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					 <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ratevalue</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">ratevalue</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ratevalue</span> <span class="o">&gt;=</span> <span class="n">MPT_RATE_LAST</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_DATA</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">curr_rateidx</span> <span class="o">=</span> <span class="n">ratevalue</span><span class="p">;</span>
	<span class="n">r8712_SetDataRate</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_start_test_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">val8</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span>  <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">mode</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span><span class="p">;</span><span class="cm">/* 1 for loopback*/</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">mp_start_test</span><span class="p">(</span><span class="n">Adapter</span><span class="p">)</span> <span class="o">==</span> <span class="n">_FAIL</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">r8712_write8</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">MSR</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="cm">/* Link in ad hoc network, 0x1025004C */</span>
	<span class="n">r8712_write8</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RCR</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="cm">/* RCR : disable all pkt, 0x10250048 */</span>
	<span class="cm">/* RCR disable Check BSSID, 0x1025004a */</span>
	<span class="n">r8712_write8</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RCR</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">);</span>
	<span class="cm">/* disable RX filter map , mgt frames will put in RX FIFO 0 */</span>
	<span class="n">r8712_write16</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RXFLTMAP0</span><span class="p">,</span> <span class="mh">0x0</span><span class="p">);</span>
	<span class="n">val8</span> <span class="o">=</span> <span class="n">r8712_read8</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">EE_9346CR</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">val8</span> <span class="o">&amp;</span> <span class="n">_9356SEL</span><span class="p">))</span> <span class="p">{</span> <span class="cm">/*boot from EFUSE*/</span>
		<span class="n">r8712_efuse_reg_init</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
		<span class="n">r8712_efuse_change_max_size</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
		<span class="n">r8712_efuse_reg_uninit</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_stop_test_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">mp_stop_test</span><span class="p">(</span><span class="n">Adapter</span><span class="p">)</span> <span class="o">==</span> <span class="n">_FAIL</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_channel_direct_call_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						   <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">Channel</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">Channel</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Channel</span> <span class="o">&gt;</span> <span class="mi">14</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">curr_ch</span> <span class="o">=</span> <span class="n">Channel</span><span class="p">;</span>
	<span class="n">r8712_SetChannel</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_antenna_bb_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">antenna</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">antenna</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">antenna_tx</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)((</span><span class="n">antenna</span> <span class="o">&amp;</span> <span class="mh">0xFFFF0000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">);</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">antenna_rx</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">antenna</span> <span class="o">&amp;</span> <span class="mh">0x0000FFFF</span><span class="p">);</span>
	<span class="n">r8712_SwitchAntenna</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_tx_power_control_hdl</span><span class="p">(</span>
					<span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_pwr_idx</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">tx_pwr_idx</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">tx_pwr_idx</span> <span class="o">&gt;</span> <span class="n">MAX_TX_PWR_INDEX_N_MODE</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">curr_txpoweridx</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">tx_pwr_idx</span><span class="p">;</span>
	<span class="n">r8712_SetTxPower</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_query_tx_packet_sent_hdl</span><span class="p">(</span>
					<span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">==</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span> <span class="p">{</span>
		<span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
					<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">tx_pktcount</span><span class="p">;</span>
		<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_query_rx_packet_received_hdl</span><span class="p">(</span>
					<span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">==</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span> <span class="p">{</span>
		<span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
					<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">rx_pktcount</span><span class="p">;</span>
		<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_query_rx_packet_crc32_error_hdl</span><span class="p">(</span>
					<span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">==</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span> <span class="p">{</span>
		<span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
					<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">rx_crcerrpktcount</span><span class="p">;</span>
		<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_reset_tx_packet_sent_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						<span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">tx_pktcount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_reset_rx_packet_received_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						    <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">==</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">rx_pktcount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">rx_crcerrpktcount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_reset_phy_rx_packet_count_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						 <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">r8712_ResetPhyRxPktCount</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_get_phy_rx_packet_received_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						  <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
					 <span class="n">r8712_GetPhyRxPktReceived</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_get_phy_rx_packet_crc32_error_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						     <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">!=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
					 <span class="n">r8712_GetPhyRxPktCRC32Error</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_modulation_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					  <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>

	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">curr_modem</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_continuous_tx_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					     <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">u32</span>		<span class="n">bStartTest</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">bStartTest</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">r8712_SetContinuousTx</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">bStartTest</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_single_carrier_tx_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						 <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">u32</span>		<span class="n">bStartTest</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">bStartTest</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">r8712_SetSingleCarrierTx</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">bStartTest</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_carrier_suppression_tx_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						      <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">u32</span>		<span class="n">bStartTest</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">bStartTest</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">r8712_SetCarrierSuppressionTx</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">bStartTest</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_single_tone_tx_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					      <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">u32</span>		<span class="n">bStartTest</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">bStartTest</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">r8712_SetSingleToneTx</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">bStartTest</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro8711_join_bss_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ndis_802_11_ssid</span> <span class="o">*</span><span class="n">pssid</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span> <span class="o">=</span> <span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ndis_802_11_ssid</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pssid</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">ndis_802_11_ssid</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">mp_start_joinbss</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pssid</span><span class="p">)</span> <span class="o">==</span> <span class="n">_FAIL</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ndis_802_11_ssid</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_read_register_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					 <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mp_rw_reg</span> <span class="o">*</span><span class="n">RegRWStruct</span><span class="p">;</span>
	<span class="n">u16</span>		<span class="n">offset</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">RegRWStruct</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mp_rw_reg</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">&gt;=</span> <span class="mh">0x10250800</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">&lt;=</span> <span class="mh">0x10250FFF</span><span class="p">))</span> <span class="p">{</span>
		<span class="cm">/*baseband register*/</span>
		<span class="cm">/*0ffset :0x800~0xfff*/</span>
		<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFF</span><span class="p">;</span>
		<span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="n">r8712_bb_reg_read</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">offset</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mi">1</span>:
			<span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="n">r8712_read8</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span>
						   <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">2</span>:
			<span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="n">r8712_read16</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span>
						    <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">4</span>:
			<span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="n">r8712_read32</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span>
						    <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_write_register_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mp_rw_reg</span> <span class="o">*</span><span class="n">RegRWStruct</span><span class="p">;</span>
	<span class="n">u16</span>		<span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">value</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">oldValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">RegRWStruct</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mp_rw_reg</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">&gt;=</span> <span class="mh">0x10250800</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">&lt;=</span> <span class="mh">0x10250FFF</span><span class="p">))</span> <span class="p">{</span>
		<span class="cm">/*baseband register*/</span>
		<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFF</span><span class="p">;</span>
		<span class="n">value</span> <span class="o">=</span> <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mi">1</span>:
			<span class="n">oldValue</span> <span class="o">=</span> <span class="n">r8712_bb_reg_read</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">offset</span><span class="p">);</span>
			<span class="n">oldValue</span> <span class="o">&amp;=</span> <span class="mh">0xFFFFFF00</span><span class="p">;</span>
			<span class="n">value</span> <span class="o">&amp;=</span> <span class="mh">0x000000FF</span><span class="p">;</span>
			<span class="n">value</span> <span class="o">|=</span> <span class="n">oldValue</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">2</span>:
			<span class="n">oldValue</span> <span class="o">=</span> <span class="n">r8712_bb_reg_read</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">offset</span><span class="p">);</span>
			<span class="n">oldValue</span> <span class="o">&amp;=</span> <span class="mh">0xFFFF0000</span><span class="p">;</span>
			<span class="n">value</span> <span class="o">&amp;=</span> <span class="mh">0x0000FFFF</span><span class="p">;</span>
			<span class="n">value</span> <span class="o">|=</span> <span class="n">oldValue</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">r8712_bb_reg_write</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">width</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mi">1</span>:
			<span class="n">r8712_write8</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
			       <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span><span class="p">)</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">2</span>:
			<span class="n">r8712_write16</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
				<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">)</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">4</span>:
			<span class="n">r8712_write32</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
				<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">((</span><span class="n">status</span> <span class="o">==</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
		    <span class="p">(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">==</span> <span class="n">HIMR</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
		    <span class="p">(</span><span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">width</span> <span class="o">==</span> <span class="mi">4</span><span class="p">))</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">ImrContent</span> <span class="o">=</span> <span class="n">RegRWStruct</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_burst_read_register_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					       <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">burst_rw_reg</span> <span class="o">*</span><span class="n">pBstRwReg</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">pBstRwReg</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">burst_rw_reg</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">r8712_read_mem</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pBstRwReg</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span> <span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="n">pBstRwReg</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		 <span class="n">pBstRwReg</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_burst_write_register_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
						<span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">burst_rw_reg</span> <span class="o">*</span><span class="n">pBstRwReg</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">pBstRwReg</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">burst_rw_reg</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">r8712_write_mem</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pBstRwReg</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span> <span class="p">(</span><span class="n">u32</span><span class="p">)</span><span class="n">pBstRwReg</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span>
		  <span class="n">pBstRwReg</span><span class="o">-&gt;</span><span class="n">Data</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_write_txcmd_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_read16_eeprom_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">eeprom_rw_param</span> <span class="o">*</span><span class="n">pEEPROM</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">pEEPROM</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">eeprom_rw_param</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">pEEPROM</span><span class="o">-&gt;</span><span class="n">value</span> <span class="o">=</span> <span class="n">r8712_eeprom_read16</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span>
					     <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">pEEPROM</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">));</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_write16_eeprom_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">eeprom_rw_param</span> <span class="o">*</span><span class="n">pEEPROM</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">pEEPROM</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">eeprom_rw_param</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">r8712_eeprom_write16</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">pEEPROM</span><span class="o">-&gt;</span><span class="n">offset</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">),</span>
			     <span class="n">pEEPROM</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro8711_wi_poll_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">mp_wiparam</span> <span class="o">*</span><span class="n">pwi_param</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">mp_wiparam</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">bcompleted</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">pwi_param</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">mp_wiparam</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">pwi_param</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">,</span>
		<span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">mp_wiparam</span><span class="p">));</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">act_in_progress</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro8711_pkt_loss_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">uint</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">uint</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">rx_pktloss</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="o">*</span><span class="p">((</span><span class="n">uint</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span>
					 <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">rx_pktloss</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_rd_attrib_mem_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_wr_attrib_mem_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_rf_intfs_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">r8712_setrfintfs_cmd</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span>
	    <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">)</span> <span class="o">==</span> <span class="n">_FAIL</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_poll_rx_status_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">,</span>
		<span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">rxstat</span><span class="p">,</span>
		<span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">recv_stat</span><span class="p">));</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_cfg_debug_message_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					     <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_data_rate_ex_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					    <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">r8712_setdatarate_cmd</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span>
	    <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">)</span> <span class="o">!=</span> <span class="n">_SUCCESS</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_get_thermal_meter_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">act_in_progress</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u8</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="cm">/*init workparam*/</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">act_in_progress</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">bcompleted</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">act_type</span> <span class="o">=</span> <span class="n">MPT_GET_THERMAL_METER</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">io_offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">io_value</span> <span class="o">=</span> <span class="mh">0xFFFFFFFF</span><span class="p">;</span>
	<span class="n">r8712_GetThermalMeter</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">io_value</span><span class="p">);</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">bcompleted</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">act_in_progress</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
	<span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
				 <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">workparam</span><span class="p">.</span><span class="n">io_value</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_power_tracking_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					      <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u8</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">r8712_setptm_cmd</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="o">*</span><span class="p">((</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">)))</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_basic_rate_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">u8</span> <span class="n">mpdatarate</span><span class="p">[</span><span class="n">NumRates</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">11</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">};</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ratevalue</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">datarates</span><span class="p">[</span><span class="n">NumRates</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">ratevalue</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">NumRates</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ratevalue</span> <span class="o">==</span> <span class="n">mpdatarate</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="n">datarates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpdatarate</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">else</span>
			<span class="n">datarates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xff</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">r8712_setbasicrate_cmd</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">datarates</span><span class="p">)</span> <span class="o">!=</span> <span class="n">_SUCCESS</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_qry_pwrstate_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
	<span class="n">memcpy</span><span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">,</span>
		<span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">pwrctrlpriv</span><span class="p">.</span><span class="n">pwr_mode</span><span class="p">),</span> <span class="mi">8</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_pwrstate_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">pwr_mode</span><span class="p">,</span> <span class="n">smart_ps</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pwr_mode</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">uint</span> <span class="o">*</span><span class="p">)(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
	<span class="n">smart_ps</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">uint</span> <span class="o">*</span><span class="p">)((</span><span class="n">addr_t</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pwr_mode</span> <span class="o">!=</span> <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">pwrctrlpriv</span><span class="p">.</span><span class="n">pwr_mode</span> <span class="o">||</span> <span class="n">smart_ps</span> <span class="o">!=</span>
			<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">pwrctrlpriv</span><span class="p">.</span><span class="n">smart_ps</span><span class="p">)</span>
		<span class="n">r8712_set_ps_mode</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pwr_mode</span><span class="p">,</span> <span class="n">smart_ps</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_h2c_set_rate_table_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					      <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">setratable_parm</span> <span class="o">*</span><span class="n">prate_table</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">res</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span>  <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">setratable_parm</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span>
	    <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">setratable_parm</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">prate_table</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">setratable_parm</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">r8712_setrttbl_cmd</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">prate_table</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">res</span> <span class="o">==</span> <span class="n">_FAIL</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_h2c_get_rate_table_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					      <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_encryption_ctrl_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					   <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">security_priv</span> <span class="o">*</span><span class="n">psecuritypriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">securitypriv</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ENCRY_CTRL_STATE</span> <span class="n">encry_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u8</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">==</span> <span class="n">SET_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">encry_mode</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">encry_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">HW_CONTROL</span>:
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">SW_CONTROL</span>:
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">HW_ENCRY_SW_DECRY</span>:
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">SW_ENCRY_HW_DECRY</span>:
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
			<span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
		    <span class="p">(</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">==</span> <span class="nb">false</span><span class="p">))</span>
			<span class="n">encry_mode</span> <span class="o">=</span> <span class="n">HW_CONTROL</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
			 <span class="p">(</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">==</span> <span class="nb">true</span><span class="p">))</span>
			<span class="n">encry_mode</span> <span class="o">=</span> <span class="n">HW_ENCRY_SW_DECRY</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
			 <span class="p">(</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">==</span> <span class="nb">false</span><span class="p">))</span>
			<span class="n">encry_mode</span> <span class="o">=</span> <span class="n">SW_ENCRY_HW_DECRY</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">((</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_encrypt</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
			 <span class="p">(</span><span class="n">psecuritypriv</span><span class="o">-&gt;</span><span class="n">sw_decrypt</span> <span class="o">==</span> <span class="nb">true</span><span class="p">))</span>
			<span class="n">encry_mode</span> <span class="o">=</span> <span class="n">SW_CONTROL</span><span class="p">;</span>
		<span class="o">*</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>  <span class="n">encry_mode</span><span class="p">;</span>
		<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*----------------------------------------------------------------------*/</span>
<span class="n">uint</span> <span class="nf">oid_rt_pro_add_sta_info_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">sta_info</span>	<span class="o">*</span><span class="n">psta</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="o">*</span><span class="n">macaddr</span><span class="p">;</span>


	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>

	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span> <span class="o">=</span> <span class="n">ETH_ALEN</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">macaddr</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">psta</span> <span class="o">=</span> <span class="n">r8712_get_stainfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">,</span> <span class="n">macaddr</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">psta</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* the sta in sta_info_queue =&gt; do nothing*/</span>
		<span class="n">psta</span> <span class="o">=</span> <span class="n">r8712_alloc_stainfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">,</span> <span class="n">macaddr</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">psta</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*-------------------------------------------------------------------------*/</span>
<span class="n">uint</span> <span class="nf">oid_rt_pro_dele_sta_info_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="kt">unsigned</span> <span class="kt">long</span>			<span class="n">irqL</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">sta_info</span>		<span class="o">*</span><span class="n">psta</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="o">*</span><span class="n">macaddr</span><span class="p">;</span>


	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>

	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span> <span class="o">=</span> <span class="n">ETH_ALEN</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>

	<span class="n">macaddr</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>

	<span class="n">psta</span> <span class="o">=</span> <span class="n">r8712_get_stainfo</span><span class="p">(</span><span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">,</span> <span class="n">macaddr</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">psta</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">spin_lock_irqsave</span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">.</span><span class="n">sta_hash_lock</span><span class="p">),</span> <span class="n">irqL</span><span class="p">);</span>
		<span class="n">r8712_free_stainfo</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">psta</span><span class="p">);</span>
		<span class="n">spin_unlock_irqrestore</span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">stapriv</span><span class="p">.</span><span class="n">sta_hash_lock</span><span class="p">),</span> <span class="n">irqL</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*--------------------------------------------------------------------------*/</span>
<span class="k">static</span> <span class="n">u32</span> <span class="nf">mp_query_drv_var</span><span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">padapter</span><span class="p">,</span> <span class="n">u8</span> <span class="n">offset</span><span class="p">,</span> <span class="n">u32</span> <span class="n">var</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">var</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_query_dr_variable_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">DR_VARIABLE_STRUCT</span> <span class="o">*</span><span class="n">pdrv_var</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span> <span class="o">=</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">DR_VARIABLE_STRUCT</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_needed</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pdrv_var</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">DR_VARIABLE_STRUCT</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">pdrv_var</span><span class="o">-&gt;</span><span class="n">variable</span> <span class="o">=</span> <span class="n">mp_query_drv_var</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">pdrv_var</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
					      <span class="n">pdrv_var</span><span class="o">-&gt;</span><span class="n">variable</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*--------------------------------------------------------------------------*/</span>
<span class="n">uint</span> <span class="nf">oid_rt_pro_rx_packet_type_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*------------------------------------------------------------------------*/</span>
<span class="n">uint</span> <span class="nf">oid_rt_pro_read_efuse_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">EFUSE_ACCESS_STRUCT</span> <span class="o">*</span><span class="n">pefuse</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">addr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cnts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span>
	    <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">EFUSE_ACCESS_STRUCT</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">pefuse</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">EFUSE_ACCESS_STRUCT</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">addr</span> <span class="o">=</span> <span class="n">pefuse</span><span class="o">-&gt;</span><span class="n">start_addr</span><span class="p">;</span>
	<span class="n">cnts</span> <span class="o">=</span> <span class="n">pefuse</span><span class="o">-&gt;</span><span class="n">cnts</span><span class="p">;</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">pefuse</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>
	<span class="n">memset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="n">cnts</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">addr</span> <span class="o">&gt;</span> <span class="mi">511</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">cnts</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">cnts</span> <span class="o">&gt;</span> <span class="mi">512</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">addr</span> <span class="o">+</span> <span class="n">cnts</span><span class="p">)</span> <span class="o">&gt;</span>
	     <span class="n">EFUSE_MAX_SIZE</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_access</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">cnts</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*------------------------------------------------------------------------*/</span>
<span class="n">uint</span> <span class="nf">oid_rt_pro_write_efuse_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">EFUSE_ACCESS_STRUCT</span> <span class="o">*</span><span class="n">pefuse</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">addr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cnts</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>

	<span class="n">pefuse</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">EFUSE_ACCESS_STRUCT</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">addr</span> <span class="o">=</span> <span class="n">pefuse</span><span class="o">-&gt;</span><span class="n">start_addr</span><span class="p">;</span>
	<span class="n">cnts</span> <span class="o">=</span> <span class="n">pefuse</span><span class="o">-&gt;</span><span class="n">cnts</span><span class="p">;</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">pefuse</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">addr</span> <span class="o">&gt;</span> <span class="mi">511</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">cnts</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">cnts</span> <span class="o">&gt;</span> <span class="mi">512</span><span class="p">)</span> <span class="o">||</span>
	    <span class="p">(</span><span class="n">addr</span> <span class="o">+</span> <span class="n">cnts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">r8712_efuse_get_max_size</span><span class="p">(</span><span class="n">Adapter</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_access</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">cnts</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">false</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*----------------------------------------------------------------------*/</span>
<span class="n">uint</span> <span class="nf">oid_rt_pro_rw_efuse_pgpkt_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">PGPKT_STRUCT</span>	<span class="o">*</span><span class="n">ppgpkt</span><span class="p">;</span>

	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">PGPKT_STRUCT</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">ppgpkt</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">PGPKT_STRUCT</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">==</span> <span class="n">QUERY_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_pg_packet_read</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ppgpkt</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
		    <span class="n">ppgpkt</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span>
			<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span>
				 <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_reg_init</span><span class="p">(</span><span class="n">Adapter</span><span class="p">)</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_pg_packet_write</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">ppgpkt</span><span class="o">-&gt;</span><span class="n">offset</span><span class="p">,</span>
			    <span class="n">ppgpkt</span><span class="o">-&gt;</span><span class="n">word_en</span><span class="p">,</span> <span class="n">ppgpkt</span><span class="o">-&gt;</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span>
				<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span>
					 <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
			<span class="n">r8712_efuse_reg_uninit</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_get_efuse_current_size_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					      <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">r8712_efuse_reg_init</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
				 <span class="n">r8712_efuse_get_current_size</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="n">r8712_efuse_reg_uninit</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_get_efuse_max_size_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
					 <span class="n">r8712_efuse_get_max_size</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_efuse_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">==</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">oid_rt_pro_read_efuse_hdl</span><span class="p">(</span><span class="n">poid_par_priv</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">oid_rt_pro_write_efuse_hdl</span><span class="p">(</span><span class="n">poid_par_priv</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_efuse_map_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="o">*</span><span class="n">data</span><span class="p">;</span>

	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="n">EFUSE_MAP_MAX_SIZE</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">==</span> <span class="n">QUERY_OID</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_map_read</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">EFUSE_MAP_MAX_SIZE</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
			<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">EFUSE_MAP_MAX_SIZE</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* SET_OID */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_reg_init</span><span class="p">(</span><span class="n">Adapter</span><span class="p">)</span> <span class="o">==</span> <span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">r8712_efuse_map_write</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
			    <span class="n">EFUSE_MAP_MAX_SIZE</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
				<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">EFUSE_MAP_MAX_SIZE</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
			<span class="n">r8712_efuse_reg_uninit</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_FAILURE</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_set_bandwidth_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">bandwidth</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">bandwidth</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span><span class="cm">/*4*/</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">bandwidth</span> <span class="o">!=</span> <span class="n">HT_CHANNEL_WIDTH_20</span><span class="p">)</span>
		<span class="n">bandwidth</span> <span class="o">=</span> <span class="n">HT_CHANNEL_WIDTH_40</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">curr_bandwidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">bandwidth</span><span class="p">;</span>
	<span class="n">r8712_SwitchBandwidth</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_set_crystal_cap_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">crystal_cap</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">crystal_cap</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span><span class="cm">/*4*/</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">crystal_cap</span> <span class="o">&gt;</span> <span class="mh">0xf</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">curr_crystalcap</span> <span class="o">=</span> <span class="n">crystal_cap</span><span class="p">;</span>
	<span class="n">r8712_SetCrystalCap</span><span class="p">(</span><span class="n">Adapter</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_set_rx_packet_type_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					   <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">u8</span>		<span class="n">rx_pkt_type</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">rcr_val32</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u8</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">rx_pkt_type</span> <span class="o">=</span> <span class="o">*</span><span class="p">((</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">);</span><span class="cm">/*4*/</span>
	<span class="n">rcr_val32</span> <span class="o">=</span> <span class="n">r8712_read32</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RCR</span><span class="p">);</span><span class="cm">/*RCR = 0x10250048*/</span>
	<span class="n">rcr_val32</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">RCR_CBSSID</span> <span class="o">|</span> <span class="n">RCR_AB</span> <span class="o">|</span> <span class="n">RCR_AM</span> <span class="o">|</span> <span class="n">RCR_APM</span> <span class="o">|</span> <span class="n">RCR_AAP</span><span class="p">);</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">rx_pkt_type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">RX_PKT_BROADCAST</span>:
		<span class="n">rcr_val32</span> <span class="o">|=</span> <span class="p">(</span><span class="n">RCR_AB</span> <span class="o">|</span> <span class="n">RCR_AM</span> <span class="o">|</span> <span class="n">RCR_APM</span> <span class="o">|</span> <span class="n">RCR_AAP</span> <span class="o">|</span> <span class="n">RCR_ACRC32</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">RX_PKT_DEST_ADDR</span>:
		<span class="n">rcr_val32</span> <span class="o">|=</span> <span class="p">(</span><span class="n">RCR_AB</span> <span class="o">|</span> <span class="n">RCR_AM</span> <span class="o">|</span> <span class="n">RCR_APM</span> <span class="o">|</span> <span class="n">RCR_AAP</span> <span class="o">|</span> <span class="n">RCR_ACRC32</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">RX_PKT_PHY_MATCH</span>:
		<span class="n">rcr_val32</span> <span class="o">|=</span> <span class="p">(</span><span class="n">RCR_APM</span><span class="o">|</span><span class="n">RCR_ACRC32</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">rcr_val32</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">RCR_AAP</span> <span class="o">|</span>
			       <span class="n">RCR_APM</span> <span class="o">|</span>
			       <span class="n">RCR_AM</span> <span class="o">|</span>
			       <span class="n">RCR_AB</span> <span class="o">|</span>
			       <span class="n">RCR_ACRC32</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">rx_pkt_type</span> <span class="o">==</span> <span class="n">RX_PKT_DEST_ADDR</span><span class="p">)</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">check_mp_pkt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">.</span><span class="n">check_mp_pkt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">r8712_write32</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">RCR</span><span class="p">,</span> <span class="n">rcr_val32</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_tx_agc_offset_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					     <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">u32</span> <span class="n">txagc</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="n">txagc</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="n">r8712_SetTxAGCOffset</span><span class="p">(</span><span class="n">Adapter</span><span class="p">,</span> <span class="n">txagc</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">uint</span> <span class="nf">oid_rt_pro_set_pkt_test_mode_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span>
					     <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>
	<span class="n">uint</span> <span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mlme_priv</span>	<span class="o">*</span><span class="n">pmlmepriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mlmepriv</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mp_priv</span>		<span class="o">*</span><span class="n">pmppriv</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">mppriv</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">type</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>

	<span class="n">type</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">u32</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">_LOOPBOOK_MODE_</span> <span class="o">==</span> <span class="n">type</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pmppriv</span><span class="o">-&gt;</span><span class="n">mode</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
		<span class="n">set_fwstate</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">WIFI_MP_LPBK_STATE</span><span class="p">);</span> <span class="cm">/*append txdesc*/</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">_2MAC_MODE_</span> <span class="o">==</span> <span class="n">type</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pmppriv</span><span class="o">-&gt;</span><span class="n">mode</span> <span class="o">=</span> <span class="n">type</span><span class="p">;</span>
		<span class="n">_clr_fwstate_</span><span class="p">(</span><span class="n">pmlmepriv</span><span class="p">,</span> <span class="n">WIFI_MP_LPBK_STATE</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="n">status</span> <span class="o">=</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*--------------------------------------------------------------------------*/</span>
<span class="cm">/*Linux*/</span>
<span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">mp_ioctl_xmit_packet_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
<span class="cm">/*-------------------------------------------------------------------------*/</span>
<span class="n">uint</span> <span class="nf">oid_rt_set_power_down_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u8</span>	<span class="n">bpwrup</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">SET_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="n">bpwrup</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span><span class="p">;</span>
	<span class="cm">/*CALL  the power_down function*/</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*-------------------------------------------------------------------------- */</span>
<span class="n">uint</span> <span class="nf">oid_rt_get_power_mode_hdl</span><span class="p">(</span><span class="k">struct</span> <span class="n">oid_par_priv</span> <span class="o">*</span><span class="n">poid_par_priv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="n">Adapter</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">_adapter</span> <span class="o">*</span><span class="p">)</span>
				   <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">adapter_context</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">type_of_oid</span> <span class="o">!=</span> <span class="n">QUERY_OID</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_NOT_ACCEPTED</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span> <span class="o">&lt;</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">u32</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">NDIS_STATUS_INVALID_LENGTH</span><span class="p">;</span>
	<span class="o">*</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="p">)</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf</span> <span class="o">=</span>
		 <span class="n">Adapter</span><span class="o">-&gt;</span><span class="n">registrypriv</span><span class="p">.</span><span class="n">low_power</span> <span class="o">?</span> <span class="n">POWER_LOW</span> <span class="o">:</span> <span class="n">POWER_NORMAL</span><span class="p">;</span>
	<span class="o">*</span><span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">bytes_rw</span> <span class="o">=</span> <span class="n">poid_par_priv</span><span class="o">-&gt;</span><span class="n">information_buf_len</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">NDIS_STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
