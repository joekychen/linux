<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › rtl8712 › ieee80211.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>ieee80211.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/******************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright(c) 2007 - 2010 Realtek Corporation. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of version 2 of the GNU General Public License as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="cm"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for</span>
<span class="cm"> * more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along with</span>
<span class="cm"> * this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm"> * 51 Franklin Street, Fifth Floor, Boston, MA 02110, USA</span>
<span class="cm"> *</span>
<span class="cm"> * Modifications for inclusion into the Linux staging tree are</span>
<span class="cm"> * Copyright(c) 2010 Larry Finger. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Contact information:</span>
<span class="cm"> * WLAN FAE &lt;wlanfae@realtek.com&gt;</span>
<span class="cm"> * Larry Finger &lt;Larry.Finger@lwfinger.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> ******************************************************************************/</span>
<span class="cp">#ifndef __IEEE80211_H</span>
<span class="cp">#define __IEEE80211_H</span>

<span class="cp">#include &quot;osdep_service.h&quot;</span>
<span class="cp">#include &quot;drv_types.h&quot;</span>
<span class="cp">#include &quot;wifi.h&quot;</span>
<span class="cp">#include &lt;linux/compiler.h&gt;</span>
<span class="cp">#include &lt;linux/wireless.h&gt;</span>

<span class="cp">#define MGMT_QUEUE_NUM 5</span>
<span class="cp">#define ETH_ALEN	6</span>
<span class="cp">#define IEEE_CMD_SET_WPA_PARAM			1</span>
<span class="cp">#define IEEE_CMD_SET_WPA_IE			2</span>
<span class="cp">#define IEEE_CMD_SET_ENCRYPTION			3</span>
<span class="cp">#define IEEE_CMD_MLME				4</span>

<span class="cp">#define IEEE_PARAM_WPA_ENABLED			1</span>
<span class="cp">#define IEEE_PARAM_TKIP_COUNTERMEASURES		2</span>
<span class="cp">#define IEEE_PARAM_DROP_UNENCRYPTED		3</span>
<span class="cp">#define IEEE_PARAM_PRIVACY_INVOKED		4</span>
<span class="cp">#define IEEE_PARAM_AUTH_ALGS			5</span>
<span class="cp">#define IEEE_PARAM_IEEE_802_1X			6</span>
<span class="cp">#define IEEE_PARAM_WPAX_SELECT			7</span>

<span class="cp">#define AUTH_ALG_OPEN_SYSTEM			0x1</span>
<span class="cp">#define AUTH_ALG_SHARED_KEY			0x2</span>
<span class="cp">#define AUTH_ALG_LEAP				0x00000004</span>

<span class="cp">#define IEEE_MLME_STA_DEAUTH			1</span>
<span class="cp">#define IEEE_MLME_STA_DISASSOC			2</span>

<span class="cp">#define IEEE_CRYPT_ERR_UNKNOWN_ALG		2</span>
<span class="cp">#define IEEE_CRYPT_ERR_UNKNOWN_ADDR		3</span>
<span class="cp">#define IEEE_CRYPT_ERR_CRYPT_INIT_FAILED	4</span>
<span class="cp">#define IEEE_CRYPT_ERR_KEY_SET_FAILED		5</span>
<span class="cp">#define IEEE_CRYPT_ERR_TX_KEY_SET_FAILED	6</span>
<span class="cp">#define IEEE_CRYPT_ERR_CARD_CONF_FAILED		7</span>


<span class="cp">#define	IEEE_CRYPT_ALG_NAME_LEN			16</span>

<span class="cp">#define WPA_CIPHER_NONE				BIT(0)</span>
<span class="cp">#define WPA_CIPHER_WEP40			BIT(1)</span>
<span class="cp">#define WPA_CIPHER_WEP104			BIT(2)</span>
<span class="cp">#define WPA_CIPHER_TKIP				BIT(3)</span>
<span class="cp">#define WPA_CIPHER_CCMP				BIT(4)</span>



<span class="cp">#define WPA_SELECTOR_LEN			4</span>
<span class="cp">#define RSN_HEADER_LEN				4</span>

<span class="cp">#define RSN_SELECTOR_LEN 4</span>

<span class="k">enum</span> <span class="n">NETWORK_TYPE</span> <span class="p">{</span>
	<span class="n">WIRELESS_INVALID</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WIRELESS_11B</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WIRELESS_11G</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WIRELESS_11BG</span>		<span class="o">=</span> <span class="p">(</span><span class="n">WIRELESS_11B</span> <span class="o">|</span> <span class="n">WIRELESS_11G</span><span class="p">),</span>
	<span class="n">WIRELESS_11A</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WIRELESS_11N</span>		<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">WIRELESS_11GN</span>		<span class="o">=</span> <span class="p">(</span><span class="n">WIRELESS_11G</span> <span class="o">|</span> <span class="n">WIRELESS_11N</span><span class="p">),</span>
	<span class="n">WIRELESS_11BGN</span>		<span class="o">=</span> <span class="p">(</span><span class="n">WIRELESS_11B</span> <span class="o">|</span> <span class="n">WIRELESS_11G</span> <span class="o">|</span> <span class="n">WIRELESS_11N</span><span class="p">),</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">ieee_param</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">sta_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">name</span><span class="p">;</span>
			<span class="n">u32</span> <span class="n">value</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">wpa_param</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span> <span class="n">len</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
			<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">wpa_ie</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">command</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">reason_code</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">mlme</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">alg</span><span class="p">[</span><span class="n">IEEE_CRYPT_ALG_NAME_LEN</span><span class="p">];</span>
			<span class="n">u8</span> <span class="n">set_tx</span><span class="p">;</span>
			<span class="n">u32</span> <span class="n">err</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">idx</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">seq</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="cm">/* sequence counter (set: RX, get: TX) */</span>
			<span class="n">u16</span> <span class="n">key_len</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">crypt</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define IEEE80211_DATA_LEN		2304</span>
<span class="cm">/* Maximum size for the MA-UNITDATA primitive, 802.11 standard section</span>
<span class="cm">   6.2.1.1.2.</span>

<span class="cm">   The figure in section 7.1.2 suggests a body size of up to 2312</span>
<span class="cm">   bytes is allowed, which is a bit confusing, I suspect this</span>
<span class="cm">   represents the 2304 bytes of real data, plus a possible 8 bytes of</span>
<span class="cm">   WEP IV and ICV. (this interpretation suggested by Ramiro Barreiro) */</span>

<span class="cp">#define IEEE80211_HLEN			30</span>
<span class="cp">#define IEEE80211_FRAME_LEN		(IEEE80211_DATA_LEN + IEEE80211_HLEN)</span>

<span class="cm">/* this is stolen from ipw2200 driver */</span>
<span class="cp">#define IEEE_IBSS_MAC_HASH_SIZE 31</span>

<span class="k">struct</span> <span class="n">ieee_ibss_seq</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">mac</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_num</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">frag_num</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">packet_time</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr4</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_ctl</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>


<span class="k">struct</span>	<span class="n">ieee80211_hdr_qos</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr4</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span>	<span class="n">qc</span><span class="p">;</span>
<span class="p">}</span>  <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span>  <span class="n">ieee80211_hdr_3addr_qos</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span>  <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span>  <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">qc</span><span class="p">;</span>
<span class="p">}</span>  <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">eapol</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">snap</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">ethertype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>


<span class="k">enum</span> <span class="n">eap_type</span> <span class="p">{</span>
	<span class="n">EAP_PACKET</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">EAPOL_START</span><span class="p">,</span>
	<span class="n">EAPOL_LOGOFF</span><span class="p">,</span>
	<span class="n">EAPOL_KEY</span><span class="p">,</span>
	<span class="n">EAPOL_ENCAP_ASF_ALERT</span>
<span class="p">};</span>

<span class="cp">#define IEEE80211_3ADDR_LEN 24</span>
<span class="cp">#define IEEE80211_4ADDR_LEN 30</span>
<span class="cp">#define IEEE80211_FCS_LEN    4</span>

<span class="cp">#define MIN_FRAG_THRESHOLD     256U</span>
<span class="cp">#define	MAX_FRAG_THRESHOLD     2346U</span>

<span class="cm">/* Frame control field constants */</span>
<span class="cp">#define IEEE80211_FCTL_VERS		0x0002</span>
<span class="cp">#define IEEE80211_FCTL_FTYPE		0x000c</span>
<span class="cp">#define IEEE80211_FCTL_STYPE		0x00f0</span>
<span class="cp">#define IEEE80211_FCTL_TODS		0x0100</span>
<span class="cp">#define IEEE80211_FCTL_FROMDS		0x0200</span>
<span class="cp">#define IEEE80211_FCTL_MOREFRAGS	0x0400</span>
<span class="cp">#define IEEE80211_FCTL_RETRY		0x0800</span>
<span class="cp">#define IEEE80211_FCTL_PM		0x1000</span>
<span class="cp">#define IEEE80211_FCTL_MOREDATA	0x2000</span>
<span class="cp">#define IEEE80211_FCTL_WEP		0x4000</span>
<span class="cp">#define IEEE80211_FCTL_ORDER		0x8000</span>

<span class="cp">#define IEEE80211_FTYPE_MGMT		0x0000</span>
<span class="cp">#define IEEE80211_FTYPE_CTL		0x0004</span>
<span class="cp">#define IEEE80211_FTYPE_DATA		0x0008</span>

<span class="cm">/* management */</span>
<span class="cp">#define IEEE80211_STYPE_ASSOC_REQ	0x0000</span>
<span class="cp">#define IEEE80211_STYPE_ASSOC_RESP	0x0010</span>
<span class="cp">#define IEEE80211_STYPE_REASSOC_REQ	0x0020</span>
<span class="cp">#define IEEE80211_STYPE_REASSOC_RESP	0x0030</span>
<span class="cp">#define IEEE80211_STYPE_PROBE_REQ	0x0040</span>
<span class="cp">#define IEEE80211_STYPE_PROBE_RESP	0x0050</span>
<span class="cp">#define IEEE80211_STYPE_BEACON		0x0080</span>
<span class="cp">#define IEEE80211_STYPE_ATIM		0x0090</span>
<span class="cp">#define IEEE80211_STYPE_DISASSOC	0x00A0</span>
<span class="cp">#define IEEE80211_STYPE_AUTH		0x00B0</span>
<span class="cp">#define IEEE80211_STYPE_DEAUTH		0x00C0</span>

<span class="cm">/* control */</span>
<span class="cp">#define IEEE80211_STYPE_PSPOLL		0x00A0</span>
<span class="cp">#define IEEE80211_STYPE_RTS		0x00B0</span>
<span class="cp">#define IEEE80211_STYPE_CTS		0x00C0</span>
<span class="cp">#define IEEE80211_STYPE_ACK		0x00D0</span>
<span class="cp">#define IEEE80211_STYPE_CFEND		0x00E0</span>
<span class="cp">#define IEEE80211_STYPE_CFENDACK	0x00F0</span>

<span class="cm">/* data */</span>
<span class="cp">#define IEEE80211_STYPE_DATA		0x0000</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFACK	0x0010</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFPOLL	0x0020</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFACKPOLL	0x0030</span>
<span class="cp">#define IEEE80211_STYPE_NULLFUNC	0x0040</span>
<span class="cp">#define IEEE80211_STYPE_CFACK		0x0050</span>
<span class="cp">#define IEEE80211_STYPE_CFPOLL		0x0060</span>
<span class="cp">#define IEEE80211_STYPE_CFACKPOLL	0x0070</span>
<span class="cp">#define IEEE80211_QOS_DATAGRP		0x0080</span>
<span class="cp">#define IEEE80211_QoS_DATAGRP		IEEE80211_QOS_DATAGRP</span>

<span class="cp">#define IEEE80211_SCTL_FRAG		0x000F</span>
<span class="cp">#define IEEE80211_SCTL_SEQ		0xFFF0</span>

<span class="cm">/* QoS,QOS */</span>
<span class="cp">#define NORMAL_ACK			0</span>
<span class="cp">#define NO_ACK				1</span>
<span class="cp">#define NON_EXPLICIT_ACK	2</span>
<span class="cp">#define BLOCK_ACK			3</span>

<span class="cp">#ifndef ETH_P_PAE</span>
<span class="cp">#define ETH_P_PAE 0x888E </span><span class="cm">/* Port Access Entity (IEEE 802.1X) */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* ETH_P_PAE */</span><span class="cp"></span>

<span class="cp">#define ETH_P_PREAUTH 0x88C7 </span><span class="cm">/* IEEE 802.11i pre-authentication */</span><span class="cp"></span>

<span class="cp">#define ETH_P_ECONET	0x0018</span>

<span class="cp">#ifndef ETH_P_80211_RAW</span>
<span class="cp">#define ETH_P_80211_RAW (ETH_P_ECONET + 1)</span>
<span class="cp">#endif</span>

<span class="cm">/* IEEE 802.11 defines */</span>

<span class="cp">#define P80211_OUI_LEN 3</span>

<span class="k">struct</span> <span class="n">ieee80211_snap_hdr</span> <span class="p">{</span>
	<span class="n">u8</span>    <span class="n">dsap</span><span class="p">;</span>   <span class="cm">/* always 0xAA */</span>
	<span class="n">u8</span>    <span class="n">ssap</span><span class="p">;</span>   <span class="cm">/* always 0xAA */</span>
	<span class="n">u8</span>    <span class="n">ctrl</span><span class="p">;</span>   <span class="cm">/* always 0x03 */</span>
	<span class="n">u8</span>    <span class="n">oui</span><span class="p">[</span><span class="n">P80211_OUI_LEN</span><span class="p">];</span>    <span class="cm">/* organizational universal id */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define SNAP_SIZE sizeof(struct ieee80211_snap_hdr)</span>

<span class="cp">#define WLAN_FC_GET_TYPE(fc) ((fc) &amp; IEEE80211_FCTL_FTYPE)</span>
<span class="cp">#define WLAN_FC_GET_STYPE(fc) ((fc) &amp; IEEE80211_FCTL_STYPE)</span>

<span class="cp">#define WLAN_QC_GET_TID(qc) ((qc) &amp; 0x0f)</span>

<span class="cp">#define WLAN_GET_SEQ_FRAG(seq) ((seq) &amp; IEEE80211_SCTL_FRAG)</span>
<span class="cp">#define WLAN_GET_SEQ_SEQ(seq)  ((seq) &amp; IEEE80211_SCTL_SEQ)</span>

<span class="cm">/* Authentication algorithms */</span>
<span class="cp">#define WLAN_AUTH_OPEN 0</span>
<span class="cp">#define WLAN_AUTH_SHARED_KEY 1</span>

<span class="cp">#define WLAN_AUTH_CHALLENGE_LEN 128</span>

<span class="cp">#define WLAN_CAPABILITY_BSS (1&lt;&lt;0)</span>
<span class="cp">#define WLAN_CAPABILITY_IBSS (1&lt;&lt;1)</span>
<span class="cp">#define WLAN_CAPABILITY_CF_POLLABLE (1&lt;&lt;2)</span>
<span class="cp">#define WLAN_CAPABILITY_CF_POLL_REQUEST (1&lt;&lt;3)</span>
<span class="cp">#define WLAN_CAPABILITY_PRIVACY (1&lt;&lt;4)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_PREAMBLE (1&lt;&lt;5)</span>
<span class="cp">#define WLAN_CAPABILITY_PBCC (1&lt;&lt;6)</span>
<span class="cp">#define WLAN_CAPABILITY_CHANNEL_AGILITY (1&lt;&lt;7)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_SLOT (1&lt;&lt;10)</span>

<span class="cm">/* Status codes */</span>
<span class="cp">#define WLAN_STATUS_SUCCESS 0</span>
<span class="cp">#define WLAN_STATUS_UNSPECIFIED_FAILURE 1</span>
<span class="cp">#define WLAN_STATUS_CAPS_UNSUPPORTED 10</span>
<span class="cp">#define WLAN_STATUS_REASSOC_NO_ASSOC 11</span>
<span class="cp">#define WLAN_STATUS_ASSOC_DENIED_UNSPEC 12</span>
<span class="cp">#define WLAN_STATUS_NOT_SUPPORTED_AUTH_ALG 13</span>
<span class="cp">#define WLAN_STATUS_UNKNOWN_AUTH_TRANSACTION 14</span>
<span class="cp">#define WLAN_STATUS_CHALLENGE_FAIL 15</span>
<span class="cp">#define WLAN_STATUS_AUTH_TIMEOUT 16</span>
<span class="cp">#define WLAN_STATUS_AP_UNABLE_TO_HANDLE_NEW_STA 17</span>
<span class="cp">#define WLAN_STATUS_ASSOC_DENIED_RATES 18</span>
<span class="cm">/* 802.11b */</span>
<span class="cp">#define WLAN_STATUS_ASSOC_DENIED_NOSHORT 19</span>
<span class="cp">#define WLAN_STATUS_ASSOC_DENIED_NOPBCC 20</span>
<span class="cp">#define WLAN_STATUS_ASSOC_DENIED_NOAGILITY 21</span>

<span class="cm">/* Reason codes */</span>
<span class="cp">#define WLAN_REASON_UNSPECIFIED 1</span>
<span class="cp">#define WLAN_REASON_PREV_AUTH_NOT_VALID 2</span>
<span class="cp">#define WLAN_REASON_DEAUTH_LEAVING 3</span>
<span class="cp">#define WLAN_REASON_DISASSOC_DUE_TO_INACTIVITY 4</span>
<span class="cp">#define WLAN_REASON_DISASSOC_AP_BUSY 5</span>
<span class="cp">#define WLAN_REASON_CLASS2_FRAME_FROM_NONAUTH_STA 6</span>
<span class="cp">#define WLAN_REASON_CLASS3_FRAME_FROM_NONASSOC_STA 7</span>
<span class="cp">#define WLAN_REASON_DISASSOC_STA_HAS_LEFT 8</span>
<span class="cp">#define WLAN_REASON_STA_REQ_ASSOC_WITHOUT_AUTH 9</span>


<span class="cm">/* Information Element IDs */</span>
<span class="cp">#define WLAN_EID_SSID 0</span>
<span class="cp">#define WLAN_EID_SUPP_RATES 1</span>
<span class="cp">#define WLAN_EID_FH_PARAMS 2</span>
<span class="cp">#define WLAN_EID_DS_PARAMS 3</span>
<span class="cp">#define WLAN_EID_CF_PARAMS 4</span>
<span class="cp">#define WLAN_EID_TIM 5</span>
<span class="cp">#define WLAN_EID_IBSS_PARAMS 6</span>
<span class="cp">#define WLAN_EID_CHALLENGE 16</span>
<span class="cp">#define WLAN_EID_RSN 48</span>
<span class="cp">#define WLAN_EID_GENERIC 221</span>

<span class="cp">#define IEEE80211_MGMT_HDR_LEN 24</span>
<span class="cp">#define IEEE80211_DATA_HDR3_LEN 24</span>
<span class="cp">#define IEEE80211_DATA_HDR4_LEN 30</span>


<span class="cp">#define IEEE80211_STATMASK_SIGNAL (1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_STATMASK_RSSI (1&lt;&lt;1)</span>
<span class="cp">#define IEEE80211_STATMASK_NOISE (1&lt;&lt;2)</span>
<span class="cp">#define IEEE80211_STATMASK_RATE (1&lt;&lt;3)</span>
<span class="cp">#define IEEE80211_STATMASK_WEMASK 0x7</span>


<span class="cp">#define IEEE80211_CCK_MODULATION    (1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_OFDM_MODULATION   (1&lt;&lt;1)</span>

<span class="cp">#define IEEE80211_24GHZ_BAND     (1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_52GHZ_BAND     (1&lt;&lt;1)</span>

<span class="cp">#define IEEE80211_CCK_RATE_LEN			4</span>
<span class="cp">#define IEEE80211_NUM_OFDM_RATESLEN	8</span>


<span class="cp">#define IEEE80211_CCK_RATE_1MB		        0x02</span>
<span class="cp">#define IEEE80211_CCK_RATE_2MB		        0x04</span>
<span class="cp">#define IEEE80211_CCK_RATE_5MB		        0x0B</span>
<span class="cp">#define IEEE80211_CCK_RATE_11MB		        0x16</span>
<span class="cp">#define IEEE80211_OFDM_RATE_LEN			8</span>
<span class="cp">#define IEEE80211_OFDM_RATE_6MB		        0x0C</span>
<span class="cp">#define IEEE80211_OFDM_RATE_9MB		        0x12</span>
<span class="cp">#define IEEE80211_OFDM_RATE_12MB		0x18</span>
<span class="cp">#define IEEE80211_OFDM_RATE_18MB		0x24</span>
<span class="cp">#define IEEE80211_OFDM_RATE_24MB		0x30</span>
<span class="cp">#define IEEE80211_OFDM_RATE_36MB		0x48</span>
<span class="cp">#define IEEE80211_OFDM_RATE_48MB		0x60</span>
<span class="cp">#define IEEE80211_OFDM_RATE_54MB		0x6C</span>
<span class="cp">#define IEEE80211_BASIC_RATE_MASK		0x80</span>

<span class="cp">#define IEEE80211_CCK_RATE_1MB_MASK		(1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_CCK_RATE_2MB_MASK		(1&lt;&lt;1)</span>
<span class="cp">#define IEEE80211_CCK_RATE_5MB_MASK		(1&lt;&lt;2)</span>
<span class="cp">#define IEEE80211_CCK_RATE_11MB_MASK		(1&lt;&lt;3)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_6MB_MASK		(1&lt;&lt;4)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_9MB_MASK		(1&lt;&lt;5)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_12MB_MASK		(1&lt;&lt;6)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_18MB_MASK		(1&lt;&lt;7)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_24MB_MASK		(1&lt;&lt;8)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_36MB_MASK		(1&lt;&lt;9)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_48MB_MASK		(1&lt;&lt;10)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_54MB_MASK		(1&lt;&lt;11)</span>

<span class="cp">#define IEEE80211_CCK_RATES_MASK	        0x0000000F</span>
<span class="cp">#define IEEE80211_CCK_BASIC_RATES_MASK		(IEEE80211_CCK_RATE_1MB_MASK | \</span>
<span class="cp">	IEEE80211_CCK_RATE_2MB_MASK)</span>
<span class="cp">#define IEEE80211_CCK_DEFAULT_RATES_MASK   (IEEE80211_CCK_BASIC_RATES_MASK | \</span>
<span class="cp">					   IEEE80211_CCK_RATE_5MB_MASK | \</span>
<span class="cp">					   IEEE80211_CCK_RATE_11MB_MASK)</span>

<span class="cp">#define IEEE80211_OFDM_RATES_MASK		0x00000FF0</span>
<span class="cp">#define IEEE80211_OFDM_BASIC_RATES_MASK	(IEEE80211_OFDM_RATE_6MB_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_12MB_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_24MB_MASK)</span>
<span class="cp">#define IEEE80211_OFDM_DEFAULT_RATES_MASK  (IEEE80211_OFDM_BASIC_RATES_MASK | \</span>
<span class="cp">					   IEEE80211_OFDM_RATE_9MB_MASK  | \</span>
<span class="cp">					   IEEE80211_OFDM_RATE_18MB_MASK | \</span>
<span class="cp">					   IEEE80211_OFDM_RATE_36MB_MASK | \</span>
<span class="cp">					   IEEE80211_OFDM_RATE_48MB_MASK | \</span>
<span class="cp">					   IEEE80211_OFDM_RATE_54MB_MASK)</span>
<span class="cp">#define IEEE80211_DEFAULT_RATES_MASK (IEEE80211_OFDM_DEFAULT_RATES_MASK | \</span>
<span class="cp">				     IEEE80211_CCK_DEFAULT_RATES_MASK)</span>

<span class="cp">#define IEEE80211_NUM_OFDM_RATES	    8</span>
<span class="cp">#define IEEE80211_NUM_CCK_RATES	            4</span>
<span class="cp">#define IEEE80211_OFDM_SHIFT_MASK_A         4</span>




<span class="cm">/* NOTE: This data is for statistical purposes; not all hardware provides this</span>
<span class="cm"> *       information for frames received.  Not setting these will not cause</span>
<span class="cm"> *       any adverse affects. */</span>
<span class="k">struct</span> <span class="n">ieee80211_rx_stats</span> <span class="p">{</span>
	<span class="n">s8</span> <span class="n">rssi</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">signal</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">noise</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">received_channel</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">rate</span><span class="p">;</span> <span class="cm">/* in 100 kbps */</span>
	<span class="n">u8</span> <span class="n">mask</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">freq</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">len</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* IEEE 802.11 requires that STA supports concurrent reception of at least</span>
<span class="cm"> * three fragmented frames. This define can be increased to support more</span>
<span class="cm"> * concurrent frames, but it should be noted that each entry can consume about</span>
<span class="cm"> * 2 kB of RAM and increasing cache size will slow down frame reassembly. */</span>
<span class="cp">#define IEEE80211_FRAG_CACHE_LEN 4</span>

<span class="k">struct</span> <span class="n">ieee80211_frag_entry</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">first_frag_time</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">seq</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">last_frag</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">qos</span><span class="p">;</span>   <span class="cm">/*jackson*/</span>
	<span class="n">uint</span> <span class="n">tid</span><span class="p">;</span>	<span class="cm">/*jackson*/</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">src_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">dst_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_stats</span> <span class="p">{</span>
	<span class="n">uint</span> <span class="n">tx_unicast_frames</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_multicast_frames</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_fragments</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_unicast_octets</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_multicast_octets</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_deferred_transmissions</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_single_retry_frames</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_multiple_retry_frames</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_retry_limit_exceeded</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_discards</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_unicast_frames</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_multicast_frames</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_fragments</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_unicast_octets</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_multicast_octets</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_fcs_errors</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_discards_no_buffer</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_discards_wrong_sa</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_discards_undecryptable</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_message_in_msg_fragments</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_message_in_bad_msg_fragments</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_softmac_stats</span> <span class="p">{</span>
	<span class="n">uint</span> <span class="n">rx_ass_ok</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_ass_err</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_probe_rq</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_probe_rs</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_beacons</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_auth_rq</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_auth_rs_ok</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_auth_rs_err</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_auth_rq</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">no_auth_rs</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">no_ass_rs</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_ass_rq</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">rx_ass_rq</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">tx_probe_rq</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">reassoc</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">swtxstop</span><span class="p">;</span>
	<span class="n">uint</span> <span class="n">swtxawake</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define SEC_KEY_1         (1&lt;&lt;0)</span>
<span class="cp">#define SEC_KEY_2         (1&lt;&lt;1)</span>
<span class="cp">#define SEC_KEY_3         (1&lt;&lt;2)</span>
<span class="cp">#define SEC_KEY_4         (1&lt;&lt;3)</span>
<span class="cp">#define SEC_ACTIVE_KEY    (1&lt;&lt;4)</span>
<span class="cp">#define SEC_AUTH_MODE     (1&lt;&lt;5)</span>
<span class="cp">#define SEC_UNICAST_GROUP (1&lt;&lt;6)</span>
<span class="cp">#define SEC_LEVEL         (1&lt;&lt;7)</span>
<span class="cp">#define SEC_ENABLED       (1&lt;&lt;8)</span>

<span class="cp">#define SEC_LEVEL_0      0 </span><span class="cm">/* None */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_1      1 </span><span class="cm">/* WEP 40 and 104 bit */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_2      2 </span><span class="cm">/* Level 1 + TKIP */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_2_CKIP 3 </span><span class="cm">/* Level 1 + CKIP */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_3      4 </span><span class="cm">/* Level 2 + CCMP */</span><span class="cp"></span>

<span class="cp">#define WEP_KEYS 4</span>
<span class="cp">#define WEP_KEY_LEN 13</span>

<span class="k">struct</span> <span class="n">ieee80211_security</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">active_key</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span>
	    <span class="nl">enabled:</span><span class="mi">1</span><span class="p">,</span>
	    <span class="nl">auth_mode:</span><span class="mi">2</span><span class="p">,</span>
	    <span class="nl">auth_algo:</span><span class="mi">4</span><span class="p">,</span>
	    <span class="nl">unicast_uses_group:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key_sizes</span><span class="p">[</span><span class="n">WEP_KEYS</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">keys</span><span class="p">[</span><span class="n">WEP_KEYS</span><span class="p">][</span><span class="n">WEP_KEY_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">level</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/*</span>

<span class="cm"> 802.11 data frame from AP</span>

<span class="cm">      ,-------------------------------------------------------------------.</span>
<span class="cm">Bytes |  2   |  2   |    6    |    6    |    6    |  2   | 0..2312 |   4  |</span>
<span class="cm">      |------|------|---------|---------|---------|------|---------|------|</span>
<span class="cm">Desc. | ctrl | dura |  DA/RA  |   TA    |    SA   | Sequ |  frame  |  fcs |</span>
<span class="cm">      |      | tion | (BSSID) |         |         | ence |  data   |      |</span>
<span class="cm">      `-------------------------------------------------------------------&#39;</span>

<span class="cm">Total: 28-2340 bytes</span>

<span class="cm">*/</span>

<span class="k">struct</span> <span class="n">ieee80211_header_data</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_ctrl</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BEACON_PROBE_SSID_ID_POSITION 12</span>

<span class="cm">/* Management Frame Information Element Types */</span>
<span class="cp">#define MFIE_TYPE_SSID       0</span>
<span class="cp">#define MFIE_TYPE_RATES      1</span>
<span class="cp">#define MFIE_TYPE_FH_SET     2</span>
<span class="cp">#define MFIE_TYPE_DS_SET     3</span>
<span class="cp">#define MFIE_TYPE_CF_SET     4</span>
<span class="cp">#define MFIE_TYPE_TIM        5</span>
<span class="cp">#define MFIE_TYPE_IBSS_SET   6</span>
<span class="cp">#define MFIE_TYPE_CHALLENGE  16</span>
<span class="cp">#define MFIE_TYPE_ERP        42</span>
<span class="cp">#define MFIE_TYPE_RSN	     48</span>
<span class="cp">#define MFIE_TYPE_RATES_EX   50</span>
<span class="cp">#define MFIE_TYPE_GENERIC    221</span>

<span class="k">struct</span> <span class="n">ieee80211_info_element_hdr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * These are the data types that can make up management packets</span>
<span class="cm"> *</span>
<span class="cm">	u16 auth_algorithm;</span>
<span class="cm">	u16 auth_sequence;</span>
<span class="cm">	u16 beacon_interval;</span>
<span class="cm">	u16 capability;</span>
<span class="cm">	u8 current_ap[ETH_ALEN];</span>
<span class="cm">	u16 listen_interval;</span>
<span class="cm">	struct {</span>
<span class="cm">		u16 association_id:14, reserved:2;</span>
<span class="cm">	} __packed;</span>
<span class="cm">	u32 time_stamp[2];</span>
<span class="cm">	u16 reason;</span>
<span class="cm">	u16 status;</span>
<span class="cm">*/</span>

<span class="cp">#define IEEE80211_DEFAULT_TX_ESSID &quot;Penguin&quot;</span>
<span class="cp">#define IEEE80211_DEFAULT_BASIC_RATE 10</span>

<span class="k">struct</span> <span class="n">ieee80211_authentication</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_header_data</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">algorithm</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">transaction</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_probe_response</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_header_data</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">time_stamp</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">beacon_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="n">info_element</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_probe_request</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_header_data</span> <span class="n">header</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_assoc_request_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element_hdr</span> <span class="n">info_element</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_assoc_response_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">aid</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ieee80211_txb</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr_frags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">encrypted</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">frag_size</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">payload_size</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">fragments</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* SWEEP TABLE ENTRIES NUMBER*/</span>
<span class="cp">#define MAX_SWEEP_TAB_ENTRIES		  42</span>
<span class="cp">#define MAX_SWEEP_TAB_ENTRIES_PER_PACKET  7</span>
<span class="cm">/* MAX_RATES_LENGTH needs to be 12.  The spec says 8, and many APs</span>
<span class="cm"> * only use 8, and then use extended rates for the remaining supported</span>
<span class="cm"> * rates.  Other APs, however, stick all of their supported rates on the</span>
<span class="cm"> * main rates information element... */</span>
<span class="cp">#define MAX_RATES_LENGTH                  ((u8)12)</span>
<span class="cp">#define MAX_RATES_EX_LENGTH               ((u8)16)</span>
<span class="cp">#define MAX_NETWORK_COUNT                  128</span>
<span class="cp">#define MAX_CHANNEL_NUMBER                 161</span>
<span class="cp">#define IEEE80211_SOFTMAC_SCAN_TIME	  400</span>
<span class="cm">/*(HZ / 2)*/</span>
<span class="cp">#define IEEE80211_SOFTMAC_ASSOC_RETRY_TIME (HZ * 2)</span>

<span class="cp">#define CRC_LENGTH                 4U</span>

<span class="cp">#define MAX_WPA_IE_LEN 128</span>

<span class="cp">#define NETWORK_EMPTY_ESSID (1&lt;&lt;0)</span>
<span class="cp">#define NETWORK_HAS_OFDM    (1&lt;&lt;1)</span>
<span class="cp">#define NETWORK_HAS_CCK     (1&lt;&lt;2)</span>

<span class="cp">#define IEEE80211_DTIM_MBCAST 4</span>
<span class="cp">#define IEEE80211_DTIM_UCAST 2</span>
<span class="cp">#define IEEE80211_DTIM_VALID 1</span>
<span class="cp">#define IEEE80211_DTIM_INVALID 0</span>

<span class="cp">#define IEEE80211_PS_DISABLED 0</span>
<span class="cp">#define IEEE80211_PS_UNICAST IEEE80211_DTIM_UCAST</span>
<span class="cp">#define IEEE80211_PS_MBCAST IEEE80211_DTIM_MBCAST</span>
<span class="cp">#define IW_ESSID_MAX_SIZE 32</span>
<span class="cm">/*</span>
<span class="cm"> * join_res:</span>
<span class="cm"> * -1: authentication fail</span>
<span class="cm"> * -2: association fail</span>
<span class="cm"> * &gt; 0: TID</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">ieee80211_state</span> <span class="p">{</span>
	<span class="cm">/* the card is not linked at all */</span>
	<span class="n">IEEE80211_NOLINK</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="cm">/* IEEE80211_ASSOCIATING* are for BSS client mode</span>
<span class="cm">	 * the driver shall not perform RX filtering unless</span>
<span class="cm">	 * the state is LINKED.</span>
<span class="cm">	 * The driver shall just check for the state LINKED and</span>
<span class="cm">	 * defaults to NOLINK for ALL the other states (including</span>
<span class="cm">	 * LINKED_SCANNING)</span>
<span class="cm">	 */</span>
	<span class="cm">/* the association procedure will start (wq scheduling)*/</span>
	<span class="n">IEEE80211_ASSOCIATING</span><span class="p">,</span>
	<span class="n">IEEE80211_ASSOCIATING_RETRY</span><span class="p">,</span>
	<span class="cm">/* the association procedure is sending AUTH request*/</span>
	<span class="n">IEEE80211_ASSOCIATING_AUTHENTICATING</span><span class="p">,</span>
	<span class="cm">/* the association procedure has successfully authenticated</span>
<span class="cm">	 * and is sending association request</span>
<span class="cm">	 */</span>
	<span class="n">IEEE80211_ASSOCIATING_AUTHENTICATED</span><span class="p">,</span>
	<span class="cm">/* the link is ok. the card associated to a BSS or linked</span>
<span class="cm">	 * to a ibss cell or acting as an AP and creating the bss</span>
<span class="cm">	 */</span>
	<span class="n">IEEE80211_LINKED</span><span class="p">,</span>
	<span class="cm">/* same as LINKED, but the driver shall apply RX filter</span>
<span class="cm">	 * rules as we are in NO_LINK mode. As the card is still</span>
<span class="cm">	 * logically linked, but it is doing a syncro site survey</span>
<span class="cm">	 * then it will be back to LINKED state.</span>
<span class="cm">	 */</span>
	<span class="n">IEEE80211_LINKED_SCANNING</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define DEFAULT_MAX_SCAN_AGE (15 * HZ)</span>
<span class="cp">#define DEFAULT_FTS 2346</span>

<span class="cp">#define CFG_IEEE80211_RESERVE_FCS (1&lt;&lt;0)</span>
<span class="cp">#define CFG_IEEE80211_COMPUTE_FCS (1&lt;&lt;1)</span>

<span class="cp">#define MAXTID	16</span>

<span class="cp">#define IEEE_A            (1&lt;&lt;0)</span>
<span class="cp">#define IEEE_B            (1&lt;&lt;1)</span>
<span class="cp">#define IEEE_G            (1&lt;&lt;2)</span>
<span class="cp">#define IEEE_MODE_MASK    (IEEE_A|IEEE_B|IEEE_G)</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_empty_essid</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">essid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">essid_len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* Single white space is for Linksys APs */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">essid_len</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">essid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="cm">/* Otherwise, if the entire essid is 0, we assume it is hidden */</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">essid_len</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">essid_len</span><span class="o">--</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">essid</span><span class="p">[</span><span class="n">essid_len</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_get_hdrlen</span><span class="p">(</span><span class="n">u16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">hdrlen</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">WLAN_FC_GET_TYPE</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">IEEE80211_FTYPE_DATA</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">IEEE80211_QOS_DATAGRP</span><span class="p">)</span>
			<span class="n">hdrlen</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">IEEE80211_FCTL_FROMDS</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">IEEE80211_FCTL_TODS</span><span class="p">))</span>
			<span class="n">hdrlen</span> <span class="o">+=</span> <span class="mi">6</span><span class="p">;</span> <span class="cm">/* Addr4 */</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IEEE80211_FTYPE_CTL</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">WLAN_FC_GET_STYPE</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">IEEE80211_STYPE_CTS</span>:
		<span class="k">case</span> <span class="n">IEEE80211_STYPE_ACK</span>:
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">hdrlen</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">struct</span> <span class="n">registry_priv</span><span class="p">;</span>

<span class="n">u8</span> <span class="o">*</span><span class="n">r8712_set_ie</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">pbuf</span><span class="p">,</span> <span class="n">sint</span> <span class="n">index</span><span class="p">,</span> <span class="n">uint</span> <span class="n">len</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">source</span><span class="p">,</span> <span class="n">uint</span> <span class="o">*</span><span class="n">frlen</span><span class="p">);</span>
<span class="n">u8</span> <span class="o">*</span><span class="n">r8712_get_ie</span><span class="p">(</span><span class="n">u8</span><span class="o">*</span><span class="n">pbuf</span><span class="p">,</span> <span class="n">sint</span> <span class="n">index</span><span class="p">,</span> <span class="n">sint</span> <span class="o">*</span><span class="n">len</span><span class="p">,</span> <span class="n">sint</span> <span class="n">limit</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">r8712_get_wpa_ie</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pie</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">rsn_ie_len</span><span class="p">,</span> <span class="kt">int</span> <span class="n">limit</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">r8712_get_wpa2_ie</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">pie</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">rsn_ie_len</span><span class="p">,</span>
				 <span class="kt">int</span> <span class="n">limit</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">r8712_parse_wpa_ie</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">wpa_ie</span><span class="p">,</span> <span class="kt">int</span> <span class="n">wpa_ie_len</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">group_cipher</span><span class="p">,</span>
			<span class="kt">int</span> <span class="o">*</span><span class="n">pairwise_cipher</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">r8712_parse_wpa2_ie</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">wpa_ie</span><span class="p">,</span> <span class="kt">int</span> <span class="n">wpa_ie_len</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">group_cipher</span><span class="p">,</span>
			<span class="kt">int</span> <span class="o">*</span><span class="n">pairwise_cipher</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">r8712_get_sec_ie</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">in_ie</span><span class="p">,</span> <span class="n">uint</span> <span class="n">in_len</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">rsn_ie</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="n">rsn_len</span><span class="p">,</span>
		     <span class="n">u8</span> <span class="o">*</span><span class="n">wpa_ie</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="n">wpa_len</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">r8712_get_wps_ie</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">in_ie</span><span class="p">,</span> <span class="n">uint</span> <span class="n">in_len</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">wps_ie</span><span class="p">,</span> <span class="n">uint</span> <span class="o">*</span><span class="n">wps_ielen</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">r8712_generate_ie</span><span class="p">(</span><span class="k">struct</span> <span class="n">registry_priv</span> <span class="o">*</span><span class="n">pregistrypriv</span><span class="p">);</span>
<span class="n">uint</span> <span class="n">r8712_is_cckrates_included</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">rate</span><span class="p">);</span>
<span class="n">uint</span> <span class="n">r8712_is_cckratesonly_included</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">rate</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* IEEE80211_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
