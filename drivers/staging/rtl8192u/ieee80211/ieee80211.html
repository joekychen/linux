<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › rtl8192u › ieee80211 › ieee80211.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>ieee80211.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Merged with mainline ieee80211.h in Aug 2004.  Original ieee802_11</span>
<span class="cm"> * remains copyright by the original authors</span>
<span class="cm"> *</span>
<span class="cm"> * Portions of the merged code are based on Host AP (software wireless</span>
<span class="cm"> * LAN access point) driver for Intersil Prism2/2.5/3.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2001-2002, SSH Communications Security Corp and Jouni Malinen</span>
<span class="cm"> * &lt;jkmaline@cc.hut.fi&gt;</span>
<span class="cm"> * Copyright (c) 2002-2003, Jouni Malinen &lt;jkmaline@cc.hut.fi&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Adaption to a generic IEEE 802.11 stack by James Ketrenos</span>
<span class="cm"> * &lt;jketreno@linux.intel.com&gt;</span>
<span class="cm"> * Copyright (c) 2004, Intel Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * Modified for Realtek&#39;s wi-fi cards by Andrea Merello</span>
<span class="cm"> * &lt;andreamrl@tiscali.it&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation. See README and COPYING for</span>
<span class="cm"> * more details.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef IEEE80211_H</span>
<span class="cp">#define IEEE80211_H</span>
<span class="cp">#include &lt;linux/if_ether.h&gt; </span><span class="cm">/* ETH_ALEN */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/kernel.h&gt;   </span><span class="cm">/* ARRAY_SIZE */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/jiffies.h&gt;</span>
<span class="cp">#include &lt;linux/timer.h&gt;</span>
<span class="cp">#include &lt;linux/sched.h&gt;</span>
<span class="cp">#include &lt;linux/semaphore.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>

<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/wireless.h&gt;</span>

<span class="cp">#include &quot;rtl819x_HT.h&quot;</span>
<span class="cp">#include &quot;rtl819x_BA.h&quot;</span>
<span class="cp">#include &quot;rtl819x_TS.h&quot;</span>


<span class="cp">#ifndef IW_MODE_MONITOR</span>
<span class="cp">#define IW_MODE_MONITOR 6</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef IWEVCUSTOM</span>
<span class="cp">#define IWEVCUSTOM 0x8c02</span>
<span class="cp">#endif</span>


<span class="cp">#ifndef container_of</span>
<span class="cm">/**</span>
<span class="cm"> * container_of - cast a member of a structure out to the containing structure</span>
<span class="cm"> *</span>
<span class="cm"> * @ptr:        the pointer to the member.</span>
<span class="cm"> * @type:       the type of the container struct this is embedded in.</span>
<span class="cm"> * @member:     the name of the member within the struct.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#define container_of(ptr, type, member) ({                      \</span>
<span class="cp">	const typeof( ((type *)0)-&gt;member ) *__mptr = (ptr);    \</span>
<span class="cp">	(type *)( (char *)__mptr - offsetof(type,member) );})</span>
<span class="cp">#endif</span>

<span class="cp">#define KEY_TYPE_NA		0x0</span>
<span class="cp">#define KEY_TYPE_WEP40 		0x1</span>
<span class="cp">#define KEY_TYPE_TKIP		0x2</span>
<span class="cp">#define KEY_TYPE_CCMP		0x4</span>
<span class="cp">#define KEY_TYPE_WEP104		0x5</span>

<span class="cm">/* added for rtl819x tx procedure */</span>
<span class="cp">#define MAX_QUEUE_SIZE		0x10</span></pre></div></td></tr>


<tr id="section-2"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-2">&#182;</a></div><p>8190 queue mapping</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define BK_QUEUE                               0</span>
<span class="cp">#define BE_QUEUE                               1</span>
<span class="cp">#define VI_QUEUE                               2</span>
<span class="cp">#define VO_QUEUE                               3</span>
<span class="cp">#define HCCA_QUEUE                             4</span>
<span class="cp">#define TXCMD_QUEUE                            5</span>
<span class="cp">#define MGNT_QUEUE                             6</span>
<span class="cp">#define HIGH_QUEUE                             7</span>
<span class="cp">#define BEACON_QUEUE                           8</span>

<span class="cp">#define LOW_QUEUE                              BE_QUEUE</span>
<span class="cp">#define NORMAL_QUEUE                           MGNT_QUEUE</span></pre></div></td></tr>


<tr id="section-3"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-3">&#182;</a></div><p>added by amy for ps</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define SWRF_TIMEOUT				50</span></pre></div></td></tr>


<tr id="section-4"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-4">&#182;</a></div><p>added by amy for LEAP related</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IE_CISCO_FLAG_POSITION		0x08	</span><span class="c1">// Flag byte: byte 8, numbered from 0.</span>
<span class="cp">#define SUPPORT_CKIP_MIC			0x08	</span><span class="c1">// bit3</span>
<span class="cp">#define SUPPORT_CKIP_PK			0x10	</span><span class="c1">// bit4</span>
<span class="cm">/* defined for skb cb field */</span>
<span class="cm">/* At most 28 byte */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">cb_desc</span> <span class="p">{</span>
	<span class="cm">/* Tx Desc Related flags (8-9) */</span>
	<span class="n">u8</span> <span class="n">bLastIniPkt</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bCmdOrInit</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bFirstSeg</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bLastSeg</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bEncrypt</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bTxDisableRateFallBack</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bTxUseDriverAssingedRate</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bHwSec</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="c1">//indicate whether use Hw security. WB</span>

	<span class="n">u8</span> <span class="n">reserved1</span><span class="p">;</span>

	<span class="cm">/* Tx Firmware Relaged flags (10-11)*/</span>
	<span class="n">u8</span> <span class="n">bCTSEnable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSEnable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bUseShortGI</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bUseShortPreamble</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bTxEnableFwCalcDur</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bAMPDUEnable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSSTBC</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">RTSSC</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">bRTSBW</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bPacketBW</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSUseShortPreamble</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSUseShortGI</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bMulticast</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bBroadcast</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-5"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-5">&#182;</a></div><p>u8 reserved2:2;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span> <span class="n">drv_agg_enable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved2</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* Tx Desc related element(12-19) */</span>
	<span class="n">u8</span> <span class="n">rata_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">queue_index</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-6"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-6">&#182;</a></div><p>u8 reserved3;
u8 reserved4;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u16</span> <span class="n">txbuf_size</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-7"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-7">&#182;</a></div><p>u8 reserved5;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span> <span class="n">RATRIndex</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved6</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved7</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved8</span><span class="p">;</span>

	<span class="cm">/* Tx firmware related element(20-27) */</span>
	<span class="n">u8</span> <span class="n">data_rate</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rts_rate</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ampdu_factor</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ampdu_density</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-8"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-8">&#182;</a></div><p>u8 reserved9;
u8 reserved10;
u8 reserved11;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span> <span class="n">DrvAggrNum</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">pkt_size</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved12</span><span class="p">;</span>
<span class="p">}</span><span class="n">cb_desc</span><span class="p">,</span> <span class="o">*</span><span class="n">pcb_desc</span><span class="p">;</span>

<span class="cm">/*--------------------------Define -------------------------------------------*/</span>
<span class="cp">#define MGN_1M                  0x02</span>
<span class="cp">#define MGN_2M                  0x04</span>
<span class="cp">#define MGN_5_5M                0x0b</span>
<span class="cp">#define MGN_11M                 0x16</span>

<span class="cp">#define MGN_6M                  0x0c</span>
<span class="cp">#define MGN_9M                  0x12</span>
<span class="cp">#define MGN_12M                 0x18</span>
<span class="cp">#define MGN_18M                 0x24</span>
<span class="cp">#define MGN_24M                 0x30</span>
<span class="cp">#define MGN_36M                 0x48</span>
<span class="cp">#define MGN_48M                 0x60</span>
<span class="cp">#define MGN_54M                 0x6c</span>

<span class="cp">#define MGN_MCS0                0x80</span>
<span class="cp">#define MGN_MCS1                0x81</span>
<span class="cp">#define MGN_MCS2                0x82</span>
<span class="cp">#define MGN_MCS3                0x83</span>
<span class="cp">#define MGN_MCS4                0x84</span>
<span class="cp">#define MGN_MCS5                0x85</span>
<span class="cp">#define MGN_MCS6                0x86</span>
<span class="cp">#define MGN_MCS7                0x87</span>
<span class="cp">#define MGN_MCS8                0x88</span>
<span class="cp">#define MGN_MCS9                0x89</span>
<span class="cp">#define MGN_MCS10               0x8a</span>
<span class="cp">#define MGN_MCS11               0x8b</span>
<span class="cp">#define MGN_MCS12               0x8c</span>
<span class="cp">#define MGN_MCS13               0x8d</span>
<span class="cp">#define MGN_MCS14               0x8e</span>
<span class="cp">#define MGN_MCS15               0x8f</span></pre></div></td></tr>


<tr id="section-9"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-9">&#182;</a></div><hr />

<h2>    802.11 Management frame Reason Code field</h2></td><td class="code"><div class="highlight"><pre><span class="k">enum</span>	<span class="n">_ReasonCode</span><span class="p">{</span>
	<span class="n">unspec_reason</span>	<span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">auth_not_valid</span>	<span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">deauth_lv_ss</span>	<span class="o">=</span> <span class="mh">0x3</span><span class="p">,</span>
	<span class="n">inactivity</span>		<span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">ap_overload</span> 	<span class="o">=</span> <span class="mh">0x5</span><span class="p">,</span>
	<span class="n">class2_err</span>		<span class="o">=</span> <span class="mh">0x6</span><span class="p">,</span>
	<span class="n">class3_err</span>		<span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">disas_lv_ss</span> 	<span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">asoc_not_auth</span>	<span class="o">=</span> <span class="mh">0x9</span><span class="p">,</span></pre></div></td></tr>


<tr id="section-10"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-10">&#182;</a></div><p>----MIC_CHECK</p></td><td class="code"><div class="highlight"><pre>	<span class="n">mic_failure</span> 	<span class="o">=</span> <span class="mh">0xe</span><span class="p">,</span></pre></div></td></tr>


<tr id="section-11"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-11">&#182;</a></div><p>----END MIC_CHECK</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-12"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-12">&#182;</a></div><p>Reason code defined in 802.11i D10.0 p.28.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">invalid_IE</span>		<span class="o">=</span> <span class="mh">0x0d</span><span class="p">,</span>
	<span class="n">four_way_tmout</span>	<span class="o">=</span> <span class="mh">0x0f</span><span class="p">,</span>
	<span class="n">two_way_tmout</span>	<span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">IE_dismatch</span> 	<span class="o">=</span> <span class="mh">0x11</span><span class="p">,</span>
	<span class="n">invalid_Gcipher</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">,</span>
	<span class="n">invalid_Pcipher</span> <span class="o">=</span> <span class="mh">0x13</span><span class="p">,</span>
	<span class="n">invalid_AKMP</span>	<span class="o">=</span> <span class="mh">0x14</span><span class="p">,</span>
	<span class="n">unsup_RSNIEver</span> <span class="o">=</span> <span class="mh">0x15</span><span class="p">,</span>
	<span class="n">invalid_RSNIE</span>	<span class="o">=</span> <span class="mh">0x16</span><span class="p">,</span>
	<span class="n">auth_802_1x_fail</span><span class="o">=</span> <span class="mh">0x17</span><span class="p">,</span>
	<span class="n">ciper_reject</span>		<span class="o">=</span> <span class="mh">0x18</span><span class="p">,</span></pre></div></td></tr>


<tr id="section-13"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-13">&#182;</a></div><p>Reason code defined in 7.3.1.7, 802.1e D13.0, p.42. Added by Annie, 2005-11-15.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">QoS_unspec</span>		<span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span> <span class="c1">// 32</span>
	<span class="n">QAP_bandwidth</span>	<span class="o">=</span> <span class="mh">0x21</span><span class="p">,</span> <span class="c1">// 33</span>
	<span class="n">poor_condition</span>	<span class="o">=</span> <span class="mh">0x22</span><span class="p">,</span> <span class="c1">// 34</span>
	<span class="n">no_facility</span> 	<span class="o">=</span> <span class="mh">0x23</span><span class="p">,</span> <span class="c1">// 35</span></pre></div></td></tr>


<tr id="section-14"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-14">&#182;</a></div><p>Where is 36???</p></td><td class="code"><div class="highlight"><pre>	<span class="n">req_declined</span>	<span class="o">=</span> <span class="mh">0x25</span><span class="p">,</span> <span class="c1">// 37</span>
	<span class="n">invalid_param</span>	<span class="o">=</span> <span class="mh">0x26</span><span class="p">,</span> <span class="c1">// 38</span>
	<span class="n">req_not_honored</span><span class="o">=</span> <span class="mh">0x27</span><span class="p">,</span>	<span class="c1">// 39</span>
	<span class="n">TS_not_created</span>	<span class="o">=</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="c1">// 47</span>
	<span class="n">DL_not_allowed</span>	<span class="o">=</span> <span class="mh">0x30</span><span class="p">,</span> <span class="c1">// 48</span>
	<span class="n">dest_not_exist</span>	<span class="o">=</span> <span class="mh">0x31</span><span class="p">,</span> <span class="c1">// 49</span>
	<span class="n">dest_not_QSTA</span>	<span class="o">=</span> <span class="mh">0x32</span><span class="p">,</span> <span class="c1">// 50</span>
<span class="p">};</span>



<span class="cp">#define aSifsTime	 ((priv-&gt;ieee80211-&gt;current_network.mode == IEEE_A)||(priv-&gt;ieee80211-&gt;current_network.mode == IEEE_N_24G)||(priv-&gt;ieee80211-&gt;current_network.mode == IEEE_N_5G))? 16 : 10</span>

<span class="cp">#define MGMT_QUEUE_NUM 5</span>

<span class="cp">#define IEEE_CMD_SET_WPA_PARAM			1</span>
<span class="cp">#define	IEEE_CMD_SET_WPA_IE			2</span>
<span class="cp">#define IEEE_CMD_SET_ENCRYPTION			3</span>
<span class="cp">#define IEEE_CMD_MLME				4</span>

<span class="cp">#define IEEE_PARAM_WPA_ENABLED			1</span>
<span class="cp">#define IEEE_PARAM_TKIP_COUNTERMEASURES		2</span>
<span class="cp">#define IEEE_PARAM_DROP_UNENCRYPTED		3</span>
<span class="cp">#define IEEE_PARAM_PRIVACY_INVOKED		4</span>
<span class="cp">#define IEEE_PARAM_AUTH_ALGS			5</span>
<span class="cp">#define IEEE_PARAM_IEEE_802_1X			6</span></pre></div></td></tr>


<tr id="section-15"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-15">&#182;</a></div><p>It should consistent with the driver_XXX.c
  David, 2006.9.26</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IEEE_PARAM_WPAX_SELECT			7</span></pre></div></td></tr>


<tr id="section-16"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-16">&#182;</a></div><p>Added for notify the encryption type selection
  David, 2006.9.26</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IEEE_PROTO_WPA				1</span>
<span class="cp">#define IEEE_PROTO_RSN				2</span></pre></div></td></tr>


<tr id="section-17"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-17">&#182;</a></div><p>Added for notify the encryption type selection
  David, 2006.9.26</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IEEE_WPAX_USEGROUP			0</span>
<span class="cp">#define IEEE_WPAX_WEP40				1</span>
<span class="cp">#define IEEE_WPAX_TKIP				2</span>
<span class="cp">#define IEEE_WPAX_WRAP   			3</span>
<span class="cp">#define IEEE_WPAX_CCMP				4</span>
<span class="cp">#define IEEE_WPAX_WEP104			5</span>

<span class="cp">#define IEEE_KEY_MGMT_IEEE8021X			1</span>
<span class="cp">#define IEEE_KEY_MGMT_PSK			2</span>

<span class="cp">#define IEEE_MLME_STA_DEAUTH			1</span>
<span class="cp">#define IEEE_MLME_STA_DISASSOC			2</span>


<span class="cp">#define IEEE_CRYPT_ERR_UNKNOWN_ALG		2</span>
<span class="cp">#define IEEE_CRYPT_ERR_UNKNOWN_ADDR		3</span>
<span class="cp">#define IEEE_CRYPT_ERR_CRYPT_INIT_FAILED	4</span>
<span class="cp">#define IEEE_CRYPT_ERR_KEY_SET_FAILED		5</span>
<span class="cp">#define IEEE_CRYPT_ERR_TX_KEY_SET_FAILED	6</span>
<span class="cp">#define IEEE_CRYPT_ERR_CARD_CONF_FAILED		7</span>


<span class="cp">#define	IEEE_CRYPT_ALG_NAME_LEN			16</span>

<span class="cp">#define MAX_IE_LEN  0xff</span></pre></div></td></tr>


<tr id="section-18"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-18">&#182;</a></div><p>added for kernel conflict</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define ieee80211_crypt_deinit_entries 	ieee80211_crypt_deinit_entries_rsl</span>
<span class="cp">#define ieee80211_crypt_deinit_handler 	ieee80211_crypt_deinit_handler_rsl</span>
<span class="cp">#define ieee80211_crypt_delayed_deinit 	ieee80211_crypt_delayed_deinit_rsl</span>
<span class="cp">#define ieee80211_register_crypto_ops  	ieee80211_register_crypto_ops_rsl</span>
<span class="cp">#define ieee80211_unregister_crypto_ops ieee80211_unregister_crypto_ops_rsl</span>
<span class="cp">#define ieee80211_get_crypto_ops 	ieee80211_get_crypto_ops_rsl</span>

<span class="cp">#define ieee80211_ccmp_null		ieee80211_ccmp_null_rsl</span>

<span class="cp">#define ieee80211_tkip_null		ieee80211_tkip_null_rsl</span>

<span class="cp">#define ieee80211_wep_null		ieee80211_wep_null_rsl</span>

<span class="cp">#define free_ieee80211          	free_ieee80211_rsl</span>
<span class="cp">#define alloc_ieee80211        		alloc_ieee80211_rsl</span>

<span class="cp">#define ieee80211_rx 			ieee80211_rx_rsl</span>
<span class="cp">#define ieee80211_rx_mgt		ieee80211_rx_mgt_rsl</span>

<span class="cp">#define ieee80211_get_beacon		ieee80211_get_beacon_rsl</span>
<span class="cp">#define ieee80211_wake_queue		ieee80211_wake_queue_rsl</span>
<span class="cp">#define ieee80211_stop_queue		ieee80211_stop_queue_rsl</span>
<span class="cp">#define ieee80211_reset_queue		ieee80211_reset_queue_rsl</span>
<span class="cp">#define ieee80211_softmac_stop_protocol	ieee80211_softmac_stop_protocol_rsl</span>
<span class="cp">#define ieee80211_softmac_start_protocol ieee80211_softmac_start_protocol_rsl</span>
<span class="cp">#define ieee80211_is_shortslot		ieee80211_is_shortslot_rsl</span>
<span class="cp">#define ieee80211_is_54g		ieee80211_is_54g_rsl</span>
<span class="cp">#define ieee80211_wpa_supplicant_ioctl	ieee80211_wpa_supplicant_ioctl_rsl</span>
<span class="cp">#define ieee80211_ps_tx_ack		ieee80211_ps_tx_ack_rsl</span>
<span class="cp">#define ieee80211_softmac_xmit		ieee80211_softmac_xmit_rsl</span>
<span class="cp">#define ieee80211_stop_send_beacons	ieee80211_stop_send_beacons_rsl</span>
<span class="cp">#define notify_wx_assoc_event		notify_wx_assoc_event_rsl</span>
<span class="cp">#define SendDisassociation		SendDisassociation_rsl</span>
<span class="cp">#define ieee80211_disassociate		ieee80211_disassociate_rsl</span>
<span class="cp">#define ieee80211_start_send_beacons	ieee80211_start_send_beacons_rsl</span>
<span class="cp">#define ieee80211_stop_scan		ieee80211_stop_scan_rsl</span>
<span class="cp">#define ieee80211_send_probe_requests	ieee80211_send_probe_requests_rsl</span>
<span class="cp">#define ieee80211_softmac_scan_syncro	ieee80211_softmac_scan_syncro_rsl</span>
<span class="cp">#define ieee80211_start_scan_syncro	ieee80211_start_scan_syncro_rsl</span>

<span class="cp">#define ieee80211_wx_get_essid		ieee80211_wx_get_essid_rsl</span>
<span class="cp">#define ieee80211_wx_set_essid		ieee80211_wx_set_essid_rsl</span>
<span class="cp">#define ieee80211_wx_set_rate		ieee80211_wx_set_rate_rsl</span>
<span class="cp">#define ieee80211_wx_get_rate		ieee80211_wx_get_rate_rsl</span>
<span class="cp">#define ieee80211_wx_set_wap		ieee80211_wx_set_wap_rsl</span>
<span class="cp">#define ieee80211_wx_get_wap		ieee80211_wx_get_wap_rsl</span>
<span class="cp">#define ieee80211_wx_set_mode		ieee80211_wx_set_mode_rsl</span>
<span class="cp">#define ieee80211_wx_get_mode		ieee80211_wx_get_mode_rsl</span>
<span class="cp">#define ieee80211_wx_set_scan		ieee80211_wx_set_scan_rsl</span>
<span class="cp">#define ieee80211_wx_get_freq		ieee80211_wx_get_freq_rsl</span>
<span class="cp">#define ieee80211_wx_set_freq		ieee80211_wx_set_freq_rsl</span>
<span class="cp">#define ieee80211_wx_set_rawtx		ieee80211_wx_set_rawtx_rsl</span>
<span class="cp">#define ieee80211_wx_get_name		ieee80211_wx_get_name_rsl</span>
<span class="cp">#define ieee80211_wx_set_power		ieee80211_wx_set_power_rsl</span>
<span class="cp">#define ieee80211_wx_get_power		ieee80211_wx_get_power_rsl</span>
<span class="cp">#define ieee80211_wlan_frequencies	ieee80211_wlan_frequencies_rsl</span>
<span class="cp">#define ieee80211_wx_set_rts		ieee80211_wx_set_rts_rsl</span>
<span class="cp">#define ieee80211_wx_get_rts		ieee80211_wx_get_rts_rsl</span>

<span class="cp">#define ieee80211_txb_free		ieee80211_txb_free_rsl</span>

<span class="cp">#define ieee80211_wx_set_gen_ie		ieee80211_wx_set_gen_ie_rsl</span>
<span class="cp">#define ieee80211_wx_get_scan		ieee80211_wx_get_scan_rsl</span>
<span class="cp">#define ieee80211_wx_set_encode		ieee80211_wx_set_encode_rsl</span>
<span class="cp">#define ieee80211_wx_get_encode		ieee80211_wx_get_encode_rsl</span>
<span class="cp">#if WIRELESS_EXT &gt;= 18</span>
<span class="cp">#define ieee80211_wx_set_mlme		ieee80211_wx_set_mlme_rsl</span>
<span class="cp">#define ieee80211_wx_set_auth		ieee80211_wx_set_auth_rsl</span>
<span class="cp">#define ieee80211_wx_set_encode_ext	ieee80211_wx_set_encode_ext_rsl</span>
<span class="cp">#define ieee80211_wx_get_encode_ext	ieee80211_wx_get_encode_ext_rsl</span>
<span class="cp">#endif</span>


<span class="k">typedef</span> <span class="k">struct</span> <span class="n">ieee_param</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">sta_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">name</span><span class="p">;</span>
			<span class="n">u32</span> <span class="n">value</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">wpa_param</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span> <span class="n">len</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
			<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">wpa_ie</span><span class="p">;</span>
		<span class="k">struct</span><span class="p">{</span>
			<span class="kt">int</span> <span class="n">command</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">reason_code</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">mlme</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">alg</span><span class="p">[</span><span class="n">IEEE_CRYPT_ALG_NAME_LEN</span><span class="p">];</span>
			<span class="n">u8</span> <span class="n">set_tx</span><span class="p">;</span>
			<span class="n">u32</span> <span class="n">err</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">idx</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">seq</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="cm">/* sequence counter (set: RX, get: TX) */</span>
			<span class="n">u16</span> <span class="n">key_len</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">crypt</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">}</span><span class="n">ieee_param</span><span class="p">;</span>


<span class="cp">#if WIRELESS_EXT &lt; 17</span>
<span class="cp">#define IW_QUAL_QUAL_INVALID   0x10</span>
<span class="cp">#define IW_QUAL_LEVEL_INVALID  0x20</span>
<span class="cp">#define IW_QUAL_NOISE_INVALID  0x40</span>
<span class="cp">#define IW_QUAL_QUAL_UPDATED   0x1</span>
<span class="cp">#define IW_QUAL_LEVEL_UPDATED  0x2</span>
<span class="cp">#define IW_QUAL_NOISE_UPDATED  0x4</span>
<span class="cp">#endif</span></pre></div></td></tr>


<tr id="section-19"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-19">&#182;</a></div><p>linux under 2.6.9 release may not support it, so modify it for common use</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define MSECS(t) msecs_to_jiffies(t)</span>
<span class="cp">#define msleep_interruptible_rsl  msleep_interruptible</span>

<span class="cp">#define IEEE80211_DATA_LEN		2304</span>
<span class="cm">/* Maximum size for the MA-UNITDATA primitive, 802.11 standard section</span>
<span class="cm">   6.2.1.1.2.</span>

<span class="cm">   The figure in section 7.1.2 suggests a body size of up to 2312</span>
<span class="cm">   bytes is allowed, which is a bit confusing, I suspect this</span>
<span class="cm">   represents the 2304 bytes of real data, plus a possible 8 bytes of</span>
<span class="cm">   WEP IV and ICV. (this interpretation suggested by Ramiro Barreiro) */</span>
<span class="cp">#define IEEE80211_1ADDR_LEN 10</span>
<span class="cp">#define IEEE80211_2ADDR_LEN 16</span>
<span class="cp">#define IEEE80211_3ADDR_LEN 24</span>
<span class="cp">#define IEEE80211_4ADDR_LEN 30</span>
<span class="cp">#define IEEE80211_FCS_LEN    4</span>
<span class="cp">#define IEEE80211_HLEN                  (IEEE80211_4ADDR_LEN)</span>
<span class="cp">#define IEEE80211_FRAME_LEN             (IEEE80211_DATA_LEN + IEEE80211_HLEN)</span>
<span class="cp">#define IEEE80211_MGMT_HDR_LEN 24</span>
<span class="cp">#define IEEE80211_DATA_HDR3_LEN 24</span>
<span class="cp">#define IEEE80211_DATA_HDR4_LEN 30</span>

<span class="cp">#define MIN_FRAG_THRESHOLD     256U</span>
<span class="cp">#define MAX_FRAG_THRESHOLD     2346U</span>


<span class="cm">/* Frame control field constants */</span>
<span class="cp">#define IEEE80211_FCTL_VERS		0x0003</span>
<span class="cp">#define IEEE80211_FCTL_FTYPE		0x000c</span>
<span class="cp">#define IEEE80211_FCTL_STYPE		0x00f0</span>
<span class="cp">#define IEEE80211_FCTL_FRAMETYPE	0x00fc</span>
<span class="cp">#define IEEE80211_FCTL_TODS		0x0100</span>
<span class="cp">#define IEEE80211_FCTL_FROMDS		0x0200</span>
<span class="cp">#define IEEE80211_FCTL_DSTODS		0x0300 </span><span class="c1">//added by david</span>
<span class="cp">#define IEEE80211_FCTL_MOREFRAGS	0x0400</span>
<span class="cp">#define IEEE80211_FCTL_RETRY		0x0800</span>
<span class="cp">#define IEEE80211_FCTL_PM		0x1000</span>
<span class="cp">#define IEEE80211_FCTL_MOREDATA		0x2000</span>
<span class="cp">#define IEEE80211_FCTL_WEP		0x4000</span>
<span class="cp">#define IEEE80211_FCTL_ORDER		0x8000</span>

<span class="cp">#define IEEE80211_FTYPE_MGMT		0x0000</span>
<span class="cp">#define IEEE80211_FTYPE_CTL		0x0004</span>
<span class="cp">#define IEEE80211_FTYPE_DATA		0x0008</span>

<span class="cm">/* management */</span>
<span class="cp">#define IEEE80211_STYPE_ASSOC_REQ	0x0000</span>
<span class="cp">#define IEEE80211_STYPE_ASSOC_RESP 	0x0010</span>
<span class="cp">#define IEEE80211_STYPE_REASSOC_REQ	0x0020</span>
<span class="cp">#define IEEE80211_STYPE_REASSOC_RESP	0x0030</span>
<span class="cp">#define IEEE80211_STYPE_PROBE_REQ	0x0040</span>
<span class="cp">#define IEEE80211_STYPE_PROBE_RESP	0x0050</span>
<span class="cp">#define IEEE80211_STYPE_BEACON		0x0080</span>
<span class="cp">#define IEEE80211_STYPE_ATIM		0x0090</span>
<span class="cp">#define IEEE80211_STYPE_DISASSOC	0x00A0</span>
<span class="cp">#define IEEE80211_STYPE_AUTH		0x00B0</span>
<span class="cp">#define IEEE80211_STYPE_DEAUTH		0x00C0</span>
<span class="cp">#define IEEE80211_STYPE_MANAGE_ACT	0x00D0</span>

<span class="cm">/* control */</span>
<span class="cp">#define IEEE80211_STYPE_PSPOLL		0x00A0</span>
<span class="cp">#define IEEE80211_STYPE_RTS		0x00B0</span>
<span class="cp">#define IEEE80211_STYPE_CTS		0x00C0</span>
<span class="cp">#define IEEE80211_STYPE_ACK		0x00D0</span>
<span class="cp">#define IEEE80211_STYPE_CFEND		0x00E0</span>
<span class="cp">#define IEEE80211_STYPE_CFENDACK	0x00F0</span>
<span class="cp">#define IEEE80211_STYPE_BLOCKACK   0x0094</span>

<span class="cm">/* data */</span>
<span class="cp">#define IEEE80211_STYPE_DATA		0x0000</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFACK	0x0010</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFPOLL	0x0020</span>
<span class="cp">#define IEEE80211_STYPE_DATA_CFACKPOLL	0x0030</span>
<span class="cp">#define IEEE80211_STYPE_NULLFUNC	0x0040</span>
<span class="cp">#define IEEE80211_STYPE_CFACK		0x0050</span>
<span class="cp">#define IEEE80211_STYPE_CFPOLL		0x0060</span>
<span class="cp">#define IEEE80211_STYPE_CFACKPOLL	0x0070</span>
<span class="cp">#define IEEE80211_STYPE_QOS_DATA	0x0080 </span><span class="c1">//added for WMM 2006/8/2</span>
<span class="cp">#define IEEE80211_STYPE_QOS_NULL	0x00C0</span>

<span class="cp">#define IEEE80211_SCTL_FRAG		0x000F</span>
<span class="cp">#define IEEE80211_SCTL_SEQ		0xFFF0</span>

<span class="cm">/* QOS control */</span>
<span class="cp">#define IEEE80211_QCTL_TID              0x000F</span>

<span class="cp">#define	FC_QOS_BIT					BIT7</span>
<span class="cp">#define IsDataFrame(pdu)			( ((pdu[0] &amp; 0x0C)==0x08) ? true : false )</span>
<span class="cp">#define	IsLegacyDataFrame(pdu)	(IsDataFrame(pdu) &amp;&amp; (!(pdu[0]&amp;FC_QOS_BIT)) )</span></pre></div></td></tr>


<tr id="section-20"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-20">&#182;</a></div><p>added by wb. Is this right?</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IsQoSDataFrame(pframe)  ((*(u16*)pframe&amp;(IEEE80211_STYPE_QOS_DATA|IEEE80211_FTYPE_DATA)) == (IEEE80211_STYPE_QOS_DATA|IEEE80211_FTYPE_DATA))</span>
<span class="cp">#define Frame_Order(pframe)     (*(u16*)pframe&amp;IEEE80211_FCTL_ORDER)</span>
<span class="cp">#define SN_LESS(a, b)		(((a-b)&amp;0x800)!=0)</span>
<span class="cp">#define SN_EQUAL(a, b)	(a == b)</span>
<span class="cp">#define MAX_DEV_ADDR_SIZE 8</span>
<span class="k">typedef</span> <span class="k">enum</span> <span class="n">_ACT_CATEGORY</span><span class="p">{</span>
	<span class="n">ACT_CAT_QOS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ACT_CAT_DLS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ACT_CAT_BA</span>  <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">ACT_CAT_HT</span>  <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">ACT_CAT_WMM</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
<span class="p">}</span> <span class="n">ACT_CATEGORY</span><span class="p">,</span> <span class="o">*</span><span class="n">PACT_CATEGORY</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="n">_TS_ACTION</span><span class="p">{</span>
	<span class="n">ACT_ADDTSREQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">ACT_ADDTSRSP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ACT_DELTS</span>    <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ACT_SCHEDULE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">}</span> <span class="n">TS_ACTION</span><span class="p">,</span> <span class="o">*</span><span class="n">PTS_ACTION</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="n">_BA_ACTION</span><span class="p">{</span>
	<span class="n">ACT_ADDBAREQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">ACT_ADDBARSP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ACT_DELBA</span>    <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span> <span class="n">BA_ACTION</span><span class="p">,</span> <span class="o">*</span><span class="n">PBA_ACTION</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="n">_InitialGainOpType</span><span class="p">{</span>
	<span class="n">IG_Backup</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
	<span class="n">IG_Restore</span><span class="p">,</span>
	<span class="n">IG_Max</span>
<span class="p">}</span><span class="n">InitialGainOpType</span><span class="p">;</span>

<span class="cm">/* debug macros */</span>
<span class="cp">#define CONFIG_IEEE80211_DEBUG</span>
<span class="cp">#ifdef CONFIG_IEEE80211_DEBUG</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">ieee80211_debug_level</span><span class="p">;</span>
<span class="cp">#define IEEE80211_DEBUG(level, fmt, args...) \</span>
<span class="cp">do { if (ieee80211_debug_level &amp; (level)) \</span>
<span class="cp">  printk(KERN_DEBUG &quot;ieee80211: &quot; fmt, ## args); } while (0)</span></pre></div></td></tr>


<tr id="section-21"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-21">&#182;</a></div><p>wb added to debug out data buf
if you want print DATA buffer related BA, please set ieee80211<em>debug</em>level to DATA|BA</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IEEE80211_DEBUG_DATA(level, data, datalen)	\</span>
<span class="cp">	do{ if ((ieee80211_debug_level &amp; (level)) == (level))	\</span>
<span class="cp">		{ 	\</span>
<span class="cp">			int i;					\</span>
<span class="cp">			u8* pdata = (u8*) data;			\</span>
<span class="cp">			printk(KERN_DEBUG &quot;ieee80211: %s()\n&quot;, __FUNCTION__);	\</span>
<span class="cp">			for(i=0; i&lt;(int)(datalen); i++)			\</span>
<span class="cp">			{						\</span>
<span class="cp">				printk(&quot;%2x &quot;, pdata[i]);		\</span>
<span class="cp">				if ((i+1)%16 == 0) printk(&quot;\n&quot;);	\</span>
<span class="cp">			}				\</span>
<span class="cp">			printk(&quot;\n&quot;);			\</span>
<span class="cp">		}					\</span>
<span class="cp">	} while (0)</span>
<span class="cp">#else</span>
<span class="cp">#define IEEE80211_DEBUG(level, fmt, args...) do {} while (0)</span>
<span class="cp">#define IEEE80211_DEBUG_DATA(level, data, datalen) do {} while(0)</span>
<span class="cp">#endif	</span><span class="cm">/* CONFIG_IEEE80211_DEBUG */</span><span class="cp"></span>

<span class="cm">/* debug macros not dependent on CONFIG_IEEE80211_DEBUG */</span>

<span class="cm">/*</span>
<span class="cm"> * To use the debug system;</span>
<span class="cm"> *</span>
<span class="cm"> * If you are defining a new debug classification, simply add it to the #define</span>
<span class="cm"> * list here in the form of:</span>
<span class="cm"> *</span>
<span class="cm"> * #define IEEE80211_DL_xxxx VALUE</span>
<span class="cm"> *</span>
<span class="cm"> * shifting value to the left one bit from the previous entry.  xxxx should be</span>
<span class="cm"> * the name of the classification (for example, WEP)</span>
<span class="cm"> *</span>
<span class="cm"> * You then need to either add a IEEE80211_xxxx_DEBUG() macro definition for your</span>
<span class="cm"> * classification, or use IEEE80211_DEBUG(IEEE80211_DL_xxxx, ...) whenever you want</span>
<span class="cm"> * to send output to that classification.</span>
<span class="cm"> *</span>
<span class="cm"> * To add your debug level to the list of levels seen when you perform</span>
<span class="cm"> *</span>
<span class="cm"> * % cat /proc/net/ipw/debug_level</span>
<span class="cm"> *</span>
<span class="cm"> * you simply need to add your entry to the ipw_debug_levels array.</span>
<span class="cm"> *</span>
<span class="cm"> * If you do not see debug_level in /proc/net/ipw then you do not have</span>
<span class="cm"> * CONFIG_IEEE80211_DEBUG defined in your kernel configuration</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#define IEEE80211_DL_INFO          (1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_DL_WX            (1&lt;&lt;1)</span>
<span class="cp">#define IEEE80211_DL_SCAN          (1&lt;&lt;2)</span>
<span class="cp">#define IEEE80211_DL_STATE         (1&lt;&lt;3)</span>
<span class="cp">#define IEEE80211_DL_MGMT          (1&lt;&lt;4)</span>
<span class="cp">#define IEEE80211_DL_FRAG          (1&lt;&lt;5)</span>
<span class="cp">#define IEEE80211_DL_EAP           (1&lt;&lt;6)</span>
<span class="cp">#define IEEE80211_DL_DROP          (1&lt;&lt;7)</span>

<span class="cp">#define IEEE80211_DL_TX            (1&lt;&lt;8)</span>
<span class="cp">#define IEEE80211_DL_RX            (1&lt;&lt;9)</span>

<span class="cp">#define IEEE80211_DL_HT		   (1&lt;&lt;10)  </span><span class="c1">//HT</span>
<span class="cp">#define IEEE80211_DL_BA		   (1&lt;&lt;11)  </span><span class="c1">//ba</span>
<span class="cp">#define IEEE80211_DL_TS		   (1&lt;&lt;12)  </span><span class="c1">//TS</span>
<span class="cp">#define IEEE80211_DL_QOS           (1&lt;&lt;13)</span>
<span class="cp">#define IEEE80211_DL_REORDER	   (1&lt;&lt;14)</span>
<span class="cp">#define IEEE80211_DL_IOT	   (1&lt;&lt;15)</span>
<span class="cp">#define IEEE80211_DL_IPS	   (1&lt;&lt;16)</span>
<span class="cp">#define IEEE80211_DL_TRACE	   (1&lt;&lt;29)  </span><span class="c1">//trace function, need to user net_ratelimit() together in order not to print too much to the screen</span>
<span class="cp">#define IEEE80211_DL_DATA	   (1&lt;&lt;30)   </span><span class="c1">//use this flag to control whether print data buf out.</span>
<span class="cp">#define IEEE80211_DL_ERR	   (1&lt;&lt;31)   </span><span class="c1">//always open</span>
<span class="cp">#define IEEE80211_ERROR(f, a...) printk(KERN_ERR &quot;ieee80211: &quot; f, ## a)</span>
<span class="cp">#define IEEE80211_WARNING(f, a...) printk(KERN_WARNING &quot;ieee80211: &quot; f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_INFO(f, a...)   IEEE80211_DEBUG(IEEE80211_DL_INFO, f, ## a)</span>

<span class="cp">#define IEEE80211_DEBUG_WX(f, a...)     IEEE80211_DEBUG(IEEE80211_DL_WX, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_SCAN(f, a...)   IEEE80211_DEBUG(IEEE80211_DL_SCAN, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_STATE(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_STATE, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_MGMT(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_MGMT, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_FRAG(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_FRAG, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_EAP(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_EAP, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_DROP(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_DROP, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_TX(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_TX, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_RX(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_RX, f, ## a)</span>
<span class="cp">#define IEEE80211_DEBUG_QOS(f, a...)  IEEE80211_DEBUG(IEEE80211_DL_QOS, f, ## a)</span>

<span class="cp">#ifdef CONFIG_IEEE80211_DEBUG</span>
<span class="cm">/* Added by Annie, 2005-11-22. */</span>
<span class="cp">#define MAX_STR_LEN     64</span>
<span class="cm">/* I want to see ASCII 33 to 126 only. Otherwise, I print &#39;?&#39;. Annie, 2005-11-22.*/</span>
<span class="cp">#define PRINTABLE(_ch)  (_ch&gt;&#39;!&#39; &amp;&amp; _ch&lt;&#39;~&#39;)</span>
<span class="cp">#define IEEE80211_PRINT_STR(_Comp, _TitleString, _Ptr, _Len)                            	\</span>
<span class="cp">			if((_Comp) &amp; level)   							\</span>
<span class="cp">			{                                                                       \</span>
<span class="cp">				int             __i;                                            \</span>
<span class="cp">				u8  buffer[MAX_STR_LEN];                                    	\</span>
<span class="cp">				int length = (_Len&lt;MAX_STR_LEN)? _Len : (MAX_STR_LEN-1) ;  	\</span>
<span class="cp">				memset(buffer, 0, MAX_STR_LEN);                      		\</span>
<span class="cp">				memcpy(buffer, (u8 *)_Ptr, length );            		\</span>
<span class="cp">				for( __i=0; __i&lt;MAX_STR_LEN; __i++ )                            \</span>
<span class="cp">				{                                                               \</span>
<span class="cp">				     if( !PRINTABLE(buffer[__i]) )   buffer[__i] = &#39;?&#39;;     	\</span>
<span class="cp">				}                                                               \</span>
<span class="cp">				buffer[length] = &#39;\0&#39;;                                          \</span>
<span class="cp">				printk(&quot;Rtl819x: &quot;);                                         	\</span>
<span class="cp">				printk(_TitleString);                                         \</span>
<span class="cp">				printk(&quot;: %d, &lt;%s&gt;\n&quot;, _Len, buffer);                         \</span>
<span class="cp">			}</span>
<span class="cp">#else</span>
<span class="cp">#define IEEE80211_PRINT_STR(_Comp, _TitleString, _Ptr, _Len)  do {} while (0)</span>
<span class="cp">#endif</span>

<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;linux/if_arp.h&gt; </span><span class="cm">/* ARPHRD_ETHER */</span><span class="cp"></span>

<span class="cp">#ifndef WIRELESS_SPY</span>
<span class="cp">#define WIRELESS_SPY		</span><span class="c1">// enable iwspy support</span>
<span class="cp">#endif</span>
<span class="cp">#include &lt;net/iw_handler.h&gt;	</span><span class="c1">// new driver API</span>

<span class="cp">#ifndef ETH_P_PAE</span>
<span class="cp">#define ETH_P_PAE 0x888E </span><span class="cm">/* Port Access Entity (IEEE 802.1X) */</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* ETH_P_PAE */</span><span class="cp"></span>

<span class="cp">#define ETH_P_PREAUTH 0x88C7 </span><span class="cm">/* IEEE 802.11i pre-authentication */</span><span class="cp"></span>

<span class="cp">#ifndef ETH_P_80211_RAW</span>
<span class="cp">#define ETH_P_80211_RAW (ETH_P_ECONET + 1)</span>
<span class="cp">#endif</span>

<span class="cm">/* IEEE 802.11 defines */</span>

<span class="cp">#define P80211_OUI_LEN 3</span>

<span class="k">struct</span> <span class="n">ieee80211_snap_hdr</span> <span class="p">{</span>

	<span class="n">u8</span>    <span class="n">dsap</span><span class="p">;</span>   <span class="cm">/* always 0xAA */</span>
	<span class="n">u8</span>    <span class="n">ssap</span><span class="p">;</span>   <span class="cm">/* always 0xAA */</span>
	<span class="n">u8</span>    <span class="n">ctrl</span><span class="p">;</span>   <span class="cm">/* always 0x03 */</span>
	<span class="n">u8</span>    <span class="n">oui</span><span class="p">[</span><span class="n">P80211_OUI_LEN</span><span class="p">];</span>    <span class="cm">/* organizational universal id */</span>

<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cp">#define SNAP_SIZE sizeof(struct ieee80211_snap_hdr)</span>

<span class="cp">#define WLAN_FC_GET_VERS(fc) ((fc) &amp; IEEE80211_FCTL_VERS)</span>
<span class="cp">#define WLAN_FC_GET_TYPE(fc) ((fc) &amp; IEEE80211_FCTL_FTYPE)</span>
<span class="cp">#define WLAN_FC_GET_STYPE(fc) ((fc) &amp; IEEE80211_FCTL_STYPE)</span>

<span class="cp">#define WLAN_FC_GET_FRAMETYPE(fc) ((fc) &amp; IEEE80211_FCTL_FRAMETYPE)</span>
<span class="cp">#define WLAN_GET_SEQ_FRAG(seq) ((seq) &amp; IEEE80211_SCTL_FRAG)</span>
<span class="cp">#define WLAN_GET_SEQ_SEQ(seq)  (((seq) &amp; IEEE80211_SCTL_SEQ) &gt;&gt; 4)</span>

<span class="cm">/* Authentication algorithms */</span>
<span class="cp">#define WLAN_AUTH_OPEN 0</span>
<span class="cp">#define WLAN_AUTH_SHARED_KEY 1</span>
<span class="cp">#define WLAN_AUTH_LEAP 2</span>

<span class="cp">#define WLAN_AUTH_CHALLENGE_LEN 128</span>

<span class="cp">#define WLAN_CAPABILITY_BSS (1&lt;&lt;0)</span>
<span class="cp">#define WLAN_CAPABILITY_IBSS (1&lt;&lt;1)</span>
<span class="cp">#define WLAN_CAPABILITY_CF_POLLABLE (1&lt;&lt;2)</span>
<span class="cp">#define WLAN_CAPABILITY_CF_POLL_REQUEST (1&lt;&lt;3)</span>
<span class="cp">#define WLAN_CAPABILITY_PRIVACY (1&lt;&lt;4)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_PREAMBLE (1&lt;&lt;5)</span>
<span class="cp">#define WLAN_CAPABILITY_PBCC (1&lt;&lt;6)</span>
<span class="cp">#define WLAN_CAPABILITY_CHANNEL_AGILITY (1&lt;&lt;7)</span>
<span class="cp">#define WLAN_CAPABILITY_SPECTRUM_MGMT (1&lt;&lt;8)</span>
<span class="cp">#define WLAN_CAPABILITY_QOS (1&lt;&lt;9)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_SLOT (1&lt;&lt;10)</span>
<span class="cp">#define WLAN_CAPABILITY_DSSS_OFDM (1&lt;&lt;13)</span>

<span class="cm">/* 802.11g ERP information element */</span>
<span class="cp">#define WLAN_ERP_NON_ERP_PRESENT (1&lt;&lt;0)</span>
<span class="cp">#define WLAN_ERP_USE_PROTECTION (1&lt;&lt;1)</span>
<span class="cp">#define WLAN_ERP_BARKER_PREAMBLE (1&lt;&lt;2)</span>

<span class="cm">/* Status codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_statuscode</span> <span class="p">{</span>
	<span class="n">WLAN_STATUS_SUCCESS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_UNSPECIFIED_FAILURE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_CAPS_UNSUPPORTED</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_REASSOC_NO_ASSOC</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_UNSPEC</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_NOT_SUPPORTED_AUTH_ALG</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_UNKNOWN_AUTH_TRANSACTION</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_CHALLENGE_FAIL</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_AUTH_TIMEOUT</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_AP_UNABLE_TO_HANDLE_NEW_STA</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_RATES</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="cm">/* 802.11b */</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOSHORTPREAMBLE</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOPBCC</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOAGILITY</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="cm">/* 802.11h */</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOSPECTRUM</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_REJECTED_BAD_POWER</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_REJECTED_BAD_SUPP_CHAN</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
	<span class="cm">/* 802.11g */</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NOSHORTTIME</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_ASSOC_DENIED_NODSSSOFDM</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
	<span class="cm">/* 802.11i */</span>
	<span class="n">WLAN_STATUS_INVALID_IE</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_GROUP_CIPHER</span> <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_PAIRWISE_CIPHER</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_AKMP</span> <span class="o">=</span> <span class="mi">43</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_UNSUPP_RSN_VERSION</span> <span class="o">=</span> <span class="mi">44</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_INVALID_RSN_IE_CAP</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	<span class="n">WLAN_STATUS_CIPHER_SUITE_REJECTED</span> <span class="o">=</span> <span class="mi">46</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Reason codes */</span>
<span class="k">enum</span> <span class="n">ieee80211_reasoncode</span> <span class="p">{</span>
	<span class="n">WLAN_REASON_UNSPECIFIED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WLAN_REASON_PREV_AUTH_NOT_VALID</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DEAUTH_LEAVING</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_DUE_TO_INACTIVITY</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_AP_BUSY</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">WLAN_REASON_CLASS2_FRAME_FROM_NONAUTH_STA</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">WLAN_REASON_CLASS3_FRAME_FROM_NONASSOC_STA</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_STA_HAS_LEFT</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">WLAN_REASON_STA_REQ_ASSOC_WITHOUT_AUTH</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="cm">/* 802.11h */</span>
	<span class="n">WLAN_REASON_DISASSOC_BAD_POWER</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">WLAN_REASON_DISASSOC_BAD_SUPP_CHAN</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="cm">/* 802.11i */</span>
	<span class="n">WLAN_REASON_INVALID_IE</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">WLAN_REASON_MIC_FAILURE</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">WLAN_REASON_4WAY_HANDSHAKE_TIMEOUT</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">WLAN_REASON_GROUP_KEY_HANDSHAKE_TIMEOUT</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">WLAN_REASON_IE_DIFFERENT</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_GROUP_CIPHER</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_PAIRWISE_CIPHER</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_AKMP</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">WLAN_REASON_UNSUPP_RSN_VERSION</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">WLAN_REASON_INVALID_RSN_IE_CAP</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">WLAN_REASON_IEEE8021X_FAILED</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">WLAN_REASON_CIPHER_SUITE_REJECTED</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define IEEE80211_STATMASK_SIGNAL (1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_STATMASK_RSSI (1&lt;&lt;1)</span>
<span class="cp">#define IEEE80211_STATMASK_NOISE (1&lt;&lt;2)</span>
<span class="cp">#define IEEE80211_STATMASK_RATE (1&lt;&lt;3)</span>
<span class="cp">#define IEEE80211_STATMASK_WEMASK 0x7</span>

<span class="cp">#define IEEE80211_CCK_MODULATION    (1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_OFDM_MODULATION   (1&lt;&lt;1)</span>

<span class="cp">#define IEEE80211_24GHZ_BAND     (1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_52GHZ_BAND     (1&lt;&lt;1)</span>

<span class="cp">#define IEEE80211_CCK_RATE_LEN  		4</span>
<span class="cp">#define IEEE80211_CCK_RATE_1MB			0x02</span>
<span class="cp">#define IEEE80211_CCK_RATE_2MB			0x04</span>
<span class="cp">#define IEEE80211_CCK_RATE_5MB			0x0B</span>
<span class="cp">#define IEEE80211_CCK_RATE_11MB			0x16</span>
<span class="cp">#define IEEE80211_OFDM_RATE_LEN 		8</span>
<span class="cp">#define IEEE80211_OFDM_RATE_6MB			0x0C</span>
<span class="cp">#define IEEE80211_OFDM_RATE_9MB			0x12</span>
<span class="cp">#define IEEE80211_OFDM_RATE_12MB		0x18</span>
<span class="cp">#define IEEE80211_OFDM_RATE_18MB		0x24</span>
<span class="cp">#define IEEE80211_OFDM_RATE_24MB		0x30</span>
<span class="cp">#define IEEE80211_OFDM_RATE_36MB		0x48</span>
<span class="cp">#define IEEE80211_OFDM_RATE_48MB		0x60</span>
<span class="cp">#define IEEE80211_OFDM_RATE_54MB		0x6C</span>
<span class="cp">#define IEEE80211_BASIC_RATE_MASK		0x80</span>

<span class="cp">#define IEEE80211_CCK_RATE_1MB_MASK		(1&lt;&lt;0)</span>
<span class="cp">#define IEEE80211_CCK_RATE_2MB_MASK		(1&lt;&lt;1)</span>
<span class="cp">#define IEEE80211_CCK_RATE_5MB_MASK		(1&lt;&lt;2)</span>
<span class="cp">#define IEEE80211_CCK_RATE_11MB_MASK		(1&lt;&lt;3)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_6MB_MASK		(1&lt;&lt;4)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_9MB_MASK		(1&lt;&lt;5)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_12MB_MASK		(1&lt;&lt;6)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_18MB_MASK		(1&lt;&lt;7)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_24MB_MASK		(1&lt;&lt;8)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_36MB_MASK		(1&lt;&lt;9)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_48MB_MASK		(1&lt;&lt;10)</span>
<span class="cp">#define IEEE80211_OFDM_RATE_54MB_MASK		(1&lt;&lt;11)</span>

<span class="cp">#define IEEE80211_CCK_RATES_MASK		0x0000000F</span>
<span class="cp">#define IEEE80211_CCK_BASIC_RATES_MASK	(IEEE80211_CCK_RATE_1MB_MASK | \</span>
<span class="cp">	IEEE80211_CCK_RATE_2MB_MASK)</span>
<span class="cp">#define IEEE80211_CCK_DEFAULT_RATES_MASK	(IEEE80211_CCK_BASIC_RATES_MASK | \</span>
<span class="cp">	IEEE80211_CCK_RATE_5MB_MASK | \</span>
<span class="cp">	IEEE80211_CCK_RATE_11MB_MASK)</span>

<span class="cp">#define IEEE80211_OFDM_RATES_MASK		0x00000FF0</span>
<span class="cp">#define IEEE80211_OFDM_BASIC_RATES_MASK	(IEEE80211_OFDM_RATE_6MB_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_12MB_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_24MB_MASK)</span>
<span class="cp">#define IEEE80211_OFDM_DEFAULT_RATES_MASK	(IEEE80211_OFDM_BASIC_RATES_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_9MB_MASK  | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_18MB_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_36MB_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_48MB_MASK | \</span>
<span class="cp">	IEEE80211_OFDM_RATE_54MB_MASK)</span>
<span class="cp">#define IEEE80211_DEFAULT_RATES_MASK (IEEE80211_OFDM_DEFAULT_RATES_MASK | \</span>
<span class="cp">				IEEE80211_CCK_DEFAULT_RATES_MASK)</span>

<span class="cp">#define IEEE80211_NUM_OFDM_RATES	    8</span>
<span class="cp">#define IEEE80211_NUM_CCK_RATES		    4</span>
<span class="cp">#define IEEE80211_OFDM_SHIFT_MASK_A         4</span>


<span class="cm">/* this is stolen and modified from the madwifi driver*/</span>
<span class="cp">#define IEEE80211_FC0_TYPE_MASK		0x0c</span>
<span class="cp">#define IEEE80211_FC0_TYPE_DATA		0x08</span>
<span class="cp">#define IEEE80211_FC0_SUBTYPE_MASK	0xB0</span>
<span class="cp">#define IEEE80211_FC0_SUBTYPE_QOS	0x80</span>

<span class="cp">#define IEEE80211_QOS_HAS_SEQ(fc) \</span>
<span class="cp">	(((fc) &amp; (IEEE80211_FC0_TYPE_MASK | IEEE80211_FC0_SUBTYPE_MASK)) == \</span>
<span class="cp">	 (IEEE80211_FC0_TYPE_DATA | IEEE80211_FC0_SUBTYPE_QOS))</span>

<span class="cm">/* this is stolen from ipw2200 driver */</span>
<span class="cp">#define IEEE_IBSS_MAC_HASH_SIZE 31</span>
<span class="k">struct</span> <span class="n">ieee_ibss_seq</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">mac</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">frag_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">packet_time</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* NOTE: This data is for statistical purposes; not all hardware provides this</span>
<span class="cm"> *       information for frames received.  Not setting these will not cause</span>
<span class="cm"> *       any adverse affects. */</span>
<span class="k">struct</span> <span class="n">ieee80211_rx_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">mac_time</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">s8</span> <span class="n">rssi</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">signal</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">noise</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">rate</span><span class="p">;</span> <span class="cm">/* in 100 kbps */</span>
	<span class="n">u8</span> <span class="n">received_channel</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">control</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mask</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">freq</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tsf</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">beacon_time</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">nic_type</span><span class="p">;</span>
	<span class="n">u16</span>       <span class="n">Length</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-22"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-22">&#182;</a></div><pre><code> u8        DataRate;      // In 0.5 Mbps
</code></pre></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span>        <span class="n">SignalQuality</span><span class="p">;</span> <span class="c1">// in 0-100 index.</span>
	<span class="n">s32</span>       <span class="n">RecvSignalPower</span><span class="p">;</span> <span class="c1">// Real power in dBm for this packet, no beautification and aggregation.</span>
	<span class="n">s8</span>        <span class="n">RxPower</span><span class="p">;</span> <span class="c1">// in dBm Translate from PWdB</span>
	<span class="n">u8</span>        <span class="n">SignalStrength</span><span class="p">;</span> <span class="c1">// in 0-100 index.</span>
	<span class="n">u16</span>       <span class="n">bHwError</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span>       <span class="n">bCRC</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span>       <span class="n">bICV</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span>       <span class="n">bShortPreamble</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span>       <span class="n">Antenna</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>      <span class="c1">//for rtl8185</span>
	<span class="n">u16</span>       <span class="n">Decrypted</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>    <span class="c1">//for rtl8185, rtl8187</span>
	<span class="n">u16</span>       <span class="n">Wakeup</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>       <span class="c1">//for rtl8185</span>
	<span class="n">u16</span>       <span class="n">Reserved0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>    <span class="c1">//for rtl8185</span>
	<span class="n">u8</span>        <span class="n">AGC</span><span class="p">;</span>
	<span class="n">u32</span>       <span class="n">TimeStampLow</span><span class="p">;</span>
	<span class="n">u32</span>       <span class="n">TimeStampHigh</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">bShift</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">bIsQosData</span><span class="p">;</span>             <span class="c1">// Added by Annie, 2005-12-22.</span>
	<span class="n">u8</span>        <span class="n">UserPriority</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-23"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-23">&#182;</a></div><p>1!!!!!!!!!!!!!!!!!!!!!!!!!!!
1Attention Please!!!&lt;11n or 8190 specific code should be put below this line>
1!!!!!!!!!!!!!!!!!!!!!!!!!!!</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span>        <span class="n">RxDrvInfoSize</span><span class="p">;</span>
	<span class="n">u8</span>        <span class="n">RxBufShift</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">bIsAMPDU</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">bFirstMPDU</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">bContainHTC</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">RxIs40MHzPacket</span><span class="p">;</span>
	<span class="n">u32</span>       <span class="n">RxPWDBAll</span><span class="p">;</span>
	<span class="n">u8</span>        <span class="n">RxMIMOSignalStrength</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>        <span class="c1">// in 0~100 index</span>
	<span class="n">s8</span>        <span class="n">RxMIMOSignalQuality</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bool</span>      <span class="n">bPacketMatchBSSID</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">bIsCCK</span><span class="p">;</span>
	<span class="n">bool</span>      <span class="n">bPacketToSelf</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-24"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-24">&#182;</a></div><p>added by amy</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span><span class="o">*</span>       <span class="n">virtual_address</span><span class="p">;</span>
	<span class="n">u16</span>          <span class="n">packetlength</span><span class="p">;</span>              <span class="c1">// Total packet length: Must equal to sum of all FragLength</span>
	<span class="n">u16</span>          <span class="n">fraglength</span><span class="p">;</span>                        <span class="c1">// FragLength should equal to PacketLength in non-fragment case</span>
	<span class="n">u16</span>          <span class="n">fragoffset</span><span class="p">;</span>                        <span class="c1">// Data offset for this fragment</span>
	<span class="n">u16</span>          <span class="n">ntotalfrag</span><span class="p">;</span>
	<span class="n">bool</span>      	  <span class="n">bisrxaggrsubframe</span><span class="p">;</span>
	<span class="n">bool</span>		  <span class="n">bPacketBeacon</span><span class="p">;</span>	<span class="c1">//cosa add for rssi</span>
	<span class="n">bool</span>		  <span class="n">bToSelfBA</span><span class="p">;</span>		<span class="c1">//cosa add for rssi</span>
	<span class="kt">char</span> 	  <span class="n">cck_adc_pwdb</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="c1">//cosa add for rx path selection</span>
	<span class="n">u16</span>		  <span class="n">Seq_Num</span><span class="p">;</span>

<span class="p">};</span>

<span class="cm">/* IEEE 802.11 requires that STA supports concurrent reception of at least</span>
<span class="cm"> * three fragmented frames. This define can be increased to support more</span>
<span class="cm"> * concurrent frames, but it should be noted that each entry can consume about</span>
<span class="cm"> * 2 kB of RAM and increasing cache size will slow down frame reassembly. */</span>
<span class="cp">#define IEEE80211_FRAG_CACHE_LEN 4</span>

<span class="k">struct</span> <span class="n">ieee80211_frag_entry</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">first_frag_time</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">last_frag</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">src_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">dst_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_stats</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_unicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_multicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_fragments</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_unicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_multicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_deferred_transmissions</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_single_retry_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_multiple_retry_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_retry_limit_exceeded</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_discards</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_unicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_multicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_fragments</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_unicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_multicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_fcs_errors</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_discards_no_buffer</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_discards_wrong_sa</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_discards_undecryptable</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_message_in_msg_fragments</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_message_in_bad_msg_fragments</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_device</span><span class="p">;</span>

<span class="cp">#include &quot;ieee80211_crypt.h&quot;</span>

<span class="cp">#define SEC_KEY_1         (1&lt;&lt;0)</span>
<span class="cp">#define SEC_KEY_2         (1&lt;&lt;1)</span>
<span class="cp">#define SEC_KEY_3         (1&lt;&lt;2)</span>
<span class="cp">#define SEC_KEY_4         (1&lt;&lt;3)</span>
<span class="cp">#define SEC_ACTIVE_KEY    (1&lt;&lt;4)</span>
<span class="cp">#define SEC_AUTH_MODE     (1&lt;&lt;5)</span>
<span class="cp">#define SEC_UNICAST_GROUP (1&lt;&lt;6)</span>
<span class="cp">#define SEC_LEVEL         (1&lt;&lt;7)</span>
<span class="cp">#define SEC_ENABLED       (1&lt;&lt;8)</span>
<span class="cp">#define SEC_ENCRYPT       (1&lt;&lt;9)</span>

<span class="cp">#define SEC_LEVEL_0      0 </span><span class="cm">/* None */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_1      1 </span><span class="cm">/* WEP 40 and 104 bit */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_2      2 </span><span class="cm">/* Level 1 + TKIP */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_2_CKIP 3 </span><span class="cm">/* Level 1 + CKIP */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_3      4 </span><span class="cm">/* Level 2 + CCMP */</span><span class="cp"></span>

<span class="cp">#define SEC_ALG_NONE            0</span>
<span class="cp">#define SEC_ALG_WEP             1</span>
<span class="cp">#define SEC_ALG_TKIP            2</span>
<span class="cp">#define SEC_ALG_CCMP            3</span>

<span class="cp">#define WEP_KEYS 		4</span>
<span class="cp">#define WEP_KEY_LEN		13</span>
<span class="cp">#define SCM_KEY_LEN             32</span>
<span class="cp">#define SCM_TEMPORAL_KEY_LENGTH 16</span>

<span class="k">struct</span> <span class="n">ieee80211_security</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">active_key</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span>
	    <span class="nl">enabled:</span><span class="mi">1</span><span class="p">,</span>
	    <span class="nl">auth_mode:</span><span class="mi">2</span><span class="p">,</span>
	    <span class="nl">auth_algo:</span><span class="mi">4</span><span class="p">,</span>
	    <span class="nl">unicast_uses_group:</span><span class="mi">1</span><span class="p">,</span>
	    <span class="nl">encrypt:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key_sizes</span><span class="p">[</span><span class="n">WEP_KEYS</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">keys</span><span class="p">[</span><span class="n">WEP_KEYS</span><span class="p">][</span><span class="n">SCM_KEY_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">level</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>


<span class="cm">/*</span>
<span class="cm"> 802.11 data frame from AP</span>
<span class="cm">      ,-------------------------------------------------------------------.</span>
<span class="cm">Bytes |  2   |  2   |    6    |    6    |    6    |  2   | 0..2312 |   4  |</span>
<span class="cm">      |------|------|---------|---------|---------|------|---------|------|</span>
<span class="cm">Desc. | ctrl | dura |  DA/RA  |   TA    |    SA   | Sequ |  frame  |  fcs |</span>
<span class="cm">      |      | tion | (BSSID) |         |         | ence |  data   |      |</span>
<span class="cm">      `-------------------------------------------------------------------&#39;</span>
<span class="cm">Total: 28-2340 bytes</span>
<span class="cm">*/</span>

<span class="cm">/* Management Frame Information Element Types */</span>
<span class="k">enum</span> <span class="n">ieee80211_mfie</span> <span class="p">{</span>
	<span class="n">MFIE_TYPE_SSID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_RATES</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_FH_SET</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_DS_SET</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_CF_SET</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_TIM</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_IBSS_SET</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_COUNTRY</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_HOP_PARAMS</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_HOP_TABLE</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_REQUEST</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_CHALLENGE</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_POWER_CONSTRAINT</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_POWER_CAPABILITY</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_TPC_REQUEST</span> <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_TPC_REPORT</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_SUPP_CHANNELS</span> <span class="o">=</span> <span class="mi">36</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_CSA</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_MEASURE_REQUEST</span> <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_MEASURE_REPORT</span> <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_QUIET</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_IBSS_DFS</span> <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_ERP</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_RSN</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_RATES_EX</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_HT_CAP</span><span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	 <span class="n">MFIE_TYPE_HT_INFO</span><span class="o">=</span> <span class="mi">61</span><span class="p">,</span>
	 <span class="n">MFIE_TYPE_AIRONET</span><span class="o">=</span><span class="mi">133</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_GENERIC</span> <span class="o">=</span> <span class="mi">221</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_QOS_PARAMETER</span> <span class="o">=</span> <span class="mi">222</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Minimal header; can be used for passing 802.11 frames with sufficient</span>
<span class="cm"> * information to determine what type of underlying data type is actually</span>
<span class="cm"> * stored in the data. */</span>
<span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_1addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_2addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_4addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr4</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_3addrqos</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">qos_ctl</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_hdr_4addrqos</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr4</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">qos_ctl</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_authentication</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">algorithm</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">transaction</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="cm">/*challenge*/</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_disassoc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_probe_request</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="cm">/* SSID, supported rates */</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_probe_response</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">time_stamp</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">beacon_interval</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="cm">/* SSID, supported rates, FH params, DS params,</span>
<span class="cm">	 * CF params, IBSS params, TIM (if beacon), RSN */</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/* Alias beacon for probe_response */</span>
<span class="cp">#define ieee80211_beacon ieee80211_probe_response</span>

<span class="k">struct</span> <span class="n">ieee80211_assoc_request_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="cm">/* SSID, supported rates, RSN */</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_reassoc_request_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">current_ap</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="cm">/* SSID, supported rates, RSN */</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_assoc_response_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">aid</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="cm">/* supported rates */</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_txb</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr_frags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">encrypted</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">queue_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rts_included</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">frag_size</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">payload_size</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">fragments</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define MAX_TX_AGG_COUNT		  16</span>
<span class="k">struct</span> <span class="n">ieee80211_drv_agg_txb</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr_drv_agg_frames</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">tx_agg_frames</span><span class="p">[</span><span class="n">MAX_TX_AGG_COUNT</span><span class="p">];</span>
<span class="p">}</span><span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cp">#define MAX_SUBFRAME_COUNT 		  64</span>
<span class="k">struct</span> <span class="n">ieee80211_rxb</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr_subframes</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">subframes</span><span class="p">[</span><span class="n">MAX_SUBFRAME_COUNT</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">dst</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">src</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">}</span><span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="n">_frameqos</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">shortdata</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">chardata</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">u16</span> <span class="n">tid</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">eosp</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">ack_policy</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">reserved</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">txop</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="p">}</span><span class="n">field</span><span class="p">;</span>
<span class="p">}</span><span class="n">frameqos</span><span class="p">,</span><span class="o">*</span><span class="n">pframeqos</span><span class="p">;</span>

<span class="cm">/* SWEEP TABLE ENTRIES NUMBER*/</span>
<span class="cp">#define MAX_SWEEP_TAB_ENTRIES		  42</span>
<span class="cp">#define MAX_SWEEP_TAB_ENTRIES_PER_PACKET  7</span>
<span class="cm">/* MAX_RATES_LENGTH needs to be 12.  The spec says 8, and many APs</span>
<span class="cm"> * only use 8, and then use extended rates for the remaining supported</span>
<span class="cm"> * rates.  Other APs, however, stick all of their supported rates on the</span>
<span class="cm"> * main rates information element... */</span>
<span class="cp">#define MAX_RATES_LENGTH                  ((u8)12)</span>
<span class="cp">#define MAX_RATES_EX_LENGTH               ((u8)16)</span>
<span class="cp">#define MAX_NETWORK_COUNT                  128</span>

<span class="cp">#define MAX_CHANNEL_NUMBER                 161</span>
<span class="cp">#define IEEE80211_SOFTMAC_SCAN_TIME	   100</span></pre></div></td></tr>


<tr id="section-25"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-25">&#182;</a></div><p>(HZ / 2)</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IEEE80211_SOFTMAC_ASSOC_RETRY_TIME (HZ * 2)</span>

<span class="cp">#define CRC_LENGTH                 4U</span>

<span class="cp">#define MAX_WPA_IE_LEN 64</span>

<span class="cp">#define NETWORK_EMPTY_ESSID (1&lt;&lt;0)</span>
<span class="cp">#define NETWORK_HAS_OFDM    (1&lt;&lt;1)</span>
<span class="cp">#define NETWORK_HAS_CCK     (1&lt;&lt;2)</span>

<span class="cm">/* QoS structure */</span>
<span class="cp">#define NETWORK_HAS_QOS_PARAMETERS      (1&lt;&lt;3)</span>
<span class="cp">#define NETWORK_HAS_QOS_INFORMATION     (1&lt;&lt;4)</span>
<span class="cp">#define NETWORK_HAS_QOS_MASK            (NETWORK_HAS_QOS_PARAMETERS | \</span>
<span class="cp">					 NETWORK_HAS_QOS_INFORMATION)</span>
<span class="cm">/* 802.11h */</span>
<span class="cp">#define NETWORK_HAS_POWER_CONSTRAINT    (1&lt;&lt;5)</span>
<span class="cp">#define NETWORK_HAS_CSA                 (1&lt;&lt;6)</span>
<span class="cp">#define NETWORK_HAS_QUIET               (1&lt;&lt;7)</span>
<span class="cp">#define NETWORK_HAS_IBSS_DFS            (1&lt;&lt;8)</span>
<span class="cp">#define NETWORK_HAS_TPC_REPORT          (1&lt;&lt;9)</span>

<span class="cp">#define NETWORK_HAS_ERP_VALUE           (1&lt;&lt;10)</span>

<span class="cp">#define QOS_QUEUE_NUM                   4</span>
<span class="cp">#define QOS_OUI_LEN                     3</span>
<span class="cp">#define QOS_OUI_TYPE                    2</span>
<span class="cp">#define QOS_ELEMENT_ID                  221</span>
<span class="cp">#define QOS_OUI_INFO_SUB_TYPE           0</span>
<span class="cp">#define QOS_OUI_PARAM_SUB_TYPE          1</span>
<span class="cp">#define QOS_VERSION_1                   1</span>
<span class="cp">#define QOS_AIFSN_MIN_VALUE             2</span>
<span class="k">struct</span> <span class="n">ieee80211_qos_information_element</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">elementID</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">qui</span><span class="p">[</span><span class="n">QOS_OUI_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">qui_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">qui_subtype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ac_info</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_qos_ac_parameter</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">aci_aifsn</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ecw_min_max</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">tx_op_limit</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_qos_parameter_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_qos_information_element</span> <span class="n">info_element</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_qos_ac_parameter</span> <span class="n">ac_params_record</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_qos_parameters</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">cw_min</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">cw_max</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">aifs</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">flag</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">tx_op_limit</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_qos_data</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_qos_parameters</span> <span class="n">parameters</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">active</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">supported</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">param_count</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">old_param_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_tim_parameters</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">tim_count</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tim_period</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span></pre></div></td></tr>


<tr id="section-26"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-26">&#182;</a></div><h1>else</h1></td><td class="code"><div class="highlight"><pre><span class="k">struct</span> <span class="n">ieee80211_wmm_ac_param</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">ac_aci_acm_aifsn</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ac_ecwmin_ecwmax</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">ac_txop_limit</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ieee80211_wmm_ts_info</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">ac_dir_tid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ac_up_psb</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_wmm_tspec_elem</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_wmm_ts_info</span> <span class="n">ts_info</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">norm_msdu_size</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">max_msdu_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">min_serv_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_serv_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">inact_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">suspen_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">serv_start_time</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">min_data_rate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mean_data_rate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">peak_data_rate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_burst_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">delay_bound</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">min_phy_rate</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">surp_band_allow</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">medium_time</span><span class="p">;</span>
<span class="p">}</span><span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>
<span class="k">enum</span> <span class="n">eap_type</span> <span class="p">{</span>
	<span class="n">EAP_PACKET</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">EAPOL_START</span><span class="p">,</span>
	<span class="n">EAPOL_LOGOFF</span><span class="p">,</span>
	<span class="n">EAPOL_KEY</span><span class="p">,</span>
	<span class="n">EAPOL_ENCAP_ASF_ALERT</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">eap_types</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">EAP_PACKET</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAP-Packet&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_START</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAPOL-Start&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_LOGOFF</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAPOL-Logoff&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_KEY</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAPOL-Key&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_ENCAP_ASF_ALERT</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;EAPOL-Encap-ASF-Alert&quot;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">eap_get_type</span><span class="p">(</span><span class="kt">int</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="n">u32</span><span class="p">)</span><span class="n">type</span> <span class="o">&gt;=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">eap_types</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;Unknown&quot;</span> <span class="o">:</span> <span class="n">eap_types</span><span class="p">[</span><span class="n">type</span><span class="p">];</span>
<span class="p">}</span></pre></div></td></tr>


<tr id="section-27"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-27">&#182;</a></div><p>added by amy for reorder</p></td><td class="code"><div class="highlight"><pre><span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="nf">Frame_QoSTID</span><span class="p">(</span><span class="n">u8</span><span class="o">*</span> <span class="n">buf</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">fc</span><span class="p">;</span>
	<span class="n">hdr</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
	<span class="n">fc</span> <span class="o">=</span> <span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_ctl</span><span class="p">);</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">u8</span><span class="p">)((</span><span class="n">frameqos</span><span class="o">*</span><span class="p">)(</span><span class="n">buf</span> <span class="o">+</span> <span class="p">(((</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">IEEE80211_FCTL_TODS</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">IEEE80211_FCTL_FROMDS</span><span class="p">))</span><span class="o">?</span> <span class="mi">30</span> <span class="o">:</span> <span class="mi">24</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">field</span><span class="p">.</span><span class="n">tid</span><span class="p">;</span>
<span class="p">}</span></pre></div></td></tr>


<tr id="section-28"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-28">&#182;</a></div><p>added by amy for reorder</p></td><td class="code"><div class="highlight"><pre><span class="k">struct</span> <span class="n">eapol</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">snap</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">ethertype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="k">struct</span> <span class="n">ieee80211_softmac_stats</span><span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_ass_ok</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_ass_err</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_probe_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_probe_rs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_beacons</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_auth_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_auth_rs_ok</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_auth_rs_err</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_auth_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_auth_rs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_ass_rs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_ass_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_ass_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_probe_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reassoc</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">swtxstop</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">swtxawake</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">CurrentShowTxate</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">last_packet_rate</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">txretrycount</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BEACON_PROBE_SSID_ID_POSITION 12</span>

<span class="k">struct</span> <span class="n">ieee80211_info_element_hdr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span> <span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cm">/*</span>
<span class="cm"> * These are the data types that can make up management packets</span>
<span class="cm"> *</span>
<span class="cm">	u16 auth_algorithm;</span>
<span class="cm">	u16 auth_sequence;</span>
<span class="cm">	u16 beacon_interval;</span>
<span class="cm">	u16 capability;</span>
<span class="cm">	u8 current_ap[ETH_ALEN];</span>
<span class="cm">	u16 listen_interval;</span>
<span class="cm">	struct {</span>
<span class="cm">		u16 association_id:14, reserved:2;</span>
<span class="cm">	} __attribute__ ((packed));</span>
<span class="cm">	u32 time_stamp[2];</span>
<span class="cm">	u16 reason;</span>
<span class="cm">	u16 status;</span>
<span class="cm">*/</span>

<span class="cp">#define IEEE80211_DEFAULT_TX_ESSID &quot;Penguin&quot;</span>
<span class="cp">#define IEEE80211_DEFAULT_BASIC_RATE 2 </span><span class="c1">//1Mbps</span>

<span class="k">enum</span> <span class="p">{</span><span class="n">WMM_all_frame</span><span class="p">,</span> <span class="n">WMM_two_frame</span><span class="p">,</span> <span class="n">WMM_four_frame</span><span class="p">,</span> <span class="n">WMM_six_frame</span><span class="p">};</span>
<span class="cp">#define MAX_SP_Len  (WMM_all_frame &lt;&lt; 4)</span>
<span class="cp">#define IEEE80211_QOS_TID 0x0f</span>
<span class="cp">#define QOS_CTL_NOTCONTAIN_ACK (0x01 &lt;&lt; 5)</span>

<span class="cp">#define IEEE80211_DTIM_MBCAST 4</span>
<span class="cp">#define IEEE80211_DTIM_UCAST 2</span>
<span class="cp">#define IEEE80211_DTIM_VALID 1</span>
<span class="cp">#define IEEE80211_DTIM_INVALID 0</span>

<span class="cp">#define IEEE80211_PS_DISABLED 0</span>
<span class="cp">#define IEEE80211_PS_UNICAST IEEE80211_DTIM_UCAST</span>
<span class="cp">#define IEEE80211_PS_MBCAST IEEE80211_DTIM_MBCAST</span></pre></div></td></tr>


<tr id="section-29"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-29">&#182;</a></div><p>added by David for QoS 2006/6/30</p>

<h1>define WMM<em>Hang</em>8187</h1></td><td class="code"><div class="highlight"><pre><span class="cp">#ifdef WMM_Hang_8187</span>
<span class="cp">#undef WMM_Hang_8187</span>
<span class="cp">#endif</span>

<span class="cp">#define WME_AC_BK   0x00</span>
<span class="cp">#define WME_AC_BE   0x01</span>
<span class="cp">#define WME_AC_VI   0x02</span>
<span class="cp">#define WME_AC_VO   0x03</span>
<span class="cp">#define WME_ACI_MASK 0x03</span>
<span class="cp">#define WME_AIFSN_MASK 0x03</span>
<span class="cp">#define WME_AC_PRAM_LEN 16</span>

<span class="cp">#define MAX_RECEIVE_BUFFER_SIZE 9100</span></pre></div></td></tr>


<tr id="section-30"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-30">&#182;</a></div><p>UP Mapping to AC, using in MgntQuery_SequenceNumber() and maybe for DSCP</p>

<h1>define UP2AC(up)    ((up&lt;3) ? ((up==0)?1:0) : (up>>1))</h1></td><td class="code"><div class="highlight"><pre><span class="cp">#define UP2AC(up) (		   \</span>
<span class="cp">	((up) &lt; 1) ? WME_AC_BE : \</span>
<span class="cp">	((up) &lt; 3) ? WME_AC_BK : \</span>
<span class="cp">	((up) &lt; 4) ? WME_AC_BE : \</span>
<span class="cp">	((up) &lt; 6) ? WME_AC_VI : \</span>
<span class="cp">	WME_AC_VO)</span></pre></div></td></tr>


<tr id="section-31"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-31">&#182;</a></div><p>AC Mapping to UP, using in Tx part for selecting the corresponding TX queue</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define AC2UP(_ac)	(       \</span>
<span class="cp">	((_ac) == WME_AC_VO) ? 6 : \</span>
<span class="cp">	((_ac) == WME_AC_VI) ? 5 : \</span>
<span class="cp">	((_ac) == WME_AC_BK) ? 1 : \</span>
<span class="cp">	0)</span>

<span class="cp">#define	ETHER_ADDR_LEN		6	</span><span class="cm">/* length of an Ethernet address */</span><span class="cp"></span>
<span class="cp">#define ETHERNET_HEADER_SIZE    14      </span><span class="cm">/* length of two Ethernet address plus ether type*/</span><span class="cp"></span>

<span class="k">struct</span>	<span class="n">ether_header</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">ether_dhost</span><span class="p">[</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ether_shost</span><span class="p">[</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">ether_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__attribute__</span><span class="p">((</span><span class="n">packed</span><span class="p">));</span>

<span class="cp">#ifndef ETHERTYPE_PAE</span>
<span class="cp">#define	ETHERTYPE_PAE	0x888e		</span><span class="cm">/* EAPOL PAE/802.1x */</span><span class="cp"></span>
<span class="cp">#endif</span>
<span class="cp">#ifndef ETHERTYPE_IP</span>
<span class="cp">#define	ETHERTYPE_IP	0x0800		</span><span class="cm">/* IP protocol */</span><span class="cp"></span>
<span class="cp">#endif</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_bss_ht</span><span class="p">{</span>

	<span class="n">bool</span>				<span class="n">support_ht</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-32"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-32">&#182;</a></div><p>HT related elements</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span>					<span class="n">ht_cap_buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u16</span>					<span class="n">ht_cap_len</span><span class="p">;</span>
	<span class="n">u8</span>					<span class="n">ht_info_buf</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="n">u16</span>					<span class="n">ht_info_len</span><span class="p">;</span>

	<span class="n">HT_SPEC_VER</span>			<span class="n">ht_spec_ver</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-33"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-33">&#182;</a></div><p>HT<em>CAPABILITY</em>ELE            bdHTCapEle;
HT<em>INFORMATION</em>ELE        bdHTInfoEle;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>				<span class="n">aggregation</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">long_slot_time</span><span class="p">;</span>
<span class="p">}</span><span class="n">bss_ht</span><span class="p">,</span> <span class="o">*</span><span class="n">pbss_ht</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="n">_erp_t</span><span class="p">{</span>
	<span class="n">ERP_NonERPpresent</span>	<span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">ERP_UseProtection</span>	<span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">ERP_BarkerPreambleMode</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
<span class="p">}</span> <span class="n">erp_t</span><span class="p">;</span>


<span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="p">{</span>
	<span class="cm">/* These entries are used to identify a unique network */</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">channel</span><span class="p">;</span>
	<span class="cm">/* Ensure null-terminated for any debug msgs */</span>
	<span class="n">u8</span> <span class="n">ssid</span><span class="p">[</span><span class="n">IW_ESSID_MAX_SIZE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ssid_len</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_qos_data</span> <span class="n">qos_data</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-34"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-34">&#182;</a></div><p>added by amy for LEAP</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>	<span class="n">bWithAironetIE</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bCkipSupported</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bCcxRmEnable</span><span class="p">;</span>
	<span class="n">u16</span> 	<span class="n">CcxRmState</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span></pre></div></td></tr>


<tr id="section-35"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-35">&#182;</a></div><p>CCXv4 S59, MBSSID.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>	<span class="n">bMBssidValid</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">MBssidMask</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">MBssid</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span></pre></div></td></tr>


<tr id="section-36"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-36">&#182;</a></div><p>CCX 2 S38, WLAN Device Version Number element. Annie, 2006-08-20.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>	<span class="n">bWithCcxVerNum</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">BssCcxVerNumber</span><span class="p">;</span>
	<span class="cm">/* These are network statistics */</span>
	<span class="k">struct</span> <span class="n">ieee80211_rx_stats</span> <span class="n">stats</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">rates</span><span class="p">[</span><span class="n">MAX_RATES_LENGTH</span><span class="p">];</span>
	<span class="n">u8</span>  <span class="n">rates_len</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">rates_ex</span><span class="p">[</span><span class="n">MAX_RATES_EX_LENGTH</span><span class="p">];</span>
	<span class="n">u8</span>  <span class="n">rates_ex_len</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">last_scanned</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">mode</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">last_associate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">time_stamp</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">beacon_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">atim_window</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">erp_value</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">wpa_ie</span><span class="p">[</span><span class="n">MAX_WPA_IE_LEN</span><span class="p">];</span>
	<span class="kt">size_t</span> <span class="n">wpa_ie_len</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">rsn_ie</span><span class="p">[</span><span class="n">MAX_WPA_IE_LEN</span><span class="p">];</span>
	<span class="kt">size_t</span> <span class="n">rsn_ie_len</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ieee80211_tim_parameters</span> <span class="n">tim</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">dtim_period</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">dtim_data</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">last_dtim_sta_time</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span></pre></div></td></tr>


<tr id="section-37"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-37">&#182;</a></div><p>appeded for QoS</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span> <span class="n">wmm_info</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_wmm_ac_param</span> <span class="n">wmm_param</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">QoS_Enable</span><span class="p">;</span>
<span class="cp">#ifdef THOMAS_TURBO</span>
	<span class="n">u8</span> <span class="n">Turbo_Enable</span><span class="p">;</span><span class="c1">//enable turbo mode, added by thomas</span>
<span class="cp">#endif</span>
	<span class="n">u16</span> <span class="n">CountryIeLen</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">CountryIeBuf</span><span class="p">[</span><span class="n">MAX_IE_LEN</span><span class="p">];</span></pre></div></td></tr>


<tr id="section-38"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-38">&#182;</a></div><p>HT Related, by amy, 2008.04.29</p></td><td class="code"><div class="highlight"><pre>	<span class="n">BSS_HT</span>	<span class="n">bssht</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-39"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-39">&#182;</a></div><p>Add to handle broadcom AP management frame CCK rate.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span> <span class="n">broadcom_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ralink_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">atheros_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">cisco_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">unknown_cap_exist</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-40"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-40">&#182;</a></div><p>u8    berp_info;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>	<span class="n">berp_info_valid</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">buseprotection</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-41"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-41">&#182;</a></div><p>put at the end of the structure.</p></td><td class="code"><div class="highlight"><pre>	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ieee80211_state</span> <span class="p">{</span>

	<span class="cm">/* the card is not linked at all */</span>
	<span class="n">IEEE80211_NOLINK</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

	<span class="cm">/* IEEE80211_ASSOCIATING* are for BSS client mode</span>
<span class="cm">	 * the driver shall not perform RX filtering unless</span>
<span class="cm">	 * the state is LINKED.</span>
<span class="cm">	 * The driver shall just check for the state LINKED and</span>
<span class="cm">	 * defaults to NOLINK for ALL the other states (including</span>
<span class="cm">	 * LINKED_SCANNING)</span>
<span class="cm">	 */</span>

	<span class="cm">/* the association procedure will start (wq scheduling)*/</span>
	<span class="n">IEEE80211_ASSOCIATING</span><span class="p">,</span>
	<span class="n">IEEE80211_ASSOCIATING_RETRY</span><span class="p">,</span>

	<span class="cm">/* the association procedure is sending AUTH request*/</span>
	<span class="n">IEEE80211_ASSOCIATING_AUTHENTICATING</span><span class="p">,</span>

	<span class="cm">/* the association procedure has successfully authentcated</span>
<span class="cm">	 * and is sending association request</span>
<span class="cm">	 */</span>
	<span class="n">IEEE80211_ASSOCIATING_AUTHENTICATED</span><span class="p">,</span>

	<span class="cm">/* the link is ok. the card associated to a BSS or linked</span>
<span class="cm">	 * to a ibss cell or acting as an AP and creating the bss</span>
<span class="cm">	 */</span>
	<span class="n">IEEE80211_LINKED</span><span class="p">,</span>

	<span class="cm">/* same as LINKED, but the driver shall apply RX filter</span>
<span class="cm">	 * rules as we are in NO_LINK mode. As the card is still</span>
<span class="cm">	 * logically linked, but it is doing a syncro site survey</span>
<span class="cm">	 * then it will be back to LINKED state.</span>
<span class="cm">	 */</span>
	<span class="n">IEEE80211_LINKED_SCANNING</span><span class="p">,</span>

<span class="p">};</span>

<span class="cp">#define DEFAULT_MAX_SCAN_AGE (15 * HZ)</span>
<span class="cp">#define DEFAULT_FTS 2346</span>

<span class="cp">#define CFG_IEEE80211_RESERVE_FCS (1&lt;&lt;0)</span>
<span class="cp">#define CFG_IEEE80211_COMPUTE_FCS (1&lt;&lt;1)</span>
<span class="cp">#define CFG_IEEE80211_RTS (1&lt;&lt;2)</span>

<span class="cp">#define IEEE80211_24GHZ_MIN_CHANNEL 1</span>
<span class="cp">#define IEEE80211_24GHZ_MAX_CHANNEL 14</span>
<span class="cp">#define IEEE80211_24GHZ_CHANNELS (IEEE80211_24GHZ_MAX_CHANNEL - \</span>
<span class="cp">				  IEEE80211_24GHZ_MIN_CHANNEL + 1)</span>

<span class="cp">#define IEEE80211_52GHZ_MIN_CHANNEL 34</span>
<span class="cp">#define IEEE80211_52GHZ_MAX_CHANNEL 165</span>
<span class="cp">#define IEEE80211_52GHZ_CHANNELS (IEEE80211_52GHZ_MAX_CHANNEL - \</span>
<span class="cp">				  IEEE80211_52GHZ_MIN_CHANNEL + 1)</span>



<span class="k">typedef</span> <span class="k">struct</span> <span class="n">tx_pending_t</span><span class="p">{</span>
	<span class="kt">int</span> <span class="n">frag</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_txb</span> <span class="o">*</span><span class="n">txb</span><span class="p">;</span>
<span class="p">}</span><span class="n">tx_pending_t</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_bandwidth_autoswitch</span>
<span class="p">{</span>
	<span class="kt">long</span> <span class="n">threshold_20Mhzto40Mhz</span><span class="p">;</span>
	<span class="kt">long</span>	<span class="n">threshold_40Mhzto20Mhz</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bforced_tx20Mhz</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bautoswitch_enable</span><span class="p">;</span>
<span class="p">}</span><span class="n">bandwidth_autoswitch</span><span class="p">,</span><span class="o">*</span><span class="n">pbandwidth_autoswitch</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-42"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-42">&#182;</a></div><p>added by amy for order</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define REORDER_WIN_SIZE	128</span>
<span class="cp">#define REORDER_ENTRY_NUM	128</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_RX_REORDER_ENTRY</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">List</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="n">SeqNum</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_rxb</span><span class="o">*</span> <span class="n">prxb</span><span class="p">;</span>
<span class="p">}</span> <span class="n">RX_REORDER_ENTRY</span><span class="p">,</span> <span class="o">*</span><span class="n">PRX_REORDER_ENTRY</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-43"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-43">&#182;</a></div><p>added by amy for order</p></td><td class="code"><div class="highlight"><pre><span class="k">typedef</span> <span class="k">enum</span> <span class="n">_Fsync_State</span><span class="p">{</span>
	<span class="n">Default_Fsync</span><span class="p">,</span>
	<span class="n">HW_Fsync</span><span class="p">,</span>
	<span class="n">SW_Fsync</span>
<span class="p">}</span><span class="n">Fsync_State</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-44"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-44">&#182;</a></div><p>Power save mode configured.</p></td><td class="code"><div class="highlight"><pre><span class="k">typedef</span>	<span class="k">enum</span> <span class="n">_RT_PS_MODE</span>
<span class="p">{</span>
	<span class="n">eActive</span><span class="p">,</span>	<span class="c1">// Active/Continuous access.</span>
	<span class="n">eMaxPs</span><span class="p">,</span>		<span class="c1">// Max power save mode.</span>
	<span class="n">eFastPs</span>		<span class="c1">// Fast power save mode.</span>
<span class="p">}</span><span class="n">RT_PS_MODE</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="n">_IPS_CALLBACK_FUNCION</span>
<span class="p">{</span>
	<span class="n">IPS_CALLBACK_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">IPS_CALLBACK_MGNT_LINK_REQUEST</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IPS_CALLBACK_JOIN_REQUEST</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">}</span><span class="n">IPS_CALLBACK_FUNCION</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">enum</span> <span class="n">_RT_JOIN_ACTION</span><span class="p">{</span>
	<span class="n">RT_JOIN_INFRA</span>   <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">RT_JOIN_IBSS</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">RT_START_IBSS</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">RT_NO_ACTION</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">}</span><span class="n">RT_JOIN_ACTION</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_IbssParms</span><span class="p">{</span>
	<span class="n">u16</span>   <span class="n">atimWin</span><span class="p">;</span>
<span class="p">}</span><span class="n">IbssParms</span><span class="p">,</span> <span class="o">*</span><span class="n">PIbssParms</span><span class="p">;</span>
<span class="cp">#define MAX_NUM_RATES	264 </span><span class="c1">// Max num of support rates element: 8,  Max num of ext. support rate: 255. 061122, by rcnjko.</span></pre></div></td></tr>


<tr id="section-45"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-45">&#182;</a></div><p>RF state.</p></td><td class="code"><div class="highlight"><pre><span class="k">typedef</span>	<span class="k">enum</span> <span class="n">_RT_RF_POWER_STATE</span>
<span class="p">{</span>
	<span class="n">eRfOn</span><span class="p">,</span>
	<span class="n">eRfSleep</span><span class="p">,</span>
	<span class="n">eRfOff</span>
<span class="p">}</span><span class="n">RT_RF_POWER_STATE</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_RT_POWER_SAVE_CONTROL</span>
<span class="p">{</span></pre></div></td></tr>


<tr id="section-46"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-46">&#182;</a></div><p>Inactive Power Save(IPS) : Disable RF when disconnected</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>				<span class="n">bInactivePs</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bIPSModeBackup</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bSwRfProcessing</span><span class="p">;</span>
	<span class="n">RT_RF_POWER_STATE</span>	<span class="n">eInactivePowerState</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> 	<span class="n">InactivePsWorkItem</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span>	<span class="n">InactivePsTimer</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-47"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-47">&#182;</a></div><p>Return point for join action</p></td><td class="code"><div class="highlight"><pre>	<span class="n">IPS_CALLBACK_FUNCION</span>	<span class="n">ReturnPoint</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-48"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-48">&#182;</a></div><p>Recored Parameters for rescheduled JoinRequest</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>				<span class="n">bTmpBssDesc</span><span class="p">;</span>
	<span class="n">RT_JOIN_ACTION</span>		<span class="n">tmpJoinAction</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="n">tmpBssDesc</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-49"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-49">&#182;</a></div><p>Recored Parameters for rescheduled MgntLinkRequest</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>				<span class="n">bTmpScanOnly</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpActiveScan</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpFilterHiddenAP</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpUpdateParms</span><span class="p">;</span>
	<span class="n">u8</span>					<span class="n">tmpSsidBuf</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
	<span class="n">OCTET_STRING</span>			<span class="n">tmpSsid2Scan</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpSsid2Scan</span><span class="p">;</span>
	<span class="n">u8</span>					<span class="n">tmpNetworkType</span><span class="p">;</span>
	<span class="n">u8</span>					<span class="n">tmpChannelNumber</span><span class="p">;</span>
	<span class="n">u16</span>					<span class="n">tmpBcnPeriod</span><span class="p">;</span>
	<span class="n">u8</span>					<span class="n">tmpDtimPeriod</span><span class="p">;</span>
	<span class="n">u16</span>					<span class="n">tmpmCap</span><span class="p">;</span>
	<span class="n">OCTET_STRING</span>			<span class="n">tmpSuppRateSet</span><span class="p">;</span>
	<span class="n">u8</span>					<span class="n">tmpSuppRateBuf</span><span class="p">[</span><span class="n">MAX_NUM_RATES</span><span class="p">];</span>
	<span class="n">bool</span>				<span class="n">bTmpSuppRate</span><span class="p">;</span>
	<span class="n">IbssParms</span>				<span class="n">tmpIbpm</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpIbpm</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-50"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-50">&#182;</a></div><p>Leisre Poswer Save : Disable RF if connected but traffic is not busy</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>				<span class="n">bLeisurePs</span><span class="p">;</span>

<span class="p">}</span><span class="n">RT_POWER_SAVE_CONTROL</span><span class="p">,</span><span class="o">*</span><span class="n">PRT_POWER_SAVE_CONTROL</span><span class="p">;</span>

<span class="k">typedef</span> <span class="n">u32</span> <span class="n">RT_RF_CHANGE_SOURCE</span><span class="p">;</span>
<span class="cp">#define RF_CHANGE_BY_SW BIT31</span>
<span class="cp">#define RF_CHANGE_BY_HW BIT30</span>
<span class="cp">#define RF_CHANGE_BY_PS BIT29</span>
<span class="cp">#define RF_CHANGE_BY_IPS BIT28</span>
<span class="cp">#define RF_CHANGE_BY_INIT	0	</span><span class="c1">// Do not change the RFOff reason. Defined by Bruce, 2008-01-17.</span>

<span class="k">typedef</span> <span class="k">enum</span>
<span class="p">{</span>
	<span class="n">COUNTRY_CODE_FCC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_IC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_ETSI</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_SPAIN</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_FRANCE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_MKK</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_MKK1</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_ISRAEL</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_TELEC</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_MIC</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_GLOBAL_DOMAIN</span>
<span class="p">}</span><span class="n">country_code_type_t</span><span class="p">;</span>

<span class="cp">#define RT_MAX_LD_SLOT_NUM	10</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="n">_RT_LINK_DETECT_T</span><span class="p">{</span>

	<span class="n">u32</span>				<span class="n">NumRecvBcnInPeriod</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">NumRecvDataInPeriod</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="n">RxBcnNum</span><span class="p">[</span><span class="n">RT_MAX_LD_SLOT_NUM</span><span class="p">];</span>	<span class="c1">// number of Rx beacon / CheckForHang_period  to determine link status</span>
	<span class="n">u32</span>				<span class="n">RxDataNum</span><span class="p">[</span><span class="n">RT_MAX_LD_SLOT_NUM</span><span class="p">];</span>	<span class="c1">// number of Rx data / CheckForHang_period  to determine link status</span>
	<span class="n">u16</span>				<span class="n">SlotNum</span><span class="p">;</span>	<span class="c1">// number of CheckForHang period to determine link status</span>
	<span class="n">u16</span>				<span class="n">SlotIndex</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="n">NumTxOkInPeriod</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">NumRxOkInPeriod</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bBusyTraffic</span><span class="p">;</span>
<span class="p">}</span><span class="n">RT_LINK_DETECT_T</span><span class="p">,</span> <span class="o">*</span><span class="n">PRT_LINK_DETECT_T</span><span class="p">;</span>


<span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_security</span> <span class="n">sec</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-51"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-51">&#182;</a></div><p>hw security related
u8 hwsec_support; //support?</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span> <span class="n">hwsec_active</span><span class="p">;</span>  <span class="c1">//hw security active.</span>
	<span class="n">bool</span> <span class="n">is_silent_reset</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ieee_up</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-52"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-52">&#182;</a></div><p>added by amy</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span> <span class="n">bSupportRemoteWakeUp</span><span class="p">;</span>
	<span class="n">RT_PS_MODE</span>	<span class="n">dot11PowerSaveMode</span><span class="p">;</span> <span class="c1">// Power save mode configured.</span>
	<span class="n">bool</span> <span class="n">actscanning</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">beinretry</span><span class="p">;</span>
	<span class="n">RT_RF_POWER_STATE</span>		<span class="n">eRFPowerState</span><span class="p">;</span>
	<span class="n">RT_RF_CHANGE_SOURCE</span>	<span class="n">RfOffReason</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">is_set_key</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-53"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-53">&#182;</a></div><p>11n spec related I wonder if These info structure need to be moved out of ieee80211_device</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-54"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-54">&#182;</a></div><p>11n HT below</p></td><td class="code"><div class="highlight"><pre>	<span class="n">PRT_HIGH_THROUGHPUT</span>	<span class="n">pHTInfo</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-55"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-55">&#182;</a></div><p>struct timer<em>list        SwBwTimer;
spinlock</em>t chnlop_spinlock;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">spinlock_t</span> <span class="n">bw_spinlock</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">reorder_spinlock</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-56"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-56">&#182;</a></div><p>for HT operation rate set.  we use this one for HT data rate to separate different descriptors
the way fill this is the same as in the IE</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span>	<span class="n">Regdot11HTOperationalRateSet</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>		<span class="c1">//use RATR format</span>
	<span class="n">u8</span>	<span class="n">dot11HTOperationalRateSet</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>		<span class="c1">//use RATR format</span>
	<span class="n">u8</span>	<span class="n">RegHTSuppRateSet</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u8</span>				<span class="n">HTCurrentOperaRate</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">HTHighestOperaRate</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-57"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-57">&#182;</a></div><p>wb added for rate operation mode to firmware</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span>	<span class="n">bTxDisableRateFallBack</span><span class="p">;</span>
	<span class="n">u8</span> 	<span class="n">bTxUseDriverAssingedRate</span><span class="p">;</span>
	<span class="n">atomic_t</span>	<span class="n">atm_chnlop</span><span class="p">;</span>
	<span class="n">atomic_t</span>	<span class="n">atm_swbw</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-58"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-58">&#182;</a></div><p>u8    HTHighestOperaRate;
u8     HTCurrentOperaRate;</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-59"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-59">&#182;</a></div><p>802.11e and WMM Traffic Stream Info (TX)</p></td><td class="code"><div class="highlight"><pre>	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Tx_TS_Admit_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Tx_TS_Pending_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Tx_TS_Unused_List</span><span class="p">;</span>
	<span class="n">TX_TS_RECORD</span>		<span class="n">TxTsRecord</span><span class="p">[</span><span class="n">TOTAL_TS_NUM</span><span class="p">];</span></pre></div></td></tr>


<tr id="section-60"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-60">&#182;</a></div><p>802.11e and WMM Traffic Stream Info (RX)</p></td><td class="code"><div class="highlight"><pre>	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Rx_TS_Admit_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Rx_TS_Pending_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Rx_TS_Unused_List</span><span class="p">;</span>
	<span class="n">RX_TS_RECORD</span>		<span class="n">RxTsRecord</span><span class="p">[</span><span class="n">TOTAL_TS_NUM</span><span class="p">];</span></pre></div></td></tr>


<tr id="section-61"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-61">&#182;</a></div><h1>ifdef TO<em>DO</em>LIST</h1></td><td class="code"><div class="highlight"><pre>	<span class="n">RX_REORDER_ENTRY</span>	<span class="n">RxReorderEntry</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">RxReorder_Unused_List</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-62"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-62">&#182;</a></div><h1>endif</h1>

<p>Qos related. Added by Annie, 2005-11-01.
PSTA_QOS            pStaQos;</p></td><td class="code"><div class="highlight"><pre>	<span class="n">u8</span>				<span class="n">ForcedPriority</span><span class="p">;</span>		<span class="c1">// Force per-packet priority 1~7. (default: 0, not to force it.)</span>


	<span class="cm">/* Bookkeeping structures */</span>
	<span class="k">struct</span> <span class="n">net_device_stats</span> <span class="n">stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_stats</span> <span class="n">ieee_stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_softmac_stats</span> <span class="n">softmac_stats</span><span class="p">;</span>

	<span class="cm">/* Probe / Beacon management */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">network_free_list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">network_list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span><span class="n">networks</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">scans</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">scan_age</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">iw_mode</span><span class="p">;</span> <span class="cm">/* operating mode (IW_MODE_*) */</span>
	<span class="k">struct</span> <span class="n">iw_spy_data</span> <span class="n">spy_data</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">wpax_suitlist_lock</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">tx_headroom</span><span class="p">;</span> <span class="cm">/* Set to size of any additional room needed at front</span>
<span class="cm">			  * of allocated Tx SKBs */</span>
	<span class="n">u32</span> <span class="n">config</span><span class="p">;</span>

	<span class="cm">/* WEP and other encryption related settings at the device level */</span>
	<span class="kt">int</span> <span class="n">open_wep</span><span class="p">;</span> <span class="cm">/* Set to 1 to allow unencrypted frames */</span>
	<span class="kt">int</span> <span class="n">auth_mode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">reset_on_keychange</span><span class="p">;</span> <span class="cm">/* Set to 1 if the HW needs to be reset on</span>
<span class="cm">				 * WEP key changes */</span>

	<span class="cm">/* If the host performs {en,de}cryption, then set to 1 */</span>
	<span class="kt">int</span> <span class="n">host_encrypt</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">host_encrypt_msdu</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">host_decrypt</span><span class="p">;</span>
	<span class="cm">/* host performs multicast decryption */</span>
	<span class="kt">int</span> <span class="n">host_mc_decrypt</span><span class="p">;</span>

	<span class="cm">/* host should strip IV and ICV from protected frames */</span>
	<span class="cm">/* meaningful only when hardware decryption is being used */</span>
	<span class="kt">int</span> <span class="n">host_strip_iv_icv</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">host_open_frag</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">host_build_iv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ieee802_1x</span><span class="p">;</span> <span class="cm">/* is IEEE 802.1X used */</span>

	<span class="cm">/* WPA data */</span>
	<span class="n">bool</span> <span class="n">bHalfWirelessN24GMode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">wpa_enabled</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">drop_unencrypted</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tkip_countermeasures</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">privacy_invoked</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">wpa_ie_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">wpa_ie</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ap_mac_addr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">pairwise_key_type</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">group_key_type</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">crypt_deinit_list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_crypt_data</span> <span class="o">*</span><span class="n">crypt</span><span class="p">[</span><span class="n">WEP_KEYS</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">tx_keyidx</span><span class="p">;</span> <span class="cm">/* default TX key index (crypt[tx_keyidx]) */</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">crypt_deinit_timer</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">crypt_quiesced</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">bcrx_sta_key</span><span class="p">;</span> <span class="cm">/* use individual keys to override default keys even</span>
<span class="cm">			   * with RX of broad/multicast frames */</span>

	<span class="cm">/* Fragmentation structures */</span></pre></div></td></tr>


<tr id="section-63"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-63">&#182;</a></div><p>each streaming contain a entry</p></td><td class="code"><div class="highlight"><pre>	<span class="k">struct</span> <span class="n">ieee80211_frag_entry</span> <span class="n">frag_cache</span><span class="p">[</span><span class="mi">17</span><span class="p">][</span><span class="n">IEEE80211_FRAG_CACHE_LEN</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">frag_next_idx</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">fts</span><span class="p">;</span> <span class="cm">/* Fragmentation Threshold */</span>
<span class="cp">#define DEFAULT_RTS_THRESHOLD 2346U</span>
<span class="cp">#define MIN_RTS_THRESHOLD 1</span>
<span class="cp">#define MAX_RTS_THRESHOLD 2346U</span>
	<span class="n">u16</span> <span class="n">rts</span><span class="p">;</span> <span class="cm">/* RTS threshold */</span>

	<span class="cm">/* Association info */</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>

	<span class="cm">/* This stores infos for the current network.</span>
<span class="cm">	 * Either the network we are associated in INFRASTRUCTURE</span>
<span class="cm">	 * or the network that we are creating in MASTER mode.</span>
<span class="cm">	 * ad-hoc is a mixture ;-).</span>
<span class="cm">	 * Note that in infrastructure mode, even when not associated,</span>
<span class="cm">	 * fields bssid and essid may be valid (if wpa_set and essid_set</span>
<span class="cm">	 * are true) as thy carry the value set by the user via iwconfig</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="n">current_network</span><span class="p">;</span>

	<span class="k">enum</span> <span class="n">ieee80211_state</span> <span class="n">state</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">short_slot</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">reg_mode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>       <span class="cm">/* A, B, G */</span>
	<span class="kt">int</span> <span class="n">modulation</span><span class="p">;</span> <span class="cm">/* CCK, OFDM */</span>
	<span class="kt">int</span> <span class="n">freq_band</span><span class="p">;</span>  <span class="cm">/* 2.4Ghz, 5.2Ghz, Mixed */</span>
	<span class="kt">int</span> <span class="n">abg_true</span><span class="p">;</span>   <span class="cm">/* ABG flag              */</span>

	<span class="cm">/* used for forcing the ibss workqueue to terminate</span>
<span class="cm">	 * without wait for the syncro scan to terminate</span>
<span class="cm">	 */</span>
	<span class="kt">short</span> <span class="n">sync_scan_hurryup</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">perfect_rssi</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">worst_rssi</span><span class="p">;</span>

	<span class="n">u16</span> <span class="n">prev_seq_ctl</span><span class="p">;</span>       <span class="cm">/* used to drop duplicate frames */</span>

	<span class="cm">/* map of allowed channels. 0 is dummy */</span></pre></div></td></tr>


<tr id="section-64"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-64">&#182;</a></div><p>FIXME: remember to default to a basic channel plan depending of the PHY type</p></td><td class="code"><div class="highlight"><pre>	<span class="kt">void</span><span class="o">*</span> <span class="n">pDot11dInfo</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bGlobalDomain</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rate</span><span class="p">;</span>       <span class="cm">/* current rate */</span>
	<span class="kt">int</span> <span class="n">basic_rate</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-65"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-65">&#182;</a></div><p>FIXME: pleace callback, see if redundant with softmac_features</p></td><td class="code"><div class="highlight"><pre>	<span class="kt">short</span> <span class="n">active_scan</span><span class="p">;</span>

	<span class="cm">/* this contains flags for selectively enable softmac support */</span>
	<span class="n">u16</span> <span class="n">softmac_features</span><span class="p">;</span>

	<span class="cm">/* if the sequence control field is not filled by HW */</span>
	<span class="n">u16</span> <span class="n">seq_ctrl</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

	<span class="cm">/* association procedure transaction sequence number */</span>
	<span class="n">u16</span> <span class="n">associate_seq</span><span class="p">;</span>

	<span class="cm">/* AID for RTXed association responses */</span>
	<span class="n">u16</span> <span class="n">assoc_id</span><span class="p">;</span>

	<span class="cm">/* power save mode related*/</span>
	<span class="kt">short</span> <span class="n">ps</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">sta_sleep</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ps_timeout</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ps_period</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">ps_task</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ps_th</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ps_tl</span><span class="p">;</span>

	<span class="kt">short</span> <span class="n">raw_tx</span><span class="p">;</span>
	<span class="cm">/* used if IEEE_SOFTMAC_TX_QUEUE is set */</span>
	<span class="kt">short</span> <span class="n">queue_stop</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">scanning</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">proto_started</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">semaphore</span> <span class="n">wx_sem</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">semaphore</span> <span class="n">scan_sem</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">mgmt_tx_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">beacon_lock</span><span class="p">;</span>

	<span class="kt">short</span> <span class="n">beacon_txing</span><span class="p">;</span>

	<span class="kt">short</span> <span class="n">wap_set</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">ssid_set</span><span class="p">;</span>

	<span class="n">u8</span>  <span class="n">wpax_type_set</span><span class="p">;</span>    <span class="c1">//{added by David, 2006.9.28}</span>
	<span class="n">u32</span> <span class="n">wpax_type_notify</span><span class="p">;</span> <span class="c1">//{added by David, 2006.9.26}</span>

	<span class="cm">/* QoS related flag */</span>
	<span class="kt">char</span> <span class="n">init_wmmparam_flag</span><span class="p">;</span>
	<span class="cm">/* set on initialization */</span>
	<span class="n">u8</span>  <span class="n">qos_support</span><span class="p">;</span>

	<span class="cm">/* for discarding duplicated packets in IBSS */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">ibss_mac_hash</span><span class="p">[</span><span class="n">IEEE_IBSS_MAC_HASH_SIZE</span><span class="p">];</span>

	<span class="cm">/* for discarding duplicated packets in BSS */</span>
	<span class="n">u16</span> <span class="n">last_rxseq_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span> <span class="cm">/* rx seq previous per-tid */</span>
	<span class="n">u16</span> <span class="n">last_rxfrag_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span><span class="cm">/* tx frag previous per-tid */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">last_packet_time</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>

	<span class="cm">/* for PS mode */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">last_rx_ps_time</span><span class="p">;</span>

	<span class="cm">/* used if IEEE_SOFTMAC_SINGLE_QUEUE is set */</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">mgmt_queue_ring</span><span class="p">[</span><span class="n">MGMT_QUEUE_NUM</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">mgmt_queue_head</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">mgmt_queue_tail</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-66"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-66">&#182;</a></div><p>{ added for rtl819x</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define IEEE80211_QUEUE_LIMIT 128</span>
	<span class="n">u8</span> <span class="n">AsocRetryCount</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hw_header</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">skb_waitQ</span><span class="p">[</span><span class="n">MAX_QUEUE_SIZE</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span>  <span class="n">skb_aggQ</span><span class="p">[</span><span class="n">MAX_QUEUE_SIZE</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span>  <span class="n">skb_drv_aggQ</span><span class="p">[</span><span class="n">MAX_QUEUE_SIZE</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">sta_edca_param</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bool</span> <span class="n">aggregation</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-67"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-67">&#182;</a></div><p>Enable/Disable Rx immediate BA capability.</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span> <span class="n">enable_rx_imm_BA</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bibsscoordinator</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-68"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-68">&#182;</a></div><p>+by amy for DM ,080515
Dynamic Tx power for near/far range enable/Disable  , by amy , 2008-05-15</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span>	<span class="n">bdynamic_txpower_enable</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">bCTSToSelfEnable</span><span class="p">;</span>
	<span class="n">u8</span> 	<span class="n">CTSToSelfTH</span><span class="p">;</span>

	<span class="n">u32</span> 	<span class="n">fsync_time_interval</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">fsync_rate_bitmap</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">fsync_rssi_threshold</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bfsync_enable</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">fsync_multiple_timeinterval</span><span class="p">;</span>		<span class="c1">// FsyncMultipleTimeInterval * FsyncTimeInterval</span>
	<span class="n">u32</span>	<span class="n">fsync_firstdiff_ratethreshold</span><span class="p">;</span>		<span class="c1">// low threshold</span>
	<span class="n">u32</span>	<span class="n">fsync_seconddiff_ratethreshold</span><span class="p">;</span>	 <span class="c1">// decrease threshold</span>
	<span class="n">Fsync_State</span>			<span class="n">fsync_state</span><span class="p">;</span>
	<span class="n">bool</span>		<span class="n">bis_any_nonbepkts</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-69"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-69">&#182;</a></div><p>20Mhz 40Mhz AutoSwitch Threshold</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bandwidth_autoswitch</span> <span class="n">bandwidth_auto_switch</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-70"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-70">&#182;</a></div><p>for txpower tracking</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span> <span class="n">FwRWRF</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-71"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-71">&#182;</a></div><p>added by amy for AP roaming</p></td><td class="code"><div class="highlight"><pre>	<span class="n">RT_LINK_DETECT_T</span>	<span class="n">LinkDetectInfo</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-72"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-72">&#182;</a></div><p>added by amy for ps</p></td><td class="code"><div class="highlight"><pre>	<span class="n">RT_POWER_SAVE_CONTROL</span>	<span class="n">PowerSaveControl</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-73"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-73">&#182;</a></div><p>}</p></td><td class="code"><div class="highlight"><pre>	<span class="cm">/* used if IEEE_SOFTMAC_TX_QUEUE is set */</span>
	<span class="k">struct</span>  <span class="n">tx_pending_t</span> <span class="n">tx_pending</span><span class="p">;</span>

	<span class="cm">/* used if IEEE_SOFTMAC_ASSOCIATE is set */</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">associate_timer</span><span class="p">;</span>

	<span class="cm">/* used if IEEE_SOFTMAC_BEACONS is set */</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">beacon_timer</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">associate_complete_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">associate_procedure_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">softmac_scan_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">associate_retry_wq</span><span class="p">;</span>
	 <span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">start_ibss_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">wx_sync_scan_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">workqueue_struct</span> <span class="o">*</span><span class="n">wq</span><span class="p">;</span></pre></div></td></tr>


<tr id="section-74"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-74">&#182;</a></div><p>Qos related. Added by Annie, 2005-11-01.
STA_QOS  StaQos;</p></td><td class="code"><div class="highlight"><pre></pre></div></td></tr>


<tr id="section-75"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-75">&#182;</a></div><p>u32 STA<em>EDCA</em>PARAM[4];
CHANNEL<em>ACCESS</em>SETTING ChannelAccessSetting;</p></td><td class="code"><div class="highlight"><pre>	<span class="cm">/* Callback functions */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_security</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">ieee80211_security</span> <span class="o">*</span><span class="n">sec</span><span class="p">);</span>

	<span class="cm">/* Used to TX data frame by using txb structs.</span>
<span class="cm">	 * this is not used if in the softmac_features</span>
<span class="cm">	 * is set the flag IEEE_SOFTMAC_TX_QUEUE</span>
<span class="cm">	 */</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">hard_start_xmit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">ieee80211_txb</span> <span class="o">*</span><span class="n">txb</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">reset_port</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
        <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">is_queue_full</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pri</span><span class="p">);</span>

        <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">handle_management</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">,</span>
                                  <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span> <span class="n">network</span><span class="p">,</span> <span class="n">u16</span> <span class="n">type</span><span class="p">);</span>
        <span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">is_qos_active</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>

	<span class="cm">/* Softmac-generated frames (mamagement) are TXed via this</span>
<span class="cm">	 * callback if the flag IEEE_SOFTMAC_SINGLE_QUEUE is</span>
<span class="cm">	 * not set. As some cards may have different HW queues that</span>
<span class="cm">	 * one might want to use for data and management frames</span>
<span class="cm">	 * the option to have two callbacks might be useful.</span>
<span class="cm">	 * This function can&#39;t sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">softmac_hard_start_xmit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* used instead of hard_start_xmit (not softmac_hard_start_xmit)</span>
<span class="cm">	 * if the IEEE_SOFTMAC_TX_QUEUE feature is used to TX data</span>
<span class="cm">	 * frames. I the option IEEE_SOFTMAC_SINGLE_QUEUE is also set</span>
<span class="cm">	 * then also management frames are sent via this callback.</span>
<span class="cm">	 * This function can&#39;t sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">softmac_data_hard_start_xmit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span><span class="kt">int</span> <span class="n">rate</span><span class="p">);</span>

	<span class="cm">/* stops the HW queue for DATA frames. Useful to avoid</span>
<span class="cm">	 * waste time to TX data frame when we are reassociating</span>
<span class="cm">	 * This function can sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">data_hard_stop</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* OK this is complementar to data_poll_hard_stop */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">data_hard_resume</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* ask to the driver to retune the radio .</span>
<span class="cm">	 * This function can sleep. the driver should ensure</span>
<span class="cm">	 * the radio has been swithced before return.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_chan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span><span class="kt">short</span> <span class="n">ch</span><span class="p">);</span>

	<span class="cm">/* These are not used if the ieee stack takes care of</span>
<span class="cm">	 * scanning (IEEE_SOFTMAC_SCAN feature set).</span>
<span class="cm">	 * In this case only the set_chan is used.</span>
<span class="cm">	 *</span>
<span class="cm">	 * The syncro version is similar to the start_scan but</span>
<span class="cm">	 * does not return until all channels has been scanned.</span>
<span class="cm">	 * this is called in user context and should sleep,</span>
<span class="cm">	 * it is called in a work_queue when swithcing to ad-hoc mode</span>
<span class="cm">	 * or in behalf of iwlist scan when the card is associated</span>
<span class="cm">	 * and root user ask for a scan.</span>
<span class="cm">	 * the function stop_scan should stop both the syncro and</span>
<span class="cm">	 * background scanning and can sleep.</span>
<span class="cm">	 * The function start_scan should initiate the background</span>
<span class="cm">	 * scanning and can&#39;t sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">scan_syncro</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">start_scan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">stop_scan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* indicate the driver that the link state is changed</span>
<span class="cm">	 * for example it may indicate the card is associated now.</span>
<span class="cm">	 * Driver might be interested in this to apply RX filter</span>
<span class="cm">	 * rules or simply light the LINK led</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">link_change</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* these two function indicates to the HW when to start</span>
<span class="cm">	 * and stop to send beacons. This is used when the</span>
<span class="cm">	 * IEEE_SOFTMAC_BEACONS is not set. For now the</span>
<span class="cm">	 * stop_send_bacons is NOT guaranteed to be called only</span>
<span class="cm">	 * after start_send_beacons.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">start_send_beacons</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span><span class="n">u16</span> <span class="n">tx_rate</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">stop_send_beacons</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* power save mode related */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">sta_wake_up</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">ps_request_tx_ack</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">enter_sleep_state</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u32</span> <span class="n">th</span><span class="p">,</span> <span class="n">u32</span> <span class="n">tl</span><span class="p">);</span>
	<span class="kt">short</span> <span class="p">(</span><span class="o">*</span><span class="n">ps_is_queue_empty</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">handle_beacon</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_beacon</span> <span class="o">*</span> <span class="n">beacon</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span> <span class="n">network</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">handle_assoc_response</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span> <span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_assoc_response_frame</span> <span class="o">*</span> <span class="n">resp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span> <span class="n">network</span><span class="p">);</span>


	<span class="cm">/* check whether Tx hw resouce available */</span>
	<span class="kt">short</span> <span class="p">(</span><span class="o">*</span><span class="n">check_nic_enough_desc</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">queue_index</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-76"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-76">&#182;</a></div><p>added by wb for HT related
void (*SwChnlByTimerHandler)(struct net_device *dev, int channel);</p></td><td class="code"><div class="highlight"><pre>	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">SetBWModeHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">HT_CHANNEL_WIDTH</span> <span class="n">Bandwidth</span><span class="p">,</span> <span class="n">HT_EXTCHNL_OFFSET</span> <span class="n">Offset</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-77"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-77">&#182;</a></div><p>void (<em>UpdateHalRATRTableHandler)(struct net_device</em> dev, u8* pMcsRate);</p></td><td class="code"><div class="highlight"><pre>	<span class="n">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">GetNmodeSupportBySecCfg</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span><span class="o">*</span> <span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">SetWirelessMode</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span><span class="o">*</span> <span class="n">dev</span><span class="p">,</span> <span class="n">u8</span> <span class="n">wireless_mode</span><span class="p">);</span>
	<span class="n">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">GetHalfNmodeSupportByAPsHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span><span class="o">*</span> <span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">InitialGainHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u8</span> <span class="n">Operation</span><span class="p">);</span>

	<span class="cm">/* This must be the last item so that it points to the data</span>
<span class="cm">	 * allocated beyond this structure by alloc_ieee80211 */</span>
	<span class="n">u8</span> <span class="n">priv</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define IEEE_A            (1&lt;&lt;0)</span>
<span class="cp">#define IEEE_B            (1&lt;&lt;1)</span>
<span class="cp">#define IEEE_G            (1&lt;&lt;2)</span>
<span class="cp">#define IEEE_N_24G 		  (1&lt;&lt;4)</span>
<span class="cp">#define	IEEE_N_5G		  (1&lt;&lt;5)</span>
<span class="cp">#define IEEE_MODE_MASK    (IEEE_A|IEEE_B|IEEE_G)</span>

<span class="cm">/* Generate a 802.11 header */</span>

<span class="cm">/* Uses the channel change callback directly</span>
<span class="cm"> * instead of [start/stop] scan callbacks</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE_SOFTMAC_SCAN (1&lt;&lt;2)</span>

<span class="cm">/* Perform authentication and association handshake */</span>
<span class="cp">#define IEEE_SOFTMAC_ASSOCIATE (1&lt;&lt;3)</span>

<span class="cm">/* Generate probe requests */</span>
<span class="cp">#define IEEE_SOFTMAC_PROBERQ (1&lt;&lt;4)</span>

<span class="cm">/* Generate respones to probe requests */</span>
<span class="cp">#define IEEE_SOFTMAC_PROBERS (1&lt;&lt;5)</span>

<span class="cm">/* The ieee802.11 stack will manages the netif queue</span>
<span class="cm"> * wake/stop for the driver, taking care of 802.11</span>
<span class="cm"> * fragmentation. See softmac.c for details. */</span>
<span class="cp">#define IEEE_SOFTMAC_TX_QUEUE (1&lt;&lt;7)</span>

<span class="cm">/* Uses only the softmac_data_hard_start_xmit</span>
<span class="cm"> * even for TX management frames.</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE_SOFTMAC_SINGLE_QUEUE (1&lt;&lt;8)</span>

<span class="cm">/* Generate beacons.  The stack will enqueue beacons</span>
<span class="cm"> * to the card</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE_SOFTMAC_BEACONS (1&lt;&lt;6)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">ieee80211_priv</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="p">)</span><span class="n">netdev_priv</span><span class="p">(</span><span class="n">dev</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">priv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_empty_essid</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">essid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">essid_len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* Single white space is for Linksys APs */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">essid_len</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">essid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* Otherwise, if the entire essid is 0, we assume it is hidden */</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">essid_len</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">essid_len</span><span class="o">--</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">essid</span><span class="p">[</span><span class="n">essid_len</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_valid_mode</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * It is possible for both access points and our device to support</span>
<span class="cm">	 * combinations of modes, so as long as there is one valid combination</span>
<span class="cm">	 * of ap/device supported modes, then return success</span>
<span class="cm">	 *</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="n">IEEE_A</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">modulation</span> <span class="o">&amp;</span> <span class="n">IEEE80211_OFDM_MODULATION</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">freq_band</span> <span class="o">&amp;</span> <span class="n">IEEE80211_52GHZ_BAND</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="n">IEEE_G</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">modulation</span> <span class="o">&amp;</span> <span class="n">IEEE80211_OFDM_MODULATION</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">freq_band</span> <span class="o">&amp;</span> <span class="n">IEEE80211_24GHZ_BAND</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="n">IEEE_B</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">modulation</span> <span class="o">&amp;</span> <span class="n">IEEE80211_CCK_MODULATION</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">freq_band</span> <span class="o">&amp;</span> <span class="n">IEEE80211_24GHZ_BAND</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_get_hdrlen</span><span class="p">(</span><span class="n">u16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">hdrlen</span> <span class="o">=</span> <span class="n">IEEE80211_3ADDR_LEN</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">WLAN_FC_GET_TYPE</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">IEEE80211_FTYPE_DATA</span>:
		<span class="k">if</span> <span class="p">((</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">IEEE80211_FCTL_FROMDS</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">IEEE80211_FCTL_TODS</span><span class="p">))</span>
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="n">IEEE80211_4ADDR_LEN</span><span class="p">;</span> <span class="cm">/* Addr4 */</span>
		<span class="k">if</span><span class="p">(</span><span class="n">IEEE80211_QOS_HAS_SEQ</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span>
			<span class="n">hdrlen</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span> <span class="cm">/* QOS ctrl*/</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IEEE80211_FTYPE_CTL</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">WLAN_FC_GET_STYPE</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">IEEE80211_STYPE_CTS</span>:
		<span class="k">case</span> <span class="n">IEEE80211_STYPE_ACK</span>:
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="n">IEEE80211_1ADDR_LEN</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="n">IEEE80211_2ADDR_LEN</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">hdrlen</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="o">*</span><span class="nf">ieee80211_get_payload</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hdr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">ieee80211_get_hdrlen</span><span class="p">(</span><span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_ctl</span><span class="p">)))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">IEEE80211_1ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">ieee80211_hdr_1addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IEEE80211_2ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">ieee80211_hdr_2addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IEEE80211_3ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">ieee80211_hdr_3addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IEEE80211_4ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">ieee80211_hdr_4addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_ofdm_rate</span><span class="p">(</span><span class="n">u8</span> <span class="n">rate</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">IEEE80211_BASIC_RATE_MASK</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_6MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_9MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_12MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_18MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_24MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_36MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_48MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_OFDM_RATE_54MB</span>:
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_is_cck_rate</span><span class="p">(</span><span class="n">u8</span> <span class="n">rate</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">IEEE80211_BASIC_RATE_MASK</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">IEEE80211_CCK_RATE_1MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_CCK_RATE_2MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_CCK_RATE_5MB</span>:
	<span class="k">case</span> <span class="n">IEEE80211_CCK_RATE_11MB</span>:
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/* ieee80211.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">free_ieee80211</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">alloc_ieee80211</span><span class="p">(</span><span class="kt">int</span> <span class="n">sizeof_priv</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_set_encryption</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>

<span class="cm">/* ieee80211_tx.c */</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_encrypt_fragment</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">frag</span><span class="p">,</span>
	<span class="kt">int</span> <span class="n">hdr_len</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			  <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_txb_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_txb</span> <span class="o">*</span><span class="p">);</span>


<span class="cm">/* ieee80211_rx.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_rx</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">ieee80211_rx_stats</span> <span class="o">*</span><span class="n">rx_stats</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_rx_mgt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">ieee80211_hdr_4addr</span> <span class="o">*</span><span class="n">header</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">ieee80211_rx_stats</span> <span class="o">*</span><span class="n">stats</span><span class="p">);</span>

<span class="cm">/* ieee80211_wx.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_scan</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				 <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_encode</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				   <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_encode</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				   <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="cp">#if WIRELESS_EXT &gt;= 18</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_encode_ext</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			    <span class="k">union</span> <span class="n">iwreq_data</span><span class="o">*</span> <span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_encode_ext</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			    <span class="k">union</span> <span class="n">iwreq_data</span><span class="o">*</span> <span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_auth</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_param</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_mlme</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			       <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_gen_ie</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">ie</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">);</span>

<span class="cm">/* ieee80211_softmac.c */</span>
<span class="k">extern</span> <span class="kt">short</span> <span class="n">ieee80211_is_54g</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span><span class="n">net</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">short</span> <span class="n">ieee80211_is_shortslot</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span><span class="n">net</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_rx_frame_softmac</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">ieee80211_rx_stats</span> <span class="o">*</span><span class="n">rx_stats</span><span class="p">,</span> <span class="n">u16</span> <span class="n">type</span><span class="p">,</span>
			<span class="n">u16</span> <span class="n">stype</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_softmac_new_net</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span><span class="n">net</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">SendDisassociation</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">asSta</span><span class="p">,</span> <span class="n">u8</span> <span class="n">asRsn</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_softmac_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_txb</span> <span class="o">*</span><span class="n">txb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_stop_send_beacons</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">notify_wx_assoc_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_softmac_check_all_nets</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_start_bss</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_start_master_bss</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_start_ibss</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_softmac_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_softmac_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_associate_abort</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_disassociate</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_stop_scan</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_start_scan_syncro</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_check_all_nets</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_start_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_stop_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_softmac_start_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_softmac_stop_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_reset_queue</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_wake_queue</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_stop_queue</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">ieee80211_get_beacon</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_start_send_beacons</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_stop_send_beacons</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wpa_supplicant_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">iw_point</span> <span class="o">*</span><span class="n">p</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">notify_wx_assoc_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_ps_tx_ack</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="kt">short</span> <span class="n">success</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">softmac_mgmt_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>

<span class="cm">/* ieee80211_crypt_ccmp&amp;tkip&amp;wep.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_tkip_null</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_wep_null</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_ccmp_null</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* ieee80211_softmac_wx.c */</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_wap</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			    <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ext</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_wap</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			 <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			 <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">awrq</span><span class="p">,</span>
			 <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_essid</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span><span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span><span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_rate</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_rate</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_mode</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_scan</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_essid</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_mode</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_freq</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_freq</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-78"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-78">&#182;</a></div><p>extern void ieee80211<em>wx</em>sync<em>scan</em>wq(struct ieee80211_device *ieee);</p></td><td class="code"><div class="highlight"><pre><span class="k">extern</span> <span class="kt">void</span> <span class="n">ieee80211_wx_sync_scan_wq</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>


<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_rawtx</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			       <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_power</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				 <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_power</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				 <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_set_rts</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_wx_get_rts</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-79"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-79">&#182;</a></div><p>HT</p></td><td class="code"><div class="highlight"><pre><span class="cp">#define MAX_RECEIVE_BUFFER_SIZE 9100  </span><span class="c1">//</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTDebugHTCapability</span><span class="p">(</span><span class="n">u8</span><span class="o">*</span> <span class="n">CapIE</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">TitleString</span> <span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTDebugHTInfo</span><span class="p">(</span><span class="n">u8</span><span class="o">*</span>  <span class="n">InfoIE</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">TitleString</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">HTSetConnectBwMode</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">HT_CHANNEL_WIDTH</span> <span class="n">Bandwidth</span><span class="p">,</span> <span class="n">HT_EXTCHNL_OFFSET</span>    <span class="n">Offset</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTUpdateDefaultSetting</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTConstructCapabilityElement</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">posHTCap</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">len</span><span class="p">,</span> <span class="n">u8</span> <span class="n">isEncrypt</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTConstructInfoElement</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">posHTInfo</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">len</span><span class="p">,</span> <span class="n">u8</span> <span class="n">isEncrypt</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTConstructRT2RTAggElement</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">posRT2RTAgg</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">len</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTOnAssocRsp</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTInitializeHTInfo</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTInitializeBssDesc</span><span class="p">(</span><span class="n">PBSS_HT</span> <span class="n">pBssHT</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTResetSelfAndSavePeerSetting</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span> <span class="n">pNetwork</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTUpdateSelfAndPeerSetting</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span>   <span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span> <span class="n">pNetwork</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">HTGetHighestMCSRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">pMCSRateSet</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">pMCSFilter</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">MCS_FILTER_ALL</span><span class="p">[];</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">MCS_DATA_RATE</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">77</span><span class="p">]</span> <span class="p">;</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">HTCCheck</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span>   <span class="n">pFrame</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-80"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-80">&#182;</a></div><p>extern void HTSetConnectBwModeCallback(unsigned long data);</p></td><td class="code"><div class="highlight"><pre><span class="k">extern</span> <span class="kt">void</span> <span class="n">HTResetIOTSetting</span><span class="p">(</span><span class="n">PRT_HIGH_THROUGHPUT</span>  <span class="n">pHTInfo</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">bool</span> <span class="n">IsHTHalfNmodeAPs</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">HTHalfMcsToDataRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span>  <span class="n">u8</span>      <span class="n">nMcsRate</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">HTMcsToDataRate</span><span class="p">(</span> <span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">nMcsRate</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span>  <span class="n">TxCountToDataRate</span><span class="p">(</span> <span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">nDataRate</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-81"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-81">&#182;</a></div><p>function in BAPROC.c</p></td><td class="code"><div class="highlight"><pre><span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_rx_ADDBAReq</span><span class="p">(</span> <span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_rx_ADDBARsp</span><span class="p">(</span> <span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_rx_DELBA</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TsInitAddBA</span><span class="p">(</span> <span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">PTX_TS_RECORD</span>   <span class="n">pTS</span><span class="p">,</span> <span class="n">u8</span> <span class="n">Policy</span><span class="p">,</span> <span class="n">u8</span> <span class="n">bOverwritePending</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TsInitDelBA</span><span class="p">(</span> <span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">PTS_COMMON_INFO</span> <span class="n">pTsCommonInfo</span><span class="p">,</span> <span class="n">TR_SELECT</span> <span class="n">TxRxSelect</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">BaSetupTimeOut</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TxBaInactTimeout</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">RxBaInactTimeout</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ResetBaEntry</span><span class="p">(</span> <span class="n">PBA_RECORD</span> <span class="n">pBA</span><span class="p">);</span></pre></div></td></tr>


<tr id="section-82"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-82">&#182;</a></div><p>function in TS.c</p></td><td class="code"><div class="highlight"><pre><span class="k">extern</span> <span class="n">bool</span> <span class="n">GetTs</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span>        <span class="n">ieee</span><span class="p">,</span>
	<span class="n">PTS_COMMON_INFO</span>                 <span class="o">*</span><span class="n">ppTS</span><span class="p">,</span>
	<span class="n">u8</span><span class="o">*</span>                             <span class="n">Addr</span><span class="p">,</span>
	<span class="n">u8</span>                              <span class="n">TID</span><span class="p">,</span>
	<span class="n">TR_SELECT</span>                       <span class="n">TxRxSelect</span><span class="p">,</span>  <span class="c1">//Rx:1, Tx:0</span>
	<span class="n">bool</span>                            <span class="n">bAddNewTs</span>
	<span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TSInitialize</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span>  <span class="kt">void</span> <span class="n">TsStartAddBaProcess</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">PTX_TS_RECORD</span>   <span class="n">pTxTS</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">RemovePeerTS</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">Addr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">RemoveAllTS</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span><span class="o">*</span> <span class="n">ieee</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ieee80211_softmac_scan_syncro</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>

<span class="k">extern</span> <span class="k">const</span> <span class="kt">long</span> <span class="n">ieee80211_wlan_frequencies</span><span class="p">[];</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ieee80211_increment_scans</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ieee</span><span class="o">-&gt;</span><span class="n">scans</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ieee80211_get_scans</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">ieee</span><span class="o">-&gt;</span><span class="n">scans</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">escape_essid</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">essid</span><span class="p">,</span> <span class="n">u8</span> <span class="n">essid_len</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">static</span> <span class="kt">char</span> <span class="n">escaped</span><span class="p">[</span><span class="n">IW_ESSID_MAX_SIZE</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">essid</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="n">escaped</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ieee80211_is_empty_essid</span><span class="p">(</span><span class="n">essid</span><span class="p">,</span> <span class="n">essid_len</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">escaped</span><span class="p">,</span> <span class="s">&quot;&lt;hidden&gt;&quot;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="s">&quot;&lt;hidden&gt;&quot;</span><span class="p">));</span>
		<span class="k">return</span> <span class="n">escaped</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">essid_len</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">essid_len</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">IW_ESSID_MAX_SIZE</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">essid_len</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
			<span class="o">*</span><span class="n">d</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;\\&#39;</span><span class="p">;</span>
			<span class="o">*</span><span class="n">d</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
			<span class="n">s</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="o">*</span><span class="n">d</span><span class="o">++</span> <span class="o">=</span> <span class="o">*</span><span class="n">s</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">escaped</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* For the function is more related to hardware setting, it&#39;s better to use the</span>
<span class="cm"> * ieee handler to refer to it.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">short</span> <span class="n">check_nic_enough_desc</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">queue_index</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_data_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ieee80211_parse_info_param</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">ieee80211_info_element</span> <span class="o">*</span><span class="n">info_element</span><span class="p">,</span>
		<span class="n">u16</span> <span class="n">length</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">ieee80211_network</span> <span class="o">*</span><span class="n">network</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">ieee80211_rx_stats</span> <span class="o">*</span><span class="n">stats</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ieee80211_indicate_packets</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_rxb</span><span class="o">**</span> <span class="n">prxbIndicateArray</span><span class="p">,</span><span class="n">u8</span>  <span class="n">index</span><span class="p">);</span>
<span class="cp">#define RT_ASOC_RETRY_LIMIT	5</span>
<span class="cp">#endif </span><span class="cm">/* IEEE80211_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
