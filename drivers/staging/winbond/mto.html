<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › winbond › mto.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>mto.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * ==================================================================</span>
<span class="cm"> * MTO.H</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2003 Winbond Electronics Corp. All rights reserved.</span>
<span class="cm"> * ==================================================================</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __MTO_H__</span>
<span class="cp">#define __MTO_H__</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="k">struct</span> <span class="n">wbsoft_priv</span><span class="p">;</span>

<span class="cp">#define MTO_PREAMBLE_LONG               WLAN_PREAMBLE_TYPE_LONG</span>
<span class="cp">#define MTO_PREAMBLE_SHORT              WLAN_PREAMBLE_TYPE_SHORT</span>

<span class="cm">/* Defines the parameters used in the MAC Throughput Optimization algorithm */</span>
<span class="k">struct</span> <span class="n">wb35_mto_params</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">TxFlowCount</span><span class="p">;</span> <span class="cm">/* to judge what kind the tx flow(sparse or busy) is */</span>

	<span class="cm">/* --------- DTO threshold parameters ------------- */</span>
	<span class="n">u16</span>	<span class="n">DTO_PeriodicCheckCycle</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">DTO_RssiThForAntDiv</span><span class="p">;</span>

	<span class="n">u16</span>	<span class="n">DTO_TxCountThForCalcNewRate</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">DTO_TxRateIncTh</span><span class="p">;</span>

	<span class="n">u16</span>	<span class="n">DTO_TxRateDecTh</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">DTO_TxRateEqTh</span><span class="p">;</span>

	<span class="n">u16</span>	<span class="n">DTO_TxRateBackOff</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">DTO_TxRetryRateReduce</span><span class="p">;</span>

	<span class="n">u16</span>	<span class="n">DTO_TxPowerIndex</span><span class="p">;</span>		<span class="cm">/* 0 ~ 31 */</span>
	<span class="n">u16</span>	<span class="n">reserved_1</span><span class="p">;</span>
	<span class="cm">/* ------------------------------------------------ */</span>

	<span class="n">u8</span>	<span class="n">PowerChangeEnable</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">AntDiversityEnable</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">CCA_Mode</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">CCA_Mode_Setup</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">Preamble_Type</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">PreambleChangeEnable</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">DataRateLevel</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">DataRateChangeEnable</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">FragThresholdLevel</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">FragThresholdChangeEnable</span><span class="p">;</span>

	<span class="n">u16</span>	<span class="n">RTSThreshold</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">RTSThreshold_Setup</span><span class="p">;</span>

	<span class="n">u32</span>	<span class="n">AvgIdleSlot</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">Pr_Interf</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">AvgGapBtwnInterf</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">RTSChangeEnable</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">Ant_sel</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">aging_timeout</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">reserved_2</span><span class="p">;</span>

	<span class="n">u32</span>	<span class="n">Cnt_Ant</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">SQ_Ant</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

	<span class="n">u8</span>	<span class="n">FallbackRateLevel</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">OfdmRateLevel</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">RatePolicy</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">reserved_3</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

	<span class="cm">/* For RSSI turning */</span>
	<span class="n">s32</span>	<span class="n">RSSI_high</span><span class="p">;</span>
	<span class="n">s32</span>	<span class="n">RSSI_low</span><span class="p">;</span>
<span class="p">};</span>


<span class="cp">#define MTO_DATA()		(adapter-&gt;sMtoPara)</span>
<span class="cp">#define MTO_HAL()		(&amp;adapter-&gt;sHwData)</span>
<span class="cp">#define MTO_SET_PREAMBLE_TYPE(x) </span><span class="cm">/* Turbo mark LM_PREAMBLE_TYPE(&amp;pcore_data-&gt;lm_data) = (x) */</span><span class="cp"></span>
<span class="cp">#define MTO_ENABLE		(adapter-&gt;sLocalPara.TxRateMode == RATE_AUTO)</span>
<span class="cp">#define MTO_TXPOWER_FROM_EEPROM	(adapter-&gt;sHwData.PowerIndexFromEEPROM)</span>
<span class="cp">#define LOCAL_ANTENNA_NO()	(adapter-&gt;sLocalPara.bAntennaNo)</span>
<span class="cp">#define LOCAL_IS_CONNECTED()	(adapter-&gt;sLocalPara.wConnectedSTAindex != 0)</span>
<span class="cp">#define MTO_INITTXRATE_MODE	(adapter-&gt;sHwData.SoftwareSet&amp;0x2) </span><span class="cm">/* bit 1 */</span><span class="cp"></span>

<span class="cp">#define MTO_POWER_CHANGE_ENABLE()	MTO_DATA().PowerChangeEnable</span>
<span class="cp">#define MTO_CCA_MODE()			MTO_DATA().CCA_Mode</span>
<span class="cp">#define MTO_CCA_MODE_SETUP()		MTO_DATA().CCA_Mode_Setup</span>
<span class="cp">#define MTO_PREAMBLE_TYPE()		MTO_DATA().Preamble_Type</span>
<span class="cp">#define MTO_PREAMBLE_CHANGE_ENABLE()	MTO_DATA().PreambleChangeEnable</span>

<span class="cp">#define MTO_RATE_LEVEL()		MTO_DATA().DataRateLevel</span>
<span class="cp">#define MTO_OFDM_RATE_LEVEL()		MTO_DATA().OfdmRateLevel</span>
<span class="cp">#define MTO_RATE_CHANGE_ENABLE()	MTO_DATA().DataRateChangeEnable</span>
<span class="cp">#define MTO_FRAG_TH_LEVEL()		MTO_DATA().FragThresholdLevel</span>
<span class="cp">#define MTO_FRAG_CHANGE_ENABLE()	MTO_DATA().FragThresholdChangeEnable</span>
<span class="cp">#define MTO_RTS_THRESHOLD()		MTO_DATA().RTSThreshold</span>
<span class="cp">#define MTO_RTS_CHANGE_ENABLE()		MTO_DATA().RTSChangeEnable</span>
<span class="cp">#define MTO_RTS_THRESHOLD_SETUP()	MTO_DATA().RTSThreshold_Setup</span>

<span class="cp">#define MTO_AVG_IDLE_SLOT()		MTO_DATA().AvgIdleSlot</span>
<span class="cp">#define MTO_PR_INTERF()			MTO_DATA().Pr_Interf</span>
<span class="cp">#define MTO_AVG_GAP_BTWN_INTERF()	MTO_DATA().AvgGapBtwnInterf</span>

<span class="cp">#define MTO_CNT_ANT(x)			MTO_DATA().Cnt_Ant[(x)]</span>
<span class="cp">#define MTO_SQ_ANT(x)			MTO_DATA().SQ_Ant[(x)]</span>
<span class="cp">#define MTO_AGING_TIMEOUT()		MTO_DATA().aging_timeout</span>

<span class="cp">#define MTO_TXFLOWCOUNT()		MTO_DATA().TxFlowCount</span>

<span class="cm">/* --------- DTO threshold parameters ------------- */</span>
<span class="cp">#define	MTOPARA_PERIODIC_CHECK_CYCLE()		MTO_DATA().DTO_PeriodicCheckCycle</span>
<span class="cp">#define	MTOPARA_RSSI_TH_FOR_ANTDIV()		MTO_DATA().DTO_RssiThForAntDiv</span>
<span class="cp">#define	MTOPARA_TXCOUNT_TH_FOR_CALC_RATE()	MTO_DATA().DTO_TxCountThForCalcNewRate</span>
<span class="cp">#define	MTOPARA_TXRATE_INC_TH()			MTO_DATA().DTO_TxRateIncTh</span>
<span class="cp">#define	MTOPARA_TXRATE_DEC_TH()			MTO_DATA().DTO_TxRateDecTh</span>
<span class="cp">#define MTOPARA_TXRATE_EQ_TH()			MTO_DATA().DTO_TxRateEqTh</span>
<span class="cp">#define	MTOPARA_TXRATE_BACKOFF()		MTO_DATA().DTO_TxRateBackOff</span>
<span class="cp">#define	MTOPARA_TXRETRYRATE_REDUCE()		MTO_DATA().DTO_TxRetryRateReduce</span>
<span class="cp">#define MTOPARA_TXPOWER_INDEX()			MTO_DATA().DTO_TxPowerIndex</span>
<span class="cm">/* ------------------------------------------------ */</span>


<span class="k">extern</span> <span class="n">u16</span> <span class="n">MTO_Frag_Th_Tbl</span><span class="p">[];</span>

<span class="cp">#define MTO_DATA_RATE()			MTO_Data_Rate_Tbl[MTO_RATE_LEVEL()]</span>
<span class="cp">#define MTO_FRAG_TH()			MTO_Frag_Th_Tbl[MTO_FRAG_TH_LEVEL()]</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">MTO_Init</span><span class="p">(</span><span class="k">struct</span> <span class="n">wbsoft_priv</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">MTO_PeriodicTimerExpired</span><span class="p">(</span><span class="k">struct</span> <span class="n">wbsoft_priv</span> <span class="o">*</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">MTO_SetDTORateRange</span><span class="p">(</span><span class="k">struct</span> <span class="n">wbsoft_priv</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="p">,</span> <span class="n">u8</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">MTO_GetTxRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">wbsoft_priv</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span> <span class="n">u32</span> <span class="n">fpdu_len</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">MTO_GetTxFallbackRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">wbsoft_priv</span> <span class="o">*</span><span class="n">adapter</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">MTO_SetTxCount</span><span class="p">(</span><span class="k">struct</span> <span class="n">wbsoft_priv</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span> <span class="n">u8</span> <span class="n">t0</span><span class="p">,</span> <span class="n">u8</span> <span class="n">index</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __MTO_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
