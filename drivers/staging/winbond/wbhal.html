<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › winbond › wbhal.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>wbhal.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef __WINBOND_WBHAL_S_H</span>
<span class="cp">#define __WINBOND_WBHAL_S_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/if_ether.h&gt; </span><span class="cm">/* for ETH_ALEN */</span><span class="cp"></span>

<span class="cp">#define HAL_LED_SET_MASK	0x001c</span>
<span class="cp">#define HAL_LED_SET_SHIFT	2</span>

<span class="cm">/* supported RF type */</span>
<span class="cp">#define RF_MAXIM_2825		0</span>
<span class="cp">#define RF_MAXIM_2827		1</span>
<span class="cp">#define RF_MAXIM_2828		2</span>
<span class="cp">#define RF_MAXIM_2829		3</span>
<span class="cp">#define RF_MAXIM_V1		15</span>
<span class="cp">#define RF_AIROHA_2230		16</span>
<span class="cp">#define RF_AIROHA_7230		17</span>
<span class="cp">#define RF_AIROHA_2230S		18</span>
<span class="cp">#define RF_WB_242		33</span>
<span class="cp">#define RF_WB_242_1		34</span>
<span class="cp">#define RF_DECIDE_BY_INF	255</span>

<span class="cm">/*</span>
<span class="cm"> * ----------------------------------------------------------------</span>
<span class="cm"> * The follow define connect to upper layer</span>
<span class="cm"> *	User must modify for connection between HAL and upper layer</span>
<span class="cm"> * ----------------------------------------------------------------</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * ==============================</span>
<span class="cm"> * Common define</span>
<span class="cm"> * ==============================</span>
<span class="cm"> */</span>
<span class="cm">/* Bit 5 */</span>
<span class="cp">#define HAL_USB_MODE_BURST(_H)			(_H-&gt;SoftwareSet &amp; 0x20)</span>

<span class="cm">/* Scan interval */</span>
<span class="cp">#define SCAN_MAX_CHNL_TIME			(50)</span>

<span class="cm">/* For TxL2 Frame typr recognise */</span>
<span class="cp">#define FRAME_TYPE_802_3_DATA			0</span>
<span class="cp">#define FRAME_TYPE_802_11_MANAGEMENT		1</span>
<span class="cp">#define FRAME_TYPE_802_11_MANAGEMENT_CHALLENGE	2</span>
<span class="cp">#define FRAME_TYPE_802_11_CONTROL		3</span>
<span class="cp">#define FRAME_TYPE_802_11_DATA			4</span>
<span class="cp">#define FRAME_TYPE_PROMISCUOUS			5</span>

<span class="cm">/* The follow definition is used for convert the frame------------ */</span>
<span class="cp">#define DOT_11_SEQUENCE_OFFSET			22 </span><span class="cm">/* Sequence control offset */</span><span class="cp"></span>
<span class="cp">#define DOT_3_TYPE_OFFSET			12</span>
<span class="cp">#define DOT_11_MAC_HEADER_SIZE			24</span>
<span class="cp">#define DOT_11_SNAP_SIZE			6</span>
<span class="cp">#define DOT_11_TYPE_OFFSET			30 </span><span class="cm">/* The start offset of 802.11 Frame. Type encapsulation. */</span><span class="cp"></span>
<span class="cp">#define DEFAULT_SIFSTIME			10</span>
<span class="cp">#define DEFAULT_FRAGMENT_THRESHOLD		2346 </span><span class="cm">/* No fragment */</span><span class="cp"></span>
<span class="cp">#define DEFAULT_MSDU_LIFE_TIME			0xffff</span>

<span class="cp">#define LONG_PREAMBLE_PLUS_PLCPHEADER_TIME		(144 + 48)</span>
<span class="cp">#define SHORT_PREAMBLE_PLUS_PLCPHEADER_TIME		(72 + 24)</span>
<span class="cp">#define PREAMBLE_PLUS_SIGNAL_PLUS_SIGNALEXTENSION	(16 + 4 + 6)</span>
<span class="cp">#define Tsym						4</span>

<span class="cm">/*  Frame Type of Bits (2, 3)----------------------------------- */</span>
<span class="cp">#define MAC_TYPE_MANAGEMENT			0x00</span>
<span class="cp">#define MAC_TYPE_CONTROL			0x04</span>
<span class="cp">#define MAC_TYPE_DATA				0x08</span>
<span class="cp">#define MASK_FRAGMENT_NUMBER			0x000F</span>
<span class="cp">#define SEQUENCE_NUMBER_SHIFT			4</span>

<span class="cp">#define  HAL_WOL_TYPE_WAKEUP_FRAME		0x01</span>
<span class="cp">#define  HAL_WOL_TYPE_MAGIC_PACKET		0x02</span>

<span class="cp">#define HAL_KEYTYPE_WEP40			0</span>
<span class="cp">#define HAL_KEYTYPE_WEP104			1</span>
<span class="cp">#define HAL_KEYTYPE_TKIP			2 </span><span class="cm">/* 128 bit key */</span><span class="cp"></span>
<span class="cp">#define HAL_KEYTYPE_AES_CCMP			3 </span><span class="cm">/* 128 bit key */</span><span class="cp"></span>

<span class="cm">/* For VM state */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">VM_STOP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">VM_RUNNING</span><span class="p">,</span>
	<span class="n">VM_COMPLETED</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * ================================</span>
<span class="cm"> * Normal Key table format</span>
<span class="cm"> * ================================</span>
<span class="cm"> */</span>

<span class="cm">/* The order of KEY index is MAPPING_KEY_START_INDEX &gt; GROUP_KEY_START_INDEX */</span>
<span class="cp">#define MAX_KEY_TABLE			24 </span><span class="cm">/* 24 entry for storing key data */</span><span class="cp"></span>
<span class="cp">#define GROUP_KEY_START_INDEX		4</span>
<span class="cp">#define MAPPING_KEY_START_INDEX		8</span>

<span class="cm">/*</span>
<span class="cm"> * =========================================</span>
<span class="cm"> * Descriptor</span>
<span class="cm"> * =========================================</span>
<span class="cm"> */</span>
<span class="cp">#define MAX_DESCRIPTOR_BUFFER_INDEX	8 </span><span class="cm">/* Have to multiple of 2 */</span><span class="cp"></span>
<span class="cp">#define FLAG_ERROR_TX_MASK		0x000000bf</span>
<span class="cp">#define FLAG_ERROR_RX_MASK		0x0000083f</span>

<span class="cp">#define FLAG_BAND_RX_MASK		0x10000000 </span><span class="cm">/* Bit 28 */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">R00_descriptor</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span>	<span class="n">value</span><span class="p">;</span>
<span class="cp">#ifdef _BIG_ENDIAN_</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">R00_packet_or_buffer_status</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_packet_in_fifo</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_RESERVED</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_receive_byte_count</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_receive_time_index</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#else</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">R00_receive_time_index</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_receive_byte_count</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_RESERVED</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_packet_in_fifo</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R00_packet_or_buffer_status</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#endif</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">T00_descriptor</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span>	<span class="n">value</span><span class="p">;</span>
<span class="cp">#ifdef _BIG_ENDIAN_</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">T00_first_mpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* for hardware use */</span>
			<span class="n">u32</span>	<span class="n">T00_last_mpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* for hardware use */</span>
			<span class="n">u32</span>	<span class="n">T00_IsLastMpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span><span class="cm">/* 0:not 1:Yes for software used */</span>
			<span class="n">u32</span>	<span class="n">T00_IgnoreResult</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span><span class="cm">/* The same mechanism with T00 setting. */</span>
			<span class="n">u32</span>	<span class="n">T00_RESERVED_ID</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span><span class="cm">/* 3 bit ID reserved */</span>
			<span class="n">u32</span>	<span class="n">T00_tx_packet_id</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T00_RESERVED</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T00_header_length</span><span class="o">:</span><span class="mi">6</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T00_frame_length</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#else</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">T00_frame_length</span><span class="o">:</span><span class="mi">12</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T00_header_length</span><span class="o">:</span><span class="mi">6</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T00_RESERVED</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T00_tx_packet_id</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T00_RESERVED_ID</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span> <span class="cm">/* 3 bit ID reserved */</span>
			<span class="n">u32</span>	<span class="n">T00_IgnoreResult</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* The same mechanism with T00 setting. */</span>
			<span class="n">u32</span>	<span class="n">T00_IsLastMpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* 0:not 1:Yes for software used */</span>
			<span class="n">u32</span>	<span class="n">T00_last_mpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* for hardware use */</span>
			<span class="n">u32</span>	<span class="n">T00_first_mpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* for hardware use */</span>
		<span class="p">};</span>
<span class="cp">#endif</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">R01_descriptor</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span>	<span class="n">value</span><span class="p">;</span>
<span class="cp">#ifdef _BIG_ENDIAN_</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">R01_RESERVED</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_mod_type</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_pre_type</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_data_rate</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_AGC_state</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_LNA_state</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_decryption_method</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_mic_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_replay</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_broadcast_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_multicast_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_directed_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_receive_frame_antenna_selection</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_frame_receive_during_atim_window</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_protocol_version_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_authentication_frame_icv_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_null_key_to_authentication_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_icv_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_crc_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#else</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">R01_crc_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_icv_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_null_key_to_authentication_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_authentication_frame_icv_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_protocol_version_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_frame_receive_during_atim_window</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_receive_frame_antenna_selection</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_directed_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_multicast_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_broadcast_frame</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_replay</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_mic_error</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_decryption_method</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_LNA_state</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_AGC_state</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_data_rate</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_pre_type</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_mod_type</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">R01_RESERVED</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#endif</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">T01_descriptor</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span>	<span class="n">value</span><span class="p">;</span>
<span class="cp">#ifdef _BIG_ENDIAN_</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">T01_rts_cts_duration</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_fall_back_rate</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_add_rts</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_add_cts</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_modulation_type</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_plcp_header_length</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_transmit_rate</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_wep_id</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_add_challenge_text</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_inhibit_crc</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_loop_back_wep_mode</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_retry_abort_ebable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#else</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">T01_retry_abort_ebable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_loop_back_wep_mode</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_inhibit_crc</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_add_challenge_text</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_wep_id</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_transmit_rate</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_plcp_header_length</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_modulation_type</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_add_cts</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_add_rts</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_fall_back_rate</span><span class="o">:</span><span class="mi">3</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T01_rts_cts_duration</span><span class="o">:</span><span class="mi">16</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#endif</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">T02_descriptor</span> <span class="p">{</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span>	<span class="n">value</span><span class="p">;</span>
<span class="cp">#ifdef _BIG_ENDIAN_</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">T02_IsLastMpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* The same mechanism with T00 setting */</span>
			<span class="n">u32</span>	<span class="n">T02_IgnoreResult</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* The same mechanism with T00 setting. */</span>
			<span class="n">u32</span>	<span class="n">T02_RESERVED_ID</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span> <span class="cm">/* The same mechanism with T00 setting */</span>
			<span class="n">u32</span>	<span class="n">T02_Tx_PktID</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_MPDU_Cnt</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_RTS_Cnt</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_RESERVED</span><span class="o">:</span><span class="mi">7</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_complete</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_abort_due_to_TBTT</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_effective_transmission_rate</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_without_encryption_due_to_wep_on_false</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_discard_due_to_null_wep_key</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_RESERVED_1</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_out_of_MaxTxMSDULiftTime</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_abort</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_fail</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">};</span>
<span class="cp">#else</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_fail</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_abort</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_out_of_MaxTxMSDULiftTime</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_RESERVED_1</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_discard_due_to_null_wep_key</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_without_encryption_due_to_wep_on_false</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_effective_transmission_rate</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_abort_due_to_TBTT</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_transmit_complete</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_RESERVED</span><span class="o">:</span><span class="mi">7</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_RTS_Cnt</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_MPDU_Cnt</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_Tx_PktID</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
			<span class="n">u32</span>	<span class="n">T02_RESERVED_ID</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span> <span class="cm">/* The same mechanism with T00 setting */</span>
			<span class="n">u32</span>	<span class="n">T02_IgnoreResult</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* The same mechanism with T00 setting. */</span>
			<span class="n">u32</span>	<span class="n">T02_IsLastMpdu</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span> <span class="cm">/* The same mechanism with T00 setting */</span>
		<span class="p">};</span>
<span class="cp">#endif</span>
	<span class="p">};</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">wb35_descriptor</span> <span class="p">{</span> <span class="cm">/* Skip length = 8 DWORD */</span>
	<span class="cm">/* ID for descriptor ---, The field doesn&#39;t be cleard in the operation of Descriptor definition */</span>
	<span class="n">u8</span>	<span class="n">Descriptor_ID</span><span class="p">;</span>
	<span class="cm">/* ----------------------The above region doesn&#39;t be cleared by DESCRIPTOR_RESET------ */</span>
	<span class="n">u8</span>	<span class="n">RESERVED</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

	<span class="n">u16</span>	<span class="n">FragmentThreshold</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">InternalUsed</span><span class="p">;</span> <span class="cm">/* Only can be used by operation of descriptor definition */</span>
	<span class="n">u8</span>	<span class="n">Type</span><span class="p">;</span> <span class="cm">/* 0: 802.3 1:802.11 data frame 2:802.11 management frame */</span>

	<span class="n">u8</span>	<span class="n">PreambleMode</span><span class="p">;</span><span class="cm">/* 0: short 1:long */</span>
	<span class="n">u8</span>	<span class="n">TxRate</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">FragmentCount</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">EapFix</span><span class="p">;</span> <span class="cm">/* For speed up key install */</span>

	<span class="cm">/* For R00 and T00 ------------------------------ */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">R00_descriptor</span>	<span class="n">R00</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">T00_descriptor</span>	<span class="n">T00</span><span class="p">;</span>
	<span class="p">};</span>

	<span class="cm">/* For R01 and T01 ------------------------------ */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">R01_descriptor</span>	<span class="n">R01</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">T01_descriptor</span>	<span class="n">T01</span><span class="p">;</span>
	<span class="p">};</span>

	<span class="cm">/* For R02 and T02 ------------------------------ */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span>		<span class="n">R02</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">T02_descriptor</span>	<span class="n">T02</span><span class="p">;</span>
	<span class="p">};</span>

	<span class="cm">/* For R03 and T03 ------------------------------ */</span>
	<span class="cm">/* For software used */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span>	<span class="n">R03</span><span class="p">;</span>
		<span class="n">u32</span>	<span class="n">T03</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span>	<span class="n">buffer_number</span><span class="p">;</span>
			<span class="n">u8</span>	<span class="n">buffer_start_index</span><span class="p">;</span>
			<span class="n">u16</span>	<span class="n">buffer_total_size</span><span class="p">;</span>
		<span class="p">};</span>
	<span class="p">};</span>

	<span class="cm">/* For storing the buffer */</span>
	<span class="n">u16</span>	<span class="n">buffer_size</span><span class="p">[</span><span class="n">MAX_DESCRIPTOR_BUFFER_INDEX</span><span class="p">];</span>
	<span class="kt">void</span>	<span class="o">*</span><span class="n">buffer_address</span><span class="p">[</span><span class="n">MAX_DESCRIPTOR_BUFFER_INDEX</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define MAX_TXVGA_EEPROM		9	</span><span class="cm">/* How many word(u16) of EEPROM will be used for TxVGA */</span><span class="cp"></span>
<span class="cp">#define MAX_RF_PARAMETER		32</span>

<span class="k">struct</span> <span class="n">txvga_for_50</span> <span class="p">{</span>
	<span class="n">u8</span>	<span class="n">ChanNo</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">TxVgaValue</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * ==============================================</span>
<span class="cm"> * Device related include</span>
<span class="cm"> * ==============================================</span>
<span class="cm"> */</span>

<span class="cp">#include &quot;wb35reg_s.h&quot;</span>
<span class="cp">#include &quot;wb35tx_s.h&quot;</span>
<span class="cp">#include &quot;wb35rx_s.h&quot;</span>

<span class="cm">/* For Hal using ============================================ */</span>
<span class="k">struct</span> <span class="n">hw_data</span> <span class="p">{</span>
	<span class="cm">/* For compatible with 33 */</span>
	<span class="n">u32</span>	<span class="n">revision</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">BB3c_cal</span><span class="p">;</span> <span class="cm">/* The value for Tx calibration comes from EEPROM */</span>
	<span class="n">u32</span>	<span class="n">BB54_cal</span><span class="p">;</span> <span class="cm">/* The value for Rx calibration comes from EEPROM */</span>

	<span class="cm">/* For surprise remove */</span>
	<span class="n">u32</span>	<span class="n">SurpriseRemove</span><span class="p">;</span> <span class="cm">/* 0: Normal 1: Surprise remove */</span>
	<span class="n">u8</span>	<span class="n">IsKeyPreSet</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">CalOneTime</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">VCO_trim</span><span class="p">;</span>

	<span class="n">u32</span>	<span class="n">FragCount</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">DMAFix</span><span class="p">;</span> <span class="cm">/* V1_DMA_FIX The variable can be removed if driver want to save mem space for V2. */</span>

	<span class="cm">/*</span>
<span class="cm">	 * ===============================================</span>
<span class="cm">	 * Definition for MAC address</span>
<span class="cm">	 * ===============================================</span>
<span class="cm">	 */</span>
	<span class="n">u8</span>	<span class="n">PermanentMacAddress</span><span class="p">[</span><span class="n">ETH_ALEN</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span> <span class="cm">/* The Ethernet addr that are stored in EEPROM. + 2 to 8-byte alignment */</span>
	<span class="n">u8</span>	<span class="n">CurrentMacAddress</span><span class="p">[</span><span class="n">ETH_ALEN</span> <span class="o">+</span> <span class="mi">2</span><span class="p">];</span> <span class="cm">/* The Enthernet addr that are in used. + 2 to 8-byte alignment */</span>

	<span class="cm">/*</span>
<span class="cm">	 * =========================================</span>
<span class="cm">	 * Definition for 802.11</span>
<span class="cm">	 * =========================================</span>
<span class="cm">	 */</span>
	<span class="n">u8</span>	<span class="o">*</span><span class="n">bssid_pointer</span><span class="p">;</span> <span class="cm">/* Used by hal_get_bssid for return value */</span>
	<span class="n">u8</span>	<span class="n">bssid</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="cm">/* Only 6 byte will be used. 8 byte is required for read buffer */</span>
	<span class="n">u8</span>	<span class="n">ssid</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span> <span class="cm">/* maximum ssid length is 32 byte */</span>

	<span class="n">u16</span>	<span class="n">AID</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">ssid_length</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">Channel</span><span class="p">;</span>

	<span class="n">u16</span>	<span class="n">ListenInterval</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">CapabilityInformation</span><span class="p">;</span>

	<span class="n">u16</span>	<span class="n">BeaconPeriod</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">ProbeDelay</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">bss_type</span><span class="p">;</span><span class="cm">/* 0: IBSS_NET or 1:ESS_NET */</span>
	<span class="n">u8</span>	<span class="n">preamble</span><span class="p">;</span><span class="cm">/* 0: short preamble, 1: long preamble */</span>
	<span class="n">u8</span>	<span class="n">slot_time_select</span><span class="p">;</span> <span class="cm">/* 9 or 20 value */</span>
	<span class="n">u8</span>	<span class="n">phy_type</span><span class="p">;</span> <span class="cm">/* Phy select */</span>

	<span class="n">u32</span>	<span class="n">phy_para</span><span class="p">[</span><span class="n">MAX_RF_PARAMETER</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">phy_number</span><span class="p">;</span>

	<span class="n">u32</span>	<span class="n">CurrentRadioSw</span><span class="p">;</span> <span class="cm">/* 0:On 1:Off */</span>
	<span class="n">u32</span>	<span class="n">CurrentRadioHw</span><span class="p">;</span> <span class="cm">/* 0:On 1:Off */</span>

	<span class="n">u8</span>	<span class="o">*</span><span class="n">power_save_point</span><span class="p">;</span> <span class="cm">/* Used by hal_get_power_save_mode for return value */</span>
	<span class="n">u8</span>	<span class="n">cwmin</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">desired_power_save</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">dtim</span><span class="p">;</span> <span class="cm">/* Is running dtim */</span>
	<span class="n">u8</span>	<span class="n">mapping_key_replace_index</span><span class="p">;</span> <span class="cm">/* In Key table, the next index be replaced */</span>

	<span class="n">u16</span>	<span class="n">MaxReceiveLifeTime</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">FragmentThreshold</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">FragmentThreshold_tmp</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">cwmax</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">Key_slot</span><span class="p">[</span><span class="n">MAX_KEY_TABLE</span><span class="p">][</span><span class="mi">8</span><span class="p">];</span> <span class="cm">/* Ownership record for key slot. For Alignment */</span>
	<span class="n">u32</span>	<span class="n">Key_content</span><span class="p">[</span><span class="n">MAX_KEY_TABLE</span><span class="p">][</span><span class="mi">12</span><span class="p">];</span> <span class="cm">/* 10DW for each entry + 2 for burst command (Off and On valid bit) */</span>
	<span class="n">u8</span>	<span class="n">CurrentDefaultKeyIndex</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">CurrentDefaultKeyLength</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * ==================================================</span>
<span class="cm">	 * Variable for each module</span>
<span class="cm">	 * ==================================================</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">usb_device</span>	<span class="o">*</span><span class="n">udev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wb35_reg</span>		<span class="n">reg</span><span class="p">;</span>	<span class="cm">/* Need Wb35Reg.h */</span>
	<span class="k">struct</span> <span class="n">wb35_tx</span>		<span class="n">Wb35Tx</span><span class="p">;</span> <span class="cm">/* Need Wb35Tx.h */</span>
	<span class="k">struct</span> <span class="n">wb35_rx</span>		<span class="n">Wb35Rx</span><span class="p">;</span> <span class="cm">/* Need Wb35Rx.h */</span>

	<span class="k">struct</span> <span class="n">timer_list</span>	<span class="n">LEDTimer</span><span class="p">;</span> <span class="cm">/* For LED */</span>

	<span class="n">u32</span>			<span class="n">LEDpoint</span><span class="p">;</span> <span class="cm">/* For LED */</span>

	<span class="n">u32</span>			<span class="n">dto_tx_retry_count</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">dto_tx_frag_count</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">rx_ok_count</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span> <span class="cm">/* index=0: total rx ok */</span>
	<span class="n">u32</span>			<span class="n">rx_err_count</span><span class="p">[</span><span class="mi">13</span><span class="p">];</span> <span class="cm">/* index=0: total rx err */</span>

	<span class="cm">/* for Tx debug */</span>
	<span class="n">u32</span>			<span class="n">tx_TBTT_start_count</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">tx_ETR_count</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">tx_WepOn_false_count</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">tx_Null_key_count</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">tx_retry_count</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>

	<span class="n">u8</span>			<span class="n">PowerIndexFromEEPROM</span><span class="p">;</span> <span class="cm">/* For 2412MHz */</span>
	<span class="n">u8</span>			<span class="n">power_index</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">IsWaitJoinComplete</span><span class="p">;</span> <span class="cm">/* TRUE: set join request */</span>
	<span class="n">u8</span>			<span class="n">band</span><span class="p">;</span>

	<span class="n">u16</span>			<span class="n">SoftwareSet</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="n">Reserved_s</span><span class="p">;</span>

	<span class="n">u32</span>			<span class="n">IsInitOK</span><span class="p">;</span> <span class="cm">/* 0: Driver starting 1: Driver init OK */</span>

	<span class="cm">/* For Phy calibration */</span>
	<span class="n">s32</span>			<span class="n">iq_rsdl_gain_tx_d2</span><span class="p">;</span>
	<span class="n">s32</span>			<span class="n">iq_rsdl_phase_tx_d2</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">txvga_setting_for_cal</span><span class="p">;</span>

	<span class="n">u8</span>			<span class="n">TxVgaSettingInEEPROM</span><span class="p">[(((</span><span class="n">MAX_TXVGA_EEPROM</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x03</span><span class="p">)];</span> <span class="cm">/* For EEPROM value */</span>
	<span class="n">u8</span>			<span class="n">TxVgaFor24</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span> <span class="cm">/* Max is 14, 2 for alignment */</span>
	<span class="k">struct</span> <span class="n">txvga_for_50</span>		<span class="n">TxVgaFor50</span><span class="p">[</span><span class="mi">36</span><span class="p">];</span>	<span class="cm">/* 35 channels in 5G. 35x2 = 70 byte. 2 for alignments */</span>

	<span class="n">u16</span>			<span class="n">Scan_Interval</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="n">RESERVED6</span><span class="p">;</span>

	<span class="cm">/* LED control */</span>
	<span class="n">u32</span>		<span class="n">LED_control</span><span class="p">;</span>
	<span class="cm">/*</span>
<span class="cm">	 * LED_control 4 byte: Gray_Led_1[3] Gray_Led_0[2] Led[1] Led[0]</span>
<span class="cm">	 * Gray_Led</span>
<span class="cm">	 *		For Led gray setting</span>
<span class="cm">	 * Led</span>
<span class="cm">	 *		0: normal control,</span>
<span class="cm">	 *			LED behavior will decide by EEPROM setting</span>
<span class="cm">	 *		1: Turn off specific LED</span>
<span class="cm">	 *		2: Always on specific LED</span>
<span class="cm">	 *		3: slow blinking specific LED</span>
<span class="cm">	 *		4: fast blinking specific LED</span>
<span class="cm">	 *		5: WPS led control is set. Led0 is Red, Led1 id Green</span>
<span class="cm">	 *</span>
<span class="cm">	 * Led[1] is parameter for WPS LED mode</span>
<span class="cm">	 *		1:InProgress</span>
<span class="cm">	 *		2: Error</span>
<span class="cm">	 *		3: Session overlap</span>
<span class="cm">	 *		4: Success control</span>
<span class="cm">	 */</span>
	<span class="n">u32</span>		<span class="n">LED_LinkOn</span><span class="p">;</span>	<span class="cm">/* Turn LED on control */</span>
	<span class="n">u32</span>		<span class="n">LED_Scanning</span><span class="p">;</span>	<span class="cm">/* Let LED in scan process control */</span>
	<span class="n">u32</span>		<span class="n">LED_Blinking</span><span class="p">;</span>	<span class="cm">/* Temp variable for shining */</span>
	<span class="n">u32</span>		<span class="n">RxByteCountLast</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">TxByteCountLast</span><span class="p">;</span>

	<span class="cm">/* For global timer */</span>
	<span class="n">u32</span>		<span class="n">time_count</span><span class="p">;</span>	<span class="cm">/* TICK_TIME_100ms 1 = 100ms */</span>
<span class="p">};</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
