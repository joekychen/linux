<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › tidspbridge › include › dspbridge › proc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>proc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * proc.h</span>
<span class="cm"> *</span>
<span class="cm"> * DSP-BIOS Bridge driver support functions for TI OMAP processors.</span>
<span class="cm"> *</span>
<span class="cm"> * This is the DSP API RM module interface.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2005-2006 Texas Instruments, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * This package is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS PACKAGE IS PROVIDED ``AS IS&#39;&#39; AND WITHOUT ANY EXPRESS OR</span>
<span class="cm"> * IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED</span>
<span class="cm"> * WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef PROC_</span>
<span class="cp">#define PROC_</span>

<span class="cp">#include &lt;dspbridge/cfgdefs.h&gt;</span>
<span class="cp">#include &lt;dspbridge/devdefs.h&gt;</span>
<span class="cp">#include &lt;dspbridge/drv.h&gt;</span>

<span class="k">extern</span> <span class="kt">char</span> <span class="o">*</span><span class="n">iva_img</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_attach ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Prepare for communication with a particular DSP processor, and return</span>
<span class="cm"> *      a handle to the processor object. The PROC Object gets created</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      processor_id  :	   The processor index (zero-based).</span>
<span class="cm"> *      hmgr_obj  :	   Handle to the Manager Object</span>
<span class="cm"> *      attr_in     :	   Ptr to the dsp_processorattrin structure.</span>
<span class="cm"> *			      A NULL value means use default values.</span>
<span class="cm"> *      ph_processor :	   Ptr to location to store processor handle.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :	   Success.</span>
<span class="cm"> *      -EPERM   :	   General failure.</span>
<span class="cm"> *      -EFAULT :	   Invalid processor handle.</span>
<span class="cm"> *      0:   Success; Processor already attached.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      ph_processor != NULL.</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *      -EPERM, and *ph_processor == NULL, OR</span>
<span class="cm"> *      Success and *ph_processor is a Valid Processor handle OR</span>
<span class="cm"> *      0 and *ph_processor is a Valid Processor.</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *      When attr_in is NULL, the default timeout value is 10 seconds.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_attach</span><span class="p">(</span><span class="n">u32</span> <span class="n">processor_id</span><span class="p">,</span>
			      <span class="k">const</span> <span class="k">struct</span> <span class="n">dsp_processorattrin</span>
			      <span class="o">*</span><span class="n">attr_in</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">ph_processor</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">process_context</span> <span class="o">*</span><span class="n">pr_ctxt</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_auto_start =========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      A Particular device gets loaded with the default image</span>
<span class="cm"> *      if the AutoStart flag is set.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hdev_obj  :   Handle to the Device</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   On Successful Loading</span>
<span class="cm"> *      -ENOENT   :   No DSP exec file found.</span>
<span class="cm"> *      -EPERM   :   General Failure</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      hdev_obj != NULL.</span>
<span class="cm"> *      dev_node_obj != NULL.</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_auto_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">cfg_devnode</span> <span class="o">*</span><span class="n">dev_node_obj</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">dev_object</span> <span class="o">*</span><span class="n">hdev_obj</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_ctrl ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Pass control information to the GPP device driver managing the DSP</span>
<span class="cm"> *      processor. This will be an OEM-only function, and not part of the</span>
<span class="cm"> *      &#39;Bridge application developer&#39;s API.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :       The processor handle.</span>
<span class="cm"> *      dw_cmd       :       Private driver IOCTL cmd ID.</span>
<span class="cm"> *      pargs       :       Ptr to an driver defined argument structure.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :       SUCCESS</span>
<span class="cm"> *      -EFAULT :       Invalid processor handle.</span>
<span class="cm"> *      -ETIME:       A Timeout Occurred before the Control information</span>
<span class="cm"> *			  could be sent.</span>
<span class="cm"> *      -EPERM   :       General Failure.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *      This function Calls bridge_dev_ctrl.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_ctrl</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
			    <span class="n">u32</span> <span class="n">dw_cmd</span><span class="p">,</span> <span class="k">struct</span> <span class="n">dsp_cbdata</span> <span class="o">*</span><span class="n">arg</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_detach ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Close a DSP processor and de-allocate all (GPP) resources reserved</span>
<span class="cm"> *      for it. The Processor Object is deleted.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      pr_ctxt     :   The processor handle.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   InValid Handle.</span>
<span class="cm"> *      -EPERM   :   General failure.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *      PROC Object is destroyed.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_detach</span><span class="p">(</span><span class="k">struct</span> <span class="n">process_context</span> <span class="o">*</span><span class="n">pr_ctxt</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_enum_nodes ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Enumerate the nodes currently allocated on a processor.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :   The processor handle.</span>
<span class="cm"> *      node_tab    :   The first Location of an array allocated for node</span>
<span class="cm"> *		      handles.</span>
<span class="cm"> *      node_tab_size:   The number of (DSP_HNODE) handles that can be held</span>
<span class="cm"> *		      to the memory the client has allocated for node_tab</span>
<span class="cm"> *      pu_num_nodes  :   Location where DSPProcessor_EnumNodes will return</span>
<span class="cm"> *		      the number of valid handles written to node_tab</span>
<span class="cm"> *      pu_allocated :   Location where DSPProcessor_EnumNodes will return</span>
<span class="cm"> *		      the number of nodes that are allocated on the DSP.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   Invalid processor handle.</span>
<span class="cm"> *      -EINVAL   :   The amount of memory allocated for node_tab is</span>
<span class="cm"> *		      insufficent. That is the number of nodes actually</span>
<span class="cm"> *		      allocated on the DSP is greater than the value</span>
<span class="cm"> *		      specified for node_tab_size.</span>
<span class="cm"> *      -EPERM   :   Unable to get Resource Information.</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *  Requires</span>
<span class="cm"> *      pu_num_nodes is not NULL.</span>
<span class="cm"> *      pu_allocated is not NULL.</span>
<span class="cm"> *      node_tab is not NULL.</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_enum_nodes</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
				  <span class="kt">void</span> <span class="o">**</span><span class="n">node_tab</span><span class="p">,</span>
				  <span class="n">u32</span> <span class="n">node_tab_size</span><span class="p">,</span>
				  <span class="n">u32</span> <span class="o">*</span><span class="n">pu_num_nodes</span><span class="p">,</span>
				  <span class="n">u32</span> <span class="o">*</span><span class="n">pu_allocated</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_get_resource_info ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Enumerate the resources currently available on a processor.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :       The processor handle.</span>
<span class="cm"> *      resource_type:      Type of resource .</span>
<span class="cm"> *      resource_info:      Ptr to the dsp_resourceinfo structure.</span>
<span class="cm"> *      resource_info_size:  Size of the structure.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :       Success.</span>
<span class="cm"> *      -EFAULT :       Invalid processor handle.</span>
<span class="cm"> *      -EBADR:    The processor is not in the PROC_RUNNING state.</span>
<span class="cm"> *      -ETIME:       A timeout occurred before the DSP responded to the</span>
<span class="cm"> *			  querry.</span>
<span class="cm"> *      -EPERM   :       Unable to get Resource Information</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      resource_info is not NULL.</span>
<span class="cm"> *      Parameter resource_type is Valid.[TBD]</span>
<span class="cm"> *      resource_info_size is &gt;= sizeof dsp_resourceinfo struct.</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *      This function currently returns</span>
<span class="cm"> *      -ENOSYS, and does not write any data to the resource_info struct.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_get_resource_info</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
					 <span class="n">u32</span> <span class="n">resource_type</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">dsp_resourceinfo</span>
					 <span class="o">*</span><span class="n">resource_info</span><span class="p">,</span>
					 <span class="n">u32</span> <span class="n">resource_info_size</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * ======== proc_get_dev_object =========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Returns the DEV Hanlde for a given Processor handle</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :   Processor Handle</span>
<span class="cm"> *      device_obj :    Location to store the DEV Handle.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success; *device_obj has Dev handle</span>
<span class="cm"> *      -EPERM   :   Failure; *device_obj is zero.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      device_obj is not NULL</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *      0     :   *device_obj is not NULL</span>
<span class="cm"> *      -EPERM   :   *device_obj is NULL.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_get_dev_object</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
				      <span class="k">struct</span> <span class="n">dev_object</span> <span class="o">**</span><span class="n">device_obj</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_get_state ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Report the state of the specified DSP processor.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :   The processor handle.</span>
<span class="cm"> *      proc_state_obj :   Ptr to location to store the dsp_processorstate</span>
<span class="cm"> *		      structure.</span>
<span class="cm"> *      state_info_size: Size of dsp_processorstate.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM   :   General failure while querying processor state.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      proc_state_obj is not NULL</span>
<span class="cm"> *      state_info_size is &gt;= than the size of dsp_processorstate structure.</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_get_state</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span> <span class="k">struct</span> <span class="n">dsp_processorstate</span>
				 <span class="o">*</span><span class="n">proc_state_obj</span><span class="p">,</span> <span class="n">u32</span> <span class="n">state_info_size</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== PROC_GetProcessorID ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Report the state of the specified DSP processor.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :   The processor handle.</span>
<span class="cm"> *      proc_id      :   Processor ID</span>
<span class="cm"> *</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM   :   General failure while querying processor state.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      proc_state_obj is not NULL</span>
<span class="cm"> *      state_info_size is &gt;= than the size of dsp_processorstate structure.</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_get_processor_id</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">proc</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span> <span class="n">proc_id</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_get_trace ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Retrieve the trace buffer from the specified DSP processor.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :   The processor handle.</span>
<span class="cm"> *      pbuf	:   Ptr to buffer to hold trace output.</span>
<span class="cm"> *      max_size    :   Maximum size of the output buffer.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM   :   General failure while retireving processor trace</span>
<span class="cm"> *		      Buffer.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      pbuf is not NULL</span>
<span class="cm"> *      max_size is &gt; 0.</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_get_trace</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span> <span class="n">pbuf</span><span class="p">,</span> <span class="n">u32</span> <span class="n">max_size</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_load ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Reset a processor and load a new base program image.</span>
<span class="cm"> *      This will be an OEM-only function.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor:       The processor handle.</span>
<span class="cm"> *      argc_index:       The number of Arguments(strings)in the aArgV[]</span>
<span class="cm"> *      user_args:       An Array of Arguments(Unicode Strings)</span>
<span class="cm"> *      user_envp:       An Array of Environment settings(Unicode Strings)</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0:       Success.</span>
<span class="cm"> *      -ENOENT:       The DSP Execuetable was not found.</span>
<span class="cm"> *      -EFAULT:       Invalid processor handle.</span>
<span class="cm"> *      -EPERM   :       Unable to Load the Processor</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      user_args is not NULL</span>
<span class="cm"> *      argc_index is &gt; 0</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *      Success and ProcState == PROC_LOADED</span>
<span class="cm"> *      or DSP_FAILED status.</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *      Does not implement access rights to control which GPP application</span>
<span class="cm"> *      can load the processor.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_load</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
			    <span class="k">const</span> <span class="n">s32</span> <span class="n">argc_index</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">user_args</span><span class="p">,</span>
			    <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">user_envp</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_register_notify ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Register to be notified of specific processor events</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :   The processor handle.</span>
<span class="cm"> *      event_mask  :   Mask of types of events to be notified about.</span>
<span class="cm"> *      notify_type :   Type of notification to be sent.</span>
<span class="cm"> *      hnotification:  Handle to be used for notification.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   Invalid processor handle or hnotification.</span>
<span class="cm"> *      -EINVAL  :   Parameter event_mask is Invalid</span>
<span class="cm"> *      DSP_ENOTIMP :   The notification type specified in uNotifyMask</span>
<span class="cm"> *		      is not supported.</span>
<span class="cm"> *      -EPERM   :   Unable to register for notification.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      hnotification is not NULL</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_register_notify</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
				       <span class="n">u32</span> <span class="n">event_mask</span><span class="p">,</span> <span class="n">u32</span> <span class="n">notify_type</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">dsp_notification</span>
				       <span class="o">*</span><span class="n">hnotification</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_notify_clients ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Notify the Processor Clients</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      proc       :   The processor handle.</span>
<span class="cm"> *      events     :   Event to be notified about.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM   :   Failure to Set or Reset the Event</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      events is Supported or Valid type of Event</span>
<span class="cm"> *      proc is a valid handle</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_notify_clients</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">proc</span><span class="p">,</span> <span class="n">u32</span> <span class="n">events</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_notify_all_clients ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Notify the Processor Clients</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      proc       :   The processor handle.</span>
<span class="cm"> *      events     :   Event to be notified about.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :   Success.</span>
<span class="cm"> *      -EFAULT :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM   :   Failure to Set or Reset the Event</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      events is Supported or Valid type of Event</span>
<span class="cm"> *      proc is a valid handle</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *      NODE And STRM would use this function to notify their clients</span>
<span class="cm"> *      about the state changes in NODE or STRM.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_notify_all_clients</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">proc</span><span class="p">,</span> <span class="n">u32</span> <span class="n">events</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_start ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Start a processor running.</span>
<span class="cm"> *      Processor must be in PROC_LOADED state.</span>
<span class="cm"> *      This will be an OEM-only function, and not part of the &#39;Bridge</span>
<span class="cm"> *      application developer&#39;s API.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :       The processor handle.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :       Success.</span>
<span class="cm"> *      -EFAULT :       Invalid processor handle.</span>
<span class="cm"> *      -EBADR:    Processor is not in PROC_LOADED state.</span>
<span class="cm"> *      -EPERM   :       Unable to start the processor.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *      Success and ProcState == PROC_RUNNING or DSP_FAILED status.</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_start</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_stop ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Start a processor running.</span>
<span class="cm"> *      Processor must be in PROC_LOADED state.</span>
<span class="cm"> *      This will be an OEM-only function, and not part of the &#39;Bridge</span>
<span class="cm"> *      application developer&#39;s API.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor  :       The processor handle.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0     :       Success.</span>
<span class="cm"> *      -EFAULT :       Invalid processor handle.</span>
<span class="cm"> *      -EBADR:    Processor is not in PROC_LOADED state.</span>
<span class="cm"> *      -EPERM   :       Unable to start the processor.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *      Success and ProcState == PROC_RUNNING or DSP_FAILED status.</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_stop</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_end_dma ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Begin a DMA transfer</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      pmpu_addr	:   Buffer start address</span>
<span class="cm"> *      ul_size		:   Buffer size</span>
<span class="cm"> *      dir		:   The direction of the transfer</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      Memory was previously mapped.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_end_dma</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">pmpu_addr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">ul_size</span><span class="p">,</span>
						<span class="k">enum</span> <span class="n">dma_data_direction</span> <span class="n">dir</span><span class="p">);</span>
<span class="cm">/*</span>
<span class="cm"> *  ======== proc_begin_dma ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Begin a DMA transfer</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      pmpu_addr	:   Buffer start address</span>
<span class="cm"> *      ul_size		:   Buffer size</span>
<span class="cm"> *      dir		:   The direction of the transfer</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      Memory was previously mapped.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_begin_dma</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">pmpu_addr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">ul_size</span><span class="p">,</span>
						<span class="k">enum</span> <span class="n">dma_data_direction</span> <span class="n">dir</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_flush_memory ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Flushes a buffer from the MPU data cache.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      pmpu_addr	:   Buffer start address</span>
<span class="cm"> *      ul_size	  :   Buffer size</span>
<span class="cm"> *      ul_flags	 :   Reserved.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0	 :   Success.</span>
<span class="cm"> *      -EFAULT     :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM       :   General failure.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *      All the arguments are currently ignored.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_flush_memory</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
				    <span class="kt">void</span> <span class="o">*</span><span class="n">pmpu_addr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">ul_size</span><span class="p">,</span> <span class="n">u32</span> <span class="n">ul_flags</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_invalidate_memory ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Invalidates a buffer from the MPU data cache.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      pmpu_addr	:   Buffer start address</span>
<span class="cm"> *      ul_size	  :   Buffer size</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0	 :   Success.</span>
<span class="cm"> *      -EFAULT     :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM       :   General failure.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> *      All the arguments are currently ignored.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_invalidate_memory</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
					 <span class="kt">void</span> <span class="o">*</span><span class="n">pmpu_addr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">ul_size</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_map ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Maps a MPU buffer to DSP address space.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      pmpu_addr	:   Starting address of the memory region to map.</span>
<span class="cm"> *      ul_size	  :   Size of the memory region to map.</span>
<span class="cm"> *      req_addr	:   Requested DSP start address. Offset-adjusted actual</span>
<span class="cm"> *			  mapped address is in the last argument.</span>
<span class="cm"> *      pp_map_addr       :   Ptr to DSP side mapped u8 address.</span>
<span class="cm"> *      ul_map_attr       :   Optional endianness attributes, virt to phys flag.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0	 :   Success.</span>
<span class="cm"> *      -EFAULT     :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM       :   General failure.</span>
<span class="cm"> *      -ENOMEM     :   MPU side memory allocation error.</span>
<span class="cm"> *      -ENOENT   :   Cannot find a reserved region starting with this</span>
<span class="cm"> *		      :   address.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      pmpu_addr is not NULL</span>
<span class="cm"> *      ul_size is not zero</span>
<span class="cm"> *      pp_map_addr is not NULL</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_map</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
			   <span class="kt">void</span> <span class="o">*</span><span class="n">pmpu_addr</span><span class="p">,</span>
			   <span class="n">u32</span> <span class="n">ul_size</span><span class="p">,</span>
			   <span class="kt">void</span> <span class="o">*</span><span class="n">req_addr</span><span class="p">,</span>
			   <span class="kt">void</span> <span class="o">**</span><span class="n">pp_map_addr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">ul_map_attr</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">process_context</span> <span class="o">*</span><span class="n">pr_ctxt</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_reserve_memory ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Reserve a virtually contiguous region of DSP address space.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      ul_size	  :   Size of the address space to reserve.</span>
<span class="cm"> *      pp_rsv_addr       :   Ptr to DSP side reserved u8 address.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0	 :   Success.</span>
<span class="cm"> *      -EFAULT     :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM       :   General failure.</span>
<span class="cm"> *      -ENOMEM     :   Cannot reserve chunk of this size.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      pp_rsv_addr is not NULL</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_reserve_memory</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
				      <span class="n">u32</span> <span class="n">ul_size</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">pp_rsv_addr</span><span class="p">,</span>
				      <span class="k">struct</span> <span class="n">process_context</span> <span class="o">*</span><span class="n">pr_ctxt</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_un_map ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Removes a MPU buffer mapping from the DSP address space.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      map_addr	:   Starting address of the mapped memory region.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0	 :   Success.</span>
<span class="cm"> *      -EFAULT     :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM       :   General failure.</span>
<span class="cm"> *      -ENOENT   :   Cannot find a mapped region starting with this</span>
<span class="cm"> *		      :   address.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      map_addr is not NULL</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_un_map</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">map_addr</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">process_context</span> <span class="o">*</span><span class="n">pr_ctxt</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== proc_un_reserve_memory ========</span>
<span class="cm"> *  Purpose:</span>
<span class="cm"> *      Frees a previously reserved region of DSP address space.</span>
<span class="cm"> *  Parameters:</span>
<span class="cm"> *      hprocessor      :   The processor handle.</span>
<span class="cm"> *      prsv_addr	:   Ptr to DSP side reservedBYTE address.</span>
<span class="cm"> *  Returns:</span>
<span class="cm"> *      0	 :   Success.</span>
<span class="cm"> *      -EFAULT     :   Invalid processor handle.</span>
<span class="cm"> *      -EPERM       :   General failure.</span>
<span class="cm"> *      -ENOENT   :   Cannot find a reserved region starting with this</span>
<span class="cm"> *		      :   address.</span>
<span class="cm"> *  Requires:</span>
<span class="cm"> *      prsv_addr is not NULL</span>
<span class="cm"> *      PROC Initialized.</span>
<span class="cm"> *  Ensures:</span>
<span class="cm"> *  Details:</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">proc_un_reserve_memory</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">hprocessor</span><span class="p">,</span>
					 <span class="kt">void</span> <span class="o">*</span><span class="n">prsv_addr</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">process_context</span> <span class="o">*</span><span class="n">pr_ctxt</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* PROC_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
