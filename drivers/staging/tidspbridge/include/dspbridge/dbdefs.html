<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › tidspbridge › include › dspbridge › dbdefs.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>dbdefs.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * dbdefs.h</span>
<span class="cm"> *</span>
<span class="cm"> * DSP-BIOS Bridge driver support functions for TI OMAP processors.</span>
<span class="cm"> *</span>
<span class="cm"> * Global definitions and constants for DSP/BIOS Bridge.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2005-2006 Texas Instruments, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * This package is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS PACKAGE IS PROVIDED ``AS IS&#39;&#39; AND WITHOUT ANY EXPRESS OR</span>
<span class="cm"> * IMPLIED WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED</span>
<span class="cm"> * WARRANTIES OF MERCHANTIBILITY AND FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef DBDEFS_</span>
<span class="cp">#define DBDEFS_</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="cp">#include &lt;dspbridge/rms_sh.h&gt;	</span><span class="cm">/* Types shared between GPP and DSP */</span><span class="cp"></span>

<span class="cp">#define PG_SIZE4K 4096</span>
<span class="cp">#define PG_MASK(pg_size) (~((pg_size)-1))</span>
<span class="cp">#define PG_ALIGN_LOW(addr, pg_size) ((addr) &amp; PG_MASK(pg_size))</span>
<span class="cp">#define PG_ALIGN_HIGH(addr, pg_size) (((addr)+(pg_size)-1) &amp; PG_MASK(pg_size))</span>

<span class="cm">/* API return value and calling convention */</span>
<span class="cp">#define DBAPI                       int</span>

<span class="cm">/* Maximum length of node name, used in dsp_ndbprops */</span>
<span class="cp">#define DSP_MAXNAMELEN              32</span>

<span class="cm">/* notify_type values for the RegisterNotify() functions. */</span>
<span class="cp">#define DSP_SIGNALEVENT             0x00000001</span>

<span class="cm">/* Types of events for processors */</span>
<span class="cp">#define DSP_PROCESSORSTATECHANGE    0x00000001</span>
<span class="cp">#define DSP_PROCESSORATTACH         0x00000002</span>
<span class="cp">#define DSP_PROCESSORDETACH         0x00000004</span>
<span class="cp">#define DSP_PROCESSORRESTART        0x00000008</span>

<span class="cm">/* DSP exception events (DSP/BIOS and DSP MMU fault) */</span>
<span class="cp">#define DSP_MMUFAULT                0x00000010</span>
<span class="cp">#define DSP_SYSERROR                0x00000020</span>
<span class="cp">#define DSP_EXCEPTIONABORT          0x00000300</span>
<span class="cp">#define DSP_PWRERROR                0x00000080</span>
<span class="cp">#define DSP_WDTOVERFLOW	0x00000040</span>

<span class="cm">/* IVA exception events (IVA MMU fault) */</span>
<span class="cp">#define IVA_MMUFAULT                0x00000040</span>
<span class="cm">/* Types of events for nodes */</span>
<span class="cp">#define DSP_NODESTATECHANGE         0x00000100</span>
<span class="cp">#define DSP_NODEMESSAGEREADY        0x00000200</span>

<span class="cm">/* Types of events for streams */</span>
<span class="cp">#define DSP_STREAMDONE              0x00001000</span>
<span class="cp">#define DSP_STREAMIOCOMPLETION      0x00002000</span>

<span class="cm">/* Handle definition representing the GPP node in DSPNode_Connect() calls */</span>
<span class="cp">#define DSP_HGPPNODE                0xFFFFFFFF</span>

<span class="cm">/* Node directions used in DSPNode_Connect() */</span>
<span class="cp">#define DSP_TONODE                  1</span>
<span class="cp">#define DSP_FROMNODE                2</span>

<span class="cm">/* Define Node Minimum and Maximum Priorities */</span>
<span class="cp">#define DSP_NODE_MIN_PRIORITY       1</span>
<span class="cp">#define DSP_NODE_MAX_PRIORITY       15</span>

<span class="cm">/* msg_ctrl contains SM buffer description */</span>
<span class="cp">#define DSP_RMSBUFDESC RMS_BUFDESC</span>

<span class="cm">/* Processor ID numbers */</span>
<span class="cp">#define DSP_UNIT    0</span>
<span class="cp">#define IVA_UNIT    1</span>

<span class="cp">#define DSPWORD       unsigned char</span>
<span class="cp">#define DSPWORDSIZE     sizeof(DSPWORD)</span>

<span class="cp">#define    MAX_PROFILES     16</span>

<span class="cm">/* DSP chip type */</span>
<span class="cp">#define DSPTYPE64	0x99</span>

<span class="cm">/* Handy Macros */</span>
<span class="cp">#define VALID_PROC_EVENT (DSP_PROCESSORSTATECHANGE | DSP_PROCESSORATTACH | \</span>
<span class="cp">	DSP_PROCESSORDETACH | DSP_PROCESSORRESTART | DSP_NODESTATECHANGE | \</span>
<span class="cp">	DSP_STREAMDONE | DSP_STREAMIOCOMPLETION | DSP_MMUFAULT | \</span>
<span class="cp">	DSP_SYSERROR | DSP_WDTOVERFLOW | DSP_PWRERROR)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">is_valid_proc_event</span><span class="p">(</span><span class="n">u32</span> <span class="n">x</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">VALID_PROC_EVENT</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">VALID_PROC_EVENT</span><span class="p">)));</span>
<span class="p">}</span>

<span class="cm">/* The Node UUID structure */</span>
<span class="k">struct</span> <span class="n">dsp_uuid</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">data1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">data2</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">data3</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data4</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data5</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data6</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* DCD types */</span>
<span class="k">enum</span> <span class="n">dsp_dcdobjtype</span> <span class="p">{</span>
	<span class="n">DSP_DCDNODETYPE</span><span class="p">,</span>
	<span class="n">DSP_DCDPROCESSORTYPE</span><span class="p">,</span>
	<span class="n">DSP_DCDLIBRARYTYPE</span><span class="p">,</span>
	<span class="n">DSP_DCDCREATELIBTYPE</span><span class="p">,</span>
	<span class="n">DSP_DCDEXECUTELIBTYPE</span><span class="p">,</span>
	<span class="n">DSP_DCDDELETELIBTYPE</span><span class="p">,</span>
	<span class="cm">/* DSP_DCDMAXOBJTYPE is meant to be the last DCD object type */</span>
	<span class="n">DSP_DCDMAXOBJTYPE</span>
<span class="p">};</span>

<span class="cm">/* Processor states */</span>
<span class="k">enum</span> <span class="n">dsp_procstate</span> <span class="p">{</span>
	<span class="n">PROC_STOPPED</span><span class="p">,</span>
	<span class="n">PROC_LOADED</span><span class="p">,</span>
	<span class="n">PROC_RUNNING</span><span class="p">,</span>
	<span class="n">PROC_ERROR</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *  Node types: Message node, task node, xDAIS socket node, and</span>
<span class="cm"> *  device node. _NODE_GPP is used when defining a stream connection</span>
<span class="cm"> *  between a task or socket node and the GPP.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">node_type</span> <span class="p">{</span>
	<span class="n">NODE_DEVICE</span><span class="p">,</span>
	<span class="n">NODE_TASK</span><span class="p">,</span>
	<span class="n">NODE_DAISSOCKET</span><span class="p">,</span>
	<span class="n">NODE_MESSAGE</span><span class="p">,</span>
	<span class="n">NODE_GPP</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *  ======== node_state ========</span>
<span class="cm"> *  Internal node states.</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">node_state</span> <span class="p">{</span>
	<span class="n">NODE_ALLOCATED</span><span class="p">,</span>
	<span class="n">NODE_CREATED</span><span class="p">,</span>
	<span class="n">NODE_RUNNING</span><span class="p">,</span>
	<span class="n">NODE_PAUSED</span><span class="p">,</span>
	<span class="n">NODE_DONE</span><span class="p">,</span>
	<span class="n">NODE_CREATING</span><span class="p">,</span>
	<span class="n">NODE_STARTING</span><span class="p">,</span>
	<span class="n">NODE_PAUSING</span><span class="p">,</span>
	<span class="n">NODE_TERMINATING</span><span class="p">,</span>
	<span class="n">NODE_DELETING</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Stream states */</span>
<span class="k">enum</span> <span class="n">dsp_streamstate</span> <span class="p">{</span>
	<span class="n">STREAM_IDLE</span><span class="p">,</span>
	<span class="n">STREAM_READY</span><span class="p">,</span>
	<span class="n">STREAM_PENDING</span><span class="p">,</span>
	<span class="n">STREAM_DONE</span>
<span class="p">};</span>

<span class="cm">/* Stream connect types */</span>
<span class="k">enum</span> <span class="n">dsp_connecttype</span> <span class="p">{</span>
	<span class="n">CONNECTTYPE_NODEOUTPUT</span><span class="p">,</span>
	<span class="n">CONNECTTYPE_GPPOUTPUT</span><span class="p">,</span>
	<span class="n">CONNECTTYPE_NODEINPUT</span><span class="p">,</span>
	<span class="n">CONNECTTYPE_GPPINPUT</span>
<span class="p">};</span>

<span class="cm">/* Stream mode types */</span>
<span class="k">enum</span> <span class="n">dsp_strmmode</span> <span class="p">{</span>
	<span class="n">STRMMODE_PROCCOPY</span><span class="p">,</span>	<span class="cm">/* Processor(s) copy stream data payloads */</span>
	<span class="n">STRMMODE_ZEROCOPY</span><span class="p">,</span>	<span class="cm">/* Strm buffer ptrs swapped no data copied */</span>
	<span class="n">STRMMODE_LDMA</span><span class="p">,</span>		<span class="cm">/* Local DMA : OMAP&#39;s System-DMA device */</span>
	<span class="n">STRMMODE_RDMA</span>		<span class="cm">/* Remote DMA: OMAP&#39;s DSP-DMA device */</span>
<span class="p">};</span>

<span class="cm">/* Resource Types */</span>
<span class="k">enum</span> <span class="n">dsp_resourceinfotype</span> <span class="p">{</span>
	<span class="n">DSP_RESOURCE_DYNDARAM</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">DSP_RESOURCE_DYNSARAM</span><span class="p">,</span>
	<span class="n">DSP_RESOURCE_DYNEXTERNAL</span><span class="p">,</span>
	<span class="n">DSP_RESOURCE_DYNSRAM</span><span class="p">,</span>
	<span class="n">DSP_RESOURCE_PROCLOAD</span>
<span class="p">};</span>

<span class="cm">/* Memory Segment Types */</span>
<span class="k">enum</span> <span class="n">dsp_memtype</span> <span class="p">{</span>
	<span class="n">DSP_DYNDARAM</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">DSP_DYNSARAM</span><span class="p">,</span>
	<span class="n">DSP_DYNEXTERNAL</span><span class="p">,</span>
	<span class="n">DSP_DYNSRAM</span>
<span class="p">};</span>

<span class="cm">/* Memory Flush Types */</span>
<span class="k">enum</span> <span class="n">dsp_flushtype</span> <span class="p">{</span>
	<span class="n">PROC_INVALIDATE_MEM</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">PROC_WRITEBACK_MEM</span><span class="p">,</span>
	<span class="n">PROC_WRITEBACK_INVALIDATE_MEM</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Memory Segment Status Values */</span>
<span class="k">struct</span> <span class="n">dsp_memstat</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_free_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">len_max_free_block</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_free_blocks</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_alloc_blocks</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Processor Load information Values */</span>
<span class="k">struct</span> <span class="n">dsp_procloadstat</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">curr_load</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">predicted_load</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">curr_dsp_freq</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">predicted_freq</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Attributes for STRM connections between nodes */</span>
<span class="k">struct</span> <span class="n">dsp_strmattr</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">seg_id</span><span class="p">;</span>		<span class="cm">/* Memory segment on DSP to allocate buffers */</span>
	<span class="n">u32</span> <span class="n">buf_size</span><span class="p">;</span>		<span class="cm">/* Buffer size (DSP words) */</span>
	<span class="n">u32</span> <span class="n">num_bufs</span><span class="p">;</span>		<span class="cm">/* Number of buffers */</span>
	<span class="n">u32</span> <span class="n">buf_alignment</span><span class="p">;</span>	<span class="cm">/* Buffer alignment */</span>
	<span class="n">u32</span> <span class="n">timeout</span><span class="p">;</span>		<span class="cm">/* Timeout for blocking STRM calls */</span>
	<span class="k">enum</span> <span class="n">dsp_strmmode</span> <span class="n">strm_mode</span><span class="p">;</span>	<span class="cm">/* mode of stream when opened */</span>
	<span class="cm">/* DMA chnl id if dsp_strmmode is LDMA or RDMA */</span>
	<span class="n">u32</span> <span class="n">dma_chnl_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dma_priority</span><span class="p">;</span>	<span class="cm">/* DMA channel priority 0=lowest, &gt;0=high */</span>
<span class="p">};</span>

<span class="cm">/* The dsp_cbdata structure */</span>
<span class="k">struct</span> <span class="n">dsp_cbdata</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_data</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">node_data</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* The dsp_msg structure */</span>
<span class="k">struct</span> <span class="n">dsp_msg</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">arg1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">arg2</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* The dsp_resourcereqmts structure for node&#39;s resource requirements */</span>
<span class="k">struct</span> <span class="n">dsp_resourcereqmts</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">static_data_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">global_data_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">program_mem_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">wc_execution_time</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">wc_period</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">wc_deadline</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">avg_exection_time</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">minimum_period</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * The dsp_streamconnect structure describes a stream connection</span>
<span class="cm"> * between two nodes, or between a node and the GPP</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dsp_streamconnect</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">dsp_connecttype</span> <span class="n">connect_type</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">this_node_stream_index</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">connected_node</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dsp_uuid</span> <span class="n">ui_connected_node_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">connected_node_stream_index</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">dsp_nodeprofs</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">heap_size</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* The dsp_ndbprops structure reports the attributes of a node */</span>
<span class="k">struct</span> <span class="n">dsp_ndbprops</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dsp_uuid</span> <span class="n">ui_node_id</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">ac_name</span><span class="p">[</span><span class="n">DSP_MAXNAMELEN</span><span class="p">];</span>
	<span class="k">enum</span> <span class="n">node_type</span> <span class="n">ntype</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cache_on_gpp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dsp_resourcereqmts</span> <span class="n">dsp_resource_reqmts</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">prio</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stack_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sys_stack_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">stack_seg</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">message_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_input_streams</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_output_streams</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">timeout</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">count_profiles</span><span class="p">;</span>	<span class="cm">/* Number of supported profiles */</span>
	<span class="cm">/* Array of profiles */</span>
	<span class="k">struct</span> <span class="n">dsp_nodeprofs</span> <span class="n">node_profiles</span><span class="p">[</span><span class="n">MAX_PROFILES</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">stack_seg_name</span><span class="p">;</span>	<span class="cm">/* Stack Segment Name */</span>
<span class="p">};</span>

	<span class="cm">/* The dsp_nodeattrin structure describes the attributes of a</span>
<span class="cm">	 * node client */</span>
<span class="k">struct</span> <span class="n">dsp_nodeattrin</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">prio</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">timeout</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">profile_id</span><span class="p">;</span>
	<span class="cm">/* Reserved, for Bridge Internal use only */</span>
	<span class="n">u32</span> <span class="n">heap_size</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">pgpp_virt_addr</span><span class="p">;</span>	<span class="cm">/* Reserved, for Bridge Internal use only */</span>
<span class="p">};</span>

	<span class="cm">/* The dsp_nodeinfo structure is used to retrieve information</span>
<span class="cm">	 * about a node */</span>
<span class="k">struct</span> <span class="n">dsp_nodeinfo</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dsp_ndbprops</span> <span class="n">nb_node_database_props</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">execution_priority</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">node_state</span> <span class="n">ns_execution_state</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">device_owner</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">number_streams</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dsp_streamconnect</span> <span class="n">sc_stream_connection</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">node_env</span><span class="p">;</span>
<span class="p">};</span>

	<span class="cm">/* The dsp_nodeattr structure describes the attributes of a node */</span>
<span class="k">struct</span> <span class="n">dsp_nodeattr</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dsp_nodeattrin</span> <span class="n">in_node_attr_in</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">node_attr_inputs</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">node_attr_outputs</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dsp_nodeinfo</span> <span class="n">node_info</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *  Notification type: either the name of an opened event, or an event or</span>
<span class="cm"> *  window handle.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dsp_notification</span> <span class="p">{</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">handle</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* The dsp_processorattrin structure describes the attributes of a processor */</span>
<span class="k">struct</span> <span class="n">dsp_processorattrin</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">timeout</span><span class="p">;</span>
<span class="p">};</span>
<span class="cm">/*</span>
<span class="cm"> * The dsp_processorinfo structure describes basic capabilities of a</span>
<span class="cm"> * DSP processor</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dsp_processorinfo</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">processor_family</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">processor_type</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">clock_rate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">internal_mem_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">external_mem_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">processor_id</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ty_running_rtos</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">node_min_priority</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">node_max_priority</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Error information of last DSP exception signalled to the GPP */</span>
<span class="k">struct</span> <span class="n">dsp_errorinfo</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">err_mask</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">val1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">val2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">val3</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* The dsp_processorstate structure describes the state of a DSP processor */</span>
<span class="k">struct</span> <span class="n">dsp_processorstate</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">dsp_procstate</span> <span class="n">proc_state</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * The dsp_resourceinfo structure is used to retrieve information about a</span>
<span class="cm"> * processor&#39;s resources</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dsp_resourceinfo</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">dsp_resourceinfotype</span> <span class="n">resource_type</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">resource</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">dsp_memstat</span> <span class="n">mem_stat</span><span class="p">;</span>
		<span class="k">struct</span> <span class="n">dsp_procloadstat</span> <span class="n">proc_load_stat</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">result</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * The dsp_streamattrin structure describes the attributes of a stream,</span>
<span class="cm"> * including segment and alignment of data buffers allocated with</span>
<span class="cm"> * DSPStream_AllocateBuffers(), if applicable</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dsp_streamattrin</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">timeout</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">segment_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">buf_alignment</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">num_bufs</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">dsp_strmmode</span> <span class="n">strm_mode</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dma_chnl_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dma_priority</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* The dsp_bufferattr structure describes the attributes of a data buffer */</span>
<span class="k">struct</span> <span class="n">dsp_bufferattr</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">segment_id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">buf_alignment</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *  The dsp_streaminfo structure is used to retrieve information</span>
<span class="cm"> *  about a stream.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dsp_streaminfo</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cb_struct</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">number_bufs_allowed</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">number_bufs_in_stream</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">number_bytes</span><span class="p">;</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">sync_object_handle</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">dsp_streamstate</span> <span class="n">ss_stream_state</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* DMM MAP attributes</span>
<span class="cm">It is a bit mask with each bit value indicating a specific attribute</span>
<span class="cm">bit 0 - GPP address type (user virtual=0, physical=1)</span>
<span class="cm">bit 1 - MMU Endianism (Big Endian=1, Little Endian=0)</span>
<span class="cm">bit 2 - MMU mixed page attribute (Mixed/ CPUES=1, TLBES =0)</span>
<span class="cm">bit 3 - MMU element size = 8bit (valid only for non mixed page entries)</span>
<span class="cm">bit 4 - MMU element size = 16bit (valid only for non mixed page entries)</span>
<span class="cm">bit 5 - MMU element size = 32bit (valid only for non mixed page entries)</span>
<span class="cm">bit 6 - MMU element size = 64bit (valid only for non mixed page entries)</span>

<span class="cm">bit 14 - Input (read only) buffer</span>
<span class="cm">bit 15 - Output (writeable) buffer</span>
<span class="cm">*/</span>

<span class="cm">/* Types of mapping attributes */</span>

<span class="cm">/* MPU address is virtual and needs to be translated to physical addr */</span>
<span class="cp">#define DSP_MAPVIRTUALADDR          0x00000000</span>
<span class="cp">#define DSP_MAPPHYSICALADDR         0x00000001</span>

<span class="cm">/* Mapped data is big endian */</span>
<span class="cp">#define DSP_MAPBIGENDIAN            0x00000002</span>
<span class="cp">#define DSP_MAPLITTLEENDIAN         0x00000000</span>

<span class="cm">/* Element size is based on DSP r/w access size */</span>
<span class="cp">#define DSP_MAPMIXEDELEMSIZE        0x00000004</span>

<span class="cm">/*</span>
<span class="cm"> * Element size for MMU mapping (8, 16, 32, or 64 bit)</span>
<span class="cm"> * Ignored if DSP_MAPMIXEDELEMSIZE enabled</span>
<span class="cm"> */</span>
<span class="cp">#define DSP_MAPELEMSIZE8            0x00000008</span>
<span class="cp">#define DSP_MAPELEMSIZE16           0x00000010</span>
<span class="cp">#define DSP_MAPELEMSIZE32           0x00000020</span>
<span class="cp">#define DSP_MAPELEMSIZE64           0x00000040</span>

<span class="cp">#define DSP_MAPVMALLOCADDR         0x00000080</span>

<span class="cp">#define DSP_MAPDONOTLOCK	   0x00000100</span>

<span class="cp">#define DSP_MAP_DIR_MASK		0x3FFF</span>

<span class="cp">#define GEM_CACHE_LINE_SIZE     128</span>
<span class="cp">#define GEM_L1P_PREFETCH_SIZE   128</span>

<span class="cm">/*</span>
<span class="cm"> * Definitions from dbreg.h</span>
<span class="cm"> */</span>

<span class="cp">#define DSPPROCTYPE_C64		6410</span>
<span class="cp">#define IVAPROCTYPE_ARM7	470</span>

<span class="cm">/* Max registry path length. Also the max registry value length. */</span>
<span class="cp">#define MAXREGPATHLENGTH	255</span>

<span class="cp">#endif </span><span class="cm">/* DBDEFS_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
