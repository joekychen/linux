<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › telephony › ixj.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>ixj.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/****************************************************************************</span>
<span class="cm"> *    ixj.c</span>
<span class="cm"> *</span>
<span class="cm"> * Device Driver for Quicknet Technologies, Inc.&#39;s Telephony cards</span>
<span class="cm"> * including the Internet PhoneJACK, Internet PhoneJACK Lite,</span>
<span class="cm"> * Internet PhoneJACK PCI, Internet LineJACK, Internet PhoneCARD and</span>
<span class="cm"> * SmartCABLE</span>
<span class="cm"> *</span>
<span class="cm"> *    (c) Copyright 1999-2001  Quicknet Technologies, Inc.</span>
<span class="cm"> *</span>
<span class="cm"> *    This program is free software; you can redistribute it and/or</span>
<span class="cm"> *    modify it under the terms of the GNU General Public License</span>
<span class="cm"> *    as published by the Free Software Foundation; either version</span>
<span class="cm"> *    2 of the License, or (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * Author:          Ed Okerson, &lt;eokerson@quicknet.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Contributors:    Greg Herlein, &lt;gherlein@quicknet.net&gt;</span>
<span class="cm"> *                  David W. Erhart, &lt;derhart@quicknet.net&gt;</span>
<span class="cm"> *                  John Sellers, &lt;jsellers@quicknet.net&gt;</span>
<span class="cm"> *                  Mike Preston, &lt;mpreston@quicknet.net&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Fixes:           David Huggins-Daines, &lt;dhd@cepstral.com&gt;</span>
<span class="cm"> *                  Fabio Ferrari, &lt;fabio.ferrari@digitro.com.br&gt;</span>
<span class="cm"> *                  Artis Kugevics, &lt;artis@mt.lv&gt;</span>
<span class="cm"> *                  Daniele Bellucci, &lt;bellucda@tiscali.it&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * More information about the hardware related to this driver can be found</span>
<span class="cm"> * at our website:    http://www.quicknet.net</span>
<span class="cm"> *</span>
<span class="cm"> * IN NO EVENT SHALL QUICKNET TECHNOLOGIES, INC. BE LIABLE TO ANY PARTY FOR</span>
<span class="cm"> * DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT</span>
<span class="cm"> * OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF QUICKNET</span>
<span class="cm"> * TECHNOLOGIES, INC. HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm"> *</span>
<span class="cm"> * QUICKNET TECHNOLOGIES, INC. SPECIFICALLY DISCLAIMS ANY WARRANTIES,</span>
<span class="cm"> * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY</span>
<span class="cm"> * AND FITNESS FOR A PARTICULAR PURPOSE.  THE SOFTWARE PROVIDED HEREUNDER IS</span>
<span class="cm"> * ON AN &quot;AS IS&quot; BASIS, AND QUICKNET TECHNOLOGIES, INC. HAS NO OBLIGATION</span>
<span class="cm"> * TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.</span>
<span class="cm"> *</span>
<span class="cm"> ***************************************************************************/</span>

<span class="cm">/*</span>
<span class="cm"> * Revision 4.8  2003/07/09 19:39:00  Daniele Bellucci</span>
<span class="cm"> * Audit some copy_*_user and minor cleanup.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.7  2001/08/13 06:19:33  craigs</span>
<span class="cm"> * Added additional changes from Alan Cox and John Anderson for</span>
<span class="cm"> * 2.2 to 2.4 cleanup and bounds checking</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.6  2001/08/13 01:05:05  craigs</span>
<span class="cm"> * Really fixed PHONE_QUERY_CODEC problem this time</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.5  2001/08/13 00:11:03  craigs</span>
<span class="cm"> * Fixed problem in handling of PHONE_QUERY_CODEC, thanks to Shane Anderson</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.4  2001/08/07 07:58:12  craigs</span>
<span class="cm"> * Changed back to three digit version numbers</span>
<span class="cm"> * Added tagbuild target to allow automatic and easy tagging of versions</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.3  2001/08/07 07:24:47  craigs</span>
<span class="cm"> * Added ixj-ver.h to allow easy configuration management of driver</span>
<span class="cm"> * Added display of version number in /prox/ixj</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.2  2001/08/06 07:07:19  craigs</span>
<span class="cm"> * Reverted IXJCTL_DSP_TYPE and IXJCTL_DSP_VERSION files to original</span>
<span class="cm"> * behaviour of returning int rather than short *</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.1  2001/08/05 00:17:37  craigs</span>
<span class="cm"> * More changes for correct PCMCIA installation</span>
<span class="cm"> * Start of changes for backward Linux compatibility</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 4.0  2001/08/04 12:33:12  craigs</span>
<span class="cm"> * New version using GNU autoconf</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.105  2001/07/20 23:14:32  eokerson</span>
<span class="cm"> * More work on CallerID generation when using ring cadences.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.104  2001/07/06 01:33:55  eokerson</span>
<span class="cm"> * Some bugfixes from Robert Vojta &lt;vojta@ipex.cz&gt; and a few mods to the Makefile.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.103  2001/07/05 19:20:16  eokerson</span>
<span class="cm"> * Updated HOWTO</span>
<span class="cm"> * Changed mic gain to 30dB on Internet LineJACK mic/speaker port.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.102  2001/07/03 23:51:21  eokerson</span>
<span class="cm"> * Un-mute mic on Internet LineJACK when in speakerphone mode.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.101  2001/07/02 19:26:56  eokerson</span>
<span class="cm"> * Removed initialiazation of ixjdebug and ixj_convert_loaded so they will go in the .bss instead of the .data</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.100  2001/07/02 19:18:27  eokerson</span>
<span class="cm"> * Changed driver to make dynamic allocation possible.  We now pass IXJ * between functions instead of array indexes.</span>
<span class="cm"> * Fixed the way the POTS and PSTN ports interact during a PSTN call to allow local answering.</span>
<span class="cm"> * Fixed speaker mode on Internet LineJACK.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.99  2001/05/09 14:11:16  eokerson</span>
<span class="cm"> * Fixed kmalloc error in ixj_build_filter_cadence.  Thanks David Chan &lt;cat@waulogy.stanford.edu&gt;.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.98  2001/05/08 19:55:33  eokerson</span>
<span class="cm"> * Fixed POTS hookstate detection while it is connected to PSTN port.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.97  2001/05/08 00:01:04  eokerson</span>
<span class="cm"> * Fixed kernel oops when sending caller ID data.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.96  2001/05/04 23:09:30  eokerson</span>
<span class="cm"> * Now uses one kernel timer for each card, instead of one for the entire driver.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.95  2001/04/25 22:06:47  eokerson</span>
<span class="cm"> * Fixed squawking at beginning of some G.723.1 calls.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.94  2001/04/03 23:42:00  eokerson</span>
<span class="cm"> * Added linear volume ioctls</span>
<span class="cm"> * Added raw filter load ioctl</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.93  2001/02/27 01:00:06  eokerson</span>
<span class="cm"> * Fixed blocking in CallerID.</span>
<span class="cm"> * Reduced size of ixj structure for smaller driver footprint.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.92  2001/02/20 22:02:59  eokerson</span>
<span class="cm"> * Fixed isapnp and pcmcia module compatibility for 2.4.x kernels.</span>
<span class="cm"> * Improved PSTN ring detection.</span>
<span class="cm"> * Fixed wink generation on POTS ports.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.91  2001/02/13 00:55:44  eokerson</span>
<span class="cm"> * Turn AEC back on after changing frame sizes.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.90  2001/02/12 16:42:00  eokerson</span>
<span class="cm"> * Added ALAW codec, thanks to Fabio Ferrari for the table based converters to make ALAW from ULAW.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.89  2001/02/12 15:41:16  eokerson</span>
<span class="cm"> * Fix from Artis Kugevics - Tone gains were not being set correctly.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.88  2001/02/05 23:25:42  eokerson</span>
<span class="cm"> * Fixed lockup bugs with deregister.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.87  2001/01/29 21:00:39  eokerson</span>
<span class="cm"> * Fix from Fabio Ferrari &lt;fabio.ferrari@digitro.com.br&gt; to properly handle EAGAIN and EINTR during non-blocking write.</span>
<span class="cm"> * Updated copyright date.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.86  2001/01/23 23:53:46  eokerson</span>
<span class="cm"> * Fixes to G.729 compatibility.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.85  2001/01/23 21:30:36  eokerson</span>
<span class="cm"> * Added verbage about cards supported.</span>
<span class="cm"> * Removed commands that put the card in low power mode at some times that it should not be in low power mode.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.84  2001/01/22 23:32:10  eokerson</span>
<span class="cm"> * Some bugfixes from David Huggins-Daines, &lt;dhd@cepstral.com&gt; and other cleanups.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.83  2001/01/19 14:51:41  eokerson</span>
<span class="cm"> * Fixed ixj_WriteDSPCommand to decrement usage counter when command fails.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.82  2001/01/19 00:34:49  eokerson</span>
<span class="cm"> * Added verbosity to write overlap errors.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.81  2001/01/18 23:56:54  eokerson</span>
<span class="cm"> * Fixed PSTN line test functions.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.80  2001/01/18 22:29:27  eokerson</span>
<span class="cm"> * Updated AEC/AGC values for different cards.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.79  2001/01/17 02:58:54  eokerson</span>
<span class="cm"> * Fixed AEC reset after Caller ID.</span>
<span class="cm"> * Fixed Codec lockup after Caller ID on Call Waiting when not using 30ms frames.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.78  2001/01/16 19:43:09  eokerson</span>
<span class="cm"> * Added support for Linux 2.4.x kernels.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.77  2001/01/09 04:00:52  eokerson</span>
<span class="cm"> * Linetest will now test the line, even if it has previously succeeded.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.76  2001/01/08 19:27:00  eokerson</span>
<span class="cm"> * Fixed problem with standard cable on Internet PhoneCARD.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.75  2000/12/22 16:52:14  eokerson</span>
<span class="cm"> * Modified to allow hookstate detection on the POTS port when the PSTN port is selected.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.74  2000/12/08 22:41:50  eokerson</span>
<span class="cm"> * Added capability for G729B.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.73  2000/12/07 23:35:16  eokerson</span>
<span class="cm"> * Added capability to have different ring pattern before CallerID data.</span>
<span class="cm"> * Added hookstate checks in CallerID routines to stop FSK.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.72  2000/12/06 19:31:31  eokerson</span>
<span class="cm"> * Modified signal behavior to only send one signal per event.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.71  2000/12/06 03:23:08  eokerson</span>
<span class="cm"> * Fixed CallerID on Call Waiting.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.70  2000/12/04 21:29:37  eokerson</span>
<span class="cm"> * Added checking to Smart Cable gain functions.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.69  2000/12/04 21:05:20  eokerson</span>
<span class="cm"> * Changed ixjdebug levels.</span>
<span class="cm"> * Added ioctls to change gains in Internet Phone CARD Smart Cable.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.68  2000/12/04 00:17:21  craigs</span>
<span class="cm"> * Changed mixer voice gain to +6dB rather than 0dB</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.67  2000/11/30 21:25:51  eokerson</span>
<span class="cm"> * Fixed write signal errors.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.66  2000/11/29 22:42:44  eokerson</span>
<span class="cm"> * Fixed PSTN ring detect problems.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.65  2000/11/29 07:31:55  craigs</span>
<span class="cm"> * Added new 425Hz filter co-efficients</span>
<span class="cm"> * Added card-specific DTMF prescaler initialisation</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.64  2000/11/28 14:03:32  craigs</span>
<span class="cm"> * Changed certain mixer initialisations to be 0dB rather than 12dB</span>
<span class="cm"> * Added additional information to /proc/ixj</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.63  2000/11/28 11:38:41  craigs</span>
<span class="cm"> * Added display of AEC modes in AUTO and AGC mode</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.62  2000/11/28 04:05:44  eokerson</span>
<span class="cm"> * Improved PSTN ring detection routine.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.61  2000/11/27 21:53:12  eokerson</span>
<span class="cm"> * Fixed flash detection.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.60  2000/11/27 15:57:29  eokerson</span>
<span class="cm"> * More work on G.729 load routines.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.59  2000/11/25 21:55:12  eokerson</span>
<span class="cm"> * Fixed errors in G.729 load routine.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.58  2000/11/25 04:08:29  eokerson</span>
<span class="cm"> * Added board locks around G.729 and TS85 load routines.</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.57  2000/11/24 05:35:17  craigs</span>
<span class="cm"> * Added ability to retrieve mixer values on LineJACK</span>
<span class="cm"> * Added complete initialisation of all mixer values at startup</span>
<span class="cm"> * Fixed spelling mistake</span>
<span class="cm"> *</span>
<span class="cm"> * Revision 3.56  2000/11/23 02:52:11  robertj</span>
<span class="cm"> * Added cvs change log keyword.</span>
<span class="cm"> * Fixed bug in capabilities list when using G.729 module.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#include &quot;ixj-ver.h&quot;</span>

<span class="cp">#define PERFMON_STATS</span>
<span class="cp">#define IXJDEBUG 0</span>
<span class="cp">#define MAXRINGS 5</span>

<span class="cp">#include &lt;linux/module.h&gt;</span>

<span class="cp">#include &lt;linux/init.h&gt;</span>
<span class="cp">#include &lt;linux/sched.h&gt;</span>
<span class="cp">#include &lt;linux/kernel.h&gt;	</span><span class="cm">/* printk() */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/fs.h&gt;		</span><span class="cm">/* everything... */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/errno.h&gt;	</span><span class="cm">/* error codes */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>
<span class="cp">#include &lt;linux/mutex.h&gt;</span>
<span class="cp">#include &lt;linux/mm.h&gt;</span>
<span class="cp">#include &lt;linux/ioport.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>
<span class="cp">#include &lt;linux/proc_fs.h&gt;</span>
<span class="cp">#include &lt;linux/poll.h&gt;</span>
<span class="cp">#include &lt;linux/timer.h&gt;</span>
<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/pci.h&gt;</span>

<span class="cp">#include &lt;asm/io.h&gt;</span>
<span class="cp">#include &lt;asm/uaccess.h&gt;</span>

<span class="cp">#include &lt;linux/isapnp.h&gt;</span>

<span class="cp">#include &quot;ixj.h&quot;</span>

<span class="cp">#define TYPE(inode) (iminor(inode) &gt;&gt; 4)</span>
<span class="cp">#define NUM(inode) (iminor(inode) &amp; 0xf)</span>

<span class="k">static</span> <span class="n">DEFINE_MUTEX</span><span class="p">(</span><span class="n">ixj_mutex</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixjdebug</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">hertz</span> <span class="o">=</span> <span class="n">HZ</span><span class="p">;</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">samplerate</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="n">module_param</span><span class="p">(</span><span class="n">ixjdebug</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

<span class="k">static</span> <span class="n">DEFINE_PCI_DEVICE_TABLE</span><span class="p">(</span><span class="n">ixj_pci_tbl</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">{</span> <span class="n">PCI_VENDOR_ID_QUICKNET</span><span class="p">,</span> <span class="n">PCI_DEVICE_ID_QUICKNET_XJ</span><span class="p">,</span>
	  <span class="n">PCI_ANY_ID</span><span class="p">,</span> <span class="n">PCI_ANY_ID</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">},</span>
	<span class="p">{</span> <span class="p">}</span>
<span class="p">};</span>
<span class="n">MODULE_DEVICE_TABLE</span><span class="p">(</span><span class="n">pci</span><span class="p">,</span> <span class="n">ixj_pci_tbl</span><span class="p">);</span>

<span class="cm">/************************************************************************</span>
<span class="cm">*</span>
<span class="cm">* ixjdebug meanings are now bit mapped instead of level based</span>
<span class="cm">* Values can be or&#39;ed together to turn on multiple messages</span>
<span class="cm">*</span>
<span class="cm">* bit  0 (0x0001) = any failure</span>
<span class="cm">* bit  1 (0x0002) = general messages</span>
<span class="cm">* bit  2 (0x0004) = POTS ringing related</span>
<span class="cm">* bit  3 (0x0008) = PSTN events</span>
<span class="cm">* bit  4 (0x0010) = PSTN Cadence state details</span>
<span class="cm">* bit  5 (0x0020) = Tone detection triggers</span>
<span class="cm">* bit  6 (0x0040) = Tone detection cadence details</span>
<span class="cm">* bit  7 (0x0080) = ioctl tracking</span>
<span class="cm">* bit  8 (0x0100) = signal tracking</span>
<span class="cm">* bit  9 (0x0200) = CallerID generation details</span>
<span class="cm">*</span>
<span class="cm">************************************************************************/</span>

<span class="cp">#ifdef IXJ_DYN_ALLOC</span>

<span class="k">static</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">ixj</span><span class="p">[</span><span class="n">IXJMAX</span><span class="p">];</span>
<span class="cp">#define	get_ixj(b)	ixj[(b)]</span>

<span class="cm">/*</span>
<span class="cm"> *	Allocate a free IXJ device</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="n">IXJ</span> <span class="o">*</span><span class="nf">ixj_alloc</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span><span class="o">&lt;</span><span class="n">IXJMAX</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixj</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">==</span> <span class="nb">NULL</span> <span class="o">||</span> <span class="o">!</span><span class="n">ixj</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">j</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
				<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
			<span class="n">ixj</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
			<span class="k">return</span> <span class="n">j</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_fsk_free</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_fsk_alloc</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="mi">8000</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ phone%d - allocate failed</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">return</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">fsksize</span> <span class="o">=</span> <span class="mi">8000</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ phone%d - allocate succeeded</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cp">#else</span>

<span class="k">static</span> <span class="n">IXJ</span> <span class="n">ixj</span><span class="p">[</span><span class="n">IXJMAX</span><span class="p">];</span>
<span class="cp">#define	get_ixj(b)	(&amp;ixj[(b)])</span>

<span class="cm">/*</span>
<span class="cm"> *	Allocate a free IXJ device</span>
<span class="cm"> */</span>

<span class="k">static</span> <span class="n">IXJ</span> <span class="o">*</span><span class="nf">ixj_alloc</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span><span class="o">&lt;</span><span class="n">IXJMAX</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">ixj</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">DSPbase</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">&amp;</span><span class="n">ixj</span><span class="p">[</span><span class="n">cnt</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ixj_fsk_free</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span> <span class="p">{;}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ixj_fsk_alloc</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fsksize</span> <span class="o">=</span> <span class="mi">8000</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#endif</span>

<span class="cp">#ifdef PERFMON_STATS</span>
<span class="cp">#define ixj_perfmon(x)	((x)++)</span>
<span class="cp">#else</span>
<span class="cp">#define ixj_perfmon(x)	do { } while(0)</span>
<span class="cp">#endif</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_convert_loaded</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>

<span class="cm">/************************************************************************</span>
<span class="cm">*</span>
<span class="cm">* These are function definitions to allow external modules to register</span>
<span class="cm">* enhanced functionality call backs.</span>
<span class="cm">*</span>
<span class="cm">************************************************************************/</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">Stub</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span> <span class="n">J</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">IXJ_REGFUNC</span> <span class="n">ixj_PreRead</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Stub</span><span class="p">;</span>
<span class="k">static</span> <span class="n">IXJ_REGFUNC</span> <span class="n">ixj_PostRead</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Stub</span><span class="p">;</span>
<span class="k">static</span> <span class="n">IXJ_REGFUNC</span> <span class="n">ixj_PreWrite</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Stub</span><span class="p">;</span>
<span class="k">static</span> <span class="n">IXJ_REGFUNC</span> <span class="n">ixj_PostWrite</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">Stub</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_read_frame</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_write_frame</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_init_timer</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span>	<span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_timeout</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ptr</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">read_filters</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">LineMonitor</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_fasync</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_set_port</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_set_pots</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_record_start</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_record_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">set_rec_volume</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">volume</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">get_rec_volume</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">set_rec_codec</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_vad</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_play_start</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">arg</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">char</span> <span class="n">tone</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_aec_start</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">level</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">idle</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">aec_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_ringback</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_busytone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_dialtone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_cpt_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">char</span> <span class="n">daa_int_read</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">char</span> <span class="n">daa_CR_read</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cr</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">daa_set_mode</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_linetest</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_daa_cid_read</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">DAA_Coeff_US</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">DAA_Coeff_UK</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">DAA_Coeff_France</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">DAA_Coeff_Germany</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">DAA_Coeff_Australia</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">DAA_Coeff_Japan</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_init_filter</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_FILTER</span> <span class="o">*</span> <span class="n">jf</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_init_filter_raw</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_FILTER_RAW</span> <span class="o">*</span> <span class="n">jfr</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_TONE</span> <span class="o">*</span> <span class="n">ti</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_build_cadence</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_CADENCE</span> <span class="n">__user</span> <span class="o">*</span> <span class="n">cp</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_build_filter_cadence</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_FILTER_CADENCE</span> <span class="n">__user</span> <span class="o">*</span> <span class="n">cp</span><span class="p">);</span>
<span class="cm">/* Serial Control Interface funtions */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">SCI_Control</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">control</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">SCI_WaitHighSCI</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="n">DWORD</span> <span class="n">PCIEE_GetSerialNumber</span><span class="p">(</span><span class="n">WORD</span> <span class="n">wAddress</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_pre_cid</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_write_cid</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bit</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">set_base_frame</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">set_play_codec</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">set_rec_depth</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">depth</span><span class="p">);</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">ixj_mixer</span><span class="p">(</span><span class="kt">long</span> <span class="n">val</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">);</span>

<span class="cm">/************************************************************************</span>
<span class="cm">CT8020/CT8021 Host Programmers Model</span>
<span class="cm">Host address	Function					Access</span>
<span class="cm">DSPbase +</span>
<span class="cm">0-1		Aux Software Status Register (reserved)		Read Only</span>
<span class="cm">2-3		Software Status Register			Read Only</span>
<span class="cm">4-5		Aux Software Control Register (reserved)	Read Write</span>
<span class="cm">6-7		Software Control Register			Read Write</span>
<span class="cm">8-9		Hardware Status Register			Read Only</span>
<span class="cm">A-B		Hardware Control Register			Read Write</span>
<span class="cm">C-D Host Transmit (Write) Data Buffer Access Port (buffer input)Write Only</span>
<span class="cm">E-F Host Receive (Read) Data Buffer Access Port (buffer input)	Read Only</span>
<span class="cm">************************************************************************/</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ixj_read_HSR</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">hsr</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mi">8</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">hsr</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mi">9</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">IsControlReady</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_read_HSR</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hsr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">controlrdy</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">IsPCControlReady</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">crr</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">IsStatusReady</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_read_HSR</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hsr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">statusrdy</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">IsRxReady</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_read_HSR</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rxreadycheck</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hsr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rxrdy</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">IsTxReady</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_read_HSR</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">txreadycheck</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hsr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">txrdy</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">set_play_volume</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">volume</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: /dev/phone%d Setting Play Volume to 0x%4.4x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">volume</span><span class="p">);</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF02</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_play_volume_linear</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">volume</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">newvolume</span><span class="p">,</span> <span class="n">dspplaymax</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: /dev/phone %d Setting Linear Play Volume to 0x%4.4x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">volume</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="o">||</span> <span class="n">volume</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* This should normalize the perceived volumes between the different cards caused by differences in the hardware */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x380</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_PSTN</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x48</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x100</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_LITE</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x380</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x6C</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x50</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">newvolume</span> <span class="o">=</span> <span class="p">(</span><span class="n">dspplaymax</span> <span class="o">*</span> <span class="n">volume</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
	<span class="n">set_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">newvolume</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">set_play_depth</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">depth</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">)</span>
		<span class="n">depth</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5280</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">get_play_volume</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF00</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">get_play_volume_linear</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">volume</span><span class="p">,</span> <span class="n">newvolume</span><span class="p">,</span> <span class="n">dspplaymax</span><span class="p">;</span>

	<span class="cm">/* This should normalize the perceived volumes between the different cards caused by differences in the hardware */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x380</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_PSTN</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x48</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x100</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_LITE</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x380</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mh">0x6C</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
		<span class="n">dspplaymax</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">volume</span> <span class="o">=</span> <span class="n">get_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">newvolume</span> <span class="o">=</span> <span class="p">(</span><span class="n">volume</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">dspplaymax</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">newvolume</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span>
		<span class="n">newvolume</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">newvolume</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">BYTE</span> <span class="nf">SLIC_GetState</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">outw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
		<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
		<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">powerdown</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">PLD_SLIC_STATE_OC</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring0</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring1</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">PLD_SLIC_STATE_ACTIVE</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="k">return</span> <span class="n">PLD_SLIC_STATE_RINGING</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">state</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">bool</span> <span class="nf">SLIC_SetState</span><span class="p">(</span><span class="n">BYTE</span> <span class="n">byState</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">bool</span> <span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">byState</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_TIPOPEN</span>:
			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OC</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">powerdown</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_RINGING</span>:
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">powerdown</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OHT</span>:	<span class="cm">/* On-hook transmit */</span>

			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_STANDBY</span>:
			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_ACTIVE</span>:
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">powerdown</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">powerdown</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ring1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_APR</span>:	<span class="cm">/* Active polarity reversal */</span>

			<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OHTPR</span>:	<span class="cm">/* OHT polarity reversal */</span>

			<span class="nl">default:</span>
				<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="cm">/* Set the C1, C2, C3 &amp; B2EN signals. */</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">byState</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OC</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_RINGING</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_ACTIVE</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OHT</span>:	<span class="cm">/* On-hook transmit */</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_TIPOPEN</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_STANDBY</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_APR</span>:	<span class="cm">/* Active polarity reversal */</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OHTPR</span>:	<span class="cm">/* OHT polarity reversal */</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">b2en</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">fRetVal</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">fRetVal</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_wink</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTE</span> <span class="n">slicnow</span><span class="p">;</span>

	<span class="n">slicnow</span> <span class="o">=</span> <span class="n">SLIC_GetState</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pots_winkstart</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
	<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_OC</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

	<span class="n">msleep</span><span class="p">(</span><span class="n">jiffies_to_msecs</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">winktime</span><span class="p">));</span>

	<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">slicnow</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_init_timer</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">init_timer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">timer</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">timer</span><span class="p">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">ixj_timeout</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">timer</span><span class="p">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span><span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_add_timer</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">timer</span><span class="p">.</span><span class="n">expires</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">/</span> <span class="n">samplerate</span><span class="p">);</span>
	<span class="n">add_timer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">timer</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_tone_timeout</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ_TONE</span> <span class="n">ti</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="o">++</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="o">++</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">elements_used</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">termination</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">case</span> <span class="n">PLAY_ONCE</span>:
					<span class="n">ixj_cpt_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">REPEAT_LAST_ELEMENT</span>:
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="o">--</span><span class="p">;</span>
					<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">REPEAT_ALL</span>:
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq0</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">index</span><span class="p">;</span>
						<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq0</span><span class="p">;</span>
						<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">gain0</span><span class="p">;</span>
						<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq1</span><span class="p">;</span>
						<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">gain1</span><span class="p">;</span>
						<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">tone_on_time</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
					<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">tone_off_time</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
					<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">gain0</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">index</span><span class="p">;</span>
					<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq0</span><span class="p">;</span>
					<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">gain0</span><span class="p">;</span>
					<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq1</span><span class="p">;</span>
					<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">gain1</span><span class="p">;</span>
					<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">tone_on_time</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">tone_off_time</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ixj_kill_fasync</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_SIGEVENT</span> <span class="n">event</span><span class="p">,</span> <span class="kt">int</span> <span class="n">dir</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ixj_signals</span><span class="p">[</span><span class="n">event</span><span class="p">])</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0100</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Sending signal for event %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">event</span><span class="p">);</span>
			<span class="cm">/* Send apps notice of change */</span>
		<span class="cm">/* see config.h for macro definition */</span>
		<span class="n">kill_fasync</span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">async_queue</span><span class="p">),</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ixj_signals</span><span class="p">[</span><span class="n">event</span><span class="p">],</span> <span class="n">dir</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_pstn_state</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">var</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">XOPXR0</span> <span class="n">XR0</span><span class="p">,</span> <span class="n">daaint</span><span class="p">;</span>

	<span class="n">var</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

	<span class="n">XR0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">daaint</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">XR0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daaflag</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">daa_int_read</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RING</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_sleeptil</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RING</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ DAA Ring Interrupt /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_RESET</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">Caller_ID</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">Caller_ID</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_cid_intr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_cid_received</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ DAA Caller_ID Interrupt /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">Cadence</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">Cadence</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ DAA Cadence Interrupt /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span> <span class="o">!=</span> <span class="n">XR0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">SI_0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">daa_CR_read</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span> <span class="o">!=</span> <span class="n">XR0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span> <span class="o">&amp;&amp;</span> <span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_sleeptil</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">SI_1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ DAA RMR /dev/phone%d was %s for %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">XR0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span><span class="o">?</span><span class="s">&quot;on&quot;</span><span class="o">:</span><span class="s">&quot;off&quot;</span><span class="p">,</span> <span class="n">jiffies</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_last_rmr</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_prev_rmr</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_last_rmr</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_last_rmr</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">switch</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">SOP_PU_SLEEP</span>:
			<span class="k">if</span> <span class="p">(</span><span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RING</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_ringing</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">!=</span> <span class="n">SOP_PU_RINGING</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_int</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
						<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_RINGING</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">SOP_PU_RINGING</span>:
			<span class="k">if</span> <span class="p">(</span><span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence a state = %d /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">SI_1</span><span class="p">)</span> <span class="p">{</span>                <span class="cm">/* Rising edge of RMR */</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_rmr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_start</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1</span> <span class="o">*</span> <span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">);</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1</span> <span class="o">*</span> <span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">);</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1</span> <span class="o">*</span> <span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1max</span><span class="p">)))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence fail state = %d /dev/phone%d at %ld should be %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_prev_rmr</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2max</span><span class="p">)))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence fail state = %d /dev/phone%d at %ld should be %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_prev_rmr</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">6</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3max</span><span class="p">)))</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence fail state = %d /dev/phone%d at %ld should be %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_prev_rmr</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>                                <span class="cm">/* Falling edge of RMR */</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
					          <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1max</span><span class="p">)))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence fail state = %d /dev/phone%d at %ld should be %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_prev_rmr</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2max</span><span class="p">)))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence fail state = %d /dev/phone%d at %ld should be %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_prev_rmr</span><span class="p">,</span>
										<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3max</span><span class="p">)))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence fail state = %d /dev/phone%d at %ld should be %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span>
									<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_prev_rmr</span><span class="p">,</span>
									<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Cadence b state = %d /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0010</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">switch</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">case</span> <span class="mi">1</span>:
							<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Ring Cadence state at %u min %ld - %ld - max %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1min</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1dot</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1max</span><span class="p">);</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="mi">2</span>:
							<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Ring Cadence state at %u min %ld - %ld - max %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1min</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1dot</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1max</span><span class="p">);</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="mi">3</span>:
							<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Ring Cadence state at %u min %ld - %ld - max %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2min</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2dot</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2max</span><span class="p">);</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="mi">4</span>:
							<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Ring Cadence state at %u min %ld - %ld - max %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2min</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2dot</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2max</span><span class="p">);</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="mi">5</span>:
							<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Ring Cadence state at %u min %ld - %ld - max %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3min</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3dot</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3max</span><span class="p">);</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="k">case</span> <span class="mi">6</span>:
							<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Ring Cadence state at %u min %ld - %ld - max %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3min</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3dot</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3max</span><span class="p">);</span>
							<span class="k">break</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_PSTN_RING</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring int set /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span><span class="p">((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_int</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_int</span> <span class="o">+</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_rmr</span><span class="p">)</span> <span class="o">||</span>
			   <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span> <span class="o">!=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span> <span class="o">+</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))))</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ DAA no ring in 5 seconds /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
					<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ DAA pstn ring int /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_int</span><span class="p">);</span>
					<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ DAA pstn ring stop /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_SLEEP</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_cid_intr</span> <span class="o">&amp;&amp;</span> <span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_cid_received</span> <span class="o">+</span> <span class="n">hertz</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">ixj_daa_cid_read</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">caller_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_CALLER_ID</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_cid_intr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">Cadence</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ DAA Cadence interrupt going to sleep /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_SLEEP</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">SOP_PU_CONVERSATION</span>:
			<span class="k">if</span> <span class="p">(</span><span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">daaint</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">SI_0</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_winkstart</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ DAA possible wink /dev/phone%d %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_winkstart</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_winkstart</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ DAA possible wink end /dev/phone%d %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_winkstart</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_winkstart</span> <span class="o">&amp;&amp;</span> <span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_winkstart</span> <span class="o">+</span> <span class="p">((</span><span class="n">hertz</span> <span class="o">*</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">winktime</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)))</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ DAA wink detected going to sleep /dev/phone%d %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_SLEEP</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_winkstart</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_wink</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_PSTN_WINK</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_timeout</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ptr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">board</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">jifon</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="p">)</span><span class="n">ptr</span><span class="p">;</span>
	<span class="n">board</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">&amp;&amp;</span> <span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">test_and_set_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">timerchecks</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span> <span class="o">=</span> <span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">ixj_cpt_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_hook</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_hook</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hookstate</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_HOOKSTATE</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
				<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="k">return</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">jifon</span> <span class="o">=</span> <span class="p">((</span><span class="n">hertz</span> <span class="o">*</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_on_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">/</span> <span class="mi">100000</span><span class="p">);</span>
			<span class="k">else</span>
				<span class="n">jifon</span> <span class="o">=</span> <span class="p">((</span><span class="n">hertz</span> <span class="o">*</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_on_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">/</span> <span class="mi">100000</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="n">hertz</span> <span class="o">*</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_off_time</span><span class="p">)</span> <span class="o">*</span> <span class="mi">25</span> <span class="o">/</span> <span class="mi">100000</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_start_jif</span> <span class="o">+</span> <span class="n">jifon</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_index</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
						<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
						<span class="k">return</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
						<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
						<span class="k">return</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">ixj_tone_timeout</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dialtone</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">ixj_dialtone</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">busytone</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">ixj_busytone</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
						<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
						<span class="k">return</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringback</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">ixj_ringback</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
						<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
						<span class="k">return</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">ixj_cpt_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">IsRxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">ixj_read_frame</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">ixj_write_frame</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cringing</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">enable</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">en_filter</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">en_filter</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">firstring</span><span class="p">)))</span> <span class="p">{</span>
				<span class="k">switch</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">case</span> <span class="mi">0</span>:
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on1dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on1dot</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">1</span>:
						<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on1dot</span><span class="p">))</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off1dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">2</span>:
						<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off1dot</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on2</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on2dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">3</span>:
						<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on2dot</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off2</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off2dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">4</span>:
						<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off2dot</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on3</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on3dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">5</span>:
						<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on3dot</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off3</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off3dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
							<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
								<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
							<span class="p">}</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">6</span>:
						<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">off3dot</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
							<span class="p">}</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">7</span>:
						<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Ringing cadence state = %d - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_OHT</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
						<span class="n">ixj_pre_cid</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
				<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="k">return</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_jif</span> <span class="o">+</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)))</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_OHT</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
							<span class="n">ixj_pre_cid</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
						<span class="p">}</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_t</span><span class="o">--</span><span class="p">;</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_t</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_t</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_jif</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>

					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_t</span><span class="p">)</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">en_filter</span><span class="p">)</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">firstring</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
						<span class="k">else</span>
							<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
						<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span><span class="p">)</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
				<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="k">return</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* &amp; 1) { */</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span> <span class="o">&amp;&amp;</span>
				    <span class="n">SLIC_GetState</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="n">PLD_SLIC_STATE_ACTIVE</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_ACTIVE</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">LineMonitor</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="n">read_filters</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x511B</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">proc_load</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_hook</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_hook</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hookstate</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_HOOKSTATE</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_hook</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_hook</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hookstate</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_HOOKSTATE</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstncheck</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ixj_pstn_state</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bytes</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">poll_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked selects */</span>
		<span class="p">}</span>
		<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_status_wait</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">jif</span><span class="p">;</span>

	<span class="n">jif</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">((</span><span class="mi">60</span> <span class="o">*</span> <span class="n">hertz</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsStatusReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">statuswait</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">jif</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">statuswaitfail</span><span class="p">);</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">jif</span><span class="p">;</span>

	<span class="n">jif</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">((</span><span class="mi">60</span> <span class="o">*</span> <span class="n">hertz</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsPCControlReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pcontrolwait</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">jif</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pcontrolwaitfail</span><span class="p">);</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_WriteDSPCommand</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">jif</span><span class="p">;</span>

	<span class="n">atomic_inc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d DSP write overlap attempting command 0x%4.4x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">cmd</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">cmd</span> <span class="o">&amp;</span> <span class="mh">0xFF00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">cmd</span> <span class="o">&amp;</span> <span class="mh">0x00FF</span><span class="p">;</span>
	<span class="n">jif</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">((</span><span class="mi">60</span> <span class="o">*</span> <span class="n">hertz</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsControlReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">iscontrolready</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">jif</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">ixj_perfmon</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">iscontrolreadyfail</span><span class="p">);</span>
			<span class="n">atomic_dec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
			<span class="k">if</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d DSP overlaped command 0x%4.4x during control ready failure.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">cmd</span><span class="p">);</span>
				<span class="k">while</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">atomic_dec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mi">6</span><span class="p">);</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mi">7</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_status_wait</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
		<span class="n">atomic_dec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d DSP overlaped command 0x%4.4x during status wait failure.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">cmd</span><span class="p">);</span>
			<span class="k">while</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">atomic_dec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
<span class="cm">/* Read Software Status Register */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
	<span class="n">atomic_dec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d DSP overlaped command 0x%4.4x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">cmd</span><span class="p">);</span>
		<span class="k">while</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">atomic_dec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/***************************************************************************</span>
<span class="cm">*</span>
<span class="cm">*  General Purpose IO Register read routine</span>
<span class="cm">*</span>
<span class="cm">***************************************************************************/</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ixj_gpio_read</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5143</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">LED_SetState</span><span class="p">(</span><span class="kt">int</span> <span class="n">state</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">led1</span> <span class="o">=</span> <span class="n">state</span> <span class="o">&amp;</span> <span class="mh">0x1</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">led2</span> <span class="o">=</span> <span class="n">state</span> <span class="o">&amp;</span> <span class="mh">0x2</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">led3</span> <span class="o">=</span> <span class="n">state</span> <span class="o">&amp;</span> <span class="mh">0x4</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">led4</span> <span class="o">=</span> <span class="n">state</span> <span class="o">&amp;</span> <span class="mh">0x8</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>

		<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="cm">/*********************************************************************</span>
<span class="cm">*  GPIO Pins are configured as follows on the Quicknet Internet</span>
<span class="cm">*  PhoneJACK Telephony Cards</span>
<span class="cm">*</span>
<span class="cm">* POTS Select        GPIO_6=0 GPIO_7=0</span>
<span class="cm">* Mic/Speaker Select GPIO_6=0 GPIO_7=1</span>
<span class="cm">* Handset Select     GPIO_6=1 GPIO_7=0</span>
<span class="cm">*</span>
<span class="cm">* SLIC Active        GPIO_1=0 GPIO_2=1 GPIO_5=0</span>
<span class="cm">* SLIC Ringing       GPIO_1=1 GPIO_2=1 GPIO_5=0</span>
<span class="cm">* SLIC Open Circuit  GPIO_1=0 GPIO_2=0 GPIO_5=0</span>
<span class="cm">*</span>
<span class="cm">* Hook Switch changes reported on GPIO_3</span>
<span class="cm">*********************************************************************/</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_set_port</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK_LITE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">arg</span> <span class="o">!=</span> <span class="n">PORT_POTS</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">10</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">PORT_POTS</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_POTS</span><span class="p">;</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_ACTIVE</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="k">else</span>
				<span class="k">return</span> <span class="mi">11</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">mic</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">spk</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
			<span class="n">ixj_set_pots</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>			<span class="cm">/* Disconnect POTS/PSTN relay */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xC528</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Write CODEC config to</span>
<span class="cm">									   Software Control Register */</span>
				<span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_clock</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_clock</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x04</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">spken</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1200</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Turn Off MIC switch on mixer left */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1401</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Turn On Mono1 switch on mixer left */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1300</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>       <span class="cm">/* Turn Off MIC switch on mixer right */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1501</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>       <span class="cm">/* Turn On Mono1 switch on mixer right */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0E80</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mic mute */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0F00</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set mono out (SLIC) to 0dB */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0080</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Mute Master Left volume */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0180</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Mute Master Right volume */</span>
			<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_STANDBY</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="cm">/*			SLIC_SetState(PLD_SLIC_STATE_ACTIVE, j); */</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">word</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PORT_PSTN</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xC534</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Write CODEC config to Software Control Register */</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">spken</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_PSTN</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">return</span> <span class="mi">4</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PORT_SPEAKER</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_SPEAKER</span><span class="p">;</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_OC</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">mic</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">spk</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
			<span class="n">ixj_set_pots</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>			<span class="cm">/* Disconnect POTS/PSTN relay */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xC528</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Write CODEC config to</span>
<span class="cm">									   Software Control Register */</span>
				<span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_clock</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_clock</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x04</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">spken</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1201</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Turn On MIC switch on mixer left */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1400</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Turn Off Mono1 switch on mixer left */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1301</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>       <span class="cm">/* Turn On MIC switch on mixer right */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1500</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>       <span class="cm">/* Turn Off Mono1 switch on mixer right */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0E06</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mic un-mute 0dB */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0F80</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Mute mono out (SLIC) */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set Master Left volume to 0dB */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0100</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set Master Right volume to 0dB */</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio6</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio7</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">word</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PORT_HANDSET</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">!=</span> <span class="n">QTI_PHONEJACK</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="mi">5</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio6</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio7</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">word</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_HANDSET</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="mi">6</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_set_pots</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_PSTN</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_ring_on</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span>	<span class="cm">/* Internet PhoneJACK */</span>
	 <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring On /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> 	<span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">word</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* send the ring signal */</span>
	<span class="p">}</span> <span class="k">else</span>			<span class="cm">/* Internet LineJACK, Internet PhoneJACK Lite or Internet PhoneJACK PCI */</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring On /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>

		<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_RINGING</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_siadc</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciascp</span><span class="p">){</span>
			<span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">siadc</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rxg</span><span class="p">;</span>

			<span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mh">0x1F</span><span class="p">)</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">siadc</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Handset Out Mute */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">siadc</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">lom</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Line Out Mute */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">siadc</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rxg</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>			<span class="cm">/*(0xC000 - 0x41C8) / 0x4EF;    RX PGA Gain */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">siadc</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">siadc</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rxg</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_sidac</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">val</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">){</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciascp</span><span class="p">){</span>
			<span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
				<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">sidac</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">txg</span><span class="p">;</span>

			<span class="k">if</span><span class="p">(</span><span class="n">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="mh">0x1F</span><span class="p">)</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sidac</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">srm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>				<span class="cm">/* Speaker Right Mute */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sidac</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">slm</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>				<span class="cm">/* Speaker Left Mute */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sidac</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">txg</span> <span class="o">=</span> <span class="n">val</span><span class="p">;</span>			<span class="cm">/* (0xC000 - 0x45E4) / 0x5D3;	 TX PGA Gain */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sidac</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">sidac</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">txg</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_pcmcia_cable_check</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">drf</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rstc</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ed</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">ed</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">led2</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">det</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">led2</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">r_hook</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">drf</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pwr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rstc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">checkwait</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">incheck</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">incheck</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">checkwait</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">incheck</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pwr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rstc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">drf</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciascp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>		<span class="cm">/* Set Cable Present Flag */</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span> <span class="o">=</span> <span class="p">(</span><span class="n">inw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">;</span>		<span class="cm">/* Get Cable Type */</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pwr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rstc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr2</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_SPEAKER</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_POTS</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">cpd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Chip Power Down */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">mpd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* MIC Bias Power Down */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hpd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Handset Bias Power Down */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">lpd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Line Bias Power Down */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">spd</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>				<span class="cm">/* Speaker Drive Power Down */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sic1</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">al</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Analog Loopback DAC analog -&gt; ADC analog */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dl2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Digital Loopback DAC -&gt; ADC one bit */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dl1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Digital Loopback ADC -&gt; DAC one bit */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pll</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* 1 = div 10, 0 = div 5 */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sic2</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hpd</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* HPF disable */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sic2</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>		<span class="cm">/* PLL Divide N1 */</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="mh">0x09</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>		<span class="cm">/* PLL Multiply M1 */</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sirxg</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">lig</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>				<span class="cm">/* Line In Gain */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sirxg</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">lim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>				<span class="cm">/* Line In Mute */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sirxg</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">mcg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* MIC In Gain was 3 */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sirxg</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">mcm</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* MIC In Mute */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sirxg</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">him</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Handset In Mute */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">sirxg</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">iir</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>				<span class="cm">/* IIR */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sirxg</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_siadc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">);</span>
			<span class="n">ixj_sidac</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">);</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">siaatt</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">sot</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>				<span class="cm">/* R/W Smart Cable Register Address */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>				<span class="cm">/* Read / Write flag */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">siaatt</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
			<span class="n">outb</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">powerdown</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">outw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
				<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciascp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_hookstate</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">fOffHook</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
		<span class="n">ixj_gpio_read</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">fOffHook</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio3read</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_LITE</span>:
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
		<span class="n">SLIC_GetState</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">fOffHook</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">potspstn</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">fOffHook</span> <span class="o">!=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">p_hook</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">checkwait</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">checkwait</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">if</span><span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">checkwait</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">fOffHook</span> <span class="o">^=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">checkwait</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">p_hook</span> <span class="o">=</span> <span class="n">fOffHook</span><span class="p">;</span>
	 			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ : /dev/phone%d pots-pstn hookstate check %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">fOffHook</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">PLD_SLIC_STATE_ACTIVE</span> <span class="o">||</span>
			    <span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">PLD_SLIC_STATE_STANDBY</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cringing</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">in_interrupt</span><span class="p">())</span> <span class="p">{</span>
						<span class="n">msleep</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span>
					<span class="p">}</span>
					<span class="n">SLIC_GetState</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">PLD_SLIC_STATE_RINGING</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK_PCI</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
					<span class="n">fOffHook</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">det</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span> <span class="k">else</span>
					<span class="n">fOffHook</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">det</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
		<span class="n">fOffHook</span> <span class="o">=</span> <span class="n">ixj_pcmcia_cable_check</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">r_hook</span> <span class="o">!=</span> <span class="n">fOffHook</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">r_hook</span> <span class="o">=</span> <span class="n">fOffHook</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_SPEAKER</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_HANDSET</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// || (j-&gt;port == PORT_PSTN &amp;&amp; j-&gt;flags.pots_pstn == 0)) {</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hookstate</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_HOOKSTATE</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">fOffHook</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flash_end</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">((</span><span class="mi">60</span> <span class="o">*</span> <span class="n">hertz</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">fOffHook</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flash_end</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">flash</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flash_end</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_FLASH</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flash_end</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">fOffHook</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_PSTN</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">==</span> <span class="n">SOP_PU_CONVERSATION</span><span class="p">)</span>
		<span class="n">fOffHook</span> <span class="o">|=</span> <span class="mi">2</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_SPEAKER</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciascp</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">fOffHook</span> <span class="o">|=</span> <span class="mi">2</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">fOffHook</span> <span class="o">|=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_HANDSET</span><span class="p">)</span>
		<span class="n">fOffHook</span> <span class="o">|=</span> <span class="mi">2</span><span class="p">;</span>

	<span class="k">return</span> <span class="n">fOffHook</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_ring_off</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span>	<span class="cm">/* Internet PhoneJACK */</span>
	 <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Off</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">word</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span>			<span class="cm">/* Internet LineJACK */</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Ring Off</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span><span class="p">)</span>
			<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_STANDBY</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

		<span class="n">SLIC_GetState</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_ring_start</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cringing</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Cadence Ringing Start /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_POTS</span><span class="p">)</span>
			<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0004</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Cadence Ringing Stopped /dev/phone%d off hook</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">enable</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">en_filter</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_jif</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">on1</span><span class="p">)</span>
			<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_jif</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_t</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence_t</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">firstring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_ring</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">cntr</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">jif</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cntr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cntr</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">maxrings</span><span class="p">;</span> <span class="n">cntr</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">jif</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">hertz</span><span class="p">);</span>
		<span class="n">ixj_ring_on</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">jif</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">signal_pending</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
				<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">jif</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">hertz</span><span class="p">);</span>
		<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">while</span> <span class="p">(</span><span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">jif</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">msleep</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">signal_pending</span><span class="p">(</span><span class="n">current</span><span class="p">))</span>
				<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_open</span><span class="p">(</span><span class="k">struct</span> <span class="n">phone_device</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file_p</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">p</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
	<span class="n">file_p</span><span class="o">-&gt;</span><span class="n">private_data</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_mode</span> <span class="o">&amp;</span> <span class="n">FMODE_READ</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span><span class="p">)</span> <span class="p">{</span>
	                <span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span><span class="o">++</span><span class="p">;</span>
        	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                	<span class="k">return</span> <span class="o">-</span><span class="n">EBUSY</span><span class="p">;</span>
		<span class="p">}</span>
        <span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_mode</span> <span class="o">&amp;</span> <span class="n">FMODE_WRITE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_mode</span> <span class="o">&amp;</span> <span class="n">FMODE_READ</span><span class="p">){</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span><span class="o">--</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EBUSY</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">powerdown</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dev</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rw</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">outw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">psccr</span><span class="p">.</span><span class="n">byte</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pslic</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">);</span>
		<span class="n">ixj_PCcontrol_wait</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidcw_ack</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Opening board %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">p</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">framesread</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">frameswritten</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_release</span><span class="p">(</span><span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">inode</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file_p</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ_TONE</span> <span class="n">ti</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">file_p</span><span class="o">-&gt;</span><span class="n">private_data</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">board</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">board</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 *    Set up locks to ensure that only one process is talking to the DSP at a time.</span>
<span class="cm">	 *    This is necessary to keep the DSP from locking up.</span>
<span class="cm">	 */</span>
	<span class="k">while</span><span class="p">(</span><span class="n">test_and_set_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Closing board %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">NUM</span><span class="p">(</span><span class="n">inode</span><span class="p">));</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span>
		<span class="n">ixj_set_port</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">PORT_SPEAKER</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">ixj_set_port</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">PORT_POTS</span><span class="p">);</span>

	<span class="n">aec_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_record_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">set_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">);</span>
	<span class="n">set_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">);</span>
	<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="cm">/* Restore the tone table to default settings. */</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz941</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">hz1209</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">11</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz941</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">hz1336</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz941</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">hz1477</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">13</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz800</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">14</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1000</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1250</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz950</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">17</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1100</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1400</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1500</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1600</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1800</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">22</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz2100</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz1300</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz2450</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz350</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">hz440</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">26</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz440</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">hz480</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">27</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz480</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">hz620</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>

	<span class="n">set_rec_depth</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>	<span class="cm">/* Set Record Channel Limit to 2 frames */</span>

	<span class="n">set_play_depth</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>	<span class="cm">/* Set Playback Channel Limit to 2 frames */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">maxrings</span> <span class="o">=</span> <span class="n">MAXRINGS</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence</span> <span class="o">=</span> <span class="n">USA_RING_CADENCE</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">enable</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">enable</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">en_filter</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">drybuffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">winktime</span> <span class="o">=</span> <span class="mi">320</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dtmf_oob</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">enable</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">idle</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_OC</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_mode</span> <span class="o">&amp;</span> <span class="n">FMODE_READ</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span><span class="o">--</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_mode</span> <span class="o">&amp;</span> <span class="n">FMODE_WRITE</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="o">--</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_set_port</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">PORT_PSTN</span><span class="p">);</span>
		<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_SLEEP</span><span class="p">);</span>
		<span class="n">ixj_set_pots</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0FE3</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Put the DSP in 1/5 power mode. */</span>

	<span class="cm">/* Set up the default signals for events */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ixj_signals</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">SIGIO</span><span class="p">;</span>

	<span class="cm">/* Set the excetion signal enable flags */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hookstate</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">flash</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">caller_id</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_wink</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f2</span> <span class="o">=</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f3</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">file_p</span><span class="o">-&gt;</span><span class="n">private_data</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">read_filters</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">fc</span><span class="p">,</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">trg</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">var</span><span class="p">;</span>

	<span class="n">trg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5144</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Read Frame Counter failed!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">fc</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">fc</span> <span class="o">==</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">frame_count</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">frame_count</span> <span class="o">=</span> <span class="n">fc</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_proc</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">var</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5154</span> <span class="o">+</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Select Filter %d failed!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x515C</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Read Filter History %d failed!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">enable</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">12</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span>
					   <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
					    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1max</span><span class="p">)))</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span>
					   <span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
					    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2max</span><span class="p">)))</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">12</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
					<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
					  <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1max</span><span class="p">)))</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span><span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
					    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2max</span><span class="p">)))</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">((</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3min</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
					    <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3max</span><span class="p">)))</span> <span class="p">{</span>
						<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3min</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3dot</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3max</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="kt">long</span><span class="p">)((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3</span> <span class="o">*</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="n">var</span><span class="p">))</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">));</span>
						<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
						<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="k">switch</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">case</span> <span class="mi">1</span>:
						<span class="k">if</span><span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1dot</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						   <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1</span> <span class="o">&amp;&amp;</span>
						   <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2</span> <span class="o">&amp;&amp;</span>
						   <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">3</span>:
						<span class="k">if</span><span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2dot</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						   <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2</span> <span class="o">&amp;&amp;</span>
						   <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">5</span>:
						<span class="k">if</span><span class="p">(</span><span class="n">time_after</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3dot</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
						   <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
						<span class="p">}</span>
						<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ Tone Cadence state = %d /dev/phone%d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="k">switch</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">case</span> <span class="mi">0</span>:
						<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d No Tone detected</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">1</span>:
						<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Tone Cadence state at %u %ld - %ld - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1min</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1dot</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on1max</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">2</span>:
						<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Tone Cadence state at %ld - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1min</span><span class="p">,</span>
															<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off1max</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">3</span>:
						<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Tone Cadence state at %ld - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2min</span><span class="p">,</span>
															<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on2max</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">4</span>:
						<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Tone Cadence state at %ld - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2min</span><span class="p">,</span>
															<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off2max</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">5</span>:
						<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Tone Cadence state at %ld - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3min</span><span class="p">,</span>
															<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">on3max</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="k">case</span> <span class="mi">6</span>:
						<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ /dev/phone%d Next Tone Cadence state at %ld - %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3min</span><span class="p">,</span>
															<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">off3max</span><span class="p">);</span>
						<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">==</span> <span class="mi">7</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">enable</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">enable</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">cnt</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="mi">0</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter Cadence 0 triggered %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_FC0</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">1</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter Cadence 1 triggered %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_FC1</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">2</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter Cadence 2 triggered %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_FC2</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">3</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter Cadence 3 triggered %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_FC3</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_en</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">12</span><span class="p">))</span> <span class="o">||</span>
					  <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">12</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">))))</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">12</span><span class="p">)))</span> <span class="p">{</span>
				<span class="n">trg</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">12</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)))</span> <span class="p">{</span>
				<span class="n">trg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">cnt</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="mi">0</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter 0 triggered %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">trg</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_F0</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">1</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter 1 triggered %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">trg</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_F1</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">2</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter 2 triggered %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">trg</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_F2</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mi">3</span>:
				<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Filter 3 triggered %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">trg</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_F3</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">LineMonitor</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_proc</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_proc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x7000</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Line Monitor */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_state</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_valid</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_current</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">digit</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_state</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_valid</span><span class="p">)</span>	<span class="cm">/* &amp;&amp; j-&gt;dtmf_wp != j-&gt;dtmf_rp) */</span>
	 <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcw_wait</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmfbuffer</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_current</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span><span class="o">++</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span> <span class="o">==</span> <span class="mi">79</span><span class="p">)</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_DTMF_READY</span><span class="p">,</span> <span class="n">POLL_IN</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_current</span> <span class="o">==</span> <span class="mh">0x00</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_current</span> <span class="o">==</span> <span class="mh">0x0D</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0020</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ phone%d saw CIDCW Ack DTMF %d from display at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_current</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidcw_ack</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_proc</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/************************************************************************</span>
<span class="cm">*</span>
<span class="cm">* Functions to allow alaw &lt;-&gt; ulaw conversions.</span>
<span class="cm">*</span>
<span class="cm">************************************************************************/</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ulaw2alaw</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buff</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">table_ulaw2alaw</span><span class="p">[]</span> <span class="o">=</span>
	<span class="p">{</span>
		<span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span>
		<span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span>
		<span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span>
		<span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span>
		<span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">,</span>
		<span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x1A</span><span class="p">,</span>
		<span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span> <span class="mh">0x12</span><span class="p">,</span>
		<span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span>
		<span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span> <span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span>
		<span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span> <span class="mh">0x7B</span><span class="p">,</span> <span class="mh">0x79</span><span class="p">,</span>
		<span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x7F</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x7D</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x73</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x71</span><span class="p">,</span>
		<span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x77</span><span class="p">,</span> <span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x75</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span>
		<span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span>
		<span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span>
		<span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span>
		<span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span>
		<span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span>
		<span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span>
		<span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span>
		<span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span>
		<span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span>
		<span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span> <span class="mh">0x9A</span><span class="p">,</span>
		<span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span>
		<span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span>
		<span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span> <span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span>
		<span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span> <span class="mh">0xFB</span><span class="p">,</span> <span class="mh">0xF9</span><span class="p">,</span>
		<span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xFD</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xF3</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xF1</span><span class="p">,</span>
		<span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xF7</span><span class="p">,</span> <span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xF5</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span>
		<span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span> <span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span>
		<span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span>
		<span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span> <span class="mh">0xD1</span><span class="p">,</span>
		<span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0xD5</span>
	<span class="p">};</span>

	<span class="k">while</span> <span class="p">(</span><span class="n">len</span><span class="o">--</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="o">*</span><span class="n">buff</span> <span class="o">=</span> <span class="n">table_ulaw2alaw</span><span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">buff</span><span class="p">];</span>
		<span class="n">buff</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">alaw2ulaw</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">buff</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">table_alaw2ulaw</span><span class="p">[]</span> <span class="o">=</span>
	<span class="p">{</span>
		<span class="mh">0x29</span><span class="p">,</span> <span class="mh">0x2A</span><span class="p">,</span> <span class="mh">0x27</span><span class="p">,</span> <span class="mh">0x28</span><span class="p">,</span> <span class="mh">0x2D</span><span class="p">,</span> <span class="mh">0x2E</span><span class="p">,</span> <span class="mh">0x2B</span><span class="p">,</span> <span class="mh">0x2C</span><span class="p">,</span>
		<span class="mh">0x21</span><span class="p">,</span> <span class="mh">0x22</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="mh">0x25</span><span class="p">,</span> <span class="mh">0x26</span><span class="p">,</span> <span class="mh">0x23</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span>
		<span class="mh">0x39</span><span class="p">,</span> <span class="mh">0x3A</span><span class="p">,</span> <span class="mh">0x37</span><span class="p">,</span> <span class="mh">0x38</span><span class="p">,</span> <span class="mh">0x3D</span><span class="p">,</span> <span class="mh">0x3E</span><span class="p">,</span> <span class="mh">0x3B</span><span class="p">,</span> <span class="mh">0x3C</span><span class="p">,</span>
		<span class="mh">0x31</span><span class="p">,</span> <span class="mh">0x32</span><span class="p">,</span> <span class="mh">0x2F</span><span class="p">,</span> <span class="mh">0x30</span><span class="p">,</span> <span class="mh">0x35</span><span class="p">,</span> <span class="mh">0x36</span><span class="p">,</span> <span class="mh">0x33</span><span class="p">,</span> <span class="mh">0x34</span><span class="p">,</span>
		<span class="mh">0x0A</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">,</span> <span class="mh">0x08</span><span class="p">,</span> <span class="mh">0x09</span><span class="p">,</span> <span class="mh">0x0E</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x0C</span><span class="p">,</span> <span class="mh">0x0D</span><span class="p">,</span>
		<span class="mh">0x02</span><span class="p">,</span> <span class="mh">0x03</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">,</span> <span class="mh">0x06</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">,</span> <span class="mh">0x04</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span>
		<span class="mh">0x1A</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">,</span> <span class="mh">0x18</span><span class="p">,</span> <span class="mh">0x19</span><span class="p">,</span> <span class="mh">0x1E</span><span class="p">,</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="mh">0x1C</span><span class="p">,</span> <span class="mh">0x1D</span><span class="p">,</span>
		<span class="mh">0x12</span><span class="p">,</span> <span class="mh">0x13</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="mh">0x11</span><span class="p">,</span> <span class="mh">0x16</span><span class="p">,</span> <span class="mh">0x17</span><span class="p">,</span> <span class="mh">0x14</span><span class="p">,</span> <span class="mh">0x15</span><span class="p">,</span>
		<span class="mh">0x62</span><span class="p">,</span> <span class="mh">0x63</span><span class="p">,</span> <span class="mh">0x60</span><span class="p">,</span> <span class="mh">0x61</span><span class="p">,</span> <span class="mh">0x66</span><span class="p">,</span> <span class="mh">0x67</span><span class="p">,</span> <span class="mh">0x64</span><span class="p">,</span> <span class="mh">0x65</span><span class="p">,</span>
		<span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0x5D</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x5C</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x5F</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span> <span class="mh">0x5E</span><span class="p">,</span>
		<span class="mh">0x74</span><span class="p">,</span> <span class="mh">0x76</span><span class="p">,</span> <span class="mh">0x70</span><span class="p">,</span> <span class="mh">0x72</span><span class="p">,</span> <span class="mh">0x7C</span><span class="p">,</span> <span class="mh">0x7E</span><span class="p">,</span> <span class="mh">0x78</span><span class="p">,</span> <span class="mh">0x7A</span><span class="p">,</span>
		<span class="mh">0x6A</span><span class="p">,</span> <span class="mh">0x6B</span><span class="p">,</span> <span class="mh">0x68</span><span class="p">,</span> <span class="mh">0x69</span><span class="p">,</span> <span class="mh">0x6E</span><span class="p">,</span> <span class="mh">0x6F</span><span class="p">,</span> <span class="mh">0x6C</span><span class="p">,</span> <span class="mh">0x6D</span><span class="p">,</span>
		<span class="mh">0x48</span><span class="p">,</span> <span class="mh">0x49</span><span class="p">,</span> <span class="mh">0x46</span><span class="p">,</span> <span class="mh">0x47</span><span class="p">,</span> <span class="mh">0x4C</span><span class="p">,</span> <span class="mh">0x4D</span><span class="p">,</span> <span class="mh">0x4A</span><span class="p">,</span> <span class="mh">0x4B</span><span class="p">,</span>
		<span class="mh">0x40</span><span class="p">,</span> <span class="mh">0x41</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x3F</span><span class="p">,</span> <span class="mh">0x44</span><span class="p">,</span> <span class="mh">0x45</span><span class="p">,</span> <span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x43</span><span class="p">,</span>
		<span class="mh">0x56</span><span class="p">,</span> <span class="mh">0x57</span><span class="p">,</span> <span class="mh">0x54</span><span class="p">,</span> <span class="mh">0x55</span><span class="p">,</span> <span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x5B</span><span class="p">,</span> <span class="mh">0x58</span><span class="p">,</span> <span class="mh">0x59</span><span class="p">,</span>
		<span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x4F</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x4E</span><span class="p">,</span> <span class="mh">0x52</span><span class="p">,</span> <span class="mh">0x53</span><span class="p">,</span> <span class="mh">0x50</span><span class="p">,</span> <span class="mh">0x51</span><span class="p">,</span>
		<span class="mh">0xA9</span><span class="p">,</span> <span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xA7</span><span class="p">,</span> <span class="mh">0xA8</span><span class="p">,</span> <span class="mh">0xAD</span><span class="p">,</span> <span class="mh">0xAE</span><span class="p">,</span> <span class="mh">0xAB</span><span class="p">,</span> <span class="mh">0xAC</span><span class="p">,</span>
		<span class="mh">0xA1</span><span class="p">,</span> <span class="mh">0xA2</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0xA0</span><span class="p">,</span> <span class="mh">0xA5</span><span class="p">,</span> <span class="mh">0xA6</span><span class="p">,</span> <span class="mh">0xA3</span><span class="p">,</span> <span class="mh">0xA4</span><span class="p">,</span>
		<span class="mh">0xB9</span><span class="p">,</span> <span class="mh">0xBA</span><span class="p">,</span> <span class="mh">0xB7</span><span class="p">,</span> <span class="mh">0xB8</span><span class="p">,</span> <span class="mh">0xBD</span><span class="p">,</span> <span class="mh">0xBE</span><span class="p">,</span> <span class="mh">0xBB</span><span class="p">,</span> <span class="mh">0xBC</span><span class="p">,</span>
		<span class="mh">0xB1</span><span class="p">,</span> <span class="mh">0xB2</span><span class="p">,</span> <span class="mh">0xAF</span><span class="p">,</span> <span class="mh">0xB0</span><span class="p">,</span> <span class="mh">0xB5</span><span class="p">,</span> <span class="mh">0xB6</span><span class="p">,</span> <span class="mh">0xB3</span><span class="p">,</span> <span class="mh">0xB4</span><span class="p">,</span>
		<span class="mh">0x8A</span><span class="p">,</span> <span class="mh">0x8B</span><span class="p">,</span> <span class="mh">0x88</span><span class="p">,</span> <span class="mh">0x89</span><span class="p">,</span> <span class="mh">0x8E</span><span class="p">,</span> <span class="mh">0x8F</span><span class="p">,</span> <span class="mh">0x8C</span><span class="p">,</span> <span class="mh">0x8D</span><span class="p">,</span>
		<span class="mh">0x82</span><span class="p">,</span> <span class="mh">0x83</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x81</span><span class="p">,</span> <span class="mh">0x86</span><span class="p">,</span> <span class="mh">0x87</span><span class="p">,</span> <span class="mh">0x84</span><span class="p">,</span> <span class="mh">0x85</span><span class="p">,</span>
		<span class="mh">0x9A</span><span class="p">,</span> <span class="mh">0x9B</span><span class="p">,</span> <span class="mh">0x98</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x9E</span><span class="p">,</span> <span class="mh">0x9F</span><span class="p">,</span> <span class="mh">0x9C</span><span class="p">,</span> <span class="mh">0x9D</span><span class="p">,</span>
		<span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x93</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">,</span> <span class="mh">0x91</span><span class="p">,</span> <span class="mh">0x96</span><span class="p">,</span> <span class="mh">0x97</span><span class="p">,</span> <span class="mh">0x94</span><span class="p">,</span> <span class="mh">0x95</span><span class="p">,</span>
		<span class="mh">0xE2</span><span class="p">,</span> <span class="mh">0xE3</span><span class="p">,</span> <span class="mh">0xE0</span><span class="p">,</span> <span class="mh">0xE1</span><span class="p">,</span> <span class="mh">0xE6</span><span class="p">,</span> <span class="mh">0xE7</span><span class="p">,</span> <span class="mh">0xE4</span><span class="p">,</span> <span class="mh">0xE5</span><span class="p">,</span>
		<span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xDD</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xDC</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xDF</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span> <span class="mh">0xDE</span><span class="p">,</span>
		<span class="mh">0xF4</span><span class="p">,</span> <span class="mh">0xF6</span><span class="p">,</span> <span class="mh">0xF0</span><span class="p">,</span> <span class="mh">0xF2</span><span class="p">,</span> <span class="mh">0xFC</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">,</span> <span class="mh">0xF8</span><span class="p">,</span> <span class="mh">0xFA</span><span class="p">,</span>
		<span class="mh">0xEA</span><span class="p">,</span> <span class="mh">0xEB</span><span class="p">,</span> <span class="mh">0xE8</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">,</span> <span class="mh">0xEE</span><span class="p">,</span> <span class="mh">0xEF</span><span class="p">,</span> <span class="mh">0xEC</span><span class="p">,</span> <span class="mh">0xED</span><span class="p">,</span>
		<span class="mh">0xC8</span><span class="p">,</span> <span class="mh">0xC9</span><span class="p">,</span> <span class="mh">0xC6</span><span class="p">,</span> <span class="mh">0xC7</span><span class="p">,</span> <span class="mh">0xCC</span><span class="p">,</span> <span class="mh">0xCD</span><span class="p">,</span> <span class="mh">0xCA</span><span class="p">,</span> <span class="mh">0xCB</span><span class="p">,</span>
		<span class="mh">0xC0</span><span class="p">,</span> <span class="mh">0xC1</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xBF</span><span class="p">,</span> <span class="mh">0xC4</span><span class="p">,</span> <span class="mh">0xC5</span><span class="p">,</span> <span class="mh">0xC2</span><span class="p">,</span> <span class="mh">0xC3</span><span class="p">,</span>
		<span class="mh">0xD6</span><span class="p">,</span> <span class="mh">0xD7</span><span class="p">,</span> <span class="mh">0xD4</span><span class="p">,</span> <span class="mh">0xD5</span><span class="p">,</span> <span class="mh">0xDA</span><span class="p">,</span> <span class="mh">0xDB</span><span class="p">,</span> <span class="mh">0xD8</span><span class="p">,</span> <span class="mh">0xD9</span><span class="p">,</span>
		<span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xCF</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xCE</span><span class="p">,</span> <span class="mh">0xD2</span><span class="p">,</span> <span class="mh">0xD3</span><span class="p">,</span> <span class="mh">0xD0</span><span class="p">,</span> <span class="mh">0xD1</span>
	<span class="p">};</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">len</span><span class="o">--</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="o">*</span><span class="n">buff</span> <span class="o">=</span> <span class="n">table_alaw2ulaw</span><span class="p">[</span><span class="o">*</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">buff</span><span class="p">];</span>
                <span class="n">buff</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">ixj_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span> <span class="n">file_p</span><span class="p">,</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">length</span><span class="p">,</span> <span class="n">loff_t</span> <span class="o">*</span> <span class="n">ppos</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="o">*</span><span class="n">ppos</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span> <span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">NUM</span><span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_path</span><span class="p">.</span><span class="n">dentry</span><span class="o">-&gt;</span><span class="n">d_inode</span><span class="p">));</span>

	<span class="n">DECLARE_WAITQUEUE</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="n">current</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inread</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EALREADY</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inread</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">add_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
	<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_INTERRUPTIBLE</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>

	<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_ready</span> <span class="o">||</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_state</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dtmf_oob</span><span class="p">))</span> <span class="p">{</span>
		<span class="o">++</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_wait</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_flags</span> <span class="o">&amp;</span> <span class="n">O_NONBLOCK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
			<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inread</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EAGAIN</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
			<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inread</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">interruptible_sleep_on</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">signal_pending</span><span class="p">(</span><span class="n">current</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
			<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inread</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EINTR</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
	<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
	<span class="cm">/* Don&#39;t ever copy more than the user asks */</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">==</span> <span class="n">ALAW</span><span class="p">)</span>
		<span class="n">ulaw2alaw</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">,</span> <span class="n">min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_size</span><span class="p">));</span>
	<span class="n">i</span> <span class="o">=</span> <span class="n">copy_to_user</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">,</span> <span class="n">min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_size</span><span class="p">));</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_ready</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inread</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inread</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_size</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">ixj_enhanced_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span> <span class="n">file_p</span><span class="p">,</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">length</span><span class="p">,</span>
			  <span class="n">loff_t</span> <span class="o">*</span> <span class="n">ppos</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">pre_retval</span><span class="p">;</span>
	<span class="kt">ssize_t</span> <span class="n">read_retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">NUM</span><span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_path</span><span class="p">.</span><span class="n">dentry</span><span class="o">-&gt;</span><span class="n">d_inode</span><span class="p">));</span>

	<span class="n">pre_retval</span> <span class="o">=</span> <span class="n">ixj_PreRead</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0L</span><span class="p">);</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pre_retval</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">NORMAL</span>:
		<span class="n">read_retval</span> <span class="o">=</span> <span class="n">ixj_read</span><span class="p">(</span><span class="n">file_p</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">ppos</span><span class="p">);</span>
		<span class="n">ixj_PostRead</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0L</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">NOPOST</span>:
		<span class="n">read_retval</span> <span class="o">=</span> <span class="n">ixj_read</span><span class="p">(</span><span class="n">file_p</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">ppos</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">POSTONLY</span>:
		<span class="n">ixj_PostRead</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0L</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">read_retval</span> <span class="o">=</span> <span class="n">pre_retval</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">read_retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">ixj_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file_p</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">count</span><span class="p">,</span> <span class="n">loff_t</span> <span class="o">*</span> <span class="n">ppos</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">i</span> <span class="o">=</span> <span class="o">*</span><span class="n">ppos</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">file_p</span><span class="o">-&gt;</span><span class="n">private_data</span><span class="p">;</span>

	<span class="n">DECLARE_WAITQUEUE</span><span class="p">(</span><span class="n">wait</span><span class="p">,</span> <span class="n">current</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inwrite</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EALREADY</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inwrite</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">add_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
	<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_INTERRUPTIBLE</span><span class="p">);</span>
	<span class="n">mb</span><span class="p">();</span>


	<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">++</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_wait</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_flags</span> <span class="o">&amp;</span> <span class="n">O_NONBLOCK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
			<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inwrite</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EAGAIN</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
			<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inwrite</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">interruptible_sleep_on</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">signal_pending</span><span class="p">(</span><span class="n">current</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
			<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inwrite</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EINTR</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">set_current_state</span><span class="p">(</span><span class="n">TASK_RUNNING</span><span class="p">);</span>
	<span class="n">remove_wait_queue</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wait</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">+</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_end</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">;</span>
	<span class="n">i</span> <span class="o">=</span> <span class="n">copy_from_user</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">min</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_size</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inwrite</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
	<span class="p">}</span>
       <span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">==</span> <span class="n">ALAW</span><span class="p">)</span>
               <span class="n">alaw2ulaw</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span><span class="p">,</span> <span class="n">min</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_size</span><span class="p">));</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">inwrite</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_size</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">ssize_t</span> <span class="nf">ixj_enhanced_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span> <span class="n">file_p</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">__user</span> <span class="o">*</span><span class="n">buf</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">count</span><span class="p">,</span> <span class="n">loff_t</span> <span class="o">*</span> <span class="n">ppos</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">pre_retval</span><span class="p">;</span>
	<span class="kt">ssize_t</span> <span class="n">write_retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">NUM</span><span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_path</span><span class="p">.</span><span class="n">dentry</span><span class="o">-&gt;</span><span class="n">d_inode</span><span class="p">));</span>

	<span class="n">pre_retval</span> <span class="o">=</span> <span class="n">ixj_PreWrite</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0L</span><span class="p">);</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">pre_retval</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">NORMAL</span>:
		<span class="n">write_retval</span> <span class="o">=</span> <span class="n">ixj_write</span><span class="p">(</span><span class="n">file_p</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">ppos</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">write_retval</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ixj_PostWrite</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0L</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">+=</span> <span class="n">write_retval</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span><span class="o">--</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">NOPOST</span>:
		<span class="n">write_retval</span> <span class="o">=</span> <span class="n">ixj_write</span><span class="p">(</span><span class="n">file_p</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">ppos</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">write_retval</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">+=</span> <span class="n">write_retval</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span><span class="o">--</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">POSTONLY</span>:
		<span class="n">ixj_PostWrite</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0L</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">write_retval</span> <span class="o">=</span> <span class="n">pre_retval</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">write_retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_read_frame</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">dly</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">cnt</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">IsRxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsRxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">dly</span><span class="o">++</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="n">udelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="cm">/* Throw away word 0 of the 8021 compressed format to get standard G.729. */</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">==</span> <span class="n">G729</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">10</span> <span class="o">||</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">20</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0E</span><span class="p">);</span>
				<span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0F</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">+</span> <span class="n">cnt</span><span class="p">)</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0E</span><span class="p">);</span>
			<span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">+</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0F</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="o">++</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">framesread</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">get_ixj</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span><span class="p">)))</span> <span class="p">{</span>
				<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">cnt</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">dly</span><span class="o">++</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
								<span class="k">break</span><span class="p">;</span>
							<span class="p">}</span>
							<span class="n">udelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="n">outb_p</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">+</span> <span class="n">cnt</span><span class="p">),</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0C</span><span class="p">);</span>
					<span class="n">outb_p</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">+</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0D</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">get_ixj</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">frameswritten</span><span class="o">++</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_ready</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked readers */</span>

			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">poll_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked selects */</span>

			<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ixj_signals</span><span class="p">[</span><span class="n">SIG_READ_READY</span><span class="p">])</span>
				<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_READ_READY</span><span class="p">,</span> <span class="n">POLL_OUT</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">short</span> <span class="n">fsk</span><span class="p">[][</span><span class="mi">6</span><span class="p">][</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span>
<span class="p">{</span>
	<span class="p">{</span>
		<span class="p">{</span>
			<span class="mi">0</span><span class="p">,</span> <span class="mi">17846</span><span class="p">,</span> <span class="mi">29934</span><span class="p">,</span> <span class="mi">32364</span><span class="p">,</span> <span class="mi">24351</span><span class="p">,</span> <span class="mi">8481</span><span class="p">,</span> <span class="o">-</span><span class="mi">10126</span><span class="p">,</span> <span class="o">-</span><span class="mi">25465</span><span class="p">,</span> <span class="o">-</span><span class="mi">32587</span><span class="p">,</span> <span class="o">-</span><span class="mi">29196</span><span class="p">,</span>
			<span class="o">-</span><span class="mi">16384</span><span class="p">,</span> <span class="mi">1715</span><span class="p">,</span> <span class="mi">19260</span><span class="p">,</span> <span class="mi">30591</span><span class="p">,</span> <span class="mi">32051</span><span class="p">,</span> <span class="mi">23170</span><span class="p">,</span> <span class="mi">6813</span><span class="p">,</span> <span class="o">-</span><span class="mi">11743</span><span class="p">,</span> <span class="o">-</span><span class="mi">26509</span><span class="p">,</span> <span class="o">-</span><span class="mi">32722</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="o">-</span><span class="mi">28377</span><span class="p">,</span> <span class="o">-</span><span class="mi">14876</span><span class="p">,</span> <span class="mi">3425</span><span class="p">,</span> <span class="mi">20621</span><span class="p">,</span> <span class="mi">31163</span><span class="p">,</span> <span class="mi">31650</span><span class="p">,</span> <span class="mi">21925</span><span class="p">,</span> <span class="mi">5126</span><span class="p">,</span> <span class="o">-</span><span class="mi">13328</span><span class="p">,</span> <span class="o">-</span><span class="mi">27481</span><span class="p">,</span>
			<span class="o">-</span><span class="mi">32767</span><span class="p">,</span> <span class="o">-</span><span class="mi">27481</span><span class="p">,</span> <span class="o">-</span><span class="mi">13328</span><span class="p">,</span> <span class="mi">5126</span><span class="p">,</span> <span class="mi">21925</span><span class="p">,</span> <span class="mi">31650</span><span class="p">,</span> <span class="mi">31163</span><span class="p">,</span> <span class="mi">20621</span><span class="p">,</span> <span class="mi">3425</span><span class="p">,</span> <span class="o">-</span><span class="mi">14876</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="o">-</span><span class="mi">28377</span><span class="p">,</span> <span class="o">-</span><span class="mi">32722</span><span class="p">,</span> <span class="o">-</span><span class="mi">26509</span><span class="p">,</span> <span class="o">-</span><span class="mi">11743</span><span class="p">,</span> <span class="mi">6813</span><span class="p">,</span> <span class="mi">23170</span><span class="p">,</span> <span class="mi">32051</span><span class="p">,</span> <span class="mi">30591</span><span class="p">,</span> <span class="mi">19260</span><span class="p">,</span> <span class="mi">1715</span><span class="p">,</span>
			<span class="o">-</span><span class="mi">16384</span><span class="p">,</span> <span class="o">-</span><span class="mi">29196</span><span class="p">,</span> <span class="o">-</span><span class="mi">32587</span><span class="p">,</span> <span class="o">-</span><span class="mi">25465</span><span class="p">,</span> <span class="o">-</span><span class="mi">10126</span><span class="p">,</span> <span class="mi">8481</span><span class="p">,</span> <span class="mi">24351</span><span class="p">,</span> <span class="mi">32364</span><span class="p">,</span> <span class="mi">29934</span><span class="p">,</span> <span class="mi">17846</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">17846</span><span class="p">,</span> <span class="o">-</span><span class="mi">29934</span><span class="p">,</span> <span class="o">-</span><span class="mi">32364</span><span class="p">,</span> <span class="o">-</span><span class="mi">24351</span><span class="p">,</span> <span class="o">-</span><span class="mi">8481</span><span class="p">,</span> <span class="mi">10126</span><span class="p">,</span> <span class="mi">25465</span><span class="p">,</span> <span class="mi">32587</span><span class="p">,</span> <span class="mi">29196</span><span class="p">,</span>
			<span class="mi">16384</span><span class="p">,</span> <span class="o">-</span><span class="mi">1715</span><span class="p">,</span> <span class="o">-</span><span class="mi">19260</span><span class="p">,</span> <span class="o">-</span><span class="mi">30591</span><span class="p">,</span> <span class="o">-</span><span class="mi">32051</span><span class="p">,</span> <span class="o">-</span><span class="mi">23170</span><span class="p">,</span> <span class="o">-</span><span class="mi">6813</span><span class="p">,</span> <span class="mi">11743</span><span class="p">,</span> <span class="mi">26509</span><span class="p">,</span> <span class="mi">32722</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="mi">28377</span><span class="p">,</span> <span class="mi">14876</span><span class="p">,</span> <span class="o">-</span><span class="mi">3425</span><span class="p">,</span> <span class="o">-</span><span class="mi">20621</span><span class="p">,</span> <span class="o">-</span><span class="mi">31163</span><span class="p">,</span> <span class="o">-</span><span class="mi">31650</span><span class="p">,</span> <span class="o">-</span><span class="mi">21925</span><span class="p">,</span> <span class="o">-</span><span class="mi">5126</span><span class="p">,</span> <span class="mi">13328</span><span class="p">,</span> <span class="mi">27481</span><span class="p">,</span>
			<span class="mi">32767</span><span class="p">,</span> <span class="mi">27481</span><span class="p">,</span> <span class="mi">13328</span><span class="p">,</span> <span class="o">-</span><span class="mi">5126</span><span class="p">,</span> <span class="o">-</span><span class="mi">21925</span><span class="p">,</span> <span class="o">-</span><span class="mi">31650</span><span class="p">,</span> <span class="o">-</span><span class="mi">31163</span><span class="p">,</span> <span class="o">-</span><span class="mi">20621</span><span class="p">,</span> <span class="o">-</span><span class="mi">3425</span><span class="p">,</span> <span class="mi">14876</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="mi">28377</span><span class="p">,</span> <span class="mi">32722</span><span class="p">,</span> <span class="mi">26509</span><span class="p">,</span> <span class="mi">11743</span><span class="p">,</span> <span class="o">-</span><span class="mi">6813</span><span class="p">,</span> <span class="o">-</span><span class="mi">23170</span><span class="p">,</span> <span class="o">-</span><span class="mi">32051</span><span class="p">,</span> <span class="o">-</span><span class="mi">30591</span><span class="p">,</span> <span class="o">-</span><span class="mi">19260</span><span class="p">,</span> <span class="o">-</span><span class="mi">1715</span><span class="p">,</span>
			<span class="mi">16384</span><span class="p">,</span> <span class="mi">29196</span><span class="p">,</span> <span class="mi">32587</span><span class="p">,</span> <span class="mi">25465</span><span class="p">,</span> <span class="mi">10126</span><span class="p">,</span> <span class="o">-</span><span class="mi">8481</span><span class="p">,</span> <span class="o">-</span><span class="mi">24351</span><span class="p">,</span> <span class="o">-</span><span class="mi">32364</span><span class="p">,</span> <span class="o">-</span><span class="mi">29934</span><span class="p">,</span> <span class="o">-</span><span class="mi">17846</span>
		<span class="p">}</span>
	<span class="p">},</span>
	<span class="p">{</span>
		<span class="p">{</span>
			<span class="mi">0</span><span class="p">,</span> <span class="mi">10126</span><span class="p">,</span> <span class="mi">19260</span><span class="p">,</span> <span class="mi">26509</span><span class="p">,</span> <span class="mi">31163</span><span class="p">,</span> <span class="mi">32767</span><span class="p">,</span> <span class="mi">31163</span><span class="p">,</span> <span class="mi">26509</span><span class="p">,</span> <span class="mi">19260</span><span class="p">,</span> <span class="mi">10126</span><span class="p">,</span>
			<span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10126</span><span class="p">,</span> <span class="o">-</span><span class="mi">19260</span><span class="p">,</span> <span class="o">-</span><span class="mi">26509</span><span class="p">,</span> <span class="o">-</span><span class="mi">31163</span><span class="p">,</span> <span class="o">-</span><span class="mi">32767</span><span class="p">,</span> <span class="o">-</span><span class="mi">31163</span><span class="p">,</span> <span class="o">-</span><span class="mi">26509</span><span class="p">,</span> <span class="o">-</span><span class="mi">19260</span><span class="p">,</span> <span class="o">-</span><span class="mi">10126</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="o">-</span><span class="mi">28377</span><span class="p">,</span> <span class="o">-</span><span class="mi">21925</span><span class="p">,</span> <span class="o">-</span><span class="mi">13328</span><span class="p">,</span> <span class="o">-</span><span class="mi">3425</span><span class="p">,</span> <span class="mi">6813</span><span class="p">,</span> <span class="mi">16384</span><span class="p">,</span> <span class="mi">24351</span><span class="p">,</span> <span class="mi">29934</span><span class="p">,</span> <span class="mi">32587</span><span class="p">,</span> <span class="mi">32051</span><span class="p">,</span>
			<span class="mi">28377</span><span class="p">,</span> <span class="mi">21925</span><span class="p">,</span> <span class="mi">13328</span><span class="p">,</span> <span class="mi">3425</span><span class="p">,</span> <span class="o">-</span><span class="mi">6813</span><span class="p">,</span> <span class="o">-</span><span class="mi">16384</span><span class="p">,</span> <span class="o">-</span><span class="mi">24351</span><span class="p">,</span> <span class="o">-</span><span class="mi">29934</span><span class="p">,</span> <span class="o">-</span><span class="mi">32587</span><span class="p">,</span> <span class="o">-</span><span class="mi">32051</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="o">-</span><span class="mi">28377</span><span class="p">,</span> <span class="o">-</span><span class="mi">32051</span><span class="p">,</span> <span class="o">-</span><span class="mi">32587</span><span class="p">,</span> <span class="o">-</span><span class="mi">29934</span><span class="p">,</span> <span class="o">-</span><span class="mi">24351</span><span class="p">,</span> <span class="o">-</span><span class="mi">16384</span><span class="p">,</span> <span class="o">-</span><span class="mi">6813</span><span class="p">,</span> <span class="mi">3425</span><span class="p">,</span> <span class="mi">13328</span><span class="p">,</span> <span class="mi">21925</span><span class="p">,</span>
			<span class="mi">28377</span><span class="p">,</span> <span class="mi">32051</span><span class="p">,</span> <span class="mi">32587</span><span class="p">,</span> <span class="mi">29934</span><span class="p">,</span> <span class="mi">24351</span><span class="p">,</span> <span class="mi">16384</span><span class="p">,</span> <span class="mi">6813</span><span class="p">,</span> <span class="o">-</span><span class="mi">3425</span><span class="p">,</span> <span class="o">-</span><span class="mi">13328</span><span class="p">,</span> <span class="o">-</span><span class="mi">21925</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10126</span><span class="p">,</span> <span class="o">-</span><span class="mi">19260</span><span class="p">,</span> <span class="o">-</span><span class="mi">26509</span><span class="p">,</span> <span class="o">-</span><span class="mi">31163</span><span class="p">,</span> <span class="o">-</span><span class="mi">32767</span><span class="p">,</span> <span class="o">-</span><span class="mi">31163</span><span class="p">,</span> <span class="o">-</span><span class="mi">26509</span><span class="p">,</span> <span class="o">-</span><span class="mi">19260</span><span class="p">,</span> <span class="o">-</span><span class="mi">10126</span><span class="p">,</span>
			<span class="mi">0</span><span class="p">,</span> <span class="mi">10126</span><span class="p">,</span> <span class="mi">19260</span><span class="p">,</span> <span class="mi">26509</span><span class="p">,</span> <span class="mi">31163</span><span class="p">,</span> <span class="mi">32767</span><span class="p">,</span> <span class="mi">31163</span><span class="p">,</span> <span class="mi">26509</span><span class="p">,</span> <span class="mi">19260</span><span class="p">,</span> <span class="mi">10126</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="mi">28377</span><span class="p">,</span> <span class="mi">21925</span><span class="p">,</span> <span class="mi">13328</span><span class="p">,</span> <span class="mi">3425</span><span class="p">,</span> <span class="o">-</span><span class="mi">6813</span><span class="p">,</span> <span class="o">-</span><span class="mi">16383</span><span class="p">,</span> <span class="o">-</span><span class="mi">24351</span><span class="p">,</span> <span class="o">-</span><span class="mi">29934</span><span class="p">,</span> <span class="o">-</span><span class="mi">32587</span><span class="p">,</span> <span class="o">-</span><span class="mi">32051</span><span class="p">,</span>
			<span class="o">-</span><span class="mi">28377</span><span class="p">,</span> <span class="o">-</span><span class="mi">21925</span><span class="p">,</span> <span class="o">-</span><span class="mi">13328</span><span class="p">,</span> <span class="o">-</span><span class="mi">3425</span><span class="p">,</span> <span class="mi">6813</span><span class="p">,</span> <span class="mi">16383</span><span class="p">,</span> <span class="mi">24351</span><span class="p">,</span> <span class="mi">29934</span><span class="p">,</span> <span class="mi">32587</span><span class="p">,</span> <span class="mi">32051</span>
		<span class="p">},</span>
		<span class="p">{</span>
			<span class="mi">28377</span><span class="p">,</span> <span class="mi">32051</span><span class="p">,</span> <span class="mi">32587</span><span class="p">,</span> <span class="mi">29934</span><span class="p">,</span> <span class="mi">24351</span><span class="p">,</span> <span class="mi">16384</span><span class="p">,</span> <span class="mi">6813</span><span class="p">,</span> <span class="o">-</span><span class="mi">3425</span><span class="p">,</span> <span class="o">-</span><span class="mi">13328</span><span class="p">,</span> <span class="o">-</span><span class="mi">21925</span><span class="p">,</span>
			<span class="o">-</span><span class="mi">28377</span><span class="p">,</span> <span class="o">-</span><span class="mi">32051</span><span class="p">,</span> <span class="o">-</span><span class="mi">32587</span><span class="p">,</span> <span class="o">-</span><span class="mi">29934</span><span class="p">,</span> <span class="o">-</span><span class="mi">24351</span><span class="p">,</span> <span class="o">-</span><span class="mi">16384</span><span class="p">,</span> <span class="o">-</span><span class="mi">6813</span><span class="p">,</span> <span class="mi">3425</span><span class="p">,</span> <span class="mi">13328</span><span class="p">,</span> <span class="mi">21925</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>


<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_cid_bit</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">bit</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskcnt</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fsksize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsk</span><span class="p">[</span><span class="n">bit</span><span class="p">][</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskz</span><span class="p">][</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskcnt</span><span class="p">];</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskcnt</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskcnt</span> <span class="o">%=</span> <span class="mi">20</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bit</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskz</span><span class="o">++</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskz</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskz</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_cid_byte</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">char</span> <span class="n">byte</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ_CBYTE</span> <span class="n">cb</span><span class="p">;</span>

		<span class="n">cb</span><span class="p">.</span><span class="n">cbyte</span> <span class="o">=</span> <span class="n">byte</span><span class="p">;</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b0</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b1</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b2</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b3</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b4</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b5</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b6</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">cb</span><span class="p">.</span><span class="n">cbits</span><span class="p">.</span><span class="n">b7</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_cid_seize</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">150</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">180</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_cidcw_seize</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_write_cid_bit</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_write_cid_string</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span><span class="p">,</span> <span class="kt">int</span> <span class="n">checksum</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">);</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">s</span><span class="p">[</span><span class="n">cnt</span><span class="p">]);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="p">(</span><span class="n">checksum</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">cnt</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">checksum</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_pad_fsk</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pad</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">pad</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fsksize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">720</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fsksize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_pre_cid</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_codec</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_frame_size</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_volume</span> <span class="o">=</span> <span class="n">get_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_flag</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">playing</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_rec_codec</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_rec_volume</span> <span class="o">=</span> <span class="n">get_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_rec_flag</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">recording</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_aec_level</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">;</span>

	<span class="k">switch</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_base_frame_size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_base_frame_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0xF0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_base_frame_size</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_cpt_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">set_base_frame</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
	<span class="n">set_play_codec</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">LINEAR16</span><span class="p">);</span>
	<span class="n">set_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x1B</span><span class="p">);</span>
	<span class="n">ixj_play_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_post_cid</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cidsize</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_STANDBY</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ phone%d Finished Playing CallerID data %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">ixj_fsk_free</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">set_base_frame</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_base_frame_size</span><span class="p">);</span>
	<span class="n">set_play_codec</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_codec</span><span class="p">);</span>
	<span class="n">ixj_aec_start</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_aec_level</span><span class="p">);</span>
	<span class="n">set_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_volume</span><span class="p">);</span>

	<span class="n">set_rec_codec</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_rec_codec</span><span class="p">);</span>
	<span class="n">set_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_rec_volume</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_rec_flag</span><span class="p">)</span>
		<span class="n">ixj_record_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_flag</span><span class="p">)</span>
		<span class="n">ixj_play_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_flag</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked writers */</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_cid</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">sdmf1</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">sdmf2</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">sdmf3</span><span class="p">[</span><span class="mi">80</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">mdmflen</span><span class="p">,</span> <span class="n">len1</span><span class="p">,</span> <span class="n">len2</span><span class="p">,</span> <span class="n">len3</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">pad</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">checksum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskz</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskphase</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskcnt</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cidsize</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">ixj_fsk_alloc</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">strcpy</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">month</span><span class="p">);</span>
	<span class="n">strcat</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">day</span><span class="p">);</span>
	<span class="n">strcat</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">hour</span><span class="p">);</span>
	<span class="n">strcat</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">min</span><span class="p">);</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">sdmf2</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">number</span><span class="p">);</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">sdmf3</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>

	<span class="n">len1</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">);</span>
	<span class="n">len2</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">sdmf2</span><span class="p">);</span>
	<span class="n">len3</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">sdmf3</span><span class="p">);</span>
	<span class="n">mdmflen</span> <span class="o">=</span> <span class="n">len1</span> <span class="o">+</span> <span class="n">len2</span> <span class="o">+</span> <span class="n">len3</span> <span class="o">+</span> <span class="mi">6</span><span class="p">;</span>

	<span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
		<span class="n">ixj_write_cid_seize</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">mdmflen</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">mdmflen</span><span class="p">;</span>

		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">;</span>
		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">len1</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">len1</span><span class="p">;</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">ixj_write_cid_string</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">sdmf1</span><span class="p">,</span> <span class="n">checksum</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>

		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">;</span>
		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">len2</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">len2</span><span class="p">;</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">ixj_write_cid_string</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">sdmf2</span><span class="p">,</span> <span class="n">checksum</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>

		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x07</span><span class="p">;</span>
		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">len3</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">len3</span><span class="p">;</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">ixj_write_cid_string</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">sdmf3</span><span class="p">,</span> <span class="n">checksum</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>

		<span class="n">checksum</span> <span class="o">%=</span> <span class="mi">256</span><span class="p">;</span>
		<span class="n">checksum</span> <span class="o">^=</span> <span class="mh">0xFF</span><span class="p">;</span>
		<span class="n">checksum</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>

		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="n">checksum</span><span class="p">);</span>

		<span class="n">pad</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">%</span> <span class="mi">240</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pad</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pad</span> <span class="o">=</span> <span class="mi">240</span> <span class="o">-</span> <span class="n">pad</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">ixj_pad_fsk</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">pad</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">ixj_write_frame</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_cidcw</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ_TONE</span> <span class="n">ti</span><span class="p">;</span>

	<span class="kt">char</span> <span class="n">sdmf1</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">sdmf2</span><span class="p">[</span><span class="mi">50</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">sdmf3</span><span class="p">[</span><span class="mi">80</span><span class="p">];</span>
	<span class="kt">char</span> <span class="n">mdmflen</span><span class="p">,</span> <span class="n">len1</span><span class="p">,</span> <span class="n">len2</span><span class="p">,</span> <span class="n">len3</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">pad</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">checksum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskz</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskphase</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskcnt</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cidsize</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">ixj_fsk_alloc</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidcw_ack</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">23</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz440</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>

	<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="mi">1500</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ cidcw phone%d first tone start at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">23</span><span class="p">);</span>

	<span class="n">clear_bit</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="p">)</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="n">test_and_set_bit</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ cidcw phone%d first tone end at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="mi">24</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">hz2130</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">hz2750</span><span class="p">;</span>
	<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>

	<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ cidcw phone%d second tone start at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>

	<span class="n">clear_bit</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="p">)</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="n">test_and_set_bit</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ cidcw phone%d sent second tone at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcw_wait</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">((</span><span class="mi">50</span> <span class="o">*</span> <span class="n">hertz</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">);</span>

	<span class="n">clear_bit</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidcw_ack</span> <span class="o">&amp;&amp;</span> <span class="n">time_before</span><span class="p">(</span><span class="n">jiffies</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcw_wait</span><span class="p">))</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">while</span><span class="p">(</span><span class="n">test_and_set_bit</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcw_wait</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidcw_ack</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ cidcw phone%d did not receive ACK from display %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">ixj_post_cid</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_flag</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked readers */</span>
		<span class="p">}</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">ixj_pre_cid</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidcw_ack</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">month</span><span class="p">);</span>
	<span class="n">strcat</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">day</span><span class="p">);</span>
	<span class="n">strcat</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">hour</span><span class="p">);</span>
	<span class="n">strcat</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">min</span><span class="p">);</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">sdmf2</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">number</span><span class="p">);</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">sdmf3</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">.</span><span class="n">name</span><span class="p">);</span>

	<span class="n">len1</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">sdmf1</span><span class="p">);</span>
	<span class="n">len2</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">sdmf2</span><span class="p">);</span>
	<span class="n">len3</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">sdmf3</span><span class="p">);</span>
	<span class="n">mdmflen</span> <span class="o">=</span> <span class="n">len1</span> <span class="o">+</span> <span class="n">len2</span> <span class="o">+</span> <span class="n">len3</span> <span class="o">+</span> <span class="mi">6</span><span class="p">;</span>

	<span class="n">ixj_write_cidcw_seize</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">mdmflen</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">mdmflen</span><span class="p">;</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x01</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">len1</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">len1</span><span class="p">;</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">ixj_write_cid_string</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">sdmf1</span><span class="p">,</span> <span class="n">checksum</span><span class="p">);</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">len2</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">len2</span><span class="p">;</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">ixj_write_cid_string</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">sdmf2</span><span class="p">,</span> <span class="n">checksum</span><span class="p">);</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x07</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">len3</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">len3</span><span class="p">;</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">ixj_write_cid_string</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">sdmf3</span><span class="p">,</span> <span class="n">checksum</span><span class="p">);</span>

	<span class="n">checksum</span> <span class="o">%=</span> <span class="mi">256</span><span class="p">;</span>
	<span class="n">checksum</span> <span class="o">^=</span> <span class="mh">0xFF</span><span class="p">;</span>
	<span class="n">checksum</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="n">checksum</span><span class="p">);</span>

	<span class="n">pad</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">%</span> <span class="mi">240</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pad</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pad</span> <span class="o">=</span> <span class="mi">240</span> <span class="o">-</span> <span class="n">pad</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ixj_pad_fsk</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">pad</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0200</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ cidcw phone%d sent FSK data at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_vmwi</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">msg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">char</span> <span class="n">mdmflen</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">pad</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">checksum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span><span class="p">)</span>
		<span class="k">return</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskz</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskphase</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskcnt</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cidsize</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">ixj_fsk_alloc</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">mdmflen</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">==</span> <span class="n">PORT_POTS</span><span class="p">)</span>
		<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_OHT</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

	<span class="n">ixj_write_cid_seize</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="mh">0x82</span><span class="p">;</span>
	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">mdmflen</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="n">mdmflen</span><span class="p">;</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x0B</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x0B</span><span class="p">;</span>
	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0xFF</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">else</span> <span class="p">{</span>
		<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">);</span>
		<span class="n">checksum</span> <span class="o">=</span> <span class="n">checksum</span> <span class="o">+</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">checksum</span> <span class="o">%=</span> <span class="mi">256</span><span class="p">;</span>
	<span class="n">checksum</span> <span class="o">^=</span> <span class="mh">0xFF</span><span class="p">;</span>
	<span class="n">checksum</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">ixj_write_cid_byte</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span><span class="p">)</span> <span class="n">checksum</span><span class="p">);</span>

	<span class="n">pad</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">%</span> <span class="mi">240</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">pad</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pad</span> <span class="o">=</span> <span class="mi">240</span> <span class="o">-</span> <span class="n">pad</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ixj_pad_fsk</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">pad</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_write_frame</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">frame_count</span><span class="p">,</span> <span class="n">dly</span><span class="p">;</span>
	<span class="n">IXJ_WORD</span> <span class="n">dat</span><span class="p">;</span>

	<span class="n">frame_count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidplay</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">480</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">cnt</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">dly</span><span class="o">++</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="k">break</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="n">udelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="n">dat</span><span class="p">.</span><span class="n">word</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcnt</span><span class="o">++</span><span class="p">];</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">dat</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0C</span><span class="p">);</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">dat</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0D</span><span class="p">);</span>
			<span class="n">cnt</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcnt</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ixj_post_cid</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="cm">/* This may seem rude, but if we just played one frame of FSK data for CallerID</span>
<span class="cm">		   and there is real audio data in the buffer, we need to throw it away because</span>
<span class="cm">		   we just used it&#39;s time slot */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">&gt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">+=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_end</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span><span class="o">++</span><span class="p">;</span>
			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked writers */</span>

			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">poll_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked selects */</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">&gt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">frame_count</span> <span class="o">=</span>
			    <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">&gt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">frame_count</span> <span class="o">=</span>
			    <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
			    <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_end</span> <span class="o">-</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">frame_count</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">play_first_frame</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">BYTES</span> <span class="n">blankword</span><span class="p">;</span>

				<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">case</span> <span class="n">PLAYBACK_MODE_ULAW</span>:
				<span class="k">case</span> <span class="n">PLAYBACK_MODE_ALAW</span>:
					<span class="n">blankword</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">blankword</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLAYBACK_MODE_8LINEAR</span>:
				<span class="k">case</span> <span class="n">PLAYBACK_MODE_16LINEAR</span>:
				<span class="nl">default:</span>
					<span class="n">blankword</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">blankword</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLAYBACK_MODE_8LINEAR_WSS</span>:
					<span class="n">blankword</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">blankword</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">cnt</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">dly</span><span class="o">++</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
								<span class="k">break</span><span class="p">;</span>
							<span class="p">}</span>
							<span class="n">udelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="n">outb_p</span><span class="p">((</span><span class="n">blankword</span><span class="p">.</span><span class="n">low</span><span class="p">),</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0C</span><span class="p">);</span>
					<span class="n">outb_p</span><span class="p">((</span><span class="n">blankword</span><span class="p">.</span><span class="n">high</span><span class="p">),</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0D</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">play_first_frame</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span> <span class="k">else</span>	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">==</span> <span class="n">G723_63</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">play_first_frame</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">24</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">BYTES</span> <span class="n">blankword</span><span class="p">;</span>

					<span class="k">if</span><span class="p">(</span><span class="n">cnt</span> <span class="o">==</span> <span class="mi">12</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">blankword</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
						<span class="n">blankword</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="k">else</span> <span class="p">{</span>
						<span class="n">blankword</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">blankword</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
					<span class="p">}</span>
					<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">cnt</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
						<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
						<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
							<span class="k">if</span> <span class="p">(</span><span class="n">dly</span><span class="o">++</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
								<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
								<span class="k">break</span><span class="p">;</span>
							<span class="p">}</span>
							<span class="n">udelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
						<span class="p">}</span>
					<span class="p">}</span>
					<span class="n">outb_p</span><span class="p">((</span><span class="n">blankword</span><span class="p">.</span><span class="n">low</span><span class="p">),</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0C</span><span class="p">);</span>
					<span class="n">outb_p</span><span class="p">((</span><span class="n">blankword</span><span class="p">.</span><span class="n">high</span><span class="p">),</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0D</span><span class="p">);</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">play_first_frame</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">cnt</span> <span class="o">%</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
					<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">IsTxReady</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
						<span class="k">if</span> <span class="p">(</span><span class="n">dly</span><span class="o">++</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
							<span class="n">dly</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
							<span class="k">break</span><span class="p">;</span>
						<span class="p">}</span>
						<span class="n">udelay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="cm">/* Add word 0 to G.729 frames for the 8021.  Right now we don&#39;t do VAD/CNG  */</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">==</span> <span class="n">G729</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">10</span> <span class="o">||</span> <span class="n">cnt</span> <span class="o">==</span> <span class="mi">20</span><span class="p">))</span> <span class="p">{</span>
					<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span>
					    <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span><span class="p">[</span><span class="n">cnt</span> <span class="o">+</span> <span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
					<span class="cm">/* someone is trying to write silence lets make this a type 0 frame. */</span>
						<span class="n">outb_p</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0C</span><span class="p">);</span>
						<span class="n">outb_p</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0D</span><span class="p">);</span>
					<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
					<span class="cm">/* so all other frames are type 1. */</span>
						<span class="n">outb_p</span><span class="p">(</span><span class="mh">0x01</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0C</span><span class="p">);</span>
						<span class="n">outb_p</span><span class="p">(</span><span class="mh">0x00</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0D</span><span class="p">);</span>
					<span class="p">}</span>
				<span class="p">}</span>
				<span class="n">outb_p</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">+</span> <span class="n">cnt</span><span class="p">),</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0C</span><span class="p">);</span>
				<span class="n">outb_p</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">+</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x0D</span><span class="p">);</span>
				<span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">+</span> <span class="n">cnt</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">+</span> <span class="n">cnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">+=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_end</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span><span class="o">++</span><span class="p">;</span>
			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked writers */</span>

			<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">poll_q</span><span class="p">);</span>	<span class="cm">/* Wake any blocked selects */</span>

			<span class="o">++</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">frameswritten</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">drybuffer</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ixj_signals</span><span class="p">[</span><span class="n">SIG_WRITE_READY</span><span class="p">])</span> <span class="p">{</span>
		<span class="n">ixj_kill_fasync</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SIG_WRITE_READY</span><span class="p">,</span> <span class="n">POLL_OUT</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">idle</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* DSP Idle */</span>

		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">playing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">recording</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_base_frame</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">size</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>

	<span class="n">idle</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_aec_level</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">;</span>
	<span class="n">aec_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">idle</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mi">30</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x07F0</span><span class="p">;</span>
			<span class="cm">/* Set Base Frame Size to 240 pg9-10 8021 */</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">20</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x07A0</span><span class="p">;</span>
			<span class="cm">/* Set Base Frame Size to 160 pg9-10 8021 */</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">10</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x0750</span><span class="p">;</span>
			<span class="cm">/* Set Base Frame Size to 80 pg9-10 8021 */</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">size</span> <span class="o">==</span> <span class="mi">30</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">size</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
		<span class="cm">/* If the status returned is 0x0000 (pg9-9 8021) the call failed */</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">high</span> <span class="o">==</span> <span class="mh">0x00</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x00</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">ixj_aec_start</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_play_aec_level</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">size</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_rec_codec</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">=</span> <span class="n">rate</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">G723_63</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G723_53</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">TS85</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ts85_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">TS48</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">TS41</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G728</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">48</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G729</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="mh">0xA0</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mh">0x50</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G729B</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="mh">0xA0</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mh">0x50</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">ULAW</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">ALAW</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">LINEAR16</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">160</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">240</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">LINEAR8</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">WSS</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_record_start</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_record_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">recording</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0FE0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Put the DSP in full power mode. */</span>

	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d Starting Record Codec %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">G723_63</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5131</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">G723_53</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5132</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">TS85</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5130</span><span class="p">;</span>	<span class="cm">/* TrueSpeech 8.5 */</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">TS48</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5133</span><span class="p">;</span>	<span class="cm">/* TrueSpeech 4.8 */</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">TS41</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5134</span><span class="p">;</span>	<span class="cm">/* TrueSpeech 4.1 */</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">G728</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5135</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">G729</span>:
		<span class="k">case</span> <span class="n">G729B</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5136</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">)</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GFP_ATOMIC</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Read buffer allocation for ixj board %d failed!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_size</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5102</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Set Poll sync mode */</span>

		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">0</span>:
		<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1C03</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>

		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">4</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1E03</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1E01</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>

		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">5</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1E83</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1E81</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>

		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">6</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1F03</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1F01</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>

		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">7</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1F83</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x1F81</span><span class="p">;</span>	<span class="cm">/* Record C1 */</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">playing</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_aec_start</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_record_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d Stopping Record Codec %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>

	<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5120</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">recording</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_vad</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">arg</span><span class="p">)</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x513F</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x513E</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">set_rec_depth</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">depth</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">)</span>
		<span class="n">depth</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5180</span> <span class="o">+</span> <span class="n">depth</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">set_dtmf_prescale</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">volume</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF07</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">get_dtmf_prescale</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF05</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">set_rec_volume</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">volume</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span> <span class="o">==</span> <span class="n">AEC_AGC</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: /dev/phone%d Setting AGC Threshold to 0x%4.4x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">volume</span><span class="p">);</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF96</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: /dev/phone %d Setting Record Volume to 0x%4.4x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">volume</span><span class="p">);</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF03</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_rec_volume_linear</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">volume</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">newvolume</span><span class="p">,</span> <span class="n">dsprecmax</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: /dev/phone %d Setting Linear Record Volume to 0x%4.4x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">volume</span><span class="p">);</span>
	<span class="k">if</span><span class="p">(</span><span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">100</span> <span class="o">||</span> <span class="n">volume</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
	  <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* This should normalize the perceived volumes between the different cards caused by differences in the hardware */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x440</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x180</span><span class="p">;</span>
		<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0203</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Voice Left Volume unmute 6db */</span>
		<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0303</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Voice Right Volume unmute 6db */</span>
		<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0C00</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mono1 unmute 12db */</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_LITE</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x4C0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x100</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x400</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">newvolume</span> <span class="o">=</span> <span class="p">(</span><span class="n">dsprecmax</span> <span class="o">*</span> <span class="n">volume</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">;</span>
	<span class="n">set_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">newvolume</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">get_rec_volume</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span> <span class="o">==</span> <span class="n">AEC_AGC</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Getting AGC Threshold</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF86</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;AGC Threshold is 0x%2.2x%2.2x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Getting Record Volume</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF01</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">get_rec_volume_linear</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">volume</span><span class="p">,</span> <span class="n">newvolume</span><span class="p">,</span> <span class="n">dsprecmax</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x440</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x180</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_LITE</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x4C0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x100</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
		<span class="n">dsprecmax</span> <span class="o">=</span> <span class="mh">0x400</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">volume</span> <span class="o">=</span> <span class="n">get_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">newvolume</span> <span class="o">=</span> <span class="p">(</span><span class="n">volume</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="n">dsprecmax</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">newvolume</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span>
		<span class="n">newvolume</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">newvolume</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">get_rec_level</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">retval</span><span class="p">;</span>

	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF88</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

	<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="n">retval</span> <span class="o">=</span> <span class="p">(</span><span class="n">retval</span> <span class="o">*</span> <span class="mi">256</span><span class="p">)</span> <span class="o">/</span> <span class="mi">240</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_aec_start</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">level</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span> <span class="o">=</span> <span class="n">level</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;AGC set = 0x%2.2x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">level</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">aec_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">==</span> <span class="n">G729</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">==</span> <span class="n">G729</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">==</span> <span class="n">G729B</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">==</span> <span class="n">G729B</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE022</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Move AEC filter buffer */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0300</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xB001</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* AEC On */</span>

		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE013</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Advanced AEC C1 */</span>

		<span class="k">switch</span> <span class="p">(</span><span class="n">level</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">AEC_LOW</span>:
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Advanced AEC C2 = off */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE011</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xFFFF</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF97</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Enable */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to off */</span>

			<span class="k">break</span><span class="p">;</span>

		<span class="k">case</span> <span class="n">AEC_MED</span>:
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0600</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Advanced AEC C2 = on medium */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE011</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0080</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF97</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Enable */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to off */</span>

			<span class="k">break</span><span class="p">;</span>

		<span class="k">case</span> <span class="n">AEC_HIGH</span>:
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0C00</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Advanced AEC C2 = on high */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE011</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0080</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF97</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Enable */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to off */</span>

			<span class="k">break</span><span class="p">;</span>

		<span class="k">case</span> <span class="n">AEC_AGC</span>:
                        <span class="cm">/* First we have to put the AEC into advance auto mode so that AGC will not conflict with it */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0002</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Attenuation scaling factor of 2 */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE011</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0100</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Higher Threshold Floor */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE012</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set Train and Lock */</span>

			<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0224</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="k">else</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x1224</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE014</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0003</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Lock threshold at 3dB */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE338</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set Echo Suppresser Attenuation to 0dB */</span>

			<span class="cm">/* Now we can set the AGC initial parameters and turn it on */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF90</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Minimum gain */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0020</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to 0.125 (-18dB) */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF91</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Maximum gain */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to 16 (24dB) */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF92</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC start gain */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0800</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to 8 (+18dB) */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF93</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC hold time */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x1F40</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to 2 seconds (units are 250us) */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF94</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Attack Time Constant */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0005</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to 8ms */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF95</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Decay Time Constant */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x000D</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to 4096ms */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF96</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Attack Threshold */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x1200</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to 25% */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF97</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set AGC Enable */</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0001</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* to on */</span>

			<span class="k">break</span><span class="p">;</span>

		<span class="k">case</span> <span class="n">AEC_AUTO</span>:
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0002</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Attenuation scaling factor of 2 */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE011</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0100</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Higher Threshold Floor */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE012</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set Train and Lock */</span>

			<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0224</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="k">else</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x1224</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE014</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0003</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Lock threshold at 3dB */</span>

			<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE338</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set Echo Suppresser Attenuation to 0dB */</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">aec_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span> <span class="o">=</span> <span class="n">AEC_OFF</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">==</span> <span class="n">G729</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">==</span> <span class="n">G729</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span> <span class="o">==</span> <span class="n">G729B</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">==</span> <span class="n">G729B</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xE022</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Move AEC filter buffer back */</span>

		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0700</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xB002</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* AEC Stop */</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">set_play_codec</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span> <span class="o">=</span> <span class="n">rate</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">rate</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">G723_63</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G723_53</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">TS85</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ts85_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">TS48</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">9</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">TS41</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span> <span class="o">||</span> <span class="n">ixj_convert_loaded</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G728</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">48</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G729</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="mh">0xA0</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mh">0x50</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">G729B</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="mh">0xA0</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="mh">0x50</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">18</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">ULAW</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">ALAW</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">LINEAR16</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">160</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">240</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">LINEAR8</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">WSS</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="mh">0xA0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">80</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mh">0x50</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">40</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">120</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_play_start</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x0000</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d Starting Play Codec %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">playing</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0FE0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Put the DSP in full power mode. */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">play_first_frame</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">drybuffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">G723_63</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5231</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">G723_53</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5232</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">TS85</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5230</span><span class="p">;</span>	<span class="cm">/* TrueSpeech 8.5 */</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">TS48</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5233</span><span class="p">;</span>	<span class="cm">/* TrueSpeech 4.8 */</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">TS41</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5234</span><span class="p">;</span>	<span class="cm">/* TrueSpeech 4.1 */</span>

			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">G728</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5235</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">G729</span>:
		<span class="k">case</span> <span class="n">G729B</span>:
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x5236</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">GFP_ATOMIC</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Write buffer allocation for ixj board %d failed!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="p">}</span>
<span class="cm">/*	j-&gt;write_buffers_empty = 2; */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_size</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_end</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_rp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_wp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5202</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Set Poll sync mode */</span>

		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">0</span>:
		<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C03</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">2</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C23</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C21</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">4</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C43</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C41</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">5</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C53</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C51</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">6</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C63</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x2C61</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x2000</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Playback C2 */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x2000</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_frame_size</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>	<span class="cm">/* Playback C3 */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">recording</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_aec_start</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_play_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d Stopping Play Codec %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>

	<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer_size</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5221</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Stop playback and flush buffers.  8022 reference page 9-40 */</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">playing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">get_play_level</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">retval</span><span class="p">;</span>

	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF8F</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span> <span class="cm">/* 8022 Reference page 9-38 */</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="n">retval</span> <span class="o">=</span> <span class="p">(</span><span class="n">retval</span> <span class="o">*</span> <span class="mi">256</span><span class="p">)</span> <span class="o">/</span> <span class="mi">240</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">ixj_poll</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file_p</span><span class="p">,</span> <span class="n">poll_table</span> <span class="o">*</span> <span class="n">wait</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">NUM</span><span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_path</span><span class="p">.</span><span class="n">dentry</span><span class="o">-&gt;</span><span class="n">d_inode</span><span class="p">));</span>

	<span class="n">poll_wait</span><span class="p">(</span><span class="n">file_p</span><span class="p">,</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">poll_q</span><span class="p">),</span> <span class="n">wait</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer_ready</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">mask</span> <span class="o">|=</span> <span class="n">POLLIN</span> <span class="o">|</span> <span class="n">POLLRDNORM</span><span class="p">;</span>	<span class="cm">/* readable */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffers_empty</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">mask</span> <span class="o">|=</span> <span class="n">POLLOUT</span> <span class="o">|</span> <span class="n">POLLWRNORM</span><span class="p">;</span>	<span class="cm">/* writable */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bytes</span><span class="p">)</span>
		<span class="n">mask</span> <span class="o">|=</span> <span class="n">POLLPRI</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">mask</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_play_tone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">char</span> <span class="n">tone</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;IXJ %d starting tone %d at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">,</span> <span class="n">tone</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">idle</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_start_jif</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_index</span> <span class="o">=</span> <span class="n">tone</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6000</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_index</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_set_tone_on</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">arg</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_on_time</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6E04</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Set Tone On Period */</span>

		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">SCI_WaitHighSCI</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">sci</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">udelay</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">((</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">sci</span><span class="p">))</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;SCI Wait High failed %x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">sci</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">udelay</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">sci</span><span class="p">))</span>
				<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;SCI Wait Low failed %x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">SCI_Control</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">control</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">control</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SCI_End</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Set PLD Serial control interface */</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* to no selection */</span>

		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SCI_Enable_DAA</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Set PLD Serial control interface */</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* to write to DAA */</span>

		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SCI_Enable_Mixer</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Set PLD Serial control interface */</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* to write to mixer */</span>

		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SCI_Enable_EEPROM</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c0</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Set PLD Serial control interface */</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">c1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* to write to EEPROM */</span>

		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">control</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SCI_End</span>:
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SCI_Enable_DAA</span>:
	<span class="k">case</span> <span class="n">SCI_Enable_Mixer</span>:
	<span class="k">case</span> <span class="n">SCI_Enable_EEPROM</span>:
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitHighSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">SCI_Prepare</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_get_mixer</span><span class="p">(</span><span class="kt">long</span> <span class="n">val</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">reg</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x1F00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">mix</span><span class="p">.</span><span class="n">vol</span><span class="p">[</span><span class="n">reg</span><span class="p">];</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_mixer</span><span class="p">(</span><span class="kt">long</span> <span class="n">val</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x1F00</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x00FF</span><span class="p">;</span>

        <span class="cm">/* save mixer value so we can get back later on */</span>
        <span class="n">j</span><span class="o">-&gt;</span><span class="n">mix</span><span class="p">.</span><span class="n">vol</span><span class="p">[</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">]</span> <span class="o">=</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>

	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">&amp;</span> <span class="mh">0x1F</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>	<span class="cm">/* Load Mixer Address */</span>

	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>	<span class="cm">/* Load Mixer Data */</span>

	<span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_Mixer</span><span class="p">);</span>

	<span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">daa_load</span><span class="p">(</span><span class="n">BYTES</span> <span class="o">*</span> <span class="n">p_bytes</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">p_bytes</span><span class="o">-&gt;</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">p_bytes</span><span class="o">-&gt;</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_daa_cr4</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">char</span> <span class="n">reg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SOP_PU_SLEEP</span>:
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x14</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_RINGING</span>:
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x54</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_CONVERSATION</span>:
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x94</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_PULSEDIALING</span>:
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0xD4</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">reg</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">AGX</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="mi">0</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">AGR_Z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">1</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">AGR_Z</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">2</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">AGR_Z</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="mi">3</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">AGR_Z</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">char</span> <span class="nf">daa_int_read</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x38</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="n">ALISDAA_ID_BYTE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Cannot read DAA ID Byte high = %d low = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">char</span> <span class="nf">daa_CR_read</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">cr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ_WORD</span> <span class="n">wdata</span><span class="p">;</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SOP_PU_SLEEP</span>:
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x30</span> <span class="o">+</span> <span class="n">cr</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_RINGING</span>:
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x70</span> <span class="o">+</span> <span class="n">cr</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_CONVERSATION</span>:
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0xB0</span> <span class="o">+</span> <span class="n">cr</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_PULSEDIALING</span>:
	<span class="nl">default:</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0xF0</span> <span class="o">+</span> <span class="n">cr</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>

	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="n">ALISDAA_ID_BYTE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Cannot read DAA ID Byte high = %d low = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">wdata</span><span class="p">.</span><span class="n">word</span> <span class="o">=</span> <span class="n">inw_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

	<span class="k">switch</span><span class="p">(</span><span class="n">cr</span><span class="p">){</span>
		<span class="k">case</span> <span class="mi">5</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">wdata</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">4</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">wdata</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">3</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">wdata</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">2</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">wdata</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">1</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">wdata</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="mi">0</span>:
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">wdata</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_daa_cid_reset</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA Clearing CID ram</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x58</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitHighSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitHighSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA CID ram cleared</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_daa_cid_read</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">CID</span><span class="p">[</span><span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">];</span>
	<span class="n">bool</span> <span class="n">mContinue</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">pIn</span><span class="p">,</span> <span class="o">*</span><span class="n">pOut</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x78</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitHighSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="n">ALISDAA_ID_BYTE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA Get Version Cannot read DAA ID Byte high = %d low = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">;</span> <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitHighSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

		<span class="n">CID</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
		<span class="n">CID</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">pIn</span> <span class="o">=</span> <span class="n">CID</span><span class="p">;</span>
	<span class="n">pOut</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">;</span>
	<span class="n">mContinue</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">mContinue</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x01</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pOut</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">pIn</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0c</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x04</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pOut</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x03</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xfc</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x30</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x10</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pOut</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x0f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xf0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xc0</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x40</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pOut</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">pIn</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mh">0xc0</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">mContinue</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">pIn</span> <span class="o">+=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pOut</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PHONE_CID</span><span class="p">));</span>
	<span class="n">pOut</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">;</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
	<span class="n">strncpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">month</span><span class="p">,</span> <span class="n">pOut</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">strncpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">day</span><span class="p">,</span> <span class="n">pOut</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">strncpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">hour</span><span class="p">,</span> <span class="n">pOut</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
	<span class="n">strncpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">min</span><span class="p">,</span> <span class="n">pOut</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">numlen</span> <span class="o">=</span> <span class="o">*</span><span class="n">pOut</span><span class="p">;</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">strncpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">number</span><span class="p">,</span> <span class="n">pOut</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">numlen</span><span class="p">);</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">numlen</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">namelen</span> <span class="o">=</span> <span class="o">*</span><span class="n">pOut</span><span class="p">;</span>
	<span class="n">pOut</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">strncpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pOut</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">.</span><span class="n">namelen</span><span class="p">);</span>

	<span class="n">ixj_daa_cid_reset</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">char</span> <span class="nf">daa_get_version</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x35</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="n">ALISDAA_ID_BYTE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA Get Version Cannot read DAA ID Byte high = %d low = %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_Enable_DAA</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x03</span><span class="p">);</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA CR5 Byte high = 0x%x low = 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">daa_set_mode</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* NOTE:</span>
<span class="cm">	      The DAA *MUST* be in the conversation mode if the</span>
<span class="cm">	      PSTN line is to be seized (PSTN line off-hook).</span>
<span class="cm">	      Taking the PSTN line off-hook while the DAA is in</span>
<span class="cm">	      a mode other than conversation mode will cause a</span>
<span class="cm">	      hardware failure of the ALIS-A part.</span>

<span class="cm">	   NOTE:</span>
<span class="cm">	      The DAA can only go to SLEEP, RINGING or PULSEDIALING modes</span>
<span class="cm">	      if the PSTN line is on-hook.  Failure to have the PSTN line</span>
<span class="cm">	      in the on-hook state WILL CAUSE A HARDWARE FAILURE OF THE</span>
<span class="cm">	      ALIS-A part.</span>
<span class="cm">	*/</span>

	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_rmr</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">mode</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">SOP_PU_RESET</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
		<span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">=</span> <span class="n">SOP_PU_SLEEP</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_SLEEP</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">==</span> <span class="n">SOP_PU_SLEEP</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;phone DAA: SOP_PU_SLEEP at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
<span class="cm">/*		if(j-&gt;daa_mode == SOP_PU_CONVERSATION) */</span>
		<span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
			<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
			<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
			<span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
		<span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">=</span> <span class="n">SOP_PU_SLEEP</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_sleeptil</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">/</span> <span class="mi">4</span><span class="p">);</span>
		<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">);</span>      <span class="cm">/* Wake any blocked readers */</span>
		<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">);</span>     <span class="cm">/* Wake any blocked writers */</span>
		<span class="n">wake_up_interruptible</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">poll_q</span><span class="p">);</span>      <span class="cm">/* Wake any blocked selects */</span>
 		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_RINGING</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;phone DAA: SOP_PU_RINGING at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x50</span><span class="p">;</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
		<span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">=</span> <span class="n">SOP_PU_RINGING</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_CONVERSATION</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;phone DAA: SOP_PU_CONVERSATION at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x90</span><span class="p">;</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
		<span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Turn on DAA Frame Sync */</span>

		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">=</span> <span class="n">SOP_PU_CONVERSATION</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_sleeptil</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_start</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">SOP_PU_PULSEDIALING</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0008</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;phone DAA: SOP_PU_PULSEDIALING at %ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0xD0</span><span class="p">;</span>
		<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
		<span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span> <span class="o">=</span> <span class="n">SOP_PU_PULSEDIALING</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_daa_write</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstncheck</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

	<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_SLEEP</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x14</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x1F</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr7</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr6_W</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr5</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr4</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr3</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr2</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr1</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr0_W</span><span class="p">.</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Prepare</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x03</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x06</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0C</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0D</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_WaitLowSCI</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0F</span><span class="p">;</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">daa_load</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bytes</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">udelay</span><span class="p">(</span><span class="mi">32</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">SCI_Control</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SCI_End</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA Coefficients Loaded</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstncheck</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_set_tone_off</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">arg</span><span class="p">,</span> <span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_off_time</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6E05</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Set Tone Off Period */</span>

		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_get_tone_on</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6E06</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Get Tone On Period */</span>

		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_get_tone_off</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6E07</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Get Tone Off Period */</span>

		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_busytone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringback</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dialtone</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">busytone</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="mh">0x07D0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="mh">0x07D0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">27</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_dialtone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringback</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dialtone</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">busytone</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="mh">0xFFFF</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_cpt_stop</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dialtone</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">busytone</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringback</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="mh">0x0001</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">);</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
		<span class="n">idle</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span>
		<span class="n">ixj_play_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span>
		<span class="n">ixj_record_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_ringback</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">busytone</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dialtone</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringback</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="mh">0x0FA0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="mh">0x2EE0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">26</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">ixj_testram</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x3001</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Test External SRAM */</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_build_cadence</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_CADENCE</span> <span class="n">__user</span> <span class="o">*</span> <span class="n">cp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ixj_cadence</span> <span class="o">*</span><span class="n">lcp</span><span class="p">;</span>
	<span class="n">IXJ_CADENCE_ELEMENT</span> <span class="n">__user</span> <span class="o">*</span><span class="n">cep</span><span class="p">;</span>
	<span class="n">IXJ_CADENCE_ELEMENT</span> <span class="o">*</span><span class="n">lcep</span><span class="p">;</span>
	<span class="n">IXJ_TONE</span> <span class="n">ti</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">err</span><span class="p">;</span>

	<span class="n">lcp</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">ixj_cadence</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lcp</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">elements_used</span><span class="p">,</span>
			   <span class="o">&amp;</span><span class="n">cp</span><span class="o">-&gt;</span><span class="n">elements_used</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)))</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">termination</span><span class="p">,</span>
			   <span class="o">&amp;</span><span class="n">cp</span><span class="o">-&gt;</span><span class="n">termination</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ_CADENCE_TERM</span><span class="p">)))</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">get_user</span><span class="p">(</span><span class="n">cep</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cp</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">))</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">((</span><span class="kt">unsigned</span><span class="p">)</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">elements_used</span> <span class="o">&gt;=</span> <span class="o">~</span><span class="mi">0U</span><span class="o">/</span><span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ_CADENCE_ELEMENT</span><span class="p">))</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
	<span class="n">lcep</span> <span class="o">=</span> <span class="n">kmalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ_CADENCE_ELEMENT</span><span class="p">)</span> <span class="o">*</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">elements_used</span><span class="p">,</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">lcep</span><span class="p">)</span>
		<span class="k">goto</span> <span class="n">out</span><span class="p">;</span>

	<span class="n">err</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="n">lcep</span><span class="p">,</span> <span class="n">cep</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ_CADENCE_ELEMENT</span><span class="p">)</span> <span class="o">*</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">elements_used</span><span class="p">))</span>
		<span class="k">goto</span> <span class="n">out1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">);</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">lcp</span><span class="o">-&gt;</span><span class="n">ce</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span> <span class="n">lcep</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span> <span class="o">=</span> <span class="n">lcp</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">tone_on_time</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">tone_off_time</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ti</span><span class="p">.</span><span class="n">tone_index</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">index</span><span class="p">;</span>
		<span class="n">ti</span><span class="p">.</span><span class="n">freq0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq0</span><span class="p">;</span>
		<span class="n">ti</span><span class="p">.</span><span class="n">gain0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">gain0</span><span class="p">;</span>
		<span class="n">ti</span><span class="p">.</span><span class="n">freq1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">freq1</span><span class="p">;</span>
		<span class="n">ti</span><span class="p">.</span><span class="n">gain1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_t</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_cadence_state</span><span class="p">].</span><span class="n">gain1</span><span class="p">;</span>
		<span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">ce</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">index</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="nl">out1:</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">lcep</span><span class="p">);</span>
<span class="nl">out:</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">lcp</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">err</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_build_filter_cadence</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_FILTER_CADENCE</span> <span class="n">__user</span> <span class="o">*</span> <span class="n">cp</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ_FILTER_CADENCE</span> <span class="o">*</span><span class="n">lcp</span><span class="p">;</span>
	<span class="n">lcp</span> <span class="o">=</span> <span class="n">memdup_user</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ_FILTER_CADENCE</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">IS_ERR</span><span class="p">(</span><span class="n">lcp</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Could not allocate memory for cadence or could not copy cadence to kernel</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="n">PTR_ERR</span><span class="p">(</span><span class="n">lcp</span><span class="p">);</span>
        <span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0001</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Cadence out of range</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="n">kfree</span><span class="p">(</span><span class="n">lcp</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">enable</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">enable</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_en</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">en_filter</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">en_filter</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on1</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">on1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on1min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on1max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off1</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">off1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off1min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off1max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on2</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">on2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on2min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on2max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off2</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">off2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off2min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off2max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on3</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">on3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on3min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">on3max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off3</span> <span class="o">=</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">off3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off3min</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">].</span><span class="n">off3max</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Cadence %d loaded</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">lcp</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">lcp</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">add_caps</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">PHONE_VENDOR_QUICKNET</span><span class="p">;</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;Quicknet Technologies, Inc. (www.quicknet.net)&quot;</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">vendor</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">device</span><span class="p">;</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;Quicknet Internet PhoneJACK&quot;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;Quicknet Internet LineJACK&quot;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_LITE</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;Quicknet Internet PhoneJACK Lite&quot;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;Quicknet Internet PhoneJACK PCI&quot;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;Quicknet Internet PhoneCARD&quot;</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;POTS&quot;</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">port</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">pots</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

 	<span class="cm">/* add devices that can do speaker/mic */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
	<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
	<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;SPEAKER&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">port</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">speaker</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
        <span class="nl">default:</span>
     		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

 	<span class="cm">/* add devices that can do handset */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;HANDSET&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">port</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">handset</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
        <span class="nl">default:</span>
     		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

 	<span class="cm">/* add devices that can do PSTN */</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;PSTN&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">port</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">pstn</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
        <span class="nl">default:</span>
     		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* add codecs - all cards can do uLaw, linear 8/16, and Windows sound system */</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;ULAW&quot;</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">ULAW</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

	<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;LINEAR 16 bit&quot;</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">LINEAR16</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

	<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;LINEAR 8 bit&quot;</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">LINEAR8</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

	<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;Windows Sound System&quot;</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">WSS</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

	<span class="cm">/* software ALAW codec, made from ULAW */</span>
	<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;ALAW&quot;</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">ALAW</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

	<span class="cm">/* version 12 of the 8020 does the following codecs in a broken way */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;G.723.1 6.3kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">G723_63</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;G.723.1 5.3kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">G723_53</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 4.8kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">TS48</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>

		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 4.1kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">TS41</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* 8020 chips can do TS8.5 native, and 8021/8022 can load it */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ts85_loaded</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 8.5kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">TS85</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* 8021 chips can do G728 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x21</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;G.728 16kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">G728</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="cm">/* 8021/8022 chips can do G729 if loaded */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;G.729A 8kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">G729</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">strcpy</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">desc</span><span class="p">,</span> <span class="s">&quot;G.729B 8kbps&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">captype</span> <span class="o">=</span> <span class="n">codec</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">cap</span> <span class="o">=</span> <span class="n">G729B</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">].</span><span class="n">handle</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="o">++</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">capabilities_check</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="k">struct</span> <span class="n">phone_capability</span> <span class="o">*</span><span class="n">pcreq</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">pcreq</span><span class="o">-&gt;</span><span class="n">captype</span> <span class="o">==</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">captype</span>
		    <span class="o">&amp;&amp;</span> <span class="n">pcreq</span><span class="o">-&gt;</span><span class="n">cap</span> <span class="o">==</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">cap</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">long</span> <span class="nf">do_ixj_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file_p</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ_TONE</span> <span class="n">ti</span><span class="p">;</span>
	<span class="n">IXJ_FILTER</span> <span class="n">jf</span><span class="p">;</span>
	<span class="n">IXJ_FILTER_RAW</span> <span class="n">jfr</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="n">argp</span> <span class="o">=</span> <span class="p">(</span><span class="kt">void</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span><span class="n">arg</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">inode</span> <span class="o">*</span><span class="n">inode</span> <span class="o">=</span> <span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_path</span><span class="p">.</span><span class="n">dentry</span><span class="o">-&gt;</span><span class="n">d_inode</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">minor</span> <span class="o">=</span> <span class="n">iminor</span><span class="p">(</span><span class="n">inode</span><span class="p">);</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">raise</span><span class="p">,</span> <span class="n">mant</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">board</span> <span class="o">=</span> <span class="n">NUM</span><span class="p">(</span><span class="n">inode</span><span class="p">);</span>

	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">NUM</span><span class="p">(</span><span class="n">inode</span><span class="p">));</span>

	<span class="kt">int</span> <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 *    Set up locks to ensure that only one process is talking to the DSP at a time.</span>
<span class="cm">	 *    This is necessary to keep the DSP from locking up.</span>
<span class="cm">	 */</span>
	<span class="k">while</span><span class="p">(</span><span class="n">test_and_set_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">schedule_timeout_interruptible</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;phone%d ioctl, cmd: 0x%x, arg: 0x%lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">minor</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">minor</span> <span class="o">&gt;=</span> <span class="n">IXJMAX</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/*</span>
<span class="cm">	 *    Check ioctls only root can use.</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">capable</span><span class="p">(</span><span class="n">CAP_SYS_ADMIN</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">cmd</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">IXJCTL_TESTRAM</span>:
		<span class="k">case</span> <span class="n">IXJCTL_HZ</span>:
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EPERM</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">cmd</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">IXJCTL_TESTRAM</span>:
		<span class="n">ixj_testram</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_CARDTYPE</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_SERIAL</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">serial</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_VERSION</span>:
		<span class="p">{</span>
			<span class="kt">char</span> <span class="n">arg_str</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
			<span class="n">snprintf</span><span class="p">(</span><span class="n">arg_str</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">arg_str</span><span class="p">),</span>
				<span class="s">&quot;</span><span class="se">\n</span><span class="s">Driver version %i.%i.%i&quot;</span><span class="p">,</span> <span class="n">IXJ_VER_MAJOR</span><span class="p">,</span>
				<span class="n">IXJ_VER_MINOR</span><span class="p">,</span> <span class="n">IXJ_BLD_VER</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">copy_to_user</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span> <span class="n">arg_str</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">arg_str</span><span class="p">)))</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_RING_CADENCE</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_CIDCW</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PHONE_CID</span><span class="p">)))</span> <span class="p">{</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PHONE_CID</span><span class="p">));</span>
		<span class="p">}</span>
		<span class="n">ixj_write_cidcw</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
        <span class="cm">/* Binary compatbility */</span>
        <span class="k">case</span> <span class="n">OLD_PHONE_RING_START</span>:
                <span class="n">arg</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="cm">/* Fall through */</span>
 	<span class="k">case</span> <span class="n">PHONE_RING_START</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PHONE_CID</span><span class="p">)))</span> <span class="p">{</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">ixj_write_cid</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_send</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PHONE_CID</span><span class="p">));</span>
		<span class="p">}</span>
		<span class="n">ixj_ring_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_RING_STOP</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">enable</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">ixj_ring_off</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_RING</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_ring</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_EXCEPTION</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bytes</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">flash</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flash_end</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">flash</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">caller_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_wink</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">reserved</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_HOOKSTATE</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hookstate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span><span class="p">;</span>  <span class="c1">//j-&gt;r_hook;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_SET_LED</span>:
		<span class="n">LED_SetState</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_FRAME</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">set_base_frame</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_REC_CODEC</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">set_rec_codec</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_VAD</span>:
		<span class="n">ixj_vad</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_REC_START</span>:
		<span class="n">ixj_record_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_REC_STOP</span>:
		<span class="n">ixj_record_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_REC_DEPTH</span>:
		<span class="n">set_rec_depth</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_REC_VOLUME</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">get_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="n">set_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_REC_VOLUME_LINEAR</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">get_rec_volume_linear</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="n">set_rec_volume_linear</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_DTMF_PRESCALE</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">get_dtmf_prescale</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="n">set_dtmf_prescale</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_REC_LEVEL</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">get_rec_level</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_SC_RXG</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_siadc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_SC_TXG</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_sidac</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_AEC_START</span>:
		<span class="n">ixj_aec_start</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_AEC_STOP</span>:
		<span class="n">aec_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_AEC_GET_LEVEL</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_CODEC</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">set_play_codec</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_START</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_play_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_STOP</span>:
		<span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_DEPTH</span>:
		<span class="n">set_play_depth</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_VOLUME</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">get_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="n">set_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_VOLUME_LINEAR</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">get_play_volume_linear</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">else</span> <span class="p">{</span>
			<span class="n">set_play_volume_linear</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_LEVEL</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">get_play_level</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_DSP_TYPE</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_DSP_VERSION</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_HZ</span>:
		<span class="n">hertz</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_RATE</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">arg</span> <span class="o">&gt;</span> <span class="n">hertz</span><span class="p">)</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">samplerate</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_DRYBUFFER_READ</span>:
		<span class="n">put_user</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">drybuffer</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span> <span class="n">argp</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_DRYBUFFER_CLEAR</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">drybuffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_FRAMES_READ</span>:
		<span class="n">put_user</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">framesread</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span> <span class="n">argp</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_FRAMES_WRITTEN</span>:
		<span class="n">put_user</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">frameswritten</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span> <span class="n">argp</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_READ_WAIT</span>:
		<span class="n">put_user</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_wait</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span> <span class="n">argp</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_WRITE_WAIT</span>:
		<span class="n">put_user</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_wait</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">__user</span> <span class="o">*</span><span class="p">)</span> <span class="n">argp</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_MAXRINGS</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">maxrings</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_SET_TONE_ON_TIME</span>:
		<span class="n">ixj_set_tone_on</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_SET_TONE_OFF_TIME</span>:
		<span class="n">ixj_set_tone_off</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_GET_TONE_ON_TIME</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_get_tone_on</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_GET_TONE_OFF_TIME</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_get_tone_off</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PLAY_TONE</span>:
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="p">)</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_play_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">else</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_GET_TONE_STATE</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">tone_state</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_DTMF_READY</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_GET_DTMF</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">!=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmfbuffer</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span><span class="p">];</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span><span class="o">++</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">==</span> <span class="mi">79</span><span class="p">)</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">==</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span><span class="p">)</span> <span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_GET_DTMF_ASCII</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_hookstate</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">!=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmfbuffer</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span><span class="p">])</span> <span class="p">{</span>
				<span class="k">case</span> <span class="mi">10</span>:
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>	<span class="cm">/* &#39;*&#39;; */</span>

					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mi">11</span>:
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">48</span><span class="p">;</span>	<span class="cm">/*&#39;0&#39;; */</span>

					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mi">12</span>:
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">35</span><span class="p">;</span>	<span class="cm">/*&#39;#&#39;; */</span>

					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mi">28</span>:
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">65</span><span class="p">;</span>	<span class="cm">/*&#39;A&#39;; */</span>

					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mi">29</span>:
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">66</span><span class="p">;</span>	<span class="cm">/*&#39;B&#39;; */</span>

					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mi">30</span>:
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">67</span><span class="p">;</span>	<span class="cm">/*&#39;C&#39;; */</span>

					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mi">31</span>:
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">68</span><span class="p">;</span>	<span class="cm">/*&#39;D&#39;; */</span>

					<span class="k">break</span><span class="p">;</span>
				<span class="nl">default:</span>
					<span class="n">retval</span> <span class="o">=</span> <span class="mi">48</span> <span class="o">+</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmfbuffer</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span><span class="p">];</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span><span class="o">++</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">==</span> <span class="mi">79</span><span class="p">)</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">==</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_DTMF_OOB</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dtmf_oob</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_DIALTONE</span>:
		<span class="n">ixj_dialtone</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_BUSY</span>:
		<span class="n">ixj_busytone</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_RINGBACK</span>:
		<span class="n">ixj_ringback</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_WINK</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK</span><span class="p">)</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_wink</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_CPT_STOP</span>:
		<span class="n">ixj_cpt_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
        <span class="k">case</span> <span class="n">PHONE_QUERY_CODEC</span>:
        <span class="p">{</span>
                <span class="k">struct</span> <span class="n">phone_codec_data</span> <span class="n">pd</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">val</span><span class="p">;</span>
                <span class="kt">int</span> <span class="n">proto_size</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                        <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
                        <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">6</span>
                <span class="p">};</span>
                <span class="k">if</span><span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pd</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">pd</span><span class="p">)))</span> <span class="p">{</span>
                        <span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">type</span><span class="o">&lt;</span><span class="mi">1</span> <span class="o">||</span> <span class="n">pd</span><span class="p">.</span><span class="n">type</span><span class="o">&gt;</span><span class="mi">13</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EPROTONOSUPPORT</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="n">type</span><span class="o">&lt;</span><span class="n">G729</span><span class="p">)</span>
                        <span class="n">val</span><span class="o">=</span><span class="n">proto_size</span><span class="p">[</span><span class="n">pd</span><span class="p">.</span><span class="n">type</span><span class="p">];</span>
                <span class="k">else</span> <span class="k">switch</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">)</span>
                <span class="p">{</span>
                        <span class="k">case</span> <span class="mh">0xA0</span>:<span class="n">val</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">proto_size</span><span class="p">[</span><span class="n">pd</span><span class="p">.</span><span class="n">type</span><span class="p">];</span><span class="k">break</span><span class="p">;</span>
                        <span class="k">case</span> <span class="mh">0x50</span>:<span class="n">val</span><span class="o">=</span><span class="n">proto_size</span><span class="p">[</span><span class="n">pd</span><span class="p">.</span><span class="n">type</span><span class="p">];</span><span class="k">break</span><span class="p">;</span>
                        <span class="nl">default:</span><span class="n">val</span><span class="o">=</span><span class="n">proto_size</span><span class="p">[</span><span class="n">pd</span><span class="p">.</span><span class="n">type</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">;</span><span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">pd</span><span class="p">.</span><span class="n">buf_min</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">buf_max</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">buf_opt</span><span class="o">=</span><span class="n">val</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">copy_to_user</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">pd</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">pd</span><span class="p">)))</span>
                        <span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
        	<span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
	<span class="k">case</span> <span class="n">IXJCTL_DSP_IDLE</span>:
		<span class="n">idle</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_MIXER</span>:
                <span class="k">if</span> <span class="p">((</span><span class="n">arg</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0xff</span><span class="p">)</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_get_mixer</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
                <span class="k">else</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_DAA_COEFF_SET</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">DAA_US</span>:
			<span class="n">DAA_Coeff_US</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">DAA_UK</span>:
			<span class="n">DAA_Coeff_UK</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">DAA_FRANCE</span>:
			<span class="n">DAA_Coeff_France</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">DAA_GERMANY</span>:
			<span class="n">DAA_Coeff_Germany</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">DAA_AUSTRALIA</span>:
			<span class="n">DAA_Coeff_Australia</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">DAA_JAPAN</span>:
			<span class="n">DAA_Coeff_Japan</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_DAA_AGAIN</span>:
		<span class="n">ixj_daa_cr4</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span> <span class="o">|</span> <span class="mh">0x02</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_PSTN_LINETEST</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_linetest</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_VMWI</span>:
		<span class="n">ixj_write_vmwi</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_CID</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">copy_to_user</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cid</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">PHONE_CID</span><span class="p">)))</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">caller_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_WINK_DURATION</span>:
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">winktime</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_PORT</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">arg</span><span class="p">)</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_set_port</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">else</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_POTS_PSTN</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_set_pots</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_CAPABILITIES</span>:
		<span class="n">add_caps</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_CAPABILITIES_LIST</span>:
		<span class="n">add_caps</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">copy_to_user</span><span class="p">(</span><span class="n">argp</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caplist</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">phone_capability</span><span class="p">)</span> <span class="o">*</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">))</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_CAPABILITIES_CHECK</span>:
		<span class="p">{</span>
			<span class="k">struct</span> <span class="n">phone_capability</span> <span class="n">cap</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cap</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">cap</span><span class="p">)))</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">else</span> <span class="p">{</span>
				<span class="n">add_caps</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
				<span class="n">retval</span> <span class="o">=</span> <span class="n">capabilities_check</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">cap</span><span class="p">);</span>
			<span class="p">}</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PSTN_SET_STATE</span>:
		<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">PHONE_PSTN_GET_STATE</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_SET_FILTER</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">jf</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">jf</span><span class="p">)))</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_init_filter</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">jf</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_SET_FILTER_RAW</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">jfr</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">jfr</span><span class="p">)))</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_init_filter_raw</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">jfr</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_GET_FILTER_HIST</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">||</span><span class="n">arg</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">)</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_hist</span><span class="p">[</span><span class="n">arg</span><span class="p">];</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_INIT_TONE</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ti</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">ti</span><span class="p">)))</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_init_tone</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ti</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_TONE_CADENCE</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_build_cadence</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">argp</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_FILTER_CADENCE</span>:
		<span class="n">retval</span> <span class="o">=</span> <span class="n">ixj_build_filter_cadence</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">argp</span><span class="p">);</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_SIGCTL</span>:
		<span class="k">if</span> <span class="p">(</span><span class="n">copy_from_user</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sigdef</span><span class="p">,</span> <span class="n">argp</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ_SIGDEF</span><span class="p">)))</span> <span class="p">{</span>
			<span class="n">retval</span> <span class="o">=</span> <span class="o">-</span><span class="n">EFAULT</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ixj_signals</span><span class="p">[</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sigdef</span><span class="p">.</span><span class="n">event</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">sigdef</span><span class="p">.</span><span class="n">signal</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sigdef</span><span class="p">.</span><span class="n">event</span> <span class="o">&lt;</span> <span class="mi">33</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">raise</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="n">mant</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">mant</span> <span class="o">&lt;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">sigdef</span><span class="p">.</span><span class="n">event</span><span class="p">;</span> <span class="n">mant</span><span class="o">++</span><span class="p">){</span>
				<span class="n">raise</span> <span class="o">*=</span> <span class="mi">2</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">sigdef</span><span class="p">.</span><span class="n">signal</span><span class="p">)</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bytes</span> <span class="o">|=</span> <span class="n">raise</span><span class="p">;</span>
			<span class="k">else</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bytes</span> <span class="o">&amp;=</span> <span class="p">(</span><span class="n">raise</span><span class="o">^</span><span class="mh">0xffff</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_INTERCOM_STOP</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">arg</span> <span class="o">&gt;=</span> <span class="n">IXJMAX</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">ixj_record_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">idle</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">get_ixj</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">intercom</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">ixj_record_stop</span><span class="p">(</span><span class="n">get_ixj</span><span class="p">(</span><span class="n">arg</span><span class="p">));</span>
		<span class="n">ixj_play_stop</span><span class="p">(</span><span class="n">get_ixj</span><span class="p">(</span><span class="n">arg</span><span class="p">));</span>
		<span class="n">idle</span><span class="p">(</span><span class="n">get_ixj</span><span class="p">(</span><span class="n">arg</span><span class="p">));</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">IXJCTL_INTERCOM_START</span>:
		<span class="k">if</span><span class="p">(</span><span class="n">arg</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">arg</span> <span class="o">&gt;=</span> <span class="n">IXJMAX</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">-</span><span class="n">EINVAL</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span> <span class="o">=</span> <span class="n">arg</span><span class="p">;</span>
		<span class="n">ixj_record_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">ixj_play_start</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">get_ixj</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">intercom</span> <span class="o">=</span> <span class="n">board</span><span class="p">;</span>
		<span class="n">ixj_play_start</span><span class="p">(</span><span class="n">get_ixj</span><span class="p">(</span><span class="n">arg</span><span class="p">));</span>
		<span class="n">ixj_record_start</span><span class="p">(</span><span class="n">get_ixj</span><span class="p">(</span><span class="n">arg</span><span class="p">));</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0040</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="s">&quot;phone%d ioctl end, cmd: 0x%x, arg: 0x%lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">minor</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
	<span class="n">clear_bit</span><span class="p">(</span><span class="n">board</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">busyflags</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">long</span> <span class="nf">ixj_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file_p</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">cmd</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">arg</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">long</span> <span class="n">ret</span><span class="p">;</span>
	<span class="n">mutex_lock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ixj_mutex</span><span class="p">);</span>
	<span class="n">ret</span> <span class="o">=</span> <span class="n">do_ixj_ioctl</span><span class="p">(</span><span class="n">file_p</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">arg</span><span class="p">);</span>
	<span class="n">mutex_unlock</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ixj_mutex</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_fasync</span><span class="p">(</span><span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="k">struct</span> <span class="n">file</span> <span class="o">*</span><span class="n">file_p</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">NUM</span><span class="p">(</span><span class="n">file_p</span><span class="o">-&gt;</span><span class="n">f_path</span><span class="p">.</span><span class="n">dentry</span><span class="o">-&gt;</span><span class="n">d_inode</span><span class="p">));</span>

	<span class="k">return</span> <span class="n">fasync_helper</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">file_p</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">async_queue</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">file_operations</span> <span class="n">ixj_fops</span> <span class="o">=</span>
<span class="p">{</span>
        <span class="p">.</span><span class="n">owner</span>          <span class="o">=</span> <span class="n">THIS_MODULE</span><span class="p">,</span>
        <span class="p">.</span><span class="n">read</span>           <span class="o">=</span> <span class="n">ixj_enhanced_read</span><span class="p">,</span>
        <span class="p">.</span><span class="n">write</span>          <span class="o">=</span> <span class="n">ixj_enhanced_write</span><span class="p">,</span>
        <span class="p">.</span><span class="n">poll</span>           <span class="o">=</span> <span class="n">ixj_poll</span><span class="p">,</span>
        <span class="p">.</span><span class="n">unlocked_ioctl</span> <span class="o">=</span> <span class="n">ixj_ioctl</span><span class="p">,</span>
        <span class="p">.</span><span class="n">release</span>        <span class="o">=</span> <span class="n">ixj_release</span><span class="p">,</span>
        <span class="p">.</span><span class="n">fasync</span>         <span class="o">=</span> <span class="n">ixj_fasync</span><span class="p">,</span>
        <span class="p">.</span><span class="n">llseek</span>	 <span class="o">=</span> <span class="n">default_llseek</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_linetest</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstncheck</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Testing */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="cm">/* Assume the line is not there */</span>

	<span class="n">daa_int_read</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>	<span class="cm">/*Clear DAA Interrupt flags */</span>
	<span class="cm">/* */</span>
	<span class="cm">/* Hold all relays in the normally de-energized position. */</span>
	<span class="cm">/* */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

	<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicr</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">potspstn</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x4</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

		<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
		<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_CONVERSATION</span><span class="p">);</span>
		<span class="n">msleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
		<span class="n">daa_int_read</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_RESET</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Should not be line voltage on POTS port. */</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x4</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
	<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_CONVERSATION</span><span class="p">);</span>
	<span class="n">msleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
	<span class="n">daa_int_read</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">daa_set_mode</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">SOP_PU_RESET</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_sleeptil</span> <span class="o">=</span> <span class="n">jiffies</span> <span class="o">+</span> <span class="p">(</span><span class="n">hertz</span> <span class="o">/</span> <span class="mi">4</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0xA</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x6</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x9</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x5</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstncheck</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Testing */</span>
	<span class="k">return</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_selfprobe</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="n">BYTES</span> <span class="n">bytes</span><span class="p">;</span>

        <span class="n">init_waitqueue_head</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">poll_q</span><span class="p">);</span>
        <span class="n">init_waitqueue_head</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_q</span><span class="p">);</span>
        <span class="n">init_waitqueue_head</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_q</span><span class="p">);</span>

	<span class="k">while</span><span class="p">(</span><span class="n">atomic_read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
		<span class="n">atomic_dec</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPWrite</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Write IDLE to Software Control Register</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0FE0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Put the DSP in full power mode. */</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Write IDLE to Software Control Register */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="cm">/* The read values of the SSR should be 0x00 for the IDLE command */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Get Device ID Code</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x3400</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Get Device ID Code */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Get Device Version Code</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x3800</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Get Device Version Code */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x21</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">^</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
<span class="cm">/* Test for Internet LineJACK or Internet PhoneJACK Lite */</span>
			<span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">inb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x02</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="n">bytes</span><span class="p">.</span><span class="n">high</span><span class="p">)</span>	<span class="cm">/*  Register is read only on */</span>
				<span class="cm">/*  Internet PhoneJack Lite */</span>
			 <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_PHONEJACK_LITE</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">request_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;ixj control&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: can&#39;t get I/O address 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
					<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_LINEJACK</span><span class="p">;</span>

				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">request_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;ixj control&quot;</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: can&#39;t get I/O address 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
					<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x22</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_PHONEJACK_PCI</span><span class="p">;</span>
			<span class="n">request_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;ixj control&quot;</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_PHONEJACK</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">QTI_PHONEJACK</span>:
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x3800</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_LINEJACK</span>:
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">request_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&quot;ixj control&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: can&#39;t get I/O address 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_PHONEJACK_LITE</span>:
		<span class="k">case</span> <span class="n">QTI_PHONEJACK_PCI</span>:
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">request_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s">&quot;ixj control&quot;</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: can&#39;t get I/O address 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">pcib</span><span class="p">.</span><span class="n">e1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">QTI_PHONECARD</span>:
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK_LITE</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK_PCI</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Write CODEC config to Software Control Register</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xC462</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Write CODEC config to Software Control Register */</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Write CODEC timing to Software Control Register</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x9FF2</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x9FF5</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>	<span class="cm">/* Write CODEC timing to Software Control Register */</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">set_base_frame</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">30</span><span class="p">)</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Write CODEC config to Software Control Register</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xC528</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Write CODEC config to Software Control Register */</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xC528</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Write CODEC config to Software Control Register */</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Turn on the PLD Clock at 8Khz</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_clock</span><span class="p">.</span><span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_clock</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x04</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x20</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Configure GPIO pins</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
<span class="cm">/*  bytes.low = 0xEF;  0xF7 */</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio4</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio5</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio6</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio7</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">word</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Set GPIO pin directions */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Enable SLIC</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">high</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bytes</span><span class="p">.</span><span class="n">low</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">gpio5</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">gpio</span><span class="p">.</span><span class="n">word</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* send the ring stop signal */</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_POTS</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x1</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">msleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x2</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">msleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x4</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">msleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x8</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">msleep</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
			<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
			<span class="n">daa_get_version</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;Loading DAA Coefficients</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">DAA_Coeff_US</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">ixj_daa_write</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA write failed on board %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">ixj_daa_cid_reset</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;DAA CID reset failed on board %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">);</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">ixj_linetest</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

				<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">spken</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
				<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
				<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_STANDBY</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="cm">/*				SLIC_SetState(PLD_SLIC_STATE_ACTIVE, j); */</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span> <span class="o">=</span> <span class="n">PORT_POTS</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">ixj_set_port</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">PORT_PSTN</span><span class="p">);</span>
			<span class="n">ixj_set_pots</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Enable Mixer</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Master Volume Left unmute 0db */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0100</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Master Volume Right unmute 0db */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0203</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Voice Left Volume unmute 6db */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0303</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Voice Right Volume unmute 6db */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0480</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*FM Left mute */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0580</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*FM Right mute */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0680</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*CD Left mute */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0780</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*CD Right mute */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0880</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Line Left mute */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0980</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Line Right mute */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0A80</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Aux left mute  */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0B80</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Aux right mute */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0C00</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mono1 unmute 12db */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0D80</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mono2 mute */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0E80</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mic mute */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x0F00</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mono Out Volume unmute 0db */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1000</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Voice Left and Right out only */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x110C</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>


			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1200</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mono1 switch on mixer left */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1401</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1300</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>       <span class="cm">/*Mono1 switch on mixer right */</span>
			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1501</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1700</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Clock select */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1800</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*ADC input from mixer */</span>

			<span class="n">ixj_mixer</span><span class="p">(</span><span class="mh">0x1901</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/*Mic gain 30db */</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Setting Default US Ring Cadence Detection</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/*Cadence Filter 4 is used for PSTN ring cadence */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">on3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">off3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* These should represent standard US ring pulse. */</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_last_rmr</span> <span class="o">=</span> <span class="n">jiffies</span><span class="p">;</span>

		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONECARD</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0xCF07</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x00B0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="n">ixj_set_port</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">PORT_SPEAKER</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
				<span class="n">ixj_set_port</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">PORT_POTS</span><span class="p">);</span>
				<span class="n">SLIC_SetState</span><span class="p">(</span><span class="n">PLD_SLIC_STATE_STANDBY</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
<span class="cm">/*				SLIC_SetState(PLD_SLIC_STATE_ACTIVE, j); */</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">intercom</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">framesread</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">frameswritten</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">read_wait</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_wait</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">rxreadycheck</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">txreadycheck</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* initialise the DTMF prescale to a sensible value */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">set_dtmf_prescale</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">set_dtmf_prescale</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x40</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">set_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">);</span>
	<span class="n">set_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mh">0x100</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0000</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Write IDLE to Software Control Register */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="cm">/* The read values of the SSR should be 0x00 for the IDLE command */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">low</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ssr</span><span class="p">.</span><span class="n">high</span><span class="p">)</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Enable Line Monitor</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Set Line Monitor to Asyncronous Mode</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x7E01</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Asynchronous Line Monitor */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;Enable DTMF Detectors</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5151</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Enable DTMF detection */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6E01</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Set Asyncronous Tone Generation */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="n">set_rec_depth</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>	<span class="cm">/* Set Record Channel Limit to 2 frames */</span>

	<span class="n">set_play_depth</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>	<span class="cm">/* Set Playback Channel Limit to 2 frames */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_wp</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dtmf_rp</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_mode</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">play_mode</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">ringing</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">maxrings</span> <span class="o">=</span> <span class="n">MAXRINGS</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ring_cadence</span> <span class="o">=</span> <span class="n">USA_RING_CADENCE</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">drybuffer</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">winktime</span> <span class="o">=</span> <span class="mi">320</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">dtmf_oob</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="n">cnt</span><span class="p">].</span><span class="n">enable</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="cm">/* must be a device on the specified address */</span>
	<span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x0FE3</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>	<span class="cm">/* Put the DSP in 1/5 power mode. */</span>

	<span class="cm">/* Set up the default signals for events */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">ixj_signals</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="n">SIGIO</span><span class="p">;</span>

	<span class="cm">/* Set the excetion signal enable flags */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">dtmf_ready</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">hookstate</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">flash</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_ring</span> <span class="o">=</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">caller_id</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">pstn_wink</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f2</span> <span class="o">=</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">f3</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc0</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ex_sig</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="cp">#ifdef IXJ_DYN_ALLOC</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdata</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">fskdcnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cidcw_wait</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* Register with the Telephony for Linux subsystem */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">f_op</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ixj_fops</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">open</span> <span class="o">=</span> <span class="n">ixj_open</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">p</span><span class="p">.</span><span class="n">board</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span><span class="p">;</span>
	<span class="n">phone_register_device</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">p</span><span class="p">,</span> <span class="n">PHONE_UNIT_ANY</span><span class="p">);</span>

	<span class="n">ixj_init_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="n">ixj_add_timer</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> *	Exported service for pcmcia card handling</span>
<span class="cm"> */</span>

<span class="n">IXJ</span> <span class="o">*</span><span class="nf">ixj_pcmcia_probe</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">dsp</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">xilinx</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">ixj_alloc</span><span class="p">();</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">=</span> <span class="n">dsp</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">=</span> <span class="n">xilinx</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_PHONECARD</span><span class="p">;</span>
	<span class="n">ixj_selfprobe</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">j</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">EXPORT_SYMBOL</span><span class="p">(</span><span class="n">ixj_pcmcia_probe</span><span class="p">);</span>		<span class="cm">/* Fpr PCMCIA */</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_get_status_proc</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">buf</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">len</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">;</span>
	<span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Driver version %i.%i.%i&quot;</span><span class="p">,</span> <span class="n">IXJ_VER_MAJOR</span><span class="p">,</span> <span class="n">IXJ_VER_MINOR</span><span class="p">,</span> <span class="n">IXJ_BLD_VER</span><span class="p">);</span>
	<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">sizeof IXJ struct %Zd bytes&quot;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">IXJ</span><span class="p">));</span>
	<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">sizeof DAA struct %Zd bytes&quot;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">DAA_REGS</span><span class="p">));</span>
	<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Using old telephony API&quot;</span><span class="p">);</span>
	<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Debug Level %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ixjdebug</span><span class="p">);</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">IXJMAX</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">cnt</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">==</span><span class="nb">NULL</span><span class="p">)</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Card Num %d&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DSP Base Address 0x%4.4x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">!=</span> <span class="n">QTI_PHONEJACK</span><span class="p">)</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">XILINX Base Address 0x%4.4x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DSP Type %2.2x%2.2x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DSP Version %2.2x.%2.2x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Serial Number %8.8x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">serial</span><span class="p">);</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="p">(</span><span class="n">QTI_PHONEJACK</span><span class="p">)</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Card Type = Internet PhoneJACK&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="p">(</span><span class="n">QTI_LINEJACK</span><span class="p">)</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Card Type = Internet LineJACK&quot;</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot; w/G.729 A/B&quot;</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot; Country = %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_country</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="p">(</span><span class="n">QTI_PHONEJACK_LITE</span><span class="p">)</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Card Type = Internet PhoneJACK Lite&quot;</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot; w/G.729 A/B&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="p">(</span><span class="n">QTI_PHONEJACK_PCI</span><span class="p">)</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Card Type = Internet PhoneJACK PCI&quot;</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot; w/G.729 A/B&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="p">(</span><span class="n">QTI_PHONECARD</span><span class="p">)</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Card Type = Internet PhoneCARD&quot;</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">g729_loaded</span><span class="p">)</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot; w/G.729 A/B&quot;</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Smart Cable %spresent&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">drf</span> <span class="o">?</span> <span class="s">&quot;not &quot;</span> <span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pccr1</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">drf</span><span class="p">)</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Smart Cable type %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciasct</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Smart Cable state %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pcmciastate</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Card Type = %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Readers %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">readers</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Writers %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">writers</span><span class="p">);</span>
			<span class="n">add_caps</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Capabilities %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">caps</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x20</span><span class="p">)</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DSP Processor load %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">proc_load</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">cidsent</span><span class="p">)</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Caller ID data sent&quot;</span><span class="p">);</span>
			<span class="k">else</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Caller ID data not sent&quot;</span><span class="p">);</span>

			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Play CODEC &quot;</span><span class="p">);</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">play_codec</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">G723_63</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.723.1 6.3&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G723_53</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.723.1 5.3&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">TS85</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 8.5&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">TS48</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 4.8&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">TS41</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 4.1&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G728</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.728&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G729</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.729&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G729B</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.729B&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">ULAW</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;uLaw&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">ALAW</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;aLaw&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">LINEAR16</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;16 bit Linear&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">LINEAR8</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;8 bit Linear&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">WSS</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;Windows Sound System&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;NO CODEC CHOSEN&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Record CODEC &quot;</span><span class="p">);</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">rec_codec</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">G723_63</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.723.1 6.3&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G723_53</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.723.1 5.3&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">TS85</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 8.5&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">TS48</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 4.8&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">TS41</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;TrueSpeech 4.1&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G728</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.728&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G729</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.729&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">G729B</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;G.729B&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">ULAW</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;uLaw&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">ALAW</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;aLaw&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">LINEAR16</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;16 bit Linear&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">LINEAR8</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;8 bit Linear&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">WSS</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;Windows Sound System&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;NO CODEC CHOSEN&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">AEC &quot;</span><span class="p">);</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">AEC_OFF</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;Off&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">AEC_LOW</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;Low&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">AEC_MED</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;Med&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">AEC_HIGH</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;High&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">AEC_AUTO</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;Auto&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">AEC_AGC</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;AEC/AGC&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="nl">default:</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;unknown(%i)&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">aec_level</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Rec volume 0x%x&quot;</span><span class="p">,</span> <span class="n">get_rec_volume</span><span class="p">(</span><span class="n">j</span><span class="p">));</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Play volume 0x%x&quot;</span><span class="p">,</span> <span class="n">get_play_volume</span><span class="p">(</span><span class="n">j</span><span class="p">));</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DTMF prescale 0x%x&quot;</span><span class="p">,</span> <span class="n">get_dtmf_prescale</span><span class="p">(</span><span class="n">j</span><span class="p">));</span>

			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Hook state %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">hookstate</span><span class="p">);</span> <span class="cm">/* j-&gt;r_hook);	*/</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">POTS Correct %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_correct</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">PSTN Present %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstn_present</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">PSTN Check %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pstncheck</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">POTS to PSTN %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">.</span><span class="n">pots_pstn</span><span class="p">);</span>
				<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_mode</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">case</span> <span class="n">SOP_PU_SLEEP</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA PSTN On Hook&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">SOP_PU_RINGING</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA PSTN Ringing&quot;</span><span class="p">);</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Ringing state = %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cadence_f</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="n">state</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">SOP_PU_CONVERSATION</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA PSTN Off Hook&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">SOP_PU_PULSEDIALING</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA PSTN Pulse Dialing&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA RMR = %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">RMR</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA VDD OK = %d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">bitreg</span><span class="p">.</span><span class="n">VDD_OK</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA CR0 = 0x%02x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA CR1 = 0x%02x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA CR2 = 0x%02x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA CR3 = 0x%02x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA CR4 = 0x%02x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA CR5 = 0x%02x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr5</span><span class="p">.</span><span class="n">reg</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA XR0 = 0x%02x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr0</span><span class="p">.</span><span class="n">reg</span><span class="p">);</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">DAA ringstop %ld - jiffies %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pstn_ring_stop</span><span class="p">,</span> <span class="n">jiffies</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="k">switch</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">port</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="n">PORT_POTS</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Port POTS&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">PORT_PSTN</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Port PSTN&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">PORT_SPEAKER</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Port SPEAKER/MIC&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="n">PORT_HANDSET</span>:
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Port HANDSET&quot;</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x21</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">dsp</span><span class="p">.</span><span class="n">low</span> <span class="o">==</span> <span class="mh">0x22</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">SLIC state &quot;</span><span class="p">);</span>
				<span class="k">switch</span> <span class="p">(</span><span class="n">SLIC_GetState</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="p">{</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OC</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;OC&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_RINGING</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;RINGING&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_ACTIVE</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;ACTIVE&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OHT</span>:	<span class="cm">/* On-hook transmit */</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;OHT&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_TIPOPEN</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;TIPOPEN&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_STANDBY</span>:
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;STANDBY&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_APR</span>:	<span class="cm">/* Active polarity reversal */</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;APR&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="n">PLD_SLIC_STATE_OHTPR</span>:	<span class="cm">/* OHT polarity reversal */</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;OHTPR&quot;</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="nl">default:</span>
					<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;%d&quot;</span><span class="p">,</span> <span class="n">SLIC_GetState</span><span class="p">(</span><span class="n">j</span><span class="p">));</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Base Frame %2.2x.%2.2x&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">high</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">baseframe</span><span class="p">.</span><span class="n">low</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">CID Base Frame %2d&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cid_base_frame_size</span><span class="p">);</span>
<span class="cp">#ifdef PERFMON_STATS</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Timer Checks %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">timerchecks</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">RX Ready Checks %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">rxreadycheck</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">TX Ready Checks %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">txreadycheck</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Frames Read %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">framesread</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Frames Written %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">frameswritten</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Dry Buffer %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">drybuffer</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Read Waits %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">read_wait</span><span class="p">);</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Write Waits %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">write_wait</span><span class="p">);</span>
                        <span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Status Waits %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">statuswait</span><span class="p">);</span>
                        <span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Status Wait Fails %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">statuswaitfail</span><span class="p">);</span>
                        <span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">PControl Waits %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pcontrolwait</span><span class="p">);</span>
                        <span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">PControl Wait Fails %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">pcontrolwaitfail</span><span class="p">);</span>
                        <span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Is Control Ready Checks %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">iscontrolready</span><span class="p">);</span>
                        <span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Is Control Ready Check failures %ld&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">iscontrolreadyfail</span><span class="p">);</span>

<span class="cp">#endif</span>
			<span class="n">len</span> <span class="o">+=</span> <span class="n">sprintf</span><span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="n">len</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_read_proc</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">page</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">start</span><span class="p">,</span> <span class="kt">off_t</span> <span class="n">off</span><span class="p">,</span>
                              <span class="kt">int</span> <span class="n">count</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">eof</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
        <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="n">ixj_get_status_proc</span><span class="p">(</span><span class="n">page</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&lt;=</span> <span class="n">off</span><span class="o">+</span><span class="n">count</span><span class="p">)</span> <span class="o">*</span><span class="n">eof</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="o">*</span><span class="n">start</span> <span class="o">=</span> <span class="n">page</span> <span class="o">+</span> <span class="n">off</span><span class="p">;</span>
        <span class="n">len</span> <span class="o">-=</span> <span class="n">off</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">len</span><span class="o">&gt;</span><span class="n">count</span><span class="p">)</span> <span class="n">len</span> <span class="o">=</span> <span class="n">count</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">len</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kt">void</span> <span class="nf">cleanup</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">IXJMAX</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span> <span class="o">=</span> <span class="n">get_ixj</span><span class="p">(</span><span class="n">cnt</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">j</span> <span class="o">!=</span> <span class="nb">NULL</span> <span class="o">&amp;&amp;</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: Deleting timer for /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
			<span class="n">del_timer</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">timer</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_LINEJACK</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">daafsyncen</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>	<span class="cm">/* Turn off DAA Frame Sync */</span>

				<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_scrw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">);</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">bits</span><span class="p">.</span><span class="n">rly3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
				<span class="n">outb_p</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">pld_slicw</span><span class="p">.</span><span class="n">byte</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">+</span> <span class="mh">0x01</span><span class="p">);</span>
				<span class="n">LED_SetState</span><span class="p">(</span><span class="mh">0x0</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: Releasing XILINX address for /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
				<span class="n">release_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
			<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK_LITE</span> <span class="o">||</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">==</span> <span class="n">QTI_PHONEJACK_PCI</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: Releasing XILINX address for /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
				<span class="n">release_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span><span class="p">,</span> <span class="mi">4</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">read_buffer</span><span class="p">);</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">write_buffer</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">)</span>
				<span class="n">pnp_device_detach</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">dev</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: Unregistering /dev/phone%d from LTAPI</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
			<span class="n">phone_unregister_device</span><span class="p">(</span><span class="o">&amp;</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">p</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: Releasing DSP address for /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
			<span class="n">release_region</span><span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
<span class="cp">#ifdef IXJ_DYN_ALLOC</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
				<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: Freeing memory for /dev/phone%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">cnt</span><span class="p">);</span>
			<span class="n">kfree</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">ixj</span><span class="p">[</span><span class="n">cnt</span><span class="p">]</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="cp">#endif</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixjdebug</span> <span class="o">&amp;</span> <span class="mh">0x0002</span><span class="p">)</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;IXJ: Removing /proc/ixj</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">remove_proc_entry</span> <span class="p">(</span><span class="s">&quot;ixj&quot;</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Typedefs */</span>
<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">BYTE</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">DWORD</span> <span class="n">bits</span><span class="p">;</span>
<span class="p">}</span> <span class="n">DATABLOCK</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">PCIEE_WriteBit</span><span class="p">(</span><span class="n">WORD</span> <span class="n">wEEPROMAddress</span><span class="p">,</span> <span class="n">BYTE</span> <span class="n">lastLCC</span><span class="p">,</span> <span class="n">BYTE</span> <span class="n">byData</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">&amp;</span> <span class="mh">0xfb</span><span class="p">;</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">|</span> <span class="p">(</span><span class="n">byData</span> <span class="o">?</span> <span class="mi">4</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">lastLCC</span><span class="p">,</span> <span class="n">wEEPROMAddress</span><span class="p">);</span>	<span class="cm">/*set data out bit as appropriate */</span>

	<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">|</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">lastLCC</span><span class="p">,</span> <span class="n">wEEPROMAddress</span><span class="p">);</span>	<span class="cm">/*SK rising edge */</span>

	<span class="n">byData</span> <span class="o">=</span> <span class="n">byData</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">;</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">&amp;</span> <span class="mh">0xfe</span><span class="p">;</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">lastLCC</span><span class="p">,</span> <span class="n">wEEPROMAddress</span><span class="p">);</span>	<span class="cm">/*after delay, SK falling edge */</span>

<span class="p">}</span>

<span class="k">static</span> <span class="n">BYTE</span> <span class="nf">PCIEE_ReadBit</span><span class="p">(</span><span class="n">WORD</span> <span class="n">wEEPROMAddress</span><span class="p">,</span> <span class="n">BYTE</span> <span class="n">lastLCC</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">|</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">lastLCC</span><span class="p">,</span> <span class="n">wEEPROMAddress</span><span class="p">);</span>	<span class="cm">/*SK rising edge */</span>

	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">&amp;</span> <span class="mh">0xfe</span><span class="p">;</span>
	<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">lastLCC</span><span class="p">,</span> <span class="n">wEEPROMAddress</span><span class="p">);</span>	<span class="cm">/*after delay, SK falling edge */</span>

	<span class="k">return</span> <span class="p">((</span><span class="n">inb</span><span class="p">(</span><span class="n">wEEPROMAddress</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">bool</span> <span class="nf">PCIEE_ReadWord</span><span class="p">(</span><span class="n">WORD</span> <span class="n">wAddress</span><span class="p">,</span> <span class="n">WORD</span> <span class="n">wLoc</span><span class="p">,</span> <span class="n">WORD</span> <span class="o">*</span> <span class="n">pwResult</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">BYTE</span> <span class="n">lastLCC</span><span class="p">;</span>
	<span class="n">WORD</span> <span class="n">wEEPROMAddress</span> <span class="o">=</span> <span class="n">wAddress</span> <span class="o">+</span> <span class="mi">3</span><span class="p">;</span>
	<span class="n">DWORD</span> <span class="n">i</span><span class="p">;</span>
	<span class="n">BYTE</span> <span class="n">byResult</span><span class="p">;</span>
	<span class="o">*</span><span class="n">pwResult</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">inb</span><span class="p">(</span><span class="n">wEEPROMAddress</span><span class="p">);</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">|</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">&amp;</span> <span class="mh">0xfe</span><span class="p">;</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">lastLCC</span><span class="p">,</span> <span class="n">wEEPROMAddress</span><span class="p">);</span>	<span class="cm">/* CS hi, SK lo */</span>

	<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>		<span class="cm">/* delay */</span>

	<span class="n">PCIEE_WriteBit</span><span class="p">(</span><span class="n">wEEPROMAddress</span><span class="p">,</span> <span class="n">lastLCC</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">PCIEE_WriteBit</span><span class="p">(</span><span class="n">wEEPROMAddress</span><span class="p">,</span> <span class="n">lastLCC</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
	<span class="n">PCIEE_WriteBit</span><span class="p">(</span><span class="n">wEEPROMAddress</span><span class="p">,</span> <span class="n">lastLCC</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">PCIEE_WriteBit</span><span class="p">(</span><span class="n">wEEPROMAddress</span><span class="p">,</span> <span class="n">lastLCC</span><span class="p">,</span> <span class="n">wLoc</span> <span class="o">&amp;</span> <span class="mh">0x80</span> <span class="o">?</span> <span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">);</span>
		<span class="n">wLoc</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">byResult</span> <span class="o">=</span> <span class="n">PCIEE_ReadBit</span><span class="p">(</span><span class="n">wEEPROMAddress</span><span class="p">,</span> <span class="n">lastLCC</span><span class="p">);</span>
		<span class="o">*</span><span class="n">pwResult</span> <span class="o">=</span> <span class="p">(</span><span class="o">*</span><span class="n">pwResult</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">byResult</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">mdelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>		<span class="cm">/* another delay */</span>

	<span class="n">lastLCC</span> <span class="o">=</span> <span class="n">lastLCC</span> <span class="o">&amp;</span> <span class="mh">0xfd</span><span class="p">;</span>
	<span class="n">outb</span><span class="p">(</span><span class="n">lastLCC</span><span class="p">,</span> <span class="n">wEEPROMAddress</span><span class="p">);</span>	<span class="cm">/* negate CS */</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">DWORD</span> <span class="nf">PCIEE_GetSerialNumber</span><span class="p">(</span><span class="n">WORD</span> <span class="n">wAddress</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">WORD</span> <span class="n">wLo</span><span class="p">,</span> <span class="n">wHi</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">PCIEE_ReadWord</span><span class="p">(</span><span class="n">wAddress</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wLo</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">PCIEE_ReadWord</span><span class="p">(</span><span class="n">wAddress</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wHi</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">return</span> <span class="p">(((</span><span class="n">DWORD</span><span class="p">)</span> <span class="n">wHi</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="n">wLo</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">dspio</span><span class="p">[</span><span class="n">IXJMAX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span>
<span class="p">{</span>
	<span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">xio</span><span class="p">[</span><span class="n">IXJMAX</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span>
<span class="p">{</span>
	<span class="mi">0</span><span class="p">,</span>
<span class="p">};</span>

<span class="n">module_param_array</span><span class="p">(</span><span class="n">dspio</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">module_param_array</span><span class="p">(</span><span class="n">xio</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="n">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&quot;Quicknet VoIP Telephony card module - www.quicknet.net&quot;</span><span class="p">);</span>
<span class="n">MODULE_AUTHOR</span><span class="p">(</span><span class="s">&quot;Ed Okerson &lt;eokerson@quicknet.net&gt;&quot;</span><span class="p">);</span>
<span class="n">MODULE_LICENSE</span><span class="p">(</span><span class="s">&quot;GPL&quot;</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">ixj_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">cleanup</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">IXJ</span> <span class="o">*</span><span class="nf">new_ixj</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">port</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">res</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">request_region</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s">&quot;ixj DSP&quot;</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: can&#39;t get I/O address 0x%lx</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">port</span><span class="p">);</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">ixj_alloc</span><span class="p">();</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">release_region</span><span class="p">(</span><span class="n">port</span><span class="p">,</span> <span class="mi">16</span><span class="p">);</span>
		<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: out of memory</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">res</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">=</span> <span class="n">port</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">res</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">ixj_probe_isapnp</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">cnt</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">probe</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">func</span> <span class="o">=</span> <span class="mh">0x110</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">pnp_dev</span> <span class="o">*</span><span class="n">dev</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">*</span><span class="n">old_dev</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">do</span> <span class="p">{</span>
			<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">result</span><span class="p">;</span>

			<span class="n">old_dev</span> <span class="o">=</span> <span class="n">dev</span><span class="p">;</span>
			<span class="n">dev</span> <span class="o">=</span> <span class="n">pnp_find_dev</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="n">ISAPNP_VENDOR</span><span class="p">(</span><span class="sc">&#39;Q&#39;</span><span class="p">,</span> <span class="sc">&#39;T&#39;</span><span class="p">,</span> <span class="sc">&#39;I&#39;</span><span class="p">),</span>
					 <span class="n">ISAPNP_FUNCTION</span><span class="p">(</span><span class="n">func</span><span class="p">),</span> <span class="n">old_dev</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">dev</span> <span class="o">||</span> <span class="o">!</span><span class="n">dev</span><span class="o">-&gt;</span><span class="n">card</span><span class="p">)</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">pnp_device_attach</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;pnp attach failed %d </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">pnp_activate_dev</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">printk</span><span class="p">(</span><span class="s">&quot;pnp activate failed (out of resources?)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
				<span class="n">pnp_device_detach</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
				<span class="k">return</span> <span class="o">-</span><span class="n">ENOMEM</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pnp_port_valid</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="p">{</span>
				<span class="n">pnp_device_detach</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
				<span class="k">return</span> <span class="o">-</span><span class="n">ENODEV</span><span class="p">;</span>
			<span class="p">}</span>

			<span class="n">j</span> <span class="o">=</span> <span class="n">new_ixj</span><span class="p">(</span><span class="n">pnp_port_start</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="p">)</span>
				<span class="k">break</span><span class="p">;</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">func</span> <span class="o">!=</span> <span class="mh">0x110</span><span class="p">)</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">=</span> <span class="n">pnp_port_start</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>	<span class="cm">/* get real port */</span>

			<span class="k">switch</span> <span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">case</span> <span class="p">(</span><span class="mh">0x110</span><span class="p">)</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_PHONEJACK</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="p">(</span><span class="mh">0x310</span><span class="p">)</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_LINEJACK</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="k">case</span> <span class="p">(</span><span class="mh">0x410</span><span class="p">)</span>:
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_PHONEJACK_LITE</span><span class="p">;</span>
				<span class="k">break</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span> <span class="o">=</span> <span class="o">*</span><span class="n">cnt</span><span class="p">;</span>
			<span class="n">probe</span> <span class="o">=</span> <span class="n">ixj_selfprobe</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">probe</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">serial</span> <span class="o">=</span> <span class="n">dev</span><span class="o">-&gt;</span><span class="n">card</span><span class="o">-&gt;</span><span class="n">serial</span><span class="p">;</span>
				<span class="n">j</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="n">dev</span><span class="p">;</span>
				<span class="k">switch</span> <span class="p">(</span><span class="n">func</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">case</span> <span class="mh">0x110</span>:
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: found Internet PhoneJACK at 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mh">0x310</span>:
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: found Internet LineJACK at 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="k">case</span> <span class="mh">0x410</span>:
					<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: found Internet PhoneJACK Lite at 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">);</span>
					<span class="k">break</span><span class="p">;</span>
				<span class="p">}</span>
			<span class="p">}</span>
			<span class="o">++*</span><span class="n">cnt</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">dev</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">func</span> <span class="o">==</span> <span class="mh">0x410</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">func</span> <span class="o">==</span> <span class="mh">0x310</span><span class="p">)</span>
			<span class="n">func</span> <span class="o">=</span> <span class="mh">0x410</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">func</span> <span class="o">==</span> <span class="mh">0x110</span><span class="p">)</span>
			<span class="n">func</span> <span class="o">=</span> <span class="mh">0x310</span><span class="p">;</span>
		<span class="n">dev</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">probe</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">ixj_probe_isa</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">cnt</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">probe</span><span class="p">;</span>

	<span class="cm">/* Use passed parameters for older kernels without PnP */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">IXJMAX</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">dspio</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
			<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="n">new_ixj</span><span class="p">(</span><span class="n">dspio</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>

			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="p">)</span>
				<span class="k">break</span><span class="p">;</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">=</span> <span class="n">xio</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

			<span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span> <span class="o">=</span> <span class="o">*</span><span class="n">cnt</span><span class="p">;</span>
			<span class="n">probe</span> <span class="o">=</span> <span class="n">ixj_selfprobe</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
			<span class="n">j</span><span class="o">-&gt;</span><span class="n">dev</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
			<span class="o">++*</span><span class="n">cnt</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">ixj_probe_pci</span><span class="p">(</span><span class="kt">int</span> <span class="o">*</span><span class="n">cnt</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pci</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">probe</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">IXJMAX</span> <span class="o">-</span> <span class="o">*</span><span class="n">cnt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pci</span> <span class="o">=</span> <span class="n">pci_get_device</span><span class="p">(</span><span class="n">PCI_VENDOR_ID_QUICKNET</span><span class="p">,</span>
				      <span class="n">PCI_DEVICE_ID_QUICKNET_XJ</span><span class="p">,</span> <span class="n">pci</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">pci</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">pci_enable_device</span><span class="p">(</span><span class="n">pci</span><span class="p">))</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="n">j</span> <span class="o">=</span> <span class="n">new_ixj</span><span class="p">(</span><span class="n">pci_resource_start</span><span class="p">(</span><span class="n">pci</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">j</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>

		<span class="n">j</span><span class="o">-&gt;</span><span class="n">serial</span> <span class="o">=</span> <span class="p">(</span><span class="n">PCIEE_GetSerialNumber</span><span class="p">)</span><span class="n">pci_resource_start</span><span class="p">(</span><span class="n">pci</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">XILINXbase</span> <span class="o">=</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span> <span class="o">+</span> <span class="mh">0x10</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">cardtype</span> <span class="o">=</span> <span class="n">QTI_PHONEJACK_PCI</span><span class="p">;</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">board</span> <span class="o">=</span> <span class="o">*</span><span class="n">cnt</span><span class="p">;</span>
		<span class="n">probe</span> <span class="o">=</span> <span class="n">ixj_selfprobe</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">probe</span><span class="p">)</span>
			<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj: found Internet PhoneJACK PCI at 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">j</span><span class="o">-&gt;</span><span class="n">DSPbase</span><span class="p">);</span>
		<span class="o">++*</span><span class="n">cnt</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">pci_dev_put</span><span class="p">(</span><span class="n">pci</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">probe</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">ixj_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">probe</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="cm">/* These might be no-ops, see above. */</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">probe</span> <span class="o">=</span> <span class="n">ixj_probe_isapnp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cnt</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">probe</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">probe</span> <span class="o">=</span> <span class="n">ixj_probe_isa</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cnt</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">probe</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">probe</span> <span class="o">=</span> <span class="n">ixj_probe_pci</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cnt</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="n">probe</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">printk</span><span class="p">(</span><span class="n">KERN_INFO</span> <span class="s">&quot;ixj driver initialized.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="n">create_proc_read_entry</span> <span class="p">(</span><span class="s">&quot;ixj&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">ixj_read_proc</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">probe</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">module_init</span><span class="p">(</span><span class="n">ixj_init</span><span class="p">);</span>
<span class="n">module_exit</span><span class="p">(</span><span class="n">ixj_exit</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">DAA_Coeff_US</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_country</span> <span class="o">=</span> <span class="n">DAA_US</span><span class="p">;</span>
	<span class="cm">/*----------------------------------------------- */</span>
	<span class="cm">/* CAO */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

<span class="cm">/* Bytes for IM-filter part 1 (04): 0E,32,E2,2F,C2,5A,C0,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x03</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5D</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x24</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Bytes for IM-filter part 2 (05): 72,85,00,0E,2B,3A,D0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x71</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x33</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRX-filter       (08): 03,8F,48,F2,8F,48,70,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x72</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x34</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x30</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRR-filter       (07): 04,8F,38,7F,9B,EA,B0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x87</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF9</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for AX-filter        (0A): 16,55,DD,CA */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x41</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
<span class="cm">/* Bytes for AR-filter        (09): 52,D3,11,42 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x25</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC7</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD6</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 1 (00): 00,42,48,81,B3,80,00,98 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x42</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x48</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x98</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 2 (01): 02,F2,33,A0,68,AB,8A,AD */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE8</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAB</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCC</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 3 (02): 00,88,DA,54,A4,BA,2D,BB */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x24</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA9</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
<span class="cm">/* ;  (10K, 0.68uF) */</span>
	<span class="cm">/*  */</span>
	<span class="cm">/* Bytes for Ringing part 1 (03):1B,3B,9B,BA,D4,1C,B3,23 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x93</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
	<span class="cm">/* Bytes for Ringing part 2 (06):13,42,A6,BA,D4,73,CA,D5 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x7A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD5</span><span class="p">;</span>

	<span class="cm">/* Levelmetering Ringing        (0D):B2,45,0F,8E       */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x35</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8E</span><span class="p">;</span>

	<span class="cm">/* Bytes for Ringing part 1 (03):1B,3B,9B,BA,D4,1C,B3,23 */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[7] = 0x1C; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[6] = 0xB3; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[5] = 0xAB; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[4] = 0xAB; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[3] = 0x54; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[2] = 0x2D; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[1] = 0x62; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_1[0] = 0x2D; */</span>
	<span class="cm">/* Bytes for Ringing part 2 (06):13,42,A6,BA,D4,73,CA,D5 */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[7] = 0x2D; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[6] = 0x62; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[5] = 0xA6; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[4] = 0xBB; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[3] = 0x2A; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[2] = 0x7D; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[1] = 0x0A; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.RingerImpendance_2[0] = 0xD4; */</span>
<span class="cm">/* */</span>
	<span class="cm">/* Levelmetering Ringing        (0D):B2,45,0F,8E       */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.LevelmeteringRinging[3] = 0xAA; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.LevelmeteringRinging[2] = 0x05; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.LevelmeteringRinging[1] = 0x0F; */</span>
<span class="cm">/*	j-&gt;m_DAAShadowRegs.COP_REGS.COP.LevelmeteringRinging[0] = 0x8E; */</span>

	<span class="cm">/* Caller ID 1st Tone           (0E):CA,0E,CA,09,99,99,99,99 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
<span class="cm">/* Caller ID 2nd Tone           (0F):FD,B5,BA,07,DA,00,00,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/*  */</span>
	<span class="cm">/* ;CR Registers */</span>
	<span class="cm">/* Config. Reg. 0 (filters)       (cr0):FE ; CLK gen. by crystal */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 1 (dialing)       (cr1):05 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 2 (caller ID)     (cr2):04 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 3 (testloops)     (cr3):03 ; SEL Bit==0, HP-disabled */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 4 (analog gain)   (cr4):02 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="cm">/* Config. Reg. 5 (Version)       (cr5):02 */</span>
	<span class="cm">/* Config. Reg. 6 (Reserved)      (cr6):00 */</span>
	<span class="cm">/* Config. Reg. 7 (Reserved)      (cr7):00 */</span>
	<span class="cm">/*  */</span>
	<span class="cm">/* ;xr Registers */</span>
	<span class="cm">/* Ext. Reg. 0 (Interrupt Reg.)   (xr0):02 */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr0_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>	<span class="cm">/* SO_1 set to &#39;1&#39; because it is inverted. */</span>
	<span class="cm">/* Ext. Reg. 1 (Interrupt enable) (xr1):3C Cadence, RING, Caller ID, VDD_OK */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x3C</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 2 (Cadence Time Out) (xr2):7D */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x7D</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 3 (DC Char)          (xr3):32 ; B-Filter Off == 1 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x3B</span><span class="p">;</span>		<span class="cm">/*0x32; */</span>
	<span class="cm">/* Ext. Reg. 4 (Cadence)          (xr4):00 */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 5 (Ring timer)       (xr5):22 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 6 (Power State)      (xr6):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr6_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 7 (Vdd)              (xr7):40 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr7</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">;</span>		<span class="cm">/* 0x40 ??? Should it be 0x00? */</span>
	<span class="cm">/*  */</span>
	<span class="cm">/* DTMF Tone 1                     (0B): 11,B3,5A,2C ;   697 Hz   */</span>
	<span class="cm">/*                                       12,33,5A,C3 ;  770 Hz   */</span>
	<span class="cm">/*                                       13,3C,5B,32 ;  852 Hz   */</span>
	<span class="cm">/*                                       1D,1B,5C,CC ;  941 Hz   */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
<span class="cm">/* DTMF Tone 2                     (0C): 32,32,52,B3 ;  1209 Hz   */</span>
	<span class="cm">/*                                       EC,1D,52,22 ;  1336 Hz   */</span>
	<span class="cm">/*                                       AA,AC,51,D2 ;  1477 Hz   */</span>
	<span class="cm">/*                                       9B,3B,51,25 ;  1633 Hz   */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">DAA_Coeff_UK</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_country</span> <span class="o">=</span> <span class="n">DAA_UK</span><span class="p">;</span>
	<span class="cm">/*----------------------------------------------- */</span>
	<span class="cm">/* CAO */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

<span class="cm">/*  Bytes for IM-filter part 1 (04): 00,C2,BB,A8,CB,81,A0,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBB</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA8</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCB</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Bytes for IM-filter part 2 (05): 40,00,00,0A,A4,33,E0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA4</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x33</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRX-filter       (08): 07,9B,ED,24,B2,A2,A0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xED</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x24</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRR-filter       (07): 0F,92,F2,B2,87,D2,30,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x92</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x87</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x30</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for AX-filter        (0A): 1B,A5,DD,CA */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
<span class="cm">/* Bytes for AR-filter        (09): E2,27,10,D6 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x27</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD6</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 1 (00): 80,2D,38,8B,D0,00,00,98 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2D</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x38</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x98</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 2 (01): 02,5A,53,F0,0B,5F,84,D4 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x53</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x84</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD4</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 3 (02): 00,88,6A,A4,8F,52,F5,32 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA4</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
<span class="cm">/* ; idle */</span>
	<span class="cm">/* Bytes for Ringing part 1 (03):1B,3C,93,3A,22,12,A3,23 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x93</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
<span class="cm">/* Bytes for Ringing part 2 (06):12,A2,A6,BA,22,7A,0A,D5 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x7A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD5</span><span class="p">;</span>
<span class="cm">/* Levelmetering Ringing           (0D):AA,35,0F,8E     ; 25Hz 30V less possible? */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x35</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8E</span><span class="p">;</span>
<span class="cm">/* Caller ID 1st Tone              (0E):CA,0E,CA,09,99,99,99,99 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
<span class="cm">/* Caller ID 2nd Tone              (0F):FD,B5,BA,07,DA,00,00,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* ;CR Registers */</span>
	<span class="cm">/* Config. Reg. 0 (filters)        (cr0):FF */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 1 (dialing)        (cr1):05 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 2 (caller ID)      (cr2):04 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 3 (testloops)      (cr3):00        ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 4 (analog gain)    (cr4):02 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="cm">/* Config. Reg. 5 (Version)        (cr5):02 */</span>
	<span class="cm">/* Config. Reg. 6 (Reserved)       (cr6):00 */</span>
	<span class="cm">/* Config. Reg. 7 (Reserved)       (cr7):00 */</span>
	<span class="cm">/* ;xr Registers */</span>
	<span class="cm">/* Ext. Reg. 0 (Interrupt Reg.)    (xr0):02 */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr0_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>	<span class="cm">/* SO_1 set to &#39;1&#39; because it is inverted. */</span>
	<span class="cm">/* Ext. Reg. 1 (Interrupt enable)  (xr1):1C */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x1C</span><span class="p">;</span>		<span class="cm">/* RING, Caller ID, VDD_OK */</span>
	<span class="cm">/* Ext. Reg. 2 (Cadence Time Out)  (xr2):7D */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x7D</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 3 (DC Char)           (xr3):36        ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x36</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 4 (Cadence)           (xr4):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 5 (Ring timer)        (xr5):22 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 6 (Power State)       (xr6):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr6_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 7 (Vdd)               (xr7):46 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr7</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x46</span><span class="p">;</span>		<span class="cm">/* 0x46 ??? Should it be 0x00? */</span>
	<span class="cm">/* DTMF Tone 1                     (0B): 11,B3,5A,2C    ;   697 Hz   */</span>
	<span class="cm">/*                                       12,33,5A,C3    ;  770 Hz   */</span>
	<span class="cm">/*                                       13,3C,5B,32    ;  852 Hz   */</span>
	<span class="cm">/*                                       1D,1B,5C,CC    ;  941 Hz   */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
<span class="cm">/* DTMF Tone 2                     (0C): 32,32,52,B3    ;  1209 Hz   */</span>
	<span class="cm">/*                                       EC,1D,52,22    ;  1336 Hz   */</span>
	<span class="cm">/*                                       AA,AC,51,D2    ;  1477 Hz   */</span>
	<span class="cm">/*                                       9B,3B,51,25    ;  1633 Hz   */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kt">void</span> <span class="nf">DAA_Coeff_France</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_country</span> <span class="o">=</span> <span class="n">DAA_FRANCE</span><span class="p">;</span>
	<span class="cm">/*----------------------------------------------- */</span>
	<span class="cm">/* CAO */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

<span class="cm">/* Bytes for IM-filter part 1 (04): 02,A2,43,2C,22,AF,A0,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x43</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAF</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Bytes for IM-filter part 2 (05): 67,CE,00,0C,22,33,E0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x67</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCE</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x33</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRX-filter       (08): 07,9A,28,F6,23,4A,B0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x28</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRR-filter       (07): 03,8F,F9,2F,9E,FA,20,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x03</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF9</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for AX-filter        (0A): 16,B5,DD,CA */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x16</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
<span class="cm">/* Bytes for AR-filter        (09): 52,C7,10,D6 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC7</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD6</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 1 (00): 00,42,48,81,A6,80,00,98 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x42</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x48</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x98</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 2 (01): 02,AC,2A,30,78,AC,8A,2C */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAC</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x30</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x78</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAC</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 3 (02): 00,88,DA,A5,22,BA,2C,45 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x45</span><span class="p">;</span>
<span class="cm">/* ; idle */</span>
	<span class="cm">/* Bytes for Ringing part 1 (03):1B,3C,93,3A,22,12,A3,23 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x93</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
<span class="cm">/* Bytes for Ringing part 2 (06):12,A2,A6,BA,22,7A,0A,D5 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x7A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD5</span><span class="p">;</span>
<span class="cm">/* Levelmetering Ringing           (0D):32,45,B5,84     ; 50Hz 20V */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x45</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x84</span><span class="p">;</span>
<span class="cm">/* Caller ID 1st Tone              (0E):CA,0E,CA,09,99,99,99,99 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
<span class="cm">/* Caller ID 2nd Tone              (0F):FD,B5,BA,07,DA,00,00,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* ;CR Registers */</span>
	<span class="cm">/* Config. Reg. 0 (filters)        (cr0):FF */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 1 (dialing)        (cr1):05 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 2 (caller ID)      (cr2):04 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 3 (testloops)      (cr3):00        ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 4 (analog gain)    (cr4):02 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="cm">/* Config. Reg. 5 (Version)        (cr5):02 */</span>
	<span class="cm">/* Config. Reg. 6 (Reserved)       (cr6):00 */</span>
	<span class="cm">/* Config. Reg. 7 (Reserved)       (cr7):00 */</span>
	<span class="cm">/* ;xr Registers */</span>
	<span class="cm">/* Ext. Reg. 0 (Interrupt Reg.)    (xr0):02 */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr0_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>	<span class="cm">/* SO_1 set to &#39;1&#39; because it is inverted. */</span>
	<span class="cm">/* Ext. Reg. 1 (Interrupt enable)  (xr1):1C */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x1C</span><span class="p">;</span>		<span class="cm">/* RING, Caller ID, VDD_OK */</span>
	<span class="cm">/* Ext. Reg. 2 (Cadence Time Out)  (xr2):7D */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x7D</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 3 (DC Char)           (xr3):36        ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x36</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 4 (Cadence)           (xr4):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 5 (Ring timer)        (xr5):22 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 6 (Power State)       (xr6):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr6_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 7 (Vdd)               (xr7):46 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr7</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x46</span><span class="p">;</span>		<span class="cm">/* 0x46 ??? Should it be 0x00? */</span>
	<span class="cm">/* DTMF Tone 1                     (0B): 11,B3,5A,2C    ;   697 Hz   */</span>
	<span class="cm">/*                                       12,33,5A,C3    ;  770 Hz   */</span>
	<span class="cm">/*                                       13,3C,5B,32    ;  852 Hz   */</span>
	<span class="cm">/*                                       1D,1B,5C,CC    ;  941 Hz   */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
<span class="cm">/* DTMF Tone 2                     (0C): 32,32,52,B3    ;  1209 Hz   */</span>
	<span class="cm">/*                                       EC,1D,52,22    ;  1336 Hz   */</span>
	<span class="cm">/*                                       AA,AC,51,D2    ;  1477 Hz   */</span>
	<span class="cm">/*                                       9B,3B,51,25    ;  1633 Hz   */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kt">void</span> <span class="nf">DAA_Coeff_Germany</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_country</span> <span class="o">=</span> <span class="n">DAA_GERMANY</span><span class="p">;</span>
	<span class="cm">/*----------------------------------------------- */</span>
	<span class="cm">/* CAO */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

<span class="cm">/* Bytes for IM-filter part 1 (04): 00,CE,BB,B8,D2,81,B0,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCE</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBB</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB8</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Bytes for IM-filter part 2 (05): 45,8F,00,0C,D2,3A,D0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x45</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRX-filter       (08): 07,AA,E2,34,24,89,20,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x34</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x24</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x89</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRR-filter       (07): 02,87,FA,37,9A,CA,B0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x87</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x37</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for AX-filter        (0A): 72,D5,DD,CA */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x72</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
<span class="cm">/* Bytes for AR-filter        (09): 72,42,13,4B */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x72</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x42</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x13</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4B</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 1 (00): 80,52,48,81,AD,80,00,98 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x48</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x98</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 2 (01): 02,42,5A,20,E8,1A,81,27 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x42</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE8</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x27</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 3 (02): 00,88,63,26,BD,4B,A3,C2 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x63</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x26</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC2</span><span class="p">;</span>
<span class="cm">/* ;  (10K, 0.68uF) */</span>
	<span class="cm">/* Bytes for Ringing part 1 (03):1B,3B,9B,BA,D4,1C,B3,23 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD4</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
<span class="cm">/* Bytes for Ringing part 2 (06):13,42,A6,BA,D4,73,CA,D5 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x13</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x42</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD4</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x73</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD5</span><span class="p">;</span>
<span class="cm">/* Levelmetering Ringing        (0D):B2,45,0F,8E       */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x45</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8E</span><span class="p">;</span>
<span class="cm">/* Caller ID 1st Tone           (0E):CA,0E,CA,09,99,99,99,99 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
<span class="cm">/* Caller ID 2nd Tone           (0F):FD,B5,BA,07,DA,00,00,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* ;CR Registers */</span>
	<span class="cm">/* Config. Reg. 0 (filters)        (cr0):FF ; all Filters enabled, CLK from ext. source */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 1 (dialing)        (cr1):05 ; Manual Ring, Ring metering enabled */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 2 (caller ID)      (cr2):04 ; Analog Gain 0dB, FSC internal */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 3 (testloops)      (cr3):00 ; SEL Bit==0, HP-enabled */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 4 (analog gain)    (cr4):02 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="cm">/* Config. Reg. 5 (Version)        (cr5):02 */</span>
	<span class="cm">/* Config. Reg. 6 (Reserved)       (cr6):00 */</span>
	<span class="cm">/* Config. Reg. 7 (Reserved)       (cr7):00 */</span>
	<span class="cm">/* ;xr Registers */</span>
	<span class="cm">/* Ext. Reg. 0 (Interrupt Reg.)    (xr0):02 */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr0_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>	<span class="cm">/* SO_1 set to &#39;1&#39; because it is inverted. */</span>
	<span class="cm">/* Ext. Reg. 1 (Interrupt enable)  (xr1):1C ; Ring, CID, VDDOK Interrupts enabled */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x1C</span><span class="p">;</span>		<span class="cm">/* RING, Caller ID, VDD_OK */</span>
	<span class="cm">/* Ext. Reg. 2 (Cadence Time Out)  (xr2):7D */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x7D</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 3 (DC Char)           (xr3):32 ; B-Filter Off==1, U0=3.5V, R=200Ohm */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 4 (Cadence)           (xr4):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 5 (Ring timer)        (xr5):22 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 6 (Power State)       (xr6):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr6_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 7 (Vdd)               (xr7):40 ; VDD=4.25 V */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr7</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">;</span>		<span class="cm">/* 0x40 ??? Should it be 0x00? */</span>
	<span class="cm">/* DTMF Tone 1                     (0B): 11,B3,5A,2C    ;   697 Hz   */</span>
	<span class="cm">/*                                       12,33,5A,C3    ;  770 Hz   */</span>
	<span class="cm">/*                                       13,3C,5B,32    ;  852 Hz   */</span>
	<span class="cm">/*                                       1D,1B,5C,CC    ;  941 Hz   */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
<span class="cm">/* DTMF Tone 2                     (0C): 32,32,52,B3    ;  1209 Hz   */</span>
	<span class="cm">/*                                       EC,1D,52,22    ;  1336 Hz   */</span>
	<span class="cm">/*                                       AA,AC,51,D2    ;  1477 Hz   */</span>
	<span class="cm">/*                                       9B,3B,51,25    ;  1633 Hz   */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">static</span> <span class="kt">void</span> <span class="nf">DAA_Coeff_Australia</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_country</span> <span class="o">=</span> <span class="n">DAA_AUSTRALIA</span><span class="p">;</span>
	<span class="cm">/*----------------------------------------------- */</span>
	<span class="cm">/* CAO */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

<span class="cm">/* Bytes for IM-filter part 1 (04): 00,A3,AA,28,B3,82,D0,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x28</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x82</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Bytes for IM-filter part 2 (05): 70,96,00,09,32,6B,C0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x70</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x96</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRX-filter       (08): 07,96,E2,34,32,9B,30,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x96</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x34</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x30</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRR-filter       (07): 0F,9A,E9,2F,22,CC,A0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE9</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCC</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for AX-filter        (0A): CB,45,DD,CA */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCB</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x45</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
<span class="cm">/* Bytes for AR-filter        (09): 1B,67,10,D6 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x67</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD6</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 1 (00): 80,52,48,81,AF,80,00,98 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x48</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAF</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x98</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 2 (01): 02,DB,52,B0,38,01,82,AC */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDB</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x38</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x82</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAC</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 3 (02): 00,88,4A,3E,2C,3B,24,46 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x24</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x46</span><span class="p">;</span>
<span class="cm">/* ;  idle */</span>
	<span class="cm">/* Bytes for Ringing part 1 (03):1B,3C,93,3A,22,12,A3,23 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x93</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
<span class="cm">/* Bytes for Ringing part 2 (06):12,A2,A6,BA,22,7A,0A,D5 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x7A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD5</span><span class="p">;</span>
<span class="cm">/* Levelmetering Ringing           (0D):32,45,B5,84   ; 50Hz 20V */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x45</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x84</span><span class="p">;</span>
<span class="cm">/* Caller ID 1st Tone              (0E):CA,0E,CA,09,99,99,99,99 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
<span class="cm">/* Caller ID 2nd Tone              (0F):FD,B5,BA,07,DA,00,00,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* ;CR Registers */</span>
	<span class="cm">/* Config. Reg. 0 (filters)        (cr0):FF */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 1 (dialing)        (cr1):05 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 2 (caller ID)      (cr2):04 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 3 (testloops)      (cr3):00        ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 4 (analog gain)    (cr4):02 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="cm">/* Config. Reg. 5 (Version)        (cr5):02 */</span>
	<span class="cm">/* Config. Reg. 6 (Reserved)       (cr6):00 */</span>
	<span class="cm">/* Config. Reg. 7 (Reserved)       (cr7):00 */</span>
	<span class="cm">/* ;xr Registers */</span>
	<span class="cm">/* Ext. Reg. 0 (Interrupt Reg.)    (xr0):02 */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr0_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>	<span class="cm">/* SO_1 set to &#39;1&#39; because it is inverted. */</span>
	<span class="cm">/* Ext. Reg. 1 (Interrupt enable)  (xr1):1C */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x1C</span><span class="p">;</span>		<span class="cm">/* RING, Caller ID, VDD_OK */</span>
	<span class="cm">/* Ext. Reg. 2 (Cadence Time Out)  (xr2):7D */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x7D</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 3 (DC Char)           (xr3):2B      ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x2B</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 4 (Cadence)           (xr4):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 5 (Ring timer)        (xr5):22 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 6 (Power State)       (xr6):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr6_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 7 (Vdd)               (xr7):40 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr7</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">;</span>		<span class="cm">/* 0x40 ??? Should it be 0x00? */</span>

	<span class="cm">/* DTMF Tone 1                     (0B): 11,B3,5A,2C    ;  697 Hz   */</span>
	<span class="cm">/*                                       12,33,5A,C3    ;  770 Hz   */</span>
	<span class="cm">/*                                       13,3C,5B,32    ;  852 Hz   */</span>
	<span class="cm">/*                                       1D,1B,5C,CC    ;  941 Hz   */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>

	<span class="cm">/* DTMF Tone 2                     (0C): 32,32,52,B3    ;  1209 Hz   */</span>
	<span class="cm">/*                                       EC,1D,52,22    ;  1336 Hz   */</span>
	<span class="cm">/*                                       AA,AC,51,D2    ;  1477 Hz   */</span>
	<span class="cm">/*                                       9B,3B,51,25    ;  1633 Hz   */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">DAA_Coeff_Japan</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">daa_country</span> <span class="o">=</span> <span class="n">DAA_JAPAN</span><span class="p">;</span>
	<span class="cm">/*----------------------------------------------- */</span>
	<span class="cm">/* CAO */</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ALISDAA_CALLERID_SIZE</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">CAO_REGS</span><span class="p">.</span><span class="n">CAO</span><span class="p">.</span><span class="n">CallerID</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

<span class="cm">/* Bytes for IM-filter part 1 (04): 06,BD,E2,2D,BA,F9,A0,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x06</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2D</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF9</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Bytes for IM-filter part 2 (05): 6F,F7,00,0E,34,33,E0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x6F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF7</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x34</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x33</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xE0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">IMFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRX-filter       (08): 02,8F,68,77,9C,58,F0,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x68</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x77</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x9C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x58</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xF0</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for FRR-filter       (07): 03,8F,38,73,87,EA,20,08 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x03</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x38</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x73</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x87</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xEA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">FRRFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">;</span>
<span class="cm">/* Bytes for AX-filter        (0A): 51,C5,DD,CA */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x51</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">AXFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
<span class="cm">/* Bytes for AR-filter        (09): 25,A7,10,D6 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x25</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA7</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">ARFilterCoeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD6</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 1 (00): 00,42,48,81,AE,80,00,98 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x42</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x48</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x81</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAE</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x80</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x98</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 2 (01): 02,AB,2A,20,99,5B,89,28 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAB</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x89</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x28</span><span class="p">;</span>
<span class="cm">/* Bytes for TH-filter part 3 (02): 00,88,DA,25,34,C5,4C,BA */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x88</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x25</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x34</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xC5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">THFilterCoeff_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
<span class="cm">/* ;  idle */</span>
	<span class="cm">/* Bytes for Ringing part 1 (03):1B,3C,93,3A,22,12,A3,23 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x1B</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3C</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x93</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x3A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x23</span><span class="p">;</span>
<span class="cm">/* Bytes for Ringing part 2 (06):12,A2,A6,BA,22,7A,0A,D5 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA2</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xA6</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x7A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">RingerImpendance_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xD5</span><span class="p">;</span>
<span class="cm">/* Levelmetering Ringing           (0D):AA,35,0F,8E    ; 25Hz 30V ????????? */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xAA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x35</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0F</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">LevelmeteringRinging</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x8E</span><span class="p">;</span>
<span class="cm">/* Caller ID 1st Tone              (0E):CA,0E,CA,09,99,99,99,99 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x0E</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xCA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x09</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID1stTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x99</span><span class="p">;</span>
<span class="cm">/* Caller ID 2nd Tone              (0F):FD,B5,BA,07,DA,00,00,00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xFD</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB5</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xBA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x07</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xDA</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">CallerID2ndTone</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* ;CR Registers */</span>
	<span class="cm">/* Config. Reg. 0 (filters)        (cr0):FF */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr0</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0xFF</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 1 (dialing)        (cr1):05 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x05</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 2 (caller ID)      (cr2):04 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 3 (testloops)      (cr3):00        ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Config. Reg. 4 (analog gain)    (cr4):02 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">SOP_REGS</span><span class="p">.</span><span class="n">SOP</span><span class="p">.</span><span class="n">cr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>
	<span class="cm">/* Config. Reg. 5 (Version)        (cr5):02 */</span>
	<span class="cm">/* Config. Reg. 6 (Reserved)       (cr6):00 */</span>
	<span class="cm">/* Config. Reg. 7 (Reserved)       (cr7):00 */</span>
	<span class="cm">/* ;xr Registers */</span>
	<span class="cm">/* Ext. Reg. 0 (Interrupt Reg.)    (xr0):02 */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr0_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">;</span>	<span class="cm">/* SO_1 set to &#39;1&#39; because it is inverted. */</span>
	<span class="cm">/* Ext. Reg. 1 (Interrupt enable)  (xr1):1C */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr1</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x1C</span><span class="p">;</span>		<span class="cm">/* RING, Caller ID, VDD_OK */</span>
	<span class="cm">/* Ext. Reg. 2 (Cadence Time Out)  (xr2):7D */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr2</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x7D</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 3 (DC Char)           (xr3):22        ;  */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr3</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 4 (Cadence)           (xr4):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr4</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 5 (Ring timer)        (xr5):22 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr5</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x22</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 6 (Power State)       (xr6):00 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_xr6_W</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">;</span>
<span class="cm">/* Ext. Reg. 7 (Vdd)               (xr7):40 */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">XOP_REGS</span><span class="p">.</span><span class="n">XOP</span><span class="p">.</span><span class="n">xr7</span><span class="p">.</span><span class="n">reg</span> <span class="o">=</span> <span class="mh">0x40</span><span class="p">;</span>		<span class="cm">/* 0x40 ??? Should it be 0x00? */</span>
	<span class="cm">/* DTMF Tone 1                     (0B): 11,B3,5A,2C    ;   697 Hz   */</span>
	<span class="cm">/*                                       12,33,5A,C3    ;  770 Hz   */</span>
	<span class="cm">/*                                       13,3C,5B,32    ;  852 Hz   */</span>
	<span class="cm">/*                                       1D,1B,5C,CC    ;  941 Hz   */</span>

	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x11</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x5A</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone1Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x2C</span><span class="p">;</span>
<span class="cm">/* DTMF Tone 2                     (0C): 32,32,52,B3    ;  1209 Hz   */</span>
	<span class="cm">/*                                       EC,1D,52,22    ;  1336 Hz   */</span>
	<span class="cm">/*                                       AA,AC,51,D2    ;  1477 Hz   */</span>
	<span class="cm">/*                                       9B,3B,51,25    ;  1633 Hz   */</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x32</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x52</span><span class="p">;</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">m_DAAShadowRegs</span><span class="p">.</span><span class="n">COP_REGS</span><span class="p">.</span><span class="n">COP</span><span class="p">.</span><span class="n">Tone2Coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xB3</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">s16</span> <span class="n">tone_table</span><span class="p">[][</span><span class="mi">19</span><span class="p">]</span> <span class="o">=</span>
<span class="p">{</span>
	<span class="p">{</span>			<span class="cm">/* f20_50[] 11 */</span>
		<span class="mi">32538</span><span class="p">,</span>		<span class="cm">/* A1 = 1.985962 */</span>
		 <span class="o">-</span><span class="mi">32325</span><span class="p">,</span>	<span class="cm">/* A2 = -0.986511 */</span>
		 <span class="o">-</span><span class="mi">343</span><span class="p">,</span>		<span class="cm">/* B2 = -0.010493 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">343</span><span class="p">,</span>		<span class="cm">/* B0 = 0.010493 */</span>
		 <span class="mi">32619</span><span class="p">,</span>		<span class="cm">/* A1 = 1.990906 */</span>
		 <span class="o">-</span><span class="mi">32520</span><span class="p">,</span>	<span class="cm">/* A2 = -0.992462 */</span>
		 <span class="mi">19179</span><span class="p">,</span>		<span class="cm">/* B2 = 0.585327 */</span>
		 <span class="o">-</span><span class="mi">19178</span><span class="p">,</span>	<span class="cm">/* B1 = -1.170593 */</span>
		 <span class="mi">19179</span><span class="p">,</span>		<span class="cm">/* B0 = 0.585327 */</span>
		 <span class="mi">32723</span><span class="p">,</span>		<span class="cm">/* A1 = 1.997314 */</span>
		 <span class="o">-</span><span class="mi">32686</span><span class="p">,</span>	<span class="cm">/* A2 = -0.997528 */</span>
		 <span class="mi">9973</span><span class="p">,</span>		<span class="cm">/* B2 = 0.304352 */</span>
		 <span class="o">-</span><span class="mi">9955</span><span class="p">,</span>		<span class="cm">/* B1 = -0.607605 */</span>
		 <span class="mi">9973</span><span class="p">,</span>		<span class="cm">/* B0 = 0.304352 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f133_200[] 12 */</span>
		<span class="mi">32072</span><span class="p">,</span>		<span class="cm">/* A1 = 1.95752 */</span>
		 <span class="o">-</span><span class="mi">31896</span><span class="p">,</span>	<span class="cm">/* A2 = -0.973419 */</span>
		 <span class="o">-</span><span class="mi">435</span><span class="p">,</span>		<span class="cm">/* B2 = -0.013294 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">435</span><span class="p">,</span>		<span class="cm">/* B0 = 0.013294 */</span>
		 <span class="mi">32188</span><span class="p">,</span>		<span class="cm">/* A1 = 1.9646 */</span>
		 <span class="o">-</span><span class="mi">32400</span><span class="p">,</span>	<span class="cm">/* A2 = -0.98877 */</span>
		 <span class="mi">15139</span><span class="p">,</span>		<span class="cm">/* B2 = 0.462036 */</span>
		 <span class="o">-</span><span class="mi">14882</span><span class="p">,</span>	<span class="cm">/* B1 = -0.908356 */</span>
		 <span class="mi">15139</span><span class="p">,</span>		<span class="cm">/* B0 = 0.462036 */</span>
		 <span class="mi">32473</span><span class="p">,</span>		<span class="cm">/* A1 = 1.981995 */</span>
		 <span class="o">-</span><span class="mi">32524</span><span class="p">,</span>	<span class="cm">/* A2 = -0.992584 */</span>
		 <span class="mi">23200</span><span class="p">,</span>		<span class="cm">/* B2 = 0.708008 */</span>
		 <span class="o">-</span><span class="mi">23113</span><span class="p">,</span>	<span class="cm">/* B1 = -1.410706 */</span>
		 <span class="mi">23200</span><span class="p">,</span>		<span class="cm">/* B0 = 0.708008 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f300 13 */</span>
		<span class="mi">31769</span><span class="p">,</span>		<span class="cm">/* A1 = -1.939026 */</span>
		 <span class="o">-</span><span class="mi">32584</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994385 */</span>
		 <span class="o">-</span><span class="mi">475</span><span class="p">,</span>		<span class="cm">/* B2 = -0.014522 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">475</span><span class="p">,</span>		<span class="cm">/* B0 = 0.014522 */</span>
		 <span class="mi">31789</span><span class="p">,</span>		<span class="cm">/* A1 = -1.940247 */</span>
		 <span class="o">-</span><span class="mi">32679</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997284 */</span>
		 <span class="mi">17280</span><span class="p">,</span>		<span class="cm">/* B2 = 0.527344 */</span>
		 <span class="o">-</span><span class="mi">16865</span><span class="p">,</span>	<span class="cm">/* B1 = -1.029358 */</span>
		 <span class="mi">17280</span><span class="p">,</span>		<span class="cm">/* B0 = 0.527344 */</span>
		 <span class="mi">31841</span><span class="p">,</span>		<span class="cm">/* A1 = -1.943481 */</span>
		 <span class="o">-</span><span class="mi">32681</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997345 */</span>
		 <span class="mi">543</span><span class="p">,</span>		<span class="cm">/* B2 = 0.016579 */</span>
		 <span class="o">-</span><span class="mi">525</span><span class="p">,</span>		<span class="cm">/* B1 = -0.032097 */</span>
		 <span class="mi">543</span><span class="p">,</span>		<span class="cm">/* B0 = 0.016579 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f300_420[] 14 */</span>
		<span class="mi">30750</span><span class="p">,</span>		<span class="cm">/* A1 = 1.876892 */</span>
		 <span class="o">-</span><span class="mi">31212</span><span class="p">,</span>	<span class="cm">/* A2 = -0.952515 */</span>
		 <span class="o">-</span><span class="mi">804</span><span class="p">,</span>		<span class="cm">/* B2 = -0.024541 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">804</span><span class="p">,</span>		<span class="cm">/* B0 = 0.024541 */</span>
		 <span class="mi">30686</span><span class="p">,</span>		<span class="cm">/* A1 = 1.872925 */</span>
		 <span class="o">-</span><span class="mi">32145</span><span class="p">,</span>	<span class="cm">/* A2 = -0.980988 */</span>
		 <span class="mi">14747</span><span class="p">,</span>		<span class="cm">/* B2 = 0.450043 */</span>
		 <span class="o">-</span><span class="mi">13703</span><span class="p">,</span>	<span class="cm">/* B1 = -0.836395 */</span>
		 <span class="mi">14747</span><span class="p">,</span>		<span class="cm">/* B0 = 0.450043 */</span>
		 <span class="mi">31651</span><span class="p">,</span>		<span class="cm">/* A1 = 1.931824 */</span>
		 <span class="o">-</span><span class="mi">32321</span><span class="p">,</span>	<span class="cm">/* A2 = -0.986389 */</span>
		 <span class="mi">24425</span><span class="p">,</span>		<span class="cm">/* B2 = 0.745422 */</span>
		 <span class="o">-</span><span class="mi">23914</span><span class="p">,</span>	<span class="cm">/* B1 = -1.459595 */</span>
		 <span class="mi">24427</span><span class="p">,</span>		<span class="cm">/* B0 = 0.745483 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f330 15 */</span>
		<span class="mi">31613</span><span class="p">,</span>		<span class="cm">/* A1 = -1.929565 */</span>
		 <span class="o">-</span><span class="mi">32646</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996277 */</span>
		 <span class="o">-</span><span class="mi">185</span><span class="p">,</span>		<span class="cm">/* B2 = -0.005657 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">185</span><span class="p">,</span>		<span class="cm">/* B0 = 0.005657 */</span>
		 <span class="mi">31620</span><span class="p">,</span>		<span class="cm">/* A1 = -1.929932 */</span>
		 <span class="o">-</span><span class="mi">32713</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998352 */</span>
		 <span class="mi">19253</span><span class="p">,</span>		<span class="cm">/* B2 = 0.587585 */</span>
		 <span class="o">-</span><span class="mi">18566</span><span class="p">,</span>	<span class="cm">/* B1 = -1.133179 */</span>
		 <span class="mi">19253</span><span class="p">,</span>		<span class="cm">/* B0 = 0.587585 */</span>
		 <span class="mi">31674</span><span class="p">,</span>		<span class="cm">/* A1 = -1.933228 */</span>
		 <span class="o">-</span><span class="mi">32715</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998413 */</span>
		 <span class="mi">2575</span><span class="p">,</span>		<span class="cm">/* B2 = 0.078590 */</span>
		 <span class="o">-</span><span class="mi">2495</span><span class="p">,</span>		<span class="cm">/* B1 = -0.152283 */</span>
		 <span class="mi">2575</span><span class="p">,</span>		<span class="cm">/* B0 = 0.078590 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f300_425[] 16 */</span>
		<span class="mi">30741</span><span class="p">,</span>		<span class="cm">/* A1 = 1.876282 */</span>
		 <span class="o">-</span><span class="mi">31475</span><span class="p">,</span>	<span class="cm">/* A2 = -0.960541 */</span>
		 <span class="o">-</span><span class="mi">703</span><span class="p">,</span>		<span class="cm">/* B2 = -0.021484 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">703</span><span class="p">,</span>		<span class="cm">/* B0 = 0.021484 */</span>
		 <span class="mi">30688</span><span class="p">,</span>		<span class="cm">/* A1 = 1.873047 */</span>
		 <span class="o">-</span><span class="mi">32248</span><span class="p">,</span>	<span class="cm">/* A2 = -0.984161 */</span>
		 <span class="mi">14542</span><span class="p">,</span>		<span class="cm">/* B2 = 0.443787 */</span>
		 <span class="o">-</span><span class="mi">13523</span><span class="p">,</span>	<span class="cm">/* B1 = -0.825439 */</span>
		 <span class="mi">14542</span><span class="p">,</span>		<span class="cm">/* B0 = 0.443817 */</span>
		 <span class="mi">31494</span><span class="p">,</span>		<span class="cm">/* A1 = 1.922302 */</span>
		 <span class="o">-</span><span class="mi">32366</span><span class="p">,</span>	<span class="cm">/* A2 = -0.987762 */</span>
		 <span class="mi">21577</span><span class="p">,</span>		<span class="cm">/* B2 = 0.658508 */</span>
		 <span class="o">-</span><span class="mi">21013</span><span class="p">,</span>	<span class="cm">/* B1 = -1.282532 */</span>
		 <span class="mi">21577</span><span class="p">,</span>		<span class="cm">/* B0 = 0.658508 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f330_440[] 17 */</span>
		<span class="mi">30627</span><span class="p">,</span>		<span class="cm">/* A1 = 1.869324 */</span>
		 <span class="o">-</span><span class="mi">31338</span><span class="p">,</span>	<span class="cm">/* A2 = -0.95636 */</span>
		 <span class="o">-</span><span class="mi">843</span><span class="p">,</span>		<span class="cm">/* B2 = -0.025749 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">843</span><span class="p">,</span>		<span class="cm">/* B0 = 0.025749 */</span>
		 <span class="mi">30550</span><span class="p">,</span>		<span class="cm">/* A1 = 1.864685 */</span>
		 <span class="o">-</span><span class="mi">32221</span><span class="p">,</span>	<span class="cm">/* A2 = -0.983337 */</span>
		 <span class="mi">13594</span><span class="p">,</span>		<span class="cm">/* B2 = 0.414886 */</span>
		 <span class="o">-</span><span class="mi">12589</span><span class="p">,</span>	<span class="cm">/* B1 = -0.768402 */</span>
		 <span class="mi">13594</span><span class="p">,</span>		<span class="cm">/* B0 = 0.414886 */</span>
		 <span class="mi">31488</span><span class="p">,</span>		<span class="cm">/* A1 = 1.921936 */</span>
		 <span class="o">-</span><span class="mi">32358</span><span class="p">,</span>	<span class="cm">/* A2 = -0.987518 */</span>
		 <span class="mi">24684</span><span class="p">,</span>		<span class="cm">/* B2 = 0.753296 */</span>
		 <span class="o">-</span><span class="mi">24029</span><span class="p">,</span>	<span class="cm">/* B1 = -1.466614 */</span>
		 <span class="mi">24684</span><span class="p">,</span>		<span class="cm">/* B0 = 0.753296 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f340 18 */</span>
		<span class="mi">31546</span><span class="p">,</span>		<span class="cm">/* A1 = -1.925476 */</span>
		 <span class="o">-</span><span class="mi">32646</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996277 */</span>
		 <span class="o">-</span><span class="mi">445</span><span class="p">,</span>		<span class="cm">/* B2 = -0.013588 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">445</span><span class="p">,</span>		<span class="cm">/* B0 = 0.013588 */</span>
		 <span class="mi">31551</span><span class="p">,</span>		<span class="cm">/* A1 = -1.925781 */</span>
		 <span class="o">-</span><span class="mi">32713</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998352 */</span>
		 <span class="mi">23884</span><span class="p">,</span>		<span class="cm">/* B2 = 0.728882 */</span>
		 <span class="o">-</span><span class="mi">22979</span><span class="p">,</span>	<span class="cm">/* B1 = -1.402527 */</span>
		 <span class="mi">23884</span><span class="p">,</span>		<span class="cm">/* B0 = 0.728882 */</span>
		 <span class="mi">31606</span><span class="p">,</span>		<span class="cm">/* A1 = -1.929138 */</span>
		 <span class="o">-</span><span class="mi">32715</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998413 */</span>
		 <span class="mi">863</span><span class="p">,</span>		<span class="cm">/* B2 = 0.026367 */</span>
		 <span class="o">-</span><span class="mi">835</span><span class="p">,</span>		<span class="cm">/* B1 = -0.050985 */</span>
		 <span class="mi">863</span><span class="p">,</span>		<span class="cm">/* B0 = 0.026367 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f350_400[] 19 */</span>
		<span class="mi">31006</span><span class="p">,</span>		<span class="cm">/* A1 = 1.892517 */</span>
		 <span class="o">-</span><span class="mi">32029</span><span class="p">,</span>	<span class="cm">/* A2 = -0.977448 */</span>
		 <span class="o">-</span><span class="mi">461</span><span class="p">,</span>		<span class="cm">/* B2 = -0.014096 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">461</span><span class="p">,</span>		<span class="cm">/* B0 = 0.014096 */</span>
		 <span class="mi">30999</span><span class="p">,</span>		<span class="cm">/* A1 = 1.892029 */</span>
		 <span class="o">-</span><span class="mi">32487</span><span class="p">,</span>	<span class="cm">/* A2 = -0.991455 */</span>
		 <span class="mi">11325</span><span class="p">,</span>		<span class="cm">/* B2 = 0.345612 */</span>
		 <span class="o">-</span><span class="mi">10682</span><span class="p">,</span>	<span class="cm">/* B1 = -0.651978 */</span>
		 <span class="mi">11325</span><span class="p">,</span>		<span class="cm">/* B0 = 0.345612 */</span>
		 <span class="mi">31441</span><span class="p">,</span>		<span class="cm">/* A1 = 1.919067 */</span>
		 <span class="o">-</span><span class="mi">32526</span><span class="p">,</span>	<span class="cm">/* A2 = -0.992615 */</span>
		 <span class="mi">24324</span><span class="p">,</span>		<span class="cm">/* B2 = 0.74231 */</span>
		 <span class="o">-</span><span class="mi">23535</span><span class="p">,</span>	<span class="cm">/* B1 = -1.436523 */</span>
		 <span class="mi">24324</span><span class="p">,</span>		<span class="cm">/* B0 = 0.74231 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f350_440[] */</span>
		<span class="mi">30634</span><span class="p">,</span>		<span class="cm">/* A1 = 1.869751 */</span>
		 <span class="o">-</span><span class="mi">31533</span><span class="p">,</span>	<span class="cm">/* A2 = -0.962341 */</span>
		 <span class="o">-</span><span class="mi">680</span><span class="p">,</span>		<span class="cm">/* B2 = -0.020782 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">680</span><span class="p">,</span>		<span class="cm">/* B0 = 0.020782 */</span>
		 <span class="mi">30571</span><span class="p">,</span>		<span class="cm">/* A1 = 1.865906 */</span>
		 <span class="o">-</span><span class="mi">32277</span><span class="p">,</span>	<span class="cm">/* A2 = -0.985016 */</span>
		 <span class="mi">12894</span><span class="p">,</span>		<span class="cm">/* B2 = 0.393524 */</span>
		 <span class="o">-</span><span class="mi">11945</span><span class="p">,</span>	<span class="cm">/* B1 = -0.729065 */</span>
		 <span class="mi">12894</span><span class="p">,</span>		<span class="cm">/* B0 = 0.393524 */</span>
		 <span class="mi">31367</span><span class="p">,</span>		<span class="cm">/* A1 = 1.91449 */</span>
		 <span class="o">-</span><span class="mi">32379</span><span class="p">,</span>	<span class="cm">/* A2 = -0.988129 */</span>
		 <span class="mi">23820</span><span class="p">,</span>		<span class="cm">/* B2 = 0.726929 */</span>
		 <span class="o">-</span><span class="mi">23104</span><span class="p">,</span>	<span class="cm">/* B1 = -1.410217 */</span>
		 <span class="mi">23820</span><span class="p">,</span>		<span class="cm">/* B0 = 0.726929 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f350_450[] */</span>
		<span class="mi">30552</span><span class="p">,</span>		<span class="cm">/* A1 = 1.864807 */</span>
		 <span class="o">-</span><span class="mi">31434</span><span class="p">,</span>	<span class="cm">/* A2 = -0.95929 */</span>
		 <span class="o">-</span><span class="mi">690</span><span class="p">,</span>		<span class="cm">/* B2 = -0.021066 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">690</span><span class="p">,</span>		<span class="cm">/* B0 = 0.021066 */</span>
		 <span class="mi">30472</span><span class="p">,</span>		<span class="cm">/* A1 = 1.859924 */</span>
		 <span class="o">-</span><span class="mi">32248</span><span class="p">,</span>	<span class="cm">/* A2 = -0.984161 */</span>
		 <span class="mi">13385</span><span class="p">,</span>		<span class="cm">/* B2 = 0.408478 */</span>
		 <span class="o">-</span><span class="mi">12357</span><span class="p">,</span>	<span class="cm">/* B1 = -0.754242 */</span>
		 <span class="mi">13385</span><span class="p">,</span>		<span class="cm">/* B0 = 0.408478 */</span>
		 <span class="mi">31358</span><span class="p">,</span>		<span class="cm">/* A1 = 1.914001 */</span>
		 <span class="o">-</span><span class="mi">32366</span><span class="p">,</span>	<span class="cm">/* A2 = -0.987732 */</span>
		 <span class="mi">26488</span><span class="p">,</span>		<span class="cm">/* B2 = 0.80835 */</span>
		 <span class="o">-</span><span class="mi">25692</span><span class="p">,</span>	<span class="cm">/* B1 = -1.568176 */</span>
		 <span class="mi">26490</span><span class="p">,</span>		<span class="cm">/* B0 = 0.808411 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f360 */</span>
		<span class="mi">31397</span><span class="p">,</span>		<span class="cm">/* A1 = -1.916321 */</span>
		 <span class="o">-</span><span class="mi">32623</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995605 */</span>
		 <span class="o">-</span><span class="mi">117</span><span class="p">,</span>		<span class="cm">/* B2 = -0.003598 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">117</span><span class="p">,</span>		<span class="cm">/* B0 = 0.003598 */</span>
		 <span class="mi">31403</span><span class="p">,</span>		<span class="cm">/* A1 = -1.916687 */</span>
		 <span class="o">-</span><span class="mi">32700</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997925 */</span>
		 <span class="mi">3388</span><span class="p">,</span>		<span class="cm">/* B2 = 0.103401 */</span>
		 <span class="o">-</span><span class="mi">3240</span><span class="p">,</span>		<span class="cm">/* B1 = -0.197784 */</span>
		 <span class="mi">3388</span><span class="p">,</span>		<span class="cm">/* B0 = 0.103401 */</span>
		 <span class="mi">31463</span><span class="p">,</span>		<span class="cm">/* A1 = -1.920410 */</span>
		 <span class="o">-</span><span class="mi">32702</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997986 */</span>
		 <span class="mi">13346</span><span class="p">,</span>		<span class="cm">/* B2 = 0.407288 */</span>
		 <span class="o">-</span><span class="mi">12863</span><span class="p">,</span>	<span class="cm">/* B1 = -0.785126 */</span>
		 <span class="mi">13346</span><span class="p">,</span>		<span class="cm">/* B0 = 0.407288 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f380_420[] */</span>
		<span class="mi">30831</span><span class="p">,</span>		<span class="cm">/* A1 = 1.881775 */</span>
		 <span class="o">-</span><span class="mi">32064</span><span class="p">,</span>	<span class="cm">/* A2 = -0.978546 */</span>
		 <span class="o">-</span><span class="mi">367</span><span class="p">,</span>		<span class="cm">/* B2 = -0.01122 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">367</span><span class="p">,</span>		<span class="cm">/* B0 = 0.01122 */</span>
		 <span class="mi">30813</span><span class="p">,</span>		<span class="cm">/* A1 = 1.880737 */</span>
		 <span class="o">-</span><span class="mi">32456</span><span class="p">,</span>	<span class="cm">/* A2 = -0.990509 */</span>
		 <span class="mi">11068</span><span class="p">,</span>		<span class="cm">/* B2 = 0.337769 */</span>
		 <span class="o">-</span><span class="mi">10338</span><span class="p">,</span>	<span class="cm">/* B1 = -0.631042 */</span>
		 <span class="mi">11068</span><span class="p">,</span>		<span class="cm">/* B0 = 0.337769 */</span>
		 <span class="mi">31214</span><span class="p">,</span>		<span class="cm">/* A1 = 1.905212 */</span>
		 <span class="o">-</span><span class="mi">32491</span><span class="p">,</span>	<span class="cm">/* A2 = -0.991577 */</span>
		 <span class="mi">16374</span><span class="p">,</span>		<span class="cm">/* B2 = 0.499695 */</span>
		 <span class="o">-</span><span class="mi">15781</span><span class="p">,</span>	<span class="cm">/* B1 = -0.963196 */</span>
		 <span class="mi">16374</span><span class="p">,</span>		<span class="cm">/* B0 = 0.499695 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f392 */</span>
		<span class="mi">31152</span><span class="p">,</span>		<span class="cm">/* A1 = -1.901428 */</span>
		 <span class="o">-</span><span class="mi">32613</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995300 */</span>
		 <span class="o">-</span><span class="mi">314</span><span class="p">,</span>		<span class="cm">/* B2 = -0.009605 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">314</span><span class="p">,</span>		<span class="cm">/* B0 = 0.009605 */</span>
		 <span class="mi">31156</span><span class="p">,</span>		<span class="cm">/* A1 = -1.901672 */</span>
		 <span class="o">-</span><span class="mi">32694</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997742 */</span>
		 <span class="mi">28847</span><span class="p">,</span>		<span class="cm">/* B2 = 0.880371 */</span>
		 <span class="o">-</span><span class="mi">2734</span><span class="p">,</span>		<span class="cm">/* B1 = -0.166901 */</span>
		 <span class="mi">28847</span><span class="p">,</span>		<span class="cm">/* B0 = 0.880371 */</span>
		 <span class="mi">31225</span><span class="p">,</span>		<span class="cm">/* A1 = -1.905823 */</span>
		 <span class="o">-</span><span class="mi">32696</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997803 */</span>
		 <span class="mi">462</span><span class="p">,</span>		<span class="cm">/* B2 = 0.014108 */</span>
		 <span class="o">-</span><span class="mi">442</span><span class="p">,</span>		<span class="cm">/* B1 = -0.027019 */</span>
		 <span class="mi">462</span><span class="p">,</span>		<span class="cm">/* B0 = 0.014108 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f400_425[] */</span>
		<span class="mi">30836</span><span class="p">,</span>		<span class="cm">/* A1 = 1.882141 */</span>
		 <span class="o">-</span><span class="mi">32296</span><span class="p">,</span>	<span class="cm">/* A2 = -0.985596 */</span>
		 <span class="o">-</span><span class="mi">324</span><span class="p">,</span>		<span class="cm">/* B2 = -0.009903 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">324</span><span class="p">,</span>		<span class="cm">/* B0 = 0.009903 */</span>
		 <span class="mi">30825</span><span class="p">,</span>		<span class="cm">/* A1 = 1.881409 */</span>
		 <span class="o">-</span><span class="mi">32570</span><span class="p">,</span>	<span class="cm">/* A2 = -0.993958 */</span>
		 <span class="mi">16847</span><span class="p">,</span>		<span class="cm">/* B2 = 0.51416 */</span>
		 <span class="o">-</span><span class="mi">15792</span><span class="p">,</span>	<span class="cm">/* B1 = -0.963898 */</span>
		 <span class="mi">16847</span><span class="p">,</span>		<span class="cm">/* B0 = 0.51416 */</span>
		 <span class="mi">31106</span><span class="p">,</span>		<span class="cm">/* A1 = 1.89856 */</span>
		 <span class="o">-</span><span class="mi">32584</span><span class="p">,</span>	<span class="cm">/* A2 = -0.994415 */</span>
		 <span class="mi">9579</span><span class="p">,</span>		<span class="cm">/* B2 = 0.292328 */</span>
		 <span class="o">-</span><span class="mi">9164</span><span class="p">,</span>		<span class="cm">/* B1 = -0.559357 */</span>
		 <span class="mi">9579</span><span class="p">,</span>		<span class="cm">/* B0 = 0.292328 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f400_440[] */</span>
		<span class="mi">30702</span><span class="p">,</span>		<span class="cm">/* A1 = 1.873962 */</span>
		 <span class="o">-</span><span class="mi">32134</span><span class="p">,</span>	<span class="cm">/* A2 = -0.980682 */</span>
		 <span class="o">-</span><span class="mi">517</span><span class="p">,</span>		<span class="cm">/* B2 = -0.015793 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">517</span><span class="p">,</span>		<span class="cm">/* B0 = 0.015793 */</span>
		 <span class="mi">30676</span><span class="p">,</span>		<span class="cm">/* A1 = 1.872375 */</span>
		 <span class="o">-</span><span class="mi">32520</span><span class="p">,</span>	<span class="cm">/* A2 = -0.992462 */</span>
		 <span class="mi">8144</span><span class="p">,</span>		<span class="cm">/* B2 = 0.24855 */</span>
		 <span class="o">-</span><span class="mi">7596</span><span class="p">,</span>		<span class="cm">/* B1 = -0.463684 */</span>
		 <span class="mi">8144</span><span class="p">,</span>		<span class="cm">/* B0 = 0.24855 */</span>
		 <span class="mi">31084</span><span class="p">,</span>		<span class="cm">/* A1 = 1.897217 */</span>
		 <span class="o">-</span><span class="mi">32547</span><span class="p">,</span>	<span class="cm">/* A2 = -0.993256 */</span>
		 <span class="mi">22713</span><span class="p">,</span>		<span class="cm">/* B2 = 0.693176 */</span>
		 <span class="o">-</span><span class="mi">21734</span><span class="p">,</span>	<span class="cm">/* B1 = -1.326599 */</span>
		 <span class="mi">22713</span><span class="p">,</span>		<span class="cm">/* B0 = 0.693176 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f400_450[] */</span>
		<span class="mi">30613</span><span class="p">,</span>		<span class="cm">/* A1 = 1.86853 */</span>
		 <span class="o">-</span><span class="mi">32031</span><span class="p">,</span>	<span class="cm">/* A2 = -0.977509 */</span>
		 <span class="o">-</span><span class="mi">618</span><span class="p">,</span>		<span class="cm">/* B2 = -0.018866 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">618</span><span class="p">,</span>		<span class="cm">/* B0 = 0.018866 */</span>
		 <span class="mi">30577</span><span class="p">,</span>		<span class="cm">/* A1 = 1.866272 */</span>
		 <span class="o">-</span><span class="mi">32491</span><span class="p">,</span>	<span class="cm">/* A2 = -0.991577 */</span>
		 <span class="mi">9612</span><span class="p">,</span>		<span class="cm">/* B2 = 0.293335 */</span>
		 <span class="o">-</span><span class="mi">8935</span><span class="p">,</span>		<span class="cm">/* B1 = -0.54541 */</span>
		 <span class="mi">9612</span><span class="p">,</span>		<span class="cm">/* B0 = 0.293335 */</span>
		 <span class="mi">31071</span><span class="p">,</span>		<span class="cm">/* A1 = 1.896484 */</span>
		 <span class="o">-</span><span class="mi">32524</span><span class="p">,</span>	<span class="cm">/* A2 = -0.992584 */</span>
		 <span class="mi">21596</span><span class="p">,</span>		<span class="cm">/* B2 = 0.659058 */</span>
		 <span class="o">-</span><span class="mi">20667</span><span class="p">,</span>	<span class="cm">/* B1 = -1.261414 */</span>
		 <span class="mi">21596</span><span class="p">,</span>		<span class="cm">/* B0 = 0.659058 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f420 */</span>
		<span class="mi">30914</span><span class="p">,</span>		<span class="cm">/* A1 = -1.886841 */</span>
		 <span class="o">-</span><span class="mi">32584</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994385 */</span>
		 <span class="o">-</span><span class="mi">426</span><span class="p">,</span>		<span class="cm">/* B2 = -0.013020 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">426</span><span class="p">,</span>		<span class="cm">/* B0 = 0.013020 */</span>
		 <span class="mi">30914</span><span class="p">,</span>		<span class="cm">/* A1 = -1.886841 */</span>
		 <span class="o">-</span><span class="mi">32679</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997314 */</span>
		 <span class="mi">17520</span><span class="p">,</span>		<span class="cm">/* B2 = 0.534668 */</span>
		 <span class="o">-</span><span class="mi">16471</span><span class="p">,</span>	<span class="cm">/* B1 = -1.005310 */</span>
		 <span class="mi">17520</span><span class="p">,</span>		<span class="cm">/* B0 = 0.534668 */</span>
		 <span class="mi">31004</span><span class="p">,</span>		<span class="cm">/* A1 = -1.892334 */</span>
		 <span class="o">-</span><span class="mi">32683</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997406 */</span>
		 <span class="mi">819</span><span class="p">,</span>		<span class="cm">/* B2 = 0.025023 */</span>
		 <span class="o">-</span><span class="mi">780</span><span class="p">,</span>		<span class="cm">/* B1 = -0.047619 */</span>
		 <span class="mi">819</span><span class="p">,</span>		<span class="cm">/* B0 = 0.025023 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
<span class="cp">#if 0</span><span class="c"></span>
<span class="c">	{			/* f425 */</span>
<span class="c">		30881,		/* A1 = -1.884827 */</span>
<span class="c">		 -32603,	/* A2 = 0.994965 */</span>
<span class="c">		 -496,		/* B2 = -0.015144 */</span>
<span class="c">		 0,		/* B1 = 0.000000 */</span>
<span class="c">		 496,		/* B0 = 0.015144 */</span>
<span class="c">		 30880,		/* A1 = -1.884766 */</span>
<span class="c">		 -32692,	/* A2 = 0.997711 */</span>
<span class="c">		 24767,		/* B2 = 0.755859 */</span>
<span class="c">		 -23290,	/* B1 = -1.421509 */</span>
<span class="c">		 24767,		/* B0 = 0.755859 */</span>
<span class="c">		 30967,		/* A1 = -1.890076 */</span>
<span class="c">		 -32694,	/* A2 = 0.997772 */</span>
<span class="c">		 728,		/* B2 = 0.022232 */</span>
<span class="c">		 -691,		/* B1 = -0.042194 */</span>
<span class="c">		 728,		/* B0 = 0.022232 */</span>
<span class="c">		 5,		/* Internal filter scaling */</span>
<span class="c">		 159,		/* Minimum in-band energy threshold */</span>
<span class="c">		 21,		/* 21/32 in-band to broad-band ratio */</span>
<span class="c">		 0x0FF5		/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
<span class="c">	},</span>
<span class="cp">#else</span>
	<span class="p">{</span>
		<span class="mi">30850</span><span class="p">,</span>
		<span class="o">-</span><span class="mi">32534</span><span class="p">,</span>
		<span class="o">-</span><span class="mi">504</span><span class="p">,</span>
		<span class="mi">0</span><span class="p">,</span>
		<span class="mi">504</span><span class="p">,</span>
		<span class="mi">30831</span><span class="p">,</span>
		<span class="o">-</span><span class="mi">32669</span><span class="p">,</span>
		<span class="mi">24303</span><span class="p">,</span>
		<span class="o">-</span><span class="mi">22080</span><span class="p">,</span>
		<span class="mi">24303</span><span class="p">,</span>
		<span class="mi">30994</span><span class="p">,</span>
		<span class="o">-</span><span class="mi">32673</span><span class="p">,</span>
		<span class="mi">1905</span><span class="p">,</span>
		<span class="o">-</span><span class="mi">1811</span><span class="p">,</span>
		<span class="mi">1905</span><span class="p">,</span>
		<span class="mi">5</span><span class="p">,</span>
		<span class="mi">129</span><span class="p">,</span>
		<span class="mi">17</span><span class="p">,</span>
		<span class="mh">0xff5</span>
	<span class="p">},</span>
<span class="cp">#endif</span>
	<span class="p">{</span>			<span class="cm">/* f425_450[] */</span>
		<span class="mi">30646</span><span class="p">,</span>		<span class="cm">/* A1 = 1.870544 */</span>
		 <span class="o">-</span><span class="mi">32327</span><span class="p">,</span>	<span class="cm">/* A2 = -0.986572 */</span>
		 <span class="o">-</span><span class="mi">287</span><span class="p">,</span>		<span class="cm">/* B2 = -0.008769 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">287</span><span class="p">,</span>		<span class="cm">/* B0 = 0.008769 */</span>
		 <span class="mi">30627</span><span class="p">,</span>		<span class="cm">/* A1 = 1.869324 */</span>
		 <span class="o">-</span><span class="mi">32607</span><span class="p">,</span>	<span class="cm">/* A2 = -0.995087 */</span>
		 <span class="mi">13269</span><span class="p">,</span>		<span class="cm">/* B2 = 0.404968 */</span>
		 <span class="o">-</span><span class="mi">12376</span><span class="p">,</span>	<span class="cm">/* B1 = -0.755432 */</span>
		 <span class="mi">13269</span><span class="p">,</span>		<span class="cm">/* B0 = 0.404968 */</span>
		 <span class="mi">30924</span><span class="p">,</span>		<span class="cm">/* A1 = 1.887512 */</span>
		 <span class="o">-</span><span class="mi">32619</span><span class="p">,</span>	<span class="cm">/* A2 = -0.995453 */</span>
		 <span class="mi">19950</span><span class="p">,</span>		<span class="cm">/* B2 = 0.608826 */</span>
		 <span class="o">-</span><span class="mi">18940</span><span class="p">,</span>	<span class="cm">/* B1 = -1.156006 */</span>
		 <span class="mi">19950</span><span class="p">,</span>		<span class="cm">/* B0 = 0.608826 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f425_475[] */</span>
		<span class="mi">30396</span><span class="p">,</span>		<span class="cm">/* A1 = 1.855225 */</span>
		 <span class="o">-</span><span class="mi">32014</span><span class="p">,</span>	<span class="cm">/* A2 = -0.97699 */</span>
		 <span class="o">-</span><span class="mi">395</span><span class="p">,</span>		<span class="cm">/* B2 = -0.012055 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">395</span><span class="p">,</span>		<span class="cm">/* B0 = 0.012055 */</span>
		 <span class="mi">30343</span><span class="p">,</span>		<span class="cm">/* A1 = 1.85199 */</span>
		 <span class="o">-</span><span class="mi">32482</span><span class="p">,</span>	<span class="cm">/* A2 = -0.991302 */</span>
		 <span class="mi">17823</span><span class="p">,</span>		<span class="cm">/* B2 = 0.543945 */</span>
		 <span class="o">-</span><span class="mi">16431</span><span class="p">,</span>	<span class="cm">/* B1 = -1.002869 */</span>
		 <span class="mi">17823</span><span class="p">,</span>		<span class="cm">/* B0 = 0.543945 */</span>
		 <span class="mi">30872</span><span class="p">,</span>		<span class="cm">/* A1 = 1.884338 */</span>
		 <span class="o">-</span><span class="mi">32516</span><span class="p">,</span>	<span class="cm">/* A2 = -0.99231 */</span>
		 <span class="mi">18124</span><span class="p">,</span>		<span class="cm">/* B2 = 0.553101 */</span>
		 <span class="o">-</span><span class="mi">17246</span><span class="p">,</span>	<span class="cm">/* B1 = -1.052673 */</span>
		 <span class="mi">18124</span><span class="p">,</span>		<span class="cm">/* B0 = 0.553101 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f435 */</span>
		<span class="mi">30796</span><span class="p">,</span>		<span class="cm">/* A1 = -1.879639 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="o">-</span><span class="mi">254</span><span class="p">,</span>		<span class="cm">/* B2 = -0.007762 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">254</span><span class="p">,</span>		<span class="cm">/* B0 = 0.007762 */</span>
		 <span class="mi">30793</span><span class="p">,</span>		<span class="cm">/* A1 = -1.879456 */</span>
		 <span class="o">-</span><span class="mi">32692</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997711 */</span>
		 <span class="mi">18934</span><span class="p">,</span>		<span class="cm">/* B2 = 0.577820 */</span>
		 <span class="o">-</span><span class="mi">17751</span><span class="p">,</span>	<span class="cm">/* B1 = -1.083496 */</span>
		 <span class="mi">18934</span><span class="p">,</span>		<span class="cm">/* B0 = 0.577820 */</span>
		 <span class="mi">30882</span><span class="p">,</span>		<span class="cm">/* A1 = -1.884888 */</span>
		 <span class="o">-</span><span class="mi">32694</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997772 */</span>
		 <span class="mi">1858</span><span class="p">,</span>		<span class="cm">/* B2 = 0.056713 */</span>
		 <span class="o">-</span><span class="mi">1758</span><span class="p">,</span>		<span class="cm">/* B1 = -0.107357 */</span>
		 <span class="mi">1858</span><span class="p">,</span>		<span class="cm">/* B0 = 0.056713 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f440_450[] */</span>
		<span class="mi">30641</span><span class="p">,</span>		<span class="cm">/* A1 = 1.870239 */</span>
		 <span class="o">-</span><span class="mi">32458</span><span class="p">,</span>	<span class="cm">/* A2 = -0.99057 */</span>
		 <span class="o">-</span><span class="mi">155</span><span class="p">,</span>		<span class="cm">/* B2 = -0.004735 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">155</span><span class="p">,</span>		<span class="cm">/* B0 = 0.004735 */</span>
		 <span class="mi">30631</span><span class="p">,</span>		<span class="cm">/* A1 = 1.869568 */</span>
		 <span class="o">-</span><span class="mi">32630</span><span class="p">,</span>	<span class="cm">/* A2 = -0.995789 */</span>
		 <span class="mi">11453</span><span class="p">,</span>		<span class="cm">/* B2 = 0.349548 */</span>
		 <span class="o">-</span><span class="mi">10666</span><span class="p">,</span>	<span class="cm">/* B1 = -0.651001 */</span>
		 <span class="mi">11453</span><span class="p">,</span>		<span class="cm">/* B0 = 0.349548 */</span>
		 <span class="mi">30810</span><span class="p">,</span>		<span class="cm">/* A1 = 1.880554 */</span>
		 <span class="o">-</span><span class="mi">32634</span><span class="p">,</span>	<span class="cm">/* A2 = -0.995941 */</span>
		 <span class="mi">12237</span><span class="p">,</span>		<span class="cm">/* B2 = 0.373474 */</span>
		 <span class="o">-</span><span class="mi">11588</span><span class="p">,</span>	<span class="cm">/* B1 = -0.707336 */</span>
		 <span class="mi">12237</span><span class="p">,</span>		<span class="cm">/* B0 = 0.373474 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f440_480[] */</span>
		<span class="mi">30367</span><span class="p">,</span>		<span class="cm">/* A1 = 1.853455 */</span>
		 <span class="o">-</span><span class="mi">32147</span><span class="p">,</span>	<span class="cm">/* A2 = -0.981079 */</span>
		 <span class="o">-</span><span class="mi">495</span><span class="p">,</span>		<span class="cm">/* B2 = -0.015113 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">495</span><span class="p">,</span>		<span class="cm">/* B0 = 0.015113 */</span>
		 <span class="mi">30322</span><span class="p">,</span>		<span class="cm">/* A1 = 1.850769 */</span>
		 <span class="o">-</span><span class="mi">32543</span><span class="p">,</span>	<span class="cm">/* A2 = -0.993134 */</span>
		 <span class="mi">10031</span><span class="p">,</span>		<span class="cm">/* B2 = 0.306152 */</span>
		 <span class="o">-</span><span class="mi">9252</span><span class="p">,</span>		<span class="cm">/* B1 = -0.564728 */</span>
		 <span class="mi">10031</span><span class="p">,</span>		<span class="cm">/* B0 = 0.306152 */</span>
		 <span class="mi">30770</span><span class="p">,</span>		<span class="cm">/* A1 = 1.878052 */</span>
		 <span class="o">-</span><span class="mi">32563</span><span class="p">,</span>	<span class="cm">/* A2 = -0.993774 */</span>
		 <span class="mi">22674</span><span class="p">,</span>		<span class="cm">/* B2 = 0.691956 */</span>
		 <span class="o">-</span><span class="mi">21465</span><span class="p">,</span>	<span class="cm">/* B1 = -1.31012 */</span>
		 <span class="mi">22674</span><span class="p">,</span>		<span class="cm">/* B0 = 0.691956 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f445 */</span>
		<span class="mi">30709</span><span class="p">,</span>		<span class="cm">/* A1 = -1.874329 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="o">-</span><span class="mi">83</span><span class="p">,</span>		<span class="cm">/* B2 = -0.002545 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">83</span><span class="p">,</span>		<span class="cm">/* B0 = 0.002545 */</span>
		 <span class="mi">30704</span><span class="p">,</span>		<span class="cm">/* A1 = -1.874084 */</span>
		 <span class="o">-</span><span class="mi">32692</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997711 */</span>
		 <span class="mi">10641</span><span class="p">,</span>		<span class="cm">/* B2 = 0.324738 */</span>
		 <span class="o">-</span><span class="mi">9947</span><span class="p">,</span>		<span class="cm">/* B1 = -0.607147 */</span>
		 <span class="mi">10641</span><span class="p">,</span>		<span class="cm">/* B0 = 0.324738 */</span>
		 <span class="mi">30796</span><span class="p">,</span>		<span class="cm">/* A1 = -1.879639 */</span>
		 <span class="o">-</span><span class="mi">32694</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997772 */</span>
		 <span class="mi">10079</span><span class="p">,</span>		<span class="cm">/* B2 = 0.307587 */</span>
		 <span class="mi">9513</span><span class="p">,</span>		<span class="cm">/* B1 = 0.580688 */</span>
		 <span class="mi">10079</span><span class="p">,</span>		<span class="cm">/* B0 = 0.307587 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f450 */</span>
		<span class="mi">30664</span><span class="p">,</span>		<span class="cm">/* A1 = -1.871643 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="o">-</span><span class="mi">164</span><span class="p">,</span>		<span class="cm">/* B2 = -0.005029 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">164</span><span class="p">,</span>		<span class="cm">/* B0 = 0.005029 */</span>
		 <span class="mi">30661</span><span class="p">,</span>		<span class="cm">/* A1 = -1.871399 */</span>
		 <span class="o">-</span><span class="mi">32692</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997711 */</span>
		 <span class="mi">15294</span><span class="p">,</span>		<span class="cm">/* B2 = 0.466736 */</span>
		 <span class="o">-</span><span class="mi">14275</span><span class="p">,</span>	<span class="cm">/* B1 = -0.871307 */</span>
		 <span class="mi">15294</span><span class="p">,</span>		<span class="cm">/* B0 = 0.466736 */</span>
		 <span class="mi">30751</span><span class="p">,</span>		<span class="cm">/* A1 = -1.876953 */</span>
		 <span class="o">-</span><span class="mi">32694</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997772 */</span>
		 <span class="mi">3548</span><span class="p">,</span>		<span class="cm">/* B2 = 0.108284 */</span>
		 <span class="o">-</span><span class="mi">3344</span><span class="p">,</span>		<span class="cm">/* B1 = -0.204155 */</span>
		 <span class="mi">3548</span><span class="p">,</span>		<span class="cm">/* B0 = 0.108284 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f452 */</span>
		<span class="mi">30653</span><span class="p">,</span>		<span class="cm">/* A1 = -1.870911 */</span>
		 <span class="o">-</span><span class="mi">32615</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995361 */</span>
		 <span class="o">-</span><span class="mi">209</span><span class="p">,</span>		<span class="cm">/* B2 = -0.006382 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">209</span><span class="p">,</span>		<span class="cm">/* B0 = 0.006382 */</span>
		 <span class="mi">30647</span><span class="p">,</span>		<span class="cm">/* A1 = -1.870605 */</span>
		 <span class="o">-</span><span class="mi">32702</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997986 */</span>
		 <span class="mi">18971</span><span class="p">,</span>		<span class="cm">/* B2 = 0.578979 */</span>
		 <span class="o">-</span><span class="mi">17716</span><span class="p">,</span>	<span class="cm">/* B1 = -1.081299 */</span>
		 <span class="mi">18971</span><span class="p">,</span>		<span class="cm">/* B0 = 0.578979 */</span>
		 <span class="mi">30738</span><span class="p">,</span>		<span class="cm">/* A1 = -1.876099 */</span>
		 <span class="o">-</span><span class="mi">32702</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998016 */</span>
		 <span class="mi">2967</span><span class="p">,</span>		<span class="cm">/* B2 = 0.090561 */</span>
		 <span class="o">-</span><span class="mi">2793</span><span class="p">,</span>		<span class="cm">/* B1 = -0.170502 */</span>
		 <span class="mi">2967</span><span class="p">,</span>		<span class="cm">/* B0 = 0.090561 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f475 */</span>
		<span class="mi">30437</span><span class="p">,</span>		<span class="cm">/* A1 = -1.857727 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="o">-</span><span class="mi">264</span><span class="p">,</span>		<span class="cm">/* B2 = -0.008062 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">264</span><span class="p">,</span>		<span class="cm">/* B0 = 0.008062 */</span>
		 <span class="mi">30430</span><span class="p">,</span>		<span class="cm">/* A1 = -1.857300 */</span>
		 <span class="o">-</span><span class="mi">32692</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997711 */</span>
		 <span class="mi">21681</span><span class="p">,</span>		<span class="cm">/* B2 = 0.661682 */</span>
		 <span class="o">-</span><span class="mi">20082</span><span class="p">,</span>	<span class="cm">/* B1 = -1.225708 */</span>
		 <span class="mi">21681</span><span class="p">,</span>		<span class="cm">/* B0 = 0.661682 */</span>
		 <span class="mi">30526</span><span class="p">,</span>		<span class="cm">/* A1 = -1.863220 */</span>
		 <span class="o">-</span><span class="mi">32694</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997742 */</span>
		 <span class="mi">1559</span><span class="p">,</span>		<span class="cm">/* B2 = 0.047600 */</span>
		 <span class="o">-</span><span class="mi">1459</span><span class="p">,</span>		<span class="cm">/* B1 = -0.089096 */</span>
		 <span class="mi">1559</span><span class="p">,</span>		<span class="cm">/* B0 = 0.047600 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f480_620[] */</span>
		<span class="mi">28975</span><span class="p">,</span>		<span class="cm">/* A1 = 1.768494 */</span>
		 <span class="o">-</span><span class="mi">30955</span><span class="p">,</span>	<span class="cm">/* A2 = -0.944672 */</span>
		 <span class="o">-</span><span class="mi">1026</span><span class="p">,</span>		<span class="cm">/* B2 = -0.03133 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">1026</span><span class="p">,</span>		<span class="cm">/* B0 = 0.03133 */</span>
		 <span class="mi">28613</span><span class="p">,</span>		<span class="cm">/* A1 = 1.746399 */</span>
		 <span class="o">-</span><span class="mi">32089</span><span class="p">,</span>	<span class="cm">/* A2 = -0.979309 */</span>
		 <span class="mi">14214</span><span class="p">,</span>		<span class="cm">/* B2 = 0.433807 */</span>
		 <span class="o">-</span><span class="mi">12202</span><span class="p">,</span>	<span class="cm">/* B1 = -0.744812 */</span>
		 <span class="mi">14214</span><span class="p">,</span>		<span class="cm">/* B0 = 0.433807 */</span>
		 <span class="mi">30243</span><span class="p">,</span>		<span class="cm">/* A1 = 1.845947 */</span>
		 <span class="o">-</span><span class="mi">32238</span><span class="p">,</span>	<span class="cm">/* A2 = -0.983856 */</span>
		 <span class="mi">24825</span><span class="p">,</span>		<span class="cm">/* B2 = 0.757629 */</span>
		 <span class="o">-</span><span class="mi">23402</span><span class="p">,</span>	<span class="cm">/* B1 = -1.428345 */</span>
		 <span class="mi">24825</span><span class="p">,</span>		<span class="cm">/* B0 = 0.757629 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f494 */</span>
		<span class="mi">30257</span><span class="p">,</span>		<span class="cm">/* A1 = -1.846741 */</span>
		 <span class="o">-</span><span class="mi">32605</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995056 */</span>
		 <span class="o">-</span><span class="mi">249</span><span class="p">,</span>		<span class="cm">/* B2 = -0.007625 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">249</span><span class="p">,</span>		<span class="cm">/* B0 = 0.007625 */</span>
		 <span class="mi">30247</span><span class="p">,</span>		<span class="cm">/* A1 = -1.846191 */</span>
		 <span class="o">-</span><span class="mi">32694</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997772 */</span>
		 <span class="mi">18088</span><span class="p">,</span>		<span class="cm">/* B2 = 0.552002 */</span>
		 <span class="o">-</span><span class="mi">16652</span><span class="p">,</span>	<span class="cm">/* B1 = -1.016418 */</span>
		 <span class="mi">18088</span><span class="p">,</span>		<span class="cm">/* B0 = 0.552002 */</span>
		 <span class="mi">30348</span><span class="p">,</span>		<span class="cm">/* A1 = -1.852295 */</span>
		 <span class="o">-</span><span class="mi">32696</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997803 */</span>
		 <span class="mi">2099</span><span class="p">,</span>		<span class="cm">/* B2 = 0.064064 */</span>
		 <span class="o">-</span><span class="mi">1953</span><span class="p">,</span>		<span class="cm">/* B1 = -0.119202 */</span>
		 <span class="mi">2099</span><span class="p">,</span>		<span class="cm">/* B0 = 0.064064 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f500 */</span>
		<span class="mi">30202</span><span class="p">,</span>		<span class="cm">/* A1 = -1.843431 */</span>
		 <span class="o">-</span><span class="mi">32624</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995622 */</span>
		 <span class="o">-</span><span class="mi">413</span><span class="p">,</span>		<span class="cm">/* B2 = -0.012622 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">413</span><span class="p">,</span>		<span class="cm">/* B0 = 0.012622 */</span>
		 <span class="mi">30191</span><span class="p">,</span>		<span class="cm">/* A1 = -1.842721 */</span>
		 <span class="o">-</span><span class="mi">32714</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998364 */</span>
		 <span class="mi">25954</span><span class="p">,</span>		<span class="cm">/* B2 = 0.792057 */</span>
		 <span class="o">-</span><span class="mi">23890</span><span class="p">,</span>	<span class="cm">/* B1 = -1.458131 */</span>
		 <span class="mi">25954</span><span class="p">,</span>		<span class="cm">/* B0 = 0.792057 */</span>
		 <span class="mi">30296</span><span class="p">,</span>		<span class="cm">/* A1 = -1.849172 */</span>
		 <span class="o">-</span><span class="mi">32715</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998397 */</span>
		 <span class="mi">2007</span><span class="p">,</span>		<span class="cm">/* B2 = 0.061264 */</span>
		 <span class="o">-</span><span class="mi">1860</span><span class="p">,</span>		<span class="cm">/* B1 = -0.113568 */</span>
		 <span class="mi">2007</span><span class="p">,</span>		<span class="cm">/* B0 = 0.061264 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f520 */</span>
		<span class="mi">30001</span><span class="p">,</span>		<span class="cm">/* A1 = -1.831116 */</span>
		 <span class="o">-</span><span class="mi">32613</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995270 */</span>
		 <span class="o">-</span><span class="mi">155</span><span class="p">,</span>		<span class="cm">/* B2 = -0.004750 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">155</span><span class="p">,</span>		<span class="cm">/* B0 = 0.004750 */</span>
		 <span class="mi">29985</span><span class="p">,</span>		<span class="cm">/* A1 = -1.830200 */</span>
		 <span class="o">-</span><span class="mi">32710</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998260 */</span>
		 <span class="mi">6584</span><span class="p">,</span>		<span class="cm">/* B2 = 0.200928 */</span>
		 <span class="o">-</span><span class="mi">6018</span><span class="p">,</span>		<span class="cm">/* B1 = -0.367355 */</span>
		 <span class="mi">6584</span><span class="p">,</span>		<span class="cm">/* B0 = 0.200928 */</span>
		 <span class="mi">30105</span><span class="p">,</span>		<span class="cm">/* A1 = -1.837524 */</span>
		 <span class="o">-</span><span class="mi">32712</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998291 */</span>
		 <span class="mi">23812</span><span class="p">,</span>		<span class="cm">/* B2 = 0.726685 */</span>
		 <span class="o">-</span><span class="mi">21936</span><span class="p">,</span>	<span class="cm">/* B1 = -1.338928 */</span>
		 <span class="mi">23812</span><span class="p">,</span>		<span class="cm">/* B0 = 0.726685 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f523 */</span>
		<span class="mi">29964</span><span class="p">,</span>		<span class="cm">/* A1 = -1.828918 */</span>
		 <span class="o">-</span><span class="mi">32601</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994904 */</span>
		 <span class="o">-</span><span class="mi">101</span><span class="p">,</span>		<span class="cm">/* B2 = -0.003110 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">101</span><span class="p">,</span>		<span class="cm">/* B0 = 0.003110 */</span>
		 <span class="mi">29949</span><span class="p">,</span>		<span class="cm">/* A1 = -1.827942 */</span>
		 <span class="o">-</span><span class="mi">32700</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997925 */</span>
		 <span class="mi">11041</span><span class="p">,</span>		<span class="cm">/* B2 = 0.336975 */</span>
		 <span class="o">-</span><span class="mi">10075</span><span class="p">,</span>	<span class="cm">/* B1 = -0.614960 */</span>
		 <span class="mi">11041</span><span class="p">,</span>		<span class="cm">/* B0 = 0.336975 */</span>
		 <span class="mi">30070</span><span class="p">,</span>		<span class="cm">/* A1 = -1.835388 */</span>
		 <span class="o">-</span><span class="mi">32702</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997986 */</span>
		 <span class="mi">16762</span><span class="p">,</span>		<span class="cm">/* B2 = 0.511536 */</span>
		 <span class="o">-</span><span class="mi">15437</span><span class="p">,</span>	<span class="cm">/* B1 = -0.942230 */</span>
		 <span class="mi">16762</span><span class="p">,</span>		<span class="cm">/* B0 = 0.511536 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f525 */</span>
		<span class="mi">29936</span><span class="p">,</span>		<span class="cm">/* A1 = -1.827209 */</span>
		 <span class="o">-</span><span class="mi">32584</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994415 */</span>
		 <span class="o">-</span><span class="mi">91</span><span class="p">,</span>		<span class="cm">/* B2 = -0.002806 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">91</span><span class="p">,</span>		<span class="cm">/* B0 = 0.002806 */</span>
		 <span class="mi">29921</span><span class="p">,</span>		<span class="cm">/* A1 = -1.826233 */</span>
		 <span class="o">-</span><span class="mi">32688</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997559 */</span>
		 <span class="mi">11449</span><span class="p">,</span>		<span class="cm">/* B2 = 0.349396 */</span>
		 <span class="o">-</span><span class="mi">10426</span><span class="p">,</span>	<span class="cm">/* B1 = -0.636383 */</span>
		 <span class="mi">11449</span><span class="p">,</span>		<span class="cm">/* B0 = 0.349396 */</span>
		 <span class="mi">30045</span><span class="p">,</span>		<span class="cm">/* A1 = -1.833862 */</span>
		 <span class="o">-</span><span class="mi">32688</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997589 */</span>
		 <span class="mi">13055</span><span class="p">,</span>		<span class="cm">/* B2 = 0.398407 */</span>
		 <span class="o">-</span><span class="mi">12028</span><span class="p">,</span>	<span class="cm">/* B1 = -0.734161 */</span>
		 <span class="mi">13055</span><span class="p">,</span>		<span class="cm">/* B0 = 0.398407 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f540_660[] */</span>
		<span class="mi">28499</span><span class="p">,</span>		<span class="cm">/* A1 = 1.739441 */</span>
		 <span class="o">-</span><span class="mi">31129</span><span class="p">,</span>	<span class="cm">/* A2 = -0.949982 */</span>
		 <span class="o">-</span><span class="mi">849</span><span class="p">,</span>		<span class="cm">/* B2 = -0.025922 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">849</span><span class="p">,</span>		<span class="cm">/* B0 = 0.025922 */</span>
		 <span class="mi">28128</span><span class="p">,</span>		<span class="cm">/* A1 = 1.716797 */</span>
		 <span class="o">-</span><span class="mi">32130</span><span class="p">,</span>	<span class="cm">/* A2 = -0.98056 */</span>
		 <span class="mi">14556</span><span class="p">,</span>		<span class="cm">/* B2 = 0.444214 */</span>
		 <span class="o">-</span><span class="mi">12251</span><span class="p">,</span>	<span class="cm">/* B1 = -0.747772 */</span>
		 <span class="mi">14556</span><span class="p">,</span>		<span class="cm">/* B0 = 0.444244 */</span>
		 <span class="mi">29667</span><span class="p">,</span>		<span class="cm">/* A1 = 1.81073 */</span>
		 <span class="o">-</span><span class="mi">32244</span><span class="p">,</span>	<span class="cm">/* A2 = -0.984039 */</span>
		 <span class="mi">23038</span><span class="p">,</span>		<span class="cm">/* B2 = 0.703064 */</span>
		 <span class="o">-</span><span class="mi">21358</span><span class="p">,</span>	<span class="cm">/* B1 = -1.303589 */</span>
		 <span class="mi">23040</span><span class="p">,</span>		<span class="cm">/* B0 = 0.703125 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f587 */</span>
		<span class="mi">29271</span><span class="p">,</span>		<span class="cm">/* A1 = -1.786560 */</span>
		 <span class="o">-</span><span class="mi">32599</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994873 */</span>
		 <span class="o">-</span><span class="mi">490</span><span class="p">,</span>		<span class="cm">/* B2 = -0.014957 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">490</span><span class="p">,</span>		<span class="cm">/* B0 = 0.014957 */</span>
		 <span class="mi">29246</span><span class="p">,</span>		<span class="cm">/* A1 = -1.785095 */</span>
		 <span class="o">-</span><span class="mi">32700</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997925 */</span>
		 <span class="mi">28961</span><span class="p">,</span>		<span class="cm">/* B2 = 0.883850 */</span>
		 <span class="o">-</span><span class="mi">25796</span><span class="p">,</span>	<span class="cm">/* B1 = -1.574463 */</span>
		 <span class="mi">28961</span><span class="p">,</span>		<span class="cm">/* B0 = 0.883850 */</span>
		 <span class="mi">29383</span><span class="p">,</span>		<span class="cm">/* A1 = -1.793396 */</span>
		 <span class="o">-</span><span class="mi">32700</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997955 */</span>
		 <span class="mi">1299</span><span class="p">,</span>		<span class="cm">/* B2 = 0.039650 */</span>
		 <span class="o">-</span><span class="mi">1169</span><span class="p">,</span>		<span class="cm">/* B1 = -0.071396 */</span>
		 <span class="mi">1299</span><span class="p">,</span>		<span class="cm">/* B0 = 0.039650 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f590 */</span>
		<span class="mi">29230</span><span class="p">,</span>		<span class="cm">/* A1 = -1.784058 */</span>
		 <span class="o">-</span><span class="mi">32584</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994415 */</span>
		 <span class="o">-</span><span class="mi">418</span><span class="p">,</span>		<span class="cm">/* B2 = -0.012757 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">418</span><span class="p">,</span>		<span class="cm">/* B0 = 0.012757 */</span>
		 <span class="mi">29206</span><span class="p">,</span>		<span class="cm">/* A1 = -1.782593 */</span>
		 <span class="o">-</span><span class="mi">32688</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997559 */</span>
		 <span class="mi">36556</span><span class="p">,</span>		<span class="cm">/* B2 = 1.115601 */</span>
		 <span class="o">-</span><span class="mi">32478</span><span class="p">,</span>	<span class="cm">/* B1 = -1.982300 */</span>
		 <span class="mi">36556</span><span class="p">,</span>		<span class="cm">/* B0 = 1.115601 */</span>
		 <span class="mi">29345</span><span class="p">,</span>		<span class="cm">/* A1 = -1.791077 */</span>
		 <span class="o">-</span><span class="mi">32688</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997589 */</span>
		 <span class="mi">897</span><span class="p">,</span>		<span class="cm">/* B2 = 0.027397 */</span>
		 <span class="o">-</span><span class="mi">808</span><span class="p">,</span>		<span class="cm">/* B1 = -0.049334 */</span>
		 <span class="mi">897</span><span class="p">,</span>		<span class="cm">/* B0 = 0.027397 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f600 */</span>
		<span class="mi">29116</span><span class="p">,</span>		<span class="cm">/* A1 = -1.777100 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="o">-</span><span class="mi">165</span><span class="p">,</span>		<span class="cm">/* B2 = -0.005039 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">165</span><span class="p">,</span>		<span class="cm">/* B0 = 0.005039 */</span>
		 <span class="mi">29089</span><span class="p">,</span>		<span class="cm">/* A1 = -1.775452 */</span>
		 <span class="o">-</span><span class="mi">32708</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998199 */</span>
		 <span class="mi">6963</span><span class="p">,</span>		<span class="cm">/* B2 = 0.212494 */</span>
		 <span class="o">-</span><span class="mi">6172</span><span class="p">,</span>		<span class="cm">/* B1 = -0.376770 */</span>
		 <span class="mi">6963</span><span class="p">,</span>		<span class="cm">/* B0 = 0.212494 */</span>
		 <span class="mi">29237</span><span class="p">,</span>		<span class="cm">/* A1 = -1.784485 */</span>
		 <span class="o">-</span><span class="mi">32710</span><span class="p">,</span>	<span class="cm">/* A2 = 0.998230 */</span>
		 <span class="mi">24197</span><span class="p">,</span>		<span class="cm">/* B2 = 0.738464 */</span>
		 <span class="o">-</span><span class="mi">21657</span><span class="p">,</span>	<span class="cm">/* B1 = -1.321899 */</span>
		 <span class="mi">24197</span><span class="p">,</span>		<span class="cm">/* B0 = 0.738464 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f660 */</span>
		<span class="mi">28376</span><span class="p">,</span>		<span class="cm">/* A1 = -1.731934 */</span>
		 <span class="o">-</span><span class="mi">32567</span><span class="p">,</span>	<span class="cm">/* A2 = 0.993896 */</span>
		 <span class="o">-</span><span class="mi">363</span><span class="p">,</span>		<span class="cm">/* B2 = -0.011102 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">363</span><span class="p">,</span>		<span class="cm">/* B0 = 0.011102 */</span>
		 <span class="mi">28337</span><span class="p">,</span>		<span class="cm">/* A1 = -1.729614 */</span>
		 <span class="o">-</span><span class="mi">32683</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997434 */</span>
		 <span class="mi">21766</span><span class="p">,</span>		<span class="cm">/* B2 = 0.664246 */</span>
		 <span class="o">-</span><span class="mi">18761</span><span class="p">,</span>	<span class="cm">/* B1 = -1.145081 */</span>
		 <span class="mi">21766</span><span class="p">,</span>		<span class="cm">/* B0 = 0.664246 */</span>
		 <span class="mi">28513</span><span class="p">,</span>		<span class="cm">/* A1 = -1.740356 */</span>
		 <span class="o">-</span><span class="mi">32686</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997498 */</span>
		 <span class="mi">2509</span><span class="p">,</span>		<span class="cm">/* B2 = 0.076584 */</span>
		 <span class="o">-</span><span class="mi">2196</span><span class="p">,</span>		<span class="cm">/* B1 = -0.134041 */</span>
		 <span class="mi">2509</span><span class="p">,</span>		<span class="cm">/* B0 = 0.076584 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f700 */</span>
		<span class="mi">27844</span><span class="p">,</span>		<span class="cm">/* A1 = -1.699463 */</span>
		 <span class="o">-</span><span class="mi">32563</span><span class="p">,</span>	<span class="cm">/* A2 = 0.993744 */</span>
		 <span class="o">-</span><span class="mi">366</span><span class="p">,</span>		<span class="cm">/* B2 = -0.011187 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">366</span><span class="p">,</span>		<span class="cm">/* B0 = 0.011187 */</span>
		 <span class="mi">27797</span><span class="p">,</span>		<span class="cm">/* A1 = -1.696655 */</span>
		 <span class="o">-</span><span class="mi">32686</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997498 */</span>
		 <span class="mi">22748</span><span class="p">,</span>		<span class="cm">/* B2 = 0.694214 */</span>
		 <span class="o">-</span><span class="mi">19235</span><span class="p">,</span>	<span class="cm">/* B1 = -1.174072 */</span>
		 <span class="mi">22748</span><span class="p">,</span>		<span class="cm">/* B0 = 0.694214 */</span>
		 <span class="mi">27995</span><span class="p">,</span>		<span class="cm">/* A1 = -1.708740 */</span>
		 <span class="o">-</span><span class="mi">32688</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997559 */</span>
		 <span class="mi">2964</span><span class="p">,</span>		<span class="cm">/* B2 = 0.090477 */</span>
		 <span class="o">-</span><span class="mi">2546</span><span class="p">,</span>		<span class="cm">/* B1 = -0.155449 */</span>
		 <span class="mi">2964</span><span class="p">,</span>		<span class="cm">/* B0 = 0.090477 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f740 */</span>
		<span class="mi">27297</span><span class="p">,</span>		<span class="cm">/* A1 = -1.666077 */</span>
		 <span class="o">-</span><span class="mi">32551</span><span class="p">,</span>	<span class="cm">/* A2 = 0.993408 */</span>
		 <span class="o">-</span><span class="mi">345</span><span class="p">,</span>		<span class="cm">/* B2 = -0.010540 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">345</span><span class="p">,</span>		<span class="cm">/* B0 = 0.010540 */</span>
		 <span class="mi">27240</span><span class="p">,</span>		<span class="cm">/* A1 = -1.662598 */</span>
		 <span class="o">-</span><span class="mi">32683</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997406 */</span>
		 <span class="mi">22560</span><span class="p">,</span>		<span class="cm">/* B2 = 0.688477 */</span>
		 <span class="o">-</span><span class="mi">18688</span><span class="p">,</span>	<span class="cm">/* B1 = -1.140625 */</span>
		 <span class="mi">22560</span><span class="p">,</span>		<span class="cm">/* B0 = 0.688477 */</span>
		 <span class="mi">27461</span><span class="p">,</span>		<span class="cm">/* A1 = -1.676147 */</span>
		 <span class="o">-</span><span class="mi">32684</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997467 */</span>
		 <span class="mi">3541</span><span class="p">,</span>		<span class="cm">/* B2 = 0.108086 */</span>
		 <span class="o">-</span><span class="mi">2985</span><span class="p">,</span>		<span class="cm">/* B1 = -0.182220 */</span>
		 <span class="mi">3541</span><span class="p">,</span>		<span class="cm">/* B0 = 0.108086 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f750 */</span>
		<span class="mi">27155</span><span class="p">,</span>		<span class="cm">/* A1 = -1.657410 */</span>
		 <span class="o">-</span><span class="mi">32551</span><span class="p">,</span>	<span class="cm">/* A2 = 0.993408 */</span>
		 <span class="o">-</span><span class="mi">462</span><span class="p">,</span>		<span class="cm">/* B2 = -0.014117 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">462</span><span class="p">,</span>		<span class="cm">/* B0 = 0.014117 */</span>
		 <span class="mi">27097</span><span class="p">,</span>		<span class="cm">/* A1 = -1.653870 */</span>
		 <span class="o">-</span><span class="mi">32683</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997406 */</span>
		 <span class="mi">32495</span><span class="p">,</span>		<span class="cm">/* B2 = 0.991699 */</span>
		 <span class="o">-</span><span class="mi">26776</span><span class="p">,</span>	<span class="cm">/* B1 = -1.634338 */</span>
		 <span class="mi">32495</span><span class="p">,</span>		<span class="cm">/* B0 = 0.991699 */</span>
		 <span class="mi">27321</span><span class="p">,</span>		<span class="cm">/* A1 = -1.667542 */</span>
		 <span class="o">-</span><span class="mi">32684</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997467 */</span>
		 <span class="mi">1835</span><span class="p">,</span>		<span class="cm">/* B2 = 0.056007 */</span>
		 <span class="o">-</span><span class="mi">1539</span><span class="p">,</span>		<span class="cm">/* B1 = -0.093948 */</span>
		 <span class="mi">1835</span><span class="p">,</span>		<span class="cm">/* B0 = 0.056007 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f750_1450[] */</span>
		<span class="mi">19298</span><span class="p">,</span>		<span class="cm">/* A1 = 1.177917 */</span>
		 <span class="o">-</span><span class="mi">24471</span><span class="p">,</span>	<span class="cm">/* A2 = -0.746796 */</span>
		 <span class="o">-</span><span class="mi">4152</span><span class="p">,</span>		<span class="cm">/* B2 = -0.126709 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">4152</span><span class="p">,</span>		<span class="cm">/* B0 = 0.126709 */</span>
		 <span class="mi">12902</span><span class="p">,</span>		<span class="cm">/* A1 = 0.787476 */</span>
		 <span class="o">-</span><span class="mi">29091</span><span class="p">,</span>	<span class="cm">/* A2 = -0.887817 */</span>
		 <span class="mi">12491</span><span class="p">,</span>		<span class="cm">/* B2 = 0.38121 */</span>
		 <span class="o">-</span><span class="mi">1794</span><span class="p">,</span>		<span class="cm">/* B1 = -0.109528 */</span>
		 <span class="mi">12494</span><span class="p">,</span>		<span class="cm">/* B0 = 0.381317 */</span>
		 <span class="mi">26291</span><span class="p">,</span>		<span class="cm">/* A1 = 1.604736 */</span>
		 <span class="o">-</span><span class="mi">30470</span><span class="p">,</span>	<span class="cm">/* A2 = -0.929901 */</span>
		 <span class="mi">28859</span><span class="p">,</span>		<span class="cm">/* B2 = 0.880737 */</span>
		 <span class="o">-</span><span class="mi">26084</span><span class="p">,</span>	<span class="cm">/* B1 = -1.592102 */</span>
		 <span class="mi">28861</span><span class="p">,</span>		<span class="cm">/* B0 = 0.880798 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f770 */</span>
		<span class="mi">26867</span><span class="p">,</span>		<span class="cm">/* A1 = -1.639832 */</span>
		 <span class="o">-</span><span class="mi">32551</span><span class="p">,</span>	<span class="cm">/* A2 = 0.993408 */</span>
		 <span class="o">-</span><span class="mi">123</span><span class="p">,</span>		<span class="cm">/* B2 = -0.003755 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">123</span><span class="p">,</span>		<span class="cm">/* B0 = 0.003755 */</span>
		 <span class="mi">26805</span><span class="p">,</span>		<span class="cm">/* A1 = -1.636108 */</span>
		 <span class="o">-</span><span class="mi">32683</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997406 */</span>
		 <span class="mi">17297</span><span class="p">,</span>		<span class="cm">/* B2 = 0.527863 */</span>
		 <span class="o">-</span><span class="mi">14096</span><span class="p">,</span>	<span class="cm">/* B1 = -0.860382 */</span>
		 <span class="mi">17297</span><span class="p">,</span>		<span class="cm">/* B0 = 0.527863 */</span>
		 <span class="mi">27034</span><span class="p">,</span>		<span class="cm">/* A1 = -1.650085 */</span>
		 <span class="o">-</span><span class="mi">32684</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997467 */</span>
		 <span class="mi">12958</span><span class="p">,</span>		<span class="cm">/* B2 = 0.395477 */</span>
		 <span class="o">-</span><span class="mi">10756</span><span class="p">,</span>	<span class="cm">/* B1 = -0.656525 */</span>
		 <span class="mi">12958</span><span class="p">,</span>		<span class="cm">/* B0 = 0.395477 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f800 */</span>
		<span class="mi">26413</span><span class="p">,</span>		<span class="cm">/* A1 = -1.612122 */</span>
		 <span class="o">-</span><span class="mi">32547</span><span class="p">,</span>	<span class="cm">/* A2 = 0.993286 */</span>
		 <span class="o">-</span><span class="mi">223</span><span class="p">,</span>		<span class="cm">/* B2 = -0.006825 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">223</span><span class="p">,</span>		<span class="cm">/* B0 = 0.006825 */</span>
		 <span class="mi">26342</span><span class="p">,</span>		<span class="cm">/* A1 = -1.607849 */</span>
		 <span class="o">-</span><span class="mi">32686</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997498 */</span>
		 <span class="mi">6391</span><span class="p">,</span>		<span class="cm">/* B2 = 0.195053 */</span>
		 <span class="o">-</span><span class="mi">5120</span><span class="p">,</span>		<span class="cm">/* B1 = -0.312531 */</span>
		 <span class="mi">6391</span><span class="p">,</span>		<span class="cm">/* B0 = 0.195053 */</span>
		 <span class="mi">26593</span><span class="p">,</span>		<span class="cm">/* A1 = -1.623108 */</span>
		 <span class="o">-</span><span class="mi">32688</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997559 */</span>
		 <span class="mi">23681</span><span class="p">,</span>		<span class="cm">/* B2 = 0.722717 */</span>
		 <span class="o">-</span><span class="mi">19328</span><span class="p">,</span>	<span class="cm">/* B1 = -1.179688 */</span>
		 <span class="mi">23681</span><span class="p">,</span>		<span class="cm">/* B0 = 0.722717 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f816 */</span>
		<span class="mi">26168</span><span class="p">,</span>		<span class="cm">/* A1 = -1.597209 */</span>
		 <span class="o">-</span><span class="mi">32528</span><span class="p">,</span>	<span class="cm">/* A2 = 0.992706 */</span>
		 <span class="o">-</span><span class="mi">235</span><span class="p">,</span>		<span class="cm">/* B2 = -0.007182 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">235</span><span class="p">,</span>		<span class="cm">/* B0 = 0.007182 */</span>
		 <span class="mi">26092</span><span class="p">,</span>		<span class="cm">/* A1 = -1.592590 */</span>
		 <span class="o">-</span><span class="mi">32675</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997192 */</span>
		 <span class="mi">20823</span><span class="p">,</span>		<span class="cm">/* B2 = 0.635498 */</span>
		 <span class="o">-</span><span class="mi">16510</span><span class="p">,</span>	<span class="cm">/* B1 = -1.007751 */</span>
		 <span class="mi">20823</span><span class="p">,</span>		<span class="cm">/* B0 = 0.635498 */</span>
		 <span class="mi">26363</span><span class="p">,</span>		<span class="cm">/* A1 = -1.609070 */</span>
		 <span class="o">-</span><span class="mi">32677</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997253 */</span>
		 <span class="mi">6739</span><span class="p">,</span>		<span class="cm">/* B2 = 0.205688 */</span>
		 <span class="o">-</span><span class="mi">5459</span><span class="p">,</span>		<span class="cm">/* B1 = -0.333206 */</span>
		 <span class="mi">6739</span><span class="p">,</span>		<span class="cm">/* B0 = 0.205688 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f850 */</span>
		<span class="mi">25641</span><span class="p">,</span>		<span class="cm">/* A1 = -1.565063 */</span>
		 <span class="o">-</span><span class="mi">32536</span><span class="p">,</span>	<span class="cm">/* A2 = 0.992950 */</span>
		 <span class="o">-</span><span class="mi">121</span><span class="p">,</span>		<span class="cm">/* B2 = -0.003707 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">121</span><span class="p">,</span>		<span class="cm">/* B0 = 0.003707 */</span>
		 <span class="mi">25560</span><span class="p">,</span>		<span class="cm">/* A1 = -1.560059 */</span>
		 <span class="o">-</span><span class="mi">32684</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997437 */</span>
		 <span class="mi">18341</span><span class="p">,</span>		<span class="cm">/* B2 = 0.559753 */</span>
		 <span class="o">-</span><span class="mi">14252</span><span class="p">,</span>	<span class="cm">/* B1 = -0.869904 */</span>
		 <span class="mi">18341</span><span class="p">,</span>		<span class="cm">/* B0 = 0.559753 */</span>
		 <span class="mi">25837</span><span class="p">,</span>		<span class="cm">/* A1 = -1.577026 */</span>
		 <span class="o">-</span><span class="mi">32684</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997467 */</span>
		 <span class="mi">16679</span><span class="p">,</span>		<span class="cm">/* B2 = 0.509003 */</span>
		 <span class="o">-</span><span class="mi">13232</span><span class="p">,</span>	<span class="cm">/* B1 = -0.807648 */</span>
		 <span class="mi">16679</span><span class="p">,</span>		<span class="cm">/* B0 = 0.509003 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f857_1645[] */</span>
		<span class="mi">16415</span><span class="p">,</span>		<span class="cm">/* A1 = 1.001953 */</span>
		 <span class="o">-</span><span class="mi">23669</span><span class="p">,</span>	<span class="cm">/* A2 = -0.722321 */</span>
		 <span class="o">-</span><span class="mi">4549</span><span class="p">,</span>		<span class="cm">/* B2 = -0.138847 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">4549</span><span class="p">,</span>		<span class="cm">/* B0 = 0.138847 */</span>
		 <span class="mi">8456</span><span class="p">,</span>		<span class="cm">/* A1 = 0.516174 */</span>
		 <span class="o">-</span><span class="mi">28996</span><span class="p">,</span>	<span class="cm">/* A2 = -0.884918 */</span>
		 <span class="mi">13753</span><span class="p">,</span>		<span class="cm">/* B2 = 0.419724 */</span>
		 <span class="o">-</span><span class="mi">12</span><span class="p">,</span>		<span class="cm">/* B1 = -0.000763 */</span>
		 <span class="mi">13757</span><span class="p">,</span>		<span class="cm">/* B0 = 0.419846 */</span>
		 <span class="mi">24632</span><span class="p">,</span>		<span class="cm">/* A1 = 1.503418 */</span>
		 <span class="o">-</span><span class="mi">30271</span><span class="p">,</span>	<span class="cm">/* A2 = -0.923828 */</span>
		 <span class="mi">29070</span><span class="p">,</span>		<span class="cm">/* B2 = 0.887146 */</span>
		 <span class="o">-</span><span class="mi">25265</span><span class="p">,</span>	<span class="cm">/* B1 = -1.542114 */</span>
		 <span class="mi">29073</span><span class="p">,</span>		<span class="cm">/* B0 = 0.887268 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f900 */</span>
		<span class="mi">24806</span><span class="p">,</span>		<span class="cm">/* A1 = -1.514099 */</span>
		 <span class="o">-</span><span class="mi">32501</span><span class="p">,</span>	<span class="cm">/* A2 = 0.991852 */</span>
		 <span class="o">-</span><span class="mi">326</span><span class="p">,</span>		<span class="cm">/* B2 = -0.009969 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">326</span><span class="p">,</span>		<span class="cm">/* B0 = 0.009969 */</span>
		 <span class="mi">24709</span><span class="p">,</span>		<span class="cm">/* A1 = -1.508118 */</span>
		 <span class="o">-</span><span class="mi">32659</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996674 */</span>
		 <span class="mi">20277</span><span class="p">,</span>		<span class="cm">/* B2 = 0.618835 */</span>
		 <span class="o">-</span><span class="mi">15182</span><span class="p">,</span>	<span class="cm">/* B1 = -0.926636 */</span>
		 <span class="mi">20277</span><span class="p">,</span>		<span class="cm">/* B0 = 0.618835 */</span>
		 <span class="mi">25022</span><span class="p">,</span>		<span class="cm">/* A1 = -1.527222 */</span>
		 <span class="o">-</span><span class="mi">32661</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996735 */</span>
		 <span class="mi">4320</span><span class="p">,</span>		<span class="cm">/* B2 = 0.131836 */</span>
		 <span class="o">-</span><span class="mi">3331</span><span class="p">,</span>		<span class="cm">/* B1 = -0.203339 */</span>
		 <span class="mi">4320</span><span class="p">,</span>		<span class="cm">/* B0 = 0.131836 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f900_1300[] */</span>
		<span class="mi">19776</span><span class="p">,</span>		<span class="cm">/* A1 = 1.207092 */</span>
		 <span class="o">-</span><span class="mi">27437</span><span class="p">,</span>	<span class="cm">/* A2 = -0.837341 */</span>
		 <span class="o">-</span><span class="mi">2666</span><span class="p">,</span>		<span class="cm">/* B2 = -0.081371 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">2666</span><span class="p">,</span>		<span class="cm">/* B0 = 0.081371 */</span>
		 <span class="mi">16302</span><span class="p">,</span>		<span class="cm">/* A1 = 0.995026 */</span>
		 <span class="o">-</span><span class="mi">30354</span><span class="p">,</span>	<span class="cm">/* A2 = -0.926361 */</span>
		 <span class="mi">10389</span><span class="p">,</span>		<span class="cm">/* B2 = 0.317062 */</span>
		 <span class="o">-</span><span class="mi">3327</span><span class="p">,</span>		<span class="cm">/* B1 = -0.203064 */</span>
		 <span class="mi">10389</span><span class="p">,</span>		<span class="cm">/* B0 = 0.317062 */</span>
		 <span class="mi">24299</span><span class="p">,</span>		<span class="cm">/* A1 = 1.483154 */</span>
		 <span class="o">-</span><span class="mi">30930</span><span class="p">,</span>	<span class="cm">/* A2 = -0.943909 */</span>
		 <span class="mi">25016</span><span class="p">,</span>		<span class="cm">/* B2 = 0.763428 */</span>
		 <span class="o">-</span><span class="mi">21171</span><span class="p">,</span>	<span class="cm">/* B1 = -1.292236 */</span>
		 <span class="mi">25016</span><span class="p">,</span>		<span class="cm">/* B0 = 0.763428 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f935_1215[] */</span>
		<span class="mi">20554</span><span class="p">,</span>		<span class="cm">/* A1 = 1.254517 */</span>
		 <span class="o">-</span><span class="mi">28764</span><span class="p">,</span>	<span class="cm">/* A2 = -0.877838 */</span>
		 <span class="o">-</span><span class="mi">2048</span><span class="p">,</span>		<span class="cm">/* B2 = -0.062515 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">2048</span><span class="p">,</span>		<span class="cm">/* B0 = 0.062515 */</span>
		 <span class="mi">18209</span><span class="p">,</span>		<span class="cm">/* A1 = 1.11145 */</span>
		 <span class="o">-</span><span class="mi">30951</span><span class="p">,</span>	<span class="cm">/* A2 = -0.94458 */</span>
		 <span class="mi">9390</span><span class="p">,</span>		<span class="cm">/* B2 = 0.286575 */</span>
		 <span class="o">-</span><span class="mi">3955</span><span class="p">,</span>		<span class="cm">/* B1 = -0.241455 */</span>
		 <span class="mi">9390</span><span class="p">,</span>		<span class="cm">/* B0 = 0.286575 */</span>
		 <span class="mi">23902</span><span class="p">,</span>		<span class="cm">/* A1 = 1.458923 */</span>
		 <span class="o">-</span><span class="mi">31286</span><span class="p">,</span>	<span class="cm">/* A2 = -0.954803 */</span>
		 <span class="mi">23252</span><span class="p">,</span>		<span class="cm">/* B2 = 0.709595 */</span>
		 <span class="o">-</span><span class="mi">19132</span><span class="p">,</span>	<span class="cm">/* B1 = -1.167725 */</span>
		 <span class="mi">23252</span><span class="p">,</span>		<span class="cm">/* B0 = 0.709595 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f941_1477[] */</span>
		<span class="mi">17543</span><span class="p">,</span>		<span class="cm">/* A1 = 1.07074 */</span>
		 <span class="o">-</span><span class="mi">26220</span><span class="p">,</span>	<span class="cm">/* A2 = -0.800201 */</span>
		 <span class="o">-</span><span class="mi">3298</span><span class="p">,</span>		<span class="cm">/* B2 = -0.100647 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">3298</span><span class="p">,</span>		<span class="cm">/* B0 = 0.100647 */</span>
		 <span class="mi">12423</span><span class="p">,</span>		<span class="cm">/* A1 = 0.75827 */</span>
		 <span class="o">-</span><span class="mi">30036</span><span class="p">,</span>	<span class="cm">/* A2 = -0.916626 */</span>
		 <span class="mi">12651</span><span class="p">,</span>		<span class="cm">/* B2 = 0.386078 */</span>
		 <span class="o">-</span><span class="mi">2444</span><span class="p">,</span>		<span class="cm">/* B1 = -0.14917 */</span>
		 <span class="mi">12653</span><span class="p">,</span>		<span class="cm">/* B0 = 0.386154 */</span>
		 <span class="mi">23518</span><span class="p">,</span>		<span class="cm">/* A1 = 1.435425 */</span>
		 <span class="o">-</span><span class="mi">30745</span><span class="p">,</span>	<span class="cm">/* A2 = -0.938293 */</span>
		 <span class="mi">27282</span><span class="p">,</span>		<span class="cm">/* B2 = 0.832581 */</span>
		 <span class="o">-</span><span class="mi">22529</span><span class="p">,</span>	<span class="cm">/* B1 = -1.375122 */</span>
		 <span class="mi">27286</span><span class="p">,</span>		<span class="cm">/* B0 = 0.832703 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f942 */</span>
		<span class="mi">24104</span><span class="p">,</span>		<span class="cm">/* A1 = -1.471252 */</span>
		 <span class="o">-</span><span class="mi">32507</span><span class="p">,</span>	<span class="cm">/* A2 = 0.992065 */</span>
		 <span class="o">-</span><span class="mi">351</span><span class="p">,</span>		<span class="cm">/* B2 = -0.010722 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">351</span><span class="p">,</span>		<span class="cm">/* B0 = 0.010722 */</span>
		 <span class="mi">23996</span><span class="p">,</span>		<span class="cm">/* A1 = -1.464600 */</span>
		 <span class="o">-</span><span class="mi">32671</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997040 */</span>
		 <span class="mi">22848</span><span class="p">,</span>		<span class="cm">/* B2 = 0.697266 */</span>
		 <span class="o">-</span><span class="mi">16639</span><span class="p">,</span>	<span class="cm">/* B1 = -1.015564 */</span>
		 <span class="mi">22848</span><span class="p">,</span>		<span class="cm">/* B0 = 0.697266 */</span>
		 <span class="mi">24332</span><span class="p">,</span>		<span class="cm">/* A1 = -1.485168 */</span>
		 <span class="o">-</span><span class="mi">32673</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997101 */</span>
		 <span class="mi">4906</span><span class="p">,</span>		<span class="cm">/* B2 = 0.149727 */</span>
		 <span class="o">-</span><span class="mi">3672</span><span class="p">,</span>		<span class="cm">/* B1 = -0.224174 */</span>
		 <span class="mi">4906</span><span class="p">,</span>		<span class="cm">/* B0 = 0.149727 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f950 */</span>
		<span class="mi">23967</span><span class="p">,</span>		<span class="cm">/* A1 = -1.462830 */</span>
		 <span class="o">-</span><span class="mi">32507</span><span class="p">,</span>	<span class="cm">/* A2 = 0.992065 */</span>
		 <span class="o">-</span><span class="mi">518</span><span class="p">,</span>		<span class="cm">/* B2 = -0.015821 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">518</span><span class="p">,</span>		<span class="cm">/* B0 = 0.015821 */</span>
		 <span class="mi">23856</span><span class="p">,</span>		<span class="cm">/* A1 = -1.456055 */</span>
		 <span class="o">-</span><span class="mi">32671</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997040 */</span>
		 <span class="mi">26287</span><span class="p">,</span>		<span class="cm">/* B2 = 0.802246 */</span>
		 <span class="o">-</span><span class="mi">19031</span><span class="p">,</span>	<span class="cm">/* B1 = -1.161560 */</span>
		 <span class="mi">26287</span><span class="p">,</span>		<span class="cm">/* B0 = 0.802246 */</span>
		 <span class="mi">24195</span><span class="p">,</span>		<span class="cm">/* A1 = -1.476746 */</span>
		 <span class="o">-</span><span class="mi">32673</span><span class="p">,</span>	<span class="cm">/* A2 = 0.997101 */</span>
		 <span class="mi">2890</span><span class="p">,</span>		<span class="cm">/* B2 = 0.088196 */</span>
		 <span class="o">-</span><span class="mi">2151</span><span class="p">,</span>		<span class="cm">/* B1 = -0.131317 */</span>
		 <span class="mi">2890</span><span class="p">,</span>		<span class="cm">/* B0 = 0.088196 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f950_1400[] */</span>
		<span class="mi">18294</span><span class="p">,</span>		<span class="cm">/* A1 = 1.116638 */</span>
		 <span class="o">-</span><span class="mi">26962</span><span class="p">,</span>	<span class="cm">/* A2 = -0.822845 */</span>
		 <span class="o">-</span><span class="mi">2914</span><span class="p">,</span>		<span class="cm">/* B2 = -0.088936 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">2914</span><span class="p">,</span>		<span class="cm">/* B0 = 0.088936 */</span>
		 <span class="mi">14119</span><span class="p">,</span>		<span class="cm">/* A1 = 0.861786 */</span>
		 <span class="o">-</span><span class="mi">30227</span><span class="p">,</span>	<span class="cm">/* A2 = -0.922455 */</span>
		 <span class="mi">11466</span><span class="p">,</span>		<span class="cm">/* B2 = 0.349945 */</span>
		 <span class="o">-</span><span class="mi">2833</span><span class="p">,</span>		<span class="cm">/* B1 = -0.172943 */</span>
		 <span class="mi">11466</span><span class="p">,</span>		<span class="cm">/* B0 = 0.349945 */</span>
		 <span class="mi">23431</span><span class="p">,</span>		<span class="cm">/* A1 = 1.430115 */</span>
		 <span class="o">-</span><span class="mi">30828</span><span class="p">,</span>	<span class="cm">/* A2 = -0.940796 */</span>
		 <span class="mi">25331</span><span class="p">,</span>		<span class="cm">/* B2 = 0.773071 */</span>
		 <span class="o">-</span><span class="mi">20911</span><span class="p">,</span>	<span class="cm">/* B1 = -1.276367 */</span>
		 <span class="mi">25331</span><span class="p">,</span>		<span class="cm">/* B0 = 0.773071 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f975 */</span>
		<span class="mi">23521</span><span class="p">,</span>		<span class="cm">/* A1 = -1.435608 */</span>
		 <span class="o">-</span><span class="mi">32489</span><span class="p">,</span>	<span class="cm">/* A2 = 0.991516 */</span>
		 <span class="o">-</span><span class="mi">193</span><span class="p">,</span>		<span class="cm">/* B2 = -0.005915 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">193</span><span class="p">,</span>		<span class="cm">/* B0 = 0.005915 */</span>
		 <span class="mi">23404</span><span class="p">,</span>		<span class="cm">/* A1 = -1.428467 */</span>
		 <span class="o">-</span><span class="mi">32655</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996582 */</span>
		 <span class="mi">17740</span><span class="p">,</span>		<span class="cm">/* B2 = 0.541412 */</span>
		 <span class="o">-</span><span class="mi">12567</span><span class="p">,</span>	<span class="cm">/* B1 = -0.767029 */</span>
		 <span class="mi">17740</span><span class="p">,</span>		<span class="cm">/* B0 = 0.541412 */</span>
		 <span class="mi">23753</span><span class="p">,</span>		<span class="cm">/* A1 = -1.449829 */</span>
		 <span class="o">-</span><span class="mi">32657</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996613 */</span>
		 <span class="mi">9090</span><span class="p">,</span>		<span class="cm">/* B2 = 0.277405 */</span>
		 <span class="o">-</span><span class="mi">6662</span><span class="p">,</span>		<span class="cm">/* B1 = -0.406647 */</span>
		 <span class="mi">9090</span><span class="p">,</span>		<span class="cm">/* B0 = 0.277405 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1000 */</span>
		<span class="mi">23071</span><span class="p">,</span>		<span class="cm">/* A1 = -1.408203 */</span>
		 <span class="o">-</span><span class="mi">32489</span><span class="p">,</span>	<span class="cm">/* A2 = 0.991516 */</span>
		 <span class="o">-</span><span class="mi">293</span><span class="p">,</span>		<span class="cm">/* B2 = -0.008965 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">293</span><span class="p">,</span>		<span class="cm">/* B0 = 0.008965 */</span>
		 <span class="mi">22951</span><span class="p">,</span>		<span class="cm">/* A1 = -1.400818 */</span>
		 <span class="o">-</span><span class="mi">32655</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996582 */</span>
		 <span class="mi">5689</span><span class="p">,</span>		<span class="cm">/* B2 = 0.173645 */</span>
		 <span class="o">-</span><span class="mi">3951</span><span class="p">,</span>		<span class="cm">/* B1 = -0.241150 */</span>
		 <span class="mi">5689</span><span class="p">,</span>		<span class="cm">/* B0 = 0.173645 */</span>
		 <span class="mi">23307</span><span class="p">,</span>		<span class="cm">/* A1 = -1.422607 */</span>
		 <span class="o">-</span><span class="mi">32657</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996613 */</span>
		 <span class="mi">18692</span><span class="p">,</span>		<span class="cm">/* B2 = 0.570435 */</span>
		 <span class="o">-</span><span class="mi">13447</span><span class="p">,</span>	<span class="cm">/* B1 = -0.820770 */</span>
		 <span class="mi">18692</span><span class="p">,</span>		<span class="cm">/* B0 = 0.570435 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1020 */</span>
		<span class="mi">22701</span><span class="p">,</span>		<span class="cm">/* A1 = -1.385620 */</span>
		 <span class="o">-</span><span class="mi">32474</span><span class="p">,</span>	<span class="cm">/* A2 = 0.991058 */</span>
		 <span class="o">-</span><span class="mi">292</span><span class="p">,</span>		<span class="cm">/* B2 = -0.008933 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/*163840      , B1 = 10.000000 */</span>
		 <span class="mi">292</span><span class="p">,</span>		<span class="cm">/* B0 = 0.008933 */</span>
		 <span class="mi">22564</span><span class="p">,</span>		<span class="cm">/* A1 = -1.377258 */</span>
		 <span class="o">-</span><span class="mi">32655</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996552 */</span>
		 <span class="mi">20756</span><span class="p">,</span>		<span class="cm">/* B2 = 0.633423 */</span>
		 <span class="o">-</span><span class="mi">14176</span><span class="p">,</span>	<span class="cm">/* B1 = -0.865295 */</span>
		 <span class="mi">20756</span><span class="p">,</span>		<span class="cm">/* B0 = 0.633423 */</span>
		 <span class="mi">22960</span><span class="p">,</span>		<span class="cm">/* A1 = -1.401428 */</span>
		 <span class="o">-</span><span class="mi">32657</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996613 */</span>
		 <span class="mi">6520</span><span class="p">,</span>		<span class="cm">/* B2 = 0.198990 */</span>
		 <span class="o">-</span><span class="mi">4619</span><span class="p">,</span>		<span class="cm">/* B1 = -0.281937 */</span>
		 <span class="mi">6520</span><span class="p">,</span>		<span class="cm">/* B0 = 0.198990 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1050 */</span>
		<span class="mi">22142</span><span class="p">,</span>		<span class="cm">/* A1 = -1.351501 */</span>
		 <span class="o">-</span><span class="mi">32474</span><span class="p">,</span>	<span class="cm">/* A2 = 0.991058 */</span>
		 <span class="o">-</span><span class="mi">147</span><span class="p">,</span>		<span class="cm">/* B2 = -0.004493 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">147</span><span class="p">,</span>		<span class="cm">/* B0 = 0.004493 */</span>
		 <span class="mi">22000</span><span class="p">,</span>		<span class="cm">/* A1 = -1.342834 */</span>
		 <span class="o">-</span><span class="mi">32655</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996552 */</span>
		 <span class="mi">15379</span><span class="p">,</span>		<span class="cm">/* B2 = 0.469360 */</span>
		 <span class="o">-</span><span class="mi">10237</span><span class="p">,</span>	<span class="cm">/* B1 = -0.624847 */</span>
		 <span class="mi">15379</span><span class="p">,</span>		<span class="cm">/* B0 = 0.469360 */</span>
		 <span class="mi">22406</span><span class="p">,</span>		<span class="cm">/* A1 = -1.367554 */</span>
		 <span class="o">-</span><span class="mi">32657</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996613 */</span>
		 <span class="mi">17491</span><span class="p">,</span>		<span class="cm">/* B2 = 0.533783 */</span>
		 <span class="o">-</span><span class="mi">12096</span><span class="p">,</span>	<span class="cm">/* B1 = -0.738312 */</span>
		 <span class="mi">17491</span><span class="p">,</span>		<span class="cm">/* B0 = 0.533783 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1100_1750[] */</span>
		<span class="mi">12973</span><span class="p">,</span>		<span class="cm">/* A1 = 0.79184 */</span>
		 <span class="o">-</span><span class="mi">24916</span><span class="p">,</span>	<span class="cm">/* A2 = -0.760376 */</span>
		 <span class="mi">6655</span><span class="p">,</span>		<span class="cm">/* B2 = 0.203102 */</span>
		 <span class="mi">367</span><span class="p">,</span>		<span class="cm">/* B1 = 0.0224 */</span>
		 <span class="mi">6657</span><span class="p">,</span>		<span class="cm">/* B0 = 0.203171 */</span>
		 <span class="mi">5915</span><span class="p">,</span>		<span class="cm">/* A1 = 0.361053 */</span>
		 <span class="o">-</span><span class="mi">29560</span><span class="p">,</span>	<span class="cm">/* A2 = -0.90213 */</span>
		 <span class="o">-</span><span class="mi">7777</span><span class="p">,</span>		<span class="cm">/* B2 = -0.23735 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">7777</span><span class="p">,</span>		<span class="cm">/* B0 = 0.23735 */</span>
		 <span class="mi">20510</span><span class="p">,</span>		<span class="cm">/* A1 = 1.251892 */</span>
		 <span class="o">-</span><span class="mi">30260</span><span class="p">,</span>	<span class="cm">/* A2 = -0.923462 */</span>
		 <span class="mi">26662</span><span class="p">,</span>		<span class="cm">/* B2 = 0.81366 */</span>
		 <span class="o">-</span><span class="mi">20573</span><span class="p">,</span>	<span class="cm">/* B1 = -1.255737 */</span>
		 <span class="mi">26668</span><span class="p">,</span>		<span class="cm">/* B0 = 0.813843 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1140 */</span>
		<span class="mi">20392</span><span class="p">,</span>		<span class="cm">/* A1 = -1.244629 */</span>
		 <span class="o">-</span><span class="mi">32460</span><span class="p">,</span>	<span class="cm">/* A2 = 0.990601 */</span>
		 <span class="o">-</span><span class="mi">270</span><span class="p">,</span>		<span class="cm">/* B2 = -0.008240 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">270</span><span class="p">,</span>		<span class="cm">/* B0 = 0.008240 */</span>
		 <span class="mi">20218</span><span class="p">,</span>		<span class="cm">/* A1 = -1.234009 */</span>
		 <span class="o">-</span><span class="mi">32655</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996582 */</span>
		 <span class="mi">21337</span><span class="p">,</span>		<span class="cm">/* B2 = 0.651154 */</span>
		 <span class="o">-</span><span class="mi">13044</span><span class="p">,</span>	<span class="cm">/* B1 = -0.796143 */</span>
		 <span class="mi">21337</span><span class="p">,</span>		<span class="cm">/* B0 = 0.651154 */</span>
		 <span class="mi">20684</span><span class="p">,</span>		<span class="cm">/* A1 = -1.262512 */</span>
		 <span class="o">-</span><span class="mi">32657</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996643 */</span>
		 <span class="mi">8572</span><span class="p">,</span>		<span class="cm">/* B2 = 0.261612 */</span>
		 <span class="o">-</span><span class="mi">5476</span><span class="p">,</span>		<span class="cm">/* B1 = -0.334244 */</span>
		 <span class="mi">8572</span><span class="p">,</span>		<span class="cm">/* B0 = 0.261612 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1200 */</span>
		<span class="mi">19159</span><span class="p">,</span>		<span class="cm">/* A1 = -1.169373 */</span>
		 <span class="o">-</span><span class="mi">32456</span><span class="p">,</span>	<span class="cm">/* A2 = 0.990509 */</span>
		 <span class="o">-</span><span class="mi">335</span><span class="p">,</span>		<span class="cm">/* B2 = -0.010252 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">335</span><span class="p">,</span>		<span class="cm">/* B0 = 0.010252 */</span>
		 <span class="mi">18966</span><span class="p">,</span>		<span class="cm">/* A1 = -1.157593 */</span>
		 <span class="o">-</span><span class="mi">32661</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996735 */</span>
		 <span class="mi">6802</span><span class="p">,</span>		<span class="cm">/* B2 = 0.207588 */</span>
		 <span class="o">-</span><span class="mi">3900</span><span class="p">,</span>		<span class="cm">/* B1 = -0.238098 */</span>
		 <span class="mi">6802</span><span class="p">,</span>		<span class="cm">/* B0 = 0.207588 */</span>
		 <span class="mi">19467</span><span class="p">,</span>		<span class="cm">/* A1 = -1.188232 */</span>
		 <span class="o">-</span><span class="mi">32661</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996765 */</span>
		 <span class="mi">25035</span><span class="p">,</span>		<span class="cm">/* B2 = 0.764008 */</span>
		 <span class="o">-</span><span class="mi">15049</span><span class="p">,</span>	<span class="cm">/* B1 = -0.918579 */</span>
		 <span class="mi">25035</span><span class="p">,</span>		<span class="cm">/* B0 = 0.764008 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1209 */</span>
		<span class="mi">18976</span><span class="p">,</span>		<span class="cm">/* A1 = -1.158264 */</span>
		 <span class="o">-</span><span class="mi">32439</span><span class="p">,</span>	<span class="cm">/* A2 = 0.989990 */</span>
		 <span class="o">-</span><span class="mi">183</span><span class="p">,</span>		<span class="cm">/* B2 = -0.005588 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">183</span><span class="p">,</span>		<span class="cm">/* B0 = 0.005588 */</span>
		 <span class="mi">18774</span><span class="p">,</span>		<span class="cm">/* A1 = -1.145874 */</span>
		 <span class="o">-</span><span class="mi">32650</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996429 */</span>
		 <span class="mi">15468</span><span class="p">,</span>		<span class="cm">/* B2 = 0.472076 */</span>
		 <span class="o">-</span><span class="mi">8768</span><span class="p">,</span>		<span class="cm">/* B1 = -0.535217 */</span>
		 <span class="mi">15468</span><span class="p">,</span>		<span class="cm">/* B0 = 0.472076 */</span>
		 <span class="mi">19300</span><span class="p">,</span>		<span class="cm">/* A1 = -1.177979 */</span>
		 <span class="o">-</span><span class="mi">32652</span><span class="p">,</span>	<span class="cm">/* A2 = 0.996490 */</span>
		 <span class="mi">19840</span><span class="p">,</span>		<span class="cm">/* B2 = 0.605499 */</span>
		 <span class="o">-</span><span class="mi">11842</span><span class="p">,</span>	<span class="cm">/* B1 = -0.722809 */</span>
		 <span class="mi">19840</span><span class="p">,</span>		<span class="cm">/* B0 = 0.605499 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1330 */</span>
		<span class="mi">16357</span><span class="p">,</span>		<span class="cm">/* A1 = -0.998413 */</span>
		 <span class="o">-</span><span class="mi">32368</span><span class="p">,</span>	<span class="cm">/* A2 = 0.987793 */</span>
		 <span class="o">-</span><span class="mi">217</span><span class="p">,</span>		<span class="cm">/* B2 = -0.006652 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">217</span><span class="p">,</span>		<span class="cm">/* B0 = 0.006652 */</span>
		 <span class="mi">16107</span><span class="p">,</span>		<span class="cm">/* A1 = -0.983126 */</span>
		 <span class="o">-</span><span class="mi">32601</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994904 */</span>
		 <span class="mi">11602</span><span class="p">,</span>		<span class="cm">/* B2 = 0.354065 */</span>
		 <span class="o">-</span><span class="mi">5555</span><span class="p">,</span>		<span class="cm">/* B1 = -0.339111 */</span>
		 <span class="mi">11602</span><span class="p">,</span>		<span class="cm">/* B0 = 0.354065 */</span>
		 <span class="mi">16722</span><span class="p">,</span>		<span class="cm">/* A1 = -1.020630 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="mi">15574</span><span class="p">,</span>		<span class="cm">/* B2 = 0.475311 */</span>
		 <span class="o">-</span><span class="mi">8176</span><span class="p">,</span>		<span class="cm">/* B1 = -0.499069 */</span>
		 <span class="mi">15574</span><span class="p">,</span>		<span class="cm">/* B0 = 0.475311 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1336 */</span>
		<span class="mi">16234</span><span class="p">,</span>		<span class="cm">/* A1 = -0.990875 */</span>
		 <span class="mi">32404</span><span class="p">,</span>		<span class="cm">/* A2 = -0.988922 */</span>
		 <span class="o">-</span><span class="mi">193</span><span class="p">,</span>		<span class="cm">/* B2 = -0.005908 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">193</span><span class="p">,</span>		<span class="cm">/* B0 = 0.005908 */</span>
		 <span class="mi">15986</span><span class="p">,</span>		<span class="cm">/* A1 = -0.975769 */</span>
		 <span class="o">-</span><span class="mi">32632</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995880 */</span>
		 <span class="mi">18051</span><span class="p">,</span>		<span class="cm">/* B2 = 0.550903 */</span>
		 <span class="o">-</span><span class="mi">8658</span><span class="p">,</span>		<span class="cm">/* B1 = -0.528473 */</span>
		 <span class="mi">18051</span><span class="p">,</span>		<span class="cm">/* B0 = 0.550903 */</span>
		 <span class="mi">16591</span><span class="p">,</span>		<span class="cm">/* A1 = -1.012695 */</span>
		 <span class="o">-</span><span class="mi">32634</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995941 */</span>
		 <span class="mi">15736</span><span class="p">,</span>		<span class="cm">/* B2 = 0.480240 */</span>
		 <span class="o">-</span><span class="mi">8125</span><span class="p">,</span>		<span class="cm">/* B1 = -0.495926 */</span>
		 <span class="mi">15736</span><span class="p">,</span>		<span class="cm">/* B0 = 0.480240 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1366 */</span>
		<span class="mi">15564</span><span class="p">,</span>		<span class="cm">/* A1 = -0.949982 */</span>
		 <span class="o">-</span><span class="mi">32404</span><span class="p">,</span>	<span class="cm">/* A2 = 0.988922 */</span>
		 <span class="o">-</span><span class="mi">269</span><span class="p">,</span>		<span class="cm">/* B2 = -0.008216 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">269</span><span class="p">,</span>		<span class="cm">/* B0 = 0.008216 */</span>
		 <span class="mi">15310</span><span class="p">,</span>		<span class="cm">/* A1 = -0.934479 */</span>
		 <span class="o">-</span><span class="mi">32632</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995880 */</span>
		 <span class="mi">10815</span><span class="p">,</span>		<span class="cm">/* B2 = 0.330063 */</span>
		 <span class="o">-</span><span class="mi">4962</span><span class="p">,</span>		<span class="cm">/* B1 = -0.302887 */</span>
		 <span class="mi">10815</span><span class="p">,</span>		<span class="cm">/* B0 = 0.330063 */</span>
		 <span class="mi">15924</span><span class="p">,</span>		<span class="cm">/* A1 = -0.971924 */</span>
		 <span class="o">-</span><span class="mi">32634</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995941 */</span>
		 <span class="mi">18880</span><span class="p">,</span>		<span class="cm">/* B2 = 0.576172 */</span>
		 <span class="o">-</span><span class="mi">9364</span><span class="p">,</span>		<span class="cm">/* B1 = -0.571594 */</span>
		 <span class="mi">18880</span><span class="p">,</span>		<span class="cm">/* B0 = 0.576172 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1380 */</span>
		<span class="mi">15247</span><span class="p">,</span>		<span class="cm">/* A1 = -0.930603 */</span>
		 <span class="o">-</span><span class="mi">32397</span><span class="p">,</span>	<span class="cm">/* A2 = 0.988708 */</span>
		 <span class="o">-</span><span class="mi">244</span><span class="p">,</span>		<span class="cm">/* B2 = -0.007451 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">244</span><span class="p">,</span>		<span class="cm">/* B0 = 0.007451 */</span>
		 <span class="mi">14989</span><span class="p">,</span>		<span class="cm">/* A1 = -0.914886 */</span>
		 <span class="o">-</span><span class="mi">32627</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995697 */</span>
		 <span class="mi">18961</span><span class="p">,</span>		<span class="cm">/* B2 = 0.578644 */</span>
		 <span class="o">-</span><span class="mi">8498</span><span class="p">,</span>		<span class="cm">/* B1 = -0.518707 */</span>
		 <span class="mi">18961</span><span class="p">,</span>		<span class="cm">/* B0 = 0.578644 */</span>
		 <span class="mi">15608</span><span class="p">,</span>		<span class="cm">/* A1 = -0.952667 */</span>
		 <span class="o">-</span><span class="mi">32628</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995758 */</span>
		 <span class="mi">11145</span><span class="p">,</span>		<span class="cm">/* B2 = 0.340134 */</span>
		 <span class="o">-</span><span class="mi">5430</span><span class="p">,</span>		<span class="cm">/* B1 = -0.331467 */</span>
		 <span class="mi">11145</span><span class="p">,</span>		<span class="cm">/* B0 = 0.340134 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1400 */</span>
		<span class="mi">14780</span><span class="p">,</span>		<span class="cm">/* A1 = -0.902130 */</span>
		 <span class="o">-</span><span class="mi">32393</span><span class="p">,</span>	<span class="cm">/* A2 = 0.988586 */</span>
		 <span class="o">-</span><span class="mi">396</span><span class="p">,</span>		<span class="cm">/* B2 = -0.012086 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">396</span><span class="p">,</span>		<span class="cm">/* B0 = 0.012086 */</span>
		 <span class="mi">14510</span><span class="p">,</span>		<span class="cm">/* A1 = -0.885651 */</span>
		 <span class="o">-</span><span class="mi">32630</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995819 */</span>
		 <span class="mi">6326</span><span class="p">,</span>		<span class="cm">/* B2 = 0.193069 */</span>
		 <span class="o">-</span><span class="mi">2747</span><span class="p">,</span>		<span class="cm">/* B1 = -0.167671 */</span>
		 <span class="mi">6326</span><span class="p">,</span>		<span class="cm">/* B0 = 0.193069 */</span>
		 <span class="mi">15154</span><span class="p">,</span>		<span class="cm">/* A1 = -0.924957 */</span>
		 <span class="o">-</span><span class="mi">32632</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995850 */</span>
		 <span class="mi">23235</span><span class="p">,</span>		<span class="cm">/* B2 = 0.709076 */</span>
		 <span class="o">-</span><span class="mi">10983</span><span class="p">,</span>	<span class="cm">/* B1 = -0.670380 */</span>
		 <span class="mi">23235</span><span class="p">,</span>		<span class="cm">/* B0 = 0.709076 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1477 */</span>
		<span class="mi">13005</span><span class="p">,</span>		<span class="cm">/* A1 = -0.793793 */</span>
		 <span class="o">-</span><span class="mi">32368</span><span class="p">,</span>	<span class="cm">/* A2 = 0.987823 */</span>
		 <span class="o">-</span><span class="mi">500</span><span class="p">,</span>		<span class="cm">/* B2 = -0.015265 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">500</span><span class="p">,</span>		<span class="cm">/* B0 = 0.015265 */</span>
		 <span class="mi">12708</span><span class="p">,</span>		<span class="cm">/* A1 = -0.775665 */</span>
		 <span class="o">-</span><span class="mi">32615</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995331 */</span>
		 <span class="mi">11420</span><span class="p">,</span>		<span class="cm">/* B2 = 0.348526 */</span>
		 <span class="o">-</span><span class="mi">4306</span><span class="p">,</span>		<span class="cm">/* B1 = -0.262833 */</span>
		 <span class="mi">11420</span><span class="p">,</span>		<span class="cm">/* B0 = 0.348526 */</span>
		 <span class="mi">13397</span><span class="p">,</span>		<span class="cm">/* A1 = -0.817688 */</span>
		 <span class="o">-</span><span class="mi">32615</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995361 */</span>
		 <span class="mi">9454</span><span class="p">,</span>		<span class="cm">/* B2 = 0.288528 */</span>
		 <span class="o">-</span><span class="mi">3981</span><span class="p">,</span>		<span class="cm">/* B1 = -0.243027 */</span>
		 <span class="mi">9454</span><span class="p">,</span>		<span class="cm">/* B0 = 0.288528 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1600 */</span>
		<span class="mi">10046</span><span class="p">,</span>		<span class="cm">/* A1 = -0.613190 */</span>
		 <span class="o">-</span><span class="mi">32331</span><span class="p">,</span>	<span class="cm">/* A2 = 0.986694 */</span>
		 <span class="o">-</span><span class="mi">455</span><span class="p">,</span>		<span class="cm">/* B2 = -0.013915 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">455</span><span class="p">,</span>		<span class="cm">/* B0 = 0.013915 */</span>
		 <span class="mi">9694</span><span class="p">,</span>		<span class="cm">/* A1 = -0.591705 */</span>
		 <span class="o">-</span><span class="mi">32601</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994934 */</span>
		 <span class="mi">6023</span><span class="p">,</span>		<span class="cm">/* B2 = 0.183815 */</span>
		 <span class="o">-</span><span class="mi">1708</span><span class="p">,</span>		<span class="cm">/* B1 = -0.104279 */</span>
		 <span class="mi">6023</span><span class="p">,</span>		<span class="cm">/* B0 = 0.183815 */</span>
		 <span class="mi">10478</span><span class="p">,</span>		<span class="cm">/* A1 = -0.639587 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="mi">22031</span><span class="p">,</span>		<span class="cm">/* B2 = 0.672333 */</span>
		 <span class="o">-</span><span class="mi">7342</span><span class="p">,</span>		<span class="cm">/* B1 = -0.448151 */</span>
		 <span class="mi">22031</span><span class="p">,</span>		<span class="cm">/* B0 = 0.672333 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1633_1638[] */</span>
		<span class="mi">9181</span><span class="p">,</span>		<span class="cm">/* A1 = 0.560394 */</span>
		 <span class="o">-</span><span class="mi">32256</span><span class="p">,</span>	<span class="cm">/* A2 = -0.984375 */</span>
		 <span class="o">-</span><span class="mi">556</span><span class="p">,</span>		<span class="cm">/* B2 = -0.016975 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0 */</span>
		 <span class="mi">556</span><span class="p">,</span>		<span class="cm">/* B0 = 0.016975 */</span>
		 <span class="mi">8757</span><span class="p">,</span>		<span class="cm">/* A1 = 0.534515 */</span>
		 <span class="o">-</span><span class="mi">32574</span><span class="p">,</span>	<span class="cm">/* A2 = -0.99408 */</span>
		 <span class="mi">8443</span><span class="p">,</span>		<span class="cm">/* B2 = 0.25769 */</span>
		 <span class="o">-</span><span class="mi">2135</span><span class="p">,</span>		<span class="cm">/* B1 = -0.130341 */</span>
		 <span class="mi">8443</span><span class="p">,</span>		<span class="cm">/* B0 = 0.25769 */</span>
		 <span class="mi">9691</span><span class="p">,</span>		<span class="cm">/* A1 = 0.591522 */</span>
		 <span class="o">-</span><span class="mi">32574</span><span class="p">,</span>	<span class="cm">/* A2 = -0.99411 */</span>
		 <span class="mi">15446</span><span class="p">,</span>		<span class="cm">/* B2 = 0.471375 */</span>
		 <span class="o">-</span><span class="mi">4809</span><span class="p">,</span>		<span class="cm">/* B1 = -0.293579 */</span>
		 <span class="mi">15446</span><span class="p">,</span>		<span class="cm">/* B0 = 0.471375 */</span>
		 <span class="mi">7</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1800 */</span>
		<span class="mi">5076</span><span class="p">,</span>		<span class="cm">/* A1 = -0.309875 */</span>
		 <span class="o">-</span><span class="mi">32304</span><span class="p">,</span>	<span class="cm">/* A2 = 0.985840 */</span>
		 <span class="o">-</span><span class="mi">508</span><span class="p">,</span>		<span class="cm">/* B2 = -0.015503 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">508</span><span class="p">,</span>		<span class="cm">/* B0 = 0.015503 */</span>
		 <span class="mi">4646</span><span class="p">,</span>		<span class="cm">/* A1 = -0.283600 */</span>
		 <span class="o">-</span><span class="mi">32605</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995026 */</span>
		 <span class="mi">6742</span><span class="p">,</span>		<span class="cm">/* B2 = 0.205780 */</span>
		 <span class="o">-</span><span class="mi">878</span><span class="p">,</span>		<span class="cm">/* B1 = -0.053635 */</span>
		 <span class="mi">6742</span><span class="p">,</span>		<span class="cm">/* B0 = 0.205780 */</span>
		 <span class="mi">5552</span><span class="p">,</span>		<span class="cm">/* A1 = -0.338928 */</span>
		 <span class="o">-</span><span class="mi">32605</span><span class="p">,</span>	<span class="cm">/* A2 = 0.995056 */</span>
		 <span class="mi">23667</span><span class="p">,</span>		<span class="cm">/* B2 = 0.722260 */</span>
		 <span class="o">-</span><span class="mi">4297</span><span class="p">,</span>		<span class="cm">/* B1 = -0.262329 */</span>
		 <span class="mi">23667</span><span class="p">,</span>		<span class="cm">/* B0 = 0.722260 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
	<span class="p">{</span>			<span class="cm">/* f1860 */</span>
		<span class="mi">3569</span><span class="p">,</span>		<span class="cm">/* A1 = -0.217865 */</span>
		 <span class="o">-</span><span class="mi">32292</span><span class="p">,</span>	<span class="cm">/* A2 = 0.985504 */</span>
		 <span class="o">-</span><span class="mi">239</span><span class="p">,</span>		<span class="cm">/* B2 = -0.007322 */</span>
		 <span class="mi">0</span><span class="p">,</span>		<span class="cm">/* B1 = 0.000000 */</span>
		 <span class="mi">239</span><span class="p">,</span>		<span class="cm">/* B0 = 0.007322 */</span>
		 <span class="mi">3117</span><span class="p">,</span>		<span class="cm">/* A1 = -0.190277 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="mi">18658</span><span class="p">,</span>		<span class="cm">/* B2 = 0.569427 */</span>
		 <span class="o">-</span><span class="mi">1557</span><span class="p">,</span>		<span class="cm">/* B1 = -0.095032 */</span>
		 <span class="mi">18658</span><span class="p">,</span>		<span class="cm">/* B0 = 0.569427 */</span>
		 <span class="mi">4054</span><span class="p">,</span>		<span class="cm">/* A1 = -0.247437 */</span>
		 <span class="o">-</span><span class="mi">32603</span><span class="p">,</span>	<span class="cm">/* A2 = 0.994965 */</span>
		 <span class="mi">18886</span><span class="p">,</span>		<span class="cm">/* B2 = 0.576385 */</span>
		 <span class="o">-</span><span class="mi">2566</span><span class="p">,</span>		<span class="cm">/* B1 = -0.156647 */</span>
		 <span class="mi">18886</span><span class="p">,</span>		<span class="cm">/* B0 = 0.576385 */</span>
		 <span class="mi">5</span><span class="p">,</span>		<span class="cm">/* Internal filter scaling */</span>
		 <span class="mi">159</span><span class="p">,</span>		<span class="cm">/* Minimum in-band energy threshold */</span>
		 <span class="mi">21</span><span class="p">,</span>		<span class="cm">/* 21/32 in-band to broad-band ratio */</span>
		 <span class="mh">0x0FF5</span>		<span class="cm">/* shift-mask 0x0FF (look at 16 half-frames) bit count = 5 */</span>
	<span class="p">},</span>
<span class="p">};</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_init_filter</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_FILTER</span> <span class="o">*</span> <span class="n">jf</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">max</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">jf</span><span class="o">-&gt;</span><span class="n">filter</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5154</span> <span class="o">+</span> <span class="n">jf</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>	<span class="cm">/* Select Filter */</span>

		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">jf</span><span class="o">-&gt;</span><span class="n">enable</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5152</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Disable Filter */</span>

			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5153</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Enable Filter */</span>

			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="cm">/* Select the filter (f0 - f3) to use. */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5154</span> <span class="o">+</span> <span class="n">jf</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">jf</span><span class="o">-&gt;</span><span class="n">freq</span> <span class="o">&lt;</span> <span class="mi">12</span> <span class="o">&amp;&amp;</span> <span class="n">jf</span><span class="o">-&gt;</span><span class="n">freq</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* Select the frequency for the selected filter. */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5170</span> <span class="o">+</span> <span class="n">jf</span><span class="o">-&gt;</span><span class="n">freq</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">jf</span><span class="o">-&gt;</span><span class="n">freq</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* We need to load a programmable filter set for undefined */</span>
		<span class="cm">/* frequencies.  So we will point the filter to a programmable set. */</span>
		<span class="cm">/* Since there are only 4 filters and 4 programmable sets, we will */</span>
		<span class="cm">/* just point the filter to the same number set and program it for the */</span>
		<span class="cm">/* frequency we want. */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5170</span> <span class="o">+</span> <span class="n">jf</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x515B</span><span class="p">;</span>
			<span class="n">max</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x515E</span><span class="p">;</span>
			<span class="n">max</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">max</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">tone_table</span><span class="p">[</span><span class="n">jf</span><span class="o">-&gt;</span><span class="n">freq</span> <span class="o">-</span> <span class="mi">12</span><span class="p">][</span><span class="n">cnt</span><span class="p">],</span> <span class="n">j</span><span class="p">))</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_en</span><span class="p">[</span><span class="n">jf</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">jf</span><span class="o">-&gt;</span><span class="n">enable</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_init_filter_raw</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_FILTER_RAW</span> <span class="o">*</span> <span class="n">jfr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cnt</span><span class="p">,</span> <span class="n">max</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">jfr</span><span class="o">-&gt;</span><span class="n">filter</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5154</span> <span class="o">+</span> <span class="n">jfr</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>	<span class="cm">/* Select Filter */</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">jfr</span><span class="o">-&gt;</span><span class="n">enable</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5152</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Disable Filter */</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5153</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>		<span class="cm">/* Enable Filter */</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="cm">/* Select the filter (f0 - f3) to use. */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5154</span> <span class="o">+</span> <span class="n">jfr</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="cm">/* We need to load a programmable filter set for undefined */</span>
	<span class="cm">/* frequencies.  So we will point the filter to a programmable set. */</span>
	<span class="cm">/* Since there are only 4 filters and 4 programmable sets, we will */</span>
	<span class="cm">/* just point the filter to the same number set and program it for the */</span>
	<span class="cm">/* frequency we want. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x5170</span> <span class="o">+</span> <span class="n">jfr</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">j</span><span class="o">-&gt;</span><span class="n">ver</span><span class="p">.</span><span class="n">low</span> <span class="o">!=</span> <span class="mh">0x12</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x515B</span><span class="p">;</span>
		<span class="n">max</span> <span class="o">=</span> <span class="mi">19</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">cmd</span> <span class="o">=</span> <span class="mh">0x515E</span><span class="p">;</span>
		<span class="n">max</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">cnt</span> <span class="o">&lt;</span> <span class="n">max</span><span class="p">;</span> <span class="n">cnt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">jfr</span><span class="o">-&gt;</span><span class="n">coeff</span><span class="p">[</span><span class="n">cnt</span><span class="p">],</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">j</span><span class="o">-&gt;</span><span class="n">filter_en</span><span class="p">[</span><span class="n">jfr</span><span class="o">-&gt;</span><span class="n">filter</span><span class="p">]</span> <span class="o">=</span> <span class="n">jfr</span><span class="o">-&gt;</span><span class="n">enable</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">ixj_init_tone</span><span class="p">(</span><span class="n">IXJ</span> <span class="o">*</span><span class="n">j</span><span class="p">,</span> <span class="n">IXJ_TONE</span> <span class="o">*</span> <span class="n">ti</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">freq0</span><span class="p">,</span> <span class="n">freq1</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">data</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ti</span><span class="o">-&gt;</span><span class="n">freq0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">freq0</span> <span class="o">=</span> <span class="n">ti</span><span class="o">-&gt;</span><span class="n">freq0</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">freq0</span> <span class="o">=</span> <span class="mh">0x7FFF</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">ti</span><span class="o">-&gt;</span><span class="n">freq1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">freq1</span> <span class="o">=</span> <span class="n">ti</span><span class="o">-&gt;</span><span class="n">freq1</span><span class="p">;</span>
	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
		<span class="n">freq1</span> <span class="o">=</span> <span class="mh">0x7FFF</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">if</span><span class="p">(</span><span class="n">ti</span><span class="o">-&gt;</span><span class="n">tone_index</span> <span class="o">&gt;</span> <span class="mi">12</span> <span class="o">&amp;&amp;</span> <span class="n">ti</span><span class="o">-&gt;</span><span class="n">tone_index</span> <span class="o">&lt;</span> <span class="mi">28</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6800</span> <span class="o">+</span> <span class="n">ti</span><span class="o">-&gt;</span><span class="n">tone_index</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="mh">0x6000</span> <span class="o">+</span> <span class="p">(</span><span class="n">ti</span><span class="o">-&gt;</span><span class="n">gain1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">ti</span><span class="o">-&gt;</span><span class="n">gain0</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">freq0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">freq1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ixj_WriteDSPCommand</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>
			<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">freq0</span><span class="p">;</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
