<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › rts_pstor › rtsx_card.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>rtsx_card.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* Driver for Realtek PCI-Express card reader</span>
<span class="cm"> * Header file</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright(c) 2009 Realtek Semiconductor Corp. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License as published by the</span>
<span class="cm"> * Free Software Foundation; either version 2, or (at your option) any</span>
<span class="cm"> * later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along</span>
<span class="cm"> * with this program; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span class="cm"> *</span>
<span class="cm"> * Author:</span>
<span class="cm"> *   wwang (wei_wang@realsil.com.cn)</span>
<span class="cm"> *   No. 450, Shenhu Road, Suzhou Industry Park, Suzhou, China</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __REALTEK_RTSX_CARD_H</span>
<span class="cp">#define __REALTEK_RTSX_CARD_H</span>

<span class="cp">#include &quot;debug.h&quot;</span>
<span class="cp">#include &quot;rtsx.h&quot;</span>
<span class="cp">#include &quot;rtsx_chip.h&quot;</span>
<span class="cp">#include &quot;rtsx_transport.h&quot;</span>
<span class="cp">#include &quot;sd.h&quot;</span>

<span class="cp">#define SSC_POWER_DOWN		0x01</span>
<span class="cp">#define SD_OC_POWER_DOWN	0x02</span>
<span class="cp">#define MS_OC_POWER_DOWN	0x04</span>
<span class="cp">#define ALL_POWER_DOWN		0x07</span>
<span class="cp">#define OC_POWER_DOWN		0x06</span>

<span class="cp">#define PMOS_STRG_MASK		0x10</span>
<span class="cp">#define PMOS_STRG_800mA		0x10</span>
<span class="cp">#define PMOS_STRG_400mA		0x00</span>

<span class="cp">#define POWER_OFF		0x03</span>
<span class="cp">#define PARTIAL_POWER_ON	0x01</span>
<span class="cp">#define POWER_ON		0x00</span>

<span class="cp">#define MS_POWER_OFF		0x0C</span>
<span class="cp">#define MS_PARTIAL_POWER_ON	0x04</span>
<span class="cp">#define MS_POWER_ON		0x00</span>
<span class="cp">#define MS_POWER_MASK		0x0C</span>

<span class="cp">#define SD_POWER_OFF		0x03</span>
<span class="cp">#define SD_PARTIAL_POWER_ON	0x01</span>
<span class="cp">#define SD_POWER_ON		0x00</span>
<span class="cp">#define SD_POWER_MASK		0x03</span>

<span class="cp">#define XD_OUTPUT_EN		0x02</span>
<span class="cp">#define SD_OUTPUT_EN		0x04</span>
<span class="cp">#define MS_OUTPUT_EN		0x08</span>
<span class="cp">#define SPI_OUTPUT_EN		0x10</span>

<span class="cp">#define CLK_LOW_FREQ		0x01</span>

<span class="cp">#define CLK_DIV_1		0x01</span>
<span class="cp">#define CLK_DIV_2		0x02</span>
<span class="cp">#define CLK_DIV_4		0x03</span>
<span class="cp">#define CLK_DIV_8		0x04</span>

<span class="cp">#define SSC_80			0</span>
<span class="cp">#define SSC_100			1</span>
<span class="cp">#define SSC_120			2</span>
<span class="cp">#define SSC_150			3</span>
<span class="cp">#define SSC_200			4</span>

<span class="cp">#define XD_CLK_EN		0x02</span>
<span class="cp">#define SD_CLK_EN		0x04</span>
<span class="cp">#define MS_CLK_EN		0x08</span>
<span class="cp">#define SPI_CLK_EN		0x10</span>

<span class="cp">#define XD_MOD_SEL		1</span>
<span class="cp">#define SD_MOD_SEL		2</span>
<span class="cp">#define MS_MOD_SEL		3</span>
<span class="cp">#define SPI_MOD_SEL		4</span>

<span class="cp">#define CHANGE_CLK		0x01</span>

<span class="cp">#define	SD_CRC7_ERR			0x80</span>
<span class="cp">#define	SD_CRC16_ERR			0x40</span>
<span class="cp">#define	SD_CRC_WRITE_ERR		0x20</span>
<span class="cp">#define	SD_CRC_WRITE_ERR_MASK	    	0x1C</span>
<span class="cp">#define	GET_CRC_TIME_OUT		0x02</span>
<span class="cp">#define	SD_TUNING_COMPARE_ERR		0x01</span>

<span class="cp">#define	SD_RSP_80CLK_TIMEOUT		0x01</span>

<span class="cp">#define	SD_CLK_TOGGLE_EN		0x80</span>
<span class="cp">#define	SD_CLK_FORCE_STOP	        0x40</span>
<span class="cp">#define	SD_DAT3_STATUS		        0x10</span>
<span class="cp">#define	SD_DAT2_STATUS		        0x08</span>
<span class="cp">#define	SD_DAT1_STATUS		        0x04</span>
<span class="cp">#define	SD_DAT0_STATUS		        0x02</span>
<span class="cp">#define	SD_CMD_STATUS			0x01</span>

<span class="cp">#define	SD_IO_USING_1V8		        0x80</span>
<span class="cp">#define	SD_IO_USING_3V3		        0x7F</span>
<span class="cp">#define	TYPE_A_DRIVING		        0x00</span>
<span class="cp">#define	TYPE_B_DRIVING			0x01</span>
<span class="cp">#define	TYPE_C_DRIVING			0x02</span>
<span class="cp">#define	TYPE_D_DRIVING		        0x03</span>

<span class="cp">#define	DDR_FIX_RX_DAT			0x00</span>
<span class="cp">#define	DDR_VAR_RX_DAT			0x80</span>
<span class="cp">#define	DDR_FIX_RX_DAT_EDGE		0x00</span>
<span class="cp">#define	DDR_FIX_RX_DAT_14_DELAY		0x40</span>
<span class="cp">#define	DDR_FIX_RX_CMD			0x00</span>
<span class="cp">#define	DDR_VAR_RX_CMD			0x20</span>
<span class="cp">#define	DDR_FIX_RX_CMD_POS_EDGE		0x00</span>
<span class="cp">#define	DDR_FIX_RX_CMD_14_DELAY		0x10</span>
<span class="cp">#define	SD20_RX_POS_EDGE		0x00</span>
<span class="cp">#define	SD20_RX_14_DELAY		0x08</span>
<span class="cp">#define SD20_RX_SEL_MASK		0x08</span>

<span class="cp">#define	DDR_FIX_TX_CMD_DAT		0x00</span>
<span class="cp">#define	DDR_VAR_TX_CMD_DAT		0x80</span>
<span class="cp">#define	DDR_FIX_TX_DAT_14_TSU		0x00</span>
<span class="cp">#define	DDR_FIX_TX_DAT_12_TSU		0x40</span>
<span class="cp">#define	DDR_FIX_TX_CMD_NEG_EDGE		0x00</span>
<span class="cp">#define	DDR_FIX_TX_CMD_14_AHEAD		0x20</span>
<span class="cp">#define	SD20_TX_NEG_EDGE		0x00</span>
<span class="cp">#define	SD20_TX_14_AHEAD		0x10</span>
<span class="cp">#define SD20_TX_SEL_MASK		0x10</span>
<span class="cp">#define	DDR_VAR_SDCLK_POL_SWAP		0x01</span>

<span class="cp">#define	SD_TRANSFER_START		0x80</span>
<span class="cp">#define	SD_TRANSFER_END			0x40</span>
<span class="cp">#define SD_STAT_IDLE			0x20</span>
<span class="cp">#define	SD_TRANSFER_ERR			0x10</span>
<span class="cp">#define	SD_TM_NORMAL_WRITE		0x00</span>
<span class="cp">#define	SD_TM_AUTO_WRITE_3		0x01</span>
<span class="cp">#define	SD_TM_AUTO_WRITE_4		0x02</span>
<span class="cp">#define	SD_TM_AUTO_READ_3		0x05</span>
<span class="cp">#define	SD_TM_AUTO_READ_4		0x06</span>
<span class="cp">#define	SD_TM_CMD_RSP			0x08</span>
<span class="cp">#define	SD_TM_AUTO_WRITE_1		0x09</span>
<span class="cp">#define	SD_TM_AUTO_WRITE_2		0x0A</span>
<span class="cp">#define	SD_TM_NORMAL_READ		0x0C</span>
<span class="cp">#define	SD_TM_AUTO_READ_1		0x0D</span>
<span class="cp">#define	SD_TM_AUTO_READ_2		0x0E</span>
<span class="cp">#define	SD_TM_AUTO_TUNING		0x0F</span>

<span class="cp">#define PHASE_CHANGE			0x80</span>
<span class="cp">#define PHASE_NOT_RESET			0x40</span>

<span class="cp">#define DCMPS_CHANGE			0x80</span>
<span class="cp">#define DCMPS_CHANGE_DONE	   	0x40</span>
<span class="cp">#define DCMPS_ERROR			0x20</span>
<span class="cp">#define DCMPS_CURRENT_PHASE     	0x1F</span>

<span class="cp">#define SD_CLK_DIVIDE_0			0x00</span>
<span class="cp">#define	SD_CLK_DIVIDE_256		0xC0</span>
<span class="cp">#define	SD_CLK_DIVIDE_128		0x80</span>
<span class="cp">#define	SD_BUS_WIDTH_1			0x00</span>
<span class="cp">#define	SD_BUS_WIDTH_4			0x01</span>
<span class="cp">#define	SD_BUS_WIDTH_8			0x02</span>
<span class="cp">#define	SD_ASYNC_FIFO_NOT_RST		0x10</span>
<span class="cp">#define	SD_20_MODE			0x00</span>
<span class="cp">#define	SD_DDR_MODE			0x04</span>
<span class="cp">#define	SD_30_MODE			0x08</span>

<span class="cp">#define SD_CLK_DIVIDE_MASK		0xC0</span>

<span class="cp">#define SD_CMD_IDLE			0x80</span>

<span class="cp">#define SD_DATA_IDLE			0x80</span>

<span class="cp">#define DCM_RESET			0x08</span>
<span class="cp">#define DCM_LOCKED			0x04</span>
<span class="cp">#define DCM_208M			0x00</span>
<span class="cp">#define DCM_TX			        0x01</span>
<span class="cp">#define DCM_RX			        0x02</span>

<span class="cp">#define DRP_START			0x80</span>
<span class="cp">#define DRP_DONE			0x40</span>

<span class="cp">#define DRP_WRITE			0x80</span>
<span class="cp">#define DRP_READ			0x00</span>
<span class="cp">#define DCM_WRITE_ADDRESS_50		0x50</span>
<span class="cp">#define DCM_WRITE_ADDRESS_51		0x51</span>
<span class="cp">#define DCM_READ_ADDRESS_00		0x00</span>
<span class="cp">#define DCM_READ_ADDRESS_51		0x51</span>

<span class="cp">#define	SD_CALCULATE_CRC7		0x00</span>
<span class="cp">#define	SD_NO_CALCULATE_CRC7		0x80</span>
<span class="cp">#define	SD_CHECK_CRC16			0x00</span>
<span class="cp">#define	SD_NO_CHECK_CRC16		0x40</span>
<span class="cp">#define SD_NO_CHECK_WAIT_CRC_TO		0x20</span>
<span class="cp">#define	SD_WAIT_BUSY_END		0x08</span>
<span class="cp">#define	SD_NO_WAIT_BUSY_END		0x00</span>
<span class="cp">#define	SD_CHECK_CRC7			0x00</span>
<span class="cp">#define	SD_NO_CHECK_CRC7		0x04</span>
<span class="cp">#define	SD_RSP_LEN_0			0x00</span>
<span class="cp">#define	SD_RSP_LEN_6			0x01</span>
<span class="cp">#define	SD_RSP_LEN_17			0x02</span>
<span class="cp">#define	SD_RSP_TYPE_R0			0x04</span>
<span class="cp">#define	SD_RSP_TYPE_R1			0x01</span>
<span class="cp">#define	SD_RSP_TYPE_R1b			0x09</span>
<span class="cp">#define	SD_RSP_TYPE_R2			0x02</span>
<span class="cp">#define	SD_RSP_TYPE_R3			0x05</span>
<span class="cp">#define	SD_RSP_TYPE_R4			0x05</span>
<span class="cp">#define	SD_RSP_TYPE_R5			0x01</span>
<span class="cp">#define	SD_RSP_TYPE_R6			0x01</span>
<span class="cp">#define	SD_RSP_TYPE_R7			0x01</span>

<span class="cp">#define	SD_RSP_80CLK_TIMEOUT_EN	   	0x01</span>

<span class="cp">#define	SAMPLE_TIME_RISING		0x00</span>
<span class="cp">#define	SAMPLE_TIME_FALLING		0x80</span>
<span class="cp">#define	PUSH_TIME_DEFAULT		0x00</span>
<span class="cp">#define	PUSH_TIME_ODD			0x40</span>
<span class="cp">#define	NO_EXTEND_TOGGLE		0x00</span>
<span class="cp">#define	EXTEND_TOGGLE_CHK		0x20</span>
<span class="cp">#define	MS_BUS_WIDTH_1			0x00</span>
<span class="cp">#define	MS_BUS_WIDTH_4			0x10</span>
<span class="cp">#define	MS_BUS_WIDTH_8			0x18</span>
<span class="cp">#define	MS_2K_SECTOR_MODE		0x04</span>
<span class="cp">#define	MS_512_SECTOR_MODE		0x00</span>
<span class="cp">#define	MS_TOGGLE_TIMEOUT_EN		0x00</span>
<span class="cp">#define	MS_TOGGLE_TIMEOUT_DISEN		0x01</span>
<span class="cp">#define MS_NO_CHECK_INT			0x02</span>

<span class="cp">#define	WAIT_INT			0x80</span>
<span class="cp">#define	NO_WAIT_INT			0x00</span>
<span class="cp">#define	NO_AUTO_READ_INT_REG		0x00</span>
<span class="cp">#define	AUTO_READ_INT_REG		0x40</span>
<span class="cp">#define	MS_CRC16_ERR			0x20</span>
<span class="cp">#define	MS_RDY_TIMEOUT			0x10</span>
<span class="cp">#define	MS_INT_CMDNK			0x08</span>
<span class="cp">#define	MS_INT_BREQ			0x04</span>
<span class="cp">#define	MS_INT_ERR			0x02</span>
<span class="cp">#define	MS_INT_CED			0x01</span>

<span class="cp">#define	MS_TRANSFER_START		0x80</span>
<span class="cp">#define	MS_TRANSFER_END			0x40</span>
<span class="cp">#define	MS_TRANSFER_ERR			0x20</span>
<span class="cp">#define	MS_BS_STATE			0x10</span>
<span class="cp">#define	MS_TM_READ_BYTES		0x00</span>
<span class="cp">#define	MS_TM_NORMAL_READ		0x01</span>
<span class="cp">#define	MS_TM_WRITE_BYTES		0x04</span>
<span class="cp">#define	MS_TM_NORMAL_WRITE		0x05</span>
<span class="cp">#define	MS_TM_AUTO_READ			0x08</span>
<span class="cp">#define	MS_TM_AUTO_WRITE		0x0C</span>

<span class="cp">#define CARD_SHARE_MASK			0x0F</span>
<span class="cp">#define CARD_SHARE_MULTI_LUN		0x00</span>
<span class="cp">#define	CARD_SHARE_NORMAL		0x00</span>
<span class="cp">#define	CARD_SHARE_48_XD		0x02</span>
<span class="cp">#define	CARD_SHARE_48_SD		0x04</span>
<span class="cp">#define	CARD_SHARE_48_MS		0x08</span>
<span class="cp">#define CARD_SHARE_BAROSSA_XD		0x00</span>
<span class="cp">#define CARD_SHARE_BAROSSA_SD		0x01</span>
<span class="cp">#define CARD_SHARE_BAROSSA_MS		0x02</span>

<span class="cp">#define	MS_DRIVE_8			0x00</span>
<span class="cp">#define	MS_DRIVE_4			0x40</span>
<span class="cp">#define	MS_DRIVE_12			0x80</span>
<span class="cp">#define	SD_DRIVE_8			0x00</span>
<span class="cp">#define	SD_DRIVE_4			0x10</span>
<span class="cp">#define	SD_DRIVE_12			0x20</span>
<span class="cp">#define	XD_DRIVE_8			0x00</span>
<span class="cp">#define	XD_DRIVE_4			0x04</span>
<span class="cp">#define	XD_DRIVE_12			0x08</span>

<span class="cp">#define SPI_STOP		0x01</span>
<span class="cp">#define XD_STOP			0x02</span>
<span class="cp">#define SD_STOP			0x04</span>
<span class="cp">#define MS_STOP			0x08</span>
<span class="cp">#define SPI_CLR_ERR		0x10</span>
<span class="cp">#define XD_CLR_ERR		0x20</span>
<span class="cp">#define SD_CLR_ERR		0x40</span>
<span class="cp">#define MS_CLR_ERR		0x80</span>

<span class="cp">#define CRC_FIX_CLK		(0x00 &lt;&lt; 0)</span>
<span class="cp">#define CRC_VAR_CLK0		(0x01 &lt;&lt; 0)</span>
<span class="cp">#define CRC_VAR_CLK1		(0x02 &lt;&lt; 0)</span>
<span class="cp">#define SD30_FIX_CLK		(0x00 &lt;&lt; 2)</span>
<span class="cp">#define SD30_VAR_CLK0		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define SD30_VAR_CLK1		(0x02 &lt;&lt; 2)</span>
<span class="cp">#define SAMPLE_FIX_CLK		(0x00 &lt;&lt; 4)</span>
<span class="cp">#define SAMPLE_VAR_CLK0		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define SAMPLE_VAR_CLK1		(0x02 &lt;&lt; 4)</span>

<span class="cp">#define SDIO_VER_20		0x80</span>
<span class="cp">#define SDIO_VER_10		0x00</span>
<span class="cp">#define SDIO_VER_CHG		0x40</span>
<span class="cp">#define SDIO_BUS_AUTO_SWITCH	0x10</span>

<span class="cp">#define PINGPONG_BUFFER		0x01</span>
<span class="cp">#define RING_BUFFER		0x00</span>

<span class="cp">#define RB_FLUSH		0x80</span>

<span class="cp">#define DMA_DONE_INT_EN			0x80</span>
<span class="cp">#define SUSPEND_INT_EN			0x40</span>
<span class="cp">#define LINK_RDY_INT_EN			0x20</span>
<span class="cp">#define LINK_DOWN_INT_EN		0x10</span>

<span class="cp">#define DMA_DONE_INT			0x80</span>
<span class="cp">#define SUSPEND_INT			0x40</span>
<span class="cp">#define LINK_RDY_INT			0x20</span>
<span class="cp">#define LINK_DOWN_INT			0x10</span>

<span class="cp">#define MRD_ERR_INT_EN			0x40</span>
<span class="cp">#define MWR_ERR_INT_EN			0x20</span>
<span class="cp">#define SCSI_CMD_INT_EN			0x10</span>
<span class="cp">#define TLP_RCV_INT_EN			0x08</span>
<span class="cp">#define TLP_TRSMT_INT_EN		0x04</span>
<span class="cp">#define MRD_COMPLETE_INT_EN		0x02</span>
<span class="cp">#define MWR_COMPLETE_INT_EN		0x01</span>

<span class="cp">#define MRD_ERR_INT			0x40</span>
<span class="cp">#define MWR_ERR_INT			0x20</span>
<span class="cp">#define SCSI_CMD_INT			0x10</span>
<span class="cp">#define TLP_RX_INT			0x08</span>
<span class="cp">#define TLP_TX_INT			0x04</span>
<span class="cp">#define MRD_COMPLETE_INT		0x02</span>
<span class="cp">#define MWR_COMPLETE_INT		0x01</span>

<span class="cp">#define MSG_RX_INT_EN			0x08</span>
<span class="cp">#define MRD_RX_INT_EN			0x04</span>
<span class="cp">#define MWR_RX_INT_EN			0x02</span>
<span class="cp">#define CPLD_RX_INT_EN			0x01</span>

<span class="cp">#define MSG_RX_INT			0x08</span>
<span class="cp">#define MRD_RX_INT			0x04</span>
<span class="cp">#define MWR_RX_INT			0x02</span>
<span class="cp">#define CPLD_RX_INT			0x01</span>

<span class="cp">#define MSG_TX_INT_EN			0x08</span>
<span class="cp">#define MRD_TX_INT_EN			0x04</span>
<span class="cp">#define MWR_TX_INT_EN			0x02</span>
<span class="cp">#define CPLD_TX_INT_EN			0x01</span>

<span class="cp">#define MSG_TX_INT			0x08</span>
<span class="cp">#define MRD_TX_INT			0x04</span>
<span class="cp">#define MWR_TX_INT			0x02</span>
<span class="cp">#define CPLD_TX_INT			0x01</span>

<span class="cp">#define DMA_RST				0x80</span>
<span class="cp">#define DMA_BUSY			0x04</span>
<span class="cp">#define DMA_DIR_TO_CARD			0x00</span>
<span class="cp">#define DMA_DIR_FROM_CARD		0x02</span>
<span class="cp">#define DMA_EN				0x01</span>
<span class="cp">#define DMA_128				(0 &lt;&lt; 4)</span>
<span class="cp">#define DMA_256				(1 &lt;&lt; 4)</span>
<span class="cp">#define DMA_512				(2 &lt;&lt; 4)</span>
<span class="cp">#define DMA_1024			(3 &lt;&lt; 4)</span>
<span class="cp">#define DMA_PACK_SIZE_MASK		0x30</span>

<span class="cp">#define	XD_PWR_OFF_DELAY0		0x00</span>
<span class="cp">#define	XD_PWR_OFF_DELAY1		0x02</span>
<span class="cp">#define	XD_PWR_OFF_DELAY2		0x04</span>
<span class="cp">#define	XD_PWR_OFF_DELAY3		0x06</span>
<span class="cp">#define	XD_AUTO_PWR_OFF_EN		0xF7</span>
<span class="cp">#define	XD_NO_AUTO_PWR_OFF		0x08</span>

<span class="cp">#define	XD_TIME_RWN_1			0x00</span>
<span class="cp">#define	XD_TIME_RWN_STEP		0x20</span>
<span class="cp">#define	XD_TIME_RW_1			0x00</span>
<span class="cp">#define	XD_TIME_RW_STEP			0x04</span>
<span class="cp">#define	XD_TIME_SETUP_1			0x00</span>
<span class="cp">#define	XD_TIME_SETUP_STEP		0x01</span>

<span class="cp">#define	XD_ECC2_UNCORRECTABLE		0x80</span>
<span class="cp">#define	XD_ECC2_ERROR			0x40</span>
<span class="cp">#define	XD_ECC1_UNCORRECTABLE		0x20</span>
<span class="cp">#define	XD_ECC1_ERROR			0x10</span>
<span class="cp">#define	XD_RDY				0x04</span>
<span class="cp">#define	XD_CE_EN			0xFD</span>
<span class="cp">#define	XD_CE_DISEN			0x02</span>
<span class="cp">#define	XD_WP_EN			0xFE</span>
<span class="cp">#define	XD_WP_DISEN			0x01</span>

<span class="cp">#define	XD_TRANSFER_START		0x80</span>
<span class="cp">#define	XD_TRANSFER_END			0x40</span>
<span class="cp">#define	XD_PPB_EMPTY			0x20</span>
<span class="cp">#define	XD_RESET			0x00</span>
<span class="cp">#define	XD_ERASE			0x01</span>
<span class="cp">#define	XD_READ_STATUS			0x02</span>
<span class="cp">#define	XD_READ_ID			0x03</span>
<span class="cp">#define	XD_READ_REDUNDANT		0x04</span>
<span class="cp">#define	XD_READ_PAGES			0x05</span>
<span class="cp">#define	XD_SET_CMD			0x06</span>
<span class="cp">#define	XD_NORMAL_READ			0x07</span>
<span class="cp">#define	XD_WRITE_PAGES			0x08</span>
<span class="cp">#define	XD_NORMAL_WRITE			0x09</span>
<span class="cp">#define	XD_WRITE_REDUNDANT		0x0A</span>
<span class="cp">#define	XD_SET_ADDR			0x0B</span>

<span class="cp">#define	XD_PPB_TO_SIE			0x80</span>
<span class="cp">#define	XD_TO_PPB_ONLY			0x00</span>
<span class="cp">#define	XD_BA_TRANSFORM			0x40</span>
<span class="cp">#define	XD_BA_NO_TRANSFORM		0x00</span>
<span class="cp">#define	XD_NO_CALC_ECC			0x20</span>
<span class="cp">#define	XD_CALC_ECC			0x00</span>
<span class="cp">#define	XD_IGNORE_ECC			0x10</span>
<span class="cp">#define	XD_CHECK_ECC			0x00</span>
<span class="cp">#define	XD_DIRECT_TO_RB			0x08</span>
<span class="cp">#define	XD_ADDR_LENGTH_0		0x00</span>
<span class="cp">#define	XD_ADDR_LENGTH_1		0x01</span>
<span class="cp">#define	XD_ADDR_LENGTH_2		0x02</span>
<span class="cp">#define	XD_ADDR_LENGTH_3		0x03</span>
<span class="cp">#define	XD_ADDR_LENGTH_4		0x04</span>

<span class="cp">#define	XD_GPG				0xFF</span>
<span class="cp">#define	XD_BPG				0x00</span>

<span class="cp">#define	XD_GBLK				0xFF</span>
<span class="cp">#define	XD_LATER_BBLK			0xF0</span>

<span class="cp">#define	XD_ECC2_ALL1			0x80</span>
<span class="cp">#define	XD_ECC1_ALL1			0x40</span>
<span class="cp">#define	XD_BA2_ALL0			0x20</span>
<span class="cp">#define	XD_BA1_ALL0			0x10</span>
<span class="cp">#define	XD_BA1_BA2_EQL			0x04</span>
<span class="cp">#define	XD_BA2_VALID			0x02</span>
<span class="cp">#define	XD_BA1_VALID			0x01</span>

<span class="cp">#define	XD_PGSTS_ZEROBIT_OVER4		0x00</span>
<span class="cp">#define	XD_PGSTS_NOT_FF			0x02</span>
<span class="cp">#define	XD_AUTO_CHK_DATA_STATUS		0x01</span>

<span class="cp">#define	RSTB_MODE_DETECT		0x80</span>
<span class="cp">#define	MODE_OUT_VLD			0x40</span>
<span class="cp">#define	MODE_OUT_0_NONE			0x00</span>
<span class="cp">#define	MODE_OUT_10_NONE		0x04</span>
<span class="cp">#define	MODE_OUT_10_47			0x05</span>
<span class="cp">#define	MODE_OUT_10_180			0x06</span>
<span class="cp">#define	MODE_OUT_10_680			0x07</span>
<span class="cp">#define	MODE_OUT_16_NONE		0x08</span>
<span class="cp">#define	MODE_OUT_16_47			0x09</span>
<span class="cp">#define	MODE_OUT_16_180			0x0A</span>
<span class="cp">#define	MODE_OUT_16_680			0x0B</span>
<span class="cp">#define	MODE_OUT_NONE_NONE		0x0C</span>
<span class="cp">#define	MODE_OUT_NONE_47		0x0D</span>
<span class="cp">#define	MODE_OUT_NONE_180		0x0E</span>
<span class="cp">#define	MODE_OUT_NONE_680		0x0F</span>

<span class="cp">#define	CARD_OC_INT_EN			0x20</span>
<span class="cp">#define	CARD_DETECT_EN			0x08</span>

<span class="cp">#define MS_DETECT_EN			0x80</span>
<span class="cp">#define MS_OCP_INT_EN			0x40</span>
<span class="cp">#define MS_OCP_INT_CLR			0x20</span>
<span class="cp">#define MS_OC_CLR			0x10</span>
<span class="cp">#define SD_DETECT_EN			0x08</span>
<span class="cp">#define SD_OCP_INT_EN			0x04</span>
<span class="cp">#define SD_OCP_INT_CLR			0x02</span>
<span class="cp">#define SD_OC_CLR			0x01</span>

<span class="cp">#define	CARD_OCP_DETECT			0x80</span>
<span class="cp">#define	CARD_OC_NOW			0x08</span>
<span class="cp">#define	CARD_OC_EVER			0x04</span>

<span class="cp">#define MS_OCP_DETECT			0x80</span>
<span class="cp">#define MS_OC_NOW			0x40</span>
<span class="cp">#define MS_OC_EVER			0x20</span>
<span class="cp">#define SD_OCP_DETECT			0x08</span>
<span class="cp">#define SD_OC_NOW			0x04</span>
<span class="cp">#define SD_OC_EVER			0x02</span>

<span class="cp">#define	CARD_OC_INT_CLR			0x08</span>
<span class="cp">#define	CARD_OC_CLR			0x02</span>

<span class="cp">#define SD_OCP_GLITCH_MASK		0x07</span>
<span class="cp">#define SD_OCP_GLITCH_6_4		0x00</span>
<span class="cp">#define SD_OCP_GLITCH_64		0x01</span>
<span class="cp">#define SD_OCP_GLITCH_640		0x02</span>
<span class="cp">#define SD_OCP_GLITCH_1000		0x03</span>
<span class="cp">#define SD_OCP_GLITCH_2000		0x04</span>
<span class="cp">#define SD_OCP_GLITCH_4000		0x05</span>
<span class="cp">#define SD_OCP_GLITCH_8000		0x06</span>
<span class="cp">#define SD_OCP_GLITCH_10000		0x07</span>

<span class="cp">#define MS_OCP_GLITCH_MASK		0x70</span>
<span class="cp">#define MS_OCP_GLITCH_6_4		(0x00 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_GLITCH_64		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_GLITCH_640		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_GLITCH_1000		(0x03 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_GLITCH_2000		(0x04 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_GLITCH_4000		(0x05 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_GLITCH_8000		(0x06 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_GLITCH_10000		(0x07 &lt;&lt; 4)</span>

<span class="cp">#define OCP_TIME_60			0x00</span>
<span class="cp">#define OCP_TIME_100			(0x01 &lt;&lt; 3)</span>
<span class="cp">#define OCP_TIME_200			(0x02 &lt;&lt; 3)</span>
<span class="cp">#define OCP_TIME_400			(0x03 &lt;&lt; 3)</span>
<span class="cp">#define OCP_TIME_600			(0x04 &lt;&lt; 3)</span>
<span class="cp">#define OCP_TIME_800			(0x05 &lt;&lt; 3)</span>
<span class="cp">#define OCP_TIME_1100			(0x06 &lt;&lt; 3)</span>
<span class="cp">#define OCP_TIME_MASK			0x38</span>

<span class="cp">#define MS_OCP_TIME_60			0x00</span>
<span class="cp">#define MS_OCP_TIME_100			(0x01 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_TIME_200			(0x02 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_TIME_400			(0x03 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_TIME_600			(0x04 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_TIME_800			(0x05 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_TIME_1100		(0x06 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_TIME_MASK		0x70</span>

<span class="cp">#define SD_OCP_TIME_60			0x00</span>
<span class="cp">#define SD_OCP_TIME_100			0x01</span>
<span class="cp">#define SD_OCP_TIME_200			0x02</span>
<span class="cp">#define SD_OCP_TIME_400			0x03</span>
<span class="cp">#define SD_OCP_TIME_600			0x04</span>
<span class="cp">#define SD_OCP_TIME_800			0x05</span>
<span class="cp">#define SD_OCP_TIME_1100		0x06</span>
<span class="cp">#define SD_OCP_TIME_MASK		0x07</span>

<span class="cp">#define OCP_THD_315_417			0x00</span>
<span class="cp">#define OCP_THD_283_783			(0x01 &lt;&lt; 6)</span>
<span class="cp">#define OCP_THD_244_946			(0x02 &lt;&lt; 6)</span>
<span class="cp">#define OCP_THD_191_1080		(0x03 &lt;&lt; 6)</span>
<span class="cp">#define OCP_THD_MASK			0xC0</span>

<span class="cp">#define MS_OCP_THD_450			0x00</span>
<span class="cp">#define MS_OCP_THD_550			(0x01 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_THD_650			(0x02 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_THD_750			(0x03 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_THD_850			(0x04 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_THD_950			(0x05 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_THD_1050			(0x06 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_THD_1150			(0x07 &lt;&lt; 4)</span>
<span class="cp">#define MS_OCP_THD_MASK			0x70</span>

<span class="cp">#define SD_OCP_THD_450			0x00</span>
<span class="cp">#define SD_OCP_THD_550			0x01</span>
<span class="cp">#define SD_OCP_THD_650			0x02</span>
<span class="cp">#define SD_OCP_THD_750			0x03</span>
<span class="cp">#define SD_OCP_THD_850			0x04</span>
<span class="cp">#define SD_OCP_THD_950			0x05</span>
<span class="cp">#define SD_OCP_THD_1050			0x06</span>
<span class="cp">#define SD_OCP_THD_1150			0x07</span>
<span class="cp">#define SD_OCP_THD_MASK			0x07</span>

<span class="cp">#define FPGA_MS_PULL_CTL_EN		0xEF</span>
<span class="cp">#define FPGA_SD_PULL_CTL_EN		0xF7</span>
<span class="cp">#define FPGA_XD_PULL_CTL_EN1		0xFE</span>
<span class="cp">#define FPGA_XD_PULL_CTL_EN2		0xFD</span>
<span class="cp">#define FPGA_XD_PULL_CTL_EN3		0xFB</span>

<span class="cp">#define FPGA_MS_PULL_CTL_BIT		0x10</span>
<span class="cp">#define FPGA_SD_PULL_CTL_BIT		0x08</span>

<span class="cp">#define BLINK_EN			0x08</span>
<span class="cp">#define LED_GPIO0			(0 &lt;&lt; 4)</span>
<span class="cp">#define LED_GPIO1			(1 &lt;&lt; 4)</span>
<span class="cp">#define LED_GPIO2			(2 &lt;&lt; 4)</span>

<span class="cp">#define SDIO_BUS_CTRL		0x01</span>
<span class="cp">#define SDIO_CD_CTRL		0x02</span>

<span class="cp">#define SSC_RSTB		0x80</span>
<span class="cp">#define SSC_8X_EN		0x40</span>
<span class="cp">#define SSC_FIX_FRAC		0x20</span>
<span class="cp">#define SSC_SEL_1M		0x00</span>
<span class="cp">#define SSC_SEL_2M		0x08</span>
<span class="cp">#define SSC_SEL_4M		0x10</span>
<span class="cp">#define SSC_SEL_8M		0x18</span>

<span class="cp">#define SSC_DEPTH_MASK		0x07</span>
<span class="cp">#define SSC_DEPTH_DISALBE	0x00</span>
<span class="cp">#define SSC_DEPTH_4M		0x01</span>
<span class="cp">#define SSC_DEPTH_2M		0x02</span>
<span class="cp">#define SSC_DEPTH_1M		0x03</span>
<span class="cp">#define SSC_DEPTH_512K		0x04</span>
<span class="cp">#define SSC_DEPTH_256K		0x05</span>
<span class="cp">#define SSC_DEPTH_128K		0x06</span>
<span class="cp">#define SSC_DEPTH_64K		0x07</span>

<span class="cp">#define XD_D3_NP		0x00</span>
<span class="cp">#define XD_D3_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define XD_D3_PU		(0x02 &lt;&lt; 6)</span>
<span class="cp">#define XD_D2_NP		0x00</span>
<span class="cp">#define XD_D2_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define XD_D2_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define XD_D1_NP		0x00</span>
<span class="cp">#define XD_D1_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define XD_D1_PU		(0x02 &lt;&lt; 2)</span>
<span class="cp">#define XD_D0_NP		0x00</span>
<span class="cp">#define XD_D0_PD		0x01</span>
<span class="cp">#define XD_D0_PU		0x02</span>

<span class="cp">#define SD_D7_NP		0x00</span>
<span class="cp">#define SD_D7_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define SD_DAT7_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define SD_CLK_NP		0x00</span>
<span class="cp">#define SD_CLK_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define SD_CLK_PU		(0x02 &lt;&lt; 2)</span>
<span class="cp">#define SD_D5_NP		0x00</span>
<span class="cp">#define SD_D5_PD		0x01</span>
<span class="cp">#define SD_D5_PU		0x02</span>

<span class="cp">#define MS_D1_NP		0x00</span>
<span class="cp">#define MS_D1_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define MS_D1_PU		(0x02 &lt;&lt; 6)</span>
<span class="cp">#define MS_D2_NP		0x00</span>
<span class="cp">#define MS_D2_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define MS_D2_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define MS_CLK_NP		0x00</span>
<span class="cp">#define MS_CLK_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define MS_CLK_PU		(0x02 &lt;&lt; 2)</span>
<span class="cp">#define MS_D6_NP		0x00</span>
<span class="cp">#define MS_D6_PD		0x01</span>
<span class="cp">#define MS_D6_PU		0x02</span>

<span class="cp">#define XD_D7_NP		0x00</span>
<span class="cp">#define XD_D7_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define XD_D7_PU		(0x02 &lt;&lt; 6)</span>
<span class="cp">#define XD_D6_NP		0x00</span>
<span class="cp">#define XD_D6_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define XD_D6_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define XD_D5_NP		0x00</span>
<span class="cp">#define XD_D5_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define XD_D5_PU		(0x02 &lt;&lt; 2)</span>
<span class="cp">#define XD_D4_NP		0x00</span>
<span class="cp">#define XD_D4_PD		0x01</span>
<span class="cp">#define XD_D4_PU		0x02</span>

<span class="cp">#define SD_D6_NP		0x00</span>
<span class="cp">#define SD_D6_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define SD_D6_PU		(0x02 &lt;&lt; 6)</span>
<span class="cp">#define SD_D0_NP		0x00</span>
<span class="cp">#define SD_D0_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define SD_D0_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define SD_D1_NP		0x00</span>
<span class="cp">#define SD_D1_PD		0x01</span>
<span class="cp">#define SD_D1_PU		0x02</span>

<span class="cp">#define MS_D3_NP		0x00</span>
<span class="cp">#define MS_D3_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define MS_D3_PU		(0x02 &lt;&lt; 6)</span>
<span class="cp">#define MS_D0_NP		0x00</span>
<span class="cp">#define MS_D0_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define MS_D0_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define MS_BS_NP		0x00</span>
<span class="cp">#define MS_BS_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define MS_BS_PU		(0x02 &lt;&lt; 2)</span>

<span class="cp">#define XD_WP_NP		0x00</span>
<span class="cp">#define XD_WP_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define XD_WP_PU		(0x02 &lt;&lt; 6)</span>
<span class="cp">#define XD_CE_NP		0x00</span>
<span class="cp">#define XD_CE_PD		(0x01 &lt;&lt; 3)</span>
<span class="cp">#define XD_CE_PU		(0x02 &lt;&lt; 3)</span>
<span class="cp">#define XD_CLE_NP		0x00</span>
<span class="cp">#define XD_CLE_PD		(0x01 &lt;&lt; 1)</span>
<span class="cp">#define XD_CLE_PU		(0x02 &lt;&lt; 1)</span>
<span class="cp">#define XD_CD_PD		0x00</span>
<span class="cp">#define XD_CD_PU		0x01</span>

<span class="cp">#define SD_D4_NP		0x00</span>
<span class="cp">#define SD_D4_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define SD_D4_PU		(0x02 &lt;&lt; 6)</span>

<span class="cp">#define MS_D7_NP		0x00</span>
<span class="cp">#define MS_D7_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define MS_D7_PU		(0x02 &lt;&lt; 6)</span>

<span class="cp">#define XD_RDY_NP		0x00</span>
<span class="cp">#define XD_RDY_PD		(0x01 &lt;&lt; 6)</span>
<span class="cp">#define XD_RDY_PU		(0x02 &lt;&lt; 6)</span>
<span class="cp">#define XD_WE_NP		0x00</span>
<span class="cp">#define XD_WE_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define XD_WE_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define XD_RE_NP		0x00</span>
<span class="cp">#define XD_RE_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define XD_RE_PU		(0x02 &lt;&lt; 2)</span>
<span class="cp">#define XD_ALE_NP		0x00</span>
<span class="cp">#define XD_ALE_PD		0x01</span>
<span class="cp">#define XD_ALE_PU		0x02</span>

<span class="cp">#define SD_D3_NP		0x00</span>
<span class="cp">#define SD_D3_PD		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define SD_D3_PU		(0x02 &lt;&lt; 4)</span>
<span class="cp">#define SD_D2_NP		0x00</span>
<span class="cp">#define SD_D2_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define SD_D2_PU		(0x02 &lt;&lt; 2)</span>

<span class="cp">#define MS_INS_PD		0x00</span>
<span class="cp">#define MS_INS_PU		(0x01 &lt;&lt; 7)</span>
<span class="cp">#define SD_WP_NP		0x00</span>
<span class="cp">#define SD_WP_PD		(0x01 &lt;&lt; 5)</span>
<span class="cp">#define SD_WP_PU		(0x02 &lt;&lt; 5)</span>
<span class="cp">#define SD_CD_PD		0x00</span>
<span class="cp">#define SD_CD_PU		(0x01 &lt;&lt; 4)</span>
<span class="cp">#define SD_CMD_NP		0x00</span>
<span class="cp">#define SD_CMD_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define SD_CMD_PU		(0x02 &lt;&lt; 2)</span>

<span class="cp">#define MS_D5_NP		0x00</span>
<span class="cp">#define MS_D5_PD		(0x01 &lt;&lt; 2)</span>
<span class="cp">#define MS_D5_PU		(0x02 &lt;&lt; 2)</span>
<span class="cp">#define MS_D4_NP		0x00</span>
<span class="cp">#define MS_D4_PD		0x01</span>
<span class="cp">#define MS_D4_PU		0x02</span>

<span class="cp">#define FORCE_PM_CLOCK		0x10</span>
<span class="cp">#define EN_CLOCK_PM		0x01</span>

<span class="cp">#define HOST_ENTER_S3		0x02</span>
<span class="cp">#define HOST_ENTER_S1		0x01</span>

<span class="cp">#define AUX_PWR_DETECTED	0x01</span>

<span class="cp">#define PHY_DEBUG_MODE		0x01</span>

<span class="cp">#define SPI_COMMAND_BIT_8	0xE0</span>
<span class="cp">#define SPI_ADDRESS_BIT_24	0x17</span>
<span class="cp">#define SPI_ADDRESS_BIT_32	0x1F</span>

<span class="cp">#define SPI_TRANSFER0_START	0x80</span>
<span class="cp">#define SPI_TRANSFER0_END	0x40</span>
<span class="cp">#define SPI_C_MODE0		0x00</span>
<span class="cp">#define SPI_CA_MODE0		0x01</span>
<span class="cp">#define SPI_CDO_MODE0		0x02</span>
<span class="cp">#define SPI_CDI_MODE0		0x03</span>
<span class="cp">#define SPI_CADO_MODE0		0x04</span>
<span class="cp">#define SPI_CADI_MODE0		0x05</span>
<span class="cp">#define SPI_POLLING_MODE0	0x06</span>

<span class="cp">#define SPI_TRANSFER1_START	0x80</span>
<span class="cp">#define SPI_TRANSFER1_END	0x40</span>
<span class="cp">#define SPI_DO_MODE1		0x00</span>
<span class="cp">#define SPI_DI_MODE1		0x01</span>

<span class="cp">#define CS_POLARITY_HIGH	0x40</span>
<span class="cp">#define CS_POLARITY_LOW		0x00</span>
<span class="cp">#define DTO_MSB_FIRST		0x00</span>
<span class="cp">#define DTO_LSB_FIRST		0x20</span>
<span class="cp">#define SPI_MASTER		0x00</span>
<span class="cp">#define SPI_SLAVE		0x10</span>
<span class="cp">#define SPI_MODE0		0x00</span>
<span class="cp">#define SPI_MODE1		0x04</span>
<span class="cp">#define SPI_MODE2		0x08</span>
<span class="cp">#define SPI_MODE3		0x0C</span>
<span class="cp">#define SPI_MANUAL		0x00</span>
<span class="cp">#define SPI_HALF_AUTO		0x01</span>
<span class="cp">#define SPI_AUTO		0x02</span>
<span class="cp">#define SPI_EEPROM_AUTO		0x03</span>

<span class="cp">#define EDO_TIMING_MASK		0x03</span>
<span class="cp">#define SAMPLE_RISING		0x00</span>
<span class="cp">#define SAMPLE_DELAY_HALF	0x01</span>
<span class="cp">#define SAMPLE_DELAY_ONE	0x02</span>
<span class="cp">#define SAPMLE_DELAY_ONE_HALF	0x03</span>
<span class="cp">#define TCS_MASK		0x0C</span>

<span class="cp">#define NOT_BYPASS_SD		0x02</span>
<span class="cp">#define DISABLE_SDIO_FUNC	0x04</span>
<span class="cp">#define SELECT_1LUN		0x08</span>

<span class="cp">#define PWR_GATE_EN		0x01</span>
<span class="cp">#define LDO3318_PWR_MASK	0x06</span>
<span class="cp">#define LDO_ON			0x00</span>
<span class="cp">#define LDO_SUSPEND		0x04</span>
<span class="cp">#define LDO_OFF			0x06</span>

<span class="cp">#define SD_CFG1			0xFDA0</span>
<span class="cp">#define SD_CFG2			0xFDA1</span>
<span class="cp">#define SD_CFG3			0xFDA2</span>
<span class="cp">#define SD_STAT1		0xFDA3</span>
<span class="cp">#define SD_STAT2		0xFDA4</span>
<span class="cp">#define SD_BUS_STAT		0xFDA5</span>
<span class="cp">#define SD_PAD_CTL		0xFDA6</span>
<span class="cp">#define SD_SAMPLE_POINT_CTL	0xFDA7</span>
<span class="cp">#define SD_PUSH_POINT_CTL	0xFDA8</span>
<span class="cp">#define SD_CMD0			0xFDA9</span>
<span class="cp">#define SD_CMD1			0xFDAA</span>
<span class="cp">#define SD_CMD2			0xFDAB</span>
<span class="cp">#define SD_CMD3			0xFDAC</span>
<span class="cp">#define SD_CMD4			0xFDAD</span>
<span class="cp">#define SD_CMD5			0xFDAE</span>
<span class="cp">#define SD_BYTE_CNT_L		0xFDAF</span>
<span class="cp">#define SD_BYTE_CNT_H		0xFDB0</span>
<span class="cp">#define SD_BLOCK_CNT_L		0xFDB1</span>
<span class="cp">#define SD_BLOCK_CNT_H		0xFDB2</span>
<span class="cp">#define SD_TRANSFER		0xFDB3</span>
<span class="cp">#define SD_CMD_STATE		0xFDB5</span>
<span class="cp">#define SD_DATA_STATE		0xFDB6</span>

<span class="cp">#define	DCM_DRP_CTL         	0xFC23</span>
<span class="cp">#define	DCM_DRP_TRIG		0xFC24</span>
<span class="cp">#define	DCM_DRP_CFG         	0xFC25</span>
<span class="cp">#define	DCM_DRP_WR_DATA_L   	0xFC26</span>
<span class="cp">#define	DCM_DRP_WR_DATA_H   	0xFC27</span>
<span class="cp">#define	DCM_DRP_RD_DATA_L   	0xFC28</span>
<span class="cp">#define	DCM_DRP_RD_DATA_H   	0xFC29</span>
<span class="cp">#define SD_VPCLK0_CTL		0xFC2A</span>
<span class="cp">#define SD_VPCLK1_CTL		0xFC2B</span>
<span class="cp">#define SD_DCMPS0_CTL		0xFC2C</span>
<span class="cp">#define SD_DCMPS1_CTL		0xFC2D</span>
<span class="cp">#define SD_VPTX_CTL		SD_VPCLK0_CTL</span>
<span class="cp">#define SD_VPRX_CTL		SD_VPCLK1_CTL</span>
<span class="cp">#define SD_DCMPS_TX_CTL		SD_DCMPS0_CTL</span>
<span class="cp">#define SD_DCMPS_RX_CTL		SD_DCMPS1_CTL</span>

<span class="cp">#define CARD_CLK_SOURCE		0xFC2E</span>

<span class="cp">#define CARD_PWR_CTL		0xFD50</span>
<span class="cp">#define CARD_CLK_SWITCH		0xFD51</span>
<span class="cp">#define CARD_SHARE_MODE		0xFD52</span>
<span class="cp">#define CARD_DRIVE_SEL		0xFD53</span>
<span class="cp">#define CARD_STOP		0xFD54</span>
<span class="cp">#define CARD_OE			0xFD55</span>
<span class="cp">#define CARD_AUTO_BLINK		0xFD56</span>
<span class="cp">#define CARD_GPIO_DIR		0xFD57</span>
<span class="cp">#define CARD_GPIO		0xFD58</span>

<span class="cp">#define CARD_DATA_SOURCE	0xFD5B</span>
<span class="cp">#define CARD_SELECT		0xFD5C</span>
<span class="cp">#define SD30_DRIVE_SEL		0xFD5E</span>

<span class="cp">#define CARD_CLK_EN		0xFD69</span>

<span class="cp">#define SDIO_CTRL		0xFD6B</span>

<span class="cp">#define FPDCTL			0xFC00</span>
<span class="cp">#define PDINFO			0xFC01</span>

<span class="cp">#define CLK_CTL			0xFC02</span>
<span class="cp">#define CLK_DIV			0xFC03</span>
<span class="cp">#define CLK_SEL			0xFC04</span>

<span class="cp">#define SSC_DIV_N_0		0xFC0F</span>
<span class="cp">#define SSC_DIV_N_1		0xFC10</span>

<span class="cp">#define RCCTL			0xFC14</span>

<span class="cp">#define FPGA_PULL_CTL		0xFC1D</span>

<span class="cp">#define CARD_PULL_CTL1		0xFD60</span>
<span class="cp">#define CARD_PULL_CTL2		0xFD61</span>
<span class="cp">#define CARD_PULL_CTL3		0xFD62</span>
<span class="cp">#define CARD_PULL_CTL4		0xFD63</span>
<span class="cp">#define CARD_PULL_CTL5		0xFD64</span>
<span class="cp">#define CARD_PULL_CTL6		0xFD65</span>

<span class="cp">#define IRQEN0				0xFE20</span>
<span class="cp">#define IRQSTAT0			0xFE21</span>
<span class="cp">#define IRQEN1				0xFE22</span>
<span class="cp">#define IRQSTAT1			0xFE23</span>
<span class="cp">#define TLPRIEN				0xFE24</span>
<span class="cp">#define TLPRISTAT			0xFE25</span>
<span class="cp">#define TLPTIEN				0xFE26</span>
<span class="cp">#define TLPTISTAT			0xFE27</span>
<span class="cp">#define DMATC0				0xFE28</span>
<span class="cp">#define DMATC1				0xFE29</span>
<span class="cp">#define DMATC2				0xFE2A</span>
<span class="cp">#define DMATC3				0xFE2B</span>
<span class="cp">#define DMACTL				0xFE2C</span>
<span class="cp">#define BCTL				0xFE2D</span>
<span class="cp">#define RBBC0				0xFE2E</span>
<span class="cp">#define RBBC1				0xFE2F</span>
<span class="cp">#define RBDAT				0xFE30</span>
<span class="cp">#define RBCTL				0xFE34</span>
<span class="cp">#define CFGADDR0			0xFE35</span>
<span class="cp">#define CFGADDR1			0xFE36</span>
<span class="cp">#define CFGDATA0			0xFE37</span>
<span class="cp">#define CFGDATA1			0xFE38</span>
<span class="cp">#define CFGDATA2			0xFE39</span>
<span class="cp">#define CFGDATA3			0xFE3A</span>
<span class="cp">#define CFGRWCTL			0xFE3B</span>
<span class="cp">#define PHYRWCTL			0xFE3C</span>
<span class="cp">#define PHYDATA0			0xFE3D</span>
<span class="cp">#define PHYDATA1			0xFE3E</span>
<span class="cp">#define PHYADDR				0xFE3F</span>
<span class="cp">#define MSGRXDATA0			0xFE40</span>
<span class="cp">#define MSGRXDATA1			0xFE41</span>
<span class="cp">#define MSGRXDATA2			0xFE42</span>
<span class="cp">#define MSGRXDATA3			0xFE43</span>
<span class="cp">#define MSGTXDATA0			0xFE44</span>
<span class="cp">#define MSGTXDATA1			0xFE45</span>
<span class="cp">#define MSGTXDATA2			0xFE46</span>
<span class="cp">#define MSGTXDATA3			0xFE47</span>
<span class="cp">#define MSGTXCTL			0xFE48</span>
<span class="cp">#define PETXCFG				0xFE49</span>

<span class="cp">#define CDRESUMECTL			0xFE52</span>
<span class="cp">#define WAKE_SEL_CTL			0xFE54</span>
<span class="cp">#define PME_FORCE_CTL			0xFE56</span>
<span class="cp">#define ASPM_FORCE_CTL			0xFE57</span>
<span class="cp">#define PM_CLK_FORCE_CTL		0xFE58</span>
<span class="cp">#define PERST_GLITCH_WIDTH		0xFE5C</span>
<span class="cp">#define CHANGE_LINK_STATE		0xFE5B</span>
<span class="cp">#define RESET_LOAD_REG			0xFE5E</span>
<span class="cp">#define HOST_SLEEP_STATE		0xFE60</span>
<span class="cp">#define MAIN_PWR_OFF_CTL		0xFE70	</span><span class="cm">/* RTS5208 */</span><span class="cp"></span>
<span class="cp">#define SDIO_CFG			0xFE70	</span><span class="cm">/* RTS5209 */</span><span class="cp"></span>

<span class="cp">#define NFTS_TX_CTRL			0xFE72</span>

<span class="cp">#define PWR_GATE_CTRL			0xFE75</span>
<span class="cp">#define PWD_SUSPEND_EN			0xFE76</span>

<span class="cp">#define EFUSE_CONTENT			0xFE5F</span>

<span class="cp">#define XD_INIT				0xFD10</span>
<span class="cp">#define XD_DTCTL			0xFD11</span>
<span class="cp">#define XD_CTL				0xFD12</span>
<span class="cp">#define XD_TRANSFER			0xFD13</span>
<span class="cp">#define XD_CFG				0xFD14</span>
<span class="cp">#define XD_ADDRESS0			0xFD15</span>
<span class="cp">#define XD_ADDRESS1			0xFD16</span>
<span class="cp">#define XD_ADDRESS2			0xFD17</span>
<span class="cp">#define XD_ADDRESS3			0xFD18</span>
<span class="cp">#define XD_ADDRESS4			0xFD19</span>
<span class="cp">#define XD_DAT				0xFD1A</span>
<span class="cp">#define XD_PAGE_CNT			0xFD1B</span>
<span class="cp">#define XD_PAGE_STATUS			0xFD1C</span>
<span class="cp">#define XD_BLOCK_STATUS			0xFD1D</span>
<span class="cp">#define XD_BLOCK_ADDR1_L		0xFD1E</span>
<span class="cp">#define XD_BLOCK_ADDR1_H		0xFD1F</span>
<span class="cp">#define XD_BLOCK_ADDR2_L		0xFD20</span>
<span class="cp">#define XD_BLOCK_ADDR2_H		0xFD21</span>
<span class="cp">#define XD_BYTE_CNT_L			0xFD22</span>
<span class="cp">#define XD_BYTE_CNT_H			0xFD23</span>
<span class="cp">#define	XD_PARITY			0xFD24</span>
<span class="cp">#define XD_ECC_BIT1			0xFD25</span>
<span class="cp">#define XD_ECC_BYTE1			0xFD26</span>
<span class="cp">#define XD_ECC_BIT2			0xFD27</span>
<span class="cp">#define XD_ECC_BYTE2			0xFD28</span>
<span class="cp">#define XD_RESERVED0			0xFD29</span>
<span class="cp">#define XD_RESERVED1			0xFD2A</span>
<span class="cp">#define XD_RESERVED2			0xFD2B</span>
<span class="cp">#define XD_RESERVED3			0xFD2C</span>
<span class="cp">#define XD_CHK_DATA_STATUS		0xFD2D</span>
<span class="cp">#define XD_CATCTL			0xFD2E</span>

<span class="cp">#define MS_CFG				0xFD40</span>
<span class="cp">#define MS_TPC				0xFD41</span>
<span class="cp">#define MS_TRANS_CFG			0xFD42</span>
<span class="cp">#define MS_TRANSFER			0xFD43</span>
<span class="cp">#define MS_INT_REG			0xFD44</span>
<span class="cp">#define MS_BYTE_CNT			0xFD45</span>
<span class="cp">#define MS_SECTOR_CNT_L			0xFD46</span>
<span class="cp">#define MS_SECTOR_CNT_H			0xFD47</span>
<span class="cp">#define MS_DBUS_H			0xFD48</span>

<span class="cp">#define SSC_CTL1			0xFC11</span>
<span class="cp">#define SSC_CTL2			0xFC12</span>

<span class="cp">#define OCPCTL				0xFC15</span>
<span class="cp">#define OCPSTAT				0xFC16</span>
<span class="cp">#define OCPCLR				0xFC17	</span><span class="cm">/* 5208 */</span><span class="cp"></span>
<span class="cp">#define OCPGLITCH			0xFC17	</span><span class="cm">/* 5209 */</span><span class="cp"></span>
<span class="cp">#define OCPPARA1			0xFC18</span>
<span class="cp">#define OCPPARA2			0xFC19</span>

<span class="cp">#define EFUSE_OP			0xFC20</span>
<span class="cp">#define EFUSE_CTRL			0xFC21</span>
<span class="cp">#define EFUSE_DATA			0xFC22</span>

<span class="cp">#define	SPI_COMMAND			0xFD80</span>
<span class="cp">#define	SPI_ADDR0			0xFD81</span>
<span class="cp">#define	SPI_ADDR1			0xFD82</span>
<span class="cp">#define	SPI_ADDR2			0xFD83</span>
<span class="cp">#define	SPI_ADDR3			0xFD84</span>
<span class="cp">#define	SPI_CA_NUMBER			0xFD85</span>
<span class="cp">#define	SPI_LENGTH0			0xFD86</span>
<span class="cp">#define	SPI_LENGTH1			0xFD87</span>
<span class="cp">#define	SPI_DATA			0xFD88</span>
<span class="cp">#define SPI_DATA_NUMBER			0xFD89</span>
<span class="cp">#define	SPI_TRANSFER0			0xFD90</span>
<span class="cp">#define	SPI_TRANSFER1			0xFD91</span>
<span class="cp">#define	SPI_CONTROL			0xFD92</span>
<span class="cp">#define	SPI_SIG				0xFD93</span>
<span class="cp">#define	SPI_TCTL			0xFD94</span>
<span class="cp">#define	SPI_SLAVE_NUM			0xFD95</span>
<span class="cp">#define	SPI_CLK_DIVIDER0		0xFD96</span>
<span class="cp">#define	SPI_CLK_DIVIDER1		0xFD97</span>

<span class="cp">#define SRAM_BASE			0xE600</span>
<span class="cp">#define RBUF_BASE			0xF400</span>
<span class="cp">#define PPBUF_BASE1			0xF800</span>
<span class="cp">#define PPBUF_BASE2			0xFA00</span>
<span class="cp">#define IMAGE_FLAG_ADDR0		0xCE80</span>
<span class="cp">#define IMAGE_FLAG_ADDR1		0xCE81</span>

<span class="cp">#define READ_OP			1</span>
<span class="cp">#define WRITE_OP		2</span>

<span class="cp">#define LCTLR		0x80</span>

<span class="cp">#define POLLING_WAIT_CNT	1</span>
<span class="cp">#define IDLE_MAX_COUNT		10</span>
<span class="cp">#define SDIO_IDLE_COUNT		10</span>

<span class="cp">#define DEBOUNCE_CNT			5</span>

<span class="kt">void</span> <span class="n">do_remaining_work</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">try_to_switch_sdio_ctrl</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">do_reset_sd_card</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">do_reset_xd_card</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">do_reset_ms_card</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">rtsx_power_off_card</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">rtsx_release_cards</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">rtsx_reset_cards</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">rtsx_reinit_cards</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reset_chip</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">rtsx_init_cards</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">switch_ssc_clock</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">clk</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">switch_normal_clock</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">clk</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">enable_card_clock</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">card</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">disable_card_clock</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">card</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">card_rw</span><span class="p">(</span><span class="k">struct</span> <span class="n">scsi_cmnd</span> <span class="o">*</span><span class="n">srb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u32</span> <span class="n">sec_addr</span><span class="p">,</span> <span class="n">u16</span> <span class="n">sec_cnt</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">trans_dma_enable</span><span class="p">(</span><span class="k">enum</span> <span class="n">dma_data_direction</span> <span class="n">dir</span><span class="p">,</span> <span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u32</span> <span class="n">byte_cnt</span><span class="p">,</span> <span class="n">u8</span> <span class="n">pack_size</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">toggle_gpio</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">gpio</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">turn_on_led</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">gpio</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">turn_off_led</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">gpio</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">card_share_mode</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">card</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">select_card</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">card</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">detect_card_cd</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">card</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">check_card_exist</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">check_card_ready</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">check_card_wp</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">check_card_fail</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">check_card_ejected</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">eject_card</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">);</span>
<span class="n">u8</span> <span class="n">get_lun_card</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">get_card_size</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">lun</span><span class="p">)</span>
<span class="p">{</span>
<span class="cp">#ifdef SUPPORT_SD_LOCK</span>
	<span class="k">struct</span> <span class="n">sd_info</span> <span class="o">*</span><span class="n">sd_card</span> <span class="o">=</span> <span class="o">&amp;</span><span class="p">(</span><span class="n">chip</span><span class="o">-&gt;</span><span class="n">sd_card</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">get_lun_card</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">lun</span><span class="p">)</span> <span class="o">==</span> <span class="n">SD_CARD</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">sd_card</span><span class="o">-&gt;</span><span class="n">sd_lock_status</span> <span class="o">&amp;</span> <span class="n">SD_LOCKED</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">else</span>
		<span class="k">return</span> <span class="n">chip</span><span class="o">-&gt;</span><span class="n">capacity</span><span class="p">[</span><span class="n">lun</span><span class="p">];</span>
<span class="cp">#else</span>
	<span class="k">return</span> <span class="n">chip</span><span class="o">-&gt;</span><span class="n">capacity</span><span class="p">[</span><span class="n">lun</span><span class="p">];</span>
<span class="cp">#endif</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">switch_clock</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="kt">int</span> <span class="n">clk</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">retval</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">chip</span><span class="o">-&gt;</span><span class="n">asic_code</span><span class="p">)</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="n">switch_ssc_clock</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">clk</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">retval</span> <span class="o">=</span> <span class="n">switch_normal_clock</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">clk</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">retval</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">card_power_on</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">card</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">card_power_off</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">,</span> <span class="n">u8</span> <span class="n">card</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">card_power_off_all</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">RTSX_WRITE_REG</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">CARD_PWR_CTL</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">,</span> <span class="mh">0x0F</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">STATUS_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">rtsx_clear_xd_error</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">rtsx_write_register</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">CARD_STOP</span><span class="p">,</span> <span class="n">XD_STOP</span> <span class="o">|</span> <span class="n">XD_CLR_ERR</span><span class="p">,</span> <span class="n">XD_STOP</span> <span class="o">|</span> <span class="n">XD_CLR_ERR</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">rtsx_clear_sd_error</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">rtsx_write_register</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">CARD_STOP</span><span class="p">,</span> <span class="n">SD_STOP</span> <span class="o">|</span> <span class="n">SD_CLR_ERR</span><span class="p">,</span> <span class="n">SD_STOP</span> <span class="o">|</span> <span class="n">SD_CLR_ERR</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">rtsx_clear_ms_error</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">rtsx_write_register</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">CARD_STOP</span><span class="p">,</span> <span class="n">MS_STOP</span> <span class="o">|</span> <span class="n">MS_CLR_ERR</span><span class="p">,</span> <span class="n">MS_STOP</span> <span class="o">|</span> <span class="n">MS_CLR_ERR</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">rtsx_clear_spi_error</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">rtsx_write_register</span><span class="p">(</span><span class="n">chip</span><span class="p">,</span> <span class="n">CARD_STOP</span><span class="p">,</span> <span class="n">SPI_STOP</span> <span class="o">|</span> <span class="n">SPI_CLR_ERR</span><span class="p">,</span> <span class="n">SPI_STOP</span> <span class="o">|</span> <span class="n">SPI_CLR_ERR</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#ifdef SUPPORT_SDIO_ASPM</span>
<span class="kt">void</span> <span class="n">dynamic_configure_sdio_aspm</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtsx_chip</span> <span class="o">*</span><span class="n">chip</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="cp">#endif  </span><span class="cm">/* __REALTEK_RTSX_CARD_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
