<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › staging › rtl8192e › rtllib.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>rtllib.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Merged with mainline rtllib.h in Aug 2004.  Original ieee802_11</span>
<span class="cm"> * remains copyright by the original authors</span>
<span class="cm"> *</span>
<span class="cm"> * Portions of the merged code are based on Host AP (software wireless</span>
<span class="cm"> * LAN access point) driver for Intersil Prism2/2.5/3.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2001-2002, SSH Communications Security Corp and Jouni Malinen</span>
<span class="cm"> * &lt;jkmaline@cc.hut.fi&gt;</span>
<span class="cm"> * Copyright (c) 2002-2003, Jouni Malinen &lt;jkmaline@cc.hut.fi&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * Adaption to a generic IEEE 802.11 stack by James Ketrenos</span>
<span class="cm"> * &lt;jketreno@linux.intel.com&gt;</span>
<span class="cm"> * Copyright (c) 2004, Intel Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * Modified for Realtek&#39;s wi-fi cards by Andrea Merello</span>
<span class="cm"> * &lt;andreamrl@tiscali.it&gt;</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License version 2 as</span>
<span class="cm"> * published by the Free Software Foundation. See README and COPYING for</span>
<span class="cm"> * more details.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef RTLLIB_H</span>
<span class="cp">#define RTLLIB_H</span>
<span class="cp">#include &lt;linux/if_ether.h&gt; </span><span class="cm">/* ETH_ALEN */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/kernel.h&gt;   </span><span class="cm">/* ARRAY_SIZE */</span><span class="cp"></span>
<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>
<span class="cp">#include &lt;linux/jiffies.h&gt;</span>
<span class="cp">#include &lt;linux/timer.h&gt;</span>
<span class="cp">#include &lt;linux/sched.h&gt;</span>
<span class="cp">#include &lt;linux/semaphore.h&gt;</span>

<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/wireless.h&gt;</span>

<span class="cp">#include &quot;rtllib_debug.h&quot;</span>
<span class="cp">#include &quot;rtl819x_HT.h&quot;</span>
<span class="cp">#include &quot;rtl819x_BA.h&quot;</span>
<span class="cp">#include &quot;rtl819x_TS.h&quot;</span>

<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;linux/if_arp.h&gt; </span><span class="cm">/* ARPHRD_ETHER */</span><span class="cp"></span>
<span class="cp">#include &lt;net/lib80211.h&gt;</span>

<span class="cp">#define MAX_PRECMD_CNT 16</span>
<span class="cp">#define MAX_RFDEPENDCMD_CNT 16</span>
<span class="cp">#define MAX_POSTCMD_CNT 16</span>

<span class="cp">#ifndef WIRELESS_SPY</span>
<span class="cp">#define WIRELESS_SPY</span>
<span class="cp">#endif</span>
<span class="cp">#include &lt;net/iw_handler.h&gt;</span>

<span class="cp">#ifndef IW_MODE_MONITOR</span>
<span class="cp">#define IW_MODE_MONITOR 6</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef IWEVCUSTOM</span>
<span class="cp">#define IWEVCUSTOM 0x8c02</span>
<span class="cp">#endif</span>

<span class="cp">#ifndef IW_CUSTOM_MAX</span>
<span class="cm">/* Max number of char in custom event - use multiple of them if needed */</span>
<span class="cp">#define IW_CUSTOM_MAX	256	</span><span class="cm">/* In bytes */</span><span class="cp"></span>
<span class="cp">#endif</span>

<span class="cp">#ifndef container_of</span>
<span class="cm">/**</span>
<span class="cm"> * container_of - cast a member of a structure out to the containing structure</span>
<span class="cm"> *</span>
<span class="cm"> * @ptr:	the pointer to the member.</span>
<span class="cm"> * @type:       the type of the container struct this is embedded in.</span>
<span class="cm"> * @member:     the name of the member within the struct.</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#define container_of(ptr, type, member) ({		      \</span>
<span class="cp">	const typeof(((type *)0)-&gt;member)*__mptr = (ptr);    \</span>
<span class="cp">	(type *)((char *)__mptr - offsetof(type, member)); })</span>
<span class="cp">#endif</span>

<span class="cp">#define skb_tail_pointer_rsl(skb) skb_tail_pointer(skb)</span>

<span class="cp">#define EXPORT_SYMBOL_RSL(x) EXPORT_SYMBOL(x)</span>


<span class="cp">#define queue_delayed_work_rsl(x, y, z) queue_delayed_work(x, y, z)</span>
<span class="cp">#define INIT_DELAYED_WORK_RSL(x, y, z) INIT_DELAYED_WORK(x, y)</span>

<span class="cp">#define queue_work_rsl(x, y) queue_work(x, y)</span>
<span class="cp">#define INIT_WORK_RSL(x, y, z) INIT_WORK(x, y)</span>

<span class="cp">#define container_of_work_rsl(x, y, z) container_of(x, y, z)</span>
<span class="cp">#define container_of_dwork_rsl(x, y, z)				\</span>
<span class="cp">	container_of(container_of(x, struct delayed_work, work), y, z)</span>

<span class="cp">#define iwe_stream_add_event_rsl(info, start, stop, iwe, len)	\</span>
<span class="cp">	iwe_stream_add_event(info, start, stop, iwe, len)</span>

<span class="cp">#define iwe_stream_add_point_rsl(info, start, stop, iwe, p)	\</span>
<span class="cp">	iwe_stream_add_point(info, start, stop, iwe, p)</span>

<span class="cp">#define usb_alloc_urb_rsl(x, y) usb_alloc_urb(x, y)</span>
<span class="cp">#define usb_submit_urb_rsl(x, y) usb_submit_urb(x, y)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">netdev_priv_rsl</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">netdev_priv</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">#define KEY_TYPE_NA		0x0</span>
<span class="cp">#define KEY_TYPE_WEP40		0x1</span>
<span class="cp">#define KEY_TYPE_TKIP		0x2</span>
<span class="cp">#define KEY_TYPE_CCMP		0x4</span>
<span class="cp">#define KEY_TYPE_WEP104		0x5</span>
<span class="cm">/* added for rtl819x tx procedure */</span>
<span class="cp">#define MAX_QUEUE_SIZE		0x10</span>

<span class="cp">#define BK_QUEUE			       0</span>
<span class="cp">#define BE_QUEUE			       1</span>
<span class="cp">#define VI_QUEUE			       2</span>
<span class="cp">#define VO_QUEUE			       3</span>
<span class="cp">#define HCCA_QUEUE			     4</span>
<span class="cp">#define TXCMD_QUEUE			    5</span>
<span class="cp">#define MGNT_QUEUE			     6</span>
<span class="cp">#define HIGH_QUEUE			     7</span>
<span class="cp">#define BEACON_QUEUE			   8</span>

<span class="cp">#define LOW_QUEUE			      BE_QUEUE</span>
<span class="cp">#define NORMAL_QUEUE			   MGNT_QUEUE</span>

<span class="cp">#ifndef IW_MODE_MESH</span>
<span class="cp">#define IW_MODE_MESH			7</span>
<span class="cp">#endif</span>
<span class="cp">#define AMSDU_SUBHEADER_LEN 14</span>
<span class="cp">#define SWRF_TIMEOUT				50</span>

<span class="cp">#define IE_CISCO_FLAG_POSITION		0x08</span>
<span class="cp">#define SUPPORT_CKIP_MIC			0x08</span>
<span class="cp">#define SUPPORT_CKIP_PK			0x10</span>
<span class="cp">#define	RT_RF_OFF_LEVL_ASPM			BIT0</span>
<span class="cp">#define	RT_RF_OFF_LEVL_CLK_REQ		BIT1</span>
<span class="cp">#define	RT_RF_OFF_LEVL_PCI_D3			BIT2</span>
<span class="cp">#define	RT_RF_OFF_LEVL_HALT_NIC		BIT3</span>
<span class="cp">#define	RT_RF_OFF_LEVL_FREE_FW		BIT4</span>
<span class="cp">#define	RT_RF_OFF_LEVL_FW_32K		BIT5</span>
<span class="cp">#define	RT_RF_PS_LEVEL_ALWAYS_ASPM	BIT6</span>
<span class="cp">#define	RT_RF_LPS_DISALBE_2R			BIT30</span>
<span class="cp">#define	RT_RF_LPS_LEVEL_ASPM			BIT31</span>
<span class="cp">#define	RT_IN_PS_LEVEL(pPSC, _PS_FLAG)		\</span>
<span class="cp">	((pPSC-&gt;CurPsLevel &amp; _PS_FLAG) ? true : false)</span>
<span class="cp">#define	RT_CLEAR_PS_LEVEL(pPSC, _PS_FLAG)	\</span>
<span class="cp">	(pPSC-&gt;CurPsLevel &amp;= (~(_PS_FLAG)))</span>
<span class="cp">#define	RT_SET_PS_LEVEL(pPSC, _PS_FLAG)	(pPSC-&gt;CurPsLevel |= _PS_FLAG)</span>

<span class="cm">/* defined for skb cb field */</span>
<span class="cm">/* At most 28 byte */</span>
<span class="k">struct</span> <span class="n">cb_desc</span> <span class="p">{</span>
	<span class="cm">/* Tx Desc Related flags (8-9) */</span>
	<span class="n">u8</span> <span class="n">bLastIniPkt</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bCmdOrInit</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bFirstSeg</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bLastSeg</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bEncrypt</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bTxDisableRateFallBack</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bTxUseDriverAssingedRate</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bHwSec</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">nStuckCount</span><span class="p">;</span>

	<span class="cm">/* Tx Firmware Related flags (10-11)*/</span>
	<span class="n">u8</span> <span class="n">bCTSEnable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSEnable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bUseShortGI</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bUseShortPreamble</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bTxEnableFwCalcDur</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bAMPDUEnable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSSTBC</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">RTSSC</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">bRTSBW</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bPacketBW</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSUseShortPreamble</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bRTSUseShortGI</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bMulticast</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bBroadcast</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">drv_agg_enable</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved2</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* Tx Desc related element(12-19) */</span>
	<span class="n">u8</span> <span class="n">rata_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">queue_index</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">txbuf_size</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">RATRIndex</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bAMSDU</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bFromAggrQ</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved6</span><span class="o">:</span><span class="mi">6</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">macId</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">priority</span><span class="p">;</span>

	<span class="cm">/* Tx firmware related element(20-27) */</span>
	<span class="n">u8</span> <span class="n">data_rate</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rts_rate</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ampdu_factor</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ampdu_density</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">DrvAggrNum</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bdhcp</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">pkt_size</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bIsSpecialDataFrame</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">bBTTxPacket</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bIsBTProbRsp</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">sw_chnl_cmd_id</span> <span class="p">{</span>
	<span class="n">CmdID_End</span><span class="p">,</span>
	<span class="n">CmdID_SetTxPowerLevel</span><span class="p">,</span>
	<span class="n">CmdID_BBRegWrite10</span><span class="p">,</span>
	<span class="n">CmdID_WritePortUlong</span><span class="p">,</span>
	<span class="n">CmdID_WritePortUshort</span><span class="p">,</span>
	<span class="n">CmdID_WritePortUchar</span><span class="p">,</span>
	<span class="n">CmdID_RF_WriteReg</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">sw_chnl_cmd</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="n">sw_chnl_cmd_id</span> <span class="n">CmdID</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">Para1</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">Para2</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">msDelay</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/*--------------------------Define -------------------------------------------*/</span>
<span class="cp">#define MGN_1M		  0x02</span>
<span class="cp">#define MGN_2M		  0x04</span>
<span class="cp">#define MGN_5_5M		0x0b</span>
<span class="cp">#define MGN_11M		 0x16</span>

<span class="cp">#define MGN_6M		  0x0c</span>
<span class="cp">#define MGN_9M		  0x12</span>
<span class="cp">#define MGN_12M		 0x18</span>
<span class="cp">#define MGN_18M		 0x24</span>
<span class="cp">#define MGN_24M		 0x30</span>
<span class="cp">#define MGN_36M		 0x48</span>
<span class="cp">#define MGN_48M		 0x60</span>
<span class="cp">#define MGN_54M		 0x6c</span>

<span class="cp">#define MGN_MCS0		0x80</span>
<span class="cp">#define MGN_MCS1		0x81</span>
<span class="cp">#define MGN_MCS2		0x82</span>
<span class="cp">#define MGN_MCS3		0x83</span>
<span class="cp">#define MGN_MCS4		0x84</span>
<span class="cp">#define MGN_MCS5		0x85</span>
<span class="cp">#define MGN_MCS6		0x86</span>
<span class="cp">#define MGN_MCS7		0x87</span>
<span class="cp">#define MGN_MCS8		0x88</span>
<span class="cp">#define MGN_MCS9		0x89</span>
<span class="cp">#define MGN_MCS10	       0x8a</span>
<span class="cp">#define MGN_MCS11	       0x8b</span>
<span class="cp">#define MGN_MCS12	       0x8c</span>
<span class="cp">#define MGN_MCS13	       0x8d</span>
<span class="cp">#define MGN_MCS14	       0x8e</span>
<span class="cp">#define MGN_MCS15	       0x8f</span>
<span class="cp">#define	MGN_MCS0_SG			0x90</span>
<span class="cp">#define	MGN_MCS1_SG			0x91</span>
<span class="cp">#define	MGN_MCS2_SG			0x92</span>
<span class="cp">#define	MGN_MCS3_SG			0x93</span>
<span class="cp">#define	MGN_MCS4_SG			0x94</span>
<span class="cp">#define	MGN_MCS5_SG			0x95</span>
<span class="cp">#define	MGN_MCS6_SG			0x96</span>
<span class="cp">#define	MGN_MCS7_SG			0x97</span>
<span class="cp">#define	MGN_MCS8_SG			0x98</span>
<span class="cp">#define	MGN_MCS9_SG			0x99</span>
<span class="cp">#define	MGN_MCS10_SG		0x9a</span>
<span class="cp">#define	MGN_MCS11_SG		0x9b</span>
<span class="cp">#define	MGN_MCS12_SG		0x9c</span>
<span class="cp">#define	MGN_MCS13_SG		0x9d</span>
<span class="cp">#define	MGN_MCS14_SG		0x9e</span>
<span class="cp">#define	MGN_MCS15_SG		0x9f</span>


<span class="k">enum</span>	<span class="n">_ReasonCode</span> <span class="p">{</span>
	<span class="n">unspec_reason</span>	<span class="o">=</span> <span class="mh">0x1</span><span class="p">,</span>
	<span class="n">auth_not_valid</span>	<span class="o">=</span> <span class="mh">0x2</span><span class="p">,</span>
	<span class="n">deauth_lv_ss</span>	<span class="o">=</span> <span class="mh">0x3</span><span class="p">,</span>
	<span class="n">inactivity</span>		<span class="o">=</span> <span class="mh">0x4</span><span class="p">,</span>
	<span class="n">ap_overload</span>	<span class="o">=</span> <span class="mh">0x5</span><span class="p">,</span>
	<span class="n">class2_err</span>		<span class="o">=</span> <span class="mh">0x6</span><span class="p">,</span>
	<span class="n">class3_err</span>		<span class="o">=</span> <span class="mh">0x7</span><span class="p">,</span>
	<span class="n">disas_lv_ss</span>	<span class="o">=</span> <span class="mh">0x8</span><span class="p">,</span>
	<span class="n">asoc_not_auth</span>	<span class="o">=</span> <span class="mh">0x9</span><span class="p">,</span>

	<span class="n">mic_failure</span>	<span class="o">=</span> <span class="mh">0xe</span><span class="p">,</span>

	<span class="n">invalid_IE</span>		<span class="o">=</span> <span class="mh">0x0d</span><span class="p">,</span>
	<span class="n">four_way_tmout</span>	<span class="o">=</span> <span class="mh">0x0f</span><span class="p">,</span>
	<span class="n">two_way_tmout</span>	<span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">IE_dismatch</span>	<span class="o">=</span> <span class="mh">0x11</span><span class="p">,</span>
	<span class="n">invalid_Gcipher</span> <span class="o">=</span> <span class="mh">0x12</span><span class="p">,</span>
	<span class="n">invalid_Pcipher</span> <span class="o">=</span> <span class="mh">0x13</span><span class="p">,</span>
	<span class="n">invalid_AKMP</span>	<span class="o">=</span> <span class="mh">0x14</span><span class="p">,</span>
	<span class="n">unsup_RSNIEver</span> <span class="o">=</span> <span class="mh">0x15</span><span class="p">,</span>
	<span class="n">invalid_RSNIE</span>	<span class="o">=</span> <span class="mh">0x16</span><span class="p">,</span>
	<span class="n">auth_802_1x_fail</span> <span class="o">=</span> <span class="mh">0x17</span><span class="p">,</span>
	<span class="n">ciper_reject</span>		<span class="o">=</span> <span class="mh">0x18</span><span class="p">,</span>

	<span class="n">QoS_unspec</span>		<span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>
	<span class="n">QAP_bandwidth</span>	<span class="o">=</span> <span class="mh">0x21</span><span class="p">,</span>
	<span class="n">poor_condition</span>	<span class="o">=</span> <span class="mh">0x22</span><span class="p">,</span>
	<span class="n">no_facility</span>	<span class="o">=</span> <span class="mh">0x23</span><span class="p">,</span>
	<span class="n">req_declined</span>	<span class="o">=</span> <span class="mh">0x25</span><span class="p">,</span>
	<span class="n">invalid_param</span>	<span class="o">=</span> <span class="mh">0x26</span><span class="p">,</span>
	<span class="n">req_not_honored</span> <span class="o">=</span> <span class="mh">0x27</span><span class="p">,</span>
	<span class="n">TS_not_created</span>	<span class="o">=</span> <span class="mh">0x2F</span><span class="p">,</span>
	<span class="n">DL_not_allowed</span>	<span class="o">=</span> <span class="mh">0x30</span><span class="p">,</span>
	<span class="n">dest_not_exist</span>	<span class="o">=</span> <span class="mh">0x31</span><span class="p">,</span>
	<span class="n">dest_not_QSTA</span>	<span class="o">=</span> <span class="mh">0x32</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">hal_def_variable</span> <span class="p">{</span>
	<span class="n">HAL_DEF_TPC_ENABLE</span><span class="p">,</span>
	<span class="n">HAL_DEF_INIT_GAIN</span><span class="p">,</span>
	<span class="n">HAL_DEF_PROT_IMP_MODE</span><span class="p">,</span>
	<span class="n">HAL_DEF_HIGH_POWER_MECHANISM</span><span class="p">,</span>
	<span class="n">HAL_DEF_RATE_ADAPTIVE_MECHANISM</span><span class="p">,</span>
	<span class="n">HAL_DEF_ANTENNA_DIVERSITY_MECHANISM</span><span class="p">,</span>
	<span class="n">HAL_DEF_LED</span><span class="p">,</span>
	<span class="n">HAL_DEF_CW_MAX_MIN</span><span class="p">,</span>

	<span class="n">HAL_DEF_WOWLAN</span><span class="p">,</span>
	<span class="n">HAL_DEF_ENDPOINTS</span><span class="p">,</span>
	<span class="n">HAL_DEF_MIN_TX_POWER_DBM</span><span class="p">,</span>
	<span class="n">HAL_DEF_MAX_TX_POWER_DBM</span><span class="p">,</span>
	<span class="n">HW_DEF_EFUSE_REPG_SECTION1_FLAG</span><span class="p">,</span>
	<span class="n">HW_DEF_EFUSE_REPG_DATA</span><span class="p">,</span>
	<span class="n">HW_DEF_GPIO</span><span class="p">,</span>
	<span class="n">HAL_DEF_PCI_SUPPORT_ASPM</span><span class="p">,</span>
	<span class="n">HAL_DEF_THERMAL_VALUE</span><span class="p">,</span>
	<span class="n">HAL_DEF_USB_IN_TOKEN_REV</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">hw_variables</span> <span class="p">{</span>
	<span class="n">HW_VAR_ETHER_ADDR</span><span class="p">,</span>
	<span class="n">HW_VAR_MULTICAST_REG</span><span class="p">,</span>
	<span class="n">HW_VAR_BASIC_RATE</span><span class="p">,</span>
	<span class="n">HW_VAR_BSSID</span><span class="p">,</span>
	<span class="n">HW_VAR_MEDIA_STATUS</span><span class="p">,</span>
	<span class="n">HW_VAR_SECURITY_CONF</span><span class="p">,</span>
	<span class="n">HW_VAR_BEACON_INTERVAL</span><span class="p">,</span>
	<span class="n">HW_VAR_ATIM_WINDOW</span><span class="p">,</span>
	<span class="n">HW_VAR_LISTEN_INTERVAL</span><span class="p">,</span>
	<span class="n">HW_VAR_CS_COUNTER</span><span class="p">,</span>
	<span class="n">HW_VAR_DEFAULTKEY0</span><span class="p">,</span>
	<span class="n">HW_VAR_DEFAULTKEY1</span><span class="p">,</span>
	<span class="n">HW_VAR_DEFAULTKEY2</span><span class="p">,</span>
	<span class="n">HW_VAR_DEFAULTKEY3</span><span class="p">,</span>
	<span class="n">HW_VAR_SIFS</span><span class="p">,</span>
	<span class="n">HW_VAR_DIFS</span><span class="p">,</span>
	<span class="n">HW_VAR_EIFS</span><span class="p">,</span>
	<span class="n">HW_VAR_SLOT_TIME</span><span class="p">,</span>
	<span class="n">HW_VAR_ACK_PREAMBLE</span><span class="p">,</span>
	<span class="n">HW_VAR_CW_CONFIG</span><span class="p">,</span>
	<span class="n">HW_VAR_CW_VALUES</span><span class="p">,</span>
	<span class="n">HW_VAR_RATE_FALLBACK_CONTROL</span><span class="p">,</span>
	<span class="n">HW_VAR_CONTENTION_WINDOW</span><span class="p">,</span>
	<span class="n">HW_VAR_RETRY_COUNT</span><span class="p">,</span>
	<span class="n">HW_VAR_TR_SWITCH</span><span class="p">,</span>
	<span class="n">HW_VAR_COMMAND</span><span class="p">,</span>
	<span class="n">HW_VAR_WPA_CONFIG</span><span class="p">,</span>
	<span class="n">HW_VAR_AMPDU_MIN_SPACE</span><span class="p">,</span>
	<span class="n">HW_VAR_SHORTGI_DENSITY</span><span class="p">,</span>
	<span class="n">HW_VAR_AMPDU_FACTOR</span><span class="p">,</span>
	<span class="n">HW_VAR_MCS_RATE_AVAILABLE</span><span class="p">,</span>
	<span class="n">HW_VAR_AC_PARAM</span><span class="p">,</span>
	<span class="n">HW_VAR_ACM_CTRL</span><span class="p">,</span>
	<span class="n">HW_VAR_DIS_Req_Qsize</span><span class="p">,</span>
	<span class="n">HW_VAR_CCX_CHNL_LOAD</span><span class="p">,</span>
	<span class="n">HW_VAR_CCX_NOISE_HISTOGRAM</span><span class="p">,</span>
	<span class="n">HW_VAR_CCX_CLM_NHM</span><span class="p">,</span>
	<span class="n">HW_VAR_TxOPLimit</span><span class="p">,</span>
	<span class="n">HW_VAR_TURBO_MODE</span><span class="p">,</span>
	<span class="n">HW_VAR_RF_STATE</span><span class="p">,</span>
	<span class="n">HW_VAR_RF_OFF_BY_HW</span><span class="p">,</span>
	<span class="n">HW_VAR_BUS_SPEED</span><span class="p">,</span>
	<span class="n">HW_VAR_SET_DEV_POWER</span><span class="p">,</span>

	<span class="n">HW_VAR_RCR</span><span class="p">,</span>
	<span class="n">HW_VAR_RATR_0</span><span class="p">,</span>
	<span class="n">HW_VAR_RRSR</span><span class="p">,</span>
	<span class="n">HW_VAR_CPU_RST</span><span class="p">,</span>
	<span class="n">HW_VAR_CECHK_BSSID</span><span class="p">,</span>
	<span class="n">HW_VAR_LBK_MODE</span><span class="p">,</span>
	<span class="n">HW_VAR_AES_11N_FIX</span><span class="p">,</span>
	<span class="n">HW_VAR_USB_RX_AGGR</span><span class="p">,</span>
	<span class="n">HW_VAR_USER_CONTROL_TURBO_MODE</span><span class="p">,</span>
	<span class="n">HW_VAR_RETRY_LIMIT</span><span class="p">,</span>
	<span class="n">HW_VAR_INIT_TX_RATE</span><span class="p">,</span>
	<span class="n">HW_VAR_TX_RATE_REG</span><span class="p">,</span>
	<span class="n">HW_VAR_EFUSE_USAGE</span><span class="p">,</span>
	<span class="n">HW_VAR_EFUSE_BYTES</span><span class="p">,</span>
	<span class="n">HW_VAR_AUTOLOAD_STATUS</span><span class="p">,</span>
	<span class="n">HW_VAR_RF_2R_DISABLE</span><span class="p">,</span>
	<span class="n">HW_VAR_SET_RPWM</span><span class="p">,</span>
	<span class="n">HW_VAR_H2C_FW_PWRMODE</span><span class="p">,</span>
	<span class="n">HW_VAR_H2C_FW_JOINBSSRPT</span><span class="p">,</span>
	<span class="n">HW_VAR_1X1_RECV_COMBINE</span><span class="p">,</span>
	<span class="n">HW_VAR_STOP_SEND_BEACON</span><span class="p">,</span>
	<span class="n">HW_VAR_TSF_TIMER</span><span class="p">,</span>
	<span class="n">HW_VAR_IO_CMD</span><span class="p">,</span>

	<span class="n">HW_VAR_RF_RECOVERY</span><span class="p">,</span>
	<span class="n">HW_VAR_H2C_FW_UPDATE_GTK</span><span class="p">,</span>
	<span class="n">HW_VAR_WF_MASK</span><span class="p">,</span>
	<span class="n">HW_VAR_WF_CRC</span><span class="p">,</span>
	<span class="n">HW_VAR_WF_IS_MAC_ADDR</span><span class="p">,</span>
	<span class="n">HW_VAR_H2C_FW_OFFLOAD</span><span class="p">,</span>
	<span class="n">HW_VAR_RESET_WFCRC</span><span class="p">,</span>

	<span class="n">HW_VAR_HANDLE_FW_C2H</span><span class="p">,</span>
	<span class="n">HW_VAR_DL_FW_RSVD_PAGE</span><span class="p">,</span>
	<span class="n">HW_VAR_AID</span><span class="p">,</span>
	<span class="n">HW_VAR_HW_SEQ_ENABLE</span><span class="p">,</span>
	<span class="n">HW_VAR_CORRECT_TSF</span><span class="p">,</span>
	<span class="n">HW_VAR_BCN_VALID</span><span class="p">,</span>
	<span class="n">HW_VAR_FWLPS_RF_ON</span><span class="p">,</span>
	<span class="n">HW_VAR_DUAL_TSF_RST</span><span class="p">,</span>
	<span class="n">HW_VAR_SWITCH_EPHY_WoWLAN</span><span class="p">,</span>
	<span class="n">HW_VAR_INT_MIGRATION</span><span class="p">,</span>
	<span class="n">HW_VAR_INT_AC</span><span class="p">,</span>
	<span class="n">HW_VAR_RF_TIMING</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">rt_op_mode</span> <span class="p">{</span>
	<span class="n">RT_OP_MODE_AP</span><span class="p">,</span>
	<span class="n">RT_OP_MODE_INFRASTRUCTURE</span><span class="p">,</span>
	<span class="n">RT_OP_MODE_IBSS</span><span class="p">,</span>
	<span class="n">RT_OP_MODE_NO_LINK</span><span class="p">,</span>
<span class="p">};</span>


<span class="cp">#define aSifsTime						\</span>
<span class="cp">	 (((priv-&gt;rtllib-&gt;current_network.mode == IEEE_A)	\</span>
<span class="cp">	|| (priv-&gt;rtllib-&gt;current_network.mode == IEEE_N_24G)	\</span>
<span class="cp">	|| (priv-&gt;rtllib-&gt;current_network.mode == IEEE_N_5G)) ? 16 : 10)</span>

<span class="cp">#define MGMT_QUEUE_NUM 5</span>

<span class="cp">#define IEEE_CMD_SET_WPA_PARAM			1</span>
<span class="cp">#define	IEEE_CMD_SET_WPA_IE			2</span>
<span class="cp">#define IEEE_CMD_SET_ENCRYPTION			3</span>
<span class="cp">#define IEEE_CMD_MLME				4</span>

<span class="cp">#define IEEE_PARAM_WPA_ENABLED			1</span>
<span class="cp">#define IEEE_PARAM_TKIP_COUNTERMEASURES		2</span>
<span class="cp">#define IEEE_PARAM_DROP_UNENCRYPTED		3</span>
<span class="cp">#define IEEE_PARAM_PRIVACY_INVOKED		4</span>
<span class="cp">#define IEEE_PARAM_AUTH_ALGS			5</span>
<span class="cp">#define IEEE_PARAM_IEEE_802_1X			6</span>
<span class="cp">#define IEEE_PARAM_WPAX_SELECT			7</span>
<span class="cp">#define IEEE_PROTO_WPA				1</span>
<span class="cp">#define IEEE_PROTO_RSN				2</span>
<span class="cp">#define IEEE_WPAX_USEGROUP			0</span>
<span class="cp">#define IEEE_WPAX_WEP40				1</span>
<span class="cp">#define IEEE_WPAX_TKIP				2</span>
<span class="cp">#define IEEE_WPAX_WRAP				3</span>
<span class="cp">#define IEEE_WPAX_CCMP				4</span>
<span class="cp">#define IEEE_WPAX_WEP104			5</span>

<span class="cp">#define IEEE_KEY_MGMT_IEEE8021X			1</span>
<span class="cp">#define IEEE_KEY_MGMT_PSK			2</span>

<span class="cp">#define IEEE_MLME_STA_DEAUTH			1</span>
<span class="cp">#define IEEE_MLME_STA_DISASSOC			2</span>


<span class="cp">#define IEEE_CRYPT_ERR_UNKNOWN_ALG		2</span>
<span class="cp">#define IEEE_CRYPT_ERR_UNKNOWN_ADDR		3</span>
<span class="cp">#define IEEE_CRYPT_ERR_CRYPT_INIT_FAILED	4</span>
<span class="cp">#define IEEE_CRYPT_ERR_KEY_SET_FAILED		5</span>
<span class="cp">#define IEEE_CRYPT_ERR_TX_KEY_SET_FAILED	6</span>
<span class="cp">#define IEEE_CRYPT_ERR_CARD_CONF_FAILED		7</span>
<span class="cp">#define	IEEE_CRYPT_ALG_NAME_LEN			16</span>

<span class="cp">#define MAX_IE_LEN  0xff</span>
<span class="cp">#define RT_ASSERT_RET(_Exp) do {} while (0)</span>
<span class="cp">#define RT_ASSERT_RET_VALUE(_Exp, Ret)		\</span>
<span class="cp">	do {} while (0)</span>

<span class="k">struct</span> <span class="n">ieee_param</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">sta_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">name</span><span class="p">;</span>
			<span class="n">u32</span> <span class="n">value</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">wpa_param</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u32</span> <span class="n">len</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
			<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">wpa_ie</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="kt">int</span> <span class="n">command</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">reason_code</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">mlme</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span> <span class="n">alg</span><span class="p">[</span><span class="n">IEEE_CRYPT_ALG_NAME_LEN</span><span class="p">];</span>
			<span class="n">u8</span> <span class="n">set_tx</span><span class="p">;</span>
			<span class="n">u32</span> <span class="n">err</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">idx</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">seq</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span> <span class="cm">/* sequence counter (set: RX, get: TX) */</span>
			<span class="n">u16</span> <span class="n">key_len</span><span class="p">;</span>
			<span class="n">u8</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="p">}</span> <span class="n">crypt</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">};</span>


<span class="cp">#if WIRELESS_EXT &lt; 17</span>
<span class="cp">#define IW_QUAL_QUAL_INVALID   0x10</span>
<span class="cp">#define IW_QUAL_LEVEL_INVALID  0x20</span>
<span class="cp">#define IW_QUAL_NOISE_INVALID  0x40</span>
<span class="cp">#define IW_QUAL_QUAL_UPDATED   0x1</span>
<span class="cp">#define IW_QUAL_LEVEL_UPDATED  0x2</span>
<span class="cp">#define IW_QUAL_NOISE_UPDATED  0x4</span>
<span class="cp">#endif</span>

<span class="cp">#define MSECS(t) msecs_to_jiffies(t)</span>
<span class="cp">#define msleep_interruptible_rsl  msleep_interruptible</span>

<span class="cp">#define RTLLIB_DATA_LEN		2304</span>
<span class="cm">/* Maximum size for the MA-UNITDATA primitive, 802.11 standard section</span>
<span class="cm">   6.2.1.1.2.</span>

<span class="cm">   The figure in section 7.1.2 suggests a body size of up to 2312</span>
<span class="cm">   bytes is allowed, which is a bit confusing, I suspect this</span>
<span class="cm">   represents the 2304 bytes of real data, plus a possible 8 bytes of</span>
<span class="cm">   WEP IV and ICV. (this interpretation suggested by Ramiro Barreiro) */</span>
<span class="cp">#define RTLLIB_1ADDR_LEN 10</span>
<span class="cp">#define RTLLIB_2ADDR_LEN 16</span>
<span class="cp">#define RTLLIB_3ADDR_LEN 24</span>
<span class="cp">#define RTLLIB_4ADDR_LEN 30</span>
<span class="cp">#define RTLLIB_FCS_LEN    4</span>
<span class="cp">#define RTLLIB_HLEN		  (RTLLIB_4ADDR_LEN)</span>
<span class="cp">#define RTLLIB_FRAME_LEN	     (RTLLIB_DATA_LEN + RTLLIB_HLEN)</span>
<span class="cp">#define RTLLIB_MGMT_HDR_LEN 24</span>
<span class="cp">#define RTLLIB_DATA_HDR3_LEN 24</span>
<span class="cp">#define RTLLIB_DATA_HDR4_LEN 30</span>

<span class="cp">#define RTLLIB_SKBBUFFER_SIZE 2500</span>

<span class="cp">#define MIN_FRAG_THRESHOLD     256U</span>
<span class="cp">#define MAX_FRAG_THRESHOLD     2346U</span>
<span class="cp">#define MAX_HT_DATA_FRAG_THRESHOLD 0x2000</span>

<span class="cp">#define HT_AMSDU_SIZE_4K 3839</span>
<span class="cp">#define HT_AMSDU_SIZE_8K 7935</span>

<span class="cm">/* Frame control field constants */</span>
<span class="cp">#define RTLLIB_FCTL_VERS		0x0003</span>
<span class="cp">#define RTLLIB_FCTL_FTYPE		0x000c</span>
<span class="cp">#define RTLLIB_FCTL_STYPE		0x00f0</span>
<span class="cp">#define RTLLIB_FCTL_FRAMETYPE	0x00fc</span>
<span class="cp">#define RTLLIB_FCTL_TODS		0x0100</span>
<span class="cp">#define RTLLIB_FCTL_FROMDS		0x0200</span>
<span class="cp">#define RTLLIB_FCTL_DSTODS		0x0300</span>
<span class="cp">#define RTLLIB_FCTL_MOREFRAGS	0x0400</span>
<span class="cp">#define RTLLIB_FCTL_RETRY		0x0800</span>
<span class="cp">#define RTLLIB_FCTL_PM		0x1000</span>
<span class="cp">#define RTLLIB_FCTL_MOREDATA		0x2000</span>
<span class="cp">#define RTLLIB_FCTL_WEP		0x4000</span>
<span class="cp">#define RTLLIB_FCTL_ORDER		0x8000</span>

<span class="cp">#define RTLLIB_FTYPE_MGMT		0x0000</span>
<span class="cp">#define RTLLIB_FTYPE_CTL		0x0004</span>
<span class="cp">#define RTLLIB_FTYPE_DATA		0x0008</span>

<span class="cm">/* management */</span>
<span class="cp">#define RTLLIB_STYPE_ASSOC_REQ	0x0000</span>
<span class="cp">#define RTLLIB_STYPE_ASSOC_RESP		0x0010</span>
<span class="cp">#define RTLLIB_STYPE_REASSOC_REQ	0x0020</span>
<span class="cp">#define RTLLIB_STYPE_REASSOC_RESP	0x0030</span>
<span class="cp">#define RTLLIB_STYPE_PROBE_REQ	0x0040</span>
<span class="cp">#define RTLLIB_STYPE_PROBE_RESP	0x0050</span>
<span class="cp">#define RTLLIB_STYPE_BEACON		0x0080</span>
<span class="cp">#define RTLLIB_STYPE_ATIM		0x0090</span>
<span class="cp">#define RTLLIB_STYPE_DISASSOC	0x00A0</span>
<span class="cp">#define RTLLIB_STYPE_AUTH		0x00B0</span>
<span class="cp">#define RTLLIB_STYPE_DEAUTH		0x00C0</span>
<span class="cp">#define RTLLIB_STYPE_MANAGE_ACT	0x00D0</span>

<span class="cm">/* control */</span>
<span class="cp">#define RTLLIB_STYPE_PSPOLL		0x00A0</span>
<span class="cp">#define RTLLIB_STYPE_RTS		0x00B0</span>
<span class="cp">#define RTLLIB_STYPE_CTS		0x00C0</span>
<span class="cp">#define RTLLIB_STYPE_ACK		0x00D0</span>
<span class="cp">#define RTLLIB_STYPE_CFEND		0x00E0</span>
<span class="cp">#define RTLLIB_STYPE_CFENDACK	0x00F0</span>
<span class="cp">#define RTLLIB_STYPE_BLOCKACK   0x0094</span>

<span class="cm">/* data */</span>
<span class="cp">#define RTLLIB_STYPE_DATA		0x0000</span>
<span class="cp">#define RTLLIB_STYPE_DATA_CFACK	0x0010</span>
<span class="cp">#define RTLLIB_STYPE_DATA_CFPOLL	0x0020</span>
<span class="cp">#define RTLLIB_STYPE_DATA_CFACKPOLL	0x0030</span>
<span class="cp">#define RTLLIB_STYPE_NULLFUNC	0x0040</span>
<span class="cp">#define RTLLIB_STYPE_CFACK		0x0050</span>
<span class="cp">#define RTLLIB_STYPE_CFPOLL		0x0060</span>
<span class="cp">#define RTLLIB_STYPE_CFACKPOLL	0x0070</span>
<span class="cp">#define RTLLIB_STYPE_QOS_DATA	0x0080</span>
<span class="cp">#define RTLLIB_STYPE_QOS_NULL	0x00C0</span>

<span class="cp">#define RTLLIB_SCTL_FRAG		0x000F</span>
<span class="cp">#define RTLLIB_SCTL_SEQ		0xFFF0</span>

<span class="cm">/* QOS control */</span>
<span class="cp">#define RTLLIB_QCTL_TID	      0x000F</span>

<span class="cp">#define	FC_QOS_BIT					BIT7</span>
<span class="cp">#define IsDataFrame(pdu)	(((pdu[0] &amp; 0x0C) == 0x08) ? true : false)</span>
<span class="cp">#define	IsLegacyDataFrame(pdu)	(IsDataFrame(pdu) &amp;&amp; (!(pdu[0]&amp;FC_QOS_BIT)))</span>
<span class="cp">#define IsQoSDataFrame(pframe)			\</span>
<span class="cp">	((*(u16 *)pframe&amp;(RTLLIB_STYPE_QOS_DATA|RTLLIB_FTYPE_DATA)) ==	\</span>
<span class="cp">	(RTLLIB_STYPE_QOS_DATA|RTLLIB_FTYPE_DATA))</span>
<span class="cp">#define Frame_Order(pframe)     (*(u16 *)pframe&amp;RTLLIB_FCTL_ORDER)</span>
<span class="cp">#define SN_LESS(a, b)		(((a-b)&amp;0x800) != 0)</span>
<span class="cp">#define SN_EQUAL(a, b)	(a == b)</span>
<span class="cp">#define MAX_DEV_ADDR_SIZE 8</span>

<span class="k">enum</span> <span class="n">act_category</span> <span class="p">{</span>
	<span class="n">ACT_CAT_QOS</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ACT_CAT_DLS</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ACT_CAT_BA</span>  <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">ACT_CAT_HT</span>  <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">ACT_CAT_WMM</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ts_action</span> <span class="p">{</span>
	<span class="n">ACT_ADDTSREQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">ACT_ADDTSRSP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ACT_DELTS</span>    <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">ACT_SCHEDULE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ba_action</span> <span class="p">{</span>
	<span class="n">ACT_ADDBAREQ</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">ACT_ADDBARSP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">ACT_DELBA</span>    <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">init_gain_op_type</span> <span class="p">{</span>
	<span class="n">IG_Backup</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">IG_Restore</span><span class="p">,</span>
	<span class="n">IG_Max</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">led_ctl_mode</span> <span class="p">{</span>
	<span class="n">LED_CTL_POWER_ON</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">LED_CTL_LINK</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">LED_CTL_NO_LINK</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">LED_CTL_TX</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">LED_CTL_RX</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">LED_CTL_SITE_SURVEY</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">LED_CTL_POWER_OFF</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">LED_CTL_START_TO_LINK</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">LED_CTL_START_WPS</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">LED_CTL_STOP_WPS</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">LED_CTL_START_WPS_BOTTON</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">LED_CTL_STOP_WPS_FAIL</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	 <span class="n">LED_CTL_STOP_WPS_FAIL_OVERLAP</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">rt_rf_type_def</span> <span class="p">{</span>
	<span class="n">RF_1T2R</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">RF_2T4R</span><span class="p">,</span>
	<span class="n">RF_2T2R</span><span class="p">,</span>
	<span class="n">RF_1T1R</span><span class="p">,</span>
	<span class="n">RF_2T2R_GREEN</span><span class="p">,</span>
	<span class="n">RF_819X_MAX_TYPE</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">wireless_mode</span> <span class="p">{</span>
	<span class="n">WIRELESS_MODE_UNKNOWN</span> <span class="o">=</span> <span class="mh">0x00</span><span class="p">,</span>
	<span class="n">WIRELESS_MODE_A</span> <span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">WIRELESS_MODE_B</span> <span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">WIRELESS_MODE_G</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
	<span class="n">WIRELESS_MODE_AUTO</span> <span class="o">=</span> <span class="mh">0x08</span><span class="p">,</span>
	<span class="n">WIRELESS_MODE_N_24G</span> <span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>
	<span class="n">WIRELESS_MODE_N_5G</span> <span class="o">=</span> <span class="mh">0x20</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">wireless_network_type</span> <span class="p">{</span>
	<span class="n">WIRELESS_11B</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">WIRELESS_11G</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">WIRELESS_11A</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">WIRELESS_11N</span> <span class="o">=</span> <span class="mi">8</span>
<span class="p">};</span>

<span class="cp">#define OUI_SUBTYPE_WMM_INFO		0</span>
<span class="cp">#define OUI_SUBTYPE_WMM_PARAM	1</span>
<span class="cp">#define OUI_SUBTYPE_QOS_CAPABI	5</span>

<span class="cm">/* debug macros */</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">rtllib_debug_level</span><span class="p">;</span>
<span class="cp">#define RTLLIB_DEBUG(level, fmt, args...) \</span>
<span class="cp">do {								\</span>
<span class="cp">	if (rtllib_debug_level &amp; (level))			\</span>
<span class="cp">		printk(KERN_DEBUG &quot;rtllib: &quot; fmt, ## args);	\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define RTLLIB_DEBUG_DATA(level, data, datalen)	\</span>
<span class="cp">	do {							\</span>
<span class="cp">		if ((rtllib_debug_level &amp; (level)) == (level)) {	\</span>
<span class="cp">			int i;					\</span>
<span class="cp">			u8 *pdata = (u8 *)data;			\</span>
<span class="cp">			printk(KERN_DEBUG &quot;rtllib: %s()\n&quot;, __func__);	\</span>
<span class="cp">			for (i = 0; i &lt; (int)(datalen); i++)	{	\</span>
<span class="cp">				printk(&quot;%2.2x &quot;, pdata[i]);		\</span>
<span class="cp">				if ((i+1)%16 == 0)			\</span>
<span class="cp">					printk(&quot;\n&quot;);	\</span>
<span class="cp">			}				\</span>
<span class="cp">			printk(&quot;\n&quot;);			\</span>
<span class="cp">		}					\</span>
<span class="cp">	} while (0)</span>

<span class="cm">/*</span>
<span class="cm"> * To use the debug system;</span>
<span class="cm"> *</span>
<span class="cm"> * If you are defining a new debug classification, simply add it to the #define</span>
<span class="cm"> * list here in the form of:</span>
<span class="cm"> *</span>
<span class="cm"> * #define RTLLIB_DL_xxxx VALUE</span>
<span class="cm"> *</span>
<span class="cm"> * shifting value to the left one bit from the previous entry.  xxxx should be</span>
<span class="cm"> * the name of the classification (for example, WEP)</span>
<span class="cm"> *</span>
<span class="cm"> * You then need to either add a RTLLIB_xxxx_DEBUG() macro definition for your</span>
<span class="cm"> * classification, or use RTLLIB_DEBUG(RTLLIB_DL_xxxx, ...) whenever you want</span>
<span class="cm"> * to send output to that classification.</span>
<span class="cm"> *</span>
<span class="cm"> * To add your debug level to the list of levels seen when you perform</span>
<span class="cm"> *</span>
<span class="cm"> * % cat /proc/net/ipw/debug_level</span>
<span class="cm"> *</span>
<span class="cm"> * you simply need to add your entry to the ipw_debug_levels array.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#define RTLLIB_DL_INFO	  (1&lt;&lt;0)</span>
<span class="cp">#define RTLLIB_DL_WX	    (1&lt;&lt;1)</span>
<span class="cp">#define RTLLIB_DL_SCAN	  (1&lt;&lt;2)</span>
<span class="cp">#define RTLLIB_DL_STATE	 (1&lt;&lt;3)</span>
<span class="cp">#define RTLLIB_DL_MGMT	  (1&lt;&lt;4)</span>
<span class="cp">#define RTLLIB_DL_FRAG	  (1&lt;&lt;5)</span>
<span class="cp">#define RTLLIB_DL_EAP	   (1&lt;&lt;6)</span>
<span class="cp">#define RTLLIB_DL_DROP	  (1&lt;&lt;7)</span>

<span class="cp">#define RTLLIB_DL_TX	    (1&lt;&lt;8)</span>
<span class="cp">#define RTLLIB_DL_RX	    (1&lt;&lt;9)</span>

<span class="cp">#define RTLLIB_DL_HT		   (1&lt;&lt;10)</span>
<span class="cp">#define RTLLIB_DL_BA		   (1&lt;&lt;11)</span>
<span class="cp">#define RTLLIB_DL_TS		   (1&lt;&lt;12)</span>
<span class="cp">#define RTLLIB_DL_QOS	   (1&lt;&lt;13)</span>
<span class="cp">#define RTLLIB_DL_REORDER	   (1&lt;&lt;14)</span>
<span class="cp">#define RTLLIB_DL_IOT	   (1&lt;&lt;15)</span>
<span class="cp">#define RTLLIB_DL_IPS	   (1&lt;&lt;16)</span>
<span class="cp">#define RTLLIB_DL_TRACE	   (1&lt;&lt;29)</span>
<span class="cp">#define RTLLIB_DL_DATA	   (1&lt;&lt;30)</span>
<span class="cp">#define RTLLIB_DL_ERR	   (1&lt;&lt;31)</span>
<span class="cp">#define RTLLIB_ERROR(f, a...) printk(KERN_ERR &quot;rtllib: &quot; f, ## a)</span>
<span class="cp">#define RTLLIB_WARNING(f, a...) printk(KERN_WARNING &quot;rtllib: &quot; f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_INFO(f, a...)   RTLLIB_DEBUG(RTLLIB_DL_INFO, f, ## a)</span>

<span class="cp">#define RTLLIB_DEBUG_WX(f, a...)     RTLLIB_DEBUG(RTLLIB_DL_WX, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_SCAN(f, a...)   RTLLIB_DEBUG(RTLLIB_DL_SCAN, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_STATE(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_STATE, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_MGMT(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_MGMT, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_FRAG(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_FRAG, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_EAP(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_EAP, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_DROP(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_DROP, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_TX(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_TX, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_RX(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_RX, f, ## a)</span>
<span class="cp">#define RTLLIB_DEBUG_QOS(f, a...)  RTLLIB_DEBUG(RTLLIB_DL_QOS, f, ## a)</span>

<span class="cm">/* Added by Annie, 2005-11-22. */</span>
<span class="cp">#define MAX_STR_LEN     64</span>
<span class="cm">/* I want to see ASCII 33 to 126 only. Otherwise, I print &#39;?&#39;. */</span>
<span class="cp">#define PRINTABLE(_ch)  (_ch &gt; &#39;!&#39; &amp;&amp; _ch &lt; &#39;~&#39;)</span>
<span class="cp">#define RTLLIB_PRINT_STR(_Comp, _TitleString, _Ptr, _Len)		\</span>
<span class="cp">	if ((_Comp) &amp; level) {					       \</span>
<span class="cp">		int	     __i;				    \</span>
<span class="cp">		u8  struct buffer[MAX_STR_LEN];				\</span>
<span class="cp">		int length = (_Len &lt; MAX_STR_LEN) ? _Len : (MAX_STR_LEN-1) ;\</span>
<span class="cp">		memset(struct buffer, 0, MAX_STR_LEN);		\</span>
<span class="cp">		memcpy(struct buffer, (u8 *)_Ptr, length);		\</span>
<span class="cp">		for (__i = 0; __i &lt; MAX_STR_LEN; __i++) {		\</span>
<span class="cp">			if (!PRINTABLE(struct buffer[__i]))		\</span>
<span class="cp">				struct buffer[__i] = &#39;?&#39;;		\</span>
<span class="cp">		}							\</span>
<span class="cp">		struct buffer[length] = &#39;\0&#39;;				\</span>
<span class="cp">		printk(KERN_INFO &quot;Rtl819x: &quot;);				\</span>
<span class="cp">		printk(_TitleString);					\</span>
<span class="cp">		printk(&quot;: %d, &lt;%s&gt;\n&quot;, _Len, struct buffer);		\</span>
<span class="cp">	}</span>
<span class="cp">#ifndef ETH_P_PAE</span>
<span class="cp">#define ETH_P_PAE 0x888E </span><span class="cm">/* Port Access Entity (IEEE 802.1X) */</span><span class="cp"></span>
<span class="cp">#define ETH_P_IP	0x0800		</span><span class="cm">/* Internet Protocol packet	*/</span><span class="cp"></span>
<span class="cp">#define ETH_P_ARP	0x0806		</span><span class="cm">/* Address Resolution packet	*/</span><span class="cp"></span>
<span class="cp">#endif </span><span class="cm">/* ETH_P_PAE */</span><span class="cp"></span>

<span class="cp">#define ETH_P_PREAUTH 0x88C7 </span><span class="cm">/* IEEE 802.11i pre-authentication */</span><span class="cp"></span>

<span class="cp">#ifndef ETH_P_80211_RAW</span>
<span class="cp">#define ETH_P_80211_RAW (ETH_P_ECONET + 1)</span>
<span class="cp">#endif</span>

<span class="cm">/* IEEE 802.11 defines */</span>

<span class="cp">#define P80211_OUI_LEN 3</span>

<span class="k">struct</span> <span class="n">rtllib_snap_hdr</span> <span class="p">{</span>

	<span class="n">u8</span>    <span class="n">dsap</span><span class="p">;</span>   <span class="cm">/* always 0xAA */</span>
	<span class="n">u8</span>    <span class="n">ssap</span><span class="p">;</span>   <span class="cm">/* always 0xAA */</span>
	<span class="n">u8</span>    <span class="n">ctrl</span><span class="p">;</span>   <span class="cm">/* always 0x03 */</span>
	<span class="n">u8</span>    <span class="n">oui</span><span class="p">[</span><span class="n">P80211_OUI_LEN</span><span class="p">];</span>    <span class="cm">/* organizational universal id */</span>

<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">_REG_PREAMBLE_MODE</span> <span class="p">{</span>
	<span class="n">PREAMBLE_LONG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">PREAMBLE_AUTO</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">PREAMBLE_SHORT</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define SNAP_SIZE sizeof(struct rtllib_snap_hdr)</span>

<span class="cp">#define WLAN_FC_GET_VERS(fc) ((fc) &amp; RTLLIB_FCTL_VERS)</span>
<span class="cp">#define WLAN_FC_GET_TYPE(fc) ((fc) &amp; RTLLIB_FCTL_FTYPE)</span>
<span class="cp">#define WLAN_FC_GET_STYPE(fc) ((fc) &amp; RTLLIB_FCTL_STYPE)</span>
<span class="cp">#define WLAN_FC_MORE_DATA(fc) ((fc) &amp; RTLLIB_FCTL_MOREDATA)</span>

<span class="cp">#define WLAN_FC_GET_FRAMETYPE(fc) ((fc) &amp; RTLLIB_FCTL_FRAMETYPE)</span>
<span class="cp">#define WLAN_GET_SEQ_FRAG(seq) ((seq) &amp; RTLLIB_SCTL_FRAG)</span>
<span class="cp">#define WLAN_GET_SEQ_SEQ(seq)  (((seq) &amp; RTLLIB_SCTL_SEQ) &gt;&gt; 4)</span>

<span class="cm">/* Authentication algorithms */</span>
<span class="cp">#define WLAN_AUTH_OPEN 0</span>
<span class="cp">#define WLAN_AUTH_SHARED_KEY 1</span>
<span class="cp">#define WLAN_AUTH_LEAP 128</span>

<span class="cp">#define WLAN_AUTH_CHALLENGE_LEN 128</span>

<span class="cp">#define WLAN_CAPABILITY_ESS (1&lt;&lt;0)</span>
<span class="cp">#define WLAN_CAPABILITY_IBSS (1&lt;&lt;1)</span>
<span class="cp">#define WLAN_CAPABILITY_CF_POLLABLE (1&lt;&lt;2)</span>
<span class="cp">#define WLAN_CAPABILITY_CF_POLL_REQUEST (1&lt;&lt;3)</span>
<span class="cp">#define WLAN_CAPABILITY_PRIVACY (1&lt;&lt;4)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_PREAMBLE (1&lt;&lt;5)</span>
<span class="cp">#define WLAN_CAPABILITY_PBCC (1&lt;&lt;6)</span>
<span class="cp">#define WLAN_CAPABILITY_CHANNEL_AGILITY (1&lt;&lt;7)</span>
<span class="cp">#define WLAN_CAPABILITY_SPECTRUM_MGMT (1&lt;&lt;8)</span>
<span class="cp">#define WLAN_CAPABILITY_QOS (1&lt;&lt;9)</span>
<span class="cp">#define WLAN_CAPABILITY_SHORT_SLOT_TIME (1&lt;&lt;10)</span>
<span class="cp">#define WLAN_CAPABILITY_DSSS_OFDM (1&lt;&lt;13)</span>

<span class="cm">/* 802.11g ERP information element */</span>
<span class="cp">#define WLAN_ERP_NON_ERP_PRESENT (1&lt;&lt;0)</span>
<span class="cp">#define WLAN_ERP_USE_PROTECTION (1&lt;&lt;1)</span>
<span class="cp">#define WLAN_ERP_BARKER_PREAMBLE (1&lt;&lt;2)</span>

<span class="cp">#define RTLLIB_STATMASK_SIGNAL (1&lt;&lt;0)</span>
<span class="cp">#define RTLLIB_STATMASK_RSSI (1&lt;&lt;1)</span>
<span class="cp">#define RTLLIB_STATMASK_NOISE (1&lt;&lt;2)</span>
<span class="cp">#define RTLLIB_STATMASK_RATE (1&lt;&lt;3)</span>
<span class="cp">#define RTLLIB_STATMASK_WEMASK 0x7</span>

<span class="cp">#define RTLLIB_CCK_MODULATION    (1&lt;&lt;0)</span>
<span class="cp">#define RTLLIB_OFDM_MODULATION   (1&lt;&lt;1)</span>

<span class="cp">#define RTLLIB_24GHZ_BAND     (1&lt;&lt;0)</span>
<span class="cp">#define RTLLIB_52GHZ_BAND     (1&lt;&lt;1)</span>

<span class="cp">#define RTLLIB_CCK_RATE_LEN		4</span>
<span class="cp">#define RTLLIB_CCK_RATE_1MB			0x02</span>
<span class="cp">#define RTLLIB_CCK_RATE_2MB			0x04</span>
<span class="cp">#define RTLLIB_CCK_RATE_5MB			0x0B</span>
<span class="cp">#define RTLLIB_CCK_RATE_11MB			0x16</span>
<span class="cp">#define RTLLIB_OFDM_RATE_LEN		8</span>
<span class="cp">#define RTLLIB_OFDM_RATE_6MB			0x0C</span>
<span class="cp">#define RTLLIB_OFDM_RATE_9MB			0x12</span>
<span class="cp">#define RTLLIB_OFDM_RATE_12MB		0x18</span>
<span class="cp">#define RTLLIB_OFDM_RATE_18MB		0x24</span>
<span class="cp">#define RTLLIB_OFDM_RATE_24MB		0x30</span>
<span class="cp">#define RTLLIB_OFDM_RATE_36MB		0x48</span>
<span class="cp">#define RTLLIB_OFDM_RATE_48MB		0x60</span>
<span class="cp">#define RTLLIB_OFDM_RATE_54MB		0x6C</span>
<span class="cp">#define RTLLIB_BASIC_RATE_MASK		0x80</span>

<span class="cp">#define RTLLIB_CCK_RATE_1MB_MASK		(1&lt;&lt;0)</span>
<span class="cp">#define RTLLIB_CCK_RATE_2MB_MASK		(1&lt;&lt;1)</span>
<span class="cp">#define RTLLIB_CCK_RATE_5MB_MASK		(1&lt;&lt;2)</span>
<span class="cp">#define RTLLIB_CCK_RATE_11MB_MASK		(1&lt;&lt;3)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_6MB_MASK		(1&lt;&lt;4)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_9MB_MASK		(1&lt;&lt;5)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_12MB_MASK		(1&lt;&lt;6)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_18MB_MASK		(1&lt;&lt;7)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_24MB_MASK		(1&lt;&lt;8)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_36MB_MASK		(1&lt;&lt;9)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_48MB_MASK		(1&lt;&lt;10)</span>
<span class="cp">#define RTLLIB_OFDM_RATE_54MB_MASK		(1&lt;&lt;11)</span>

<span class="cp">#define RTLLIB_CCK_RATES_MASK		0x0000000F</span>
<span class="cp">#define RTLLIB_CCK_BASIC_RATES_MASK	(RTLLIB_CCK_RATE_1MB_MASK | \</span>
<span class="cp">	RTLLIB_CCK_RATE_2MB_MASK)</span>
<span class="cp">#define RTLLIB_CCK_DEFAULT_RATES_MASK	(RTLLIB_CCK_BASIC_RATES_MASK | \</span>
<span class="cp">	RTLLIB_CCK_RATE_5MB_MASK | \</span>
<span class="cp">	RTLLIB_CCK_RATE_11MB_MASK)</span>

<span class="cp">#define RTLLIB_OFDM_RATES_MASK		0x00000FF0</span>
<span class="cp">#define RTLLIB_OFDM_BASIC_RATES_MASK	(RTLLIB_OFDM_RATE_6MB_MASK | \</span>
<span class="cp">	RTLLIB_OFDM_RATE_12MB_MASK | \</span>
<span class="cp">	RTLLIB_OFDM_RATE_24MB_MASK)</span>
<span class="cp">#define RTLLIB_OFDM_DEFAULT_RATES_MASK	(RTLLIB_OFDM_BASIC_RATES_MASK | \</span>
<span class="cp">	RTLLIB_OFDM_RATE_9MB_MASK  | \</span>
<span class="cp">	RTLLIB_OFDM_RATE_18MB_MASK | \</span>
<span class="cp">	RTLLIB_OFDM_RATE_36MB_MASK | \</span>
<span class="cp">	RTLLIB_OFDM_RATE_48MB_MASK | \</span>
<span class="cp">	RTLLIB_OFDM_RATE_54MB_MASK)</span>
<span class="cp">#define RTLLIB_DEFAULT_RATES_MASK (RTLLIB_OFDM_DEFAULT_RATES_MASK | \</span>
<span class="cp">				RTLLIB_CCK_DEFAULT_RATES_MASK)</span>

<span class="cp">#define RTLLIB_NUM_OFDM_RATES	    8</span>
<span class="cp">#define RTLLIB_NUM_CCK_RATES		    4</span>
<span class="cp">#define RTLLIB_OFDM_SHIFT_MASK_A	 4</span>


<span class="cm">/* this is stolen and modified from the madwifi driver*/</span>
<span class="cp">#define RTLLIB_FC0_TYPE_MASK		0x0c</span>
<span class="cp">#define RTLLIB_FC0_TYPE_DATA		0x08</span>
<span class="cp">#define RTLLIB_FC0_SUBTYPE_MASK	0xB0</span>
<span class="cp">#define RTLLIB_FC0_SUBTYPE_QOS	0x80</span>

<span class="cp">#define RTLLIB_QOS_HAS_SEQ(fc) \</span>
<span class="cp">	(((fc) &amp; (RTLLIB_FC0_TYPE_MASK | RTLLIB_FC0_SUBTYPE_MASK)) == \</span>
<span class="cp">	 (RTLLIB_FC0_TYPE_DATA | RTLLIB_FC0_SUBTYPE_QOS))</span>

<span class="cm">/* this is stolen from ipw2200 driver */</span>
<span class="cp">#define IEEE_IBSS_MAC_HASH_SIZE 31</span>
<span class="k">struct</span> <span class="n">ieee_ibss_seq</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">mac</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">seq_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">frag_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">packet_time</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* NOTE: This data is for statistical purposes; not all hardware provides this</span>
<span class="cm"> *       information for frames received.  Not setting these will not cause</span>
<span class="cm"> *       any adverse affects. */</span>
<span class="k">struct</span> <span class="n">rtllib_rx_stats</span> <span class="p">{</span>
	<span class="n">u64</span> <span class="n">mac_time</span><span class="p">;</span>
	<span class="n">s8</span>  <span class="n">rssi</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">signal</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">noise</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">rate</span><span class="p">;</span> <span class="cm">/* in 100 kbps */</span>
	<span class="n">u8</span>  <span class="n">received_channel</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">control</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">mask</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">freq</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tsf</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">beacon_time</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">nic_type</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">Length</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">SignalQuality</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">RecvSignalPower</span><span class="p">;</span>
	<span class="n">s8</span>  <span class="n">RxPower</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">SignalStrength</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bHwError</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bCRC</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bICV</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bShortPreamble</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">Antenna</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">Decrypted</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">Wakeup</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">Reserved0</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">AGC</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TimeStampLow</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TimeStampHigh</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bShift</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bIsQosData</span><span class="p">;</span>
	<span class="n">u8</span>   <span class="n">UserPriority</span><span class="p">;</span>

	<span class="n">u8</span>    <span class="n">RxDrvInfoSize</span><span class="p">;</span>
	<span class="n">u8</span>    <span class="n">RxBufShift</span><span class="p">;</span>
	<span class="n">bool</span>  <span class="n">bIsAMPDU</span><span class="p">;</span>
	<span class="n">bool</span>  <span class="n">bFirstMPDU</span><span class="p">;</span>
	<span class="n">bool</span>  <span class="n">bContainHTC</span><span class="p">;</span>
	<span class="n">bool</span>  <span class="n">RxIs40MHzPacket</span><span class="p">;</span>
	<span class="n">u32</span>   <span class="n">RxPWDBAll</span><span class="p">;</span>
	<span class="n">u8</span>    <span class="n">RxMIMOSignalStrength</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">s8</span>    <span class="n">RxMIMOSignalQuality</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bool</span>  <span class="n">bPacketMatchBSSID</span><span class="p">;</span>
	<span class="n">bool</span>  <span class="n">bIsCCK</span><span class="p">;</span>
	<span class="n">bool</span>  <span class="n">bPacketToSelf</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">virtual_address</span><span class="p">;</span>
	<span class="n">u16</span>    <span class="n">packetlength</span><span class="p">;</span>
	<span class="n">u16</span>    <span class="n">fraglength</span><span class="p">;</span>
	<span class="n">u16</span>    <span class="n">fragoffset</span><span class="p">;</span>
	<span class="n">u16</span>    <span class="n">ntotalfrag</span><span class="p">;</span>
	<span class="n">bool</span>   <span class="n">bisrxaggrsubframe</span><span class="p">;</span>
	<span class="n">bool</span>   <span class="n">bPacketBeacon</span><span class="p">;</span>
	<span class="n">bool</span>   <span class="n">bToSelfBA</span><span class="p">;</span>
	<span class="kt">char</span>   <span class="n">cck_adc_pwdb</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u16</span>    <span class="n">Seq_Num</span><span class="p">;</span>
	<span class="n">u8</span>     <span class="n">nTotalAggPkt</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* IEEE 802.11 requires that STA supports concurrent reception of at least</span>
<span class="cm"> * three fragmented frames. This define can be increased to support more</span>
<span class="cm"> * concurrent frames, but it should be noted that each entry can consume about</span>
<span class="cm"> * 2 kB of RAM and increasing cache size will slow down frame reassembly. */</span>
<span class="cp">#define RTLLIB_FRAG_CACHE_LEN 4</span>

<span class="k">struct</span> <span class="n">rtllib_frag_entry</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">first_frag_time</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">seq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">last_frag</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">src_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">dst_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtllib_stats</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_unicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_multicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_fragments</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_unicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_multicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_deferred_transmissions</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_single_retry_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_multiple_retry_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_retry_limit_exceeded</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_discards</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_unicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_multicast_frames</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_fragments</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_unicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_multicast_octets</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_fcs_errors</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_discards_no_buffer</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_discards_wrong_sa</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_discards_undecryptable</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_message_in_msg_fragments</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_message_in_bad_msg_fragments</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtllib_device</span><span class="p">;</span>

<span class="cp">#define SEC_KEY_1	 (1&lt;&lt;0)</span>
<span class="cp">#define SEC_KEY_2	 (1&lt;&lt;1)</span>
<span class="cp">#define SEC_KEY_3	 (1&lt;&lt;2)</span>
<span class="cp">#define SEC_KEY_4	 (1&lt;&lt;3)</span>
<span class="cp">#define SEC_ACTIVE_KEY    (1&lt;&lt;4)</span>
<span class="cp">#define SEC_AUTH_MODE     (1&lt;&lt;5)</span>
<span class="cp">#define SEC_UNICAST_GROUP (1&lt;&lt;6)</span>
<span class="cp">#define SEC_LEVEL	 (1&lt;&lt;7)</span>
<span class="cp">#define SEC_ENABLED       (1&lt;&lt;8)</span>
<span class="cp">#define SEC_ENCRYPT       (1&lt;&lt;9)</span>

<span class="cp">#define SEC_LEVEL_0      0 </span><span class="cm">/* None */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_1      1 </span><span class="cm">/* WEP 40 and 104 bit */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_2      2 </span><span class="cm">/* Level 1 + TKIP */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_2_CKIP 3 </span><span class="cm">/* Level 1 + CKIP */</span><span class="cp"></span>
<span class="cp">#define SEC_LEVEL_3      4 </span><span class="cm">/* Level 2 + CCMP */</span><span class="cp"></span>

<span class="cp">#define SEC_ALG_NONE		0</span>
<span class="cp">#define SEC_ALG_WEP		1</span>
<span class="cp">#define SEC_ALG_TKIP		2</span>
<span class="cp">#define SEC_ALG_CCMP		4</span>

<span class="cp">#define WEP_KEY_LEN		13</span>
<span class="cp">#define SCM_KEY_LEN		32</span>
<span class="cp">#define SCM_TEMPORAL_KEY_LENGTH 16</span>

<span class="k">struct</span> <span class="n">rtllib_security</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">active_key</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span>
	    <span class="nl">enabled:</span><span class="mi">1</span><span class="p">,</span>
	    <span class="nl">auth_mode:</span><span class="mi">2</span><span class="p">,</span>
	    <span class="nl">auth_algo:</span><span class="mi">4</span><span class="p">,</span>
	    <span class="nl">unicast_uses_group:</span><span class="mi">1</span><span class="p">,</span>
	    <span class="nl">encrypt:</span><span class="mi">1</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key_sizes</span><span class="p">[</span><span class="n">NUM_WEP_KEYS</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">keys</span><span class="p">[</span><span class="n">NUM_WEP_KEYS</span><span class="p">][</span><span class="n">SCM_KEY_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">level</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>


<span class="cm">/*</span>
<span class="cm"> 802.11 data frame from AP</span>
<span class="cm">      ,-------------------------------------------------------------------.</span>
<span class="cm">Bytes |  2   |  2   |    6    |    6    |    6    |  2   | 0..2312 |   4  |</span>
<span class="cm">      |------|------|---------|---------|---------|------|---------|------|</span>
<span class="cm">Desc. | ctrl | dura |  DA/RA  |   TA    |    SA   | Sequ |  frame  |  fcs |</span>
<span class="cm">      |      | tion | (BSSID) |	 |	 | ence |  data   |      |</span>
<span class="cm">      `-------------------------------------------------------------------&#39;</span>
<span class="cm">Total: 28-2340 bytes</span>
<span class="cm">*/</span>

<span class="cm">/* Management Frame Information Element Types */</span>
<span class="k">enum</span> <span class="n">rtllib_mfie</span> <span class="p">{</span>
	<span class="n">MFIE_TYPE_SSID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_RATES</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_FH_SET</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_DS_SET</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_CF_SET</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_TIM</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_IBSS_SET</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_COUNTRY</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_HOP_PARAMS</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_HOP_TABLE</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_REQUEST</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_CHALLENGE</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_POWER_CONSTRAINT</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_POWER_CAPABILITY</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_TPC_REQUEST</span> <span class="o">=</span> <span class="mi">34</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_TPC_REPORT</span> <span class="o">=</span> <span class="mi">35</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_SUPP_CHANNELS</span> <span class="o">=</span> <span class="mi">36</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_CSA</span> <span class="o">=</span> <span class="mi">37</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_MEASURE_REQUEST</span> <span class="o">=</span> <span class="mi">38</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_MEASURE_REPORT</span> <span class="o">=</span> <span class="mi">39</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_QUIET</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_IBSS_DFS</span> <span class="o">=</span> <span class="mi">41</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_ERP</span> <span class="o">=</span> <span class="mi">42</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_HT_CAP</span> <span class="o">=</span> <span class="mi">45</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_RSN</span> <span class="o">=</span> <span class="mi">48</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_RATES_EX</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_HT_INFO</span> <span class="o">=</span> <span class="mi">61</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_AIRONET</span> <span class="o">=</span> <span class="mi">133</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_GENERIC</span> <span class="o">=</span> <span class="mi">221</span><span class="p">,</span>
	<span class="n">MFIE_TYPE_QOS_PARAMETER</span> <span class="o">=</span> <span class="mi">222</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* Minimal header; can be used for passing 802.11 frames with sufficient</span>
<span class="cm"> * information to determine what type of underlying data type is actually</span>
<span class="cm"> * stored in the data. */</span>
<span class="k">struct</span> <span class="n">rtllib_pspoll_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">aid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ta</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_hdr_1addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_hdr_2addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_hdr_4addr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr4</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_hdr_3addrqos</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">qos_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_hdr_4addrqos</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">frame_ctl</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">duration_id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr1</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr2</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">addr3</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">seq_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">addr4</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">qos_ctl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_authentication</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">algorithm</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">transaction</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="cm">/*challenge*/</span>
	<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_disauth</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_disassoc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_probe_request</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="cm">/* SSID, supported rates */</span>
	<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_probe_response</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">time_stamp</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">beacon_interval</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="cm">/* SSID, supported rates, FH params, DS params,</span>
<span class="cm">	 * CF params, IBSS params, TIM (if beacon), RSN */</span>
	<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Alias beacon for probe_response */</span>
<span class="cp">#define rtllib_beacon rtllib_probe_response</span>

<span class="k">struct</span> <span class="n">rtllib_assoc_request_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="cm">/* SSID, supported rates, RSN */</span>
	<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_reassoc_request_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">current_ap</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="cm">/* SSID, supported rates, RSN */</span>
	<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_assoc_response_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="n">header</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">aid</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="n">info_element</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="cm">/* supported rates */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_txb</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr_frags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">encrypted</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">queue_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rts_included</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">frag_size</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">payload_size</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">fragments</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define MAX_TX_AGG_COUNT		  16</span>
<span class="k">struct</span> <span class="n">rtllib_drv_agg_txb</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr_drv_agg_frames</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">tx_agg_frames</span><span class="p">[</span><span class="n">MAX_TX_AGG_COUNT</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define MAX_SUBFRAME_COUNT		  64</span>
<span class="k">struct</span> <span class="n">rtllib_rxb</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">nr_subframes</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">subframes</span><span class="p">[</span><span class="n">MAX_SUBFRAME_COUNT</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">dst</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">src</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">union</span> <span class="n">frameqos</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">shortdata</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">chardata</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">u16</span> <span class="n">tid</span><span class="o">:</span><span class="mi">4</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">eosp</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">ack_policy</span><span class="o">:</span><span class="mi">2</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">reserved</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">txop</span><span class="o">:</span><span class="mi">8</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">field</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* SWEEP TABLE ENTRIES NUMBER*/</span>
<span class="cp">#define MAX_SWEEP_TAB_ENTRIES		  42</span>
<span class="cp">#define MAX_SWEEP_TAB_ENTRIES_PER_PACKET  7</span>
<span class="cm">/* MAX_RATES_LENGTH needs to be 12.  The spec says 8, and many APs</span>
<span class="cm"> * only use 8, and then use extended rates for the remaining supported</span>
<span class="cm"> * rates.  Other APs, however, stick all of their supported rates on the</span>
<span class="cm"> * main rates information element... */</span>
<span class="cp">#define MAX_RATES_LENGTH		  ((u8)12)</span>
<span class="cp">#define MAX_RATES_EX_LENGTH	       ((u8)16)</span>
<span class="cp">#define MAX_NETWORK_COUNT		  96</span>

<span class="cp">#define MAX_CHANNEL_NUMBER		 161</span>
<span class="cp">#define RTLLIB_SOFTMAC_SCAN_TIME	   100</span>
<span class="cp">#define RTLLIB_SOFTMAC_ASSOC_RETRY_TIME (HZ * 2)</span>

<span class="cp">#define CRC_LENGTH		 4U</span>

<span class="cp">#define MAX_WPA_IE_LEN 64</span>
<span class="cp">#define MAX_WZC_IE_LEN 256</span>

<span class="cp">#define NETWORK_EMPTY_ESSID (1&lt;&lt;0)</span>
<span class="cp">#define NETWORK_HAS_OFDM    (1&lt;&lt;1)</span>
<span class="cp">#define NETWORK_HAS_CCK     (1&lt;&lt;2)</span>

<span class="cm">/* QoS structure */</span>
<span class="cp">#define NETWORK_HAS_QOS_PARAMETERS      (1&lt;&lt;3)</span>
<span class="cp">#define NETWORK_HAS_QOS_INFORMATION     (1&lt;&lt;4)</span>
<span class="cp">#define NETWORK_HAS_QOS_MASK	    (NETWORK_HAS_QOS_PARAMETERS | \</span>
<span class="cp">					 NETWORK_HAS_QOS_INFORMATION)</span>
<span class="cm">/* 802.11h */</span>
<span class="cp">#define NETWORK_HAS_POWER_CONSTRAINT    (1&lt;&lt;5)</span>
<span class="cp">#define NETWORK_HAS_CSA		 (1&lt;&lt;6)</span>
<span class="cp">#define NETWORK_HAS_QUIET	       (1&lt;&lt;7)</span>
<span class="cp">#define NETWORK_HAS_IBSS_DFS	    (1&lt;&lt;8)</span>
<span class="cp">#define NETWORK_HAS_TPC_REPORT	  (1&lt;&lt;9)</span>

<span class="cp">#define NETWORK_HAS_ERP_VALUE	   (1&lt;&lt;10)</span>

<span class="cp">#define QOS_QUEUE_NUM		   4</span>
<span class="cp">#define QOS_OUI_LEN		     3</span>
<span class="cp">#define QOS_OUI_TYPE		    2</span>
<span class="cp">#define QOS_ELEMENT_ID		  221</span>
<span class="cp">#define QOS_OUI_INFO_SUB_TYPE	   0</span>
<span class="cp">#define QOS_OUI_PARAM_SUB_TYPE	  1</span>
<span class="cp">#define QOS_VERSION_1		   1</span>
<span class="cp">#define QOS_AIFSN_MIN_VALUE	     2</span>

<span class="k">struct</span> <span class="n">rtllib_qos_information_element</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">elementID</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">qui</span><span class="p">[</span><span class="n">QOS_OUI_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">qui_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">qui_subtype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ac_info</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_qos_ac_parameter</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">aci_aifsn</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ecw_min_max</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">tx_op_limit</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_qos_parameter_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_qos_information_element</span> <span class="n">info_element</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_qos_ac_parameter</span> <span class="n">ac_params_record</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_qos_parameters</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">cw_min</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">cw_max</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">aifs</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">flag</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">tx_op_limit</span><span class="p">[</span><span class="n">QOS_QUEUE_NUM</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_qos_data</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_qos_parameters</span> <span class="n">parameters</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wmm_acm</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">active</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">supported</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">param_count</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">old_param_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtllib_tim_parameters</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">tim_count</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tim_period</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_wmm_ac_param</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">ac_aci_acm_aifsn</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ac_ecwmin_ecwmax</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">ac_txop_limit</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtllib_wmm_ts_info</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">ac_dir_tid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ac_up_psb</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_wmm_tspec_elem</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_wmm_ts_info</span> <span class="n">ts_info</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">norm_msdu_size</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">max_msdu_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">min_serv_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_serv_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">inact_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">suspen_inter</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">serv_start_time</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">min_data_rate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mean_data_rate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">peak_data_rate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_burst_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">delay_bound</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">min_phy_rate</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">surp_band_allow</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">medium_time</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">eap_type</span> <span class="p">{</span>
	<span class="n">EAP_PACKET</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">EAPOL_START</span><span class="p">,</span>
	<span class="n">EAPOL_LOGOFF</span><span class="p">,</span>
	<span class="n">EAPOL_KEY</span><span class="p">,</span>
	<span class="n">EAPOL_ENCAP_ASF_ALERT</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">eap_types</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">[</span><span class="n">EAP_PACKET</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAP-Packet&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_START</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAPOL-Start&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_LOGOFF</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAPOL-Logoff&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_KEY</span><span class="p">]</span>		<span class="o">=</span> <span class="s">&quot;EAPOL-Key&quot;</span><span class="p">,</span>
	<span class="p">[</span><span class="n">EAPOL_ENCAP_ASF_ALERT</span><span class="p">]</span>	<span class="o">=</span> <span class="s">&quot;EAPOL-Encap-ASF-Alert&quot;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">eap_get_type</span><span class="p">(</span><span class="kt">int</span> <span class="n">type</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="n">u32</span><span class="p">)</span><span class="n">type</span> <span class="o">&gt;=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">eap_types</span><span class="p">))</span> <span class="o">?</span> <span class="s">&quot;Unknown&quot;</span> <span class="o">:</span>
		 <span class="n">eap_types</span><span class="p">[</span><span class="n">type</span><span class="p">];</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="nf">Frame_QoSTID</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">buf</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">fc</span><span class="p">;</span>
	<span class="n">hdr</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
	<span class="n">fc</span> <span class="o">=</span> <span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_ctl</span><span class="p">);</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">u8</span><span class="p">)((</span><span class="k">union</span> <span class="n">frameqos</span> <span class="o">*</span><span class="p">)(</span><span class="n">buf</span> <span class="o">+</span> <span class="p">(((</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">RTLLIB_FCTL_TODS</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
		    <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">RTLLIB_FCTL_FROMDS</span><span class="p">))</span> <span class="o">?</span> <span class="mi">30</span> <span class="o">:</span> <span class="mi">24</span><span class="p">)))</span><span class="o">-&gt;</span><span class="n">field</span><span class="p">.</span><span class="n">tid</span><span class="p">;</span>
<span class="p">}</span>


<span class="k">struct</span> <span class="n">eapol</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">snap</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">ethertype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">version</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">length</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">rtllib_softmac_stats</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_ass_ok</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_ass_err</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_probe_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_probe_rs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_beacons</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_auth_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_auth_rs_ok</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_auth_rs_err</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_auth_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_auth_rs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">no_ass_rs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_ass_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_ass_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_probe_rq</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">reassoc</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">swtxstop</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">swtxawake</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">CurrentShowTxate</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">last_packet_rate</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">txretrycount</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BEACON_PROBE_SSID_ID_POSITION 12</span>

<span class="k">struct</span> <span class="n">rtllib_info_element_hdr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/*</span>
<span class="cm"> * These are the data types that can make up management packets</span>
<span class="cm"> *</span>
<span class="cm">	u16 auth_algorithm;</span>
<span class="cm">	u16 auth_sequence;</span>
<span class="cm">	u16 beacon_interval;</span>
<span class="cm">	u16 capability;</span>
<span class="cm">	u8 current_ap[ETH_ALEN];</span>
<span class="cm">	u16 listen_interval;</span>
<span class="cm">	struct {</span>
<span class="cm">		u16 association_id:14, reserved:2;</span>
<span class="cm">	} __packed;</span>
<span class="cm">	u32 time_stamp[2];</span>
<span class="cm">	u16 reason;</span>
<span class="cm">	u16 status;</span>
<span class="cm">*/</span>

<span class="cp">#define RTLLIB_DEFAULT_TX_ESSID &quot;Penguin&quot;</span>
<span class="cp">#define RTLLIB_DEFAULT_BASIC_RATE 2</span>

<span class="k">enum</span> <span class="p">{</span><span class="n">WMM_all_frame</span><span class="p">,</span> <span class="n">WMM_two_frame</span><span class="p">,</span> <span class="n">WMM_four_frame</span><span class="p">,</span> <span class="n">WMM_six_frame</span><span class="p">};</span>
<span class="cp">#define MAX_SP_Len  (WMM_all_frame &lt;&lt; 4)</span>
<span class="cp">#define RTLLIB_QOS_TID 0x0f</span>
<span class="cp">#define QOS_CTL_NOTCONTAIN_ACK (0x01 &lt;&lt; 5)</span>

<span class="cp">#define RTLLIB_DTIM_MBCAST 4</span>
<span class="cp">#define RTLLIB_DTIM_UCAST 2</span>
<span class="cp">#define RTLLIB_DTIM_VALID 1</span>
<span class="cp">#define RTLLIB_DTIM_INVALID 0</span>

<span class="cp">#define RTLLIB_PS_DISABLED 0</span>
<span class="cp">#define RTLLIB_PS_UNICAST RTLLIB_DTIM_UCAST</span>
<span class="cp">#define RTLLIB_PS_MBCAST RTLLIB_DTIM_MBCAST</span>

<span class="cp">#define WME_AC_BK   0x00</span>
<span class="cp">#define WME_AC_BE   0x01</span>
<span class="cp">#define WME_AC_VI   0x02</span>
<span class="cp">#define WME_AC_VO   0x03</span>
<span class="cp">#define WME_ACI_MASK 0x03</span>
<span class="cp">#define WME_AIFSN_MASK 0x03</span>
<span class="cp">#define WME_AC_PRAM_LEN 16</span>

<span class="cp">#define MAX_RECEIVE_BUFFER_SIZE 9100</span>

<span class="cp">#define UP2AC(up) (		   \</span>
<span class="cp">	((up) &lt; 1) ? WME_AC_BE : \</span>
<span class="cp">	((up) &lt; 3) ? WME_AC_BK : \</span>
<span class="cp">	((up) &lt; 4) ? WME_AC_BE : \</span>
<span class="cp">	((up) &lt; 6) ? WME_AC_VI : \</span>
<span class="cp">	WME_AC_VO)</span>

<span class="cp">#define AC2UP(_ac)	(       \</span>
<span class="cp">	((_ac) == WME_AC_VO) ? 6 : \</span>
<span class="cp">	((_ac) == WME_AC_VI) ? 5 : \</span>
<span class="cp">	((_ac) == WME_AC_BK) ? 1 : \</span>
<span class="cp">	0)</span>

<span class="cp">#define	ETHER_ADDR_LEN		6	</span><span class="cm">/* length of an Ethernet address */</span><span class="cp"></span>
<span class="cp">#define ETHERNET_HEADER_SIZE    14      </span><span class="cm">/* length of two Ethernet address</span>
<span class="cm">					 * plus ether type*/</span><span class="cp"></span>

<span class="k">struct</span>	<span class="n">ether_header</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">ether_dhost</span><span class="p">[</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ether_shost</span><span class="p">[</span><span class="n">ETHER_ADDR_LEN</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">ether_type</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#ifndef ETHERTYPE_PAE</span>
<span class="cp">#define	ETHERTYPE_PAE	0x888e		</span><span class="cm">/* EAPOL PAE/802.1x */</span><span class="cp"></span>
<span class="cp">#endif</span>
<span class="cp">#ifndef ETHERTYPE_IP</span>
<span class="cp">#define	ETHERTYPE_IP	0x0800		</span><span class="cm">/* IP protocol */</span><span class="cp"></span>
<span class="cp">#endif</span>


<span class="k">enum</span> <span class="n">erp_t</span> <span class="p">{</span>
	<span class="n">ERP_NonERPpresent</span>	<span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>
	<span class="n">ERP_UseProtection</span>	<span class="o">=</span> <span class="mh">0x02</span><span class="p">,</span>
	<span class="n">ERP_BarkerPreambleMode</span> <span class="o">=</span> <span class="mh">0x04</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtllib_network</span> <span class="p">{</span>
	<span class="cm">/* These entries are used to identify a unique network */</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">channel</span><span class="p">;</span>
	<span class="cm">/* Ensure null-terminated for any debug msgs */</span>
	<span class="n">u8</span> <span class="n">ssid</span><span class="p">[</span><span class="n">IW_ESSID_MAX_SIZE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ssid_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hidden_ssid</span><span class="p">[</span><span class="n">IW_ESSID_MAX_SIZE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">hidden_ssid_len</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_qos_data</span> <span class="n">qos_data</span><span class="p">;</span>

	<span class="n">bool</span>	<span class="n">bWithAironetIE</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bCkipSupported</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bCcxRmEnable</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">CcxRmState</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">bool</span>	<span class="n">bMBssidValid</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">MBssidMask</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">MBssid</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bool</span>	<span class="n">bWithCcxVerNum</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">BssCcxVerNumber</span><span class="p">;</span>
	<span class="cm">/* These are network statistics */</span>
	<span class="k">struct</span> <span class="n">rtllib_rx_stats</span> <span class="n">stats</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">capability</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">rates</span><span class="p">[</span><span class="n">MAX_RATES_LENGTH</span><span class="p">];</span>
	<span class="n">u8</span>  <span class="n">rates_len</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">rates_ex</span><span class="p">[</span><span class="n">MAX_RATES_EX_LENGTH</span><span class="p">];</span>
	<span class="n">u8</span>  <span class="n">rates_ex_len</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">last_scanned</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">mode</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">last_associate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">time_stamp</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">beacon_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">atim_window</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">erp_value</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">wpa_ie</span><span class="p">[</span><span class="n">MAX_WPA_IE_LEN</span><span class="p">];</span>
	<span class="kt">size_t</span> <span class="n">wpa_ie_len</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">rsn_ie</span><span class="p">[</span><span class="n">MAX_WPA_IE_LEN</span><span class="p">];</span>
	<span class="kt">size_t</span> <span class="n">rsn_ie_len</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">wzc_ie</span><span class="p">[</span><span class="n">MAX_WZC_IE_LEN</span><span class="p">];</span>
	<span class="kt">size_t</span> <span class="n">wzc_ie_len</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">rtllib_tim_parameters</span> <span class="n">tim</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">dtim_period</span><span class="p">;</span>
	<span class="n">u8</span>  <span class="n">dtim_data</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">last_dtim_sta_time</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">wmm_info</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_wmm_ac_param</span> <span class="n">wmm_param</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">Turbo_Enable</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">CountryIeLen</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">CountryIeBuf</span><span class="p">[</span><span class="n">MAX_IE_LEN</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">bss_ht</span> <span class="n">bssht</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">broadcom_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">realtek_cap_exit</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">marvell_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ralink_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">atheros_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">cisco_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">airgo_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">unknown_cap_exist</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">berp_info_valid</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">buseprotection</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bIsNetgear854T</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">SignalStrength</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">RSSI</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#if 1</span>
<span class="k">enum</span> <span class="n">rtllib_state</span> <span class="p">{</span>

	<span class="cm">/* the card is not linked at all */</span>
	<span class="n">RTLLIB_NOLINK</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>

	<span class="cm">/* RTLLIB_ASSOCIATING* are for BSS client mode</span>
<span class="cm">	 * the driver shall not perform RX filtering unless</span>
<span class="cm">	 * the state is LINKED.</span>
<span class="cm">	 * The driver shall just check for the state LINKED and</span>
<span class="cm">	 * defaults to NOLINK for ALL the other states (including</span>
<span class="cm">	 * LINKED_SCANNING)</span>
<span class="cm">	 */</span>

	<span class="cm">/* the association procedure will start (wq scheduling)*/</span>
	<span class="n">RTLLIB_ASSOCIATING</span><span class="p">,</span>
	<span class="n">RTLLIB_ASSOCIATING_RETRY</span><span class="p">,</span>

	<span class="cm">/* the association procedure is sending AUTH request*/</span>
	<span class="n">RTLLIB_ASSOCIATING_AUTHENTICATING</span><span class="p">,</span>

	<span class="cm">/* the association procedure has successfully authenticated</span>
<span class="cm">	 * and is sending association request</span>
<span class="cm">	 */</span>
	<span class="n">RTLLIB_ASSOCIATING_AUTHENTICATED</span><span class="p">,</span>

	<span class="cm">/* the link is ok. the card associated to a BSS or linked</span>
<span class="cm">	 * to a ibss cell or acting as an AP and creating the bss</span>
<span class="cm">	 */</span>
	<span class="n">RTLLIB_LINKED</span><span class="p">,</span>

	<span class="cm">/* same as LINKED, but the driver shall apply RX filter</span>
<span class="cm">	 * rules as we are in NO_LINK mode. As the card is still</span>
<span class="cm">	 * logically linked, but it is doing a syncro site survey</span>
<span class="cm">	 * then it will be back to LINKED state.</span>
<span class="cm">	 */</span>
	<span class="n">RTLLIB_LINKED_SCANNING</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#else</span>
<span class="k">enum</span> <span class="n">rtllib_state</span> <span class="p">{</span>
	<span class="n">RTLLIB_UNINITIALIZED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">RTLLIB_INITIALIZED</span><span class="p">,</span>
	<span class="n">RTLLIB_ASSOCIATING</span><span class="p">,</span>
	<span class="n">RTLLIB_ASSOCIATED</span><span class="p">,</span>
	<span class="n">RTLLIB_AUTHENTICATING</span><span class="p">,</span>
	<span class="n">RTLLIB_AUTHENTICATED</span><span class="p">,</span>
	<span class="n">RTLLIB_SHUTDOWN</span>
<span class="p">};</span>
<span class="cp">#endif</span>

<span class="cp">#define DEFAULT_MAX_SCAN_AGE (15 * HZ)</span>
<span class="cp">#define DEFAULT_FTS 2346</span>

<span class="cp">#define CFG_RTLLIB_RESERVE_FCS (1&lt;&lt;0)</span>
<span class="cp">#define CFG_RTLLIB_COMPUTE_FCS (1&lt;&lt;1)</span>
<span class="cp">#define CFG_RTLLIB_RTS (1&lt;&lt;2)</span>

<span class="cp">#define RTLLIB_24GHZ_MIN_CHANNEL 1</span>
<span class="cp">#define RTLLIB_24GHZ_MAX_CHANNEL 14</span>
<span class="cp">#define RTLLIB_24GHZ_CHANNELS (RTLLIB_24GHZ_MAX_CHANNEL - \</span>
<span class="cp">				  RTLLIB_24GHZ_MIN_CHANNEL + 1)</span>

<span class="cp">#define RTLLIB_52GHZ_MIN_CHANNEL 34</span>
<span class="cp">#define RTLLIB_52GHZ_MAX_CHANNEL 165</span>
<span class="cp">#define RTLLIB_52GHZ_CHANNELS (RTLLIB_52GHZ_MAX_CHANNEL - \</span>
<span class="cp">				  RTLLIB_52GHZ_MIN_CHANNEL + 1)</span>
<span class="cp">#ifndef eqMacAddr</span>
<span class="cp">#define eqMacAddr(a, b)					\</span>
<span class="cp">	(((a)[0] == (b)[0] &amp;&amp; (a)[1] == (b)[1] &amp;&amp; (a)[2] == (b)[2] &amp;&amp;	\</span>
<span class="cp">	(a)[3] == (b)[3] &amp;&amp; (a)[4] == (b)[4] &amp;&amp; (a)[5] == (b)[5]) ? 1 : 0)</span>
<span class="cp">#endif</span>
<span class="k">struct</span> <span class="n">tx_pending</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">frag</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_txb</span> <span class="o">*</span><span class="n">txb</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bandwidth_autoswitch</span> <span class="p">{</span>
	<span class="kt">long</span> <span class="n">threshold_20Mhzto40Mhz</span><span class="p">;</span>
	<span class="kt">long</span>	<span class="n">threshold_40Mhzto20Mhz</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bforced_tx20Mhz</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bautoswitch_enable</span><span class="p">;</span>
<span class="p">};</span>



<span class="cp">#define REORDER_WIN_SIZE	128</span>
<span class="cp">#define REORDER_ENTRY_NUM	128</span>
<span class="k">struct</span> <span class="n">rx_reorder_entry</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span>	<span class="n">List</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="n">SeqNum</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_rxb</span> <span class="o">*</span><span class="n">prxb</span><span class="p">;</span>
<span class="p">};</span>
<span class="k">enum</span> <span class="n">fsync_state</span> <span class="p">{</span>
	<span class="n">Default_Fsync</span><span class="p">,</span>
	<span class="n">HW_Fsync</span><span class="p">,</span>
	<span class="n">SW_Fsync</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">rt_ps_mode</span> <span class="p">{</span>
	<span class="n">eActive</span><span class="p">,</span>
	<span class="n">eMaxPs</span><span class="p">,</span>
	<span class="n">eFastPs</span><span class="p">,</span>
	<span class="n">eAutoPs</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">ips_callback_function</span> <span class="p">{</span>
	<span class="n">IPS_CALLBACK_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">IPS_CALLBACK_MGNT_LINK_REQUEST</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">IPS_CALLBACK_JOIN_REQUEST</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">rt_join_action</span> <span class="p">{</span>
	<span class="n">RT_JOIN_INFRA</span>   <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">RT_JOIN_IBSS</span>  <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">RT_START_IBSS</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">RT_NO_ACTION</span>  <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ibss_parms</span> <span class="p">{</span>
	<span class="n">u16</span>   <span class="n">atimWin</span><span class="p">;</span>
<span class="p">};</span>
<span class="cp">#define MAX_NUM_RATES	264</span>

<span class="k">enum</span> <span class="n">rt_rf_power_state</span> <span class="p">{</span>
	<span class="n">eRfOn</span><span class="p">,</span>
	<span class="n">eRfSleep</span><span class="p">,</span>
	<span class="n">eRfOff</span>
<span class="p">};</span>

<span class="cp">#define	MAX_SUPPORT_WOL_PATTERN_NUM		8</span>

<span class="cp">#define	MAX_WOL_BIT_MASK_SIZE		16</span>
<span class="cp">#define	MAX_WOL_PATTERN_SIZE		128</span>

<span class="k">enum</span> <span class="n">wol_pattern_type</span> <span class="p">{</span>
	<span class="n">eNetBIOS</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">eIPv4IPv6ARP</span><span class="p">,</span>
	<span class="n">eIPv4IPv6TCPSYN</span><span class="p">,</span>
	<span class="n">eMACIDOnly</span><span class="p">,</span>
	<span class="n">eNoDefined</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rt_pm_wol_info</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">PatternId</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">Mask</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u16</span>	<span class="n">CrcRemainder</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">WFMIndex</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">wol_pattern_type</span> <span class="n">PatternType</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rt_pwr_save_ctrl</span> <span class="p">{</span>

	<span class="n">bool</span>				<span class="n">bInactivePs</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bIPSModeBackup</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bHaltAdapterClkRQ</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bSwRfProcessing</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">rt_rf_power_state</span> <span class="n">eInactivePowerState</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span>		<span class="n">InactivePsWorkItem</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span>	<span class="n">InactivePsTimer</span><span class="p">;</span>

	<span class="k">enum</span> <span class="n">ips_callback_function</span> <span class="n">ReturnPoint</span><span class="p">;</span>

	<span class="n">bool</span>				<span class="n">bTmpBssDesc</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">rt_join_action</span> <span class="n">tmpJoinAction</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_network</span> <span class="n">tmpBssDesc</span><span class="p">;</span>

	<span class="n">bool</span>				<span class="n">bTmpScanOnly</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpActiveScan</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpFilterHiddenAP</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpUpdateParms</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">tmpSsidBuf</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">octet_string</span> <span class="n">tmpSsid2Scan</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpSsid2Scan</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">tmpNetworkType</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">tmpChannelNumber</span><span class="p">;</span>
	<span class="n">u16</span>				<span class="n">tmpBcnPeriod</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">tmpDtimPeriod</span><span class="p">;</span>
	<span class="n">u16</span>				<span class="n">tmpmCap</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">octet_string</span> <span class="n">tmpSuppRateSet</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">tmpSuppRateBuf</span><span class="p">[</span><span class="n">MAX_NUM_RATES</span><span class="p">];</span>
	<span class="n">bool</span>				<span class="n">bTmpSuppRate</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ibss_parms</span> <span class="n">tmpIbpm</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bTmpIbpm</span><span class="p">;</span>

	<span class="n">bool</span>				<span class="n">bLeisurePs</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">PowerProfile</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">LpsIdleCount</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">RegMaxLPSAwakeIntvl</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">LPSAwakeIntvl</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="n">CurPsLevel</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">RegRfPsLevel</span><span class="p">;</span>

	<span class="n">bool</span>				<span class="n">bFwCtrlLPS</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">FWCtrlPSMode</span><span class="p">;</span>

	<span class="n">bool</span>				<span class="n">LinkReqInIPSRFOffPgs</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">BufConnectinfoBefore</span><span class="p">;</span>


	<span class="n">bool</span>				<span class="n">bGpioRfSw</span><span class="p">;</span>

	<span class="n">u8</span>				<span class="n">RegAMDPciASPM</span><span class="p">;</span>

	<span class="n">u8</span>				<span class="n">oWLANMode</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rt_pm_wol_info</span> <span class="n">PmWoLPatternInfo</span><span class="p">[</span><span class="n">MAX_SUPPORT_WOL_PATTERN_NUM</span><span class="p">];</span>

<span class="p">};</span>

<span class="cp">#define RT_RF_CHANGE_SOURCE u32</span>

<span class="cp">#define RF_CHANGE_BY_SW BIT31</span>
<span class="cp">#define RF_CHANGE_BY_HW BIT30</span>
<span class="cp">#define RF_CHANGE_BY_PS BIT29</span>
<span class="cp">#define RF_CHANGE_BY_IPS BIT28</span>
<span class="cp">#define RF_CHANGE_BY_INIT	0</span>

<span class="k">enum</span> <span class="n">country_code_type</span> <span class="p">{</span>
	<span class="n">COUNTRY_CODE_FCC</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_IC</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_ETSI</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_SPAIN</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_FRANCE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_MKK</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_MKK1</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_ISRAEL</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_TELEC</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_MIC</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_GLOBAL_DOMAIN</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_WORLD_WIDE_13</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_TELEC_NETGEAR</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">COUNTRY_CODE_MAX</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">scan_op_backup_opt</span> <span class="p">{</span>
	<span class="n">SCAN_OPT_BACKUP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">SCAN_OPT_RESTORE</span><span class="p">,</span>
	<span class="n">SCAN_OPT_MAX</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">fw_cmd_io_type</span> <span class="p">{</span>
	<span class="n">FW_CMD_DIG_ENABLE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">FW_CMD_DIG_DISABLE</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">FW_CMD_DIG_HALT</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">FW_CMD_DIG_RESUME</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">FW_CMD_HIGH_PWR_ENABLE</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">FW_CMD_HIGH_PWR_DISABLE</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">FW_CMD_RA_RESET</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">FW_CMD_RA_ACTIVE</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">FW_CMD_RA_REFRESH_N</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">FW_CMD_RA_REFRESH_BG</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>
	<span class="n">FW_CMD_RA_INIT</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
	<span class="n">FW_CMD_IQK_ENABLE</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span>
	<span class="n">FW_CMD_TXPWR_TRACK_ENABLE</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span>
	<span class="n">FW_CMD_TXPWR_TRACK_DISABLE</span> <span class="o">=</span> <span class="mi">13</span><span class="p">,</span>
	<span class="n">FW_CMD_TXPWR_TRACK_THERMAL</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span>
	<span class="n">FW_CMD_PAUSE_DM_BY_SCAN</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
	<span class="n">FW_CMD_RESUME_DM_BY_SCAN</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
	<span class="n">FW_CMD_RA_REFRESH_N_COMB</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
	<span class="n">FW_CMD_RA_REFRESH_BG_COMB</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
	<span class="n">FW_CMD_ANTENNA_SW_ENABLE</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span>
	<span class="n">FW_CMD_ANTENNA_SW_DISABLE</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
	<span class="n">FW_CMD_TX_FEEDBACK_CCX_ENABLE</span> <span class="o">=</span> <span class="mi">21</span><span class="p">,</span>
	<span class="n">FW_CMD_LPS_ENTER</span> <span class="o">=</span> <span class="mi">22</span><span class="p">,</span>
	<span class="n">FW_CMD_LPS_LEAVE</span> <span class="o">=</span> <span class="mi">23</span><span class="p">,</span>
	<span class="n">FW_CMD_DIG_MODE_SS</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>
	<span class="n">FW_CMD_DIG_MODE_FA</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span>
	<span class="n">FW_CMD_ADD_A2_ENTRY</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
	<span class="n">FW_CMD_CTRL_DM_BY_DRIVER</span> <span class="o">=</span> <span class="mi">27</span><span class="p">,</span>
	<span class="n">FW_CMD_CTRL_DM_BY_DRIVER_NEW</span> <span class="o">=</span> <span class="mi">28</span><span class="p">,</span>
	<span class="n">FW_CMD_PAPE_CONTROL</span> <span class="o">=</span> <span class="mi">29</span><span class="p">,</span>
	<span class="n">FW_CMD_CHAN_SET</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define RT_MAX_LD_SLOT_NUM	10</span>
<span class="k">struct</span> <span class="n">rt_link_detect</span> <span class="p">{</span>

	<span class="n">u32</span>				<span class="n">NumRecvBcnInPeriod</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">NumRecvDataInPeriod</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="n">RxBcnNum</span><span class="p">[</span><span class="n">RT_MAX_LD_SLOT_NUM</span><span class="p">];</span>
	<span class="n">u32</span>				<span class="n">RxDataNum</span><span class="p">[</span><span class="n">RT_MAX_LD_SLOT_NUM</span><span class="p">];</span>
	<span class="n">u16</span>				<span class="n">SlotNum</span><span class="p">;</span>
	<span class="n">u16</span>				<span class="n">SlotIndex</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="n">NumTxOkInPeriod</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">NumRxOkInPeriod</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">NumRxUnicastOkInPeriod</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bBusyTraffic</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bHigherBusyTraffic</span><span class="p">;</span>
	<span class="n">bool</span>				<span class="n">bHigherBusyRxTraffic</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">IdleCount</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">NumTxUnicastOkInPeriod</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">LastNumTxUnicast</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">LastNumRxUnicast</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">sw_cam_table</span> <span class="p">{</span>

	<span class="n">u8</span>				<span class="n">macaddr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">bool</span>				<span class="n">bused</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">key_buf</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u16</span>				<span class="n">key_type</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">useDK</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">key_index</span><span class="p">;</span>

<span class="p">};</span>
<span class="cp">#define   TOTAL_CAM_ENTRY				32</span>
<span class="k">struct</span> <span class="n">rate_adaptive</span> <span class="p">{</span>
	<span class="n">u8</span>				<span class="n">rate_adaptive_disabled</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">ratr_state</span><span class="p">;</span>
	<span class="n">u16</span>				<span class="n">reserve</span><span class="p">;</span>

	<span class="n">u32</span>				<span class="n">high_rssi_thresh_for_ra</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">high2low_rssi_thresh_for_ra</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">low2high_rssi_thresh_for_ra40M</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">low_rssi_thresh_for_ra40M</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">low2high_rssi_thresh_for_ra20M</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">low_rssi_thresh_for_ra20M</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">upper_rssi_threshold_ratr</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">middle_rssi_threshold_ratr</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">low_rssi_threshold_ratr</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">low_rssi_threshold_ratr_40M</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">low_rssi_threshold_ratr_20M</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">ping_rssi_enable</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">ping_rssi_ratr</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">ping_rssi_thresh_for_ra</span><span class="p">;</span>
	<span class="n">u32</span>				<span class="n">last_ratr</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">PreRATRState</span><span class="p">;</span>

<span class="p">};</span>
<span class="k">enum</span> <span class="n">ratr_table_mode_8192s</span> <span class="p">{</span>
	<span class="n">RATR_INX_WIRELESS_NGB</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_NG</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_NB</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_N</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_GB</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_G</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_B</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_MC</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
	<span class="n">RATR_INX_WIRELESS_A</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define	NUM_PMKID_CACHE		16</span>
<span class="k">struct</span> <span class="n">rt_pmkid_list</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">bUsed</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">Bssid</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">PMKID</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">SsidBuf</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">ssid_octet</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">ssid_length</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rt_intel_promisc_mode</span> <span class="p">{</span>
	<span class="n">bool</span> <span class="n">bPromiscuousOn</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bFilterSourceStationFrame</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/*************** DRIVER STATUS   *****/</span>
<span class="cp">#define STATUS_SCANNING			0</span>
<span class="cp">#define STATUS_SCAN_HW			1</span>
<span class="cp">#define STATUS_SCAN_ABORTING	2</span>
<span class="cp">#define STATUS_SETTING_CHAN		3</span>
<span class="cm">/*************** DRIVER STATUS   *****/</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">NO_USE</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">USED</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">HW_SEC</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">SW_SEC</span>		<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">LPS_IS_WAKE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">LPS_IS_SLEEP</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">LPS_WAIT_NULL_DATA_SEND</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">rtllib_device</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_security</span> <span class="n">sec</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">disable_mgnt_queue</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">status</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">hwscan_ch_bk</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ht_extchnl_offset</span> <span class="n">chan_offset_bk</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ht_channel_width</span> <span class="n">bandwidth_bk</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">hwscan_sem_up</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">CntAfterLink</span><span class="p">;</span>

	<span class="k">enum</span> <span class="n">rt_op_mode</span> <span class="n">OpMode</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">VersionID</span><span class="p">;</span>
	<span class="cm">/* The last AssocReq/Resp IEs */</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">assocreq_ies</span><span class="p">,</span> <span class="o">*</span><span class="n">assocresp_ies</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">assocreq_ies_len</span><span class="p">,</span> <span class="n">assocresp_ies_len</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">b_customer_lenovo_id</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bForcedShowRxRate</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bForcedShowRateStill</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">SystemQueryDataRateCount</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bForcedBgMode</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bUseRAMask</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">b1x1RecvCombine</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">RF_Type</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">b1SSSupport</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">hwsec_active</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">is_silent_reset</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">force_mic_error</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">is_roaming</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ieee_up</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">cannot_notify</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bSupportRemoteWakeUp</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">rt_ps_mode</span> <span class="n">dot11PowerSaveMode</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">actscanning</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">FirstIe_InScan</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">be_scan_inprogress</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">beinretry</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">rt_rf_power_state</span> <span class="n">eRFPowerState</span><span class="p">;</span>
	<span class="n">RT_RF_CHANGE_SOURCE</span>	<span class="n">RfOffReason</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">is_set_key</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">wx_set_enc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rt_hi_throughput</span> <span class="o">*</span><span class="n">pHTInfo</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">bw_spinlock</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">reorder_spinlock</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">Regdot11HTOperationalRateSet</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">Regdot11TxHTOperationalRateSet</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">dot11HTOperationalRateSet</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">RegHTSuppRateSet</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">HTCurrentOperaRate</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">HTHighestOperaRate</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">MinSpaceCfg</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">MaxMssDensity</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">bTxDisableRateFallBack</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">bTxUseDriverAssingedRate</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">bTxEnableFwCalcDur</span><span class="p">;</span>
	<span class="n">atomic_t</span>	<span class="n">atm_chnlop</span><span class="p">;</span>
	<span class="n">atomic_t</span>	<span class="n">atm_swbw</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Tx_TS_Admit_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Tx_TS_Pending_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Tx_TS_Unused_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tx_ts_record</span> <span class="n">TxTsRecord</span><span class="p">[</span><span class="n">TOTAL_TS_NUM</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Rx_TS_Admit_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Rx_TS_Pending_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">Rx_TS_Unused_List</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rx_ts_record</span> <span class="n">RxTsRecord</span><span class="p">[</span><span class="n">TOTAL_TS_NUM</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">rx_reorder_entry</span> <span class="n">RxReorderEntry</span><span class="p">[</span><span class="mi">128</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">list_head</span>		<span class="n">RxReorder_Unused_List</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">ForcedPriority</span><span class="p">;</span>


	<span class="cm">/* Bookkeeping structures */</span>
	<span class="k">struct</span> <span class="n">net_device_stats</span> <span class="n">stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_stats</span> <span class="n">ieee_stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_softmac_stats</span> <span class="n">softmac_stats</span><span class="p">;</span>

	<span class="cm">/* Probe / Beacon management */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">network_free_list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">network_list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">networks</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">scans</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">scan_age</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">iw_mode</span><span class="p">;</span> <span class="cm">/* operating mode (IW_MODE_*) */</span>
	<span class="n">bool</span> <span class="n">bNetPromiscuousMode</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rt_intel_promisc_mode</span> <span class="n">IntelPromiscuousModeInfo</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">iw_spy_data</span> <span class="n">spy_data</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">wpax_suitlist_lock</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">tx_headroom</span><span class="p">;</span> <span class="cm">/* Set to size of any additional room needed at front</span>
<span class="cm">			  * of allocated Tx SKBs */</span>
	<span class="n">u32</span> <span class="n">config</span><span class="p">;</span>

	<span class="cm">/* WEP and other encryption related settings at the device level */</span>
	<span class="kt">int</span> <span class="n">open_wep</span><span class="p">;</span> <span class="cm">/* Set to 1 to allow unencrypted frames */</span>
	<span class="kt">int</span> <span class="n">auth_mode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">reset_on_keychange</span><span class="p">;</span> <span class="cm">/* Set to 1 if the HW needs to be reset on</span>
<span class="cm">				 * WEP key changes */</span>

	<span class="cm">/* If the host performs {en,de}cryption, then set to 1 */</span>
	<span class="kt">int</span> <span class="n">host_encrypt</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">host_encrypt_msdu</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">host_decrypt</span><span class="p">;</span>
	<span class="cm">/* host performs multicast decryption */</span>
	<span class="kt">int</span> <span class="n">host_mc_decrypt</span><span class="p">;</span>

	<span class="cm">/* host should strip IV and ICV from protected frames */</span>
	<span class="cm">/* meaningful only when hardware decryption is being used */</span>
	<span class="kt">int</span> <span class="n">host_strip_iv_icv</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">host_open_frag</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">host_build_iv</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ieee802_1x</span><span class="p">;</span> <span class="cm">/* is IEEE 802.1X used */</span>

	<span class="cm">/* WPA data */</span>
	<span class="n">bool</span> <span class="n">bHalfNMode</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bHalfWirelessN24GMode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">wpa_enabled</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">drop_unencrypted</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tkip_countermeasures</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">privacy_invoked</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">wpa_ie_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">wpa_ie</span><span class="p">;</span>
	<span class="kt">size_t</span> <span class="n">wps_ie_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">wps_ie</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ap_mac_addr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">pairwise_key_type</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">group_key_type</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">lib80211_crypt_info</span> <span class="n">crypt_info</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">sw_cam_table</span> <span class="n">swcamtable</span><span class="p">[</span><span class="n">TOTAL_CAM_ENTRY</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">bcrx_sta_key</span><span class="p">;</span> <span class="cm">/* use individual keys to override default keys even</span>
<span class="cm">			   * with RX of broad/multicast frames */</span>

	<span class="k">struct</span> <span class="n">rt_pmkid_list</span> <span class="n">PMKIDList</span><span class="p">[</span><span class="n">NUM_PMKID_CACHE</span><span class="p">];</span>

	<span class="cm">/* Fragmentation structures */</span>
	<span class="k">struct</span> <span class="n">rtllib_frag_entry</span> <span class="n">frag_cache</span><span class="p">[</span><span class="mi">17</span><span class="p">][</span><span class="n">RTLLIB_FRAG_CACHE_LEN</span><span class="p">];</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">frag_next_idx</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">fts</span><span class="p">;</span> <span class="cm">/* Fragmentation Threshold */</span>
<span class="cp">#define DEFAULT_RTS_THRESHOLD 2346U</span>
<span class="cp">#define MIN_RTS_THRESHOLD 1</span>
<span class="cp">#define MAX_RTS_THRESHOLD 2346U</span>
	<span class="n">u16</span> <span class="n">rts</span><span class="p">;</span> <span class="cm">/* RTS threshold */</span>

	<span class="cm">/* Association info */</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>

	<span class="cm">/* This stores infos for the current network.</span>
<span class="cm">	 * Either the network we are associated in INFRASTRUCTURE</span>
<span class="cm">	 * or the network that we are creating in MASTER mode.</span>
<span class="cm">	 * ad-hoc is a mixture ;-).</span>
<span class="cm">	 * Note that in infrastructure mode, even when not associated,</span>
<span class="cm">	 * fields bssid and essid may be valid (if wpa_set and essid_set</span>
<span class="cm">	 * are true) as thy carry the value set by the user via iwconfig</span>
<span class="cm">	 */</span>
	<span class="k">struct</span> <span class="n">rtllib_network</span> <span class="n">current_network</span><span class="p">;</span>

	<span class="k">enum</span> <span class="n">rtllib_state</span> <span class="n">state</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">short_slot</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">reg_mode</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>       <span class="cm">/* A, B, G */</span>
	<span class="kt">int</span> <span class="n">modulation</span><span class="p">;</span> <span class="cm">/* CCK, OFDM */</span>
	<span class="kt">int</span> <span class="n">freq_band</span><span class="p">;</span>  <span class="cm">/* 2.4Ghz, 5.2Ghz, Mixed */</span>
	<span class="kt">int</span> <span class="n">abg_true</span><span class="p">;</span>   <span class="cm">/* ABG flag	      */</span>

	<span class="cm">/* used for forcing the ibss workqueue to terminate</span>
<span class="cm">	 * without wait for the syncro scan to terminate</span>
<span class="cm">	 */</span>
	<span class="kt">short</span> <span class="n">sync_scan_hurryup</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">scan_watch_dog</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">perfect_rssi</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">worst_rssi</span><span class="p">;</span>

	<span class="n">u16</span> <span class="n">prev_seq_ctl</span><span class="p">;</span>       <span class="cm">/* used to drop duplicate frames */</span>

	<span class="cm">/* map of allowed channels. 0 is dummy */</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">pDot11dInfo</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bGlobalDomain</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">active_channel_map</span><span class="p">[</span><span class="n">MAX_CHANNEL_NUMBER</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>

	<span class="n">u8</span>   <span class="n">IbssStartChnl</span><span class="p">;</span>
	<span class="n">u8</span>   <span class="n">ibss_maxjoin_chal</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">rate</span><span class="p">;</span>       <span class="cm">/* current rate */</span>
	<span class="kt">int</span> <span class="n">basic_rate</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">currentRate</span><span class="p">;</span>

	<span class="kt">short</span> <span class="n">active_scan</span><span class="p">;</span>

	<span class="cm">/* this contains flags for selectively enable softmac support */</span>
	<span class="n">u16</span> <span class="n">softmac_features</span><span class="p">;</span>

	<span class="cm">/* if the sequence control field is not filled by HW */</span>
	<span class="n">u16</span> <span class="n">seq_ctrl</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>

	<span class="cm">/* association procedure transaction sequence number */</span>
	<span class="n">u16</span> <span class="n">associate_seq</span><span class="p">;</span>

	<span class="cm">/* AID for RTXed association responses */</span>
	<span class="n">u16</span> <span class="n">assoc_id</span><span class="p">;</span>

	<span class="cm">/* power save mode related*/</span>
	<span class="n">u8</span> <span class="n">ack_tx_to_ieee</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">ps</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">sta_sleep</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ps_timeout</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">ps_period</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">ps_task</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">ps_time</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">polling</span><span class="p">;</span>

	<span class="kt">short</span> <span class="n">raw_tx</span><span class="p">;</span>
	<span class="cm">/* used if IEEE_SOFTMAC_TX_QUEUE is set */</span>
	<span class="kt">short</span> <span class="n">queue_stop</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">scanning_continue</span> <span class="p">;</span>
	<span class="kt">short</span> <span class="n">proto_started</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">proto_stoppping</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">semaphore</span> <span class="n">wx_sem</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">semaphore</span> <span class="n">scan_sem</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">semaphore</span> <span class="n">ips_sem</span><span class="p">;</span>

	<span class="n">spinlock_t</span> <span class="n">mgmt_tx_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">beacon_lock</span><span class="p">;</span>

	<span class="kt">short</span> <span class="n">beacon_txing</span><span class="p">;</span>

	<span class="kt">short</span> <span class="n">wap_set</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">ssid_set</span><span class="p">;</span>

	<span class="cm">/* set on initialization */</span>
	<span class="n">u8</span>  <span class="n">qos_support</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wmm_acm</span><span class="p">;</span>

	<span class="cm">/* for discarding duplicated packets in IBSS */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">ibss_mac_hash</span><span class="p">[</span><span class="n">IEEE_IBSS_MAC_HASH_SIZE</span><span class="p">];</span>

	<span class="cm">/* for discarding duplicated packets in BSS */</span>
	<span class="n">u16</span> <span class="n">last_rxseq_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span> <span class="cm">/* rx seq previous per-tid */</span>
	<span class="n">u16</span> <span class="n">last_rxfrag_num</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span><span class="cm">/* tx frag previous per-tid */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">last_packet_time</span><span class="p">[</span><span class="mi">17</span><span class="p">];</span>

	<span class="cm">/* for PS mode */</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">last_rx_ps_time</span><span class="p">;</span>
	<span class="n">bool</span>			<span class="n">bAwakePktSent</span><span class="p">;</span>
	<span class="n">u8</span>			<span class="n">LPSDelayCnt</span><span class="p">;</span>

	<span class="cm">/* used if IEEE_SOFTMAC_SINGLE_QUEUE is set */</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">mgmt_queue_ring</span><span class="p">[</span><span class="n">MGMT_QUEUE_NUM</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">mgmt_queue_head</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">mgmt_queue_tail</span><span class="p">;</span>
<span class="cp">#define RTLLIB_QUEUE_LIMIT 128</span>
	<span class="n">u8</span> <span class="n">AsocRetryCount</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hw_header</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">skb_waitQ</span><span class="p">[</span><span class="n">MAX_QUEUE_SIZE</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span>  <span class="n">skb_aggQ</span><span class="p">[</span><span class="n">MAX_QUEUE_SIZE</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span>  <span class="n">skb_drv_aggQ</span><span class="p">[</span><span class="n">MAX_QUEUE_SIZE</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">sta_edca_param</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">bool</span> <span class="n">aggregation</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">enable_rx_imm_BA</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bibsscoordinator</span><span class="p">;</span>

	<span class="n">bool</span>	<span class="n">bdynamic_txpower_enable</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">bCTSToSelfEnable</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">CTSToSelfTH</span><span class="p">;</span>

	<span class="n">u32</span>	<span class="n">fsync_time_interval</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">fsync_rate_bitmap</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">fsync_rssi_threshold</span><span class="p">;</span>
	<span class="n">bool</span>	<span class="n">bfsync_enable</span><span class="p">;</span>

	<span class="n">u8</span>	<span class="n">fsync_multiple_timeinterval</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">fsync_firstdiff_ratethreshold</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">fsync_seconddiff_ratethreshold</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">fsync_state</span> <span class="n">fsync_state</span><span class="p">;</span>
	<span class="n">bool</span>		<span class="n">bis_any_nonbepkts</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bandwidth_autoswitch</span> <span class="n">bandwidth_auto_switch</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">FwRWRF</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">rt_link_detect</span> <span class="n">LinkDetectInfo</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">bIsAggregateFrame</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">rt_pwr_save_ctrl</span> <span class="n">PowerSaveControl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">amsdu_in_process</span><span class="p">;</span>

	<span class="cm">/* used if IEEE_SOFTMAC_TX_QUEUE is set */</span>
	<span class="k">struct</span> <span class="n">tx_pending</span> <span class="n">tx_pending</span><span class="p">;</span>

	<span class="cm">/* used if IEEE_SOFTMAC_ASSOCIATE is set */</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">associate_timer</span><span class="p">;</span>

	<span class="cm">/* used if IEEE_SOFTMAC_BEACONS is set */</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">beacon_timer</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">need_sw_enc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">associate_complete_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">ips_leave_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">associate_procedure_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">softmac_scan_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">softmac_hint11d_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">associate_retry_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">start_ibss_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">hw_wakeup_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">hw_sleep_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">link_change_wq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">wx_sync_scan_wq</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">workqueue_struct</span> <span class="o">*</span><span class="n">wq</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="n">rtllib_rxb</span> <span class="o">*</span><span class="n">RfdArray</span><span class="p">[</span><span class="n">REORDER_WIN_SIZE</span><span class="p">];</span>
		<span class="k">struct</span> <span class="n">rtllib_rxb</span> <span class="o">*</span><span class="n">stats_IndicateArray</span><span class="p">[</span><span class="n">REORDER_WIN_SIZE</span><span class="p">];</span>
		<span class="k">struct</span> <span class="n">rtllib_rxb</span> <span class="o">*</span><span class="n">prxbIndicateArray</span><span class="p">[</span><span class="n">REORDER_WIN_SIZE</span><span class="p">];</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="k">struct</span> <span class="n">sw_chnl_cmd</span> <span class="n">PreCommonCmd</span><span class="p">[</span><span class="n">MAX_PRECMD_CNT</span><span class="p">];</span>
			<span class="k">struct</span> <span class="n">sw_chnl_cmd</span> <span class="n">PostCommonCmd</span><span class="p">[</span><span class="n">MAX_POSTCMD_CNT</span><span class="p">];</span>
			<span class="k">struct</span> <span class="n">sw_chnl_cmd</span> <span class="n">RfDependCmd</span><span class="p">[</span><span class="n">MAX_RFDEPENDCMD_CNT</span><span class="p">];</span>
		<span class="p">};</span>
	<span class="p">};</span>

	<span class="cm">/* Callback functions */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_security</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">rtllib_security</span> <span class="o">*</span><span class="n">sec</span><span class="p">);</span>

	<span class="cm">/* Used to TX data frame by using txb structs.</span>
<span class="cm">	 * this is not used if in the softmac_features</span>
<span class="cm">	 * is set the flag IEEE_SOFTMAC_TX_QUEUE</span>
<span class="cm">	 */</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">hard_start_xmit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">rtllib_txb</span> <span class="o">*</span><span class="n">txb</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">reset_port</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">is_queue_full</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">pri</span><span class="p">);</span>

	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">handle_management</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">network</span><span class="p">,</span> <span class="n">u16</span> <span class="n">type</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">is_qos_active</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>

	<span class="cm">/* Softmac-generated frames (mamagement) are TXed via this</span>
<span class="cm">	 * callback if the flag IEEE_SOFTMAC_SINGLE_QUEUE is</span>
<span class="cm">	 * not set. As some cards may have different HW queues that</span>
<span class="cm">	 * one might want to use for data and management frames</span>
<span class="cm">	 * the option to have two callbacks might be useful.</span>
<span class="cm">	 * This fucntion can&#39;t sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">softmac_hard_start_xmit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* used instead of hard_start_xmit (not softmac_hard_start_xmit)</span>
<span class="cm">	 * if the IEEE_SOFTMAC_TX_QUEUE feature is used to TX data</span>
<span class="cm">	 * frames. If the option IEEE_SOFTMAC_SINGLE_QUEUE is also set</span>
<span class="cm">	 * then also management frames are sent via this callback.</span>
<span class="cm">	 * This function can&#39;t sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">softmac_data_hard_start_xmit</span><span class="p">)(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rate</span><span class="p">);</span>

	<span class="cm">/* stops the HW queue for DATA frames. Useful to avoid</span>
<span class="cm">	 * waste time to TX data frame when we are reassociating</span>
<span class="cm">	 * This function can sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">data_hard_stop</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* OK this is complementing to data_poll_hard_stop */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">data_hard_resume</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* ask to the driver to retune the radio .</span>
<span class="cm">	 * This function can sleep. the driver should ensure</span>
<span class="cm">	 * the radio has been switched before return.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">set_chan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">short</span> <span class="n">ch</span><span class="p">);</span>

	<span class="cm">/* These are not used if the ieee stack takes care of</span>
<span class="cm">	 * scanning (IEEE_SOFTMAC_SCAN feature set).</span>
<span class="cm">	 * In this case only the set_chan is used.</span>
<span class="cm">	 *</span>
<span class="cm">	 * The syncro version is similar to the start_scan but</span>
<span class="cm">	 * does not return until all channels has been scanned.</span>
<span class="cm">	 * this is called in user context and should sleep,</span>
<span class="cm">	 * it is called in a work_queue when switching to ad-hoc mode</span>
<span class="cm">	 * or in behalf of iwlist scan when the card is associated</span>
<span class="cm">	 * and root user ask for a scan.</span>
<span class="cm">	 * the fucntion stop_scan should stop both the syncro and</span>
<span class="cm">	 * background scanning and can sleep.</span>
<span class="cm">	 * The fucntion start_scan should initiate the background</span>
<span class="cm">	 * scanning and can&#39;t sleep.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">scan_syncro</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">start_scan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">stop_scan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtllib_start_hw_scan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtllib_stop_hw_scan</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* indicate the driver that the link state is changed</span>
<span class="cm">	 * for example it may indicate the card is associated now.</span>
<span class="cm">	 * Driver might be interested in this to apply RX filter</span>
<span class="cm">	 * rules or simply light the LINK led</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">link_change</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* these two function indicates to the HW when to start</span>
<span class="cm">	 * and stop to send beacons. This is used when the</span>
<span class="cm">	 * IEEE_SOFTMAC_BEACONS is not set. For now the</span>
<span class="cm">	 * stop_send_bacons is NOT guaranteed to be called only</span>
<span class="cm">	 * after start_send_beacons.</span>
<span class="cm">	 */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">start_send_beacons</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">stop_send_beacons</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* power save mode related */</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">sta_wake_up</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">enter_sleep_state</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u64</span> <span class="n">time</span><span class="p">);</span>
	<span class="kt">short</span> <span class="p">(</span><span class="o">*</span><span class="n">ps_is_queue_empty</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">handle_beacon</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">rtllib_beacon</span> <span class="o">*</span><span class="n">beacon</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">network</span><span class="p">);</span>
	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">handle_assoc_response</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				     <span class="k">struct</span> <span class="n">rtllib_assoc_response_frame</span> <span class="o">*</span><span class="n">resp</span><span class="p">,</span>
				     <span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">network</span><span class="p">);</span>


	<span class="cm">/* check whether Tx hw resource available */</span>
	<span class="kt">short</span> <span class="p">(</span><span class="o">*</span><span class="n">check_nic_enough_desc</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">queue_index</span><span class="p">);</span>
	<span class="kt">short</span> <span class="p">(</span><span class="o">*</span><span class="n">get_nic_desc_num</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">queue_index</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">SetBWModeHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				 <span class="k">enum</span> <span class="n">ht_channel_width</span> <span class="n">Bandwidth</span><span class="p">,</span>
				 <span class="k">enum</span> <span class="n">ht_extchnl_offset</span> <span class="n">Offset</span><span class="p">);</span>
	<span class="n">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">GetNmodeSupportBySecCfg</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">SetWirelessMode</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u8</span> <span class="n">wireless_mode</span><span class="p">);</span>
	<span class="n">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">GetHalfNmodeSupportByAPsHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="n">u8</span>   <span class="p">(</span><span class="o">*</span><span class="n">rtllib_ap_sec_type</span><span class="p">)(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">HalUsbRxAggrHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">bool</span> <span class="n">Value</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">InitialGainHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u8</span> <span class="n">Operation</span><span class="p">);</span>
	<span class="n">bool</span> <span class="p">(</span><span class="o">*</span><span class="n">SetFwCmdHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				<span class="k">enum</span> <span class="n">fw_cmd_io_type</span> <span class="n">FwCmdIO</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UpdateHalRAMaskHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">bool</span> <span class="n">bMulticast</span><span class="p">,</span>
				       <span class="n">u8</span> <span class="n">macId</span><span class="p">,</span> <span class="n">u8</span> <span class="n">MimoPs</span><span class="p">,</span> <span class="n">u8</span> <span class="n">WirelessMode</span><span class="p">,</span>
				       <span class="n">u8</span> <span class="n">bCurTxBW40MHz</span><span class="p">,</span> <span class="n">u8</span> <span class="n">rssi_level</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UpdateBeaconInterruptHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					     <span class="n">bool</span> <span class="n">start</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">UpdateInterruptMaskHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u32</span> <span class="n">AddMSR</span><span class="p">,</span>
					   <span class="n">u32</span> <span class="n">RemoveMSR</span><span class="p">);</span>
	<span class="n">u16</span>  <span class="p">(</span><span class="o">*</span><span class="n">rtl_11n_user_show_rates</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">ScanOperationBackupHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					   <span class="n">u8</span> <span class="n">Operation</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">LedControlHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
				  <span class="k">enum</span> <span class="n">led_ctl_mode</span> <span class="n">LedAction</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">SetHwRegHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u8</span> <span class="n">variable</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">val</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">GetHwRegHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="n">u8</span> <span class="n">variable</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">val</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">AllowAllDestAddrHandler</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					<span class="n">bool</span> <span class="n">bAllowAllDA</span><span class="p">,</span> <span class="n">bool</span> <span class="n">WriteIntoReg</span><span class="p">);</span>

	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtllib_ips_leave_wq</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtllib_ips_leave</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">LeisurePSLeave</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtllib_rfkill_poll</span><span class="p">)(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>

	<span class="cm">/* This must be the last item so that it points to the data</span>
<span class="cm">	 * allocated beyond this structure by alloc_rtllib */</span>
	<span class="n">u8</span> <span class="n">priv</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define IEEE_A	    (1&lt;&lt;0)</span>
<span class="cp">#define IEEE_B	    (1&lt;&lt;1)</span>
<span class="cp">#define IEEE_G	    (1&lt;&lt;2)</span>
<span class="cp">#define IEEE_N_24G		  (1&lt;&lt;4)</span>
<span class="cp">#define	IEEE_N_5G		  (1&lt;&lt;5)</span>
<span class="cp">#define IEEE_MODE_MASK    (IEEE_A|IEEE_B|IEEE_G)</span>

<span class="cm">/* Generate a 802.11 header */</span>

<span class="cm">/* Uses the channel change callback directly</span>
<span class="cm"> * instead of [start/stop] scan callbacks</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE_SOFTMAC_SCAN (1&lt;&lt;2)</span>

<span class="cm">/* Perform authentication and association handshake */</span>
<span class="cp">#define IEEE_SOFTMAC_ASSOCIATE (1&lt;&lt;3)</span>

<span class="cm">/* Generate probe requests */</span>
<span class="cp">#define IEEE_SOFTMAC_PROBERQ (1&lt;&lt;4)</span>

<span class="cm">/* Generate response to probe requests */</span>
<span class="cp">#define IEEE_SOFTMAC_PROBERS (1&lt;&lt;5)</span>

<span class="cm">/* The ieee802.11 stack will manage the netif queue</span>
<span class="cm"> * wake/stop for the driver, taking care of 802.11</span>
<span class="cm"> * fragmentation. See softmac.c for details. */</span>
<span class="cp">#define IEEE_SOFTMAC_TX_QUEUE (1&lt;&lt;7)</span>

<span class="cm">/* Uses only the softmac_data_hard_start_xmit</span>
<span class="cm"> * even for TX management frames.</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE_SOFTMAC_SINGLE_QUEUE (1&lt;&lt;8)</span>

<span class="cm">/* Generate beacons.  The stack will enqueue beacons</span>
<span class="cm"> * to the card</span>
<span class="cm"> */</span>
<span class="cp">#define IEEE_SOFTMAC_BEACONS (1&lt;&lt;6)</span>


<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="o">*</span><span class="nf">rtllib_priv</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="p">)</span><span class="n">netdev_priv</span><span class="p">(</span><span class="n">dev</span><span class="p">))</span><span class="o">-&gt;</span><span class="n">priv</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rtllib_is_empty_essid</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">essid</span><span class="p">,</span> <span class="kt">int</span> <span class="n">essid_len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* Single white space is for Linksys APs */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">essid_len</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">essid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39; &#39;</span><span class="p">)</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="cm">/* Otherwise, if the entire essid is 0, we assume it is hidden */</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">essid_len</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">essid_len</span><span class="o">--</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">essid</span><span class="p">[</span><span class="n">essid_len</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rtllib_is_valid_mode</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * It is possible for both access points and our device to support</span>
<span class="cm">	 * combinations of modes, so as long as there is one valid combination</span>
<span class="cm">	 * of ap/device supported modes, then return success</span>
<span class="cm">	 *</span>
<span class="cm">	 */</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="n">IEEE_A</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">modulation</span> <span class="o">&amp;</span> <span class="n">RTLLIB_OFDM_MODULATION</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">freq_band</span> <span class="o">&amp;</span> <span class="n">RTLLIB_52GHZ_BAND</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="n">IEEE_G</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">modulation</span> <span class="o">&amp;</span> <span class="n">RTLLIB_OFDM_MODULATION</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">freq_band</span> <span class="o">&amp;</span> <span class="n">RTLLIB_24GHZ_BAND</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">((</span><span class="n">mode</span> <span class="o">&amp;</span> <span class="n">IEEE_B</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">modulation</span> <span class="o">&amp;</span> <span class="n">RTLLIB_CCK_MODULATION</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="p">(</span><span class="n">ieee</span><span class="o">-&gt;</span><span class="n">freq_band</span> <span class="o">&amp;</span> <span class="n">RTLLIB_24GHZ_BAND</span><span class="p">))</span>
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rtllib_get_hdrlen</span><span class="p">(</span><span class="n">u16</span> <span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">hdrlen</span> <span class="o">=</span> <span class="n">RTLLIB_3ADDR_LEN</span><span class="p">;</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">WLAN_FC_GET_TYPE</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">RTLLIB_FTYPE_DATA</span>:
		<span class="k">if</span> <span class="p">((</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">RTLLIB_FCTL_FROMDS</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">fc</span> <span class="o">&amp;</span> <span class="n">RTLLIB_FCTL_TODS</span><span class="p">))</span>
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="n">RTLLIB_4ADDR_LEN</span><span class="p">;</span> <span class="cm">/* Addr4 */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">RTLLIB_QOS_HAS_SEQ</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span>
			<span class="n">hdrlen</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span> <span class="cm">/* QOS ctrl*/</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">RTLLIB_FTYPE_CTL</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="n">WLAN_FC_GET_STYPE</span><span class="p">(</span><span class="n">fc</span><span class="p">))</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">RTLLIB_STYPE_CTS</span>:
		<span class="k">case</span> <span class="n">RTLLIB_STYPE_ACK</span>:
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="n">RTLLIB_1ADDR_LEN</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="nl">default:</span>
			<span class="n">hdrlen</span> <span class="o">=</span> <span class="n">RTLLIB_2ADDR_LEN</span><span class="p">;</span>
			<span class="k">break</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">hdrlen</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">u8</span> <span class="o">*</span><span class="nf">rtllib_get_payload</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_hdr</span> <span class="o">*</span><span class="n">hdr</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">rtllib_get_hdrlen</span><span class="p">(</span><span class="n">le16_to_cpu</span><span class="p">(</span><span class="n">hdr</span><span class="o">-&gt;</span><span class="n">frame_ctl</span><span class="p">)))</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">RTLLIB_1ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">rtllib_hdr_1addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">RTLLIB_2ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">rtllib_hdr_2addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">RTLLIB_3ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">rtllib_hdr_3addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">RTLLIB_4ADDR_LEN</span>:
		<span class="k">return</span> <span class="p">((</span><span class="k">struct</span> <span class="n">rtllib_hdr_4addr</span> <span class="o">*</span><span class="p">)</span><span class="n">hdr</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">payload</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rtllib_is_ofdm_rate</span><span class="p">(</span><span class="n">u8</span> <span class="n">rate</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">RTLLIB_BASIC_RATE_MASK</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_6MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_9MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_12MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_18MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_24MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_36MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_48MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_OFDM_RATE_54MB</span>:
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rtllib_is_cck_rate</span><span class="p">(</span><span class="n">u8</span> <span class="n">rate</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">switch</span> <span class="p">(</span><span class="n">rate</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">RTLLIB_BASIC_RATE_MASK</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">RTLLIB_CCK_RATE_1MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_CCK_RATE_2MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_CCK_RATE_5MB</span>:
	<span class="k">case</span> <span class="n">RTLLIB_CCK_RATE_11MB</span>:
		<span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/* rtllib.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">free_rtllib</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">alloc_rtllib</span><span class="p">(</span><span class="kt">int</span> <span class="n">sizeof_priv</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_set_encryption</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>

<span class="cm">/* rtllib_tx.c */</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_encrypt_fragment</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">frag</span><span class="p">,</span>
	<span class="kt">int</span> <span class="n">hdr_len</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>  <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_xmit_inter</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_txb_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_txb</span> <span class="o">*</span><span class="p">);</span>

<span class="cm">/* rtllib_rx.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_rx</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">rtllib_rx_stats</span> <span class="o">*</span><span class="n">rx_stats</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_rx_mgt</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">rtllib_rx_stats</span> <span class="o">*</span><span class="n">stats</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_rx_probe_rq</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_legal_channel</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">rtllib</span><span class="p">,</span> <span class="n">u8</span> <span class="n">channel</span><span class="p">);</span>

<span class="cm">/* rtllib_wx.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_scan</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				 <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_encode</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				   <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_encode</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				   <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">key</span><span class="p">);</span>
<span class="cp">#if WIRELESS_EXT &gt;= 18</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_encode_ext</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			    <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_encode_ext</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			    <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_auth</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_param</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_mlme</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			       <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_gen_ie</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">ie</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">);</span>

<span class="cm">/* rtllib_softmac.c */</span>
<span class="k">extern</span> <span class="kt">short</span> <span class="n">rtllib_is_54g</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">net</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">short</span> <span class="n">rtllib_is_shortslot</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">net</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_rx_frame_softmac</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">rtllib_rx_stats</span> <span class="o">*</span><span class="n">rx_stats</span><span class="p">,</span> <span class="n">u16</span> <span class="n">type</span><span class="p">,</span>
				   <span class="n">u16</span> <span class="n">stype</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_softmac_new_net</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				   <span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">net</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">SendDisassociation</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">bool</span> <span class="n">deauth</span><span class="p">,</span> <span class="n">u16</span> <span class="n">asRsn</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_softmac_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_txb</span> <span class="o">*</span><span class="n">txb</span><span class="p">,</span>
				<span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_stop_send_beacons</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">notify_wx_assoc_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_softmac_check_all_nets</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_start_bss</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_start_master_bss</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_start_ibss</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_softmac_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_softmac_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_associate_abort</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_disassociate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_stop_scan</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">bool</span> <span class="n">rtllib_act_scanning</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">bool</span> <span class="n">sync_scan</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_stop_scan_syncro</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_start_scan_syncro</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">is_mesh</span><span class="p">);</span>
<span class="k">extern</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">rtllib_probe_req</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">MgntQuery_MgntFrameTxRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_sta_ps_send_null_frame</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
					  <span class="kt">short</span> <span class="n">pwr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_sta_wakeup</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="kt">short</span> <span class="n">nl</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_sta_ps_send_pspoll_frame</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_check_all_nets</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_start_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_stop_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">shutdown</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_EnableNetMonitorMode</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					<span class="n">bool</span> <span class="n">bInitState</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_DisableNetMonitorMode</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					 <span class="n">bool</span> <span class="n">bInitState</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_EnableIntelPromiscuousMode</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					      <span class="n">bool</span> <span class="n">bInitState</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_DisableIntelPromiscuousMode</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
					       <span class="n">bool</span> <span class="n">bInitState</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_send_probe_requests</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">is_mesh</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_softmac_stop_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
					 <span class="n">u8</span> <span class="n">mesh_flag</span><span class="p">,</span> <span class="n">u8</span> <span class="n">shutdown</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_softmac_start_protocol</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
					  <span class="n">u8</span> <span class="n">mesh_flag</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_reset_queue</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_wake_queue</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_stop_queue</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_wake_all_queues</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_stop_all_queues</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">rtllib_get_beacon</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_start_send_beacons</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_stop_send_beacons</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wpa_supplicant_ioctl</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">iw_point</span> <span class="o">*</span><span class="n">p</span><span class="p">,</span> <span class="n">u8</span> <span class="n">is_mesh</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">notify_wx_assoc_event</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_ps_tx_ack</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="kt">short</span> <span class="n">success</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="n">softmac_mgmt_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">rtllib_query_seqnum</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">dst</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">rtllib_ap_sec_type</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>

<span class="cm">/* rtllib_crypt_ccmp&amp;tkip&amp;wep.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_tkip_null</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_wep_null</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_ccmp_null</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>

<span class="cm">/* rtllib_softmac_wx.c */</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_wap</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ext</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_wap</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">awrq</span><span class="p">,</span>
			     <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_essid</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			       <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_rate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_rate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_mode</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_scan</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_essid</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_mode</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_freq</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_freq</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			      <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span>
			      <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">b</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_wx_sync_scan_wq</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_rawtx</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			       <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_name</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_power</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				 <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_power</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				 <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
				 <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_set_rts</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>

<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_wx_get_rts</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">iw_request_info</span> <span class="o">*</span><span class="n">info</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">iwreq_data</span> <span class="o">*</span><span class="n">wrqu</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">extra</span><span class="p">);</span>
<span class="cp">#define MAX_RECEIVE_BUFFER_SIZE 9100</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTDebugHTCapability</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">CapIE</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">TitleString</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTDebugHTInfo</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">InfoIE</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">TitleString</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">HTSetConnectBwMode</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">ht_channel_width</span> <span class="n">Bandwidth</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">ht_extchnl_offset</span> <span class="n">Offset</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTUpdateDefaultSetting</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTConstructCapabilityElement</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
					 <span class="n">u8</span> <span class="o">*</span><span class="n">posHTCap</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">len</span><span class="p">,</span>
					 <span class="n">u8</span> <span class="n">isEncrypt</span><span class="p">,</span> <span class="n">bool</span> <span class="n">bAssoc</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTConstructInfoElement</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				   <span class="n">u8</span> <span class="o">*</span><span class="n">posHTInfo</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">len</span><span class="p">,</span> <span class="n">u8</span> <span class="n">isEncrypt</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTConstructRT2RTAggElement</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				       <span class="n">u8</span> <span class="o">*</span><span class="n">posRT2RTAgg</span><span class="p">,</span> <span class="n">u8</span><span class="o">*</span> <span class="n">len</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTOnAssocRsp</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTInitializeHTInfo</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTInitializeBssDesc</span><span class="p">(</span><span class="k">struct</span> <span class="n">bss_ht</span> <span class="o">*</span><span class="n">pBssHT</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTResetSelfAndSavePeerSetting</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
					  <span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">pNetwork</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HT_update_self_and_peer_setting</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
					    <span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">pNetwork</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">HTGetHighestMCSRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">pMCSRateSet</span><span class="p">,</span>
			      <span class="n">u8</span> <span class="o">*</span><span class="n">pMCSFilter</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">MCS_FILTER_ALL</span><span class="p">[];</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">MCS_DATA_RATE</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">77</span><span class="p">]</span> <span class="p">;</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">HTCCheck</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">pFrame</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTResetIOTSetting</span><span class="p">(</span><span class="k">struct</span> <span class="n">rt_hi_throughput</span> <span class="o">*</span><span class="n">pHTInfo</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">bool</span> <span class="n">IsHTHalfNmodeAPs</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">HTHalfMcsToDataRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">nMcsRate</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">HTMcsToDataRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">nMcsRate</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span>  <span class="n">TxCountToDataRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">nDataRate</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_rx_ADDBAReq</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_rx_ADDBARsp</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_rx_DELBA</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TsInitAddBA</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="k">struct</span> <span class="n">tx_ts_record</span> <span class="o">*</span><span class="n">pTS</span><span class="p">,</span>
			<span class="n">u8</span> <span class="n">Policy</span><span class="p">,</span> <span class="n">u8</span> <span class="n">bOverwritePending</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TsInitDelBA</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			<span class="k">struct</span> <span class="n">ts_common_info</span> <span class="o">*</span><span class="n">pTsCommonInfo</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">tr_select</span> <span class="n">TxRxSelect</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">BaSetupTimeOut</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TxBaInactTimeout</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">RxBaInactTimeout</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ResetBaEntry</span><span class="p">(</span><span class="k">struct</span> <span class="n">ba_record</span> <span class="o">*</span><span class="n">pBA</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">bool</span> <span class="n">GetTs</span><span class="p">(</span>
	<span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
	<span class="k">struct</span> <span class="n">ts_common_info</span> <span class="o">**</span><span class="n">ppTS</span><span class="p">,</span>
	<span class="n">u8</span> <span class="o">*</span><span class="n">Addr</span><span class="p">,</span>
	<span class="n">u8</span> <span class="n">TID</span><span class="p">,</span>
	<span class="k">enum</span> <span class="n">tr_select</span> <span class="n">TxRxSelect</span><span class="p">,</span>
	<span class="n">bool</span> <span class="n">bAddNewTs</span>
<span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">TSInitialize</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span>  <span class="kt">void</span> <span class="n">TsStartAddBaProcess</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
				  <span class="k">struct</span> <span class="n">tx_ts_record</span> <span class="o">*</span><span class="n">pTxTS</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">RemovePeerTS</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">Addr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">RemoveAllTS</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">rtllib_softmac_scan_syncro</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="n">is_mesh</span><span class="p">);</span>

<span class="k">extern</span> <span class="k">const</span> <span class="kt">long</span> <span class="n">rtllib_wlan_frequencies</span><span class="p">[];</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">rtllib_increment_scans</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ieee</span><span class="o">-&gt;</span><span class="n">scans</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">rtllib_get_scans</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">ieee</span><span class="o">-&gt;</span><span class="n">scans</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="nf">escape_essid</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">essid</span><span class="p">,</span> <span class="n">u8</span> <span class="n">essid_len</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="kt">char</span> <span class="n">escaped</span><span class="p">[</span><span class="n">IW_ESSID_MAX_SIZE</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">s</span> <span class="o">=</span> <span class="n">essid</span><span class="p">;</span>
	<span class="kt">char</span> <span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="n">escaped</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">rtllib_is_empty_essid</span><span class="p">(</span><span class="n">essid</span><span class="p">,</span> <span class="n">essid_len</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">memcpy</span><span class="p">(</span><span class="n">escaped</span><span class="p">,</span> <span class="s">&quot;&lt;hidden&gt;&quot;</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="s">&quot;&lt;hidden&gt;&quot;</span><span class="p">));</span>
		<span class="k">return</span> <span class="n">escaped</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">essid_len</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">essid_len</span><span class="p">,</span> <span class="p">(</span><span class="n">u8</span><span class="p">)</span><span class="n">IW_ESSID_MAX_SIZE</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">essid_len</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">s</span> <span class="o">==</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span> <span class="p">{</span>
			<span class="o">*</span><span class="n">d</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;\\&#39;</span><span class="p">;</span>
			<span class="o">*</span><span class="n">d</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
			<span class="n">s</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="o">*</span><span class="n">d</span><span class="o">++</span> <span class="o">=</span> <span class="o">*</span><span class="n">s</span><span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="o">*</span><span class="n">d</span> <span class="o">=</span> <span class="sc">&#39;\0&#39;</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">escaped</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#define CONVERT_RATE(_ieee, _MGN_RATE)			\</span>
<span class="cp">	((_MGN_RATE &lt; MGN_MCS0) ? (_MGN_RATE) :		\</span>
<span class="cp">	(HTMcsToDataRate(_ieee, (u8)_MGN_RATE)))</span>

<span class="cm">/* fun with the built-in rtllib stack... */</span>
<span class="n">bool</span> <span class="n">rtllib_MgntDisconnect</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">rtllib</span><span class="p">,</span> <span class="n">u8</span> <span class="n">asRsn</span><span class="p">);</span>


<span class="cm">/* For the function is more related to hardware setting, it&#39;s better to use the</span>
<span class="cm"> * ieee handler to refer to it.</span>
<span class="cm"> */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_update_active_chan_map</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_FlushRxTsPendingPkts</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
					<span class="k">struct</span> <span class="n">rx_ts_record</span> <span class="o">*</span><span class="n">pTS</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_data_xmit</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">rtllib_parse_info_param</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">rtllib_info_element</span> <span class="o">*</span><span class="n">info_element</span><span class="p">,</span>
		<span class="n">u16</span> <span class="n">length</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">rtllib_network</span> <span class="o">*</span><span class="n">network</span><span class="p">,</span>
		<span class="k">struct</span> <span class="n">rtllib_rx_stats</span> <span class="o">*</span><span class="n">stats</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">rtllib_indicate_packets</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">rtllib_rxb</span> <span class="o">**</span><span class="n">prxbIndicateArray</span><span class="p">,</span> <span class="n">u8</span>  <span class="n">index</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u8</span> <span class="n">HTFilterMCSRate</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="o">*</span><span class="n">pSupportMCS</span><span class="p">,</span>
			  <span class="n">u8</span> <span class="o">*</span><span class="n">pOperateMCS</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">HTUseDefaultSetting</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="cp">#define RT_ASOC_RETRY_LIMIT	5</span>
<span class="n">u8</span> <span class="n">MgntQuery_TxRateExcludeCCKRates</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">rtllib_TURBO_Info</span><span class="p">(</span><span class="k">struct</span> <span class="n">rtllib_device</span> <span class="o">*</span><span class="n">ieee</span><span class="p">,</span> <span class="n">u8</span> <span class="o">**</span><span class="n">tag_p</span><span class="p">);</span>
<span class="cp">#ifndef ENABLE_LOCK_DEBUG</span>
<span class="cp">#define SPIN_LOCK_IEEE(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_IEEE(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_IEEE_REORDER(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_IEEE_REORDER(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_IEEE_WPAX(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_IEEE_WPAX(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_IEEE_MGNTTX(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_IEEE_MGNTTX(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_IEEE_BCN(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_IEEE_BCN(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_MSH_STAINFO(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_MSH_STAINFO(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_MSH_PREQ(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_MSH_PREQ(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_MSH_QUEUE(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_MSH_QUEUE(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_PRIV_RFPS(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_PRIV_RFPS(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_PRIV_IRQTH(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_PRIV_IRQTH(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_PRIV_TX(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_PRIV_TX(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_PRIV_D3(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_PRIV_D3(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_PRIV_RF(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_PRIV_RF(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SPIN_LOCK_PRIV_PS(plock) spin_lock_irqsave((plock), flags)</span>
<span class="cp">#define SPIN_UNLOCK_PRIV_PS(plock) spin_unlock_irqrestore((plock), flags)</span>
<span class="cp">#define SEM_DOWN_IEEE_WX(psem) down(psem)</span>
<span class="cp">#define SEM_UP_IEEE_WX(psem) up(psem)</span>
<span class="cp">#define SEM_DOWN_IEEE_SCAN(psem) down(psem)</span>
<span class="cp">#define SEM_UP_IEEE_SCAN(psem) up(psem)</span>
<span class="cp">#define SEM_DOWN_IEEE_IPS(psem) down(psem)</span>
<span class="cp">#define SEM_UP_IEEE_IPS(psem) up(psem)</span>
<span class="cp">#define SEM_DOWN_PRIV_WX(psem) down(psem)</span>
<span class="cp">#define SEM_UP_PRIV_WX(psem) up(psem)</span>
<span class="cp">#define SEM_DOWN_PRIV_RF(psem) down(psem)</span>
<span class="cp">#define SEM_UP_PRIV_RF(psem) up(psem)</span>
<span class="cp">#define MUTEX_LOCK_PRIV(pmutex) mutex_lock(pmutex)</span>
<span class="cp">#define MUTEX_UNLOCK_PRIV(pmutex) mutex_unlock(pmutex)</span>
<span class="cp">#endif</span>

<span class="cp">#endif </span><span class="cm">/* RTLLIB_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
