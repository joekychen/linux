<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › dma › ioat › registers.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../index.html"></a><h1>registers.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright(c) 2004 - 2009 Intel Corporation. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License as published by the Free</span>
<span class="cm"> * Software Foundation; either version 2 of the License, or (at your option)</span>
<span class="cm"> * any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but WITHOUT</span>
<span class="cm"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for</span>
<span class="cm"> * more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License along with</span>
<span class="cm"> * this program; if not, write to the Free Software Foundation, Inc., 59</span>
<span class="cm"> * Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
<span class="cm"> *</span>
<span class="cm"> * The full GNU General Public License is included in this distribution in the</span>
<span class="cm"> * file called COPYING.</span>
<span class="cm"> */</span>
<span class="cp">#ifndef _IOAT_REGISTERS_H_</span>
<span class="cp">#define _IOAT_REGISTERS_H_</span>

<span class="cp">#define IOAT_PCI_DMACTRL_OFFSET			0x48</span>
<span class="cp">#define IOAT_PCI_DMACTRL_DMA_EN			0x00000001</span>
<span class="cp">#define IOAT_PCI_DMACTRL_MSI_EN			0x00000002</span>

<span class="cp">#define IOAT_PCI_DEVICE_ID_OFFSET		0x02</span>
<span class="cp">#define IOAT_PCI_DMAUNCERRSTS_OFFSET		0x148</span>
<span class="cp">#define IOAT_PCI_CHANERR_INT_OFFSET		0x180</span>
<span class="cp">#define IOAT_PCI_CHANERRMASK_INT_OFFSET		0x184</span>

<span class="cm">/* MMIO Device Registers */</span>
<span class="cp">#define IOAT_CHANCNT_OFFSET			0x00	</span><span class="cm">/*  8-bit */</span><span class="cp"></span>

<span class="cp">#define IOAT_XFERCAP_OFFSET			0x01	</span><span class="cm">/*  8-bit */</span><span class="cp"></span>
<span class="cp">#define IOAT_XFERCAP_4KB			12</span>
<span class="cp">#define IOAT_XFERCAP_8KB			13</span>
<span class="cp">#define IOAT_XFERCAP_16KB			14</span>
<span class="cp">#define IOAT_XFERCAP_32KB			15</span>
<span class="cp">#define IOAT_XFERCAP_32GB			0</span>

<span class="cp">#define IOAT_GENCTRL_OFFSET			0x02	</span><span class="cm">/*  8-bit */</span><span class="cp"></span>
<span class="cp">#define IOAT_GENCTRL_DEBUG_EN			0x01</span>

<span class="cp">#define IOAT_INTRCTRL_OFFSET			0x03	</span><span class="cm">/*  8-bit */</span><span class="cp"></span>
<span class="cp">#define IOAT_INTRCTRL_MASTER_INT_EN		0x01	</span><span class="cm">/* Master Interrupt Enable */</span><span class="cp"></span>
<span class="cp">#define IOAT_INTRCTRL_INT_STATUS		0x02	</span><span class="cm">/* ATTNSTATUS -or- Channel Int */</span><span class="cp"></span>
<span class="cp">#define IOAT_INTRCTRL_INT			0x04	</span><span class="cm">/* INT_STATUS -and- MASTER_INT_EN */</span><span class="cp"></span>
<span class="cp">#define IOAT_INTRCTRL_MSIX_VECTOR_CONTROL	0x08	</span><span class="cm">/* Enable all MSI-X vectors */</span><span class="cp"></span>

<span class="cp">#define IOAT_ATTNSTATUS_OFFSET			0x04	</span><span class="cm">/* Each bit is a channel */</span><span class="cp"></span>

<span class="cp">#define IOAT_VER_OFFSET				0x08	</span><span class="cm">/*  8-bit */</span><span class="cp"></span>
<span class="cp">#define IOAT_VER_MAJOR_MASK			0xF0</span>
<span class="cp">#define IOAT_VER_MINOR_MASK			0x0F</span>
<span class="cp">#define GET_IOAT_VER_MAJOR(x)			(((x) &amp; IOAT_VER_MAJOR_MASK) &gt;&gt; 4)</span>
<span class="cp">#define GET_IOAT_VER_MINOR(x)			((x) &amp; IOAT_VER_MINOR_MASK)</span>

<span class="cp">#define IOAT_PERPORTOFFSET_OFFSET		0x0A	</span><span class="cm">/* 16-bit */</span><span class="cp"></span>

<span class="cp">#define IOAT_INTRDELAY_OFFSET			0x0C	</span><span class="cm">/* 16-bit */</span><span class="cp"></span>
<span class="cp">#define IOAT_INTRDELAY_MASK			0x3FFF	</span><span class="cm">/* Interrupt Delay Time */</span><span class="cp"></span>
<span class="cp">#define IOAT_INTRDELAY_COALESE_SUPPORT		0x8000	</span><span class="cm">/* Interrupt Coalescing Supported */</span><span class="cp"></span>

<span class="cp">#define IOAT_DEVICE_STATUS_OFFSET		0x0E	</span><span class="cm">/* 16-bit */</span><span class="cp"></span>
<span class="cp">#define IOAT_DEVICE_STATUS_DEGRADED_MODE	0x0001</span>
<span class="cp">#define IOAT_DEVICE_MMIO_RESTRICTED		0x0002</span>
<span class="cp">#define IOAT_DEVICE_MEMORY_BYPASS		0x0004</span>
<span class="cp">#define IOAT_DEVICE_ADDRESS_REMAPPING		0x0008</span>

<span class="cp">#define IOAT_DMA_CAP_OFFSET			0x10	</span><span class="cm">/* 32-bit */</span><span class="cp"></span>
<span class="cp">#define IOAT_CAP_PAGE_BREAK			0x00000001</span>
<span class="cp">#define IOAT_CAP_CRC				0x00000002</span>
<span class="cp">#define IOAT_CAP_SKIP_MARKER			0x00000004</span>
<span class="cp">#define IOAT_CAP_DCA				0x00000010</span>
<span class="cp">#define IOAT_CAP_CRC_MOVE			0x00000020</span>
<span class="cp">#define IOAT_CAP_FILL_BLOCK			0x00000040</span>
<span class="cp">#define IOAT_CAP_APIC				0x00000080</span>
<span class="cp">#define IOAT_CAP_XOR				0x00000100</span>
<span class="cp">#define IOAT_CAP_PQ				0x00000200</span>

<span class="cp">#define IOAT_CHANNEL_MMIO_SIZE			0x80	</span><span class="cm">/* Each Channel MMIO space is this size */</span><span class="cp"></span>

<span class="cm">/* DMA Channel Registers */</span>
<span class="cp">#define IOAT_CHANCTRL_OFFSET			0x00	</span><span class="cm">/* 16-bit Channel Control Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_CHANCTRL_CHANNEL_PRIORITY_MASK	0xF000</span>
<span class="cp">#define IOAT3_CHANCTRL_COMPL_DCA_EN		0x0200</span>
<span class="cp">#define IOAT_CHANCTRL_CHANNEL_IN_USE		0x0100</span>
<span class="cp">#define IOAT_CHANCTRL_DESCRIPTOR_ADDR_SNOOP_CONTROL	0x0020</span>
<span class="cp">#define IOAT_CHANCTRL_ERR_INT_EN		0x0010</span>
<span class="cp">#define IOAT_CHANCTRL_ANY_ERR_ABORT_EN		0x0008</span>
<span class="cp">#define IOAT_CHANCTRL_ERR_COMPLETION_EN		0x0004</span>
<span class="cp">#define IOAT_CHANCTRL_INT_REARM			0x0001</span>
<span class="cp">#define IOAT_CHANCTRL_RUN			(IOAT_CHANCTRL_INT_REARM |\</span>
<span class="cp">						 IOAT_CHANCTRL_ANY_ERR_ABORT_EN)</span>

<span class="cp">#define IOAT_DMA_COMP_OFFSET			0x02	</span><span class="cm">/* 16-bit DMA channel compatibility */</span><span class="cp"></span>
<span class="cp">#define IOAT_DMA_COMP_V1			0x0001	</span><span class="cm">/* Compatibility with DMA version 1 */</span><span class="cp"></span>
<span class="cp">#define IOAT_DMA_COMP_V2			0x0002	</span><span class="cm">/* Compatibility with DMA version 2 */</span><span class="cp"></span>


<span class="cp">#define IOAT1_CHANSTS_OFFSET		0x04	</span><span class="cm">/* 64-bit Channel Status Register */</span><span class="cp"></span>
<span class="cp">#define IOAT2_CHANSTS_OFFSET		0x08	</span><span class="cm">/* 64-bit Channel Status Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_CHANSTS_OFFSET(ver)		((ver) &lt; IOAT_VER_2_0 \</span>
<span class="cp">						? IOAT1_CHANSTS_OFFSET : IOAT2_CHANSTS_OFFSET)</span>
<span class="cp">#define IOAT1_CHANSTS_OFFSET_LOW	0x04</span>
<span class="cp">#define IOAT2_CHANSTS_OFFSET_LOW	0x08</span>
<span class="cp">#define IOAT_CHANSTS_OFFSET_LOW(ver)		((ver) &lt; IOAT_VER_2_0 \</span>
<span class="cp">						? IOAT1_CHANSTS_OFFSET_LOW : IOAT2_CHANSTS_OFFSET_LOW)</span>
<span class="cp">#define IOAT1_CHANSTS_OFFSET_HIGH	0x08</span>
<span class="cp">#define IOAT2_CHANSTS_OFFSET_HIGH	0x0C</span>
<span class="cp">#define IOAT_CHANSTS_OFFSET_HIGH(ver)		((ver) &lt; IOAT_VER_2_0 \</span>
<span class="cp">						? IOAT1_CHANSTS_OFFSET_HIGH : IOAT2_CHANSTS_OFFSET_HIGH)</span>
<span class="cp">#define IOAT_CHANSTS_COMPLETED_DESCRIPTOR_ADDR	(~0x3fULL)</span>
<span class="cp">#define IOAT_CHANSTS_SOFT_ERR			0x10ULL</span>
<span class="cp">#define IOAT_CHANSTS_UNAFFILIATED_ERR		0x8ULL</span>
<span class="cp">#define IOAT_CHANSTS_STATUS	0x7ULL</span>
<span class="cp">#define IOAT_CHANSTS_ACTIVE	0x0</span>
<span class="cp">#define IOAT_CHANSTS_DONE	0x1</span>
<span class="cp">#define IOAT_CHANSTS_SUSPENDED	0x2</span>
<span class="cp">#define IOAT_CHANSTS_HALTED	0x3</span>



<span class="cp">#define IOAT_CHAN_DMACOUNT_OFFSET	0x06    </span><span class="cm">/* 16-bit DMA Count register */</span><span class="cp"></span>

<span class="cp">#define IOAT_DCACTRL_OFFSET         0x30   </span><span class="cm">/* 32 bit Direct Cache Access Control Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_DCACTRL_CMPL_WRITE_ENABLE 0x10000</span>
<span class="cp">#define IOAT_DCACTRL_TARGET_CPU_MASK   0xFFFF </span><span class="cm">/* APIC ID */</span><span class="cp"></span>

<span class="cm">/* CB DCA Memory Space Registers */</span>
<span class="cp">#define IOAT_DCAOFFSET_OFFSET       0x14</span>
<span class="cm">/* CB_BAR + IOAT_DCAOFFSET value */</span>
<span class="cp">#define IOAT_DCA_VER_OFFSET         0x00</span>
<span class="cp">#define IOAT_DCA_VER_MAJOR_MASK     0xF0</span>
<span class="cp">#define IOAT_DCA_VER_MINOR_MASK     0x0F</span>

<span class="cp">#define IOAT_DCA_COMP_OFFSET        0x02</span>
<span class="cp">#define IOAT_DCA_COMP_V1            0x1</span>

<span class="cp">#define IOAT_FSB_CAPABILITY_OFFSET  0x04</span>
<span class="cp">#define IOAT_FSB_CAPABILITY_PREFETCH    0x1</span>

<span class="cp">#define IOAT_PCI_CAPABILITY_OFFSET  0x06</span>
<span class="cp">#define IOAT_PCI_CAPABILITY_MEMWR   0x1</span>

<span class="cp">#define IOAT_FSB_CAP_ENABLE_OFFSET  0x08</span>
<span class="cp">#define IOAT_FSB_CAP_ENABLE_PREFETCH    0x1</span>

<span class="cp">#define IOAT_PCI_CAP_ENABLE_OFFSET  0x0A</span>
<span class="cp">#define IOAT_PCI_CAP_ENABLE_MEMWR   0x1</span>

<span class="cp">#define IOAT_APICID_TAG_MAP_OFFSET  0x0C</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG0    0x0000000F</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG0_SHIFT 0</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG1    0x000000F0</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG1_SHIFT 4</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG2    0x00000F00</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG2_SHIFT 8</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG3    0x0000F000</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG3_SHIFT 12</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG4    0x000F0000</span>
<span class="cp">#define IOAT_APICID_TAG_MAP_TAG4_SHIFT 16</span>
<span class="cp">#define IOAT_APICID_TAG_CB2_VALID   0x8080808080</span>

<span class="cp">#define IOAT_DCA_GREQID_OFFSET      0x10</span>
<span class="cp">#define IOAT_DCA_GREQID_SIZE        0x04</span>
<span class="cp">#define IOAT_DCA_GREQID_MASK        0xFFFF</span>
<span class="cp">#define IOAT_DCA_GREQID_IGNOREFUN   0x10000000</span>
<span class="cp">#define IOAT_DCA_GREQID_VALID       0x20000000</span>
<span class="cp">#define IOAT_DCA_GREQID_LASTID      0x80000000</span>

<span class="cp">#define IOAT3_CSI_CAPABILITY_OFFSET 0x08</span>
<span class="cp">#define IOAT3_CSI_CAPABILITY_PREFETCH    0x1</span>

<span class="cp">#define IOAT3_PCI_CAPABILITY_OFFSET 0x0A</span>
<span class="cp">#define IOAT3_PCI_CAPABILITY_MEMWR  0x1</span>

<span class="cp">#define IOAT3_CSI_CONTROL_OFFSET    0x0C</span>
<span class="cp">#define IOAT3_CSI_CONTROL_PREFETCH  0x1</span>

<span class="cp">#define IOAT3_PCI_CONTROL_OFFSET    0x0E</span>
<span class="cp">#define IOAT3_PCI_CONTROL_MEMWR     0x1</span>

<span class="cp">#define IOAT3_APICID_TAG_MAP_OFFSET 0x10</span>
<span class="cp">#define IOAT3_APICID_TAG_MAP_OFFSET_LOW  0x10</span>
<span class="cp">#define IOAT3_APICID_TAG_MAP_OFFSET_HIGH 0x14</span>

<span class="cp">#define IOAT3_DCA_GREQID_OFFSET     0x02</span>

<span class="cp">#define IOAT1_CHAINADDR_OFFSET		0x0C	</span><span class="cm">/* 64-bit Descriptor Chain Address Register */</span><span class="cp"></span>
<span class="cp">#define IOAT2_CHAINADDR_OFFSET		0x10	</span><span class="cm">/* 64-bit Descriptor Chain Address Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_CHAINADDR_OFFSET(ver)		((ver) &lt; IOAT_VER_2_0 \</span>
<span class="cp">						? IOAT1_CHAINADDR_OFFSET : IOAT2_CHAINADDR_OFFSET)</span>
<span class="cp">#define IOAT1_CHAINADDR_OFFSET_LOW	0x0C</span>
<span class="cp">#define IOAT2_CHAINADDR_OFFSET_LOW	0x10</span>
<span class="cp">#define IOAT_CHAINADDR_OFFSET_LOW(ver)		((ver) &lt; IOAT_VER_2_0 \</span>
<span class="cp">						? IOAT1_CHAINADDR_OFFSET_LOW : IOAT2_CHAINADDR_OFFSET_LOW)</span>
<span class="cp">#define IOAT1_CHAINADDR_OFFSET_HIGH	0x10</span>
<span class="cp">#define IOAT2_CHAINADDR_OFFSET_HIGH	0x14</span>
<span class="cp">#define IOAT_CHAINADDR_OFFSET_HIGH(ver)		((ver) &lt; IOAT_VER_2_0 \</span>
<span class="cp">						? IOAT1_CHAINADDR_OFFSET_HIGH : IOAT2_CHAINADDR_OFFSET_HIGH)</span>

<span class="cp">#define IOAT1_CHANCMD_OFFSET		0x14	</span><span class="cm">/*  8-bit DMA Channel Command Register */</span><span class="cp"></span>
<span class="cp">#define IOAT2_CHANCMD_OFFSET		0x04	</span><span class="cm">/*  8-bit DMA Channel Command Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_CHANCMD_OFFSET(ver)		((ver) &lt; IOAT_VER_2_0 \</span>
<span class="cp">						? IOAT1_CHANCMD_OFFSET : IOAT2_CHANCMD_OFFSET)</span>
<span class="cp">#define IOAT_CHANCMD_RESET			0x20</span>
<span class="cp">#define IOAT_CHANCMD_RESUME			0x10</span>
<span class="cp">#define IOAT_CHANCMD_ABORT			0x08</span>
<span class="cp">#define IOAT_CHANCMD_SUSPEND			0x04</span>
<span class="cp">#define IOAT_CHANCMD_APPEND			0x02</span>
<span class="cp">#define IOAT_CHANCMD_START			0x01</span>

<span class="cp">#define IOAT_CHANCMP_OFFSET			0x18	</span><span class="cm">/* 64-bit Channel Completion Address Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_CHANCMP_OFFSET_LOW			0x18</span>
<span class="cp">#define IOAT_CHANCMP_OFFSET_HIGH		0x1C</span>

<span class="cp">#define IOAT_CDAR_OFFSET			0x20	</span><span class="cm">/* 64-bit Current Descriptor Address Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_CDAR_OFFSET_LOW			0x20</span>
<span class="cp">#define IOAT_CDAR_OFFSET_HIGH			0x24</span>

<span class="cp">#define IOAT_CHANERR_OFFSET			0x28	</span><span class="cm">/* 32-bit Channel Error Register */</span><span class="cp"></span>
<span class="cp">#define IOAT_CHANERR_SRC_ADDR_ERR	0x0001</span>
<span class="cp">#define IOAT_CHANERR_DEST_ADDR_ERR	0x0002</span>
<span class="cp">#define IOAT_CHANERR_NEXT_ADDR_ERR	0x0004</span>
<span class="cp">#define IOAT_CHANERR_NEXT_DESC_ALIGN_ERR	0x0008</span>
<span class="cp">#define IOAT_CHANERR_CHAIN_ADDR_VALUE_ERR	0x0010</span>
<span class="cp">#define IOAT_CHANERR_CHANCMD_ERR		0x0020</span>
<span class="cp">#define IOAT_CHANERR_CHIPSET_UNCORRECTABLE_DATA_INTEGRITY_ERR	0x0040</span>
<span class="cp">#define IOAT_CHANERR_DMA_UNCORRECTABLE_DATA_INTEGRITY_ERR	0x0080</span>
<span class="cp">#define IOAT_CHANERR_READ_DATA_ERR		0x0100</span>
<span class="cp">#define IOAT_CHANERR_WRITE_DATA_ERR		0x0200</span>
<span class="cp">#define IOAT_CHANERR_CONTROL_ERR	0x0400</span>
<span class="cp">#define IOAT_CHANERR_LENGTH_ERR	0x0800</span>
<span class="cp">#define IOAT_CHANERR_COMPLETION_ADDR_ERR	0x1000</span>
<span class="cp">#define IOAT_CHANERR_INT_CONFIGURATION_ERR	0x2000</span>
<span class="cp">#define IOAT_CHANERR_SOFT_ERR			0x4000</span>
<span class="cp">#define IOAT_CHANERR_UNAFFILIATED_ERR		0x8000</span>
<span class="cp">#define IOAT_CHANERR_XOR_P_OR_CRC_ERR		0x10000</span>
<span class="cp">#define IOAT_CHANERR_XOR_Q_ERR			0x20000</span>
<span class="cp">#define IOAT_CHANERR_DESCRIPTOR_COUNT_ERR	0x40000</span>

<span class="cp">#define IOAT_CHANERR_HANDLE_MASK (IOAT_CHANERR_XOR_P_OR_CRC_ERR | IOAT_CHANERR_XOR_Q_ERR)</span>

<span class="cp">#define IOAT_CHANERR_MASK_OFFSET		0x2C	</span><span class="cm">/* 32-bit Channel Error Register */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* _IOAT_REGISTERS_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:3}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../javascript/docco.min.js"></script>
</html>
