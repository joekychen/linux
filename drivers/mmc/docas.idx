d | host |  | 62 items |  | Ming Lei | ming.lei@canonical.com | 1340741430 |  | Revert "mmc: omap_hsmmc: Enable Auto CMD12"  This patch reverts the commit dba3c29ea4a1d5d544.  After bisecting, this commit dba3c29 is found to ruin micro-SD card data (writing incorrect file, or fs is corrupt after several times mount) on the beagle-xm revB, and reverting the commit will fix the problem.  Also from TRM of OMAP3/OMAP4/DM37x, the below is mentioned about the Auto CMD12 Enable bit.         - SDIO does not support this feature.         - SD card only. Looks it is not suitable to always enable Auto CMD12 in host controller driver.  Considered that the commit is not mature enough, so ask to revert it first.  Cc: Balaji T K <balajitk@ti.com> Cc: Venkatraman S <svenkatr@ti.com> Buglink: https://lkml.org/lkml/2012/6/10/225 Reported-by: Paolo Pisati <p.pisati@gmail.com> Reported-bisected-and-tested-by: Ming Lei <ming.lei@canonical.com> Signed-off-by: Ming Lei <ming.lei@canonical.com> Acked-by: Venkatraman S <svenkatr@ti.com> Signed-off-by: Chris Ball <cjb@laptop.org>
d | card |  | 7 items |  | Subhash Jadavani | subhashj@codeaurora.org | 1340741429 |  | mmc: block: fix the data timeout issue with ACMD22  If multi block write operation fails for SD card, during error handling we send the SD_APP_SEND_NUM_WR_BLKS (ACMD22) to know how many blocks were already programmed by card.  But mmc_sd_num_wr_blocks() function which sends the ACMD22 calculates the data timeout value from csd.tacc_ns and csd.tacc_clks parameters which will be 0 for block addressed (>2GB cards) SD card. This would result in timeout_ns and timeout_clks being 0 in the mmc_request passed to host driver. This means host controller would program its data timeout timer value with 0 which could result in DATA TIMEOUT errors from controller.  To fix this issue, mmc_sd_num_wr_blocks() should instead just call the mmc_set_data_timeout() to calculate the data timeout value. mmc_set_data_timeout() function ensures that non zero timeout value is set even for block addressed SD cards.  Signed-off-by: Subhash Jadavani <subhashj@codeaurora.org> Reviewed-by: Venkatraman S <svenkatr@ti.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | Makefile | g | 194B |  | Adrian Hunter | adrian.hunter@intel.com | 1326344327 |  | mmc: sdhci-pci: add platform data  Add a means of getting platform data for the SDHCI PCI devices.  The data is stored against the slot not the device in order to support multi-slot devices.  The data allows platform-specific setup (such as getting GPIO numbers from firmware or setting up wl12xx for SDIO) to be done in platform support files instead of the sdhci-pci driver.  Signed-off-by: Adrian Hunter <adrian.hunter@intel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | Kconfig | g | 625B |  | Pierre Ossman | drzeus@drzeus.cx | 1223802276 |  | mmc: explicitly mention SDIO support in Kconfig  Signed-off-by: Pierre Ossman <drzeus@drzeus.cx>
d | core |  | 27 items |  | Jaehoon Chung | jh80.chung@samsung.com | 1338990587 |  | mmc: core: return an error on suspend if mmc_deselect_cards fails  When mmc_host is not spi mode, mmc/sd is doing mmc_deselect_cards(). mmc_deselect_cards could be returned error. If returned error, we can know something wrong when enter suspend.  Signed-off-by: Jaehoon Chung <jh80.chung@samsung.com> Signed-off-by: Kyungmin Park <kyungmin.park@samsung.com> Acked-by: Ulf Hansson <ulf.hansson@linaro.org> Signed-off-by: Chris Ball <cjb@laptop.org>
