f | davinci_mmc.c | s | 41K | 1286 | Jan Luebbe | jlu@pengutronix.de | 1335107818 |  | mmc: davinci_mmc: set MODULE_ALIAS to allow autoloading  Davinci MMC platform devices (as in mach-davinci/devices-da8xx.c) use "davinci_mmc" as their name. To allow autoloading of the relevant driver, the module needs to set the MODULE_ALIAS.  Signed-off-by: Jan Luebbe <jlu@pengutronix.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | msm_sdcc.h | s | 6.6K | 218 | Sahitya Tummala | stummala@codeaurora.org | 1319658217 |  | mmc: msm_sdcc: Use MCI_INT_MASK0 for PIO interrupts  Not all targets have IRQ1 line routed from the SD controller to the processor. So we cannot rely on IRQ1 for PIO interrupts. This patch moves all PIO interrupts to IRQ0 and enables the PIO mode.  Signed-off-by: Murali Palnati <palnatim@codeaurora.org> Signed-off-by: Sahitya Tummala <stummala@codeaurora.org> Signed-off-by: David Brown <davidb@codeaurora.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | vub300.c | s | 72K | 2412 | Rusty Russell | rusty@rustcorp.com.au | 1326409340 |  | module_param: make bool parameters really bool (drivers & misc)  module_param(bool) used to counter-intuitively take an int.  In fddd5201 (mid-2009) we allowed bool or int/unsigned int using a messy trick.  It's time to remove the int/unsigned int option.  For this version it'll simply give a warning, but it'll break next kernel version.  Acked-by: Mauro Carvalho Chehab <mchehab@redhat.com> Signed-off-by: Rusty Russell <rusty@rustcorp.com.au>
f | tmio_mmc.c | s | 3.1K | 118 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci.c | s | 79K | 2570 | Chris Ball | cjb@laptop.org | 1338976356 |  | mmc: sdhci: Use DBG() instead of pr_warning() on large timeout  3bdc9ba892d6 ("mmc: use really long write timeout to deal with crappy cards") in 3.4 increased the write timeout that the core sends to host drivers to 3 seconds.  This makes sdhci's "requested timeout too large" warning trigger on every write; so, change this pr_warning() to a DBG().  Reported-by: Adrian Hunter <adrian.hunter@intel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | Makefile | g | 2.1K |  | Sascha Hauer | s.hauer@pengutronix.de | 1335107845 |  | mmc: remove imxmmc driver  This driver is broken since 2.6.31 when the traditional i.MX1 support was removed.  In theory the i.MX1 mmc controller can be supported by the mxcmmc driver which basically is the same hardware. However, the i.MX1 controller has severe bugs which made several workarounds necessary which resulted in a different driver structure. At that time it seemed easier to write a second driver to support hardware without bugs.  As noone cared for the i.MX1 driver for a long time and it does not compile, remove it.  Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | mxcmmc.c | s | 25K | 875 | Sascha Hauer | s.hauer@pengutronix.de | 1335366218 |  | mmc mxcmmc: do not depend on grouped clocks  the current i.MX clock support groups together unrelated clocks to a single clock which is then used by the driver. This can't be accomplished with the generic clock framework so we instead request the individual clocks in the driver. For i.MX there are generally three different clocks:  ipg: bus clock (needed to access registers) ahb: dma relevant clock, sometimes referred to as hclk in the datasheet per: bit clock, pixel clock  This patch changes the driver to request the individual clocks. Currently all clk_get will get the same clock until the SoCs are converted to the generic clock framework  Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
f | msm_sdcc.c | s | 34K | 1236 | Cong Wang | amwang@redhat.com | 1326344322 |  | mmc: remove the second argument of k[un]map_atomic()  Signed-off-by: Cong Wang <amwang@redhat.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-spear.c | s | 7.0K | 247 | Viresh Kumar | viresh.linux@gmail.com | 1340228376 |  | Viresh has moved  viresh.kumar@st.com email-id doesn't exist anymore as I have left the company.  Replace ST's id with viresh.linux@gmail.com.  It also updates .mailmap file to fix address for 'git shortlog'  Signed-off-by: Viresh Kumar <viresh.linux@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
f | s3cmci.c | s | 45K | 1508 | Masanari Iida | standby24x7@gmail.com | 1328458487 |  | mmc: Fix typo in s3cmci.c  Correct typo "resouce" to "resource" in drivers/mmc/host/s3cmci.c  Signed-off-by: Masanari Iida <standby24x7@gmail.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
f | mmc_spi.c | s | 41K | 1346 | Lars-Peter Clausen | lars@metafoo.de | 1326344322 |  | mmc: Remove redundant spi driver bus initialization  In ancient times it was necessary to manually initialize the bus field of an spi_driver to spi_bus_type. These days this is done in spi_driver_register(), so we can drop the manual assignment.  The patch was generated using the following coccinelle semantic patch: // <smpl> @@ identifier _driver; @@ struct spi_driver _driver = { 	.driver = { -		.bus = &spi_bus_type, 	}, }; // </smpl>  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-pci-data.c | s | 184B | 4 | Adrian Hunter | adrian.hunter@intel.com | 1326344327 |  | mmc: sdhci-pci: add platform data  Add a means of getting platform data for the SDHCI PCI devices.  The data is stored against the slot not the device in order to support multi-slot devices.  The data allows platform-specific setup (such as getting GPIO numbers from firmware or setting up wl12xx for SDIO) to be done in platform support files instead of the sdhci-pci driver.  Signed-off-by: Adrian Hunter <adrian.hunter@intel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | omap.c | s | 38K | 1367 | Tony Lindgren | tony@atomide.com | 1338990469 |  | mmc: omap: Fix broken reg_shift initialization  Commit fa550189 (mmc: core: Prevent eMMC VCC supply to be cut from late init) slightly affected timings for how things are done for the omap MMC driver causing the MMC cards not getting detected any longer.  Turns out this was caused by buggy reg_shift initialization in the omap MMC driver that was happening after mmc_add_host() was being called.  Fix this by initializing reg_shift before mmc_add_host() is called.  Signed-off-by: Tony Lindgren <tony@atomide.com> Cc: <stable@vger.kernel.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-esdhc-imx.c | s | 17K | 549 | Linus Torvalds | torvalds@linux-foundation.org | 1338061349 |  | 
f | bfin_sdh.c | s | 15K | 525 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | cb710-mmc.h | s | 3.3K | 90 | Michał Mirosław | mirq-linux@rere.qmqm.pl | 1244925778 |  | mmc: Driver for CB710/720 memory card reader (MMC part)  The code is divided in two parts. There is a virtual 'bus' driver that handles PCI device and registers three new devices one per card reader type. The other driver handles SD/MMC part of the reader.  Signed-off-by: Michał Mirosław <mirq-linux@rere.qmqm.pl> Signed-off-by: Pierre Ossman <pierre@ossman.eu>
f | atmel-mci-regs.h | s | 7.9K | 150 | Nicolas Ferre | nicolas.ferre@atmel.com | 1338987132 |  | mmc: atmel-mci: fix burst/chunk size modification  The use of DMA slave config operation requires that the burst size (aka chunk size) is specified through this interface. Modify atmel-mci slave driver to use this specification on its side.  Signed-off-by: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Ludovic Desroches <ludovic.desroches@atmel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | cb710-mmc.c | s | 21K | 647 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | of_mmc_spi.c | s | 4.2K | 151 | Jean-Christophe PLAGNIOL-VILLARD | plagnioj@jcrosoft.com | 1329183538 |  | mmc: of_mmc_spi: fix little endian support  The voltage_ranges is supposed to switch from big endian to little endian.  Signed-off-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Acked-by: Grant Likely <grant.likely@secretlab.ca> Signed-off-by: Chris Ball <cjb@laptop.org>
f | dw_mmc-pltfm.c | s | 2.9K | 114 | Shashidhar Hiremath | shashidharh@vayavyalabs.com | 1332718424 |  | mmc: Support of PCI mode in the dw_mmc driver  Support of PCI mode for the dw_mmc driver. This Patch adds the support for the scenario where the Synopsys Designware IP is present on the PCI bus. The patch adds the minimal modifications necessary for the driver to work on PCI platform. Also added separate files for PCI and PLATFORM modes of operation.  Signed-off-by: Shashidhar Hiremath <shashidharh@vayavyalabs.com> Acked-by: James Hogan <james.hogan@imgtec.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | mxs-mmc.c | s | 23K | 759 | Marek Vasut | marex@denx.de | 1338992200 |  | mmc: mxs-mmc: Move of_match_table out of CONFIG_PM  Signed-off-by: Marek Vasut <marex@denx.de> Acked-by: Shawn Guo <shawn.guo@linaro.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-tegra.c | s | 10K | 343 | Linus Torvalds | torvalds@linux-foundation.org | 1337959412 |  | 
f | mvsdio.c | s | 25K | 805 | Andrew Lunn | andrew@lunn.ch | 1336520040 |  | ARM: Orion: SDIO: Add support for clk.  Some orion devices can gate the SDIO clock. If the clock exists, enable/disable it as appropriate.  Signed-off-by: Andrew Lunn <andrew@lunn.ch> Tested-by: Jamie Lentin <jm@lentin.co.uk> Signed-off-by: Mike Turquette <mturquette@linaro.org>
f | wbsd.h | s | 4.7K | 148 | Pierre Ossman | drzeus@drzeus.cx | 1185407611 |  | mmc: update header file paths  Make sure all headers in the files reflect their true position in the tree.  Signed-off-by: Pierre Ossman <drzeus@drzeus.cx>
f | dw_mmc.c | s | 53K | 1867 | Seungwon Jeon | tgih.jun@samsung.com | 1338989931 |  | mmc: dw_mmc: correct the calculation for CLKDIV  In case of "host->bus_hz < slot->clock", divider value is miscalculated. And clock divider register value is multiple of 2. If calculated divider value is odd number, result can be over-clocking.  Signed-off-by: Seungwon Jeon <tgih.jun@samsung.com> Acked-by: Will Newton <will.newton@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | tmio_mmc_dma.c | s | 8.0K | 282 | Linus Torvalds | torvalds@linux-foundation.org | 1333060497 |  | Merge branch 'next' of git://git.infradead.org/users/vkoul/slave-dma  Pull slave-dmaengine update from Vinod Koul:  "This includes the cookie cleanup by Russell, the addition of context   parameter for dmaengine APIs, more arm dmaengine driver cleanup by   moving code to dmaengine, this time for imx by Javier and pl330 by   Boojin along with the usual driver fixes."  Fix up some fairly trivial conflicts with various other cleanups.  * 'next' of git://git.infradead.org/users/vkoul/slave-dma: (67 commits)   dmaengine: imx: fix the build failure on x86_64   dmaengine: i.MX: Fix merge of cookie branch.   dmaengine: i.MX: Add support for interleaved transfers.   dmaengine: imx-dma: use 'dev_dbg' and 'dev_warn' for messages.   dmaengine: imx-dma: remove 'imx_dmav1_baseaddr' and 'dma_clk'.   dmaengine: imx-dma: remove unused arg of imxdma_sg_next.   dmaengine: imx-dma: remove internal structure.   dmaengine: imx-dma: remove 'resbytes' field of 'internal' structure.   dmaengine: imx-dma: remove 'in_use' field of 'internal' structure.   dmaengine: imx-dma: remove sg member from internal structure.   dmaengine: imx-dma: remove 'imxdma_setup_sg_hw' function.   dmaengine: imx-dma: remove 'imxdma_config_channel_hw' function.   dmaengine: imx-dma: remove 'imxdma_setup_mem2mem_hw' function.   dmaengine: imx-dma: remove dma_mode member of internal structure.   dmaengine: imx-dma: remove data member from internal structure.   dmaengine: imx-dma: merge old dma-v1.c with imx-dma.c   dmaengine: at_hdmac: add slave config operation   dmaengine: add context parameter to prep_slave_sg and prep_dma_cyclic   dmaengine/dma_slave: introduce inline wrappers   dma: imx-sdma: Treat firmware messages as warnings instead of erros   ...
f | sdhci-of-esdhc.c | s | 5.3K | 175 | Jerry Huang | Chang-Ming.Huang@freescale.com | 1332718425 |  | mmc: esdhc: Workaround for data crc error on p1010rdb  SD card read was failing (data crc error) on some cards at maximum possible frequency on P1010 (CCB frequency set to 400MHz). Some clock deviations are also observed at this frequency. Hence reduced the mmc clock freq.  Signed-off-by: Priyanka Jain <Priyanka.Jain@freescale.com> Singed-off-by: Jerry Huang <Chang-Ming.Huang@freescale.com> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | mmci.h | s | 6.1K | 190 | Ulf Hansson | ulf.hansson@stericsson.com | 1328202135 |  | ARM: 7280/1: mmc: mmci: Cache MMCICLOCK and MMCIPOWER register  Instead of reading a register value everytime we need to apply a new value for it, maintain a cached copy for it. This also means we are able to skip writes that are not needed.  Tested-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Ulf Hansson <ulf.hansson@stericsson.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | atmel-mci.c | s | 64K | 2148 | Nicolas Ferre | nicolas.ferre@atmel.com | 1338987132 |  | mmc: atmel-mci: fix burst/chunk size modification  The use of DMA slave config operation requires that the burst size (aka chunk size) is specified through this interface. Modify atmel-mci slave driver to use this specification on its side.  Signed-off-by: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Ludovic Desroches <ludovic.desroches@atmel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | tifm_sd.c | s | 28K | 929 | Linus Torvalds | torvalds@linux-foundation.org | 1326573136 |  | 
f | sdhci-pxav3.c | s | 7.0K | 233 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | dw_mmc-pci.c | s | 3.6K | 135 | Shashidhar Hiremath | shashidharh@vayavyalabs.com | 1332718424 |  | mmc: Support of PCI mode in the dw_mmc driver  Support of PCI mode for the dw_mmc driver. This Patch adds the support for the scenario where the Synopsys Designware IP is present on the PCI bus. The patch adds the minimal modifications necessary for the driver to work on PCI platform. Also added separate files for PCI and PLATFORM modes of operation.  Signed-off-by: Shashidhar Hiremath <shashidharh@vayavyalabs.com> Acked-by: James Hogan <james.hogan@imgtec.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sh_mmcif.c | s | 37K | 1266 | Simon Horman | horms@verge.net.au | 1333672344 |  | mmc: sh_mmcif: Simplify calculation of mmc->f_min  There is no need to tune mmc->f_min to a value near 400kHz as the MMC core begins testing frequencies at 400kHz regardless of the value of mmc->f_min.  As suggested by Guennadi Liakhovetski.  Cc: Magnus Damm <magnus.damm@gmail.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Tested-by: Cao Minh Hiep <hiepcm@gmail.com> Signed-off-by: Simon Horman <horms@verge.net.au> Signed-off-by: Chris Ball <cjb@laptop.org>
f | tmio_mmc.h | s | 5.7K | 167 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1332865217 |  | mmc: tmio_mmc: remove unused sdio_irq_enabled flag  The sdio_irq_enabled member of struct tmio_mmc_host is a left-over from the previously removed SDIO IRQ workaround. It is no longer needed and can now be removed too.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | pxamci.c | s | 20K | 732 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-cns3xxx.c | s | 2.8K | 104 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | omap_hsmmc.c | s | 53K | 1862 | Ming Lei | ming.lei@canonical.com | 1340741430 |  | Revert "mmc: omap_hsmmc: Enable Auto CMD12"  This patch reverts the commit dba3c29ea4a1d5d544.  After bisecting, this commit dba3c29 is found to ruin micro-SD card data (writing incorrect file, or fs is corrupt after several times mount) on the beagle-xm revB, and reverting the commit will fix the problem.  Also from TRM of OMAP3/OMAP4/DM37x, the below is mentioned about the Auto CMD12 Enable bit.         - SDIO does not support this feature.         - SD card only. Looks it is not suitable to always enable Auto CMD12 in host controller driver.  Considered that the commit is not mature enough, so ask to revert it first.  Cc: Balaji T K <balajitk@ti.com> Cc: Venkatraman S <svenkatr@ti.com> Buglink: https://lkml.org/lkml/2012/6/10/225 Reported-by: Paolo Pisati <p.pisati@gmail.com> Reported-bisected-and-tested-by: Ming Lei <ming.lei@canonical.com> Signed-off-by: Ming Lei <ming.lei@canonical.com> Acked-by: Venkatraman S <svenkatr@ti.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-pci.c | s | 35K | 1219 | Chris Ball | cjb@laptop.org | 1333672352 |  | Revert "mmc: sdhci-pci: Add MSI support"  This reverts commit e6039832bed9a9b967796d7021f17f25b625b616. There are reports of MSI breaking SDHCI on multiple chipsets (JMicron and O2Micro, at least), so this should be reverted until we come up with a whitelist or something.  Signed-off-by: Chris Ball <cjb@laptop.org>
f | au1xmmc.c | s | 28K | 972 | Manuel Lauss | manuel.lauss@googlemail.com | 1323295325 |  | MIPS: Alchemy: Au1300 SoC support  Add basic support for the Au1300 variant(s): - New GPIO/Interrupt controller - DBDMA ids - USB setup - MMC support - enable various PSC drivers - detection code.  Signed-off-by: Manuel Lauss <manuel.lauss@googlemail.com> To: linux-mips@linux-mips.org Patchwork: https://patchwork.linux-mips.org/patch/2866/ Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
f | sdricoh_cs.c | s | 14K | 487 | Paul Gortmaker | paul.gortmaker@windriver.com | 1319661139 |  | mmc: Add module.h to drivers/mmc users assuming implicit presence.  We are cleaning up the implicit presence of module.h; these guys are some of the people who just assume it will be there.  Call it out explitly for those that really need it.  Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | at91_mci.c | s | 30K | 1009 | Jean-Christophe PLAGNIOL-VILLARD | plagnioj@jcrosoft.com | 1328272385 |  | ARM: at91: code removal of CAP9 SoC  Following removal announce and addition to feature-removal-schedule.txt, here is the actual source code deletion for Atmel CAP9 family.  Signed-off-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Acked-by: Nicolas Ferre <nicolas.ferre@atmel.com>
f | dw_mmc.h | s | 5.7K | 174 | Shashidhar Hiremath | shashidharh@vayavyalabs.com | 1332718424 |  | mmc: Support of PCI mode in the dw_mmc driver  Support of PCI mode for the dw_mmc driver. This Patch adds the support for the scenario where the Synopsys Designware IP is present on the PCI bus. The patch adds the minimal modifications necessary for the driver to work on PCI platform. Also added separate files for PCI and PLATFORM modes of operation.  Signed-off-by: Shashidhar Hiremath <shashidharh@vayavyalabs.com> Acked-by: James Hogan <james.hogan@imgtec.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | wbsd.c | s | 39K | 1634 | Girish K S | girish.shivananjappa@linaro.org | 1319661142 |  | mmc: replace printk with appropriate display macro  All the files using printk function for displaying kernel messages in the mmc driver have been replaced with corresponding macro.  Signed-off-by: Girish K S <girish.shivananjappa@linaro.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-esdhc.h | s | 2.2K | 65 | Tony Lin | tony.lin@freescale.com | 1326344321 |  | mmc: sdhci-esdhc: Change delay after setting clock from 100ms to 1ms  1ms is enough for hardware to change the clock to stable. 100ms is too long in the tasklet.  Signed-off-by: Tony Lin <tony.lin@freescale.com> CC: Xiaobo Xie <X.Xie@freescale.com> CC: Anton Vorontsov <avorontsov@ru.mvista.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-s3c.c | s | 19K | 622 | Heiko Stübner | heiko@sntech.de | 1338990802 |  | mmc: sdhci-s3c: pass IRQF ONESHOT to request threaded irq  Fix a boot regression in existing kernels causing:  genirq: Threaded irq requested with handler=NULL and !ONESHOT for irq XXX  caused by 1c6c6952 (genirq: Reject bogus threaded irq requests).  Signed-off-by: Heiko Stuebner <heiko@sntech.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | Kconfig | g | 18K |  | Ludovic Desroches | ludovic.desroches@atmel.com | 1337279628 |  | mmc: at91-mci: this driver is now deprecated  at91-mci is deprecated since atmel-mci can deal with all chips.  Signed-off-by: Ludovic Desroches <ludovic.desroches@atmel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-pxav2.c | s | 5.9K | 194 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | mvsdio.h | s | 4.9K | 155 | Maen Suleiman | maen@marvell.com | 1237926603 |  | mmc: SDIO driver for Marvell SoCs  This supports MMC/SD/SDIO currently found on the Kirkwood 88F6281 and 88F6192 SoC controllers.  Signed-off-by: Nicolas Pitre <nico@marvell.com> Signed-off-by: Pierre Ossman <drzeus@drzeus.cx>
f | mmci.c | s | 40K | 1409 | Roland Stigge | stigge@antcom.de | 1339968276 |  | ARM: 7427/1: mmc: mmci: Defer probe() in case of yet uninitialized GPIOs  If the GPIOs used by the MMCI driver are not registered yet when the driver is probe()d, they can't be used. This happens if the mmci driver is probed before the respective GPIO controller (e.g. on the LPC32xx EA3250 board, the PCA9532 GPIO controller would be initialized via DT after mmci). Therefore, we defer mmci in this case.  Signed-off-by: Roland Stigge <stigge@antcom.de> Acked-by: Linus Walleij <linus.walleij@linaro.org> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | sdhci-pltfm.c | s | 6.2K | 202 | Arnd Bergmann | arnd@arndb.de | 1337081382 |  | mmc: dt: Consolidate DT bindings  This patch unifies the current DT MMC bindings documentation and code, adds generic MMC DT bindings documentation, and updates .dts files for consistency.  [cjb: typo fixes, addition of max-frequency property] Signed-off-by: Chris Ball <cjb@laptop.org> Signed-off-by: Arnd Bergmann <arnd@arndb.de>
f | ushc.c | s | 13K | 465 | Greg Kroah-Hartman | gregkh@suse.de | 1321638730 |  | USB: convert some miscellanies drivers to use module_usb_driver()  This converts the remaining USB drivers in the kernel to use the module_usb_driver() macro which makes the code smaller and a bit simpler.  Added bonus is that it removes some unneeded kernel log messages about drivers loading and/or unloading.  Cc: Guenter Roeck <guenter.roeck@ericsson.com> Cc: Jean Delvare <khali@linux-fr.org> Cc: Ben Dooks <ben-linux@fluff.org> Cc: Till Harbaum <till@harbaum.org> Cc: Karsten Keil <isdn@linux-pingi.de> Cc: Chris Ball <cjb@laptop.org> Cc: David Woodhouse <dwmw2@infradead.org> Cc: Lauro Ramos Venancio <lauro.venancio@openbossa.org> Cc: Aloisio Almeida Jr <aloisio.almeida@openbossa.org> Cc: Samuel Ortiz <sameo@linux.intel.com> Cc: Steve Glendinning <steve.glendinning@smsc.com> Cc: Florian Tobias Schandinat <FlorianSchandinat@gmx.de> Cc: Evgeniy Polyakov <zbr@ioremap.net> Cc: Wim Van Sebroeck <wim@iguana.be> Cc: "David S. Miller" <davem@davemloft.net> Cc: Jesper Juhl <jj@chaosbits.net> Cc: Artem Bityutskiy <Artem.Bityutskiy@nokia.com> Cc: Jamie Iles <jamie@jamieiles.com> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
f | at91_mci.h | s | 5.2K | 103 | Jean-Christophe PLAGNIOL-VILLARD | plagnioj@jcrosoft.com | 1311258908 |  | mmc: at91_mci: move register header from include/ to drivers/  Signed-off-by: Jean-Christophe PLAGNIOL-VILLARD <plagnioj@jcrosoft.com> Cc: Nicolas Ferre <nicolas.ferre@atmel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-of-hlwd.c | s | 2.6K | 86 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-dove.c | s | 2.4K | 84 | Alf Høgemark | alf@i100.no | 1333672353 |  | mmc: sdhci-dove: Fix compile error by including module.h  This patch fixes a compile error in drivers/mmc/host/sdhci-dove.c by including the linux/module.h file.  Signed-off-by: Alf Høgemark <alf@i100.no> Cc: <stable@vger.kernel.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci-pltfm.h | s | 2.8K | 90 | Manuel Lauss | manuel.lauss@googlemail.com | 1324338611 |  | mmc: sdhci: remove "state" argument from sdhci_suspend_host  Drop the "state" argument from sdhci_suspend_host.  Its only user is the PCI glue;  this allows to move all SDHCI glues to use dev_pm_ops instead.  Signed-off-by: Manuel Lauss <manuel.lauss@googlemail.com> Acked-by: Adrian Hunter <adrian.hunter@intel.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | jz4740_mmc.c | s | 24K | 825 | Axel Lin | axel.lin@gmail.com | 1326344322 |  | mmc: convert drivers/mmc/host/* to use module_platform_driver()  This patch converts the drivers in drivers/mmc/host/* to use the module_platform_driver() macro which makes the code smaller and a bit simpler.  Signed-off-by: Axel Lin <axel.lin@gmail.com> Acked-by: "Michał Mirosław" <mirq-linux@rere.qmqm.pl> Acked-by: David Brown <davidb@codeaurora.org> Acked-by: Viresh Kumar <viresh.kumar@st.com> Acked-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Sascha Hauer <s.hauer@pengutronix.de> Acked-by: Wolfram Sang <w.sang@pengutronix.de> Acked-by: Anton Vorontsov <cbouatmailru@gmail.com> Signed-off-by: Chris Ball <cjb@laptop.org>
f | tmio_mmc_pio.c | s | 27K | 891 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1332865218 |  | mmc: tmio: cosmetic: prettify the tmio_mmc_set_ios() function  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Signed-off-by: Chris Ball <cjb@laptop.org>
f | via-sdmmc.c | s | 35K | 1088 | Girish K S | girish.shivananjappa@linaro.org | 1319661142 |  | mmc: replace printk with appropriate display macro  All the files using printk function for displaying kernel messages in the mmc driver have been replaced with corresponding macro.  Signed-off-by: Girish K S <girish.shivananjappa@linaro.org> Signed-off-by: Chris Ball <cjb@laptop.org>
f | sdhci.h | s | 11K | 325 | Chris Ball | cjb@laptop.org | 1332718424 |  | mmc: sdhci: Add platform suspend/resume hooks.  Some platforms require saving/restoring registers across suspend/resume; this hook allows them to do that inside their driver.  Signed-off-by: Chris Ball <cjb@laptop.org>
f | pxamci.h | s | 2.3K | 70 | Bridge Wu | bridge.wu@marvell.com | 1201360073 |  | [ARM] pxa: mmc: add 1st host controller support for pxa3xx  This patchis to add the first mmc controller support for pxa3xx. It's valid for pxa3[0||1||2]0.  On zylonite, the first controller supports two slots, this patch only support the first one right now.  Signed-off-by: Bridge Wu <bridge.wu@marvell.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>
f | sh_mobile_sdhi.c | s | 7.2K | 263 | Guennadi Liakhovetski | g.liakhovetski@gmx.de | 1332865219 |  | mmc: sh_mobile_sdhi: support modular mmc-core with non-standard hotplug  Currently if a platform wants to implement a non-standard card-detection method, it would need to call tmio_mmc_cd_wakeup(), which is an inline function, calling mmc_detect_change(). For this the platform would have to link mmc_core statically into the kernel, losing the ability to build it as a module. This patch adds a callback to the sh_mobile_sdhi driver, which eliminates this dependency.  Signed-off-by: Guennadi Liakhovetski <g.liakhovetski@gmx.de> Acked-by: Magnus Damm <damm@opensource.se> Signed-off-by: Chris Ball <cjb@laptop.org>
f | s3cmci.h | s | 1.6K | 68 | Ben Dooks | ben@simtec.co.uk | 1254438675 |  | s3cmci: DMA fixes  Fixes for the DMA transfer mode of the driver to try and improve the state of the code:  - Ensure that dma_complete is set during the end of the command phase   so that transfers do not stall awaiting the completion  - Update the DMA debugging to provide a bit more useful information   such as how many DMA descriptors where not processed and print the   DMA addresses in hexadecimal.  - Fix the DMA channel request code to actually request DMA for the   S3CMCI block instead of whatever '0' signified.  - Add fallback to PIO if we cannot get the DMA channel, as many of the   devices with this block only have a limited number of DMA channels.  - Only try and claim and free the DMA channel if we are trying to use it.  This improves the driver DMA code to the point where it can now identify a card and read the partition table.  However the DMA can still stall when trying to move data between the host and memory.  Signed-off-by: Ben Dooks <ben@simtec.co.uk> Cc: <linux-mmc@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
