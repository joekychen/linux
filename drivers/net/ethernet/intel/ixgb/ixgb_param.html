<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › intel › ixgb › ixgb_param.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>ixgb_param.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*******************************************************************************</span>

<span class="cm">  Intel PRO/10GbE Linux driver</span>
<span class="cm">  Copyright(c) 1999 - 2008 Intel Corporation.</span>

<span class="cm">  This program is free software; you can redistribute it and/or modify it</span>
<span class="cm">  under the terms and conditions of the GNU General Public License,</span>
<span class="cm">  version 2, as published by the Free Software Foundation.</span>

<span class="cm">  This program is distributed in the hope it will be useful, but WITHOUT</span>
<span class="cm">  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm">  FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for</span>
<span class="cm">  more details.</span>

<span class="cm">  You should have received a copy of the GNU General Public License along with</span>
<span class="cm">  this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm">  51 Franklin St - Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="cm">  The full GNU General Public License is included in this distribution in</span>
<span class="cm">  the file called &quot;COPYING&quot;.</span>

<span class="cm">  Contact Information:</span>
<span class="cm">  Linux NICS &lt;linux.nics@intel.com&gt;</span>
<span class="cm">  e1000-devel Mailing List &lt;e1000-devel@lists.sourceforge.net&gt;</span>
<span class="cm">  Intel Corporation, 5200 N.E. Elam Young Parkway, Hillsboro, OR 97124-6497</span>

<span class="cm">*******************************************************************************/</span>

<span class="cp">#define pr_fmt(fmt) KBUILD_MODNAME &quot;: &quot; fmt</span>

<span class="cp">#include &quot;ixgb.h&quot;</span>

<span class="cm">/* This is the only thing that needs to be changed to adjust the</span>
<span class="cm"> * maximum number of ports that the driver can manage.</span>
<span class="cm"> */</span>

<span class="cp">#define IXGB_MAX_NIC 8</span>

<span class="cp">#define OPTION_UNSET	-1</span>
<span class="cp">#define OPTION_DISABLED 0</span>
<span class="cp">#define OPTION_ENABLED  1</span>

<span class="cm">/* All parameters are treated the same, as an integer array of values.</span>
<span class="cm"> * This macro just reduces the need to repeat the same declaration code</span>
<span class="cm"> * over and over (plus this helps to avoid typo bugs).</span>
<span class="cm"> */</span>

<span class="cp">#define IXGB_PARAM_INIT { [0 ... IXGB_MAX_NIC] = OPTION_UNSET }</span>
<span class="cp">#define IXGB_PARAM(X, desc)					\</span>
<span class="cp">	static int __devinitdata X[IXGB_MAX_NIC+1]		\</span>
<span class="cp">		= IXGB_PARAM_INIT;				\</span>
<span class="cp">	static unsigned int num_##X = 0;			\</span>
<span class="cp">	module_param_array_named(X, X, int, &amp;num_##X, 0);	\</span>
<span class="cp">	MODULE_PARM_DESC(X, desc);</span>

<span class="cm">/* Transmit Descriptor Count</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 64-4096</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 256</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">TxDescriptors</span><span class="p">,</span> <span class="s">&quot;Number of transmit descriptors&quot;</span><span class="p">);</span>

<span class="cm">/* Receive Descriptor Count</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 64-4096</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 1024</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">RxDescriptors</span><span class="p">,</span> <span class="s">&quot;Number of receive descriptors&quot;</span><span class="p">);</span>

<span class="cm">/* User Specified Flow Control Override</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 0-3</span>
<span class="cm"> *  - 0 - No Flow Control</span>
<span class="cm"> *  - 1 - Rx only, respond to PAUSE frames but do not generate them</span>
<span class="cm"> *  - 2 - Tx only, generate PAUSE frames but ignore them on receive</span>
<span class="cm"> *  - 3 - Full Flow Control Support</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 2 - Tx only (silicon bug avoidance)</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">FlowControl</span><span class="p">,</span> <span class="s">&quot;Flow Control setting&quot;</span><span class="p">);</span>

<span class="cm">/* XsumRX - Receive Checksum Offload Enable/Disable</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 0, 1</span>
<span class="cm"> *  - 0 - disables all checksum offload</span>
<span class="cm"> *  - 1 - enables receive IP/TCP/UDP checksum offload</span>
<span class="cm"> *        on 82597 based NICs</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 1</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">XsumRX</span><span class="p">,</span> <span class="s">&quot;Disable or enable Receive Checksum offload&quot;</span><span class="p">);</span>

<span class="cm">/* Transmit Interrupt Delay in units of 0.8192 microseconds</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 0-65535</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 32</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">TxIntDelay</span><span class="p">,</span> <span class="s">&quot;Transmit Interrupt Delay&quot;</span><span class="p">);</span>

<span class="cm">/* Receive Interrupt Delay in units of 0.8192 microseconds</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 0-65535</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 72</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">RxIntDelay</span><span class="p">,</span> <span class="s">&quot;Receive Interrupt Delay&quot;</span><span class="p">);</span>

<span class="cm">/* Receive Flow control high threshold (when we send a pause frame)</span>
<span class="cm"> * (FCRTH)</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 1,536 - 262,136 (0x600 - 0x3FFF8, 8 byte granularity)</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 196,608 (0x30000)</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">RxFCHighThresh</span><span class="p">,</span> <span class="s">&quot;Receive Flow Control High Threshold&quot;</span><span class="p">);</span>

<span class="cm">/* Receive Flow control low threshold (when we send a resume frame)</span>
<span class="cm"> * (FCRTL)</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 64 - 262,136 (0x40 - 0x3FFF8, 8 byte granularity)</span>
<span class="cm"> *              must be less than high threshold by at least 8 bytes</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value:  163,840 (0x28000)</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">RxFCLowThresh</span><span class="p">,</span> <span class="s">&quot;Receive Flow Control Low Threshold&quot;</span><span class="p">);</span>

<span class="cm">/* Flow control request timeout (how long to pause the link partner&#39;s tx)</span>
<span class="cm"> * (PAP 15:0)</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 1 - 65535</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value:  65535 (0xffff) (we&#39;ll send an xon if we recover)</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">FCReqTimeout</span><span class="p">,</span> <span class="s">&quot;Flow Control Request Timeout&quot;</span><span class="p">);</span>

<span class="cm">/* Interrupt Delay Enable</span>
<span class="cm"> *</span>
<span class="cm"> * Valid Range: 0, 1</span>
<span class="cm"> *</span>
<span class="cm"> *  - 0 - disables transmit interrupt delay</span>
<span class="cm"> *  - 1 - enables transmmit interrupt delay</span>
<span class="cm"> *</span>
<span class="cm"> * Default Value: 1</span>
<span class="cm"> */</span>

<span class="n">IXGB_PARAM</span><span class="p">(</span><span class="n">IntDelayEnable</span><span class="p">,</span> <span class="s">&quot;Transmit Interrupt Delay Enable&quot;</span><span class="p">);</span>


<span class="cp">#define DEFAULT_TIDV	   		     32</span>
<span class="cp">#define MAX_TIDV			 0xFFFF</span>
<span class="cp">#define MIN_TIDV			      0</span>

<span class="cp">#define DEFAULT_RDTR		   	     72</span>
<span class="cp">#define MAX_RDTR			 0xFFFF</span>
<span class="cp">#define MIN_RDTR			      0</span>

<span class="cp">#define XSUMRX_DEFAULT		 OPTION_ENABLED</span>

<span class="cp">#define DEFAULT_FCRTL	  		0x28000</span>
<span class="cp">#define DEFAULT_FCRTH			0x30000</span>
<span class="cp">#define MIN_FCRTL			      0</span>
<span class="cp">#define MAX_FCRTL			0x3FFE8</span>
<span class="cp">#define MIN_FCRTH			      8</span>
<span class="cp">#define MAX_FCRTH			0x3FFF0</span>

<span class="cp">#define MIN_FCPAUSE			      1</span>
<span class="cp">#define MAX_FCPAUSE			 0xffff</span>
<span class="cp">#define DEFAULT_FCPAUSE		  	 0xFFFF </span><span class="cm">/* this may be too long */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">ixgb_option</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="p">{</span> <span class="n">enable_option</span><span class="p">,</span> <span class="n">range_option</span><span class="p">,</span> <span class="n">list_option</span> <span class="p">}</span> <span class="n">type</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">err</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">def</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>	<span class="cm">/* range_option info */</span>
			<span class="kt">int</span> <span class="n">min</span><span class="p">;</span>
			<span class="kt">int</span> <span class="n">max</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">r</span><span class="p">;</span>
		<span class="k">struct</span> <span class="p">{</span>	<span class="cm">/* list_option info */</span>
			<span class="kt">int</span> <span class="n">nr</span><span class="p">;</span>
			<span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_opt_list</span> <span class="p">{</span>
				<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
				<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">;</span>
			<span class="p">}</span> <span class="o">*</span><span class="n">p</span><span class="p">;</span>
		<span class="p">}</span> <span class="n">l</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">arg</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kt">int</span> <span class="n">__devinit</span>
<span class="nf">ixgb_validate_option</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="o">*</span><span class="n">opt</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">value</span> <span class="o">==</span> <span class="n">OPTION_UNSET</span><span class="p">)</span> <span class="p">{</span>
		<span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">def</span><span class="p">;</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">switch</span> <span class="p">(</span><span class="n">opt</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">case</span> <span class="n">enable_option</span>:
		<span class="k">switch</span> <span class="p">(</span><span class="o">*</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">OPTION_ENABLED</span>:
			<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;%s Enabled</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">case</span> <span class="n">OPTION_DISABLED</span>:
			<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;%s Disabled</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">range_option</span>:
		<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">value</span> <span class="o">&gt;=</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">.</span><span class="n">r</span><span class="p">.</span><span class="n">min</span> <span class="o">&amp;&amp;</span> <span class="o">*</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">.</span><span class="n">r</span><span class="p">.</span><span class="n">max</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;%s set to %i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">value</span><span class="p">);</span>
			<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="k">case</span> <span class="n">list_option</span>: <span class="p">{</span>
		<span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
		<span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_opt_list</span> <span class="o">*</span><span class="n">ent</span><span class="p">;</span>

		<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">.</span><span class="n">l</span><span class="p">.</span><span class="n">nr</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">ent</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">opt</span><span class="o">-&gt;</span><span class="n">arg</span><span class="p">.</span><span class="n">l</span><span class="p">.</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">*</span><span class="n">value</span> <span class="o">==</span> <span class="n">ent</span><span class="o">-&gt;</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">ent</span><span class="o">-&gt;</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="sc">&#39;\0&#39;</span><span class="p">)</span>
					<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">ent</span><span class="o">-&gt;</span><span class="n">str</span><span class="p">);</span>
				<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>
	<span class="p">}</span>
		<span class="k">break</span><span class="p">;</span>
	<span class="nl">default:</span>
		<span class="n">BUG</span><span class="p">();</span>
	<span class="p">}</span>

	<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Invalid %s specified (%i) %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">value</span><span class="p">,</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">err</span><span class="p">);</span>
	<span class="o">*</span><span class="n">value</span> <span class="o">=</span> <span class="n">opt</span><span class="o">-&gt;</span><span class="n">def</span><span class="p">;</span>
	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * ixgb_check_options - Range Checking for Command Line Parameters</span>
<span class="cm"> * @adapter: board private structure</span>
<span class="cm"> *</span>
<span class="cm"> * This routine checks all command line parameters for valid user</span>
<span class="cm"> * input.  If an invalid value is given, or if no user specified</span>
<span class="cm"> * value exists, a default value is used.  The final value is stored</span>
<span class="cm"> * in a variable in the adapter structure.</span>
<span class="cm"> **/</span>

<span class="kt">void</span> <span class="n">__devinit</span>
<span class="nf">ixgb_check_options</span><span class="p">(</span><span class="k">struct</span> <span class="n">ixgb_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">bd</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">-&gt;</span><span class="n">bd_number</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">bd</span> <span class="o">&gt;=</span> <span class="n">IXGB_MAX_NIC</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">pr_notice</span><span class="p">(</span><span class="s">&quot;Warning: no configuration for board #%i</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">bd</span><span class="p">);</span>
		<span class="n">pr_notice</span><span class="p">(</span><span class="s">&quot;Using defaults for all values</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="p">{</span> <span class="cm">/* Transmit Descriptor Count */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">range_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Transmit Descriptors&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;using default of &quot;</span> <span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">DEFAULT_TXD</span><span class="p">),</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">DEFAULT_TXD</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span>  <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">MIN_TXD</span><span class="p">,</span>
					 <span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">MAX_TXD</span><span class="p">}}</span>
		<span class="p">};</span>
		<span class="k">struct</span> <span class="n">ixgb_desc_ring</span> <span class="o">*</span><span class="n">tx_ring</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">tx_ring</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_TxDescriptors</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">tx_ring</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">TxDescriptors</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tx_ring</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">tx_ring</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">tx_ring</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="n">tx_ring</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span> <span class="n">IXGB_REQ_TX_DESCRIPTOR_MULTIPLE</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Receive Descriptor Count */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">range_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Receive Descriptors&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;using default of &quot;</span> <span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">DEFAULT_RXD</span><span class="p">),</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">DEFAULT_RXD</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span>  <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">MIN_RXD</span><span class="p">,</span>
					 <span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">MAX_RXD</span><span class="p">}}</span>
		<span class="p">};</span>
		<span class="k">struct</span> <span class="n">ixgb_desc_ring</span> <span class="o">*</span><span class="n">rx_ring</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">rx_ring</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_RxDescriptors</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">rx_ring</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">RxDescriptors</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rx_ring</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">rx_ring</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">rx_ring</span><span class="o">-&gt;</span><span class="n">count</span> <span class="o">=</span> <span class="n">ALIGN</span><span class="p">(</span><span class="n">rx_ring</span><span class="o">-&gt;</span><span class="n">count</span><span class="p">,</span> <span class="n">IXGB_REQ_RX_DESCRIPTOR_MULTIPLE</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Receive Checksum Offload Enable */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">enable_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Receive Checksum Offload&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;defaulting to Enabled&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">OPTION_ENABLED</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_XsumRX</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_csum</span> <span class="o">=</span> <span class="n">XsumRX</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rx_csum</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">rx_csum</span> <span class="o">=</span> <span class="n">rx_csum</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">rx_csum</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Flow Control */</span>

		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_opt_list</span> <span class="n">fc_list</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
		       <span class="p">{</span> <span class="n">ixgb_fc_none</span><span class="p">,</span> <span class="s">&quot;Flow Control Disabled&quot;</span> <span class="p">},</span>
		       <span class="p">{</span> <span class="n">ixgb_fc_rx_pause</span><span class="p">,</span> <span class="s">&quot;Flow Control Receive Only&quot;</span> <span class="p">},</span>
		       <span class="p">{</span> <span class="n">ixgb_fc_tx_pause</span><span class="p">,</span> <span class="s">&quot;Flow Control Transmit Only&quot;</span> <span class="p">},</span>
		       <span class="p">{</span> <span class="n">ixgb_fc_full</span><span class="p">,</span> <span class="s">&quot;Flow Control Enabled&quot;</span> <span class="p">},</span>
		       <span class="p">{</span> <span class="n">ixgb_fc_default</span><span class="p">,</span> <span class="s">&quot;Flow Control Hardware Default&quot;</span> <span class="p">}</span>
		<span class="p">};</span>

		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">list_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Flow Control&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;reading default settings from EEPROM&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">ixgb_fc_tx_pause</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span>  <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">l</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">nr</span> <span class="o">=</span> <span class="n">ARRAY_SIZE</span><span class="p">(</span><span class="n">fc_list</span><span class="p">),</span>
					 <span class="p">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">fc_list</span> <span class="p">}}</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_FlowControl</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">fc</span> <span class="o">=</span> <span class="n">FlowControl</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">fc</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">fc</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Receive Flow Control High Threshold */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">range_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Rx Flow Control High Threshold&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;using default of &quot;</span> <span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">DEFAULT_FCRTH</span><span class="p">),</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">DEFAULT_FCRTH</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span>  <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">MIN_FCRTH</span><span class="p">,</span>
					 <span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">MAX_FCRTH</span><span class="p">}}</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_RxFCHighThresh</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">high_water</span> <span class="o">=</span> <span class="n">RxFCHighThresh</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">high_water</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">high_water</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">ixgb_fc_tx_pause</span><span class="p">)</span> <span class="p">)</span>
			<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Ignoring RxFCHighThresh when no RxFC</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Receive Flow Control Low Threshold */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">range_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Rx Flow Control Low Threshold&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;using default of &quot;</span> <span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">DEFAULT_FCRTL</span><span class="p">),</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">DEFAULT_FCRTL</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span>  <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">MIN_FCRTL</span><span class="p">,</span>
					 <span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">MAX_FCRTL</span><span class="p">}}</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_RxFCLowThresh</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">low_water</span> <span class="o">=</span> <span class="n">RxFCLowThresh</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">low_water</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">low_water</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">ixgb_fc_tx_pause</span><span class="p">)</span> <span class="p">)</span>
			<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Ignoring RxFCLowThresh when no RxFC</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Flow Control Pause Time Request*/</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">range_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Flow Control Pause Time Request&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;using default of &quot;</span><span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">DEFAULT_FCPAUSE</span><span class="p">),</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">DEFAULT_FCPAUSE</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">MIN_FCPAUSE</span><span class="p">,</span>
					<span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">MAX_FCPAUSE</span><span class="p">}}</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_FCReqTimeout</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pause_time</span> <span class="o">=</span> <span class="n">FCReqTimeout</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pause_time</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">pause_time</span> <span class="o">=</span> <span class="n">pause_time</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">pause_time</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">ixgb_fc_tx_pause</span><span class="p">)</span> <span class="p">)</span>
			<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;Ignoring FCReqTimeout when no RxFC</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="cm">/* high low and spacing check for rx flow control thresholds */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">type</span> <span class="o">&amp;</span> <span class="n">ixgb_fc_tx_pause</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/* high must be greater than low */</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">high_water</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">low_water</span> <span class="o">+</span> <span class="mi">8</span><span class="p">))</span> <span class="p">{</span>
			<span class="cm">/* set defaults */</span>
			<span class="n">pr_info</span><span class="p">(</span><span class="s">&quot;RxFCHighThresh must be &gt;= (RxFCLowThresh + 8), Using Defaults</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">high_water</span> <span class="o">=</span> <span class="n">DEFAULT_FCRTH</span><span class="p">;</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">hw</span><span class="p">.</span><span class="n">fc</span><span class="p">.</span><span class="n">low_water</span>  <span class="o">=</span> <span class="n">DEFAULT_FCRTL</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Receive Interrupt Delay */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">range_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Receive Interrupt Delay&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;using default of &quot;</span> <span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">DEFAULT_RDTR</span><span class="p">),</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">DEFAULT_RDTR</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span>  <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">MIN_RDTR</span><span class="p">,</span>
					 <span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">MAX_RDTR</span><span class="p">}}</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_RxIntDelay</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">rx_int_delay</span> <span class="o">=</span> <span class="n">RxIntDelay</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">rx_int_delay</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">rx_int_delay</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="p">{</span> <span class="cm">/* Transmit Interrupt Delay */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">range_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Transmit Interrupt Delay&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;using default of &quot;</span> <span class="n">__MODULE_STRING</span><span class="p">(</span><span class="n">DEFAULT_TIDV</span><span class="p">),</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">DEFAULT_TIDV</span><span class="p">,</span>
			<span class="p">.</span><span class="n">arg</span>  <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">r</span> <span class="o">=</span> <span class="p">{</span> <span class="p">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">MIN_TIDV</span><span class="p">,</span>
					 <span class="p">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">MAX_TIDV</span><span class="p">}}</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_TxIntDelay</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">tx_int_delay</span> <span class="o">=</span> <span class="n">TxIntDelay</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">adapter</span><span class="o">-&gt;</span><span class="n">tx_int_delay</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">tx_int_delay</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="p">{</span> <span class="cm">/* Transmit Interrupt Delay Enable */</span>
		<span class="k">static</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">ixgb_option</span> <span class="n">opt</span> <span class="o">=</span> <span class="p">{</span>
			<span class="p">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">enable_option</span><span class="p">,</span>
			<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Tx Interrupt Delay Enable&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">err</span>  <span class="o">=</span> <span class="s">&quot;defaulting to Enabled&quot;</span><span class="p">,</span>
			<span class="p">.</span><span class="n">def</span>  <span class="o">=</span> <span class="n">OPTION_ENABLED</span>
		<span class="p">};</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">num_IntDelayEnable</span> <span class="o">&gt;</span> <span class="n">bd</span><span class="p">)</span> <span class="p">{</span>
			<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ide</span> <span class="o">=</span> <span class="n">IntDelayEnable</span><span class="p">[</span><span class="n">bd</span><span class="p">];</span>
			<span class="n">ixgb_validate_option</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ide</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">opt</span><span class="p">);</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">tx_int_delay_enable</span> <span class="o">=</span> <span class="n">ide</span><span class="p">;</span>
		<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
			<span class="n">adapter</span><span class="o">-&gt;</span><span class="n">tx_int_delay_enable</span> <span class="o">=</span> <span class="n">opt</span><span class="p">.</span><span class="n">def</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
