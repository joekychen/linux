<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › broadcom › bnx2x › bnx2x_stats.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>bnx2x_stats.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* bnx2x_stats.h: Broadcom Everest network driver.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2007-2012 Broadcom Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation.</span>
<span class="cm"> *</span>
<span class="cm"> * Maintained by: Eilon Greenstein &lt;eilong@broadcom.com&gt;</span>
<span class="cm"> * Written by: Eliezer Tamir</span>
<span class="cm"> * Based on code from Michael Chan&#39;s bnx2 driver</span>
<span class="cm"> * UDP CSUM errata workaround by Arik Gendelman</span>
<span class="cm"> * Slowpath and fastpath rework by Vladislav Zolotarov</span>
<span class="cm"> * Statistics and Link management by Yitchak Gertner</span>
<span class="cm"> *</span>
<span class="cm"> */</span>
<span class="cp">#ifndef BNX2X_STATS_H</span>
<span class="cp">#define BNX2X_STATS_H</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>

<span class="k">struct</span> <span class="n">nig_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">brb_discard</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">brb_packet</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">brb_truncate</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flow_ctrl_discard</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flow_ctrl_octets</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">flow_ctrl_packet</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mng_discard</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mng_octet_inp</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mng_octet_out</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mng_packet_inp</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mng_packet_out</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbf_octets</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pbf_packet</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">safc_inp</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">egress_mac_pkt0_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">egress_mac_pkt0_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">egress_mac_pkt1_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">egress_mac_pkt1_hi</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">enum</span> <span class="n">bnx2x_stats_event</span> <span class="p">{</span>
	<span class="n">STATS_EVENT_PMF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">STATS_EVENT_LINK_UP</span><span class="p">,</span>
	<span class="n">STATS_EVENT_UPDATE</span><span class="p">,</span>
	<span class="n">STATS_EVENT_STOP</span><span class="p">,</span>
	<span class="n">STATS_EVENT_MAX</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bnx2x_stats_state</span> <span class="p">{</span>
	<span class="n">STATS_STATE_DISABLED</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">STATS_STATE_ENABLED</span><span class="p">,</span>
	<span class="n">STATS_STATE_MAX</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bnx2x_eth_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">total_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">valid_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">valid_bytes_received_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">error_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">error_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">etherstatsoverrsizepkts_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">etherstatsoverrsizepkts_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">no_buff_discard_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">no_buff_discard_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">rx_stat_ifhcinbadoctets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_ifhcinbadoctets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_ifhcoutbadoctets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_ifhcoutbadoctets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsfcserrors_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsfcserrors_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsalignmenterrors_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsalignmenterrors_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statscarriersenseerrors_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statscarriersenseerrors_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_falsecarriererrors_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_falsecarriererrors_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_etherstatsundersizepkts_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_etherstatsundersizepkts_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsframestoolong_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsframestoolong_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_etherstatsfragments_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_etherstatsfragments_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_etherstatsjabbers_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_etherstatsjabbers_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_maccontrolframesreceived_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_maccontrolframesreceived_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_bmac_xpf_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_bmac_xpf_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_bmac_xcf_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_bmac_xcf_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_xoffstateentered_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_xoffstateentered_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_xonpauseframesreceived_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_xonpauseframesreceived_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_xoffpauseframesreceived_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_xoffpauseframesreceived_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_outxonsent_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_outxonsent_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_outxoffsent_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_outxoffsent_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_flowcontroldone_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_flowcontroldone_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatscollisions_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatscollisions_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statssinglecollisionframes_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statssinglecollisionframes_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsmultiplecollisionframes_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsmultiplecollisionframes_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsdeferredtransmissions_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsdeferredtransmissions_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsexcessivecollisions_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsexcessivecollisions_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statslatecollisions_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statslatecollisions_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts64octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts64octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts65octetsto127octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts65octetsto127octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts128octetsto255octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts128octetsto255octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts256octetsto511octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts256octetsto511octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts512octetsto1023octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts512octetsto1023octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts1024octetsto1522octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspkts1024octetsto1522octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspktsover1522octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_etherstatspktsover1522octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_2047_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_2047_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_4095_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_4095_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_9216_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_9216_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_16383_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_16383_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsinternalmactransmiterrors_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_dot3statsinternalmactransmiterrors_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_ufl_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_stat_bmac_ufl_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">pause_frames_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pause_frames_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pause_frames_sent_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pause_frames_sent_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">etherstatspkts1024octetsto1522octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">etherstatspkts1024octetsto1522octets_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">etherstatspktsover1522octets_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">etherstatspktsover1522octets_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">brb_drop_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">brb_drop_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">brb_truncate_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">brb_truncate_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">mac_filter_discard</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mf_tag_discard</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">brb_truncate_discard</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">mac_discard</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">driver_xoff</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_err_discard_pkt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_skb_alloc_failed</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">hw_csum_err</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">nig_timer_max</span><span class="p">;</span>

	<span class="cm">/* TPA */</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregations_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregations_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregated_frames_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregated_frames_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_bytes_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_bytes_lo</span><span class="p">;</span>

	<span class="cm">/* PFC */</span>
	<span class="n">u32</span> <span class="n">pfc_frames_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pfc_frames_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pfc_frames_sent_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">pfc_frames_sent_lo</span><span class="p">;</span>

	<span class="cm">/* Recovery */</span>
	<span class="n">u32</span> <span class="n">recoverable_error</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">unrecoverable_error</span><span class="p">;</span>
<span class="p">};</span>


<span class="k">struct</span> <span class="n">bnx2x_eth_q_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">valid_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">valid_bytes_received_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">etherstatsoverrsizepkts_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">etherstatsoverrsizepkts_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">no_buff_discard_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">no_buff_discard_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">driver_xoff</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_err_discard_pkt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_skb_alloc_failed</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">hw_csum_err</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">total_packets_received_checksum_discarded_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_packets_received_checksum_discarded_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_packets_received_ttl0_discarded_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_packets_received_ttl0_discarded_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_transmitted_dropped_packets_error_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_transmitted_dropped_packets_error_lo</span><span class="p">;</span>

	<span class="cm">/* TPA */</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregations_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregations_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregated_frames_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_aggregated_frames_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_bytes_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_bytes_lo</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bnx2x_eth_stats_old</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsframestoolong_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_stat_dot3statsframestoolong_lo</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bnx2x_eth_q_stats_old</span> <span class="p">{</span>
	<span class="cm">/* Fields to perserve over fw reset*/</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_bytes_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_bytes_lo</span><span class="p">;</span>

	<span class="cm">/* Fields to perserve last of */</span>
	<span class="n">u32</span> <span class="n">total_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_bytes_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_received_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_unicast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_multicast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_transmitted_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_broadcast_packets_transmitted_lo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">valid_bytes_received_hi</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">valid_bytes_received_lo</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">total_tpa_bytes_hi_old</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">total_tpa_bytes_lo_old</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">driver_xoff_old</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_err_discard_pkt_old</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_skb_alloc_failed_old</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">hw_csum_err_old</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bnx2x_net_stats_old</span> <span class="p">{</span>
	 <span class="n">u32</span> <span class="n">rx_dropped</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bnx2x_fw_port_stats_old</span> <span class="p">{</span>
	 <span class="n">u32</span> <span class="n">mac_filter_discard</span><span class="p">;</span>
	 <span class="n">u32</span> <span class="n">mf_tag_discard</span><span class="p">;</span>
	 <span class="n">u32</span> <span class="n">brb_truncate_discard</span><span class="p">;</span>
	 <span class="n">u32</span> <span class="n">mac_discard</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/****************************************************************************</span>
<span class="cm">* Macros</span>
<span class="cm">****************************************************************************/</span>

<span class="cm">/* sum[hi:lo] += add[hi:lo] */</span>
<span class="cp">#define ADD_64(s_hi, a_hi, s_lo, a_lo) \</span>
<span class="cp">	do { \</span>
<span class="cp">		s_lo += a_lo; \</span>
<span class="cp">		s_hi += a_hi + ((s_lo &lt; a_lo) ? 1 : 0); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define LE32_0 ((__force __le32) 0)</span>
<span class="cp">#define LE16_0 ((__force __le16) 0)</span>

<span class="cm">/* The _force is for cases where high value is 0 */</span>
<span class="cp">#define ADD_64_LE(s_hi, a_hi_le, s_lo, a_lo_le) \</span>
<span class="cp">		ADD_64(s_hi, le32_to_cpu(a_hi_le), \</span>
<span class="cp">		       s_lo, le32_to_cpu(a_lo_le))</span>

<span class="cp">#define ADD_64_LE16(s_hi, a_hi_le, s_lo, a_lo_le) \</span>
<span class="cp">		ADD_64(s_hi, le16_to_cpu(a_hi_le), \</span>
<span class="cp">		       s_lo, le16_to_cpu(a_lo_le))</span>

<span class="cm">/* difference = minuend - subtrahend */</span>
<span class="cp">#define DIFF_64(d_hi, m_hi, s_hi, d_lo, m_lo, s_lo) \</span>
<span class="cp">	do { \</span>
<span class="cp">		if (m_lo &lt; s_lo) { \</span>
<span class="cp">			</span><span class="cm">/* underflow */</span><span class="cp"> \</span>
<span class="cp">			d_hi = m_hi - s_hi; \</span>
<span class="cp">			if (d_hi &gt; 0) { \</span>
<span class="cp">				</span><span class="cm">/* we can &#39;loan&#39; 1 */</span><span class="cp"> \</span>
<span class="cp">				d_hi--; \</span>
<span class="cp">				d_lo = m_lo + (UINT_MAX - s_lo) + 1; \</span>
<span class="cp">			} else { \</span>
<span class="cp">				</span><span class="cm">/* m_hi &lt;= s_hi */</span><span class="cp"> \</span>
<span class="cp">				d_hi = 0; \</span>
<span class="cp">				d_lo = 0; \</span>
<span class="cp">			} \</span>
<span class="cp">		} else { \</span>
<span class="cp">			</span><span class="cm">/* m_lo &gt;= s_lo */</span><span class="cp"> \</span>
<span class="cp">			if (m_hi &lt; s_hi) { \</span>
<span class="cp">				d_hi = 0; \</span>
<span class="cp">				d_lo = 0; \</span>
<span class="cp">			} else { \</span>
<span class="cp">				</span><span class="cm">/* m_hi &gt;= s_hi */</span><span class="cp"> \</span>
<span class="cp">				d_hi = m_hi - s_hi; \</span>
<span class="cp">				d_lo = m_lo - s_lo; \</span>
<span class="cp">			} \</span>
<span class="cp">		} \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_STAT64(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		DIFF_64(diff.hi, new-&gt;s##_hi, pstats-&gt;mac_stx[0].t##_hi, \</span>
<span class="cp">			diff.lo, new-&gt;s##_lo, pstats-&gt;mac_stx[0].t##_lo); \</span>
<span class="cp">		pstats-&gt;mac_stx[0].t##_hi = new-&gt;s##_hi; \</span>
<span class="cp">		pstats-&gt;mac_stx[0].t##_lo = new-&gt;s##_lo; \</span>
<span class="cp">		ADD_64(pstats-&gt;mac_stx[1].t##_hi, diff.hi, \</span>
<span class="cp">		       pstats-&gt;mac_stx[1].t##_lo, diff.lo); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_STAT64_NIG(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		DIFF_64(diff.hi, new-&gt;s##_hi, old-&gt;s##_hi, \</span>
<span class="cp">			diff.lo, new-&gt;s##_lo, old-&gt;s##_lo); \</span>
<span class="cp">		ADD_64(estats-&gt;t##_hi, diff.hi, \</span>
<span class="cp">		       estats-&gt;t##_lo, diff.lo); \</span>
<span class="cp">	} while (0)</span>

<span class="cm">/* sum[hi:lo] += add */</span>
<span class="cp">#define ADD_EXTEND_64(s_hi, s_lo, a) \</span>
<span class="cp">	do { \</span>
<span class="cp">		s_lo += a; \</span>
<span class="cp">		s_hi += (s_lo &lt; a) ? 1 : 0; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define ADD_STAT64(diff, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		ADD_64(pstats-&gt;mac_stx[1].t##_hi, new-&gt;diff##_hi, \</span>
<span class="cp">		       pstats-&gt;mac_stx[1].t##_lo, new-&gt;diff##_lo); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_EXTEND_STAT(s) \</span>
<span class="cp">	do { \</span>
<span class="cp">		ADD_EXTEND_64(pstats-&gt;mac_stx[1].s##_hi, \</span>
<span class="cp">			      pstats-&gt;mac_stx[1].s##_lo, \</span>
<span class="cp">			      new-&gt;s); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_EXTEND_TSTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		diff = le32_to_cpu(tclient-&gt;s) - le32_to_cpu(old_tclient-&gt;s); \</span>
<span class="cp">		old_tclient-&gt;s = tclient-&gt;s; \</span>
<span class="cp">		ADD_EXTEND_64(qstats-&gt;t##_hi, qstats-&gt;t##_lo, diff); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_EXTEND_E_TSTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		UPDATE_EXTEND_TSTAT(s, t); \</span>
<span class="cp">		ADD_EXTEND_64(estats-&gt;t##_hi, estats-&gt;t##_lo, diff); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_EXTEND_USTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		diff = le32_to_cpu(uclient-&gt;s) - le32_to_cpu(old_uclient-&gt;s); \</span>
<span class="cp">		old_uclient-&gt;s = uclient-&gt;s; \</span>
<span class="cp">		ADD_EXTEND_64(qstats-&gt;t##_hi, qstats-&gt;t##_lo, diff); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_EXTEND_E_USTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		UPDATE_EXTEND_USTAT(s, t); \</span>
<span class="cp">		ADD_EXTEND_64(estats-&gt;t##_hi, estats-&gt;t##_lo, diff); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_EXTEND_XSTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		diff = le32_to_cpu(xclient-&gt;s) - le32_to_cpu(old_xclient-&gt;s); \</span>
<span class="cp">		old_xclient-&gt;s = xclient-&gt;s; \</span>
<span class="cp">		ADD_EXTEND_64(qstats-&gt;t##_hi, qstats-&gt;t##_lo, diff); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_QSTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		qstats-&gt;t##_hi = qstats_old-&gt;t##_hi + le32_to_cpu(s.hi); \</span>
<span class="cp">		qstats-&gt;t##_lo = qstats_old-&gt;t##_lo + le32_to_cpu(s.lo); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_QSTAT_OLD(f) \</span>
<span class="cp">	do { \</span>
<span class="cp">		qstats_old-&gt;f = qstats-&gt;f; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_ESTAT_QSTAT_64(s) \</span>
<span class="cp">	do { \</span>
<span class="cp">		ADD_64(estats-&gt;s##_hi, qstats-&gt;s##_hi, \</span>
<span class="cp">		       estats-&gt;s##_lo, qstats-&gt;s##_lo); \</span>
<span class="cp">		SUB_64(estats-&gt;s##_hi, qstats_old-&gt;s##_hi_old, \</span>
<span class="cp">		       estats-&gt;s##_lo, qstats_old-&gt;s##_lo_old); \</span>
<span class="cp">		qstats_old-&gt;s##_hi_old = qstats-&gt;s##_hi; \</span>
<span class="cp">		qstats_old-&gt;s##_lo_old = qstats-&gt;s##_lo; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_ESTAT_QSTAT(s) \</span>
<span class="cp">	do { \</span>
<span class="cp">		estats-&gt;s += qstats-&gt;s; \</span>
<span class="cp">		estats-&gt;s -= qstats_old-&gt;s##_old; \</span>
<span class="cp">		qstats_old-&gt;s##_old = qstats-&gt;s; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_FSTAT_QSTAT(s) \</span>
<span class="cp">	do { \</span>
<span class="cp">		ADD_64(fstats-&gt;s##_hi, qstats-&gt;s##_hi, \</span>
<span class="cp">		       fstats-&gt;s##_lo, qstats-&gt;s##_lo); \</span>
<span class="cp">		SUB_64(fstats-&gt;s##_hi, qstats_old-&gt;s##_hi, \</span>
<span class="cp">		       fstats-&gt;s##_lo, qstats_old-&gt;s##_lo); \</span>
<span class="cp">		estats-&gt;s##_hi = fstats-&gt;s##_hi; \</span>
<span class="cp">		estats-&gt;s##_lo = fstats-&gt;s##_lo; \</span>
<span class="cp">		qstats_old-&gt;s##_hi = qstats-&gt;s##_hi; \</span>
<span class="cp">		qstats_old-&gt;s##_lo = qstats-&gt;s##_lo; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_FW_STAT(s) \</span>
<span class="cp">	do { \</span>
<span class="cp">		estats-&gt;s = le32_to_cpu(tport-&gt;s) + fwstats-&gt;s; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_FW_STAT_OLD(f) \</span>
<span class="cp">	do { \</span>
<span class="cp">		fwstats-&gt;f = estats-&gt;f; \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define UPDATE_ESTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		SUB_64(estats-&gt;s##_hi, estats_old-&gt;t##_hi, \</span>
<span class="cp">		       estats-&gt;s##_lo, estats_old-&gt;t##_lo); \</span>
<span class="cp">		ADD_64(estats-&gt;s##_hi, estats-&gt;t##_hi, \</span>
<span class="cp">		       estats-&gt;s##_lo, estats-&gt;t##_lo); \</span>
<span class="cp">		estats_old-&gt;t##_hi = estats-&gt;t##_hi; \</span>
<span class="cp">		estats_old-&gt;t##_lo = estats-&gt;t##_lo; \</span>
<span class="cp">	} while (0)</span>

<span class="cm">/* minuend -= subtrahend */</span>
<span class="cp">#define SUB_64(m_hi, s_hi, m_lo, s_lo) \</span>
<span class="cp">	do { \</span>
<span class="cp">		DIFF_64(m_hi, m_hi, s_hi, m_lo, m_lo, s_lo); \</span>
<span class="cp">	} while (0)</span>

<span class="cm">/* minuend[hi:lo] -= subtrahend */</span>
<span class="cp">#define SUB_EXTEND_64(m_hi, m_lo, s) \</span>
<span class="cp">	do { \</span>
<span class="cp">		SUB_64(m_hi, 0, m_lo, s); \</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define SUB_EXTEND_USTAT(s, t) \</span>
<span class="cp">	do { \</span>
<span class="cp">		diff = le32_to_cpu(uclient-&gt;s) - le32_to_cpu(old_uclient-&gt;s); \</span>
<span class="cp">		SUB_EXTEND_64(qstats-&gt;t##_hi, qstats-&gt;t##_lo, diff); \</span>
<span class="cp">	} while (0)</span>


<span class="cm">/* forward */</span>
<span class="k">struct</span> <span class="n">bnx2x</span><span class="p">;</span>

<span class="kt">void</span> <span class="n">bnx2x_stats_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">bnx2x</span> <span class="o">*</span><span class="n">bp</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">bnx2x_stats_handle</span><span class="p">(</span><span class="k">struct</span> <span class="n">bnx2x</span> <span class="o">*</span><span class="n">bp</span><span class="p">,</span> <span class="k">enum</span> <span class="n">bnx2x_stats_event</span> <span class="n">event</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * bnx2x_save_statistics - save statistics when unloading.</span>
<span class="cm"> *</span>
<span class="cm"> * @bp:		driver handle</span>
<span class="cm"> */</span>
<span class="kt">void</span> <span class="n">bnx2x_save_statistics</span><span class="p">(</span><span class="k">struct</span> <span class="n">bnx2x</span> <span class="o">*</span><span class="n">bp</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">bnx2x_afex_collect_stats</span><span class="p">(</span><span class="k">struct</span> <span class="n">bnx2x</span> <span class="o">*</span><span class="n">bp</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">void_afex_stats</span><span class="p">,</span>
			      <span class="n">u32</span> <span class="n">stats_type</span><span class="p">);</span>
<span class="cp">#endif </span><span class="cm">/* BNX2X_STATS_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
