d | bnx2x |  | 21 items |  | Yuval Mintz | yuvalmin@broadcom.com | 1339915116 |  | bnx2x: fix link for BCM57711 with 84823 phy  Signed-off-by: Yaniv Rosner <yaniv.rosner@broadcom.com> Signed-off-by: Yuval Mintz <yuvalmin@broadcom.com> Signed-off-by: Eilon Greenstein <eilong@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bnx2.c | s | 211K | 7119 | Eric Dumazet | edumazet@google.com | 1335836111 |  | net: allow skb->head to be a page fragment  skb->head is currently allocated from kmalloc(). This is convenient but has the drawback the data cannot be converted to a page fragment if needed.  We have three spots were it hurts :  1) GRO aggregation   When a linear skb must be appended to another skb, GRO uses the frag_list fallback, very inefficient since we keep all struct sk_buff around. So drivers enabling GRO but delivering linear skbs to network stack aren't enabling full GRO power.  2) splice(socket -> pipe).   We must copy the linear part to a page fragment.  This kind of defeats splice() purpose (zero copy claim)  3) TCP coalescing.   Recently introduced, this permits to group several contiguous segments into a single skb. This shortens queue lengths and save kernel memory, and greatly reduce probabilities of TCP collapses. This coalescing doesnt work on linear skbs (or we would need to copy data, this would be too slow)  Given all these issues, the following patch introduces the possibility of having skb->head be a fragment in itself. We use a new skb flag, skb->head_frag to carry this information.  build_skb() is changed to accept a frag_size argument. Drivers willing to provide a page fragment instead of kmalloc() data will set a non zero value, set to the fragment size.  Then, on situations we need to convert the skb head to a frag in itself, we can check if skb->head_frag is set and avoid the copies or various fallbacks we have.  This means drivers currently using frags could be updated to avoid the current skb->head allocation and reduce their memory footprint (aka skb truesize). (thats 512 or 1024 bytes saved per skb). This also makes bpf/netfilter faster since the 'first frag' will be part of skb linear part, no need to copy data.  Signed-off-by: Eric Dumazet <edumazet@google.com> Cc: Ilpo Järvinen <ilpo.jarvinen@helsinki.fi> Cc: Herbert Xu <herbert@gondor.apana.org.au> Cc: Maciej Żenczykowski <maze@google.com> Cc: Neal Cardwell <ncardwell@google.com> Cc: Tom Herbert <therbert@google.com> Cc: Jeff Kirsher <jeffrey.t.kirsher@intel.com> Cc: Ben Hutchings <bhutchings@solarflare.com> Cc: Matt Carlson <mcarlson@broadcom.com> Cc: Michael Chan <mchan@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | Makefile | g | 288B |  | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1313031279 |  | broadcom: Move the Broadcom drivers  Moves the drivers for Broadcom devices into drivers/net/ethernet/broadcom/ and the necessary Kconfig and Makefile changes.  CC: Eilon Greenstein <eilong@broadcom.com> CC: Michael Chan <mchan@broadcom.com> CC: Matt Carlson <mcarlson@broadcom.com> CC: Gary Zambrano <zambrano@broadcom.com> CC: "Maciej W. Rozycki" <macro@linux-mips.org> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | bnx2_fw.h | s | 2.8K | 83 | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1313031279 |  | broadcom: Move the Broadcom drivers  Moves the drivers for Broadcom devices into drivers/net/ethernet/broadcom/ and the necessary Kconfig and Makefile changes.  CC: Eilon Greenstein <eilong@broadcom.com> CC: Michael Chan <mchan@broadcom.com> CC: Matt Carlson <mcarlson@broadcom.com> CC: Gary Zambrano <zambrano@broadcom.com> CC: "Maciej W. Rozycki" <macro@linux-mips.org> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | cnic_if.h | s | 8.6K | 307 | Michael Chan | mchan@broadcom.com | 1332381456 |  | cnic: Fix parity error code conflict  The recently added parity error handling used an error code that was already defined for a different error.  This could lead to bnx2x firmware assert.  We need to fix this with new error codes that are defined for parity error only.  Signed-off-by: Michael Chan <mchan@broadcom.com> Reviewed-by: Eddie Wai <eddie.wai@broadcom.com> Reviewed-by: Bhanu Prakash Gollapudi <bprakash@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cnic.c | s | 144K | 4641 | Michael Chan | mchan@broadcom.com | 1332381456 |  | cnic: Fix parity error code conflict  The recently added parity error handling used an error code that was already defined for a different error.  This could lead to bnx2x firmware assert.  We need to fix this with new error codes that are defined for parity error only.  Signed-off-by: Michael Chan <mchan@broadcom.com> Reviewed-by: Eddie Wai <eddie.wai@broadcom.com> Reviewed-by: Bhanu Prakash Gollapudi <bprakash@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cnic_defs.h | s | 169K | 5135 | Michael Chan | mchan@broadcom.com | 1332381456 |  | cnic: Fix parity error code conflict  The recently added parity error handling used an error code that was already defined for a different error.  This could lead to bnx2x firmware assert.  We need to fix this with new error codes that are defined for parity error only.  Signed-off-by: Michael Chan <mchan@broadcom.com> Reviewed-by: Eddie Wai <eddie.wai@broadcom.com> Reviewed-by: Bhanu Prakash Gollapudi <bprakash@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | b44.h | s | 17K | 374 | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1313031279 |  | broadcom: Move the Broadcom drivers  Moves the drivers for Broadcom devices into drivers/net/ethernet/broadcom/ and the necessary Kconfig and Makefile changes.  CC: Eilon Greenstein <eilong@broadcom.com> CC: Michael Chan <mchan@broadcom.com> CC: Matt Carlson <mcarlson@broadcom.com> CC: Gary Zambrano <zambrano@broadcom.com> CC: "Maciej W. Rozycki" <macro@linux-mips.org> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | tg3.h | s | 117K | 2981 | Michael Chan | mchan@broadcom.com | 1332381456 |  | tg3: Fix RSS ring refill race condition  The RSS feature in tg3 hardware has only one rx producer ring for all RSS rings.  NAPI vector 1 is special and handles the refilling of the rx producer ring on behalf of all RSS rings.  There is a race condition between these RSS NAPIs and the NAPI[1].  If NAPI[1] finishes checking for refill and then another RSS ring empties the rx producer ring before NAPI[1] exits NAPI, the chip will be completely out of SKBs in the rx producer ring.  We fix this by adding a flag tp->rx_refill and rely on napi_schedule()/ napi_complete() to help synchronize it to close the race condition.  Update driver version to 3.123.  Signed-off-by: Michael Chan <mchan@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | cnic.h | s | 12K | 380 | Michael Chan | mchan@broadcom.com | 1314565707 |  | cnic: Add timeout for ramrod replies.  If the bnx2x device has encountered parity errors, the chip will not DMA any replies.  Using wait_event_timeout() will allow us to make forward progress and let bnx2x reset the chip.  Signed-off-by: Michael Chan <mchan@broadcom.com> Reviewed-by: Bhanu Prakash Gollapudi <bprakash@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | Kconfig | g | 3.2K |  | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1316116148 |  | MII: fix Kconfig dependencies for MII  MII Kconfig option is apart of the core networking drivers and by default NET_CORE is enabled so drivers selecting MII will have MII enabled as well.  It was found using the randconfig option during testing, MII would be selected but NET_CORE could be disabled.  This caused a dependency error.  Resolved the dependency by selecting NET_CORE when MII is selected.  Reported-by: Emil Tantilov <emil.s.tantilov@intel.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com> Tested-by: Aaron Brown <aaron.f.brown@intel.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bnx2.h | s | 322K | 6636 | Michael Chan | mchan@broadcom.com | 1328499720 |  | bnx2: Add support for ethtool --show-channels||--set-channels  Allow the user to override the default number of RSS/TSS rings.  Signed-off-by: Michael Chan <mchan@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | tg3.c | s | 419K | 13450 | Matt Carlson | mcarlson@broadcom.com | 1339458910 |  | tg3: Apply short DMA frag workaround to 5906  5906 devices also need the short DMA fragment workaround.  This patch makes the necessary change.  Signed-off-by: Matt Carlson <mcarlson@broadcom.com> Tested-by: Christian Kujau <lists@nerdbynature.de> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bcm63xx_enet.c | s | 47K | 1620 | Florian Fainelli | florian@openwrt.org | 1329167048 |  | bcm63xx-enet: fix PHY name to match MDIO bus name  Commit 3e617506: bcm63xx_enet: use an unique MDIO bus name introduced a regression in the PHY connection logic, since the PHY name was formatted to expect the bus name to be "0" or "1", whereas it is now "bcm63xx-enet-0" or "bcm63xx-enet-1".  Reported-by: Joel EJC <joel_ejc@yahoofr> Signed-off-by: Florian Fainelli <florian@openwrt.org> Signed-off-by: David S. Miller <davem@davemloft.net>
f | sb1250-mac.c | s | 64K | 2164 | Joe Perches | joe@perches.com | 1328044848 |  | drivers/net: Remove alloc_etherdev error messages  alloc_etherdev has a generic OOM/unable to alloc message. Remove the duplicative messages after alloc_etherdev calls.  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | bcm63xx_enet.h | s | 6.6K | 244 | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1313031279 |  | broadcom: Move the Broadcom drivers  Moves the drivers for Broadcom devices into drivers/net/ethernet/broadcom/ and the necessary Kconfig and Makefile changes.  CC: Eilon Greenstein <eilong@broadcom.com> CC: Michael Chan <mchan@broadcom.com> CC: Matt Carlson <mcarlson@broadcom.com> CC: Gary Zambrano <zambrano@broadcom.com> CC: "Maciej W. Rozycki" <macro@linux-mips.org> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | b44.c | s | 57K | 1950 | David S. Miller | davem@davemloft.net | 1330311351 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net  Conflicts: 	drivers/net/ethernet/sfc/rx.c  Overlapping changes in drivers/net/ethernet/sfc/rx.c, one to change the rx_buf->is_page boolean into a set of u16 flags, and another to adjust how ->ip_summed is initialized.  Signed-off-by: David S. Miller <davem@davemloft.net>
