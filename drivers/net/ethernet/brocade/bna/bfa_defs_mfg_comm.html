<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › brocade › bna › bfa_defs_mfg_comm.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>bfa_defs_mfg_comm.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Linux network driver for Brocade Converged Network Adapter.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License (GPL) Version 2 as</span>
<span class="cm"> * published by the Free Software Foundation</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> */</span>
<span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2005-2010 Brocade Communications Systems, Inc.</span>
<span class="cm"> * All rights reserved</span>
<span class="cm"> * www.brocade.com</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __BFA_DEFS_MFG_COMM_H__</span>
<span class="cp">#define __BFA_DEFS_MFG_COMM_H__</span>

<span class="cp">#include &quot;bfa_defs.h&quot;</span>

<span class="cm">/**</span>
<span class="cm"> * Manufacturing block version</span>
<span class="cm"> */</span>
<span class="cp">#define BFA_MFG_VERSION				3</span>
<span class="cp">#define BFA_MFG_VERSION_UNINIT			0xFF</span>

<span class="cm">/**</span>
<span class="cm"> * Manufacturing block encrypted version</span>
<span class="cm"> */</span>
<span class="cp">#define BFA_MFG_ENC_VER				2</span>

<span class="cm">/**</span>
<span class="cm"> * Manufacturing block version 1 length</span>
<span class="cm"> */</span>
<span class="cp">#define BFA_MFG_VER1_LEN			128</span>

<span class="cm">/**</span>
<span class="cm"> * Manufacturing block header length</span>
<span class="cm"> */</span>
<span class="cp">#define BFA_MFG_HDR_LEN				4</span>

<span class="cp">#define BFA_MFG_SERIALNUM_SIZE			11</span>
<span class="cp">#define STRSZ(_n)				(((_n) + 4) &amp; ~3)</span>

<span class="cm">/**</span>
<span class="cm"> * Manufacturing card type</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">BFA_MFG_TYPE_CB_MAX</span>  <span class="o">=</span> <span class="mi">825</span><span class="p">,</span>      <span class="cm">/*!&lt; Crossbow card type max	*/</span>
	<span class="n">BFA_MFG_TYPE_FC8P2</span>   <span class="o">=</span> <span class="mi">825</span><span class="p">,</span>      <span class="cm">/*!&lt; 8G 2port FC card		*/</span>
	<span class="n">BFA_MFG_TYPE_FC8P1</span>   <span class="o">=</span> <span class="mi">815</span><span class="p">,</span>      <span class="cm">/*!&lt; 8G 1port FC card		*/</span>
	<span class="n">BFA_MFG_TYPE_FC4P2</span>   <span class="o">=</span> <span class="mi">425</span><span class="p">,</span>      <span class="cm">/*!&lt; 4G 2port FC card		*/</span>
	<span class="n">BFA_MFG_TYPE_FC4P1</span>   <span class="o">=</span> <span class="mi">415</span><span class="p">,</span>      <span class="cm">/*!&lt; 4G 1port FC card		*/</span>
	<span class="n">BFA_MFG_TYPE_CNA10P2</span> <span class="o">=</span> <span class="mi">1020</span><span class="p">,</span>     <span class="cm">/*!&lt; 10G 2port CNA card	*/</span>
	<span class="n">BFA_MFG_TYPE_CNA10P1</span> <span class="o">=</span> <span class="mi">1010</span><span class="p">,</span>     <span class="cm">/*!&lt; 10G 1port CNA card	*/</span>
	<span class="n">BFA_MFG_TYPE_JAYHAWK</span> <span class="o">=</span> <span class="mi">804</span><span class="p">,</span>	 <span class="cm">/*!&lt; Jayhawk mezz card		*/</span>
	<span class="n">BFA_MFG_TYPE_WANCHESE</span> <span class="o">=</span> <span class="mi">1007</span><span class="p">,</span>	 <span class="cm">/*!&lt; Wanchese mezz card	*/</span>
	<span class="n">BFA_MFG_TYPE_ASTRA</span>    <span class="o">=</span> <span class="mi">807</span><span class="p">,</span>	 <span class="cm">/*!&lt; Astra mezz card		*/</span>
	<span class="n">BFA_MFG_TYPE_LIGHTNING_P0</span> <span class="o">=</span> <span class="mi">902</span><span class="p">,</span> <span class="cm">/*!&lt; Lightning mezz card - old	*/</span>
	<span class="n">BFA_MFG_TYPE_LIGHTNING</span> <span class="o">=</span> <span class="mi">1741</span><span class="p">,</span>	 <span class="cm">/*!&lt; Lightning mezz card	*/</span>
	<span class="n">BFA_MFG_TYPE_PROWLER_F</span> <span class="o">=</span> <span class="mi">1560</span><span class="p">,</span>	 <span class="cm">/*!&lt; Prowler FC only cards	*/</span>
	<span class="n">BFA_MFG_TYPE_PROWLER_N</span> <span class="o">=</span> <span class="mi">1410</span><span class="p">,</span>	 <span class="cm">/*!&lt; Prowler NIC only cards	*/</span>
	<span class="n">BFA_MFG_TYPE_PROWLER_C</span> <span class="o">=</span> <span class="mi">1710</span><span class="p">,</span>	 <span class="cm">/*!&lt; Prowler CNA only cards	*/</span>
	<span class="n">BFA_MFG_TYPE_PROWLER_D</span> <span class="o">=</span> <span class="mi">1860</span><span class="p">,</span>	 <span class="cm">/*!&lt; Prowler Dual cards	*/</span>
	<span class="n">BFA_MFG_TYPE_CHINOOK</span>   <span class="o">=</span> <span class="mi">1867</span><span class="p">,</span>	 <span class="cm">/*!&lt; Chinook cards		*/</span>
	<span class="n">BFA_MFG_TYPE_INVALID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>	 <span class="cm">/*!&lt; Invalid card type		*/</span>
<span class="p">};</span>

<span class="cp">#pragma pack(1)</span>

<span class="cm">/**</span>
<span class="cm"> * Check if Mezz card</span>
<span class="cm"> */</span>
<span class="cp">#define bfa_mfg_is_mezz(type) (( \</span>
<span class="cp">	(type) == BFA_MFG_TYPE_JAYHAWK || \</span>
<span class="cp">	(type) == BFA_MFG_TYPE_WANCHESE || \</span>
<span class="cp">	(type) == BFA_MFG_TYPE_ASTRA || \</span>
<span class="cp">	(type) == BFA_MFG_TYPE_LIGHTNING_P0 || \</span>
<span class="cp">	(type) == BFA_MFG_TYPE_LIGHTNING || \</span>
<span class="cp">	(type) == BFA_MFG_TYPE_CHINOOK))</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">CB_GPIO_TTV</span>	<span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">),</span>		<span class="cm">/*!&lt; TTV debug capable cards	*/</span>
	<span class="n">CB_GPIO_FC8P2</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">),</span>		<span class="cm">/*!&lt; 8G 2port FC card		*/</span>
	<span class="n">CB_GPIO_FC8P1</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">),</span>		<span class="cm">/*!&lt; 8G 1port FC card		*/</span>
	<span class="n">CB_GPIO_FC4P2</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">),</span>		<span class="cm">/*!&lt; 4G 2port FC card		*/</span>
	<span class="n">CB_GPIO_FC4P1</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">),</span>		<span class="cm">/*!&lt; 4G 1port FC card		*/</span>
	<span class="n">CB_GPIO_DFLY</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">),</span>		<span class="cm">/*!&lt; 8G 2port FC mezzanine card	*/</span>
	<span class="n">CB_GPIO_PROTO</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">)</span>	<span class="cm">/*!&lt; 8G 2port FC prototypes	*/</span>
<span class="p">};</span>

<span class="cp">#define bfa_mfg_adapter_prop_init_gpio(gpio, card_type, prop)	\</span>
<span class="cp">do {								\</span>
<span class="cp">	if ((gpio) &amp; CB_GPIO_PROTO) {				\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_PROTO;			\</span>
<span class="cp">		(gpio) &amp;= ~CB_GPIO_PROTO;			\</span>
<span class="cp">	}							\</span>
<span class="cp">	switch ((gpio)) {					\</span>
<span class="cp">	case CB_GPIO_TTV:					\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_TTV;			\</span>
<span class="cp">	case CB_GPIO_DFLY:					\</span>
<span class="cp">	case CB_GPIO_FC8P2:					\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(NPORTS, 2);		\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(SPEED, 8);		\</span>
<span class="cp">		(card_type) = BFA_MFG_TYPE_FC8P2;		\</span>
<span class="cp">		break;						\</span>
<span class="cp">	case CB_GPIO_FC8P1:					\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(NPORTS, 1);		\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(SPEED, 8);		\</span>
<span class="cp">		(card_type) = BFA_MFG_TYPE_FC8P1;		\</span>
<span class="cp">		break;						\</span>
<span class="cp">	case CB_GPIO_FC4P2:					\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(NPORTS, 2);		\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(SPEED, 4);		\</span>
<span class="cp">		(card_type) = BFA_MFG_TYPE_FC4P2;		\</span>
<span class="cp">		break;						\</span>
<span class="cp">	case CB_GPIO_FC4P1:					\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(NPORTS, 1);		\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_SETP(SPEED, 4);		\</span>
<span class="cp">		(card_type) = BFA_MFG_TYPE_FC4P1;		\</span>
<span class="cp">		break;						\</span>
<span class="cp">	default:						\</span>
<span class="cp">		(prop) |= BFI_ADAPTER_UNSUPP;			\</span>
<span class="cp">		(card_type) = BFA_MFG_TYPE_INVALID;		\</span>
<span class="cp">	}							\</span>
<span class="cp">} while (0)</span>

<span class="cm">/**</span>
<span class="cm"> * VPD data length</span>
<span class="cm"> */</span>
<span class="cp">#define BFA_MFG_VPD_LEN			512</span>
<span class="cp">#define BFA_MFG_VPD_LEN_INVALID		0</span>

<span class="cp">#define BFA_MFG_VPD_PCI_HDR_OFF		137</span>
<span class="cp">#define BFA_MFG_VPD_PCI_VER_MASK	0x07	</span><span class="cm">/*!&lt; version mask 3 bits */</span><span class="cp"></span>
<span class="cp">#define BFA_MFG_VPD_PCI_VDR_MASK	0xf8	</span><span class="cm">/*!&lt; vendor mask 5 bits */</span><span class="cp"></span>

<span class="cm">/**</span>
<span class="cm"> * VPD vendor tag</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">BFA_MFG_VPD_UNKNOWN</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>     <span class="cm">/*!&lt; vendor unknown		*/</span>
	<span class="n">BFA_MFG_VPD_IBM</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>     <span class="cm">/*!&lt; vendor IBM		*/</span>
	<span class="n">BFA_MFG_VPD_HP</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>     <span class="cm">/*!&lt; vendor HP			*/</span>
	<span class="n">BFA_MFG_VPD_DELL</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>     <span class="cm">/*!&lt; vendor DELL		*/</span>
	<span class="n">BFA_MFG_VPD_PCI_IBM</span>	<span class="o">=</span> <span class="mh">0x08</span><span class="p">,</span>  <span class="cm">/*!&lt; PCI VPD IBM		*/</span>
	<span class="n">BFA_MFG_VPD_PCI_HP</span>	<span class="o">=</span> <span class="mh">0x10</span><span class="p">,</span>  <span class="cm">/*!&lt; PCI VPD HP		*/</span>
	<span class="n">BFA_MFG_VPD_PCI_DELL</span>	<span class="o">=</span> <span class="mh">0x20</span><span class="p">,</span>  <span class="cm">/*!&lt; PCI VPD DELL		*/</span>
	<span class="n">BFA_MFG_VPD_PCI_BRCD</span>	<span class="o">=</span> <span class="mh">0xf8</span><span class="p">,</span>  <span class="cm">/*!&lt; PCI VPD Brocade		*/</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * @brief BFA adapter flash vpd data definition.</span>
<span class="cm"> *</span>
<span class="cm"> * All numerical fields are in big-endian format.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfa_mfg_vpd</span> <span class="p">{</span>
	<span class="n">u8</span>		<span class="n">version</span><span class="p">;</span>	<span class="cm">/*!&lt; vpd data version */</span>
	<span class="n">u8</span>		<span class="n">vpd_sig</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>	<span class="cm">/*!&lt; characters &#39;V&#39;, &#39;P&#39;, &#39;D&#39; */</span>
	<span class="n">u8</span>		<span class="n">chksum</span><span class="p">;</span>		<span class="cm">/*!&lt; u8 checksum */</span>
	<span class="n">u8</span>		<span class="n">vendor</span><span class="p">;</span>		<span class="cm">/*!&lt; vendor */</span>
	<span class="n">u8</span>	<span class="n">len</span><span class="p">;</span>		<span class="cm">/*!&lt; vpd data length excluding header */</span>
	<span class="n">u8</span>	<span class="n">rsv</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">data</span><span class="p">[</span><span class="n">BFA_MFG_VPD_LEN</span><span class="p">];</span>	<span class="cm">/*!&lt; vpd data */</span>
<span class="p">};</span>

<span class="cp">#pragma pack()</span>

<span class="cp">#endif </span><span class="cm">/* __BFA_DEFS_MFG_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
