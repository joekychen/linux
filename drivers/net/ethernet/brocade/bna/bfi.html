<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › brocade › bna › bfi.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>bfi.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Linux network driver for Brocade Converged Network Adapter.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify it</span>
<span class="cm"> * under the terms of the GNU General Public License (GPL) Version 2 as</span>
<span class="cm"> * published by the Free Software Foundation</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful, but</span>
<span class="cm"> * WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<span class="cm"> * General Public License for more details.</span>
<span class="cm"> */</span>
<span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2005-2010 Brocade Communications Systems, Inc.</span>
<span class="cm"> * All rights reserved</span>
<span class="cm"> * www.brocade.com</span>
<span class="cm"> */</span>
<span class="cp">#ifndef __BFI_H__</span>
<span class="cp">#define __BFI_H__</span>

<span class="cp">#include &quot;bfa_defs.h&quot;</span>

<span class="cp">#pragma pack(1)</span>

<span class="cm">/**</span>
<span class="cm"> * BFI FW image type</span>
<span class="cm"> */</span>
<span class="cp">#define	BFI_FLASH_CHUNK_SZ			256	</span><span class="cm">/*!&lt; Flash chunk size */</span><span class="cp"></span>
<span class="cp">#define	BFI_FLASH_CHUNK_SZ_WORDS	(BFI_FLASH_CHUNK_SZ/sizeof(u32))</span>

<span class="cm">/**</span>
<span class="cm"> * Msg header common to all msgs</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="p">{</span>
	<span class="n">u8</span>		<span class="n">msg_class</span><span class="p">;</span>	<span class="cm">/*!&lt; @ref enum bfi_mclass	    */</span>
	<span class="n">u8</span>		<span class="n">msg_id</span><span class="p">;</span>		<span class="cm">/*!&lt; msg opcode with in the class   */</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="k">struct</span> <span class="p">{</span>
			<span class="n">u8</span>	<span class="n">qid</span><span class="p">;</span>
			<span class="n">u8</span>	<span class="n">fn_lpu</span><span class="p">;</span>	<span class="cm">/*!&lt; msg destination		    */</span>
		<span class="p">}</span> <span class="n">h2i</span><span class="p">;</span>
		<span class="n">u16</span>	<span class="n">i2htok</span><span class="p">;</span>	<span class="cm">/*!&lt; token in msgs to host	    */</span>
	<span class="p">}</span> <span class="n">mtag</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define bfi_fn_lpu(__fn, __lpu)	((__fn) &lt;&lt; 1 | (__lpu))</span>
<span class="cp">#define bfi_mhdr_2_fn(_mh)	((_mh)-&gt;mtag.h2i.fn_lpu &gt;&gt; 1)</span>
<span class="cp">#define bfi_mhdr_2_qid(_mh)	((_mh)-&gt;mtag.h2i.qid)</span>

<span class="cp">#define bfi_h2i_set(_mh, _mc, _op, _fn_lpu) do {		\</span>
<span class="cp">	(_mh).msg_class			= (_mc);		\</span>
<span class="cp">	(_mh).msg_id			= (_op);		\</span>
<span class="cp">	(_mh).mtag.h2i.fn_lpu	= (_fn_lpu);			\</span>
<span class="cp">} while (0)</span>

<span class="cp">#define bfi_i2h_set(_mh, _mc, _op, _i2htok) do {		\</span>
<span class="cp">	(_mh).msg_class			= (_mc);		\</span>
<span class="cp">	(_mh).msg_id			= (_op);		\</span>
<span class="cp">	(_mh).mtag.i2htok		= (_i2htok);		\</span>
<span class="cp">} while (0)</span>

<span class="cm">/*</span>
<span class="cm"> * Message opcodes: 0-127 to firmware, 128-255 to host</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_I2H_OPCODE_BASE	128</span>
<span class="cp">#define BFA_I2HM(_x)			((_x) + BFI_I2H_OPCODE_BASE)</span>

<span class="cm">/**</span>
<span class="cm"> ****************************************************************************</span>
<span class="cm"> *</span>
<span class="cm"> * Scatter Gather Element and Page definition</span>
<span class="cm"> *</span>
<span class="cm"> ****************************************************************************</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * DMA addresses</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">bfi_addr_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="p">{</span>
		<span class="n">u32</span>	<span class="n">addr_lo</span><span class="p">;</span>
		<span class="n">u32</span>	<span class="n">addr_hi</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">a32</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Generic DMA addr-len pair.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_alen</span> <span class="p">{</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>	<span class="n">al_addr</span><span class="p">;</span>	<span class="cm">/* DMA addr of buffer	*/</span>
	<span class="n">u32</span>			<span class="n">al_len</span><span class="p">;</span>		<span class="cm">/* length of buffer */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Large Message structure - 128 Bytes size Msgs</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_LMSG_SZ		128</span>
<span class="cp">#define BFI_LMSG_PL_WSZ	\</span>
<span class="cp">			((BFI_LMSG_SZ - sizeof(struct bfi_mhdr)) / 4)</span>

<span class="cm">/**</span>
<span class="cm"> * Mailbox message structure</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_MBMSG_SZ		7</span>
<span class="k">struct</span> <span class="n">bfi_mbmsg</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">pl</span><span class="p">[</span><span class="n">BFI_MBMSG_SZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Supported PCI function class codes (personality)</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">bfi_pcifn_class</span> <span class="p">{</span>
	<span class="n">BFI_PCIFN_CLASS_FC</span>	<span class="o">=</span> <span class="mh">0x0c04</span><span class="p">,</span>
	<span class="n">BFI_PCIFN_CLASS_ETH</span>	<span class="o">=</span> <span class="mh">0x0200</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Message Classes</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">bfi_mclass</span> <span class="p">{</span>
	<span class="n">BFI_MC_IOC</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/*!&lt; IO Controller (IOC)	    */</span>
	<span class="n">BFI_MC_DIAG</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>	<span class="cm">/*!&lt; Diagnostic Msgs		    */</span>
	<span class="n">BFI_MC_FLASH</span>		<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>	<span class="cm">/*!&lt; Flash message class	    */</span>
	<span class="n">BFI_MC_CEE</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>	<span class="cm">/*!&lt; CEE			    */</span>
	<span class="n">BFI_MC_FCPORT</span>		<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>	<span class="cm">/*!&lt; FC port			    */</span>
	<span class="n">BFI_MC_IOCFC</span>		<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>	<span class="cm">/*!&lt; FC - IO Controller (IOC)	    */</span>
	<span class="n">BFI_MC_LL</span>		<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>	<span class="cm">/*!&lt; Link Layer			    */</span>
	<span class="n">BFI_MC_UF</span>		<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>	<span class="cm">/*!&lt; Unsolicited frame receive	    */</span>
	<span class="n">BFI_MC_FCXP</span>		<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>	<span class="cm">/*!&lt; FC Transport		    */</span>
	<span class="n">BFI_MC_LPS</span>		<span class="o">=</span> <span class="mi">10</span><span class="p">,</span>	<span class="cm">/*!&lt; lport fc login services	    */</span>
	<span class="n">BFI_MC_RPORT</span>		<span class="o">=</span> <span class="mi">11</span><span class="p">,</span>	<span class="cm">/*!&lt; Remote port		    */</span>
	<span class="n">BFI_MC_ITNIM</span>		<span class="o">=</span> <span class="mi">12</span><span class="p">,</span>	<span class="cm">/*!&lt; I-T nexus (Initiator mode)	    */</span>
	<span class="n">BFI_MC_IOIM_READ</span>	<span class="o">=</span> <span class="mi">13</span><span class="p">,</span>	<span class="cm">/*!&lt; read IO (Initiator mode)	    */</span>
	<span class="n">BFI_MC_IOIM_WRITE</span>	<span class="o">=</span> <span class="mi">14</span><span class="p">,</span>	<span class="cm">/*!&lt; write IO (Initiator mode)	    */</span>
	<span class="n">BFI_MC_IOIM_IO</span>		<span class="o">=</span> <span class="mi">15</span><span class="p">,</span>	<span class="cm">/*!&lt; IO (Initiator mode)	    */</span>
	<span class="n">BFI_MC_IOIM</span>		<span class="o">=</span> <span class="mi">16</span><span class="p">,</span>	<span class="cm">/*!&lt; IO (Initiator mode)	    */</span>
	<span class="n">BFI_MC_IOIM_IOCOM</span>	<span class="o">=</span> <span class="mi">17</span><span class="p">,</span>	<span class="cm">/*!&lt; good IO completion		    */</span>
	<span class="n">BFI_MC_TSKIM</span>		<span class="o">=</span> <span class="mi">18</span><span class="p">,</span>	<span class="cm">/*!&lt; Initiator Task management	    */</span>
	<span class="n">BFI_MC_SBOOT</span>		<span class="o">=</span> <span class="mi">19</span><span class="p">,</span>	<span class="cm">/*!&lt; SAN boot services		    */</span>
	<span class="n">BFI_MC_IPFC</span>		<span class="o">=</span> <span class="mi">20</span><span class="p">,</span>	<span class="cm">/*!&lt; IP over FC Msgs		    */</span>
	<span class="n">BFI_MC_PORT</span>		<span class="o">=</span> <span class="mi">21</span><span class="p">,</span>	<span class="cm">/*!&lt; Physical port		    */</span>
	<span class="n">BFI_MC_SFP</span>		<span class="o">=</span> <span class="mi">22</span><span class="p">,</span>	<span class="cm">/*!&lt; SFP module			    */</span>
	<span class="n">BFI_MC_MSGQ</span>		<span class="o">=</span> <span class="mi">23</span><span class="p">,</span>	<span class="cm">/*!&lt; MSGQ			    */</span>
	<span class="n">BFI_MC_ENET</span>		<span class="o">=</span> <span class="mi">24</span><span class="p">,</span>	<span class="cm">/*!&lt; ENET commands/responses	    */</span>
	<span class="n">BFI_MC_PHY</span>		<span class="o">=</span> <span class="mi">25</span><span class="p">,</span>	<span class="cm">/*!&lt; External PHY message class	    */</span>
	<span class="n">BFI_MC_NBOOT</span>		<span class="o">=</span> <span class="mi">26</span><span class="p">,</span>	<span class="cm">/*!&lt; Network Boot		    */</span>
	<span class="n">BFI_MC_TIO_READ</span>		<span class="o">=</span> <span class="mi">27</span><span class="p">,</span>	<span class="cm">/*!&lt; read IO (Target mode)	    */</span>
	<span class="n">BFI_MC_TIO_WRITE</span>	<span class="o">=</span> <span class="mi">28</span><span class="p">,</span>	<span class="cm">/*!&lt; write IO (Target mode)	    */</span>
	<span class="n">BFI_MC_TIO_DATA_XFERED</span>	<span class="o">=</span> <span class="mi">29</span><span class="p">,</span>	<span class="cm">/*!&lt; ds transferred (target mode)   */</span>
	<span class="n">BFI_MC_TIO_IO</span>		<span class="o">=</span> <span class="mi">30</span><span class="p">,</span>	<span class="cm">/*!&lt; IO (Target mode)		    */</span>
	<span class="n">BFI_MC_TIO</span>		<span class="o">=</span> <span class="mi">31</span><span class="p">,</span>	<span class="cm">/*!&lt; IO (target mode)		    */</span>
	<span class="n">BFI_MC_MFG</span>		<span class="o">=</span> <span class="mi">32</span><span class="p">,</span>	<span class="cm">/*!&lt; MFG/ASIC block commands	    */</span>
	<span class="n">BFI_MC_EDMA</span>		<span class="o">=</span> <span class="mi">33</span><span class="p">,</span>	<span class="cm">/*!&lt; EDMA copy commands		    */</span>
	<span class="n">BFI_MC_MAX</span>		<span class="o">=</span> <span class="mi">34</span>
<span class="p">};</span>

<span class="cp">#define BFI_IOC_MSGLEN_MAX	32	</span><span class="cm">/* 32 bytes */</span><span class="cp"></span>

<span class="cp">#define BFI_FWBOOT_ENV_OS		0</span>

<span class="cm">/**</span>
<span class="cm"> *----------------------------------------------------------------------</span>
<span class="cm"> *				IOC</span>
<span class="cm"> *----------------------------------------------------------------------</span>
<span class="cm"> */</span>

<span class="cm">/**</span>
<span class="cm"> * Different asic generations</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">bfi_asic_gen</span> <span class="p">{</span>
	<span class="n">BFI_ASIC_GEN_CB</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_ASIC_GEN_CT</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_ASIC_GEN_CT2</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_asic_mode</span> <span class="p">{</span>
	<span class="n">BFI_ASIC_MODE_FC</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/* FC upto 8G speed		*/</span>
	<span class="n">BFI_ASIC_MODE_FC16</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>	<span class="cm">/* FC upto 16G speed		*/</span>
	<span class="n">BFI_ASIC_MODE_ETH</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>	<span class="cm">/* Ethernet ports		*/</span>
	<span class="n">BFI_ASIC_MODE_COMBO</span>	<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>	<span class="cm">/* FC 16G and Ethernet 10G port	*/</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_ioc_h2i_msgs</span> <span class="p">{</span>
	<span class="n">BFI_IOC_H2I_ENABLE_REQ</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_IOC_H2I_DISABLE_REQ</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_IOC_H2I_GETATTR_REQ</span>		<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">BFI_IOC_H2I_DBG_SYNC</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">BFI_IOC_H2I_DBG_DUMP</span>		<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_ioc_i2h_msgs</span> <span class="p">{</span>
	<span class="n">BFI_IOC_I2H_ENABLE_REPLY</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_IOC_I2H_DISABLE_REPLY</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">BFI_IOC_I2H_GETATTR_REPLY</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
	<span class="n">BFI_IOC_I2H_HBEAT</span>		<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * BFI_IOC_H2I_GETATTR_REQ message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_ioc_getattr_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span>	<span class="n">attr_addr</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_ioc_attr</span> <span class="p">{</span>
	<span class="n">u64</span>		<span class="n">mfg_pwwn</span><span class="p">;</span>	<span class="cm">/*!&lt; Mfg port wwn	   */</span>
	<span class="n">u64</span>		<span class="n">mfg_nwwn</span><span class="p">;</span>	<span class="cm">/*!&lt; Mfg node wwn	   */</span>
	<span class="n">mac_t</span>		<span class="n">mfg_mac</span><span class="p">;</span>	<span class="cm">/*!&lt; Mfg mac		   */</span>
	<span class="n">u8</span>		<span class="n">port_mode</span><span class="p">;</span>	<span class="cm">/* enum bfi_port_mode	   */</span>
	<span class="n">u8</span>		<span class="n">rsvd_a</span><span class="p">;</span>
	<span class="n">u64</span>		<span class="n">pwwn</span><span class="p">;</span>
	<span class="n">u64</span>		<span class="n">nwwn</span><span class="p">;</span>
	<span class="n">mac_t</span>		<span class="n">mac</span><span class="p">;</span>		<span class="cm">/*!&lt; PBC or Mfg mac	   */</span>
	<span class="n">u16</span>	<span class="n">rsvd_b</span><span class="p">;</span>
	<span class="n">mac_t</span>		<span class="n">fcoe_mac</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">rsvd_c</span><span class="p">;</span>
	<span class="kt">char</span>		<span class="n">brcd_serialnum</span><span class="p">[</span><span class="n">STRSZ</span><span class="p">(</span><span class="n">BFA_MFG_SERIALNUM_SIZE</span><span class="p">)];</span>
	<span class="n">u8</span>		<span class="n">pcie_gen</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">pcie_lanes_orig</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">pcie_lanes</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rx_bbcredit</span><span class="p">;</span>	<span class="cm">/*!&lt; receive buffer credits */</span>
	<span class="n">u32</span>	<span class="n">adapter_prop</span><span class="p">;</span>	<span class="cm">/*!&lt; adapter properties     */</span>
	<span class="n">u16</span>	<span class="n">maxfrsize</span><span class="p">;</span>	<span class="cm">/*!&lt; max receive frame size */</span>
	<span class="kt">char</span>		<span class="n">asic_rev</span><span class="p">;</span>
	<span class="n">u8</span>		<span class="n">rsvd_d</span><span class="p">;</span>
	<span class="kt">char</span>		<span class="n">fw_version</span><span class="p">[</span><span class="n">BFA_VERSION_LEN</span><span class="p">];</span>
	<span class="kt">char</span>		<span class="n">optrom_version</span><span class="p">[</span><span class="n">BFA_VERSION_LEN</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">bfa_mfg_vpd</span> <span class="n">vpd</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">card_type</span><span class="p">;</span>	<span class="cm">/*!&lt; card type			*/</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * BFI_IOC_I2H_GETATTR_REPLY message</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_ioc_getattr_reply</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/*!&lt; Common msg header		*/</span>
	<span class="n">u8</span>			<span class="n">status</span><span class="p">;</span>	<span class="cm">/*!&lt; cfg reply status		*/</span>
	<span class="n">u8</span>			<span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * Firmware memory page offsets</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_IOC_SMEM_PG0_CB	(0x40)</span>
<span class="cp">#define BFI_IOC_SMEM_PG0_CT	(0x180)</span>

<span class="cm">/**</span>
<span class="cm"> * Firmware statistic offset</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_IOC_FWSTATS_OFF	(0x6B40)</span>
<span class="cp">#define BFI_IOC_FWSTATS_SZ	(4096)</span>

<span class="cm">/**</span>
<span class="cm"> * Firmware trace offset</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_IOC_TRC_OFF		(0x4b00)</span>
<span class="cp">#define BFI_IOC_TRC_ENTS	256</span>
<span class="cp">#define BFI_IOC_TRC_ENT_SZ	16</span>
<span class="cp">#define BFI_IOC_TRC_HDR_SZ	32</span>

<span class="cp">#define BFI_IOC_FW_SIGNATURE	(0xbfadbfad)</span>
<span class="cp">#define BFI_IOC_MD5SUM_SZ	4</span>
<span class="k">struct</span> <span class="n">bfi_ioc_image_hdr</span> <span class="p">{</span>
	<span class="n">u32</span>	<span class="n">signature</span><span class="p">;</span>	<span class="cm">/*!&lt; constant signature */</span>
	<span class="n">u8</span>	<span class="n">asic_gen</span><span class="p">;</span>	<span class="cm">/*!&lt; asic generation */</span>
	<span class="n">u8</span>	<span class="n">asic_mode</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">port0_mode</span><span class="p">;</span>	<span class="cm">/*!&lt; device mode for port 0 */</span>
	<span class="n">u8</span>	<span class="n">port1_mode</span><span class="p">;</span>	<span class="cm">/*!&lt; device mode for port 1 */</span>
	<span class="n">u32</span>	<span class="n">exec</span><span class="p">;</span>		<span class="cm">/*!&lt; exec vector	*/</span>
	<span class="n">u32</span>	<span class="n">bootenv</span><span class="p">;</span>	<span class="cm">/*!&lt; firmware boot env */</span>
	<span class="n">u32</span>	<span class="n">rsvd_b</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">md5sum</span><span class="p">[</span><span class="n">BFI_IOC_MD5SUM_SZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define BFI_FWBOOT_DEVMODE_OFF		4</span>
<span class="cp">#define BFI_FWBOOT_TYPE_OFF		8</span>
<span class="cp">#define BFI_FWBOOT_ENV_OFF		12</span>
<span class="cp">#define BFI_FWBOOT_DEVMODE(__asic_gen, __asic_mode, __p0_mode, __p1_mode) \</span>
<span class="cp">	(((u32)(__asic_gen)) &lt;&lt; 24 |	\</span>
<span class="cp">	 ((u32)(__asic_mode)) &lt;&lt; 16 |	\</span>
<span class="cp">	 ((u32)(__p0_mode)) &lt;&lt; 8 |	\</span>
<span class="cp">	 ((u32)(__p1_mode)))</span>

<span class="k">enum</span> <span class="n">bfi_fwboot_type</span> <span class="p">{</span>
	<span class="n">BFI_FWBOOT_TYPE_NORMAL</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">BFI_FWBOOT_TYPE_FLASH</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_FWBOOT_TYPE_MEMTEST</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_port_mode</span> <span class="p">{</span>
	<span class="n">BFI_PORT_MODE_FC</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_PORT_MODE_ETH</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">bfi_ioc_hbeat</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>		<span class="cm">/*!&lt; common msg header		*/</span>
	<span class="n">u32</span>	   <span class="n">hb_count</span><span class="p">;</span>	<span class="cm">/*!&lt; current heart beat count	*/</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * IOC hardware/firmware state</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">bfi_ioc_state</span> <span class="p">{</span>
	<span class="n">BFI_IOC_UNINIT</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>	<span class="cm">/*!&lt; not initialized		     */</span>
	<span class="n">BFI_IOC_INITING</span>		<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>	<span class="cm">/*!&lt; h/w is being initialized	     */</span>
	<span class="n">BFI_IOC_HWINIT</span>		<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>	<span class="cm">/*!&lt; h/w is initialized		     */</span>
	<span class="n">BFI_IOC_CFG</span>		<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>	<span class="cm">/*!&lt; IOC configuration in progress   */</span>
	<span class="n">BFI_IOC_OP</span>		<span class="o">=</span> <span class="mi">4</span><span class="p">,</span>	<span class="cm">/*!&lt; IOC is operational		     */</span>
	<span class="n">BFI_IOC_DISABLING</span>	<span class="o">=</span> <span class="mi">5</span><span class="p">,</span>	<span class="cm">/*!&lt; IOC is being disabled	     */</span>
	<span class="n">BFI_IOC_DISABLED</span>	<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>	<span class="cm">/*!&lt; IOC is disabled		     */</span>
	<span class="n">BFI_IOC_CFG_DISABLED</span>	<span class="o">=</span> <span class="mi">7</span><span class="p">,</span>	<span class="cm">/*!&lt; IOC is being disabled;transient */</span>
	<span class="n">BFI_IOC_FAIL</span>		<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>	<span class="cm">/*!&lt; IOC heart-beat failure	     */</span>
	<span class="n">BFI_IOC_MEMTEST</span>		<span class="o">=</span> <span class="mi">9</span><span class="p">,</span>	<span class="cm">/*!&lt; IOC is doing memtest	     */</span>
<span class="p">};</span>

<span class="cp">#define BFI_IOC_ENDIAN_SIG  0x12345678</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">BFI_ADAPTER_TYPE_FC</span>	<span class="o">=</span> <span class="mh">0x01</span><span class="p">,</span>		<span class="cm">/*!&lt; FC adapters	   */</span>
	<span class="n">BFI_ADAPTER_TYPE_MK</span>	<span class="o">=</span> <span class="mh">0x0f0000</span><span class="p">,</span>	<span class="cm">/*!&lt; adapter type mask     */</span>
	<span class="n">BFI_ADAPTER_TYPE_SH</span>	<span class="o">=</span> <span class="mi">16</span><span class="p">,</span>	        <span class="cm">/*!&lt; adapter type shift    */</span>
	<span class="n">BFI_ADAPTER_NPORTS_MK</span>	<span class="o">=</span> <span class="mh">0xff00</span><span class="p">,</span>	<span class="cm">/*!&lt; number of ports mask  */</span>
	<span class="n">BFI_ADAPTER_NPORTS_SH</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>	        <span class="cm">/*!&lt; number of ports shift */</span>
	<span class="n">BFI_ADAPTER_SPEED_MK</span>	<span class="o">=</span> <span class="mh">0xff</span><span class="p">,</span>		<span class="cm">/*!&lt; adapter speed mask    */</span>
	<span class="n">BFI_ADAPTER_SPEED_SH</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>	        <span class="cm">/*!&lt; adapter speed shift   */</span>
	<span class="n">BFI_ADAPTER_PROTO</span>	<span class="o">=</span> <span class="mh">0x100000</span><span class="p">,</span>	<span class="cm">/*!&lt; prototype adapaters   */</span>
	<span class="n">BFI_ADAPTER_TTV</span>		<span class="o">=</span> <span class="mh">0x200000</span><span class="p">,</span>	<span class="cm">/*!&lt; TTV debug capable     */</span>
	<span class="n">BFI_ADAPTER_UNSUPP</span>	<span class="o">=</span> <span class="mh">0x400000</span><span class="p">,</span>	<span class="cm">/*!&lt; unknown adapter type  */</span>
<span class="p">};</span>

<span class="cp">#define BFI_ADAPTER_GETP(__prop, __adap_prop)			\</span>
<span class="cp">	(((__adap_prop) &amp; BFI_ADAPTER_ ## __prop ## _MK) &gt;&gt;	\</span>
<span class="cp">		BFI_ADAPTER_ ## __prop ## _SH)</span>
<span class="cp">#define BFI_ADAPTER_SETP(__prop, __val)				\</span>
<span class="cp">	((__val) &lt;&lt; BFI_ADAPTER_ ## __prop ## _SH)</span>
<span class="cp">#define BFI_ADAPTER_IS_PROTO(__adap_type)			\</span>
<span class="cp">	((__adap_type) &amp; BFI_ADAPTER_PROTO)</span>
<span class="cp">#define BFI_ADAPTER_IS_TTV(__adap_type)				\</span>
<span class="cp">	((__adap_type) &amp; BFI_ADAPTER_TTV)</span>
<span class="cp">#define BFI_ADAPTER_IS_UNSUPP(__adap_type)			\</span>
<span class="cp">	((__adap_type) &amp; BFI_ADAPTER_UNSUPP)</span>
<span class="cp">#define BFI_ADAPTER_IS_SPECIAL(__adap_type)			\</span>
<span class="cp">	((__adap_type) &amp; (BFI_ADAPTER_TTV | BFI_ADAPTER_PROTO |	\</span>
<span class="cp">			BFI_ADAPTER_UNSUPP))</span>

<span class="cm">/**</span>
<span class="cm"> * BFI_IOC_H2I_ENABLE_REQ &amp; BFI_IOC_H2I_DISABLE_REQ messages</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_ioc_ctrl_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="n">clscode</span><span class="p">;</span>
	<span class="n">u16</span>			<span class="n">rsvd</span><span class="p">;</span>
	<span class="n">u32</span>		<span class="n">tv_sec</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * BFI_IOC_I2H_ENABLE_REPLY &amp; BFI_IOC_I2H_DISABLE_REPLY messages</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_ioc_ctrl_reply</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>			<span class="cm">/*!&lt; Common msg header     */</span>
	<span class="n">u8</span>			<span class="n">status</span><span class="p">;</span>		<span class="cm">/*!&lt; enable/disable status */</span>
	<span class="n">u8</span>			<span class="n">port_mode</span><span class="p">;</span>	<span class="cm">/*!&lt; enum bfa_mode */</span>
	<span class="n">u8</span>			<span class="n">cap_bm</span><span class="p">;</span>		<span class="cm">/*!&lt; capability bit mask */</span>
	<span class="n">u8</span>			<span class="n">rsvd</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BFI_IOC_MSGSZ   8</span>
<span class="cm">/**</span>
<span class="cm"> * H2I Messages</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">bfi_ioc_h2i_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_ioc_ctrl_req</span> <span class="n">enable_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_ioc_ctrl_req</span> <span class="n">disable_req</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_ioc_getattr_req</span> <span class="n">getattr_req</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">mboxmsg</span><span class="p">[</span><span class="n">BFI_IOC_MSGSZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * I2H Messages</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">bfi_ioc_i2h_msg_u</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_ioc_ctrl_reply</span> <span class="n">fw_event</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">mboxmsg</span><span class="p">[</span><span class="n">BFI_IOC_MSGSZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> *----------------------------------------------------------------------</span>
<span class="cm"> *				MSGQ</span>
<span class="cm"> *----------------------------------------------------------------------</span>
<span class="cm"> */</span>

<span class="k">enum</span> <span class="n">bfi_msgq_h2i_msgs</span> <span class="p">{</span>
	<span class="n">BFI_MSGQ_H2I_INIT_REQ</span>	   <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_MSGQ_H2I_DOORBELL_PI</span>	<span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_MSGQ_H2I_DOORBELL_CI</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">BFI_MSGQ_H2I_CMDQ_COPY_RSP</span>      <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_msgq_i2h_msgs</span> <span class="p">{</span>
	<span class="n">BFI_MSGQ_I2H_INIT_RSP</span>	   <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="n">BFI_MSGQ_H2I_INIT_REQ</span><span class="p">),</span>
	<span class="n">BFI_MSGQ_I2H_DOORBELL_PI</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="n">BFI_MSGQ_H2I_DOORBELL_PI</span><span class="p">),</span>
	<span class="n">BFI_MSGQ_I2H_DOORBELL_CI</span>	<span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="n">BFI_MSGQ_H2I_DOORBELL_CI</span><span class="p">),</span>
	<span class="n">BFI_MSGQ_I2H_CMDQ_COPY_REQ</span>      <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="n">BFI_MSGQ_H2I_CMDQ_COPY_RSP</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/* Messages(commands/responsed/AENS will have the following header */</span>
<span class="k">struct</span> <span class="n">bfi_msgq_mhdr</span> <span class="p">{</span>
	<span class="n">u8</span>	<span class="n">msg_class</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">msg_id</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">msg_token</span><span class="p">;</span>
	<span class="n">u16</span>	<span class="n">num_entries</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">enet_id</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">rsvd</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define bfi_msgq_mhdr_set(_mh, _mc, _mid, _tok, _enet_id) do {	\</span>
<span class="cp">	(_mh).msg_class	 = (_mc);	\</span>
<span class="cp">	(_mh).msg_id	    = (_mid);       \</span>
<span class="cp">	(_mh).msg_token	 = (_tok);       \</span>
<span class="cp">	(_mh).enet_id	   = (_enet_id);   \</span>
<span class="cp">} while (0)</span>

<span class="cm">/*</span>
<span class="cm"> * Mailbox  for messaging interface</span>
<span class="cm"> */</span>
<span class="cp">#define BFI_MSGQ_CMD_ENTRY_SIZE	 (64)    </span><span class="cm">/* TBD */</span><span class="cp"></span>
<span class="cp">#define BFI_MSGQ_RSP_ENTRY_SIZE	 (64)    </span><span class="cm">/* TBD */</span><span class="cp"></span>

<span class="cp">#define bfi_msgq_num_cmd_entries(_size)				 \</span>
<span class="cp">	(((_size) + BFI_MSGQ_CMD_ENTRY_SIZE - 1) / BFI_MSGQ_CMD_ENTRY_SIZE)</span>

<span class="k">struct</span> <span class="n">bfi_msgq</span> <span class="p">{</span>
	<span class="k">union</span> <span class="n">bfi_addr_u</span> <span class="n">addr</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">q_depth</span><span class="p">;</span>     <span class="cm">/* Total num of entries in the queue */</span>
	<span class="n">u8</span> <span class="n">rsvd</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* BFI_ENET_MSGQ_CFG_REQ TBD init or cfg? */</span>
<span class="k">struct</span> <span class="n">bfi_msgq_cfg_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_msgq</span> <span class="n">cmdq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_msgq</span> <span class="n">rspq</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* BFI_ENET_MSGQ_CFG_RSP */</span>
<span class="k">struct</span> <span class="n">bfi_msgq_cfg_rsp</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">cmd_status</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rsvd</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* BFI_MSGQ_H2I_DOORBELL */</span>
<span class="k">struct</span> <span class="n">bfi_msgq_h2i_db</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u16</span> <span class="n">cmdq_pi</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">rspq_ci</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">idx</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* BFI_MSGQ_I2H_DOORBELL */</span>
<span class="k">struct</span> <span class="n">bfi_msgq_i2h_db</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="k">union</span> <span class="p">{</span>
		<span class="n">u16</span> <span class="n">rspq_pi</span><span class="p">;</span>
		<span class="n">u16</span> <span class="n">cmdq_ci</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">idx</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define BFI_CMD_COPY_SZ 28</span>

<span class="cm">/* BFI_MSGQ_H2I_CMD_COPY_RSP */</span>
<span class="k">struct</span> <span class="n">bfi_msgq_h2i_cmdq_copy_rsp</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="n">u8</span>	      <span class="n">data</span><span class="p">[</span><span class="n">BFI_CMD_COPY_SZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cm">/* BFI_MSGQ_I2H_CMD_COPY_REQ */</span>
<span class="k">struct</span> <span class="n">bfi_msgq_i2h_cmdq_copy_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>
	<span class="n">u16</span>     <span class="n">offset</span><span class="p">;</span>
	<span class="n">u16</span>     <span class="n">len</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> *      FLASH module specific</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">bfi_flash_h2i_msgs</span> <span class="p">{</span>
	<span class="n">BFI_FLASH_H2I_QUERY_REQ</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">BFI_FLASH_H2I_ERASE_REQ</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
	<span class="n">BFI_FLASH_H2I_WRITE_REQ</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">BFI_FLASH_H2I_READ_REQ</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
	<span class="n">BFI_FLASH_H2I_BOOT_VER_REQ</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">bfi_flash_i2h_msgs</span> <span class="p">{</span>
	<span class="n">BFI_FLASH_I2H_QUERY_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
	<span class="n">BFI_FLASH_I2H_ERASE_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
	<span class="n">BFI_FLASH_I2H_WRITE_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
	<span class="n">BFI_FLASH_I2H_READ_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
	<span class="n">BFI_FLASH_I2H_BOOT_VER_RSP</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
	<span class="n">BFI_FLASH_I2H_EVENT</span> <span class="o">=</span> <span class="n">BFA_I2HM</span><span class="p">(</span><span class="mi">127</span><span class="p">),</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Flash query request</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_flash_query_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>   <span class="cm">/* Common msg header */</span>
	<span class="k">struct</span> <span class="n">bfi_alen</span> <span class="n">alen</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Flash write request</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_flash_write_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* Common msg header */</span>
	<span class="k">struct</span> <span class="n">bfi_alen</span> <span class="n">alen</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">type</span><span class="p">;</span>   <span class="cm">/* partition type */</span>
	<span class="n">u8</span>	<span class="n">instance</span><span class="p">;</span> <span class="cm">/* partition instance */</span>
	<span class="n">u8</span>	<span class="n">last</span><span class="p">;</span>
	<span class="n">u8</span>	<span class="n">rsv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">length</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Flash read request</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_flash_read_req</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* Common msg header */</span>
	<span class="n">u32</span>	<span class="n">type</span><span class="p">;</span>		<span class="cm">/* partition type */</span>
	<span class="n">u8</span>	<span class="n">instance</span><span class="p">;</span>	<span class="cm">/* partition instance */</span>
	<span class="n">u8</span>	<span class="n">rsv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">offset</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">length</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">bfi_alen</span> <span class="n">alen</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Flash query response</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_flash_query_rsp</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* Common msg header */</span>
	<span class="n">u32</span>	<span class="n">status</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Flash read response</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_flash_read_rsp</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* Common msg header */</span>
	<span class="n">u32</span>	<span class="n">type</span><span class="p">;</span>		<span class="cm">/* partition type */</span>
	<span class="n">u8</span>	<span class="n">instance</span><span class="p">;</span>	<span class="cm">/* partition instance */</span>
	<span class="n">u8</span>	<span class="n">rsv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">status</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">length</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Flash write response</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">bfi_flash_write_rsp</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">bfi_mhdr</span> <span class="n">mh</span><span class="p">;</span>	<span class="cm">/* Common msg header */</span>
	<span class="n">u32</span>	<span class="n">type</span><span class="p">;</span>		<span class="cm">/* partition type */</span>
	<span class="n">u8</span>	<span class="n">instance</span><span class="p">;</span>	<span class="cm">/* partition instance */</span>
	<span class="n">u8</span>	<span class="n">rsv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span>	<span class="n">status</span><span class="p">;</span>
	<span class="n">u32</span>	<span class="n">length</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#pragma pack()</span>

<span class="cp">#endif </span><span class="cm">/* __BFI_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
