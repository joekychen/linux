f | ethtool.c | s | 33K | 1015 | Joe Perches | joe@perches.com | 1336707181 |  | drivers/net: Convert compare_ether_addr to ether_addr_equal  Use the new bool function ether_addr_equal to add some clarity and reduce the likelihood for misuse of compare_ether_addr for sorting.  Done via cocci script:  $ cat compare_ether_addr.cocci @@ expression a,b; @@ -	!compare_ether_addr(a, b) +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	compare_ether_addr(a, b) +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) == 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!ether_addr_equal(a, b) != 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) == 0 +	!ether_addr_equal(a, b)  @@ expression a,b; @@ -	ether_addr_equal(a, b) != 0 +	ether_addr_equal(a, b)  @@ expression a,b; @@ -	!!ether_addr_equal(a, b) +	ether_addr_equal(a, b)  Signed-off-by: Joe Perches <joe@perches.com> Signed-off-by: David S. Miller <davem@davemloft.net>
f | Makefile | g | 333B |  | Ben Hutchings | bhutchings@solarflare.com | 1329351913 |  | sfc: Add SR-IOV back-end support for SFC9000 family  On the SFC9000 family, each port has 1024 Virtual Interfaces (VIs), each with an RX queue, a TX queue, an event queue and a mailbox register.  These may be assigned to up to 127 SR-IOV virtual functions per port, with up to 64 VIs per VF.  We allocate an extra channel (IRQ and event queue only) to receive requests from VF drivers.  There is a per-port limit of 4 concurrent RX queue flushes, and queue flushes may be initiated by the MC in response to a Function Level Reset (FLR) of a VF.  Therefore, when SR-IOV is in use, we submit all flush requests via the MC.  The RSS indirection table is shared with VFs, so the number of RX queues used in the PF is limited to the number of VIs per VF.  This is almost entirely the work of Steve Hodgson, formerly shodgson@solarflare.com.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | io.h | s | 9.7K | 259 | David S. Miller | davem@davemloft.net | 1316676193 |  | Merge branch 'master' of github.com:davem330/net  Conflicts: 	MAINTAINERS 	drivers/net/Kconfig 	drivers/net/ethernet/broadcom/bnx2x/bnx2x_link.c 	drivers/net/ethernet/broadcom/tg3.c 	drivers/net/wireless/iwlwifi/iwl-pci.c 	drivers/net/wireless/iwlwifi/iwl-trans-tx-pcie.c 	drivers/net/wireless/rt2x00/rt2800usb.c 	drivers/net/wireless/wl12xx/main.c
f | workarounds.h | s | 2.4K | 53 | David S. Miller | davem@davemloft.net | 1316676193 |  | Merge branch 'master' of github.com:davem330/net  Conflicts: 	MAINTAINERS 	drivers/net/Kconfig 	drivers/net/ethernet/broadcom/bnx2x/bnx2x_link.c 	drivers/net/ethernet/broadcom/tg3.c 	drivers/net/wireless/iwlwifi/iwl-pci.c 	drivers/net/wireless/iwlwifi/iwl-trans-tx-pcie.c 	drivers/net/wireless/rt2x00/rt2800usb.c 	drivers/net/wireless/wl12xx/main.c
f | tenxpress.c | s | 13K | 406 | Ben Hutchings | bhutchings@solarflare.com | 1325789089 |  | sfc: Fix some formatting errors reported by checkpatch  Fix the following errors and warnings:  ERROR: trailing whitespace ERROR: spaces required around that '=' (ctx:VxV) WARNING: please, no space before tabs  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | filter.h | s | 4.9K | 132 | Ben Hutchings | bhutchings@solarflare.com | 1329351090 |  | sfc: Add support for TX MAC filters  On Siena each TX queue can be configured to send only packets for which there is a TX MAC filter that matches the source MAC address, queue ID, and optionally VID.  This will be used to implement the 'spoofchk' feature for SR-IOV virtual functions.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | efx.h | s | 6.1K | 137 | Ben Hutchings | bhutchings@solarflare.com | 1331057655 |  | sfc: Run event/IRQ self-test asynchronously when interface is brought up  Generate a test event on each event queue whenever the interface is brought up, then after 1 second check that we have either handled a test event or handled another IRQ for each event queue.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | txc43128_phy.c | s | 15K | 464 | Ben Hutchings | bhutchings@solarflare.com | 1326128893 |  | sfc: Const-qualify static data as appropriate, partly prompted by checkpatch  Fix the following warnings:  WARNING: struct dev_pm_ops should normally be const WARNING: static const char * array should probably be static const char * const  Similarly const-qualify struct i2c_board_info, struct i2c_algo_bit_data, struct efx_ethtool_stat, struct efx_mtd_ops and struct siena_nvram_type_info.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | falcon_boards.c | s | 21K | 654 | Ben Hutchings | bhutchings@solarflare.com | 1331057656 |  | sfc: Log the part number on probe  During probe of each port, read and log the part number from VPD. Remove the Falcon-specific board name lookup.  Initial version by Stuart Hodgson <smhodgson@solarflare.com>.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | tx.c | s | 33K | 1035 | Ben Hutchings | bhutchings@solarflare.com | 1329943718 |  | sfc: Minor formatting cleanup  Fix some indentation and line continuations.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mcdi_pcol.h | s | 92K | 2046 | Ben Hutchings | bhutchings@solarflare.com | 1326128896 |  | sfc: Update MCDI (firmware interface) definitions  Some commands and constants have been renamed; adjust the code accordingly.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | enum.h | s | 5.8K | 154 | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1313055230 |  | sfc: Move the Solarflare drivers  Moves the Solarflare drivers into drivers/net/ethernet/sfc/ and make the necessary Kconfig and Makefile changes.  CC: Steve Hodgson <shodgson@solarflare.com> CC: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | siena.c | s | 19K | 571 | Ben Hutchings | bhutchings@solarflare.com | 1331057653 |  | sfc: Remove redundant function efx_nic_has_mc()  This function is now used in only one place, where it always returns true.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | selftest.h | s | 1.5K | 47 | Ben Hutchings | bhutchings@solarflare.com | 1331057655 |  | sfc: Run event/IRQ self-test asynchronously when interface is brought up  Generate a test event on each event queue whenever the interface is brought up, then after 1 second check that we have either handled a test event or handled another IRQ for each event queue.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | falcon.c | s | 50K | 1574 | Ben Hutchings | bhutchings@solarflare.com | 1329351912 |  | sfc: Allocate SRAM between buffer table and descriptor caches at init time  Each port has a block of 64-bit SRAM that is divided between buffer table and descriptor cache regions at initialisation time.  Currently we use a fixed allocation, but it needs to be changed to support larger numbers of queues.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | spi.h | s | 3.8K | 89 | Ben Hutchings | bhutchings@solarflare.com | 1325789089 |  | sfc: Fix some formatting errors reported by checkpatch  Fix the following errors and warnings:  ERROR: trailing whitespace ERROR: spaces required around that '=' (ctx:VxV) WARNING: please, no space before tabs  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | selftest.c | s | 22K | 700 | Ben Hutchings | bhutchings@solarflare.com | 1331057655 |  | sfc: Run event/IRQ self-test asynchronously when interface is brought up  Generate a test event on each event queue whenever the interface is brought up, then after 1 second check that we have either handled a test event or handled another IRQ for each event queue.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | vfdi.h | s | 9.3K | 247 | Ben Hutchings | bhutchings@solarflare.com | 1329943687 |  | sfc: Specify that the VFDI status page has page alignment and size  This requirement was meant to be implied in the name 'status page'. One out-of-tree VF driver allocates a buffer using the structure size and not a full page - hence the current odd specification - but in practice that allocation will be padded and aligned to at least 4KB. Therefore, we can specify this and have the option to extend the structure up to 4KB without worrying about VF drivers using odd-shaped buffers.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mcdi.h | s | 6.2K | 149 | Ben Hutchings | bhutchings@solarflare.com | 1329351913 |  | sfc: Add SR-IOV back-end support for SFC9000 family  On the SFC9000 family, each port has 1024 Virtual Interfaces (VIs), each with an RX queue, a TX queue, an event queue and a mailbox register.  These may be assigned to up to 127 SR-IOV virtual functions per port, with up to 64 VIs per VF.  We allocate an extra channel (IRQ and event queue only) to receive requests from VF drivers.  There is a per-port limit of 4 concurrent RX queue flushes, and queue flushes may be initiated by the MC in response to a Function Level Reset (FLR) of a VF.  Therefore, when SR-IOV is in use, we submit all flush requests via the MC.  The RSS indirection table is shared with VFs, so the number of RX queues used in the PF is limited to the number of VIs per VF.  This is almost entirely the work of Steve Hodgson, formerly shodgson@solarflare.com.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mdio_10g.c | s | 8.5K | 276 | Ben Hutchings | bhutchings@solarflare.com | 1325789089 |  | sfc: Fix some formatting errors reported by checkpatch  Fix the following errors and warnings:  ERROR: trailing whitespace ERROR: spaces required around that '=' (ctx:VxV) WARNING: please, no space before tabs  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | filter.c | s | 31K | 984 | Ben Hutchings | bhutchings@solarflare.com | 1329351090 |  | sfc: Add support for TX MAC filters  On Siena each TX queue can be configured to send only packets for which there is a TX MAC filter that matches the source MAC address, queue ID, and optionally VID.  This will be used to implement the 'spoofchk' feature for SR-IOV virtual functions.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mcdi_mon.c | s | 11K | 353 | Ben Hutchings | bhutchings@solarflare.com | 1329943718 |  | sfc: Minor formatting cleanup  Fix some indentation and line continuations.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mdio_10g.h | s | 3.4K | 87 | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1313055230 |  | sfc: Move the Solarflare drivers  Moves the Solarflare drivers into drivers/net/ethernet/sfc/ and make the necessary Kconfig and Makefile changes.  CC: Steve Hodgson <shodgson@solarflare.com> CC: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | phy.h | s | 2.5K | 55 | Jeff Kirsher | jeffrey.t.kirsher@intel.com | 1313055230 |  | sfc: Move the Solarflare drivers  Moves the Solarflare drivers into drivers/net/ethernet/sfc/ and make the necessary Kconfig and Makefile changes.  CC: Steve Hodgson <shodgson@solarflare.com> CC: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>
f | net_driver.h | s | 36K | 1017 | Stuart Hodgson | smhodgson@solarflare.com | 1336615846 |  | sfc: Added support for new ethtool APIs for obtaining module eeprom  Currently allows for SFP+ eeprom to be returned using the ethtool API. This can be extended in future to handle different eeprom formats and sizes  Signed-off-by: Stuart Hodgson <smhodgson@solarflare.com> [bwh: Drop redundant validation, comment, whitespace] Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | rx.c | s | 21K | 632 | David Riddoch | driddoch@solarflare.com | 1336612937 |  | sfc: By default refill RX rings as soon as space for a batch  Previously we refilled with much larger batches, which caused large latency spikes.  We now have many more much much smaller spikes!  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mcdi_mac.c | s | 3.4K | 107 | Ben Hutchings | bhutchings@solarflare.com | 1329351913 |  | sfc: Add SR-IOV back-end support for SFC9000 family  On the SFC9000 family, each port has 1024 Virtual Interfaces (VIs), each with an RX queue, a TX queue, an event queue and a mailbox register.  These may be assigned to up to 127 SR-IOV virtual functions per port, with up to 64 VIs per VF.  We allocate an extra channel (IRQ and event queue only) to receive requests from VF drivers.  There is a per-port limit of 4 concurrent RX queue flushes, and queue flushes may be initiated by the MC in response to a Function Level Reset (FLR) of a VF.  Therefore, when SR-IOV is in use, we submit all flush requests via the MC.  The RSS indirection table is shared with VFs, so the number of RX queues used in the PF is limited to the number of VIs per VF.  This is almost entirely the work of Steve Hodgson, formerly shodgson@solarflare.com.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | siena_sriov.c | s | 44K | 1406 | Robert Stonehouse | rstonehouse@solarflare.com | 1331057653 |  | sfc: Fix calculation of vf_i in map_vi_index()  This was broken during refactoring to use efx_vf_size().  [bwh: Keep using efx_vf_size()] Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | nic.c | s | 60K | 1786 | Ben Hutchings | bhutchings@solarflare.com | 1331057655 |  | sfc: Run event/IRQ self-test asynchronously when interface is brought up  Generate a test event on each event queue whenever the interface is brought up, then after 1 second check that we have either handled a test event or handled another IRQ for each event queue.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | Kconfig | g | 1.1K |  | Ben Hutchings | bhutchings@solarflare.com | 1329351913 |  | sfc: Add SR-IOV back-end support for SFC9000 family  On the SFC9000 family, each port has 1024 Virtual Interfaces (VIs), each with an RX queue, a TX queue, an event queue and a mailbox register.  These may be assigned to up to 127 SR-IOV virtual functions per port, with up to 64 VIs per VF.  We allocate an extra channel (IRQ and event queue only) to receive requests from VF drivers.  There is a per-port limit of 4 concurrent RX queue flushes, and queue flushes may be initiated by the MC in response to a Function Level Reset (FLR) of a VF.  Therefore, when SR-IOV is in use, we submit all flush requests via the MC.  The RSS indirection table is shared with VFs, so the number of RX queues used in the PF is limited to the number of VIs per VF.  This is almost entirely the work of Steve Hodgson, formerly shodgson@solarflare.com.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mcdi_phy.c | s | 22K | 702 | Stuart Hodgson | smhodgson@solarflare.com | 1336615846 |  | sfc: Added support for new ethtool APIs for obtaining module eeprom  Currently allows for SFP+ eeprom to be returned using the ethtool API. This can be extended in future to handle different eeprom formats and sizes  Signed-off-by: Stuart Hodgson <smhodgson@solarflare.com> [bwh: Drop redundant validation, comment, whitespace] Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | regs.h | s | 112K | 3002 | Ben Hutchings | bhutchings@solarflare.com | 1329351091 |  | sfc: Correct MAC filter bitfield definitions  The RMFT_DEST_MAC and TMFT_SRC_MAC register fields were previously documented as 44 bits wide, whereas a MAC address has 48 bits. Thankfully the hardware uses the correct width and the driver has used separate definitions that divide each of these into 32-bit and 16-bit fields.  Fix the initial definitions for these fields and rewrite the latter definitions to use them.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | bitfield.h | s | 18K | 465 | Ben Hutchings | bhutchings@solarflare.com | 1329943718 |  | sfc: Minor formatting cleanup  Fix some indentation and line continuations.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | mcdi.c | s | 30K | 982 | Ben Hutchings | bhutchings@solarflare.com | 1329351913 |  | sfc: Add SR-IOV back-end support for SFC9000 family  On the SFC9000 family, each port has 1024 Virtual Interfaces (VIs), each with an RX queue, a TX queue, an event queue and a mailbox register.  These may be assigned to up to 127 SR-IOV virtual functions per port, with up to 64 VIs per VF.  We allocate an extra channel (IRQ and event queue only) to receive requests from VF drivers.  There is a per-port limit of 4 concurrent RX queue flushes, and queue flushes may be initiated by the MC in response to a Function Level Reset (FLR) of a VF.  Therefore, when SR-IOV is in use, we submit all flush requests via the MC.  The RSS indirection table is shared with VFs, so the number of RX queues used in the PF is limited to the number of VIs per VF.  This is almost entirely the work of Steve Hodgson, formerly shodgson@solarflare.com.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | qt202x_phy.c | s | 14K | 426 | Ben Hutchings | bhutchings@solarflare.com | 1336615854 |  | sfc: Implement module EEPROM access for SFE4002 and SFN4112F  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | falcon_xmac.c | s | 11K | 306 | Ben Hutchings | bhutchings@solarflare.com | 1327623046 |  | sfc: Merge efx_mac_operations into efx_nic_type  No NICs need to switch efx_mac_operations at run-time, and the MAC operations are fairly closely bound to NIC types.  Move efx_mac_operations::reconfigure to efx_nic_type::reconfigure_mac and efx_mac_operations::check_fault fo efx_nic_type::check_mac_fault. Change callers to call through efx->type or directly if the NIC type is known.  Remove efx_mac_operations::update_stats.  The implementations for Falcon used to fetch MAC statistics synchronously and this was used by efx_register_netdev() to clear statistics after running self-tests. However, it now only converts statistics that have already been fetched (and that only for Falcon), and the call from efx_register_netdev() has no effect.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
f | efx.c | s | 74K | 2387 | David S. Miller | davem@davemloft.net | 1337221057 |  | Merge git://git.kernel.org/pub/scm/linux/kernel/git/davem/net
f | mtd.c | s | 16K | 582 | Linus Torvalds | torvalds@linux-foundation.org | 1333153916 |  | 
f | nic.h | s | 12K | 335 | Ben Hutchings | bhutchings@solarflare.com | 1331057656 |  | sfc: Log the part number on probe  During probe of each port, read and log the part number from VPD. Remove the Falcon-specific board name lookup.  Initial version by Stuart Hodgson <smhodgson@solarflare.com>.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
