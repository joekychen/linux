<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › oki-semi › pch_gbe › pch_gbe.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>pch_gbe.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (C) 1999 - 2010 Intel Corporation.</span>
<span class="cm"> * Copyright (C) 2010 OKI SEMICONDUCTOR Co., LTD.</span>
<span class="cm"> *</span>
<span class="cm"> * This code was derived from the Intel e1000e Linux driver.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; version 2 of the License.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307, USA.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _PCH_GBE_H_</span>
<span class="cp">#define _PCH_GBE_H_</span>

<span class="cp">#define pr_fmt(fmt) KBUILD_MODNAME &quot;: &quot; fmt</span>

<span class="cp">#include &lt;linux/mii.h&gt;</span>
<span class="cp">#include &lt;linux/delay.h&gt;</span>
<span class="cp">#include &lt;linux/pci.h&gt;</span>
<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;linux/etherdevice.h&gt;</span>
<span class="cp">#include &lt;linux/ethtool.h&gt;</span>
<span class="cp">#include &lt;linux/vmalloc.h&gt;</span>
<span class="cp">#include &lt;net/ip.h&gt;</span>
<span class="cp">#include &lt;net/tcp.h&gt;</span>
<span class="cp">#include &lt;net/udp.h&gt;</span>

<span class="cm">/**</span>
<span class="cm"> * pch_gbe_regs_mac_adr - Structure holding values of mac address registers</span>
<span class="cm"> * @high	Denotes the 1st to 4th byte from the initial of MAC address</span>
<span class="cm"> * @low		Denotes the 5th to 6th byte from the initial of MAC address</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_regs_mac_adr</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">high</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">low</span><span class="p">;</span>
<span class="p">};</span>
<span class="cm">/**</span>
<span class="cm"> * pch_udc_regs - Structure holding values of MAC registers</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_regs</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">INT_ST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">INT_EN</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">MODE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RESET</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TCPIP_ACC</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">EX_LIST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">INT_ST_HOLD</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">PHY_INT_CTRL</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">MAC_RX_EN</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RX_FCTRL</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">PAUSE_REQ</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RX_MODE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_MODE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RX_FIFO_ST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_FIFO_ST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_FID</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_RESULT</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">PAUSE_PKT1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">PAUSE_PKT2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">PAUSE_PKT3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">PAUSE_PKT4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">PAUSE_PKT5</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserve</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">pch_gbe_regs_mac_adr</span> <span class="n">mac_adr</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">ADDR_MASK</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">MIIM</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">MAC_ADDR_LOAD</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RGMII_ST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RGMII_CTRL</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserve3</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">DMA_CTRL</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserve4</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">RX_DSC_BASE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RX_DSC_SIZE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RX_DSC_HW_P</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RX_DSC_HW_P_HLD</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">RX_DSC_SW_P</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserve5</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">TX_DSC_BASE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_DSC_SIZE</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_DSC_HW_P</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_DSC_HW_P_HLD</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_DSC_SW_P</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserve6</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">RX_DMA_ST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">TX_DMA_ST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserve7</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u32</span> <span class="n">WOL_ST</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">WOL_CTRL</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">WOL_ADDR_MASK</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/* Interrupt Status */</span>
<span class="cm">/* Interrupt Status Hold */</span>
<span class="cm">/* Interrupt Enable */</span>
<span class="cp">#define PCH_GBE_INT_RX_DMA_CMPLT  0x00000001 </span><span class="cm">/* Receive DMA Transfer Complete */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_RX_VALID      0x00000002 </span><span class="cm">/* MAC Normal Receive Complete */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_RX_FRAME_ERR  0x00000004 </span><span class="cm">/* Receive frame error */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_RX_FIFO_ERR   0x00000008 </span><span class="cm">/* Receive FIFO Overflow */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_RX_DMA_ERR    0x00000010 </span><span class="cm">/* Receive DMA Transfer Error */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_RX_DSC_EMP    0x00000020 </span><span class="cm">/* Receive Descriptor Empty */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_TX_CMPLT      0x00000100 </span><span class="cm">/* MAC Transmission Complete */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_TX_DMA_CMPLT  0x00000200 </span><span class="cm">/* DMA Transfer Complete */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_TX_FIFO_ERR   0x00000400 </span><span class="cm">/* Transmission FIFO underflow. */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_TX_DMA_ERR    0x00000800 </span><span class="cm">/* Transmission DMA Error */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_PAUSE_CMPLT   0x00001000 </span><span class="cm">/* Pause Transmission complete */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_MIIM_CMPLT    0x00010000 </span><span class="cm">/* MIIM I/F Read completion */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_PHY_INT       0x00100000 </span><span class="cm">/* Interruption from PHY */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_WOL_DET       0x01000000 </span><span class="cm">/* Wake On LAN Event detection. */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_INT_TCPIP_ERR     0x10000000 </span><span class="cm">/* TCP/IP Accelerator Error */</span><span class="cp"></span>

<span class="cm">/* Mode */</span>
<span class="cp">#define PCH_GBE_MODE_MII_ETHER      0x00000000  </span><span class="cm">/* GIGA Ethernet Mode [MII] */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_MODE_GMII_ETHER     0x80000000  </span><span class="cm">/* GIGA Ethernet Mode [GMII] */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_MODE_HALF_DUPLEX    0x00000000  </span><span class="cm">/* Duplex Mode [half duplex] */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_MODE_FULL_DUPLEX    0x40000000  </span><span class="cm">/* Duplex Mode [full duplex] */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_MODE_FR_BST         0x04000000  </span><span class="cm">/* Frame bursting is done */</span><span class="cp"></span>

<span class="cm">/* Reset */</span>
<span class="cp">#define PCH_GBE_ALL_RST         0x80000000  </span><span class="cm">/* All reset */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TX_RST          0x00008000  </span><span class="cm">/* TX MAC, TX FIFO, TX DMA reset */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RX_RST          0x00004000  </span><span class="cm">/* RX MAC, RX FIFO, RX DMA reset */</span><span class="cp"></span>

<span class="cm">/* TCP/IP Accelerator Control */</span>
<span class="cp">#define PCH_GBE_EX_LIST_EN      0x00000008  </span><span class="cm">/* External List Enable */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RX_TCPIPACC_OFF 0x00000004  </span><span class="cm">/* RX TCP/IP ACC Disabled */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TX_TCPIPACC_EN  0x00000002  </span><span class="cm">/* TX TCP/IP ACC Enable */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RX_TCPIPACC_EN  0x00000001  </span><span class="cm">/* RX TCP/IP ACC Enable */</span><span class="cp"></span>

<span class="cm">/* MAC RX Enable */</span>
<span class="cp">#define PCH_GBE_MRE_MAC_RX_EN   0x00000001      </span><span class="cm">/* MAC Receive Enable */</span><span class="cp"></span>

<span class="cm">/* RX Flow Control */</span>
<span class="cp">#define PCH_GBE_FL_CTRL_EN      0x80000000  </span><span class="cm">/* Pause packet is enabled */</span><span class="cp"></span>

<span class="cm">/* Pause Packet Request */</span>
<span class="cp">#define PCH_GBE_PS_PKT_RQ       0x80000000  </span><span class="cm">/* Pause packet Request */</span><span class="cp"></span>

<span class="cm">/* RX Mode */</span>
<span class="cp">#define PCH_GBE_ADD_FIL_EN      0x80000000  </span><span class="cm">/* Address Filtering Enable */</span><span class="cp"></span>
<span class="cm">/* Multicast Filtering Enable */</span>
<span class="cp">#define PCH_GBE_MLT_FIL_EN      0x40000000</span>
<span class="cm">/* Receive Almost Empty Threshold */</span>
<span class="cp">#define PCH_GBE_RH_ALM_EMP_4    0x00000000      </span><span class="cm">/* 4 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_ALM_EMP_8    0x00004000      </span><span class="cm">/* 8 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_ALM_EMP_16   0x00008000      </span><span class="cm">/* 16 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_ALM_EMP_32   0x0000C000      </span><span class="cm">/* 32 words */</span><span class="cp"></span>
<span class="cm">/* Receive Almost Full Threshold */</span>
<span class="cp">#define PCH_GBE_RH_ALM_FULL_4   0x00000000      </span><span class="cm">/* 4 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_ALM_FULL_8   0x00001000      </span><span class="cm">/* 8 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_ALM_FULL_16  0x00002000      </span><span class="cm">/* 16 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_ALM_FULL_32  0x00003000      </span><span class="cm">/* 32 words */</span><span class="cp"></span>
<span class="cm">/* RX FIFO Read Triger Threshold */</span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_4     0x00000000      </span><span class="cm">/* 4 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_8     0x00000200      </span><span class="cm">/* 8 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_16    0x00000400      </span><span class="cm">/* 16 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_32    0x00000600      </span><span class="cm">/* 32 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_64    0x00000800      </span><span class="cm">/* 64 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_128   0x00000A00      </span><span class="cm">/* 128 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_256   0x00000C00      </span><span class="cm">/* 256 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RH_RD_TRG_512   0x00000E00      </span><span class="cm">/* 512 words */</span><span class="cp"></span>

<span class="cm">/* Receive Descriptor bit definitions */</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_BCAST          0x00000400</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_MCAST          0x00000200</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_UCAST          0x00000100</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_TCPIPOK        0x000000C0</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_IPOK           0x00000080</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_TCPOK          0x00000040</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_IP6ERR         0x00000020</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_OFLIST         0x00000010</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_TYPEIP         0x00000008</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_MACL           0x00000004</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_PPPOE          0x00000002</span>
<span class="cp">#define PCH_GBE_RXD_ACC_STAT_VTAGT          0x00000001</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_PAUSE         0x0200</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_MARBR         0x0100</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_MARMLT        0x0080</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_MARIND        0x0040</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_MARNOTMT      0x0020</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_TLONG         0x0010</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_TSHRT         0x0008</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_NOTOCTAL      0x0004</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_NBLERR        0x0002</span>
<span class="cp">#define PCH_GBE_RXD_GMAC_STAT_CRCERR        0x0001</span>

<span class="cm">/* Transmit Descriptor bit definitions */</span>
<span class="cp">#define PCH_GBE_TXD_CTRL_TCPIP_ACC_OFF      0x0008</span>
<span class="cp">#define PCH_GBE_TXD_CTRL_ITAG               0x0004</span>
<span class="cp">#define PCH_GBE_TXD_CTRL_ICRC               0x0002</span>
<span class="cp">#define PCH_GBE_TXD_CTRL_APAD               0x0001</span>
<span class="cp">#define PCH_GBE_TXD_WORDS_SHIFT             2</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_CMPLT         0x2000</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_ABT           0x1000</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_EXCOL         0x0800</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_SNGCOL        0x0400</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_MLTCOL        0x0200</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_CRSER         0x0100</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_TLNG          0x0080</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_TSHRT         0x0040</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_LTCOL         0x0020</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_TFUNDFLW      0x0010</span>
<span class="cp">#define PCH_GBE_TXD_GMAC_STAT_RTYCNT_MASK   0x000F</span>

<span class="cm">/* TX Mode */</span>
<span class="cp">#define PCH_GBE_TM_NO_RTRY     0x80000000 </span><span class="cm">/* No Retransmission */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_LONG_PKT    0x40000000 </span><span class="cm">/* Long Packt TX Enable */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_ST_AND_FD   0x20000000 </span><span class="cm">/* Stare and Forward */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_SHORT_PKT   0x10000000 </span><span class="cm">/* Short Packet TX Enable */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_LTCOL_RETX  0x08000000 </span><span class="cm">/* Retransmission at Late Collision */</span><span class="cp"></span>
<span class="cm">/* Frame Start Threshold */</span>
<span class="cp">#define PCH_GBE_TM_TH_TX_STRT_4    0x00000000    </span><span class="cm">/* 4 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_TX_STRT_8    0x00004000    </span><span class="cm">/* 8 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_TX_STRT_16   0x00008000    </span><span class="cm">/* 16 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_TX_STRT_32   0x0000C000    </span><span class="cm">/* 32 words */</span><span class="cp"></span>
<span class="cm">/* Transmit Almost Empty Threshold */</span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_4    0x00000000    </span><span class="cm">/* 4 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_8    0x00000800    </span><span class="cm">/* 8 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_16   0x00001000    </span><span class="cm">/* 16 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_32   0x00001800    </span><span class="cm">/* 32 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_64   0x00002000    </span><span class="cm">/* 64 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_128  0x00002800    </span><span class="cm">/* 128 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_256  0x00003000    </span><span class="cm">/* 256 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_EMP_512  0x00003800    </span><span class="cm">/* 512 words */</span><span class="cp"></span>
<span class="cm">/* Transmit Almost Full Threshold */</span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_FULL_4   0x00000000    </span><span class="cm">/* 4 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_FULL_8   0x00000200    </span><span class="cm">/* 8 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_FULL_16  0x00000400    </span><span class="cm">/* 16 words */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TM_TH_ALM_FULL_32  0x00000600    </span><span class="cm">/* 32 words */</span><span class="cp"></span>

<span class="cm">/* RX FIFO Status */</span>
<span class="cp">#define PCH_GBE_RF_ALM_FULL     0x80000000  </span><span class="cm">/* RX FIFO is almost full. */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RF_ALM_EMP      0x40000000  </span><span class="cm">/* RX FIFO is almost empty. */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RF_RD_TRG       0x20000000  </span><span class="cm">/* Become more than RH_RD_TRG. */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RF_STRWD        0x1FFE0000  </span><span class="cm">/* The word count of RX FIFO. */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RF_RCVING       0x00010000  </span><span class="cm">/* Stored in RX FIFO. */</span><span class="cp"></span>

<span class="cm">/* MAC Address Mask */</span>
<span class="cp">#define PCH_GBE_BUSY                0x80000000</span>

<span class="cm">/* MIIM  */</span>
<span class="cp">#define PCH_GBE_MIIM_OPER_WRITE     0x04000000</span>
<span class="cp">#define PCH_GBE_MIIM_OPER_READ      0x00000000</span>
<span class="cp">#define PCH_GBE_MIIM_OPER_READY     0x04000000</span>
<span class="cp">#define PCH_GBE_MIIM_PHY_ADDR_SHIFT 21</span>
<span class="cp">#define PCH_GBE_MIIM_REG_ADDR_SHIFT 16</span>

<span class="cm">/* RGMII Status */</span>
<span class="cp">#define PCH_GBE_LINK_UP             0x80000008</span>
<span class="cp">#define PCH_GBE_RXC_SPEED_MSK       0x00000006</span>
<span class="cp">#define PCH_GBE_RXC_SPEED_2_5M      0x00000000    </span><span class="cm">/* 2.5MHz */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RXC_SPEED_25M       0x00000002    </span><span class="cm">/* 25MHz  */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_RXC_SPEED_125M      0x00000004    </span><span class="cm">/* 100MHz */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_DUPLEX_FULL         0x00000001</span>

<span class="cm">/* RGMII Control */</span>
<span class="cp">#define PCH_GBE_CRS_SEL             0x00000010</span>
<span class="cp">#define PCH_GBE_RGMII_RATE_125M     0x00000000</span>
<span class="cp">#define PCH_GBE_RGMII_RATE_25M      0x00000008</span>
<span class="cp">#define PCH_GBE_RGMII_RATE_2_5M     0x0000000C</span>
<span class="cp">#define PCH_GBE_RGMII_MODE_GMII     0x00000000</span>
<span class="cp">#define PCH_GBE_RGMII_MODE_RGMII    0x00000002</span>
<span class="cp">#define PCH_GBE_CHIP_TYPE_EXTERNAL  0x00000000</span>
<span class="cp">#define PCH_GBE_CHIP_TYPE_INTERNAL  0x00000001</span>

<span class="cm">/* DMA Control */</span>
<span class="cp">#define PCH_GBE_RX_DMA_EN       0x00000002   </span><span class="cm">/* Enables Receive DMA */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_TX_DMA_EN       0x00000001   </span><span class="cm">/* Enables Transmission DMA */</span><span class="cp"></span>

<span class="cm">/* RX DMA STATUS */</span>
<span class="cp">#define PCH_GBE_IDLE_CHECK       0xFFFFFFFE</span>

<span class="cm">/* Wake On LAN Status */</span>
<span class="cp">#define PCH_GBE_WLS_BR          0x00000008 </span><span class="cm">/* Broadcas Address */</span><span class="cp"></span>
<span class="cp">#define PCH_GBE_WLS_MLT         0x00000004 </span><span class="cm">/* Multicast Address */</span><span class="cp"></span>

<span class="cm">/* The Frame registered in Address Recognizer */</span>
<span class="cp">#define PCH_GBE_WLS_IND         0x00000002</span>
<span class="cp">#define PCH_GBE_WLS_MP          0x00000001 </span><span class="cm">/* Magic packet Address */</span><span class="cp"></span>

<span class="cm">/* Wake On LAN Control */</span>
<span class="cp">#define PCH_GBE_WLC_WOL_MODE    0x00010000</span>
<span class="cp">#define PCH_GBE_WLC_IGN_TLONG   0x00000100</span>
<span class="cp">#define PCH_GBE_WLC_IGN_TSHRT   0x00000080</span>
<span class="cp">#define PCH_GBE_WLC_IGN_OCTER   0x00000040</span>
<span class="cp">#define PCH_GBE_WLC_IGN_NBLER   0x00000020</span>
<span class="cp">#define PCH_GBE_WLC_IGN_CRCER   0x00000010</span>
<span class="cp">#define PCH_GBE_WLC_BR          0x00000008</span>
<span class="cp">#define PCH_GBE_WLC_MLT         0x00000004</span>
<span class="cp">#define PCH_GBE_WLC_IND         0x00000002</span>
<span class="cp">#define PCH_GBE_WLC_MP          0x00000001</span>

<span class="cm">/* Wake On LAN Address Mask */</span>
<span class="cp">#define PCH_GBE_WLA_BUSY        0x80000000</span>



<span class="cm">/* TX/RX descriptor defines */</span>
<span class="cp">#define PCH_GBE_MAX_TXD                     4096</span>
<span class="cp">#define PCH_GBE_DEFAULT_TXD                  256</span>
<span class="cp">#define PCH_GBE_MIN_TXD                        8</span>
<span class="cp">#define PCH_GBE_MAX_RXD                     4096</span>
<span class="cp">#define PCH_GBE_DEFAULT_RXD                  256</span>
<span class="cp">#define PCH_GBE_MIN_RXD                        8</span>

<span class="cm">/* Number of Transmit and Receive Descriptors must be a multiple of 8 */</span>
<span class="cp">#define PCH_GBE_TX_DESC_MULTIPLE               8</span>
<span class="cp">#define PCH_GBE_RX_DESC_MULTIPLE               8</span>

<span class="cm">/* Read/Write operation is done through MII Management IF */</span>
<span class="cp">#define PCH_GBE_HAL_MIIM_READ          ((u32)0x00000000)</span>
<span class="cp">#define PCH_GBE_HAL_MIIM_WRITE         ((u32)0x04000000)</span>

<span class="cm">/* flow control values */</span>
<span class="cp">#define PCH_GBE_FC_NONE			0</span>
<span class="cp">#define PCH_GBE_FC_RX_PAUSE		1</span>
<span class="cp">#define PCH_GBE_FC_TX_PAUSE		2</span>
<span class="cp">#define PCH_GBE_FC_FULL			3</span>
<span class="cp">#define PCH_GBE_FC_DEFAULT		PCH_GBE_FC_FULL</span>


<span class="k">struct</span> <span class="n">pch_gbe_hw</span><span class="p">;</span>
<span class="cm">/**</span>
<span class="cm"> * struct  pch_gbe_functions - HAL APi function pointer</span>
<span class="cm"> * @get_bus_info:	for pch_gbe_hal_get_bus_info</span>
<span class="cm"> * @init_hw:		for pch_gbe_hal_init_hw</span>
<span class="cm"> * @read_phy_reg:	for pch_gbe_hal_read_phy_reg</span>
<span class="cm"> * @write_phy_reg:	for pch_gbe_hal_write_phy_reg</span>
<span class="cm"> * @reset_phy:		for pch_gbe_hal_phy_hw_reset</span>
<span class="cm"> * @sw_reset_phy:	for pch_gbe_hal_phy_sw_reset</span>
<span class="cm"> * @power_up_phy:	for pch_gbe_hal_power_up_phy</span>
<span class="cm"> * @power_down_phy:	for pch_gbe_hal_power_down_phy</span>
<span class="cm"> * @read_mac_addr:	for pch_gbe_hal_read_mac_addr</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_functions</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">get_bus_info</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="p">);</span>
	<span class="n">s32</span> <span class="p">(</span><span class="o">*</span><span class="n">init_hw</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="p">);</span>
	<span class="n">s32</span> <span class="p">(</span><span class="o">*</span><span class="n">read_phy_reg</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="p">,</span> <span class="n">u32</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="p">);</span>
	<span class="n">s32</span> <span class="p">(</span><span class="o">*</span><span class="n">write_phy_reg</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="p">,</span> <span class="n">u32</span><span class="p">,</span> <span class="n">u16</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">reset_phy</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">sw_reset_phy</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">power_up_phy</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">power_down_phy</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
	<span class="n">s32</span> <span class="p">(</span><span class="o">*</span><span class="n">read_mac_addr</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_mac_info - MAC information</span>
<span class="cm"> * @addr[6]:		Store the MAC address</span>
<span class="cm"> * @fc:			Mode of flow control</span>
<span class="cm"> * @fc_autoneg:		Auto negotiation enable for flow control setting</span>
<span class="cm"> * @tx_fc_enable:	Enable flag of Transmit flow control</span>
<span class="cm"> * @max_frame_size:	Max transmit frame size</span>
<span class="cm"> * @min_frame_size:	Min transmit frame size</span>
<span class="cm"> * @autoneg:		Auto negotiation enable</span>
<span class="cm"> * @link_speed:		Link speed</span>
<span class="cm"> * @link_duplex:	Link duplex</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_mac_info</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">addr</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">fc</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">fc_autoneg</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tx_fc_enable</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">max_frame_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">min_frame_size</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">autoneg</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">link_speed</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">link_duplex</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_phy_info - PHY information</span>
<span class="cm"> * @addr:		PHY address</span>
<span class="cm"> * @id:			PHY&#39;s identifier</span>
<span class="cm"> * @revision:		PHY&#39;s revision</span>
<span class="cm"> * @reset_delay_us:	HW reset delay time[us]</span>
<span class="cm"> * @autoneg_advertised:	Autoneg advertised</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_phy_info</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">addr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">revision</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reset_delay_us</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">autoneg_advertised</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*!</span>
<span class="cm"> * @ingroup Gigabit Ether driver Layer</span>
<span class="cm"> * @struct  pch_gbe_bus_info</span>
<span class="cm"> * @brief   Bus information</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_bus_info</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">speed</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">width</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*!</span>
<span class="cm"> * @ingroup Gigabit Ether driver Layer</span>
<span class="cm"> * @struct  pch_gbe_hw</span>
<span class="cm"> * @brief   Hardware information</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">back</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">pch_gbe_regs</span>  <span class="n">__iomem</span> <span class="o">*</span><span class="n">reg</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">miim_lock</span><span class="p">;</span>

	<span class="k">const</span> <span class="k">struct</span> <span class="n">pch_gbe_functions</span> <span class="o">*</span><span class="n">func</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_mac_info</span> <span class="n">mac</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_phy_info</span> <span class="n">phy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_bus_info</span> <span class="n">bus</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_rx_desc - Receive Descriptor</span>
<span class="cm"> * @buffer_addr:	RX Frame Buffer Address</span>
<span class="cm"> * @tcp_ip_status:	TCP/IP Accelerator Status</span>
<span class="cm"> * @rx_words_eob:	RX word count and Byte position</span>
<span class="cm"> * @gbec_status:	GMAC Status</span>
<span class="cm"> * @dma_status:		DMA Status</span>
<span class="cm"> * @reserved1:		Reserved</span>
<span class="cm"> * @reserved2:		Reserved</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_rx_desc</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">buffer_addr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tcp_ip_status</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">rx_words_eob</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">gbec_status</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dma_status</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">reserved2</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_tx_desc - Transmit Descriptor</span>
<span class="cm"> * @buffer_addr:	TX Frame Buffer Address</span>
<span class="cm"> * @length:		Data buffer length</span>
<span class="cm"> * @reserved1:		Reserved</span>
<span class="cm"> * @tx_words_eob:	TX word count and Byte position</span>
<span class="cm"> * @tx_frame_ctrl:	TX Frame Control</span>
<span class="cm"> * @dma_status:		DMA Status</span>
<span class="cm"> * @reserved2:		Reserved</span>
<span class="cm"> * @gbec_status:	GMAC Status</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_tx_desc</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">buffer_addr</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">reserved1</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">tx_words_eob</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">tx_frame_ctrl</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dma_status</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved2</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">gbec_status</span><span class="p">;</span>
<span class="p">};</span>


<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_buffer - Buffer information</span>
<span class="cm"> * @skb:	pointer to a socket buffer</span>
<span class="cm"> * @dma:	DMA address</span>
<span class="cm"> * @time_stamp:	time stamp</span>
<span class="cm"> * @length:	data size</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_buffer</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">dma</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">rx_buffer</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">time_stamp</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">length</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">mapped</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_tx_ring - tx ring information</span>
<span class="cm"> * @tx_lock:	spinlock structs</span>
<span class="cm"> * @desc:	pointer to the descriptor ring memory</span>
<span class="cm"> * @dma:	physical address of the descriptor ring</span>
<span class="cm"> * @size:	length of descriptor ring in bytes</span>
<span class="cm"> * @count:	number of descriptors in the ring</span>
<span class="cm"> * @next_to_use:	next descriptor to associate a buffer with</span>
<span class="cm"> * @next_to_clean:	next descriptor to check for DD status bit</span>
<span class="cm"> * @buffer_info:	array of buffer information structs</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_tx_ring</span> <span class="p">{</span>
	<span class="n">spinlock_t</span> <span class="n">tx_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_tx_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">dma</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">next_to_use</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">next_to_clean</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_buffer</span> <span class="o">*</span><span class="n">buffer_info</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_rx_ring - rx ring information</span>
<span class="cm"> * @desc:	pointer to the descriptor ring memory</span>
<span class="cm"> * @dma:	physical address of the descriptor ring</span>
<span class="cm"> * @size:	length of descriptor ring in bytes</span>
<span class="cm"> * @count:	number of descriptors in the ring</span>
<span class="cm"> * @next_to_use:	next descriptor to associate a buffer with</span>
<span class="cm"> * @next_to_clean:	next descriptor to check for DD status bit</span>
<span class="cm"> * @buffer_info:	array of buffer information structs</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_rx_ring</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">pch_gbe_rx_desc</span> <span class="o">*</span><span class="n">desc</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">dma</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">char</span> <span class="o">*</span><span class="n">rx_buff_pool</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">rx_buff_pool_logic</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rx_buff_pool_size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">size</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">count</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">next_to_use</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">next_to_clean</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_buffer</span> <span class="o">*</span><span class="n">buffer_info</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_hw_stats - Statistics counters collected by the MAC</span>
<span class="cm"> * @rx_packets:		    total packets received</span>
<span class="cm"> * @tx_packets:		    total packets transmitted</span>
<span class="cm"> * @rx_bytes:		    total bytes received</span>
<span class="cm"> * @tx_bytes:		    total bytes transmitted</span>
<span class="cm"> * @rx_errors:		    bad packets received</span>
<span class="cm"> * @tx_errors:		    packet transmit problems</span>
<span class="cm"> * @rx_dropped:		    no space in Linux buffers</span>
<span class="cm"> * @tx_dropped:		    no space available in Linux</span>
<span class="cm"> * @multicast:		    multicast packets received</span>
<span class="cm"> * @collisions:		    collisions</span>
<span class="cm"> * @rx_crc_errors:	    received packet with crc error</span>
<span class="cm"> * @rx_frame_errors:	    received frame alignment error</span>
<span class="cm"> * @rx_alloc_buff_failed:   allocate failure of a receive buffer</span>
<span class="cm"> * @tx_length_errors:	    transmit length error</span>
<span class="cm"> * @tx_aborted_errors:	    transmit aborted error</span>
<span class="cm"> * @tx_carrier_errors:	    transmit carrier error</span>
<span class="cm"> * @tx_timeout_count:	    Number of transmit timeout</span>
<span class="cm"> * @tx_restart_count:	    Number of transmit restert</span>
<span class="cm"> * @intr_rx_dsc_empty_count:	Interrupt count of receive descriptor empty</span>
<span class="cm"> * @intr_rx_frame_err_count:	Interrupt count of receive frame error</span>
<span class="cm"> * @intr_rx_fifo_err_count:	Interrupt count of receive FIFO error</span>
<span class="cm"> * @intr_rx_dma_err_count:	Interrupt count of receive DMA error</span>
<span class="cm"> * @intr_tx_fifo_err_count:	Interrupt count of transmit FIFO error</span>
<span class="cm"> * @intr_tx_dma_err_count:	Interrupt count of transmit DMA error</span>
<span class="cm"> * @intr_tcpip_err_count:	Interrupt count of TCP/IP Accelerator</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">pch_gbe_hw_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">rx_packets</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_packets</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_bytes</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_bytes</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_errors</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_errors</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_dropped</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_dropped</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">multicast</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">collisions</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_crc_errors</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_frame_errors</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_alloc_buff_failed</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_length_errors</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_aborted_errors</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_carrier_errors</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_timeout_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_restart_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intr_rx_dsc_empty_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intr_rx_frame_err_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intr_rx_fifo_err_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intr_rx_dma_err_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intr_tx_fifo_err_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intr_tx_dma_err_count</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">intr_tcpip_err_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct pch_gbe_adapter - board specific private data structure</span>
<span class="cm"> * @stats_lock:	Spinlock structure for status</span>
<span class="cm"> * @ethtool_lock:	Spinlock structure for ethtool</span>
<span class="cm"> * @irq_sem:		Semaphore for interrupt</span>
<span class="cm"> * @netdev:		Pointer of network device structure</span>
<span class="cm"> * @pdev:		Pointer of pci device structure</span>
<span class="cm"> * @polling_netdev:	Pointer of polling network device structure</span>
<span class="cm"> * @napi:		NAPI structure</span>
<span class="cm"> * @hw:			Pointer of hardware structure</span>
<span class="cm"> * @stats:		Hardware status</span>
<span class="cm"> * @reset_task:		Reset task</span>
<span class="cm"> * @mii:		MII information structure</span>
<span class="cm"> * @watchdog_timer:	Watchdog timer list</span>
<span class="cm"> * @wake_up_evt:	Wake up event</span>
<span class="cm"> * @config_space:	Configuration space</span>
<span class="cm"> * @msg_enable:		Driver message level</span>
<span class="cm"> * @led_status:		LED status</span>
<span class="cm"> * @tx_ring:		Pointer of Tx descriptor ring structure</span>
<span class="cm"> * @rx_ring:		Pointer of Rx descriptor ring structure</span>
<span class="cm"> * @rx_buffer_len:	Receive buffer length</span>
<span class="cm"> * @tx_queue_len:	Transmit queue length</span>
<span class="cm"> * @have_msi:		PCI MSI mode flag</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="p">{</span>
	<span class="n">spinlock_t</span> <span class="n">stats_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">ethtool_lock</span><span class="p">;</span>
	<span class="n">atomic_t</span> <span class="n">irq_sem</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">netdev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">polling_netdev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">napi_struct</span> <span class="n">napi</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="n">hw</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_hw_stats</span> <span class="n">stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">reset_task</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mii_if_info</span> <span class="n">mii</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">watchdog_timer</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">wake_up_evt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">config_space</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">led_status</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_tx_ring</span> <span class="o">*</span><span class="n">tx_ring</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pch_gbe_rx_ring</span> <span class="o">*</span><span class="n">rx_ring</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">rx_buffer_len</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tx_queue_len</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">have_msi</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">rx_stop_flag</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">hwts_tx_en</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">hwts_rx_en</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">ptp_pdev</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="n">pch_driver_version</span><span class="p">[];</span>

<span class="cm">/* pch_gbe_main.c */</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">pch_gbe_up</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_down</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_reinit_locked</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">pch_gbe_setup_tx_resources</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">pch_gbe_tx_ring</span> <span class="o">*</span><span class="n">txdr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">pch_gbe_setup_rx_resources</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">pch_gbe_rx_ring</span> <span class="o">*</span><span class="n">rxdr</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_free_tx_resources</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">pch_gbe_tx_ring</span> <span class="o">*</span><span class="n">tx_ring</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_free_rx_resources</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span>
				       <span class="k">struct</span> <span class="n">pch_gbe_rx_ring</span> <span class="o">*</span><span class="n">rx_ring</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_update_stats</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_PCH_PTP</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">pch_ch_control_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_ch_control_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">,</span> <span class="n">u32</span> <span class="n">val</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">pch_ch_event_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_ch_event_write</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">,</span> <span class="n">u32</span> <span class="n">val</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">pch_src_uuid_lo_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">pch_src_uuid_hi_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">pch_rx_snap_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u64</span> <span class="n">pch_tx_snap_read</span><span class="p">(</span><span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">pch_set_station_address</span><span class="p">(</span><span class="n">u8</span> <span class="o">*</span><span class="n">addr</span><span class="p">,</span> <span class="k">struct</span> <span class="n">pci_dev</span> <span class="o">*</span><span class="n">pdev</span><span class="p">);</span>
<span class="cp">#endif</span>

<span class="cm">/* pch_gbe_param.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_check_options</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">);</span>

<span class="cm">/* pch_gbe_ethtool.c */</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">pch_gbe_set_ethtool_ops</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">netdev</span><span class="p">);</span>

<span class="cm">/* pch_gbe_mac.c */</span>
<span class="k">extern</span> <span class="n">s32</span> <span class="n">pch_gbe_mac_force_mac_fc</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">s32</span> <span class="n">pch_gbe_mac_read_mac_addr</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
<span class="k">extern</span> <span class="n">u16</span> <span class="n">pch_gbe_mac_ctrl_miim</span><span class="p">(</span><span class="k">struct</span> <span class="n">pch_gbe_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">,</span>
				  <span class="n">u32</span> <span class="n">addr</span><span class="p">,</span> <span class="n">u32</span> <span class="n">dir</span><span class="p">,</span> <span class="n">u32</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u16</span> <span class="n">data</span><span class="p">);</span>
<span class="cp">#endif </span><span class="cm">/* _PCH_GBE_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
