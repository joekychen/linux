<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › apple › mace.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>mace.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * mace.h - definitions for the registers in the Am79C940 MACE</span>
<span class="cm"> * (Medium Access Control for Ethernet) controller.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1996 Paul Mackerras.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or</span>
<span class="cm"> * modify it under the terms of the GNU General Public License</span>
<span class="cm"> * as published by the Free Software Foundation; either version</span>
<span class="cm"> * 2 of the License, or (at your option) any later version.</span>
<span class="cm"> */</span>

<span class="cp">#define REG(x)	volatile unsigned char x; char x ## _pad[15]</span>

<span class="k">struct</span> <span class="n">mace</span> <span class="p">{</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">rcvfifo</span><span class="p">);</span>		<span class="cm">/* receive FIFO */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">xmtfifo</span><span class="p">);</span>		<span class="cm">/* transmit FIFO */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">xmtfc</span><span class="p">);</span>		<span class="cm">/* transmit frame control */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">xmtfs</span><span class="p">);</span>		<span class="cm">/* transmit frame status */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">xmtrc</span><span class="p">);</span>		<span class="cm">/* transmit retry count */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">rcvfc</span><span class="p">);</span>		<span class="cm">/* receive frame control */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">rcvfs</span><span class="p">);</span>		<span class="cm">/* receive frame status (4 bytes) */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">fifofc</span><span class="p">);</span>		<span class="cm">/* FIFO frame count */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">ir</span><span class="p">);</span>		<span class="cm">/* interrupt register */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">imr</span><span class="p">);</span>		<span class="cm">/* interrupt mask register */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">pr</span><span class="p">);</span>		<span class="cm">/* poll register */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">biucc</span><span class="p">);</span>		<span class="cm">/* bus interface unit config control */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">fifocc</span><span class="p">);</span>		<span class="cm">/* FIFO configuration control */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">maccc</span><span class="p">);</span>		<span class="cm">/* medium access control config control */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">plscc</span><span class="p">);</span>		<span class="cm">/* phys layer signalling config control */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">phycc</span><span class="p">);</span>		<span class="cm">/* physical configuration control */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">chipid_lo</span><span class="p">);</span>		<span class="cm">/* chip ID, lsb */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">chipid_hi</span><span class="p">);</span>		<span class="cm">/* chip ID, msb */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">iac</span><span class="p">);</span>		<span class="cm">/* internal address config */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">reg19</span><span class="p">);</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">ladrf</span><span class="p">);</span>		<span class="cm">/* logical address filter (8 bytes) */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">padr</span><span class="p">);</span>		<span class="cm">/* physical address (6 bytes) */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">reg22</span><span class="p">);</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">reg23</span><span class="p">);</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">mpc</span><span class="p">);</span>		<span class="cm">/* missed packet count (clears when read) */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">reg25</span><span class="p">);</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">rntpc</span><span class="p">);</span>		<span class="cm">/* runt packet count (clears when read) */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">rcvcc</span><span class="p">);</span>		<span class="cm">/* recv collision count (clears when read) */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">reg28</span><span class="p">);</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">utr</span><span class="p">);</span>		<span class="cm">/* user test reg */</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">reg30</span><span class="p">);</span>
	<span class="n">REG</span><span class="p">(</span><span class="n">reg31</span><span class="p">);</span>
<span class="p">};</span>

<span class="cm">/* Bits in XMTFC */</span>
<span class="cp">#define DRTRY		0x80	</span><span class="cm">/* don&#39;t retry transmission after collision */</span><span class="cp"></span>
<span class="cp">#define DXMTFCS		0x08	</span><span class="cm">/* don&#39;t append FCS to transmitted frame */</span><span class="cp"></span>
<span class="cp">#define AUTO_PAD_XMIT	0x01	</span><span class="cm">/* auto-pad short packets on transmission */</span><span class="cp"></span>

<span class="cm">/* Bits in XMTFS: only valid when XMTSV is set in PR and XMTFS */</span>
<span class="cp">#define XMTSV		0x80	</span><span class="cm">/* transmit status (i.e. XMTFS) valid */</span><span class="cp"></span>
<span class="cp">#define UFLO		0x40	</span><span class="cm">/* underflow - xmit fifo ran dry */</span><span class="cp"></span>
<span class="cp">#define LCOL		0x20	</span><span class="cm">/* late collision (transmission aborted) */</span><span class="cp"></span>
<span class="cp">#define MORE		0x10	</span><span class="cm">/* 2 or more retries needed to xmit frame */</span><span class="cp"></span>
<span class="cp">#define ONE		0x08	</span><span class="cm">/* 1 retry needed to xmit frame */</span><span class="cp"></span>
<span class="cp">#define DEFER		0x04	</span><span class="cm">/* MACE had to defer xmission (enet busy) */</span><span class="cp"></span>
<span class="cp">#define LCAR		0x02	</span><span class="cm">/* loss of carrier (transmission aborted) */</span><span class="cp"></span>
<span class="cp">#define RTRY		0x01	</span><span class="cm">/* too many retries (transmission aborted) */</span><span class="cp"></span>

<span class="cm">/* Bits in XMTRC: only valid when XMTSV is set in PR (and XMTFS) */</span>
<span class="cp">#define EXDEF		0x80	</span><span class="cm">/* had to defer for excessive time */</span><span class="cp"></span>
<span class="cp">#define RETRY_MASK	0x0f	</span><span class="cm">/* number of retries (0 - 15) */</span><span class="cp"></span>

<span class="cm">/* Bits in RCVFC */</span>
<span class="cp">#define LLRCV		0x08	</span><span class="cm">/* low latency receive: early DMA request */</span><span class="cp"></span>
<span class="cp">#define M_RBAR		0x04	</span><span class="cm">/* sets function of EAM/R pin */</span><span class="cp"></span>
<span class="cp">#define AUTO_STRIP_RCV	0x01	</span><span class="cm">/* auto-strip short LLC frames on recv */</span><span class="cp"></span>

<span class="cm">/*</span>
<span class="cm"> * Bits in RCVFS.  After a frame is received, four bytes of status</span>
<span class="cm"> * are automatically read from this register and appended to the frame</span>
<span class="cm"> * data in memory.  These are:</span>
<span class="cm"> * Byte 0 and 1: message byte count and frame status</span>
<span class="cm"> * Byte 2: runt packet count</span>
<span class="cm"> * Byte 3: receive collision count</span>
<span class="cm"> */</span>
<span class="cp">#define RS_OFLO		0x8000	</span><span class="cm">/* receive FIFO overflowed */</span><span class="cp"></span>
<span class="cp">#define RS_CLSN		0x4000	</span><span class="cm">/* received frame suffered (late) collision */</span><span class="cp"></span>
<span class="cp">#define RS_FRAMERR	0x2000	</span><span class="cm">/* framing error flag */</span><span class="cp"></span>
<span class="cp">#define RS_FCSERR	0x1000	</span><span class="cm">/* frame had FCS error */</span><span class="cp"></span>
<span class="cp">#define RS_COUNT	0x0fff	</span><span class="cm">/* mask for byte count field */</span><span class="cp"></span>

<span class="cm">/* Bits (fields) in FIFOFC */</span>
<span class="cp">#define RCVFC_SH	4	</span><span class="cm">/* receive frame count in FIFO */</span><span class="cp"></span>
<span class="cp">#define RCVFC_MASK	0x0f</span>
<span class="cp">#define XMTFC_SH	0	</span><span class="cm">/* transmit frame count in FIFO */</span><span class="cp"></span>
<span class="cp">#define XMTFC_MASK	0x0f</span>

<span class="cm">/*</span>
<span class="cm"> * Bits in IR and IMR.  The IR clears itself when read.</span>
<span class="cm"> * Setting a bit in the IMR will disable the corresponding interrupt.</span>
<span class="cm"> */</span>
<span class="cp">#define JABBER		0x80	</span><span class="cm">/* jabber error - 10baseT xmission too long */</span><span class="cp"></span>
<span class="cp">#define BABBLE		0x40	</span><span class="cm">/* babble - xmitter xmitting for too long */</span><span class="cp"></span>
<span class="cp">#define CERR		0x20	</span><span class="cm">/* collision err - no SQE test (heartbeat) */</span><span class="cp"></span>
<span class="cp">#define RCVCCO		0x10	</span><span class="cm">/* RCVCC overflow */</span><span class="cp"></span>
<span class="cp">#define RNTPCO		0x08	</span><span class="cm">/* RNTPC overflow */</span><span class="cp"></span>
<span class="cp">#define MPCO		0x04	</span><span class="cm">/* MPC overflow */</span><span class="cp"></span>
<span class="cp">#define RCVINT		0x02	</span><span class="cm">/* receive interrupt */</span><span class="cp"></span>
<span class="cp">#define XMTINT		0x01	</span><span class="cm">/* transmitter interrupt */</span><span class="cp"></span>

<span class="cm">/* Bits in PR */</span>
<span class="cp">#define XMTSV		0x80	</span><span class="cm">/* XMTFS valid (same as in XMTFS) */</span><span class="cp"></span>
<span class="cp">#define TDTREQ		0x40	</span><span class="cm">/* set when xmit fifo is requesting data */</span><span class="cp"></span>
<span class="cp">#define RDTREQ		0x20	</span><span class="cm">/* set when recv fifo requests data xfer */</span><span class="cp"></span>

<span class="cm">/* Bits in BIUCC */</span>
<span class="cp">#define BSWP		0x40	</span><span class="cm">/* byte swap, i.e. big-endian bus */</span><span class="cp"></span>
<span class="cp">#define XMTSP_4		0x00	</span><span class="cm">/* start xmitting when 4 bytes in FIFO */</span><span class="cp"></span>
<span class="cp">#define XMTSP_16	0x10	</span><span class="cm">/* start xmitting when 16 bytes in FIFO */</span><span class="cp"></span>
<span class="cp">#define XMTSP_64	0x20	</span><span class="cm">/* start xmitting when 64 bytes in FIFO */</span><span class="cp"></span>
<span class="cp">#define XMTSP_112	0x30	</span><span class="cm">/* start xmitting when 112 bytes in FIFO */</span><span class="cp"></span>
<span class="cp">#define SWRST		0x01	</span><span class="cm">/* software reset */</span><span class="cp"></span>

<span class="cm">/* Bits in FIFOCC */</span>
<span class="cp">#define XMTFW_8		0x00	</span><span class="cm">/* xmit fifo watermark = 8 words free */</span><span class="cp"></span>
<span class="cp">#define XMTFW_16	0x40	</span><span class="cm">/*  16 words free */</span><span class="cp"></span>
<span class="cp">#define XMTFW_32	0x80	</span><span class="cm">/*  32 words free */</span><span class="cp"></span>
<span class="cp">#define RCVFW_16	0x00	</span><span class="cm">/* recv fifo watermark = 16 bytes avail */</span><span class="cp"></span>
<span class="cp">#define RCVFW_32	0x10	</span><span class="cm">/*  32 bytes avail */</span><span class="cp"></span>
<span class="cp">#define RCVFW_64	0x20	</span><span class="cm">/*  64 bytes avail */</span><span class="cp"></span>
<span class="cp">#define XMTFWU		0x08	</span><span class="cm">/* xmit fifo watermark update enable */</span><span class="cp"></span>
<span class="cp">#define RCVFWU		0x04	</span><span class="cm">/* recv fifo watermark update enable */</span><span class="cp"></span>
<span class="cp">#define XMTBRST		0x02	</span><span class="cm">/* enable transmit burst mode */</span><span class="cp"></span>
<span class="cp">#define RCVBRST		0x01	</span><span class="cm">/* enable receive burst mode */</span><span class="cp"></span>

<span class="cm">/* Bits in MACCC */</span>
<span class="cp">#define PROM		0x80	</span><span class="cm">/* promiscuous mode */</span><span class="cp"></span>
<span class="cp">#define DXMT2PD		0x40	</span><span class="cm">/* disable xmit two-part deferral algorithm */</span><span class="cp"></span>
<span class="cp">#define EMBA		0x20	</span><span class="cm">/* enable modified backoff algorithm */</span><span class="cp"></span>
<span class="cp">#define DRCVPA		0x08	</span><span class="cm">/* disable receiving physical address */</span><span class="cp"></span>
<span class="cp">#define DRCVBC		0x04	</span><span class="cm">/* disable receiving broadcasts */</span><span class="cp"></span>
<span class="cp">#define ENXMT		0x02	</span><span class="cm">/* enable transmitter */</span><span class="cp"></span>
<span class="cp">#define ENRCV		0x01	</span><span class="cm">/* enable receiver */</span><span class="cp"></span>

<span class="cm">/* Bits in PLSCC */</span>
<span class="cp">#define XMTSEL		0x08	</span><span class="cm">/* select DO+/DO- state when idle */</span><span class="cp"></span>
<span class="cp">#define PORTSEL_AUI	0x00	</span><span class="cm">/* select AUI port */</span><span class="cp"></span>
<span class="cp">#define PORTSEL_10T	0x02	</span><span class="cm">/* select 10Base-T port */</span><span class="cp"></span>
<span class="cp">#define PORTSEL_DAI	0x04	</span><span class="cm">/* select DAI port */</span><span class="cp"></span>
<span class="cp">#define PORTSEL_GPSI	0x06	</span><span class="cm">/* select GPSI port */</span><span class="cp"></span>
<span class="cp">#define ENPLSIO		0x01	</span><span class="cm">/* enable optional PLS I/O pins */</span><span class="cp"></span>

<span class="cm">/* Bits in PHYCC */</span>
<span class="cp">#define LNKFL		0x80	</span><span class="cm">/* reports 10Base-T link failure */</span><span class="cp"></span>
<span class="cp">#define DLNKTST		0x40	</span><span class="cm">/* disable 10Base-T link test */</span><span class="cp"></span>
<span class="cp">#define REVPOL		0x20	</span><span class="cm">/* 10Base-T receiver polarity reversed */</span><span class="cp"></span>
<span class="cp">#define DAPC		0x10	</span><span class="cm">/* disable auto receiver polarity correction */</span><span class="cp"></span>
<span class="cp">#define LRT		0x08	</span><span class="cm">/* low receive threshold for long links */</span><span class="cp"></span>
<span class="cp">#define ASEL		0x04	</span><span class="cm">/* auto-select AUI or 10Base-T port */</span><span class="cp"></span>
<span class="cp">#define RWAKE		0x02	</span><span class="cm">/* remote wake function */</span><span class="cp"></span>
<span class="cp">#define AWAKE		0x01	</span><span class="cm">/* auto wake function */</span><span class="cp"></span>

<span class="cm">/* Bits in IAC */</span>
<span class="cp">#define ADDRCHG		0x80	</span><span class="cm">/* request address change */</span><span class="cp"></span>
<span class="cp">#define PHYADDR		0x04	</span><span class="cm">/* access physical address */</span><span class="cp"></span>
<span class="cp">#define LOGADDR		0x02	</span><span class="cm">/* access multicast filter */</span><span class="cp"></span>

<span class="cm">/* Bits in UTR */</span>
<span class="cp">#define RTRE		0x80	</span><span class="cm">/* reserved test register enable. DON&#39;T SET. */</span><span class="cp"></span>
<span class="cp">#define RTRD		0x40	</span><span class="cm">/* reserved test register disable.  Sticky */</span><span class="cp"></span>
<span class="cp">#define RPAC		0x20	</span><span class="cm">/* accept runt packets */</span><span class="cp"></span>
<span class="cp">#define FCOLL		0x10	</span><span class="cm">/* force collision */</span><span class="cp"></span>
<span class="cp">#define RCVFCSE		0x08	</span><span class="cm">/* receive FCS enable */</span><span class="cp"></span>
<span class="cp">#define LOOP_NONE	0x00	</span><span class="cm">/* no loopback */</span><span class="cp"></span>
<span class="cp">#define LOOP_EXT	0x02	</span><span class="cm">/* external loopback */</span><span class="cp"></span>
<span class="cp">#define LOOP_INT	0x04	</span><span class="cm">/* internal loopback, excludes MENDEC */</span><span class="cp"></span>
<span class="cp">#define LOOP_MENDEC	0x06	</span><span class="cm">/* internal loopback, includes MENDEC */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
