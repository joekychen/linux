<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › sun › sunqe.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>sunqe.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* $Id: sunqe.h,v 1.13 2000/02/09 11:15:42 davem Exp $</span>
<span class="cm"> * sunqe.h: Definitions for the Sun QuadEthernet driver.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 1996 David S. Miller (davem@caip.rutgers.edu)</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _SUNQE_H</span>
<span class="cp">#define _SUNQE_H</span>

<span class="cm">/* QEC global registers. */</span>
<span class="cp">#define GLOB_CTRL	0x00UL		</span><span class="cm">/* Control			*/</span><span class="cp"></span>
<span class="cp">#define GLOB_STAT	0x04UL		</span><span class="cm">/* Status			*/</span><span class="cp"></span>
<span class="cp">#define GLOB_PSIZE	0x08UL		</span><span class="cm">/* Packet Size			*/</span><span class="cp"></span>
<span class="cp">#define GLOB_MSIZE	0x0cUL		</span><span class="cm">/* Local-memory Size		*/</span><span class="cp"></span>
<span class="cp">#define GLOB_RSIZE	0x10UL		</span><span class="cm">/* Receive partition size	*/</span><span class="cp"></span>
<span class="cp">#define GLOB_TSIZE	0x14UL		</span><span class="cm">/* Transmit partition size	*/</span><span class="cp"></span>
<span class="cp">#define GLOB_REG_SIZE	0x18UL</span>

<span class="cp">#define GLOB_CTRL_MMODE       0x40000000 </span><span class="cm">/* MACE qec mode            */</span><span class="cp"></span>
<span class="cp">#define GLOB_CTRL_BMODE       0x10000000 </span><span class="cm">/* BigMAC qec mode          */</span><span class="cp"></span>
<span class="cp">#define GLOB_CTRL_EPAR        0x00000020 </span><span class="cm">/* Enable parity            */</span><span class="cp"></span>
<span class="cp">#define GLOB_CTRL_ACNTRL      0x00000018 </span><span class="cm">/* SBUS arbitration control */</span><span class="cp"></span>
<span class="cp">#define GLOB_CTRL_B64         0x00000004 </span><span class="cm">/* 64 byte dvma bursts      */</span><span class="cp"></span>
<span class="cp">#define GLOB_CTRL_B32         0x00000002 </span><span class="cm">/* 32 byte dvma bursts      */</span><span class="cp"></span>
<span class="cp">#define GLOB_CTRL_B16         0x00000000 </span><span class="cm">/* 16 byte dvma bursts      */</span><span class="cp"></span>
<span class="cp">#define GLOB_CTRL_RESET       0x00000001 </span><span class="cm">/* Reset the QEC            */</span><span class="cp"></span>

<span class="cp">#define GLOB_STAT_TX          0x00000008 </span><span class="cm">/* BigMAC Transmit IRQ      */</span><span class="cp"></span>
<span class="cp">#define GLOB_STAT_RX          0x00000004 </span><span class="cm">/* BigMAC Receive IRQ       */</span><span class="cp"></span>
<span class="cp">#define GLOB_STAT_BM          0x00000002 </span><span class="cm">/* BigMAC Global IRQ        */</span><span class="cp"></span>
<span class="cp">#define GLOB_STAT_ER          0x00000001 </span><span class="cm">/* BigMAC Error IRQ         */</span><span class="cp"></span>

<span class="cp">#define GLOB_PSIZE_2048       0x00       </span><span class="cm">/* 2k packet size           */</span><span class="cp"></span>
<span class="cp">#define GLOB_PSIZE_4096       0x01       </span><span class="cm">/* 4k packet size           */</span><span class="cp"></span>
<span class="cp">#define GLOB_PSIZE_6144       0x10       </span><span class="cm">/* 6k packet size           */</span><span class="cp"></span>
<span class="cp">#define GLOB_PSIZE_8192       0x11       </span><span class="cm">/* 8k packet size           */</span><span class="cp"></span>

<span class="cm">/* In MACE mode, there are four qe channels.  Each channel has it&#39;s own</span>
<span class="cm"> * status bits in the QEC status register.  This macro picks out the</span>
<span class="cm"> * ones you want.</span>
<span class="cm"> */</span>
<span class="cp">#define GLOB_STAT_PER_QE(status, channel) (((status) &gt;&gt; ((channel) * 4)) &amp; 0xf)</span>

<span class="cm">/* The following registers are for per-qe channel information/status. */</span>
<span class="cp">#define CREG_CTRL	0x00UL	</span><span class="cm">/* Control                   */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT	0x04UL	</span><span class="cm">/* Status                    */</span><span class="cp"></span>
<span class="cp">#define CREG_RXDS	0x08UL	</span><span class="cm">/* RX descriptor ring ptr    */</span><span class="cp"></span>
<span class="cp">#define CREG_TXDS	0x0cUL	</span><span class="cm">/* TX descriptor ring ptr    */</span><span class="cp"></span>
<span class="cp">#define CREG_RIMASK	0x10UL	</span><span class="cm">/* RX Interrupt Mask         */</span><span class="cp"></span>
<span class="cp">#define CREG_TIMASK	0x14UL	</span><span class="cm">/* TX Interrupt Mask         */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK	0x18UL	</span><span class="cm">/* QEC Error Interrupt Mask  */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK	0x1cUL	</span><span class="cm">/* MACE Error Interrupt Mask */</span><span class="cp"></span>
<span class="cp">#define CREG_RXWBUFPTR	0x20UL	</span><span class="cm">/* Local memory rx write ptr */</span><span class="cp"></span>
<span class="cp">#define CREG_RXRBUFPTR	0x24UL	</span><span class="cm">/* Local memory rx read ptr  */</span><span class="cp"></span>
<span class="cp">#define CREG_TXWBUFPTR	0x28UL	</span><span class="cm">/* Local memory tx write ptr */</span><span class="cp"></span>
<span class="cp">#define CREG_TXRBUFPTR	0x2cUL	</span><span class="cm">/* Local memory tx read ptr  */</span><span class="cp"></span>
<span class="cp">#define CREG_CCNT	0x30UL	</span><span class="cm">/* Collision Counter         */</span><span class="cp"></span>
<span class="cp">#define CREG_PIPG	0x34UL	</span><span class="cm">/* Inter-Frame Gap           */</span><span class="cp"></span>
<span class="cp">#define CREG_REG_SIZE	0x38UL</span>

<span class="cp">#define CREG_CTRL_RXOFF       0x00000004  </span><span class="cm">/* Disable this qe&#39;s receiver*/</span><span class="cp"></span>
<span class="cp">#define CREG_CTRL_RESET       0x00000002  </span><span class="cm">/* Reset this qe channel     */</span><span class="cp"></span>
<span class="cp">#define CREG_CTRL_TWAKEUP     0x00000001  </span><span class="cm">/* Transmitter Wakeup, &#39;go&#39;. */</span><span class="cp"></span>

<span class="cp">#define CREG_STAT_EDEFER      0x10000000  </span><span class="cm">/* Excessive Defers          */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_CLOSS       0x08000000  </span><span class="cm">/* Carrier Loss              */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_ERETRIES    0x04000000  </span><span class="cm">/* More than 16 retries      */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_LCOLL       0x02000000  </span><span class="cm">/* Late TX Collision         */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_FUFLOW      0x01000000  </span><span class="cm">/* FIFO Underflow            */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_JERROR      0x00800000  </span><span class="cm">/* Jabber Error              */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_BERROR      0x00400000  </span><span class="cm">/* Babble Error              */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_TXIRQ       0x00200000  </span><span class="cm">/* Transmit Interrupt        */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_CCOFLOW     0x00100000  </span><span class="cm">/* TX Coll-counter Overflow  */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_TXDERROR    0x00080000  </span><span class="cm">/* TX Descriptor is bogus    */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_TXLERR      0x00040000  </span><span class="cm">/* Late Transmit Error       */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_TXPERR      0x00020000  </span><span class="cm">/* Transmit Parity Error     */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_TXSERR      0x00010000  </span><span class="cm">/* Transmit SBUS error ack   */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RCCOFLOW    0x00001000  </span><span class="cm">/* RX Coll-counter Overflow  */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RUOFLOW     0x00000800  </span><span class="cm">/* Runt Counter Overflow     */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_MCOFLOW     0x00000400  </span><span class="cm">/* Missed Counter Overflow   */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RXFOFLOW    0x00000200  </span><span class="cm">/* RX FIFO Overflow          */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RLCOLL      0x00000100  </span><span class="cm">/* RX Late Collision         */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_FCOFLOW     0x00000080  </span><span class="cm">/* Frame Counter Overflow    */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_CECOFLOW    0x00000040  </span><span class="cm">/* CRC Error-counter Overflow*/</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RXIRQ       0x00000020  </span><span class="cm">/* Receive Interrupt         */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RXDROP      0x00000010  </span><span class="cm">/* Dropped a RX&#39;d packet     */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RXSMALL     0x00000008  </span><span class="cm">/* Receive buffer too small  */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RXLERR      0x00000004  </span><span class="cm">/* Receive Late Error        */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RXPERR      0x00000002  </span><span class="cm">/* Receive Parity Error      */</span><span class="cp"></span>
<span class="cp">#define CREG_STAT_RXSERR      0x00000001  </span><span class="cm">/* Receive SBUS Error ACK    */</span><span class="cp"></span>

<span class="cp">#define CREG_STAT_ERRORS      (CREG_STAT_EDEFER|CREG_STAT_CLOSS|CREG_STAT_ERETRIES|     \</span>
<span class="cp">			       CREG_STAT_LCOLL|CREG_STAT_FUFLOW|CREG_STAT_JERROR|       \</span>
<span class="cp">			       CREG_STAT_BERROR|CREG_STAT_CCOFLOW|CREG_STAT_TXDERROR|   \</span>
<span class="cp">			       CREG_STAT_TXLERR|CREG_STAT_TXPERR|CREG_STAT_TXSERR|      \</span>
<span class="cp">			       CREG_STAT_RCCOFLOW|CREG_STAT_RUOFLOW|CREG_STAT_MCOFLOW| \</span>
<span class="cp">			       CREG_STAT_RXFOFLOW|CREG_STAT_RLCOLL|CREG_STAT_FCOFLOW|   \</span>
<span class="cp">			       CREG_STAT_CECOFLOW|CREG_STAT_RXDROP|CREG_STAT_RXSMALL|   \</span>
<span class="cp">			       CREG_STAT_RXLERR|CREG_STAT_RXPERR|CREG_STAT_RXSERR)</span>

<span class="cp">#define CREG_QMASK_COFLOW     0x00100000  </span><span class="cm">/* CollCntr overflow         */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_TXDERROR   0x00080000  </span><span class="cm">/* TXD error                 */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_TXLERR     0x00040000  </span><span class="cm">/* TX late error             */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_TXPERR     0x00020000  </span><span class="cm">/* TX parity error           */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_TXSERR     0x00010000  </span><span class="cm">/* TX sbus error ack         */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_RXDROP     0x00000010  </span><span class="cm">/* RX drop                   */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_RXBERROR   0x00000008  </span><span class="cm">/* RX buffer error           */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_RXLEERR    0x00000004  </span><span class="cm">/* RX late error             */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_RXPERR     0x00000002  </span><span class="cm">/* RX parity error           */</span><span class="cp"></span>
<span class="cp">#define CREG_QMASK_RXSERR     0x00000001  </span><span class="cm">/* RX sbus error ack         */</span><span class="cp"></span>

<span class="cp">#define CREG_MMASK_EDEFER     0x10000000  </span><span class="cm">/* Excess defer              */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_CLOSS      0x08000000  </span><span class="cm">/* Carrier loss              */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_ERETRY     0x04000000  </span><span class="cm">/* Excess retry              */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_LCOLL      0x02000000  </span><span class="cm">/* Late collision error      */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_UFLOW      0x01000000  </span><span class="cm">/* Underflow                 */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_JABBER     0x00800000  </span><span class="cm">/* Jabber error              */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_BABBLE     0x00400000  </span><span class="cm">/* Babble error              */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_OFLOW      0x00000800  </span><span class="cm">/* Overflow                  */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_RXCOLL     0x00000400  </span><span class="cm">/* RX Coll-Cntr overflow     */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_RPKT       0x00000200  </span><span class="cm">/* Runt pkt overflow         */</span><span class="cp"></span>
<span class="cp">#define CREG_MMASK_MPKT       0x00000100  </span><span class="cm">/* Missed pkt overflow       */</span><span class="cp"></span>

<span class="cp">#define CREG_PIPG_TENAB       0x00000020  </span><span class="cm">/* Enable Throttle           */</span><span class="cp"></span>
<span class="cp">#define CREG_PIPG_MMODE       0x00000010  </span><span class="cm">/* Manual Mode               */</span><span class="cp"></span>
<span class="cp">#define CREG_PIPG_WMASK       0x0000000f  </span><span class="cm">/* SBUS Wait Mask            */</span><span class="cp"></span>

<span class="cm">/* Per-channel AMD 79C940 MACE registers. */</span>
<span class="cp">#define MREGS_RXFIFO	0x00UL	</span><span class="cm">/* Receive FIFO                   */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFIFO	0x01UL	</span><span class="cm">/* Transmit FIFO                  */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFCNTL	0x02UL	</span><span class="cm">/* Transmit Frame Control         */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT	0x03UL	</span><span class="cm">/* Transmit Frame Status          */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXRCNT	0x04UL	</span><span class="cm">/* Transmit Retry Count           */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFCNTL	0x05UL	</span><span class="cm">/* Receive Frame Control          */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFSTAT	0x06UL	</span><span class="cm">/* Receive Frame Status           */</span><span class="cp"></span>
<span class="cp">#define MREGS_FFCNT	0x07UL	</span><span class="cm">/* FIFO Frame Count               */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG	0x08UL	</span><span class="cm">/* Interrupt Register             */</span><span class="cp"></span>
<span class="cp">#define MREGS_IMASK	0x09UL	</span><span class="cm">/* Interrupt Mask                 */</span><span class="cp"></span>
<span class="cp">#define MREGS_POLL	0x0aUL	</span><span class="cm">/* POLL Register                  */</span><span class="cp"></span>
<span class="cp">#define MREGS_BCONFIG	0x0bUL	</span><span class="cm">/* BIU Config                     */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG	0x0cUL	</span><span class="cm">/* FIFO Config                    */</span><span class="cp"></span>
<span class="cp">#define MREGS_MCONFIG	0x0dUL	</span><span class="cm">/* MAC Config                     */</span><span class="cp"></span>
<span class="cp">#define MREGS_PLSCONFIG	0x0eUL	</span><span class="cm">/* PLS Config                     */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG	0x0fUL	</span><span class="cm">/* PHY Config                     */</span><span class="cp"></span>
<span class="cp">#define MREGS_CHIPID1	0x10UL	</span><span class="cm">/* Chip-ID, low bits              */</span><span class="cp"></span>
<span class="cp">#define MREGS_CHIPID2	0x11UL	</span><span class="cm">/* Chip-ID, high bits             */</span><span class="cp"></span>
<span class="cp">#define MREGS_IACONFIG	0x12UL	</span><span class="cm">/* Internal Address Config        */</span><span class="cp"></span>
	<span class="cm">/* 0x13UL, reserved */</span>
<span class="cp">#define MREGS_FILTER	0x14UL	</span><span class="cm">/* Logical Address Filter         */</span><span class="cp"></span>
<span class="cp">#define MREGS_ETHADDR	0x15UL	</span><span class="cm">/* Our Ethernet Address           */</span><span class="cp"></span>
	<span class="cm">/* 0x16UL, reserved */</span>
	<span class="cm">/* 0x17UL, reserved */</span>
<span class="cp">#define MREGS_MPCNT	0x18UL	</span><span class="cm">/* Missed Packet Count            */</span><span class="cp"></span>
	<span class="cm">/* 0x19UL, reserved */</span>
<span class="cp">#define MREGS_RPCNT	0x1aUL	</span><span class="cm">/* Runt Packet Count              */</span><span class="cp"></span>
<span class="cp">#define MREGS_RCCNT	0x1bUL	</span><span class="cm">/* RX Collision Count             */</span><span class="cp"></span>
	<span class="cm">/* 0x1cUL, reserved */</span>
<span class="cp">#define MREGS_UTEST	0x1dUL	</span><span class="cm">/* User Test                      */</span><span class="cp"></span>
<span class="cp">#define MREGS_RTEST1	0x1eUL	</span><span class="cm">/* Reserved Test 1                */</span><span class="cp"></span>
<span class="cp">#define MREGS_RTEST2	0x1fUL	</span><span class="cm">/* Reserved Test 2                */</span><span class="cp"></span>
<span class="cp">#define MREGS_REG_SIZE	0x20UL</span>

<span class="cp">#define MREGS_TXFCNTL_DRETRY        0x80 </span><span class="cm">/* Retry disable                  */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFCNTL_DFCS          0x08 </span><span class="cm">/* Disable TX FCS                 */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFCNTL_AUTOPAD       0x01 </span><span class="cm">/* TX auto pad                    */</span><span class="cp"></span>

<span class="cp">#define MREGS_TXFSTAT_VALID         0x80 </span><span class="cm">/* TX valid                       */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT_UNDERFLOW     0x40 </span><span class="cm">/* TX underflow                   */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT_LCOLL         0x20 </span><span class="cm">/* TX late collision              */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT_MRETRY        0x10 </span><span class="cm">/* TX &gt; 1 retries                 */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT_ORETRY        0x08 </span><span class="cm">/* TX 1 retry                     */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT_PDEFER        0x04 </span><span class="cm">/* TX pkt deferred                */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT_CLOSS         0x02 </span><span class="cm">/* TX carrier lost                */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXFSTAT_RERROR        0x01 </span><span class="cm">/* TX retry error                 */</span><span class="cp"></span>

<span class="cp">#define MREGS_TXRCNT_EDEFER         0x80 </span><span class="cm">/* TX Excess defers               */</span><span class="cp"></span>
<span class="cp">#define MREGS_TXRCNT_CMASK          0x0f </span><span class="cm">/* TX retry count                 */</span><span class="cp"></span>

<span class="cp">#define MREGS_RXFCNTL_LOWLAT        0x08 </span><span class="cm">/* RX low latency                 */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFCNTL_AREJECT       0x04 </span><span class="cm">/* RX addr match rej              */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFCNTL_AUTOSTRIP     0x01 </span><span class="cm">/* RX auto strip                  */</span><span class="cp"></span>

<span class="cp">#define MREGS_RXFSTAT_OVERFLOW      0x80 </span><span class="cm">/* RX overflow                    */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFSTAT_LCOLL         0x40 </span><span class="cm">/* RX late collision              */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFSTAT_FERROR        0x20 </span><span class="cm">/* RX framing error               */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFSTAT_FCSERROR      0x10 </span><span class="cm">/* RX FCS error                   */</span><span class="cp"></span>
<span class="cp">#define MREGS_RXFSTAT_RBCNT         0x0f </span><span class="cm">/* RX msg byte count              */</span><span class="cp"></span>

<span class="cp">#define MREGS_FFCNT_RX              0xf0 </span><span class="cm">/* RX FIFO frame cnt              */</span><span class="cp"></span>
<span class="cp">#define MREGS_FFCNT_TX              0x0f </span><span class="cm">/* TX FIFO frame cnt              */</span><span class="cp"></span>

<span class="cp">#define MREGS_IREG_JABBER           0x80 </span><span class="cm">/* IRQ Jabber error               */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG_BABBLE           0x40 </span><span class="cm">/* IRQ Babble error               */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG_COLL             0x20 </span><span class="cm">/* IRQ Collision error            */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG_RCCO             0x10 </span><span class="cm">/* IRQ Collision cnt overflow     */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG_RPKTCO           0x08 </span><span class="cm">/* IRQ Runt packet count overflow */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG_MPKTCO           0x04 </span><span class="cm">/* IRQ missed packet cnt overflow */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG_RXIRQ            0x02 </span><span class="cm">/* IRQ RX&#39;d a packet              */</span><span class="cp"></span>
<span class="cp">#define MREGS_IREG_TXIRQ            0x01 </span><span class="cm">/* IRQ TX&#39;d a packet              */</span><span class="cp"></span>

<span class="cp">#define MREGS_IMASK_BABBLE          0x40 </span><span class="cm">/* IMASK Babble errors            */</span><span class="cp"></span>
<span class="cp">#define MREGS_IMASK_COLL            0x20 </span><span class="cm">/* IMASK Collision errors         */</span><span class="cp"></span>
<span class="cp">#define MREGS_IMASK_MPKTCO          0x04 </span><span class="cm">/* IMASK Missed pkt cnt overflow  */</span><span class="cp"></span>
<span class="cp">#define MREGS_IMASK_RXIRQ           0x02 </span><span class="cm">/* IMASK RX interrupts            */</span><span class="cp"></span>
<span class="cp">#define MREGS_IMASK_TXIRQ           0x01 </span><span class="cm">/* IMASK TX interrupts            */</span><span class="cp"></span>

<span class="cp">#define MREGS_POLL_TXVALID          0x80 </span><span class="cm">/* TX is valid                    */</span><span class="cp"></span>
<span class="cp">#define MREGS_POLL_TDTR             0x40 </span><span class="cm">/* TX data transfer request       */</span><span class="cp"></span>
<span class="cp">#define MREGS_POLL_RDTR             0x20 </span><span class="cm">/* RX data transfer request       */</span><span class="cp"></span>

<span class="cp">#define MREGS_BCONFIG_BSWAP         0x40 </span><span class="cm">/* Byte Swap                      */</span><span class="cp"></span>
<span class="cp">#define MREGS_BCONFIG_4TS           0x00 </span><span class="cm">/* 4byte transmit start point     */</span><span class="cp"></span>
<span class="cp">#define MREGS_BCONFIG_16TS          0x10 </span><span class="cm">/* 16byte transmit start point    */</span><span class="cp"></span>
<span class="cp">#define MREGS_BCONFIG_64TS          0x20 </span><span class="cm">/* 64byte transmit start point    */</span><span class="cp"></span>
<span class="cp">#define MREGS_BCONFIG_112TS         0x30 </span><span class="cm">/* 112byte transmit start point   */</span><span class="cp"></span>
<span class="cp">#define MREGS_BCONFIG_RESET         0x01 </span><span class="cm">/* SW-Reset the MACE              */</span><span class="cp"></span>

<span class="cp">#define MREGS_FCONFIG_TXF8          0x00 </span><span class="cm">/* TX fifo 8 write cycles         */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_TXF32         0x80 </span><span class="cm">/* TX fifo 32 write cycles        */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_TXF16         0x40 </span><span class="cm">/* TX fifo 16 write cycles        */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_RXF64         0x20 </span><span class="cm">/* RX fifo 64 write cycles        */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_RXF32         0x10 </span><span class="cm">/* RX fifo 32 write cycles        */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_RXF16         0x00 </span><span class="cm">/* RX fifo 16 write cycles        */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_TFWU          0x08 </span><span class="cm">/* TX fifo watermark update       */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_RFWU          0x04 </span><span class="cm">/* RX fifo watermark update       */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_TBENAB        0x02 </span><span class="cm">/* TX burst enable                */</span><span class="cp"></span>
<span class="cp">#define MREGS_FCONFIG_RBENAB        0x01 </span><span class="cm">/* RX burst enable                */</span><span class="cp"></span>

<span class="cp">#define MREGS_MCONFIG_PROMISC       0x80 </span><span class="cm">/* Promiscuous mode enable        */</span><span class="cp"></span>
<span class="cp">#define MREGS_MCONFIG_TPDDISAB      0x40 </span><span class="cm">/* TX 2part deferral enable       */</span><span class="cp"></span>
<span class="cp">#define MREGS_MCONFIG_MBAENAB       0x20 </span><span class="cm">/* Modified backoff enable        */</span><span class="cp"></span>
<span class="cp">#define MREGS_MCONFIG_RPADISAB      0x08 </span><span class="cm">/* RX physical addr disable       */</span><span class="cp"></span>
<span class="cp">#define MREGS_MCONFIG_RBDISAB       0x04 </span><span class="cm">/* RX broadcast disable           */</span><span class="cp"></span>
<span class="cp">#define MREGS_MCONFIG_TXENAB        0x02 </span><span class="cm">/* Enable transmitter             */</span><span class="cp"></span>
<span class="cp">#define MREGS_MCONFIG_RXENAB        0x01 </span><span class="cm">/* Enable receiver                */</span><span class="cp"></span>

<span class="cp">#define MREGS_PLSCONFIG_TXMS        0x08 </span><span class="cm">/* TX mode select                 */</span><span class="cp"></span>
<span class="cp">#define MREGS_PLSCONFIG_GPSI        0x06 </span><span class="cm">/* Use GPSI connector             */</span><span class="cp"></span>
<span class="cp">#define MREGS_PLSCONFIG_DAI         0x04 </span><span class="cm">/* Use DAI connector              */</span><span class="cp"></span>
<span class="cp">#define MREGS_PLSCONFIG_TP          0x02 </span><span class="cm">/* Use TwistedPair connector      */</span><span class="cp"></span>
<span class="cp">#define MREGS_PLSCONFIG_AUI         0x00 </span><span class="cm">/* Use AUI connector              */</span><span class="cp"></span>
<span class="cp">#define MREGS_PLSCONFIG_IOENAB      0x01 </span><span class="cm">/* PLS I/O enable                 */</span><span class="cp"></span>

<span class="cp">#define MREGS_PHYCONFIG_LSTAT       0x80 </span><span class="cm">/* Link status                    */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG_LTESTDIS    0x40 </span><span class="cm">/* Disable link test logic        */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG_RXPOLARITY  0x20 </span><span class="cm">/* RX polarity                    */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG_APCDISAB    0x10 </span><span class="cm">/* AutoPolarityCorrect disab      */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG_LTENAB      0x08 </span><span class="cm">/* Select low threshold           */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG_AUTO        0x04 </span><span class="cm">/* Connector port auto-sel        */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG_RWU         0x02 </span><span class="cm">/* Remote WakeUp                  */</span><span class="cp"></span>
<span class="cp">#define MREGS_PHYCONFIG_AW          0x01 </span><span class="cm">/* Auto Wakeup                    */</span><span class="cp"></span>

<span class="cp">#define MREGS_IACONFIG_ACHNGE       0x80 </span><span class="cm">/* Do address change              */</span><span class="cp"></span>
<span class="cp">#define MREGS_IACONFIG_PARESET      0x04 </span><span class="cm">/* Physical address reset         */</span><span class="cp"></span>
<span class="cp">#define MREGS_IACONFIG_LARESET      0x02 </span><span class="cm">/* Logical address reset          */</span><span class="cp"></span>

<span class="cp">#define MREGS_UTEST_RTRENAB         0x80 </span><span class="cm">/* Enable resv test register      */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_RTRDISAB        0x40 </span><span class="cm">/* Disab resv test register       */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_RPACCEPT        0x20 </span><span class="cm">/* Accept runt packets            */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_FCOLL           0x10 </span><span class="cm">/* Force collision status         */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_FCSENAB         0x08 </span><span class="cm">/* Enable FCS on RX               */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_INTLOOPM        0x06 </span><span class="cm">/* Intern lpback w/MENDEC         */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_INTLOOP         0x04 </span><span class="cm">/* Intern lpback                  */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_EXTLOOP         0x02 </span><span class="cm">/* Extern lpback                  */</span><span class="cp"></span>
<span class="cp">#define MREGS_UTEST_NOLOOP          0x00 </span><span class="cm">/* No loopback                    */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">qe_rxd</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">rx_flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_addr</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define RXD_OWN      0x80000000 </span><span class="cm">/* Ownership.      */</span><span class="cp"></span>
<span class="cp">#define RXD_UPDATE   0x10000000 </span><span class="cm">/* Being Updated?  */</span><span class="cp"></span>
<span class="cp">#define RXD_LENGTH   0x000007ff </span><span class="cm">/* Packet Length.  */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">qe_txd</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">tx_flags</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_addr</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define TXD_OWN      0x80000000 </span><span class="cm">/* Ownership.      */</span><span class="cp"></span>
<span class="cp">#define TXD_SOP      0x40000000 </span><span class="cm">/* Start Of Packet */</span><span class="cp"></span>
<span class="cp">#define TXD_EOP      0x20000000 </span><span class="cm">/* End Of Packet   */</span><span class="cp"></span>
<span class="cp">#define TXD_UPDATE   0x10000000 </span><span class="cm">/* Being Updated?  */</span><span class="cp"></span>
<span class="cp">#define TXD_LENGTH   0x000007ff </span><span class="cm">/* Packet Length.  */</span><span class="cp"></span>

<span class="cp">#define TX_RING_MAXSIZE   256</span>
<span class="cp">#define RX_RING_MAXSIZE   256</span>

<span class="cp">#define TX_RING_SIZE      16</span>
<span class="cp">#define RX_RING_SIZE      16</span>

<span class="cp">#define NEXT_RX(num)       (((num) + 1) &amp; (RX_RING_MAXSIZE - 1))</span>
<span class="cp">#define NEXT_TX(num)       (((num) + 1) &amp; (TX_RING_MAXSIZE - 1))</span>
<span class="cp">#define PREV_RX(num)       (((num) - 1) &amp; (RX_RING_MAXSIZE - 1))</span>
<span class="cp">#define PREV_TX(num)       (((num) - 1) &amp; (TX_RING_MAXSIZE - 1))</span>

<span class="cp">#define TX_BUFFS_AVAIL(qp)                                    \</span>
<span class="cp">        (((qp)-&gt;tx_old &lt;= (qp)-&gt;tx_new) ?                     \</span>
<span class="cp">	  (qp)-&gt;tx_old + (TX_RING_SIZE - 1) - (qp)-&gt;tx_new :  \</span>
<span class="cp">			    (qp)-&gt;tx_old - (qp)-&gt;tx_new - 1)</span>

<span class="k">struct</span> <span class="n">qe_init_block</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">qe_rxd</span> <span class="n">qe_rxd</span><span class="p">[</span><span class="n">RX_RING_MAXSIZE</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">qe_txd</span> <span class="n">qe_txd</span><span class="p">[</span><span class="n">TX_RING_MAXSIZE</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define qib_offset(mem, elem) \</span>
<span class="cp">((__u32)((unsigned long)(&amp;(((struct qe_init_block *)0)-&gt;mem[elem]))))</span>

<span class="k">struct</span> <span class="n">sunqe</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">sunqec</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="n">__iomem</span>		<span class="o">*</span><span class="n">gregs</span><span class="p">;</span>		<span class="cm">/* QEC Global Registers         */</span>
	<span class="k">struct</span> <span class="n">sunqe</span>		<span class="o">*</span><span class="n">qes</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>	<span class="cm">/* Each child MACE              */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>            <span class="n">qec_bursts</span><span class="p">;</span>	<span class="cm">/* Support burst sizes          */</span>
	<span class="k">struct</span> <span class="n">platform_device</span>	<span class="o">*</span><span class="n">op</span><span class="p">;</span>		<span class="cm">/* QEC&#39;s OF device              */</span>
	<span class="k">struct</span> <span class="n">sunqec</span>		<span class="o">*</span><span class="n">next_module</span><span class="p">;</span>	<span class="cm">/* List of all QECs in system   */</span>
<span class="p">};</span>

<span class="cp">#define PKT_BUF_SZ	1664</span>
<span class="cp">#define RXD_PKT_SZ	1664</span>

<span class="k">struct</span> <span class="n">sunqe_buffers</span> <span class="p">{</span>
	<span class="n">u8</span>	<span class="n">tx_buf</span><span class="p">[</span><span class="n">TX_RING_SIZE</span><span class="p">][</span><span class="n">PKT_BUF_SZ</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">__pad</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="n">u8</span>	<span class="n">rx_buf</span><span class="p">[</span><span class="n">RX_RING_SIZE</span><span class="p">][</span><span class="n">PKT_BUF_SZ</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define qebuf_offset(mem, elem) \</span>
<span class="cp">((__u32)((unsigned long)(&amp;(((struct sunqe_buffers *)0)-&gt;mem[elem][0]))))</span>

<span class="k">struct</span> <span class="n">sunqe</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="n">__iomem</span>			<span class="o">*</span><span class="n">qcregs</span><span class="p">;</span>		<span class="cm">/* QEC per-channel Registers   */</span>
	<span class="kt">void</span> <span class="n">__iomem</span>			<span class="o">*</span><span class="n">mregs</span><span class="p">;</span>		<span class="cm">/* Per-channel MACE Registers  */</span>
	<span class="k">struct</span> <span class="n">qe_init_block</span>      	<span class="o">*</span><span class="n">qe_block</span><span class="p">;</span>	<span class="cm">/* RX and TX descriptors       */</span>
	<span class="n">__u32</span>                      	<span class="n">qblock_dvma</span><span class="p">;</span>	<span class="cm">/* RX and TX descriptors       */</span>
	<span class="n">spinlock_t</span>			<span class="n">lock</span><span class="p">;</span>		<span class="cm">/* Protects txfull state       */</span>
	<span class="kt">int</span>                        	<span class="n">rx_new</span><span class="p">,</span> <span class="n">rx_old</span><span class="p">;</span>	<span class="cm">/* RX ring extents	       */</span>
	<span class="kt">int</span>			   	<span class="n">tx_new</span><span class="p">,</span> <span class="n">tx_old</span><span class="p">;</span>	<span class="cm">/* TX ring extents	       */</span>
	<span class="k">struct</span> <span class="n">sunqe_buffers</span>		<span class="o">*</span><span class="n">buffers</span><span class="p">;</span>	<span class="cm">/* CPU visible address.        */</span>
	<span class="n">__u32</span>				<span class="n">buffers_dvma</span><span class="p">;</span>	<span class="cm">/* DVMA visible address.       */</span>
	<span class="k">struct</span> <span class="n">sunqec</span>			<span class="o">*</span><span class="n">parent</span><span class="p">;</span>
	<span class="n">u8</span>				<span class="n">mconfig</span><span class="p">;</span>	<span class="cm">/* Base MACE mconfig value     */</span>
	<span class="k">struct</span> <span class="n">platform_device</span>		<span class="o">*</span><span class="n">op</span><span class="p">;</span>		<span class="cm">/* QE&#39;s OF device struct       */</span>
	<span class="k">struct</span> <span class="n">net_device</span>		<span class="o">*</span><span class="n">dev</span><span class="p">;</span>		<span class="cm">/* QE&#39;s netdevice struct       */</span>
	<span class="kt">int</span>				<span class="n">channel</span><span class="p">;</span>	<span class="cm">/* Who am I?                   */</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="cm">/* !(_SUNQE_H) */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
