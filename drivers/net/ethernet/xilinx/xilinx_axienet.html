<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › xilinx › xilinx_axienet.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>xilinx_axienet.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Definitions for Xilinx Axi Ethernet device driver.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2009 Secret Lab Technologies, Ltd.</span>
<span class="cm"> * Copyright (c) 2010 - 2012 Xilinx, Inc. All rights reserved.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef XILINX_AXIENET_H</span>
<span class="cp">#define XILINX_AXIENET_H</span>

<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;linux/spinlock.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>

<span class="cm">/* Packet size info */</span>
<span class="cp">#define XAE_HDR_SIZE			14 </span><span class="cm">/* Size of Ethernet header */</span><span class="cp"></span>
<span class="cp">#define XAE_HDR_VLAN_SIZE		18 </span><span class="cm">/* Size of an Ethernet hdr + VLAN */</span><span class="cp"></span>
<span class="cp">#define XAE_TRL_SIZE			 4 </span><span class="cm">/* Size of Ethernet trailer (FCS) */</span><span class="cp"></span>
<span class="cp">#define XAE_MTU			      1500 </span><span class="cm">/* Max MTU of an Ethernet frame */</span><span class="cp"></span>
<span class="cp">#define XAE_JUMBO_MTU		      9000 </span><span class="cm">/* Max MTU of a jumbo Eth. frame */</span><span class="cp"></span>

<span class="cp">#define XAE_MAX_FRAME_SIZE	 (XAE_MTU + XAE_HDR_SIZE + XAE_TRL_SIZE)</span>
<span class="cp">#define XAE_MAX_VLAN_FRAME_SIZE  (XAE_MTU + XAE_HDR_VLAN_SIZE + XAE_TRL_SIZE)</span>
<span class="cp">#define XAE_MAX_JUMBO_FRAME_SIZE (XAE_JUMBO_MTU + XAE_HDR_SIZE + XAE_TRL_SIZE)</span>

<span class="cm">/* Configuration options */</span>

<span class="cm">/* Accept all incoming packets. Default: disabled (cleared) */</span>
<span class="cp">#define XAE_OPTION_PROMISC			(1 &lt;&lt; 0)</span>

<span class="cm">/* Jumbo frame support for Tx &amp; Rx. Default: disabled (cleared) */</span>
<span class="cp">#define XAE_OPTION_JUMBO			(1 &lt;&lt; 1)</span>

<span class="cm">/* VLAN Rx &amp; Tx frame support. Default: disabled (cleared) */</span>
<span class="cp">#define XAE_OPTION_VLAN				(1 &lt;&lt; 2)</span>

<span class="cm">/* Enable recognition of flow control frames on Rx. Default: enabled (set) */</span>
<span class="cp">#define XAE_OPTION_FLOW_CONTROL			(1 &lt;&lt; 4)</span>

<span class="cm">/* Strip FCS and PAD from incoming frames. Note: PAD from VLAN frames is not</span>
<span class="cm"> * stripped. Default: disabled (set) */</span>
<span class="cp">#define XAE_OPTION_FCS_STRIP			(1 &lt;&lt; 5)</span>

<span class="cm">/* Generate FCS field and add PAD automatically for outgoing frames.</span>
<span class="cm"> * Default: enabled (set) */</span>
<span class="cp">#define XAE_OPTION_FCS_INSERT			(1 &lt;&lt; 6)</span>

<span class="cm">/* Enable Length/Type error checking for incoming frames. When this option is</span>
<span class="cm"> * set, the MAC will filter frames that have a mismatched type/length field</span>
<span class="cm"> * and if XAE_OPTION_REPORT_RXERR is set, the user is notified when these</span>
<span class="cm"> * types of frames are encountered. When this option is cleared, the MAC will</span>
<span class="cm"> * allow these types of frames to be received. Default: enabled (set) */</span>
<span class="cp">#define XAE_OPTION_LENTYPE_ERR			(1 &lt;&lt; 7)</span>

<span class="cm">/* Enable the transmitter. Default: enabled (set) */</span>
<span class="cp">#define XAE_OPTION_TXEN				(1 &lt;&lt; 11)</span>

<span class="cm">/*  Enable the receiver. Default: enabled (set) */</span>
<span class="cp">#define XAE_OPTION_RXEN				(1 &lt;&lt; 12)</span>

<span class="cm">/*  Default options set when device is initialized or reset */</span>
<span class="cp">#define XAE_OPTION_DEFAULTS				   \</span>
<span class="cp">				(XAE_OPTION_TXEN |	   \</span>
<span class="cp">				 XAE_OPTION_FLOW_CONTROL | \</span>
<span class="cp">				 XAE_OPTION_RXEN)</span>

<span class="cm">/* Axi DMA Register definitions */</span>

<span class="cp">#define XAXIDMA_TX_CR_OFFSET	0x00000000 </span><span class="cm">/* Channel control */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_TX_SR_OFFSET	0x00000004 </span><span class="cm">/* Status */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_TX_CDESC_OFFSET	0x00000008 </span><span class="cm">/* Current descriptor pointer */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_TX_TDESC_OFFSET	0x00000010 </span><span class="cm">/* Tail descriptor pointer */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_RX_CR_OFFSET	0x00000030 </span><span class="cm">/* Channel control */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_RX_SR_OFFSET	0x00000034 </span><span class="cm">/* Status */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_RX_CDESC_OFFSET	0x00000038 </span><span class="cm">/* Current descriptor pointer */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_RX_TDESC_OFFSET	0x00000040 </span><span class="cm">/* Tail descriptor pointer */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_CR_RUNSTOP_MASK	0x00000001 </span><span class="cm">/* Start/stop DMA channel */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_CR_RESET_MASK	0x00000004 </span><span class="cm">/* Reset DMA engine */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_BD_NDESC_OFFSET		0x00 </span><span class="cm">/* Next descriptor pointer */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_BUFA_OFFSET		0x08 </span><span class="cm">/* Buffer address */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_CTRL_LEN_OFFSET	0x18 </span><span class="cm">/* Control/buffer length */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_OFFSET		0x1C </span><span class="cm">/* Status */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_USR0_OFFSET		0x20 </span><span class="cm">/* User IP specific word0 */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_USR1_OFFSET		0x24 </span><span class="cm">/* User IP specific word1 */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_USR2_OFFSET		0x28 </span><span class="cm">/* User IP specific word2 */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_USR3_OFFSET		0x2C </span><span class="cm">/* User IP specific word3 */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_USR4_OFFSET		0x30 </span><span class="cm">/* User IP specific word4 */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_ID_OFFSET		0x34 </span><span class="cm">/* Sw ID */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_HAS_STSCNTRL_OFFSET	0x38 </span><span class="cm">/* Whether has stscntrl strm */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_HAS_DRE_OFFSET	0x3C </span><span class="cm">/* Whether has DRE */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_BD_HAS_DRE_SHIFT	8 </span><span class="cm">/* Whether has DRE shift */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_HAS_DRE_MASK		0xF00 </span><span class="cm">/* Whether has DRE mask */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_WORDLEN_MASK		0xFF </span><span class="cm">/* Whether has DRE mask */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_BD_CTRL_LENGTH_MASK	0x007FFFFF </span><span class="cm">/* Requested len */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_CTRL_TXSOF_MASK	0x08000000 </span><span class="cm">/* First tx packet */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_CTRL_TXEOF_MASK	0x04000000 </span><span class="cm">/* Last tx packet */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_CTRL_ALL_MASK	0x0C000000 </span><span class="cm">/* All control bits */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_DELAY_MASK		0xFF000000 </span><span class="cm">/* Delay timeout counter */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_COALESCE_MASK		0x00FF0000 </span><span class="cm">/* Coalesce counter */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_DELAY_SHIFT		24</span>
<span class="cp">#define XAXIDMA_COALESCE_SHIFT		16</span>

<span class="cp">#define XAXIDMA_IRQ_IOC_MASK		0x00001000 </span><span class="cm">/* Completion intr */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_IRQ_DELAY_MASK		0x00002000 </span><span class="cm">/* Delay interrupt */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_IRQ_ERROR_MASK		0x00004000 </span><span class="cm">/* Error interrupt */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_IRQ_ALL_MASK		0x00007000 </span><span class="cm">/* All interrupts */</span><span class="cp"></span>

<span class="cm">/* Default TX/RX Threshold and waitbound values for SGDMA mode */</span>
<span class="cp">#define XAXIDMA_DFT_TX_THRESHOLD	24</span>
<span class="cp">#define XAXIDMA_DFT_TX_WAITBOUND	254</span>
<span class="cp">#define XAXIDMA_DFT_RX_THRESHOLD	24</span>
<span class="cp">#define XAXIDMA_DFT_RX_WAITBOUND	254</span>

<span class="cp">#define XAXIDMA_BD_CTRL_TXSOF_MASK	0x08000000 </span><span class="cm">/* First tx packet */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_CTRL_TXEOF_MASK	0x04000000 </span><span class="cm">/* Last tx packet */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_CTRL_ALL_MASK	0x0C000000 </span><span class="cm">/* All control bits */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_BD_STS_ACTUAL_LEN_MASK	0x007FFFFF </span><span class="cm">/* Actual len */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_COMPLETE_MASK	0x80000000 </span><span class="cm">/* Completed */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_DEC_ERR_MASK	0x40000000 </span><span class="cm">/* Decode error */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_SLV_ERR_MASK	0x20000000 </span><span class="cm">/* Slave error */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_INT_ERR_MASK	0x10000000 </span><span class="cm">/* Internal err */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_ALL_ERR_MASK	0x70000000 </span><span class="cm">/* All errors */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_RXSOF_MASK	0x08000000 </span><span class="cm">/* First rx pkt */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_RXEOF_MASK	0x04000000 </span><span class="cm">/* Last rx pkt */</span><span class="cp"></span>
<span class="cp">#define XAXIDMA_BD_STS_ALL_MASK		0xFC000000 </span><span class="cm">/* All status bits */</span><span class="cp"></span>

<span class="cp">#define XAXIDMA_BD_MINIMUM_ALIGNMENT	0x40</span>

<span class="cm">/* Axi Ethernet registers definition */</span>
<span class="cp">#define XAE_RAF_OFFSET		0x00000000 </span><span class="cm">/* Reset and Address filter */</span><span class="cp"></span>
<span class="cp">#define XAE_TPF_OFFSET		0x00000004 </span><span class="cm">/* Tx Pause Frame */</span><span class="cp"></span>
<span class="cp">#define XAE_IFGP_OFFSET		0x00000008 </span><span class="cm">/* Tx Inter-frame gap adjustment*/</span><span class="cp"></span>
<span class="cp">#define XAE_IS_OFFSET		0x0000000C </span><span class="cm">/* Interrupt status */</span><span class="cp"></span>
<span class="cp">#define XAE_IP_OFFSET		0x00000010 </span><span class="cm">/* Interrupt pending */</span><span class="cp"></span>
<span class="cp">#define XAE_IE_OFFSET		0x00000014 </span><span class="cm">/* Interrupt enable */</span><span class="cp"></span>
<span class="cp">#define XAE_TTAG_OFFSET		0x00000018 </span><span class="cm">/* Tx VLAN TAG */</span><span class="cp"></span>
<span class="cp">#define XAE_RTAG_OFFSET		0x0000001C </span><span class="cm">/* Rx VLAN TAG */</span><span class="cp"></span>
<span class="cp">#define XAE_UAWL_OFFSET		0x00000020 </span><span class="cm">/* Unicast address word lower */</span><span class="cp"></span>
<span class="cp">#define XAE_UAWU_OFFSET		0x00000024 </span><span class="cm">/* Unicast address word upper */</span><span class="cp"></span>
<span class="cp">#define XAE_TPID0_OFFSET	0x00000028 </span><span class="cm">/* VLAN TPID0 register */</span><span class="cp"></span>
<span class="cp">#define XAE_TPID1_OFFSET	0x0000002C </span><span class="cm">/* VLAN TPID1 register */</span><span class="cp"></span>
<span class="cp">#define XAE_PPST_OFFSET		0x00000030 </span><span class="cm">/* PCS PMA Soft Temac Status Reg */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW0_OFFSET		0x00000400 </span><span class="cm">/* Rx Configuration Word 0 */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_OFFSET		0x00000404 </span><span class="cm">/* Rx Configuration Word 1 */</span><span class="cp"></span>
<span class="cp">#define XAE_TC_OFFSET		0x00000408 </span><span class="cm">/* Tx Configuration */</span><span class="cp"></span>
<span class="cp">#define XAE_FCC_OFFSET		0x0000040C </span><span class="cm">/* Flow Control Configuration */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_OFFSET		0x00000410 </span><span class="cm">/* EMAC mode configuration */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_OFFSET		0x00000414 </span><span class="cm">/* RGMII/SGMII configuration */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MC_OFFSET	0x00000500 </span><span class="cm">/* MII Management Config */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_OFFSET	0x00000504 </span><span class="cm">/* MII Management Control */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MWD_OFFSET	0x00000508 </span><span class="cm">/* MII Management Write Data */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MRD_OFFSET	0x0000050C </span><span class="cm">/* MII Management Read Data */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MIS_OFFSET	0x00000600 </span><span class="cm">/* MII Management Interrupt Status */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MIP_OFFSET	0x00000620 </span><span class="cm">/* MII Mgmt Interrupt Pending</span>
<span class="cm">					    * register offset */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MIE_OFFSET	0x00000640 </span><span class="cm">/* MII Management Interrupt Enable</span>
<span class="cm">					    * register offset */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MIC_OFFSET	0x00000660 </span><span class="cm">/* MII Management Interrupt Clear</span>
<span class="cm">					    * register offset. */</span><span class="cp"></span>
<span class="cp">#define XAE_UAW0_OFFSET		0x00000700 </span><span class="cm">/* Unicast address word 0 */</span><span class="cp"></span>
<span class="cp">#define XAE_UAW1_OFFSET		0x00000704 </span><span class="cm">/* Unicast address word 1 */</span><span class="cp"></span>
<span class="cp">#define XAE_FMI_OFFSET		0x00000708 </span><span class="cm">/* Filter Mask Index */</span><span class="cp"></span>
<span class="cp">#define XAE_AF0_OFFSET		0x00000710 </span><span class="cm">/* Address Filter 0 */</span><span class="cp"></span>
<span class="cp">#define XAE_AF1_OFFSET		0x00000714 </span><span class="cm">/* Address Filter 1 */</span><span class="cp"></span>

<span class="cp">#define XAE_TX_VLAN_DATA_OFFSET 0x00004000 </span><span class="cm">/* TX VLAN data table address */</span><span class="cp"></span>
<span class="cp">#define XAE_RX_VLAN_DATA_OFFSET 0x00008000 </span><span class="cm">/* RX VLAN data table address */</span><span class="cp"></span>
<span class="cp">#define XAE_MCAST_TABLE_OFFSET	0x00020000 </span><span class="cm">/* Multicast table address */</span><span class="cp"></span>

<span class="cm">/* Bit Masks for Axi Ethernet RAF register */</span>
<span class="cp">#define XAE_RAF_MCSTREJ_MASK		0x00000002 </span><span class="cm">/* Reject receive multicast</span>
<span class="cm">						    * destination address */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_BCSTREJ_MASK		0x00000004 </span><span class="cm">/* Reject receive broadcast</span>
<span class="cm">						    * destination address */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_TXVTAGMODE_MASK		0x00000018 </span><span class="cm">/* Tx VLAN TAG mode */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_RXVTAGMODE_MASK		0x00000060 </span><span class="cm">/* Rx VLAN TAG mode */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_TXVSTRPMODE_MASK	0x00000180 </span><span class="cm">/* Tx VLAN STRIP mode */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_RXVSTRPMODE_MASK	0x00000600 </span><span class="cm">/* Rx VLAN STRIP mode */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_NEWFNCENBL_MASK		0x00000800 </span><span class="cm">/* New function mode */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_EMULTIFLTRENBL_MASK	0x00001000 </span><span class="cm">/* Exteneded Multicast</span>
<span class="cm">						    * Filtering mode</span>
<span class="cm">						    */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_STATSRST_MASK		0x00002000 </span><span class="cm">/* Stats. Counter Reset */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_RXBADFRMEN_MASK		0x00004000 </span><span class="cm">/* Recv Bad Frame Enable */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_TXVTAGMODE_SHIFT	3 </span><span class="cm">/* Tx Tag mode shift bits */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_RXVTAGMODE_SHIFT	5 </span><span class="cm">/* Rx Tag mode shift bits */</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_TXVSTRPMODE_SHIFT	7 </span><span class="cm">/* Tx strip mode shift bits*/</span><span class="cp"></span>
<span class="cp">#define XAE_RAF_RXVSTRPMODE_SHIFT	9 </span><span class="cm">/* Rx Strip mode shift bits*/</span><span class="cp"></span>

<span class="cm">/* Bit Masks for Axi Ethernet TPF and IFGP registers */</span>
<span class="cp">#define XAE_TPF_TPFV_MASK		0x0000FFFF </span><span class="cm">/* Tx pause frame value */</span><span class="cp"></span>
<span class="cp">#define XAE_IFGP0_IFGP_MASK		0x0000007F </span><span class="cm">/* Transmit inter-frame</span>
<span class="cm">						    * gap adjustment value */</span><span class="cp"></span>

<span class="cm">/* Bit Masks for Axi Ethernet IS, IE and IP registers, Same masks apply</span>
<span class="cm"> * for all 3 registers. */</span>
<span class="cp">#define XAE_INT_HARDACSCMPLT_MASK	0x00000001 </span><span class="cm">/* Hard register access</span>
<span class="cm">						    * complete */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_AUTONEG_MASK		0x00000002 </span><span class="cm">/* Auto negotiation</span>
<span class="cm">						    * complete */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_RXCMPIT_MASK		0x00000004 </span><span class="cm">/* Rx complete */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_RXRJECT_MASK		0x00000008 </span><span class="cm">/* Rx frame rejected */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_RXFIFOOVR_MASK		0x00000010 </span><span class="cm">/* Rx fifo overrun */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_TXCMPIT_MASK		0x00000020 </span><span class="cm">/* Tx complete */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_RXDCMLOCK_MASK		0x00000040 </span><span class="cm">/* Rx Dcm Lock */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_MGTRDY_MASK		0x00000080 </span><span class="cm">/* MGT clock Lock */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_PHYRSTCMPLT_MASK	0x00000100 </span><span class="cm">/* Phy Reset complete */</span><span class="cp"></span>
<span class="cp">#define XAE_INT_ALL_MASK		0x0000003F </span><span class="cm">/* All the ints */</span><span class="cp"></span>

<span class="cp">#define XAE_INT_RECV_ERROR_MASK				\</span>
<span class="cp">	(XAE_INT_RXRJECT_MASK | XAE_INT_RXFIFOOVR_MASK) </span><span class="cm">/* INT bits that</span>
<span class="cm">							 * indicate receive</span>
<span class="cm">							 * errors */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet VLAN TPID Word 0 register */</span>
<span class="cp">#define XAE_TPID_0_MASK		0x0000FFFF </span><span class="cm">/* TPID 0 */</span><span class="cp"></span>
<span class="cp">#define XAE_TPID_1_MASK		0xFFFF0000 </span><span class="cm">/* TPID 1 */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet VLAN TPID Word 1 register */</span>
<span class="cp">#define XAE_TPID_2_MASK		0x0000FFFF </span><span class="cm">/* TPID 0 */</span><span class="cp"></span>
<span class="cp">#define XAE_TPID_3_MASK		0xFFFF0000 </span><span class="cm">/* TPID 1 */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet RCW1 register */</span>
<span class="cp">#define XAE_RCW1_RST_MASK	0x80000000 </span><span class="cm">/* Reset */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_JUM_MASK	0x40000000 </span><span class="cm">/* Jumbo frame enable */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_FCS_MASK	0x20000000 </span><span class="cm">/* In-Band FCS enable</span>
<span class="cm">					    * (FCS not stripped) */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_RX_MASK	0x10000000 </span><span class="cm">/* Receiver enable */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_VLAN_MASK	0x08000000 </span><span class="cm">/* VLAN frame enable */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_LT_DIS_MASK	0x02000000 </span><span class="cm">/* Length/type field valid check</span>
<span class="cm">					    * disable */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_CL_DIS_MASK	0x01000000 </span><span class="cm">/* Control frame Length check</span>
<span class="cm">					    * disable */</span><span class="cp"></span>
<span class="cp">#define XAE_RCW1_PAUSEADDR_MASK 0x0000FFFF </span><span class="cm">/* Pause frame source address</span>
<span class="cm">					    * bits [47:32]. Bits [31:0] are</span>
<span class="cm">					    * stored in register RCW0 */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet TC register */</span>
<span class="cp">#define XAE_TC_RST_MASK		0x80000000 </span><span class="cm">/* Reset */</span><span class="cp"></span>
<span class="cp">#define XAE_TC_JUM_MASK		0x40000000 </span><span class="cm">/* Jumbo frame enable */</span><span class="cp"></span>
<span class="cp">#define XAE_TC_FCS_MASK		0x20000000 </span><span class="cm">/* In-Band FCS enable</span>
<span class="cm">					    * (FCS not generated) */</span><span class="cp"></span>
<span class="cp">#define XAE_TC_TX_MASK		0x10000000 </span><span class="cm">/* Transmitter enable */</span><span class="cp"></span>
<span class="cp">#define XAE_TC_VLAN_MASK	0x08000000 </span><span class="cm">/* VLAN frame enable */</span><span class="cp"></span>
<span class="cp">#define XAE_TC_IFG_MASK		0x02000000 </span><span class="cm">/* Inter-frame gap adjustment</span>
<span class="cm">					    * enable */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet FCC register */</span>
<span class="cp">#define XAE_FCC_FCRX_MASK	0x20000000 </span><span class="cm">/* Rx flow control enable */</span><span class="cp"></span>
<span class="cp">#define XAE_FCC_FCTX_MASK	0x40000000 </span><span class="cm">/* Tx flow control enable */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet EMMC register */</span>
<span class="cp">#define XAE_EMMC_LINKSPEED_MASK	0xC0000000 </span><span class="cm">/* Link speed */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_RGMII_MASK	0x20000000 </span><span class="cm">/* RGMII mode enable */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_SGMII_MASK	0x10000000 </span><span class="cm">/* SGMII mode enable */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_GPCS_MASK	0x08000000 </span><span class="cm">/* 1000BaseX mode enable */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_HOST_MASK	0x04000000 </span><span class="cm">/* Host interface enable */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_TX16BIT	0x02000000 </span><span class="cm">/* 16 bit Tx client enable */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_RX16BIT	0x01000000 </span><span class="cm">/* 16 bit Rx client enable */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_LINKSPD_10	0x00000000 </span><span class="cm">/* Link Speed mask for 10 Mbit */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_LINKSPD_100	0x40000000 </span><span class="cm">/* Link Speed mask for 100 Mbit */</span><span class="cp"></span>
<span class="cp">#define XAE_EMMC_LINKSPD_1000	0x80000000 </span><span class="cm">/* Link Speed mask for 1000 Mbit */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet PHYC register */</span>
<span class="cp">#define XAE_PHYC_SGMIILINKSPEED_MASK	0xC0000000 </span><span class="cm">/* SGMII link speed mask*/</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_RGMIILINKSPEED_MASK	0x0000000C </span><span class="cm">/* RGMII link speed */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_RGMIIHD_MASK		0x00000002 </span><span class="cm">/* RGMII Half-duplex */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_RGMIILINK_MASK		0x00000001 </span><span class="cm">/* RGMII link status */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_RGLINKSPD_10		0x00000000 </span><span class="cm">/* RGMII link 10 Mbit */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_RGLINKSPD_100		0x00000004 </span><span class="cm">/* RGMII link 100 Mbit */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_RGLINKSPD_1000		0x00000008 </span><span class="cm">/* RGMII link 1000 Mbit */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_SGLINKSPD_10		0x00000000 </span><span class="cm">/* SGMII link 10 Mbit */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_SGLINKSPD_100		0x40000000 </span><span class="cm">/* SGMII link 100 Mbit */</span><span class="cp"></span>
<span class="cp">#define XAE_PHYC_SGLINKSPD_1000		0x80000000 </span><span class="cm">/* SGMII link 1000 Mbit */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet MDIO interface MC register */</span>
<span class="cp">#define XAE_MDIO_MC_MDIOEN_MASK		0x00000040 </span><span class="cm">/* MII management enable */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MC_CLOCK_DIVIDE_MAX	0x3F	   </span><span class="cm">/* Maximum MDIO divisor */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet MDIO interface MCR register */</span>
<span class="cp">#define XAE_MDIO_MCR_PHYAD_MASK		0x1F000000 </span><span class="cm">/* Phy Address Mask */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_PHYAD_SHIFT	24	   </span><span class="cm">/* Phy Address Shift */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_REGAD_MASK		0x001F0000 </span><span class="cm">/* Reg Address Mask */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_REGAD_SHIFT	16	   </span><span class="cm">/* Reg Address Shift */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_OP_MASK		0x0000C000 </span><span class="cm">/* Operation Code Mask */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_OP_SHIFT		13	   </span><span class="cm">/* Operation Code Shift */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_OP_READ_MASK	0x00008000 </span><span class="cm">/* Op Code Read Mask */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_OP_WRITE_MASK	0x00004000 </span><span class="cm">/* Op Code Write Mask */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_INITIATE_MASK	0x00000800 </span><span class="cm">/* Ready Mask */</span><span class="cp"></span>
<span class="cp">#define XAE_MDIO_MCR_READY_MASK		0x00000080 </span><span class="cm">/* Ready Mask */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet MDIO interface MIS, MIP, MIE, MIC registers */</span>
<span class="cp">#define XAE_MDIO_INT_MIIM_RDY_MASK	0x00000001 </span><span class="cm">/* MIIM Interrupt */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet UAW1 register */</span>
<span class="cp">#define XAE_UAW1_UNICASTADDR_MASK	0x0000FFFF </span><span class="cm">/* Station address bits</span>
<span class="cm">						    * [47:32]; Station address</span>
<span class="cm">						    * bits [31:0] are stored in</span>
<span class="cm">						    * register UAW0 */</span><span class="cp"></span>

<span class="cm">/* Bit masks for Axi Ethernet FMI register */</span>
<span class="cp">#define XAE_FMI_PM_MASK			0x80000000 </span><span class="cm">/* Promis. mode enable */</span><span class="cp"></span>
<span class="cp">#define XAE_FMI_IND_MASK		0x00000003 </span><span class="cm">/* Index Mask */</span><span class="cp"></span>

<span class="cp">#define XAE_MDIO_DIV_DFT		29 </span><span class="cm">/* Default MDIO clock divisor */</span><span class="cp"></span>

<span class="cm">/* Defines for different options for C_PHY_TYPE parameter in Axi Ethernet IP */</span>
<span class="cp">#define XAE_PHY_TYPE_MII		0</span>
<span class="cp">#define XAE_PHY_TYPE_GMII		1</span>
<span class="cp">#define XAE_PHY_TYPE_RGMII_1_3		2</span>
<span class="cp">#define XAE_PHY_TYPE_RGMII_2_0		3</span>
<span class="cp">#define XAE_PHY_TYPE_SGMII		4</span>
<span class="cp">#define XAE_PHY_TYPE_1000BASE_X		5</span>

<span class="cp">#define XAE_MULTICAST_CAM_TABLE_NUM	4 </span><span class="cm">/* Total number of entries in the</span>
<span class="cm">					   * hardware multicast table. */</span><span class="cp"></span>

<span class="cm">/* Axi Ethernet Synthesis features */</span>
<span class="cp">#define XAE_FEATURE_PARTIAL_RX_CSUM	(1 &lt;&lt; 0)</span>
<span class="cp">#define XAE_FEATURE_PARTIAL_TX_CSUM	(1 &lt;&lt; 1)</span>
<span class="cp">#define XAE_FEATURE_FULL_RX_CSUM	(1 &lt;&lt; 2)</span>
<span class="cp">#define XAE_FEATURE_FULL_TX_CSUM	(1 &lt;&lt; 3)</span>

<span class="cp">#define XAE_NO_CSUM_OFFLOAD		0</span>

<span class="cp">#define XAE_FULL_CSUM_STATUS_MASK	0x00000038</span>
<span class="cp">#define XAE_IP_UDP_CSUM_VALIDATED	0x00000003</span>
<span class="cp">#define XAE_IP_TCP_CSUM_VALIDATED	0x00000002</span>

<span class="cp">#define DELAY_OF_ONE_MILLISEC		1000</span>

<span class="cm">/**</span>
<span class="cm"> * struct axidma_bd - Axi Dma buffer descriptor layout</span>
<span class="cm"> * @next:         MM2S/S2MM Next Descriptor Pointer</span>
<span class="cm"> * @reserved1:    Reserved and not used</span>
<span class="cm"> * @phys:         MM2S/S2MM Buffer Address</span>
<span class="cm"> * @reserved2:    Reserved and not used</span>
<span class="cm"> * @reserved3:    Reserved and not used</span>
<span class="cm"> * @reserved4:    Reserved and not used</span>
<span class="cm"> * @cntrl:        MM2S/S2MM Control value</span>
<span class="cm"> * @status:       MM2S/S2MM Status value</span>
<span class="cm"> * @app0:         MM2S/S2MM User Application Field 0.</span>
<span class="cm"> * @app1:         MM2S/S2MM User Application Field 1.</span>
<span class="cm"> * @app2:         MM2S/S2MM User Application Field 2.</span>
<span class="cm"> * @app3:         MM2S/S2MM User Application Field 3.</span>
<span class="cm"> * @app4:         MM2S/S2MM User Application Field 4.</span>
<span class="cm"> * @sw_id_offset: MM2S/S2MM Sw ID</span>
<span class="cm"> * @reserved5:    Reserved and not used</span>
<span class="cm"> * @reserved6:    Reserved and not used</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">axidma_bd</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">next</span><span class="p">;</span>	<span class="cm">/* Physical address of next buffer descriptor */</span>
	<span class="n">u32</span> <span class="n">reserved1</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">phys</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved2</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cntrl</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">app0</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">app1</span><span class="p">;</span>	<span class="cm">/* TX start &lt;&lt; 16 | insert */</span>
	<span class="n">u32</span> <span class="n">app2</span><span class="p">;</span>	<span class="cm">/* TX csum seed */</span>
	<span class="n">u32</span> <span class="n">app3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">app4</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sw_id_offset</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved5</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reserved6</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct axienet_local - axienet private per device data</span>
<span class="cm"> * @ndev:	Pointer for net_device to which it will be attached.</span>
<span class="cm"> * @dev:	Pointer to device structure</span>
<span class="cm"> * @phy_dev:	Pointer to PHY device structure attached to the axienet_local</span>
<span class="cm"> * @phy_node:	Pointer to device node structure</span>
<span class="cm"> * @mii_bus:	Pointer to MII bus structure</span>
<span class="cm"> * @mdio_irqs:	IRQs table for MDIO bus required in mii_bus structure</span>
<span class="cm"> * @regs:	Base address for the axienet_local device address space</span>
<span class="cm"> * @dma_regs:	Base address for the axidma device address space</span>
<span class="cm"> * @dma_err_tasklet: Tasklet structure to process Axi DMA errors</span>
<span class="cm"> * @tx_irq:	Axidma TX IRQ number</span>
<span class="cm"> * @rx_irq:	Axidma RX IRQ number</span>
<span class="cm"> * @temac_type:	axienet type to identify between soft and hard temac</span>
<span class="cm"> * @phy_type:	Phy type to identify between MII/GMII/RGMII/SGMII/1000 Base-X</span>
<span class="cm"> * @options:	AxiEthernet option word</span>
<span class="cm"> * @last_link:	Phy link state in which the PHY was negotiated earlier</span>
<span class="cm"> * @features:	Stores the extended features supported by the axienet hw</span>
<span class="cm"> * @tx_bd_v:	Virtual address of the TX buffer descriptor ring</span>
<span class="cm"> * @tx_bd_p:	Physical address(start address) of the TX buffer descr. ring</span>
<span class="cm"> * @rx_bd_v:	Virtual address of the RX buffer descriptor ring</span>
<span class="cm"> * @rx_bd_p:	Physical address(start address) of the RX buffer descr. ring</span>
<span class="cm"> * @tx_bd_ci:	Stores the index of the Tx buffer descriptor in the ring being</span>
<span class="cm"> *		accessed currently. Used while alloc. BDs before a TX starts</span>
<span class="cm"> * @tx_bd_tail:	Stores the index of the Tx buffer descriptor in the ring being</span>
<span class="cm"> *		accessed currently. Used while processing BDs after the TX</span>
<span class="cm"> *		completed.</span>
<span class="cm"> * @rx_bd_ci:	Stores the index of the Rx buffer descriptor in the ring being</span>
<span class="cm"> *		accessed currently.</span>
<span class="cm"> * @max_frm_size: Stores the maximum size of the frame that can be that</span>
<span class="cm"> *		  Txed/Rxed in the existing hardware. If jumbo option is</span>
<span class="cm"> *		  supported, the maximum frame size would be 9k. Else it is</span>
<span class="cm"> *		  1522 bytes (assuming support for basic VLAN)</span>
<span class="cm"> * @jumbo_support: Stores hardware configuration for jumbo support. If hardware</span>
<span class="cm"> *		   can handle jumbo packets, this entry will be 1, else 0.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">axienet_local</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">ndev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>

	<span class="cm">/* Connection to PHY device */</span>
	<span class="k">struct</span> <span class="n">phy_device</span> <span class="o">*</span><span class="n">phy_dev</span><span class="p">;</span>	<span class="cm">/* Pointer to PHY device */</span>
	<span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">phy_node</span><span class="p">;</span>

	<span class="cm">/* MDIO bus data */</span>
	<span class="k">struct</span> <span class="n">mii_bus</span> <span class="o">*</span><span class="n">mii_bus</span><span class="p">;</span>	<span class="cm">/* MII bus reference */</span>
	<span class="kt">int</span> <span class="n">mdio_irqs</span><span class="p">[</span><span class="n">PHY_MAX_ADDR</span><span class="p">];</span>	<span class="cm">/* IRQs table for MDIO bus */</span>

	<span class="cm">/* IO registers, dma functions and IRQs */</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">regs</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">dma_regs</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">dma_err_tasklet</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">tx_irq</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rx_irq</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">temac_type</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">phy_type</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">options</span><span class="p">;</span>			<span class="cm">/* Current options word */</span>
	<span class="n">u32</span> <span class="n">last_link</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">features</span><span class="p">;</span>

	<span class="cm">/* Buffer descriptors */</span>
	<span class="k">struct</span> <span class="n">axidma_bd</span> <span class="o">*</span><span class="n">tx_bd_v</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">tx_bd_p</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">axidma_bd</span> <span class="o">*</span><span class="n">rx_bd_v</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">rx_bd_p</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_bd_ci</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">tx_bd_tail</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_bd_ci</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">max_frm_size</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">jumbo_support</span><span class="p">;</span>

	<span class="kt">int</span> <span class="n">csum_offload_on_tx_path</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">csum_offload_on_rx_path</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">coalesce_count_rx</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">coalesce_count_tx</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * struct axiethernet_option - Used to set axi ethernet hardware options</span>
<span class="cm"> * @opt:	Option to be set.</span>
<span class="cm"> * @reg:	Register offset to be written for setting the option</span>
<span class="cm"> * @m_or:	Mask to be ORed for setting the option in the register</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">axienet_option</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">opt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">reg</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">m_or</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/**</span>
<span class="cm"> * axienet_ior - Memory mapped Axi Ethernet register read</span>
<span class="cm"> * @lp:         Pointer to axienet local structure</span>
<span class="cm"> * @offset:     Address offset from the base address of Axi Ethernet core</span>
<span class="cm"> *</span>
<span class="cm"> * returns: The contents of the Axi Ethernet register</span>
<span class="cm"> *</span>
<span class="cm"> * This function returns the contents of the corresponding register.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u32</span> <span class="nf">axienet_ior</span><span class="p">(</span><span class="k">struct</span> <span class="n">axienet_local</span> <span class="o">*</span><span class="n">lp</span><span class="p">,</span> <span class="kt">off_t</span> <span class="n">offset</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">in_be32</span><span class="p">(</span><span class="n">lp</span><span class="o">-&gt;</span><span class="n">regs</span> <span class="o">+</span> <span class="n">offset</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * axienet_iow - Memory mapped Axi Ethernet register write</span>
<span class="cm"> * @lp:         Pointer to axienet local structure</span>
<span class="cm"> * @offset:     Address offset from the base address of Axi Ethernet core</span>
<span class="cm"> * @value:      Value to be written into the Axi Ethernet register</span>
<span class="cm"> *</span>
<span class="cm"> * This function writes the desired value into the corresponding Axi Ethernet</span>
<span class="cm"> * register.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">axienet_iow</span><span class="p">(</span><span class="k">struct</span> <span class="n">axienet_local</span> <span class="o">*</span><span class="n">lp</span><span class="p">,</span> <span class="kt">off_t</span> <span class="n">offset</span><span class="p">,</span>
			       <span class="n">u32</span> <span class="n">value</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">out_be32</span><span class="p">((</span><span class="n">lp</span><span class="o">-&gt;</span><span class="n">regs</span> <span class="o">+</span> <span class="n">offset</span><span class="p">),</span> <span class="n">value</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/* Function prototypes visible in xilinx_axienet_mdio.c for other files */</span>
<span class="kt">int</span> <span class="n">axienet_mdio_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">axienet_local</span> <span class="o">*</span><span class="n">lp</span><span class="p">,</span> <span class="k">struct</span> <span class="n">device_node</span> <span class="o">*</span><span class="n">np</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">axienet_mdio_wait_until_ready</span><span class="p">(</span><span class="k">struct</span> <span class="n">axienet_local</span> <span class="o">*</span><span class="n">lp</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">axienet_mdio_teardown</span><span class="p">(</span><span class="k">struct</span> <span class="n">axienet_local</span> <span class="o">*</span><span class="n">lp</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* XILINX_AXI_ENET_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
