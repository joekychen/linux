<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › chelsio › cxgb › mv88e1xxx.c

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>mv88e1xxx.c</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* $Date: 2005/10/24 23:18:13 $ $RCSfile: mv88e1xxx.c,v $ $Revision: 1.49 $ */</span>
<span class="cp">#include &quot;common.h&quot;</span>
<span class="cp">#include &quot;mv88e1xxx.h&quot;</span>
<span class="cp">#include &quot;cphy.h&quot;</span>
<span class="cp">#include &quot;elmer0.h&quot;</span>

<span class="cm">/* MV88E1XXX MDI crossover register values */</span>
<span class="cp">#define CROSSOVER_MDI   0</span>
<span class="cp">#define CROSSOVER_MDIX  1</span>
<span class="cp">#define CROSSOVER_AUTO  3</span>

<span class="cp">#define INTR_ENABLE_MASK 0x6CA0</span>

<span class="cm">/*</span>
<span class="cm"> * Set the bits given by &#39;bitval&#39; in PHY register &#39;reg&#39;.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">mdio_set_bit</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u32</span> <span class="n">bitval</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">val</span><span class="p">;</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">);</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">val</span> <span class="o">|</span> <span class="n">bitval</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Clear the bits given by &#39;bitval&#39; in PHY register &#39;reg&#39;.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">void</span> <span class="nf">mdio_clear_bit</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reg</span><span class="p">,</span> <span class="n">u32</span> <span class="n">bitval</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">val</span><span class="p">;</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">);</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">val</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">bitval</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * NAME:   phy_reset</span>
<span class="cm"> *</span>
<span class="cm"> * DESC:   Reset the given PHY&#39;s port. NOTE: This is not a global</span>
<span class="cm"> *         chip reset.</span>
<span class="cm"> *</span>
<span class="cm"> * PARAMS: cphy     - Pointer to PHY instance data.</span>
<span class="cm"> *</span>
<span class="cm"> * RETURN:  0 - Successful reset.</span>
<span class="cm"> *         -1 - Timeout.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">wait</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">ctl</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">time_out</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>

	<span class="n">mdio_set_bit</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="n">BMCR_RESET</span><span class="p">);</span>

	<span class="k">do</span> <span class="p">{</span>
		<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ctl</span><span class="p">);</span>
		<span class="n">ctl</span> <span class="o">&amp;=</span> <span class="n">BMCR_RESET</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">ctl</span><span class="p">)</span>
			<span class="n">udelay</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">ctl</span> <span class="o">&amp;&amp;</span> <span class="o">--</span><span class="n">time_out</span><span class="p">);</span>

	<span class="k">return</span> <span class="n">ctl</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_interrupt_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* Enable PHY interrupts. */</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MV88E1XXX_INTERRUPT_ENABLE_REGISTER</span><span class="p">,</span>
		   <span class="n">INTR_ENABLE_MASK</span><span class="p">);</span>

	<span class="cm">/* Enable Marvell interrupts through Elmer0. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">t1_is_asic</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">elmer</span><span class="p">;</span>

		<span class="n">t1_tpi_read</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">,</span> <span class="n">A_ELMER0_INT_ENABLE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">elmer</span><span class="p">);</span>
		<span class="n">elmer</span> <span class="o">|=</span> <span class="n">ELMER0_GP_BIT1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">is_T2</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">))</span>
		    <span class="n">elmer</span> <span class="o">|=</span> <span class="n">ELMER0_GP_BIT2</span> <span class="o">|</span> <span class="n">ELMER0_GP_BIT3</span> <span class="o">|</span> <span class="n">ELMER0_GP_BIT4</span><span class="p">;</span>
		<span class="n">t1_tpi_write</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">,</span> <span class="n">A_ELMER0_INT_ENABLE</span><span class="p">,</span> <span class="n">elmer</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_interrupt_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="cm">/* Disable all phy interrupts. */</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MV88E1XXX_INTERRUPT_ENABLE_REGISTER</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

	<span class="cm">/* Disable Marvell interrupts through Elmer0. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">t1_is_asic</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">elmer</span><span class="p">;</span>

		<span class="n">t1_tpi_read</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">,</span> <span class="n">A_ELMER0_INT_ENABLE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">elmer</span><span class="p">);</span>
		<span class="n">elmer</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">ELMER0_GP_BIT1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">is_T2</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">))</span>
		    <span class="n">elmer</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">ELMER0_GP_BIT2</span><span class="o">|</span><span class="n">ELMER0_GP_BIT3</span><span class="o">|</span><span class="n">ELMER0_GP_BIT4</span><span class="p">);</span>
		<span class="n">t1_tpi_write</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">,</span> <span class="n">A_ELMER0_INT_ENABLE</span><span class="p">,</span> <span class="n">elmer</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_interrupt_clear</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">elmer</span><span class="p">;</span>

	<span class="cm">/* Clear PHY interrupts by reading the register. */</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
			<span class="n">MV88E1XXX_INTERRUPT_STATUS_REGISTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">elmer</span><span class="p">);</span>

	<span class="cm">/* Clear Marvell interrupts through Elmer0. */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">t1_is_asic</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">))</span> <span class="p">{</span>
		<span class="n">t1_tpi_read</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">,</span> <span class="n">A_ELMER0_INT_CAUSE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">elmer</span><span class="p">);</span>
		<span class="n">elmer</span> <span class="o">|=</span> <span class="n">ELMER0_GP_BIT1</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">is_T2</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">))</span>
		    <span class="n">elmer</span> <span class="o">|=</span> <span class="n">ELMER0_GP_BIT2</span><span class="o">|</span><span class="n">ELMER0_GP_BIT3</span><span class="o">|</span><span class="n">ELMER0_GP_BIT4</span><span class="p">;</span>
		<span class="n">t1_tpi_write</span><span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">adapter</span><span class="p">,</span> <span class="n">A_ELMER0_INT_CAUSE</span><span class="p">,</span> <span class="n">elmer</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/*</span>
<span class="cm"> * Set the PHY speed and duplex.  This also disables auto-negotiation, except</span>
<span class="cm"> * for 1Gb/s, where auto-negotiation is mandatory.</span>
<span class="cm"> */</span>
<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_set_speed_duplex</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">speed</span><span class="p">,</span> <span class="kt">int</span> <span class="n">duplex</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">ctl</span><span class="p">;</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">phy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ctl</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">speed</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ctl</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">BMCR_SPEED100</span> <span class="o">|</span> <span class="n">BMCR_SPEED1000</span> <span class="o">|</span> <span class="n">BMCR_ANENABLE</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">speed</span> <span class="o">==</span> <span class="n">SPEED_100</span><span class="p">)</span>
			<span class="n">ctl</span> <span class="o">|=</span> <span class="n">BMCR_SPEED100</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">speed</span> <span class="o">==</span> <span class="n">SPEED_1000</span><span class="p">)</span>
			<span class="n">ctl</span> <span class="o">|=</span> <span class="n">BMCR_SPEED1000</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">duplex</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">ctl</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">BMCR_FULLDPLX</span> <span class="o">|</span> <span class="n">BMCR_ANENABLE</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">duplex</span> <span class="o">==</span> <span class="n">DUPLEX_FULL</span><span class="p">)</span>
			<span class="n">ctl</span> <span class="o">|=</span> <span class="n">BMCR_FULLDPLX</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">ctl</span> <span class="o">&amp;</span> <span class="n">BMCR_SPEED1000</span><span class="p">)</span>  <span class="cm">/* auto-negotiation required for 1Gb/s */</span>
		<span class="n">ctl</span> <span class="o">|=</span> <span class="n">BMCR_ANENABLE</span><span class="p">;</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">phy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="n">ctl</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_crossover_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">crossover</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">data32</span><span class="p">;</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
			<span class="n">MV88E1XXX_SPECIFIC_CNTRL_REGISTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">data32</span><span class="p">);</span>
	<span class="n">data32</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">V_PSCR_MDI_XOVER_MODE</span><span class="p">(</span><span class="n">M_PSCR_MDI_XOVER_MODE</span><span class="p">);</span>
	<span class="n">data32</span> <span class="o">|=</span> <span class="n">V_PSCR_MDI_XOVER_MODE</span><span class="p">(</span><span class="n">crossover</span><span class="p">);</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
			<span class="n">MV88E1XXX_SPECIFIC_CNTRL_REGISTER</span><span class="p">,</span> <span class="n">data32</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_autoneg_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">ctl</span><span class="p">;</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">mv88e1xxx_crossover_set</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">CROSSOVER_AUTO</span><span class="p">);</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ctl</span><span class="p">);</span>
	<span class="cm">/* restart autoneg for change to take effect */</span>
	<span class="n">ctl</span> <span class="o">|=</span> <span class="n">BMCR_ANENABLE</span> <span class="o">|</span> <span class="n">BMCR_ANRESTART</span><span class="p">;</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="n">ctl</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_autoneg_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">ctl</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * Crossover *must* be set to manual in order to disable auto-neg.</span>
<span class="cm">	 * The Alaska FAQs document highlights this point.</span>
<span class="cm">	 */</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">mv88e1xxx_crossover_set</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">CROSSOVER_MDI</span><span class="p">);</span>

	<span class="cm">/*</span>
<span class="cm">	 * Must include autoneg reset when disabling auto-neg. This</span>
<span class="cm">	 * is described in the Alaska FAQ document.</span>
<span class="cm">	 */</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ctl</span><span class="p">);</span>
	<span class="n">ctl</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">BMCR_ANENABLE</span><span class="p">;</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="n">ctl</span> <span class="o">|</span> <span class="n">BMCR_ANRESTART</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_autoneg_restart</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">mdio_set_bit</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="n">BMCR_ANRESTART</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_advertise</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">phy</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">advertise_map</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span>
	    <span class="p">(</span><span class="n">ADVERTISED_1000baseT_Half</span> <span class="o">|</span> <span class="n">ADVERTISED_1000baseT_Full</span><span class="p">))</span> <span class="p">{</span>
		<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">phy</span><span class="p">,</span> <span class="n">MII_GBCR</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">);</span>
		<span class="n">val</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">GBCR_ADV_1000HALF</span> <span class="o">|</span> <span class="n">GBCR_ADV_1000FULL</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_1000baseT_Half</span><span class="p">)</span>
			<span class="n">val</span> <span class="o">|=</span> <span class="n">GBCR_ADV_1000HALF</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_1000baseT_Full</span><span class="p">)</span>
			<span class="n">val</span> <span class="o">|=</span> <span class="n">GBCR_ADV_1000FULL</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">phy</span><span class="p">,</span> <span class="n">MII_GBCR</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>

	<span class="n">val</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_10baseT_Half</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">ADVERTISE_10HALF</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_10baseT_Full</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">ADVERTISE_10FULL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_100baseT_Half</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">ADVERTISE_100HALF</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_100baseT_Full</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">ADVERTISE_100FULL</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_PAUSE</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">ADVERTISE_PAUSE</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">advertise_map</span> <span class="o">&amp;</span> <span class="n">ADVERTISED_ASYM_PAUSE</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">ADVERTISE_PAUSE_ASYM</span><span class="p">;</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">phy</span><span class="p">,</span> <span class="n">MII_ADVERTISE</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_set_loopback</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">on</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">on</span><span class="p">)</span>
		<span class="n">mdio_set_bit</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="n">BMCR_LOOPBACK</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="n">mdio_clear_bit</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">MII_BMCR</span><span class="p">,</span> <span class="n">BMCR_LOOPBACK</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_get_link_status</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">link_ok</span><span class="p">,</span>
				     <span class="kt">int</span> <span class="o">*</span><span class="n">speed</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">duplex</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">fc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">sp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dplx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">pause</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
			<span class="n">MV88E1XXX_SPECIFIC_STATUS_REGISTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">status</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">status</span> <span class="o">&amp;</span> <span class="n">V_PSSR_STATUS_RESOLVED</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">&amp;</span> <span class="n">V_PSSR_RX_PAUSE</span><span class="p">)</span>
			<span class="n">pause</span> <span class="o">|=</span> <span class="n">PAUSE_RX</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">&amp;</span> <span class="n">V_PSSR_TX_PAUSE</span><span class="p">)</span>
			<span class="n">pause</span> <span class="o">|=</span> <span class="n">PAUSE_TX</span><span class="p">;</span>
		<span class="n">dplx</span> <span class="o">=</span> <span class="p">(</span><span class="n">status</span> <span class="o">&amp;</span> <span class="n">V_PSSR_DUPLEX</span><span class="p">)</span> <span class="o">?</span> <span class="n">DUPLEX_FULL</span> <span class="o">:</span> <span class="n">DUPLEX_HALF</span><span class="p">;</span>
		<span class="n">sp</span> <span class="o">=</span> <span class="n">G_PSSR_SPEED</span><span class="p">(</span><span class="n">status</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">sp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="n">SPEED_10</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">sp</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="n">SPEED_100</span><span class="p">;</span>
		<span class="k">else</span>
			<span class="n">sp</span> <span class="o">=</span> <span class="n">SPEED_1000</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">link_ok</span><span class="p">)</span>
		<span class="o">*</span><span class="n">link_ok</span> <span class="o">=</span> <span class="p">(</span><span class="n">status</span> <span class="o">&amp;</span> <span class="n">V_PSSR_LINK</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">speed</span><span class="p">)</span>
		<span class="o">*</span><span class="n">speed</span> <span class="o">=</span> <span class="n">sp</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">duplex</span><span class="p">)</span>
		<span class="o">*</span><span class="n">duplex</span> <span class="o">=</span> <span class="n">dplx</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">fc</span><span class="p">)</span>
		<span class="o">*</span><span class="n">fc</span> <span class="o">=</span> <span class="n">pause</span><span class="p">;</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_downshift_set</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">,</span> <span class="kt">int</span> <span class="n">downshift_enable</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">u32</span> <span class="n">val</span><span class="p">;</span>

	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
		<span class="n">MV88E1XXX_EXT_PHY_SPECIFIC_CNTRL_REGISTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">val</span><span class="p">);</span>

	<span class="cm">/*</span>
<span class="cm">	 * Set the downshift counter to 2 so we try to establish Gb link</span>
<span class="cm">	 * twice before downshifting.</span>
<span class="cm">	 */</span>
	<span class="n">val</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="p">(</span><span class="n">V_DOWNSHIFT_ENABLE</span> <span class="o">|</span> <span class="n">V_DOWNSHIFT_CNT</span><span class="p">(</span><span class="n">M_DOWNSHIFT_CNT</span><span class="p">));</span>

	<span class="k">if</span> <span class="p">(</span><span class="n">downshift_enable</span><span class="p">)</span>
		<span class="n">val</span> <span class="o">|=</span> <span class="n">V_DOWNSHIFT_ENABLE</span> <span class="o">|</span> <span class="n">V_DOWNSHIFT_CNT</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
			<span class="n">MV88E1XXX_EXT_PHY_SPECIFIC_CNTRL_REGISTER</span><span class="p">,</span> <span class="n">val</span><span class="p">);</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_interrupt_handler</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">cphy_cause</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">status</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * Loop until cause reads zero. Need to handle bouncing interrupts.</span>
<span class="cm">	 */</span>
	<span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">u32</span> <span class="n">cause</span><span class="p">;</span>

		<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
				<span class="n">MV88E1XXX_INTERRUPT_STATUS_REGISTER</span><span class="p">,</span>
				<span class="o">&amp;</span><span class="n">cause</span><span class="p">);</span>
		<span class="n">cause</span> <span class="o">&amp;=</span> <span class="n">INTR_ENABLE_MASK</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cause</span><span class="p">)</span>
			<span class="k">break</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">cause</span> <span class="o">&amp;</span> <span class="n">MV88E1XXX_INTR_LINK_CHNG</span><span class="p">)</span> <span class="p">{</span>
			<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_read</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
				<span class="n">MV88E1XXX_SPECIFIC_STATUS_REGISTER</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">status</span><span class="p">);</span>

			<span class="k">if</span> <span class="p">(</span><span class="n">status</span> <span class="o">&amp;</span> <span class="n">MV88E1XXX_INTR_LINK_CHNG</span><span class="p">)</span>
				<span class="n">cphy</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">|=</span> <span class="n">PHY_LINK_UP</span><span class="p">;</span>
			<span class="k">else</span> <span class="p">{</span>
				<span class="n">cphy</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">PHY_LINK_UP</span><span class="p">;</span>
				<span class="k">if</span> <span class="p">(</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">&amp;</span> <span class="n">PHY_AUTONEG_EN</span><span class="p">)</span>
					<span class="n">cphy</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">PHY_AUTONEG_RDY</span><span class="p">;</span>
				<span class="n">cphy_cause</span> <span class="o">|=</span> <span class="n">cphy_cause_link_change</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="p">}</span>

		<span class="k">if</span> <span class="p">(</span><span class="n">cause</span> <span class="o">&amp;</span> <span class="n">MV88E1XXX_INTR_AUTONEG_DONE</span><span class="p">)</span>
			<span class="n">cphy</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">|=</span> <span class="n">PHY_AUTONEG_RDY</span><span class="p">;</span>

		<span class="k">if</span> <span class="p">((</span><span class="n">cphy</span><span class="o">-&gt;</span><span class="n">state</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">PHY_LINK_UP</span> <span class="o">|</span> <span class="n">PHY_AUTONEG_RDY</span><span class="p">))</span> <span class="o">==</span>
			<span class="p">(</span><span class="n">PHY_LINK_UP</span> <span class="o">|</span> <span class="n">PHY_AUTONEG_RDY</span><span class="p">))</span>
				<span class="n">cphy_cause</span> <span class="o">|=</span> <span class="n">cphy_cause_link_change</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">cphy_cause</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">mv88e1xxx_destroy</span><span class="p">(</span><span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">kfree</span><span class="p">(</span><span class="n">cphy</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">cphy_ops</span> <span class="n">mv88e1xxx_ops</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">destroy</span>              <span class="o">=</span> <span class="n">mv88e1xxx_destroy</span><span class="p">,</span>
	<span class="p">.</span><span class="n">reset</span>                <span class="o">=</span> <span class="n">mv88e1xxx_reset</span><span class="p">,</span>
	<span class="p">.</span><span class="n">interrupt_enable</span>     <span class="o">=</span> <span class="n">mv88e1xxx_interrupt_enable</span><span class="p">,</span>
	<span class="p">.</span><span class="n">interrupt_disable</span>    <span class="o">=</span> <span class="n">mv88e1xxx_interrupt_disable</span><span class="p">,</span>
	<span class="p">.</span><span class="n">interrupt_clear</span>      <span class="o">=</span> <span class="n">mv88e1xxx_interrupt_clear</span><span class="p">,</span>
	<span class="p">.</span><span class="n">interrupt_handler</span>    <span class="o">=</span> <span class="n">mv88e1xxx_interrupt_handler</span><span class="p">,</span>
	<span class="p">.</span><span class="n">autoneg_enable</span>       <span class="o">=</span> <span class="n">mv88e1xxx_autoneg_enable</span><span class="p">,</span>
	<span class="p">.</span><span class="n">autoneg_disable</span>      <span class="o">=</span> <span class="n">mv88e1xxx_autoneg_disable</span><span class="p">,</span>
	<span class="p">.</span><span class="n">autoneg_restart</span>      <span class="o">=</span> <span class="n">mv88e1xxx_autoneg_restart</span><span class="p">,</span>
	<span class="p">.</span><span class="n">advertise</span>            <span class="o">=</span> <span class="n">mv88e1xxx_advertise</span><span class="p">,</span>
	<span class="p">.</span><span class="n">set_loopback</span>         <span class="o">=</span> <span class="n">mv88e1xxx_set_loopback</span><span class="p">,</span>
	<span class="p">.</span><span class="n">set_speed_duplex</span>     <span class="o">=</span> <span class="n">mv88e1xxx_set_speed_duplex</span><span class="p">,</span>
	<span class="p">.</span><span class="n">get_link_status</span>      <span class="o">=</span> <span class="n">mv88e1xxx_get_link_status</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">static</span> <span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="nf">mv88e1xxx_phy_create</span><span class="p">(</span><span class="k">struct</span> <span class="n">net_device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span> <span class="kt">int</span> <span class="n">phy_addr</span><span class="p">,</span>
					 <span class="k">const</span> <span class="k">struct</span> <span class="n">mdio_ops</span> <span class="o">*</span><span class="n">mdio_ops</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="n">adapter</span> <span class="o">=</span> <span class="n">netdev_priv</span><span class="p">(</span><span class="n">dev</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">cphy</span> <span class="o">*</span><span class="n">cphy</span> <span class="o">=</span> <span class="n">kzalloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">cphy</span><span class="p">),</span> <span class="n">GFP_KERNEL</span><span class="p">);</span>

	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">cphy</span><span class="p">)</span>
		<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>

	<span class="n">cphy_init</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">phy_addr</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">mv88e1xxx_ops</span><span class="p">,</span> <span class="n">mdio_ops</span><span class="p">);</span>

	<span class="cm">/* Configure particular PHY&#39;s to run in a different mode. */</span>
	<span class="k">if</span> <span class="p">((</span><span class="n">board_info</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">caps</span> <span class="o">&amp;</span> <span class="n">SUPPORTED_TP</span><span class="p">)</span> <span class="o">&amp;&amp;</span>
	    <span class="n">board_info</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">chip_phy</span> <span class="o">==</span> <span class="n">CHBT_PHY_88E1111</span><span class="p">)</span> <span class="p">{</span>
		<span class="cm">/*</span>
<span class="cm">		 * Configure the PHY transmitter as class A to reduce EMI.</span>
<span class="cm">		 */</span>
		<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
				<span class="n">MV88E1XXX_EXTENDED_ADDR_REGISTER</span><span class="p">,</span> <span class="mh">0xB</span><span class="p">);</span>
		<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
				<span class="n">MV88E1XXX_EXTENDED_REGISTER</span><span class="p">,</span> <span class="mh">0x8004</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">mv88e1xxx_downshift_set</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>   <span class="cm">/* Enable downshift */</span>

	<span class="cm">/* LED */</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">is_T2</span><span class="p">(</span><span class="n">adapter</span><span class="p">))</span> <span class="p">{</span>
		<span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="n">simple_mdio_write</span><span class="p">(</span><span class="n">cphy</span><span class="p">,</span>
				<span class="n">MV88E1XXX_LED_CONTROL_REGISTER</span><span class="p">,</span> <span class="mh">0x1</span><span class="p">);</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="n">cphy</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">mv88e1xxx_phy_reset</span><span class="p">(</span><span class="n">adapter_t</span><span class="o">*</span> <span class="n">adapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">const</span> <span class="k">struct</span> <span class="n">gphy</span> <span class="n">t1_mv88e1xxx_ops</span> <span class="o">=</span> <span class="p">{</span>
	<span class="p">.</span><span class="n">create</span> <span class="o">=</span> <span class="n">mv88e1xxx_phy_create</span><span class="p">,</span>
	<span class="p">.</span><span class="n">reset</span> <span class="o">=</span>  <span class="n">mv88e1xxx_phy_reset</span>
<span class="p">};</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
