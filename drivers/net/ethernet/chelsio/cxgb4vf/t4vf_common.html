<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › chelsio › cxgb4vf › t4vf_common.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>t4vf_common.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * This file is part of the Chelsio T4 PCI-E SR-IOV Virtual Function Ethernet</span>
<span class="cm"> * driver for Linux.</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (c) 2009-2010 Chelsio Communications, Inc. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * This software is available to you under a choice of one of two</span>
<span class="cm"> * licenses.  You may choose to be licensed under the terms of the GNU</span>
<span class="cm"> * General Public License (GPL) Version 2, available from the file</span>
<span class="cm"> * COPYING in the main directory of this source tree, or the</span>
<span class="cm"> * OpenIB.org BSD license below:</span>
<span class="cm"> *</span>
<span class="cm"> *     Redistribution and use in source and binary forms, with or</span>
<span class="cm"> *     without modification, are permitted provided that the following</span>
<span class="cm"> *     conditions are met:</span>
<span class="cm"> *</span>
<span class="cm"> *      - Redistributions of source code must retain the above</span>
<span class="cm"> *        copyright notice, this list of conditions and the following</span>
<span class="cm"> *        disclaimer.</span>
<span class="cm"> *</span>
<span class="cm"> *      - Redistributions in binary form must reproduce the above</span>
<span class="cm"> *        copyright notice, this list of conditions and the following</span>
<span class="cm"> *        disclaimer in the documentation and/or other materials</span>
<span class="cm"> *        provided with the distribution.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND,</span>
<span class="cm"> * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND</span>
<span class="cm"> * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS</span>
<span class="cm"> * BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN</span>
<span class="cm"> * ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN</span>
<span class="cm"> * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span>
<span class="cm"> * SOFTWARE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __T4VF_COMMON_H__</span>
<span class="cp">#define __T4VF_COMMON_H__</span>

<span class="cp">#include &quot;../cxgb4/t4fw_api.h&quot;</span>

<span class="cm">/*</span>
<span class="cm"> * The &quot;len16&quot; field of a Firmware Command Structure ...</span>
<span class="cm"> */</span>
<span class="cp">#define FW_LEN16(fw_struct) FW_CMD_LEN16(sizeof(fw_struct) / 16)</span>

<span class="cm">/*</span>
<span class="cm"> * Per-VF statistics.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">t4vf_port_stats</span> <span class="p">{</span>
	<span class="cm">/*</span>
<span class="cm">	 * TX statistics.</span>
<span class="cm">	 */</span>
	<span class="n">u64</span> <span class="n">tx_bcast_bytes</span><span class="p">;</span>		<span class="cm">/* broadcast */</span>
	<span class="n">u64</span> <span class="n">tx_bcast_frames</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_mcast_bytes</span><span class="p">;</span>		<span class="cm">/* multicast */</span>
	<span class="n">u64</span> <span class="n">tx_mcast_frames</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_ucast_bytes</span><span class="p">;</span>		<span class="cm">/* unicast */</span>
	<span class="n">u64</span> <span class="n">tx_ucast_frames</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">tx_drop_frames</span><span class="p">;</span>		<span class="cm">/* TX dropped frames */</span>
	<span class="n">u64</span> <span class="n">tx_offload_bytes</span><span class="p">;</span>		<span class="cm">/* offload */</span>
	<span class="n">u64</span> <span class="n">tx_offload_frames</span><span class="p">;</span>

	<span class="cm">/*</span>
<span class="cm">	 * RX statistics.</span>
<span class="cm">	 */</span>
	<span class="n">u64</span> <span class="n">rx_bcast_bytes</span><span class="p">;</span>		<span class="cm">/* broadcast */</span>
	<span class="n">u64</span> <span class="n">rx_bcast_frames</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_mcast_bytes</span><span class="p">;</span>		<span class="cm">/* multicast */</span>
	<span class="n">u64</span> <span class="n">rx_mcast_frames</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_ucast_bytes</span><span class="p">;</span>
	<span class="n">u64</span> <span class="n">rx_ucast_frames</span><span class="p">;</span>		<span class="cm">/* unicast */</span>

	<span class="n">u64</span> <span class="n">rx_err_frames</span><span class="p">;</span>		<span class="cm">/* RX error frames */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Per-&quot;port&quot; (Virtual Interface) link configuration ...</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">link_config</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>   <span class="n">supported</span><span class="p">;</span>        <span class="cm">/* link capabilities */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span>   <span class="n">advertising</span><span class="p">;</span>      <span class="cm">/* advertised capabilities */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">requested_speed</span><span class="p">;</span>  <span class="cm">/* speed user has requested */</span>
	<span class="kt">unsigned</span> <span class="kt">short</span> <span class="n">speed</span><span class="p">;</span>            <span class="cm">/* actual link speed */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>  <span class="n">requested_fc</span><span class="p">;</span>     <span class="cm">/* flow control user has requested */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>  <span class="n">fc</span><span class="p">;</span>               <span class="cm">/* actual link flow control */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>  <span class="n">autoneg</span><span class="p">;</span>          <span class="cm">/* autonegotiating? */</span>
	<span class="kt">unsigned</span> <span class="kt">char</span>  <span class="n">link_ok</span><span class="p">;</span>          <span class="cm">/* link up? */</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="p">{</span>
	<span class="n">PAUSE_RX</span>      <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">PAUSE_TX</span>      <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">PAUSE_AUTONEG</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * General device parameters ...</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">dev_params</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">fwrev</span><span class="p">;</span>			<span class="cm">/* firmware version */</span>
	<span class="n">u32</span> <span class="n">tprev</span><span class="p">;</span>			<span class="cm">/* TP Microcode Version */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Scatter Gather Engine parameters.  These are almost all determined by the</span>
<span class="cm"> * Physical Function Driver.  We just need to grab them to see within which</span>
<span class="cm"> * environment we&#39;re playing ...</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">sge_params</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">sge_control</span><span class="p">;</span>		<span class="cm">/* padding, boundaries, lengths, etc. */</span>
	<span class="n">u32</span> <span class="n">sge_host_page_size</span><span class="p">;</span>		<span class="cm">/* RDMA page sizes */</span>
	<span class="n">u32</span> <span class="n">sge_queues_per_page</span><span class="p">;</span>	<span class="cm">/* RDMA queues/page */</span>
	<span class="n">u32</span> <span class="n">sge_user_mode_limits</span><span class="p">;</span>	<span class="cm">/* limits for BAR2 user mode accesses */</span>
	<span class="n">u32</span> <span class="n">sge_fl_buffer_size</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>	<span class="cm">/* free list buffer sizes */</span>
	<span class="n">u32</span> <span class="n">sge_ingress_rx_threshold</span><span class="p">;</span>	<span class="cm">/* RX counter interrupt threshold[4] */</span>
	<span class="n">u32</span> <span class="n">sge_timer_value_0_and_1</span><span class="p">;</span>	<span class="cm">/* interrupt coalescing timer values */</span>
	<span class="n">u32</span> <span class="n">sge_timer_value_2_and_3</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sge_timer_value_4_and_5</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Vital Product Data parameters.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">vpd_params</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">cclk</span><span class="p">;</span>			<span class="cm">/* Core Clock (KHz) */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Global Receive Side Scaling (RSS) parameters in host-native format.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">rss_params</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">mode</span><span class="p">;</span>		<span class="cm">/* RSS mode */</span>
	<span class="k">union</span> <span class="p">{</span>
	    <span class="k">struct</span> <span class="p">{</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">synmapen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* SYN Map Enable */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">syn4tupenipv6</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* enable hashing 4-tuple IPv6 SYNs */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">syn2tupenipv6</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* enable hashing 2-tuple IPv6 SYNs */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">syn4tupenipv4</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* enable hashing 4-tuple IPv4 SYNs */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">syn2tupenipv4</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* enable hashing 2-tuple IPv4 SYNs */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ofdmapen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Offload Map Enable */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tnlmapen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Tunnel Map Enable */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tnlalllookup</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* Tunnel All Lookup */</span>
		<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hashtoeplitz</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* use Toeplitz hash */</span>
	    <span class="p">}</span> <span class="n">basicvirtual</span><span class="p">;</span>
	<span class="p">}</span> <span class="n">u</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Virtual Interface RSS Configuration in host-native format.</span>
<span class="cm"> */</span>
<span class="k">union</span> <span class="n">rss_vi_config</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">defaultq</span><span class="p">;</span>			<span class="cm">/* Ingress Queue ID for !tnlalllookup */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ip6fourtupen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* hash 4-tuple IPv6 ingress packets */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ip6twotupen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* hash 2-tuple IPv6 ingress packets */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ip4fourtupen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* hash 4-tuple IPv4 ingress packets */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ip4twotupen</span><span class="o">:</span><span class="mi">1</span><span class="p">;</span>	<span class="cm">/* hash 2-tuple IPv4 ingress packets */</span>
	<span class="kt">int</span> <span class="n">udpen</span><span class="p">;</span>			<span class="cm">/* hash 4-tuple UDP ingress packets */</span>
    <span class="p">}</span> <span class="n">basicvirtual</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Maximum resources provisioned for a PCI VF.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">vf_resources</span> <span class="p">{</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nvi</span><span class="p">;</span>		<span class="cm">/* N virtual interfaces */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">neq</span><span class="p">;</span>		<span class="cm">/* N egress Qs */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nethctrl</span><span class="p">;</span>		<span class="cm">/* N egress ETH or CTRL Qs */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">niqflint</span><span class="p">;</span>		<span class="cm">/* N ingress Qs/w free list(s) &amp; intr */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">niq</span><span class="p">;</span>		<span class="cm">/* N ingress Qs */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tc</span><span class="p">;</span>		<span class="cm">/* PCI-E traffic class */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">pmask</span><span class="p">;</span>		<span class="cm">/* port access rights mask */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nexactf</span><span class="p">;</span>		<span class="cm">/* N exact MPS filters */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">r_caps</span><span class="p">;</span>		<span class="cm">/* read capabilities */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">wx_caps</span><span class="p">;</span>		<span class="cm">/* write/execute capabilities */</span>
<span class="p">};</span>

<span class="cm">/*</span>
<span class="cm"> * Per-&quot;adapter&quot; (Virtual Function) parameters.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">adapter_params</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">dev_params</span> <span class="n">dev</span><span class="p">;</span>		<span class="cm">/* general device parameters */</span>
	<span class="k">struct</span> <span class="n">sge_params</span> <span class="n">sge</span><span class="p">;</span>		<span class="cm">/* Scatter Gather Engine */</span>
	<span class="k">struct</span> <span class="n">vpd_params</span> <span class="n">vpd</span><span class="p">;</span>		<span class="cm">/* Vital Product Data */</span>
	<span class="k">struct</span> <span class="n">rss_params</span> <span class="n">rss</span><span class="p">;</span>		<span class="cm">/* Receive Side Scaling */</span>
	<span class="k">struct</span> <span class="n">vf_resources</span> <span class="n">vfres</span><span class="p">;</span>	<span class="cm">/* Virtual Function Resource limits */</span>
	<span class="n">u8</span> <span class="n">nports</span><span class="p">;</span>			<span class="cm">/* # of Ethernet &quot;ports&quot; */</span>
<span class="p">};</span>

<span class="cp">#include &quot;adapter.h&quot;</span>

<span class="cp">#ifndef PCI_VENDOR_ID_CHELSIO</span>
<span class="cp"># define PCI_VENDOR_ID_CHELSIO 0x1425</span>
<span class="cp">#endif</span>

<span class="cp">#define for_each_port(adapter, iter) \</span>
<span class="cp">	for (iter = 0; iter &lt; (adapter)-&gt;params.nports; iter++)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="n">bool</span> <span class="nf">is_10g_port</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">link_config</span> <span class="o">*</span><span class="n">lc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">lc</span><span class="o">-&gt;</span><span class="n">supported</span> <span class="o">&amp;</span> <span class="n">SUPPORTED_10000baseT_Full</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">core_ticks_per_usec</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">adapter</span><span class="o">-&gt;</span><span class="n">params</span><span class="p">.</span><span class="n">vpd</span><span class="p">.</span><span class="n">cclk</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">us_to_core_ticks</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span>
					    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">us</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">us</span> <span class="o">*</span> <span class="n">adapter</span><span class="o">-&gt;</span><span class="n">params</span><span class="p">.</span><span class="n">vpd</span><span class="p">.</span><span class="n">cclk</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">core_ticks_to_us</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span>
					    <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">ticks</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="p">(</span><span class="n">ticks</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="n">adapter</span><span class="o">-&gt;</span><span class="n">params</span><span class="p">.</span><span class="n">vpd</span><span class="p">.</span><span class="n">cclk</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">t4vf_wr_mbox_core</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="p">,</span> <span class="n">bool</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">t4vf_wr_mbox</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cmd</span><span class="p">,</span>
			       <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">rpl</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">t4vf_wr_mbox_core</span><span class="p">(</span><span class="n">adapter</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rpl</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">t4vf_wr_mbox_ns</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="n">adapter</span><span class="p">,</span> <span class="k">const</span> <span class="kt">void</span> <span class="o">*</span><span class="n">cmd</span><span class="p">,</span>
				  <span class="kt">int</span> <span class="n">size</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">rpl</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">t4vf_wr_mbox_core</span><span class="p">(</span><span class="n">adapter</span><span class="p">,</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">rpl</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="n">__devinit</span> <span class="n">t4vf_wait_dev_ready</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">__devinit</span> <span class="n">t4vf_port_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">t4vf_fw_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_query_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="n">u32</span> <span class="o">*</span><span class="p">,</span> <span class="n">u32</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_set_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="n">u32</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="n">u32</span> <span class="o">*</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">t4vf_get_sge_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_get_vpd_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_get_dev_params</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_get_rss_glb_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_get_vfres</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">t4vf_read_rss_vi_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>
			    <span class="k">union</span> <span class="n">rss_vi_config</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_write_rss_vi_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>
			     <span class="k">union</span> <span class="n">rss_vi_config</span> <span class="o">*</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_config_rss_range</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span>
			  <span class="k">const</span> <span class="n">u16</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">t4vf_alloc_vi</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_free_vi</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_enable_vi</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="n">bool</span><span class="p">,</span> <span class="n">bool</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_identify_port</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">t4vf_set_rxmode</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span>
		    <span class="n">bool</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_alloc_mac_filt</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="n">bool</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>
			<span class="k">const</span> <span class="n">u8</span> <span class="o">**</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="p">,</span> <span class="n">u64</span> <span class="o">*</span><span class="p">,</span> <span class="n">bool</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_change_mac</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="p">,</span> <span class="n">bool</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_set_addr_hash</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="n">bool</span><span class="p">,</span> <span class="n">u64</span><span class="p">,</span> <span class="n">bool</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_get_port_stats</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span> <span class="k">struct</span> <span class="n">t4vf_port_stats</span> <span class="o">*</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">t4vf_iq_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">,</span>
		 <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">t4vf_eth_eq_free</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">int</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">t4vf_handle_fw_rpl</span><span class="p">(</span><span class="k">struct</span> <span class="n">adapter</span> <span class="o">*</span><span class="p">,</span> <span class="k">const</span> <span class="n">__be64</span> <span class="o">*</span><span class="p">);</span>

<span class="cp">#endif </span><span class="cm">/* __T4VF_COMMON_H__ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
