<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › ethernet › stmicro › stmmac › dwmac1000.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>dwmac1000.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*******************************************************************************</span>
<span class="cm">  Copyright (C) 2007-2009  STMicroelectronics Ltd</span>

<span class="cm">  This program is free software; you can redistribute it and/or modify it</span>
<span class="cm">  under the terms and conditions of the GNU General Public License,</span>
<span class="cm">  version 2, as published by the Free Software Foundation.</span>

<span class="cm">  This program is distributed in the hope it will be useful, but WITHOUT</span>
<span class="cm">  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<span class="cm">  FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for</span>
<span class="cm">  more details.</span>

<span class="cm">  You should have received a copy of the GNU General Public License along with</span>
<span class="cm">  this program; if not, write to the Free Software Foundation, Inc.,</span>
<span class="cm">  51 Franklin St - Fifth Floor, Boston, MA 02110-1301 USA.</span>

<span class="cm">  The full GNU General Public License is included in this distribution in</span>
<span class="cm">  the file called &quot;COPYING&quot;.</span>

<span class="cm">  Author: Giuseppe Cavallaro &lt;peppe.cavallaro@st.com&gt;</span>
<span class="cm">*******************************************************************************/</span>

<span class="cp">#include &lt;linux/phy.h&gt;</span>
<span class="cp">#include &quot;common.h&quot;</span>

<span class="cp">#define GMAC_CONTROL		0x00000000	</span><span class="cm">/* Configuration */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER	0x00000004	</span><span class="cm">/* Frame Filter */</span><span class="cp"></span>
<span class="cp">#define GMAC_HASH_HIGH		0x00000008	</span><span class="cm">/* Multicast Hash Table High */</span><span class="cp"></span>
<span class="cp">#define GMAC_HASH_LOW		0x0000000c	</span><span class="cm">/* Multicast Hash Table Low */</span><span class="cp"></span>
<span class="cp">#define GMAC_MII_ADDR		0x00000010	</span><span class="cm">/* MII Address */</span><span class="cp"></span>
<span class="cp">#define GMAC_MII_DATA		0x00000014	</span><span class="cm">/* MII Data */</span><span class="cp"></span>
<span class="cp">#define GMAC_FLOW_CTRL		0x00000018	</span><span class="cm">/* Flow Control */</span><span class="cp"></span>
<span class="cp">#define GMAC_VLAN_TAG		0x0000001c	</span><span class="cm">/* VLAN Tag */</span><span class="cp"></span>
<span class="cp">#define GMAC_VERSION		0x00000020	</span><span class="cm">/* GMAC CORE Version */</span><span class="cp"></span>
<span class="cp">#define GMAC_WAKEUP_FILTER	0x00000028	</span><span class="cm">/* Wake-up Frame Filter */</span><span class="cp"></span>

<span class="cp">#define GMAC_INT_STATUS		0x00000038	</span><span class="cm">/* interrupt status register */</span><span class="cp"></span>
<span class="k">enum</span> <span class="n">dwmac1000_irq_status</span> <span class="p">{</span>
	<span class="n">time_stamp_irq</span> <span class="o">=</span> <span class="mh">0x0200</span><span class="p">,</span>
	<span class="n">mmc_rx_csum_offload_irq</span> <span class="o">=</span> <span class="mh">0x0080</span><span class="p">,</span>
	<span class="n">mmc_tx_irq</span> <span class="o">=</span> <span class="mh">0x0040</span><span class="p">,</span>
	<span class="n">mmc_rx_irq</span> <span class="o">=</span> <span class="mh">0x0020</span><span class="p">,</span>
	<span class="n">mmc_irq</span> <span class="o">=</span> <span class="mh">0x0010</span><span class="p">,</span>
	<span class="n">pmt_irq</span> <span class="o">=</span> <span class="mh">0x0008</span><span class="p">,</span>
	<span class="n">pcs_ane_irq</span> <span class="o">=</span> <span class="mh">0x0004</span><span class="p">,</span>
	<span class="n">pcs_link_irq</span> <span class="o">=</span> <span class="mh">0x0002</span><span class="p">,</span>
	<span class="n">rgmii_irq</span> <span class="o">=</span> <span class="mh">0x0001</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define GMAC_INT_MASK		0x0000003c	</span><span class="cm">/* interrupt mask register */</span><span class="cp"></span>

<span class="cm">/* PMT Control and Status */</span>
<span class="cp">#define GMAC_PMT		0x0000002c</span>
<span class="k">enum</span> <span class="n">power_event</span> <span class="p">{</span>
	<span class="n">pointer_reset</span> <span class="o">=</span> <span class="mh">0x80000000</span><span class="p">,</span>
	<span class="n">global_unicast</span> <span class="o">=</span> <span class="mh">0x00000200</span><span class="p">,</span>
	<span class="n">wake_up_rx_frame</span> <span class="o">=</span> <span class="mh">0x00000040</span><span class="p">,</span>
	<span class="n">magic_frame</span> <span class="o">=</span> <span class="mh">0x00000020</span><span class="p">,</span>
	<span class="n">wake_up_frame_en</span> <span class="o">=</span> <span class="mh">0x00000004</span><span class="p">,</span>
	<span class="n">magic_pkt_en</span> <span class="o">=</span> <span class="mh">0x00000002</span><span class="p">,</span>
	<span class="n">power_down</span> <span class="o">=</span> <span class="mh">0x00000001</span><span class="p">,</span>
<span class="p">};</span>

<span class="cm">/* GMAC HW ADDR regs */</span>
<span class="cp">#define GMAC_ADDR_HIGH(reg)	(((reg &gt; 15) ? 0x00000800 : 0x00000040) + \</span>
<span class="cp">				(reg * 8))</span>
<span class="cp">#define GMAC_ADDR_LOW(reg)	(((reg &gt; 15) ? 0x00000804 : 0x00000044) + \</span>
<span class="cp">				(reg * 8))</span>
<span class="cp">#define GMAC_MAX_PERFECT_ADDRESSES	32</span>

<span class="cp">#define GMAC_AN_CTRL	0x000000c0	</span><span class="cm">/* AN control */</span><span class="cp"></span>
<span class="cp">#define GMAC_AN_STATUS	0x000000c4	</span><span class="cm">/* AN status */</span><span class="cp"></span>
<span class="cp">#define GMAC_ANE_ADV	0x000000c8	</span><span class="cm">/* Auto-Neg. Advertisement */</span><span class="cp"></span>
<span class="cp">#define GMAC_ANE_LINK	0x000000cc	</span><span class="cm">/* Auto-Neg. link partener ability */</span><span class="cp"></span>
<span class="cp">#define GMAC_ANE_EXP	0x000000d0	</span><span class="cm">/* ANE expansion */</span><span class="cp"></span>
<span class="cp">#define GMAC_TBI	0x000000d4	</span><span class="cm">/* TBI extend status */</span><span class="cp"></span>
<span class="cp">#define GMAC_GMII_STATUS 0x000000d8	</span><span class="cm">/* S/R-GMII status */</span><span class="cp"></span>

<span class="cm">/* GMAC Configuration defines */</span>
<span class="cp">#define GMAC_CONTROL_TC	0x01000000	</span><span class="cm">/* Transmit Conf. in RGMII/SGMII */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_WD	0x00800000	</span><span class="cm">/* Disable Watchdog on receive */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_JD	0x00400000	</span><span class="cm">/* Jabber disable */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_BE	0x00200000	</span><span class="cm">/* Frame Burst Enable */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_JE	0x00100000	</span><span class="cm">/* Jumbo frame */</span><span class="cp"></span>
<span class="k">enum</span> <span class="n">inter_frame_gap</span> <span class="p">{</span>
	<span class="n">GMAC_CONTROL_IFG_88</span> <span class="o">=</span> <span class="mh">0x00040000</span><span class="p">,</span>
	<span class="n">GMAC_CONTROL_IFG_80</span> <span class="o">=</span> <span class="mh">0x00020000</span><span class="p">,</span>
	<span class="n">GMAC_CONTROL_IFG_40</span> <span class="o">=</span> <span class="mh">0x000e0000</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define GMAC_CONTROL_DCRS	0x00010000 </span><span class="cm">/* Disable carrier sense during tx */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_PS		0x00008000 </span><span class="cm">/* Port Select 0:GMI 1:MII */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_FES	0x00004000 </span><span class="cm">/* Speed 0:10 1:100 */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_DO		0x00002000 </span><span class="cm">/* Disable Rx Own */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_LM		0x00001000 </span><span class="cm">/* Loop-back mode */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_DM		0x00000800 </span><span class="cm">/* Duplex Mode */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_IPC	0x00000400 </span><span class="cm">/* Checksum Offload */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_DR		0x00000200 </span><span class="cm">/* Disable Retry */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_LUD	0x00000100 </span><span class="cm">/* Link up/down */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_ACS	0x00000080 </span><span class="cm">/* Automatic Pad/FCS Stripping */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_DC		0x00000010 </span><span class="cm">/* Deferral Check */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_TE		0x00000008 </span><span class="cm">/* Transmitter Enable */</span><span class="cp"></span>
<span class="cp">#define GMAC_CONTROL_RE		0x00000004 </span><span class="cm">/* Receiver Enable */</span><span class="cp"></span>

<span class="cp">#define GMAC_CORE_INIT (GMAC_CONTROL_JD | GMAC_CONTROL_PS | GMAC_CONTROL_ACS | \</span>
<span class="cp">			GMAC_CONTROL_JE | GMAC_CONTROL_BE)</span>

<span class="cm">/* GMAC Frame Filter defines */</span>
<span class="cp">#define GMAC_FRAME_FILTER_PR	0x00000001	</span><span class="cm">/* Promiscuous Mode */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_HUC	0x00000002	</span><span class="cm">/* Hash Unicast */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_HMC	0x00000004	</span><span class="cm">/* Hash Multicast */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_DAIF	0x00000008	</span><span class="cm">/* DA Inverse Filtering */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_PM	0x00000010	</span><span class="cm">/* Pass all multicast */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_DBF	0x00000020	</span><span class="cm">/* Disable Broadcast frames */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_SAIF	0x00000100	</span><span class="cm">/* Inverse Filtering */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_SAF	0x00000200	</span><span class="cm">/* Source Address Filter */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_HPF	0x00000400	</span><span class="cm">/* Hash or perfect Filter */</span><span class="cp"></span>
<span class="cp">#define GMAC_FRAME_FILTER_RA	0x80000000	</span><span class="cm">/* Receive all mode */</span><span class="cp"></span>
<span class="cm">/* GMII ADDR  defines */</span>
<span class="cp">#define GMAC_MII_ADDR_WRITE	0x00000002	</span><span class="cm">/* MII Write */</span><span class="cp"></span>
<span class="cp">#define GMAC_MII_ADDR_BUSY	0x00000001	</span><span class="cm">/* MII Busy */</span><span class="cp"></span>
<span class="cm">/* GMAC FLOW CTRL defines */</span>
<span class="cp">#define GMAC_FLOW_CTRL_PT_MASK	0xffff0000	</span><span class="cm">/* Pause Time Mask */</span><span class="cp"></span>
<span class="cp">#define GMAC_FLOW_CTRL_PT_SHIFT	16</span>
<span class="cp">#define GMAC_FLOW_CTRL_RFE	0x00000004	</span><span class="cm">/* Rx Flow Control Enable */</span><span class="cp"></span>
<span class="cp">#define GMAC_FLOW_CTRL_TFE	0x00000002	</span><span class="cm">/* Tx Flow Control Enable */</span><span class="cp"></span>
<span class="cp">#define GMAC_FLOW_CTRL_FCB_BPA	0x00000001	</span><span class="cm">/* Flow Control Busy ... */</span><span class="cp"></span>

<span class="cm">/*--- DMA BLOCK defines ---*/</span>
<span class="cm">/* DMA Bus Mode register defines */</span>
<span class="cp">#define DMA_BUS_MODE_SFT_RESET	0x00000001	</span><span class="cm">/* Software Reset */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_MODE_DA		0x00000002	</span><span class="cm">/* Arbitration scheme */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_MODE_DSL_MASK	0x0000007c	</span><span class="cm">/* Descriptor Skip Length */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_MODE_DSL_SHIFT	2	</span><span class="cm">/*   (in DWORDS)      */</span><span class="cp"></span>
<span class="cm">/* Programmable burst length (passed thorugh platform)*/</span>
<span class="cp">#define DMA_BUS_MODE_PBL_MASK	0x00003f00	</span><span class="cm">/* Programmable Burst Len */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_MODE_PBL_SHIFT	8</span>

<span class="k">enum</span> <span class="n">rx_tx_priority_ratio</span> <span class="p">{</span>
	<span class="n">double_ratio</span> <span class="o">=</span> <span class="mh">0x00004000</span><span class="p">,</span>	<span class="cm">/*2:1 */</span>
	<span class="n">triple_ratio</span> <span class="o">=</span> <span class="mh">0x00008000</span><span class="p">,</span>	<span class="cm">/*3:1 */</span>
	<span class="n">quadruple_ratio</span> <span class="o">=</span> <span class="mh">0x0000c000</span><span class="p">,</span>	<span class="cm">/*4:1 */</span>
<span class="p">};</span>

<span class="cp">#define DMA_BUS_MODE_FB		0x00010000	</span><span class="cm">/* Fixed burst */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_MODE_MB		0x04000000	</span><span class="cm">/* Mixed burst */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_MODE_RPBL_MASK	0x003e0000	</span><span class="cm">/* Rx-Programmable Burst Len */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_MODE_RPBL_SHIFT	17</span>
<span class="cp">#define DMA_BUS_MODE_USP	0x00800000</span>
<span class="cp">#define DMA_BUS_MODE_PBL	0x01000000</span>
<span class="cp">#define DMA_BUS_MODE_AAL	0x02000000</span>

<span class="cm">/* DMA CRS Control and Status Register Mapping */</span>
<span class="cp">#define DMA_HOST_TX_DESC	  0x00001048	</span><span class="cm">/* Current Host Tx descriptor */</span><span class="cp"></span>
<span class="cp">#define DMA_HOST_RX_DESC	  0x0000104c	</span><span class="cm">/* Current Host Rx descriptor */</span><span class="cp"></span>
<span class="cm">/*  DMA Bus Mode register defines */</span>
<span class="cp">#define DMA_BUS_PR_RATIO_MASK	  0x0000c000	</span><span class="cm">/* Rx/Tx priority ratio */</span><span class="cp"></span>
<span class="cp">#define DMA_BUS_PR_RATIO_SHIFT	  14</span>
<span class="cp">#define DMA_BUS_FB	  	  0x00010000	</span><span class="cm">/* Fixed Burst */</span><span class="cp"></span>

<span class="cm">/* DMA operation mode defines (start/stop tx/rx are placed in common header)*/</span>
<span class="cp">#define DMA_CONTROL_DT		0x04000000 </span><span class="cm">/* Disable Drop TCP/IP csum error */</span><span class="cp"></span>
<span class="cp">#define DMA_CONTROL_RSF		0x02000000 </span><span class="cm">/* Receive Store and Forward */</span><span class="cp"></span>
<span class="cp">#define DMA_CONTROL_DFF		0x01000000 </span><span class="cm">/* Disaable flushing */</span><span class="cp"></span>
<span class="cm">/* Threshold for Activating the FC */</span>
<span class="k">enum</span> <span class="n">rfa</span> <span class="p">{</span>
	<span class="n">act_full_minus_1</span> <span class="o">=</span> <span class="mh">0x00800000</span><span class="p">,</span>
	<span class="n">act_full_minus_2</span> <span class="o">=</span> <span class="mh">0x00800200</span><span class="p">,</span>
	<span class="n">act_full_minus_3</span> <span class="o">=</span> <span class="mh">0x00800400</span><span class="p">,</span>
	<span class="n">act_full_minus_4</span> <span class="o">=</span> <span class="mh">0x00800600</span><span class="p">,</span>
<span class="p">};</span>
<span class="cm">/* Threshold for Deactivating the FC */</span>
<span class="k">enum</span> <span class="n">rfd</span> <span class="p">{</span>
	<span class="n">deac_full_minus_1</span> <span class="o">=</span> <span class="mh">0x00400000</span><span class="p">,</span>
	<span class="n">deac_full_minus_2</span> <span class="o">=</span> <span class="mh">0x00400800</span><span class="p">,</span>
	<span class="n">deac_full_minus_3</span> <span class="o">=</span> <span class="mh">0x00401000</span><span class="p">,</span>
	<span class="n">deac_full_minus_4</span> <span class="o">=</span> <span class="mh">0x00401800</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define DMA_CONTROL_TSF		0x00200000 </span><span class="cm">/* Transmit  Store and Forward */</span><span class="cp"></span>

<span class="k">enum</span> <span class="n">ttc_control</span> <span class="p">{</span>
	<span class="n">DMA_CONTROL_TTC_64</span> <span class="o">=</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_TTC_128</span> <span class="o">=</span> <span class="mh">0x00004000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_TTC_192</span> <span class="o">=</span> <span class="mh">0x00008000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_TTC_256</span> <span class="o">=</span> <span class="mh">0x0000c000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_TTC_40</span> <span class="o">=</span> <span class="mh">0x00010000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_TTC_32</span> <span class="o">=</span> <span class="mh">0x00014000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_TTC_24</span> <span class="o">=</span> <span class="mh">0x00018000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_TTC_16</span> <span class="o">=</span> <span class="mh">0x0001c000</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define DMA_CONTROL_TC_TX_MASK	0xfffe3fff</span>

<span class="cp">#define DMA_CONTROL_EFC		0x00000100</span>
<span class="cp">#define DMA_CONTROL_FEF		0x00000080</span>
<span class="cp">#define DMA_CONTROL_FUF		0x00000040</span>

<span class="k">enum</span> <span class="n">rtc_control</span> <span class="p">{</span>
	<span class="n">DMA_CONTROL_RTC_64</span> <span class="o">=</span> <span class="mh">0x00000000</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_RTC_32</span> <span class="o">=</span> <span class="mh">0x00000008</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_RTC_96</span> <span class="o">=</span> <span class="mh">0x00000010</span><span class="p">,</span>
	<span class="n">DMA_CONTROL_RTC_128</span> <span class="o">=</span> <span class="mh">0x00000018</span><span class="p">,</span>
<span class="p">};</span>
<span class="cp">#define DMA_CONTROL_TC_RX_MASK	0xffffffe7</span>

<span class="cp">#define DMA_CONTROL_OSF	0x00000004	</span><span class="cm">/* Operate on second frame */</span><span class="cp"></span>

<span class="cm">/* MMC registers offset */</span>
<span class="cp">#define GMAC_MMC_CTRL      0x100</span>
<span class="cp">#define GMAC_MMC_RX_INTR   0x104</span>
<span class="cp">#define GMAC_MMC_TX_INTR   0x108</span>
<span class="cp">#define GMAC_MMC_RX_CSUM_OFFLOAD   0x208</span>

<span class="cm">/* Synopsys Core versions */</span>
<span class="cp">#define	DWMAC_CORE_3_40	34</span>

<span class="k">extern</span> <span class="k">const</span> <span class="k">struct</span> <span class="n">stmmac_dma_ops</span> <span class="n">dwmac1000_dma_ops</span><span class="p">;</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
