<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › wireless › brcm80211 › brcmsmac › types.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>types.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2010 Broadcom Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="cm"> * purpose with or without fee is hereby granted, provided that the above</span>
<span class="cm"> * copyright notice and this permission notice appear in all copies.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="cm"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY</span>
<span class="cm"> * SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="cm"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION</span>
<span class="cm"> * OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN</span>
<span class="cm"> * CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef _BRCM_TYPES_H_</span>
<span class="cp">#define _BRCM_TYPES_H_</span>

<span class="cp">#include &lt;linux/types.h&gt;</span>
<span class="cp">#include &lt;linux/io.h&gt;</span>

<span class="cp">#define WL_CHAN_FREQ_RANGE_2G      0</span>
<span class="cp">#define WL_CHAN_FREQ_RANGE_5GL     1</span>
<span class="cp">#define WL_CHAN_FREQ_RANGE_5GM     2</span>
<span class="cp">#define WL_CHAN_FREQ_RANGE_5GH     3</span>

<span class="cm">/* boardflags */</span>

<span class="cm">/* Board has gpio 9 controlling the PA */</span>
<span class="cp">#define	BFL_PACTRL		0x00000002</span>
<span class="cm">/* Not ok to power down the chip pll and oscillator */</span>
<span class="cp">#define	BFL_NOPLLDOWN		0x00000020</span>
<span class="cm">/* Board supports the Front End Module */</span>
<span class="cp">#define BFL_FEM			0x00000800</span>
<span class="cm">/* Board has an external LNA in 2.4GHz band */</span>
<span class="cp">#define BFL_EXTLNA		0x00001000</span>
<span class="cm">/* Board has no PA */</span>
<span class="cp">#define BFL_NOPA		0x00010000</span>
<span class="cm">/* Power topology uses BUCKBOOST */</span>
<span class="cp">#define BFL_BUCKBOOST		0x00200000</span>
<span class="cm">/* Board has FEM and switch to share antenna w/ BT */</span>
<span class="cp">#define BFL_FEM_BT		0x00400000</span>
<span class="cm">/* Power topology doesn&#39;t use CBUCK */</span>
<span class="cp">#define BFL_NOCBUCK		0x00800000</span>
<span class="cm">/* Power topology uses PALDO */</span>
<span class="cp">#define BFL_PALDO		0x02000000</span>
<span class="cm">/* Board has an external LNA in 5GHz band */</span>
<span class="cp">#define BFL_EXTLNA_5GHz		0x10000000</span>

<span class="cm">/* boardflags2 */</span>

<span class="cm">/* Board has an external rxbb regulator */</span>
<span class="cp">#define BFL2_RXBB_INT_REG_DIS	0x00000001</span>
<span class="cm">/* Flag to implement alternative A-band PLL settings */</span>
<span class="cp">#define BFL2_APLL_WAR		0x00000002</span>
<span class="cm">/* Board permits enabling TX Power Control */</span>
<span class="cp">#define BFL2_TXPWRCTRL_EN	0x00000004</span>
<span class="cm">/* Board supports the 2X4 diversity switch */</span>
<span class="cp">#define BFL2_2X4_DIV		0x00000008</span>
<span class="cm">/* Board supports 5G band power gain */</span>
<span class="cp">#define BFL2_5G_PWRGAIN		0x00000010</span>
<span class="cm">/* Board overrides ASPM and Clkreq settings */</span>
<span class="cp">#define BFL2_PCIEWAR_OVR	0x00000020</span>
<span class="cp">#define BFL2_LEGACY		0x00000080</span>
<span class="cm">/* 4321mcm93 board uses Skyworks FEM */</span>
<span class="cp">#define BFL2_SKWRKFEM_BRD	0x00000100</span>
<span class="cm">/* Board has a WAR for clock-harmonic spurs */</span>
<span class="cp">#define BFL2_SPUR_WAR		0x00000200</span>
<span class="cm">/* Flag to narrow G-band PLL loop b/w */</span>
<span class="cp">#define BFL2_GPLL_WAR		0x00000400</span>
<span class="cm">/* Tx CCK pkts on Ant 0 only */</span>
<span class="cp">#define BFL2_SINGLEANT_CCK	0x00001000</span>
<span class="cm">/* WAR to reduce and avoid clock-harmonic spurs in 2G */</span>
<span class="cp">#define BFL2_2G_SPUR_WAR	0x00002000</span>
<span class="cm">/* Flag to widen G-band PLL loop b/w */</span>
<span class="cp">#define BFL2_GPLL_WAR2	        0x00010000</span>
<span class="cp">#define BFL2_IPALVLSHIFT_3P3    0x00020000</span>
<span class="cm">/* Use internal envelope detector for TX IQCAL */</span>
<span class="cp">#define BFL2_INTERNDET_TXIQCAL  0x00040000</span>
<span class="cm">/* Keep the buffered Xtal output from radio &quot;ON&quot;. Most drivers will turn it</span>
<span class="cm"> * off without this flag to save power. */</span>
<span class="cp">#define BFL2_XTALBUFOUTEN       0x00080000</span>

<span class="cm">/*</span>
<span class="cm"> * board specific GPIO assignment, gpio 0-3 are also customer-configurable</span>
<span class="cm"> * led</span>
<span class="cm"> */</span>

<span class="cm">/* bit 9 controls the PA on new 4306 boards */</span>
<span class="cp">#define	BOARD_GPIO_PACTRL	0x200</span>
<span class="cp">#define BOARD_GPIO_12		0x1000</span>
<span class="cp">#define BOARD_GPIO_13		0x2000</span>

<span class="cm">/* **** Core type/rev defaults **** */</span>
<span class="cp">#define D11CONF		0x0fffffb0	</span><span class="cm">/* Supported  D11 revs: 4, 5, 7-27</span>
<span class="cm">					 * also need to update wlc.h MAXCOREREV</span>
<span class="cm">					 */</span><span class="cp"></span>

<span class="cp">#define NCONF		0x000001ff	</span><span class="cm">/* Supported nphy revs:</span>
<span class="cm">					 *      0       4321a0</span>
<span class="cm">					 *      1       4321a1</span>
<span class="cm">					 *      2       4321b0/b1/c0/c1</span>
<span class="cm">					 *      3       4322a0</span>
<span class="cm">					 *      4       4322a1</span>
<span class="cm">					 *      5       4716a0</span>
<span class="cm">					 *      6       43222a0, 43224a0</span>
<span class="cm">					 *      7       43226a0</span>
<span class="cm">					 *      8       5357a0, 43236a0</span>
<span class="cm">					 */</span><span class="cp"></span>

<span class="cp">#define LCNCONF		0x00000007	</span><span class="cm">/* Supported lcnphy revs:</span>
<span class="cm">					 *      0       4313a0, 4336a0, 4330a0</span>
<span class="cm">					 *      1</span>
<span class="cm">					 *      2       4330a0</span>
<span class="cm">					 */</span><span class="cp"></span>

<span class="cp">#define SSLPNCONF	0x0000000f	</span><span class="cm">/* Supported sslpnphy revs:</span>
<span class="cm">					 *      0       4329a0/k0</span>
<span class="cm">					 *      1       4329b0/4329C0</span>
<span class="cm">					 *      2       4319a0</span>
<span class="cm">					 *      3       5356a0</span>
<span class="cm">					 */</span><span class="cp"></span>

<span class="cm">/********************************************************************</span>
<span class="cm"> * Phy/Core Configuration.  Defines macros to to check core phy/rev *</span>
<span class="cm"> * compile-time configuration.  Defines default core support.       *</span>
<span class="cm"> * ******************************************************************</span>
<span class="cm"> */</span>

<span class="cm">/* Basic macros to check a configuration bitmask */</span>

<span class="cp">#define CONF_HAS(config, val)	((config) &amp; (1 &lt;&lt; (val)))</span>
<span class="cp">#define CONF_MSK(config, mask)	((config) &amp; (mask))</span>
<span class="cp">#define MSK_RANGE(low, hi)	((1 &lt;&lt; ((hi)+1)) - (1 &lt;&lt; (low)))</span>
<span class="cp">#define CONF_RANGE(config, low, hi) (CONF_MSK(config, MSK_RANGE(low, high)))</span>

<span class="cp">#define CONF_IS(config, val)	((config) == (1 &lt;&lt; (val)))</span>
<span class="cp">#define CONF_GE(config, val)	((config) &amp; (0-(1 &lt;&lt; (val))))</span>
<span class="cp">#define CONF_GT(config, val)	((config) &amp; (0-2*(1 &lt;&lt; (val))))</span>
<span class="cp">#define CONF_LT(config, val)	((config) &amp; ((1 &lt;&lt; (val))-1))</span>
<span class="cp">#define CONF_LE(config, val)	((config) &amp; (2*(1 &lt;&lt; (val))-1))</span>

<span class="cm">/* Wrappers for some of the above, specific to config constants */</span>

<span class="cp">#define NCONF_HAS(val)	CONF_HAS(NCONF, val)</span>
<span class="cp">#define NCONF_MSK(mask)	CONF_MSK(NCONF, mask)</span>
<span class="cp">#define NCONF_IS(val)	CONF_IS(NCONF, val)</span>
<span class="cp">#define NCONF_GE(val)	CONF_GE(NCONF, val)</span>
<span class="cp">#define NCONF_GT(val)	CONF_GT(NCONF, val)</span>
<span class="cp">#define NCONF_LT(val)	CONF_LT(NCONF, val)</span>
<span class="cp">#define NCONF_LE(val)	CONF_LE(NCONF, val)</span>

<span class="cp">#define LCNCONF_HAS(val)	CONF_HAS(LCNCONF, val)</span>
<span class="cp">#define LCNCONF_MSK(mask)	CONF_MSK(LCNCONF, mask)</span>
<span class="cp">#define LCNCONF_IS(val)		CONF_IS(LCNCONF, val)</span>
<span class="cp">#define LCNCONF_GE(val)		CONF_GE(LCNCONF, val)</span>
<span class="cp">#define LCNCONF_GT(val)		CONF_GT(LCNCONF, val)</span>
<span class="cp">#define LCNCONF_LT(val)		CONF_LT(LCNCONF, val)</span>
<span class="cp">#define LCNCONF_LE(val)		CONF_LE(LCNCONF, val)</span>

<span class="cp">#define D11CONF_HAS(val) CONF_HAS(D11CONF, val)</span>
<span class="cp">#define D11CONF_MSK(mask) CONF_MSK(D11CONF, mask)</span>
<span class="cp">#define D11CONF_IS(val)	CONF_IS(D11CONF, val)</span>
<span class="cp">#define D11CONF_GE(val)	CONF_GE(D11CONF, val)</span>
<span class="cp">#define D11CONF_GT(val)	CONF_GT(D11CONF, val)</span>
<span class="cp">#define D11CONF_LT(val)	CONF_LT(D11CONF, val)</span>
<span class="cp">#define D11CONF_LE(val)	CONF_LE(D11CONF, val)</span>

<span class="cp">#define PHYCONF_HAS(val) CONF_HAS(PHYTYPE, val)</span>
<span class="cp">#define PHYCONF_IS(val)	CONF_IS(PHYTYPE, val)</span>

<span class="cp">#define NREV_IS(var, val) \</span>
<span class="cp">	(NCONF_HAS(val) &amp;&amp; (NCONF_IS(val) || ((var) == (val))))</span>

<span class="cp">#define NREV_GE(var, val) \</span>
<span class="cp">	(NCONF_GE(val) &amp;&amp; (!NCONF_LT(val) || ((var) &gt;= (val))))</span>

<span class="cp">#define NREV_GT(var, val) \</span>
<span class="cp">	(NCONF_GT(val) &amp;&amp; (!NCONF_LE(val) || ((var) &gt; (val))))</span>

<span class="cp">#define NREV_LT(var, val) \</span>
<span class="cp">	(NCONF_LT(val) &amp;&amp; (!NCONF_GE(val) || ((var) &lt; (val))))</span>

<span class="cp">#define NREV_LE(var, val) \</span>
<span class="cp">	(NCONF_LE(val) &amp;&amp; (!NCONF_GT(val) || ((var) &lt;= (val))))</span>

<span class="cp">#define LCNREV_IS(var, val) \</span>
<span class="cp">	(LCNCONF_HAS(val) &amp;&amp; (LCNCONF_IS(val) || ((var) == (val))))</span>

<span class="cp">#define LCNREV_GE(var, val) \</span>
<span class="cp">	(LCNCONF_GE(val) &amp;&amp; (!LCNCONF_LT(val) || ((var) &gt;= (val))))</span>

<span class="cp">#define LCNREV_GT(var, val) \</span>
<span class="cp">	(LCNCONF_GT(val) &amp;&amp; (!LCNCONF_LE(val) || ((var) &gt; (val))))</span>

<span class="cp">#define LCNREV_LT(var, val) \</span>
<span class="cp">	(LCNCONF_LT(val) &amp;&amp; (!LCNCONF_GE(val) || ((var) &lt; (val))))</span>

<span class="cp">#define LCNREV_LE(var, val) \</span>
<span class="cp">	(LCNCONF_LE(val) &amp;&amp; (!LCNCONF_GT(val) || ((var) &lt;= (val))))</span>

<span class="cp">#define D11REV_IS(var, val) \</span>
<span class="cp">	(D11CONF_HAS(val) &amp;&amp; (D11CONF_IS(val) || ((var) == (val))))</span>

<span class="cp">#define D11REV_GE(var, val) \</span>
<span class="cp">	(D11CONF_GE(val) &amp;&amp; (!D11CONF_LT(val) || ((var) &gt;= (val))))</span>

<span class="cp">#define D11REV_GT(var, val) \</span>
<span class="cp">	(D11CONF_GT(val) &amp;&amp; (!D11CONF_LE(val) || ((var) &gt; (val))))</span>

<span class="cp">#define D11REV_LT(var, val) \</span>
<span class="cp">	(D11CONF_LT(val) &amp;&amp; (!D11CONF_GE(val) || ((var) &lt; (val))))</span>

<span class="cp">#define D11REV_LE(var, val) \</span>
<span class="cp">	(D11CONF_LE(val) &amp;&amp; (!D11CONF_GT(val) || ((var) &lt;= (val))))</span>

<span class="cp">#define PHYTYPE_IS(var, val)\</span>
<span class="cp">	(PHYCONF_HAS(val) &amp;&amp; (PHYCONF_IS(val) || ((var) == (val))))</span>

<span class="cm">/* Set up PHYTYPE automatically: (depends on PHY_TYPE_X, from d11.h) */</span>

<span class="cp">#define _PHYCONF_N (1 &lt;&lt; PHY_TYPE_N)</span>
<span class="cp">#define _PHYCONF_LCN (1 &lt;&lt; PHY_TYPE_LCN)</span>
<span class="cp">#define _PHYCONF_SSLPN (1 &lt;&lt; PHY_TYPE_SSN)</span>

<span class="cp">#define PHYTYPE (_PHYCONF_N | _PHYCONF_LCN | _PHYCONF_SSLPN)</span>

<span class="cm">/* Utility macro to identify 802.11n (HT) capable PHYs */</span>
<span class="cp">#define PHYTYPE_11N_CAP(phytype) \</span>
<span class="cp">	(PHYTYPE_IS(phytype, PHY_TYPE_N) ||	\</span>
<span class="cp">	 PHYTYPE_IS(phytype, PHY_TYPE_LCN) || \</span>
<span class="cp">	 PHYTYPE_IS(phytype, PHY_TYPE_SSN))</span>

<span class="cm">/* Last but not least: shorter wlc-specific var checks */</span>
<span class="cp">#define BRCMS_ISNPHY(band)		PHYTYPE_IS((band)-&gt;phytype, PHY_TYPE_N)</span>
<span class="cp">#define BRCMS_ISLCNPHY(band)	PHYTYPE_IS((band)-&gt;phytype, PHY_TYPE_LCN)</span>
<span class="cp">#define BRCMS_ISSSLPNPHY(band)	PHYTYPE_IS((band)-&gt;phytype, PHY_TYPE_SSN)</span>

<span class="cp">#define BRCMS_PHY_11N_CAP(band)	PHYTYPE_11N_CAP((band)-&gt;phytype)</span>

<span class="cm">/**********************************************************************</span>
<span class="cm"> * ------------- End of Core phy/rev configuration. ----------------- *</span>
<span class="cm"> * ********************************************************************</span>
<span class="cm"> */</span>

<span class="cp">#define BCMMSG(dev, fmt, args...)		\</span>
<span class="cp">do {						\</span>
<span class="cp">	if (brcm_msg_level &amp; LOG_TRACE_VAL)	\</span>
<span class="cp">		wiphy_err(dev, &quot;%s: &quot; fmt, __func__, ##args);	\</span>
<span class="cp">} while (0)</span>

<span class="cp">#ifdef CONFIG_BCM47XX</span>
<span class="cm">/*</span>
<span class="cm"> * bcm4716 (which includes 4717 &amp; 4718), plus 4706 on PCIe can reorder</span>
<span class="cm"> * transactions. As a fix, a read after write is performed on certain places</span>
<span class="cm"> * in the code. Older chips and the newer 5357 family don&#39;t require this fix.</span>
<span class="cm"> */</span>
<span class="cp">#define bcma_wflush16(c, o, v) \</span>
<span class="cp">	({ bcma_write16(c, o, v); (void)bcma_read16(c, o); })</span>
<span class="cp">#else</span>
<span class="cp">#define bcma_wflush16(c, o, v)	bcma_write16(c, o, v)</span>
<span class="cp">#endif				</span><span class="cm">/* CONFIG_BCM47XX */</span><span class="cp"></span>

<span class="cm">/* multi-bool data type: set of bools, mbool is true if any is set */</span>

<span class="cm">/* set one bool */</span>
<span class="cp">#define mboolset(mb, bit)		((mb) |= (bit))</span>
<span class="cm">/* clear one bool */</span>
<span class="cp">#define mboolclr(mb, bit)		((mb) &amp;= ~(bit))</span>
<span class="cm">/* true if one bool is set */</span>
<span class="cp">#define mboolisset(mb, bit)		(((mb) &amp; (bit)) != 0)</span>
<span class="cp">#define	mboolmaskset(mb, mask, val)	((mb) = (((mb) &amp; ~(mask)) | (val)))</span>

<span class="cp">#define CEIL(x, y)		(((x) + ((y)-1)) / (y))</span>

<span class="cm">/* forward declarations */</span>
<span class="k">struct</span> <span class="n">wiphy</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">ieee80211_sta</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">ieee80211_tx_queue_params</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">brcms_info</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">brcms_c_info</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">brcms_hardware</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">brcms_txq_info</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">brcms_band</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">dma_pub</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">si_pub</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">tx_status</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">d11rxhdr</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">txpwr_limits</span><span class="p">;</span>

<span class="cm">/* iovar structure */</span>
<span class="k">struct</span> <span class="n">brcmu_iovar</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>	<span class="cm">/* name for lookup and display */</span>
	<span class="n">u16</span> <span class="n">varid</span><span class="p">;</span>	<span class="cm">/* id for switch */</span>
	<span class="n">u16</span> <span class="n">flags</span><span class="p">;</span>	<span class="cm">/* driver-specific flag bits */</span>
	<span class="n">u16</span> <span class="n">type</span><span class="p">;</span>	<span class="cm">/* base type of argument */</span>
	<span class="n">u16</span> <span class="n">minlen</span><span class="p">;</span>	<span class="cm">/* min length for buffer vars */</span>
<span class="p">};</span>

<span class="cm">/* brcm_msg_level is a bit vector with defs in defs.h */</span>
<span class="k">extern</span> <span class="n">u32</span> <span class="n">brcm_msg_level</span><span class="p">;</span>

<span class="cp">#endif				</span><span class="cm">/* _BRCM_TYPES_H_ */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
