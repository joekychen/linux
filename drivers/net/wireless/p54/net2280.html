<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › wireless › p54 › net2280.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>net2280.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cp">#ifndef NET2280_H</span>
<span class="cp">#define NET2280_H</span>
<span class="cm">/*</span>
<span class="cm"> * NetChip 2280 high/full speed USB device controller.</span>
<span class="cm"> * Unlike many such controllers, this one talks PCI.</span>
<span class="cm"> */</span>

<span class="cm">/*</span>
<span class="cm"> * Copyright (C) 2002 NetChip Technology, Inc. (http://www.netchip.com)</span>
<span class="cm"> * Copyright (C) 2003 David Brownell</span>
<span class="cm"> *</span>
<span class="cm"> * This program is free software; you can redistribute it and/or modify</span>
<span class="cm"> * it under the terms of the GNU General Public License as published by</span>
<span class="cm"> * the Free Software Foundation; either version 2 of the License, or</span>
<span class="cm"> * (at your option) any later version.</span>
<span class="cm"> *</span>
<span class="cm"> * This program is distributed in the hope that it will be useful,</span>
<span class="cm"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="cm"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="cm"> * GNU General Public License for more details.</span>
<span class="cm"> *</span>
<span class="cm"> * You should have received a copy of the GNU General Public License</span>
<span class="cm"> * along with this program; if not, write to the Free Software</span>
<span class="cm"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
<span class="cm"> */</span>

<span class="cm">/*-------------------------------------------------------------------------*/</span>

<span class="cm">/* NET2280 MEMORY MAPPED REGISTERS</span>
<span class="cm"> *</span>
<span class="cm"> * The register layout came from the chip documentation, and the bit</span>
<span class="cm"> * number definitions were extracted from chip specification.</span>
<span class="cm"> *</span>
<span class="cm"> * Use the shift operator (&#39;&lt;&lt;&#39;) to build bit masks, with readl/writel</span>
<span class="cm"> * to access the registers through PCI.</span>
<span class="cm"> */</span>

<span class="cm">/* main registers, BAR0 + 0x0000 */</span>
<span class="k">struct</span> <span class="n">net2280_regs</span> <span class="p">{</span>
	<span class="cm">/* offset 0x0000 */</span>
	<span class="n">__le32</span>			<span class="n">devinit</span><span class="p">;</span>
<span class="cp">#define LOCAL_CLOCK_FREQUENCY					8</span>
<span class="cp">#define FORCE_PCI_RESET						7</span>
<span class="cp">#define PCI_ID							6</span>
<span class="cp">#define PCI_ENABLE						5</span>
<span class="cp">#define FIFO_SOFT_RESET						4</span>
<span class="cp">#define CFG_SOFT_RESET						3</span>
<span class="cp">#define PCI_SOFT_RESET						2</span>
<span class="cp">#define USB_SOFT_RESET						1</span>
<span class="cp">#define M8051_RESET						0</span>
	<span class="n">__le32</span>			<span class="n">eectl</span><span class="p">;</span>
<span class="cp">#define EEPROM_ADDRESS_WIDTH					23</span>
<span class="cp">#define EEPROM_CHIP_SELECT_ACTIVE				22</span>
<span class="cp">#define EEPROM_PRESENT						21</span>
<span class="cp">#define EEPROM_VALID						20</span>
<span class="cp">#define EEPROM_BUSY						19</span>
<span class="cp">#define EEPROM_CHIP_SELECT_ENABLE				18</span>
<span class="cp">#define EEPROM_BYTE_READ_START					17</span>
<span class="cp">#define EEPROM_BYTE_WRITE_START					16</span>
<span class="cp">#define EEPROM_READ_DATA					8</span>
<span class="cp">#define EEPROM_WRITE_DATA					0</span>
	<span class="n">__le32</span>			<span class="n">eeclkfreq</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">_unused0</span><span class="p">;</span>
	<span class="cm">/* offset 0x0010 */</span>

	<span class="n">__le32</span>			<span class="n">pciirqenb0</span><span class="p">;</span>	<span class="cm">/* interrupt PCI master ... */</span>
<span class="cp">#define SETUP_PACKET_INTERRUPT_ENABLE				7</span>
<span class="cp">#define ENDPOINT_F_INTERRUPT_ENABLE				6</span>
<span class="cp">#define ENDPOINT_E_INTERRUPT_ENABLE				5</span>
<span class="cp">#define ENDPOINT_D_INTERRUPT_ENABLE				4</span>
<span class="cp">#define ENDPOINT_C_INTERRUPT_ENABLE				3</span>
<span class="cp">#define ENDPOINT_B_INTERRUPT_ENABLE				2</span>
<span class="cp">#define ENDPOINT_A_INTERRUPT_ENABLE				1</span>
<span class="cp">#define ENDPOINT_0_INTERRUPT_ENABLE				0</span>
	<span class="n">__le32</span>			<span class="n">pciirqenb1</span><span class="p">;</span>
<span class="cp">#define PCI_INTERRUPT_ENABLE					31</span>
<span class="cp">#define POWER_STATE_CHANGE_INTERRUPT_ENABLE			27</span>
<span class="cp">#define PCI_ARBITER_TIMEOUT_INTERRUPT_ENABLE			26</span>
<span class="cp">#define PCI_PARITY_ERROR_INTERRUPT_ENABLE			25</span>
<span class="cp">#define PCI_MASTER_ABORT_RECEIVED_INTERRUPT_ENABLE		20</span>
<span class="cp">#define PCI_TARGET_ABORT_RECEIVED_INTERRUPT_ENABLE		19</span>
<span class="cp">#define PCI_TARGET_ABORT_ASSERTED_INTERRUPT_ENABLE		18</span>
<span class="cp">#define PCI_RETRY_ABORT_INTERRUPT_ENABLE			17</span>
<span class="cp">#define PCI_MASTER_CYCLE_DONE_INTERRUPT_ENABLE			16</span>
<span class="cp">#define GPIO_INTERRUPT_ENABLE					13</span>
<span class="cp">#define DMA_D_INTERRUPT_ENABLE					12</span>
<span class="cp">#define DMA_C_INTERRUPT_ENABLE					11</span>
<span class="cp">#define DMA_B_INTERRUPT_ENABLE					10</span>
<span class="cp">#define DMA_A_INTERRUPT_ENABLE					9</span>
<span class="cp">#define EEPROM_DONE_INTERRUPT_ENABLE				8</span>
<span class="cp">#define VBUS_INTERRUPT_ENABLE					7</span>
<span class="cp">#define CONTROL_STATUS_INTERRUPT_ENABLE				6</span>
<span class="cp">#define ROOT_PORT_RESET_INTERRUPT_ENABLE			4</span>
<span class="cp">#define SUSPEND_REQUEST_INTERRUPT_ENABLE			3</span>
<span class="cp">#define SUSPEND_REQUEST_CHANGE_INTERRUPT_ENABLE			2</span>
<span class="cp">#define RESUME_INTERRUPT_ENABLE					1</span>
<span class="cp">#define SOF_INTERRUPT_ENABLE					0</span>
	<span class="n">__le32</span>                  <span class="n">cpu_irqenb0</span><span class="p">;</span>	<span class="cm">/* ... or onboard 8051 */</span>
<span class="cp">#define SETUP_PACKET_INTERRUPT_ENABLE				7</span>
<span class="cp">#define ENDPOINT_F_INTERRUPT_ENABLE				6</span>
<span class="cp">#define ENDPOINT_E_INTERRUPT_ENABLE				5</span>
<span class="cp">#define ENDPOINT_D_INTERRUPT_ENABLE				4</span>
<span class="cp">#define ENDPOINT_C_INTERRUPT_ENABLE				3</span>
<span class="cp">#define ENDPOINT_B_INTERRUPT_ENABLE				2</span>
<span class="cp">#define ENDPOINT_A_INTERRUPT_ENABLE				1</span>
<span class="cp">#define ENDPOINT_0_INTERRUPT_ENABLE				0</span>
	<span class="n">__le32</span>                  <span class="n">cpu_irqenb1</span><span class="p">;</span>
<span class="cp">#define CPU_INTERRUPT_ENABLE					31</span>
<span class="cp">#define POWER_STATE_CHANGE_INTERRUPT_ENABLE			27</span>
<span class="cp">#define PCI_ARBITER_TIMEOUT_INTERRUPT_ENABLE			26</span>
<span class="cp">#define PCI_PARITY_ERROR_INTERRUPT_ENABLE			25</span>
<span class="cp">#define PCI_INTA_INTERRUPT_ENABLE				24</span>
<span class="cp">#define PCI_PME_INTERRUPT_ENABLE				23</span>
<span class="cp">#define PCI_SERR_INTERRUPT_ENABLE				22</span>
<span class="cp">#define PCI_PERR_INTERRUPT_ENABLE				21</span>
<span class="cp">#define PCI_MASTER_ABORT_RECEIVED_INTERRUPT_ENABLE		20</span>
<span class="cp">#define PCI_TARGET_ABORT_RECEIVED_INTERRUPT_ENABLE		19</span>
<span class="cp">#define PCI_RETRY_ABORT_INTERRUPT_ENABLE			17</span>
<span class="cp">#define PCI_MASTER_CYCLE_DONE_INTERRUPT_ENABLE			16</span>
<span class="cp">#define GPIO_INTERRUPT_ENABLE					13</span>
<span class="cp">#define DMA_D_INTERRUPT_ENABLE					12</span>
<span class="cp">#define DMA_C_INTERRUPT_ENABLE					11</span>
<span class="cp">#define DMA_B_INTERRUPT_ENABLE					10</span>
<span class="cp">#define DMA_A_INTERRUPT_ENABLE					9</span>
<span class="cp">#define EEPROM_DONE_INTERRUPT_ENABLE				8</span>
<span class="cp">#define VBUS_INTERRUPT_ENABLE					7</span>
<span class="cp">#define CONTROL_STATUS_INTERRUPT_ENABLE				6</span>
<span class="cp">#define ROOT_PORT_RESET_INTERRUPT_ENABLE			4</span>
<span class="cp">#define SUSPEND_REQUEST_INTERRUPT_ENABLE			3</span>
<span class="cp">#define SUSPEND_REQUEST_CHANGE_INTERRUPT_ENABLE			2</span>
<span class="cp">#define RESUME_INTERRUPT_ENABLE					1</span>
<span class="cp">#define SOF_INTERRUPT_ENABLE					0</span>

	<span class="cm">/* offset 0x0020 */</span>
	<span class="n">u32</span>			<span class="n">_unused1</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">usbirqenb1</span><span class="p">;</span>
<span class="cp">#define USB_INTERRUPT_ENABLE					31</span>
<span class="cp">#define POWER_STATE_CHANGE_INTERRUPT_ENABLE			27</span>
<span class="cp">#define PCI_ARBITER_TIMEOUT_INTERRUPT_ENABLE			26</span>
<span class="cp">#define PCI_PARITY_ERROR_INTERRUPT_ENABLE			25</span>
<span class="cp">#define PCI_INTA_INTERRUPT_ENABLE				24</span>
<span class="cp">#define PCI_PME_INTERRUPT_ENABLE				23</span>
<span class="cp">#define PCI_SERR_INTERRUPT_ENABLE				22</span>
<span class="cp">#define PCI_PERR_INTERRUPT_ENABLE				21</span>
<span class="cp">#define PCI_MASTER_ABORT_RECEIVED_INTERRUPT_ENABLE		20</span>
<span class="cp">#define PCI_TARGET_ABORT_RECEIVED_INTERRUPT_ENABLE		19</span>
<span class="cp">#define PCI_RETRY_ABORT_INTERRUPT_ENABLE			17</span>
<span class="cp">#define PCI_MASTER_CYCLE_DONE_INTERRUPT_ENABLE			16</span>
<span class="cp">#define GPIO_INTERRUPT_ENABLE					13</span>
<span class="cp">#define DMA_D_INTERRUPT_ENABLE					12</span>
<span class="cp">#define DMA_C_INTERRUPT_ENABLE					11</span>
<span class="cp">#define DMA_B_INTERRUPT_ENABLE					10</span>
<span class="cp">#define DMA_A_INTERRUPT_ENABLE					9</span>
<span class="cp">#define EEPROM_DONE_INTERRUPT_ENABLE				8</span>
<span class="cp">#define VBUS_INTERRUPT_ENABLE					7</span>
<span class="cp">#define CONTROL_STATUS_INTERRUPT_ENABLE				6</span>
<span class="cp">#define ROOT_PORT_RESET_INTERRUPT_ENABLE			4</span>
<span class="cp">#define SUSPEND_REQUEST_INTERRUPT_ENABLE			3</span>
<span class="cp">#define SUSPEND_REQUEST_CHANGE_INTERRUPT_ENABLE			2</span>
<span class="cp">#define RESUME_INTERRUPT_ENABLE					1</span>
<span class="cp">#define SOF_INTERRUPT_ENABLE					0</span>
	<span class="n">__le32</span>			<span class="n">irqstat0</span><span class="p">;</span>
<span class="cp">#define INTA_ASSERTED						12</span>
<span class="cp">#define SETUP_PACKET_INTERRUPT					7</span>
<span class="cp">#define ENDPOINT_F_INTERRUPT					6</span>
<span class="cp">#define ENDPOINT_E_INTERRUPT					5</span>
<span class="cp">#define ENDPOINT_D_INTERRUPT					4</span>
<span class="cp">#define ENDPOINT_C_INTERRUPT					3</span>
<span class="cp">#define ENDPOINT_B_INTERRUPT					2</span>
<span class="cp">#define ENDPOINT_A_INTERRUPT					1</span>
<span class="cp">#define ENDPOINT_0_INTERRUPT					0</span>
	<span class="n">__le32</span>			<span class="n">irqstat1</span><span class="p">;</span>
<span class="cp">#define POWER_STATE_CHANGE_INTERRUPT				27</span>
<span class="cp">#define PCI_ARBITER_TIMEOUT_INTERRUPT				26</span>
<span class="cp">#define PCI_PARITY_ERROR_INTERRUPT				25</span>
<span class="cp">#define PCI_INTA_INTERRUPT					24</span>
<span class="cp">#define PCI_PME_INTERRUPT					23</span>
<span class="cp">#define PCI_SERR_INTERRUPT					22</span>
<span class="cp">#define PCI_PERR_INTERRUPT					21</span>
<span class="cp">#define PCI_MASTER_ABORT_RECEIVED_INTERRUPT			20</span>
<span class="cp">#define PCI_TARGET_ABORT_RECEIVED_INTERRUPT			19</span>
<span class="cp">#define PCI_RETRY_ABORT_INTERRUPT				17</span>
<span class="cp">#define PCI_MASTER_CYCLE_DONE_INTERRUPT				16</span>
<span class="cp">#define GPIO_INTERRUPT						13</span>
<span class="cp">#define DMA_D_INTERRUPT						12</span>
<span class="cp">#define DMA_C_INTERRUPT						11</span>
<span class="cp">#define DMA_B_INTERRUPT						10</span>
<span class="cp">#define DMA_A_INTERRUPT						9</span>
<span class="cp">#define EEPROM_DONE_INTERRUPT					8</span>
<span class="cp">#define VBUS_INTERRUPT						7</span>
<span class="cp">#define CONTROL_STATUS_INTERRUPT				6</span>
<span class="cp">#define ROOT_PORT_RESET_INTERRUPT				4</span>
<span class="cp">#define SUSPEND_REQUEST_INTERRUPT				3</span>
<span class="cp">#define SUSPEND_REQUEST_CHANGE_INTERRUPT			2</span>
<span class="cp">#define RESUME_INTERRUPT					1</span>
<span class="cp">#define SOF_INTERRUPT						0</span>
	<span class="cm">/* offset 0x0030 */</span>
	<span class="n">__le32</span>			<span class="n">idxaddr</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">idxdata</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">fifoctl</span><span class="p">;</span>
<span class="cp">#define PCI_BASE2_RANGE						16</span>
<span class="cp">#define IGNORE_FIFO_AVAILABILITY				3</span>
<span class="cp">#define PCI_BASE2_SELECT					2</span>
<span class="cp">#define FIFO_CONFIGURATION_SELECT				0</span>
	<span class="n">u32</span>			<span class="n">_unused2</span><span class="p">;</span>
	<span class="cm">/* offset 0x0040 */</span>
	<span class="n">__le32</span>			<span class="n">memaddr</span><span class="p">;</span>
<span class="cp">#define START							28</span>
<span class="cp">#define DIRECTION						27</span>
<span class="cp">#define FIFO_DIAGNOSTIC_SELECT					24</span>
<span class="cp">#define MEMORY_ADDRESS						0</span>
	<span class="n">__le32</span>			<span class="n">memdata0</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">memdata1</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">_unused3</span><span class="p">;</span>
	<span class="cm">/* offset 0x0050 */</span>
	<span class="n">__le32</span>			<span class="n">gpioctl</span><span class="p">;</span>
<span class="cp">#define GPIO3_LED_SELECT					12</span>
<span class="cp">#define GPIO3_INTERRUPT_ENABLE					11</span>
<span class="cp">#define GPIO2_INTERRUPT_ENABLE					10</span>
<span class="cp">#define GPIO1_INTERRUPT_ENABLE					9</span>
<span class="cp">#define GPIO0_INTERRUPT_ENABLE					8</span>
<span class="cp">#define GPIO3_OUTPUT_ENABLE					7</span>
<span class="cp">#define GPIO2_OUTPUT_ENABLE					6</span>
<span class="cp">#define GPIO1_OUTPUT_ENABLE					5</span>
<span class="cp">#define GPIO0_OUTPUT_ENABLE					4</span>
<span class="cp">#define GPIO3_DATA						3</span>
<span class="cp">#define GPIO2_DATA						2</span>
<span class="cp">#define GPIO1_DATA						1</span>
<span class="cp">#define GPIO0_DATA						0</span>
	<span class="n">__le32</span>			<span class="n">gpiostat</span><span class="p">;</span>
<span class="cp">#define GPIO3_INTERRUPT						3</span>
<span class="cp">#define GPIO2_INTERRUPT						2</span>
<span class="cp">#define GPIO1_INTERRUPT						1</span>
<span class="cp">#define GPIO0_INTERRUPT						0</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* usb control, BAR0 + 0x0080 */</span>
<span class="k">struct</span> <span class="n">net2280_usb_regs</span> <span class="p">{</span>
	<span class="cm">/* offset 0x0080 */</span>
	<span class="n">__le32</span>			<span class="n">stdrsp</span><span class="p">;</span>
<span class="cp">#define STALL_UNSUPPORTED_REQUESTS				31</span>
<span class="cp">#define SET_TEST_MODE						16</span>
<span class="cp">#define GET_OTHER_SPEED_CONFIGURATION				15</span>
<span class="cp">#define GET_DEVICE_QUALIFIER					14</span>
<span class="cp">#define SET_ADDRESS						13</span>
<span class="cp">#define ENDPOINT_SET_CLEAR_HALT					12</span>
<span class="cp">#define DEVICE_SET_CLEAR_DEVICE_REMOTE_WAKEUP			11</span>
<span class="cp">#define GET_STRING_DESCRIPTOR_2					10</span>
<span class="cp">#define GET_STRING_DESCRIPTOR_1					9</span>
<span class="cp">#define GET_STRING_DESCRIPTOR_0					8</span>
<span class="cp">#define GET_SET_INTERFACE					6</span>
<span class="cp">#define GET_SET_CONFIGURATION					5</span>
<span class="cp">#define GET_CONFIGURATION_DESCRIPTOR				4</span>
<span class="cp">#define GET_DEVICE_DESCRIPTOR					3</span>
<span class="cp">#define GET_ENDPOINT_STATUS					2</span>
<span class="cp">#define GET_INTERFACE_STATUS					1</span>
<span class="cp">#define GET_DEVICE_STATUS					0</span>
	<span class="n">__le32</span>			<span class="n">prodvendid</span><span class="p">;</span>
<span class="cp">#define     PRODUCT_ID						16</span>
<span class="cp">#define     VENDOR_ID						0</span>
	<span class="n">__le32</span>			<span class="n">relnum</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">usbctl</span><span class="p">;</span>
<span class="cp">#define SERIAL_NUMBER_INDEX					16</span>
<span class="cp">#define PRODUCT_ID_STRING_ENABLE				13</span>
<span class="cp">#define VENDOR_ID_STRING_ENABLE					12</span>
<span class="cp">#define USB_ROOT_PORT_WAKEUP_ENABLE				11</span>
<span class="cp">#define VBUS_PIN						10</span>
<span class="cp">#define TIMED_DISCONNECT					9</span>
<span class="cp">#define SUSPEND_IMMEDIATELY					7</span>
<span class="cp">#define SELF_POWERED_USB_DEVICE					6</span>
<span class="cp">#define REMOTE_WAKEUP_SUPPORT					5</span>
<span class="cp">#define PME_POLARITY						4</span>
<span class="cp">#define USB_DETECT_ENABLE					3</span>
<span class="cp">#define PME_WAKEUP_ENABLE					2</span>
<span class="cp">#define DEVICE_REMOTE_WAKEUP_ENABLE				1</span>
<span class="cp">#define SELF_POWERED_STATUS					0</span>
	<span class="cm">/* offset 0x0090 */</span>
	<span class="n">__le32</span>			<span class="n">usbstat</span><span class="p">;</span>
<span class="cp">#define HIGH_SPEED						7</span>
<span class="cp">#define FULL_SPEED						6</span>
<span class="cp">#define GENERATE_RESUME						5</span>
<span class="cp">#define GENERATE_DEVICE_REMOTE_WAKEUP				4</span>
	<span class="n">__le32</span>			<span class="n">xcvrdiag</span><span class="p">;</span>
<span class="cp">#define FORCE_HIGH_SPEED_MODE					31</span>
<span class="cp">#define FORCE_FULL_SPEED_MODE					30</span>
<span class="cp">#define USB_TEST_MODE						24</span>
<span class="cp">#define LINE_STATE						16</span>
<span class="cp">#define TRANSCEIVER_OPERATION_MODE				2</span>
<span class="cp">#define TRANSCEIVER_SELECT					1</span>
<span class="cp">#define TERMINATION_SELECT					0</span>
	<span class="n">__le32</span>			<span class="n">setup0123</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">setup4567</span><span class="p">;</span>
	<span class="cm">/* offset 0x0090 */</span>
	<span class="n">u32</span>			<span class="n">_unused0</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">ouraddr</span><span class="p">;</span>
<span class="cp">#define FORCE_IMMEDIATE						7</span>
<span class="cp">#define OUR_USB_ADDRESS						0</span>
	<span class="n">__le32</span>			<span class="n">ourconfig</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* pci control, BAR0 + 0x0100 */</span>
<span class="k">struct</span> <span class="n">net2280_pci_regs</span> <span class="p">{</span>
	<span class="cm">/* offset 0x0100 */</span>
	<span class="n">__le32</span>			<span class="n">pcimstctl</span><span class="p">;</span>
<span class="cp">#define PCI_ARBITER_PARK_SELECT					13</span>
<span class="cp">#define PCI_MULTI LEVEL_ARBITER					12</span>
<span class="cp">#define PCI_RETRY_ABORT_ENABLE					11</span>
<span class="cp">#define DMA_MEMORY_WRITE_AND_INVALIDATE_ENABLE			10</span>
<span class="cp">#define DMA_READ_MULTIPLE_ENABLE				9</span>
<span class="cp">#define DMA_READ_LINE_ENABLE					8</span>
<span class="cp">#define PCI_MASTER_COMMAND_SELECT				6</span>
<span class="cp">#define		MEM_READ_OR_WRITE				0</span>
<span class="cp">#define		IO_READ_OR_WRITE				1</span>
<span class="cp">#define		CFG_READ_OR_WRITE				2</span>
<span class="cp">#define PCI_MASTER_START					5</span>
<span class="cp">#define PCI_MASTER_READ_WRITE					4</span>
<span class="cp">#define		PCI_MASTER_WRITE				0</span>
<span class="cp">#define		PCI_MASTER_READ					1</span>
<span class="cp">#define PCI_MASTER_BYTE_WRITE_ENABLES				0</span>
	<span class="n">__le32</span>			<span class="n">pcimstaddr</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">pcimstdata</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">pcimststat</span><span class="p">;</span>
<span class="cp">#define PCI_ARBITER_CLEAR					2</span>
<span class="cp">#define PCI_EXTERNAL_ARBITER					1</span>
<span class="cp">#define PCI_HOST_MODE						0</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* dma control, BAR0 + 0x0180 ... array of four structs like this,</span>
<span class="cm"> * for channels 0..3.  see also struct net2280_dma:  descriptor</span>
<span class="cm"> * that can be loaded into some of these registers.</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">net2280_dma_regs</span> <span class="p">{</span>	<span class="cm">/* [11.7] */</span>
	<span class="cm">/* offset 0x0180, 0x01a0, 0x01c0, 0x01e0, */</span>
	<span class="n">__le32</span>			<span class="n">dmactl</span><span class="p">;</span>
<span class="cp">#define DMA_SCATTER_GATHER_DONE_INTERRUPT_ENABLE		25</span>
<span class="cp">#define DMA_CLEAR_COUNT_ENABLE					21</span>
<span class="cp">#define DESCRIPTOR_POLLING_RATE					19</span>
<span class="cp">#define		POLL_CONTINUOUS					0</span>
<span class="cp">#define		POLL_1_USEC					1</span>
<span class="cp">#define		POLL_100_USEC					2</span>
<span class="cp">#define		POLL_1_MSEC					3</span>
<span class="cp">#define DMA_VALID_BIT_POLLING_ENABLE				18</span>
<span class="cp">#define DMA_VALID_BIT_ENABLE					17</span>
<span class="cp">#define DMA_SCATTER_GATHER_ENABLE				16</span>
<span class="cp">#define DMA_OUT_AUTO_START_ENABLE				4</span>
<span class="cp">#define DMA_PREEMPT_ENABLE					3</span>
<span class="cp">#define DMA_FIFO_VALIDATE					2</span>
<span class="cp">#define DMA_ENABLE						1</span>
<span class="cp">#define DMA_ADDRESS_HOLD					0</span>
	<span class="n">__le32</span>			<span class="n">dmastat</span><span class="p">;</span>
<span class="cp">#define DMA_SCATTER_GATHER_DONE_INTERRUPT			25</span>
<span class="cp">#define DMA_TRANSACTION_DONE_INTERRUPT				24</span>
<span class="cp">#define DMA_ABORT						1</span>
<span class="cp">#define DMA_START						0</span>
	<span class="n">u32</span>			<span class="n">_unused0</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
	<span class="cm">/* offset 0x0190, 0x01b0, 0x01d0, 0x01f0, */</span>
	<span class="n">__le32</span>                  <span class="n">dmacount</span><span class="p">;</span>
<span class="cp">#define VALID_BIT						31</span>
<span class="cp">#define DMA_DIRECTION						30</span>
<span class="cp">#define DMA_DONE_INTERRUPT_ENABLE				29</span>
<span class="cp">#define END_OF_CHAIN						28</span>
<span class="cp">#define DMA_BYTE_COUNT_MASK					((1&lt;&lt;24)-1)</span>
<span class="cp">#define DMA_BYTE_COUNT						0</span>
	<span class="n">__le32</span>			<span class="n">dmaaddr</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">dmadesc</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">_unused1</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* dedicated endpoint registers, BAR0 + 0x0200 */</span>

<span class="k">struct</span> <span class="n">net2280_dep_regs</span> <span class="p">{</span>	<span class="cm">/* [11.8] */</span>
	<span class="cm">/* offset 0x0200, 0x0210, 0x220, 0x230, 0x240 */</span>
	<span class="n">__le32</span>			<span class="n">dep_cfg</span><span class="p">;</span>
	<span class="cm">/* offset 0x0204, 0x0214, 0x224, 0x234, 0x244 */</span>
	<span class="n">__le32</span>			<span class="n">dep_rsp</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">_unused</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* configurable endpoint registers, BAR0 + 0x0300 ... array of seven structs</span>
<span class="cm"> * like this, for ep0 then the configurable endpoints A..F</span>
<span class="cm"> * ep0 reserved for control; E and F have only 64 bytes of fifo</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">net2280_ep_regs</span> <span class="p">{</span>	<span class="cm">/* [11.9] */</span>
	<span class="cm">/* offset 0x0300, 0x0320, 0x0340, 0x0360, 0x0380, 0x03a0, 0x03c0 */</span>
	<span class="n">__le32</span>			<span class="n">ep_cfg</span><span class="p">;</span>
<span class="cp">#define ENDPOINT_BYTE_COUNT					16</span>
<span class="cp">#define ENDPOINT_ENABLE						10</span>
<span class="cp">#define ENDPOINT_TYPE						8</span>
<span class="cp">#define ENDPOINT_DIRECTION					7</span>
<span class="cp">#define ENDPOINT_NUMBER						0</span>
	<span class="n">__le32</span>			<span class="n">ep_rsp</span><span class="p">;</span>
<span class="cp">#define SET_NAK_OUT_PACKETS					15</span>
<span class="cp">#define SET_EP_HIDE_STATUS_PHASE				14</span>
<span class="cp">#define SET_EP_FORCE_CRC_ERROR					13</span>
<span class="cp">#define SET_INTERRUPT_MODE					12</span>
<span class="cp">#define SET_CONTROL_STATUS_PHASE_HANDSHAKE			11</span>
<span class="cp">#define SET_NAK_OUT_PACKETS_MODE				10</span>
<span class="cp">#define SET_ENDPOINT_TOGGLE					9</span>
<span class="cp">#define SET_ENDPOINT_HALT					8</span>
<span class="cp">#define CLEAR_NAK_OUT_PACKETS					7</span>
<span class="cp">#define CLEAR_EP_HIDE_STATUS_PHASE				6</span>
<span class="cp">#define CLEAR_EP_FORCE_CRC_ERROR				5</span>
<span class="cp">#define CLEAR_INTERRUPT_MODE					4</span>
<span class="cp">#define CLEAR_CONTROL_STATUS_PHASE_HANDSHAKE			3</span>
<span class="cp">#define CLEAR_NAK_OUT_PACKETS_MODE				2</span>
<span class="cp">#define CLEAR_ENDPOINT_TOGGLE					1</span>
<span class="cp">#define CLEAR_ENDPOINT_HALT					0</span>
	<span class="n">__le32</span>			<span class="n">ep_irqenb</span><span class="p">;</span>
<span class="cp">#define SHORT_PACKET_OUT_DONE_INTERRUPT_ENABLE			6</span>
<span class="cp">#define SHORT_PACKET_TRANSFERRED_INTERRUPT_ENABLE		5</span>
<span class="cp">#define DATA_PACKET_RECEIVED_INTERRUPT_ENABLE			3</span>
<span class="cp">#define DATA_PACKET_TRANSMITTED_INTERRUPT_ENABLE		2</span>
<span class="cp">#define DATA_OUT_PING_TOKEN_INTERRUPT_ENABLE			1</span>
<span class="cp">#define DATA_IN_TOKEN_INTERRUPT_ENABLE				0</span>
	<span class="n">__le32</span>			<span class="n">ep_stat</span><span class="p">;</span>
<span class="cp">#define FIFO_VALID_COUNT					24</span>
<span class="cp">#define HIGH_BANDWIDTH_OUT_TRANSACTION_PID			22</span>
<span class="cp">#define TIMEOUT							21</span>
<span class="cp">#define USB_STALL_SENT						20</span>
<span class="cp">#define USB_IN_NAK_SENT						19</span>
<span class="cp">#define USB_IN_ACK_RCVD						18</span>
<span class="cp">#define USB_OUT_PING_NAK_SENT					17</span>
<span class="cp">#define USB_OUT_ACK_SENT					16</span>
<span class="cp">#define FIFO_OVERFLOW						13</span>
<span class="cp">#define FIFO_UNDERFLOW						12</span>
<span class="cp">#define FIFO_FULL						11</span>
<span class="cp">#define FIFO_EMPTY						10</span>
<span class="cp">#define FIFO_FLUSH						9</span>
<span class="cp">#define SHORT_PACKET_OUT_DONE_INTERRUPT				6</span>
<span class="cp">#define SHORT_PACKET_TRANSFERRED_INTERRUPT			5</span>
<span class="cp">#define NAK_OUT_PACKETS						4</span>
<span class="cp">#define DATA_PACKET_RECEIVED_INTERRUPT				3</span>
<span class="cp">#define DATA_PACKET_TRANSMITTED_INTERRUPT			2</span>
<span class="cp">#define DATA_OUT_PING_TOKEN_INTERRUPT				1</span>
<span class="cp">#define DATA_IN_TOKEN_INTERRUPT					0</span>
	<span class="cm">/* offset 0x0310, 0x0330, 0x0350, 0x0370, 0x0390, 0x03b0, 0x03d0 */</span>
	<span class="n">__le32</span>			<span class="n">ep_avail</span><span class="p">;</span>
	<span class="n">__le32</span>			<span class="n">ep_data</span><span class="p">;</span>
	<span class="n">u32</span>			<span class="n">_unused0</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">net2280_reg_write</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">port</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">addr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">val</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">net2280_reg_read</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">port</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">addr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>
<span class="cp">#endif </span><span class="cm">/* NET2280_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
