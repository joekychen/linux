f | Makefile | g | 1.5K |  | Avinash Patil | patila@marvell.com | 1337186796 |  | mwifiex: add custom IE framework  1. support for setting custom IE from application hostapd etc. Custom IE addition using auto-indexing and Custom IE deletion using static indices (which are allocated during IE addition and stored in driver) are supported. 2. Separate file for handling IE related execution.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | init.c | s | 19K | 590 | Avinash Patil | patila@marvell.com | 1337186796 |  | mwifiex: add custom IE framework  1. support for setting custom IE from application hostapd etc. Custom IE addition using auto-indexing and Custom IE deletion using static indices (which are allocated during IE addition and stored in driver) are supported. 2. Separate file for handling IE related execution.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | 11n.c | s | 22K | 635 | Johannes Berg | johannes.berg@intel.com | 1334001955 |  | wireless: rename ht_info to ht_operation  Since some of the HT code pre-dates 802.11n-2009 some names are wrong. The one that bothers me most is that "HT operation" is called "HT information" in our code and that causes confusion.  Rename "HT information" to "HT operation" and also the control_chan field to primary_chan to match the name used in the spec.  Signed-off-by: Johannes Berg <johannes.berg@intel.com> Acked-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | pcie.h | s | 4.7K | 128 | Bing Zhao | bzhao@marvell.com | 1334340419 |  | mwifiex: update pcie8766 scratch register addresses  The scratch register addresses have been changed for newer chips. Since the old chip was never shipped and it will not be supported any more, just update register addresses to support the new chips.  Cc: <stable@vger.kernel.org> # 3.2.y, 3.3.y Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sta_event.c | s | 13K | 413 | Amitkumar Karwar | akarwar@marvell.com | 1340387990 |  | mwifiex: fix bugs in event handling code  This patch ensures uniformity in event skb sent by interface code (USB/PCIe/SDIO) which automatically fixes following bugs.  1) For USB interface, same buffer is reused for receiving cmd and events from firmware. While handling events, we perform skb_pull(skb, 4) to remove event header. Corresponding skb_push() call is missing while submitting the buffer. 2) For PCIe interface, event skb is passed with event header. Recently added uAP events EVENT_UAP_STA_ASSOC, EVENT_UAP_STA_DEAUTH will not work for PCIe, as they assume event skb points to event body.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | fw.h | s | 35K | 1186 | Avinash Patil | patila@marvell.com | 1338837685 |  | mwifiex: support NL80211_HIDDEN_SSID_ZERO_LEN for uAP  mwifiex uAP supports NL80211_HIDDEN_SSID_ZERO_LEN type of hidden SSID only. NL80211_HIDDEN_SSID_ZERO_CONTENTS is not supported.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sta_ioctl.c | s | 41K | 1349 | Avinash Patil | patila@marvell.com | 1337186795 |  | mwifiex: append peer mac address TLV in key material command to firmware  Modify key related cfg80211 handlers to copy peer mac address for pairwise keys. If peer mac address is not present or group keys, it will be sent as broadcast mac address. This would be required since hostapd downloads per peer PTK.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | usb.h | s | 2.5K | 84 | Amitkumar Karwar | akarwar@marvell.com | 1335209648 |  | mwifiex: add support for Marvell USB8797 chipset  This patch supports Avastar 88W8797 chipset with USB interface.  The corresponding firmware image file is located at: "mrvl/usb8797_uapsta.bin"  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Frank Huang <frankh@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sdio.h | s | 10K | 271 | WarheadsSE | max@warheads.net | 1336524970 |  | mwifiex: add support for SD8786 sdio  	modified:   drivers/net/wireless/mwifiex/Kconfig 	- notate additional chipset 	modified:   drivers/net/wireless/mwifiex/sdio.c 	- add definition of id (0x9116) 	- add to switch for firmware load 	- add MODULE_FIRMWARE 	modified:   drivers/net/wireless/mwifiex/sdio.h 	- add definition of default firmware name  Signed-off-by: Jason Plum <max@warheads.net> Acked-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | cmdevt.c | s | 45K | 1305 | Avinash Patil | patila@marvell.com | 1337186795 |  | mwifiex: add bss start and bss stop commands for AP  1. separate file for preparing uAP command buffer 2. definition of bss_start and bss_stop commands being sent to firmware  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | cfg80211.c | s | 48K | 1486 | Bing Zhao | bzhao@marvell.com | 1340132359 |  | mwifiex: fix wrong return values in add_virtual_intf() error cases  add_virtual_intf() needs to return an ERR_PTR(), instead of NULL, on errors, otherwise cfg80211 will crash.  Reported-by: Johannes Berg <johannes@sipsolutions.net> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | util.c | s | 7.4K | 205 | Amitkumar Karwar | akarwar@marvell.com | 1335209648 |  | mwifiex: add support for Marvell USB8797 chipset  This patch supports Avastar 88W8797 chipset with USB interface.  The corresponding firmware image file is located at: "mrvl/usb8797_uapsta.bin"  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Frank Huang <frankh@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | join.c | s | 44K | 1194 | Avinash Patil | patila@marvell.com | 1337186795 |  | mwifiex: stop BSS in deauthentication handling  While in AP mode, we should stop BSS in deauthentication handler.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | 11n.h | s | 5.4K | 145 | Yogesh Ashok Powar | yogeshp@marvell.com | 1331750372 |  | mwifiex: fix checkpatch --strict warnings/errors Part 1  For files 11n.c, 11n.h, 11n_aggr.c, 11n_rxreorder.c  Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | scan.c | s | 59K | 1781 | Amitkumar Karwar | akarwar@marvell.com | 1334689035 |  | mwifiex: corrections in timestamp related code  We get two timing related fields for each bss from firmware in scan results. 1) timestamp - Actual timestamp information in probe response/beacon 2) network_tsf - firmware's TSF value at the time the beacon or probe response was received. Both are needed while associating by firmware.  The patch takes care of following things. 1) We should pass "timestamp" to cfg80211_inform_bss(), but currently "network_tsf" is being provided. This error is corrected here. 2) Rename "network_tsf" to "fw_tsf" 3) Make use of u64 variable instead of an array of u8/u32 to save parsed "timestamp" information. 4) Use timestamp provided to stack in scan results using cfg80211_inform_bss() while associating. (bss->tsf) 5) Allocate space to save fw_tsf in "priv" of cfg80211_bss and retrieve it while associating.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | pcie.c | s | 50K | 1676 | Amitkumar Karwar | akarwar@marvell.com | 1334257830 |  | mwifiex: use asynchronous firmware loading  Make use of request_firmware_nowait instead of request_firmware to load FW asynchronously. This fixes timeouts introduced with recent udev changes.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sdio.c | s | 44K | 1533 | Amitkumar Karwar | akarwar@marvell.com | 1340387990 |  | mwifiex: fix bugs in event handling code  This patch ensures uniformity in event skb sent by interface code (USB/PCIe/SDIO) which automatically fixes following bugs.  1) For USB interface, same buffer is reused for receiving cmd and events from firmware. While handling events, we perform skb_pull(skb, 4) to remove event header. Corresponding skb_push() call is missing while submitting the buffer. 2) For PCIe interface, event skb is passed with event header. Recently added uAP events EVENT_UAP_STA_ASSOC, EVENT_UAP_STA_DEAUTH will not work for PCIe, as they assume event skb points to event body.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | txrx.c | s | 5.0K | 157 | Avinash Patil | patila@marvell.com | 1340132185 |  | mwifiex: fix uAP TX packet timeout issue  When running heavy traffic we stop the tx queue if the pending packet count reaches certain threshold. Later, the tx queue should be woken up as soon as the packet count falls below the threshold.  Current code wakes TX queue up on STA interface only. Removing the check for STA interface will allow both STA and AP interfaces to resume transmit when tx_pending count becomes low.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sta_rx.c | s | 6.6K | 185 | Amitkumar Karwar | akarwar@marvell.com | 1335209648 |  | mwifiex: add support for Marvell USB8797 chipset  This patch supports Avastar 88W8797 chipset with USB interface.  The corresponding firmware image file is located at: "mrvl/usb8797_uapsta.bin"  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Frank Huang <frankh@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | cfg80211.h | s | 1.0K | 24 | Avinash Patil | patila@marvell.com | 1337186794 |  | mwifiex: support for creation of AP interface  1. wiphy structure is per device; hence moved it to mwifiex_adapter mwifiex_register_cfg80211 takes mwifiex_adapter as parameter. This function only registers wiphy with cfg80211. 2. Creation of interfaces is moved to cfg80211 add_virtual_interface handler. 3. Create 2 interfaces by default: station and AP  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | ioctl.h | s | 6.7K | 299 | Avinash Patil | patila@marvell.com | 1337186796 |  | mwifiex: add custom IE framework  1. support for setting custom IE from application hostapd etc. Custom IE addition using auto-indexing and Custom IE deletion using static indices (which are allocated during IE addition and stored in driver) are supported. 2. Separate file for handling IE related execution.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | 11n_aggr.c | s | 9.5K | 273 | Amitkumar Karwar | akarwar@marvell.com | 1335209648 |  | mwifiex: add support for Marvell USB8797 chipset  This patch supports Avastar 88W8797 chipset with USB interface.  The corresponding firmware image file is located at: "mrvl/usb8797_uapsta.bin"  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Frank Huang <frankh@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | wmm.h | s | 3.1K | 91 | Avinash Patil | patila@marvell.com | 1327694222 |  | mwifiex: pass priv pointer instead of adapter  Pass mwifiex_private pointer directly to wmm_add_buf_txqueue() instead of passing adapter and then deriving priv again in mwifiex_get_priv_by_id(). This reduces a 'for' loop in TX path.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | README | g | 7.9K |  | Amitkumar Karwar | akarwar@marvell.com | 1302809711 |  | mwifiex: cleanup ioctl wait queue and abstraction layer  1) remove mwifiex_alloc_fill_wait_queue() and mwifiex_request_ioctl() 2) avoid dynamic allocation of wait queue 3) remove unnecessary mwifiex_error_code macros that were used mainly by the wait queue status code 4) remove some abstraction functions 5) split mwifiex_prepare_cmd() to mwifiex_send_cmd_async() and mwifiex_send_sync() to handle asynchronous and synchronous commands respectively  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | main.h | s | 28K | 885 | Avinash Patil | patila@marvell.com | 1337186797 |  | mwifiex: delete IEs when stop_ap  Delete custom IEs set by start_ap cfg80211 handler when stop_ap handler is called for AP interface. IE index required for deletion is stored in mwifiex_private structure.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | debugfs.c | s | 20K | 650 | Amitkumar Karwar | akarwar@marvell.com | 1334257829 |  | mwifiex: display correct country information in debugfs "info"  Use "priv->country_code" string to display country information in debugfs command "info" instead of "adapter->region_code".  "adapter->region_code" contains default region code got from FW while initialization, whereas "priv->country_code" is updated in reg_notifier handler whenever there is a change in regulatory domain.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | Kconfig | g | 1.2K |  | WarheadsSE | max@warheads.net | 1336524970 |  | mwifiex: add support for SD8786 sdio  	modified:   drivers/net/wireless/mwifiex/Kconfig 	- notate additional chipset 	modified:   drivers/net/wireless/mwifiex/sdio.c 	- add definition of id (0x9116) 	- add to switch for firmware load 	- add MODULE_FIRMWARE 	modified:   drivers/net/wireless/mwifiex/sdio.h 	- add definition of default firmware name  Signed-off-by: Jason Plum <max@warheads.net> Acked-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | 11n_aggr.h | s | 1.3K | 29 | Amitkumar Karwar | akarwar@marvell.com | 1317669755 |  | mwifiex: correct AMSDU aggregation check  The commit "mwifiex: remove list traversal.."(fcf2176c87..) wrongly modifies AMSDU aggregation check. Due to this even though packet size for iperf traffic is already large, we unnecessarily try to aggregate them which adds some delay. If Tx iperf is started on UUT for 30 seconds, UUT keeps sending Tx packets for few more seconds.  That commit is reverted to fix the problem. Also, MIN_NUM_AMSDU check is moved inside the loop to optimize the loop.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | wmm.c | s | 34K | 1081 | Stone Piao | piaoyun@marvell.com | 1340387989 |  | mwifiex: fix WPS eapol handshake failure  After association, STA will go through eapol handshake with WPS enabled AP. It's observed that WPS handshake fails with some 11n AP. The reason for the failure is that the eapol packet is sent via 11n frame aggregation.  The eapol packet should be sent directly without 11n aggregation.  This patch fixes the problem by adding WPS session control while dequeuing Tx packets for transmission.  Cc: "3.4.y" <stable@vger.kernel.org> Signed-off-by: Stone Piao <piaoyun@marvell.com> Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | ie.c | s | 11K | 343 | Avinash Patil | patila@marvell.com | 1340827234 |  | mwifiex: fix memory leak associated with IE manamgement  Free ap_custom_ie before return from function.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | cfp.c | s | 10K | 338 | Amitkumar Karwar | akarwar@marvell.com | 1334257828 |  | mwifiex: set default regulatory domain  Driver gets region code from FW during initialisation. This patch makes use of it for settting default regulatory domain using regulatory_hint() API.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | util.h | s | 1.3K | 33 | Amitkumar Karwar | akarwar@marvell.com | 1318444904 |  | mwifiex: add support for Marvell pcie8766 chipset  This patch supports 88W8766P chipset with a PCIe interface.  The corresponding firmware image file is located at: "mrvl/pcie8766_uapsta.bin"  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Ramesh Radhakrishnan <rramesh@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: Frank Huang <frankh@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | decl.h | s | 3.3K | 105 | Avinash Patil | patila@marvell.com | 1337186796 |  | mwifiex: add cfg80211 start_ap and stop_ap handlers  1. add start AP and stop AP handlers 2. support for parsing ssid, beacon period, DTIM period from beacon_parameters structure and setting it to FW.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sta_cmd.c | s | 41K | 1225 | Avinash Patil | patila@marvell.com | 1337186795 |  | mwifiex: append peer mac address TLV in key material command to firmware  Modify key related cfg80211 handlers to copy peer mac address for pairwise keys. If peer mac address is not present or group keys, it will be sent as broadcast mac address. This would be required since hostapd downloads per peer PTK.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sta_cmdresp.c | s | 28K | 858 | Avinash Patil | patila@marvell.com | 1337186795 |  | mwifiex: add bss start and bss stop commands for AP  1. separate file for preparing uAP command buffer 2. definition of bss_start and bss_stop commands being sent to firmware  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Yogesh Ashok Powar <yogeshp@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | 11n_rxreorder.h | s | 2.6K | 63 | Stone Piao | piaoyun@marvell.com | 1340387989 |  | mwifiex: fix 11n rx packet drop issue  Currently we check the sequence number of last packet received against start_win. If a sequence hole is detected, start_win is updated to next sequence number.  Since the rx sequence number is initialized to 0, a corner case exists when BA setup happens immediately after association. As 0 is a valid sequence number, start_win gets increased to 1 incorrectly. This causes the first packet with sequence number 0 being dropped.  Initialize rx sequence number as 0xffff and skip adjusting start_win if the sequence number remains 0xffff. The sequence number will be updated once the first packet is received.  Cc: "3.0.y, 3.1.y, 3.2.y, 3.3.y, 3.4.y" <stable@vger.kernel.org> Signed-off-by: Stone Piao <piaoyun@marvell.com> Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | usb.c | s | 27K | 877 | Amitkumar Karwar | akarwar@marvell.com | 1340387990 |  | mwifiex: improve error path handling in usb.c  skb allocated during initialisation is reused for receiving commands/events by USB interface. We miss to reset skb->data in failure cases. This patch takes care of it.  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | main.c | s | 24K | 791 | Avinash Patil | patila@marvell.com | 1337186797 |  | mwifiex: retrieve IEs from cfg80211_beacon_data and send to firmware  This patch adds logic for setting tail beacon IE, probe response IE and assoc response IE from cfg80211_ap_settings parameter of start_ap handler into FW.  RSN IE is also retrieved from tail IE buffer and sent to firmware.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | sta_tx.c | s | 5.8K | 183 | Amitkumar Karwar | akarwar@marvell.com | 1335209648 |  | mwifiex: add support for Marvell USB8797 chipset  This patch supports Avastar 88W8797 chipset with USB interface.  The corresponding firmware image file is located at: "mrvl/usb8797_uapsta.bin"  Signed-off-by: Amitkumar Karwar <akarwar@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Frank Huang <frankh@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | 11n_rxreorder.c | s | 17K | 528 | Stone Piao | piaoyun@marvell.com | 1340387989 |  | mwifiex: fix 11n rx packet drop issue  Currently we check the sequence number of last packet received against start_win. If a sequence hole is detected, start_win is updated to next sequence number.  Since the rx sequence number is initialized to 0, a corner case exists when BA setup happens immediately after association. As 0 is a valid sequence number, start_win gets increased to 1 incorrectly. This causes the first packet with sequence number 0 being dropped.  Initialize rx sequence number as 0xffff and skip adjusting start_win if the sequence number remains 0xffff. The sequence number will be updated once the first packet is received.  Cc: "3.0.y, 3.1.y, 3.2.y, 3.3.y, 3.4.y" <stable@vger.kernel.org> Signed-off-by: Stone Piao <piaoyun@marvell.com> Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Kiran Divekar <dkiran@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
f | uap_cmd.c | s | 15K | 419 | Avinash Patil | patila@marvell.com | 1339526460 |  | mwifiex: fix incorrect privacy setting in beacon and probe response  Test procedure: 1. Start AP with security setting (e.g. WPA2) 2. Stop AP 3. Start AP with open security  Here it's observed that privacy is enabled in beacons and probe responses.  This patch fixes it by checking the privacy parameter from cfg80211_ap_settings. If privacy is not set in cfg80211_ap_settings, set open authentication and no encryption in FW.  Signed-off-by: Avinash Patil <patila@marvell.com> Signed-off-by: Bing Zhao <bzhao@marvell.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
