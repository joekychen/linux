<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › wireless › iwmc3200wifi › umac.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../index.html"></a><h1>umac.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Intel Wireless Multicomm 3200 WiFi driver</span>
<span class="cm"> *</span>
<span class="cm"> * Copyright (C) 2009 Intel Corporation. All rights reserved.</span>
<span class="cm"> *</span>
<span class="cm"> * Redistribution and use in source and binary forms, with or without</span>
<span class="cm"> * modification, are permitted provided that the following conditions</span>
<span class="cm"> * are met:</span>
<span class="cm"> *</span>
<span class="cm"> *   * Redistributions of source code must retain the above copyright</span>
<span class="cm"> *     notice, this list of conditions and the following disclaimer.</span>
<span class="cm"> *   * Redistributions in binary form must reproduce the above copyright</span>
<span class="cm"> *     notice, this list of conditions and the following disclaimer in</span>
<span class="cm"> *     the documentation and/or other materials provided with the</span>
<span class="cm"> *     distribution.</span>
<span class="cm"> *   * Neither the name of Intel Corporation nor the names of its</span>
<span class="cm"> *     contributors may be used to endorse or promote products derived</span>
<span class="cm"> *     from this software without specific prior written permission.</span>
<span class="cm"> *</span>
<span class="cm"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="cm"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="cm"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="cm"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="cm"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="cm"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="cm"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="cm"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="cm"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="cm"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="cm"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="cm"> *</span>
<span class="cm"> *</span>
<span class="cm"> * Intel Corporation &lt;ilw@linux.intel.com&gt;</span>
<span class="cm"> * Samuel Ortiz &lt;samuel.ortiz@intel.com&gt;</span>
<span class="cm"> * Zhu Yi &lt;yi.zhu@intel.com&gt;</span>
<span class="cm"> *</span>
<span class="cm"> */</span>

<span class="cp">#ifndef __IWM_UMAC_H__</span>
<span class="cp">#define __IWM_UMAC_H__</span>

<span class="k">struct</span> <span class="n">iwm_udma_in_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_udma_out_nonwifi_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">addr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">op1_sz</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">op2</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_udma_out_wifi_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">meta_data</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Sequence numbering */</span>
<span class="cp">#define UMAC_WIFI_SEQ_NUM_BASE		1</span>
<span class="cp">#define UMAC_WIFI_SEQ_NUM_MAX		0x4000</span>
<span class="cp">#define UMAC_NONWIFI_SEQ_NUM_BASE	1</span>
<span class="cp">#define UMAC_NONWIFI_SEQ_NUM_MAX	0x10</span>

<span class="cm">/* MAC address address */</span>
<span class="cp">#define WICO_MAC_ADDRESS_ADDR               0x604008F8</span>

<span class="cm">/* RA / TID */</span>
<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_TID_POS                  0</span>
<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_TID_SEED                 0xF</span>

<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_RA_POS                   4</span>
<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_RA_SEED                  0xF</span>

<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_RA_UMAC                  0xF</span>
<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_TID_UMAC                 0x9</span>
<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_TID_LMAC                 0xA</span>

<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_HOST_CMD \</span>
<span class="cp">	((UMAC_HDI_ACT_TBL_IDX_RA_UMAC &lt;&lt; UMAC_HDI_ACT_TBL_IDX_RA_POS) |\</span>
<span class="cp">	 (UMAC_HDI_ACT_TBL_IDX_TID_UMAC &lt;&lt; UMAC_HDI_ACT_TBL_IDX_TID_POS))</span>
<span class="cp">#define UMAC_HDI_ACT_TBL_IDX_UMAC_CMD \</span>
<span class="cp">	((UMAC_HDI_ACT_TBL_IDX_RA_UMAC &lt;&lt; UMAC_HDI_ACT_TBL_IDX_RA_POS) |\</span>
<span class="cp">	(UMAC_HDI_ACT_TBL_IDX_TID_LMAC &lt;&lt; UMAC_HDI_ACT_TBL_IDX_TID_POS))</span>

<span class="cm">/* STA ID and color */</span>
<span class="cp">#define STA_ID_SEED                        (0x0f)</span>
<span class="cp">#define STA_ID_POS                         (0)</span>
<span class="cp">#define STA_ID_MSK                         (STA_ID_SEED &lt;&lt; STA_ID_POS)</span>

<span class="cp">#define STA_COLOR_SEED                     (0x7)</span>
<span class="cp">#define STA_COLOR_POS                      (4)</span>
<span class="cp">#define STA_COLOR_MSK                      (STA_COLOR_SEED &lt;&lt; STA_COLOR_POS)</span>

<span class="cp">#define STA_ID_N_COLOR_COLOR(id_n_color) \</span>
<span class="cp">	(((id_n_color) &amp; STA_COLOR_MSK) &gt;&gt; STA_COLOR_POS)</span>
<span class="cp">#define STA_ID_N_COLOR_ID(id_n_color) \</span>
<span class="cp">	(((id_n_color) &amp; STA_ID_MSK) &gt;&gt; STA_ID_POS)</span>

<span class="cm">/* iwm_umac_notif_alive.page_grp_state Group number -- bits [3:0] */</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_GRP_NUM_POS		0</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_GRP_NUM_SEED	0xF</span>

<span class="cm">/* iwm_umac_notif_alive.page_grp_state Super group number -- bits [7:4] */</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_SGRP_NUM_POS	4</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_SGRP_NUM_SEED	0xF</span>

<span class="cm">/* iwm_umac_notif_alive.page_grp_state Group min size -- bits [15:8] */</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_GRP_MIN_SIZE_POS	8</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_GRP_MIN_SIZE_SEED	0xFF</span>

<span class="cm">/* iwm_umac_notif_alive.page_grp_state Group max size -- bits [23:16] */</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_GRP_MAX_SIZE_POS	16</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_GRP_MAX_SIZE_SEED	0xFF</span>

<span class="cm">/* iwm_umac_notif_alive.page_grp_state Super group max size -- bits [31:24] */</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_SGRP_MAX_SIZE_POS	24</span>
<span class="cp">#define UMAC_ALIVE_PAGE_STS_SGRP_MAX_SIZE_SEED	0xFF</span>

<span class="cm">/* Barkers */</span>
<span class="cp">#define UMAC_REBOOT_BARKER		0xdeadbeef</span>
<span class="cp">#define UMAC_ACK_BARKER			0xfeedbabe</span>
<span class="cp">#define UMAC_PAD_TERMINAL		0xadadadad</span>

<span class="cm">/* UMAC JMP address */</span>
<span class="cp">#define UMAC_MU_FW_INST_DATA_12_ADDR    0xBF0000</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.cmd OP code -- bits [3:0] */</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_OPCODE_POS	0</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_OPCODE_SEED	0xF</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.cmd End-Of-Transfer -- bits [10:10] */</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_EOT_POS	10</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_EOT_SEED	0x1</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.cmd UTFD only usage -- bits [11:11] */</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_UTFD_ONLY_POS	11</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_UTFD_ONLY_SEED	0x1</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.cmd Non-WiFi HW sequence number -- bits [12:15] */</span>
<span class="cp">#define UDMA_HDI_OUT_CMD_NON_WIFI_HW_SEQ_NUM_POS   12</span>
<span class="cp">#define UDMA_HDI_OUT_CMD_NON_WIFI_HW_SEQ_NUM_SEED  0xF</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.cmd Signature -- bits [31:16] */</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_SIGNATURE_POS	16</span>
<span class="cp">#define UMAC_HDI_OUT_CMD_SIGNATURE_SEED	0xFFFF</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.meta_data Byte count -- bits [11:0] */</span>
<span class="cp">#define UMAC_HDI_OUT_BYTE_COUNT_POS	0</span>
<span class="cp">#define UMAC_HDI_OUT_BYTE_COUNT_SEED	0xFFF</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.meta_data Credit group -- bits [15:12] */</span>
<span class="cp">#define UMAC_HDI_OUT_CREDIT_GRP_POS	12</span>
<span class="cp">#define UMAC_HDI_OUT_CREDIT_GRP_SEED	0xF</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.meta_data RA/TID -- bits [23:16] */</span>
<span class="cp">#define UMAC_HDI_OUT_RATID_POS		16</span>
<span class="cp">#define UMAC_HDI_OUT_RATID_SEED		0xFF</span>

<span class="cm">/* iwm_umac_hdi_out_hdr.meta_data LMAC offset -- bits [31:24] */</span>
<span class="cp">#define UMAC_HDI_OUT_LMAC_OFFSET_POS	24</span>
<span class="cp">#define UMAC_HDI_OUT_LMAC_OFFSET_SEED	0xFF</span>

<span class="cm">/* Signature */</span>
<span class="cp">#define UMAC_HDI_OUT_SIGNATURE		0xCBBC</span>

<span class="cm">/* buffer alignment */</span>
<span class="cp">#define UMAC_HDI_BUF_ALIGN_MSK		0xF</span>

<span class="cm">/*  iwm_umac_hdi_in_hdr.cmd OP code -- bits [3:0] */</span>
<span class="cp">#define UMAC_HDI_IN_CMD_OPCODE_POS                0</span>
<span class="cp">#define UMAC_HDI_IN_CMD_OPCODE_SEED               0xF</span>

<span class="cm">/*  iwm_umac_hdi_in_hdr.cmd Non-WiFi API response -- bits [6:4] */</span>
<span class="cp">#define UMAC_HDI_IN_CMD_NON_WIFI_RESP_POS         4</span>
<span class="cp">#define UMAC_HDI_IN_CMD_NON_WIFI_RESP_SEED        0x7</span>

<span class="cm">/* iwm_umac_hdi_in_hdr.cmd WiFi API source -- bits [5:4] */</span>
<span class="cp">#define UMAC_HDI_IN_CMD_SOURCE_POS                4</span>
<span class="cp">#define UMAC_HDI_IN_CMD_SOURCE_SEED               0x3</span>

<span class="cm">/* iwm_umac_hdi_in_hdr.cmd WiFi API EOT -- bits [6:6] */</span>
<span class="cp">#define UMAC_HDI_IN_CMD_EOT_POS                   6</span>
<span class="cp">#define UMAC_HDI_IN_CMD_EOT_SEED                  0x1</span>

<span class="cm">/* iwm_umac_hdi_in_hdr.cmd timestamp present -- bits [7:7] */</span>
<span class="cp">#define UMAC_HDI_IN_CMD_TIME_STAMP_PRESENT_POS    7</span>
<span class="cp">#define UMAC_HDI_IN_CMD_TIME_STAMP_PRESENT_SEED   0x1</span>

<span class="cm">/* iwm_umac_hdi_in_hdr.cmd WiFi Non-last AMSDU -- bits [8:8] */</span>
<span class="cp">#define UMAC_HDI_IN_CMD_NON_LAST_AMSDU_POS        8</span>
<span class="cp">#define UMAC_HDI_IN_CMD_NON_LAST_AMSDU_SEED       0x1</span>

<span class="cm">/* iwm_umac_hdi_in_hdr.cmd WiFi HW sequence number -- bits [31:9] */</span>
<span class="cp">#define UMAC_HDI_IN_CMD_HW_SEQ_NUM_POS            9</span>
<span class="cp">#define UMAC_HDI_IN_CMD_HW_SEQ_NUM_SEED           0x7FFFFF</span>

<span class="cm">/* iwm_umac_hdi_in_hdr.cmd Non-WiFi HW sequence number -- bits [12:15] */</span>
<span class="cp">#define UDMA_HDI_IN_CMD_NON_WIFI_HW_SEQ_NUM_POS   12</span>
<span class="cp">#define UDMA_HDI_IN_CMD_NON_WIFI_HW_SEQ_NUM_SEED  0xF</span>

<span class="cm">/* iwm_umac_hdi_in_hdr.cmd Non-WiFi HW signature -- bits [16:31] */</span>
<span class="cp">#define UDMA_HDI_IN_CMD_NON_WIFI_HW_SIG_POS       16</span>
<span class="cp">#define UDMA_HDI_IN_CMD_NON_WIFI_HW_SIG_SEED      0xFFFF</span>

<span class="cm">/* Fixed Non-WiFi signature */</span>
<span class="cp">#define UDMA_HDI_IN_CMD_NON_WIFI_HW_SIG           0xCBBC</span>

<span class="cm">/* IN NTFY op-codes */</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_ALIVE		0xA1</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_INIT_COMPLETE	0xA2</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_WIFI_CORE_STATUS	0xA3</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_ERROR		0xA4</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_DEBUG		0xA5</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_WIFI_IF_WRAPPER	0xB0</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_STATS		0xB1</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_PAGE_DEALLOC		0xB3</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_RX_TICKET		0xB4</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_MAX		        (UMAC_NOTIFY_OPCODE_RX_TICKET -\</span>
<span class="cp">						UMAC_NOTIFY_OPCODE_ALIVE + 1)</span>
<span class="cp">#define UMAC_NOTIFY_OPCODE_FIRST		(UMAC_NOTIFY_OPCODE_ALIVE)</span>

<span class="cm">/* HDI OUT OP CODE */</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_PING		0x0</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_READ		0x1</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_WRITE		0x2</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_JUMP		0x3</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_REBOOT		0x4</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_WRITE_PERSISTENT	0x5</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_READ_PERSISTENT	0x6</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_READ_MODIFY_WRITE	0x7</span>
<span class="cm">/* #define UMAC_HDI_OUT_OPCODE_RESERVED		0x8..0xA */</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_WRITE_AUX_REG	0xB</span>
<span class="cp">#define UMAC_HDI_OUT_OPCODE_WIFI		0xF</span>

<span class="cm">/* HDI IN OP CODE -- Non WiFi*/</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_PING			0x0</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_READ			0x1</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_WRITE		0x2</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_WRITE_PERSISTENT	0x5</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_READ_PERSISTENT	0x6</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_READ_MODIFY_WRITE	0x7</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_EP_MGMT		0x8</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_CREDIT_CHANGE	0x9</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_CTRL_DATABASE	0xA</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_WRITE_AUX_REG	0xB</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_NONWIFI_MAX \</span>
<span class="cp">		(UMAC_HDI_IN_OPCODE_WRITE_AUX_REG + 1)</span>
<span class="cp">#define UMAC_HDI_IN_OPCODE_WIFI			0xF</span>

<span class="cm">/* HDI IN SOURCE */</span>
<span class="cp">#define UMAC_HDI_IN_SOURCE_FHRX			0x0</span>
<span class="cp">#define UMAC_HDI_IN_SOURCE_UDMA			0x1</span>
<span class="cp">#define UMAC_HDI_IN_SOURCE_FW			0x2</span>
<span class="cp">#define UMAC_HDI_IN_SOURCE_RESERVED		0x3</span>

<span class="cm">/* OUT CMD op-codes */</span>
<span class="cp">#define UMAC_CMD_OPCODE_ECHO                    0x01</span>
<span class="cp">#define UMAC_CMD_OPCODE_HALT                    0x02</span>
<span class="cp">#define UMAC_CMD_OPCODE_RESET                   0x03</span>
<span class="cp">#define UMAC_CMD_OPCODE_BULK_EP_INACT_TIMEOUT   0x09</span>
<span class="cp">#define UMAC_CMD_OPCODE_URB_CANCEL_ACK          0x0A</span>
<span class="cp">#define UMAC_CMD_OPCODE_DCACHE_FLUSH            0x0B</span>
<span class="cp">#define UMAC_CMD_OPCODE_EEPROM_PROXY            0x0C</span>
<span class="cp">#define UMAC_CMD_OPCODE_TX_ECHO                 0x0D</span>
<span class="cp">#define UMAC_CMD_OPCODE_DBG_MON                 0x0E</span>
<span class="cp">#define UMAC_CMD_OPCODE_INTERNAL_TX             0x0F</span>
<span class="cp">#define UMAC_CMD_OPCODE_SET_PARAM_FIX           0x10</span>
<span class="cp">#define UMAC_CMD_OPCODE_SET_PARAM_VAR           0x11</span>
<span class="cp">#define UMAC_CMD_OPCODE_GET_PARAM               0x12</span>
<span class="cp">#define UMAC_CMD_OPCODE_DBG_EVENT_WRAPPER       0x13</span>
<span class="cp">#define UMAC_CMD_OPCODE_TARGET                  0x14</span>
<span class="cp">#define UMAC_CMD_OPCODE_STATISTIC_REQUEST       0x15</span>
<span class="cp">#define UMAC_CMD_OPCODE_GET_CHAN_INFO_LIST	0x16</span>
<span class="cp">#define UMAC_CMD_OPCODE_SET_PARAM_LIST		0x17</span>
<span class="cp">#define UMAC_CMD_OPCODE_GET_PARAM_LIST		0x18</span>
<span class="cp">#define UMAC_CMD_OPCODE_STOP_RESUME_STA_TX      0x19</span>
<span class="cp">#define UMAC_CMD_OPCODE_TEST_BLOCK_ACK          0x1A</span>

<span class="cp">#define UMAC_CMD_OPCODE_BASE_WRAPPER            0xFA</span>
<span class="cp">#define UMAC_CMD_OPCODE_LMAC_WRAPPER            0xFB</span>
<span class="cp">#define UMAC_CMD_OPCODE_HW_TEST_WRAPPER         0xFC</span>
<span class="cp">#define UMAC_CMD_OPCODE_WIFI_IF_WRAPPER         0xFD</span>
<span class="cp">#define UMAC_CMD_OPCODE_WIFI_WRAPPER            0xFE</span>
<span class="cp">#define UMAC_CMD_OPCODE_WIFI_PASS_THROUGH       0xFF</span>

<span class="cm">/* UMAC WiFi interface op-codes */</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_SET_PROFILE                     0x11</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_INVALIDATE_PROFILE              0x12</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_SET_EXCLUDE_LIST                0x13</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_SCAN_REQUEST                    0x14</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_SCAN_CONFIG                     0x15</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_ADD_WEP40_KEY                   0x16</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_ADD_WEP104_KEY                  0x17</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_ADD_TKIP_KEY                    0x18</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_ADD_CCMP_KEY                    0x19</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_REMOVE_KEY                      0x1A</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_GLOBAL_TX_KEY_ID                0x1B</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_SET_HOST_EXTENDED_IE            0x1C</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_GET_SUPPORTED_CHANNELS          0x1E</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_PMKID_UPDATE                    0x1F</span>
<span class="cp">#define UMAC_WIFI_IF_CMD_TX_PWR_TRIGGER                  0x20</span>

<span class="cm">/* UMAC WiFi interface ports */</span>
<span class="cp">#define UMAC_WIFI_IF_FLG_PORT_DEF                        0x00</span>
<span class="cp">#define UMAC_WIFI_IF_FLG_PORT_PAN                        0x01</span>
<span class="cp">#define UMAC_WIFI_IF_FLG_PORT_PAN_INVALID                WIFI_IF_FLG_PORT_DEF</span>

<span class="cm">/* UMAC WiFi interface actions */</span>
<span class="cp">#define UMAC_WIFI_IF_FLG_ACT_GET                         0x10</span>
<span class="cp">#define UMAC_WIFI_IF_FLG_ACT_SET                         0x20</span>

<span class="cm">/* iwm_umac_fw_cmd_hdr.meta_data byte count -- bits [11:0] */</span>
<span class="cp">#define UMAC_FW_CMD_BYTE_COUNT_POS            0</span>
<span class="cp">#define UMAC_FW_CMD_BYTE_COUNT_SEED           0xFFF</span>

<span class="cm">/* iwm_umac_fw_cmd_hdr.meta_data status -- bits [15:12] */</span>
<span class="cp">#define UMAC_FW_CMD_STATUS_POS                12</span>
<span class="cp">#define UMAC_FW_CMD_STATUS_SEED               0xF</span>

<span class="cm">/* iwm_umac_fw_cmd_hdr.meta_data full TX command by Driver -- bits [16:16] */</span>
<span class="cp">#define UMAC_FW_CMD_TX_DRV_FULL_CMD_POS       16</span>
<span class="cp">#define UMAC_FW_CMD_TX_DRV_FULL_CMD_SEED      0x1</span>

<span class="cm">/* iwm_umac_fw_cmd_hdr.meta_data TX command by FW -- bits [17:17] */</span>
<span class="cp">#define UMAC_FW_CMD_TX_FW_CMD_POS             17</span>
<span class="cp">#define UMAC_FW_CMD_TX_FW_CMD_SEED            0x1</span>

<span class="cm">/* iwm_umac_fw_cmd_hdr.meta_data TX plaintext mode -- bits [18:18] */</span>
<span class="cp">#define UMAC_FW_CMD_TX_PLAINTEXT_POS          18</span>
<span class="cp">#define UMAC_FW_CMD_TX_PLAINTEXT_SEED         0x1</span>

<span class="cm">/* iwm_umac_fw_cmd_hdr.meta_data STA color -- bits [22:20] */</span>
<span class="cp">#define UMAC_FW_CMD_TX_STA_COLOR_POS          20</span>
<span class="cp">#define UMAC_FW_CMD_TX_STA_COLOR_SEED         0x7</span>

<span class="cm">/* iwm_umac_fw_cmd_hdr.meta_data TX life time (TU) -- bits [31:24] */</span>
<span class="cp">#define UMAC_FW_CMD_TX_LIFETIME_TU_POS        24</span>
<span class="cp">#define UMAC_FW_CMD_TX_LIFETIME_TU_SEED       0xFF</span>

<span class="cm">/* iwm_dev_cmd_hdr.flags Response required -- bits [5:5] */</span>
<span class="cp">#define UMAC_DEV_CMD_FLAGS_RESP_REQ_POS		5</span>
<span class="cp">#define UMAC_DEV_CMD_FLAGS_RESP_REQ_SEED	0x1</span>

<span class="cm">/* iwm_dev_cmd_hdr.flags Aborted command -- bits [6:6] */</span>
<span class="cp">#define UMAC_DEV_CMD_FLAGS_ABORT_POS		6</span>
<span class="cp">#define UMAC_DEV_CMD_FLAGS_ABORT_SEED		0x1</span>

<span class="cm">/* iwm_dev_cmd_hdr.flags Internal command -- bits [7:7] */</span>
<span class="cp">#define DEV_CMD_FLAGS_FLD_INTERNAL_POS		7</span>
<span class="cp">#define DEV_CMD_FLAGS_FLD_INTERNAL_SEED		0x1</span>

<span class="cm">/* Rx */</span>
<span class="cm">/* Rx actions */</span>
<span class="cp">#define IWM_RX_TICKET_DROP           0x0</span>
<span class="cp">#define IWM_RX_TICKET_RELEASE        0x1</span>
<span class="cp">#define IWM_RX_TICKET_SNIFFER        0x2</span>
<span class="cp">#define IWM_RX_TICKET_ENQUEUE        0x3</span>

<span class="cm">/* Rx flags */</span>
<span class="cp">#define IWM_RX_TICKET_PAD_SIZE_MSK        0x2</span>
<span class="cp">#define IWM_RX_TICKET_SPECIAL_SNAP_MSK    0x4</span>
<span class="cp">#define IWM_RX_TICKET_AMSDU_MSK           0x8</span>
<span class="cp">#define IWM_RX_TICKET_DROP_REASON_POS       4</span>
<span class="cp">#define IWM_RX_TICKET_DROP_REASON_MSK (0x1F &lt;&lt; IWM_RX_TICKET_DROP_REASON_POS)</span>

<span class="cp">#define IWM_RX_DROP_NO_DROP                          0x0</span>
<span class="cp">#define IWM_RX_DROP_BAD_CRC                          0x1</span>
<span class="cm">/* L2P no address match */</span>
<span class="cp">#define IWM_RX_DROP_LMAC_ADDR_FILTER                 0x2</span>
<span class="cm">/* Multicast address not in list */</span>
<span class="cp">#define IWM_RX_DROP_MCAST_ADDR_FILTER                0x3</span>
<span class="cm">/* Control frames are not sent to the driver */</span>
<span class="cp">#define IWM_RX_DROP_CTL_FRAME                        0x4</span>
<span class="cm">/* Our frame is back */</span>
<span class="cp">#define IWM_RX_DROP_OUR_TX                           0x5</span>
<span class="cm">/* Association class filtering */</span>
<span class="cp">#define IWM_RX_DROP_CLASS_FILTER                     0x6</span>
<span class="cm">/* Duplicated frame */</span>
<span class="cp">#define IWM_RX_DROP_DUPLICATE_FILTER                 0x7</span>
<span class="cm">/* Decryption error */</span>
<span class="cp">#define IWM_RX_DROP_SEC_ERR                          0x8</span>
<span class="cm">/* Unencrypted frame while encryption is on */</span>
<span class="cp">#define IWM_RX_DROP_SEC_NO_ENCRYPTION                0x9</span>
<span class="cm">/* Replay check failure */</span>
<span class="cp">#define IWM_RX_DROP_SEC_REPLAY_ERR                   0xa</span>
<span class="cm">/* uCode and FW key color mismatch, check before replay */</span>
<span class="cp">#define IWM_RX_DROP_SEC_KEY_COLOR_MISMATCH           0xb</span>
<span class="cp">#define IWM_RX_DROP_SEC_TKIP_COUNTER_MEASURE         0xc</span>
<span class="cm">/* No fragmentations Db is found */</span>
<span class="cp">#define IWM_RX_DROP_FRAG_NO_RESOURCE                 0xd</span>
<span class="cm">/* Fragmention Db has seqCtl mismatch Vs. non-1st frag */</span>
<span class="cp">#define IWM_RX_DROP_FRAG_ERR                         0xe</span>
<span class="cp">#define IWM_RX_DROP_FRAG_LOST                        0xf</span>
<span class="cp">#define IWM_RX_DROP_FRAG_COMPLETE                    0x10</span>
<span class="cm">/* Should be handled by UMAC */</span>
<span class="cp">#define IWM_RX_DROP_MANAGEMENT                       0x11</span>
<span class="cm">/* STA not found by UMAC */</span>
<span class="cp">#define IWM_RX_DROP_NO_STATION                       0x12</span>
<span class="cm">/* NULL or QoS NULL */</span>
<span class="cp">#define IWM_RX_DROP_NULL_DATA                        0x13</span>
<span class="cp">#define IWM_RX_DROP_BA_REORDER_OLD_SEQCTL            0x14</span>
<span class="cp">#define IWM_RX_DROP_BA_REORDER_DUPLICATE             0x15</span>

<span class="k">struct</span> <span class="n">iwm_rx_ticket</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">action</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">id</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">payload_offset</span><span class="p">;</span> <span class="cm">/* includes: MAC header, pad, IV */</span>
	<span class="n">u8</span> <span class="n">tail_len</span><span class="p">;</span> <span class="cm">/* includes: MIC, ICV, CRC (w/o STATUS) */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_rx_mpdu_hdr</span> <span class="p">{</span>
	<span class="n">__le16</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* UMAC SW WIFI API */</span>

<span class="k">struct</span> <span class="n">iwm_dev_cmd_hdr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">cmd</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">seq_num</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_fw_cmd_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">meta_data</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">iwm_dev_cmd_hdr</span> <span class="n">cmd</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_wifi_out_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_udma_out_wifi_hdr</span> <span class="n">hw_hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">iwm_umac_fw_cmd_hdr</span> <span class="n">sw_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_nonwifi_out_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_udma_out_nonwifi_hdr</span> <span class="n">hw_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_udma_in_hdr</span> <span class="n">hw_hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">iwm_umac_fw_cmd_hdr</span> <span class="n">sw_hdr</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_nonwifi_in_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_udma_in_hdr</span> <span class="n">hw_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">time_stamp</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define IWM_UMAC_PAGE_SIZE	0x200</span>

<span class="cm">/* Notify structures */</span>
<span class="k">struct</span> <span class="n">iwm_fw_version</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">minor</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">major</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">id</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">iwm_fw_build</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">subtype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">platform</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">opt</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">iwm_fw_alive_hdr</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_fw_version</span> <span class="n">ver</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">iwm_fw_build</span> <span class="n">build</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">os_build</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">log_hdr_addr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">log_buf_addr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">sys_timer_addr</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define WAIT_NOTIF_TIMEOUT     (2 * HZ)</span>
<span class="cp">#define SCAN_COMPLETE_TIMEOUT  (3 * HZ)</span>

<span class="cp">#define UMAC_NTFY_ALIVE_STATUS_ERR		0xDEAD</span>
<span class="cp">#define UMAC_NTFY_ALIVE_STATUS_OK		0xCAFE</span>

<span class="cp">#define UMAC_NTFY_INIT_COMPLETE_STATUS_ERR	0xDEAD</span>
<span class="cp">#define UMAC_NTFY_INIT_COMPLETE_STATUS_OK	0xCAFE</span>

<span class="cp">#define UMAC_NTFY_WIFI_CORE_STATUS_LINK_EN      0x40</span>
<span class="cp">#define UMAC_NTFY_WIFI_CORE_STATUS_MLME_EN      0x80</span>

<span class="cp">#define IWM_MACS_OUT_GROUPS	6</span>
<span class="cp">#define IWM_MACS_OUT_SGROUPS	1</span>


<span class="cp">#define WIFI_IF_NTFY_ASSOC_START			0x80</span>
<span class="cp">#define WIFI_IF_NTFY_ASSOC_COMPLETE			0x81</span>
<span class="cp">#define WIFI_IF_NTFY_PROFILE_INVALIDATE_COMPLETE	0x82</span>
<span class="cp">#define WIFI_IF_NTFY_CONNECTION_TERMINATED		0x83</span>
<span class="cp">#define WIFI_IF_NTFY_SCAN_COMPLETE			0x84</span>
<span class="cp">#define WIFI_IF_NTFY_STA_TABLE_CHANGE			0x85</span>
<span class="cp">#define WIFI_IF_NTFY_EXTENDED_IE_REQUIRED		0x86</span>
<span class="cp">#define WIFI_IF_NTFY_RADIO_PREEMPTION			0x87</span>
<span class="cp">#define WIFI_IF_NTFY_BSS_TRK_TABLE_CHANGED		0x88</span>
<span class="cp">#define WIFI_IF_NTFY_BSS_TRK_ENTRIES_REMOVED		0x89</span>
<span class="cp">#define WIFI_IF_NTFY_LINK_QUALITY_STATISTICS		0x8A</span>
<span class="cp">#define WIFI_IF_NTFY_MGMT_FRAME				0x8B</span>

<span class="cm">/* DEBUG INDICATIONS */</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_SCAN_SUPER_JOB_START		0xE0</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_SCAN_SUPER_JOB_COMPLETE	0xE1</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_SCAN_CHANNEL_START		0xE2</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_SCAN_CHANNEL_RESULT		0xE3</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_SCAN_MINI_JOB_START		0xE4</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_SCAN_MINI_JOB_COMPLETE		0xE5</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_CNCT_ATC_START			0xE6</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_COEX_NOTIFICATION		0xE7</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_COEX_HANDLE_ENVELOP		0xE8</span>
<span class="cp">#define WIFI_DBG_IF_NTFY_COEX_HANDLE_RELEASE_ENVELOP	0xE9</span>

<span class="cp">#define WIFI_IF_NTFY_MAX 0xff</span>

<span class="cm">/* Notification structures */</span>
<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">buf_size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_ROAM_REASON_FIRST_SELECTION	0x1</span>
<span class="cp">#define UMAC_ROAM_REASON_AP_DEAUTH		0x2</span>
<span class="cp">#define UMAC_ROAM_REASON_AP_CONNECT_LOST	0x3</span>
<span class="cp">#define UMAC_ROAM_REASON_RSSI			0x4</span>
<span class="cp">#define UMAC_ROAM_REASON_AP_ASSISTED_ROAM	0x5</span>
<span class="cp">#define UMAC_ROAM_REASON_IBSS_COALESCING	0x6</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_assoc_start</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_reason</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_ASSOC_COMPLETE_SUCCESS		0x0</span>
<span class="cp">#define UMAC_ASSOC_COMPLETE_FAILURE		0x1</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_assoc_complete</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">band</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">channel</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_PROFILE_INVALID_ASSOC_TIMEOUT	0x0</span>
<span class="cp">#define UMAC_PROFILE_INVALID_ROAM_TIMEOUT	0x1</span>
<span class="cp">#define UMAC_PROFILE_INVALID_REQUEST		0x2</span>
<span class="cp">#define UMAC_PROFILE_INVALID_RF_PREEMPTED	0x3</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_profile_invalidate</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">reason</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_SCAN_RESULT_SUCCESS  0x0</span>
<span class="cp">#define UMAC_SCAN_RESULT_ABORTED  0x1</span>
<span class="cp">#define UMAC_SCAN_RESULT_REJECTED 0x2</span>
<span class="cp">#define UMAC_SCAN_RESULT_FAILED   0x3</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_scan_complete</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">result</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">seq_num</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_OPCODE_ADD_MODIFY	0x0</span>
<span class="cp">#define UMAC_OPCODE_REMOVE	0x1</span>
<span class="cp">#define UMAC_OPCODE_CLEAR_ALL	0x2</span>

<span class="cp">#define UMAC_STA_FLAG_QOS	0x1</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_sta_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">opcode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mac_addr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">sta_id</span><span class="p">;</span> <span class="cm">/* bits 0-3: station ID, bits 4-7: station color */</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_BAND_2GHZ 0</span>
<span class="cp">#define UMAC_BAND_5GHZ 1</span>

<span class="cp">#define UMAC_CHANNEL_WIDTH_20MHZ 0</span>
<span class="cp">#define UMAC_CHANNEL_WIDTH_40MHZ 1</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_bss_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">type</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">timestamp</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">table_idx</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">frame_len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">band</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">channel</span><span class="p">;</span>
	<span class="n">s8</span> <span class="n">rssi</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">frame_buf</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define IWM_BSS_REMOVE_INDEX_MSK           0x0fff</span>
<span class="cp">#define IWM_BSS_REMOVE_FLAGS_MSK           0xfc00</span>

<span class="cp">#define IWM_BSS_REMOVE_FLG_AGE             0x1000</span>
<span class="cp">#define IWM_BSS_REMOVE_FLG_TIMEOUT         0x2000</span>
<span class="cp">#define IWM_BSS_REMOVE_FLG_TABLE_FULL      0x4000</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_bss_removed</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">count</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">entries</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_mgt_frame</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_if</span> <span class="n">mlme_hdr</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">len</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">frame</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_alive</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reserved1</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">iwm_fw_alive_hdr</span> <span class="n">alive_data</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reserved2</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">page_grp_count</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">page_grp_state</span><span class="p">[</span><span class="n">IWM_MACS_OUT_GROUPS</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_init_complete</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* error categories */</span>
<span class="k">enum</span> <span class="p">{</span>
	<span class="n">UMAC_SYS_ERR_CAT_NONE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">UMAC_SYS_ERR_CAT_BOOT</span><span class="p">,</span>
	<span class="n">UMAC_SYS_ERR_CAT_UMAC</span><span class="p">,</span>
	<span class="n">UMAC_SYS_ERR_CAT_UAXM</span><span class="p">,</span>
	<span class="n">UMAC_SYS_ERR_CAT_LMAC</span><span class="p">,</span>
	<span class="n">UMAC_SYS_ERR_CAT_MAX</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">iwm_fw_error_hdr</span> <span class="p">{</span>
	<span class="n">__le32</span> <span class="n">category</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">pc</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">blink1</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">blink2</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">ilink1</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">ilink2</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">data1</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">data2</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">line_num</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">umac_status</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">lmac_status</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">sdio_status</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">dbm_sample_ctrl</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">dbm_buf_base</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">dbm_buf_end</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">dbm_buf_write_ptr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">dbm_buf_cycle_cnt</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_error</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">iwm_fw_error_hdr</span> <span class="n">err</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_DEALLOC_NTFY_CHANGES_CNT_POS	0</span>
<span class="cp">#define UMAC_DEALLOC_NTFY_CHANGES_CNT_SEED	0xff</span>
<span class="cp">#define UMAC_DEALLOC_NTFY_CHANGES_MSK_POS	8</span>
<span class="cp">#define UMAC_DEALLOC_NTFY_CHANGES_MSK_SEED	0xffffff</span>
<span class="cp">#define UMAC_DEALLOC_NTFY_PAGE_CNT_POS		0</span>
<span class="cp">#define UMAC_DEALLOC_NTFY_PAGE_CNT_SEED		0xffffff</span>
<span class="cp">#define UMAC_DEALLOC_NTFY_GROUP_NUM_POS		24</span>
<span class="cp">#define UMAC_DEALLOC_NTFY_GROUP_NUM_SEED	0xf</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_page_dealloc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">changes</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">grp_info</span><span class="p">[</span><span class="n">IWM_MACS_OUT_GROUPS</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_wifi_status</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">status</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">reserved</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_rx_ticket</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">num_tickets</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">reserved</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">iwm_rx_ticket</span> <span class="n">tickets</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cm">/* Tx/Rx rates window (number of max of last update window per second) */</span>
<span class="cp">#define UMAC_NTF_RATE_SAMPLE_NR	4</span>

<span class="cm">/* Max numbers of bits required to go through all antennae in bitmasks */</span>
<span class="cp">#define UMAC_PHY_NUM_CHAINS     3</span>

<span class="cp">#define IWM_UMAC_MGMT_TID	8</span>
<span class="cp">#define IWM_UMAC_TID_NR		9 </span><span class="cm">/* 8 TIDs + MGMT */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_stats</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">timestamp</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">tid_load</span><span class="p">[</span><span class="n">IWM_UMAC_TID_NR</span> <span class="o">+</span> <span class="mi">1</span><span class="p">];</span> <span class="cm">/* 1 non-QoS + 1 dword align */</span>
	<span class="n">__le16</span> <span class="n">tx_rate</span><span class="p">[</span><span class="n">UMAC_NTF_RATE_SAMPLE_NR</span><span class="p">];</span>
	<span class="n">__le16</span> <span class="n">rx_rate</span><span class="p">[</span><span class="n">UMAC_NTF_RATE_SAMPLE_NR</span><span class="p">];</span>
	<span class="n">__le32</span> <span class="n">chain_energy</span><span class="p">[</span><span class="n">UMAC_PHY_NUM_CHAINS</span><span class="p">];</span>
	<span class="n">s32</span> <span class="n">rssi_dbm</span><span class="p">;</span>
	<span class="n">s32</span> <span class="n">noise_dbm</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">supp_rates</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">supp_ht_rates</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">missed_beacons</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_beacons</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_dir_pkts</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_nondir_pkts</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_multicast</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_errors</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_drop_other_bssid</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_drop_decode</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_drop_reassembly</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_drop_bad_len</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_drop_overflow</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_drop_crc</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_drop_missed</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_dir_pkts</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_nondir_pkts</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_failure</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_errors</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_drop_max_retry</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_err_abort</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_err_carrier</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">rx_bytes</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_bytes</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_power</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">tx_max_power</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_threshold</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">ap_assoc_nr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">scan_full</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">scan_abort</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">ap_nr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_nr</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_missed_beacons</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_rssi</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_unassoc</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_deauth</span><span class="p">;</span>
	<span class="n">__le32</span> <span class="n">roam_ap_loadblance</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_STOP_TX_FLAG    0x1</span>
<span class="cp">#define UMAC_RESUME_TX_FLAG  0x2</span>

<span class="cp">#define LAST_SEQ_NUM_INVALID     0xFFFF</span>

<span class="k">struct</span> <span class="n">iwm_umac_notif_stop_resume_tx</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">iwm_umac_wifi_in_hdr</span> <span class="n">hdr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span> <span class="cm">/* UMAC_*_TX_FLAG_* */</span>
	<span class="n">u8</span> <span class="n">sta_id</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">stop_resume_tid_msk</span><span class="p">;</span> <span class="cm">/* tid bitmask */</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define UMAC_MAX_NUM_PMKIDS 4</span>

<span class="cm">/* WiFi interface wrapper header */</span>
<span class="k">struct</span> <span class="n">iwm_umac_wifi_if</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">oid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__le16</span> <span class="n">buf_size</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define IWM_SEQ_NUM_HOST_MSK	0x0000</span>
<span class="cp">#define IWM_SEQ_NUM_UMAC_MSK	0x4000</span>
<span class="cp">#define IWM_SEQ_NUM_LMAC_MSK	0x8000</span>
<span class="cp">#define IWM_SEQ_NUM_MSK		0xC000</span>

<span class="cp">#endif</span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:4}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../javascript/docco.min.js"></script>
</html>
