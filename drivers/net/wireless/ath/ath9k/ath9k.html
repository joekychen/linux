<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › wireless › ath › ath9k › ath9k.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>ath9k.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2008-2011 Atheros Communications Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="cm"> * purpose with or without fee is hereby granted, provided that the above</span>
<span class="cm"> * copyright notice and this permission notice appear in all copies.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="cm"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="cm"> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="cm"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="cm"> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="cm"> * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef ATH9K_H</span>
<span class="cp">#define ATH9K_H</span>

<span class="cp">#include &lt;linux/etherdevice.h&gt;</span>
<span class="cp">#include &lt;linux/device.h&gt;</span>
<span class="cp">#include &lt;linux/interrupt.h&gt;</span>
<span class="cp">#include &lt;linux/leds.h&gt;</span>
<span class="cp">#include &lt;linux/completion.h&gt;</span>

<span class="cp">#include &quot;debug.h&quot;</span>
<span class="cp">#include &quot;common.h&quot;</span>
<span class="cp">#include &quot;mci.h&quot;</span>
<span class="cp">#include &quot;dfs.h&quot;</span>

<span class="cm">/*</span>
<span class="cm"> * Header for the ath9k.ko driver core *only* -- hw code nor any other driver</span>
<span class="cm"> * should rely on this file or its contents.</span>
<span class="cm"> */</span>

<span class="k">struct</span> <span class="n">ath_node</span><span class="p">;</span>

<span class="cm">/* Macro to expand scalars to 64-bit objects */</span>

<span class="cp">#define	ito64(x) (sizeof(x) == 1) ?			\</span>
<span class="cp">	(((unsigned long long int)(x)) &amp; (0xff)) :	\</span>
<span class="cp">	(sizeof(x) == 2) ?				\</span>
<span class="cp">	(((unsigned long long int)(x)) &amp; 0xffff) :	\</span>
<span class="cp">	((sizeof(x) == 4) ?				\</span>
<span class="cp">	 (((unsigned long long int)(x)) &amp; 0xffffffff) : \</span>
<span class="cp">	 (unsigned long long int)(x))</span>

<span class="cm">/* increment with wrap-around */</span>
<span class="cp">#define INCR(_l, _sz)   do {			\</span>
<span class="cp">		(_l)++;				\</span>
<span class="cp">		(_l) &amp;= ((_sz) - 1);		\</span>
<span class="cp">	} while (0)</span>

<span class="cm">/* decrement with wrap-around */</span>
<span class="cp">#define DECR(_l,  _sz)  do {			\</span>
<span class="cp">		(_l)--;				\</span>
<span class="cp">		(_l) &amp;= ((_sz) - 1);		\</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define TSF_TO_TU(_h,_l) \</span>
<span class="cp">	((((u32)(_h)) &lt;&lt; 22) | (((u32)(_l)) &gt;&gt; 10))</span>

<span class="cp">#define	ATH_TXQ_SETUP(sc, i)        ((sc)-&gt;tx.txqsetup &amp; (1&lt;&lt;i))</span>

<span class="k">struct</span> <span class="n">ath_config</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">txpowlimit</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">cabqReadytime</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*************************/</span>
<span class="cm">/* Descriptor Management */</span>
<span class="cm">/*************************/</span>

<span class="cp">#define ATH_TXBUF_RESET(_bf) do {				\</span>
<span class="cp">		(_bf)-&gt;bf_stale = false;			\</span>
<span class="cp">		(_bf)-&gt;bf_lastbf = NULL;			\</span>
<span class="cp">		(_bf)-&gt;bf_next = NULL;				\</span>
<span class="cp">		memset(&amp;((_bf)-&gt;bf_state), 0,			\</span>
<span class="cp">		       sizeof(struct ath_buf_state));		\</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define ATH_RXBUF_RESET(_bf) do {		\</span>
<span class="cp">		(_bf)-&gt;bf_stale = false;	\</span>
<span class="cp">	} while (0)</span>

<span class="cm">/**</span>
<span class="cm"> * enum buffer_type - Buffer type flags</span>
<span class="cm"> *</span>
<span class="cm"> * @BUF_AMPDU: This buffer is an ampdu, as part of an aggregate (during TX)</span>
<span class="cm"> * @BUF_AGGR: Indicates whether the buffer can be aggregated</span>
<span class="cm"> *	(used in aggregation scheduling)</span>
<span class="cm"> */</span>
<span class="k">enum</span> <span class="n">buffer_type</span> <span class="p">{</span>
	<span class="n">BUF_AMPDU</span>		<span class="o">=</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
	<span class="n">BUF_AGGR</span>		<span class="o">=</span> <span class="n">BIT</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="p">};</span>

<span class="cp">#define bf_isampdu(bf)		(bf-&gt;bf_state.bf_type &amp; BUF_AMPDU)</span>
<span class="cp">#define bf_isaggr(bf)		(bf-&gt;bf_state.bf_type &amp; BUF_AGGR)</span>

<span class="cp">#define ATH_TXSTATUS_RING_SIZE 512</span>

<span class="cp">#define	DS2PHYS(_dd, _ds)						\</span>
<span class="cp">	((_dd)-&gt;dd_desc_paddr + ((caddr_t)(_ds) - (caddr_t)(_dd)-&gt;dd_desc))</span>
<span class="cp">#define ATH_DESC_4KB_BOUND_CHECK(_daddr) ((((_daddr) &amp; 0xFFF) &gt; 0xF7F) ? 1 : 0)</span>
<span class="cp">#define ATH_DESC_4KB_BOUND_NUM_SKIPPED(_len) ((_len) / 4096)</span>

<span class="k">struct</span> <span class="n">ath_descdma</span> <span class="p">{</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">dd_desc</span><span class="p">;</span>
	<span class="n">dma_addr_t</span> <span class="n">dd_desc_paddr</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">dd_desc_len</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_buf</span> <span class="o">*</span><span class="n">dd_bufptr</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">ath_descdma_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_descdma</span> <span class="o">*</span><span class="n">dd</span><span class="p">,</span>
		      <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">head</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">,</span>
		      <span class="kt">int</span> <span class="n">nbuf</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ndesc</span><span class="p">,</span> <span class="n">bool</span> <span class="n">is_tx</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_descdma_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_descdma</span> <span class="o">*</span><span class="n">dd</span><span class="p">,</span>
			 <span class="k">struct</span> <span class="n">list_head</span> <span class="o">*</span><span class="n">head</span><span class="p">);</span>

<span class="cm">/***********/</span>
<span class="cm">/* RX / TX */</span>
<span class="cm">/***********/</span>

<span class="cp">#define ATH_RXBUF               512</span>
<span class="cp">#define ATH_TXBUF               512</span>
<span class="cp">#define ATH_TXBUF_RESERVE       5</span>
<span class="cp">#define ATH_MAX_QDEPTH          (ATH_TXBUF / 4 - ATH_TXBUF_RESERVE)</span>
<span class="cp">#define ATH_TXMAXTRY            13</span>

<span class="cp">#define TID_TO_WME_AC(_tid)				\</span>
<span class="cp">	((((_tid) == 0) || ((_tid) == 3)) ? WME_AC_BE :	\</span>
<span class="cp">	 (((_tid) == 1) || ((_tid) == 2)) ? WME_AC_BK :	\</span>
<span class="cp">	 (((_tid) == 4) || ((_tid) == 5)) ? WME_AC_VI :	\</span>
<span class="cp">	 WME_AC_VO)</span>

<span class="cp">#define ATH_AGGR_DELIM_SZ          4</span>
<span class="cp">#define ATH_AGGR_MINPLEN           256 </span><span class="cm">/* in bytes, minimum packet length */</span><span class="cp"></span>
<span class="cm">/* number of delimiters for encryption padding */</span>
<span class="cp">#define ATH_AGGR_ENCRYPTDELIM      10</span>
<span class="cm">/* minimum h/w qdepth to be sustained to maximize aggregation */</span>
<span class="cp">#define ATH_AGGR_MIN_QDEPTH        2</span>
<span class="cp">#define ATH_AMPDU_SUBFRAME_DEFAULT 32</span>

<span class="cp">#define IEEE80211_SEQ_SEQ_SHIFT    4</span>
<span class="cp">#define IEEE80211_SEQ_MAX          4096</span>
<span class="cp">#define IEEE80211_WEP_IVLEN        3</span>
<span class="cp">#define IEEE80211_WEP_KIDLEN       1</span>
<span class="cp">#define IEEE80211_WEP_CRCLEN       4</span>
<span class="cp">#define IEEE80211_MAX_MPDU_LEN     (3840 + FCS_LEN +		\</span>
<span class="cp">				    (IEEE80211_WEP_IVLEN +	\</span>
<span class="cp">				     IEEE80211_WEP_KIDLEN +	\</span>
<span class="cp">				     IEEE80211_WEP_CRCLEN))</span>

<span class="cm">/* return whether a bit at index _n in bitmap _bm is set</span>
<span class="cm"> * _sz is the size of the bitmap  */</span>
<span class="cp">#define ATH_BA_ISSET(_bm, _n)  (((_n) &lt; (WME_BA_BMP_SIZE)) &amp;&amp;		\</span>
<span class="cp">				((_bm)[(_n) &gt;&gt; 5] &amp; (1 &lt;&lt; ((_n) &amp; 31))))</span>

<span class="cm">/* return block-ack bitmap index given sequence and starting sequence */</span>
<span class="cp">#define ATH_BA_INDEX(_st, _seq) (((_seq) - (_st)) &amp; (IEEE80211_SEQ_MAX - 1))</span>

<span class="cm">/* return the seqno for _start + _offset */</span>
<span class="cp">#define ATH_BA_INDEX2SEQ(_seq, _offset) (((_seq) + (_offset)) &amp; (IEEE80211_SEQ_MAX - 1))</span>

<span class="cm">/* returns delimiter padding required given the packet length */</span>
<span class="cp">#define ATH_AGGR_GET_NDELIM(_len)					\</span>
<span class="cp">       (((_len) &gt;= ATH_AGGR_MINPLEN) ? 0 :                             \</span>
<span class="cp">        DIV_ROUND_UP(ATH_AGGR_MINPLEN - (_len), ATH_AGGR_DELIM_SZ))</span>

<span class="cp">#define BAW_WITHIN(_start, _bawsz, _seqno) \</span>
<span class="cp">	((((_seqno) - (_start)) &amp; 4095) &lt; (_bawsz))</span>

<span class="cp">#define ATH_AN_2_TID(_an, _tidno)  (&amp;(_an)-&gt;tid[(_tidno)])</span>

<span class="cp">#define ATH_TX_COMPLETE_POLL_INT	1000</span>

<span class="k">enum</span> <span class="n">ATH_AGGR_STATUS</span> <span class="p">{</span>
	<span class="n">ATH_AGGR_DONE</span><span class="p">,</span>
	<span class="n">ATH_AGGR_BAW_CLOSED</span><span class="p">,</span>
	<span class="n">ATH_AGGR_LIMITED</span><span class="p">,</span>
<span class="p">};</span>

<span class="cp">#define ATH_TXFIFO_DEPTH 8</span>
<span class="k">struct</span> <span class="n">ath_txq</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">mac80211_qnum</span><span class="p">;</span> <span class="cm">/* mac80211 queue number, -1 means not mac80211 Q */</span>
	<span class="n">u32</span> <span class="n">axq_qnum</span><span class="p">;</span> <span class="cm">/* ath9k hardware queue number */</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">axq_link</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">axq_q</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">axq_lock</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">axq_depth</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">axq_ampdu_depth</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">stopped</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">axq_tx_inprogress</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">axq_acq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">txq_fifo</span><span class="p">[</span><span class="n">ATH_TXFIFO_DEPTH</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">txq_headidx</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">txq_tailidx</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">pending_frames</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">complete_q</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_atx_ac</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">txq</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">sched</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">tid_q</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">clear_ps_filter</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_frame_info</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ath_buf</span> <span class="o">*</span><span class="n">bf</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">framelen</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ath9k_key_type</span> <span class="n">keytype</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">keyix</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">retries</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rtscts_rate</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_buf_state</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">bf_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">bfs_paprd</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ndelim</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">seqno</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">bfs_paprd_timestamp</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_buf</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_buf</span> <span class="o">*</span><span class="n">bf_lastbf</span><span class="p">;</span>	<span class="cm">/* last buf of this unit (a frame or</span>
<span class="cm">					   an aggregate) */</span>
	<span class="k">struct</span> <span class="n">ath_buf</span> <span class="o">*</span><span class="n">bf_next</span><span class="p">;</span>	<span class="cm">/* next subframe in the aggregate */</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">bf_mpdu</span><span class="p">;</span>	<span class="cm">/* enclosing frame structure */</span>
	<span class="kt">void</span> <span class="o">*</span><span class="n">bf_desc</span><span class="p">;</span>			<span class="cm">/* virtual addr of desc */</span>
	<span class="n">dma_addr_t</span> <span class="n">bf_daddr</span><span class="p">;</span>		<span class="cm">/* physical addr of desc */</span>
	<span class="n">dma_addr_t</span> <span class="n">bf_buf_addr</span><span class="p">;</span>	<span class="cm">/* physical addr of data buffer, for DMA */</span>
	<span class="n">bool</span> <span class="n">bf_stale</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_buf_state</span> <span class="n">bf_state</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_atx_tid</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">buf_q</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_node</span> <span class="o">*</span><span class="n">an</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_atx_ac</span> <span class="o">*</span><span class="n">ac</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">tx_buf</span><span class="p">[</span><span class="n">BITS_TO_LONGS</span><span class="p">(</span><span class="n">ATH_TID_MAX_BUFS</span><span class="p">)];</span>
	<span class="kt">int</span> <span class="n">bar_index</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">seq_start</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">seq_next</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">baw_size</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">tidno</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">baw_head</span><span class="p">;</span>   <span class="cm">/* first un-acked tx buffer */</span>
	<span class="kt">int</span> <span class="n">baw_tail</span><span class="p">;</span>   <span class="cm">/* next unused tx buffer slot */</span>
	<span class="kt">int</span> <span class="n">sched</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">paused</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">state</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_node</span> <span class="p">{</span>
<span class="cp">#ifdef CONFIG_ATH9K_DEBUGFS</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span> <span class="cm">/* for sc-&gt;nodes */</span>
<span class="cp">#endif</span>
	<span class="k">struct</span> <span class="n">ieee80211_sta</span> <span class="o">*</span><span class="n">sta</span><span class="p">;</span> <span class="cm">/* station struct we&#39;re part of */</span>
	<span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">;</span> <span class="cm">/* interface with which we&#39;re associated */</span>
	<span class="k">struct</span> <span class="n">ath_atx_tid</span> <span class="n">tid</span><span class="p">[</span><span class="n">WME_NUM_TID</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">ath_atx_ac</span> <span class="n">ac</span><span class="p">[</span><span class="n">WME_NUM_AC</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">ps_key</span><span class="p">;</span>

	<span class="n">u16</span> <span class="n">maxampdu</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mpdudensity</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">sleeping</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define AGGR_CLEANUP         BIT(1)</span>
<span class="cp">#define AGGR_ADDBA_COMPLETE  BIT(2)</span>
<span class="cp">#define AGGR_ADDBA_PROGRESS  BIT(3)</span>

<span class="k">struct</span> <span class="n">ath_tx_control</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">txq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_node</span> <span class="o">*</span><span class="n">an</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">paprd</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define ATH_TX_ERROR        0x01</span>

<span class="cm">/**</span>
<span class="cm"> * @txq_map:  Index is mac80211 queue number.  This is</span>
<span class="cm"> *  not necessarily the same as the hardware queue number</span>
<span class="cm"> *  (axq_qnum).</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">ath_tx</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">seq_no</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">txqsetup</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">txbuflock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">txbuf</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_txq</span> <span class="n">txq</span><span class="p">[</span><span class="n">ATH9K_NUM_TX_QUEUES</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">ath_descdma</span> <span class="n">txdma</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">txq_map</span><span class="p">[</span><span class="n">WME_NUM_AC</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_rx_edma</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">rx_fifo</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">rx_fifo_hwsize</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_rx</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">defant</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rxotherant</span><span class="p">;</span>
	<span class="n">u32</span> <span class="o">*</span><span class="n">rxlink</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rxfilter</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">rxbuflock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">rxbuf</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_descdma</span> <span class="n">rxdma</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_buf</span> <span class="o">*</span><span class="n">rx_bufptr</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_rx_edma</span> <span class="n">rx_edma</span><span class="p">[</span><span class="n">ATH9K_RX_QUEUE_MAX</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">frag</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">int</span> <span class="n">ath_startrecv</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">ath_stoprecv</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_flushrecv</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="n">u32</span> <span class="n">ath_calcrxfilter</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_rx_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nbufs</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_rx_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_rx_tasklet</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">flush</span><span class="p">,</span> <span class="n">bool</span> <span class="n">hp</span><span class="p">);</span>
<span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">ath_txq_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">qtype</span><span class="p">,</span> <span class="kt">int</span> <span class="n">subtype</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_cleanupq</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">txq</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">ath_drain_all_txq</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">bool</span> <span class="n">retry_tx</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_draintxq</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span>
		     <span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">txq</span><span class="p">,</span> <span class="n">bool</span> <span class="n">retry_tx</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_node_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_node</span> <span class="o">*</span><span class="n">an</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_node_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_node</span> <span class="o">*</span><span class="n">an</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_txq_schedule</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">txq</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_tx_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nbufs</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_txq_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="kt">int</span> <span class="n">qnum</span><span class="p">,</span>
		   <span class="k">struct</span> <span class="n">ath9k_tx_queue_info</span> <span class="o">*</span><span class="n">q</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_tx_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
		 <span class="k">struct</span> <span class="n">ath_tx_control</span> <span class="o">*</span><span class="n">txctl</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_tasklet</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_edma_tasklet</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_tx_aggr_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_sta</span> <span class="o">*</span><span class="n">sta</span><span class="p">,</span>
		      <span class="n">u16</span> <span class="n">tid</span><span class="p">,</span> <span class="n">u16</span> <span class="o">*</span><span class="n">ssn</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_aggr_stop</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_sta</span> <span class="o">*</span><span class="n">sta</span><span class="p">,</span> <span class="n">u16</span> <span class="n">tid</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_aggr_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_sta</span> <span class="o">*</span><span class="n">sta</span><span class="p">,</span> <span class="n">u16</span> <span class="n">tid</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath_tx_aggr_wakeup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_node</span> <span class="o">*</span><span class="n">an</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_tx_aggr_sleep</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_sta</span> <span class="o">*</span><span class="n">sta</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">ath_node</span> <span class="o">*</span><span class="n">an</span><span class="p">);</span>

<span class="cm">/********/</span>
<span class="cm">/* VIFs */</span>
<span class="cm">/********/</span>

<span class="k">struct</span> <span class="n">ath_vif</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">av_bslot</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">is_bslot_active</span><span class="p">,</span> <span class="n">primary_sta_vif</span><span class="p">;</span>
	<span class="n">__le64</span> <span class="n">tsf_adjust</span><span class="p">;</span> <span class="cm">/* TSF adjustment for staggered beacons */</span>
	<span class="k">struct</span> <span class="n">ath_buf</span> <span class="o">*</span><span class="n">av_bcbuf</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/*******************/</span>
<span class="cm">/* Beacon Handling */</span>
<span class="cm">/*******************/</span>

<span class="cm">/*</span>
<span class="cm"> * Regardless of the number of beacons we stagger, (i.e. regardless of the</span>
<span class="cm"> * number of BSSIDs) if a given beacon does not go out even after waiting this</span>
<span class="cm"> * number of beacon intervals, the game&#39;s up.</span>
<span class="cm"> */</span>
<span class="cp">#define BSTUCK_THRESH           	9</span>
<span class="cp">#define	ATH_BCBUF               	8</span>
<span class="cp">#define ATH_DEFAULT_BINTVAL     	100 </span><span class="cm">/* TU */</span><span class="cp"></span>
<span class="cp">#define ATH_DEFAULT_BMISS_LIMIT 	10</span>
<span class="cp">#define IEEE80211_MS_TO_TU(x)           (((x) * 1000) / 1024)</span>

<span class="k">struct</span> <span class="n">ath_beacon_config</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">beacon_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">listen_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">dtim_period</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bmiss_timeout</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">dtim_count</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_beacon</span> <span class="p">{</span>
	<span class="k">enum</span> <span class="p">{</span>
		<span class="n">OK</span><span class="p">,</span>		<span class="cm">/* no change needed */</span>
		<span class="n">UPDATE</span><span class="p">,</span>		<span class="cm">/* update pending */</span>
		<span class="n">COMMIT</span>		<span class="cm">/* beacon sent, commit change */</span>
	<span class="p">}</span> <span class="n">updateslot</span><span class="p">;</span>		<span class="cm">/* slot time update fsm */</span>

	<span class="n">u32</span> <span class="n">beaconq</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">bmisscnt</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">ast_be_xmit</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">bc_tstamp</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">bslot</span><span class="p">[</span><span class="n">ATH_BCBUF</span><span class="p">];</span>
	<span class="kt">int</span> <span class="n">slottime</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">slotupdate</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath9k_tx_queue_info</span> <span class="n">beacon_qi</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_descdma</span> <span class="n">bdma</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_txq</span> <span class="o">*</span><span class="n">cabq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">bbuf</span><span class="p">;</span>

	<span class="n">bool</span> <span class="n">tx_processed</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">tx_last</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="n">ath_beacon_tasklet</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_beacon_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_beacon_alloc</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_beacon_return</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_vif</span> <span class="o">*</span><span class="n">avp</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_beaconq_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_set_beacon</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_set_beaconing_status</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">bool</span> <span class="n">status</span><span class="p">);</span>

<span class="cm">/*******/</span>
<span class="cm">/* ANI */</span>
<span class="cm">/*******/</span>

<span class="cp">#define ATH_STA_SHORT_CALINTERVAL 1000    </span><span class="cm">/* 1 second */</span><span class="cp"></span>
<span class="cp">#define ATH_AP_SHORT_CALINTERVAL  100     </span><span class="cm">/* 100 ms */</span><span class="cp"></span>
<span class="cp">#define ATH_ANI_POLLINTERVAL_OLD  100     </span><span class="cm">/* 100 ms */</span><span class="cp"></span>
<span class="cp">#define ATH_ANI_POLLINTERVAL_NEW  1000    </span><span class="cm">/* 1000 ms */</span><span class="cp"></span>
<span class="cp">#define ATH_LONG_CALINTERVAL_INT  1000    </span><span class="cm">/* 1000 ms */</span><span class="cp"></span>
<span class="cp">#define ATH_LONG_CALINTERVAL      30000   </span><span class="cm">/* 30 seconds */</span><span class="cp"></span>
<span class="cp">#define ATH_RESTART_CALINTERVAL   1200000 </span><span class="cm">/* 20 minutes */</span><span class="cp"></span>

<span class="cp">#define ATH_PAPRD_TIMEOUT	100 </span><span class="cm">/* msecs */</span><span class="cp"></span>

<span class="kt">void</span> <span class="n">ath_reset_work</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_hw_check</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_hw_pll_work</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_rx_poll</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_start_rx_poll</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">u8</span> <span class="n">nbeacon</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_paprd_calibrate</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_ani_calibrate</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_start_ani</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_common</span> <span class="o">*</span><span class="n">common</span><span class="p">);</span>

<span class="cm">/**********/</span>
<span class="cm">/* BTCOEX */</span>
<span class="cm">/**********/</span>

<span class="k">struct</span> <span class="n">ath_btcoex</span> <span class="p">{</span>
	<span class="n">bool</span> <span class="n">hw_timer_enabled</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">btcoex_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">period_timer</span><span class="p">;</span> <span class="cm">/* Timer for BT period */</span>
	<span class="n">u32</span> <span class="n">bt_priority_cnt</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">bt_priority_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">bt_stomp_type</span><span class="p">;</span> <span class="cm">/* Types of BT stomping */</span>
	<span class="n">u32</span> <span class="n">btcoex_no_stomp</span><span class="p">;</span> <span class="cm">/* in usec */</span>
	<span class="n">u32</span> <span class="n">btcoex_period</span><span class="p">;</span> <span class="cm">/* in usec */</span>
	<span class="n">u32</span> <span class="n">btscan_no_stomp</span><span class="p">;</span> <span class="cm">/* in usec */</span>
	<span class="n">u32</span> <span class="n">duty_cycle</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_gen_timer</span> <span class="o">*</span><span class="n">no_stomp_timer</span><span class="p">;</span> <span class="cm">/* Timer for no BT stomping */</span>
	<span class="k">struct</span> <span class="n">ath_mci_profile</span> <span class="n">mci</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#ifdef CONFIG_ATH9K_BTCOEX_SUPPORT</span>
<span class="kt">int</span> <span class="n">ath9k_init_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_deinit_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_start_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_stop_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_btcoex_timer_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_btcoex_timer_pause</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_btcoex_handle_interrupt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">u32</span> <span class="n">status</span><span class="p">);</span>
<span class="n">u16</span> <span class="n">ath9k_btcoex_aggr_limit</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">u32</span> <span class="n">max_4ms_framelen</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ath9k_init_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_deinit_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_start_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_stop_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_btcoex_handle_interrupt</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span>
						 <span class="n">u32</span> <span class="n">status</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="n">u16</span> <span class="nf">ath9k_btcoex_aggr_limit</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span>
					  <span class="n">u32</span> <span class="n">max_4ms_framelen</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_ATH9K_BTCOEX_SUPPORT */</span><span class="cp"></span>

<span class="cm">/********************/</span>
<span class="cm">/*   LED Control    */</span>
<span class="cm">/********************/</span>

<span class="cp">#define ATH_LED_PIN_DEF 		1</span>
<span class="cp">#define ATH_LED_PIN_9287		8</span>
<span class="cp">#define ATH_LED_PIN_9300		10</span>
<span class="cp">#define ATH_LED_PIN_9485		6</span>
<span class="cp">#define ATH_LED_PIN_9462		4</span>

<span class="cp">#ifdef CONFIG_MAC80211_LEDS</span>
<span class="kt">void</span> <span class="n">ath_init_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_deinit_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath_init_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath_deinit_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="cp">#endif</span>


<span class="cm">/* Antenna diversity/combining */</span>
<span class="cp">#define ATH_ANT_RX_CURRENT_SHIFT 4</span>
<span class="cp">#define ATH_ANT_RX_MAIN_SHIFT 2</span>
<span class="cp">#define ATH_ANT_RX_MASK 0x3</span>

<span class="cp">#define ATH_ANT_DIV_COMB_SHORT_SCAN_INTR 50</span>
<span class="cp">#define ATH_ANT_DIV_COMB_SHORT_SCAN_PKTCOUNT 0x100</span>
<span class="cp">#define ATH_ANT_DIV_COMB_MAX_PKTCOUNT 0x200</span>
<span class="cp">#define ATH_ANT_DIV_COMB_INIT_COUNT 95</span>
<span class="cp">#define ATH_ANT_DIV_COMB_MAX_COUNT 100</span>
<span class="cp">#define ATH_ANT_DIV_COMB_ALT_ANT_RATIO 30</span>
<span class="cp">#define ATH_ANT_DIV_COMB_ALT_ANT_RATIO2 20</span>

<span class="cp">#define ATH_ANT_DIV_COMB_LNA1_LNA2_SWITCH_DELTA -1</span>
<span class="cp">#define ATH_ANT_DIV_COMB_LNA1_DELTA_HI -4</span>
<span class="cp">#define ATH_ANT_DIV_COMB_LNA1_DELTA_MID -2</span>
<span class="cp">#define ATH_ANT_DIV_COMB_LNA1_DELTA_LOW 2</span>

<span class="k">enum</span> <span class="n">ath9k_ant_div_comb_lna_conf</span> <span class="p">{</span>
	<span class="n">ATH_ANT_DIV_COMB_LNA1_MINUS_LNA2</span><span class="p">,</span>
	<span class="n">ATH_ANT_DIV_COMB_LNA2</span><span class="p">,</span>
	<span class="n">ATH_ANT_DIV_COMB_LNA1</span><span class="p">,</span>
	<span class="n">ATH_ANT_DIV_COMB_LNA1_PLUS_LNA2</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_ant_comb</span> <span class="p">{</span>
	<span class="n">u16</span> <span class="n">count</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">total_pkt_count</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">scan</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">scan_not_start</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">main_total_rssi</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">alt_total_rssi</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">alt_recv_cnt</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">main_recv_cnt</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rssi_lna1</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rssi_lna2</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rssi_add</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rssi_sub</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rssi_first</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rssi_second</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">rssi_third</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">alt_good</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">quick_scan_cnt</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">main_conf</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ath9k_ant_div_comb_lna_conf</span> <span class="n">first_quick_scan_conf</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">ath9k_ant_div_comb_lna_conf</span> <span class="n">second_quick_scan_conf</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">first_bias</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">second_bias</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">first_ratio</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">second_ratio</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">scan_start_time</span><span class="p">;</span>
<span class="p">};</span>

<span class="cm">/********************/</span>
<span class="cm">/* Main driver core */</span>
<span class="cm">/********************/</span>

<span class="cm">/*</span>
<span class="cm"> * Default cache line size, in bytes.</span>
<span class="cm"> * Used when PCI device not fully initialized by bootrom/BIOS</span>
<span class="cm">*/</span>
<span class="cp">#define DEFAULT_CACHELINE       32</span>
<span class="cp">#define ATH_REGCLASSIDS_MAX     10</span>
<span class="cp">#define ATH_CABQ_READY_TIME     80      </span><span class="cm">/* % of beacon interval */</span><span class="cp"></span>
<span class="cp">#define ATH_MAX_SW_RETRIES      30</span>
<span class="cp">#define ATH_CHAN_MAX            255</span>

<span class="cp">#define ATH_TXPOWER_MAX         100     </span><span class="cm">/* .5 dBm units */</span><span class="cp"></span>
<span class="cp">#define ATH_RATE_DUMMY_MARKER   0</span>

<span class="cp">#define SC_OP_INVALID                BIT(0)</span>
<span class="cp">#define SC_OP_BEACONS                BIT(1)</span>
<span class="cp">#define SC_OP_OFFCHANNEL             BIT(2)</span>
<span class="cp">#define SC_OP_RXFLUSH                BIT(3)</span>
<span class="cp">#define SC_OP_TSF_RESET              BIT(4)</span>
<span class="cp">#define SC_OP_BT_PRIORITY_DETECTED   BIT(5)</span>
<span class="cp">#define SC_OP_BT_SCAN                BIT(6)</span>
<span class="cp">#define SC_OP_ANI_RUN                BIT(7)</span>
<span class="cp">#define SC_OP_PRIM_STA_VIF           BIT(8)</span>

<span class="cm">/* Powersave flags */</span>
<span class="cp">#define PS_WAIT_FOR_BEACON        BIT(0)</span>
<span class="cp">#define PS_WAIT_FOR_CAB           BIT(1)</span>
<span class="cp">#define PS_WAIT_FOR_PSPOLL_DATA   BIT(2)</span>
<span class="cp">#define PS_WAIT_FOR_TX_ACK        BIT(3)</span>
<span class="cp">#define PS_BEACON_SYNC            BIT(4)</span>

<span class="k">struct</span> <span class="n">ath_rate_table</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_vif_iter_data</span> <span class="p">{</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">hw_macaddr</span><span class="p">;</span> <span class="cm">/* phy&#39;s hardware address, set</span>
<span class="cm">			       * before starting iteration for</span>
<span class="cm">			       * valid bssid mask.</span>
<span class="cm">			       */</span>
	<span class="n">u8</span> <span class="n">mask</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span> <span class="cm">/* bssid mask */</span>
	<span class="kt">int</span> <span class="n">naps</span><span class="p">;</span>      <span class="cm">/* number of AP vifs */</span>
	<span class="kt">int</span> <span class="n">nmeshes</span><span class="p">;</span>   <span class="cm">/* number of mesh vifs */</span>
	<span class="kt">int</span> <span class="n">nstations</span><span class="p">;</span> <span class="cm">/* number of station vifs */</span>
	<span class="kt">int</span> <span class="n">nwds</span><span class="p">;</span>      <span class="cm">/* number of WDS vifs */</span>
	<span class="kt">int</span> <span class="n">nadhocs</span><span class="p">;</span>   <span class="cm">/* number of adhoc vifs */</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_softc</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">survey_info</span> <span class="o">*</span><span class="n">cur_survey</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">survey_info</span> <span class="n">survey</span><span class="p">[</span><span class="n">ATH9K_NUM_CHANNELS</span><span class="p">];</span>

	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">intr_tq</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">bcon_tasklet</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_hw</span> <span class="o">*</span><span class="n">sc_ah</span><span class="p">;</span>
	<span class="kt">void</span> <span class="n">__iomem</span> <span class="o">*</span><span class="n">mem</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">irq</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">sc_serial_rw</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">sc_pm_lock</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">sc_pcu_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">mutex</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">paprd_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">hw_check_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">hw_reset_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">completion</span> <span class="n">paprd_complete</span><span class="p">;</span>

	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">hw_busy_count</span><span class="p">;</span>

	<span class="n">u32</span> <span class="n">intrstatus</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">sc_flags</span><span class="p">;</span> <span class="cm">/* SC_OP_* */</span>
	<span class="n">u16</span> <span class="n">ps_flags</span><span class="p">;</span> <span class="cm">/* PS_* */</span>
	<span class="n">u16</span> <span class="n">curtxpow</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ps_enabled</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ps_idle</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">nbcnvifs</span><span class="p">;</span>
	<span class="kt">short</span> <span class="n">nvifs</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ps_usecount</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ath_config</span> <span class="n">config</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_rx</span> <span class="n">rx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_tx</span> <span class="n">tx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_beacon</span> <span class="n">beacon</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_supported_band</span> <span class="n">sbands</span><span class="p">[</span><span class="n">IEEE80211_NUM_BANDS</span><span class="p">];</span>

<span class="cp">#ifdef CONFIG_MAC80211_LEDS</span>
	<span class="n">bool</span> <span class="n">led_registered</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">led_name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">led_classdev</span> <span class="n">led_cdev</span><span class="p">;</span>
<span class="cp">#endif</span>

	<span class="k">struct</span> <span class="n">ath9k_hw_cal_data</span> <span class="n">caldata</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">last_rssi</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_ATH9K_DEBUGFS</span>
	<span class="k">struct</span> <span class="n">ath9k_debug</span> <span class="n">debug</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">nodes_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">nodes</span><span class="p">;</span> <span class="cm">/* basically, stations */</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">tx_complete_poll_work_seen</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="k">struct</span> <span class="n">ath_beacon_config</span> <span class="n">cur_beacon_conf</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">tx_complete_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">hw_pll_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">rx_poll_timer</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_ATH9K_BTCOEX_SUPPORT</span>
	<span class="k">struct</span> <span class="n">ath_btcoex</span> <span class="n">btcoex</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_mci_coex</span> <span class="n">mci_coex</span><span class="p">;</span>
<span class="cp">#endif</span>

	<span class="k">struct</span> <span class="n">ath_descdma</span> <span class="n">txsdma</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ath_ant_comb</span> <span class="n">ant_comb</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ant_tx</span><span class="p">,</span> <span class="n">ant_rx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">dfs_pattern_detector</span> <span class="o">*</span><span class="n">dfs_detector</span><span class="p">;</span>
<span class="p">};</span>

<span class="kt">void</span> <span class="n">ath9k_tasklet</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_cabq_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="p">);</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath_read_cachesize</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_common</span> <span class="o">*</span><span class="n">common</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">csz</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">common</span><span class="o">-&gt;</span><span class="n">bus_ops</span><span class="o">-&gt;</span><span class="n">read_cachesize</span><span class="p">(</span><span class="n">common</span><span class="p">,</span> <span class="n">csz</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">ieee80211_ops</span> <span class="n">ath9k_ops</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">ath9k_modparam_nohwcrypt</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">led_blink</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">bool</span> <span class="n">is_ath9k_unloaded</span><span class="p">;</span>

<span class="n">irqreturn_t</span> <span class="n">ath_isr</span><span class="p">(</span><span class="kt">int</span> <span class="n">irq</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">dev</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath9k_init_device</span><span class="p">(</span><span class="n">u16</span> <span class="n">devid</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span>
		    <span class="k">const</span> <span class="k">struct</span> <span class="n">ath_bus_ops</span> <span class="o">*</span><span class="n">bus_ops</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_deinit_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_set_hw_capab</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_reload_chainmask_settings</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>

<span class="n">bool</span> <span class="n">ath9k_uses_beacons</span><span class="p">(</span><span class="kt">int</span> <span class="n">type</span><span class="p">);</span>

<span class="cp">#ifdef CONFIG_ATH9K_PCI</span>
<span class="kt">int</span> <span class="n">ath_pci_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_pci_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ath_pci_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath_pci_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{};</span>
<span class="cp">#endif</span>

<span class="cp">#ifdef CONFIG_ATH9K_AHB</span>
<span class="kt">int</span> <span class="n">ath_ahb_init</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath_ahb_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ath_ahb_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="p">};</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath_ahb_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{};</span>
<span class="cp">#endif</span>

<span class="kt">void</span> <span class="n">ath9k_ps_wakeup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_ps_restore</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>

<span class="n">u8</span> <span class="n">ath_txchainmask_reduction</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">,</span> <span class="n">u8</span> <span class="n">chainmask</span><span class="p">,</span> <span class="n">u32</span> <span class="n">rate</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath_start_rfkill_poll</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_softc</span> <span class="o">*</span><span class="n">sc</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="n">ath9k_rfkill_poll_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_calculate_iter_data</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">,</span>
			       <span class="k">struct</span> <span class="n">ath9k_vif_iter_data</span> <span class="o">*</span><span class="n">iter_data</span><span class="p">);</span>


<span class="cp">#endif </span><span class="cm">/* ATH9K_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
