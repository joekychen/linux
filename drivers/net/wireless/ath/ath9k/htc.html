<!DOCTYPE html>
<html><head><title>joekychen/linux » drivers › net › wireless › ath › ath9k › htc.h

</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta name="generator" content="Docco">
<link rel="stylesheet" media="all" href="../../../../../stylesheets/docco.min.css" />


</head>
<body>
<div id="container">
<div id="background"></div>
<table cellpadding="0" cellspacing="0">
<thead><tr><th class="docs"><a id="home" href="../../../../../index.html"></a><h1>htc.h</h1></th><th class="code"></th></tr></thead>
<tbody>


<tr id="section-1"><td class="docs"><div class="pilwrap"><a class="pilcrow" href="#section-1">&#182;</a></div></td><td class="code"><div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2010-2011 Atheros Communications Inc.</span>
<span class="cm"> *</span>
<span class="cm"> * Permission to use, copy, modify, and/or distribute this software for any</span>
<span class="cm"> * purpose with or without fee is hereby granted, provided that the above</span>
<span class="cm"> * copyright notice and this permission notice appear in all copies.</span>
<span class="cm"> *</span>
<span class="cm"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<span class="cm"> * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<span class="cm"> * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<span class="cm"> * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<span class="cm"> * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<span class="cm"> * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<span class="cm"> * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<span class="cm"> */</span>

<span class="cp">#ifndef HTC_H</span>
<span class="cp">#define HTC_H</span>

<span class="cp">#include &lt;linux/module.h&gt;</span>
<span class="cp">#include &lt;linux/usb.h&gt;</span>
<span class="cp">#include &lt;linux/firmware.h&gt;</span>
<span class="cp">#include &lt;linux/skbuff.h&gt;</span>
<span class="cp">#include &lt;linux/netdevice.h&gt;</span>
<span class="cp">#include &lt;linux/leds.h&gt;</span>
<span class="cp">#include &lt;linux/slab.h&gt;</span>
<span class="cp">#include &lt;net/mac80211.h&gt;</span>

<span class="cp">#include &quot;common.h&quot;</span>
<span class="cp">#include &quot;htc_hst.h&quot;</span>
<span class="cp">#include &quot;hif_usb.h&quot;</span>
<span class="cp">#include &quot;wmi.h&quot;</span>

<span class="cp">#define ATH_STA_SHORT_CALINTERVAL 1000    </span><span class="cm">/* 1 second */</span><span class="cp"></span>
<span class="cp">#define ATH_AP_SHORT_CALINTERVAL  100     </span><span class="cm">/* 100 ms */</span><span class="cp"></span>
<span class="cp">#define ATH_ANI_POLLINTERVAL      100     </span><span class="cm">/* 100 ms */</span><span class="cp"></span>
<span class="cp">#define ATH_LONG_CALINTERVAL      30000   </span><span class="cm">/* 30 seconds */</span><span class="cp"></span>
<span class="cp">#define ATH_RESTART_CALINTERVAL   1200000 </span><span class="cm">/* 20 minutes */</span><span class="cp"></span>

<span class="cp">#define ATH_DEFAULT_BMISS_LIMIT 10</span>
<span class="cp">#define IEEE80211_MS_TO_TU(x)   (((x) * 1000) / 1024)</span>
<span class="cp">#define TSF_TO_TU(_h, _l) \</span>
<span class="cp">	((((u32)(_h)) &lt;&lt; 22) | (((u32)(_l)) &gt;&gt; 10))</span>

<span class="k">extern</span> <span class="k">struct</span> <span class="n">ieee80211_ops</span> <span class="n">ath9k_htc_ops</span><span class="p">;</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="n">htc_modparam_nohwcrypt</span><span class="p">;</span>

<span class="k">enum</span> <span class="n">htc_phymode</span> <span class="p">{</span>
	<span class="n">HTC_MODE_11NA</span>		<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">HTC_MODE_11NG</span>		<span class="o">=</span> <span class="mi">1</span>
<span class="p">};</span>

<span class="k">enum</span> <span class="n">htc_opmode</span> <span class="p">{</span>
	<span class="n">HTC_M_STA</span>	<span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
	<span class="n">HTC_M_IBSS</span>	<span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">HTC_M_AHDEMO</span>	<span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
	<span class="n">HTC_M_HOSTAP</span>	<span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
	<span class="n">HTC_M_MONITOR</span>	<span class="o">=</span> <span class="mi">8</span><span class="p">,</span>
	<span class="n">HTC_M_WDS</span>	<span class="o">=</span> <span class="mi">2</span>
<span class="p">};</span>

<span class="cp">#define ATH9K_HTC_AMPDU  1</span>
<span class="cp">#define ATH9K_HTC_NORMAL 2</span>
<span class="cp">#define ATH9K_HTC_BEACON 3</span>
<span class="cp">#define ATH9K_HTC_MGMT   4</span>

<span class="cp">#define ATH9K_HTC_TX_CTSONLY      0x1</span>
<span class="cp">#define ATH9K_HTC_TX_RTSCTS       0x2</span>

<span class="k">struct</span> <span class="n">tx_frame_hdr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">data_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">node_idx</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vif_idx</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tidno</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">flags</span><span class="p">;</span> <span class="cm">/* ATH9K_HTC_TX_* */</span>
	<span class="n">u8</span> <span class="n">key_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">keyix</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">cookie</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">tx_mgmt_hdr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">node_idx</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vif_idx</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tidno</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">key_type</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">keyix</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">cookie</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">tx_beacon_header</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">vif_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">len_changed</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">rev</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define MAX_TX_AMPDU_SUBFRAMES_9271 17</span>
<span class="cp">#define MAX_TX_AMPDU_SUBFRAMES_7010 22</span>

<span class="k">struct</span> <span class="n">ath9k_htc_cap_target</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">ampdu_limit</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">ampdu_subframes</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">enable_coex</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tx_chainmask</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_vif</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">opmode</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">myaddr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">ath_cap</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">rtsthreshold</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_sta</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">macaddr</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">bssid</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">sta_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vif_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">is_vif_sta</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">flags</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">htcap</span><span class="p">;</span>
	<span class="n">__be16</span> <span class="n">maxampdu</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">pad</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_aggr</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">sta_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">tidno</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">aggr_enable</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">padding</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define ATH_HTC_RATE_MAX 30</span>

<span class="cp">#define WLAN_RC_DS_FLAG  0x01</span>
<span class="cp">#define WLAN_RC_40_FLAG  0x02</span>
<span class="cp">#define WLAN_RC_SGI_FLAG 0x04</span>
<span class="cp">#define WLAN_RC_HT_FLAG  0x08</span>

<span class="k">struct</span> <span class="n">ath9k_htc_rateset</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">rs_nrates</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">rs_rates</span><span class="p">[</span><span class="n">ATH_HTC_RATE_MAX</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath9k_htc_rate</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ath9k_htc_rateset</span> <span class="n">legacy_rates</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath9k_htc_rateset</span> <span class="n">ht_rates</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_rate</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">sta_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">isnew</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">capflags</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath9k_htc_rate</span> <span class="n">rates</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_rate_mask</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">vif_index</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">band</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">mask</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">pad</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_int_stats</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">rx</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rxorn</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">rxeol</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">txurn</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">txto</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">cst</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_tx_stats</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">xretries</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">fifoerr</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">filtered</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">timer_exp</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">shortretries</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">longretries</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">qnull</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">encap_fail</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">nobuf</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="k">struct</span> <span class="n">ath9k_htc_target_rx_stats</span> <span class="p">{</span>
	<span class="n">__be32</span> <span class="n">nobuf</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">host_send</span><span class="p">;</span>
	<span class="n">__be32</span> <span class="n">host_done</span><span class="p">;</span>
<span class="p">}</span> <span class="n">__packed</span><span class="p">;</span>

<span class="cp">#define ATH9K_HTC_MAX_VIF 2</span>
<span class="cp">#define ATH9K_HTC_MAX_BCN_VIF 2</span>

<span class="cp">#define INC_VIF(_priv, _type) do {		\</span>
<span class="cp">		switch (_type) {		\</span>
<span class="cp">		case NL80211_IFTYPE_STATION:	\</span>
<span class="cp">			_priv-&gt;num_sta_vif++;	\</span>
<span class="cp">			break;			\</span>
<span class="cp">		case NL80211_IFTYPE_ADHOC:	\</span>
<span class="cp">			_priv-&gt;num_ibss_vif++;	\</span>
<span class="cp">			break;			\</span>
<span class="cp">		case NL80211_IFTYPE_AP:		\</span>
<span class="cp">			_priv-&gt;num_ap_vif++;	\</span>
<span class="cp">			break;			\</span>
<span class="cp">		default:			\</span>
<span class="cp">			break;			\</span>
<span class="cp">		}				\</span>
<span class="cp">	} while (0)</span>

<span class="cp">#define DEC_VIF(_priv, _type) do {		\</span>
<span class="cp">		switch (_type) {		\</span>
<span class="cp">		case NL80211_IFTYPE_STATION:	\</span>
<span class="cp">			_priv-&gt;num_sta_vif--;	\</span>
<span class="cp">			break;			\</span>
<span class="cp">		case NL80211_IFTYPE_ADHOC:	\</span>
<span class="cp">			_priv-&gt;num_ibss_vif--;	\</span>
<span class="cp">			break;			\</span>
<span class="cp">		case NL80211_IFTYPE_AP:		\</span>
<span class="cp">			_priv-&gt;num_ap_vif--;	\</span>
<span class="cp">			break;			\</span>
<span class="cp">		default:			\</span>
<span class="cp">			break;			\</span>
<span class="cp">		}				\</span>
<span class="cp">	} while (0)</span>

<span class="k">struct</span> <span class="n">ath9k_htc_vif</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">index</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">seq_no</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">beacon_configured</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">bslot</span><span class="p">;</span>
	<span class="n">__le64</span> <span class="n">tsfadjust</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath9k_vif_iter_data</span> <span class="p">{</span>
	<span class="k">const</span> <span class="n">u8</span> <span class="o">*</span><span class="n">hw_macaddr</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mask</span><span class="p">[</span><span class="n">ETH_ALEN</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define ATH9K_HTC_MAX_STA 8</span>
<span class="cp">#define ATH9K_HTC_MAX_TID 8</span>

<span class="k">enum</span> <span class="n">tid_aggr_state</span> <span class="p">{</span>
	<span class="n">AGGR_STOP</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
	<span class="n">AGGR_PROGRESS</span><span class="p">,</span>
	<span class="n">AGGR_START</span><span class="p">,</span>
	<span class="n">AGGR_OPERATIONAL</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath9k_htc_sta</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">index</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">tid_aggr_state</span> <span class="n">tid_state</span><span class="p">[</span><span class="n">ATH9K_HTC_MAX_TID</span><span class="p">];</span>
<span class="p">};</span>

<span class="cp">#define ATH9K_HTC_RXBUF 256</span>
<span class="cp">#define HTC_RX_FRAME_HEADER_SIZE 40</span>

<span class="k">struct</span> <span class="n">ath9k_htc_rxbuf</span> <span class="p">{</span>
	<span class="n">bool</span> <span class="n">in_process</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_htc_rx_status</span> <span class="n">rxstatus</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">list</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath9k_htc_rx</span> <span class="p">{</span>
	<span class="kt">int</span> <span class="n">last_rssi</span><span class="p">;</span> <span class="cm">/* FIXME: per-STA */</span>
	<span class="k">struct</span> <span class="n">list_head</span> <span class="n">rxbuf</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">rxbuflock</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#define ATH9K_HTC_TX_CLEANUP_INTERVAL 50 </span><span class="cm">/* ms */</span><span class="cp"></span>
<span class="cp">#define ATH9K_HTC_TX_TIMEOUT_INTERVAL 3000 </span><span class="cm">/* ms */</span><span class="cp"></span>
<span class="cp">#define ATH9K_HTC_TX_RESERVE 10</span>
<span class="cp">#define ATH9K_HTC_TX_TIMEOUT_COUNT 40</span>
<span class="cp">#define ATH9K_HTC_TX_THRESHOLD (MAX_TX_BUF_NUM - ATH9K_HTC_TX_RESERVE)</span>

<span class="cp">#define ATH9K_HTC_OP_TX_QUEUES_STOP BIT(0)</span>
<span class="cp">#define ATH9K_HTC_OP_TX_DRAIN       BIT(1)</span>

<span class="k">struct</span> <span class="n">ath9k_htc_tx</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">flags</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">queued_cnt</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">mgmt_ep_queue</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">cab_ep_queue</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">data_be_queue</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">data_bk_queue</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">data_vi_queue</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">data_vo_queue</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">sk_buff_head</span> <span class="n">tx_failed</span><span class="p">;</span>
	<span class="n">DECLARE_BITMAP</span><span class="p">(</span><span class="n">tx_slot</span><span class="p">,</span> <span class="n">MAX_TX_BUF_NUM</span><span class="p">);</span>
	<span class="k">struct</span> <span class="n">timer_list</span> <span class="n">cleanup_timer</span><span class="p">;</span>
	<span class="n">spinlock_t</span> <span class="n">tx_lock</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath9k_htc_tx_ctl</span> <span class="p">{</span>
	<span class="n">u8</span> <span class="n">type</span><span class="p">;</span> <span class="cm">/* ATH9K_HTC_* */</span>
	<span class="n">u8</span> <span class="n">epid</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">txok</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">sta_idx</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">timestamp</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="k">struct</span> <span class="n">ath9k_htc_tx_ctl</span> <span class="o">*</span><span class="nf">HTC_SKB_CB</span><span class="p">(</span><span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_tx_info</span> <span class="o">*</span><span class="n">tx_info</span> <span class="o">=</span> <span class="n">IEEE80211_SKB_CB</span><span class="p">(</span><span class="n">skb</span><span class="p">);</span>

	<span class="n">BUILD_BUG_ON</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_tx_ctl</span><span class="p">)</span> <span class="o">&gt;</span>
		     <span class="n">IEEE80211_TX_INFO_DRIVER_DATA_SIZE</span><span class="p">);</span>
	<span class="k">return</span> <span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_tx_ctl</span> <span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">tx_info</span><span class="o">-&gt;</span><span class="n">driver_data</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">#ifdef CONFIG_ATH9K_HTC_DEBUGFS</span>

<span class="cp">#define TX_STAT_INC(c) (hif_dev-&gt;htc_handle-&gt;drv_priv-&gt;debug.tx_stats.c++)</span>
<span class="cp">#define RX_STAT_INC(c) (hif_dev-&gt;htc_handle-&gt;drv_priv-&gt;debug.rx_stats.c++)</span>
<span class="cp">#define CAB_STAT_INC   priv-&gt;debug.tx_stats.cab_queued++</span>

<span class="cp">#define TX_QSTAT_INC(q) (priv-&gt;debug.tx_stats.queue_stats[q]++)</span>

<span class="kt">void</span> <span class="n">ath9k_htc_err_stat_rx</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
			   <span class="k">struct</span> <span class="n">ath_htc_rx_status</span> <span class="o">*</span><span class="n">rxs</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">ath_tx_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">buf_queued</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">buf_completed</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">skb_queued</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">skb_success</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">skb_failed</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">cab_queued</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">queue_stats</span><span class="p">[</span><span class="n">WME_NUM_AC</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_rx_stats</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">skb_allocated</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">skb_completed</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">skb_dropped</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_crc</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_decrypt_crc</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_mic</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_pre_delim</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_post_delim</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_decrypt_busy</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_phy</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">err_phy_stats</span><span class="p">[</span><span class="n">ATH9K_PHYERR_MAX</span><span class="p">];</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath9k_debug</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="n">debugfs_phy</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_tx_stats</span> <span class="n">tx_stats</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_rx_stats</span> <span class="n">rx_stats</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#else</span>

<span class="cp">#define TX_STAT_INC(c) do { } while (0)</span>
<span class="cp">#define RX_STAT_INC(c) do { } while (0)</span>
<span class="cp">#define CAB_STAT_INC   do { } while (0)</span>

<span class="cp">#define TX_QSTAT_INC(c) do { } while (0)</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_htc_err_stat_rx</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
					 <span class="k">struct</span> <span class="n">ath_htc_rx_status</span> <span class="o">*</span><span class="n">rxs</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="cp">#endif </span><span class="cm">/* CONFIG_ATH9K_HTC_DEBUGFS */</span><span class="cp"></span>

<span class="cp">#define ATH_LED_PIN_DEF             1</span>
<span class="cp">#define ATH_LED_PIN_9287            10</span>
<span class="cp">#define ATH_LED_PIN_9271            15</span>
<span class="cp">#define ATH_LED_PIN_7010            12</span>

<span class="cp">#define BSTUCK_THRESHOLD 10</span>

<span class="cm">/*</span>
<span class="cm"> * Adjust these when the max. no of beaconing interfaces is</span>
<span class="cm"> * increased.</span>
<span class="cm"> */</span>
<span class="cp">#define DEFAULT_SWBA_RESPONSE 40 </span><span class="cm">/* in TUs */</span><span class="cp"></span>
<span class="cp">#define MIN_SWBA_RESPONSE     10 </span><span class="cm">/* in TUs */</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">htc_beacon_config</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">bslot</span><span class="p">[</span><span class="n">ATH9K_HTC_MAX_BCN_VIF</span><span class="p">];</span>
	<span class="n">u16</span> <span class="n">beacon_interval</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">dtim_period</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">bmiss_timeout</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">bmiss_cnt</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="n">ath_btcoex</span> <span class="p">{</span>
	<span class="n">u32</span> <span class="n">bt_priority_cnt</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">bt_priority_time</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">bt_stomp_type</span><span class="p">;</span> <span class="cm">/* Types of BT stomping */</span>
	<span class="n">u32</span> <span class="n">btcoex_no_stomp</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">btcoex_period</span><span class="p">;</span>
	<span class="n">u32</span> <span class="n">btscan_no_stomp</span><span class="p">;</span>
<span class="p">};</span>

<span class="cp">#ifdef CONFIG_ATH9K_BTCOEX_SUPPORT</span>
<span class="kt">void</span> <span class="n">ath9k_htc_init_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">product</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_start_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_stop_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_htc_init_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">product</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_htc_start_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_htc_stop_btcoex</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_ATH9K_BTCOEX_SUPPORT */</span><span class="cp"></span>

<span class="cp">#define OP_INVALID		   BIT(0)</span>
<span class="cp">#define OP_SCANNING		   BIT(1)</span>
<span class="cp">#define OP_ENABLE_BEACON           BIT(2)</span>
<span class="cp">#define OP_BT_PRIORITY_DETECTED    BIT(3)</span>
<span class="cp">#define OP_BT_SCAN                 BIT(4)</span>
<span class="cp">#define OP_ANI_RUNNING             BIT(5)</span>
<span class="cp">#define OP_TSF_RESET               BIT(6)</span>

<span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="p">{</span>
	<span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath_hw</span> <span class="o">*</span><span class="n">ah</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">htc</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">wmi</span> <span class="o">*</span><span class="n">wmi</span><span class="p">;</span>

	<span class="n">u16</span> <span class="n">fw_version_major</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">fw_version_minor</span><span class="p">;</span>

	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">wmi_cmd_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">beacon_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">cab_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">uapsd_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">mgmt_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">data_be_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">data_bk_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">data_vi_ep</span><span class="p">;</span>
	<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">data_vo_ep</span><span class="p">;</span>

	<span class="n">u8</span> <span class="n">vif_slot</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">mon_vif_idx</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">sta_slot</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">vif_sta_pos</span><span class="p">[</span><span class="n">ATH9K_HTC_MAX_VIF</span><span class="p">];</span>
	<span class="n">u8</span> <span class="n">num_ibss_vif</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">num_sta_vif</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">num_sta_assoc_vif</span><span class="p">;</span>
	<span class="n">u8</span> <span class="n">num_ap_vif</span><span class="p">;</span>

	<span class="n">u16</span> <span class="n">op_flags</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">curtxpow</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">txpowlimit</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">nvifs</span><span class="p">;</span>
	<span class="n">u16</span> <span class="n">nstations</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">rearm_ani</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">reconfig_beacon</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">rxfilter</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ath9k_hw_cal_data</span> <span class="n">caldata</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ieee80211_supported_band</span> <span class="n">sbands</span><span class="p">[</span><span class="n">IEEE80211_NUM_BANDS</span><span class="p">];</span>

	<span class="n">spinlock_t</span> <span class="n">beacon_lock</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">htc_beacon_config</span> <span class="n">cur_beacon_conf</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">ath9k_htc_rx</span> <span class="n">rx</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">ath9k_htc_tx</span> <span class="n">tx</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">swba_tasklet</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">rx_tasklet</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">ani_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">tasklet_struct</span> <span class="n">tx_failed_tasklet</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">ps_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">fatal_work</span><span class="p">;</span>

	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">htc_pm_lock</span><span class="p">;</span>
	<span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">ps_usecount</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ps_enabled</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">ps_idle</span><span class="p">;</span>

<span class="cp">#ifdef CONFIG_MAC80211_LEDS</span>
	<span class="k">enum</span> <span class="n">led_brightness</span> <span class="n">brightness</span><span class="p">;</span>
	<span class="n">bool</span> <span class="n">led_registered</span><span class="p">;</span>
	<span class="kt">char</span> <span class="n">led_name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
	<span class="k">struct</span> <span class="n">led_classdev</span> <span class="n">led_cdev</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">work_struct</span> <span class="n">led_work</span><span class="p">;</span>
<span class="cp">#endif</span>

	<span class="kt">int</span> <span class="n">beaconq</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">cabq</span><span class="p">;</span>
	<span class="kt">int</span> <span class="n">hwq_map</span><span class="p">[</span><span class="n">WME_NUM_AC</span><span class="p">];</span>

<span class="cp">#ifdef CONFIG_ATH9K_BTCOEX_SUPPORT</span>
	<span class="k">struct</span> <span class="n">ath_btcoex</span> <span class="n">btcoex</span><span class="p">;</span>
<span class="cp">#endif</span>

	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">coex_period_work</span><span class="p">;</span>
	<span class="k">struct</span> <span class="n">delayed_work</span> <span class="n">duty_cycle_work</span><span class="p">;</span>
<span class="cp">#ifdef CONFIG_ATH9K_HTC_DEBUGFS</span>
	<span class="k">struct</span> <span class="n">ath9k_debug</span> <span class="n">debug</span><span class="p">;</span>
<span class="cp">#endif</span>
	<span class="k">struct</span> <span class="n">mutex</span> <span class="n">mutex</span><span class="p">;</span>
<span class="p">};</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath_read_cachesize</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_common</span> <span class="o">*</span><span class="n">common</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">csz</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">common</span><span class="o">-&gt;</span><span class="n">bus_ops</span><span class="o">-&gt;</span><span class="n">read_cachesize</span><span class="p">(</span><span class="n">common</span><span class="p">,</span> <span class="n">csz</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">ath9k_htc_reset</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath9k_htc_assign_bslot</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_remove_bslot</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
			    <span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_set_tsfadjust</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_beaconq_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_beacon_config</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
			     <span class="k">struct</span> <span class="n">ieee80211_vif</span> <span class="o">*</span><span class="n">vif</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_beacon_reconfig</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_swba</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
		    <span class="k">struct</span> <span class="n">wmi_event_swba</span> <span class="o">*</span><span class="n">swba</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath9k_htc_rxep</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
		    <span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">ep_id</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_txep</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">ep_id</span><span class="p">,</span>
		    <span class="n">bool</span> <span class="n">txok</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_beaconep</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">drv_priv</span><span class="p">,</span> <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">htc_endpoint_id</span> <span class="n">ep_id</span><span class="p">,</span> <span class="n">bool</span> <span class="n">txok</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">ath9k_htc_update_cap_target</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
				<span class="n">u8</span> <span class="n">enable_coex</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_ani_work</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_start_ani</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_stop_ani</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">ath9k_tx_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath9k_htc_tx_start</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">sk_buff</span> <span class="o">*</span><span class="n">skb</span><span class="p">,</span> <span class="n">u8</span> <span class="n">slot</span><span class="p">,</span> <span class="n">bool</span> <span class="n">is_cab</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_tx_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">ath9k_htc_txq_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">subtype</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath9k_htc_cabq_setup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">get_hw_qnum</span><span class="p">(</span><span class="n">u16</span> <span class="n">queue</span><span class="p">,</span> <span class="kt">int</span> <span class="o">*</span><span class="n">hwq_map</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath_htc_txq_update</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">qnum</span><span class="p">,</span>
		       <span class="k">struct</span> <span class="n">ath9k_tx_queue_info</span> <span class="o">*</span><span class="n">qinfo</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_check_stop_queues</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_check_wake_queues</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath9k_htc_tx_get_slot</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_tx_clear_slot</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="kt">int</span> <span class="n">slot</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_tx_drain</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_txstatus</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">wmi_event</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_tx_failed_tasklet</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_tx_cleanup_timer</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>

<span class="kt">int</span> <span class="n">ath9k_rx_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_rx_cleanup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_host_rx_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_rx_tasklet</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">data</span><span class="p">);</span>
<span class="n">u32</span> <span class="n">ath9k_htc_calcrxfilter</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath9k_htc_ps_wakeup</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_ps_restore</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_ps_work</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>
<span class="n">bool</span> <span class="n">ath9k_htc_setpower</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">,</span>
			<span class="k">enum</span> <span class="n">ath9k_power_mode</span> <span class="n">mode</span><span class="p">);</span>

<span class="kt">void</span> <span class="n">ath9k_start_rfkill_poll</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_rfkill_poll_state</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_radio_enable</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_radio_disable</span><span class="p">(</span><span class="k">struct</span> <span class="n">ieee80211_hw</span> <span class="o">*</span><span class="n">hw</span><span class="p">);</span>

<span class="cp">#ifdef CONFIG_MAC80211_LEDS</span>
<span class="kt">void</span> <span class="n">ath9k_init_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_deinit_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_led_work</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_init_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_deinit_leds</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath9k_htc_priv</span> <span class="o">*</span><span class="n">priv</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">ath9k_led_work</span><span class="p">(</span><span class="k">struct</span> <span class="n">work_struct</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>
<span class="cp">#endif</span>

<span class="kt">int</span> <span class="n">ath9k_htc_probe_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">htc_handle</span><span class="p">,</span> <span class="k">struct</span> <span class="n">device</span> <span class="o">*</span><span class="n">dev</span><span class="p">,</span>
			   <span class="n">u16</span> <span class="n">devid</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">product</span><span class="p">,</span> <span class="n">u32</span> <span class="n">drv_info</span><span class="p">);</span>
<span class="kt">void</span> <span class="n">ath9k_htc_disconnect_device</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">htc_handle</span><span class="p">,</span> <span class="n">bool</span> <span class="n">hotunplug</span><span class="p">);</span>
<span class="cp">#ifdef CONFIG_PM</span>
<span class="kt">void</span> <span class="n">ath9k_htc_suspend</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">htc_handle</span><span class="p">);</span>
<span class="kt">int</span> <span class="n">ath9k_htc_resume</span><span class="p">(</span><span class="k">struct</span> <span class="n">htc_target</span> <span class="o">*</span><span class="n">htc_handle</span><span class="p">);</span>
<span class="cp">#endif</span>
<span class="cp">#ifdef CONFIG_ATH9K_HTC_DEBUGFS</span>
<span class="kt">int</span> <span class="n">ath9k_htc_init_debug</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_hw</span> <span class="o">*</span><span class="n">ah</span><span class="p">);</span>
<span class="cp">#else</span>
<span class="k">static</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">ath9k_htc_init_debug</span><span class="p">(</span><span class="k">struct</span> <span class="n">ath_hw</span> <span class="o">*</span><span class="n">ah</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> <span class="p">};</span>
<span class="cp">#endif </span><span class="cm">/* CONFIG_ATH9K_HTC_DEBUGFS */</span><span class="cp"></span>

<span class="cp">#endif </span><span class="cm">/* HTC_H */</span><span class="cp"></span>

</pre></div></td></tr>

</tbody>
</table>
</div>

</body>
<script>docas={repo:"joekychen/linux",depth:5}</script>
<script>document.write('<script src=' + ('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0rc1/zepto.min.js' : 'https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js')+'><\\/script>')</script>
<script src="http://baoshan.github.com/moment/min/moment.min.js"></script>
<script src="../../../../../javascript/docco.min.js"></script>
</html>
